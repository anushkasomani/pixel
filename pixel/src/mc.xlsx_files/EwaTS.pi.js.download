'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[1],{1053:function(y,m,a){a.d(m,"a",function(){return b});y=a(0);m=a(936);var c=a(84);class b extends m.a{constructor(e,k,d){super(e,k);this.Zx=!0;this.command=d}vr(e){super.vr(e);this.businessBar.$.Ia.qh(new c.a(this.command,e,this.businessBar.$.ji,10,null))}}Object(y.a)(b,"CommandActionBusinessBarEntry",m.a,[])},1101:function(y,m,a){function c(n){const v=k.a.instance;return Object.assign({},(()=>{switch(d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarDifferentStrings",
u.Control)){case u.Clean:return{title:v.ia(2480),message:String.format(v.sh(240),n)};case u.Fix:return{title:v.ia(2481),message:String.format(v.sh(241),n)};case u.MakeConsistent:return{title:v.ia(2482),message:String.format(v.sh(242),n)};case u.MakeProfessional:return{title:v.ia(2483),message:String.format(v.sh(243),n)};case u.AvoidIncorrections:return{title:String.format(v.sh(244),n),message:v.ia(2484)};case u.Polish:return{title:v.ia(2486),message:String.format(v.sh(245),n)};default:return{title:String.format(v.sh(239),
n),message:v.ia(2475)}}})(),{Ste:v.ia(2474)})}function b(){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarLearnMoreLinkEnabled",!1)}function e(){switch(d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarDifferentStrings",u.Control)){case u.Clean:return"Error";case u.Fix:return"Error";case u.MakeConsistent:return"Lightbulb";case u.MakeProfessional:return"Lightbulb";case u.AvoidIncorrections:return"Warning";case u.Polish:return"AutoEnhanceOn";
default:return"Lightbulb"}}a.d(m,"b",function(){return c});a.d(m,"c",function(){return b});a.d(m,"a",function(){return e});y=a(0);var k=a(12),d=a(1),u;(function(n){n[n.Control=0]="Control";n[n.Clean=1]="Clean";n[n.Fix=2]="Fix";n[n.MakeConsistent=3]="MakeConsistent";n[n.MakeProfessional=4]="MakeProfessional";n[n.AvoidIncorrections=5]="AvoidIncorrections";n[n.Polish=6]="Polish"})(u||(u={}));Object(y.b)("BusinessBarExperiment",u)},1103:function(y,m,a){a.d(m,"a",function(){return d});y=a(0);var c=a(15),
b=a(6),e=a(59),k=a(37);class d{static aFf(u,n){switch(u){case 3:return d.d1i(n);case 2:return d.vTi(n);case 1:return d.pMi(n)}return""}static d1i(u){switch(u){case 1:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static vTi(u){switch(u){case 1:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static pMi(u){switch(u){case 1:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static ice(u,n,v){if(k.a.io||k.a.Gw)window.setTimeout(()=>{d.iDg(v,d.ROf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.K8e(v),u,0,!1)}static hZh(u,n,v,f){n&&f&&f();d.ice(u,n,v)}static ROf(){return k.a.io?1:k.a.Gw?2:k.a.n3a?3:k.a.isMac?4:0}static get JXb(){return"zh-CN"===window.navigator.language}static iDg(u,n){1===n?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),
u=d.aFf(u,n),8<k.a.ZUb?e.a.Em(u,void 0,void 0,"RedirectToAppStore"):e.a.kY(u)):document.hidden||(d.JXb?(u=b.AFrameworkApplication.ea.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.kY(u)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.aFf(u,n),null,null)))}static K8e(u){switch(u){case 3:return 5;
case 2:return 3;case 1:return 1;default:return 0}}static get Gte(){return(k.a.n3a||k.a.isMac)&&k.a.$v}static rFf(u){switch(u){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Ioj(u){return(u=d.LPi(u))&&""!==u?Boolean.parse(u):!1}static hre(u){d.KGk(u)}static LPi(u){try{return localStorage.getItem(u)}catch(n){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+n.message),
null}}static KGk(u){try{localStorage.setItem(u,"true")}catch(n){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+n.message)}}}d.OXh="ChromeExtensionBarDismiss";Object(y.a)(d,"WildFireUtilities",null,[])},113:function(y,m,a){function c(I){return I.includes("aadInteractionRequired")||I.includes("sessionRevocation")||I.includes("blockAccessForTenantRestrictions")||I.includes("revoked")||I.includes("Due to organizational policies, you can't access these resources from this network location")?
!0:!1}function b(){return Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.ka("WopiTokenRevokedTokenExperiment")&&Aa.AFrameworkApplication.ea.ka("ShowTokenRevocationErrorMessage"):!1}function e(){return Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAttributeGatekeeperCookieMismatch",!1):!1}function k(I,pa){return xo(function*(){if(Object(hd.l)(I.la)){const lb=I.la.sheetProcessedData;Object(Je.a)(lb);return pa.map(hc=>pd(hc,
!0)).filter(hc=>lb.value.Moa(hc))}return[]})}function d(I,pa,lb,hc){const Xc=new Map;if(0===hc.size)return Xc;if(!Object(hd.l)(I.la))return ea.ULS.sendTraceTag(507568209,0,15,"Grid.getFormulasPointingToRange Unable to get activeItem."),Xc;if(I.la.sheetId===lb){const Gd=Object(Oc.f)(I);lb=Gd.za.uA();const ae=I.la.sheetName;lb.forEach(we=>{var Re;if(we.la.sheetName===ae){const lf=Gd.$.workbookContext.WorkbookFileName;(we=null===(Re=we.tl)||void 0===Re?void 0:Re.getCalcBlockModel())?u(pa,we,ae,lf,hc).forEach(hg=>
{const Wg=Xc.get(hg.DFe)||new Set;Wg.add(hg.qfh);Xc.set(hg.DFe,Wg)}):ea.ULS.sendTraceTag(507597516,0,15,"Grid.getFormulasPointingToRange Unable to get CalcBlockModel.")}})}return Xc}function u(I,pa,lb,hc,Xc){const Gd=new Set;if(I){var ae=pa.getRowNumbers(),we=pa.getColumnNumbers();ae=ae[0];we=we[0];pa.reset();let Re=null;for(;Re=pa.getNextCell();)if(Object(jf.f)(Re.formula)){const lf=I.extractReferences(Re.formula,lb,hc,!0);if(lf){const hg=new ca.Range(Re.row+ae,Re.col+we,Re.row+ae,Re.col+we,!1,!1);
for(const Wg of lf.Items){const mg=Object(Kc.F)(Wg.Range);Xc.forEach(Xg=>mg.Fk(Xg)?Gd.add({DFe:hg,qfh:Xg}):null)}}}}else ea.ULS.sendTraceTag(507597515,0,15,"Grid.getInBlockFormulasPointingToRange Unable to get calcManager.");return Gd}function n(I){switch(I){case 0:return 1;case 2:return 2;case 1:return 4;default:throw ea.ULS.sendTraceTag(508559903,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${I}`),Error.argument("illegal ExtraSpacesPaddingType");}}function v(I,
pa,lb,hc,Xc){return xo(function*(){const Gd=Object(Kc.w)(I.activeItemName,null,pa),{Pae:ae,Oae:we,qce:Re}=r();Object(Jc.a)(I.userOperationManager,(lf,hg,Wg)=>pe.E(I.oa.ta,Xc,Gd,hc,Object(zc.c)(lf,ae),Object(zc.b)(hg,we),Wg,null),lf=>new zb.a(258,0,lf),null);yield Re;return lb.length})}function f(I,pa,lb){return xo(function*(){const hc=Object(Kc.w)(I.activeItemName,null,pa),Xc=I.oa.ta.Wh({Oza:!0,rya:1}),{Pae:Gd,Oae:ae,qce:we}=r();Object(Jc.a)(I.userOperationManager,(Re,lf,hg)=>Cb.m(I.oa.ta,hc,Object(Kc.q)(Oc.f(I).ha.pa.activeCell,
I),lb,!1,null,null,!0,!1,Object(zc.c)(Re,Gd),Object(zc.b)(lf,ae),hg,null,Xc,null),Re=>new zb.a(11,0,Re),null);yield we;return-1})}function w(I,pa,lb){return xo(function*(){const hc=Object(Kc.w)(I.activeItemName,null,pa),{Pae:Xc,Oae:Gd,qce:ae}=r(),we=lb.reduce((lf,hg)=>lf|hg,0);Object(Jc.a)(I.userOperationManager,(lf,hg,Wg)=>{var mg=I.oa.ta;lf=Object(zc.c)(lf,Xc);hg=Object(zc.b)(hg,Gd);const Xg=mg.Za(9,null);Xg.ranges=hc;Xg.trimWhitespaceType=we;return Cb.h(mg,"TrimWhitespace",Xg,lf,hg,Wg,null,0)},
lf=>new zb.a(253,0,lf),null);const {Result:Re}=yield ae;return Re})}function r(){const I=new Pa.a;return{Pae(pa){pa&&Ia.a.ll(pa.Errors)?(ea.ULS.sendTraceTag(509617682,0,10,"DataCleansing onOperationSuccess: Ewa result contains error messages after applying"),I.setResult(null)):pa?(ea.ULS.sendTraceTag(537163359,0,20,"DataCleansing onOperationSuccess: Suggestion applied successfully"),I.setResult(pa)):(ea.ULS.sendTraceTag(508424517,0,10,"DataCleansing onOperationSuccess: Ewa result is null after applying"),
I.setResult(null))},Oae(pa){ea.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages HttpStatus [${pa.data.httpStatus}]`);I.setResult(null)},qce:Wf.e(I.task)}}function t(I,pa){if(Object(xb.c)(I)||jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&I.isMobileMode)return!0;I=pa.worksheetState;return!!pa.hostState.errorState||I.isInNamedSheetView||I.isProtected}function l(I){if(!I)return!1;I=I.sheetProcessedData;return Object(Je.d)(I)||
"PartialResult"===(null===I||void 0===I?void 0:I.reason)?!1:!0}function x(I){return Object(Dh.f)(I.name)}function A(){const I=new EventTarget;return{addEventListener:function(pa,lb,hc){I.addEventListener(pa,Xc=>{lb(Xc)},{signal:null===hc||void 0===hc?void 0:hc.signal,once:null===hc||void 0===hc?void 0:hc.once})},dispatchEvent:function(pa,lb){I.dispatchEvent(new CustomEvent(pa,{detail:lb}))}}}function z(I){const pa=new ej.a;pa.Oh=4;Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?(I=CommonUiStrings.AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUiStrings.AppsForOfficeDeveloperManifestUrl,I)+CommonUiStrings.AppsforOfficeLoadManifestUrl,pa.xW(CommonUiStrings.AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,I,cm)):(I=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,I)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,pa.xW(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,I,cm))}a.r(m);var F={};a.r(F);
a.d(F,"EwaAccessTokenExpirationManager",function(){return Hd});var D={};a.r(D);a.d(D,"AutoAdjustColumnsManager",function(){return Ta});var G={};a.r(G);a.d(G,"RenameFileManager",function(){return gc});var Q={};a.r(Q);a.d(Q,"BlockPrefetcher",function(){return oe});var O={};a.r(O);a.d(O,"CalcInterfaceAdapter",function(){return of});var J={};a.r(J);a.d(J,"CalcManager",function(){return nb});var H={};a.r(H);a.d(H,"DataCleansingHostManager",function(){return Wc});var N={};a.r(N);a.d(N,"EnrichmentTaskPane",
function(){return Kf});var L={};a.r(L);var Z={};a.r(Z);a.d(Z,"ExtendedTooltipsManager",function(){return yg});var ba={};a.r(ba);a.d(ba,"FilteredResultsStatusBarManager",function(){return ch});var K={};a.r(K);a.d(K,"FirstRunExperienceManager",function(){return Rg});var E={};a.r(E);a.d(E,"HeaderSnappingFeature",function(){return Va});var U={};a.r(U);a.d(U,"InProductMessagingManagerFactory",function(){return wf});var X={};a.r(X);a.d(X,"InstantaneousSupportInformationManager",function(){return Sf});var ia=
{};a.r(ia);a.d(ia,"LineageCatchUpExperimentManager",function(){return dh});var Ma={};a.r(Ma);a.d(Ma,"LineageTeachingCalloutTriggerManager",function(){return lc});var qa={};a.r(qa);a.d(qa,"NavigationFailHandler",function(){return md});var Ha={};a.r(Ha);a.d(Ha,"NetworkConnectionStateManager",function(){return sh});var ha={};a.r(ha);var La={};a.r(La);a.d(La,"ProactiveSuggestionDebugToolsManager",function(){return va});var fa={};a.r(fa);a.d(fa,"ProactiveSuggestionManager",function(){return mb});var ja=
{};a.r(ja);a.d(ja,"ReactTaskPaneManager",function(){return eb});var ta={};a.r(ta);a.d(ta,"SdxManifestPrefetcher",function(){return gd});var Ka={};a.r(Ka);a.d(Ka,"SharedUIControlsFactory",function(){return Qh});var Ga={};a.r(Ga);a.d(Ga,"SheetProcessedDataPrefetcher",function(){return Rh});var Na={};a.r(Na);a.d(Na,"StatusBarAggregateManager",function(){return Xi});var cb={};a.r(cb);a.d(cb,"ThemesManager",function(){return ni});var jb={};a.r(jb);a.d(jb,"UnifiedConsentAdapter",function(){return kj});
var Sa={};a.r(Sa);a.d(Sa,"ViewportObserver",function(){return Md});var bb={};a.r(bb);a.d(bb,"ViewportTelemetryManager",function(){return gf});var oa={};a.r(oa);a.d(oa,"ZoomEventManager",function(){return Eh});var ka={};a.r(ka);a.d(ka,"ZoomManager",function(){return mj});var ya={};a.r(ya);a.d(ya,"FullScreenStatusBarManager",function(){return Ri});var Oa={};a.r(Oa);a.d(Oa,"FileMenuInfoCommandHandler",function(){return ab});var za=a(0),ea=a(15),Aa=a(6),ub=a(85),rb=a(299);class Ja{constructor(){this.iZe=
this.Dkd=!1;this.w5a=()=>{rb.a.instance.wke(this.w5a);ea.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.h6i()};this.yrg=()=>{rb.a.instance.vke(this.yrg);this.iZe||this.Dkd||(ea.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.iZe=!0,this.fTk())};const I=Aa.AFrameworkApplication.accessTokenTtl;0>=I||(this.accessTokenTtl=I,ea.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:Aa.AFrameworkApplication.DR}),rb.a.instance.Eqd(this.w5a),rb.a.instance.Cqd(this.yrg))}h6i(){this.Dkd||(Aa.AFrameworkApplication.cE(ub.a.o8b),this.Dkd=!0,this.eTk())}oqd(){throw Error("Method not implemented.");}OGg(){throw Error("Method not implemented.");}}Object(za.a)(Ja,"ASessionExpirationManager",null,[]);var Xa=a(95),Y=a(41),Ia=a(36),$a=a(12),Ea=a(43),Lb=a(287),Ib=a(8),Mb=a(93),mc=a(292),jc=a(75),Fc=a(92),Gc=a(5),xc=a(215),Uc=a(144),Pa=a(186),
Bb=a(154),Nb=a(361);class oc{}Object(za.a)(oc,"Error",null,[]);class aa{}Object(za.a)(aa,"NamedResult",null,[]);class rc extends aa{}Object(za.a)(rc,"ErrorInfo",aa,[]);class yb{}yb.ymc="ActivityDuration";yb.error="Error";yb.CFd="Errors";yb.failed="Failed";yb.nyi="FirstActivity";yb.initialized="Initialized";yb.twj="LastActivity";yb.kKg="RetryOverride";yb.xtk="RequestGroups";yb.requests="Requests";yb.responses="Responses";yb.JYc="SessionDuration";yb.status="Status";yb.success="Success";yb.successful=
"Successful";yb.tokens="Tokens";Object(za.a)(yb,"SessionExpirationStrings",null,[]);var Fb=a(129);class Qb{constructor(I){this.Ix={};this.A9={};this.Xrh={};this.k$f=15;this.hRe=!1;this.Jth=new Date;this.Lhc=new Date;this.Rah=()=>{ea.ULS.sendTraceTag(41964821,217,50,ea.ULS.Di({["Aggregate"]:this.A9,["Current"]:this.Ix}))};this.vk=I;this.plc=new Fb.a(2,2,6E4*this.k$f,this.Rah,135,"SL",!1);this.vk.lm(this.plc);this.Wdj()}Wdj(){this.A9[yb.xtk]=0;this.A9[yb.requests]=0;this.A9[yb.responses]=0;this.A9[yb.status]=
yb.initialized;this.A9[yb.nyi]=new Date;this.A9[yb.JYc]=0;this.A9[yb.ymc]=0;this.A9[yb.JYc]=0;this.Ix[yb.JYc]=0;this.A9[yb.ymc]=0;this.Ix[yb.ymc]=0}cUd(I,pa){var lb=I[pa];lb=lb?lb:0;lb++;I[pa]=lb;this.wqe(I)}wqe(I){const pa=new Date;I[yb.ymc]=+pa-+this.Lhc;this.Lhc=pa;I[yb.JYc]=+this.Lhc-+this.Jth;I[yb.twj]=this.Lhc}dda(I,pa){this.Ix[I]=pa;this.wqe(this.Ix)}Zpe(I,pa){this.Ix[I]=pa;this.wqe(this.Ix)}incrementCounter(I){this.cUd(this.Ix,I);this.cUd(this.A9,I);this.cUd(this.Xrh,I)}flush(){this.hRe||
(this.A9[yb.status]=this.Ix[yb.status],this.Rah(this.plc),this.vk.Sca(this.plc,6E4*this.k$f))}stop(){ea.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.hRe=!0;this.vk.Ux(this.plc)}}Object(za.a)(Qb,"SessionLogger",null,[365]);class ac{constructor(I,pa){this.Clc=I;this.cU=pa}get tokens(){return this.Clc}get errors(){return this.cU}}Object(za.a)(ac,"TokenRefreshArgs",null,[247]);var Wa=a(108),Gb=a(614),Ub=a(541),Ra=a(191),Rb=a(397),ib=a(135),la=a(1086),
db=a(363),$b=a(285),Ic=a(1098),Tc=a(670);class Zc{constructor(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf,hg){hc=void 0===hc?null:hc;Xc=void 0===Xc?!1:Xc;Gd=void 0===Gd?null:Gd;ae=void 0===ae?!1:ae;we=void 0===we?!1:we;Re=void 0===Re?!1:Re;lf=void 0===lf?!1:lf;hg=void 0===hg?!1:hg;this.nla=0;this.o4=this.Fq=null;this.Clc=new xc.a;this.cU=new xc.a;this.kt=null;this.SEa=!1;this.DHb=this.EHb=null;this.Ltk=()=>{this.IIg()};Object(Ic.a)()||(this.vk=I,this.BWe=pa,this.BWe.execute(Wg=>{Wg.pq(ib.a.lTd,Object(Uc.a)(this,
this.wWj,"onHostResponseReceived"))}),this.qR=lb,this.q0e=new la.a("WebServiceCall","TokenRefresh"),this.Gr=hc||new Qb(I),this.Eth=Xc,this.pX=Gd?Gd:Gb.SessionStatusManager.instance,this.FMe=ae,this.Pfc=we,this.Qth=Re,this.Rth=lf,this.BZe=hg,this.Sbb=Tc.a.getInstance({Lma:"wwrelfc",featureName:"TokenRefreshManager",Yfb:"Infrastructure"}))}wWj(I){if(I.MessageId!==ib.a.lTd)ea.ULS.sendTraceTag(39408099,217,15,"Unexpected message.");else{var pa=new xc.a,lb=new xc.a;this.Gr.incrementCounter(yb.responses);
var hc=I.Values[Rb.a.TOg];if(!hc||0>=hc.length)ea.ULS.sendTraceTag(40122317,217,15,"Found no tokens in the dictionary"),hc=I.Values;this.Gr.dda("Correlation",I.CorrelationId);var Xc="";for(let Re=0;Re<hc.length;Re++){this.Gr.Zpe(yb.tokens,hc.length);var Gd=hc[Re],ae=Gd;if(ae&&ae.Name){this.Gr.incrementCounter(ae.Name);var we=Gd;if(we&&we.Value)pa.add(we),this.Clc.add(we),this.Pfc||this.Gr.dda(yb.status,yb.success),this.FMe&&this.pX&&this.pX.Euk();else{if(this.sUg){we=Gd;Gd=Object.assign(new rc,{Name:we.Name,
Errors:[],SPCorrelationId:we.SPCorrelationId});for(const lf of we.Errors)we=new oc,we.Id=lf.Id,we.Details=Ub.a.FKa(lf.Details,500),Gd.Errors.push(we)}else Gd=this.eXi(Gd);ea.ULS.sendTraceTag(39408129,217,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ae.Name,JSON.stringify(Gd),this.o4);lb.add(Gd);this.Pfc||(this.cU.add(Gd),Xc=JSON.stringify(Gd),this.Gr.dda(yb.error,JSON.stringify(Gd)),this.Gr.dda(yb.status,yb.failed));if(this.FMe)for(const lf of Gd.Errors){if(this.sUg)if(ae=
ub.a.o8b,Gd=parseInt(lf.Id),we=lf.Details.toString(),isNaN(Gd))ae=ub.a.tah;else{switch(Gd){case 401:ae=ub.a.wah;b()&&c(we)?ae=ub.a.e6c:e()&&we.includes("GatekeeperCookieMismatch")&&(ae=ub.a.d6c);break;case 403:ae=ub.a.qah;b()&&c(we)?ae=ub.a.e6c:e()&&we.includes("GatekeeperCookieMismatch")&&(ae=ub.a.d6c);break;case 404:Aa.AFrameworkApplication.ea&&Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdatePermanentErrorList",!1)&&(ae=ub.a.sah);break;case 500:ae=ub.a.rah;break;
case 503:ae=ub.a.vah}ae===ub.a.o8b&&(ae=500<Gd?ub.a.uah:ub.a.pah)}else ae=this.bMi(lf);this.pX&&this.pX.IBh(ae)}}}}this.Pfc?(0<lb.count?this.DHb?this.DHb(new ac(pa,lb)):ea.ULS.sendTraceTag(512267295,217,15,"Received errors but the promise has completed.TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}, Error: {3}",this.o4,this.pX.RHc,this.SEa.toString(),Xc):this.EHb?this.EHb(new ac(pa,lb)):ea.ULS.sendTraceTag(512267294,217,15,"Received valid tokens but the promise has completed. TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}",
this.o4,this.pX.RHc,this.SEa.toString()),ea.ULS.sendTraceTag(512344162,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",pa.count,lb.count,I.CorrelationId,this.o4)):(0<lb.count&&""!==Xc?(hc=Object.assign({},{extendedProperties:new Map}),hc.extendedProperties.set("Errors",Xc),hc.extendedProperties.set("RetryCount",this.nla.toString()),hc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),hc.extendedProperties.set("IsTokenExpiring",
this.SEa.toString()),hc.extendedProperties.set("IsAppShuttingDown",Aa.AFrameworkApplication.Vl.toString()),this.lyb?(hc.extendedProperties.set("SkipAria","false"),hc.extendedProperties.set("TokenRefreshCorrelationId",I.CorrelationId),this.Sbb.hpa({Jw:"WACTokenRefresh",errorName:"TokenRefreshFailed",Bk:{pYd:!1,isInternal:!1,wR:hc}})):Wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,hc)):this.lyb?(Xc=Object.assign({},{extendedProperties:new Map}),Xc.extendedProperties.set("SkipAria",
"false"),Xc.extendedProperties.set("TokenRefreshCorrelationId",I.CorrelationId),this.Sbb.OMa({Jw:"WACTokenRefresh",Bk:{wR:Xc}})):Wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),ea.ULS.sendTraceTag(39408130,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",pa.count,lb.count,I.CorrelationId,this.o4),0<lb.count&&!this.fYb(lb)?(I=this.qR.jMf(lb),I!==this.qR.qwb&&(this.Gr.Zpe(yb.kKg,I),this.vk.Sca(this.Fq,I))):(this.Gr.flush(),this.Fq&&this.vk.Ux(this.Fq),
this.kt&&!this.kt.task.isCompleted?this.kt.setResult(new ac(pa,lb)):ea.ULS.sendTraceTag(512267293,217,15,"Received results but the task has completed")))}}eXi(I){if(!I)return null;const pa=Object.assign(new rc,{Name:I.Name,Errors:[],SPCorrelationId:I.SPCorrelationId});for(const lb of I.Errors)I=new oc,I.Id=lb.Id,I.Details=Ub.a.FKa(lb.Details,500),pa.Errors.push(I);return pa}IIg(){$b.a.GA("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");if(this.nla>=this.qR.ndg)ea.ULS.sendTraceTag(39408132,
217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.o4),this.Ulf(this.kt,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts");else{var I=Ra.a.create().toString();if(this.lyb){const pa=new Map;pa.set("SkipAria","false");pa.set("TokenRefreshCorrelationId",I);this.Sbb.Wba({Jw:"WACTokenRefresh",wqb:db.b.SuccessBased,Bk:{extendedProperties:pa}})}else Wa.Health.instance.recordKpiUsage("WACTokenRefresh",db.b.SuccessBased,"wwrelfc",
null);this.bOg(I)}}bOg(I){const pa={};pa[Rb.a.TOg]=this.qR.tokens;this.Qth&&(pa[Rb.a.vDk]=this.Rth);ea.ULS.sendTraceTag(39408133,217,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.qR.tokens),this.nla+1,I,this.o4);this.BWe.execute(lb=>{lb.sendMessage(ib.a.E8e,pa,I)});this.nla++;this.Gr.incrementCounter(yb.requests)}Ulf(I,pa,lb){const hc=new xc.a;for(let Xc=0;Xc<this.qR.tokens.length;Xc++){const Gd=Object.assign(new rc,{Name:this.qR.tokens[Xc],Errors:[Object.assign(new oc,
{Id:pa,Details:lb})]});hc.add(Gd);this.cU.add(Gd)}this.vk.Ux(this.Fq);this.Gr.dda(yb.CFd,JSON.stringify(this.cU));this.Gr.dda(yb.status,yb.failed);I&&!I.task.isCompleted&&I.setResult(new ac(new xc.a,this.cU))}Yik(I,pa){pa=void 0===pa?null:pa;$b.a.GA("ej4if276;fheca743");$b.a.GA("5d4fi128;abe10395");$b.a.GA("7db39907;cegi0367;ijicc640");this.q0e.start();this.vk.D0a&&(ea.ULS.sendTraceTag(508351137,217,15,"Restarting taskmanager, is shutting down {0}",Aa.AFrameworkApplication.Vl),this.vk.Y6b());this.SEa=
I;this.o4=Ra.a.create().toString();ea.ULS.sendTraceTag(41755338,217,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.o4,this.SEa);this.nla=0;this.cU.clear();this.Clc.clear();const lb=new Pa.a;this.kt=lb;pa&&pa.R(()=>{const hc=!!lb&&!lb.task.isCompleted;ea.ULS.sendTraceTag(588096223,217,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.o4,this.SEa,hc);hc&&this.Ulf(lb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});
this.Pfc?this.JIg(this.qR.ndg).then(hc=>{this.kt&&!this.kt.task.isCompleted&&this.kt.setResult(hc);this.DHb=this.EHb=null;this.Gr.dda(yb.CFd,JSON.stringify(this.cU));this.Gr.dda(yb.status,yb.success);this.Gr.flush()}).catch(hc=>{this.kt&&!this.kt.task.isCompleted&&this.kt.setResult(Object(Bb.a)(247,hc));this.DHb=this.EHb=null;this.Gr.dda(yb.CFd,JSON.stringify(this.cU));this.Gr.dda(yb.status,yb.failed);this.Gr.flush()}):(this.Fq=new Fb.a(this.qR.priority,2,this.qR.qwb,this.Ltk,98,ib.a.E8e,!0),this.Eth&&
this.IIg(),this.vk.lm(this.Fq));return this.kt.task}JIg(I){const pa=this,lb=Ra.a.create().toString(),hc=new Promise((Re,lf)=>{pa.EHb=Re;pa.DHb=lf;this.lyb?(Re=new Map,Re.set("SkipAria","false"),Re.set("TokenRefreshCorrelationId",lb),this.Sbb.Wba({Jw:"WACTokenRefresh",wqb:db.b.SuccessBased,Bk:{extendedProperties:Re}})):Wa.Health.instance.recordKpiUsage("WACTokenRefresh",db.b.SuccessBased,"wwrelfc",null);pa.bOg(lb)}),Xc=this,Gd=new Promise((Re,lf)=>{window.setTimeout(()=>{lf(Xc.$lf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},
Xc.qR.qwb)});let ae=I;const we=this;return new Promise((Re,lf)=>{ae--;Promise.race([hc,Gd]).then(hg=>{if(this.lyb){const Wg=Object.assign({},{extendedProperties:new Map});Wg.extendedProperties.set("SkipAria","false");Wg.extendedProperties.set("TokenRefreshCorrelationId",lb);this.Sbb.OMa({Jw:"WACTokenRefresh",Bk:{wR:Wg}})}else Wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Re(hg)}).catch(hg=>{var Wg=we.qR.qwb;if(Object(Nb.a)(247,hg)&&(hg=Object(Bb.a)(247,hg),0<hg.errors.count)){we.fBj(hg.errors,
lb);we.qz(hg.errors);if(we.fYb(hg.errors)){lf(hg);return}const mg=we.qR.jMf(hg.errors);mg!==we.qR.qwb?(we.Gr.Zpe(yb.kKg,mg),Wg=mg):we.Otj(hg.errors)&&(Wg=0)}ae?window.setTimeout(()=>{we.JIg(ae).then(Re).catch(lf)},Wg):(Wg=we.$lf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),we.qz(Wg.errors),lf(Wg),ea.ULS.sendTraceTag(512267292,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",we.o4))})})}qz(I){for(const pa of I)this.cU.add(pa)}Otj(I){if(!I.count)return!1;
I=I.ma(I.count-1);return I.Errors.length?"TIMEOUT"==I.Errors[0].Id:!1}$lf(I,pa){const lb=new xc.a;for(let hc=0;hc<this.qR.tokens.length;hc++){const Xc=this.f7h(this.qR.tokens[hc],I,pa);lb.add(Xc)}return new ac(new xc.a,lb)}f7h(I,pa,lb){return Object.assign(new rc,{Name:I,Errors:[Object.assign(new oc,{Id:pa,Details:lb})]})}fBj(I,pa){if(I.count){I=I.ma(I.count-1);I=JSON.stringify(I);var lb=Object.assign({},{extendedProperties:new Map});lb.extendedProperties.set("Errors",I);lb.extendedProperties.set("RetryCount",
this.nla.toString());lb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());lb.extendedProperties.set("IsTokenExpiring",this.SEa.toString());lb.extendedProperties.set("IsAppShuttingDown",Aa.AFrameworkApplication.Vl.toString());this.lyb?(lb.extendedProperties.set("SkipAria","false"),lb.extendedProperties.set("TokenRefreshCorrelationId",pa),this.Sbb.hpa({Jw:"WACTokenRefresh",errorName:"TokenRefreshFailed",Bk:{wR:lb}})):Wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",
!1,!1,lb);this.Gr.dda(yb.error,I);this.Gr.dda(yb.status,yb.failed)}}rck(I){this.q0e.stop();const pa=this.n7i(I.result.errors);ea.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!pa,this.o4,this.SEa,this.nla,this.cU.count,0<I.result.errors.count?I.result.errors.ma(0).Name:"",0<I.result.errors.count&&0<I.result.errors.ma(0).Errors.length?I.result.errors.ma(0).Errors[0].Id:
"",0<I.result.errors.count&&0<I.result.errors.ma(0).Errors.length?I.result.errors.ma(0).Errors[0].Details:"");return pa?!1:this.qck(I.result.tokens)}fYb(I){return this.qR.fYb(I)}qck(I){for(let pa=0;pa<I.count;pa++){const lb=I.ma(pa);if(lb.Name===Rb.a.accessToken){const hc=(new Date).getTime();lb.Expiry>Aa.AFrameworkApplication.accessTokenTtl?(ea.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:lb.Expiry,["NowGetTime"]:hc,["BootTime"]:Aa.AFrameworkApplication.DR},"PreviousAccessTokenTtl",
Aa.AFrameworkApplication.accessTokenTtl),Aa.AFrameworkApplication.accessToken=lb.Value,Aa.AFrameworkApplication.accessTokenTtl=Math.floor(lb.Expiry),Aa.AFrameworkApplication.uab=hc,Aa.AFrameworkApplication.Ala=Math.floor(lb.Expiry)):ea.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:lb.Expiry,["NowGetTime"]:hc,["BootTime"]:Aa.AFrameworkApplication.DR},"PreviousAccessTokenTtl",Aa.AFrameworkApplication.accessTokenTtl)}}return!0}n7i(I){let pa=
!1;for(let lb=0;lb<I.count;lb++){pa=!0;const hc=I.ma(lb);ea.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",hc.Name,JSON.stringify(hc.Errors),this.o4,hc.SPCorrelationId)}return pa}N4f(I){return I.includes("aadInteractionRequired")||I.includes("sessionRevocation")||I.includes("blockAccessForTenantRestrictions")||I.includes("revoked")||I.includes("Due to organizational policies, you can't access these resources from this network location")?
!0:!1}k0f(I){return I.includes("GatekeeperCookieMismatch")}bMi(I){let pa=ub.a.o8b;const lb=parseInt(I.Id);I=I.Details.toString();if(isNaN(lb))pa=ub.a.tah;else{switch(lb){case 401:pa=ub.a.wah;this.BZe&&this.N4f(I)?pa=ub.a.e6c:this.GTg&&this.k0f(I)&&(pa=ub.a.d6c);break;case 403:pa=ub.a.qah;this.BZe&&this.N4f(I)?pa=ub.a.e6c:this.GTg&&this.k0f(I)&&(pa=ub.a.d6c);break;case 404:this.Fte&&(pa=ub.a.sah);break;case 500:pa=ub.a.rah;break;case 503:pa=ub.a.vah}pa===ub.a.o8b&&(pa=500<lb?ub.a.uah:ub.a.pah)}return pa}get lyb(){return null!=
this.zHe?this.zHe:this.zHe=Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseNewKPIApiForTokenRefresh",!1):!1}get sUg(){return null!=this.uHe?this.uHe:this.uHe=Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldRefactorProcessingTokenRefreshError",!1):!1}get GTg(){return null!=this.tHe?this.tHe:this.tHe=Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAttributeGatekeeperCookieMismatch",
!1):!1}get Fte(){return null!=this.xHe?this.xHe:this.xHe=Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdatePermanentErrorList",!1):!1}}Object(za.a)(Zc,"TokenRefreshManager",null,[248]);class cc{constructor(){this.qwb=Aa.AFrameworkApplication.Ygl;this.ndg=Aa.AFrameworkApplication.Wgl;this.tokens=Aa.AFrameworkApplication.J1i();this.priority=Aa.AFrameworkApplication.JDe;this.PXe=this.iIk();this.Beb=Aa.AFrameworkApplication.I1i()}fYb(I){if(this.PPk){var pa=
[];for(const hc of I)if(hc.Errors)for(const Xc of hc.Errors)pa.push(Xc.Id);I=JSON.stringify(pa);if(this.Beb&&0<this.Beb.length)for(var lb of this.Beb)if(0<lb.length&&0<=I.indexOf(lb))return!0}else if(lb=JSON.stringify(I),this.Beb&&0<this.Beb.length)for(pa of this.Beb)if(0<pa.length&&0<=lb.indexOf(pa))return!0;return!1}jMf(I){try{if(I)for(const pa of I)if(pa.Errors)for(const lb of pa.Errors)if(lb.Id in this.PXe)return Number.parseInvariant(this.PXe[lb.Id].toString())}catch(pa){ea.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",pa.toString())}return this.qwb}iIk(){const I={};try{if(!Aa.AFrameworkApplication.KDc()||0>=Aa.AFrameworkApplication.KDc().length||""===Aa.AFrameworkApplication.KDc()[0])return I;for(const pa of Aa.AFrameworkApplication.KDc())0<pa.length&&(I[pa]=Aa.AFrameworkApplication.Xgl)}catch(pa){ea.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",pa.toString())}return I}get PPk(){return null!=
this.yHe?this.yHe:this.yHe=Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseErrorsForParsingPermanentErrors",!1):!1}}Object(za.a)(cc,"TokenRefreshPolicy",null,[246]);var Yc=a(2),Vc=a(79),wd=a(788),wc=a(33);class Ya{constructor(I,pa){this.p5b=!1;this.correlationID=I;this.cBd=pa;this.P2c=!1;this.creationTime=wc.a.kh.vi}}Object(za.a)(Ya,"RefreshAccessTokenContext",null,[]);var ob=a(61),Cb=a(64),Wb=a(187),ad=a(54),$c=a(134),Ld=a(147),
jd=a(1),Td=a(28),re=a(172),Nd=a(38),uc=a(115);class pc{constructor(I,pa){this.documentVisibilityObserver=null;this.eh=new Y.a;this.pM=null;this.J9a=this.vdb=!1;this.GUc=null;this.x5b=!1;this.K4d=!0;this.Afd=this.qRe=this.DE=this.BHb=!1;this.I3=null;this.v2g=this.iKd=this.Dyc=this.Vl=!1;this.ZQf=()=>{if(this.$.fa.ki)this.wRf(!1);else if(this.K4d){this.K4d=!1;const lb=jc.a(this.$);ea.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${lb.aq?
lb.aq.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.R1g()}]`)}};this.hj=(lb,hc)=>{this.context&&(lb=this.$.fa,hc.fN&&this.context.p5b&&!this.context.P2c?(this.context.P2c=!0,hc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},hc.IsUserActive=lb.Jl.yv,hc.RefreshAccessTokenCorrelationID=this.context.correlationID,hc=ob.a.Di(hc),ea.ULS.sendTraceTag(537170708,0,50,hc)):!this.vdb||lb.ki||this.context.cBd||(hc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
this.pM&&(this.pM.cancel(),hc.Aborted=!0,hc.ResetStopRefreshRetriesUntilTokenExpired=!0,this.J9a=!1),hc.TimeUntilTokenExpirationInMin=this.R1g(),hc.RefreshAccessTokenCorrelationID=this.context.correlationID,hc=ob.a.Di(hc),ea.ULS.sendTraceTag(572019856,0,50,hc)))};this.TNa=()=>{if(this.context&&this.context.p5b&&!this.context.P2c){var lb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};lb.CreatedForExpired=this.context.cBd;lb.RefreshAccessTokenCorrelationID=this.context.correlationID;
lb.OpenWorkbookErrors=Ia.a.fi(this.$.fa.eQ);lb.ExecutionContextErrors=Ia.a.fi(jc.a(this.$).yj.errors);lb.accesstokenTTL=Aa.AFrameworkApplication.accessTokenTtl;lb=ob.a.Di(lb);ea.ULS.sendTraceTag(537170707,0,15,lb)}};this.vRf=()=>{this.J9a=!1;this.wRf(!0)};this.Qbe=()=>{this.x5b&&(this.$.fa.Jl.lPa(this.Qbe),this.x5b=!1);this.hZg()};this.$=I;this.Mye=pa;this.hie=I.Eh.wm("WebServiceCall","refreshToken");rb.a.instance.Eqd(this.vRf);rb.a.instance.Cqd(this.ZQf);pa=this.$.fa;pa.Nq(this.hj);pa.Nnc(this.TNa);
this.THj=this.$.ua.MinTokenLifetimeForRegularExpirationPromptInMin;this.wTg=this.$.ua.ShortAccessTokenExpirationPromptSeconds;this.nDg=this.$.ua.RefreshAccessTokenDurationLimitInSec;this.u8g(I.fa.Tug,Aa.AFrameworkApplication.accessTokenTtl);I=JSON.stringify({["AccessTokenTtl"]:Aa.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:Aa.AFrameworkApplication.DR,["WopiTokenExpiresAfterMinutes"]:Aa.AFrameworkApplication.uDa,["WopiTokenTaskItemPriority"]:Aa.AFrameworkApplication.JDe});
ea.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${I}`);jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Fc.a.resolve(Gc.Db).then(lb=>{this.documentVisibilityObserver=lb}):this.$.qa.zi(291,lb=>{this.documentVisibilityObserver=lb})}zJg(){this.J9a=this.vdb=this.Afd=this.DE=!1;uc.a.cia=0;uc.a.hZ=0;uc.a.iZ=0}mqd(I){this.eh.addHandler("SessionExpired",I)}uua(I){this.eh.addHandler("TokenRefreshed",I)}Nvb(I){this.eh.removeHandler("TokenRefreshed",
I)}oqd(){}OGg(){}get Kye(){return this.BHb}get Nba(){return this.qRe}get UY(){return this.Afd}get context(){return this.I3}get Vxb(){return this.UY?!1:this.$.fa.Jl.yv?1>uc.a.hZ:6>uc.a.iZ}get qvb(){return this.vdb}EEc(){return rb.a.instance.mN(Aa.AFrameworkApplication.accessTokenTtl)}dispose(){rb.a.instance.wke(this.vRf);rb.a.instance.vke(this.ZQf);const I=this.$.fa;I&&(I.Lq(this.hj),I.QVc(this.TNa));Xa.a.gh(this.eh);this.documentVisibilityObserver=this.$=null}R1g(){return this.EEc()?0:(Aa.AFrameworkApplication.accessTokenTtl-
(new Date).getTime())/6E4}u8g(I,pa){if(0<pa&&!this.EEc()){const lb=Aa.AFrameworkApplication.ea.Ij("AccessTokenExpirationPromptSeconds",Aa.AFrameworkApplication.pU),hc=(pa-I.getTime())/6E4;ea.ULS.shipAssertTag(537170713,0,0<=hc,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${pa}] creationTime [${I.getTime()}] tokenLifetimeInMin [${hc}]`);hc<this.THj?(ea.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.wTg}] tokenLifetimeInMin [${hc}]`),
Aa.AFrameworkApplication.pU=this.wTg):Aa.AFrameworkApplication.pU!==lb&&(ea.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${lb}] tokenLifetimeInMin [${hc}]`),Aa.AFrameworkApplication.pU=lb)}}n5h(I){return!this.context||this.context.p5b||this.context.cBd!==I?(I=new Ya(Ra.a.create().toString(),I),this.context&&!this.context.P2c&&ea.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${I.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.p5b}] `),
this.I3=I,!0):!1}guk(I){I&&this.DE&&!this.Nba&&this.$.fa.Jl.yv&&!this.UY&&(this.DE=!1)}wRf(I){this.guk(I);if(!(this.vdb||this.J9a&&!I||this.DE)&&this.Vxb){this.vdb=!0;var pa=this.context?this.context.creationTime:null,lb=this.n5h(I);this.K4d=!0;var hc=this.$.fa;this.Vl=Aa.AFrameworkApplication.Vl;var Xc={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Xc.newContextCreated=lb;Xc.IsUserActive=hc.Jl.yv;Xc.IsSessionActive=hc.ki;Xc.ContainsChangesWorkbookOperations=this.$.userOperationManager.PXa();
Xc.isSessionExpired=I;Xc.stopRefreshRetriesUntilTokenExpired=this.J9a;Xc.FailedToRefreshExpiredToken=this.DE;Xc.numOfFailuresWhileUserIsActive=uc.a.hZ;Xc.numOfFailuresWhileUserIsInActive=uc.a.iZ;Xc.numOfFailuresWhileOffline=uc.a.cia;Xc.RefreshAccessTokenCorrelationID=this.context.correlationID;Xc.isShuttingDown=this.Vl;lb&&pa&&(Xc.TimeInMinFromPreviosContextCreation=Math.round(Ld.b(wc.a.kh,pa)/60));pa=ob.a.Di(Xc);ea.ULS.sendTraceTag(40416199,0,50,pa);if(this.Vl)ea.ULS.sendTraceTag(508126686,0,15,
pa);else{this.hie.start();this.qRe=hc.Jl.yv;this.pM=new wd.a;this.syj(I);var Gd=this.Mye.Yik(!I,this.pM?this.pM.token:null);Gd.continueWith(()=>{this.tYh();const ae=this.Mye.rck(Gd);this.hie.stop();const we=this.EEc();if(!ae||jd.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&we){const Re=Gd.result.errors;ae&&we&&this.hzh(Re);this.I5i(Re,I)}else this.J9a=!1,this.O5i(Gd.result.tokens,I);this.vdb=!1},8)}}}hzh(I){const pa=[Object(Yc.a)(new oc,{Id:"200",Details:"Expired access token received on successful token request."})];
I.add(Object(Yc.a)(new rc,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:pa}))}syj(I){I&&(this.$.fa.Jl.yv?this.hZg():(this.$.fa.Jl.CGa(this.Qbe),this.x5b=!0))}hZg(){this.GUc=Wb.AsyncMethodContext.AC(()=>{this.Xik()},1E3*this.nDg,ad.a.Bik,this.GUc)}tYh(){this.GUc&&this.GUc.cancel();this.x5b&&(this.$.fa.Jl.lPa(this.Qbe),this.x5b=!1);this.pM=null}Xik(){ea.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.nDg}]`);
this.pM.cancel()}I5i(I,pa){this.J9a=!0;pa&&(this.DE||(this.BHb=this.DE=!0),this.Mye.fYb(I)&&(this.Afd=!0));const lb=!pa||this.Vxb&&!uc.a.r_c?40380379:39982555;pa=this.Olf(pa);pa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";pa.FailedToRefreshExpiredToken=this.DE;pa.LastErrorIsPermanent=this.UY;if(0<I.count){var hc=I.ma(0);pa.errorName=hc.Name;0<hc.Errors.length&&(pa.ErrorId=hc.Errors[0].Id,hc=hc.Errors[0].Details,pa.ErrorDetails=this.Kii(hc.toString())?"PiiScrubbed":hc)}pa=ob.a.Di(pa);
ea.ULS.sendTraceTag(lb,0,15,pa);if(0<I.count){this.Dyc=!1;for(const Xc of I)if(Xc.Errors)for(const Gd of Xc.Errors)"GatekeeperCookieMismatch"===Gd.Details&&(this.iKd=!0),"403"===Gd.Id&&(this.Dyc=!0)}this.eh.raiseEvent("TokenRefreshed",new ac(null,I))}Kii(I){return Td.a.contains(I,"makes the internet safe for businesses",!0)}Olf(I){const pa={},lb=this.$.fa;pa.Name="";pa.IsUserActive=lb.Jl.yv;pa.IsSessionActive=lb.ki;pa.GotDeploymentOrTimedOutError=lb.Waa;pa.TimeInSecFromLastStatefulSuccessfulRequest=
lb.h9;pa.TimeFromLastUserActivityInMs=lb.Jl.pzb;pa.calledFromSessionExpiredFlow=I;pa.RefreshTokenDurationInMS=this.hie.Ci;pa.numOfFailuresWhileUserIsActive=uc.a.hZ;pa.numOfFailuresWhileUserIsInActive=uc.a.iZ;pa.numOfFailuresWhileOffline=uc.a.cia;pa.RefreshAccessTokenCorrelationID=this.context.correlationID;pa.accessTokenTTL=Aa.AFrameworkApplication.accessTokenTtl;pa.ContainsChangesWorkbookOperations=this.$.userOperationManager.PXa();pa.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Xn.toString():
"Unknown";pa.TimeFromFirstOpenInHr=Math.floor(Ld.b(wc.a.kh,$c.toUtc(lb.Tug))/3600);return pa}O5i(I,pa){this.DE=!1;this.bcl();this.u8g(new Date,Aa.AFrameworkApplication.accessTokenTtl);const lb=this.$.fa,hc=!pa&&lb.Jl.yv,Xc=!this.$.isEditMode&&lb.hvb;pa=this.Olf(pa);pa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";pa.shouldTriggerSilentReloadAfterExpiring=hc;pa.WopiTokenTaskItemPriority=Aa.AFrameworkApplication.JDe;pa.isDirtyViewSession=Xc;pa=ob.a.Di(pa);ea.ULS.sendTraceTag(39982556,
0,15,pa);this.eh.raiseEvent("TokenRefreshed",new ac(I,null));Xc?lb.Jl.yv&&(ea.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),lb.wJd()):lb.Jl.yv?jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateNewUserAccessToken",!1)&&hc&&this.$.isEditMode?ea.ULS.sendTraceTag(507827846,0,50,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: successful token refresh when user is active."):
hc&&(I=jc.a(this.$).yj.activityState,I[uc.a.Mzb]=!0,I[re.a.s$]=!0,I[Nd.a.dA]=this.$.isEditMode,I[Nd.a.yod]=this.$.fa.N1a,Ea.a(this.$).Zy(new Lb.a(Ib.a.Uqa,2,null))):lb.ki&&Cb.k(this.$.oa.ta,!0,!1,!1,null,null,null,null,null)}bcl(){void 0!==this.$.fa.workbookContext.WorkbookUri&&null!==this.$.fa.workbookContext.WorkbookUri?(this.$.fa.workbookContext.WorkbookUri=Vc.a.a0(this.$.fa.workbookContext.WorkbookUri,Aa.AFrameworkApplication.eM,Aa.AFrameworkApplication.accessToken),this.$.fa.workbookContext.WorkbookUri=
Vc.a.a0(this.$.fa.workbookContext.WorkbookUri,Aa.AFrameworkApplication.qU,Aa.AFrameworkApplication.accessTokenTtl.toString()),this.$.fa.zRc()):ea.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ua.AccessToken=Aa.AFrameworkApplication.accessToken;this.$.ua.AccessTokenValidTo=Aa.AFrameworkApplication.accessTokenTtl;void 0!==this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion&&
(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion=Vc.a.a0(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion,Aa.AFrameworkApplication.eM,Aa.AFrameworkApplication.accessToken),this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion=Vc.a.a0(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion,Aa.AFrameworkApplication.qU,Aa.AFrameworkApplication.accessTokenTtl.toString()));void 0!==this.$.ua.EmbedConfiguratorUrl&&null!==this.$.ua.EmbedConfiguratorUrl&&(this.$.ua.EmbedConfiguratorUrl=Vc.a.a0(this.$.ua.EmbedConfiguratorUrl,
Aa.AFrameworkApplication.eM,Aa.AFrameworkApplication.accessToken),this.$.ua.EmbedConfiguratorUrl=Vc.a.a0(this.$.ua.EmbedConfiguratorUrl,Aa.AFrameworkApplication.qU,Aa.AFrameworkApplication.accessTokenTtl.toString()));this.context.p5b=!0}}Object(za.a)(pc,"EwaAccessTokenExpirationRefreshManager",null,[231,232,2]);Object(Fc.b)(Gc.a,{rk:"singleton"})(I=>xo(function*(){const pa=yield Fc.a.resolve(Gc.Ob,I);if(Aa.AFrameworkApplication.ea.ka("RefreshAccessTokenSilently")){const lb=new Zc(Aa.AFrameworkApplication.Np,
Aa.AFrameworkApplication.ND(),new cc);return new pc(pa,lb)}return new Hd(pa)}));class Hd extends Ja{constructor(I){super();this.eh=new Y.a;this.iKd=this.Dyc=this.DE=this.BHb=!1;this.$=I}zJg(){}mqd(I){this.eh.addHandler("SessionExpired",I)}uua(I){this.eh.addHandler("TokenRefreshed",I)}Nvb(I){this.eh.removeHandler("TokenRefreshed",I)}get accessTokenExpiringMessage(){const I=(new Date(this.accessTokenTtl)).format(this.$.ua.ShortTimeFormat);return String.format($a.a.instance.sh(78),I)}get Kye(){return this.BHb}get Vxb(){return!1}get Nba(){return!1}get qvb(){return!1}get UY(){return!1}EEc(){return rb.a.instance.mN(Aa.AFrameworkApplication.accessTokenTtl)}dispose(){Xa.a.gh(this.eh);
this.$=null}fTk(){this.$.isEditMode&&this.ZDc(!1)}eTk(){this.BHb=!0;this.ZDc(!0);this.eh.raiseEvent("SessionExpired")}ZDc(I){ea.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${I}, GotDeploymentOrTimedOutError ${this.$.fa.Waa}`);const pa=this.$.vh.uw;I&&pa&&pa.isVisible&&1299163859===pa.error.MessageId&&this.$.vh.uw.uK();const lb=this.nj(I);Ea.a(this.$).Zy(new Lb.a(Ib.a.JD,5,()=>{const hc=jc.a(this.$),Xc=hc.yj.activityState;Xc[Mb.a.Qea]=
this.$.NKb(this.$.isEditMode);Xc[Mb.a.vX]=Mb.a.dsb;Xc[mc.a.ax]=Ib.a.accessTokenExpiringWarning;hc.yj.qz([lb])}))}nj(I){return jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8691397_RecategorizeAccessTokenExpiredSilentRefreshDisabled")?Ia.a.wnf():I?Ia.a.LAd():this.Z$h()}Z$h(){const I=Ia.a.nj(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");I.Description=this.accessTokenExpiringMessage;return I}}Object(za.a)(Hd,"EwaAccessTokenExpirationManager",Ja,[231,232,2]);var wb=a(127),Xb=a(101),Kb=a(130),Zb=
a(118),Oc=a(23),Cd=a(7),Wd=a(84),ee=a(63),he=a(25),pe=a(364),Se=a(128);let Ta=class{constructor(I,pa){this.ctd=this.uaf=this.dtd=0;this.taf=!1;this.proactiveSuggestionCard=null;this.bib=this.xjf=!1;this.sessionCount=this.autoAdjustColumnWidthSettings=0;this.jM=!1;this.hj=(lb,hc)=>{ea.ULS.sendTraceTag(508363741,0,50,"AutoAdjustColumnsManagerService::onSessionIdChanged detected.");hc.ki?this.initialize():ea.ULS.sendTraceTag(508360707,0,15,"AutoAdjustColumnsManagerService::onSessionIdChanged but session is still not active.");
this.$.fa.Lq(this.hj)};this.y2b=lb=>{if(Ia.a.ll(lb.Errors)){const hc=lb.Errors[0].MessageId;jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")&&-315732528===hc||ea.ULS.sendTraceTag(508641556,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${Ia.a.fi(lb.Errors)}.`)}else lb.Result&&(this.autoAdjustColumnWidthSettings=parseInt(lb.Result,10),this.bib=0!==(this.autoAdjustColumnWidthSettings&3),this.sessionCount=(this.autoAdjustColumnWidthSettings&
65280)>>8),this.jM=2!==(this.autoAdjustColumnWidthSettings&2),this.taf||0!==(this.autoAdjustColumnWidthSettings&2)||(0===this.sessionCount&&(this.bib=!1),this.Faj())};this.fbe=lb=>{lb=Se.a.$j(lb.data);ea.ULS.sendTraceTag(508641555,0,10,`AutoAdjustColumnWidth.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${Ia.a.fi(lb)}.`)};this.d3b=lb=>{Ia.a.ll(lb.Errors)?ea.ULS.sendTraceTag(508641554,0,10,`AutoAdjustColumnWidth.onWriteRoamingStringSuccess: encountered an error. Errors: ${Ia.a.fi(lb.Errors)}`):
lb.Result||ea.ULS.sendTraceTag(508641553,0,10,"AutoAdjustColumnWidth.onWriteRoamingStringSuccess failed to write to roaming service.")};this.VZj=lb=>{if(Ia.a.ll(lb.Errors))ea.ULS.sendTraceTag(508641552,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${Ia.a.fi(lb.Errors)}.`);else{var hc=0;lb.Result&&(hc=parseInt(lb.Result,10));hc=hc&-4|this.autoAdjustColumnWidthSettings&3;this.Tah(hc)}};this.Ojg=()=>{Xb.a("AutoAdjustColumnWidthKeepOn");0===(this.autoAdjustColumnWidthSettings&
1)&&(this.autoAdjustColumnWidthSettings|=1,this.mCg());this.bib=!0;this.proactiveSuggestionCard.hide()};this.UQj=()=>{this.J1h();this.proactiveSuggestionCard.hide()};this.e4j=()=>{Xb.a("AutoAdjustColumnWidthHelp");const lb=new Wd.a(-859308420,ee.a.ph,this.$.ji,9,null);this.$.Ia.qh(lb,{[ee.a.hl]:"HelpID=151880",["InputMethod"]:ee.a.ph,["ShouldCanvasTakeFocus"]:!0,[ee.a.Pi]:Cd.a.NK,[Cd.a.Ara]:!0})};this.jWj=()=>{const lb={};lb[Cd.a.QM]="AutoAdjustColumnWidth";this.$.oi(802602464,ee.a.ph,8,lb)};this.m2j=
()=>{Xb.a("AutoAdjustColumnWidthTurnedOff");this.autoAdjustColumnWidthSettings|=2;this.mCg();this.bib=!0;this.proactiveSuggestionCard.hide();this.jM=!1};this.$=I;this.proactiveSuggestionCard=pa;this.uaf=jd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmThreshold",3);this.ctd=jd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmSessionCycle",3);this.taf=0===this.ctd;!jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")||
this.$.fa.ki?this.initialize():this.$.fa.Nq(this.hj)}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose();this.$=null}initialize(){ea.ULS.shipAssertTag(508641557,0,he.a.toa(),"AutoAdjustColumnWidth feature is off");pe.D(this.$.oa.ta,5,this.y2b,this.fbe,null,null)}Tah(I){pe.K(this.$.oa.ta,5,I.toString(),this.d3b,this.fbe,null,null)}Faj(){if(2!==(this.autoAdjustColumnWidthSettings&2)){var I=this.sessionCount+1;I>=this.ctd&&(I=0);this.Tah(this.autoAdjustColumnWidthSettings&
-65281|I<<8)}}mCg(){pe.D(this.$.oa.ta,5,this.VZj,this.fbe,null,null)}qig(I){if(0===this.dtd){const pa=[];pa.push(Kb.a.gm("Command",I,Zb.g.String));Xb.a("AutoAdjustedColumnWidth",void 0,void 0,pa)}++this.dtd;ea.ULS.shipAssertTag(508641551,0,0===(this.autoAdjustColumnWidthSettings&2),"AutoAdjustedColumns when AutoAdjustColumnWidthSettings is Off");!this.bib&&this.dtd>=this.uaf&&this.I1h()}I1h(){if(null!=this.proactiveSuggestionCard){Xb.a("AutoAdjustColumnWidthDialog");var I=$a.a.instance.Aa(858),pa=
$a.a.instance.Aa(859),lb=$a.a.instance.Aa(860),hc=$a.a.instance.Aa(861),Xc=$a.a.instance.Aa(863);this.proactiveSuggestionCard.show(Oc.f(this.$).ha.pa.oj,I,pa,lb,hc,this.Ojg,this.UQj,this.sCc(),void 0,void 0,"WrapText",void 0,void 0,void 0,void 0,!1,!1,Xc,this.jWj);this.xjf?this.bib=!0:this.xjf=!0}}sCc(){return[{key:"learnMessage",text:$a.a.instance.Aa(862),onClick:this.e4j}]}J1h(){const I=$a.a.instance.Aa(864),pa=$a.a.instance.Aa(865),lb=$a.a.instance.Aa(866),hc=$a.a.instance.Aa(861);this.proactiveSuggestionCard.show(Oc.f(this.$).ha.pa.oj,
I,pa,lb,hc,this.Ojg,this.m2j,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!1,!1,void 0,void 0)}};Ta=Object(wb.__decorate)([Object(Fc.d)(Gc.s),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.df)())],Ta);Object(za.a)(Ta,"AutoAdjustColumnsManager",null,[2,641]);var Qa=a(34),Ob=a(80),Jb=a(440),Jc=a(431),zb=a(216),tb=a(255),zc=a(265);class dd{constructor(I){this.$=I}get B_f(){return this.$.workbookContext.FileCoauthorable}get HXb(){return!1}get ORb(){return this.$.fa.f0}get msf(){if(this.ORb)return!0;
for(const I of this.$.fa.pu)if(!I.SupportsRename)return!1;return!0}}Object(za.a)(dd,"EwaCoauthManager",null,[597]);var od=a(26),gb;let gc=gb=class extends Ob.a{constructor(I,pa){super();this.qqa=this.Hke=this.lHg=this.lCd=null;this.Uxa=()=>{var lb=this.$.fa.Aq;if(lb&&lb.WorkbookFileName){var hc=Qa.a.Jz(lb.WorkbookFileName),Xc=!!Td.a.compare(this.$.workbookContext.WorkbookFileName,lb.WorkbookFileName,!1),Gd=jd.EwaSettings.Na(465)&&!!lb.BreadcrumbFolderUrl&&!!Td.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,
lb.BreadcrumbFolderUrl,!1);if(Xc||Gd)this.qqa={},this.qqa.NewFileName=hc,this.qqa.EditDocInClientUrl=lb.EditDocInClientUrl,this.qqa.DirectInvokeDAVUrl=lb.DirectInvokeDAVUrl,this.qqa.DownloadACopyUrl=lb.DownloadACopyUrl,jd.EwaSettings.Na(465)&&lb.BreadcrumbFolderUrl&&(this.qqa.BreadcrumbFolderName=lb.BreadcrumbFolderName,this.qqa.BreadcrumbFolderUrl=lb.BreadcrumbFolderUrl),lb=Aa.AFrameworkApplication.xh.Uj(od.a.Xyc,2,hc),this.qqa=null,ea.ULS.shipAssertTag(537154064,0,32===lb,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.YSj=(lb,hc,Xc)=>{this.lHg=hc;this.Hke=Xc;this.$.Ia.qh(new Wd.a(1897077126,ee.a.ph,2,3,null),{["newFileName"]:lb})};this.XSj=lb=>{this.qqa&&lb(this.$Lf(this.qqa),this.Ew)};this.A2b=lb=>{tb.a(lb)||!lb.Result?(lb=gb.TDi(lb),jc.a(this.$).yj.kK([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.Hke(lb)):this.lHg(this.$Lf(lb.Result),this.Ew)};this.j_j=()=>{this.Hke(5)};this.$=I;this.Ew=pa;this.$.fa.vz(this.Uxa)}initialize(){Aa.AFrameworkApplication.qyc=this.YSj;Aa.AFrameworkApplication.xZa=
this.XSj;this.lCd=Aa.AFrameworkApplication.VI;Aa.AFrameworkApplication.VI=new dd(this.$)}dispose(){Aa.AFrameworkApplication.qyc=null;Aa.AFrameworkApplication.xZa=null;this.$.fa.SB(this.Uxa);Aa.AFrameworkApplication.VI=this.lCd;this.$=this.lCd=null;super.dispose()}renameFile(I,pa){const lb=I.newFileName;if(lb&&(I=Qa.a.Jz(this.$.workbookContext.WorkbookFileName),Td.a.compare(I,lb,!1))){const hc=this.$.oa.ta.Wh();Jc.a(this.$.userOperationManager,(Xc,Gd,ae)=>{var we=this.$.oa.ta;Xc=zc.c(Xc,this.A2b);
Gd=zc.b(Gd,this.j_j);const Re=we.Za(9,hc);Re.newFileName=lb;return Cb.h(we,"RenameFile",Re,Xc,Gd,ae,null,0)},Xc=>new zb.a(134,0,Xc),pa)}}sWd(){return 32===Aa.AFrameworkApplication.xh.$k(od.a.zma,1)}$Lf(I){var pa=this.$.workbookContext;Aa.AFrameworkApplication.bga=I.DownloadACopyUrl;const lb=jd.EwaSettings.Na(465)&&!!I.BreadcrumbFolderUrl;lb&&(Aa.AFrameworkApplication.iu.breadcrumbFolderName=I.BreadcrumbFolderName,Aa.AFrameworkApplication.iu.breadcrumbFolderUrl=I.BreadcrumbFolderUrl,pa.FullDocumentInfo.BreadcrumbFolderUrl=
I.BreadcrumbFolderUrl,pa.FullDocumentInfo.BreadcrumbFolderName=I.BreadcrumbFolderName);pa.FullDocumentInfo.BreadcrumbDocName=I.NewFileName;Jb.d(pa,I.NewFileName);pa={};pa.NewName=I.NewFileName;pa.DirectInvokeDavUrl=I.DirectInvokeDAVUrl;pa.EditDocInClientUrl=I.EditDocInClientUrl;lb&&(pa.BreadcrumbFolderName=I.BreadcrumbFolderName,pa.BreadcrumbFolderUrl=I.BreadcrumbFolderUrl);pa.OperationResult=0;return pa}static TDi(I){switch(I.Errors[0].MessageId){case -414480287:I=2;break;case 650565124:I=1;break;
case 1636785843:I=6;break;case -782844485:I=4;break;default:I=5}return I}};gc=gb=Object(wb.__decorate)([Object(Fc.d)(Gc.sf),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.pd)())],gc);Object(za.a)(gc,"RenameFileManager",Ob.a,[572,2]);var Dc=a(210),hd=a(73),xd=a(81),fd=a(157),kd=a(119),Yb=a(10),Cc=a(56),td=a(13),Ad;let oe=Ad=class{constructor(I,pa,lb){this.da=I;this.v3=pa;this.JL=lb;this.dka=new AbortController;this.kFc=jd.EwaSettings.kFc();this.E5c=jd.EwaSettings.E5c();this.BJc=
jd.EwaSettings.BJc();this.AJc=jd.EwaSettings.AJc();this.AZd=this.WNk();this.Yne=hc=>{void fd.b(()=>{this.prefetch(hc)},{priority:"background"})};this.mzk=()=>{this.Yne(!1)};this.YMg=()=>{this.Yne(!0);this.da.$.fa.az(this.YMg)};if(!jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8838483_PrefetchOnlyHighEndDevices")||!this.QIc())if(this.AZd&&this.v3.b4e(this.mzk,this.dka.signal,!1),this.AZd||this.BJc||this.AJc)this.da.$.fa.Vm?this.Yne(!0):this.da.$.fa.rv(this.YMg)}prefetch(I){const pa=this.da.$.la;this.uqj(pa)&&
(I=this.BGi(I),I=this.qei(I),I.length>Ad.o1b&&(ea.ULS.sendTraceTag(507545357,0,50,`BlockPrefetcher.prefetch Trying to prefetch more than the limit. blocksToPrefetch.length: ${I.length}. numOfPrefetchRequestsPerPrefetchLimit: ${Ad.o1b}`),I.splice(Ad.o1b)),void this.lzk(I,pa))}A$j(I,pa){let lb=0;for(let hc=0;hc<I.length;hc++)this.rtk(I[hc],pa)&&(lb++,this.JL.Ysk());return lb}rtk(I,pa){const lb=this.da.za,hc=lb.Hn(pa,I);let Xc=!1;lb.ro(hc)||(Xc=lb.yIg(I,pa,"PrefetchCachedBufferedBlock"));ea.ULS.sendTraceTag(507569688,
0,50,`BlockPrefetcher.requestBlockCacheItem getRange request for block: hashCode ${hc} is pending? ${Xc}. isBeyondUsedRange? ${this.da.ZGc(I).result}`);return Xc}lzk(I,pa){const lb=this;return xo(function*(){let hc=0;for(let Xc=0;Xc<I.length;Xc+=Ad.Wgg){const Gd=I.slice(Xc,Xc+Ad.Wgg);hc+=yield fd.b(()=>lb.A$j(Gd,pa),{priority:"background",delay:Ad.wee})}lb.uCj(hc)})}uqj(I){const pa=this.da.$.fa;(I=pa.ki&&I&&hd.i(I)&&!pa.isNamedObjectViewMode)||ea.ULS.sendTraceTag(507569687,0,50,"BlockPrefetcher.isPrefetchingBlocksPossible prefetching is not possible");
return I}BGi(I){const pa=this.da.jj,lb=[];if(this.AZd){const hc=xd.f(this.da.jj,this.da.ku,this.da.LKa(),this.kFc,this.E5c);lb.push(...Dc.c(hc,this.da.fh,!1))}I&&this.pUi(lb,pa);return lb}pUi(I,pa){let lb;this.BJc&&(lb=xd.j(this.da.usedRange,this.da.fh.Im,this.da.fh.en,this.da.rowsPerBlock,this.da.columnsPerBlock,1,pa),lb.bottomRight.X=Math.min(lb.bottomRight.X,Ad.o1b),lb.bottomRight.Y=Math.min(lb.bottomRight.Y,Ad.o1b),I.push(...Dc.c(lb,this.da.fh,!1)));this.AJc&&(lb=this.N2k(pa),I.push(...Dc.c(lb,
this.da.fh,!1)))}qei(I){const pa=Yb.a.nGj+1,lb=new Set,hc=[];for(const Xc of I)I=5*Xc.X+Xc.Y*pa*5+Xc.PaneType,lb.has(I)||(lb.add(I),hc.push(Xc));return hc}N2k(I){const pa=new kd.a(1,1,1,1,Yb.a.Ok,Yb.a.Ak),lb=new Cc.a(0,0);return Dc.b(pa,lb,I,this.da.fh,this.da.dha,this.da.cka,this.da.$,this.da.gV()).Gk}WNk(){return-1!==this.kFc&&-1!==this.E5c}QIc(){if(!navigator)return!1;const I=navigator.deviceMemory,pa=navigator.hardwareConcurrency;return td.HelperMethods.QIc(I,pa,void 0!==I&&void 0!==pa)}uCj(I){ea.ULS.sendTraceTag(507569686,
0,50,`BlockPrefetcher.logPrefetchEnded prefetchedBlocksCount is ${I}`)}};oe.o1b=jd.EwaSettings.kNj();oe.wee=100;oe.Wgg=5;oe=Ad=Object(wb.__decorate)([Object(Fc.d)(Gc.A),Object(wb.__param)(0,Object(Gc.kd)()),Object(wb.__param)(1,Object(Gc.Tg)()),Object(wb.__param)(2,Object(Gc.Ug)())],oe);Object(za.a)(oe,"BlockPrefetcher",null,[]);var qe=a(758),Be=a(1419),Ee=a(1104),Ve=a(199);class Oe{}Oe.editCell="Edited";Oe.dependentCell="Dependents";Object(za.a)(Oe,"RecalcPriorityGroupType",null,[]);var Ye=a(1229),
nf=a(307);let of=class{constructor(){this.P6=jd.EwaSettings.rHc()}BJd(I,pa){I=I.units;var lb=pa.units;if(I.length!==lb.length)return ea.ULS.sendTraceTag(508367051,0,15,"CalcInterfaceAdapter.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;pa=[];let hc=-1;for(let Xc=0;Xc<I.length;Xc++)switch(I[Xc].kind){case Ye.a.blank:pa.push(...Array(lb[Xc].str.length).fill(" "));break;case Ye.a.string:pa.push(I[Xc].str);
break;case Ye.a.MBf:pa.push("");hc=Xc;break;case Ye.a.general:pa.push(lb[Xc].str);break;default:ea.ULS.sendTraceTag(508367050,0,15,"CalcInterfaceAdapter.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=hc||""===lb[hc].str)return null;lb={};lb.Start=pa.slice(0,hc).join("");lb.Separator=I[hc].str;lb.End=pa.slice(hc+1,pa.length).join("");return lb}SIf(I){switch(I.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return ea.ULS.sendTraceTag(508367049,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),
0}}cIf(I){if(I=I.color){if("String"===Object.getType(I).getName())return Ve.a.Pu(I);if("Number"===Object.getType(I).getName())return null}else return null;ea.ULS.sendTraceTag(508367048,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}hjj(I,pa){I=excelOnlineCalc.calc.getCellValueKind(I.rangeDelta.data.value);switch(I){case "number":case "string":case "boolean":case "Blank":case "Error":return!0;case "Rich":return pa.numberOfUnsupportedRichCellTypes++,!1;
default:return ea.ULS.shipAssertTag(508367047,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${I}`),!1}}YFf(I){I=excelOnlineCalc.calc.getCellValueKind(I.rangeDelta.data.value);let pa=0;switch(I){case "number":pa=1;break;case "string":pa=2;break;case "boolean":pa=3;break;case "Error":pa=4;break;case "Blank":pa=0;break;default:ea.ULS.shipAssertTag(508367046,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${I}`)}return pa}b6h(I){const pa=I.value;
switch(I.type){case 2:return void 0===pa||null===pa?"":pa;case 1:return I=parseFloat(pa),isNaN(I)?null:I;case 3:return I=parseFloat(pa),isNaN(I)?null:1===I;case 4:return I=parseFloat(pa),isNaN(I)?null:excelOnlineCalc.calc.errorValue(I);default:return excelOnlineCalc.calc.blankValue}}$Rb(I){"kind"in I&&ea.ULS.shipAssertTag(508367045,0,I.kind!==Ee.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");I=excelOnlineCalc.numfmt.getValueEditOperKind(I);
let pa=0;switch(I){case 0:case 128:pa=0;break;case 1:pa=1;break;case 2:pa=2;break;case 4:pa=3;break;case 8:pa=4;break;case 16:case 32:case 64:case 256:ea.ULS.sendTraceTag(508367044,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${I} to a CellValueType`);break;default:ea.ULS.shipAssertTag(508367043,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${I}`)}return pa}SLf(I,pa){const lb=this.VCc(pa);var hc=!(void 0===pa.rangeDelta.data.format||null===
pa.rangeDelta.data.format);ea.ULS.shipAssertTag(508367042,0,0===lb||!hc,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${pa.priorityGroup}`);I=Math.max(I.cell.to,0);hc&&(hc=excelOnlineCalc.calc.getCellFormatKind(pa.rangeDelta.data.format.format),"number"===hc?I=pa.rangeDelta.data.format.format:"string"===hc?ea.ULS.sendTraceTag(508367041,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===hc?ea.ULS.sendTraceTag(508367040,
0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):ea.ULS.shipAssertTag(508367011,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return I}VCc(I){if(I.priorityGroup===Oe.editCell)return 0;if(I.priorityGroup===Oe.dependentCell)return 1;ea.ULS.sendTraceTag(508367010,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}qPi(I){I=this.VCc(I);if(0===I)return 1;if(1===I)return 2;ea.ULS.sendTraceTag(508367009,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");
return 0}THi(I){return I.rangeDelta.range.column+1}$Hi(I){return I.rangeDelta.range.row+1}TLf(I){return this.P6?this.lQd(I.rangeDelta.data.value):I.rangeDelta.data.value.toString()}getCellValueKind(I){return excelOnlineCalc.calc.getCellValueKind(I.rangeDelta.data.value)}ZRb(I,pa){var lb,hc;if(!this.P6)return null===(hc=null===(lb=null===I||void 0===I?void 0:I.value)||void 0===lb?void 0:lb.value)||void 0===hc?void 0:hc.toString();I=excelOnlineCalc.calc.readOperToCellValue(pa,I.value);return this.lQd(I)}lQd(I){if(!Object(nf.c)(I)){if("string"===
typeof I)return I;if("number"===typeof I)return String(I);if("boolean"===typeof I)return I?"1":"0";if("kind"in I){if("Error"===I.kind)return String(I.type);if("Blank"===I.kind)return}ea.ULS.shipAssertTag(507646812,0,!1,"CalcInterfaceAdapter.GetValue: unknown cell value type!")}}};of=Object(wb.__decorate)([Object(Fc.d)(Gc.F),Object(wb.__param)(0,Object(Gc.Vb)())],of);Object(za.a)(of,"CalcInterfaceAdapter",null,[637]);var Cf=a(94),Ff=a(233),Wf=a(91);class Mf{}Mf.local="Local";Mf.n0k="Thread";Object(za.a)(Mf,
"RecalcServiceCreateMode",null,[]);var ng=a(192);class Rf{constructor(I){this.pKe=null;this.init(I)}get tma(){return this.pKe}init(I){this.pKe=new Ff.a;if(void 0!==I&&null!==I&&void 0!==I.HeadersList&&null!==I.HeadersList&&0<I.HeadersList.length)for(const pa of I.HeadersList)this.tma.ga(pa.Index,pa.Name)}}Object(za.a)(Rf,"ColHeadersListData",null,[]);var $f=a(120),jf=a(163);class Hf{constructor(I,pa){this.kdf=I;this.sheetName=pa;this.j8b=!1}}Object(za.a)(Hf,"CalcBlockInformation",null,[]);class Uf{constructor(I,
pa,lb,hc,Xc){this.type=I;this.fullName=pa;this.range=lb;this.sheetId=hc;this.attributes=Xc;this.VO=null}}Object(za.a)(Uf,"CalcNamedObject",null,[]);class If{get Cr(){return this.zZe}constructor(){this.zZe=[];this.FAe=[];this.Ygb={}}URg(I,pa){this.zZe[I]=pa}getSheetIndex(I){for(let pa=1;pa<this.Cr.length;pa++)if(Td.a.equals(this.Cr[pa].aCa.sheetName,I,!1))return pa;return-1}}Object(za.a)(If,"GridCache",null,[]);var sf=a(873),tc=a(658);class ld{constructor(I){this.aCa=I;this.Zha=new sf.a(tc.a.tm());
this.vOc=!1}}Object(za.a)(ld,"SheetInformation",null,[]);var Ed=a(1188),ze;(function(I){I[I.initialization=0]="initialization";I[I.contentReady=1]="contentReady";I[I.cellEdit=2]="cellEdit"})(ze||(ze={}));Object(za.b)("UpdateDataTrigger",ze);class ge{constructor(I){this.Ahe=null;this.F3d=this.zhe=this.hbe=!1;this.mfe=0;this.efe=this.gfe=this.hfe=this.ffe=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.Dx=null;this.FB=this.currentStateId=-1;this.aIa="";
this.Qma=null;this.getNameLoc=(pa,lb)=>this.aJc()?this.Ul.ma(this.currentStateId).Cr[0].Zha.mh(lb)?(pa=excelOnlineCalc.location.nameLoc(pa,lb),excelOnlineCalc.util.success(pa)):excelOnlineCalc.util.success(null):(pa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(pa));this.getContainingTable=pa=>{if(!this.aJc())return pa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(pa);const lb=pa.range.col,hc=pa.range.row;var Xc=this.Ul.ma(this.currentStateId).Cr[0].Zha,Gd=
null;for(const ae of Xc)if(Xc=ae.value,2===Xc.type&&Td.a.equals(pa.sheet.index.toString(),Xc.sheetId,!0)){const we=Xc.range;lb>=we.left-1&&lb<=we.right-1&&hc<=we.bottom-1&&hc>=we.top-1&&(Gd=excelOnlineCalc.location.nameScope(this.documentLoc,Xc.sheetId),Gd=excelOnlineCalc.location.nameLoc(Gd,Xc.fullName))}return Gd?excelOnlineCalc.util.success(Gd):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(pa,lb)=>{if(!this.aJc()){var hc=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(hc)}hc=
pa.name;var Xc=this.Ul.ma(this.currentStateId).Cr[0].Zha;if(Xc.mh(hc)){Xc=Xc.ma(hc);const ae=Xc.range;if(2!==Xc.type)return excelOnlineCalc.util.failure(this.pAd(5));const we=Xc.VO?Xc.VO.tma:null;if(!we)return excelOnlineCalc.util.success(null);for(var Gd of we)if(Td.a.equals(Gd.value,lb,!0))return pa=excelOnlineCalc.location.documentLoc(pa.scope.document.path,pa.scope.document.name),pa=excelOnlineCalc.location.sheetIndex(pa,Xc.sheetId),Gd=excelOnlineCalc.location.gridRange(ae.top-1,Gd.key,ae.bottom-
ae.top+1,1),Gd=excelOnlineCalc.location.sheetGridRange(pa,Gd),hc=excelOnlineCalc.location.structRefColumnLoc(hc,Gd,!!(Xc.attributes&16),!!(Xc.attributes&8)),excelOnlineCalc.util.success(hc);return ae.right-ae.left+1!==we.count?(hc=excelOnlineCalc.util.unavailable([17,pa,lb]),excelOnlineCalc.util.failure(hc)):excelOnlineCalc.util.failure(this.pAd(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(pa,lb)=>{if(!this.aJc())return lb=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(lb);
var hc=this.Ul.ma(this.currentStateId).Cr[0].Zha;if(hc.mh(pa.name)){var Xc=hc.ma(pa.name);if(2!==Xc.type)return excelOnlineCalc.util.failure(this.pAd(5));hc=!!(Xc.attributes&16);const Gd=!!(Xc.attributes&8),ae=hc?1:0,we=Gd?1:0;pa=excelOnlineCalc.location.documentLoc(pa.scope.document.path,pa.scope.document.name);pa=excelOnlineCalc.location.sheetIndex(pa,Xc.sheetId);Xc=Xc.range;let Re={};if(1===lb)Re=excelOnlineCalc.location.gridRange(Xc.top-ae-1,Xc.left-1,Xc.bottom+we-Xc.top+ae+1,Xc.right-Xc.left+
1);else if(2===lb)Re=excelOnlineCalc.location.gridRange(Xc.top-1,Xc.left-1,Xc.bottom-Xc.top+1,Xc.right-Xc.left+1);else if(3===lb)if(hc)Re=excelOnlineCalc.location.gridRange(Xc.top-2,Xc.left-1,1,Xc.right-Xc.left+1);else return excelOnlineCalc.util.success(null);else if(4===lb)if(Gd)Re=excelOnlineCalc.location.gridRange(Xc.bottom,Xc.left-1,1,Xc.right-Xc.left+1);else return excelOnlineCalc.util.success(null);lb=excelOnlineCalc.location.sheetGridRange(pa,Re);return excelOnlineCalc.util.success(lb)}return excelOnlineCalc.util.success(null)};
this.getDocumentLoc=(pa,lb)=>{if((Td.a.equals(pa,this.documentLoc.path,!0)||!pa)&&Td.a.equals(lb,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);pa=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(pa,lb)]);return excelOnlineCalc.util.failure(pa)};this.getSheetIndex=(pa,lb)=>{if(!this.Ul.mh(this.currentStateId)||!this.Ul.ma(this.currentStateId).Cr)return lb=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(lb);pa=this.Ul.ma(this.currentStateId).Cr;
for(let hc=1;hc<pa.length;hc++)if(Td.a.equals(pa[hc].aCa.sheetName,lb,!0))return excelOnlineCalc.util.success(pa[hc].aCa.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(pa,lb)=>{if(!this.Ul.mh(this.currentStateId)||!this.Ul.ma(this.currentStateId).Cr)return lb=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(lb);pa=this.Ul.ma(this.currentStateId).Cr;for(let hc=1;hc<pa.length;hc++)if(Td.a.equals(pa[hc].aCa.sheetId,lb,!0))return excelOnlineCalc.util.success(pa[hc].aCa.sheetName);
return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.apg=()=>{this.setNumberFormats()};this.Dj=()=>{ea.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Ul=new Ff.a;this.currentStateId=this.FB=-1;this.aIa=
"";this.Pib=null;this.zhe=!1;this.Dx&&this.clearCache()};this.pj=I;this.Ul=new Ff.a;this.Pib=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.pj.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.$Ca()}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.KVc(this.apg);this.pj&&this.pj.$r(this.Dj);this.close()}ybc(I){if(!this.Dx)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=
Fc.a.lh(Gc.Ed),!this.instantaneousSupportInformationManager))return ea.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==I&&(this.currentStateId=this.pj.fa.UC,this.currentStateId===Yb.a.Ek&&(this.currentStateId=this.pj.fa.yk));if(1===I&&this.currentStateId<this.FB)return ea.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.FB} - ignoring update`),!1;
this.XEk();0!==I&&this.zhe||(this.KJk(),this.HGk(),this.vHk(),this.setNumberFormats(),this.instantaneousSupportInformationManager.gqd(this.apg),this.pj.nr(this.Dj),this.zhe=!0);this.yhk();let pa=!1;0===I&&(pa=this.Bdj());if(0!==I||pa)this.OIk()?(this.vJk(I),this.uJk(),this.FB=this.currentStateId,this.cYh()):ea.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==I&&this.resumeRecalc();return!0}evalFormula(I,pa,lb,hc){if(!this.Dx)return ea.ULS.sendTraceTag(537170195,
0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});pa=excelOnlineCalc.calc.sheetCellLocation(null!==lb&&void 0!==lb?lb:hd.d(this.pj.sa.la),pa.top-1,pa.left-1);I=this.Dx.evalFormula(this.pj.fa.yk,I,pa,hc);this.resumeRecalc();return I}oTh(I,pa,lb,hc){hc=void 0===hc?null:hc;const Xc=hd.d(this.pj.sa.la);let Gd=I.cell.IH-1,ae=I.cell.RK-1;var we=Gd,Re=ae;let lf=null;hc&&(lf=excelOnlineCalc.calc.cellLocation(Gd,ae),Gd=hc.top-1,ae=hc.left-1,we=hc.bottom-1,Re=hc.right-1);lb=this.yCe(I,
lb,"SetCell");0>lb||(Re=ge.Ofa("CalculateFormula.cell",Xc,Gd,ae,we,Re),we=[],hc=this.ADc(Xc),pa=excelOnlineCalc.calc.inferredRangeFormulaEdit(Re,pa,lf,hc),we.push(pa),I=(pa=this.rQd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Xc,Gd,ae,Td.a.f8e(I.cell.text),lb,pa.top-1,pa.left-1,pa.bottom-1,pa.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
Xc,Gd,ae,Td.a.f8e(I.cell.text),lb,"","","",""),ea.ULS.sendTraceTag(537170180,0,50,I),this.Dx.editRangeFormulas(lb,we),this.resumeRecalc())}pTh(I,pa){const lb=[];var hc=hd.d(this.pj.sa.la),Xc=this.ADc(hc);pa=this.yCe(I[0].Xfa,pa,"SetCellBatched");if(0>pa)return!1;for(var Gd of I){var ae=Gd.Xfa.cell,we=ae.IH-1;ae=ae.RK-1;we=ge.Ofa("CalculateFormulaBatched.cell",hc,we,ae,we,ae);we=excelOnlineCalc.calc.inferredRangeFormulaEdit(we,Gd.editText,null,Xc);lb.push(we)}Xc=this.rQd();Gd=I[0].Xfa.cell.IH-1;we=
I[0].Xfa.cell.RK-1;ae=I[I.length-1].Xfa.cell.IH-1;I=I[I.length-1].Xfa.cell.RK-1;hc=Xc?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",hc,Gd,we,ae,I,pa,Xc.top-1,Xc.left-1,Xc.bottom-1,Xc.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",hc,Gd,we,ae,I,pa,"","","","");ea.ULS.sendTraceTag(508932947,0,50,hc);this.Dx.editRangeFormulas(pa,
lb);this.resumeRecalc();return!0}U5(I,pa,lb,hc,Xc){if(!this.Dx)return ea.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!lb||!pa)return ea.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!lb}, outputColumnRange null: ${!pa}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");ea.ULS.shipAssertTag(537170178,0,lb.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const Gd=hd.d(this.pj.sa.la),ae=this.ADc(Gd);let we=null;if(I){we=[];for(const lf of I)if(lf.column!==lb.left){I=lf.row-1;var Re=lf.column-1;I=ge.Ofa("EvalFormulaRangeOnClone.cell",Gd,I,Re,I,Re);Re=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?Ne(lf.Qn,lf.formulaBarText,lf.to):excelOnlineCalc.calc.valueCellData(lf.text,lf.text,lf.to,null);we.push(excelOnlineCalc.calc.rangeWrite(I,Re))}}lb=excelOnlineCalc.calc.cellLocation(lb.top-1,lb.left-1);pa=ge.Ofa("EvalFormulaRangeOnClone.outputColumnRange",
Gd,pa.top-1,pa.left-1,pa.bottom-1,pa.right-1);Xc?(hc=[excelOnlineCalc.calc.inferredRangeFormulaEdit(pa,hc,lb,ae)],Xc=this.Dx.evalOnClonedModel(we,hc,Xc)):(hc=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(pa,hc,lb,ae)],Xc=this.Dx.evalOnClonedModel(we,hc,Xc));this.resumeRecalc();return Xc}localizeEnglishFormula(I,pa,lb){pa=excelOnlineCalc.calc.sheetCellLocation(hd.d(pa),lb.top-1,lb.left-1);return this.Dx.localizeEnglishFormula(I,pa)}Qnf(I){let pa=null;try{if(I)if(this.aIa=Oc.f(this.pj).za.TJa(I),
this.currentStateId=I.MQa,this.currentStateId<this.FB||this.currentStateId===Yb.a.Ek)ea.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.aIa} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.FB}`);else{if(this.Gdj(),1===I.dr.PaneType&&this.icl(I.la),!this.cOh())if(pa=this.pj.Eh.Oi("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.aIa} StateId:${this.currentStateId}`),this.Pib=this.o1(I.la.sheetName))if(Oc.f(this.pj).za.dv.dPb(I.Ti)){var lb=
I.tl;if(lb){var hc=lb.getCalcBlockModel();if(hc)if(this.WNh(hc)){this.Ul.ma(this.currentStateId).Ygb[this.aIa]=new Hf(hc,I.la.sheetName);var Xc=I.Yj;Xc?this.Uzh(Xc.NamedObjects):ea.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else ea.ULS.sendTraceTag(509117971,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else ea.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else ea.ULS.sendTraceTag(537170146,
0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.aIa}`)}else ea.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");else{const Gd=!!(this.pj.Kj&32),ae=this.Ul.mh(this.currentStateId)&&this.Ul.ma(this.currentStateId).Cr?this.Ul.ma(this.currentStateId).Cr.length:0;ea.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${ae}, scratchPad:${Gd}, sheetNameLength:${I.la.sheetName?
I.la.sheetName.length:-1} Hash:${I.la.hash}`)}}else ea.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{pa&&pa.stop()}}e0a(I){var pa;if(!this.Ul.mh(this.currentStateId))return ea.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const lb=null===(pa=this.Ul.ma(this.currentStateId))||void 0===pa?void 0:pa.Cr;if(!lb||!lb[0])return null;pa=lb[0].Zha;if(!pa||
!pa.mh(I.name))return ea.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==pa}`),null;I=pa.ma(I.name);if(!I||!I.VO)return null;pa=[];for(const hc of I.VO.tma)pa.push(hc.value);return pa}qTh(I,pa,lb){var hc=Oc.f(this.pj).yh(I[0].targetRange);pa=this.yCe(hc,pa,"CopyPaste");if(0>pa)ea.ULS.sendTraceTag(508065925,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPasteBatched(). Revision not valid. targetRevision:${pa}.`);
else{hc=[];for(const Xc of I)I=this.qVi(pa,lb,Xc.sourceRange,Xc.targetRange),hc.push(I);this.Dx.editRangePaste(pa,hc);this.resumeRecalc()}}qVi(I,pa,lb,hc){const Xc=hd.d(this.pj.sa.la);pa=pa?hd.d(this.pj.sa.getItemByName(pa)):Xc;const Gd=this.ADc(Xc);lb=ge.Ofa("getRangePasteEdit.srcRange",pa,lb.top-1,lb.left-1,lb.bottom-1,lb.right-1);hc=ge.Ofa("getRangePasteEdit.targetRange",Xc,hc.top-1,hc.left-1,hc.bottom-1,hc.right-1);hc=excelOnlineCalc.calc.copyPasteRangePasteEdit(hc,lb,Gd);I=Gd?String.format("CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",
pa,Xc,I,Gd.row,Gd.column,Gd.lastRow,Gd.lastColumn):String.format("CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",Xc,I,"","","","");ea.ULS.sendTraceTag(537170142,0,50,I);return hc}ADc(I){const pa=this.rQd();let lb=null;pa?lb=ge.Ofa("GetViewport.viewport",I,pa.top-1,pa.left-1,pa.bottom-1,pa.right-1):ea.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return lb}rQd(){const I=
Oc.f(this.pj);let pa=I.Wp;if(Oc.f(this.pj).fh.vp){pa=I.ol(1).Wp;if(jd.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!pa)return ea.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;pa.Xqa(1,1);pa.Xqa(3,1)}return pa}yCe(I,pa,lb){let hc;if(!this.Dx||!I)return ea.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.Dx}, modifiedCell is null:${!I}, operation:${lb}`),
-1;const Xc=I.cell.IH-1,Gd=I.cell.RK-1;if(I.cell.aG){if(hc=I.cell.aG.Zpc,hc===Yb.a.Ek)return ea.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${I.cell.aG.Ti}, operation:${lb}`),-1}else return ea.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${I.cell.IH},${I.cell.RK}), operation:${lb}`),-1;if(hc<this.FB)return ea.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Xc},${Gd}) - blockRevision:${hc} < lastUpdatedStateId:${this.FB}, operation:${lb}`),
-1;if(hc<this.currentStateId)return ea.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Xc},${Gd}) - blockRevision:${hc} < currentStateId:${this.currentStateId}, operation:${lb}`),-1;pa&&!this.hbe&&(this.Dx.setOnRecalcResults(pa),this.hbe=!0);return this.g8k()&&!this.ybc(2)?(ea.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${lb}`),-1):hc}getFormulaBarText(I,pa,lb){return pa&&pa.startsWith("'")?
pa:I.cell.formulaBarText||lb.toString()}n$h(I,pa,lb){let hc=null;this.Pib=this.o1(lb);if(this.Zdf()&&this.Ul.ma(this.FB).Ygb){const we=this.Ul.ma(this.FB).Ygb[I];if(null===we||void 0===we?0:we.j8b)hc=we.kdf}lb=this.Bij(hc,pa,lb);const {nNj:Xc,numberOfNonEmptyCells:Gd,lNj:ae}=this.J0h(hc,pa,lb);ea.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${I} StateId:${this.currentStateId} number of formulas ${Xc}, number of non-empty cells ${Gd}, number of cells ${ae}`)}Bij(I,
pa,lb){let hc=!1;const Xc=ge.HFf(pa);if(I){const Gd=ge.HFf(I);Td.a.equals(Gd,Xc,!1)&&(hc=!0)}hc?this.CAh(I,this.FB,lb):this.EAh(pa,lb);return hc}Zdf(){let I=!1;this.Dx&&-1!==this.FB&&(I=this.Dx.stateIdAvailable(this.FB));return I&&this.Ul.mh(this.FB)&&this.FB<this.currentStateId}J0h(I,pa,lb){let hc=0,Xc=0,Gd=0,ae,we;for(pa.reset();ae=pa.getNextCell();)Gd++,(ae.value||ae.formula)&&Xc++,jf.f(ae.formula)&&hc++,(we=lb?I.getCell(ae.row,ae.col):null)?this.D0h(pa,ae,we):this.DAh(pa,ae);if(lb)for(I.reset();we=
I.getNextCell();)(ae=pa.getCell(we.row,we.col))||this.o4e(I,we);return{nNj:hc,numberOfNonEmptyCells:Xc,lNj:Gd}}vHk(){this.Dx.setOnUpdateRequest(()=>{})}uHk(){this.Dx.setOnUnresponsive((I,pa,lb,hc)=>{this.o2j(I,pa,lb,hc)})}o2j(I,pa,lb,hc){ea.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${I}, waitTime:${pa}, timeoutCount:${lb}, hasBeenClosed:${hc}.`);hc&&(this.Guk(),this.$Ca())}Guk(){this.Dj(null,null);this.F3d=this.hbe=!1;this.mfe=0;this.efe=
this.gfe=this.hfe=this.ffe=-1}close(){this.Dx.close()}clearCache(){this.Dx.clearCache()}resumeRecalc(){this.Dx.resumeRecalc()}HGk(){this.Dx.setA1ReferenceStyle(!0)}yhk(){if(this.instantaneousSupportInformationManager){var I=this.instantaneousSupportInformationManager.bgj;const lb=this.instantaneousSupportInformationManager.egj,hc=this.instantaneousSupportInformationManager.dgj,Xc=this.instantaneousSupportInformationManager.cgj;var pa=!1;I!==this.ffe&&(pa=!0,this.ffe=I);lb!==this.hfe&&(pa=!0,this.hfe=
lb);hc!==this.gfe&&(pa=!0,this.gfe=hc);Xc!==this.efe&&(pa=!0,this.efe=Xc);const Gd=[];jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(pa=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",null),Gd.push(pa),pa=!0);jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(pa=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),Gd.push(pa),pa=!0);jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",
!1)&&(pa=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),Gd.push(pa),pa=!0);pa&&(I=excelOnlineCalc.calc.recalcServiceConfig(null,I,null,lb,null,null,null,hc,Gd,Xc),this.Dx.reconfigure(I))}}vJk(I){let pa=null;if(this.Ul.mh(this.currentStateId))try{this.Qma=[],pa=this.pj.Eh.Oi("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${ze[I]}`),Cf.a.forEach(this.Ul.ma(this.currentStateId).Ygb,(lb,hc)=>{hc.j8b||(this.n$h(lb,hc.kdf,hc.sheetName),
hc.j8b=!0)},null),this.Dx.updateRanges(this.currentStateId,this.Qma)}finally{pa&&pa.stop()}else ea.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}uJk(){const I=[],pa=this.Zdf();var lb=pa&&this.Ul.ma(this.FB).Cr&&this.Ul.ma(this.FB).Cr[0]&&this.Ul.ma(this.FB).Cr[0].vOc?this.Ul.ma(this.FB).Cr[0].Zha:null;this.Vif(lb,this.Ul.ma(this.currentStateId).Cr[0].Zha,null,this.FB,I);this.Ul.ma(this.currentStateId).Cr[0].vOc=!0;for(let hc=
1;hc<this.Ul.ma(this.currentStateId).Cr.length;hc++)lb=-1,pa&&this.Ul.ma(this.FB).Cr&&(lb=this.sPd(this.Ul.ma(this.currentStateId).Cr[hc].aCa.sheetName,this.FB)),lb=-1!==lb&&this.Ul.ma(this.FB).Cr[lb].vOc?this.Ul.ma(this.FB).Cr[lb].Zha:null,this.Vif(lb,this.Ul.ma(this.currentStateId).Cr[hc].Zha,this.Ul.ma(this.currentStateId).Cr[hc].aCa.sheetId,this.FB,I),this.Ul.ma(this.currentStateId).Cr[hc].vOc=!0;this.Dx.updateNamedObjects(this.currentStateId,I)}Vif(I,pa,lb,hc,Xc){if(void 0!==lb&&null!==lb){var Gd=
excelOnlineCalc.calc.undefinedNamesWrite(lb);Xc.push(Gd)}if(I){var ae=!1;Gd=[];var we=[];if(pa)for(const lf of pa){const hg=lf.value;if(I.mh(lf.key)){var Re=I.ma(lf.key);ge.yLj(Re,hg)?ae=!0:(Re=excelOnlineCalc.calc.namedObject(lf.key,null),Gd.push(Re),ge.dpd(lf.key,hg,we))}else ge.dpd(lf.key,hg,we)}for(const lf of I)pa&&pa.mh(lf.key)||(I=excelOnlineCalc.calc.namedObject(lf.key,null),Gd.push(I));ae&&(pa=excelOnlineCalc.calc.namedObjectsPromote(lb,hc),Xc.push(pa));0<Gd.length&&(pa=excelOnlineCalc.calc.namedObjectsWrite(lb,
Gd),Xc.push(pa));0<we.length&&(lb=excelOnlineCalc.calc.namedObjectsWrite(lb,we),Xc.push(lb))}else if(pa){hc=[];for(we of pa)ge.dpd(we.key,we.value,hc);0<hc.length&&(lb=excelOnlineCalc.calc.namedObjectsWrite(lb,hc),Xc.push(lb))}}cOh(){const I=this.Ul.ma(this.currentStateId).Ygb[this.aIa];return I?(ea.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.aIa} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.FB}. sentToRecalcEngine: ${null===
I||void 0===I?void 0:I.j8b}`),!0):!1}WNh(I){return 1===I.getColumnNumbers().length&&I.getColumnNumbers()[0]===ge.s6d+1?!1:!0}Bdj(){let I=!1;Oc.f(this.pj).za.Zkb(pa=>{pa.state&1&&this.pj.fa.yk===pa.Ck.Revision&&(this.Qnf(pa),I=!0)});return I}ylf(I,pa){var lb=I.getRowNumbers(),hc=I.getColumnNumbers();I=lb[0]-1;lb=lb[lb.length-1]-1;const Xc=hc[0]-1;hc=hc[hc.length-1]-1;pa=this.o1(pa);if(!pa){const Gd=this.Ul.mh(this.currentStateId)&&this.Ul.ma(this.currentStateId).Cr?this.Ul.ma(this.currentStateId).Cr.length:
0;ea.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${Gd}`)}return ge.Ofa("CreateBlockRangeLocation",pa,I,Xc,lb,hc)}CAh(I,pa,lb){if(lb=this.ylf(I,lb)){var hc=ge.Wtc(I.getRowNumbers());I=ge.Wtc(I.getColumnNumbers());pa=excelOnlineCalc.calc.rangePromote(lb,pa,hc,I);this.Qma[this.Qma.length]=pa}}EAh(I,pa){if(pa=this.ylf(I,pa)){var lb=ge.Wtc(I.getRowNumbers());I=ge.Wtc(I.getColumnNumbers());I=excelOnlineCalc.calc.rangeWrite(pa,
null,lb,I);this.Qma[this.Qma.length]=I}}D0h(I,pa,lb){let hc=null,Xc=0,Gd=0;switch(pa.valueType){case 2:hc=this.mQd(pa);var ae=this.mQd(lb);ae=Td.a.equals(ae,hc,!1);break;case 1:null===pa.value&&null===lb.value?ae=!0:(Xc=parseFloat(pa.value),ae=parseFloat(lb.value)===Xc);break;default:null===pa.value&&null===lb.value?ae=!0:(Gd=parseFloat(pa.value),ae=Gd===parseFloat(lb.value))}ae&&pa.valueType===lb.valueType&&pa.ifmt===lb.ifmt&&pa.formulaType===lb.formulaType&&Td.a.equals(lb.formula,pa.formula,!1)||
(void 0!==pa.formula&&null!==pa.formula||void 0!==pa.value&&null!==pa.value||void 0!==pa.text&&null!==pa.text||0!==pa.valueType?this.jnc(I,pa,hc,Xc,Gd):this.o4e(I,pa))}Uzh(I){if(this.pj.$h&&this.pj.$h.items)for(let Gd=0;Gd<this.pj.$h.count;Gd++){var pa=this.pj.$h.items[Gd];if(2!==pa.type&&3!==pa.type)continue;var lb=0,hc=pa.name,Xc=hc.lastIndexOf("!");if(0<Xc){lb=hc.substr(0,Xc);"'"===lb.charAt(0)&&(lb=lb.substr(1,lb.length-2));lb=this.sPd(lb,this.currentStateId);if(-1===lb){hc=this.Ul.mh(this.currentStateId)&&
this.Ul.ma(this.currentStateId).Cr?this.Ul.ma(this.currentStateId).Cr.length:0;ea.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${hc}`);continue}hc=hc.substr(Xc+1)}Xc=this.Ul.ma(this.currentStateId).Cr[lb].Zha;let ae=pa.usedRange;2===pa.type&&(ae=ng.a(pa));if(Xc.mh(hc)){if(lb=Xc.ma(hc),lb.range=ae,lb.attributes=pa.attributes,2===lb.type)if(hc=pa.c9,!lb.VO)lb.VO=new Rf(hc);else if(hc)for(const we of hc.HeadersList)lb.VO.tma.ga(we.Index,
we.Name)}else if(lb=this.o1(pa.sheetName)){lb=new Uf(pa.type,pa.name,ae,lb,pa.attributes);if(2===lb.type)if(pa.c9)lb.VO=new Rf(pa.c9);else if(pa=ge.Exi(pa.name,I))lb.VO=new Rf(pa.ColHeadersList);Xc.ga(hc,lb)}else hc=this.Ul.mh(this.currentStateId)&&this.Ul.ma(this.currentStateId).Cr?this.Ul.ma(this.currentStateId).Cr.length:0,ea.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${hc}`)}}jnc(I,pa,lb,hc,Xc){var Gd=I.getRowNumbers()[pa.row]-
1;I=I.getColumnNumbers()[pa.col]-1;Gd=ge.Ofa("AddRangeUpdateCommand",this.Pib,Gd,I,Gd,I);I=null;let ae=pa.formula||pa.text;const we=excelOnlineCalc.calc.blankValue;let Re=null;void 0!==pa.text&&null!==pa.text||void 0!==pa.value&&null!==pa.value||(lb="",Re="This cell contains blanks only",0===pa.formulaType&&(ae=""));switch(pa.valueType){case 2:null!==lb&&(0===pa.formulaType&&(I=excelOnlineCalc.calc.valueCellData(ae,lb,pa.ifmt,Re)),1===pa.formulaType&&(I=excelOnlineCalc.calc.cellFormulaCellData(ae,
lb,pa.ifmt,Re)),2===pa.formulaType&&(I=excelOnlineCalc.calc.valueCellData("",we,0,"This cell is a part of an array")));break;case 1:isNaN(hc)?ea.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${pa.row},${pa.col}) invalid numeric value`):(0===pa.formulaType&&(I=excelOnlineCalc.calc.valueCellData(ae,hc,pa.ifmt,null)),1===pa.formulaType&&(I=excelOnlineCalc.calc.cellFormulaCellData(ae,hc,pa.ifmt,null)),2===pa.formulaType&&(I=excelOnlineCalc.calc.valueCellData("",we,0,"This cell is a part of an array")));
break;case 3:isNaN(Xc)?ea.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${pa.row},${pa.col}) invalid boolean value`):(lb=1===Xc?!0:!1,0===pa.formulaType&&(I=excelOnlineCalc.calc.valueCellData(ae,lb,pa.ifmt,null)),1===pa.formulaType&&(I=excelOnlineCalc.calc.cellFormulaCellData(ae,lb,pa.ifmt,null)),2===pa.formulaType&&(I=excelOnlineCalc.calc.valueCellData("",we,0,"This cell is a part of an array")));break;case 4:isNaN(Xc)?ea.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${pa.row},${pa.col}) invalid error value`):
(lb=excelOnlineCalc.calc.errorValue(Xc),0===pa.formulaType&&(I=excelOnlineCalc.calc.valueCellData(ae,lb,pa.ifmt,null)),1===pa.formulaType&&(I=excelOnlineCalc.calc.cellFormulaCellData(ae,lb,pa.ifmt,null)),2===pa.formulaType&&(I=excelOnlineCalc.calc.valueCellData("",we,0,"This cell is a part of an array")));break;default:I=excelOnlineCalc.calc.valueCellData("",we,pa.ifmt,null)}I&&(pa=excelOnlineCalc.calc.rangeWrite(Gd,I,null,null),this.Qma[this.Qma.length]=pa)}DAh(I,pa){switch(pa.valueType){case 2:this.jnc(I,
pa,this.mQd(pa),null,0);break;case 1:this.jnc(I,pa,null,parseFloat(pa.value),0);break;default:this.jnc(I,pa,null,null,parseFloat(pa.value))}}o4e(I,pa){var lb=I.getRowNumbers()[pa.row]-1;I=I.getColumnNumbers()[pa.col]-1;lb=ge.Ofa("AddRangeUpdateCommandEmptyCell",this.Pib,lb,I,lb,I);pa=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,pa.ifmt,null);pa=excelOnlineCalc.calc.rangeWrite(lb,pa,null,null);this.Qma[this.Qma.length]=pa}o1(I){I=this.sPd(I,this.currentStateId);return 0<I?
this.Ul.ma(this.currentStateId).Cr[I].aCa.sheetId:null}sPd(I,pa){if(!this.Ul.mh(pa))return ea.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${pa} does not exist in GridCache`),-1;const lb=this.Ul.ma(pa);return lb.Cr?lb.getSheetIndex(I):(ea.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${pa}`),-1)}OIk(){if(!this.Ul.mh(this.currentStateId)||!this.Ul.ma(this.currentStateId).Cr.length)return ea.ULS.sendTraceTag(537170083,
0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const I=[];for(let pa=1;pa<this.Ul.ma(this.currentStateId).Cr.length;pa++){const lb=this.Ul.ma(this.currentStateId).Cr[pa];lb&&I.push(lb.aCa)}this.Dx.updateSheetNames(this.currentStateId,I);this.Dx.updateUnusedCells(this.currentStateId,this.Ul.ma(this.currentStateId).FAe);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var I=
[];for(const pa of this.instantaneousSupportInformationManager.vNa){const lb=excelOnlineCalc.calc.numberFormat(pa.IfmtIndex,pa.FormatString,pa.Builtin);I.push(lb)}this.Dx.setNumberFormats(I,!0)}}XEk(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.zk){var I=this.Edj();if(!this.F3d||I)this.instantaneousSupportInformationManager.zk.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.zk.TrueValueString),this.instantaneousSupportInformationManager.zk.FalseValueString&&
(this.falseName=this.instantaneousSupportInformationManager.zk.FalseValueString),I=Ed.CalcHelper.Emf(this.instantaneousSupportInformationManager,I),this.Dx.setLocale(I),this.F3d=!0}}KJk(){var I=null;if(void 0!==this.pj.workbookContext.TimeZoneInformation&&null!==this.pj.workbookContext.TimeZoneInformation){I=null;this.pj.workbookContext.TimeZoneInformation.StandardDate.Month&&(I=excelOnlineCalc.date.dateTime(this.pj.workbookContext.TimeZoneInformation.StandardDate.Year,this.pj.workbookContext.TimeZoneInformation.StandardDate.Month,
this.pj.workbookContext.TimeZoneInformation.StandardDate.Day,this.pj.workbookContext.TimeZoneInformation.StandardDate.Hour,this.pj.workbookContext.TimeZoneInformation.StandardDate.Minute,this.pj.workbookContext.TimeZoneInformation.StandardDate.Second,this.pj.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.pj.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let pa=null;this.pj.workbookContext.TimeZoneInformation.DaylightDate.Month&&(pa=excelOnlineCalc.date.dateTime(this.pj.workbookContext.TimeZoneInformation.DaylightDate.Year,
this.pj.workbookContext.TimeZoneInformation.DaylightDate.Month,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Day,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Second,this.pj.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));I=excelOnlineCalc.date.tzData(this.pj.workbookContext.TimeZoneInformation.Bias,
I,this.pj.workbookContext.TimeZoneInformation.StandardBias,pa,this.pj.workbookContext.TimeZoneInformation.DaylightBias)}else ea.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");I=excelOnlineCalc.calc.workbookProps(this.pj.workbookContext.F1904,this.pj.workbookContext.FDateCompatibility,I);this.Dx.setWorkbookProps(I)}$Ca(){const I=jd.EwaSettings.Na(570)?Mf.local:Mf.n0k,[pa,lb]=[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()];
this.Ahe=Wf.d(excelOnlineCalc.calc.createRecalcService(I,pa,lb));this.Ahe.continueWith(hc=>{hc.exception?ea.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${hc.exception.toString()}`):(ea.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.Dx=this.Ahe.result)?this.ybc(0)?this.uHk():ea.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):ea.ULS.sendTraceTag(537170076,
0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Edj(){const I=this.instantaneousSupportInformationManager.bxa;if(!I||this.mfe===I.length)return null;this.mfe=I.length;return Ed.CalcHelper.hmf(I)}Gdj(){if(!(this.Ul.mh(this.currentStateId)&&0<this.Ul.ma(this.currentStateId).Cr.length)){this.Ul.ga(this.currentStateId,new If);this.Ul.ma(this.currentStateId).URg(0,new ld(null));var I=this.pj.sa;for(let hc=0;hc<I.count;hc++){var pa=Object(Bb.a)($f.a,I.getItem(hc));if(pa){void 0!==
pa.sheetId&&null!==pa.sheetId&&void 0!==pa.name&&null!==pa.name&&pa.sheetId.length&&pa.sheetName.length||ea.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${hc} Id:${pa.sheetId} Hash:${pa.hash} NameLength:${pa.name?pa.name.length:-1}`);var lb=excelOnlineCalc.calc.sheetName(pa.sheetId,pa.name);this.Ul.ma(this.currentStateId).URg(hc+1,new ld(lb));lb=pa.usedRange.mF();lb=excelOnlineCalc.calc.rangeLocation(0,0,lb.LastRow,lb.LastColumn);pa=excelOnlineCalc.calc.unusedCellsUpdate(pa.sheetId,
lb);this.Ul.ma(this.currentStateId).FAe.push(pa)}else ea.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${hc}`)}}}icl(I){if(I instanceof $f.a){var pa=I.usedRange.mF();pa=excelOnlineCalc.calc.rangeLocation(0,0,pa.LastRow,pa.LastColumn);pa=excelOnlineCalc.calc.unusedCellsUpdate(I.sheetId,pa);this.Ul.ma(this.currentStateId).FAe[I.index]=pa}}cYh(){for(const I of this.Ul)I.key<this.FB&&this.Ul.remove(I.key)}mQd(I){I=
I.value||I.text;if(void 0===I||null===I)I="";return I}g8k(){if(!this.Ul.mh(this.currentStateId))return!1;let I=!1;Cf.a.forEach(this.Ul.ma(this.currentStateId).Ygb,(pa,lb)=>{lb.j8b||(I=!0)},null);return I}pAd(I){const pa={};pa.reason=I;pa.kind=1;return pa}aJc(){return this.Ul.mh(this.currentStateId)&&this.Ul.ma(this.currentStateId).Cr&&this.Ul.ma(this.currentStateId).Cr[0]&&this.Ul.ma(this.currentStateId).Cr[0].Zha?!0:!1}static k6h(I){const pa=[];if(null===I||void 0===I?0:I.tma)for(const lb of I.tma)I=
excelOnlineCalc.calc.columnData(lb.key,lb.value),pa.push(I);return pa}static yLj(I,pa){if(I.type!==pa.type||I.attributes!==pa.attributes||!Td.a.equals(I.fullName,pa.fullName,!1)||!I.range.equals(pa.range))return!1;if(!I.VO&&!pa.VO)return!0;if(!I.VO||!pa.VO||I.VO.tma.count!==pa.VO.tma.count)return!1;for(const lb of I.VO.tma){let hc;if(I=lb.value)I=pa.VO.tma.tj(lb.key),{value:hc}=I,I=I.returnValue;if(!(I&&hc&&Td.a.equals(lb.value,hc,!1)))return!1}return!0}static dpd(I,pa,lb){var hc=ge.Ofa("NamedObject",
pa.sheetId,pa.range.top-1,pa.range.left-1,pa.range.bottom-1,pa.range.right-1);if(2===pa.type){const Xc=!!(pa.attributes&16),Gd=!!(pa.attributes&8);pa=ge.k6h(pa.VO);hc=excelOnlineCalc.calc.namedTableData(hc,Xc,Gd,pa);I=excelOnlineCalc.calc.namedObject(I,hc)}else hc=excelOnlineCalc.calc.namedRangeData(hc),I=excelOnlineCalc.calc.namedObject(I,hc);lb.push(I)}static HFf(I){const pa=Sys.Serialization.JavaScriptSerializer.serialize(I.getRowNumbers());I=Sys.Serialization.JavaScriptSerializer.serialize(I.getColumnNumbers());
return pa+I}static Wtc(I){let pa=null;if(1<I.length)for(let lb=1;lb<I.length;lb++){let hc=0;for(;I[lb-1]+1+hc<I[lb];)pa=pa||[],pa.push(I[lb-1]+hc),hc++}return pa}static Exi(I,pa){if(!pa)return null;for(let lb=0,hc=pa.length;lb<hc;++lb)if(Td.a.equals(I,pa[lb].Name,!1))return pa[lb];return null}static Ofa(I,pa,lb,hc,Xc,Gd){const ae=(we,Re,lf,hg)=>{(0>lf||lf>=hg)&&ea.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${we} invalid ${Re}:${lf}`)};void 0!==pa&&null!==
pa||ea.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${I} sheetId is null`);ae(I,"top",lb,ge.sdg);ae(I,"left",hc,ge.s6d);ae(I,"bottom",Xc,ge.sdg);ae(I,"right",Gd,ge.s6d);return excelOnlineCalc.calc.sheetRangeLocation(pa,lb,hc,Xc,Gd)}}ge.sdg=1048576;ge.s6d=16384;Object(za.a)(ge,"CalcAsyncEngine",null,[2]);const Ne=(I,pa,lb)=>{switch(I.type){case 2:return excelOnlineCalc.calc.valueCellData(pa,I.value,lb,null);case 1:return excelOnlineCalc.calc.valueCellData(pa,
parseFloat(I.value),lb,null);case 3:return excelOnlineCalc.calc.valueCellData(pa,1===parseFloat(I.value),lb,null);case 4:return excelOnlineCalc.calc.valueCellData(pa,excelOnlineCalc.calc.errorValue(parseFloat(I.value)),lb,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,lb,null)}};class Ge{constructor(){this.wya=this.xya=this.roa=this.soa=this.L2a=!1}}Object(za.a)(Ge,"AbsoluteRelativeReferenceInfo",null,[]);var ca=a(27);class sb{}sb.pxg="#";Object(za.a)(sb,
"Operators",null,[]);var Ba=a(1230);class V{}V.sheet="Sheet";V.sheetRange="SheetRange";V.document="Document";V.F$i="Ident";Object(za.a)(V,"TraverseFormulaQualifierTypes",null,[]);var Fa=a(1105),sc=a(1020),Kc=a(46),qd=a(68),Eb=a(77),vc=a(327);class Kd extends Sys.EventArgs{constructor(I){super();this.Gq=I}}Object(za.a)(Kd,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var Zd;let nb=Zd=class extends Y.a{constructor(I,pa){super();this.vy=pa;this.yz=null;this.Fcc=!1;this.Gme=this.instantaneousSupportInformationManager=
this.Coc=this.FAa=null;this.c9d=new Map;this.HUe=null;this.nQc=lb=>{ea.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");lb.KVc(this.nQc);lb.bxa.length?this.TPc(lb,Sys.EventArgs.Empty):(ea.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),lb.B5e(this.TPc))};this.TPc=lb=>{ea.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");lb.Vje(this.TPc);this.H5k(lb)};this.onContentReady=()=>
{this.yz&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.rGc||qd.Task.delay(0).continueWith(()=>{this.yz.ybc(1)?this.raiseEvent(Zd.uxd):ea.ULS.sendTraceTag(508368722,0,15,"CalcManager.onContentReady: calc engine failed to update in the calc model")},0,null,Eb.a.current))};this.Eig=(lb,hc)=>{this.yz&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.rGc||this.yz.Qnf(hc.Oj.block))};ea.ULS.sendTraceTag(537170067,0,50,
"Creating CalcManager");this.eHc=!1;this.th=I;this.yF=Oc.f(I);this.C9c=null;this.da.gA(this.onContentReady);this.da.za.bfb(this.Eig);this.bWf=new Promise((lb,hc)=>{this.bvk=lb;this.Qie=hc});void Fc.a.uj(Gc.Ed).then(lb=>{lb.zk?(ea.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.nQc(lb,Sys.EventArgs.Empty)):(ea.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),lb.gqd(this.nQc))});this.V2a=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8373394_setCellEstimationPrefetch")}Kpd(I){this.addHandler(Zd.ntf,
I)}Bgg(I){this.raiseEvent(Zd.ntf,new Kd(I))}$Bh(I){this.addHandler(Zd.jod,I)}nnk(I){this.removeHandler(Zd.jod,I)}LOc(I){this.raiseEvent(Zd.jod,I)}QIb(I){this.addHandler(Zd.uxd,I)}Z5b(I){this.removeHandler(Zd.uxd,I)}get ZPa(){return this.Gkd}get Y4(){return this.C9c}get da(){return this.yF}get $(){return this.th}get zN(){return this.HUe}get localeInfo(){return this.Y4?this.Y4.config.localeInfo:null}get config(){var I;return null===(I=this.Y4)||void 0===I?void 0:I.config}dispose(){ea.ULS.sendTraceTag(537170064,
0,50,"CalcManager.Dispose called");void Fc.a.uj(Gc.Ed).then(I=>{I.KVc(this.nQc);I.Vje(this.TPc)});this.da&&(this.da.dF(this.onContentReady),this.da.za&&this.da.za.W5b(this.Eig),this.yF=null);this.C9c=null;this.eHc=!1;this.V2a&&(Xa.a.gh(this.ZPa),this.Gkd=null)}rTh(I,pa,lb,hc){this.yz&&this.yz.oTh(I,pa,lb,void 0===hc?null:hc)}sTh(I,pa){return this.yz?this.yz.pTh(I,pa):!1}evalFormula(I,pa,lb,hc){return this.yz?this.yz.evalFormula(I,pa,lb,hc):Promise.reject("calc engine not initialized")}U5(I,pa,lb,
hc,Xc){return this.yz?this.yz.U5(I,pa,lb,hc,Xc):Promise.reject("CalcEngine is null")}localizeEnglishFormula(I,pa,lb){return this.yz?this.yz.localizeEnglishFormula(I,pa,lb):Promise.resolve(void 0)}e0a(I){if(!I)return ea.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.yz)return null;ea.ULS.shipAssertTag(537170059,0,2===I.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.yz.e0a(I)}v7e(I,pa){if(!pa||2!==I.type)return!1;I=ng.a(I);
return I.right-I.left+1===pa.length}nHd(I,pa){if(!this.FAa)return this.Fcc||ea.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var lb=this.xtc(ca.Range.yi(1,1));lb=this.FAa.parseFormula(excelOnlineCalc.parse.parseLocals(1,lb.range),I);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(lb))return ea.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{const hc=null!==pa&&void 0!==pa?pa:this.da.ha.pa.activeCell,
Xc=excelOnlineCalc.location.gridCell(hc.top-1,hc.left-1),Gd=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ae=excelOnlineCalc.location.sheetIndex(Gd,this.$.sa.la.sheetId),we=this.H$h(Xc,ae);this.Gme||(this.Gme=excelOnlineCalc.util.createResolver(this.G$h()));const Re=excelOnlineCalc.parse.parseResultHelper.extractReferences(lb,this.Y4.config.localeInfo,!1,we,this.Gme);jd.EwaSettings.Na(101)&&this.Wal(Re,I);return Re}catch(hc){return ea.ULS.sendTraceTag(537170055,
0,10,`CalcManager.ExtractReferenceWrappers - exception: ${hc.message}`),null}}L0d(I){if(!this.FAa||!this.Coc)return this.Fcc||ea.ULS.sendTraceTag(507912481,0,15,this.FAa||this.Coc?this.FAa?"CalcManager.isValidReference - analyzer not initialized":"CalcManager.isValidReference - parser not initialized":"CalcManager.isValidReference - parser and analyzer not initialized"),null;var pa=this.xtc(ca.Range.yi(1,1));I=this.FAa.parseFormula(excelOnlineCalc.parse.parseLocals(1,pa.range),I);if(!excelOnlineCalc.util.isSuccess(I))return I.reason.kind===
excelOnlineCalc.parse.ReasonKind.NotFormulaString?"notFormulaString":"internalError";pa=this.Coc.checkFormula(excelOnlineCalc.analyze.analyzeLocalsName(pa),I.value);return excelOnlineCalc.util.isSuccess(pa)?pa.value.isWellFormed?"valid":"illFormed":"internalError"}extractLetVariables(I,pa){if(!this.FAa)return this.Fcc||ea.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const lb=this.xtc(ca.Range.yi(1,1));I=this.FAa.parseFormula(excelOnlineCalc.parse.parseLocals(1,
lb.range),I);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(I))return ea.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(I,pa,this.Y4.config.localeInfo)}catch(hc){return ea.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${hc.message}`),null}}extractReferences(I,pa,lb,hc,Xc,Gd){if(!pa)return ea.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),
null;if(!lb)return ea.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const ae=this.nHd(I,Xc);if(!ae)return ea.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.E9h(ae,pa,lb,I,hc,Xc,Gd)}catch(we){return ea.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${we.message}`),null}}xtc(I,pa){pa=void 0===pa?!0:pa;return I&&this.Y4?this.Y4.bai(this.Y4.Pbi(),
I.top-1,I.left-1,pa):null}iIc(I,pa){I=this.Hna(I);if(!Object(vc.c)(I))return null;pa=this.zN.parseEdit(pa,I.value);return excelOnlineCalc.util.isSuccess(pa)?pa.value.kind===Ee.a.formula:null}g0d(I){I=this.Hna(I);return Object(vc.c)(I)?"Text"===I.value.valueType:null}BZf(I){I=this.Hna(I);return Object(vc.c)(I)?"Date"===I.value.valueType&&!I.value.hasTime:null}Hna(I){if(null==this.zN)return Object(vc.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(vc.a)("Instantaneous manager is null");
if(this.c9d.has(I))return Object(vc.d)(this.c9d.get(I));if("number"===typeof I){var pa=this.LKf(I);if(null==pa)return Object(vc.a)(`Invalid ifmt=${I}`);var lb=pa.FormatString;pa=pa.Builtin}else lb=I,pa=!1;lb=this.zN.createFormat(lb,pa);return excelOnlineCalc.util.isSuccess(lb)?(this.c9d.set(I,lb.value),Object(vc.d)(lb.value)):Object(vc.a)("Could not create number format")}getWorksheetFuncId(I){return this.localeInfo.getWorksheetFuncId(I)}E9h(I,pa,lb,hc,Xc,Gd,ae){const we={Items:[]};for(let hg=0;hg<
I.length;hg++){var Re=I[hg];const Wg={};Wg.Start=Re.span.start;Wg.End=Re.span.end;if(Xc||Re.kind!==Ba.a.func)if(Xc||Re.kind!==Ba.a.Nyj){if(jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8719736_calcFormulaExtractReferencesCrossSheet")&&ae&&!Re.ref.qualifier)continue;if(!this.Oii(Re,pa,lb))continue;var lf=new Ge;const mg=this.oVi(Re,pa,lf,hc,Gd);if(mg){const Xg={};Xg.Span=Wg;Xg.Range=mg;Xg.IsRangeRef=lf.L2a;Xg.IsAbsoluteFirstRow=lf.soa;Xg.IsAbsoluteFirstColumn=lf.roa;Xg.IsAbsoluteSecondRow=lf.xya;Xg.IsAbsoluteSecondColumn=
lf.wya;Xg.IsStructRef=Re.kind===Ba.a.d_g;we.Items.push(Xg)}}else Re=Re.ref.value.oper.kind,lf={},lf.Span=Wg,lf.IsString=2===Re,lf.IsBoolean=4===Re,lf.IsNumber=1===Re,we.Items.push(lf);else Wg.End=Re.span.start+Re.ref.name.length,Re={},Re.Span=Wg,Re.IsFunction=!0,Re.FunctionId=this.getWorksheetFuncId(hc.substring(Wg.Start,Wg.End)),we.Items.push(Re)}we.Items.sort((hg,Wg)=>hg.Span.Start-Wg.Span.Start);return we}oVi(I,pa,lb,hc,Xc){if(I.kind===Ba.a.range)return lb.L2a=!0,this.nkf(I,pa,lb,hc);if(I.kind===
Ba.a.namedRange){lb=I.ref;(I=this.$.$h.getItemByName(lb.name))||(I=this.$.$h.getItemByName(pa+"!"+lb.name));if(!(I&&I.sheetName&&I.usedRange&&Td.a.equals(I.sheetName,pa,!0)))return null;pa=2===I.type?ng.a(I):I.usedRange;return Kc.o(pa,I)}if(I.kind===Ba.a.d_g){const Gd=I.ref;Gd.name?(Xc=this.$.$h.getItemByName(Gd.name))||(Xc=this.$.$h.getItemByName(pa+"!"+Gd.name)):Xc=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&Xc?this.da.oh.Ml(Xc):this.da.oh.Ml(this.da.ha.pa.activeCell);
if(!(Xc&&Xc.sheetName&&Xc.usedRange&&Td.a.equals(Xc.sheetName,pa,!0)))return null;lb.L2a=!1;return this.nkf(I,pa,lb,hc)}return null}nkf(I,pa,lb,hc){I=I.ref;if(I.type){if(I.type===Fa.a.column){var Xc=I.startIndex;I=I.endIndex;lb.roa=Xc.kind===sc.a.abs;lb.wya=I.kind===sc.a.abs;return this.createRange(0,Xc.index,Yb.a.Ok,I.index,pa)}if(I.type===Fa.a.row)return Xc=I.endIndex,lb.soa=I.startIndex.kind===sc.a.abs,lb.xya=Xc.kind===sc.a.abs,this.createRange(I.startIndex.index,0,I.endIndex.index,Yb.a.Ak,pa);
if(I.type===Fa.a.cell){Xc=I.row;var Gd=I.col;lb.soa=lb.xya=Xc.kind===sc.a.abs;lb.roa=lb.wya=Gd.kind===sc.a.abs;return this.hXa(I.span.end,hc)&&(lb=ca.Range.yi(Xc.index+1,Gd.index+1),lb=this.da.oh.lNf(lb))?Kc.p(lb,pa):this.createRange(Xc.index,Gd.index,Xc.index,Gd.index,pa)}if(I.type===Fa.a.range){Xc=I.top;Gd=I.left;hc=I.bottom;I=I.right;const ae=Math.min(Xc.index,hc.index),we=Math.min(Gd.index,I.index),Re=Math.max(Xc.index,hc.index),lf=Math.max(Gd.index,I.index);lb.soa=Xc.kind===sc.a.abs;lb.xya=hc.kind===
sc.a.abs;lb.roa=Gd.kind===sc.a.abs;lb.wya=I.kind===sc.a.abs;return this.createRange(ae,we,Re,lf,pa)}ea.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${I.type}'`);return null}ea.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}hXa(I,pa){return pa.length>=I&&0<I&&pa.charAt(I-1)===sb.pxg}fTh(I,pa,lb){this.yz&&this.yz.qTh(I,pa,lb)}LKf(I){return this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.vNa&&this.instantaneousSupportInformationManager.vNa[I]&&this.zN?this.instantaneousSupportInformationManager.vNa[I]:null}b5i(I){var pa;"number"!==typeof I&&"string"!==typeof I?this.LOc(null):(I=this.Hna(I),Object(vc.c)(I)?(I=I.value,Object(nf.c)(I)||Object(nf.c)(I.formatString)?this.LOc(null):this.LOc({formatString:I.formatString,builtIn:null!==(pa=I.isBuiltIn)&&void 0!==pa?pa:!1})):this.LOc(null))}toXLNumber(I){if(!this.zN)return null;I=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,
this.zN,I);return excelOnlineCalc.util.isSuccess(I)?I.value:null}waa(I,pa,lb,hc,Xc,Gd,ae){if(!I)return Object(vc.a)("Null");var we=excelOnlineCalc.numfmt.renderCallback(lb,lf=>gridRenderer.CanvasRendererGlobals.measureTextWidth(lf,hc,!0,jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth")),Gd),Re=this.zN.renderValue(I,we);if(!excelOnlineCalc.util.isSuccess(Re))return Object(vc.a)("Finalize");lb=null;if(Gd=excelOnlineCalc.numfmt.isHashesValue(Re.value)){if(Re=this.zN.renderHashesValue(Re.value,
we),!excelOnlineCalc.util.isSuccess(Re))return Object(vc.a)("Hashes")}else lb=this.vy.BJd(I,Re.value);Re=Re.value;I=excelOnlineCalc.numfmt.renderedValueToString(Re);we=this.vy.SIf(Re);Re=this.vy.cIf(Re);return Object(vc.d)({text:I,valueType:pa,fontColor:Re,format:Xc,horizontalAlignment:we,numFmt:lb,isHashesValue:Gd,cellValue:ae})}Wal(I,pa){if(I)for(const lb of I)lb.ref.type&&lb.ref.type===Fa.a.cell&&(I=lb.ref,Zd.n$j(I,pa)&&(I.span.end+=1,lb.span.end+=1))}createRange(I,pa,lb,hc,Xc){const Gd={};Gd.FirstRow=
I;Gd.FirstColumn=pa;Gd.LastRow=lb;Gd.LastColumn=hc;Gd.SheetName=Xc;return Gd}Oii(I,pa,lb){var hc=I.ref.qualifier;if(!hc)return!0;switch(I.ref.qualifier.type){case V.sheet:return I=hc.document,Td.a.equals(hc.sheet,pa,!0)&&(!I||Td.a.equals(I.document,lb,!0));case V.sheetRange:return pa=this.$.sa.getItemByName(pa),lb=this.$.sa.getItemByName(hc.sheet1),hc=this.$.sa.getItemByName(hc.sheet2),!!pa&&!!lb&&!!hc&&(lb.index<=pa.index&&pa.index<=hc.index||hc.index<=pa.index&&pa.index<=lb.index);case V.document:return Td.a.equals(hc.document,
lb,!0);case V.F$i:return hc=hc.name,Td.a.equals(hc,pa,!0)||Td.a.equals(hc,lb,!0);default:return ea.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${hc.type}'`),!1}}Glj(){try{void 0!==excelOnlineCalc}catch(I){return!1}try{void 0!==excelOnlineCalc.location}catch(I){return!1}return!0}H5k(I){this.instantaneousSupportInformationManager=I;if(I.vNa.length&&I.bxa.length)if(this.Glj())try{this.C9c=new Ed.CalcHelper(this.da.$,this.instantaneousSupportInformationManager),
this.FAa=this.Y4.createParser(),this.Coc=this.Y4.createAnalyzer(),this.HUe=this.Y4.createNumberFormatter(),this.eHc=!0,ea.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.yz||(ea.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.yz=new ge(this.$)),this.bvk()}catch(pa){ea.ULS.sendTraceTag(507533056,0,10,`CalcManager.TryInitializeInternal: Exception while trying to create CalcManager. Exception message is: ${pa.message}`),jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&
this.Qie()}else ea.ULS.shipAssertTag(40939861,0,this.Fcc,"CalcManager.TryInitializeInternal: ExcelOnlineCalc is not loaded, any usage of it causes JS crash. Aborting calc initialization."),this.Fcc=!0,jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Qie();else ea.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${I.vNa.length}, functions info count = ${I.bxa.length}`),
jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Qie()}H$h(I,pa){const lb={allowUnqualifiedCell:!0,wrapCellReferences:!0};lb.config=this.Y4.config;lb.originGridCell=excelOnlineCalc.util.success(I);lb.originSheet=excelOnlineCalc.util.success(pa);return lb}G$h(){const I={};I.config=this.Y4.config;I.getNameLoc=this.yz.getNameLoc;I.getContainingTable=this.yz.getContainingTable;I.getStructRefColumn=this.yz.getStructRefColumn;I.getStructRefSpecialRef=this.yz.getStructRefSpecialRef;
I.getDocumentLoc=this.yz.getDocumentLoc;I.getSheetIndex=this.yz.getSheetIndex;I.getSheetName=this.yz.getSheetName;I.getUserDefinedFuncLoc=this.yz.getUserDefinedFuncLoc;I.getSheetRangeIndexes=this.yz.getSheetRangeIndexes;return I}static n$j(I,pa){return pa.length>I.span.end&&pa.charAt(I.span.end)===sb.pxg}};nb.ntf="ECRC";nb.jod="ActiveCellNumberFormatChanged";nb.uxd="ClientDataFlushedToWorkerKey";nb=Zd=Object(wb.__decorate)([Object(Fc.d)(Gc.G),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,
Object(Gc.F)()),Object(wb.__param)(2,Object(Gc.Vb)())],nb);Object(za.a)(nb,"CalcManager",Y.a,[638,2]);var ic=a(990),Bc=a(759),Qc=a(396);const pd=(I,pa)=>{pa=void 0===pa?!1:pa;I=new ca.Range(I.top,I.left,I.bottom,I.right,!1,pa);if(pa&&(1>I.top||I.top>I.maxRows||1>I.bottom||I.bottom>I.maxRows||I.top>I.bottom||1>I.left||I.left>I.maxColumns||1>I.right||I.right>I.maxColumns||I.left>I.right))throw ea.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");
return I};var Xd=a(1023),ue=a(1102),Ie=a(963),Je=a(123),He=a(994);const hf={[0]:[45],[1]:[46]};class rf{constructor(I,pa){this.$=I;this.sessionStorage=pa;this.doUndo=()=>{const lb=this;return xo(function*(){yield Object(Xd.e)(lb.$)})};this.highlightRangesOnGrid=(lb,hc,Xc)=>{const Gd=this;return xo(function*(){Gd.highlightRanges(lb,hc,hf[Xc])})};this.openLearnMore=()=>{const lb=this;return xo(function*(){Object(ue.b)(lb.$)})};this.openCustomNumberFormat=()=>{const lb=this;return xo(function*(){return new Promise(hc=>
{Object(Xd.a)(lb.$,Xc=>{hc(Xc);ea.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${Xc?"OK":"Cancel"}"`)})})})};this.openFeedback=lb=>{const hc=this;return xo(function*(){Object(Xd.f)(hc.$,lb)})};this.sendOtelEvent=lb=>xo(function*(){Object(Ie.c)(lb)});this.containsHiddenCells=lb=>k(this.$,lb);this.replaceMultipleStrings=(lb,hc,Xc,Gd)=>{const ae=this;return xo(function*(){const we=lb.map(Re=>pd(Re,!1));return v(ae.$,we,hc,Xc,{["SheetName"]:ae.$.la.sheetName,
["MatchCase"]:Gd.matchCase,["MatchEntireCell"]:Gd.matchEntireCell,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:hc,["ReplaceWholeWordOnly"]:Gd.replaceWholeWordOnly})})};this.trimWhitespace=(lb,hc)=>{const Xc=this;return xo(function*(){const Gd=lb.map(ae=>pd(ae,!1));return w(Xc.$,Gd,hc.map(n))})};this.formatCells=(lb,hc)=>{const Xc=this;return xo(function*(){const Gd=lb.map(we=>pd(we,!1)),ae={NumberFormatOptions:Object(Yc.a)(new He.a,{NumberFormatCategory:-1,
CustomFormatString:hc}),ValidMembers:32,NumberFormat:15};return f(Xc.$,Gd,ae)})};this.getIgnoredSuggestions=()=>{const lb=this;return xo(function*(){return lb.sessionStorage.getIgnoredSuggestions()})};this.addToIgnoredSuggestions=lb=>{const hc=this;return xo(function*(){return hc.sessionStorage.addToIgnoredSuggestions(lb)})};this.getAppliedSuggestions=()=>{const lb=this;return xo(function*(){return lb.sessionStorage.getAppliedSuggestions()})};this.addToAppliedSuggestions=lb=>{const hc=this;return xo(function*(){return hc.sessionStorage.addToAppliedSuggestions(lb)})};
this.removeFromAppliedSuggestions=lb=>{const hc=this;return xo(function*(){return hc.sessionStorage.removeFromAppliedSuggestions(lb)})}}get grid(){return Oc.f(this.$)}highlightRanges(I,pa,lb){lb=void 0===lb?[45]:lb;const hc=this.grid.Fh;hc.fr(lb,!1,!0);hc.wt(null,lb,!1);if(null===I||void 0===I?0:I.length){const Xc=Qc.a.l$a(hd.d(this.$.la),I.map(Gd=>pd(Gd,!1)));hc.wQ(Xc,lb,!0,void 0,!1);pa&&this.SIj(I)}hc.update(!1)}SIj(I){if(null===I||void 0===I?0:I.length){const pa=this.grid;[I]=I.sort((lb,hc)=>
lb.top<hc.top?-1:lb.top>hc.top?1:0);I=ca.Range.yi(I.top,I.left);pa.SD(I)||(ea.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),pa.KC(I,0,"DataCleansing"))}else ea.ULS.sendTraceTag(509617690,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(za.a)(rf,"HostAppCallbacks",null,[]);class qf{constructor(){this.annotations=[];this.hostState={isInCoauthoring:!1,isFeedbackAllowed:!1};this.worksheetState={isInNamedSheetView:!1,
isProtected:!1}}}Object(za.a)(qf,"DataCleansingHostState",null,[]);class We{constructor(I){this.$=I;this.Lqf=!1}get isEnabled(){return jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingLearnMoreTeachingCallout",!1)}show(){this.Lqf||(ea.ULS.sendTraceTag(508887310,0,20,"DataCleansing.showCallout: dispatchShowCalloutCommand."),Object(Xd.c)(this.$),this.Lqf=!0)}}Object(za.a)(We,"TeachingCallout",null,[]);var Jf=a(267),tf=a(1101);class ff{constructor(I){this.$=I;this.Kqf=!1;this.localStorage=
new Jf.a;this.Wtk()}V8a(I,pa){const lb=this;return xo(function*(){if(lb.Kqf)ea.ULS.sendTraceTag(509089825,0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else if(lb.IOk()){var hc=Object(tf.b)(I);lb.MWa||(lb.MWa=yield Fc.a.resolve(Gc.E,{va:1}));lb.MWa.OQk(hc.title,hc.message,hc.Ste,()=>{ea.ULS.sendTraceTag(508117194,0,20,"DataCleansingBusinessBar.showBusinessBar: Show suggestions was clicked.");lb.aha();lb.dJg()},()=>{ea.ULS.sendTraceTag(507789517,0,
20,'DataCleansingBusinessBar.showBusinessBar: "X" button was clicked.');lb.taj();pa()});lb.Kqf=!0;ea.ULS.sendTraceTag(509089824,0,20,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${I} suggestions.`)}else ea.ULS.sendTraceTag(507789518,0,20,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar should not be shown.")})}aha(){this.MWa&&this.MWa.vM(70)&&this.MWa.removeEntry(70)}IOk(){if(this.localStorage.zl()){const I=this.localStorage.getItem("CleanDataBBClosedCount");
return!I||this.d1f()||3>parseInt(I,10)}ea.ULS.sendTraceTag(507789516,0,20,"DataCleansingBusinessBar.shouldShowBusinessBar: Local storage is not supported.");return!0}Wtk(){this.d1f()?this.dJg():ea.ULS.sendTraceTag(507787410,0,20,"DataCleansingBusinessBar.resetBBCloseValuesIfNeeded: Last close was less than 30 days ago.")}d1f(){if(this.localStorage.zl()){const I=this.localStorage.getItem("CleanDataBBClosedDate");if(I){const pa=Date.now()-parseInt(I,10),lb=2592E6<pa;ea.ULS.sendTraceTag(507787409,0,
20,`DataCleansingBusinessBar.isLastCloseAboveCooldown: timeFromLastClose: ${pa}, lastCloseDate: ${I}, isLastCloseAboveCooldown: ${lb} `);return lb}}return!1}dJg(){this.localStorage.zl()&&(this.localStorage.removeItem("CleanDataBBClosedCount"),this.localStorage.removeItem("CleanDataBBClosedDate"),ea.ULS.sendTraceTag(507789515,0,20,"DataCleansingBusinessBar.resetBBClosedCount"))}taj(){if(this.localStorage.zl()){let I=this.localStorage.getItem("CleanDataBBClosedCount");I=I?(parseInt(I,10)+1).toString():
"1";const pa=Date.now().toString();this.localStorage.setItem("CleanDataBBClosedCount",I);this.localStorage.setItem("CleanDataBBClosedDate",pa);ea.ULS.sendTraceTag(507789514,0,20,`DataCleansingBusinessBar.increaseBBClosedCount: new count is: ${I}, new date is: ${pa}`)}}}Object(za.a)(ff,"BusinessBar",null,[]);var xf=a(922);class Lf{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(Lf,this,I)}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,
[Lf.getTypeName()])}}Lf.H_={T_:Lf.getTypeName(),B_:Lf.getBaseTypes()};class Ig{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(Ig,this,I)}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[Ig.getTypeName()])}}Ig.H_={T_:Ig.getTypeName(),B_:Ig.getBaseTypes()};class vf{get metadata(){return this.M_}set metadata(I){this.M_=
I}constructor(I){xf.a.assign(vf,this,I)}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[vf.getTypeName()])}}vf.H_={T_:vf.getTypeName(),B_:vf.getBaseTypes()};class rg{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(rg,this,I)}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,
[rg.getTypeName()])}}rg.H_={T_:rg.getTypeName(),B_:rg.getBaseTypes()};class jg{constructor(I){xf.a.assign(jg,this,I)}static getTypeName(){return"AugLoop_Tablelint_TableLintSuggestion"}static getBaseTypes(){return[]}static typeGuard(I){return xf.a.matchesTypesFor(I,[jg.getTypeName()])}}jg.H_={T_:jg.getTypeName(),B_:jg.getBaseTypes()};class sg{constructor(I){xf.a.assign(sg,this,I)}static getTypeName(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(I){return xf.a.matchesTypesFor(I,
[sg.getTypeName()])}}sg.H_={T_:sg.getTypeName(),B_:sg.getBaseTypes()};class af{constructor(I){xf.a.assign(af,this,I)}static getTypeName(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[af.getTypeName()])}}af.H_={T_:af.getTypeName(),B_:af.getBaseTypes()};class Ef{constructor(I){xf.a.assign(Ef,this,I)}static getTypeName(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(I){return xf.a.matchesTypesFor(I,
[Ef.getTypeName()])}}Ef.H_={T_:Ef.getTypeName(),B_:Ef.getBaseTypes()};class be{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(be,this,I)}static getTypeName(){return"AugLoop_ExcelCleanData_CleanDataResolverAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[be.getTypeName()])}}be.H_={T_:be.getTypeName(),B_:be.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(h,
this,I)}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class qc{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(qc,this,I)}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,
[qc.getTypeName()])}}qc.H_={T_:qc.getTypeName(),B_:qc.getBaseTypes()};class ma{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(ma,this,I)}static getTypeName(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[ma.getTypeName()])}}ma.H_={T_:ma.getTypeName(),B_:ma.getBaseTypes()};class Ab{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(Ab,
this,I)}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[Ab.getTypeName()])}}Ab.H_={T_:Ab.getTypeName(),B_:Ab.getBaseTypes()};class ec{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(ec,this,I)}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,
[ec.getTypeName()])}}ec.H_={T_:ec.getTypeName(),B_:ec.getBaseTypes()};class na{get metadata(){return this.M_}set metadata(I){this.M_=I}constructor(I){xf.a.assign(na,this,I)}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[na.getTypeName()])}}na.H_={T_:na.getTypeName(),B_:na.getBaseTypes()};class pb{get metadata(){return this.M_}set metadata(I){this.M_=
I}constructor(I){xf.a.assign(pb,this,I)}static getTypeName(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(I){return xf.a.matchesTypesFor(I,[pb.getTypeName()])}}pb.H_={T_:pb.getTypeName(),B_:pb.getBaseTypes()};class R{constructor(I,pa){this.$o=I;this.nig=pa;this.Iua=!1;this.FD=new EventTarget;this.F_g=(lb,hc)=>{if(lb=hc.annotation)switch(hc.operationType){case 1:case 2:this.FD.dispatchEvent(new CustomEvent("suggestionsAnnotationReceived",
{detail:lb}));break;case 3:break;default:ea.ULS.sendTraceTag(508560024,306,15,`AnnotationsProvider.suggestionsAnnotationHandler Received unexpected OperationType:${hc.operationType}`)}else ea.ULS.sendTraceTag(508560025,306,50,"AnnotationsProvider.suggestionsAnnotationHandler suggestionsAnnotation is null.")};this.fvk=(lb,hc)=>{if(lb=hc.annotation)switch(hc.operationType){case 1:case 2:this.FD.dispatchEvent(new CustomEvent("resolverAnnotationReceived",{detail:lb}));break;case 3:break;default:ea.ULS.sendTraceTag(508560027,
306,15,`AnnotationsProvider.resolverAnnotationHandler Received unexpected OperationType:${hc.operationType}`)}else ea.ULS.sendTraceTag(508560028,306,50,"AnnotationsProvider.resolverAnnotationHandler: resolverAnnotation is null.")};ea.ULS.sendTraceTag(507777624,0,50,"AnnotationsProvider.constructor: AnnotationsProvider is created.");this.$o=I;this.nig=pa}activateEvents(){this.Iua?ea.ULS.sendTraceTag(508560026,0,50,"AnnotationsProvider.ActivateEvents: Events are already registered"):(this.ljk(),this.Iua=
!0)}deactivateEvents(){this.Iua&&(this.w7k(),this.Iua=!1)}registerSuggestionsAnnotationReceived(I){this.FD.addEventListener("suggestionsAnnotationReceived",pa=>{pa instanceof CustomEvent&&I(null===pa||void 0===pa?void 0:pa.detail)})}registerResolverAnnotationReceived(I){this.FD.addEventListener("resolverAnnotationReceived",pa=>{pa instanceof CustomEvent&&I(null===pa||void 0===pa?void 0:pa.detail)})}w7k(){this.$o.unregister("DataCleansing")}ljk(){ea.ULS.sendTraceTag(574482312,0,50,"AnnotationsProvider.registerCleanDataEvents: activate annotations");
const I=this.$o.k6().I8("DataCleansing").H8(this.nig).activateAnnotation({annotationType:be.getTypeName(),EA:!0,pDa:this.fvk});jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugLoop.sendCleanDataAnnotationsInResolver",!1)&&jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterOnlyResolverAnnotation",!1)||(I.activateAnnotation({annotationType:vf.getTypeName(),EA:!0,pDa:this.F_g}),I.activateAnnotation({annotationType:qc.getTypeName(),EA:!0,pDa:this.F_g}));jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",
!1)&&I.activateAnnotation({annotationType:Ab.getTypeName(),EA:!0});jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",!1)&&I.activateAnnotation({annotationType:na.getTypeName(),EA:!0});jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDataOutliers",!1)&&I.activateAnnotation({annotationType:pb.getTypeName(),EA:!0});this.$o.register(I.build())}}Object(za.a)(R,"AnnotationsProvider",null,[]);var ua=a(1234),xb=a(153);class W{constructor(I,pa){this.$=
I;this.Mj=pa}isUsageRangeTable(I){const pa=Oc.f(this.$),lb=pa.Pzj;return I.worksheetName!==pa.$.la.sheetName?null:null==lb?(ea.ULS.sendTraceTag(507847903,0,20,"AnnotationsHostCallbacks.isUsageRangeTable: usedRange is null"),null):1===I.tableRange.top&&I.tableRange.bottom===lb.bottom}logCtrlAComparisonResults(I){I={["range"]:new ca.Range(I.tableRange.top,I.tableRange.left,I.tableRange.bottom-1,I.tableRange.right,!1,!1),["sheetId"]:I.worksheetId,["sheetName"]:I.worksheetName,["callback"]:this.vRd};
Object(Xd.b)(this.$,I)}getDependentFormulasSuggestionInfo(I,pa){const lb=new Set;pa.forEach(hc=>lb.add(pd(hc)));I=d(this.$,this.Mj,I,lb);return new Map(Array.from(I.entries(),hc=>{var [Xc,Gd]=hc;return[Xc.toString(),Array.from(new Set(Array.from(Gd,ae=>ae.toString())))]}))}vRd(I,pa,lb){I.Result?Ia.a.Qx(I.Errors)?(lb=Ia.a.fi(I.Errors),ea.ULS.sendTraceTag(507867614,0,15,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: result return with errors: ${lb}, AnnotationRange: ${pa}`)):(I=Kc.H(I.Result),
pa.bottom+=1,ea.ULS.sendTraceTag(507867613,0,20,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: sheetId: ${lb}, annotationRange: ${pa}, ctrlARange: ${I}, isSameRangeAsCtrl+A: ${I.toString()===pa.toString()}, isTopAndBottomAsCtrl+A: ${I.top===pa.top&&I.bottom===pa.bottom}`)):ea.ULS.sendTraceTag(507867615,0,50,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: result.Result is null. AnnotationRange: ${pa}`)}}Object(za.a)(W,"AnnotationsHostCallbacks",null,[]);class xa{constructor(I){this.$=
I}readIgnoredSuggestionsString(){return new Promise(I=>{pe.C(this.$.oa.ta,9,pa=>{if(Ia.a.ll(pa.Errors))ea.ULS.sendTraceTag(507577634,0,10,`RoamingOperations.readIgnoredSuggestions: encountered an error while reading roaming setting. Errors: ${Ia.a.fi(pa.Errors)}`),I(null);else{const lb=pa.Result?JSON.parse(pa.Result):[];ea.ULS.sendTraceTag(507577633,0,20,`RoamingOperations.readIgnoredSuggestions: ignoredSuggestionsIds.size: ${lb.length}`);I(pa.Result)}},pa=>{this.YUj(pa);I(null)},null,null)})}writeIgnoredSuggestionsString(I){pe.J(this.$.oa.ta,
9,I,pa=>{this.o3j(pa)},pa=>{this.m3j(pa)},null,null)}YUj(I){({data:I}=I);I=Se.a.$j(I);ea.ULS.sendTraceTag(507577632,0,10,`RoamingOperations.onGetIgnoredSuggestionsFromRoamingFailure: encountered errors while reading roaming setting. Errors: ${Ia.a.fi(I)}.`)}m3j(I){I=Se.a.$j(I.data);ea.ULS.sendTraceTag(507577631,0,10,`RoamingOperations.onWriteRoamingFailed: encountered errors: ${Ia.a.fi(I)}.`)}o3j(I){Ia.a.ll(I.Errors)||!I.Result?ea.ULS.sendTraceTag(507577630,0,10,`RoamingOperations.onWriteRoamingSuccess: write Failed${Ia.a.ll(I.Errors)?
", Encountered some errors. Errors: "+Ia.a.fi(I.Errors):""}`):ea.ULS.sendTraceTag(507577629,0,50,"RoamingOperations.onWriteRoamingSuccess: write Succeeded")}}Object(za.a)(xa,"RoamingOperations",null,[]);class kb{constructor(I,pa,lb,hc){this.$=I;this.EX=pa;this.pga=lb;this.Foc=hc;this.pag=new Set}fQf(){if(jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingFormulasDependencies",!1)&&hd.l(this.$.la)){var I=this.$.la.sheetId,pa=this.EX.sheetAnnotations(I);if(0<pa.length){let lb=
!1;this.pag.has(I)||(this.pag.add(I),lb=!0);this.logDependentSuggestionsInfo(I,pa,lb)}}}logDependentSuggestionsInfo(I,pa,lb){const hc=this.pga.annotationsUtils.getSuggestionAffectedRanges(pa);this.pga.suggestionsTelemetryUtils.logDependentSuggestionsInfo(I,pa,lb,this.Foc.getDependentFormulasSuggestionInfo(I,hc))}}Object(za.a)(kb,"SuggestionDependency",null,[]);var Pb;(function(I){I.None="None";I.ShowBusinessBar="ShowBusinessBar";I.HideBusinessBar="HideBusinessBar"})(Pb||(Pb={}));class T{constructor(I,
pa,lb,hc){this.$=I;this.pga=pa;this.EX=lb;this.sessionStorage=hc;this.isEnabled=!0;this.qDe=!1;this.businessBar=new ff(this.$);this.pac=new We(this.$)}d3i(I){const pa=this;return xo(function*(){pa.qDe?pa.businessBar.aha():yield pa.b3g(I)})}b3g(I){const pa=this;return xo(function*(){if(pa.isEnabled&&!pa.qDe){var lb=yield pa.tod(I),hc=pa.pga.disoverabilityUtils.getDiscoverabilityCommand(lb);lb=pa.pga.listsUtils.sum(lb.values());switch(hc){case Pb.ShowBusinessBar:yield pa.Y3k(lb);break;case Pb.HideBusinessBar:pa.businessBar.aha()}}})}njb(){this.businessBar.aha();
this.isEnabled=!1}t$a(){this.pac.isEnabled&&this.pac.show()}tod(I){const pa=this;return xo(function*(){const lb=pa.EX.sheetAnnotations(I),hc=yield pa.sessionStorage.getIgnoredSuggestions();return pa.pga.annotationsUtils.suggestionsToShowCountByType(lb,hc)})}Y3k(I){const pa=this;return xo(function*(){pa.EX.pauseAugmentationLoop("triggerBusinessBar");yield pa.businessBar.V8a(I,()=>{pa.oPj()});pa.qDe=!0})}oPj(){this.t$a()}}Object(za.a)(T,"DiscoverabilityManager",null,[]);var Za=a(1235),Db=a(1604),kc;
let Wc=kc=class extends Y.a{constructor(I,pa,lb,hc){super();this.$=I;this.pga=lb;this.Mj=hc;this.njb=!1;this.Tha=new qf;this.H0j=()=>{const Xc=this;return xo(function*(){Xc.stateChanged();if(jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)){const Gd=Xc.JRb();if(!Gd)return;yield Xc.QOb.b3g(Gd)}else yield Xc.jQf();Xc.E_g.fQf()})};this.EWj=Xc=>{this.Tha.ignoredSuggestions=Xc;this.stateChanged()};this.Bq=(Xc,Gd)=>{const ae=this;return xo(function*(){ae.R5g(Gd.OB);
ae.t_g(Gd.la);ae.stateChanged();if(jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)){const we=ae.JRb();if(!we)return;yield ae.QOb.d3i(we)}else ae.businessBar.aha(),yield ae.jQf();ae.E_g.fQf()})};this.sAa=()=>{this.stateChanged()};this.aF=()=>{this.stateChanged()};this.IA=()=>{this.$.fa.isEditMode?(void this.EX.activateEvents(),this.$.fa.gI(this.IA)):ea.ULS.sendTraceTag(507856794,0,20,"DataCleansingHostManager.onApplicationModeChanged: the workbook is not in edit mode, therefore we don't activate the events.")};
this.n2j=(Xc,Gd)=>{Xc=void 0===Xc?"Unknown":Xc;ea.ULS.sendTraceTag(520987272,0,20,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:ua.a[Xc],["errorCode"]:Gd})}`);jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8859872_SendExcelClientAriaEvents")?Object(Db.a)().sendTelemetryEvent(Object(Za.a)(ua.a[Xc],Gd)):Object(Ie.c)(Object(Za.a)(ua.a[Xc],Gd));this.Tha.hostState.errorState=Gd;this.stateChanged()};this.qia=(Xc,Gd)=>{hd.l(Gd.item)&&
Gd.item.Bn!==this.Tha.worksheetState.isProtected&&(ea.ULS.sendTraceTag(509613388,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${Gd.item.Bn}.`),this.stateChanged())};this.vAa=(Xc,Gd)=>{t(this.$,Gd)&&(jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)?this.QOb.njb():this.Vqf())};ea.ULS.sendTraceTag(507777625,0,50,"DataCleansingHostManager.constructor: DataCleansingHostManager is created.");this.sessionStorage=
lb.getOrCreateSessionStorage(new xa(this.$));jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8841974_addIgnoredSuggestionsToProps")&&this.sessionStorage.registerIgnoredSuggestionsChanged(this.EWj);this.IIh=new rf(this.$,this.sessionStorage);this.pac=new We(this.$);this.businessBar=new ff(this.$);pa=new R(pa,this.n2j);this.Foc=new W(this.$,this.Mj);this.EX=lb.createAnnotationsManger(pa,this.Foc);this.EX.registerSheetAnnotationsChanged(this.H0j);jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",
!1)&&(this.QOb=new T(this.$,this.pga,this.EX,this.sessionStorage));this.$.fa.isEditMode?void this.EX.activateEvents():this.$.fa.lK(this.IA);I.fu.vn(this.Bq);I.fa.$ea(this.aF);this.t_g(this.$.la);this.Vnc(this.vAa);this.$.Fwd(()=>{this.stateChanged()});this.E_g=new kb(I,this.EX,lb,this.Foc)}Vnc(I){this.addHandler(kc.hwe,I)}cHg(I){this.removeHandler(kc.hwe,I)}p_k(){this.EX.pauseAugmentationLoop("taskPaneClosed");jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",
!1)?this.QOb.t$a():this.t$a()}t_k(){jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)&&this.QOb.njb();this.EX.resumeAugmentationLoop("taskPaneOpened")}dispose(){this.$.fu.Nn(this.Bq);this.$.fa.l8(this.aF);this.$.fa.gI(this.IA);this.R5g(this.$.la);super.dispose()}get state(){this.Tha.annotations=this.EX.allAnnotations();if(hd.l(this.$.la)){const I=this.$.la.Bn,pa=this.$.la.sheetId,lb=this.$.la.sheetName;this.Tha.worksheetState.isInNamedSheetView=
this.$.la.Zj.px;this.Tha.worksheetState.isProtected=I;this.Tha.worksheetState.sheetId=pa;this.Tha.worksheetState.sheetName=lb}this.Tha.hostState.isInCoauthoring=this.isInCoauthoring();this.Tha.hostState.isFeedbackAllowed=this.$.isFeedbackEnabled;return this.Tha}Vqf(){this.businessBar.aha();this.njb=!0}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(kc.hwe,this.state)}t_g(I){hd.l(I)&&(I.Zj.hfb(this.sAa),I.lfb(this.qia))}R5g(I){hd.l(I)&&(I.Zj.e6b(this.sAa),I.UVc(this.qia))}JRb(){if(hd.l(this.$.la))return this.$.la.sheetId;
ea.ULS.sendTraceTag(507510927,0,50,"DataCleansingHostManager.getActiveSheetId: active item is not a sheet.")}tod(){const I=this;return xo(function*(){if(!hd.l(I.$.la))return new Map;const pa=I.EX.sheetAnnotations(I.$.la.sheetId);if(!I.pga.annotationsUtils.getAggregateAnnotation(pa))return new Map;const lb=yield I.sessionStorage.getIgnoredSuggestions();return I.pga.annotationsUtils.suggestionsToShowCountByType(pa,lb)})}jQf(){const I=this;return xo(function*(){const pa=yield I.tod(),lb=I.pga.listsUtils.sum(pa.values());
0===lb?I.businessBar.aha():I.DPk(lb,pa)&&(yield I.c4k(lb),I.njb=!0)})}t$a(){this.pac.isEnabled&&this.pac.show()}c4k(I){const pa=this;return xo(function*(){pa.EX.pauseAugmentationLoop("triggerDiscoverabilityBusinessBar");yield pa.businessBar.V8a(I,()=>{pa.SRh()})})}SRh(){this.t$a()}DPk(I,pa){var lb;if(!(lb=this.njb)){lb=this.$;var hc;(hc=t(lb,this.state))||(lb=lb.fa,hc=!lb.isEditMode&&!lb.$l());lb=hc}return lb||2>I||!pa.get("TextInconsistency")?!1:!0}};Wc.hwe="scek";Wc=kc=Object(wb.__decorate)([Object(Fc.d)(Gc.pb),
Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.r)()),Object(wb.__param)(2,Object(Gc.Qb)()),Object(wb.__param)(3,Object(Gc.G)())],Wc);Object(za.a)(Wc,"DataCleansingHostManager",Y.a,[]);var yd=a(266),Od=a(306),me=a(284),De=a(16),Le=a(962),Pe=a(19),ef=a(792);const yf=Pe.a.usi;let Kf=class extends yd.a{constructor(I,pa){let lb=document.getElementById(I.xi+Cd.a.Vuf);lb||(lb=Le.a("div",I.xi+Cd.a.Vuf,"cui-taskpane"));super(lb);this.h_=0;this.pab=!1;this.Xi=()=>{this.iF(!1)};this.$=
I;this.taskPaneManager=pa;Od.a(I).Wq(this);this.$.Pp(this.Xi);this.isVisible=!1}wua(I){this.addHandler("EnrichmentTaskPaneVilibilityChanged",I)}lBa(I){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",I)}IEh(I){this.addHandler("EnrichmentTaskPaneOnFocus",I)}Bpk(I){this.removeHandler("EnrichmentTaskPaneOnFocus",I)}get isVisible(){return super.isVisible}set isVisible(I){super.isVisible=I;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get ap(){return this.isVisible}get el(){return me.a.Kmi}get b$a(){return 10}get ay(){return yf}get titleText(){return jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")?
Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.EnrichmentPaneTitle:CommonUIStrings.l_EnrichmentPaneTitle:"Enrichment"}get WP(){return 300}get isResizable(){return!1}get ij(){return this.domElement}get height(){return this.taskPaneManager.a2c.offsetHeight}get HJ(){return this.taskPaneManager.xlb(this.ij,this.titleText,this.WP,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.WP)}pV(){return this.pab}T6(){return this.pab}dispose(){this.$&&
this.$.wu(this.Xi);this.taskPaneManager=this.$=null;super.dispose()}Lp(I,pa){pa||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!pa}wq(I){return De.DOMElementExtensions.Co(this.ij,I)}Rs(){}nu(){}iF(I){(this.isVisible=this.pab=I)?this.taskPaneManager.ZH("EnrichmentTaskPane",this.HJ):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane");I||(Oc.f(this.$).Lp(!0,!1),this.$.Fm())}};Kf=Object(wb.__decorate)([Object(Fc.d)(Gc.Mb),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.lf)()),
Object(wb.__param)(2,Object(ef.b)()),Object(wb.__param)(3,Object(Gc.eb)())],Kf);Object(za.a)(Kf,"EnrichmentTaskPane",yd.a,[633,2,226,42]);var ig=a(548),kg=a(323);Object(Fc.b)(Gc.Qb,{rk:"singleton"})(I=>xo(function*(){yield Object(kg.b)("excelCleanData",{va:I.va});const pa=window.excelCleanData.ExcelCleanDataGlobal;pa.init(new ig.a);ea.ULS.shipAssertTag(507777623,0,!!pa,"Failed to initialize ExcelCleanDataGlobal");return pa}));var vg=a(37);let yg=class{constructor(I,pa){this.$=I;this.shortcutKeyManager=
pa;this.Jig=()=>{this.U$a(this.$.fa.oRa,this.$.fa.O6a);this.S$k()};this.isMac=vg.a.isMac;jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8368791_ExtendedTooltips_NewArchitecture_UndoRedo")||this.shortcutKeyManager.h5e(this.Jig)}dispose(){jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8368791_ExtendedTooltips_NewArchitecture_UndoRedo")||this.shortcutKeyManager.aGg(this.Jig);this.$=null}qGk(){const I=this.A0h.concat(this.iIj).map(pa=>appChrome.actions.setControlCustomTooltip(pa.commandId,this.Bmb(pa)));
appChrome.api.dispatch(I)}U$a(I,pa){this.X6k&&(this.sX[0].title=this.sX[2].title=this.vAb(I),this.sX[1].title=this.Jbc(pa),this.sX[1].shortcut=this.isMac?this.shortcutKeyManager.Nk(192):this.shortcutKeyManager.Nk(154));I=this.Bmb(this.sX[1]);pa=this.Bmb(this.sX[2]);I=[appChrome.actions.setControlCustomTooltip(this.sX[0].commandId,this.Bmb(this.sX[0])),appChrome.actions.setControlCustomTooltip(this.sX[1].commandId,I),appChrome.actions.setControlCustomTooltip(this.sX[2].commandId,pa)];appChrome.api.dispatch(I)}get iIj(){this.mR||
(this.mR=[],this.mR.push(this.Ep("Paste_MLR",$a.a.instance.Aa(513),$a.a.instance.Aa(767),this.shortcutKeyManager.Nk(176))),this.mR.push(this.Ep("Cut",$a.a.instance.Aa(511),$a.a.instance.Aa(768),this.shortcutKeyManager.Nk(172))),this.mR.push(this.Ep("Copy",$a.a.instance.Aa(512),$a.a.instance.Aa(769),this.shortcutKeyManager.Nk(174))),this.mR.push(this.Ep("AlignTop_MLR",$a.a.instance.Aa(791),$a.a.instance.Aa(792))),this.mR.push(this.Ep("AlignMiddle_MLR",$a.a.instance.Aa(793),$a.a.instance.Aa(794))),
this.mR.push(this.Ep("AlignBottom_MLR",$a.a.instance.Aa(795),$a.a.instance.Aa(796))),this.mR.push(this.Ep("AlignLeft_MLR",$a.a.instance.Aa(797),$a.a.instance.Aa(799))),this.mR.push(this.Ep("AlignCenter_MLR",$a.a.instance.Aa(800),$a.a.instance.Aa(801))),this.mR.push(this.Ep("AlignRight_MLR",$a.a.instance.Aa(802),$a.a.instance.Aa(803))),this.mR.push(this.Ep("IncreaseIndent",$a.a.instance.Aa(804),$a.a.instance.Aa(805))),this.mR.push(this.Ep("DecreaseIndent",$a.a.instance.Aa(806),$a.a.instance.Aa(807))),
this.mR.push(this.Ep("Wrap",$a.a.instance.Aa(808),$a.a.instance.Aa(809))),this.mR.push(this.Ep("Merge",$a.a.instance.Aa(810),$a.a.instance.Aa(811))),this.mR.push(this.Ep("NumberFormatPercentage_MLR",$a.a.instance.ia(453),$a.a.instance.Aa(814),this.shortcutKeyManager.Nk(404))),this.mR.push(this.Ep("NumberFormatComma_MLR",$a.a.instance.Aa(815),$a.a.instance.Aa(816))));return this.mR}get A0h(){this.lw||(this.lw=[],this.lw.push(this.Ep("UndoRedo",$a.a.instance.Aa(83),"",this.isMac?this.shortcutKeyManager.Nk(191):
this.shortcutKeyManager.Nk(153))),this.lw.push(this.Ep("FormatPainter",$a.a.instance.ia(14),$a.a.instance.Aa(770))),this.lw.push(this.Ep("FontName_New",$a.a.instance.Aa(771),$a.a.instance.Aa(772))),he.a.Xk()&&this.lw.push(this.Ep("FontPicker",$a.a.instance.Aa(771),$a.a.instance.Aa(772))),this.lw.push(this.Ep("FontSize",$a.a.instance.Aa(773),$a.a.instance.Aa(774))),this.lw.push(this.Ep("Bold",$a.a.instance.ia(1333),$a.a.instance.Aa(775),this.isMac?this.shortcutKeyManager.Nk(180):this.shortcutKeyManager.Nk(179))),
this.lw.push(this.Ep("Italic",$a.a.instance.ia(1334),$a.a.instance.Aa(776),this.isMac?this.shortcutKeyManager.Nk(184):this.shortcutKeyManager.Nk(183))),this.lw.push(this.Ep("BordersSplitButtonCompactMenu",$a.a.instance.Aa(777),$a.a.instance.Aa(779),this.isMac?this.shortcutKeyManager.Nk(190):this.shortcutKeyManager.Nk(189))),this.lw.push(this.Ep("FillColor",$a.a.instance.ia(537),$a.a.instance.Aa(780))),this.lw.push(this.Ep("FontColor",$a.a.instance.Aa(781),$a.a.instance.Aa(782))),this.lw.push(this.Ep("GrowFontSize",
$a.a.instance.Aa(783),$a.a.instance.Aa(784),this.shortcutKeyManager.Nk(187))),this.lw.push(this.Ep("ShrinkFontSize",$a.a.instance.Aa(785),$a.a.instance.Aa(786),this.shortcutKeyManager.Nk(188))),this.lw.push(this.Ep("Underline",$a.a.instance.ia(1335),$a.a.instance.Aa(787),this.isMac?this.shortcutKeyManager.Nk(182):this.shortcutKeyManager.Nk(181))),this.lw.push(this.Ep("Strikethrough",$a.a.instance.ia(1336),$a.a.instance.Aa(788),this.isMac?this.shortcutKeyManager.Nk(186):this.shortcutKeyManager.Nk(185))),
this.lw.push(this.Ep("DoubleUnderline",$a.a.instance.Aa(789),$a.a.instance.Aa(790))),this.lw.push(this.Ep("NumberFormatNew",$a.a.instance.Aa(812),$a.a.instance.Aa(813))),this.lw.push(this.Ep("NumberFormatAccountingNew",$a.a.instance.ia(449),$a.a.instance.Aa(817))),this.lw.push(this.Ep("IncreaseDecimal",$a.a.instance.Aa(818),$a.a.instance.Aa(819))),this.lw.push(this.Ep("DecreaseDecimal",$a.a.instance.Aa(820),$a.a.instance.Aa(821))),this.lw.push(this.Ep("ConditionalFormatting",$a.a.instance.Aa(822),
$a.a.instance.Aa(823))),this.lw.push(this.Ep("CellStylesGallery",$a.a.instance.Aa(824),$a.a.instance.Aa(825))),this.lw.push(this.Ep("FormatAsTableAlt",$a.a.instance.Aa(826),$a.a.instance.Aa(827))),this.lw.push(this.Ep("Format",$a.a.instance.Aa(828),$a.a.instance.Aa(829))),this.lw.push(this.Ep("AutoSum",$a.a.instance.Aa(830),$a.a.instance.Aa(831),this.shortcutKeyManager.Nk(259))),this.lw.push(this.Ep("SortAndFilter",$a.a.instance.Aa(832),$a.a.instance.Aa(833))),this.lw.push(this.Ep("FindAndSelect",
$a.a.instance.Aa(834),$a.a.instance.Aa(835),this.shortcutKeyManager.Nk(85))),this.lw.push(this.Ep("AnalyzeData",$a.a.instance.Aa(836),$a.a.instance.Aa(837))),this.lw.push(this.Ep("Sensitivity",$a.a.instance.Aa(838),$a.a.instance.Aa(839))),this.lw.push(this.Ep("InsertCells",$a.a.instance.ia(345),$a.a.instance.Aa(840),this.shortcutKeyManager.R7?this.shortcutKeyManager.Nk(409):"")),this.lw.push(this.Ep("DeleteCells",$a.a.instance.ia(409),$a.a.instance.Aa(841),this.shortcutKeyManager.R7?this.shortcutKeyManager.Nk(407):
"")),this.lw.push(this.Ep("ClearCells",$a.a.instance.Aa(842),$a.a.instance.Aa(843))));return this.lw}get X6k(){this.sX||(this.sX=[],this.sX.push(this.Ep("Undo",this.vAb(2),$a.a.instance.Aa(765),this.isMac?this.shortcutKeyManager.Nk(191):this.shortcutKeyManager.Nk(153))),this.sX.push(this.Ep("Redo",this.Jbc(2),$a.a.instance.Aa(766),this.isMac?this.shortcutKeyManager.Nk(192):this.shortcutKeyManager.Nk(154))),this.sX.push(this.Ep("UndoRedo",this.vAb(2),"",this.isMac?this.shortcutKeyManager.Nk(191):this.shortcutKeyManager.Nk(153))));
return this.sX}Ep(I,pa,lb,hc){return{commandId:I,title:pa,description:lb,shortcut:hc,U7i:hc?!0:!1}}Bmb(I){let pa;pa=I.title;I.U7i&&(pa+=" "+I.shortcut);"UndoRedo"!==I.commandId&&(pa+="\n\n"+I.description);return pa}vAb(I){switch(I){case 1:case 0:return I=$a.a.instance.Aa(81);case 3:return I=$a.a.instance.Aa(84);case 2:return I=$a.a.instance.Aa(83);case 4:return I=$a.a.instance.Aa(82);default:return I=$a.a.instance.Aa(81)}}Jbc(I){switch(I){case 1:case 0:return I=$a.a.instance.Aa(78);case 2:return I=
$a.a.instance.Aa(80);case 4:return I=$a.a.instance.Aa(79);default:return I=$a.a.instance.Aa(78)}}S$k(){var I=this.Ep("InsertCells",$a.a.instance.ia(345),$a.a.instance.Aa(840),this.shortcutKeyManager.R7?this.shortcutKeyManager.Nk(409):"");const pa=this.Ep("DeleteCells",$a.a.instance.ia(409),$a.a.instance.Aa(841),this.shortcutKeyManager.R7?this.shortcutKeyManager.Nk(407):"");I=[appChrome.actions.setControlCustomTooltip(I.commandId,this.Bmb(I)),appChrome.actions.setControlCustomTooltip(pa.commandId,
this.Bmb(pa))];appChrome.api.dispatch(I)}};yg=Object(wb.__decorate)([Object(Fc.d)(Gc.Wb),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.cg)())],yg);Object(za.a)(yg,"ExtendedTooltipsManager",null,[2]);var ag=a(1055),gg=a(90);let ch=class extends Y.a{constructor(I){super();this.statusBarManager=null;this.tooltip=this.xqb="";this.isVisible=!1;this.hac=-1;this.sheetName=null;this.Gp=()=>{this.Cbc();this.$.fa.az(this.Gp)};this.JB=()=>{this.Cbc();this.$.fa.hBa(this.JB)};this.smg=()=>
{this.Cbc(!0);this.$.fa.hBa(this.smg)};this.g_j=pa=>{if(this.isVisible&&this.xqb){pa=this.da.oh.Ml(pa);var lb=this.$.sa.la;if(pa?pa.hasAutoFilter&&pa.vWa:lb&&0===lb.IG&&lb.hasAutoFilter&&lb.vWa)this.X8b($a.a.instance.ia(2421),!0,pa?this.YPd(pa.name):this.XPd()),this.ew()}};this.G2b=()=>{this.Cbc()};this.$=I;this.da=Oc.f(this.$);this.ha=this.da.ha;this.pa=this.ha.pa;this.ha.cx(this.G2b);this.$.qa.zi(29,pa=>{this.statusBarManager=pa;pa.vO(this)});this.$.fa.Vm?this.Cbc():this.$.fa.rv(this.Gp)}ry(I){this.addHandler("FilteredResultsStateChangedEventKey",
I)}fy(I){this.removeHandler("FilteredResultsStateChangedEventKey",I)}ew(){this.Up("QueryFilteredResultsButton")&&this.raiseEvent("FilteredResultsStateChangedEventKey")}Wrc(){this.isVisible&&this.xqb&&(this.X8b(null,!1,null),this.ew())}b$k(I,pa){this.hac=I;this.sheetName=pa}X8b(I,pa,lb){this.xqb=I;this.isVisible=pa;this.tooltip=lb}fCa(I,pa,lb){lb=void 0===lb?-1:lb;null!==I&&I.HasFilters?(this.b$k(pa?lb:-1,this.$.sa.la.name),lb=new ca.Range(I.FirstRow+1,I.FirstColumn+1,I.LastRow+1,I.LastColumn+1,!1,
!1),lb=pa?this.da.oh.Ml(lb):void 0,this.X8b(this.xqb=String.format($a.a.instance.sh(233),I.NumRowsFiltered,I.LastRow-I.FirstRow),!0,pa?this.YPd(null===lb||void 0===lb?void 0:lb.name):this.XPd()),this.ew()):(ea.ULS.sendTraceTag(507852319,0,50,"FilteredResultsStatusBarManager: EwaResult is null. All filters of that object will be cleared"),this.Wrc())}Cbc(I){I=void 0===I?!1:I;if(!this.da.isEditing&&!this.da.kq){var pa=!1,lb=this.$.sa.la,hc=this.da.oh.Ml(this.pa.activeCell);if(hc&&(I||hc.objectId!==
this.hac))if(this.hac=hc.objectId,this.sheetName=lb.name,hc.hasAutoFilter&&hc.vWa)this.X8b($a.a.instance.ia(2421),!0,this.YPd(hc.name)),pa=!0;else{this.Wrc();return}else if(!hc&&lb&&0===lb.IG){if(!this.sheetName||0<this.hac||I||lb.name!==this.sheetName)this.sheetName=lb.name,lb.hasAutoFilter&&lb.vWa?lb.AL&&(this.X8b($a.a.instance.ia(2421),!0,this.XPd()),pa=!0):this.xqb&&this.Wrc();this.hac=-1}pa&&this.ew()}}Up(){return jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",
!1)}Aw(I,pa){if("QueryFilteredResultsButton"!==I)return!1;pa[ag.a.Visible]=this.isVisible;pa[ag.a.LabelText]=this.xqb;window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.setControlCustomTooltip(gg.a.PHd,this.tooltip))},0);return!0}dispose(){this.$&&this.ha.Bx(this.G2b);this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null);this.$=null;super.dispose()}YPd(I){return $a.a.instance.ia(2422)+`${I?": "+I:""}`}XPd(){return $a.a.instance.ia(2423)}};ch=Object(wb.__decorate)([Object(Fc.d)(Gc.mc),
Object(wb.__param)(0,Object(Gc.Ob)())],ch);Object(za.a)(ch,"FilteredResultsStatusBarManager",Y.a,[2,176,177]);var Eg=a(224);class ph{constructor(I){this.$=I}get Mrd(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get zkj(){return this.isEnabled()&&jd.EwaSettings.Na(295)}get aqb(){return this.isEnabled()&&jd.EwaSettings.Na(297)}get Ypb(){return jd.EwaSettings.Na(296)}get Myi(){return null}get feg(){return 24}get PKg(){return 4E3}get k7b(){return this.$.ua.WebServiceBase||
""}isEnabled(){if(Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.ka("IsAnonymousUser"):1)return!1;const I=Aa.AFrameworkApplication.mi?Object(Bb.a)(String,Aa.AFrameworkApplication.mi.AudienceGroup):"";return"Unknown"!==I&&"Automation"!==I}}Object(za.a)(ph,"FirstRunExperienceLauncherSettings",null,[601]);let Rg=class{constructor(I){this.zBf=Eg.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher");this.Ayi=new ph(I);this.gue()}gue(){this.zBf&&this.zBf.gue(this.Ayi)}};
Rg=Object(wb.__decorate)([Object(Fc.d)(Gc.qc),Object(wb.__param)(0,Object(Gc.Ob)())],Rg);Object(za.a)(Rg,"FirstRunExperienceManager",null,[577]);var Dg=a(246),fb=a(1233);let Va=class{constructor(I,pa){this.A3a=1;this.aua=[];this.active=!1;this.rG=()=>{const lb=this.da.cQd();if(!(0>=lb||lb===this.A3a)){var hc=!1,Xc=[],Gd=[];for(var ae=this.aua.length-1;0<=ae;ae--){var we=this.aua[ae];if(this.bQd(we)>lb||we.bottom<lb)Xc.push(we),this.aua.splice(ae,1),hc=!0}for(ae=this.Qj.rangeList.length-1;0<=ae;ae--){we=
this.Qj.rangeList[ae];const Re=this.bQd(we);Re<=lb&&we.bottom>=lb&&!(Re<=this.A3a&&we.bottom>=this.A3a)&&we.Zxa&&(Gd.push(we),hc=!0)}if(hc){we=this.da.w3b;for(const Re of we)for(const lf of Re)for(const hg of lf)this.BXh(hg,Xc,Gd)}else ea.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.A3a=lb}};this.Jmg=(lb,hc)=>{hc.isRow||hc.Lqd(this.JEc)};this.Kmg=(lb,hc)=>{hc.isRow||(this.Qj.rangeList.length||this.deactivate(),hc.Bke(this.JEc))};
this.JEc=(lb,hc)=>{if(this.Sj())this.activate();else if(lb=this.active,this.deactivate(),!lb){ea.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(hc=hc.Uu)&&this.oYg(hc)};this.Wpg=(lb,hc)=>{!this.da.ez&&(this.Sj()?this.activate():(lb=this.active,this.deactivate(),lb||ea.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),hc=hc.Uu)&&(lb=fb.a(hc.uSd),this.oYg(hc)&&
hc.CQg(lb))};this.onActiveItemChanged=()=>{this.da.fh.nx?this.deactivate():this.activate()};this.Qj=I;this.da=pa;this.$=pa.$;I.xqd(this.Wpg);pa.HDh(this.Jmg);pa.IDh(this.Kmg);this.$.sa.vn(this.onActiveItemChanged);this.$.$h.vn(this.onActiveItemChanged);this.O9e(lb=>{lb.Lqd(this.JEc)});this.Sj()&&(this.activate(),this.rG(this,null))}dispose(){this.deactivate();this.da&&(this.Qj.qke(this.Wpg),this.da.Iok(this.Jmg),this.da.Jok(this.Kmg),this.$.sa.Nn(this.onActiveItemChanged),this.$.$h.Nn(this.onActiveItemChanged),
this.O9e(I=>{I.Bke(this.JEc)}));this.da=this.Qj=this.aua=null}K2c(I,pa,lb){if(!hd.b(this.$.la)||this.$.fa.isNamedObjectViewMode||this.da.fh.r$a)return pa&&ea.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const hc=lb.qOf();if(!hc)return ea.ULS.sendTraceTag(508368917,0,15,`HeaderSnappingFeature.toggleHeaderSnapping: HeaderNumbers should have been initialized, isActivate=${pa}, headerViewBlock.hashCode=${lb.hashCode}`),
!1;var Xc=hc.length;if(hc[Xc-1]<I.left)return!1;var Gd=td.HelperMethods.nK(new Dg.a(hc),0,Xc,I.left,td.HelperMethods.SS);if(0>Gd)return!1;const ae=I.X1g,we=I.Baf;Xc=Math.min(ae.length+Gd,Xc);let Re=0;if(!we)return ea.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;Gd<Xc;Gd++){const lf=hc[Gd],hg=we[Re];pa?(lb.updateCellText(Gd,ae[Re]),lb.updateCellAlignment(Gd,!0),hg&&(lb.activateCellAutoFilter(Gd,hg),this.Rzh(I,Re,lf)),
jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&lb.o7g(Gd,!0)):(lb.updateCellText(Gd,ca.Range.WO(lf)),lb.updateCellAlignment(Gd,!1),lb.deactivateCellAutoFilter(Gd),jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&lb.o7g(Gd,!1),this.Bji(lf));pa&&lb.nGk();Re++}lb.zr("HeaderSnappingFeature::toggleHeaderSnapping");I.u9a=pa;return!0}Rzh(I,pa,lb){Gc.hb.Ma()?void Fc.a.uj(Gc.hb).then(hc=>{jd.EwaSettings.$Xb()?null===hc||void 0===
hc?void 0:hc.rJa.cae(I,pa,lb):hc.rJa.cae(I,pa,lb)}):this.$.qa.zi(8,hc=>{hc.rJa.cae(I,pa,lb)})}Bji(I){Gc.hb.Ma()?void Fc.a.uj(Gc.hb).then(pa=>{jd.EwaSettings.$Xb()?null===pa||void 0===pa?void 0:pa.rJa.dae(I):pa.rJa.dae(I)}):this.$.qa.zi(8,pa=>{pa.rJa.dae(I)})}BXh(I,pa,lb){if(I.mUh()){for(var hc=pa.length-1;0<=hc;hc--)this.K2c(pa[hc],!1,I)&&(ea.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),pa.splice(hc,1));for(pa=lb.length-1;0<=pa;pa--)hc=
lb[pa],this.K2c(hc,!0,I)&&(ea.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.aua.push(hc))}else ea.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}oYg(I){var pa=I.qOf();if(!pa)return ea.ULS.sendTraceTag(508368916,0,15,`HeaderSnappingFeature.snapHeadersAfterGetRange: HeaderNumbers should have been initialized, headerViewBlock.hashCode=${I.hashCode}`),!1;const lb=pa[0];
pa=pa[pa.length-1];const hc=this.U_i(lb,pa);let Xc=!1;for(let Gd=this.aua.length-1;0<=Gd;Gd--){const ae=this.aua[Gd];pa>=ae.left&&lb<=ae.right&&(this.K2c(ae,!1,I),this.aua.splice(Gd,1),Xc=!0)}for(let Gd=0,ae=hc.length;Gd<ae;Gd++)this.K2c(hc[Gd],!0,I)&&(this.aua.push(hc[Gd]),Xc=!0);return Xc}activate(){this.Sj()&&!this.active&&(this.da.view.uz(this.rG),this.active=!0)}deactivate(){this.active&&(this.da.view.gy(this.rG),this.active=!1)}Sj(){return hd.b(this.$.la)&&!this.$.fa.isNamedObjectViewMode&&
0>=this.da.fh.QJ&&0<this.Qj.rangeList.length}O9e(I){const pa=this.da.w3b;for(const lb of pa)for(const hc of lb)for(const Xc of hc)I(Xc)}U_i(I,pa){const lb=[];if(!this.active)return lb;this.A3a=this.da.cQd();for(let hc=this.Qj.rangeList.length-1;0<=hc;hc--){const Xc=this.Qj.rangeList[hc];Xc.bottom>=this.A3a&&this.bQd(Xc)<=this.A3a&&Xc.left>=I&&Xc.right<=pa&&Xc.Zxa&&lb.push(Xc)}return lb}bQd(I){const pa=this.da.oh.Ml(I);return pa&&this.Qj.s0f(I,pa.usedRange.topLeft)?I.top+1:I.top}};Va=Object(wb.__decorate)([Object(Fc.d)(Gc.md),
Object(wb.__param)(0,Object(Gc.yg)()),Object(wb.__param)(1,Object(Gc.kd)())],Va);Object(za.a)(Va,"HeaderSnappingFeature",null,[2]);var bd=a(146),je=a(432),se=a(66),Xe=a(939);Object(Fc.b)(Gc.wd,{rk:"singleton"})(()=>xo(function*(){const I=Eg.a.instance.rI("Common.IInProductMessagingUIManager"),pa=()=>{Eg.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(lb=>{void lb.isFeatureEnabled("MsoPremiumBadge",!0).then(hc=>{!hc&&lb.isFreemiumUpsellEnabled()&&I.s3d();return null})})};
se.a.Zl.Iw?bd.a.get_instance().Hm(16,()=>{pa()}):pa();return I}));class wf extends je.a{constructor(I){super();this.WTd=null;this.$=I;this.sn()}create(){const I=Object(Xe.a)(this.$.qa,361,()=>this.f8h());this.dl(I)}f8h(){this.WTd=Eg.a.instance.rI("Common.IInProductMessagingUIManager");se.a.Zl.Iw?bd.a.get_instance().Hm(16,()=>{this.AWf()}):this.AWf();return this.WTd}AWf(){Eg.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(I=>{I.isFeatureEnabled("MsoPremiumBadge",
!0).then(pa=>{!pa&&I.isFreemiumUpsellEnabled()&&this.WTd.s3d();return null})})}static Ga(I){I.qa.Rh(362,new wf(I))}}Object(za.a)(wf,"InProductMessagingManagerFactory",je.a,[]);var Nf=a(1107),fg=a(256),Of=a(688);class Bg extends Sys.EventArgs{constructor(){super()}}Object(za.a)(Bg,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var uf=a(58),Lg=a(42),zg=a(748);class mh{constructor(I){this.data=I}}Object(za.a)(mh,"NumberFormatDataHolder",null,[]);var Cg;let Sf=Cg=class extends Y.a{constructor(I){super();
this.s2d=Yb.a.Ek;this.kvd=null;this.QAb=this.wLc=!1;this.Mhg=(pa,lb)=>{var hc;(pa=Oc.f(this.$))&&(lb=null!==(hc=lb.cell)&&void 0!==hc?hc:pa.yh(null))&&this.Lra(lb.cell.to,!0)};this.sUj=pa=>{this.isActive()&&(Ia.a.Qx(pa.Errors)||!pa.Result?(pa=pa.Errors?pa.Errors.map(lb=>JSON.stringify(lb)).join(","):"None",ea.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${pa}`)):(pa=pa.Result,ea.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${pa.Index}, category = ${pa.Category}`),
this.qHk(pa.Index,pa.Category),this.raiseEvent(Cg.$vd,new Nf.a(pa.Index,pa.Category),this)))};this.refresh=()=>{ea.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.krc();this.isActive()&&this.fa.Kh.allowEdits&&(this.QAb||this.sx&&!(this.fa.UC>this.s2d)?this.W5c():(ea.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.wNd=Of.a(this.$.oa.ta,this.sx?this.sx.Digest:"",this.cVj,
this.bVj,null,null)),ea.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.rIf())};this.dmg=pa=>{ea.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${pa.data.status}, HTTP status = ${pa.data.httpStatus}.`);this.C_a=null};this.j2=()=>{this.QAb=!1;this.fa.nL(this.j2);this.Y7a(this.wLc?Cg.rse:Cg.D8d)};this.hj=(pa,lb)=>{ea.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");
fg.a(lb)&&this.Y7a(Cg.rse)};this.Wl=()=>{ea.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.N8d(0===this.$.workbookContext.CalcMode)};this.Dj=()=>{ea.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.Y7a(Cg.rse);3!==this.$.workbookContext.CalcMode&&this.N8d(0===this.$.workbookContext.CalcMode)};this.UUj=(pa,lb,hc)=>{ea.ULS.sendTraceTag(537155712,
0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.C_a=null;this.isActive()?pa.StateId===Yb.a.Ek?(ea.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.W5c()):!pa.Result||this.T9&&this.T9.length?this.Y7a(Cg.D8d):this.pqg(pa,lb,hc):ea.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.pqg=pa=>{this.T9=
pa.Result;ea.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.T9?this.T9.length:-1} functions.`);pa=!1;if(this.T9){for(const lb of this.T9)lb&&(this.zDf[lb.NameUI.toLocaleUpperCase()]=lb.FunctionIndex.toString(),lb.NameUI!==lb.NameDataStrings&&(this.zDf[lb.NameDataStrings.toLocaleUpperCase()]=lb.FunctionIndex.toString(),pa=!0),this.QBi.ga(lb.FunctionIndex,lb.NameUI));this.raiseEvent(Cg.dKd,Sys.EventArgs.Empty,
this)}pa&&ea.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.cVj=pa=>{if(this.isActive())if(ea.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.wLc=!1,this.s2d=pa.StateId,this.s2d===Yb.a.Ek)this.wLc=!0,this.W5c();else{if(pa.Result){var lb=this.sx;this.sx=pa.Result;ea.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.sx.Digest}.`);pa=[];
if(lb)pa=Cg.nRi(lb.NumberFormats,this.sx.NumberFormats);else for(lb=0;lb<this.sx.NumberFormats.length;lb++)this.SOc.ga(lb,this.sx.NumberFormats[lb].NumberFormatCategory);for(const hc of pa)this.SOc.ga(hc,this.sx.NumberFormats[hc].NumberFormatCategory);this.raiseEvent(Cg.f9d,new Bg(pa),this);this.raiseEvent(Cg.g9f)}this.Y7a(Cg.D8d)}};this.bVj=pa=>{this.isActive()&&(10===pa.data.status?ea.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(ea.ULS.sendTraceTag(21311555,
0,10,`Failed to update instantaneous support information, status = ${pa.data.status}, HTTP status = ${pa.data.httpStatus}.`),this.wLc=!0,this.W5c()))};ea.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.fa=I.fa;this.$=I;this.sx=this.C_a=this.wNd=this.o5b=null;this.SOc=new Ff.a;this.WRb=new Ff.a;this.T9=[];this.QBi=new Ff.a;this.zDf={};this.fa.Nq(this.hj);this.$.nr(this.Dj);Oc.f(this.$).ha.wGa(this.Mhg);this.fa.vz(this.Wl);this.Y7a(Cg.bVf);ea.ULS.sendTraceTag(537155736,
0,50,"InstantaneousSupportInformationManager ctor end")}gqd(I){this.addHandler(Cg.f9d,I)}KVc(I){this.removeHandler(Cg.f9d,I)}ACh(I){this.addHandler(Cg.$vd,I)}Knk(I){this.removeHandler(Cg.$vd,I)}B5e(I){this.addHandler(Cg.dKd,I)}Vje(I){this.removeHandler(Cg.dKd,I)}oEh(I){this.addHandler(Cg.g9f,I)}get zk(){return this.sx?this.sx.LocaleInformation:null}get vNa(){return this.sx?this.sx.NumberFormats:[]}get bxa(){this.T9&&this.T9.length||this.rIf();return this.T9}get bgj(){return this.sx&&void 0!==this.sx.InstantaneousCalcWebWorkerPrecisionSamplingRate&&
null!==this.sx.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.sx.InstantaneousCalcWebWorkerPrecisionSamplingRate:Cg.ndi}get egj(){return this.sx&&void 0!==this.sx.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.sx.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.sx.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:Cg.rdi}get dgj(){return this.sx&&void 0!==this.sx.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.sx.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?
this.sx.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:Cg.qdi}get cgj(){return this.sx&&void 0!==this.sx.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.sx.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.sx.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:Cg.pdi}get TVb(){return this.sx?this.sx.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:Cg.odi}get rGc(){return null!==this.kvd?this.kvd:!1}A5k(I){let pa;if(!I)return{returnValue:!0,category:"General"};
let lb;pa="";if(!(()=>{let hc=this.Lra(I,!1);({category:lb}=hc);return hc})().returnValue)return{returnValue:!1,category:pa};pa=this.F3h(lb);return{returnValue:!0,category:pa}}F3h(I){let pa="";switch(I){case 0:pa="General";break;case 1:pa="Number";break;case 2:pa="Currency";break;case 3:pa="Accounting";break;case 4:pa="Date";break;case 5:pa="Time";break;case 6:pa="Percentage";break;case 7:pa="Fraction";break;case 8:pa="Scientific";break;case 9:pa="Text";break;case 10:pa="Special";break;case 11:pa=
"Custom"}return pa}Lra(I,pa){let lb,hc=(()=>{let Xc=this.SOc.tj(I,0);({value:lb}=Xc);return Xc})().returnValue;!hc&&0<I&&this.$&&(ea.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${I}`),this.NHi(I),pa&&(lb=this.MHi(I),hc=!0),zg.a(I,this.$.SN)&&(lb=6));return{returnValue:hc,category:lb}}Emj(I){let pa=0;if((()=>{let lb=this.Lra(I,!0);({category:pa}=lb);return lb})().returnValue)return 6===
pa;ea.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${I}`);return!1}mAi(I){this.fa.ki&&(ea.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions"),this.C_a=Cb.p(this.$.oa.ta,{FilterType:0},zc.c(this.pqg,I),this.dmg,null,null,null))}HCf(){this.Y7a(Cg.bVf)}h7h(){return Object(nf.c)(this.zk.ErrorNames)?(ea.ULS.shipAssertTag(508699781,
0,!1,"ErrorNames undefined"),this.HKi()):this.zk.ErrorNames.map((I,pa)=>excelOnlineCalc.calc.errorTypeName(pa+1,I))}HKi(){const I=[],pa=Object.keys(Yb.a.errorNames);for(let lb=0;lb<pa.length;lb++){const hc=excelOnlineCalc.calc.errorTypeName(lb+1,pa[lb]);hc&&I.push(hc)}return I}N8d(I){this.kvd=I}NHi(I){if(this.WRb&&this.$){var pa;if(!(()=>{let hc=this.WRb.tj(I);({value:pa}=hc);return hc})().returnValue||pa.isCompleted){ea.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${I}`);
var lb=Of.c(this.$.oa.ta,I,this.sUj,null,null,null);lb&&this.WRb.ga(I,lb)}}else ea.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}MHi(I){return 1<=I&&8>=I?1:9<=I&&12>=I?2:13===I||14===I?6:15===I?8:17===I|18===I?7:19===I?4:16===I||20<=I&&29>=I||31===I?11:30===I?9:32<=I&&35>=I?3:0}isActive(){const I=void 0===this.fa||null===this.fa,pa=!I&&this.fa.ki;ea.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${pa} - sessionStateManager IsNullOrUndefined: ${I}`);
return pa}qHk(I,pa){this.SOc.ga(I,pa)}dispose(){Xa.a.gh(this.o5b);this.o5b=null;this.krc();for(const I of this.WRb){const pa=I.value;pa&&!pa.isCompleted&&Aa.AFrameworkApplication.lj.lD(pa.rC)}this.WRb=null;this.fa&&(this.fa.Lq(this.hj),this.QAb&&this.fa.nL(this.j2),this.QAb=!1,this.fa.SB(this.Wl));this.fa=null;this.$&&Oc.f(this.$)&&Oc.f(this.$).ha&&(Oc.f(this.$).ha.fBa(this.Mhg),this.$.$r(this.Dj));this.$=null;super.dispose()}isFeatureEnabled(I){try{switch(I){case "LocaleLongDateFormat":return jd.EwaSettings.Na(184);
case "GetLocaleDayNames":return jd.EwaSettings.Na(185);case "OfficeVSO:3657744_CalcFixForDateFormat":return jd.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return jd.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);
case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return jd.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return jd.EwaSettings.Na(101);default:return I.startsWith("OfficeVSO:")?jd.EwaSettings.isChangeGateEnabled(I):!1}}catch(pa){return ea.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${I}): feature parsing failed, returning false. Exception: ${pa.toString()}.`),!1}}Y7a(I){this.isActive()&&
this.fa.Kh.allowEdits?(Xa.a.gh(this.o5b),this.o5b=null,this.o5b=uf.a.instance.create(this.refresh,I,ad.a.fgj)):ea.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.fa&&null!==this.fa&&void 0!==this.fa.Kh&&null!==this.fa.Kh?this.fa.Kh.allowEdits:!1}, IsEditMode ${void 0===this.fa||null===this.fa?!1:this.$.fa.isEditMode}`)}rIf(){ea.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");
this.C_a?ea.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.T9&&this.T9.length||(this.C_a=Cb.p(this.$.oa.ta,{FilterType:0},this.UUj,this.dmg,null,null,null)):ea.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}W5c(){this.QAb||(this.QAb=!0,this.fa.mK(this.j2))}krc(){this.lD(this.wNd);this.lD(this.C_a);this.C_a=this.wNd=null}lD(I){I&&
!I.isCompleted&&this.$.oa.ta.Szb(I.rC)}static nRi(I,pa){if(!I||!I.length)return[];if(!pa||!pa.length){var lb=Array(I.length);for(var hc=0;hc<I.length;++hc)lb[hc]=I[hc].IfmtIndex;return lb}lb=new Ff.a;for(var Xc of I)lb.ga(Xc.IfmtIndex,new mh(Xc));I=new xc.a;for(hc of pa)Xc=lb.tj(hc.IfmtIndex),{value:pa}=Xc,Xc.returnValue&&pa.data.FormatString===hc.FormatString||I.add(hc.IfmtIndex);return I.toArray()}};Sf.f9d="isim0";Sf.$vd="isim1";Sf.dKd="isim2";Sf.g9f="isim3";Sf.bVf=100;Sf.rse=1E3;Sf.D8d=3E5;Sf.ndi=
.001;Sf.rdi=.1;Sf.qdi=.2;Sf.pdi=.001;Sf.odi=50;Sf=Cg=Object(wb.__decorate)([Object(Fc.d)(Gc.Ed),Object(wb.__param)(0,Object(Gc.Ob)())],Sf);Object(za.a)(Sf,"InstantaneousSupportInformationManager",Y.a,[591,2]);Object(Fc.b)(Gc.Nd,{rk:"singleton"})(I=>xo(function*(){if(dh.kWd()){var pa=yield Fc.a.resolve(Gc.Od,I);pa=yield Object(Wf.e)(pa.HUg());return new dh(pa)}return new dh(!0)}));class dh{constructor(I){this.tyb=!0;dh.Eij()?this.tyb=!1:dh.kWd()?(ea.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!I}`),
this.tyb=I):this.tyb=!1}Zob(){return!this.tyb}static kWd(){return!jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableLineageTUI",!1)}static Eij(){return jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)}}Object(za.a)(dh,"LineageCatchUpExperimentManager",null,[571]);var jh;let lc=jh=class{constructor(I,pa){this.TZd=!1;this.Wl=()=>{this.x3g()};this.$=I;this.$.fa.Vqb&&!jh.uUb&&(pa&&!pa.tyb||this.nfl(),jh.KRf?ea.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):
pa&&!pa.tyb||this.vfl());ea.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.pje();this.$=null;ea.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){jh.uUb||(jh.uUb=!0,ea.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.pje()}vfl(){this.$.isAnonymousUser()||Cb.j(this.$.oa.ta,I=>{this.$?(I=I.Result,ea.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${I}.`),
jh.KRf=!0,I&&this.c3g(0)):ea.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},()=>{ea.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}nfl(){this.x3g()||(this.$.fa.vz(this.Wl),this.TZd=!0)}x3g(){return this.$.fa&&this.$.fa.Aq&&this.$.fa.Aq.ShouldTriggerLineageCalloutOnMerge?(ea.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),
this.c3g(1),!0):!1}c3g(I){jh.uUb?ea.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):(jh.uUb=!0,ea.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${I}.`),this.pje(),jd.EwaSettings.Na(418)&&(I=new Wd.a(-847286761,ee.a.ph,this.$.ji,0,Cd.a.g8),this.$.Ia.qh(I,{["CalloutName"]:4})))}pje(){this.TZd&&(this.TZd=!1,this.$.fa.SB(this.Wl))}};
lc.uUb=!1;lc.KRf=!1;lc=jh=Object(wb.__decorate)([Object(Fc.d)(Gc.Rd),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.Nd)())],lc);Object(za.a)(lc,"LineageTeachingCalloutTriggerManager",null,[588,2]);let md=class{constructor(I){this.Iae=pa=>{this.hIg(pa.detail.viewportScenarioContext,"eventHandler")};I.c4e(this.Iae,(new AbortController).signal)}hIg(I,pa){try{ea.ULS.sendTraceTag(1851881062,1,15,`NavigationFailHandler.onNavigationFailed: from ${pa}, context = ${this.Jmf(I)}`)}catch(lb){ea.ULS.sendTraceTag(507590041,
1,15,`NavigationFailHandler.onNavigationFailed: from ${pa}, exception = ${lb.message}`)}}Jmf(I){const pa=I.targetRange;return JSON.stringify({name:I.name,targetRange:null===pa||void 0===pa?void 0:pa.toString(),requiredViewportStateIdStateId:I.L6b})}};md=Object(wb.__decorate)([Object(Fc.d)(Gc.de),Object(wb.__param)(0,Object(Gc.Tg)())],md);Object(za.a)(md,"NavigationFailHandler",null,[]);class Yd{}Yd.Oyj=3;Yd.connected=0;Object(za.a)(Yd,"ConnectionStateConstants",null,[]);class ke{constructor(I,pa,
lb){var hc;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.Fig=(Gd,ae)=>{this.blockedOperationsCount++;Gd=`${ae.componentName}_${ae.actionName}_${ae.details})`;
this.blockedActions[Gd]=this.blockedActions[Gd]?this.blockedActions[Gd]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.Rbe=Gd=>{this.durationUntilUserInactive=$c.getElapsedSeconds(this.startTime,wc.a.kh.vi);Gd.Cke(this.Rbe)};this.nZ=()=>{this.hasTabbedOut=!0};this.Npa=(Gd,ae)=>{ae.svg!==this.type||this.isToastShown||(this.durationUntilToastShownMs=Ld.a(wc.a.kh,this.startTime),this.toastRaiser=ae.toastRaiser,this.isToastShown=!0)};this.startTime=I;this.durationUntilToastShownMs=
0;this.blockedActions={};this.isToastShown=lb;if(null===(hc=pa.fa)||void 0===hc?0:hc.Jl)this.wasUserActiveOnPIStart=pa.fa.Jl.yv;this.Kp(pa);this.isDialogShown=0<pa.vh.r2;let Xc=null;he.a.xp()?void Fc.a.resolve(Gc.lf,{va:1}).then(Gd=>{Xc=Gd}):Xc=pa.qa.zh(183);this.isTaskPaneShown=!!Xc&&Xc.isVisible&&!Xc.isCollapsed;this.isTaskPaneCollapsed=!!Xc&&Xc.isVisible&&Xc.isCollapsed}ZPg(){this.durationMs=Ld.a(wc.a.kh,this.startTime)}Tae(I){var pa;this.ZPg();Ea.a(I).g6b(this.Fig);Ea.a(I).Dm.RVc(this.Npa);jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Fc.a.resolve(Gc.Db).then(lb=>{lb.Gvb(this.nZ)}):I.qa.zi(291,lb=>{lb.Gvb(this.nZ)});if(null===(pa=I.fa)||void 0===pa?0:pa.Jl)I.fa.Jl.Cke(this.Rbe),this.wasUserActiveOnPIEnd=I.fa.Jl.yv}Kp(I){Ea.a(I).Onc(this.Fig);this.isToastShown?this.toastRaiser="Immediate":Ea.a(I).Dm.pqd(this.Npa);jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Fc.a.resolve(Gc.Db).then(pa=>{this.hasTabbedOut=pa.Xn;pa.Zea(this.nZ)}):I.qa.zi(291,pa=>{this.hasTabbedOut=
pa.Xn;pa.Zea(this.nZ)});this.wasUserActiveOnPIStart&&I.fa.Jl.w6e(this.Rbe)}}Object(za.a)(ke,"PartialInteractivityData",null,[]);var bf=a(1238);class cf extends ke{constructor(I,pa,lb,hc,Xc,Gd){super(I,pa,hc);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=
null;this.type=4;this.swappedOffline=lb;this.disconnectionSource=Enum.toString(bf.a,Xc);this.triggeringRequest=Gd}YQj(I,pa){this.swappedByOffline=pa;this.Tae(I)}zFk(I){this.errorDataDuringConnectivityIssuesMode=I}Mhk(I){10>this.failedRequests.length&&(I=I+"_"+$c.getElapsedSeconds(this.startTime,wc.a.kh.vi).toString(),this.failedRequests.push(I))}}Object(za.a)(cf,"ConnectivityIssuesData",ke,[]);var Df=a(164),Af=a(145),qg=a(132);class Pg{}Pg.Oji="DuringWork";Pg.connectivityIssues="ConnectivityIssues";
Pg.offline="Offline";Object(za.a)(Pg,"UnavailabilityTypes",null,[]);var Mg=a(62);class gh{constructor(I){this.sLc=this.data=null;this.uHd=0;this.Ejf=null;this.Tjg=(pa,lb)=>{lb.sU?(this.data=new cf(wc.a.kh.vi,this.$,5===lb.yra,0!==lb.yra,this.$.nm.disconnectionSource,this.Ejf),this.sLc=this.$.nm.s7f,this.uHd=1,this.$.oa.nm.pGh(this.Xy),Df.a(this.$).Mpd(this.iMg)):(this.data.YQj(this.$,5===lb.yra),this.$.oa.nm.jHg(this.Xy),this.data.lastFailedRequestToOnlineTimeGapSec=$c.getElapsedSeconds(this.sLc,
wc.a.kh.vi),jd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?Mg.b().g8b(557682689,0,50,Pg.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",ob.a.Di(this.data)):ea.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${ob.a.Di(this.data)}`),this.data&&this.data.isToastShown&&
Wa.Health.instance.recordQosError(Af.a.bZh,[qg.a.lMc],!0,!1,!1,!1,null),Df.a(this.$).Oje(this.iMg),this.data=null)};this.iMg=(pa,lb)=>{this.data.zFk(lb.lP)};this.Xy=(pa,lb)=>{this.data.Mhk(lb.context.methodName);pa=wc.a.kh.vi;lb=$c.getElapsedSeconds(this.sLc,pa);this.sLc=pa;lb>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=lb);this.uHd++;this.data.averageDurationBetweenFailedRequestsSec=this.$Sh(lb)};this.Qjg=(pa,lb)=>{this.Ejf=lb.L4k};this.$=
I;Ea.a(this.$).Dm.o5e(this.Tjg);this.$.nm.n5e(this.Qjg)}dispose(){this.$&&(Ea.a(this.$).Dm.jGg(this.Tjg),this.$.nm&&this.$.nm.iGg(this.Qjg));this.data&&this.$.oa.nm.jHg(this.Xy);this.$=null}$Sh(I){const pa=this.uHd-1;return(this.data.averageDurationBetweenFailedRequestsSec*(pa-1)+I)/pa}}Object(za.a)(gh,"ConnectivityIssuesTelemetryManager",null,[2]);var Hh=a(1425),Ph=a(1237),rh=a(1236);class eh{constructor(I){this.bLg=null;this.$1d=this.W6d=this.t1b=this.u1b=0;this.gte=!1;this.Fyd=this.s9a=this.t0c=
this.hsb=null;this.Ryd=0;this.wBk=()=>{if(12E4>this.$.fa.Jl.pzb)for(const pa of this.t0c)pa.runTest();else this.owe("UserInactive")};this.dtk=pa=>{pa=Sys.Serialization.JavaScriptSerializer.serialize(pa);ea.ULS.sendTraceTag(388821830,0,50,pa)};this.tsk=pa=>{if(pa){var lb=this.Fyd[pa.testIteration.toString()];lb?lb.push(pa):(lb=[pa],this.Fyd[pa.testIteration.toString()]=lb);if(lb.length===this.bLg.length){lb=Sys.Serialization.JavaScriptSerializer.serialize(lb);if(this.$&&this.$.nm){if(pa.EstimatedLatency=
this.$.nm.Kaf,this.$.nm.Kaf>this.$.QI.ExcelRountripThresholdMs){ea.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${lb}, consequtive slow ping iteration #: ${this.Ryd++}`);return}}else ea.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");ea.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${lb}`);this.Ryd=1}}};this.Ap=(pa,lb)=>{pa=lb.context.methodName;if(pa===Yb.a.nTb||pa===Yb.a.AKa)this.t1b++,
pa=Date.now(),this.MNk(pa)&&(this.t1b=0,this.$1d=pa,this.fXk())};this.Mpa=()=>{this.Qve("OnThrottledUserActivity")};this.nZ=()=>{this.owe("OnDocumentHidden")};this.sJ=()=>{this.Qve("OnDocumentUnhidden")};this.$=I;if(this.hte=this.qXh())this.bLg=[rh.a.v6c],this.Ryd=1,this.Fyd={},this.$.fa.Jl.CGa(this.Mpa),jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Fc.a.resolve(Gc.Db).then(pa=>{pa.Zea(this.nZ);pa.y4(this.sJ)}):this.$.qa.zi(291,pa=>
{pa.Zea(this.nZ);pa.y4(this.sJ)})}dispose(){this.$&&(this.gte&&this.$.oa&&0<this.hsb.count&&this.$.oa.oL(this.Ap),this.hte&&(this.owe("Dispose"),this.$.fa.Jl.lPa(this.Mpa)))}Bbj(){jd.EwaSettings.Na(199)&&this.Q$j();this.hte&&this.R$j()}ccj(){this.t1b=this.u1b;this.$1d=0;var I={};if(!this.hsb){this.hsb=new xc.a;const pa=Ph.a.uKd(this.dtk,"InitSampleMeasurement",this.$);for(const lb of pa)I[lb.fTd]=lb.baseUrl,this.hsb.add(lb)}I=Sys.Serialization.JavaScriptSerializer.serialize(I);ea.ULS.sendTraceTag(537155210,
0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.u1b}, numberOfRequestFromTheLastNetworkMeasurement: ${this.t1b}, testParams: ${I} `);0<this.hsb.count&&this.$.oa.MI(this.Ap)}fXk(){for(const I of this.hsb)I.runTest()}Qve(I){this.s9a&&this.s9a.Wt||(ea.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${I}`),this.s9a=uf.a.instance.$O(this.wBk,5E3,ad.a.cVk),this.s9a.z1())}owe(I){this.s9a&&this.s9a.Wt&&(ea.ULS.sendTraceTag(537155207,
0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${I}`),this.s9a.cancel())}MNk(I){return this.t1b>=this.u1b&&I-this.$1d>this.W6d}qXh(){return eh.RKg(this.$.ua.SlowNetworkMeasurementsSamplePercentage)}Q$j(){this.u1b=this.$.ua.NumberOfRequestToWaitPerNetworkMeasurement;this.W6d=1E3*this.$.ua.MinTimeBetweenNetworkMeasurementInSec;const I=this.$.ua.NetworkMeasurementsSamplePercentage;0<this.u1b&&0<this.W6d&&(this.gte=eh.RKg(I))&&this.ccj()}R$j(){if(!this.t0c){this.t0c=new xc.a;
const I=Ph.a.uKd(this.tsk,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[rh.a.v6c]);for(const pa of I)this.t0c.add(pa);this.$.fa.Jl.yv&&this.Qve("PrepareAndInitSlowNetworkTests")}}static RKg(I){return 100*Math.random()<I}}Object(za.a)(eh,"NetworkMeasurement",null,[2]);var Yf=a(40),Qg=a(160),uh=a(617);class Kh{constructor(I){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=I}get count(){return this._count}get q5(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-
1]}A9k(){this.q5&&this.q5.ZPg()}nAh(I){this.allOfflinePartialInteractivitiesDataInSession.push(I);this._count++}}Object(za.a)(Kh,"OfflinePartialInteractivitiesDataForLog",null,[]);class ai extends ke{constructor(I,pa,lb){super(I,pa,lb);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=null;this.timeFromLastOffline=-1;this.type=5}lJk(I){this.timeFromLastOffline=I}AFk(I){this._errorDataDuringOfflineMode=I}}Object(za.a)(ai,"OfflinePartialInteractivityData",ke,[]);class fh{constructor(I,pa){this.N4a=
this.q5=null;this.nfe=-1;this.bRb=null;this.m7f=qd.Task.delay(0);this.$sb=(lb,hc)=>{hc.sU?this.TYj(hc.yra):this.UYj()};this.Npa=(lb,hc)=>{5===hc.svg&&this.Skb()};this.jMg=(lb,hc)=>{this.q5.AFk(hc.lP)};this.Skb=()=>{this.N4a.A9k();this.Fyk(fh.bde,Sys.Serialization.JavaScriptSerializer.serialize(this.N4a))};this.Ssk=lb=>{if(lb=lb.result)this.X$g=!0,ea.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${lb}`)};
this.Ylk=()=>{this.X$g&&(this.$?Yf.TaskExtensions.$e(this.indexedDB.BCd(fh.bde),()=>{ea.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.ya):ea.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.S4a=()=>{if(this.N4a&&0<this.N4a.count){const lb=Sys.Serialization.JavaScriptSerializer.serialize(this.N4a);
ea.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${lb}`)}};this.$=I;this.indexedDB=pa;this.X$g=!1;this.indexedDB.zl()&&(this.indexedDB.initialize(fh.Lnb,fh.Mnb),this.nsk(),this.N4a=new Kh(this.$.ua.UserSessionId),Ea.a(this.$).Dm.hqd(this.$sb));this.du=Qg.a.instance.KU();this.du.Ga("beforeunload",this.S4a)}dispose(){this.$&&Ea.a(this.$)&&Ea.a(this.$).Dm.ike(this.$sb);Xa.a.gh(this.bRb);this.$=this.bRb=null}TYj(I){this.q5=
new ai(wc.a.kh.vi,this.$,0!==I);this.q5.lJk(-1!==this.nfe?window.performance.now()-this.nfe:-1);this.N4a.nAh(this.q5);Ea.a(this.$).Dm.pqd(this.Npa);this.Skb();this.bRb=uf.a.instance.$O(this.Skb,fh.mzi,ad.a.Skb);Df.a(this.$).Mpd(this.jMg)}UYj(){this.q5.Tae(this.$);this.Skb();Xa.a.gh(this.bRb);this.bRb=null;this.nfe=window.performance.now();Ea.a(this.$).Dm.RVc(this.Npa);Df.a(this.$).Oje(this.jMg);this.usk()}Fyk(I,pa){this.$?this.m7f=Yf.TaskExtensions.$e(this.m7f,()=>{this.indexedDB.BBa(new uh.a(I,pa))},
this.$.ya):ea.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}nsk(){const I=this.$.ya;Yf.TaskExtensions.$e(Yf.TaskExtensions.$e(this.indexedDB.rxa(fh.bde),this.Ssk,I),this.Ylk,I)}usk(){if(this.q5){const I=Sys.Serialization.JavaScriptSerializer.serialize(this.q5);jd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Mg.b().g8b(560791645,0,50,Pg.offline,this.q5.durationMs,
"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",I):ea.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${I}`)}this.q5&&this.q5.isToastShown&&Wa.Health.instance.recordQosError(Af.a.mdl,[qg.a.lMc],!0,!1,!1,!1,null)}}fh.Lnb="NetworkAvailability";fh.Mnb="NetworkAvailabilityData";fh.bde="partialInteractivityData";fh.mzi=3E3;Object(za.a)(fh,
"OfflineModeTelemetryManager",null,[2]);var Uh=a(1442);const Sg=I=>{I.isSuccess||(I=Sys.Serialization.JavaScriptSerializer.serialize(I),ea.ULS.sendTraceTag(509669840,0,10,I))};class xh{constructor(I,pa){this.Xza=this.b8d=this.Dhg=null;this.$=I;jd.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&vg.a.Cm||(this.Dhg=new fh(I,pa));jd.EwaSettings.Na(199)&&(this.b8d=new eh(this.$),this.b8d.Bbj());jd.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
vg.a.Cm||(this.Xza=new Hh.NetworkConnectionHealthChecker(this.$));this.$1h=new gh(this.$);jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(I=this.$,pa=jd.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==pa&&(new Uh.a(I,"1CDN",pa,Sg,"runOneCdnNetworkTest")).runTest())}dispose(){Xa.a.gh(this.Dhg);Xa.a.gh(this.b8d);Xa.a.gh(this.Xza);Xa.a.gh(this.$1h);this.$=null}}Object(za.a)(xh,"NetworkConnectionTelemetryManager",null,[2]);
class Fg extends ke{constructor(I,pa,lb,hc){super(I,pa,lb);this.wasInteruptedByOfflineMode=!1;this.type=hc;this.wasInteruptedByOfflineMode=!1}$sb(){this.wasInteruptedByOfflineMode=!0}}Object(za.a)(Fg,"SilentReopenData",ke,[]);class Tg{constructor(I){this.Aja=null;this.Zrg=(pa,lb)=>{this.Xrg(lb,3)};this.dog=(pa,lb)=>{this.Xrg(lb,2)};this.$=I;this.Dm=Ea.a(this.$).Dm;this.Dm.M5e(this.dog);this.Dm.RFh(this.Zrg)}dispose(){this.Dm.FGg(this.dog);this.Dm.Fqk(this.Zrg);this.Aja=this.Dm=this.$=null}Xrg(I,pa){I.sU?
this.Aja=new Fg(wc.a.kh.vi,this.$,0!==I.yra,pa):(5===I.yra&&(this.Aja.wasInteruptedByOfflineMode=!0),3!==I.yra&&2!==I.yra||ea.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.Aja.Tae(this.$),2===pa?jd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?Mg.b().h8b(571289604,0,50,Pg.offline,this.Aja.durationMs,this.Aja):ea.ULS.sendTraceTag(571289604,
0,50,ob.a.Di(this.Aja)):jd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Mg.b().h8b(542782150,0,50,Pg.Oji,this.Aja.durationMs,this.Aja):ea.ULS.sendTraceTag(542782150,0,50,ob.a.Di(this.Aja)),this.Aja=null)}}Object(za.a)(Tg,"SilentReopenPartialInteractivityTelemetryManager",null,[2]);let sh=class extends Y.a{constructor(I,pa,lb){lb=void 0===lb?!0:lb;super();this.jda=this.dtc=this.O4a=this.jCa=this.j9a=null;this.Dfg=0;this.UUc=this.uvb=this.vvb=!1;this.Ffg=
this.documentVisibilityObserver=null;this.OEa=!1;this.XTd=this.Ija=0;this.rYb=!1;this.HXg=0;this.Wse=!1;this.uda=null;this.Sog=()=>{ea.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.cOc(1,!1)};this.sJ=()=>{this.Kya||this.H_b?window.setTimeout(()=>{this.Iye()},this.Dfg):this.Iye();this.documentVisibilityObserver.jPa(this.sJ);this.rYb=!1};this.im=()=>{ea.ULS.sendTraceTag(537155218,0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.H_b}, IsInDuringWorkSilentReopenMode:${this.YMc&&
!this.OEa}`);this.H_b&&this.p2e();this.YMc&&!this.OEa&&this.l2e();Oc.f(this.$).cellTextEditBox.Ow(this.im);this.vvb=this.uvb=!1};this.Uog=()=>{ea.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.cOc(1,!0);this.uvb&&!this.vvb&&Oc.f(this.$).cellTextEditBox.Ow(this.im);this.uvb=!1};this.Mpa=(hc,Xc)=>{this.XTd=this.Ija;this.Ija=Xc.w2c};this.Yrg=()=>{this.$&&(this.UUc||(jc.a(this.$).j6(Ib.a.fOa).lDh(this.epg),this.$.nr(this.Dj),this.UUc=
!0),this.OEa=this.uij(),this.cOc(2,!1))};this.epg=()=>{var hc=jc.a(this.$).aq;const Xc=hc.jKh();hc=hc.eC.yj.errors.map(Gd=>Gd.MessageIdName);ea.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${Xc}, IsB2W:${this.OEa}, Errors: ${ob.a.Di(hc)}`);Xc&&(this.j9a?(this.OEa=!1,this.Tof(),this.G3c()):this.jCa&&(this.Uof(),this.G3c()))};this.Dj=()=>{this.$?(ea.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),
this.OEa=!1,this.jda&&this.jda.Wt&&(Xa.a.gh(this.jda),this.jda=null),this.uda&&this.uda.Wt&&(Xa.a.gh(this.uda),this.uda=null),this.cOc(2,!0),this.G3c()):ea.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.Rjg=()=>{this.peg(!0)};this.Sjg=()=>{this.peg(!1)};this.zkc=Yd.Oyj;this.Myd=Yd.connected;this.$=I;this.nm=I.oa.nm;lb&&(this.Ffg=new xh(I,pa));jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Fc.a.resolve(Gc.Db).then(hc=>{this.documentVisibilityObserver=hc}):this.$.qa.zi(291,hc=>{this.documentVisibilityObserver=hc});this.Dfg=this.$.ua.ExcelNetworkCheckAfterTabActivationDelayMs;this.nm.S5e(this.Sog);this.nm.YIb(this.Uog);this.nm.n5e(this.Rjg);this.nm.RCh(this.Sjg);new Tg(this.$,this);this.xag=this.$.ua.LongInactivityTimePeriodSeconds;this.$.fa.hJb(this.Yrg);this.$.fa.Jl.CGa(this.Mpa);this.HXg=this.$.ua.SilentReopenDuringWorkDelayMs}get $kj(){return this.OEa}get H_b(){return!(this.zkc&
1)}get YMc(){return!(this.zkc&2)}get Kya(){return!!(this.Myd&2)}dispose(){this.nm&&(this.nm.KGg(this.Sog),this.nm.f6b(this.Uog),this.nm.iGg(this.Rjg),this.nm.Znk(this.Sjg));this.rYb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.jPa(this.sJ),this.rYb=!1);this.$&&(this.UUc&&this.G3c(),this.$.fa&&(this.$.fa.VVc(this.Yrg),this.$.fa.Jl&&this.$.fa.Jl.lPa(this.Mpa)));this.uda&&(this.uda.dispose(),this.uda=null);Xa.a.gh(this.Ffg);this.$=null;super.dispose()}PFj(){this.Wse=!0}l2e(){this.jCa||
(this.jCa=Ea.a(this.$).Dm.mGa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}uij(){if(this.Wse)return this.Wse=!1,!0;const I=this.Ija>this.xag||this.XTd>this.xag&&10>this.Ija;ea.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.Ija}, Time gap between last two activities: ${this.XTd}. return value:${I}`);return I}ftk(){this.uda=uf.a.instance.create(()=>{Wa.Health.instance.recordQosError(Af.a.hVk,
[qg.a.lMc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}Cxh(){this.jCa||this.jda?ea.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.jda=uf.a.instance.create(()=>{this.$?this.jCa?ea.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):
Oc.f(this.$).isEditing?(this.uvb||(Oc.f(this.$).cellTextEditBox.Ox(this.im),ea.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.vvb=!0,ea.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.l2e():
ea.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.HXg,ad.a.TTk,void 0,!0)}peg(I){this.Myd=this.ldf(2,I,!0);this.$6e()}cOc(I,pa){this.zkc=this.ldf(I,pa,!1);this.$6e()}ldf(I,pa,lb){lb=lb?this.Myd:this.zkc;return pa?lb|I:lb&~I}Iye(){const I=!!this.O4a,pa=!!this.j9a,lb=!!this.jCa,hc=!!this.dtc;this.H_b&&!I?this.Bxh():!this.H_b&&I&&this.Nci();!this.YMc||pa||lb?this.YMc||(pa?this.Tof():(lb||this.jda&&this.jda.Wt)&&this.Uof()):
this.OEa?this.Axh():this.jda||this.Cxh();this.Kya&&!hc?this.h2g(!0):!this.Kya&&hc&&this.h2g(!1)}Bxh(){this.$?this.O4a?ea.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):Oc.f(this.$).isEditing?(this.vvb||(Oc.f(this.$).cellTextEditBox.Ox(this.im),ea.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.uvb=!0,ea.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.p2e():ea.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}p2e(){this.O4a||(this.O4a=Ea.a(this.$).Dm.mGa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}Nci(){this.O4a&&(Xa.a.gh(this.O4a),this.O4a=
null)}Tof(){this.j9a&&(Xa.a.gh(this.j9a),this.j9a=null);this.uda&&this.uda.Wt&&this.uda.cancel();this.uda=null}Uof(){this.jCa&&(Xa.a.gh(this.jCa),this.jCa=null);this.jda&&(Xa.a.gh(this.jda),this.jda=null);this.vvb&&!this.uvb&&Oc.f(this.$).cellTextEditBox.Ow(this.im);this.vvb=!1}Axh(){this.j9a||(this.j9a=Ea.a(this.$).Dm.mGa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",void 0,$a.a.instance.ia(2190)));this.ftk()}h2g(I){I?(this.dtc=Ea.a(this.$).Dm.mGa(4,"NetworkConnectionStateManager.ConnectivityIssues"),
this.mdk()):(Xa.a.gh(this.dtc),this.dtc=null)}mdk(){if(this.$&&this.$.oa){const I=this.$.oa.ta.Wh();Cb.K(this.$.oa.ta,null,null,null,I)}}G3c(){jc.a(this.$).j6(Ib.a.fOa).fy(this.epg);this.$.$r(this.Dj);this.UUc=!1}$6e(){this.documentVisibilityObserver||ea.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Xn?this.rYb||
(this.documentVisibilityObserver.y4(this.sJ),this.rYb=!0,ea.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.Iye()}};sh=Object(wb.__decorate)([Object(Fc.d)(Gc.ee),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.xd)())],sh);Object(za.a)(sh,"NetworkConnectionStateManager",Y.a,[590,2]);var Vh=a(768),Qf=a(29);const vh=Object(Qf.b)("Common.App.PenMinutesManager.IPenMinutesManager"),
bg=Object(Qf.c)(vh);var Wh=a(704),Zg=a(183);class sa{constructor(I){this.b4a=this.A5d=this.f4a=this.jNc=0;this.t5d=this.Obg=null;this.KQc=pa=>{"pen"!==pa.pointerType||this.f4a||(this.f4a=Math.floor(this.mOb()/1E3),this.f4a<=this.jNc&&(this.f4a=this.jNc),this.A5d=0)};this.Lpa=()=>{this.dRf()};this.gUb=(pa,lb)=>{0!==lb.newState&&this.dRf()};this.pCj=()=>{0<this.b4a&&this.sOg(this.b4a);this.b4a=0};I?(this.tNc=I,this.mOb=Date.now,this.H9h(),this.vkk()):ea.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}HHk(){this.Obg=
"Office.Excel.Online.Data.Activity.PenMinutes"}vkk(){window.document.body.addEventListener("pointerenter",this.KQc);window.document.body.addEventListener("pointerleave",this.Lpa);Object(Wh.a)().execute(I=>{I.c6e(this.gUb)})}dRf(){const I=Math.ceil(this.mOb()/1E3);this.f4a&&I>this.jNc&&(this.A5d=I,this.b4a+=this.A5d-this.f4a);this.jNc=I;this.f4a=0}H9h(){this.t5d=new Fb.a(4,2,6E4,this.pCj);this.tNc.lm(this.t5d)}sOg(I){const pa={name:this.Obg,dataFields:[]};(I=Kb.a.gm("PenInputSec",I.toString(),Zb.g.Int64))&&
pa.dataFields.push(I);Zg.a.sendActivityEvent(pa)}dispose(){0<this.b4a&&this.sOg(this.b4a);this.tNc.Ux(this.t5d)}}Object(za.a)(sa,"PenMinutesManager",null,[632]);var Vb=a(283);class Sc{constructor(){this.jid=this.Vh=null}get name(){return"Common.App.PenMinutesManager"}co(I){this.Vh=I;const pa=Aa.AFrameworkApplication.Np;this.Vh.register(632,"Common.App.PenMinutesManager.IPenMinutesManager").Ai().Ii(()=>new sa(pa))}init(){this.jid=Object(Qf.a)(bg)}dispose(){this.jid&&this.jid.dispose()}static main(){Vb.a.instance.Jo(new Sc)}}
Object(za.a)(Sc,"PenMinutesManagerPackage",null,[13,14]);Object(Fc.b)(Gc.Fe,{rk:"singleton"})(()=>{Type.registerNamespace("Common.App.PenMinutesManager");Sc.main();const I=Eg.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");I.HHk();return I});var ud=a(139);let va=class{constructor(I){I.q6(pa=>{void pa.Iaa(1).then(()=>{const lb=document.createElement("div"),hc=Object(Oc.f)(I).$m;appChrome.renderProactiveSuggestionDebugPane(lb,hc,ud.a.Ex)})});void Fc.a.resolve(Gc.nf,{va:1})}};va=
Object(wb.__decorate)([Object(Fc.d)(Gc.ef),Object(wb.__param)(0,Object(Gc.Ob)())],va);Object(za.a)(va,"ProactiveSuggestionDebugToolsManager",null,[]);let mb=class extends Y.a{constructor(){super()}yze(I,pa){ea.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${I}, TriggerType: ${pa}`);if(jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(pa){case 0:this.raiseEvent("pssort",
void 0,I);break;case 1:this.raiseEvent("psfilter",void 0,I);break;case 2:this.raiseEvent("pscrttbl",void 0,I)}}};mb=Object(wb.__decorate)([Object(Fc.d)(Gc.ff)],mb);Object(za.a)(mb,"ProactiveSuggestionManager",Y.a,[587]);var Tb=a(1459),yc=a(98),Nc=a(184);class zd{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=
null}}Object(za.a)(zd,"TaskPaneGroupAppProps",null,[]);class fe{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(za.a)(fe,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var Ud=a(53),P=a(45),Da=a(342);Object(Fc.b)(Gc.lf,{rk:"singleton"})(I=>xo(function*(){const pa=yield Fc.a.resolve(Gc.Ob,I);return eb.Ga(pa)}));class eb extends Y.a{constructor(I,pa){super();this.isVisible=!1;this.Lpf=500;this.g9b=[];this.oof=this.U$c=
null;this.N$d=()=>{this.nJg()};this.c2c=new Set;this.c2c.add("FieldListTaskPane");this.c2c.add("PivotTableSettingsTaskPane");this.c2c.add("SlicerSettingsTaskPane");this.th=pa;Od.a(this.$).Wq(this);this.lac=I;Aa.AFrameworkApplication.ra.$g.Zk||(this.lac.style.bottom=this.$.Kj&4?td.HelperMethods.Li(this.$.HQa):"0");this.Cyc={};this.nac={};this.THe=new Set;this.zxe=Qg.a.instance.Wk(this.ij);this.zxe.Ga("focusin",this.N$d);this.Rej()}get $(){return this.th}get vmc(){return this.THe}get xYa(){return this.U$c}get isCollapsed(){return!this.xYa}dispose(){Od.a(this.$).fI(this);
const I=this.Cyc;for(const pa in I)({key:pa,value:I[pa]}).value();this.nac=this.THe=this.Cyc=null;this.zxe.LM();this.lac=this.zxe=null;super.dispose()}xlb(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf,hg,Wg,mg,Xg,hi,Nj,yi){Re=void 0===Re?eb.eyj:Re;lf=void 0===lf?eb.dyj:lf;hg=void 0===hg?null:hg;Wg=void 0===Wg?null:Wg;mg=void 0===mg?!1:mg;Xg=void 0===Xg?!1:Xg;hi=void 0===hi?null:hi;Nj=void 0===Nj?!1:Nj;const Li=Object(Yc.a)(new fe,{getContent:()=>I});Li.isSharedRuntime=mg;return Object(Yc.a)(new Tb.a,{hideHeader:Xg,
contentProps:Li,title:pa,titleTag:hi,width:lb,location:2,onOpen:Xc,onClose:Gd,onShow:ae,onHide:we,iconUrl:hg,iconId:Wg,enableResize:hc,minResizeWidth:Re,maxResizeWidth:lf,showResizeChatButton:Nj,onCloseButtonTabKeyDown:zi=>{jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8039664_TaskpaneCloseShiftTab")&&(zi.shiftKey&&zi.keyCode===yc.a.MG&&!hc?void Nc.a.fo().then(pk=>{1>=pk.selectors.getTabbedTaskPaneCount()&&yi(zi);return null}):zi.keyCode!==yc.a.MG||zi.shiftKey||yi(zi))}})}ZH(I,pa){jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&
this.g9b.indexOf(I)&&(this.g9b[I]=!0);void Nc.a.fo().then(lb=>{this.vmc.has(I)?lb.setSelectedTaskPane(I):lb.showTaskPane(I,pa);return null})}YAd(I,pa){this.g9b[I]=!1;void Nc.a.fo().then(lb=>{lb.initializeHiddenSharedRuntimeTaskPane(I,pa);const hc=this.$.domElement;hc.addEventListener("scroll",function Gd(){0!=hc.scrollLeft&&(hc.scrollLeft=0,hc.removeEventListener("scroll",Gd))})})}updateTaskPane(I,pa){jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&this.g9b.indexOf(I)&&!this.g9b[I]||
void Nc.a.fo().then(lb=>{lb.updateTaskPane(I,pa);return null})}setSelectedTaskPane(I){void Nc.a.fo().then(pa=>{pa.setSelectedTaskPane(I);return null})}hideTaskPane(I){void Nc.a.fo().then(pa=>{pa.hideTaskPane(I,eb.q_k);return null})}get ij(){return this.lac}get ap(){return this.isVisible}get el(){return me.a.Bxe}Lp(I,pa){return pa?!1:(this.MNg(),!0)}wq(I){return De.DOMElementExtensions.Co(this.ij,I)}Rs(){this.$.frame.Nm.Ev(this.el)}nu(){}focusResizeHandle(){void Nc.a.fo().then(I=>{I.focusResizeHandle();
return null})}focusTabbedTaskPaneArea(){void Nc.a.fo().then(I=>{I.focusTabbedTaskPaneArea();return null})}Rej(){Nc.a.fo().then(I=>{const pa=new zd;pa.onOpen=lb=>{this.isVisible=!0;this.vmc.add(lb)};pa.onClose=lb=>{this.isVisible=0<I.selectors.getTabbedTaskPaneCount();ea.ULS.sendTraceTag(537014371,0,50,`Closing of ${lb} TaskPane`);this.isVisible||this.oCf();delete this.nac[lb];this.vmc.delete(lb);this.kqa()};pa.onShow=(lb,hc)=>{this.U$c=lb;this.nJg();1!==hc&&window.requestAnimationFrame(()=>{window.setTimeout(()=>
{this.yxk()},0)});this.kqa()};pa.onHide=(lb,hc,Xc)=>{this.U$c=null;Xc&&1!==hc&&this.oCf();this.kqa()};pa.setFocusCallback=(lb,hc)=>{hc&&(this.nac[lb]=hc)};pa.onResizeStart=()=>{};pa.onResizeEnd=()=>{this.kqa();ea.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.xYa} TaskPane`)};I.renderTaskPaneGroups(null,this.lac,pa);return null})}aUh(){jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8426131_gridLayoutCleanup")&&qd.Task.delay(this.Lpf).continueWith(()=>{this.$.duk()})}oCf(){Oc.f(this.$).setFocus()}kqa(){Aa.AFrameworkApplication.ra.$g.Zk?
jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridAdjustmentPostTakePaneTrigger",!1)&&(qd.Task.delay(this.Lpf).continueWith(()=>{this.$.kqa(Da.a.uxa("ResetContentAreaMargin"))}),ea.ULS.sendTraceTag(507609505,0,50,"TaskPane.onContentAreaResize")):this.aUh()}yxk(){if(this.nac[this.xYa]){const I=this.nac[this.xYa];I&&I(null,null)}else this.c2c.has(this.xYa)||this.MNg()}MNg(){Nc.a.fo().then(I=>{if(!jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<
I.selectors.getTabbedTaskPaneCount())I.focusTabbedTaskPaneArea();else{const pa=De.DOMElementExtensions.KE(this.ij.querySelectorAll(De.DOMElementExtensions.cJ));pa?pa.focus():jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<I.selectors.getTabbedTaskPaneCount()&&I.focusTabbedTaskPaneArea()}return null})}nJg(){this.$.domElement.scrollLeft=0;vg.a.Ooa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=
0},0)})}get a2c(){return this.lac}Zlf(I,pa,lb){let hc=I.zh(pa);hc||(hc=P.a(Ud.a,5,I,pa),hc.SetScriptLoadFlavor(1));lb&&hc.e5e(lb);const Xc=""+pa;let Gd=null;const ae=()=>{hc.create();Gd()};this.Cyc[Xc]=Gd=()=>{hc.Pje(ae);delete this.Cyc[Xc]};hc.Opd(ae)}static Ga(I){const pa=eb.xRh(I.xi,I.isChromeRtl);eb.MLh(I,pa);return new eb(pa,I)}static xRh(I,pa){const lb=document.createElement("div");lb.id=I+Cd.a.Cxe;Aa.AFrameworkApplication.ra.$g.Zk?lb.classList.add(Pe.a.jgl):(lb.classList.add(pa?Pe.a.lgl:Pe.a.kgl),
Aa.AFrameworkApplication.ra.$g.Zk&&lb.classList.add(Pe.a.rvb));return lb}static MLh(I,pa){I.isMobileMode&&pa.setAttribute("aria-hidden","true");if(Aa.AFrameworkApplication.ra.$g.Zk){let lb;(lb=document.getElementById("FarPaneRegion"))?lb.appendChild(pa):ea.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else document.getElementById(I.xi+Cd.a.ksc).insertBefore(pa,I.GQa)}}eb.eyj=300;eb.dyj=950;eb.q_k=2;Object(za.a)(eb,
"ReactTaskPaneManager",Y.a,[574,42,2]);var bc=a(60),Pc;let gd=Pc=class{constructor(){this.K$e=null;this.c0j=pa=>{ea.ULS.sendTraceTag(508421248,0,50,`DMS call to get SDX list succeeds with status ${pa.data.httpStatus}.`);this.kRf(pa.data.responseData)};this.b0j=pa=>{200<=pa.data.httpStatus&&300>pa.data.httpStatus?(ea.ULS.sendTraceTag(508421219,0,50,`DMS call to get SDX list succeeds with status ${pa.data.httpStatus}.`),this.kRf(pa.data.responseData)):ea.ULS.sendTraceTag(508421218,0,15,`DMS call to get SDX list fails with status ${pa.data.httpStatus}.`)};
const I=jd.EwaSettings.getStringFeatureGate("Microsoft.Office.ExcelOnline.SdxManifestPrefetchAssetIds","");""!==I&&(this.K$e=I.split(";"),this.K$j())}K$j(){const I=Ra.a.create().toString();ea.ULS.sendTraceTag(508421250,0,50,`Start calling DMS to retrieve the list of SDXs to prefetch (dmsActivityId = ${I}).`);Aa.AFrameworkApplication.lj.qv(bc.a.current.bT.SdxDmsUrl,2,Pc.T$h(),Pc.U$h(I),!1,4,this.c0j,this.b0j,null)}Zli(){return jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.UseSdx1CdnUrl",
!1)||bc.a.current.bT.ForceUseSdx1Cdn}kRf(I){try{const pa=JSON.parse(I).Packages,lb=this.Zli()?bc.a.current.bT.Sdx1CdnUrl:bc.a.current.bT.SdxCdnUrl;for(const hc of pa)if(this.K$e.includes(hc.AssetId)){const Xc=String.format(lb,hc.AssetId,hc.FFN,hc.Version,"en-us");bc.a.qub(Xc,!1,null,!0)}window.prefetchedDmsResponse=I}catch(pa){ea.ULS.sendTraceTag(508421249,0,15,`Failed to parse DMS response: "${I.substring(0,40)}...".`)}}static T$h(){const I=Object(Bb.a)(String,Aa.AFrameworkApplication.mi.AudienceGroup)||
"",pa=Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExcelApiUndo25Bump",!1)?"1.25":Aa.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8722614_RichApiUndoExcelApiUndoBump1_24")?"1.24":"1.19",lb=he.a.isReactRibbonEnabled()?Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RequirementSetRibbonApiOnePointThreePrime",!1)?"1.3":"1.2":"1.1";return JSON.stringify({Context:{Hosts:["Workbook"],ReactNativeVersion:"0.0.0.0",Channel:"DevMain",
Capabilities:[{Name:"addincommands",Version:"1.2"},{Name:"augloopsharedsession",Version:"1.1"},{Name:"bindingevents",Version:"1.1"},{Name:"biplatvisualrichapi",Version:"1.8"},{Name:"cdnurlsupport",Version:"1.1"},{Name:"compressedfile",Version:"1.1"},{Name:"customfunctions",Version:"1.9"},{Name:"customfunctionsruntime",Version:"1.4"},{Name:"datafrompicture",Version:"1.1"},{Name:"delayforcelledit",Version:"1.1"},{Name:"dialogapi",Version:"1.2"},{Name:"dialogorigin",Version:"1.2"},{Name:"documentevents",
Version:"1.1"},{Name:"excelapi",Version:"1.17"},{Name:"excelapionline",Version:"1.1"},{Name:"excelapiundo",Version:pa},{Name:"file",Version:"1.1"},{Name:"firstpartyauthentication",Version:"1.1"},{Name:"identityapi",Version:"1.3"},{Name:"keyboardshortcuts",Version:"1.1"},{Name:"matrixbindings",Version:"1.1"},{Name:"matrixcoercion",Version:"1.1"},{Name:"navigationpanesdx",Version:"1.2"},{Name:"numberformatting",Version:"1.2"},{Name:"pdffile",Version:"1.1"},{Name:"pivot",Version:"1.6"},{Name:"pivottablenativegrouping",
Version:"1.2"},{Name:"ribbonapi",Version:lb},{Name:"richapiruntime",Version:"1.2"},{Name:"richapiruntimeflag",Version:"1.2"},{Name:"selection",Version:"1.1"},{Name:"settings",Version:"1.1"},{Name:"sharedruntime",Version:"1.1"},{Name:"sharedruntimeinternal",Version:"1.2"},{Name:"tablebindings",Version:"1.1"},{Name:"tablecoercion",Version:"1.1"},{Name:"tablestyle",Version:"1.1"},{Name:"textbindings",Version:"1.1"},{Name:"textcoercion",Version:"1.1"},{Name:"webauth",Version:"1.1"}],Ring:"Automation"===
I?"Dogfood":I,Platform:"Web",Locales:[Aa.AFrameworkApplication.uiCulture],ClientId:Aa.AFrameworkApplication.ea.Ya("LoggableUserId")},SyncId:0})}static U$h(I){return{"Content-Type":"application/json",DMSActivityId:I}}};gd=Pc=Object(wb.__decorate)([Object(Fc.d)(Gc.Df)],gd);Object(za.a)(gd,"SdxManifestPrefetcher",null,[]);var nd=a(226);class Vd extends Ob.a{constructor(I,pa,lb,hc,Xc){Xc=void 0===Xc?null:Xc;super();this.tJb=null;this.h2f=!1;this.sJ=()=>{this.gWb&&ea.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.Y_b}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.p1a}, AggregatedActionParams not null: ${this.gWb}`);
this.dVd()};this.mxh=I;this.nxh=pa;this.documentVisibilityObserver=lb;this.Y_b=hc;this.EW=Xc;lb&&this.documentVisibilityObserver.y4(this.sJ)}get p1a(){return this.h2f}get gWb(){return!!this.tJb}Vvg(I){ea.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.Y_b}>.PerformThrottledAction: Start. IsActionOngoing: ${this.p1a}, AggregatedActionParams not null: ${this.gWb}`);this.tJb=this.nxh.p7e(I,this.tJb);this.dVd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.jPa(this.sJ);
super.dispose()}pRg(I){this.h2f=I}byi(){ea.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.Y_b}>.FinishedCallback: Start. IsActionOngoing: ${this.p1a}, AggregatedActionParams not null: ${this.gWb}`);this.pRg(!1);this.dVd()}dVd(){if(!this.G9b()){var I=this.tJb;this.tJb=null;this.pRg(!0);ea.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.Y_b}>.InternalPerformAction: Calling PerformAction.`);Yf.TaskExtensions.$e(this.mxh.Rvg(I),()=>{this.byi()},nd.a.none,0,this.EW)}}G9b(){return!this.gWb||
this.p1a?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Xn?(ea.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.Y_b}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}}Object(za.a)(Vd,"ActionAggregator",Ob.a,[612,2]);var ie=a(159),vd=a(17),Sd=a(52);class te extends Y.a{constructor(I){super();this.iG=this.UM=null;this.c2a=!1;this.dC=null;this.oMk=vg.a.Cm;this.Mng=pa=>{const lb=pa.La.keyCode;return lb===yc.a.Au?this.QSj():lb===yc.a.MG&&pa.La.shiftKey?
this.vui(this.UM):!1};this.Ptg=pa=>{if(!this.c2a||pa.La.keyCode!==yc.a.r_)return!1;te.HTf();qd.Task.delay(1).nB(()=>{this.iG.focus();return!0},0,this.ya);return!0};this.Z2j=()=>{document.activeElement&&document.activeElement.id===this.iG.id||(te.HTf(),qd.Task.delay(1).nB(()=>{this.iG.focus();return!0},0,this.ya))};this.tlg=()=>{this.V2g(this.iG)};this.Lng=pa=>{pa.stopPropagation();pa.preventDefault();this.c2a&&(this.c2a=!1)};this.$=I;(I=this.$.fa.Kh)&&ea.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${I.FHa}; InWebPart = '${I.inWebPart?
"Classic":"Non Classic"}', InEmbedView = '${I.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);I&&(I.inWebPart||I.inEmbedView)?ea.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${I.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${I.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.s7h(),this.q8h(),ie.a.instance.xa(vd.a.Wi,this.$.domElement,this.Ptg));this.$.qa.Rh(238,
this)}fEh(I){this.addHandler("KBIS",I)}fpk(I){this.removeHandler("KBIS",I)}dispose(){this.UM&&Sd.a.removeHandler(this.UM,vd.a.focus,this.tlg);this.dC&&this.dC.detach("focus");this.iG&&(Sd.a.removeHandler(this.iG,vd.a.focus,this.Lng),Sd.a.removeHandler(this.iG,vd.a.blur,te.onBlur),ie.a.instance.Oa(vd.a.Wi,this.iG,this.Mng));ie.a.instance.Oa(vd.a.Wi,this.$.domElement,this.Ptg);this.dC=this.iG=this.UM=this.$=null;super.dispose()}s7h(){this.oMk?(this.UM=document.documentElement,this.dC=Qg.a.instance.KU(document.parentWindow),
this.dC.Ga("focus",this.Z2j)):(this.UM=te.dmf(),document.body.insertBefore(this.UM,document.body.childNodes[0]),Sd.a.addHandler(this.UM,vd.a.focus,this.tlg))}q8h(){this.iG=te.dmf();this.iG.id=Cd.a.Ytf;this.iG.setAttribute(Cd.a.wD,$a.a.instance.ia(863));document.body.appendChild(this.iG);Sd.a.addHandler(this.iG,vd.a.focus,this.Lng);Sd.a.addHandler(this.iG,vd.a.blur,te.onBlur);ie.a.instance.xa(vd.a.Wi,this.iG,this.Mng)}vui(I){this.V2g(I);return!1}QSj(){this.c2a=!0;Oc.f(this.$).focus();Oc.f(this.$).ha.xQf();
this.raiseEvent("KBIS");return!0}V2g(I){this.c2a?this.c2a=!1:(this.c2a=!0,I&&I.focus())}static dmf(){const I=document.createElement("div");I.tabIndex=0;return I}static HTf(){document.body.classList.add(Pe.a.vwf)}static onBlur(){document.body.classList.remove(Pe.a.vwf)}}Object(za.a)(te,"EmbedViewFocusControl",Y.a,[611,2]);var ne=a(72),Ce=a(620);class Qe extends Y.a{constructor(I,pa){super();this.c7b=this.uMd=this.xSb=this.G_=null;this.$hc=!1;this.aLe=null;this.Iya=this.zge=!1;this.JUj=(lb,hc,Xc)=>
{ea.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Xc);this.c7b&&this.c7b.stop();this.G_=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.KUj=lb=>{tb.a(lb)||(this.c7b&&this.c7b.stop(),this.$hc=!1,(this.G_=lb.Result)&&0<this.G_.length&&ea.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.G_.length} rich value field list context for autocomplete`),this.rcb=!0,this.WTc())};this.rcb=!1;this.th=I;this.sgc=-1;this.Qj=pa;this.zge=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults");
this.Iya=jd.EwaSettings.Iya()}Ppd(I){this.addHandler("FieldInfoListContextLoaded",I)}Qje(I){this.removeHandler("FieldInfoListContextLoaded",I)}DDh(I){this.addHandler("GetFieldInfoListContextOperationFailed",I)}Gok(I){this.removeHandler("GetFieldInfoListContextOperationFailed",I)}get tXd(){return this.rcb}get Nzj(){return this.$hc}get wDf(){return this.sgc}get oBd(){return this.aLe}get $(){return this.th}get Vx(){return this.G_}get DMi(){return!!this.xSb}dispose(){this.th=null;this.KWc();super.dispose()}Ylb(I,
pa,lb,hc){hc=void 0===hc?null:hc;if(I){this.Cvd();this.grc();var Xc=null,Gd=!1;if(!hc&&(()=>{let ae=this.x5k(I,pa,lb);({Jtb:Gd,Vx:Xc}=ae);return ae})().returnValue)if(this.zge||this.gQg(Xc),this.$hc=!0,this.G_=Xc,this.zge){if(!Gd){this.rcb=!0;this.WTc();return}}else if(this.G_&&0<this.G_.length&&(this.rcb=!0,this.WTc()),!Gd)return;this.l7g(I,hc,pa,lb,!1)}}l7g(I,pa,lb,hc,Xc){if(this.$.fa.ki){this.$.Eh&&(this.c7b=this.$.Eh.Oi("WebServiceCall","GetRichValueFieldInfoListContext"));this.xSb=null;var Gd=
this.$.oa.ta.Wh(),ae=this.$.oa.ta,we=this.KUj,Re=this.JUj;const lf=ae.Za(1,null);lf.selectedRange=I;lf.richValueKeyPath=pa;lf.singleColumn=lb;lf.searchForRange=hc;lf.calculateMajorityDataType=Xc;this.xSb=Cb.h(ae,"GetRichValueFieldListContextList",lf,we,Re,null,Gd,4)}else this.G_=null}KWc(){this.G_=null;this.rcb=!1;this.Cvd();this.grc();this.xSb=null;this.sgc=-1}Cvd(){Qe.vLb(this.xSb)}grc(){Qe.vLb(this.uMd)}WTc(){this.raiseEvent("FieldInfoListContextLoaded")}Fy(I){I=Kc.H(I);--I.left;--I.right;return this.Qj.Fy(I)}x_a(I){I.FirstColumn=
I.FirstColumn;I.LastColumn=I.LastColumn;I.FirstRow=I.FirstRow;I.LastRow=I.LastRow;this.grc();this.uMd=null;return Jc.a(this.$.userOperationManager,(pa,lb,hc)=>pe.k(this.$.oa.ta,I,zc.c(pa,Xc=>{this.TUj(Xc)}),zc.b(lb,lb,Xc=>{this.SUj(Xc)}),hc,null),pa=>new zb.a(264,0,pa,80),null)}SUj(I){I=Se.a.$j(I.data);ea.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${Ia.a.fi(I)}`)}TUj(I){if(tb.a(I))-315732528!==I.Errors[0].MessageId&&ea.ULS.sendTraceTag(525336846,
0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${Ia.a.fi(I.Errors)}`);else if(I&&I.Result){I=I.Result;var pa=I.HasHeaderRow;pa=new Ce.AutofilterRange(I.TableRange.FirstRow+(pa?1:0)+1,I.TableRange.FirstColumn+1,I.TableRange.LastRow+1,I.TableRange.LastColumn+1,null,null,null,0,pa);this.sgc=I.TableRange.FirstColumn;(I=this.uzg(!1,!0,pa))||ea.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");
this.gQg(I)}else ea.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}x5k(I,pa,lb){let hc,Xc;Xc=null;hc=!1;if(I.SheetName!==this.$.fa.la.sheetName)return{returnValue:!1,Jtb:hc,x_a:!1,Vx:Xc};let Gd;this.sgc=-1;if(lb){Gd=this.Fy(I);if(!Gd||!Gd.Zxa)return{returnValue:!1,Jtb:hc,x_a:!1,Vx:Xc};var ae=this.Iya?(ae=Oc.f(this.$).oh.mMf(Gd))&&0<ae.size:(ae=Oc.f(this.$).oh.nMf(Gd))&&0<ae.count;this.aLe=Gd;if(jd.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&
ae)return--I.FirstColumn,--I.LastColumn,this.uMd=this.x_a(I),{returnValue:!0,Jtb:hc,x_a:!0,Vx:Xc};Gd.top+=1;Gd.right=Kc.H(I).right-1}else Gd=new Ce.AutofilterRange(I.FirstRow+1,I.FirstColumn+1,I.LastRow+1,I.LastColumn+1,null,null,null,0,!1);if(Gd.top>Gd.bottom||Gd.left>Gd.right)return{returnValue:!0,Jtb:hc,x_a:!1,Vx:Xc};I=Oc.f(this.$);var we=I.fh.width,Re=I.fh.height;ae=I.view.visibleArea;we=new ne.a(ae.x-we,ae.y-Re,ae.width+we,ae.height+Re);Re=I.Hl(Gd);if(!ae||!Re||!I.FJc(Gd))return{returnValue:!1,
Jtb:hc,x_a:!1,Vx:Xc};we.contains(Re)||(hc=!0);Xc=this.uzg(pa,lb,Gd);return{returnValue:!0,Jtb:hc,x_a:!1,Vx:Xc}}gQg(I){I&&ea.ULS.sendTraceTag(25264348,0,50,`Retrieved ${I.length} rich value field contexts from block cache`);this.$hc=!0;(this.G_=I)&&0<this.G_.length&&(this.rcb=!0,this.WTc())}uzg(I,pa,lb){let hc;hc=null;const Xc=lb.clone();if(pa)for(let Gd=lb.right,ae=0;Gd>=lb.left;--Gd){if(Xc.left=Gd,Xc.right=Gd,pa=this.HHf(Xc,!0,lb.left)){hc||(hc=[]);hc[ae]=pa;if(I)break;++ae}}else if(I=this.HHf(Xc,
!1))hc=[],hc[0]=I;return hc}HHf(I,pa,lb){lb=void 0===lb?0:lb;var hc=null;let Xc=[];if(this.Iya){var Gd=Oc.f(this.$).oh.mMf(I);if(!Gd||0>=Gd.size)return hc;Xc=Array(Gd.size);let we=0;Gd.forEach(Re=>{const lf={};lf.Name=Re.Value;lf.RefersToDotFunction=Re.RefersToDotFunction;Xc[we]=lf;++we})}else{var ae=Oc.f(this.$).oh.nMf(I);if(!ae||0>=ae.count)return hc;Xc=Array(ae.count);hc=0;for(Gd of ae.values)ae={},ae.Name=Gd,Xc[hc]=ae,++hc}Gd="";ae=-1;0<I.top&&pa&&(I=new ca.Range(I.top-1,I.left,I.top-1,I.left,
!1,!1),null!=Oc.f(this.$).yh(I)&&null!=Oc.f(this.$).yh(I).originalText&&(Gd=Oc.f(this.$).yh(I).originalText),ae=I.left-lb);hc={};hc.ColumnName=Gd;hc.ColumnIndex=ae;hc.FieldInfoDataList=Xc;return hc}static vLb(I){I&&Aa.AFrameworkApplication.lj.lD(I.rC)}}Object(za.a)(Qe,"FieldInfoManager",Y.a,[610,2]);class df extends Qe{constructor(I,pa,lb,hc){super(I,pa);this.Jjb=null;this.mlg=()=>{this.Qje(this.mlg);if(this.Vx&&this.Vx.length&&this.contextMenuManager){var Xc=this.contextMenuManager.jBc("autoFilterRichFieldList"),
Gd=window.document.getElementById(this.Jjb);Xc.gda(null,Gd,this,null,!0)}};this.cjh=lb;this.contextMenuManager=hc}get AR(){return this.cjh}QMi(I,pa){this.Jjb=pa;ea.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${I.FirstRow}, ${I.FirstColumn}, ${I.LastRow}, ${I.LastColumn})`);this.l7g(I,null,!0,!1,!0)}}Object(za.a)(df,"FilterInfoManager",Qe,[609,610,2]);var da=a(1108),hb=a(1239);a(611);var Ac=
a(308),Lc=a(291),Qd=a(332),de=a(70),Me=a(328);class Te extends yd.a{constructor(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf){super(document.createElement("div"));this.a7f=null;this.Uue=!1;this.zoom=this.Bi=this.vac=this.g9a=null;this.sZ=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.rZ=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.NTk=()=>{this.s2e()};this.rj=hg=>{this.raiseEvent(this.U3b,hg);this.gub();return!0};this.rSj=hg=>{100<Ld.a(wc.a.kh,this.a7f)&&this.ERd(new Sys.UI.Point(Math.round(hg.clientX),
Math.round(hg.clientY)))};this.oZ=hg=>{de.g(hg.La,!1);return!1};this.zoom=lf;this.jaa=this.ml.dYa();this.set_visible(!1);this.pKc=Xc;this.U3b=Gd;this.IOc=I;this.hsc=pa;this.Bi=Re;this.pKc&&(this.g9a=uf.a.instance.create(this.NTk,3E4,"OnObjectButton.ShyTimerFired",!1,!1));I&&this.domElement.classList.add(I);this.PWa=document.createElement("div");this.domElement.appendChild(this.PWa);lb&&this.PWa.classList.add(lb);this.MAe(hc);ae&&(this.vac=document.createElement("div"),this.domElement.appendChild(this.vac),
this.vac.classList.add(we),this.vac.innerText=ae,this.domElement.style.padding="3px",Ac.a.instance.xa(vd.a.Bj,this.domElement,this.oZ));this.Jgb=new Qd.a(this.domElement,7);Lc.a.instance.xa(vd.a.click,this.domElement,this.rj);jd.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Ac.a.instance.xa(vd.a.Bj,this.domElement,this.oZ);I=hg=>{de.g(hg)};this.qj.Ga("mouseup",I);this.qj.Ga("click",I);this.qj.Ga("dblclick",I)}y$(I){this.addHandler(this.U3b,I)}Oia(I){this.get_events().removeHandler(this.U3b,
I)}zEh(I){this.addHandler("OnObjectButtonMouseOver",I)}wpk(I){this.get_events().removeHandler("OnObjectButtonMouseOver",I)}yEh(I){this.addHandler("OnObjectButtonMouseOut",I)}vpk(I){this.get_events().removeHandler("OnObjectButtonMouseOut",I)}MAe(I){I&&this.Bi.hr(this.PWa,I)}X3c(I){this.PWa&&I&&this.PWa.setAttribute("title",I)}$8k(I,pa,lb){var hc=16,Xc=16;hc=void 0===hc?0:hc;Xc=void 0===Xc?0:Xc;this.Bi.wM(this.PWa);I?I.loa(pa,16,16,this.PWa,hc,Xc,void 0,lb):ea.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}a9k(I,
pa){I&&(this.vac.innerText=I);this.domElement.title=pa}dispose(){this.get_isInitialized()&&(this.hide(),this.qj.LM(),Xa.a.gj([this.jaa,this.Jgb]),Lc.a.instance.Oa(vd.a.click,this.domElement,this.rj),Ac.a.instance.Oa(vd.a.Bj,this.domElement,this.oZ),this.g9a&&this.g9a.dispose(),super.dispose())}N6b(){this.hsc&&this.domElement.classList.remove(this.hsc);this.IOc&&this.domElement.classList.add(this.IOc)}gub(){this.IOc&&this.domElement.classList.remove(this.IOc);this.hsc&&this.domElement.classList.add(this.hsc);
this.ckb()}ckb(){this.pKc&&(this.g9a.cancel(),this.FZg(),this.setOpacity(1));this.set_visible(!0)}hv(I,pa,lb,hc,Xc){Xc=void 0===Xc?!1:Xc;I=this.zoom.zoomManager.Zm(I);pa=this.zoom.zoomManager.Zm(pa);this.zoom.zoomManager.wZc(this.domElement);this.domElement.style.top=td.HelperMethods.Li(pa);this.domElement.style.left=this.domElement.style.right="";pa=I;Xc&&(pa=I-this.domElement.offsetWidth);Me.c(this.domElement.style,lb,td.HelperMethods.Li(pa));this.set_visible(!0);this.setOpacity(1);this.pKc&&(this.Uue=
!1,this.TWk(),this.g9a.PA())}hide(){this.N6b();this.set_visible(!1);this.pKc&&(this.FZg(),this.g9a.cancel())}PEd(){this.qj.Ga("mouseover",this.sZ,!0);this.qj.Ga("mouseout",this.rZ,!0)}TWk(){this.jaa.Zv("mousemove")||this.jaa.Ga("mousemove",this.rSj)}FZg(){this.jaa.Zv("mousemove")&&this.jaa.detach("mousemove")}ERd(I){if(this.domElement.parentNode){var pa=Sys.UI.DomElement.getBounds(this.domElement);const lb=new Sys.UI.Point(Math.round(pa.x+pa.width),Math.round(pa.y+pa.height));pa=Math.abs(lb.x-I.x);
I=Math.abs(lb.y-I.y);I=pa>I?pa:I;this.Uue?this.setOpacity(Te.DTh(I)):100>=I&&this.s2e()}}s2e(){this.Uue=!0;this.g9a.cancel()}setOpacity(I){vg.a.setOpacity(this.domElement,I);this.a7f=wc.a.kh.vi}static DTh(I){return 100>=I?1:250<=I?0:.01*(100-(I-100)/150*100)}}Object(za.a)(Te,"OnObjectButton",yd.a,[630,496,2]);var zf=a(1056);class dg extends Ob.a{constructor(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf){lf=void 0===lf?"":lf;super();this.rLa=null;this.jUf=!1;this.Bi=this.gOc=this.hOc=null;this.buttons={};this.$vf=
{};this.zoom=Re;this.$=I;this.svgIconProvider=pa;this.uQj=lb;this.MTd=hc;this.LTd=Xc;this.altText=Gd;this.U3b=ae;this.Bi=we;this.buttonText=lf}get zoomManager(){return this.zoom.zoomManager}get PE(){return this.zoomManager.Aua(Yb.a.PYj)}get DLb(){return Yb.a.OYj}get buttonWidth(){return this.zoomManager.Aua(Yb.a.QYj)}dispose(){this.Ihi();this.$=null;super.dispose()}getButton(I,pa){return this.exa(I,void 0===pa?!0:pa)}exa(I,pa){const lb=I.toString();lb in this.buttons||this.s8h(I,void 0===pa?!0:pa);
return this.buttons[lb]}hv(I,pa,lb,hc,Xc,Gd){Xc=void 0===Xc?!0:Xc;Gd=void 0===Gd?!1:Gd;this.hide();if(this.$.fa.isNamedObjectViewMode&&hd.i(this.$.la)){var ae=Oc.f(this.$).UZ.domElement;const we=I+this.buttonWidth-ae.scrollWidth;ae=pa+this.buttonWidth-ae.scrollHeight;I=0<we?I-we:I;pa=0<ae?pa-ae:pa}this.exa(hc,Xc).hv(I,pa,lb,this.$,Gd)}hide(){const I=this.buttons;for(const pa in I)I[pa].hide()}PEd(I,pa){!this.jUf&&(pa=this.buttons[pa.toString()])&&(this.hOc=(lb,hc)=>{I(hc,!0)},pa.zEh(this.hOc),this.gOc=
(lb,hc)=>{I(hc,!1)},pa.yEh(this.gOc),this.jUf=!0,pa.PEd())}s8h(I,pa){this.rLa=String.format(this.MTd===Pe.a.Xxc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Qa.a.Vr(this.MTd),Qa.a.Vr(this.LTd),"{0}");var lb=String.format(this.rLa,Qa.a.Vr(this.altText));pa=new Te(""===this.buttonText?"ewa-sharedUi-launchButton":"ewa-sharedUi-launchButtonWithText",""===this.buttonText?"ewa-sharedUi-launchButtonClick":
"ewa-sharedUi-launchButtonWithTextClick",Pe.a.d5,lb,pa,this.U3b,this.buttonText,"ewa-sharedUi-launchButtonText",this.Bi,this.zoom);lb=(hc,Xc)=>{this.uQj(Xc,I)};pa.y$(lb);this.buttons[I.toString()]=pa;this.$vf[I.toString()]=lb;lb=Oc.f(this.$).ol(I);lb.domElement.insertBefore(pa.domElement,lb.domElement.firstChild)}Ihi(){for(const I of zf.a(this.buttons)){const pa=this.buttons[I];pa.Oia(this.$vf[I]);Xa.a.gh(pa);delete this.buttons[I];this.hOc&&pa.wpk(this.hOc);this.gOc&&pa.vpk(this.gOc)}}domElement(I){return this.exa(I).domElement}ckb(I){this.exa(I).ckb()}Vbc(I,
pa,lb){lb=void 0===lb?!0:lb;this.rLa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Qa.a.Vr(this.MTd),Qa.a.Vr(this.LTd),"{0}");I=String.format(this.rLa,Qa.a.Vr(I));this.exa(pa,lb).MAe(I)}R$a(I,pa,lb){this.exa(lb,!1).a9k(I,pa)}i7g(){var I=void 0===I?!1:I;this.rLa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Qa.a.Vr(this.LTd),"{1}");const pa=String.format(this.rLa,void 0,
Qa.a.Vr(void 0));this.exa(void 0,I).MAe(pa)}v4c(I,pa,lb){this.exa(lb,!1).$8k(this.svgIconProvider,I,pa)}X3c(I,pa){this.exa(pa,!1).X3c(I)}}Object(za.a)(dg,"OnObjectLaunchButton",Ob.a,[608,2]);var tg=a(106);class Gg extends tg.a{constructor(I,pa){super(I);this.n_b=null;this.phi=()=>{this.display()};this.Qaj=Math.max(1,pa)}dispose(){Xa.a.gh(this.n_b);this.n_b=null;super.dispose()}B9a(){Xa.a.gh(this.n_b);this.n_b=uf.a.instance.create(this.phi,this.Qaj,ad.a.Szj)}I9a(){Xa.a.gh(this.n_b);this.hide()}}Object(za.a)(Gg,
"LoadingIndicatorBehavior",tg.a,[629,2]);class ah extends Gg{constructor(I,pa,lb,hc){super(I,pa);this.m_b=null;this.Elh=lb;this.N8i=hc;this.Jzh()}dispose(){this.m_b=null;super.dispose()}display(){this.Elh(this.m_b)}hide(){this.N8i(this.m_b)}Jzh(){this.m_b=document.createElement("div");this.domElement.appendChild(this.m_b)}}Object(za.a)(ah,"ShimmerLoadingIndicatorBehavior",Gg,[]);var bh=a(57);class Bh extends Gg{constructor(I,pa,lb,hc,Xc,Gd){hc=void 0===hc?null:hc;Xc=void 0===Xc?null:Xc;Gd=void 0===
Gd?0:Gd;super(I,pa);this.wnb=this.Q3a=null;this.wnb=lb;this.GFc=hc||bc.a.current.Tu(104);this.b9f=Gd;this.uBd=Xc;this.Izh()}dispose(){this.Q3a=null;super.dispose()}display(){De.DOMElementExtensions.setVisible(this.Q3a,!0)}hide(){De.DOMElementExtensions.setVisible(this.Q3a,!1)}Izh(){this.Q3a=document.createElement("div");this.Q3a.classList.add(bh.k);const I=document.createElement("div");I.classList.add(bh.l);this.uBd&&""!=this.uBd&&I.classList.add(this.uBd);const pa=0===this.b9f?"":$a.a.instance.ia(this.b9f),
lb=String.format('<div class="'+bh.m+'">{0}</div>',pa);this.GFc?this.wnb.hr(I,`<img src="${this.GFc}" alt="${pa}" title="${pa}"/>`+lb):this.wnb.hr(I,lb);this.Q3a.appendChild(I);this.domElement.appendChild(this.Q3a)}}Object(za.a)(Bh,"SpinnerLoadingIndicatorBehavior",Gg,[]);Object(Fc.b)(Gc.Tf)(I=>xo(function*(){const [pa,lb]=yield Promise.all([Fc.a.resolve(Gc.rd,{va:I.va}),Fc.a.resolve(Gc.dh)]);return new Qh(pa,lb)}));class Qh{constructor(I,pa){this.wnb=I;this.zoom=pa}tAd(I,pa,lb){return new da.a(I,
pa,lb)}buc(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf){return new hb.a(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf)}HNb(I,pa,lb,hc,Xc){return new Bh(I,pa,this.wnb,lb,hc,void 0===Xc?0:Xc)}rOd(I){return I.qa.zh(238)||new te(I)}wNb(I,pa,lb,hc,Xc,Gd,ae,we){return new dg(I,pa,lb,hc,Xc,Gd,ae,this.wnb,this.zoom,void 0===we?"":we)}amf(I,pa){return new Qe(I,pa)}p7h(I,pa,lb,hc){return new df(I,pa,lb,hc)}clf(I,pa,lb,hc){return new Vd(I,pa,lb,hc)}}Object(za.a)(Qh,"SharedUIControlsFactory",null,[585]);var Lh=a(486);let Rh=class{constructor(I,
pa,lb){var hc,Xc;this.$=I;this.da=pa;this.JL=lb;this.h9d=3;this.ihg=100;this.Xi=()=>{this.JL.r7a({abortReason:"workbookClosed"})};lb.r7a({success:!1,entriesCount:this.Dzb,abortReason:"notStarted",sheetCount:null===(Xc=null===(hc=this.$.sa)||void 0===hc?void 0:hc.items)||void 0===Xc?void 0:Xc.length});this.Zne();this.$.Pp(this.Xi)}Zne(){window.requestIdleCallback?window.requestIdleCallback(()=>this.Exg()):fd.e(()=>{this.Exg()},this.$.ya,100)}Exg(){if(this.tMk()){var I=this.$.sa.items,pa=this.$.fu.activeItemIndex;
0>pa&&(ea.ULS.sendTraceTag(507635023,0,50,"SheetProcessedDataProvider.prefetchSheetProcessedData: active item index is unknown, using 0 instead..."),pa=0);var lb=this.QMh;if(0===I.length||lb===I.length)ea.ULS.sendTraceTag(507635022,0,15,`SheetProcessedDataProvider.prefetchSheetProcessedData: there are ${lb}/${I.length} available spds, nothing to prefetch.`),this.JL.r7a({success:!0,entriesCount:this.Dzb});else{ea.ULS.sendTraceTag(507635021,0,50,`SheetProcessedDataProvider.prefetchSheetProcessedData: there are ${lb}/${I.length} available spds, searching for unavailable SPD to prefetch...`);
lb=pa-1;pa+=1;for(var hc;0<=lb||pa<I.length;){if(0<=lb){var Xc=I[lb];if(l(Xc)){hc=Xc.sheetName;break}--lb}if(pa<I.length){Xc=I[pa];if(l(Xc)){hc=Xc.sheetName;break}pa+=1}}null==hc?(this.JL.r7a({success:!0,entriesCount:this.Dzb}),ea.ULS.sendTraceTag(507635020,1,50,"SheetProcessedDataProvider.prefetchSheetProcessedData: done prefetching.")):this.da.Htk(hc).then(()=>{this.Zne()}).catch(Gd=>{--this.h9d;const ae=Lh.a.isExpectedError(Gd);ea.ULS.sendTraceTag(507635019,0,50,`SheetProcessedDataProvider.prefetchSheetProcessedData: unable to prefetch SPD, error='${Gd.message}', isExpected=${ae}. Remaining attempts=${this.h9d}...`);
0<this.h9d?this.Zne():this.JL.r7a({success:!1,entriesCount:this.Dzb,abortReason:"failedAttemptsLimit"})})}}}tMk(){let I=!0,pa;--this.ihg;0>this.ihg&&(pa="iterationLimit",I=!1);this.Vni&&(pa="maxEntriesExceeded",I=!1);I||(this.JL.r7a({success:!1,entriesCount:this.Dzb,abortReason:pa}),ea.ULS.sendTraceTag(507635018,0,50,`SheetProcessedDataProvider.shouldAttemptPrefetch: unable to prefetch all SPDs, reason=${pa}`));return I}get Vni(){return 1E3<=this.Dzb}get Dzb(){var I=this.$.sa.items;let pa=0;for(const lb of I)I=
lb.sheetProcessedData,Object(Je.d)(I)&&(pa+=I.value.L4a);return pa}get QMh(){let I=0;const pa=this.$.sa.items;for(const lb of pa)I+=Object(Je.d)(lb.sheetProcessedData)?1:0;return I}};Rh=Object(wb.__decorate)([Object(Fc.d)(Gc.Zf),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.kd)()),Object(wb.__param)(2,Object(Gc.Ug)())],Rh);Object(za.a)(Rh,"SheetProcessedDataPrefetcher",null,[]);var Gf=a(247),Yh=a(133),wg=a(609);class Ai extends Y.a{constructor(I,pa,lb,hc){super();this.value=
null;this.$=hc;this.E1d=I;this.AF=pa;this.pqh=lb}hDh(I){this.addHandler("EnabledStateChanged",I)}get isEnabled(){return this.AF}set isEnabled(I){I!==this.AF&&(this.AF=I,he.a.Qo(this.$)&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.E1d.replace(" ","")+"Button",I)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get Do(){return this.value?String.format($a.a.instance.sh(79),this.E1d,this.value):this.E1d}get WMc(){return this.pqh}}Object(za.a)(Ai,
"StatusBarAggregateControl",Y.a,[626]);class yh extends Y.a{constructor(I){super();this.controls=new Lg.a(!1);this.jIe=null;this.uge=()=>{this.raiseEvent("AggregatesChanged")};this.$=I;this.Ela(0,415,"Average",!0);this.Ela(1,416,"Count",!0);this.Ela(2,417,"NumericalCount",!1);this.Ela(3,418,"Minimum",!1);this.Ela(4,419,"Maximum",!1);this.Ela(5,420,"Sum",!0)}gCh(I){this.addHandler("AggregatesChanged",I)}unk(I){this.removeHandler("AggregatesChanged",I)}get Ffb(){return this.jIe||yh.cuf}set Ffb(I){var pa;
I=I||yh.cuf;if(I!==this.Ffb)if(this.$Pa(0,I.Average),this.$Pa(1,I.Count),this.$Pa(2,I.NumericalCount),this.$Pa(3,I.Minimum),this.$Pa(4,I.Maximum),this.$Pa(5,I.Sum),this.jIe=I,he.a.Qo(this.$))if(jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8624907_movingStatusBarAggregatesToDispatch")){const lb=[];null===(pa=this.controls)||void 0===pa?void 0:pa.forEach(hc=>{const Xc=hc.value;hc.key.startsWith("Query")&&(lb.push(appChrome.actions.updateControlHiddenState(hc.key,!Xc.isVisible)),lb.push(appChrome.actions.setControlLabel(hc.key,
Xc.Do)))});0<lb.length&&appChrome.api.dispatch(lb)}else this.uge();else this.uge()}dispose(){Xa.a.gj(this.controls.values);this.controls.clear();super.dispose()}bKa(I){return this.controls.getItem(I)}Eyh(I,...pa){I=this.bKa(I.toString());for(const lb of pa)this.controls.add(lb,I)}Ela(I,pa,lb,hc){pa=new Ai($a.a.instance.Aa(pa),hc,lb,this.$);pa.hDh(this.uge);this.controls.add(I.toString(),pa)}$Pa(I,pa){this.bKa(I.toString()).value=pa}static get cuf(){yh.oEa||(yh.oEa={},yh.oEa.Average=yh.oEa.Count=yh.oEa.NumericalCount=
yh.oEa.Minimum=yh.oEa.Sum=null);return yh.oEa}}yh.oEa=null;Object(za.a)(yh,"StatusBarAggregateControlCollection",Y.a,[]);var bi=a(401),vi=a(4),Vi=a(212),Wi;const wi=[{Gfb:0,name:"Average",m$a:-1015637685,Hfb:1,elb:!0},{Gfb:1,name:"Count",m$a:1957769939,Hfb:3,elb:!1},{Gfb:2,name:"NumericalCount",m$a:-1292677035,Hfb:2,elb:!1},{Gfb:3,name:"Minimum",m$a:405783320,Hfb:5,elb:!0},{Gfb:4,name:"Maximum",m$a:1210824414,Hfb:4,elb:!0},{Gfb:5,name:"Sum",m$a:1265371067,Hfb:9,elb:!0}];let Xi=Wi=class{constructor(I,
pa){this.statusBarManager=void 0===pa?null:pa;this.wAc=this.T3c=this.U3c=this.S3c=null;this.Gqb=new Lg.a(!0);this.Z0g=0;this.x4g=lb=>{const hc=this.ha.pa.activeCell.clone(),Xc=Kc.d(this.ha.pa.selectedRanges);var Gd=this.$.la;const ae=null===Gd||void 0===Gd?void 0:Gd.sheetId,we=null===Gd||void 0===Gd?void 0:Gd.hash,Re=this.$.fa.yk,lf=this.$.fa.UC;Gd=this.$.listSeparator;const hg=Kc.j(Kc.L(Xc),Gd,this.$,!1),Wg=`=${this.Mj.config.localeInfo.getWorksheetFuncName(485)}({0}${Gd}5${Gd}{1})`;Promise.all(wi.map(mg=>
this.Mj.evalFormula(String.format(Wg,mg.Hfb,hg),hc,void 0,mg.elb?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(mg=>{var Xg;const hi=this.ha.pa.selectedRanges,Nj=this.ha.pa.activeCell,yi=null===(Xg=this.$.la)||void 0===Xg?void 0:Xg.sheetId;if(Kc.X(Xc,hi)&&hc.equals(Nj)&&ae===yi){Xg=[];for(var Li of mg.entries()){[,mg]=Li;if(void 0===(null===mg||void 0===mg?void 0:mg.formatted)||!excelOnlineCalc.util.isSuccess(mg.formatted)||!excelOnlineCalc.util.isSuccess(mg.value)){this.RXc();
return}mg=this.Mj.zN.renderValue(mg.formatted.value,excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(mg)){this.RXc();return}if(jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8759742_ExcelOnlineCalcEs2015")&&excelOnlineCalc.numfmt.isHashesValue(mg.value)){this.RXc();return}mg=excelOnlineCalc.numfmt.renderedValueToString(mg.value);Xg.push(mg)}Li={};for(var zi of wi)Li[zi.name]="";zi=Xg[1];mg=Xg[2];if(1<+zi&&(Li.Count=zi,0<+mg))for(const pk of wi.entries()){const [Aj,Zk]=
pk;Li[Zk.name]=Xg[Aj]}this.a9b(Li);this.M_k(Li,zi,Re,lf,Xc,hc,ae,we,lb)}}).catch(mg=>{ea.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason fields: ${JSON.stringify(mg)}, reason message: ${String(mg)}, stack: ${null!==mg&&"object"===typeof mg?mg.stack:void 0}`);this.RXc()})};this.Gj=()=>{this.a6g()};this.onBlockCacheItemChanged=(lb,hc)=>{lb=hc.Oj.hash;hc=hc.Oj.block;const Xc=hc.hga;if(hc.state&4&&Xc&&Xc!==this.Gqb.getItem(lb)){this.Gqb.add(lb,Xc);var Gd=(lb=hc.tl)?
Oc.e(lb.getRowNumbers(),lb.getColumnNumbers()):null;Gf.a.any(this.ha.pa.selectedRanges,ae=>ae.$i(Gd))&&this.a6g()}};this.wx=(lb,hc)=>{this.Gqb.remove(hc.Oj.hash)};this.Dj=()=>{this.$.qa.zi(29,lb=>{this.statusBarManager=lb;lb.vO(this);ea.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};this.hj=(lb,hc)=>{!lb.ki&&fg.b(hc)&&this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null,ea.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};
this.t0k=()=>{let lb;const hc=this.ha.pa.selectedRanges;(()=>{let Xc=this.G5k(hc);({Wqc:lb}=Xc);return Xc})().returnValue?this.a9b(lb):this.xIg()};this.xIg=()=>{var lb;const hc=Kc.d(this.ha.pa.selectedRanges),Xc=this.ha.pa.activeCell.clone(),Gd=null===(lb=this.$.la)||void 0===lb?void 0:lb.sheetId;this.scg(Xc,hc,ae=>{var we;const Re=this.ha.pa.selectedRanges,lf=this.ha.pa.activeCell,hg=null===(we=this.$.la)||void 0===we?void 0:we.sheetId;Kc.X(hc,Re)&&Xc.equals(lf)&&Gd===hg&&this.a9b(ae.Result)})};
this.initData(I);I.Ia.iua(this);this.R7e=jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AlwaysTestCalcResult",!1);this.$=I;this.da=Oc.f(this.$);this.sma=Aa.AFrameworkApplication.lj;this.$p=wc.a.kh;this.GGa=new yh(this.$);this.$.fa.Nq(this.hj);this.$.nr(this.Dj);this.ha.cx(this.Gj);this.ha.add_activeCellChanged(this.Gj);this.za.sz(this.onBlockCacheItemChanged);this.za.uU(this.wx);for(const lb of wi)this.sJk(lb.Gfb,lb.name,lb.m$a);this.statusBarManager&&this.statusBarManager.vO(this);
void Fc.a.resolve(Gc.G,{va:1}).then(lb=>this.Mj=lb);void Fc.a.uj(Gc.Ed).then(lb=>this.instantaneousSupportInformationManager=lb)}ry(I){this.GGa.gCh(I)}fy(I){this.GGa.unk(I)}get Ffb(){return this.GGa.Ffb}a9b(I){this.GGa.Ffb=I}get za(){return this.da.za}get ha(){return this.da.ha}dispose(){this.$&&(this.$.fa.Lq(this.hj),this.$.$r(this.Dj),this.ha.Bx(this.Gj),this.ha.remove_activeCellChanged(this.Gj),this.za.Vz(this.onBlockCacheItemChanged),this.za.cW(this.wx),this.zef());this.statusBarManager&&(this.statusBarManager.GN(this),
this.statusBarManager=null);Xa.a.gj([this.S3c,this.U3c,this.T3c,this.GGa]);this.$=this.GGa=this.T3c=this.U3c=this.S3c=null;this.Gqb&&(this.Gqb.clear(),this.Gqb=null)}Aw(I,pa){return this.bKa(I)&&this.HLf(I,pa)?!0:!1}HLf(I,pa){const lb=this.bKa(I);if(!lb)return!1;const hc=lb.Do;if(I.endsWith("Label"))pa.Visible=lb.isVisible,he.a.Qo(this.$)?pa.LabelText=hc:pa.Value=hc;else if(I.endsWith("Button"))pa.LabelText=hc,pa.On=lb.isEnabled,Yh.FocusManager.instance().ds(wg.AFrame.B2);else return!1;return!0}Up(){return!0}Ri(){return!1}executeCommand(I,
pa){I=this.bKa(pa.command);if(!I)return Vi.a(pa.command);I.isEnabled=!I.isEnabled;this.SAj(I.WMc,I.isEnabled);return qd.Task.Ua(!0)}Ei(I,pa){return!!this.bKa(pa.command)}dj(){return!1}scg(I,pa,lb){var hc=this.$;this.zef();if(this.$.fa.ki){var Xc=hc.oa.ta;I=Kc.q(I,hc);pa=Kc.t(pa,hc);hc=Xc.Za(1,null);hc.activeCell=I;hc.selectedRanges=pa;this.wAc=Cb.h(Xc,"GetStatusBarAggregates",hc,lb,null,null,null,0)}}G5k(I){let pa,lb=Wi.w4g(I);({Wqc:pa}=lb);return{returnValue:lb.returnValue||this.fKh(I)&&this.cKh(I),
Wqc:pa}}M_k(I,pa,lb,hc,Xc,Gd,ae,we,Re){const lf=this.R7e?1:.05,hg=this.R7e?1E3:20;if(Re||!(this.Z0g>hg||Math.random()>lf))this.Z0g++,this.scg(Gd,Xc,Wg=>{var mg,Xg,hi,Nj;if(!tb.a(Wg)){var yi=this.ha.pa.selectedRanges,Li=this.ha.pa.activeCell,zi=null===(mg=this.$.la)||void 0===mg?void 0:mg.sheetId;mg=Wg.StateId;if(Kc.X(Xc,yi)&&Gd.equals(Li)&&ae===zi&&lb===this.$.fa.yk&&hc===this.$.fa.UC&&lb===mg){var pk=Wg.Result;mg={};const mm={};zi=!0;for(var Aj of wi){var Zk=pk[Aj.name],Pl=I[Aj.name];const nm=Zk===
Pl;mg[Aj.name]=nm;mm[Aj.name]=[Zk.length,Pl.length];zi&&(zi=nm)}({category:Li}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.A5k(null!==(Nj=null===(hi=null===(Xg=this.da.yh(Li))||void 0===Xg?void 0:Xg.cell)||void 0===hi?void 0:hi.to)&&void 0!==Nj?Nj:0):{category:"uninitialized"});Xg=yi.length;yi=Kc.b(yi);hi=this.da.hSf()||this.da.gSf();Aj=this.da.fh;Nj=Aj.y3b;Aj=xd.c(Gd,Aj.Im,Aj.en,this.da.rowsPerBlock,this.da.columnsPerBlock,this.da.jj);Aj=Aj.X+"_"+Aj.Y+
"_"+Aj.PaneType;pk=pk.Count;Zk=I.Count;Pl=this.da.oh.yCc(Xc);Wg=`StatusBarAggregateManager.testCalcResult: allCorrect: ${zi}, ${JSON.stringify(mg)}, numberFormatCategory: ${Li}, resLength(server,calc): ${JSON.stringify(mm)}, stateId: ${lb}, latestSuccessfulStateId: ${hc}, prevSheetId: ${ae}, prevSheetHash: ${we}, numOfRanges: ${Xg}, numOfCells: ${yi}, prevActiveCell: ${Gd}, prevSelectedRanges: ${Xc.join(";")}, sheetHasHidden: ${hi}, panesState: ${Nj}, blockPositionString: ${Aj}, ReportCalcState: ${Wg.ReportCalcState}, CalcComplete: ${Wg.CalcComplete}, serverCount: ${pk}, calcCount: ${Zk}, calcCountUnfiltered: ${pa}, enumeratorCount: ${Pl}, forceTestResult: ${Re}`;
ea.ULS.sendTraceTag(520426510,0,50,Wg);zi||Re||window.setTimeout(()=>{this.x4g(!0)},100)}}})}fKh(I){const pa=this.da.Wp;return!!pa&&Gf.a.all(I,lb=>pa.contains(lb))&&Gf.a.all(I,lb=>!this.da.jj.Moa(lb))}cKh(I){if(500<Kc.b(I))return!1;const pa=this.$p.Xj;I=this.da.Nfa("StatusBarAggregateManager.AreAllCellsEmpty",I);try{for(let lb=0;I.$$mn();lb++)if(I.$$cu().LQ||!(lb%25)&&100<Ld.c(this.$p,pa))return!1}finally{I&&I.dispose()}return!0}bKa(I){return this.GGa.bKa(I)}sJk(I,pa,lb){this.GGa.Eyh(I,"Query"+pa+
"Label","Query"+pa+"Button",lb.toString())}a6g(){var I;if(this.$.Kj&4&&!this.da.isEditing&&!this.da.kq){var pa;(()=>{let lb=Wi.w4g(this.ha.pa.selectedRanges);({Wqc:pa}=lb);return lb})().returnValue?this.a9b(pa):(this.a9b(null),(null===(I=this.Mj)||void 0===I?0:I.eHc)?this.dzk():this.S3c=Wb.AsyncMethodContext.AC(this.t0k,500,ad.a.vXk,this.S3c))}}dzk(){this.T3c=Wb.AsyncMethodContext.AC(()=>this.x4g(!1),10,ad.a.wXk,this.T3c)}RXc(){this.U3c=Wb.AsyncMethodContext.AC(this.xIg,500,ad.a.uXk,this.U3c)}zef(){this.wAc&&
(this.sma.lD(this.wAc.rC),this.wAc=null)}SAj(I,pa){const lb={};lb.a=this.$.ua.UserSessionId;lb.b=I;lb.c=pa;Mg.b().Ol(29,lb)}initData(I){const pa=bi.a.Dla;for(const lb of wi)pa(lb.m$a,he.a.Qo(I)?vi.a.sk|8192:vi.a.sk,0,0)}static w4g(I){return{returnValue:1===I.length&&I[0].isSingle,Wqc:null}}};Xi=Wi=Object(wb.__decorate)([Object(Fc.d)(Gc.ug),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(ef.g)())],Xi);Object(za.a)(Xi,"StatusBarAggregateManager",null,[583,2,176,177,36]);var fj=a(395),
Mi=a(971),pj=a(230);class Yi{constructor(){this.Bvh=new xc.a;this.Cvh=new xc.a}get e$a(){return this.Bvh}get r1g(){return this.Cvh}get gz(){return this.j0k}vBh(I,pa){this.e$a.add(I);this.r1g.add(pa)}wBh(I,pa){this.j0k={d7d:I,O5d:pa}}}Object(za.a)(Yi,"ThemeInfoCache",null,[]);var qj=a(44);let ni=class{constructor(I){this.e$a=this.j_=null;this.pIc=!1;this.cye=null;this.SNc=new Set;this.izb=this.Yed=!1;this.xQb=0;this.aWj=pa=>{this.pIc=!1;if(!pa||tb.a(pa))ea.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${pa?
Ia.a.fi(pa.Errors):"(no result)"}]`),this.hKg();else if(this.xQb=0,pa=pa.Result){null!==this.j_&&this.W0h(pa);this.j_=new Yi;this.e$a=pa.ThemeColors;this.cye=[];for(var lb=0;10>lb;lb++)this.cye.push(Mi.a.rKa(pj.a.XM(this.e$a[lb])));for(lb=0;6>lb;lb++)for(let hc=0;10>hc;hc++){const Xc=Ve.a.Uia(Ve.a.j3(this.e$a[10*lb+hc])),Gd=Mi.a.oRi(lb,hc,this.cye[hc],this.e$a[hc]);this.j_.vBh(Xc,Gd)}this.j_.wBh(pa.MinorFont,pa.MajorFont);this.izb=!1;he.a.Xk()&&(jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8768685_FixCommonUiStringsCrash")&&
!fj.a.Wfb&&fj.a.NVb(),fj.a.Hzj([pa.MajorFont,pa.MinorFont]));jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)&&jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewOfficeDefaultThemeSurvey",!1)&&"Aptos Narrow"===pa.MinorFont&&(pa=qj.a.instance.Kna(),27E4>pa?window.setTimeout(()=>{this.$.oi(-569754003,-1,0,null)},27E4-pa):this.$.oi(-569754003,-1,0,null));this.Yed=!1;this.tqa()}else ea.ULS.sendTraceTag(556656003,0,10,"ThemesManager: The obtained ThemeInfo is null")};
this.$Vj=()=>{this.pIc=!1;this.hKg()};this.hKg=()=>{3>this.xQb?(this.xQb++,ea.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.xQb}`),this.lJa(null,!0)):(this.xQb=0,ea.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.z2b=()=>{this.j_&&(ea.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),this.izb=!0,this.lJa(null,!0))};this.hj=(pa,lb)=>{this.j_&&
(ea.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),lb.fN&&(this.Yed=!0))};this.Dj=(pa,lb)=>{lb.$l&&td.HelperMethods.A_c(this.$)&&this.lJa(null,!0)};this.AN=()=>{this.SNc.clear()};this.$=I;this.$.fa.BO(this.z2b);this.$.fa.Nq(this.hj);this.$.Ia.XIb(this.AN);jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8557769_fetchThemeInfoViewToEdit")&&this.$.nr(this.Dj)}dispose(){var I,pa,lb,hc,Xc,Gd,ae;jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8557769_fetchThemeInfoViewToEdit")&&(null===
(pa=null===(I=this.$)||void 0===I?void 0:I.fa)||void 0===pa?void 0:pa.pQ(this.z2b),null===(hc=null===(lb=this.$)||void 0===lb?void 0:lb.fa)||void 0===hc?void 0:hc.Lq(this.hj),null===(Gd=null===(Xc=this.$)||void 0===Xc?void 0:Xc.Ia)||void 0===Gd?void 0:Gd.d6b(this.AN),null===(ae=this.$)||void 0===ae?void 0:ae.$r(this.Dj))}get jzb(){return!this.j_||this.izb?null:this.j_.e$a}get q1g(){return!this.j_||this.izb?null:this.j_.r1g}get gz(){return!this.j_||this.izb?null:this.j_.gz}get K4f(){return this.Yed}lJa(I,
pa){if(this.$.isEditMode||(void 0===pa?0:pa)||jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8768686_FixOpenMFPInEmbedView")&&this.$.Kh.allowTypingAndFormulaEntry)if(!this.j_||this.K4f||this.izb)if(I&&""!==I&&this.SNc.add(I),!this.pIc){this.pIc=!0;I=this.$.oa.ta;pa=this.aWj;var lb=this.$Vj;const hc=I.Za(1,null);Cb.h(I,"GetThemeInfo",hc,pa,lb,null,null,4)}}getThemeColor(I){let pa,lb=-1;pa=-1;if(!this.jzb)return ea.ULS.sendTraceTag(537150475,0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,
themeIndex:-1,XQa:pa};for(let hc=0;hc<this.jzb.count;hc++)if(I===this.jzb.ma(hc)){lb=hc;break}if(-1!==lb)return pa=Math.floor(lb/10),{returnValue:!0,themeIndex:lb%10,XQa:pa};ea.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,XQa:pa}}tqa(){for(const I of this.SNc)this.$.frame.WA(I);this.SNc.clear()}W0h(I){const pa=this.j_.gz.O5d;this.j_.gz.d7d===I.MinorFont&&pa===I.MajorFont||ea.ULS.sendTraceTag(512230155,0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};
ni=Object(wb.__decorate)([Object(Fc.d)(Gc.Fg),Object(wb.__param)(0,Object(Gc.Ob)())],ni);Object(za.a)(ni,"ThemesManager",null,[582,2]);var Zh=a(726);const Ni=Object(Qf.c)(Zh.b);var Xh=a(1017);class di{static nHi(I){try{return caches.open(di.uJe).then(pa=>pa.match(I))}catch(pa){return Promise.reject(null)}}static XJa(I,pa){try{return di.nHi(I).then(lb=>lb&&Number.parseInvariant(lb.headers.get("cachedTime"))>Date.now()-pa?Promise.resolve(lb.text().toLocaleString()):Promise.reject("Not found")).catch(()=>
Promise.reject("Cache returned undefined"))}catch(lb){return Promise.reject(null)}}static store(I,pa){try{return caches.open(di.uJe).then(lb=>{lb.put(I,pa).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(lb){return Promise.resolve(!0)}}static RXk(I,pa){const lb={};lb.body=pa;const hc={};hc.cachedTime=Date.now().toString();lb.headers=hc;pa=new Response(pa,lb);di.store(I,pa).then(()=>!0)}}di.uJe="ConsentState";Object(za.a)(di,"CacheManager",null,[]);class gj{constructor(){this.message=
null;this.httpStatusCode=0}}Object(za.a)(gj,"HttpRequstToPromiseRejectData",null,[]);class kh{constructor(I){this.g$=I}u7(I,pa,lb,hc,Xc,Gd){Zg.a.sendTelemetryEvent({name:"Office.Online."+I,dataFields:[{name:"EventMessage",string:pa},{name:"FormFactor",string:this.g$.formFactor},{name:"CorrelationId",string:this.g$.correlationId},{name:"AccountType",string:this.g$.accountType},{name:"OSVersion",string:this.g$.osVersion},{name:"AppId",string:this.g$.appId},{name:"ConsentSurface",string:"AppStart"},
{name:"ConsentLanguage",string:this.g$.consentLanguage},{name:"EventCode",string:lb},{name:"Region",string:this.g$.region},{name:"ModelType",string:hc},{name:"ModelId",string:Xc},{name:"Platform",string:this.g$.os},{name:"ReConsentReason",string:""},{name:"ConsentType",string:Gd}]})}}Object(za.a)(kh,"TelemetryLogger",null,[]);var Bi=a(243);class Ci{constructor(I,pa,lb){this.Akh="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Ea=I;this.$n=pa;this.dGa=lb;this.W_=new kh(lb)}fYa(I,
pa){return new Promise((lb,hc)=>{const Xc=this.Ea.Ij("UCNoticeCheckinCallTimeoutMs",5E3);let Gd=this.Ea.Ya("UCNoticeCheckinStateUrl");Gd&&Gd.length||(Gd=this.Akh);this.$n.w$(Gd,1,null,this.GSb(I),null,!1,0,ae=>{try{if(void 0===ae||null===ae||void 0===ae.data||null===ae.data||void 0===ae.data.responseData||null===ae.data.responseData){this.W_.u7("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const Re=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
"UnifiedConsent.ConsentGetFailed");hc(this.uP(Re,ae))}else if(ae.data.httpStatus!==Bi.a.NL){this.W_.u7("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",ae.data.httpStatus.toString(),null,null,null);const Re=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",ae.data.httpStatus,"UnifiedConsent.ConsentGetFailed");hc(this.uP(Re,ae))}else{var we=pa(ae.data.responseData);
if(we)lb(we);else{this.W_.u7("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);const Re=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");hc(this.uP(Re,ae))}}}catch(Re){this.W_.u7("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),we=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
Re,"UnifiedConsent.ConsentGetFailed"),hc(this.uP(we,ae))}},ae=>{this.W_.u7("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",ae.data.httpStatus.toString(),null,null,null);const we=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",ae.data.httpStatus,"UnifiedConsent.ConsentGetFailed");hc(this.uP(we,ae))},null,void 0,void 0,2500,Xc)})}uP(I,pa){const lb=new gj;lb.message=I;lb.httpStatusCode=pa&&pa.data?pa.data.httpStatus:
-1;return lb}GSb(I){const pa={};pa["Accept-Language"]=this.dGa.consentLanguage;pa.consentsurface="AppStart";pa.platform="Web";pa.formfactor=vg.a.H1?"Mobile":"Desktop";pa["x-Cid"]=this.dGa.correlationId;pa.Authorization="Bearer "+I;return pa}}Object(za.a)(Ci,"HttpRequestToPromiseUtility",null,[]);var hj=a(112);class ij{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";
this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(za.a)(ij,"WebSdkAdapterProps",null,[]);var wh=a(47);class Ih{constructor(I,pa,lb,hc){this.VOe=this.nsa=this.pea=this.a$=null;this.f6j=Xc=>{if(void 0===Xc||null===Xc)return this.W_.u7(Ih.PTa,"Checkin response undefined or null","705",this.a$,this.pea,this.nsa),null;try{const {Fz:Gd}=wh.d(Xc);return Gd}catch(Gd){this.W_.u7(Ih.PTa,"Checkin response parse error : "+Gd.message,
"706",this.a$,this.pea,this.nsa)}return null};this.Rab=hc;this.Ea=I;this.Zih=lb;this.$n=pa;this.dGa=this.getDimensions();this.W_=new kh(this.dGa)}yVg(){"MSA"===(this.Ea.Ya("HostAuthType")||"").toUpperCase()&&di.XJa(this.dGa.userId,this.Ea.Ij("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.W_.u7(Ih.PTa,"CacheFound","701",this.a$,this.pea,this.nsa);return{}}).catch(()=>{this.Zih.execute(I=>{I.nF("Consent",Ih.fvh).then(pa=>{pa.IsSuccess?(this.W_.u7(Ih.PTa,"CheckInTokenSuccess","702",this.a$,this.pea,
this.nsa),this.gJi(pa.Token).then(lb=>{this.mRi(lb);this.a$&&""!==this.a$&&I.nF("Consent",Ih.hvh).then(hc=>{hc.IsSuccess?(this.W_.u7(Ih.PTa,"WebTokenSuccess","703",this.a$,this.pea,this.nsa),this.jSk(hc,this.a$)):this.W_.u7(Ih.PTa,"WebTokenFailed : "+hc.ErrorMessage,hc.ErrorCode,this.a$,this.pea,this.nsa);return{}});return{}})):this.W_.u7(Ih.PTa,"CheckInTokenFailed : "+pa.ErrorMessage,pa.ErrorCode,this.a$,this.pea,this.nsa);return{}})})})}gJi(I){this.VOe=new Ci(this.Ea,this.$n,this.dGa);return this.VOe.fYa(I,
this.f6j).then(pa=>Promise.resolve(pa),pa=>Promise.reject("Error while getting result"+pa))}mRi(I){for(const pa of I.consentValues)if(pa.needConsent&&!pa.maxPromptsReached){this.pea=pa.id;this.nsa=pa.consentType;this.a$=pa.modelType;return}di.RXk(this.dGa.userId,wh.c(I))}jSk(I,pa){if(hj.a("showConsentNotice")){const lb=document.createElement("div");document.body.appendChild(lb);appChrome.api.showConsentNotice(this.aLi(I.Token,pa),lb)}else this.W_.u7(Ih.Rph,"1JS : ShowConsentNotice API not found",
"704",this.a$,this.pea,this.nsa)}aLi(I,pa){const lb=this.dGa;lb.token=I;lb.modelType=pa;return lb}getDimensions(){const I=this.VFc(this.Ea.Ya("SessionStartInfoJson"));return Object.assign(new ij,{emailId:this.Ea.Ya("UserPrincipalName"),userId:this.Ea.Ya("LoggableUserId"),accountType:"AAD"===(this.Ea.Ya("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Ea.Ya("OfficeApplicationId"),appVersion:this.Ea.Ya("appVersion"),appName:"Application"in I?I.Application:"",appEnv:this.Rab,consentLanguage:this.Ea.Ya("UICulture")||
"en-US",formFactor:vg.a.H1?"Mobile":"Desktop",os:"Os"in I?I.Os:"",osVersion:"OsVersion"in I?I.OsVersion:"",region:this.Ea.Ya("region"),correlationId:Ra.a.create().toString(),isDarkMode:this.Ea.ka("DarkModeIsOn"),useCache:!0})}VFc(I){let pa={};try{pa=wh.b(I)}catch(lb){}return pa}}Ih.hvh="https://consentservice.microsoft.com/web";Ih.fvh="https://consentservice.microsoft.com/checkin";Ih.Rph="UnifiedConsent.ConsentGetFailed";Ih.PTa="UnifiedConsent.AuthTokenStatus";Object(za.a)(Ih,"ConsentNoticeManager",
null,[644]);class jj{constructor(){this.Vh=null}get name(){return"Common.App.ConsentNoticeDialog"}co(I){this.Vh=I;I.register(Ih,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").Ai().Ii(()=>new Ih(Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.lj,Object(Xh.a)(),Aa.AFrameworkApplication.twa))}init(){Object(Qf.a)(Ni)}dispose(){}static main(){Vb.a.instance.Jo(new jj)}}Object(za.a)(jj,"ConsentNoticeDialogPackage",null,[13,14]);let kj=
class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");jj.main();Eg.a.instance.Dk("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(I=>I.yVg())}};kj=Object(wb.__decorate)([Object(Fc.d)(Gc.Lg)],kj);Object(za.a)(kj,"UnifiedConsentAdapter",null,[]);var Dh=a(959);class oi{constructor(I,pa){this.viewportScenarioContext=I;this.sra=pa}dispose(){var I;null===(I=this.sra)||void 0===I?void 0:I.RCa("dispose")}lia(I){var pa;null===(pa=this.sra)||void 0===pa?void 0:pa.RCa("navigationStart",
I)}dQ(){var I;null===(I=this.sra)||void 0===I?void 0:I.RCa("scrollEnd")}Phg(I){var pa;null===(pa=this.sra)||void 0===pa?void 0:pa.RCa("activeItemChanged",I)}Gtg(){var I;null===(I=this.sra)||void 0===I?void 0:I.RCa("viewportReachedRequiredStateId")}}Object(za.a)(oi,"ViewportObservedScenario",null,[]);var og=a(706);const Jh={navigationStart:"navigationStarted",scrollEnd:"unexpected",viewportReachedRequiredStateId:"unexpected",activeItemChanged:"unexpected",zoomOrSizeChange:"idle",dispose:"disposed"},
rj={idle:Jh,navigationStarted:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"scrollEnded",viewportReachedRequiredStateId:"navigationStarted",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"navigationStarted",dispose:"disposed"},scrollEnded:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"unexpected",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"scrollEnded",dispose:"disposed"},
navigationEnd:Jh,abortNavigationAndStartNew:Jh,abortNavigationAndStartActiveItemChange:Jh,unexpected:Jh,disposed:{navigationStart:"disposed",scrollEnd:"disposed",viewportReachedRequiredStateId:"disposed",activeItemChanged:"disposed",zoomOrSizeChange:"disposed",dispose:"disposed"}},ei={navigationStart:"unexpected",scrollEnd:"unexpected",viewportReachedRequiredStateId:"unexpected",activeItemChanged:"activeItemChangeStarted",zoomOrSizeChange:"idle",dispose:"disposed"},Bj={idle:ei,activeItemChangeStarted:{navigationStart:"duringActiveItemChange",
scrollEnd:"unexpected",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"activeItemChangeStarted",dispose:"disposed"},duringActiveItemChange:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"duringActiveItemChange",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"duringActiveItemChange",dispose:"disposed"},navigationEnd:ei,abortNavigationAndStartNew:ei,
abortNavigationAndStartActiveItemChange:ei,unexpected:ei,disposed:{navigationStart:"disposed",scrollEnd:"disposed",viewportReachedRequiredStateId:"disposed",activeItemChanged:"disposed",zoomOrSizeChange:"disposed",dispose:"disposed"}},Ch=new oi({name:"ViewportObserverState.idle"});class Cj{constructor(I){var {lia:pa,u2b:lb,Hae:hc}=I;this.jmi=()=>{const Xc=this.pB.viewportScenarioContext;this.pB.dispose();this.pB=Ch;this.u2b(Xc)};this.Twh=Xc=>{this.W1e(Xc);this.pB=new oi(Xc,new og.a("idle",rj,this.RQ));
this.pB.lia(Xc)};this.Swh=Xc=>{this.W1e(Xc);this.pB=new oi(Xc,new og.a("idle",Bj,this.RQ));this.pB.Phg(Xc)};this.W1e=Xc=>{this.Hae(Xc);this.pB.dispose()};this.pB=Ch;this.lia=pa;this.u2b=lb;this.Hae=hc;this.RQ={abortNavigationAndStartNew:this.Twh,abortNavigationAndStartActiveItemChange:this.Swh,navigationEnd:this.jmi}}dispose(){this.pB.dispose();this.pB=Ch}get pB(){return this.Zkh}set pB(I){I!==Ch&&this.lia(I.viewportScenarioContext);this.Zkh=I}get Tob(){return this.pB===Ch}Vqg(I){this.Tob&&(this.pB=
new oi(I,new og.a("idle",rj,this.RQ)));this.pB.lia(I)}onActiveItemChanging(I){this.Tob&&(this.pB=new oi(I,new og.a("idle",Bj,this.RQ)));this.pB.Phg(I)}cRc(I){this.pB.dQ();this.r5f(I)&&this.pB.Gtg();return this.pB.viewportScenarioContext}B7(I){this.r5f(I)&&this.pB.Gtg()}r5f(I){return void 0!==this.pB.viewportScenarioContext.L6b&&I>=this.pB.viewportScenarioContext.L6b}}Object(za.a)(Cj,"ViewportObserverState",null,[]);class sj{constructor(I){this.da=I}qpj(I){if(!I)return!0;I.u0();return!this.da.fh.OZd(I)&&
this.da.Eba(I,!1)}}Object(za.a)(sj,"NavigationResultValidator",null,[]);let Md=class{constructor(I){this.da=I;this.FD=A();this.Kog=(pa,lb)=>{this.NAb.Vqg(this.npd(lb))};this.Rpg=(pa,lb)=>{this.NAb.Vqg(this.npd(lb))};this.X4a=()=>{};this.onActiveItemChanging=()=>{this.NAb.onActiveItemChanging(this.npd({name:"GridView.OnActiveItemChanged"}))};this.nq=()=>{};this.cRc=()=>{const pa=this.NAb.cRc(this.da.$ra);this.FD.dispatchEvent("ScrollEnd",{viewportScenarioContext:pa})};this.B7=(pa,lb)=>{lb.C1a&&this.NAb.B7(lb.$ra)};
this.u2b=pa=>{x(pa)||"zoom"===pa.name||this.QKj.qpj(pa.targetRange)||this.Mek(pa);this.SAg(pa,"complete")};this.Nek=pa=>{this.FD.dispatchEvent("NavigationStart",{viewportScenarioContext:pa})};this.Lek=pa=>{this.SAg(pa,"aborted")};jd.EwaSettings.m3a()?(ea.ULS.sendTraceTag(507606538,0,50,"ViewportObserver.ctor: flight is on"),this.QKj=new sj(I),this.NAb=new Cj({lia:this.Nek,u2b:this.u2b,Hae:this.Lek}),I.Hpd(this.X4a),I.$.LI(this.nq),I.$.fu.yX(this.onActiveItemChanging),I.Wpd(this.B7),I.view.R5e(this.Kog),
I.view.lFh(this.Rpg),I.view.Unc(this.cRc)):ea.ULS.sendTraceTag(507606539,0,50,"ViewportObserver.ctor: flight is off")}epd(I,pa){jd.EwaSettings.m3a()&&this.FD.addEventListener("NavigationStart",I,{signal:pa})}c4e(I,pa){jd.EwaSettings.m3a()&&this.FD.addEventListener("NavigationFail",I,{signal:pa})}SAh(I,pa){jd.EwaSettings.m3a()&&this.FD.addEventListener("ScrollEnd",I,{signal:pa,once:!0})}b4e(I,pa,lb){jd.EwaSettings.m3a()&&this.FD.addEventListener("NavigationEnd",I,{signal:pa,once:lb})}dispose(){jd.EwaSettings.m3a()&&
(this.da.Lje(this.X4a),this.da.$.mL(this.nq),this.da.$.fu.Nn(this.onActiveItemChanging),this.da.Xje(this.B7),this.da.view.JGg(this.Kog),this.da.view.Zpk(this.Rpg),this.da.view.UGg(this.cRc),this.NAb.dispose())}Mek(I){this.FD.dispatchEvent("NavigationFail",{viewportScenarioContext:I})}SAg(I,pa){this.FD.dispatchEvent("NavigationEnd",{viewportScenarioContext:I,navigationEndReason:pa})}npd(I){return void 0!==I.L6b?I:Object.assign({},I,{L6b:this.da.$.fa.yk})}};Md=Object(wb.__decorate)([Object(Fc.d)(Gc.Tg),
Object(wb.__param)(0,Object(Gc.kd)())],Md);Object(za.a)(Md,"ViewportObserver",null,[]);class ve{constructor(){this.defaultRate=this.defaultCount=this.total=0;this.defaultCountByReason={"ActivateItem-with-SheetCtor":0,"ActivateItem-with-BootFromCache":0,"ActivateItem-with-OpenWorkbook":0,"ActivateItem-with-HttpError":0,"ActivateItem-with-InternalServerError":0,"ActivateItem-with-OnLoadOnDemandOccurred":0,"ActivateItem-with-PartialResult":0,NewSheet:0,NullActiveItem:0,NotReceivedFromOpenWorkbook:0,
PartialResult:0};this.prefetchInfo={success:!1,entriesCount:0,abortReason:void 0,maxEntries:void 0}}get reportName(){return"SPD"}}Object(za.a)(ve,"SheetProcessedDataSessionEndsReport",null,[182]);class Oi{constructor(){this.maxUsedRow=this.maxUsedColumn=0;this.isRowMaxPixelExceeded=!1}get reportName(){return"Viewport"}}Object(za.a)(Oi,"ViewportSessionEndsReport",null,[182]);class nh{constructor(){this.hitCount=this.total=0;this.missCountByReason={};this.firstScrollSheetMissCount=this.sheetOnBootMissCount=
0}}Object(za.a)(nh,"BlockCacheAccessesTelemetry",null,[]);class ii{constructor(){this.sessionBoot=new nh;this.postSessionBoot=new nh;this.duringScroll=new nh;this.blockCacheSize=this.numOfUsedPrefetchedBlocks=this.numOfPrefetchedBlocks=this.accessedBlocksDistinctCount=0}get reportName(){return"BlockCacheAccess"}}Object(za.a)(ii,"BlockCacheAccessSessionEndsReport",null,[182]);class Ei{constructor(){this.distinctCount=this.count=0;this.skeletonBlocksCounter={}}get reportName(){return"SkeletonCounter"}}
Object(za.a)(Ei,"SkeletonCounterSessionEndsReport",null,[182]);var tj=a(177);class Zi extends Y.a{constructor(){super();this.h4b=[];this.ANj()}dispose(){var I;null===(I=this.Xvg)||void 0===I?void 0:I.disconnect();super.dispose()}vEh(I){this.addHandler(Zi.e7d,I)}tpk(I){this.removeHandler(Zi.e7d,I)}Ual(I){this.h4b.push({CRc:I,timestamp:performance.now()})}ANj(){var I;if(null===(I=PerformanceObserver.supportedEntryTypes)||void 0===I?0:I.includes("long-animation-frame"))try{this.Xvg=new PerformanceObserver(pa=>
{for(const lb of pa.getEntries())this.ufi(lb)}),this.Xvg.observe({type:"long-animation-frame"})}catch(pa){ea.ULS.sendTraceTag(507799641,345,10,`observeLongAnimationFrame: observe({ type: "long-animation-frame" }) failed with: ${pa}`)}}ufi(I){const pa=[],lb=I.startTime;I=lb+I.duration;let hc=0;for(let Xc=0;Xc<this.h4b.length;++Xc){const Gd=this.h4b[Xc],ae=Gd.timestamp;if(ae>=lb&&ae<=I){pa.push({NDj:lb,MDj:I,CRc:Gd.CRc});hc=Xc+1;break}if(ae>lb){hc=Xc;break}}this.h4b=this.h4b.slice(hc);0<pa.length&&
this.raiseEvent(Zi.e7d,{eIj:pa})}}Zi.e7d="mbdek";Object(za.a)(Zi,"ScrollMissingBlocksDetector",Y.a,[2]);var uj=a(744);class $i{constructor(I,pa,lb,hc,Xc,Gd,ae,we){this.Yt=Gd;this.context=ae;this.v3=we;this.n5a=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8720834_OnMarkAddedRefactor");this.Jj=!1;this.dka=new AbortController;this.Xwh=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8731957_NavLatAbortWhenMarkLimitIsReached");this.hwk=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8781622_RevertNavLatAbortWhenMarkLimitIsReached");
this.f6d=()=>{this.mark("scroll-end")};this.oYj=Re=>{this.Wca(Re)};this.da=I;this.scenario=hc;this.aWf=pa;this.LYc=Xc;this.pYj=lb;this.mark("start",void 0,null===ae||void 0===ae?void 0:ae.timestamp);this.B7=(Re,lf)=>{lf.C1a&&(Re=lf.$ra,this.QGa(Re)?this.eNa(lf.timestamp):-1===Re?this.mark("skeleton-blocks",void 0,lf.timestamp):0<=Re&&this.mark("stale-blocks",new uj.a(Re),lf.timestamp))};this.da.Wpd(this.B7)}get CIc(){return!this.Jj}get Z3d(){return 50}dispose(){this.Jj=!0;this.da.Xje(this.B7)}RKj(){var I,
pa;null===(I=this.v3)||void 0===I?void 0:I.SAh(this.f6d,this.dka.signal);null===(pa=this.v3)||void 0===pa?void 0:pa.b4e(this.oYj,this.dka.signal,!0)}QGa(I){return I>=this.aWf}x8(I,pa,lb){var hc;this.mark("end",void 0,lb);this.log(I,pa);this.FBe(I);null===(hc=this.pYj)||void 0===hc?void 0:hc.call(this);this.Yt.g5c&&!this.Yt.MXb&&(I=this.Yt.markers,pa=I[I.length-1],ea.ULS.shipAssertTag(507557020,0,!!pa,"NavigationOperationLatencyTelemetry.scenarioEndLegacy: endMark is undefined!"),this.Yt.measure({from:I[0],
i3:pa,E6d:this.scenario}))}mark(I,pa,lb){this.hwk?(I=this.Yt.mark(I,this.scenario,pa,lb),this.n5a&&I&&this.m5a(I,pa)):this.Xwh?this.CIc&&!this.Yt.MXb&&(I=this.Yt.mark(I,this.scenario,pa,lb),this.Yt.MXb?this.x8("aborted","markersMaxLengthReached"):this.n5a&&I&&this.m5a(I,pa)):(I=this.Yt.mark(I,this.scenario,pa,lb),this.m5a(I,pa))}m5a(I){this.n5a&&this.Yt.g5c&&performance.mark(I.name,{startTime:I.timestamp})}log(I,pa){I=JSON.stringify(this.K_a(I,pa));this.v3?ea.ULS.sendTraceTag(507570122,0,50,`NavigationOperationLatencyTelemetry.log: ${I}`):
ea.ULS.sendTraceTag(356298771,0,this.Z3d,`NavigationOperationLatencyTelemetry.log: ${I}`)}K_a(I,pa){return{scenario:this.scenario,endReason:I,endDetails:pa,initialStateId:this.aWf,duration:this.Yt.duration.toFixed(4),skeletonDuration:this.Yt.skeletonDuration.toFixed(4),staleDuration:this.Yt.staleDuration.toFixed(4),isMarkersMaxLengthReached:this.Yt.MXb}}eNa(I){this.x8("complete",void 0,I)}Wca(I){const pa=I.detail.navigationEndReason;I=I.detail.viewportScenarioContext;ea.ULS.shipAssertTag(507570121,
0,this.CIc,`NavigationOperationLatencyTelemetry.scenraioEnd: scenario already ended, logging twice, name=${I.name}, endReason=${pa}, requiredViewportStateId=${I.L6b}`);this.x8(pa);this.dispose()}}Object(za.a)($i,"NavigationOperationLatencyTelemetry",null,[616]);class ji{constructor(I,pa,lb){this.name=I;this.timestamp=pa;this.context=lb}toJSON(){return{n:this.name,t:this.timestamp.toFixed(4),c:this.context}}}Object(za.a)(ji,"NavigationMark",null,[]);class ci{constructor(I){I=void 0===I?!1:I;this.markers=
[];this.g5c=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8720834_OnMarkAddedRefactor")&&jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8697299_NavLatPerfMeasureV2")&&!I&&!!performance.measure}get MXb(){return this.markers.length>=ci.UFj}get duration(){return this.endTime-this.startTime}get skeletonDuration(){return this.markers.reduce((I,pa,lb)=>{lb=this.markers[lb-1];return"skeleton-blocks"===(null===lb||void 0===lb?void 0:lb.name)?I+(pa.timestamp-lb.timestamp):I},0)}get staleDuration(){return this.markers.reduce((I,
pa,lb)=>{lb=this.markers[lb-1];return"stale-blocks"===(null===lb||void 0===lb?void 0:lb.name)?I+(pa.timestamp-lb.timestamp):I},0)}get startTime(){return this.markers[0].timestamp}get endTime(){return this.markers[this.markers.length-1].timestamp}mark(I,pa,lb,hc){if(!this.MXb)return this.qp(I,lb,hc)}C0a(I){return void 0!==this.$Hd(I)}measure(I){var {from:pa,i3:lb,E6d:hc}=I,Xc;I=Object(Dh.e)(pa)?this.$Hd(pa):pa;const Gd=Object(Dh.e)(lb)?this.$Hd(lb):lb;if(I&&Gd){var ae=null!==hc&&void 0!==hc?hc:`${I.name}->${Gd.name}`;
if(this.g5c)try{var we=null===(Xc=performance.measure(ae,I.name,Gd.name))||void 0===Xc?void 0:Xc.duration;void 0===we&&ea.ULS.sendTraceTag(507536290,0,15,"NavigationLatencyTracker.measure: performance.measure returned undefined!")}catch(Re){ea.ULS.sendTraceTag(507367692,0,15,`NavigationLatencyTracker.measure: performance.measure threw an error,! msg=${null===Re||void 0===Re?void 0:Re.message}, fromMark=${I.name}, toMark=${Gd.name}, measurementName=${ae}`)}return null!==we&&void 0!==we?we:Gd.timestamp-
I.timestamp}}qp(I,pa,lb){I=this.markers.push(new ji(I,null!==lb&&void 0!==lb?lb:performance.now(),pa));return this.markers[I-1]}$Hd(I){for(let pa=this.markers.length-1;0<=pa;pa--)if(this.markers[pa].name===I)return this.markers[pa]}}ci.UFj=50;Object(za.a)(ci,"NavigationLatencyTracker",null,[]);class Tj extends ci{constructor(){super(...arguments);this.eMa=!1;this.Vra=[];this.nld=this.Ogd=this.old=0}get skeletonDuration(){return this.old}get missingBlocksDuration(){return this.Ogd}get skeletonAndMissingBlocksDuration(){return this.nld}$ai(){let I=
!1,pa=void 0;for(let lb=0;lb<this.markers.length;lb++){const hc=this.markers[lb];switch(hc.name){case "missing-blocks-start":I?(this.Vra.push(new ji("skeleton-and-missing-blocks-start",hc.timestamp)),I=!1):this.Vra.push(hc);break;case "missing-blocks-end":"missing-blocks-start"===(null===pa||void 0===pa?void 0:pa.name)&&this.Vra.push(hc);break;case "only-missing-blocks-end":"only-missing-blocks-start"===(null===pa||void 0===pa?void 0:pa.name)&&this.Vra.push(hc);break;case "skeleton-blocks":I||(I=
!0,this.Vra.push(hc));break;default:hc.name!==(null===pa||void 0===pa?void 0:pa.name)&&(I=!1,this.Vra.push(hc))}"start"!==hc.name&&"scroll-end"!==hc.name&&(pa=hc)}return this.Vra}NTh(){let I=this.Vra[0];for(let pa=1;pa<this.Vra.length;++pa){const lb=this.Vra[pa];if("start"!==lb.name&&"scroll-end"!==lb.name){switch(I.name){case "missing-blocks-start":case "only-missing-blocks-start":this.Ogd+=lb.timestamp-I.timestamp;break;case "skeleton-and-missing-blocks-start":this.nld+=lb.timestamp-I.timestamp;
break;case "skeleton-blocks":this.old+=lb.timestamp-I.timestamp}I=lb}}}qp(I,pa,lb){lb=null!==lb&&void 0!==lb?lb:performance.now();I=new ji(I,lb,pa);this.markers.splice(this.ePi(lb),0,I);return I}ePi(I){for(let pa=this.markers.length-1;0<=pa;pa--)if(this.markers[pa].timestamp<=I)return pa+1;return 0}}Object(za.a)(Tj,"ScrollLatencyTracker",ci,[]);class pi extends $i{constructor(I,pa,lb,hc,Xc,Gd){super(I,pa,lb,"scroll",hc,new Tj(!!Gd),Xc,Gd);this.B0b=new Zi;this.lW={$Vf:0,ZVf:0,roe:0,goe:0,ioe:0,noe:0};
this.f6d=()=>{if(!this.eMa){this.mark("scroll-end");this.eMa=!0;var ae=this.da.view,we=ae.bma.y-this.lW.$Vf;0<we?this.lW.goe=we:0>we&&(this.lW.roe=Math.abs(we));ae=ae.bma.x-this.lW.ZVf;0<ae?this.lW.noe=ae:0>ae&&(this.lW.ioe=Math.abs(ae))}};this.Npg=(ae,we)=>{for(const Re of we.eIj)ae=Re.CRc?"only-missing-blocks-end":"missing-blocks-end",this.mark(Re.CRc?"only-missing-blocks-start":"missing-blocks-start",void 0,Re.NDj),this.mark(ae,void 0,Re.MDj)};this.Mpg=(ae,we)=>{this.B0b.Ual(we.i2f)};this.da.iFh(this.Mpg);
this.B0b.vEh(this.Npg);I=this.da.view;this.lW.$Vf=I.bma.y;this.lW.ZVf=I.bma.x}get eMa(){return this.Yt.eMa}set eMa(I){this.Yt.eMa=I}dispose(){this.Shi();super.dispose()}eNa(I){this.eMa?this.x8("complete",void 0,I):this.mark("content")}K_a(I,pa){const lb=this.Yt.$ai();this.Yt.NTh();return Object.assign({},super.K_a(I,pa),{missingBlocksDuration:this.Yt.missingBlocksDuration.toFixed(4),skeletonAndMissingBlocksDuration:this.Yt.skeletonAndMissingBlocksDuration.toFixed(4),userExperienceMarks:lb})}Shi(){var I,
pa;this.da.Wpk(this.Mpg);null===(I=this.B0b)||void 0===I?void 0:I.tpk(this.Npg);null===(pa=this.B0b)||void 0===pa?void 0:pa.dispose();this.B0b=void 0}FBe(){const I=this.LYc.ScrollLatency;I.duration+=this.Yt.duration;I.skeletonDuration+=this.Yt.skeletonDuration;I.skeletonAndMissingBlocksDuration+=this.Yt.skeletonAndMissingBlocksDuration;I.missingBlocksDuration+=this.Yt.missingBlocksDuration;this.lW.roe>I.maxScrollDistance.maxScrollUpDistancePx&&(I.maxScrollDistance.maxScrollUpDistancePx=this.lW.roe);
this.lW.goe>I.maxScrollDistance.maxScrollDownDistancePx&&(I.maxScrollDistance.maxScrollDownDistancePx=this.lW.goe);this.lW.ioe>I.maxScrollDistance.maxScrollLeftDistancePx&&(I.maxScrollDistance.maxScrollLeftDistancePx=this.lW.ioe);this.lW.noe>I.maxScrollDistance.maxScrollRightDistancePx&&(I.maxScrollDistance.maxScrollRightDistancePx=this.lW.noe)}}Object(za.a)(pi,"ScrollOperationLatencyTelemetry",$i,[]);class ki{constructor(I){var {iHa:pa,RMa:lb,Nxa:hc}=I;this.iHa=pa;this.RMa=lb;this.Nxa=hc}toJSON(){return{logic:this.iHa.toFixed(4),
endOfLogicToGoto:this.RMa.toFixed(4),"goto":this.Nxa.toFixed(4)}}}Object(za.a)(ki,"GotoDurationInformation",null,[]);class lh extends ci{get wPf(){if(jd.EwaSettings.HY()||jd.EwaSettings.oha()){if(!this.C0a("end"))return ea.ULS.sendTraceTag(507574408,0,15,"GotoLatencyTracker.gotoOperationDuration: operation hasn't ended yet!"),new ki({iHa:0,RMa:0,Nxa:0});if(this.C0a("web-method-error")){var I=this.measure({from:"start",i3:"web-method-error"}),pa=this.measure({from:"web-method-error",i3:"end"});return new ki({iHa:I,
RMa:0,Nxa:pa})}if(this.C0a("business-logic-success")&&this.C0a("goto-start")){I=this.measure({from:"start",i3:"business-logic-success"});pa=this.measure({from:"business-logic-success",i3:"goto-start"});const lb=this.measure({from:"goto-start",i3:"end"});return new ki({iHa:I,RMa:pa,Nxa:lb})}if(this.C0a("business-logic-success"))return I=this.measure({from:"start",i3:"business-logic-success"}),pa=this.measure({from:"business-logic-success",i3:"end"}),new ki({iHa:I,RMa:0,Nxa:pa});if(this.C0a("goto-start"))return I=
this.measure({from:"start",i3:"goto-start"}),pa=this.measure({from:"goto-start",i3:"end"}),new ki({iHa:0,RMa:I,Nxa:pa});I=this.measure({from:"start",i3:"end"});return new ki({iHa:0,RMa:0,Nxa:I})}}VRh(){return 0<=this.markers.findIndex(I=>Object(Dh.b)(I.name))}}Object(za.a)(lh,"GotoLatencyTracker",ci,[]);let qi=0;class Fi extends $i{constructor(I,pa,lb,hc,Xc,Gd,ae){super(I,pa,lb,hc,Xc,new lh(!!ae),Gd,ae);this.Vwb=!1;this.vbe=()=>{this.QGa(this.da.$ra)&&this.eNa()}}get Z3d(){return 20}dispose(){this.Vwb&&
(this.da.ha.k8(this.vbe),this.Vwb=!1);super.dispose()}mark(I,pa,lb){Object(Dh.b)(I)&&this.Yt.VRh()?this.x8("aborted","MultipleBusinessLogicMarks"):(this.n5a||"business-logic-success"!==I||(ea.ULS.shipAssertTag(507570067,0,!this.Vwb,"SetFocusOnGotoOperationLatencyTelemetry.mark: selectionEndedBlockingRegistered is true"),this.da.ha.C4(this.vbe),this.Vwb=!0),super.mark(I,pa,lb))}m5a(I,pa){this.n5a&&(super.m5a(I,pa),"business-logic-success"===I.name&&(ea.ULS.shipAssertTag(507556764,0,!this.Vwb,"SetFocusOnGotoOperationLatencyTelemetry.onMarkAdded: selectionEndedBlockingRegistered is true"),
this.da.ha.C4(this.vbe),this.Vwb=!0))}K_a(I,pa){return Object.assign({},super.K_a(I,pa),{gotoOperationDuration:this.Yt.wPf,marks:this.Yt.markers})}FBe(I){"complete"===I&&(jd.EwaSettings.HY||jd.EwaSettings.oha()||jd.EwaSettings.U0d())&&jd.EwaSettings.avj()&&this.A5h()}A5h(){if(3E4<=qi)ea.ULS.sendTraceTag(507360542,0,50,"GotoOperationLatencyTelemetry.createAndUpdateGotoReport: reached max");else{qi++;var I=this.LYc.gotoScenarioLatency[this.scenario];I||(I=[],this.LYc.gotoScenarioLatency[this.scenario]=
I);I.push(Math.round(this.Yt.wPf.Nxa))}}}Object(za.a)(Fi,"GotoOperationLatencyTelemetry",$i,[]);class Sh extends $i{constructor(I,pa,lb,hc,Xc,Gd,ae,we){super(I,pa,lb,hc,Xc,new ci(!!we),Gd,we);this.yA=ae;this.o6c=1;this.XYb=this.Tob=!1;this.O6i=()=>{const Re=performance.now()-this.Yt.startTime;ea.ULS.sendTraceTag(507511395,0,15,`ZoomOperationLatencyTelemetry.handleTimeout: timeout occurred after ${Re}ms!`);this.D2c=void 0;this.x8("aborted","timeout")};this.J5a=this.da.PQ;if(this.Evc=jd.EwaSettings.uob())this.D2c=
window.setTimeout(this.O6i,1E4),jd.EwaSettings.Vtj()&&Gd.yCd&&(this.XYb=this.yA.startTrackAnimation(Gd.event,"viewport_zoom"))}get Z3d(){return 20}get kbh(){return this.Sia>this.J5a?"zoom-in":"zoom-out"}get fij(){return 3<=this.o6c}get OZf(){return 1===this.o6c}dispose(){this.D2c&&(window.clearTimeout(this.D2c),this.D2c=void 0);this.XYb&&(ea.ULS.sendTraceTag(507384452,0,50,"ZoomOperationLatencyTelemetry.dispose: aborting animation tracking"),this.XYb=!1,this.yA.stopTrackAnimation("viewport_zoom"));
super.dispose()}mark(I,pa,lb){super.mark(I,pa,lb);this.n5a||"zoom-level-set"!==I||(this.Sia=null===pa||void 0===pa?void 0:pa.PQ,this.QGa(this.da.$ra)&&this.eNa(lb))}m5a(I,pa){if(this.n5a){super.m5a(I,pa);if(this.Yt.g5c){var lb=this.Yt.markers;(lb=lb[lb.length-2])&&I&&this.Yt.measure({from:lb,i3:I})}this.Evc?"zoom-level-set"===I.name?(this.Sia=null===pa||void 0===pa?void 0:pa.PQ,ea.ULS.shipAssertTag(507543945,0,!!this.Sia,`ZoomOperationLatencyTelemetry.onMarkAdded: zoomLevel is ${this.Sia}!`)):"rezoom"===
I.name?(this.Tob=!1,this.o6c++):"zoom-idle"===I.name&&(this.Tob=!0,this.QGa(this.da.$ra)&&(this.Yt.C0a("zoom-blocks-updated")?this.x8("complete",void 0,I.timestamp):this.eNa(I.timestamp)),this.XYb&&(this.XYb=!1,this.yA.stopTrackAnimation("viewport_zoom"))):"zoom-level-set"===I.name&&(this.Sia=null===pa||void 0===pa?void 0:pa.PQ,this.QGa(this.da.$ra)&&this.eNa())}}QGa(I){return super.QGa(I)&&this.Sia?this.Sia===this.da.Xfl:!1}eNa(I){this.Evc?(ea.ULS.shipAssertTag(507511424,0,!!this.Sia,`ZoomOperationLatencyTelemetry.markWhenAllTheBlocksInViewportAreUpdated: zoom level not set! requiredZoomLevel=${this.Sia}`),
this.mark("zoom-blocks-updated",void 0,I),this.Tob&&this.x8("complete",void 0,I)):super.eNa()}K_a(I,pa){I=Object.assign({},super.K_a(I,pa),{zoomType:this.kbh,caller:this.context.caller,delayed:this.context.yCd,isDiscrete:this.OZf,isAnimation:this.fij,zoomCount:this.o6c,startZoom:this.J5a,endZoom:this.Sia});this.Evc&&((pa=this.Yt.measure({from:"start",i3:"zoom-blocks-updated",E6d:"zoomDuration"}))&&(I.duration=pa.toFixed(4)),pa=this.OZf?pa:this.Yt.measure({from:"rezoom",i3:"zoom-blocks-updated",E6d:"lastRezoomDuration"}),
I.lastRezoomDuration=pa);return I}FBe(I){"complete"===I&&this.Sia&&(I=this.LYc.zoomScenarioLatency[this.kbh])&&(I.count++,I.duration+=this.Yt.duration,I.skeletonDuration+=this.Yt.skeletonDuration,I.staleDuration+=this.Yt.staleDuration)}}Object(za.a)(Sh,"ZoomOperationLatencyTelemetry",$i,[]);class Dj{constructor(I,pa,lb){this.da=I;this.v3=pa;this.KYc=lb;this.dka=new AbortController;this.snc=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8704121_AddZoomNavContext");this.lia=hc=>{this.UWk(hc.detail.viewportScenarioContext)};
this.v3.epd(this.lia,this.dka.signal)}dispose(){this.dka.abort()}UWk(I){ea.ULS.shipAssertTag(507570112,0,void 0===this.Lib||!this.Lib.CIc,"ViewportOperationTelemetryManager.startNewScenario: expecting no running operation, but operation is still running");if(this.snc)if(x(I))this.Lib=new pi(this.da,this.da.$.fa.UC,void 0,this.KYc,I,this.v3);else if(Object(Dh.c)(I.name))this.Lib=new Fi(this.da,this.da.$.fa.UC,void 0,I.name,this.KYc,I,this.v3);else{ea.ULS.sendTraceTag(507549210,0,10,`ViewportOperationTelemetryManager.startNewScenario: unhandled scenario ${I.name}!`);
return}else x(I)?this.Lib=new pi(this.da,this.da.$.fa.UC,void 0,this.KYc,void 0,this.v3):this.Lib=new Fi(this.da,this.da.$.fa.UC,void 0,I.name,this.KYc,void 0,this.v3);this.Lib.RKj()}}Object(za.a)(Dj,"ViewportOperationTelemetryManager",null,[]);class Pi{constructor(){this.docId=this.host=this.applicationMode=this.browserVersion=this.browser=""}get reportName(){return"SessionInfo"}}Object(za.a)(Pi,"SessionInfoSessionEndsReport",null,[182]);class Uj{constructor(){this.maxScrollLeftDistancePx=this.maxScrollRightDistancePx=
this.maxScrollDownDistancePx=this.maxScrollUpDistancePx=0}get reportName(){return"MaxScrollDistance"}}Object(za.a)(Uj,"MaxScrollDistanceSessionEndsReport",null,[]);var Ej=a(924),aj=a(925);class Fj{constructor(){this.missingBlocksDuration=this.skeletonAndMissingBlocksDuration=this.skeletonDuration=this.duration=0;var I;try{var pa=null===(I=PerformanceObserver.supportedEntryTypes)||void 0===I?void 0:I.includes("long-animation-frame")}catch(lb){jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8851611_handleExceptionInSupportedEntryTypes")&&
ea.ULS.sendTraceTag(507310616,Ej.a.mNa,aj.a.warning,`ScrollOperationLatencySessionEndsReport.isMissingBlocksSupported: exception: ${lb}`),pa=!1}this.isMissingBlocksSupported=pa;this.isScrollEndEventSupportedByBrowser=td.HelperMethods.isScrollEndEventSupportedByBrowser;this.maxScrollDistance=new Uj}get reportName(){return"scrollOperationLatency"}}Object(za.a)(Fj,"ScrollOperationLatencySessionEndsReport",null,[]);class eg{constructor(){this.ScrollLatency=new Fj;this.gotoScenarioLatency={};this.zoomScenarioLatency=
{}}get reportName(){return"NavigationOperationsLatency"}}Object(za.a)(eg,"NavigationOperationsLatencySessionEndsReport",null,[182]);let gf=class{constructor(I,pa,lb){this.$=I;this.da=pa;this.v3=lb;this.dka=new AbortController;this.KZf=td.HelperMethods.GXb&&jd.EwaSettings.Nkj();this.Psk=2E3;this.S4f=jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimation",!1);this.snc=jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8704121_AddZoomNavContext");this.wWc=null;this.DYb=!1;this.lia=
hc=>{hc=hc.detail.viewportScenarioContext;x(hc)&&this.Gae(null,hc)};this.Gae=(hc,Xc)=>{this.YP?this.i1c("gotoOperationInProgress"):(!this.DYb&&this.S4f&&(this.DYb=tj.b(this.$).startTrackAnimation(Xc.event,"viewport_scroll")),this.S$h(Xc))};this.dQ=()=>{this.i1c("scrollEnd");this.$.fa.um&&!this.YP&&this.VZ&&(this.VZ.f6d(),this.VZ.QGa(this.da.$ra)&&this.VZ.x8("complete"))};this.Uqg=()=>{this.VZ.dispose();this.VZ=void 0};this.Kae=()=>{var hc;null===(hc=this.YP)||void 0===hc?void 0:hc.dispose();this.YP=
void 0};this.Dj=()=>{this.r4e()};this.onViewportChange=()=>{this.wWc=Wb.AsyncMethodContext.AC(()=>{this.kle()},this.Psk,ad.a.kle,this.wWc)};this.B7=(hc,Xc)=>{-1===Xc.pL&&Xc.C1a&&this.lbl(Xc.hashCode)};this.A$h();this.r4e();this.Ybj();this.$.nr(this.Dj);this.KZf&&this.da.jJb(this.onViewportChange);jd.EwaSettings.U0d()&&(this.Wfl=new Dj(this.da,lb,this.esb));jd.EwaSettings.UKc()?jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MeasureOldBrowsersImpactOnInteractivity",!1)?td.HelperMethods.isScrollEndEventSupportedByBrowser&&
(this.v3.epd(this.lia,this.dka.signal),this.da.view.Unc(this.dQ)):(this.v3.epd(this.lia,this.dka.signal),this.da.view.Unc(this.dQ)):(td.HelperMethods.isScrollEndEventSupportedByBrowser&&this.da.view.R5e(this.Gae),this.da.view.Unc(this.dQ));this.da.Wpd(this.B7)}dispose(){this.$.$r(this.Dj);jd.EwaSettings.UKc()?this.dka.abort():td.HelperMethods.isScrollEndEventSupportedByBrowser&&this.da.view.JGg(this.Gae);this.da.view.UGg(this.dQ);jd.EwaSettings.U0d()&&this.Wfl.dispose();this.KZf&&this.da.p6b(this.onViewportChange);
Xa.a.gj([this.wWc,this.VZ,this.YP]);this.wWc=null;this.da.Xje(this.B7);this.YP=this.VZ=this.da=this.$=null;this.DYb=!1}get ycc(){return this.oPa.viewport}get mTg(){return this.oPa.sheetProcessedData}get Utd(){return this.oPa.PNh}get bUk(){return this.oPa.aUk}get esb(){return this.oPa.OKj}get Zrj(){return!!this.VZ}ltk(I){if(this.da.jj.isValid){if(this.ycc.maxUsedRow<I.bottom){this.ycc.maxUsedRow=I.bottom;const pa=this.da.Kxa();this.ycc.isRowMaxPixelExceeded=!!pa&&this.da.Qza(pa.ik,!0)}this.ycc.maxUsedColumn<
I.right&&(this.ycc.maxUsedColumn=I.right)}}mIg(I){var pa=this.mTg;pa.total+=1;const lb=Object(Je.e)(I);pa.defaultCount+=lb?1:0;pa.defaultRate=pa.defaultCount/pa.total;lb&&(pa.defaultCountByReason[I.$ib]+=1);pa=Object(Je.d)(I);pa||(ea.ULS.sendTraceTag(507574417,0,10,`ViewportTelemetryManager.reportSheetProcessedDataAccess: spd miss, reason=${I.reason}`),ea.ULS.shipAssertTag(507574416,0,!!I.reason,`ViewportTelemetryManager.reportSheetProcessedDataAccess: spd.reason is ${I.reason}!`));ea.ULS.shipAssertTag(507574415,
0,null==this.$.la||null!=this.$.la.sheetProcessedData,`SheetProcessedDataProvider.getActiveSheetProcessedData: invalid SPD availability state! activeItem=${this.$.la?"not null":"null"}, isHit=${pa}`)}r7a(I){var {success:pa,entriesCount:lb,abortReason:hc,maxEntries:Xc,sheetCount:Gd}=I;I=this.mTg;null!=pa&&(I.prefetchInfo.success=pa);null!=lb&&(I.prefetchInfo.entriesCount=lb);if(null!=hc){const ae=I.prefetchInfo.abortReason;"workbookClosed"!==hc||"notScheduled"!==ae&&"notStarted"!==ae?"workbookClosed"!==
hc&&(I.prefetchInfo.abortReason=hc):I.prefetchInfo.abortReason=`${ae}-workbookClosed`}null!=Xc&&(I.prefetchInfo.maxEntries=Xc);null!=Gd&&(I.prefetchInfo.sheetCount=Gd);ea.ULS.sendTraceTag(507574414,0,50,`ViewportTelemetryManager.reportSheetProcessedDataPrefetch: success=${pa}, entriesCount=${lb}, abortReason=${hc}, maxEntries=${Xc}`)}ble(I,pa,lb){var hc,Xc;const Gd=null!==(Xc=null===(hc=this.$.la)||void 0===hc?void 0:hc.hash)&&void 0!==Xc?Xc:"";!this.kTg&&Gd&&(this.kTg=Gd);hc=this.Utd;this.$.fa.um?
(this.Zrj&&(!this.ABf&&Gd&&(this.ABf=Gd),this.JAe(hc.duringScroll,I,lb)),this.JAe(hc.postSessionBoot,I,lb)):this.JAe(hc.sessionBoot,I,lb);hc.accessedBlocksDistinctCount+="WasNeverCached"===lb?1:0;hc.numOfUsedPrefetchedBlocks+=pa?1:0}Ysk(){this.Utd.numOfPrefetchedBlocks+=1}Oxa(I,pa){if(this.$.fa.um)switch(I){case Dh.a.switchSheet:case Dh.a.insertSheet:case Dh.a.findNext:case Dh.a.gotoDialog:this.Dnd(I);this.i1c("switchSheet|insertSheet|findNext");this.snc&&ea.ULS.shipAssertTag(507549212,0,!pa||Object(Dh.c)(pa.name),
`ViewportTelemetryManager.gotoNavigationStart: scenario=${I} got an invalid context = ${null===pa||void 0===pa?void 0:pa.name}!`);this.YP=new Fi(this.da,this.$.fa.UC,this.Kae,I,this.esb,pa);break;case "zoom":this.Dnd(I);this.snc&&ea.ULS.shipAssertTag(507549211,0,"zoom"===pa.name,`ViewportTelemetryManager.gotoNavigationStart: scenario=${I} got an invalid context = ${null===pa||void 0===pa?void 0:pa.name}!`);this.YP=new Sh(this.da,this.$.fa.UC,this.Kae,I,this.esb,pa,tj.b(this.$));break;default:ea.ULS.shipAssertTag(507574413,
0,!1,`ViewportTelemetryManager.navigationStart: Unexpected scenario name: ${I}`)}}dsa(I){var pa;const lb=!!this.VZ,hc="zoom"===(null===(pa=this.YP)||void 0===pa?void 0:pa.scenario);pa=this.YP&&"zoom"!==this.YP.scenario;(lb||pa)&&this.Dnd("zoom");hc?this.YP.mark("rezoom"):this.YP=new Sh(this.da,this.$.fa.UC,this.Kae,"zoom",this.esb,I,tj.b(this.$));return this.YP}eZ(I,pa){this.YP?Object(Dh.d)(this.YP.scenario,I)&&this.YP.mark(I,pa):ea.ULS.sendTraceTag(507574412,0,50,`ViewportTelemetryManager.navigationMark: Marking ${I} for an invalid / non-existing scenario`)}Wca(I){var pa;
if(jd.EwaSettings.HY()||jd.EwaSettings.oha())switch(I){case Dh.a.findNext:case Dh.a.gotoDialog:null===(pa=this.YP)||void 0===pa?void 0:pa.x8("complete");break;default:ea.ULS.shipAssertTag(507574411,0,!1,`ViewportTelemetryManager.scenarioEnd: Unexpected scenario name: ${I}`)}}JAe(I,pa,lb){var hc,Xc,Gd;I.total+=1;I.hitCount+=pa?1:0;pa||(pa=null!==(Xc=null===(hc=this.$.la)||void 0===hc?void 0:hc.hash)&&void 0!==Xc?Xc:"",I.sheetOnBootMissCount+=pa===this.kTg?1:0,I.firstScrollSheetMissCount+=pa===this.ABf?
1:0,I.missCountByReason[lb]=(null!==(Gd=I.missCountByReason[lb])&&void 0!==Gd?Gd:0)+1)}S$h(I){this.VZ?this.VZ.eMa&&(this.VZ.x8("aborted"),this.i1c("aborted"),this.VZ=new pi(this.da,this.$.fa.UC,this.Uqg,this.esb,I)):this.VZ=new pi(this.da,this.$.fa.UC,this.Uqg,this.esb,I)}i1c(I){this.S4f&&this.DYb&&(ea.ULS.sendTraceTag(507574410,0,50,`ViewportTelemetryManager.stopTrackAnimationIfRunning: reason: ${I}`),tj.b(this.$).stopTrackAnimation("viewport_scroll"));this.DYb=!1}A$h(){this.oPa={viewport:new Oi,
sheetProcessedData:new ve,PNh:this.T5h(),aUk:new Ei,OKj:new eg,Swl:this.$$h()}}T5h(){const I=new ii;I.blockCacheSize=this.da.za.Fqc;return I}$$h(){var I,pa,lb=this.$.ua;const hc=new Pi,{browser:Xc,version:Gd,returnValue:ae}=td.HelperMethods.F0c(lb.BrowserNameAndVersion);ae&&(hc.browser=Xc,hc.browserVersion=Gd);hc.host=lb.HostName;hc.docId=lb.DocumentHostInfo.ServerDocId;lb=wh.b(Aa.AFrameworkApplication.ea.appSettings.SessionStartInfoJson.toString());hc.applicationMode=null!==(pa=lb&&(null===(I=lb.ApplicationModeExtended)||
void 0===I?void 0:I.toString()))&&void 0!==pa?pa:"";return hc}r4e(){this.$.qa.zi(276,I=>{for(const pa in this.oPa)this.oPa[pa]&&I.v$(this.oPa[pa])})}Ybj(){this.fcj()}fcj(){this.r7a({success:!1,entriesCount:0,abortReason:"notScheduled",maxEntries:1E3})}kle(){const I=this.da.nXh();0<I.size&&ea.ULS.sendTraceTag(507574409,0,50,`ViewportTelemetryManager.reportMissingBlocks: found ${I.size} missing blocks ${JSON.stringify(Array.from(I))}`)}lbl(I){let pa=!1;const lb=this.bUk;lb.skeletonBlocksCounter[I]?
lb.skeletonBlocksCounter[I]+=1:(lb.skeletonBlocksCounter[I]=1,pa=!0);lb.count+=1;pa&&(lb.distinctCount+=1)}Dnd(I){var pa,lb;null===(pa=this.YP)||void 0===pa?void 0:pa.x8("aborted",`abortedBy:${I}`);null===(lb=this.VZ)||void 0===lb?void 0:lb.x8("aborted",`abortedBy:${I}`)}};gf=Object(wb.__decorate)([Object(Fc.d)(Gc.Ug),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.kd)()),Object(wb.__param)(2,Object(Gc.Tg)())],gf);Object(za.a)(gf,"ViewportTelemetryManager",null,[554]);let Eh=
class extends Y.a{constructor(){super()}A6e(I){this.addHandler("ZCIEK",I)}kHg(I){this.removeHandler("ZCIEK",I)}Qqd(I){this.addHandler("ZCUIK",I)}Gke(I){this.removeHandler("ZCUIK",I)}Afk(){this.raiseEvent("ZCIEK")}zfk(){this.raiseEvent("ZCUIK")}Bfk(){this.raiseEvent("ZCEK")}};Eh=Object(wb.__decorate)([Object(Fc.d)(Gc.bh)],Eh);Object(za.a)(Eh,"ZoomEventManager",Y.a,[553]);var th=a(649),qh=a(170),Lj=a(155),vj=a(102),Gi=a(356),Pj=a(156),mf=a(435);class Hi{constructor(I,pa){this.Onb=this.bGc=0;this.yrc=
null;this.K_f=!1;this.$=I;this.zoomManager=pa;this.K_f=I.$Kc}$mj(){return Oc.f(this.$).isEditing?(ea.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.vh.UE?(ea.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}kUj(I){this.yrc=new Sys.UI.Point(Math.round(I.NJa.center.x),Math.round(I.NJa.center.y));this.bGc=this.zoomManager.zoom;this.Onb=I.NJa.scale;
const pa={["InitialZoom"]:this.bGc,["Location"]:"canvas",["InputMethod"]:I.Gh};Pj.b(this.$).sj(Lj.a.V7j,pa);ea.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.yrc.x},${this.yrc.y}), initial zoom ${this.bGc}, initial scale ${this.Onb}`);this.Brb(I,"onGestureStart");return!0}jUj(I){if(!this.Onb)return ea.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.Brb(I,"OnGestureEvent"),!0;if(!isFinite(this.Onb))return ea.ULS.sendTraceTag(537149791,
0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.Onb}`),this.Brb(I,"OnGestureEvent"),!0;const pa=I.NJa.scale/this.Onb*this.bGc;this.zoomManager.hbh(pa,this.yrc);ea.ULS.sendTraceTag(537149790,0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${pa}. Current scale ${I.NJa.scale}`);this.Brb(I,"OnGestureEvent");return!0}iUj(I){this.zoomManager.ibh();ea.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");
this.Brb(I,"OnGestureEnd")}hUj(I){ea.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.Brb(I,"OnGestureCancel")}Brb(I,pa){var lb,hc,Xc;this.K_f&&(ea.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${pa},        eventArgs non-null: ${isNullOrUndefined(I)}, gestureData non-null: ${isNullOrUndefined(null===I||void 0===I?void 0:I.NJa)},        srcEvent non-null: ${isNullOrUndefined(null===(lb=null===I||void 0===I?void 0:
I.NJa)||void 0===lb?void 0:lb.srcEvent)}`),null===(Xc=null===(hc=null===I||void 0===I?void 0:I.NJa)||void 0===hc?void 0:hc.srcEvent)||void 0===Xc?void 0:Xc.preventDefault())}}Object(za.a)(Hi,"PinchToZoomAdapter",null,[548]);var lj=a(996),Mj=a(117);class Yg extends Y.a{constructor(I,pa){super();this.statusBarManager=null;this.iDf=!1;this.zoomManager=pa;this.$=I;this.$.qa.zi(29,lb=>{this.statusBarManager=lb;lb.vO(this)})}ry(I){this.addHandler("Zoom",I)}fy(I){this.removeHandler("Zoom",I)}ew(){const I=
he.a.mqb(this.$)?"QueryZoomComboBoxValue":"QueryZoomStatus";this.Up(I)&&this.raiseEvent("Zoom")}Aw(I,pa){switch(I){case "QueryZoomStatus":return this.F5i(pa);case "QueryZoomComboBoxValue":return this.E5i(pa);default:return!1}}Up(I){switch(I){case "QueryZoomStatus":return he.a.t9(this.$);case "QueryZoomComboBoxValue":return he.a.mqb(this.$)&&he.a.t9(this.$);default:return!1}}dispose(){this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null);this.$=null;super.dispose()}VOf(I){I=
this.j1i(I);if(!I)return null;I=I.getElementsByClassName("cui-ctl-mediumlabel");return 1!==I.length?(ea.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):I[0]}E5i(I){if(!this.$)return!1;const pa=Mj.a().XAb;I[lj.a.Value]=pa;return!0}F5i(I){if(!this.$)return!1;const pa=this.zoomManager.XAb;let lb=!1;if(he.a.Qo(this.$))Td.a.equals(appChrome.selectors.getControlLabel(gg.a.zoomStatusBarMenuOpen),pa,!1)||(lb=!0);else{const hc=this.VOf("HandleQueryZoomStatusCommand");
hc?Td.a.equals(I.LabelText.toString(),pa,!1)||(hc.innerText="",lb=!0):lb=!0}lb&&this.QGk(I,pa);return!0}QGk(I,pa){I.LabelText=pa;he.a.Qo(this.$)&&(I.Visible=!0)}j1i(I){var pa=De.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!pa)return pa=(pa=this.$.fa.Kh)?pa.inEmbedView:!1,vg.a.Oy||pa||ea.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${I}`),null;this.iDf||(this.iDf=!0,ea.ULS.sendTraceTag(537149762,
0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${I}`));return pa}}Object(za.a)(Yg,"ZoomStatusBarManager",Y.a,[2,176,177]);var Gj=a(30),Zj=a(245);let mj=class extends th.a{constructor(I,pa){super(I,Gj.yb);this.YAb=this.AMa=this.PZb=null;this.UZb=-1;this.J_f=!1;this.Pcl=jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseDelayDuringPinchZoom",!1);this.Gj=()=>{this.UZb=-1};this.SFj=Object(Zj.a)(lb=>{lb.CIc&&lb.mark("zoom-idle")},200);ea.ULS.sendTraceTag(537149785,
0,50,"AppZoom feature is Enabled.");this.ZAb=new Yg(I,this);this.W7j()&&(ea.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.vLh());this.YAb=pa}dispose(){this.ZAb&&(Xa.a.gh(this.ZAb),this.ZAb=null);this.YAb&&(this.YAb=null);this.J_f&&this.Rfi();super.dispose()}hbh(I,pa){I=this.NZa(I);if(Oc.f(this.$).rtl){const lb=Math.round(De.DOMElementExtensions.getBounds(this.$.Dl).width*this.zoom);this.PZb=new Sys.UI.Point(lb-pa.x,pa.y)}else this.PZb=pa;this.B8a(I,
this.Pcl,"ZoomWithPinch")}Zcc(){return!0}Ycc(I,pa,lb){var hc=vg.a.isMac?.07:.15;I=this.zoom+(I?hc:-hc);I=this.NZa(I);Oc.f(this.$).rtl?(hc=Math.round(De.DOMElementExtensions.getBounds(this.$.Dl).width*this.zoom),this.AMa=new Sys.UI.Point(hc-pa.x,pa.y)):this.AMa=pa;pa=this.zoom;this.B8a(I,!0,"ZoomWithMouse",lb);lb={["InitialZoom"]:pa,["FinalZoom"]:I,["Location"]:"canvas"};Pj.b(this.$).sj(Lj.a.gil,lb)}ibh(){this.PZb=null}r6c(I,pa){this.B8a(this.NZa(I),!1,pa?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}jbh(I){isNaN(I)?
ea.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.B8a(this.NZa(I),!1,"ZoomToLevelInExcelLive")}s6c(I,pa){this.B8a(this.NZa(I),!0,pa?"ZoomWithShortcuts":"ZoomWithButtons")}zMf(I,pa){const lb=Oc.f(this.$).rtl,[hc,Xc]=this.wOd(lb),[Gd,ae]=this.qQd(I,Xc);return this.AMa?(I=this.aOd(this.AMa,I,pa,Xc,hc,"ZoomWithMouse"),this.AMa=null,I):this.PZb?this.aOd(this.PZb,I,pa,Xc,hc,"ZoomWithPinch"):Oc.f(this.$).ha.$a.isFloatingObjectSelected?
this.fil(I,pa,Xc,hc,Gd,ae,Oc.f(this.$).rtl):this.hil(I,pa,Xc,hc,Gd,ae,Oc.f(this.$).rtl)}sNg(I,pa,lb){if(I){ea.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${I.x} ${I.y}) (new top-left) from zoom:${pa} to zoom:${lb}`);I=new Cc.a(I.x,I.y);lb=Oc.f(this.$).rtl;[,lb]=this.wOd(lb);const [hc,Xc]=this.qQd(pa,lb);Oc.f(this.$).h7e(I,hc,Xc,{name:"ApplicationZoom"})}else ea.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${pa} to zoom:${lb}`)}zoomFitToScreen(){const I=this.zoom;var pa=Oc.f(this.$).rtl;
const [lb,hc]=this.wOd(pa),[Xc,Gd]=this.qQd(I,hc);var ae=Oc.f(this.$).ha.$a.isFloatingObjectSelected;(pa=ae?this.XHf(this.vtb,Xc,Gd,!1):this.GMf(this.vtb,hc,lb,Xc,Gd,pa,!1))?(pa=Math.min(Xc/(pa.width+100),Gd/(pa.height+100)),pa=this.Iyi(pa),this.B8a(pa,!0,"ZoomWithFitToScreen"),ae?Oc.f(this.$).ha.$a.lXa(Oc.f(this.$).ha.$a.Ih,!1):(ae=Kc.x(Oc.f(this.$).ha.pa.activeRange,this.$),Oc.f(this.$).fp(ae,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.UZb=I,this.J_f||this.pLh()):ea.ULS.sendTraceTag(537149780,
0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${ae}`)}zoomFitToScreenUndo(){this.B8a(this.UZb,!1,"ZoomWithFitToScreen")}xte(){return-1!==this.UZb}pLh(){const I=Oc.f(this.$);I&&(I.ha.cx(this.Gj),I.zO(this.Gj))}Rfi(){const I=Oc.f(this.$);I&&(I.ha.Bx(this.Gj),I.oQ(this.Gj))}Iyi(I){I=Math.min(I,Yb.a.bHj);I=Math.max(I,Yb.a.VHj);return Math.round(100*I)/100}B8a(I,pa,lb,hc){if(this.p6c()){var Xc=Oc.f(this.$).view.visibleArea.toString();I=this.NZa(I);var Gd=hd.d(this.$.sa.la);
Gd||(Gd=th.a.kgg);Oc.f(this.$).tk.BQ(5,Gi.a.n6c,lb);var ae;if(jd.EwaSettings.kZb()){const we=Fc.a.lh(Gc.Ug);jd.EwaSettings.uob()?ae=null===we||void 0===we?void 0:we.dsa({name:"zoom",caller:lb,yCd:pa,timestamp:null===hc||void 0===hc?void 0:hc.timeStamp,event:hc}):null===we||void 0===we?void 0:we.Oxa("zoom",{name:"zoom",caller:lb,yCd:pa,timestamp:null===hc||void 0===hc?void 0:hc.timeStamp})}Oc.f(this.$).tk.c2(Gi.a.n6c,this.$.fa.yk);ea.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${I} to sheet ${Gd} origin ${lb} prevZoom ${this.zoom}`);
this.OJk(Gd,I);this.YAb.Bfk();this.l4k(lb,ae);this.y4k(pa);this.UZb=-1;mf.b(this.$,lb);I=Oc.f(this.$).view.visibleArea.toString();ea.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Xc}, NewGridVisibleArea: ${I}, IsShyRibbonActive: ${this.$.g7}`);ae&&this.SFj(ae)}}hJi(I){return(I=td.HelperMethods.eJ(this.$.Dl,this.$.domElement,I))?I:new Sys.UI.Point(0,0)}wOd(I){const pa=this.hJi(I);I=this.HOi(pa,I);return[pa,I]}qQd(I,pa){const lb=De.DOMElementExtensions.getBounds(this.$.Dl);
return[Math.round((lb.width-pa.x)*I),Math.round((lb.height-pa.y)*I)]}HOi(I,pa){pa=td.HelperMethods.eJ(Oc.f(this.$).domElement,this.$.domElement,pa);return pa?(I=new Sys.UI.Point(Math.round(pa.x-I.x),Math.round(pa.y-I.y)),I):new Sys.UI.Point(0,0)}hil(I,pa,lb,hc,Xc,Gd,ae){return(ae=this.GMf(I,lb,hc,Xc,Gd,ae))?this.rLf(ae,I,pa,lb,hc,Xc,Gd):null}GMf(I,pa,lb,hc,Xc,Gd,ae){ae=void 0===ae?!0:ae;var we=Kc.K(Oc.f(this.$).ha.pa.selectedRanges);if(ae&&(we=we.Fk(Kc.K(Oc.f(this.$).CDc())),!we))return ea.ULS.sendTraceTag(537149777,
0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const Re=Oc.f(this.$).yh(we.topLeft);we=Oc.f(this.$).yh(we.bottomRight);if(!Re||!we)return ea.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;I=Re.cell.IH===we.cell.IH&&Re.cell.RK===we.cell.RK?this.RHi(I,we,pa,lb,hc,Gd):this.I_i(I,Re,we,pa,lb,hc,Gd);return I?ae?this.JBf(I,hc,Xc):I:(ea.ULS.sendTraceTag(537149775,
0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}JBf(I,pa,lb){if(0>I.x||I.x>pa)I.x=0;if(0>I.y||I.y>lb)I.y=0;I.x+I.width>pa&&(I.width=pa-I.x);I.y+I.height>lb&&(I.height=lb-I.y);return I}I_i(I,pa,lb,hc,Xc,Gd,ae){pa=Oc.f(this.$).getCellBounds(pa.cell);if(!pa)return null;const we=Oc.f(this.$).getCellBounds(lb.cell);if(!we)return null;let Re=Xc.x;ae&&(Re=0,pa.x=Math.round(Gd/I)-pa.x-Math.round(pa.width),we.x=Math.round(Gd/I)-we.x-Math.round(we.width));I=new Sys.UI.Bounds(Math.round((pa.x-
hc.x)*I)-Re,Math.round((pa.y-hc.y)*I-Xc.y),Math.round((we.x+we.width-pa.x)*I),Math.round((we.y+we.height-pa.y)*I));lb=lb.cell.getRange();ea.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${lb.top}, b:${lb.bottom}, r:${lb.right}, l:${lb.left}) in bounds (${I.x}, ${I.y}, ${I.width}, ${I.height})`);return I}RHi(I,pa,lb,hc,Xc,Gd){const ae=Oc.f(this.$).getCellBounds(pa.cell);if(!ae)return null;let we=hc.x;Gd&&
(we=0,ae.x=Math.round(Xc/I)-ae.x-Math.round(ae.width));I=new Sys.UI.Bounds(Math.round((ae.x-lb.x)*I)-we,Math.round((ae.y-lb.y)*I-hc.y),Math.round(ae.width*I),Math.round(ae.height*I));pa=pa.cell.getRange();ea.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${pa.top}, l:${pa.left}) in bounds (${I.x}, ${I.y}, ${I.width}, ${I.height})`);return I}fil(I,pa,lb,hc,Xc,Gd){const ae=this.XHf(I,Xc,Gd);return ae?this.rLf(ae,I,pa,lb,hc,Xc,Gd):
null}rLf(I,pa,lb,hc,Xc,Gd,ae){I=new Sys.UI.Point(this.YLf(Gd,I.x,I.width),this.YLf(ae,I.y,I.height));return this.aOd(I,pa,lb,hc,Xc)}YLf(I,pa,lb){return I===lb?(ea.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),I/2):I*pa/(I-lb)}XHf(I,pa,lb,hc){hc=void 0===hc?!0:hc;const Xc=Oc.f(this.$).ha.$a.Ih.domElement;var Gd=td.HelperMethods.eJ(Xc,Oc.f(this.$).domElement,Oc.f(this.$).rtl);if(!Gd)return ea.ULS.sendTraceTag(537149771,
0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const ae=Oc.f(this.$).LKa();Gd=new Sys.UI.Point(Math.round((Gd.x-ae.topLeft.x)*I),Math.round((Gd.y-ae.topLeft.y)*I));I=new Sys.UI.Bounds(Gd.x,Gd.y,Math.round(Xc.offsetWidth*I),Math.round(Xc.offsetHeight*I));return hc?this.JBf(I,pa,lb):I}Kgg(){this.ZAb.ew()}JMj(I){"ZoomToLevelInExcelLive"===I?this.YAb.Afk():this.YAb.zfk()}aOd(I,pa,lb,hc,Xc,Gd){Gd=void 0===Gd?"":Gd;var ae=Oc.f(this.$).rtl?0:Xc.x;Xc="ZoomWithPinch"===
Gd||"ZoomWithMouse"===Gd?new Sys.UI.Point(I.x-ae-Math.round(hc.x*pa),I.y-Xc.y-Math.round(hc.y*pa)):I;Xc=new Sys.UI.Point(Math.round(Xc.x/pa),Math.round(Xc.y/pa));ea.ULS.shipAssertTag(537149770,0,!!pa,"Original zoom level must be different than 0");ae=lb/pa;Xc=new Sys.UI.Point(Math.round(Xc.x*(1-1/ae)),Math.round(Xc.y*(1-1/ae)));"ZoomWithMouse"===Gd||"ZoomWithPinch"===Gd?(Xc.x+=Math.round((hc.x-Oc.f(this.$).ys)*(ae-1)),Xc.y+=Math.round((hc.y-Oc.f(this.$).yC)*(ae-1))):(ae=Math.round(hc.x*(lb-pa)),0<
ae&&Xc.x>ae&&(Xc.x+=ae),pa=Math.round(hc.y*(lb-pa)),0<pa&&Xc.y>pa&&(Xc.y+=pa));"ZoomWithMouse"===Gd&&(I.x||(Xc.x=0),I.y||(Xc.y=0));I=Oc.f(this.$).LKa();return new Sys.UI.Point(Xc.x+I.topLeft.x,Xc.y+I.topLeft.y)}vLh(){const I=[];Eg.a.instance.Dk("Common.IGestureInputManager").execute(pa=>{0===pa.aOi()&&pa.Hjk(document.body,new Hi(this.$,this),I)})}W7j(){return this.p6c()&&(vg.a.$v&&vg.a.ELa(67)||this.$.$Kc)}OJk(I,pa){mf.a(this.$)?this.ore(I,pa,this.bEe,Yb.a.Xxg):this.ore(I,pa,this.zoomPerSheetId,this.vtb)}ore(I,
pa,lb,hc){lb.remove(I);pa!==hc&&lb.add(I,pa)}l4k(I,pa){const lb=jd.EwaSettings.kZb()?Fc.a.lh(Gc.Ug):void 0;jd.EwaSettings.uob()?null===pa||void 0===pa?void 0:pa.mark("zoom-immediate-start"):null===lb||void 0===lb?void 0:lb.eZ("zoom-immediate-start");this.PRg();this.$.kqa(Da.a.uxa("TriggerImmediateZoomOperations"));this.rcl();this.JMj(I);jd.EwaSettings.uob()?null===pa||void 0===pa?void 0:pa.mark("zoom-immediate-end"):null===lb||void 0===lb?void 0:lb.eZ("zoom-immediate-end")}rcl(){this.i_d()?this.$.Fm():
this.ZAb.ew();const I=this.ZAb.VOf("UpdateZoomStatusBar");I&&(I.innerText=this.XAb)}i_d(){const I=qh.a(this.$);return I?I.xs.QA===(he.a.YLa(this.$)?Cd.a.C6a:this.$.xi+Cd.a.ene):!1}y4k(I){Oc.f(this.$).cil(I);this.hHh()}hHh(){const I=vj.a(this.$);if(I)for(const pa of Oc.f(this.$).za.uA()){if(!pa){ea.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!pa.xq)continue;const lb=pa.cp;if(lb)for(let hc=0;hc<lb.count;hc++)if(2===lb.yn(hc).type){const Xc=
I.Xx(lb.yn(hc).Hn());Xc?(Xc.Nra(!1),ea.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):ea.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else ea.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}};mj=Object(wb.__decorate)([Object(Fc.d)(Gc.ch),Object(wb.__param)(0,Object(Gc.Ob)()),Object(wb.__param)(1,Object(Gc.bh)())],
mj);Object(za.a)(mj,"ZoomManager",th.a,[]);var ri=a(973),Qi=a(944),Mh=a(1109);let Ri=class extends Y.a{constructor(I){super();this.raa=this.llb=this.statusBarManager=null;this.IFc=this.vYb=!1;this.Otg=()=>{var pa=screen.height;pa-=this.ExcelFullScreenCalloutSettings.ScreenSizeDelta*pa;window.innerHeight>=pa&&!this.vYb?(this.vYb=!0,this.ew()):this.vYb&&window.innerHeight<pa&&(this.vYb=!1,this.ew())};this.S$d=()=>{this.ew();Mh.a.Oya||(ea.ULS.sendTraceTag(507566092,0,50,"FullScreenStatuBarManager.OnFullScreenChangeEventHandler:  exit fullscreen mode"),
this.IFc=!1)};this.$=I;this.$.Ia.iua(this);this.$.qa.zi(29,pa=>{this.statusBarManager=pa;pa.vO(this)});this.ExcelFullScreenCalloutSettings=JSON.parse(Aa.AFrameworkApplication.ea.Ya("ExcelFullScreenCalloutSettings"));this.NHj=6E4*this.ExcelFullScreenCalloutSettings.AppUsageTimeInMinutes;this.raa=document.getElementById("MainApp");this.llb=this.S$d;$addHandler(this.raa,Mh.a.YJd,this.llb);$addHandler(window,vd.a.resize,this.Otg);jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",
!1)&&this.tRk()}ry(I){this.addHandler("FullScreenChangedEventKey",I)}fy(I){this.removeHandler("FullScreenChangedEventKey",I)}ew(){this.Up("QueryFullScreen")&&(jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1)&&this.i_d()&&this.$.Fm(),this.raiseEvent("FullScreenChangedEventKey"))}Aw(I,pa){switch(I){case "QueryFullScreen":return pa[ri.a.On]=Mh.a.Oya,pa[Qi.a.customTooltip]=Mh.a.Oya?$a.a.instance.ia(2409):$a.a.instance.ia(2408),jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8740765_TogglingOfFullScreenIcons")&&
(pa[Qi.a.IconSet]=Mh.a.Oya?{"default":"FullScreenMinimize_16"}:{"default":"FullScreenMaximize_16"}),!0;default:return!1}}Up(){return he.a.OXd()?!0:!1}dispose(){this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null);$removeHandler(this.raa,Mh.a.YJd,this.llb);$removeHandler(window,vd.a.resize,this.Otg);this.raa=this.$=null;super.dispose()}Ei(I,pa){switch(pa.command){case -1912752143:return!0;default:return!1}}Ri(I,pa){switch(pa){case -1912752143:return this.vYb&&!this.IFc?
!0:!1;default:return!1}}dj(){return!1}executeCommand(I,pa){switch(pa.command){case -1912752143:return this.Y1k(),this.ew(),qd.Task.Ua(!0);default:return Vi.a(pa.command)}}Y1k(){Mh.a.Oya?(Mh.a.exitFullscreen(),this.IFc=!1):(ea.ULS.sendTraceTag(507533057,0,15,`FullScreenStatuBarManager.OnFullScreenChangeEventHandler:  enter fullscreen mode, winow height: ${window.innerHeight}, ribbon mode: ${appChrome.selectors.getRibbonMode()}`),Mh.a.requestFullscreen(this.raa),this.IFc=!0)}tRk(){setTimeout(()=>{(window.innerHeight<=
this.ExcelFullScreenCalloutSettings.MaxWindowInnerHeight||screen.height/window.innerHeight<this.ExcelFullScreenCalloutSettings.MaxRatioOfScreenToWindowHeight)&&this.uRk()},this.NHj)}i_d(){const I=qh.a(this.$);return I?I.xs.QA===(he.a.YLa(this.$)?Cd.a.C6a:this.$.xi+Cd.a.ene):!1}uRk(){const I=new Wd.a(-847286761,ee.a.ph,this.$.ji,0,null);this.$.Ia.qh(I,{["InputMethod"]:ee.a.ph,CalloutName:22})}};Ri=Object(wb.__decorate)([Object(Fc.d)(Gc.Xc),Object(wb.__param)(0,Object(Gc.Ob)())],Ri);Object(za.a)(Ri,
"FullScreenStatusBarManager",Y.a,[2,177,36]);const nj=Object(Qf.b)("Common.App.DisplayFileInfo.DisplayFileInfo"),ck=Object(Qf.c)(nj);var Vg=a(138),Th=a(1018),lg=a(24),Qj=a(1240);class M{constructor(I){this.folderName=this.JDd=this.buildVersion=this.userSessionId=null;this.T4c=(pa,lb,hc,Xc,Gd)=>{if(1===hc)return 32;Gd[Th.a.SecondaryLabel]=this.userSessionId;Gd[Th.a.Visible]=!0;return 32};this.Y8k=(pa,lb,hc,Xc,Gd)=>{if(1===hc)return 32;Gd[Th.a.SecondaryLabel]=this.buildVersion;Gd[Th.a.Visible]=!0;return 32};
this.O9k=(pa,lb,hc,Xc,Gd)=>{if(1===hc)return 32;Gd[Th.a.Value]=this.pNf;Gd[Qi.a.Do]=this.pNf;Gd[Th.a.LinkInfo]={["linkText"]:this.folderName,["linkUrl"]:this.JDd};Gd[Th.a.Visible]=!0;return 32};this.$9k=(pa,lb,hc,Xc,Gd)=>{if(1===hc)return 32;Gd[Qj.a.FileLocationProps]={["breadcrumbBrandName"]:Aa.AFrameworkApplication.breadcrumbBrandName,["breadcrumbBrandUrl"]:Aa.AFrameworkApplication.breadcrumbBrandUrl,["breadcrumbFolderName"]:Aa.AFrameworkApplication.breadcrumbFolderName,["breadcrumbFolderUrl"]:Aa.AFrameworkApplication.breadcrumbFolderUrl};
Gd[Th.a.Visible]=!0;return 32};this.un=I}get sNi(){return null!=this.fHe?this.fHe:this.fHe=Aa.AFrameworkApplication.breadcrumbFolderName&&0<Aa.AFrameworkApplication.breadcrumbFolderName.length?Aa.AFrameworkApplication.breadcrumbFolderName:Aa.AFrameworkApplication.breadcrumbBrandName&&0<Aa.AFrameworkApplication.breadcrumbBrandName.length?Aa.AFrameworkApplication.breadcrumbBrandName:Object(lg.a)("Online")}get pNf(){return null!=this.iHe?this.iHe:this.iHe=Aa.AFrameworkApplication.breadcrumbBrandName&&
0<Aa.AFrameworkApplication.breadcrumbBrandName.length||Aa.AFrameworkApplication.breadcrumbFolderName&&0<Aa.AFrameworkApplication.breadcrumbFolderName.length?Object(lg.a)("SaveAssuranceStatusWithFolder"):Object(lg.a)("SaveAssuranceStatusGeneric")}ko(){var I,pa,lb;this.userSessionId=null!==(I=Aa.AFrameworkApplication.userSessionId)&&void 0!==I?I:"";this.buildVersion=null!==(pa=Aa.AFrameworkApplication.buildVersion)&&void 0!==pa?pa:"";this.folderName=null!==(lb=this.sNi)&&void 0!==lb?lb:"";this.JDd=
"";this.JDd=Aa.AFrameworkApplication.breadcrumbFolderUrl&&0<Aa.AFrameworkApplication.breadcrumbFolderUrl.length?Aa.AFrameworkApplication.breadcrumbFolderUrl:Aa.AFrameworkApplication.breadcrumbBrandUrl;this.un.Vk(od.a.Xub,Vg.a.frame,this.T4c,96);this.un.Vk(od.a.Pub,Vg.a.frame,this.Y8k,96);this.un.Vk(od.a.Rub,Vg.a.frame,this.O9k,96);this.un.Vk(od.a.gdk,Vg.a.frame,this.$9k,96)}}Object(za.a)(M,"DisplayFileInfo",null,[]);class wa{constructor(){this.Vh=null}get name(){return"Common.App.DisplayFileInfo"}co(I){this.Vh=
I;this.Vh.register(M,"Common.App.DisplayFileInfo.DisplayFileInfo").Ai().Ii(()=>new M(Aa.AFrameworkApplication.xh))}init(){Object(Qf.a)(ck).ko()}dispose(){}static main(){Vb.a.instance.Jo(new wa)}}Object(za.a)(wa,"DisplayFileInfoPackage",null,[13,14]);let ab=class{constructor(I){he.a.K1()&&(Type.registerNamespace("Common.App.DisplayFileInfo"),wa.main());this.un=I}Ri(){return!1}executeCommand(I,pa,lb){I=2;switch(pa.command){case od.a.Rub:I=this.un.Uj(od.a.Rub,2,lb);break;case od.a.Pub:I=this.un.Uj(od.a.Pub,
2,lb);break;case od.a.Xub:I=this.un.Uj(od.a.Xub,2,lb)}return 2!==I?qd.Task.Ua(!0):Vi.a(pa.command)}Ei(I,pa){I=!1;switch(pa.command){case od.a.Rub:case od.a.Pub:case od.a.Xub:I=he.a.K1()}return I}dj(){return!1}};ab=Object(wb.__decorate)([Object(Fc.d)(Gc.ic),Object(wb.__param)(0,Object(Gc.f)())],ab);Object(za.a)(ab,"FileMenuInfoCommandHandler",null,[36]);const Sb=Object(Qf.b)("Common.App.InProductMessaging.InProductMessagingUIManager"),fc=Object(Qf.c)(Sb);var Mc=a(286);const rd=Object(Qf.b)("Common.App.InProductMessaging.InProductMessagingActor"),
Jd=Object(Qf.c)(rd);var le=a(1094);const ye=Object(Qf.c)(le.a),$e=Object(Qf.b)("Common.App.InProductMessaging.IDependencyDownloader"),kf=Object(Qf.c)($e),Bf=Object(Qf.b)("Common.IInProductMessagingUIWrapper"),Zf=Object(Qf.c)(Bf);var xg=a(140),Og=a(469);class hh extends Og.a{constructor(I){super(I)}get cNb(){return!1}createElement(){const I=document.createElement("link");I.setAttribute("rel","stylesheet");I.setAttribute("type","text/css");I.setAttribute("href",this.dE);return I}lAd(){return null}YUc(){this.element.setAttribute("href",
"");this.element.setAttribute("href",this.zJ.dE)}}Object(za.a)(hh,"CssResource",Og.a,[]);var ih=a(663),Ii=a(338);class Fh{constructor(){this.vjc=this.igc=null}czj(){this.igc||(ea.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.igc=qd.Task.WAA(Fh.jzj(),Fh.Zyj()),this.igc.continueWith(I=>{ea.ULS.sendTraceTag(21030599,324,10,"{0}",Qa.a.oMd(I.exception))},5));return this.igc}fzj(){if(!this.vjc)try{ea.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),
this.vjc=qd.Task.WAA(Fh.$Ed(Ii.a.create(Aa.AFrameworkApplication.ea.Ya("DimeUrl"),null,null))),this.vjc.continueWith(I=>{ea.ULS.sendTraceTag(39978391,324,10,"{0}",Qa.a.oMd(I.exception))},5)}catch(I){ea.ULS.sendTraceTag(594874951,324,10,"{0}",Qa.a.oMd(I))}return this.vjc}static jzj(){var I=Fh.vDc("inproductmessaging.js");I=Ii.a.create(I,null,null);return Fh.$Ed(I)}static Zyj(){var I=Fh.vDc("inproductmessaging.css");I=new hh(I);return Fh.$Ed(I)}static vDc(I){return xg.a.CMb(String.format("ipm/{0}",
I))}static $Ed(I){ih.a.UIa(I);return I.brb}}Object(za.a)(Fh,"DependencyDownloader",null,[584]);class $g{}$g.U4j="inProductMessagingOverlayDiv";$g.z8j="PlayButtonImage";$g.dsk="ReplayButtonImage";Object(za.a)($g,"Constants",null,[]);class si{constructor(){this.NZe=this.WTe=this.LIe=!0;this.esk=this.A8j=null;this.bKj=!1;this.locale=null;this.L4g={}}get Faf(){return this.LIe}set Faf(I){this.LIe=I}get oeg(){return this.WTe}set oeg(I){this.WTe=I}get iWg(){return this.NZe}set iWg(I){(this.NZe=I)&&this.MHk()}MHk(){this.R4e($g.z8j,
this.A8j);this.R4e($g.dsk,this.esk)}R4e(I,pa){pa&&(this.L4g[I]=pa)}}Object(za.a)(si,"FirstRunExperienceUISettings",null,[581]);class Nh{constructor(){this.completed=this.Alk=!1}}Object(za.a)(Nh,"FirstRunExperienceViewData",null,[580]);var ti=a(218);class bj{constructor(I,pa,lb){this.zyi=(hc,Xc,Gd,ae,we)=>{2===Gd&&this.Wgc.kxj(we);return 32};this.vgi=(hc,Xc,Gd,ae,we)=>{2===Gd&&this.Wgc.exj(we);return 32};this.laj=(hc,Xc,Gd)=>2===Gd?this.Wgc.n7d():32;this.kaj=(hc,Xc,Gd)=>2===Gd?this.Wgc.k7d():32;this.$f=
I;this.Pm=pa;this.Wgc=lb}ko(){this.$f.Vk(od.a.Byi,Vg.a.frame,this.zyi,64);this.$f.Uh(od.a.yBf,Vg.a.frame,this.laj);this.$f.Uh(od.a.xBf,Vg.a.frame,this.kaj);this.$f.Uh(od.a.ugi,Vg.a.frame,this.vgi);this.$f.Uh(od.a.ZHg,Vg.a.frame,ti.ActionManager.Bm);this.$f.Uh(od.a.Esk,Vg.a.frame,ti.ActionManager.Bm);this.$f.Uh(od.a.Fsk,Vg.a.frame,ti.ActionManager.Bm);this.Pm&&this.Pm.aC()}}Object(za.a)(bj,"InProductMessagingActor",null,[]);class oj{constructor(){this.wEg=this.IJg=this.C0g=this.eMc=this.instance=null}}
Object(za.a)(oj,"DimeExperienceUISettings",null,[]);var Hj=a(542);class Oh{constructor(I,pa,lb,hc,Xc){this.Xzc=!1;this.LOb=null;this.$f=I;this.dVa=pa;this.Xjc=lb;this.UQ=hc;this.C8c=Xc}Fdj(I){hj.b("getHeaderApi")?(I.Xtj()&&appChrome.getHeaderApi().then(pa=>{pa.updateAnonymousStatus(!0);return null}),I.isFeatureEnabled("MsoPremiumBadge",!0).then(pa=>{const lb=I.isFreemiumUpsellEnabled();lb&&(appChrome.getHeaderApi().then(hc=>{hc.updatePremiumStatus(pa,lb);return null}),I.R6a("MsoPremiumBadge",hc=>
{appChrome.getHeaderApi().then(Xc=>{Xc.updatePremiumStatus(hc.isEnabled,lb);return null})}));return null})):ea.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}kxj(I){this.Xjc.czj().continueWith(()=>{this.dVa.BTk(I)})}exj(I){let pa="gopremium",lb=null,hc=()=>{};I?(I.experience&&""!==Object(Bb.a)(String,I.experience)&&(pa=Object(Bb.a)(String,I.experience)),I.onTaskComplete&&(hc=I.onTaskComplete),I.campaignId&&""!==Object(Bb.a)(String,I.campaignId)&&(lb=Object(Bb.a)(String,I.campaignId))):
ea.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.F7f(pa,hc,lb)}F7f(I,pa,lb){lb=void 0===lb?null:lb;if(this.Xzc&&this.LOb){const hc={};hc.experience=I||"gopremium";hc.campaignId=lb||Hj.b(this.UQ,this.C8c,Object(Bb.a)(String,hc.experience),!0);this.$f.$k(od.a.ZHg,2);ea.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+hc.experience);try{const Xc=Object.assign(new oj,{instance:this.LOb,eMc:hc,C0g:pa||(()=>{}),IJg:Gd=>{ea.ULS.sendTraceTag(51675405,
324,50,"Dime launch result: "+Gd.status)},wEg:()=>{ea.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.Xzc=!1;this.LOb=null}});this.dVa.rRk(Xc)}catch(Xc){ea.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Xc.message),this.Xzc=!1,this.LOb=null,this.$f.Uj(od.a.Yzc,2,{["experience"]:hc.experience})}}else ea.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.$f.Uj(od.a.Yzc,2,{["experience"]:I})}s3d(){this.Xjc.fzj().continueWith(()=>{try{var I=Qa.a.As(Aa.AFrameworkApplication.uiCulture);
const hc=Hj.c(this.UQ);if(hc){var pa={};pa.partnerId=hc;pa.language=I;pa.sessionId=Aa.AFrameworkApplication.userSessionId;pa.authHint=Aa.AFrameworkApplication.ea.Ya("UserPrincipalName");var lb=Aa.AFrameworkApplication.ea.Ya("Puid")||"";""!==lb&&(I={},I.puid=lb,pa.userInfo=I);this.LOb=new Dime(pa);this.Xzc=!0;ea.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else ea.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(hc){ea.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
hc.message)}},3)}n7d(){return this.dVa.n7d()}k7d(){return this.dVa.k7d()}}Object(za.a)(Oh,"InProductMessagingUIManager",null,[579]);class xj{constructor(){this.v0e=0;this.Ncb=Array(5);this.Ncb[0]=10;this.Ncb[1]=15;this.Ncb[2]=50;this.Ncb[3]=100;this.Ncb[4]=200}Init(I){this.v0e=I}SendTrace(I,pa){ea.ULS.sendTraceTag(34182235,this.v0e,this.Ncb[I],"{0}",pa)}}Object(za.a)(xj,"DefaultNetworkingManager",null,[602]);var cj=a(329);class dj{constructor(I){this.Yi=I}BTk(I){I&&(InProductMessaging.Networking.NetworkingMgr=
new xj,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(I.iWg,I.oeg,I.Faf,I.bKj,I.locale,Object(Uc.a)(this,this.jSj,"onDismissFirstRunExperience"),I.L4g),this.z8a($g.U4j,!0))}rRk(I){if(I&&I.instance&&I.eMc){let pa=document.getElementById("wacDimeContainer");pa||(pa=document.createElement("div"),pa.id="wacDimeContainer",document.body.appendChild(pa));Aa.AFrameworkApplication.ea.ka("DimeFocusManagerIsEnabled")&&this.z8a("wacDimeContainer",!1);I.eMc.parentElementId="wacDimeContainer";
I.instance.launch(I.eMc,I.C0g).then(lb=>{this.J5b();document.body.removeChild(pa);I.IJg(lb)}).catch(lb=>{this.J5b();document.body.removeChild(pa);I.wEg(lb)})}else throw Error.argument("DimeExperienceUISettings");}z8a(I,pa){if(this.Yi&&I&&(I=document.getElementById(I),this.tdj(I),I=this.Yi.n1("InProductMessagingFocusId"))){const lb=this.Yi.currentScope;lb&&"InProductMessagingFocusId"===lb.name||this.Yi.b8("InProductMessagingFocusId",!1);pa&&this.CCg(I.scope)}}tdj(I){var pa=!1;pa=void 0===pa?!0:pa;
const lb=this.Yi.er("InProductMessagingFocusId");lb.parent=wg.AFrame.I4;const hc=new cj.DOMFocusListing(()=>I);hc.C5b=pa;hc.Nx(3);hc.Nx(2);hc.Nx(4);pa=this.Yi.KWa(()=>I,lb,hc);pa.aVc();pa.Rha=!0;pa.gib=!0}CCg(I){I.$B(Yh.FocusManager.instance().Fea);I.$B(Yh.FocusManager.instance().Gea);I.bindAction(Yh.FocusManager.instance().Fea,od.a.yBf);I.bindAction(Yh.FocusManager.instance().Gea,od.a.xBf)}J5b(){this.Yi&&(this.Yi.Aia("InProductMessagingFocusId"),this.Yi.h7a("InProductMessagingFocusId"))}jSj(I,pa){this.J5b();
I=Object.assign(new Nh,{completed:I,Alk:pa});Aa.AFrameworkApplication.xh.Uj(od.a.yyi,2,I)}n7d(){const I=document.activeElement,pa=this.Yi.j1();return I&&pa&&pa.Go&&I===pa.Go.iG?(pa.Go.KG(I),pa.H0b()?32:8):4}k7d(){const I=document.activeElement,pa=this.Yi.j1();return I&&pa&&pa.Go&&I===pa.Go.UM?(pa.Go.KG(I),pa.Trb()?32:8):4}}Object(za.a)(dj,"InProductMessagingUIWrapper",null,[578]);class Ki{constructor(){this.Vh=null}get name(){return"Common.App.InProductMessaging"}co(I){I.register(Fh,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Ai().Ii(()=>
new Fh);I.register(dj,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Ai().Ii(()=>new dj(Yh.FocusManager.instance()));I.register(Oh,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Ai().Ii(()=>new Oh(Aa.AFrameworkApplication.xh,Object(Qf.a)(Zf),Object(Qf.a)(kf),Aa.AFrameworkApplication.ra.$g.qn,Aa.AFrameworkApplication.ra.$g.xNa));I.register(bj,"Common.App.InProductMessaging.InProductMessagingActor").Ai().Ii(()=>
new bj(Aa.AFrameworkApplication.xh,Aa.AFrameworkApplication.ra,Object(Qf.a)(ye)));I.register(si,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Ai().Ii(()=>new si);I.register(Nh,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Ai().Ii(()=>new Nh);this.Vh=I}init(){Object(Qf.a)(Jd).ko();Aa.AFrameworkApplication.ea.cy(()=>{Aa.AFrameworkApplication.ra.$g.Iw&&bd.a.get_instance().Hm(15,()=>{Object(Mc.a)().execute(I=>
{Object(Qf.a)(fc).Fdj(I)})});Aa.AFrameworkApplication.ea.ka("FreemiumUpsellShowDialogIsEnabled")&&Hj.a()&&1!==Aa.AFrameworkApplication.ra.$g.qn&&Object(Mc.a)().execute(I=>{I.isFeatureEnabled("MsoPremiumBadge",!0).then(pa=>{!pa&&I.isFreemiumUpsellEnabled()&&Object(Qf.a)(fc).s3d();return null})})})}dispose(){}static main(){Vb.a.instance.Jo(new Ki)}}Object(za.a)(Ki,"InProductMessagingPackage",null,[13,14]);var ak=a(660);class C{constructor(I,pa,lb,hc,Xc){this.U_a=Gd=>{let ae=!1,we=null;try{if(0<Gd.data.responseData.length){const Re=
Object(Bb.a)(Object,wh.a(Gd.data.responseData)),lf=Re?Re[this.BF.Mrd]:null;lf&&(we=Object(Bb.a)(Object,wh.a(lf.toString())))}ae=!0}catch(Re){this.Cxa(null)}ae&&this.UDb&&this.UDb(Gd.data,we)};this.Cxa=Gd=>{this.QDb&&this.QDb(Gd?Gd.data:null)};this.k$j=Gd=>{this.AWe&&this.AWe(Gd?Gd.data:null)};this.OAa=Gd=>{this.gGb&&this.gGb(Gd?Gd.data:null)};this.BF=I;this.UDb=pa;this.QDb=lb;this.AWe=void 0===hc?null:hc;this.gGb=void 0===Xc?null:Xc}TGd(I){const pa=new Sys.StringBuilder(this.BF.k7b);pa.append("RoamingServiceHandler.ashx?action=");
pa.append("getFirstRunExperienceSettings");pa.append("&");pa.append(this.LOd(I));pa.append("&");pa.append(Aa.AFrameworkApplication.Oo);Aa.AFrameworkApplication.lj.qv(pa.toString(),1,null,null,!0,2,this.U_a,this.Cxa,null)}oyc(I){var pa=new Sys.StringBuilder(this.BF.k7b);pa.append("RoamingServiceHandler.ashx?action=");pa.append("saveFirstRunExperienceSettings");pa.append("&");pa.append(Aa.AFrameworkApplication.Oo);pa=pa.toString();I=wh.c(I);Aa.AFrameworkApplication.lj.qv(pa,2,I,null,!0,4,this.k$j,this.OAa,
null)}LOd(I){const pa=new Sys.StringBuilder("requestedsettings=");for(let lb=0;lb<I.count;lb++)pa.append(I.ma(lb)),lb<I.count-1&&pa.append(";");return pa.toString()}}Object(za.a)(C,"FirstRunExperienceRequestHandler",null,[]);var Ca=a(252);class qb{constructor(){this.IDb=this.jgc=this.BF=null;this.U_a=(I,pa)=>{I=I?+I.W$-+I.EP:-1;I>this.BF.PKg?ea.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
I,this.BF.PKg):pa?this.VPk(pa)?(ea.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.BF.feg),this.hue()):(this.qDd(!1),ea.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ea.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.hue())};this.Cxa=I=>
{this.qDd(!1);ea.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",I?I.httpStatus:-1)};this.OAa=I=>{ea.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",I?I.httpStatus:-1)};this.tTj=I=>{if(I){var pa=I.detail;I=I.type;var lb=this.BF&&this.BF.campaignId?this.BF.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===I||lb&&pa&&pa.id&&-1!==pa.id.indexOf(lb)){if("FRELaunchedEvent"===
I||pa&&pa.success)ea.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.kMg(this.BF.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.IDb,!0),window.removeEventListener("FRELaunchedEvent",this.IDb,!0))}}}}gue(I){I?(this.BF=I,this.Woj()&&(ea.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),I=new xc.a,I.add(this.BF.Mrd),this.jgc=new C(this.BF,
this.U_a,this.Cxa,null,this.OAa),this.jgc.TGd(I)),(this.BF.Ypb||Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.hue()):ea.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}Woj(){try{if(this.BF.Ypb)return!0;if(!Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Aa.AFrameworkApplication.ea.ka("IsAnonymousUser"))return!1;if(this.BF.zkj||this.BF.aqb||Aa.AFrameworkApplication.ea.ka("IsO365ConsumerHost"))return!0;
const I=Aa.AFrameworkApplication.ea.Ya("FlightId");return-1!==(I?I.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(I){ea.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",I?I.toString():null)}return!1}kMg(I){const pa={},lb={};lb.FREDisplayedDate=(new Date).toUTCString();lb.VersionDisplayed=I;lb.RemindMeLater=!1;pa[this.BF.Mrd]=wh.c(lb);ea.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.jgc&&this.jgc.oyc(pa)}hue(){this.qDd(!0);
var I=Object(ak.c)();I?this.SVg(I):(ea.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((I=Object(ak.a)())?I.execute(pa=>{this.SVg(pa)}):ea.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}SVg(I){if(I){var pa=this.BF.Myi;pa&&$b.a.GV(pa);ea.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",
pa);I.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.IDb=this.tTj,window.addEventListener("FGWebSurfaceEvent",this.IDb,!0),window.addEventListener("FRELaunchedEvent",this.IDb,!0)):(ea.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.kMg(this.BF.currentVersion))}else ea.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}VPk(I){if("RemindMeLater"in I&&"FREDisplayedDate"in I){if("true"===I.RemindMeLater.toString()&&
(+new Date-+new Date(I.FREDisplayedDate.toString()))/36E5>this.BF.feg)return!0}else if(Aa.AFrameworkApplication.ea.ka("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in I&&I.VersionDisplayed<this.BF.currentVersion)return ea.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}qDd(I){Aa.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&Ca.a.dispatch("FREDecisionEvent",
{["show"]:I})}}Object(za.a)(qb,"FirstRunExperienceLauncher",null,[549]);class nc{constructor(){this.Vh=null}get name(){return"Common.App.FirstRunExperienceLauncher"}co(I){this.Vh=I;this.Vh.register(549,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Ai().Ii(()=>new qb)}init(){}dispose(){}static main(){Vb.a.instance.Jo(new nc)}}Object(za.a)(nc,"FirstRunExperienceLauncherPackage",null,[13,14]);var Rc=a(9);class id extends je.a{constructor(I){super();this.$=I;this.sn()}create(){const I=
Object(Xe.a)(this.$.qa,311,()=>new Rg(this.$));this.dl(I)}static Ga(I){I.qa.Rh(312,new id(I))}}Object(za.a)(id,"FirstRunExperienceManagerFactory",je.a,[]);var sd=a(630),Fd=a(677);class S extends sd.a{constructor(I){super(1);this.Nsa=!1;this.Zig=()=>{this.refresh()};this.$ig=()=>{this.refresh()};this.da=Oc.f(I);this.da.Dh.Mv(this.$ig);this.da.Dh.Ox(this.Zig);this.refresh()}get JS(){return this.WNc(this.Nsa)}wre(I){this.Nsa!==I&&(this.Nsa=I,this.O4b())}get name(){return Fd.a.cellEdit}dispose(){this.da.Dh.Cv(this.$ig);
this.da.Dh.Ow(this.Zig);this.da=null;super.dispose()}O4b(){this.Kge(this.Nsa)}refresh(){this.wre(!this.da.isEditing)}}Object(za.a)(S,"CellEditSafeStatePublisher",sd.a,[]);class Ua{constructor(I,pa){this.handler=null;this.hge=I;this.JS=pa}}Object(za.a)(Ua,"SafeStatePublisherState",null,[]);var Hb=a(745);const Ec=I=>I?`${I.Current} / ${I.Pending} @${I.SuspensionStartTimestamp}`:null,cd=I=>(null===I||void 0===I?void 0:I.SuspensionStartTimestamp)&&I.Pending>I.Current;class Bd extends Y.a{constructor(I,
pa){super();this.k7f=null;this.ELc=!1;this.o2b=(lb,hc)=>{3===hc.Sdg&&this.ELc&&ea.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.ELc=!0;this.S4b()};this.T7a=new xc.a;this.Nrb=I;this.HAa=pa;if(this.VWb=jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1))this.HAa.gfb(this.ONa.bind(this)),this.Nrb.O5e(this.o2b)}get e8k(){return this.T7a.toArray().filter(I=>0!=I.JS).map(I=>I.hge.name)}Tnc(I){this.addHandler(Bd.S7a,
I)}TVc(I){this.removeHandler(Bd.S7a,I)}dPa(I,pa){const lb=new Ua(I,pa);this.T7a.add(lb);pa=(hc,Xc)=>{lb.JS=Xc.JS;this.S4b()};I.Tnc(pa);lb.handler=pa;this.S4b()}wAe(I){let pa=null;for(const lb of this.T7a)if(lb.hge===I){this.T5g(lb);pa=lb;break}pa&&(this.T7a.remove(pa),this.S4b())}dispose(){for(const I of this.T7a)this.T5g(I);this.T7a.clear();this.VWb&&(this.HAa.Kvb(this.ONa.bind(this)),this.Nrb.GGg(this.o2b));super.dispose()}xAc(){const I=Ag.xAc(this.T7a.toArray().map(pa=>pa.JS));return this.ELc&&
1===I?2:I}T5g(I){I.hge.TVc(I.handler)}S4b(){const I=this.xAc();I!==this.k7f&&(this.raiseEvent(Bd.S7a,new Hb.a(I)),this.k7f=I)}ONa(I,pa){I=pa.tpa;(pa=!cd(I))||(pa=this.zwj,pa=(null===I||void 0===I?void 0:I.SuspensionStartTimestamp)!==(null===pa||void 0===pa?void 0:pa.SuspensionStartTimestamp));pa&&(this.ELc=!1);this.zwj=I;this.S4b()}}Bd.S7a="SSC";Object(za.a)(Bd,"ClientStateMonitor",Y.a,[]);class ce extends sd.a{constructor(I,pa){pa=void 0===pa?null:pa;super(1);this.Nsa=!1;this.C7=()=>{this.refresh()};
this.fkg=()=>{this.refresh()};this.$=I;this.ZOe=pa||jc.a(I).j6(Ib.a.idle);jc.a(I).Jpd(this.fkg);this.Bnb.ry(this.C7);this.refresh()}get JS(){return this.WNc(this.Nsa)}wre(I){I!==this.Nsa&&(this.Nsa=I,this.O4b())}get name(){return Fd.a.Bnb}get Bnb(){return this.ZOe}dispose(){jc.a(this.$).zVc(this.fkg);this.Bnb.fy(this.C7);this.ZOe=null;super.dispose()}O4b(){this.Kge(this.Nsa)}refresh(){this.wre(1===this.Bnb.CE||jc.a(this.$).aq===this.Bnb)}}Object(za.a)(ce,"IdleActivitySafeStatePublisher",sd.a,[]);
class Fe extends Ob.a{constructor(){super()}Ri(){return!1}executeCommand(){return qd.Task.Ua(!0)}Ei(I,pa){return 1905775613===pa.command}dj(){return!1}}Object(za.a)(Fe,"ToggleMergeSuspensionSafeState",Ob.a,[36]);class Ue extends Y.a{constructor(I,pa){super();this.statusBarManager=null;this.r8d=!1;this.ONa=(lb,hc)=>{lb=`${hc.tpa.Current===hc.tpa.Pending?"\u26ad":"\u26ae"}${hc.tpa.Current}`;Td.a.equals(this.AOc,lb,!1)||(this.AOc=lb,this.ew())};this.v5a=(lb,hc)=>{lb=0==hc.JS;this.r8d!==lb&&(this.r8d=
lb,this.ew())};this.mergeSuspensionManager=pa;this.mergeSuspensionManager.HAa.gfb(this.ONa);this.AOc="";bi.a.Dla(1905775613,vi.a.li,0,1);this.Ia=I.Ia;this.Oac=new Fe;I.qa.zi(29,lb=>{this.mergeSuspensionManager&&(this.statusBarManager=lb,lb.vO(this),this.mergeSuspensionManager.pva.Tnc(this.v5a))});this.Ia.iua(this.Oac)}ry(I){this.addHandler(Ue.P6d,I)}fy(I){this.removeHandler(Ue.P6d,I)}ew(){this.raiseEvent(Ue.P6d)}Up(I){return I===Ue.kdk&&!!this.mergeSuspensionManager}Aw(I,pa){if(!this.Up(I))return!1;
this.mergeSuspensionManager&&(pa.LabelText=this.AOc,pa.On=this.r8d);return!0}dispose(){this.Oac&&(this.Ia.Cvb(this.Oac),this.Oac.dispose(),this.Oac=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.HAa.Kvb(this.ONa),this.mergeSuspensionManager.pva.TVc(this.v5a),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null);this.AOc=null;super.dispose()}}Ue.P6d="MSMSC";Ue.kdk="QueryMergeSuspensionStatus";Object(za.a)(Ue,"MergeSuspensionIndicatorManager",
Y.a,[176,177,2]);var pf=a(1096);class Tf extends Sys.EventArgs{constructor(I){super();this.TLa=I}}Object(za.a)(Tf,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class pg{}Object(za.a)(pg,"SuspensionState",null,[]);class Ng extends pg{constructor(I){super();this.F7e=!1;this.F7e=I}}Object(za.a)(Ng,"ReadyForPendingMergeState",pg,[]);const Ug=new pg,$h=new pg,Yj=new Ng(!1),Oj=new Ng(!0);var Sj=a(1095);class Di extends Sj.a{constructor(I,pa,lb){super(I);this.dIh=pa;this.zUk=lb}}Object(za.a)(Di,
"ReadyForPendingMergesUpdatedEventArgs",Sj.a,[]);class fi extends Y.a{constructor(I,pa,lb){super();this.ONa=(hc,Xc)=>{hc=this.getState();const Gd=this.bca;this.bca=Xc.tpa;Xc=this.getState();this.qCj(hc,Xc,Gd);this.raiseEvent(fi.L6d);this.lBf(hc,Xc)};this.v5a=(hc,Xc)=>{hc=this.getState();this.JS=Xc.JS;Xc=this.getState();this.lBf(hc,Xc)};this.o2b=(hc,Xc)=>{4===Xc.Sdg&&(ea.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",
Ec(this.bca),Ec(Xc.bca)),this.cBg(this.getState(),!0))};this.VWb=jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.pva=I;this.pva.Tnc(this.v5a);this.HAa=pa;this.HAa.gfb(this.ONa);this.Nrb=lb;this.Nrb.O5e(this.o2b);this.bca=Object(Yc.a)(new pf.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.JS=this.Cbj()}Cbj(){return Object(Nb.a)(Bd,this.pva)?Object(Bb.a)(Bd,this.pva).xAc():1}Xnc(I){this.addHandler(fi.Jye,I)}WVc(I){this.removeHandler(fi.Jye,
I)}mFh(I){this.addHandler(fi.whe,I)}$pk(I){this.removeHandler(fi.whe,I)}uEh(I){this.addHandler(fi.L6d,I)}spk(I){this.removeHandler(fi.L6d,I)}qfk(){this.Hge(this.getState()===$h)}dispose(){this.pva.TVc(this.v5a);this.pva=null;this.HAa.Kvb(this.ONa);this.HAa=null;this.Nrb.GGg(this.o2b);this.Nrb=null;super.dispose()}QNd(){return Object(Yc.a)(new pf.a,{Current:this.bca.Current,Pending:this.bca.Pending,SuspensionStartTimestamp:this.bca.SuspensionStartTimestamp})}getState(){return cd(this.bca)?0==this.JS?
Oj:this.VWb&&1==this.JS?Yj:$h:Ug}lBf(I,pa){I!==pa&&(pa===$h?this.Hge(!0):I===$h&&this.Hge(!1));this.cBg(pa)}cBg(I,pa){I instanceof Ng&&this.raiseEvent(fi.whe,new Di(this.bca,I.F7e||!this.VWb,void 0===pa?!1:pa))}qCj(I,pa,lb){I===Ug&&pa!==Ug?(I=pa===$h,pa=pa===Yj,ea.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${pa} publisher: ${pa||I?this.pva.e8k.join(","):""} counter: ${Ec(this.bca)} isBlockingAllMerges: ${I}`)):I!==
Ug&&pa===Ug&&ea.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${Ec(lb)}`)}Hge(I){this.raiseEvent(fi.Jye,new Tf(I))}}fi.Jye="TPMBBC";fi.whe="RFPMU";fi.L6d="MCC";Object(za.a)(fi,"MergeSuspensionStateHandler",Y.a,[]);class Ji extends Y.a{constructor(I){super();this.nea=null;this.DLc=0;this.u0b=(pa,lb)=>{(null===lb||void 0===lb?0:lb.tpa)&&this.o5a(lb.tpa,Ji.CDe)};this.RYc=()=>{this.sJg();this.RAg(this.nea,Ji.luk)};this.E$d=(pa,
lb)=>{lb.committed&&this.nea.SuspensionStartTimestamp&&ea.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${Ec(this.nea)}`)};this.sJg();this.$=I;this.$.fa.Nq(this.RYc);this.$.fa.BO(this.RYc);Oc.f(this.$).Dh.Ox(this.E$d);this.$.qa.zi(292,pa=>{pa.gfb(this.u0b);ea.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}gfb(I){this.addHandler("MCU",I)}Kvb(I){this.removeHandler("MCU",I)}get bca(){return this.nea}o5a(I,pa){pa=void 0===pa?"":pa;const lb=
this.nea.Current<I.Current||this.nea.Pending<I.Pending;if(I.SuspensionStartTimestamp&&this.DLc!==I.SuspensionStartTimestamp){if(this.DLc>I.SuspensionStartTimestamp){lb&&ea.ULS.sendTraceTag(553736149,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${pa}. S: ${Ji.t0b(I)}, C: ${Ji.t0b(this.nea)}`);return}lb||ea.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${Ji.t0b(I)}, C: ${Ji.t0b(this.nea)}`)}else if(!lb)return;
this.nea=I;this.RAg(I,pa)}dispose(){this.$.fa.Lq(this.RYc);this.$.fa.pQ(this.RYc);Oc.f(this.$).Dh.Ow(this.E$d);const I=this.$.qa.zh(292);I&&I.Kvb(this.u0b);super.dispose()}RAg(I,pa){pa=void 0===pa?"":pa;cd(I)&&I.SuspensionStartTimestamp>this.DLc&&(ea.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${Ec(I)}, Origin: ${pa}`),this.DLc=I.SuspensionStartTimestamp);this.raiseEvent("MCU",new Sj.a(I))}sJg(){ea.ULS.sendTraceTag(588276808,
0,50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${Ji.t0b(this.nea)}`);this.nea=Object(Yc.a)(new pf.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static t0b(I){return I?`(${I.Current}/${I.Pending} @${I.SuspensionStartTimestamp})`:"null"}}Ji.CDe="PMM.RTC";Ji.Uwc="PMM.EwaResult";Ji.luk="PMM.resetMergeCounter";Object(za.a)(Ji,"PendingMergeMonitor",Y.a,[]);class dk{}Object(za.a)(dk,"ClientRevisions",null,[]);const wj=(I,pa,lb,hc,Xc,Gd,ae)=>{ae=I.Za(1,void 0===ae?null:ae);ae.suspensionStartTimestamp=
pa;return Cb.h(I,"KeepBlockingPendingMerges",ae,lb,hc,Xc,Gd,0)};class qk extends Y.a{constructor(I,pa,lb,hc){super();this.QYa=null;this.tZb=0;this.uZb=this.rqb=null;this.hqg=(Xc,Gd)=>{this.QYa.ULh(Gd.tpa,Gd.dIh,Gd.zUk)};this.U2b=(Xc,Gd)=>{Gd.TLa?this.LWk():this.e1c()};this.iog=()=>{this.tZb=0};this.oOg=()=>{const Xc=this.Xha.QNd();wj(this.ta,null!=Xc.SuspensionStartTimestamp?Xc.SuspensionStartTimestamp:0,null,()=>{this.jXj(Xc)},null,null,this.ta.Wh())};this.QRa=(Xc,Gd)=>{if(Gd){Gd.uJb.MergeCount=
this.Xha.QNd();const {min:ae,max:we}=Oc.f(this.$).RHj();jd.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Gd.uJb.ClientRevisions=Object(Yc.a)(new dk,{Min:ae,Max:we,MaxFromBlockCache:Oc.f(this.$).za.odg}):Gd.uJb.ClientRevisions=Object(Yc.a)(new dk,{Min:ae,Max:we})}};this.$=I;this.dgb=lb;this.Xha=pa;this.Xha.mFh(this.hqg);this.Xha.Xnc(this.U2b);this.Xha.uEh(this.iog);this.$.oa.kJb(this.QRa);this.ta=this.$.oa.ta;this.Tle=this.$.ua.MergeSuspensionRequestThrottlingTimeInMs;
this.Rvj=this.$.ua.KeepBlockingPendingMergesRequestIntervalMs;this.QYa=hc;ea.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.oa.q6b(this.QRa);this.e1c();this.Xha.$pk(this.hqg);this.Xha.WVc(this.U2b);this.Xha.spk(this.iog);this.Xha=null;super.dispose()}LWk(){this.e1c();if(this.Jqf()){const I=this.Xha.QNd();ea.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${Ec(I)} fail count: ${this.tZb}`)}else this.uZb=
this.dgb.create(this.oOg,this.Tle,ad.a.uZb),this.rqb=this.dgb.$O(this.oOg,this.Rvj,ad.a.rqb)}e1c(){this.rqb&&(this.uZb.cancel(),this.rqb.cancel(),this.rqb=this.uZb=null)}jXj(I){let pa;pa=" fail count: "+this.tZb;this.tZb++;this.Jqf()&&this.e1c();ea.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${Ec(I)}${pa}`)}Jqf(){return this.tZb>qk.xGj}}qk.xGj=5;Object(za.a)(qk,"RequestController",Y.a,[]);class Hk extends Sys.EventArgs{constructor(I,
pa){super();this.Sdg=I;this.bca=pa}}Object(za.a)(Hk,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);class zh extends Y.a{get p1a(){return 0<this.$be}constructor(I,pa,lb,hc,Xc){lb=void 0===lb?null:lb;hc=void 0===hc?null:hc;Xc=void 0===Xc?null:Xc;super();this.CLc=null;this.$be=0;this.documentVisibilityObserver=null;this.x6f=!1;this.UNc=null;this.ta=I;this.Tle=pa.ua.MergeSuspensionRequestThrottlingTimeInMs;const Gd=pa.ua.GetRangeContentPrefetchDelayForMergeInMs;this.eD=()=>{pa.QMg(Gd)};this.$p=lb||wc.a.kh;
this.p9g=0;this.EW=hc;this.LPa=Xc;jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Fc.a.resolve(Gc.Db).then(ae=>{this.documentVisibilityObserver=ae}):pa.qa.zi(291,ae=>{this.documentVisibilityObserver=ae})}O5e(I){this.addHandler(zh.M6d,I)}GGg(I){this.removeHandler(zh.M6d,I)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Xn}ULh(I,pa,lb){this.G9b(I,pa,void 0===lb?!1:lb)?(new Pa.a).setResult(!0):
(pa=this.n7j(I,pa),this.CLc=I,this.$be++,pa.continueWith(()=>{this.nSj()},0,nd.a.none,this.EW))}n7j(I,pa){this.p9g=this.$p.Xra;this.x6f=pa;ea.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${I.Current} / ${I.Pending} @${I.SuspensionStartTimestamp}. allowSelectionAdjustment: ${pa}`);this.isDocumentHidden||this.eD();return this.CBk(pa,I)}G9b(I,pa,lb){lb=void 0===lb?!1:lb;if(this.LPa&&!pa&&!this.LPa.Ysj())return ea.ULS.sendTraceTag(523317956,
0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.CLc||I.SuspensionStartTimestamp>this.CLc.SuspensionStartTimestamp)return this.p1a&&ea.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${I.Current} / ${I.Pending} @${I.SuspensionStartTimestamp}`),!1;if(this.p1a)return!0;if(lb)return!1;lb=this.CLc;const hc=this.$p.Xra-this.p9g<
this.Tle;pa=this.x6f===pa;return(I||lb?I&&lb?I.Current===lb.Current&&I.Pending===lb.Pending&&I.SuspensionStartTimestamp===lb.SuspensionStartTimestamp:!1:!0)&&hc&&pa}CBk(I,pa){const lb=this.ta.Wh(),hc=()=>{ea.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${pa.Current} / ${pa.Pending} @${pa.SuspensionStartTimestamp}`)};return this.LPa?this.LPa.Exk(this.mLi(I,hc,lb)):this.Fdf(null,!0,void 0,hc,lb)}mLi(I,pa,lb){return(hc,Xc,Gd)=>{let ae=void 0;ea.ULS.shipAssertTag(523317955,
0,null!=hc||I,"!allowSelectionAdjustment requires a non-null initialViewportState.");ae=this.oSj.bind(this);Xc&&(ae=zc.c.call(null,we=>{const Re=we.Result;let lf=null===Re||void 0===Re?void 0:Re.AdjustedViewportState;3===(null===Re||void 0===Re?void 0:Re.MergeResultState)&&(lf=void 0);Xc(lf,we.StateId)},ae));Gd&&(pa=zc.b.call(null,Gd,pa));return this.Fdf(hc,I,ae,pa,lb)}}Fdf(I,pa,lb,hc,Xc){var Gd=this.ta;Xc=Gd.Za(1,void 0===Xc?null:Xc);Xc.viewportState=I;Xc.allowViewAdjustment=pa;return Cb.h(Gd,"DoPendingMerge",
Xc,lb,hc,null,null,0)}oSj(I){var pa=I.Result;void 0!=pa&&(pa=pa.MergeResultState,2!==pa&&(this.UNc=[pa,I.MergeCount]))}Jek(I,pa){this.raiseEvent(zh.M6d,new Hk(I,pa))}nSj(){this.$be--;if(this.UNc){const I=this.UNc;this.UNc=null;this.Jek(...I)}}}zh.M6d="MDO";Object(za.a)(zh,"DoPendingMergeSender",Y.a,[618,619]);class $k{constructor(I){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=
this.adjusted=this.adjustedDidntChange=0;this.haj=void 0===I?!1:I}get reportName(){return this.haj?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}Object(za.a)($k,"SelectionAdjustSessionEndsReport",null,[182]);class Ik{constructor(I,pa,lb,hc,Xc,Gd){this.th=I;this.SQ=pa;this.rla=lb;this.QUa=hc;this.RHe=Xc;this.hX=Gd}get activeCell(){return this.SQ}get selectedRanges(){return this.rla}get Ly(){let I=!1;if(null===this.hX||void 0===this.hX)I=!0;else if(this.hX>=this.selectedRanges.length||!this.selectedRanges[this.hX].contains(this.activeCell))ea.ULS.sendTraceTag(521200010,
0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.hX}, selectedRangesLength: ${this.selectedRanges.length}`),I=!0;I&&(this.hX=this.zTh());return this.hX}get activeRange(){return 0>this.Ly?this.activeCell:this.selectedRanges[this.Ly]}get sheetName(){return this.QUa}get activeItemName(){return this.RHe}get reh(){return 1===this.selectedRanges.length}B$g(I){const pa=this.selectedRanges.map(lb=>this.t5k(lb,this.RHe));for(const lb of pa)if(lb)for(const hc of lb)if(hc.xq&&
hc.Ck.Revision<I)return!1;return!0}I1k(){var I;return{SheetName:this.sheetName,ActiveCell:null===(I=this.activeCell)||void 0===I?void 0:I.toString(),TopLeft:void 0,SelectedRanges:Kc.t(this.selectedRanges,this.th)}}toString(){var I,pa;return`active cell: ${null!==(pa=null===(I=this.activeCell)||void 0===I?void 0:I.toString())&&void 0!==pa?pa:"null"} selection: ${this.selectedRanges.map(lb=>{var hc;return null!==(hc=null===lb||void 0===lb?void 0:lb.toString())&&void 0!==hc?hc:"null"}).join(",")}`}equals(I){return I?
this.activeCell.equals(I.activeCell)&&Kc.X(this.selectedRanges,I.selectedRanges)&&this.sheetName===I.sheetName:!1}zTh(){for(const I of this.selectedRanges.entries()){const [pa,lb]=I;if(null===lb||void 0===lb?0:lb.contains(this.activeCell))return pa}return-1}t5k(I,pa){var lb;const hc=Oc.f(this.th).za.UJa(I,pa);hc||ea.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==(lb=null===I||void 0===I?void 0:I.toString())&&void 0!==lb?lb:"null"} ; activeItemNameIsDefined: ${!!pa}`);
return hc}}Object(za.a)(Ik,"SelectionState",null,[]);var al=a(205),yl=a(961);class bl{constructor(I){this.X0c=0;this.xR=this.BP=null;this.kIe=new $k;this.lIe=new $k(!0);this.yS=0;this.P_k=!1;this.UHj=1E4;this.Dj=()=>{this.unf()};this.mq=()=>{this.Vsd(!0,!1)};this.Dsb=()=>{this.Vsd(!1,!1)};this.$=I;this.da=Oc.f(this.$);this.da.za.qy(this.mq);this.da.za.sz(this.Dsb);this.da.za.g5e(this.Dsb);this.da.za.qua(this.Dsb);this.$.nr(this.Dj);this.unf()}Exk(I){let pa=null,lb=null;const hc=()=>{this.uOj()};this.$Xf()?
(this.d0.parallel++,ea.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.xR}`)):(pa=(Xc,Gd)=>{this.vOj(Xc,Gd)},lb=this.RHk());return null===I||void 0===I?void 0:I(lb,pa,hc)}Ysj(){return!this.$Xf()&&this.Kaa().reh}RHk(){var I;ea.ULS.shipAssertTag(525135961,0,0===this.yS,"SelectionAdjustManager.setPreRequestState: unexpected state");this.xR&&(this.d0.errors++,ea.ULS.sendTraceTag(526960090,
0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.xR.toString()}`));this.xR=null;this.BP=this.Kaa();let pa=null;const lb=null===(I=this.BP)||void 0===I?void 0:I.I1k();lb&&(pa={ActiveSheetName:this.BP.sheetName,SheetViewportStateChanges:[lb]});this.yS=1;return pa}uOj(){ea.ULS.shipAssertTag(525135960,0,1===this.yS,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.d0.errors++;this.yS=2;this.Sx()}vOj(I,pa){try{ea.ULS.shipAssertTag(525135959,
0,1===this.yS,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.X0c=pa,pa=2,this.BP?I?(this.xR=this.$Lk(I))?(pa=7,this.BP.equals(this.xR)?this.BP.equals(this.Kaa())?(this.d0.adjustedDidntChange++,pa=4):(this.d0.adjustedDidntChangeWithDivergence++,pa=5):this.BP.sheetName!=this.xR.sheetName?(this.d0.differentSheetAdjust++,pa=10):this.BP.equals(this.Kaa())||(this.d0.divergenceOnResponse++,pa=6,this.THg())):this.d0.errors++:(this.d0.errors++,ea.ULS.sendTraceTag(537155412,0,15,
`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.BP.toString()}`)):(this.d0.errors++,ea.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===I||void 0===I?void 0:I.ActiveCell}`)),this.yS=pa}catch(lb){this.yS=12,ea.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${lb}`)}finally{7!=
this.yS?this.Sx():this.Vsd(!1,!0)}}dispose(){this.da.za.Ax(this.mq);this.da.za.Vz(this.Dsb);this.da.za.$Fg(this.Dsb);this.da.za.Fvb(this.Dsb);this.$.$r(this.Dj)}$Xf(){return 1===this.yS||7===this.yS}$Lk(I){let pa;if(!(()=>{let Gd=Kc.jb(I.ActiveCell,this.$.sa);({range:pa}=Gd);return Gd})().returnValue)return ea.ULS.sendTraceTag(537155411,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${I.ActiveCell}`),null;let lb=[];const hc=this.$.la,Xc=!!hc&&2===hc.IG;
if(I.SelectedRanges)lb=Kc.h(I.SelectedRanges.Ranges);else if(!Xc)return ea.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!hc}`),null;return new Ik(this.$,pa,lb,I.SheetName,this.BP.activeItemName,this.BP.Ly)}Kaa(){const I=this.$.la;if((null===I||void 0===I?0:I.activeCell)&&I.selectedRanges&&I.sheetName)return new Ik(this.$,I.activeCell,I.selectedRanges,I.sheetName,this.$.activeItemName,I.Ly);ea.ULS.sendTraceTag(525135957,
0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!I}, activeCell null: ${!(null===I||void 0===I?0:I.activeCell)}, selectedRanges null: ${!(null===I||void 0===I?0:I.selectedRanges)}, sheetName null: ${!(null===I||void 0===I?0:I.sheetName)}`);return null}unf(){this.$.qa.zi(276,()=>{const I=al.a(this.$);I.v$(this.kIe);I.v$(this.lIe)})}Vsd(I,pa){var lb;if(this.crj(I))if(8===this.yS)ea.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");
else{pa&&ea.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{ea.ULS.shipAssertTag(525135956,0,7===this.yS,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.BP.equals(this.Kaa())?(null===(lb=this.da)||void 0===lb?0:lb.isEditing)?(this.d0.editBoxDivergence++,this.yS=11):(I=0,I=this.xR.Ly,-1==I?(this.d0.errors++,ea.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):
(this.d0.adjusted++,this.yS=8,this.da.ha.zL(this.xR.selectedRanges,I,this.xR.activeCell,0,void 0,"SelectionAdjust"))):(this.d0.divergenceOnViewportReady++,this.THg(),this.yS=9)}catch(hc){this.yS=12,ea.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${hc}`)}finally{this.Sx()}}}crj(I){if(!this.xR)return!1;if(!this.BP)return ea.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.xR.toString()}`),
!1;if(Oc.f(this.$).za.odg<this.X0c)return!1;if(I||this.P_k)ea.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.BP.B$g(this.X0c)||!this.xR.B$g(this.X0c))return!1;return!0}Sx(){this.BP=this.xR=null;this.yS=0}THg(){const I=this.Kaa();ea.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.BP.toString()} current: ${I?I.toString():""} adjusted: ${this.xR.toString()} sheetSameBetweenInitialAndAdjusted: ${this.BP.sheetName===
this.xR.sheetName} sheetSameBetweenInitialAndCurrent: ${this.BP.sheetName===(I?I.sheetName:null)}`)}get d0(){return yl.a.iN(this.UHj)?this.lIe:this.kIe}}Object(za.a)(bl,"SelectionAdjustManager",null,[598,2]);class Ag extends Ob.a{constructor(I,pa,lb){lb=void 0===lb?null:lb;super();this.CSa=this.OFc=this.Cnb=this.shb=null;this.$=I;this.kdb=new Ji(I);this.LPa=new bl(this.$);this.QYa=new zh(this.$.oa.ta,this.$,void 0,void 0,this.LPa);this.bcj(I,lb);this.bta=new fi(this.CSa,this.kdb,this.QYa);this.Ole=
new qk(I,this.bta,pa,this.QYa);jd.EwaSettings.Na(230)&&(this.OFc=new Ue(I,this));ea.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}Xnc(I){this.bta.Xnc(I)}WVc(I){this.bta&&this.bta.WVc(I)}get pva(){return this.CSa}get HAa(){return this.kdb}get Xha(){return this.bta}dPa(I,pa){this.CSa.dPa(I,pa)}wAe(I){this.CSa.wAe(I)}o5a(I,pa){this.kdb.o5a(I,void 0===pa?"":pa)}dispose(){this.OFc&&(this.OFc.dispose(),this.OFc=null);this.LPa&&this.LPa.dispose();this.QYa.dispose();this.Ole&&(this.Ole.dispose(),
this.Ole=null);this.bta&&(this.bta.dispose(),this.bta=null);this.kdb.dispose();this.kdb=null;this.CSa.dispose();this.CSa=null;this.shb&&(this.shb.dispose(),this.shb=null);this.Cnb&&(this.Cnb.dispose(),this.Cnb=null);this.$=null;super.dispose()}O4b(){this.bta.qfk()}static xAc(I){let pa=0;for(const lb of I){if(2==lb)return 2;1==lb&&(pa=1)}return pa}bcj(I,pa){this.CSa=new Bd(this.QYa,this.kdb);pa?Object(Nb.a)(ce,pa)?this.dPa(pa,Object(Bb.a)(ce,pa).JS):Object(Nb.a)(S,pa)?this.dPa(pa,Object(Bb.a)(S,pa).JS):
this.dPa(pa,0):(this.shb=new S(I),this.Cnb=new ce(I),this.dPa(this.shb,this.shb.JS),this.dPa(this.Cnb,this.Cnb.JS))}}Object(za.a)(Ag,"MergeSuspensionManager",Ob.a,[573,2]);class Jk extends je.a{constructor(I){super();this.pj=I;this.sn()}create(){ea.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.dl(this.pj.qa.zh(343)||this.pj.qa.Rh(343,new Ag(this.pj,uf.a.instance)))}static Ga(I){ea.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");I.qa.Rh(344,new Jk(I))}}Object(za.a)(Jk,
"MergeSuspensionFactory",je.a,[]);class Kk extends je.a{constructor(I){super();this.$=I;this.sn()}create(){dh.kWd()?Yf.TaskExtensions.$e(Object(Wf.d)(Fc.a.resolve(Gc.Od,{va:this.gi})),I=>{Yf.TaskExtensions.$e(I.result.HUg(),pa=>{this.Wlf(pa.result)},this.$.ya,3)},this.$.ya,3):this.Wlf(!0)}Wlf(I){this.dl(this.$.qa.zh(458)||this.$.qa.Rh(458,new dh(I)))}static Ga(I){I.qa.Rh(459,new Kk(I))}}Object(za.a)(Kk,"LineageCatchUpExperimentManagerFactory",je.a,[]);class rk extends je.a{constructor(I){super();
this.$=I;this.sn()}create(){this.bjk(()=>eb.Ga(this.$))}static Ga(I){I.qa.Rh(50,new rk(I))}bjk(I){I=Object(Xe.a)(this.$.qa,183,I);this.dl(I)}}Object(za.a)(rk,"TaskPaneManagerFactory",je.a,[]);const zl=Object(Qf.b)("Common.App.Rename.IRenamedFileChecker"),cl=Object(Qf.c)(zl),Al=Object(Qf.b)("Common.App.Rename.IRenameFlyoutActor"),sk=Object(Qf.c)(Al),dl=Object(Qf.b)("Common.App.Rename.IRenameDialogActor"),Bl=Object(Qf.c)(dl);var Lk=a(539);const el=Object(Qf.b)("Common.ISessionStatus");var fl=a(698);
const Cl=Object(Qf.b)("Common.App.Rename.RenameDialogFactory"),Si=Object(Qf.c)(Cl);var fk=a(608),Ql=a(1212);const Mk=Object(Qf.c)(Ql.a);var ej=a(190);class li{constructor(I,pa,lb){this.pWg=this.qWg=this.rWg=!1;this.bXg=!I&&!pa;this.cXg=!I&&!lb;this.bXg||this.cXg||(this.rWg=!I,this.qWg=!pa,this.pWg=!lb)}}Object(za.a)(li,"RenameDisabledDialogInfo",null,[]);class jk extends ej.a{constructor(I,pa,lb,hc,Xc){super();this.Wxe=[];this.iEb=new li(I,pa,lb);this.MHb=hc;this.AEb=Xc;this.fl="RenameDisabledDialog";
this.Oh=0;this.si(1,Object(lg.a)("DialogClose"));this.hJk();this.srk()}hJk(){if(this.iEb.bXg){let I;I=this.MHb?this.AEb?Object(lg.a)("RenameFileRenameReadOnlyRecommended"):Object(lg.a)("RenameFileRenameNotEveryoneSupportsRename"):Object(lg.a)("RenameFileRenameDisabledCoauthFull");this.aXg(I)}else this.iEb.cXg?this.aXg(Object(lg.a)("RenameFileRenameDisabledPermissionFull")):this.Hzh();this.gua(this.Wxe)}aXg(I){Array.add(this.Wxe,I)}Hzh(){const I=[];this.iEb.rWg||Array.add(I,Object(lg.a)("RenameFileRenameDisabledSignIn"));
this.iEb.qWg||Array.add(I,Object(lg.a)("RenameFileRenameDisabledPermission"));this.iEb.pWg||Array.add(I,Object(lg.a)("RenameFileRenameDisabledCoauth"));0<I.length&&Array.add(this.Wxe,I)}}Object(za.a)(jk,"ReactRenameDisabledDialogBase",ej.a,[]);class gl extends jk{constructor(I,pa,lb,hc,Xc){super(I,pa,lb,hc,Xc)}srk(){this.Orb(Object(lg.a)("RenameFileRenameDisabledTitle"),null,null,null,null,null)}}Object(za.a)(gl,"RenameDisabledDialog",jk,[]);class tk{constructor(I,pa,lb){this.WTa=0;this.zma=(hc,Xc,
Gd,ae,we)=>{if(1===Gd)return this.$f.$k(od.a.renameFile,1);hc=Qa.a.Jz(this.wsa.Nv);we=(0,we.getNewDocumentTitle)();we.length>this.WTa&&(we=we.substr(0,this.WTa));if(32!==this.$f.Uj(od.a.renameFile,2,we))return this.p9(hc),8;this.p9(we);this.Yi.Aia(wg.AFrame.CBd,!1);return 32};this.$f=I;this.wsa=pa;this.Yi=lb}initialize(I){if(!this.$f||!this.wsa)return!1;this.WTa=I;this.ko();return!0}ko(){this.$f.Uh(od.a.zma,Vg.a.frame,this.zma)}p9(I){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(I))}static vNd(){return new tk(Aa.AFrameworkApplication.xh,
Aa.AFrameworkApplication.iu,Yh.FocusManager.instance())}}Object(za.a)(tk,"ReactRenameUIHandler",null,[628]);var hl=a(702),yj=a(110),uk=a(618),il=a(875),Ij=a(491),Vj=a(59);class gk{constructor(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf,hg){this._initialized=!1;this._element=null;this.WTa=0;this.xkd=this.fdd=!1;this.$f=I;this.Z8c=pa;this.kl=lb;this.bK=hc;this.wsa=Xc;this.DYe=Gd;this.rkc=ae;this.aKe=we;this.Ska=Re;this.vcb=lf;this.ged=hg}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(I,
pa,lb){if(!(this.$f&&this.wsa&&this.DYe&&this.rkc&&this.aKe&&pa)||0>=I)return!1;this._element=pa;this._element.title=lb;this._element.setAttribute(Ij.a.fk,Ij.a.KF);this._element.setAttribute("Unselectable","on");this.WTa=I;this.cF();return this._initialized=!0}cF(){this.Z8c&&(this.Z8c.xa(vd.a.blur,this._element,Object(Uc.a)(this,this.onBlur,"onBlur")),this.Z8c.xa(vd.a.paste,this._element,Object(Uc.a)(this,this.onPaste,"onPaste")));this.kl.xa(vd.a.Wi,this._element,Object(Uc.a)(this,this.onKeyDown,
"onKeyDown"));this.bK.xa(vd.a.Bj,this._element,Object(Uc.a)(this,this.onPointerDown,"onPointerDown"));this.bK.xa(vd.a.jp,this._element,Object(Uc.a)(this,this.Ho,"onPointerUp"))}onBlur(){this.isActive&&!this.fdd&&(this.aKe(this._element),this.Iif(),this.bCd(!1));return this.fdd=!1}onPaste(){ea.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(I){return this.isActive?this.nXj(I):this.oXj(I)}nXj(I){let pa=!1;switch(I.La.keyCode){case Sys.UI.Key.enter:this.Iif();
this.bCd(this.vcb||this.ged);pa=!0;break;case Sys.UI.Key.esc:this.Lme(),this.bCd(this.vcb||this.ged),pa=!0}return pa}oXj(I){let pa=!1;switch(I.La.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.I3g(this.ged),this.isActive&&this.rkc(this._element),pa=!0}return pa}onPointerDown(){this.isActive||(this.I3g(!1),this.isActive&&(this._element.focus(),this.rkc(this._element),this.xkd=!0));return!1}Ho(){return this.xkd?(this.rkc(this._element),this.xkd=!1,!0):!1}xpb(){return 32===this.$f.$k(od.a.renameFile,
1)}Iif(){const I=Qa.a.Jz(this.wsa.Nv);let pa=this._element.innerText.trim();pa.length>this.WTa&&(pa=pa.substr(0,this.WTa));pa!==I&&""!==pa?32!==this.$f.Uj(od.a.renameFile,2,pa)?this.Lme():this.p9(pa):this.Lme()}Lme(){this.p9(Qa.a.Jz(this.wsa.Nv))}p9(I){this._initialized&&(this._element.innerText=I,this.DYe())}I3g(I){this.xpb()?this.isActive||(I&&(this.fdd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Ij.a.fk,
Ij.a.Bsd),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,yj.a.mtf),this.Ska&&this.Ska.execute(pa=>{pa.eBg(!0)}),I&&this._element.focus(),ea.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.$f.$k(od.a.syb,2)}bCd(I){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Ij.a.fk,Ij.a.KF);Sys.UI.DomElement.removeCssClass(this._element,yj.a.mtf);this.Ska&&this.Ska.execute(pa=>{pa.eBg(!1)});
I&&(this._element.blur(),this._element.focus())}static BJ(){uk.a.BJ(Aa.AFrameworkApplication.isRtl)}static vNd(){return new gk(Aa.AFrameworkApplication.xh,il.a.instance,ie.a.instance,Ac.a.instance,Aa.AFrameworkApplication.iu,gk.BJ,Vj.a.LAk,Vj.a.RYh,Object(hl.a)(),vg.a.io,vg.a.Cm)}}Object(za.a)(gk,"RenameUIHandler",null,[628]);class Rj{static get instance(){return Aa.AFrameworkApplication.ra.$g.Iw?Rj.Va||(Rj.Va=tk.vNd()):Rj.Va||(Rj.Va=gk.vNd())}}Rj.Va=null;Object(za.a)(Rj,"RenameUIHandlerFactory",
null,[]);var vk=a(204);class hk{constructor(){this.gLj=this.aLj=this.Ibi=null}}Object(za.a)(hk,"RenameMruEntryProperties",null,[]);var Nk=a(790),kk;(function(I){I[I.unknown=-1]="unknown";I[I.success=0]="success";I[I.xwl=1]="renameInvalidFileName";I[I.wwl=2]="renameInCoauthNotSupported";I[I.ywl=3]="renameNotSupportedInViewMode";I[I.dwl=4]="permissionDenied";I[I.Qwl=5]="serverCommunicationFailure";I[I.Aol=6]="fileNameTooLong"})(kk||(kk={}));Object(za.b)("CommonOperationResult",kk);class Dl{constructor(I,
pa){this.fileNameCandidate=I;this.disableFailedActionDialog=void 0===pa?!1:pa}}Object(za.a)(Dl,"RenameActionData",null,[]);class zj{constructor(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf,hg,Wg){this.OVb=()=>Rj.instance.initialize(Aa.AFrameworkApplication.Wyc,Aa.AFrameworkApplication.TYa,Aa.AFrameworkApplication.Ike||Object(lg.a)("RenameFileTooltip"))?32:8;this.syb=()=>{const mg=this.edl(),Xg=this.owh();ea.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Ocb,Xg,mg,this.MHb);new gl(this.Ocb,!Xg,!mg,this.MHb,this.AEb());return 32};this.renameFile=(mg,Xg,hi,Nj,yi)=>{if(1===hi)return this.xpb();if(!Aa.AFrameworkApplication.qyc)return 8;if(8===this.xpb())return this.un.$k(od.a.syb,2),8;this.Yia&&this.Yia.n4c(!1);ea.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");mg=!1;yi instanceof Dl&&(mg=yi.disableFailedActionDialog,yi=yi.fileNameCandidate);Aa.AFrameworkApplication.qyc(yi,Object(Uc.a)(this,this.A2b,"onRenameFileSuccess"),mg?this.YOj:this.k_j);
Aa.AFrameworkApplication.drk=!0;return 32};this.YOj=mg=>{ea.ULS.sendTraceTag(507655632,203,15,"OnAutoRenameFileFailure: {0}",{["Result"]:null!==mg&&void 0!==mg?mg:-1});this.Yia&&this.Yia.n4c(!0)};this.k_j=mg=>{ea.ULS.sendTraceTag(507655631,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==mg&&void 0!==mg?mg:-1});const Xg=new ej.a;Xg.Oh=0;switch(mg){case 1:ea.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Xg.iCa(Object(lg.a)("RenameFileInvalidNameTitle"),Object(lg.a)("RenameFileInvalidName"),
null);break;case 6:ea.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Xg.iCa(Object(lg.a)("RenameFileInvalidNameTitle"),Object(lg.a)("RenameFileNameTooLong"),null);break;default:ea.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==mg&&void 0!==mg?mg:-1}),Xg.iCa(Object(lg.a)("RenameFileGenericErrorTitle"),Object(lg.a)("RenameFileGenericError"),null)}Aa.AFrameworkApplication.ND().execute(hi=>{hi.sendMessage(ib.a.owi,{["FailureMessage"]:kk[mg]})});
this.XJg();this.Yia&&this.Yia.n4c(!0)};this.Oik=(mg,Xg,hi)=>{if(1===hi)return this.xpb();if(!Aa.AFrameworkApplication.xZa)return 8;Aa.AFrameworkApplication.xZa(Object(Uc.a)(this,this.UQc,"onRefreshFilenameSuccess"),Object(Uc.a)(this,this.TQc,"onRefreshFilenameFailure"),!1);return 32};this.lOc=(mg,Xg,hi,Nj,yi)=>{if(1===hi)return Aa.AFrameworkApplication.ea.ka("UiHostSupportsMoveToFolder")?this.xpb():8;if(2===hi){if(!Aa.AFrameworkApplication.lOg)return Wa.Health.instance.recordKpiFailure("MoveToFolder",
"Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!yi)return Wa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(yi[Rb.a.dkj])if(yi[Rb.a.J8g])if(mg=yi[Rb.a.J8g].toLowerCase(),Xg=Aa.AFrameworkApplication.ea.ka("UiHostSupportsDocRebootFeatures"),hi=Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Xg&&Aa.AFrameworkApplication.AV&&hi){const Li={};Li[Rb.a.G6a]="1";Li[Rb.a.documentUrl]=mg;Li[Rb.a.reason]=
Nk.a.saveAs;Wa.Health.instance.recordKpiSuccess("MoveToFolder",null);Aa.AFrameworkApplication.ND().execute(zi=>{zi.sendMessage(ib.a.E5,Li)})}else if(!Aa.AFrameworkApplication.AV&&hi)Wa.Health.instance.recordKpiSuccess("MoveToFolder",null),Vj.a.Em(mg,Vj.a.y3(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Wa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Wa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Aa.AFrameworkApplication.xZa(Object(Uc.a)(this,
this.UQc,"onRefreshFilenameSuccess"),Object(Uc.a)(this,this.TQc,"onRefreshFilenameFailure"),!1),Aa.AFrameworkApplication.lOg(),Wa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.UQe=I;this.$f=pa;this.f$c=lb;this.AI=hc;this.Ocb=Xc;this.owh=Gd;this.MHb=ae;this.O0e=we;this.Ksh=Re;this.AEb=lf;this.Ea=hg;this.Jsh=Wg;this.GUa=new fk.a(()=>this.VWi())}ko(){Aa.AFrameworkApplication.ra&&Aa.AFrameworkApplication.ra.$g.Iw||this.un.Uh(od.a.OVb,Vg.a.frame,this.OVb);this.un.Uh(od.a.syb,Vg.a.frame,
this.syb);this.un.Uh(od.a.renameFile,Vg.a.frame,this.renameFile);this.un.Vk(od.a.Xyc,Vg.a.frame,this.Oik,64);this.un.Vk(od.a.lOc,Vg.a.frame,this.lOc,64);this.un.Uh(od.a.dca,Vg.a.frame,Object(Uc.a)(this,this.dca,"moveToFolder"));(Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||Aa.AFrameworkApplication.ra&&(Aa.AFrameworkApplication.ea.ka("PostMessageEmbedded")||Aa.AFrameworkApplication.ea.ka("IsJsApi"))&&Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&Aa.AFrameworkApplication.ND().execute(I=>{I.kr(ib.a.Feg);I.pq(ib.a.Feg,zj.ohk);I.kr(ib.a.KHd);I.pq(ib.a.KHd,zj.mhk)})}xpb(){return 0===this.Jsh.ZLf()?32:8}edl(){return this.VI?this.MHb?this.VI.msf:this.VI.ORb:!0}VWi(){return this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",!1)?Eg.a.instance.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"):null}A2b(I,pa){I?0!==I.OperationResult?this.vQf(I.OperationResult):(this.aCk(pa,I.NewName),
this.L8k(I,Object(Uc.a)(Aa.AFrameworkApplication.ra.$g,Aa.AFrameworkApplication.ra.$g.H7g,"updateOpenInClientDocumentUrl")),Aa.AFrameworkApplication.ea.ka("DocumentNameInJewelInfoMenuIsEnabled")&&Aa.AFrameworkApplication.ra.aC(),this.Ksh.$5g()):this.vQf(5);this.Yia&&this.Yia.n4c(!0)}aCk(I,pa){const lb={};lb[Rb.a.pwi]=pa;I.sendMessage(ib.a.KHd,lb)}L8k(I,pa){this.X8k(I);Aa.AFrameworkApplication.Yvc=I.DirectInvokeDavUrl;pa=pa(I.EditDocInClientUrl);const lb=new hk;lb.gLj=this.AI.Nv;lb.Ibi=pa;lb.aLj=I.EditDocInClientUrl;
this.un.Uj(od.a.renameMostRecentlyUsedFileEntry,2,lb)}vQf(I){switch(I){case 1:I=new ej.a,I.Oh=0,I.xW(Object(lg.a)("RenameFileInvalidNameTitle"),Object(lg.a)("RenameFileInvalidName"),null),this.XJg()}}X8k(I){this.AI.Nv=zj.cJh(this.AI.Nv,I.NewName);I.BreadcrumbFolderName&&(this.AI.breadcrumbFolderName=I.BreadcrumbFolderName);I.BreadcrumbFolderUrl&&(this.AI.breadcrumbFolderUrl=I.BreadcrumbFolderUrl);this.O0e(I.NewName)}dca(I,pa,lb,hc,Xc){var Gd,ae;if(1===lb)return Aa.AFrameworkApplication.ea.ka("UiHostSupportsMoveToFolder")?
32:8;if(2===lb){const we={};I=Aa.AFrameworkApplication.AV;pa=Aa.AFrameworkApplication.ea.ka("UiHostSupportsDocRebootFeatures");I=(!I||I&&pa)&&Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);we[Rb.a.ZYk]=I;Xc&&Xc.MoveButtonClickedTime&&(we[Rb.a.HIj]=Xc.MoveButtonClickedTime.getTime());I={};if(null===(Gd=Aa.AFrameworkApplication.ea)||void 0===Gd?0:Gd.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SuperPickerIntegrationForCreateACopyAndMove",
!1))I[Rb.a.titleText]=Object(lg.a)("PickerMoveTitle");Aa.AFrameworkApplication.ea.ka("DarkModeSupportInMoveFilePickerEnabled")&&Object(hj.a)("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(I[Rb.a.iwg]="Dark");if(null===(ae=Aa.AFrameworkApplication.ea)||void 0===ae?0:ae.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8833612_SuperPickerCustomizationForMoveToFolderEnabled"))we[Rb.a.gwg]=I;Aa.AFrameworkApplication.ND().execute(Re=>{Re.sendMessage(ib.a.dca,we)});
ea.ULS.sendTraceTag(507302554,306,50,"Move File Picker opened");if(Xc&&Xc.MoveButtonClickedTime){if(Gd=vk.a.yy())Xc=(new Date).getTime()-Xc.MoveButtonClickedTime.getTime(),Gd.set("MovePostDuration",Xc.toString());Wa.Health.instance.recordKpiUsage("MoveToFolder",db.b.FailureBased,"smartfio",Gd)}return 32}return 8}JPk(I,pa){return I&&pa?I!==this.AI.breadcrumbFolderName||pa!==this.AI.breadcrumbFolderUrl:!1}UQc(I,pa){I&&(I.NewName!==Qa.a.Jz(this.AI.Nv)||this.JPk(I.BreadcrumbFolderName,I.BreadcrumbFolderUrl))&&
this.A2b(I,pa)}TQc(){}XJg(){this.O0e(Qa.a.Jz(this.AI.Nv))}get un(){return this.$f.value}get Yia(){return this.GUa.value}get VI(){return this.f$c.value}static get instance(){return zj.Va||(zj.Va=zj.dxa())}static dxa(){return new zj(Aa.AFrameworkApplication.ZLa,new fk.a(()=>Aa.AFrameworkApplication.xh),new fk.a(()=>Aa.AFrameworkApplication.VI),Aa.AFrameworkApplication.iu,Aa.AFrameworkApplication.limitedEdit,()=>Aa.AFrameworkApplication.userCanRename,Aa.AFrameworkApplication.YVc,Object(Uc.a)(Rj.instance,
Rj.instance.p9,"updateTitle"),Object(Qf.a)(cl),()=>Aa.AFrameworkApplication.isReadOnlyRecommended,Aa.AFrameworkApplication.ea,Object(Qf.a)(Mk))}static cJh(I,pa){I=Qa.a.Maa(I);return pa+I}static ohk(I){const pa=I.Values[Rb.a.jpj];ea.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",pa);pa?Aa.AFrameworkApplication.xh.Uj(od.a.lOc,2,I.Values):Wa.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static mhk(I){Aa.AFrameworkApplication.xh.Uj(od.a.renameFile,
2,I.Values.NewName)}}zj.Va=null;Object(za.a)(zj,"RenameActor",null,[]);a(693);class Rl{}Object(za.a)(Rl,"ActivityEventName",null,[]);class jl{}jl.compatMode="CompatMode";Object(za.a)(jl,"ActivityEventReason",null,[]);class Ok{constructor(I,pa){this.$f=I;this.xbb=pa}ko(){this.$f.Uh(od.a.QWg,Vg.a.frame,Object(Uc.a)(this,this.WSk,"showRenameDialogAction"))}WSk(I,pa,lb){I=32;if(1===lb)return Gb.SessionStatusManager.instance.Vmb||Aa.AFrameworkApplication.wha?8:32;2===lb&&(32!==this.$f.$k(od.a.renameFile,
1)?(this.$f.$k(od.a.syb,2),I=8):32===this.$f.$k(od.a.X9b,1)?this.$f.$k(od.a.X9b,2):this.xbb.value.create().Rte());return I}}Object(za.a)(Ok,"RenameDialogActor",null,[615]);var kl=a(242);class lk{constructor(I,pa,lb){this.dialog=null;this.$f=I;this.AI=pa;this.bgc=lb}XVi(){const I={};I.nameInputProps={["type"]:"AppInputProps",["id"]:lk.KDd,["label"]:Object(lg.a)("RenameDialogLabel"),["value"]:Qa.a.Jz(this.AI.Nv),["maxLength"]:this.bgc};return I}Rte(){const I={["id"]:"RenameDialog",["bodyControls"]:this.XVi()};
this.dialog=new kl.a(!1,!1,!0);this.dialog.Oh=1;this.dialog.fl="RenameDialog";this.dialog.initializeAndShow(Object(lg.a)("RenameDialogTitle"),Object(Uc.a)(this,this.crk,"renameDialogHandler"),I)}crk(I,pa){pa&&1===I&&pa[lk.KDd]&&(I=Qa.a.Jz(this.AI.Nv),pa=(pa[lk.KDd]||"").trim(),pa!==I&&""!==pa&&this.$f.Uj(od.a.renameFile,2,pa))}}lk.KDd="txtDocumentName";Object(za.a)(lk,"RenameDialog",null,[631]);class ll{constructor(I){this.wsa=null;this.bgc=0;this.$f=I;this._initialized=!1}initialize(I,pa){this.wsa=
I;this.bgc=pa;this._initialized=!0}create(){return this._initialized?new lk(this.$f,this.wsa,this.bgc):null}}Object(za.a)(ll,"RenameDialogFactory",null,[614]);var Sl=a(97);class Wj{constructor(I,pa){this.$f=I;this.Yi=pa}ko(){this.$f.Uh(od.a.X9b,Vg.a.frame,Object(Uc.a)(this,this.XSk,"showRenameFlyoutAction"))}HUh(){return hj.d("setDocumentTitleFlyoutOpened")&&Aa.AFrameworkApplication.ra.$g.Iw}XSk(I,pa,lb){if(1===lb)return this.HUh()?32:8;Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DocumentInlineRenameEnabled",
!1)?(this.Yi.b8(wg.AFrame.CBd,!1),appChrome.getHeaderApi().then(hc=>{hc.focusDocumentTitle()})):appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}dBh(){Wj.Dsj&&Aa.AFrameworkApplication.RLa&&Sl.TaskManager.instance.lm(new Fb.a(5,1,5E3,()=>{32===this.$f.$k(od.a.X9b,1)&&this.Yi&&this.Yi.currentScope.name===wg.AFrame.I0&&(Xb.a("RenameFloatieShownOnNewDocumentLoad",!0),this.$f.$k(od.a.X9b,2))}))}static get Dsj(){Wj.Ahc&&null!=Wj.Ahc||($b.a.GA("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),
Wj.Ahc=Aa.AFrameworkApplication.ea?Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Wj.Ahc}}Wj.Ahc=null;Object(za.a)(Wj,"RenameFlyoutActor",null,[613]);class Pk{constructor(I,pa,lb,hc,Xc){this.f$c=Xc;this.VQe=lb;this.UQe=hc;this.rwh=I;this.AEb=pa}get VI(){return this.f$c.value}ZLf(){if(!this.UQe())return 5;if(this.AEb())return 1;if(this.VI){if(this.VQe&&!this.VI.msf)return 3;if(!this.VQe&&!this.VI.ORb)return 4}return this.rwh()?
0:2}}Object(za.a)(Pk,"RenameProps",null,[607]);var El=a(107);class mk{constructor(I,pa,lb,hc,Xc,Gd){this.AF=!1;this.Ofd=new El.a;this.Fbb=pa;this.$W=lb;this.bkh=hc;this.Ea=Xc;this.p_e=Gd}enable(){this.AF||(this.$5g(),this.ewe(),this.AF=!0)}generateKey(I,pa,lb){return String.format("{0}/{1}/{2}",lb,I,pa)}RPi(){const I=Qa.a.Jz(this.Fbb().Nv);return this.generateKey(this.Fbb().breadcrumbFolderName,this.Fbb().breadcrumbFolderUrl,I)}SPi(I,pa,lb){return I&&pa?this.generateKey(I,pa,lb):lb}qgi(I,pa,lb){return I&&
I!==this.Fbb().breadcrumbFolderName||pa&&pa!==this.Fbb().breadcrumbFolderUrl?!0:lb!==Qa.a.Jz(this.Fbb().Nv)}$5g(){const I=this.RPi();this.Ofd.ga(I,new Date)}vde(I){this.TNk(I)&&this.g2e(I)}TNk(I){const pa=this.bkh();return pa?this.p_e&&this.p_e.HXb||!pa.B_f||!Aa.AFrameworkApplication.xZa?(this.JZg(I),this.AF=!1):!0:!1}csg(I,pa,lb,hc){const Xc=this.qgi(I,pa,lb),Gd=this.SPi(I,pa,lb);I=(()=>this.Ofd.tj(Gd))().returnValue;Xc&&!I&&(this.wQf(hc),ea.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",
this.g4d));Xc||this.Ofd.ga(Gd,this.$W())}}Object(za.a)(mk,"ARenamedFileChecker",null,[576]);class gi extends mk{constructor(I,pa,lb,hc,Xc,Gd,ae,we){super(I,pa,lb,hc,Xc,Gd);this.mRf=(Re,lf)=>{lf&&lf.b1b&&lf.eOj&&(lf.Gpb("BreadcrumbDocName")||lf.Gpb("BreadcrumbFolderName")||lf.Gpb("BreadcrumbFolderUrl")||lf.Gpb("DirectInvokeDAVUrl")||lf.Gpb("EditDocInClientUrl"))&&(ea.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.g4d),this.vde(lf))};this.tXe=Xc;this.Ish=ae;this.Xnh=we}get g4d(){return"RenamedFileCheckerUsingSettingsRefresh"}ewe(){this.tXe.nqd(this.mRf)}JZg(){this.tXe.NGg(this.mRf)}g2e(I){if(I&&
I.b1b){const pa=I.b1b;this.csg(pa.Ya("BreadcrumbFolderName"),pa.Ya("BreadcrumbFolderUrl"),pa.Ya("BreadcrumbDocName"),I)}}wQf(I){const pa={OperationResult:0,classId:1};I=I.b1b;pa.BreadcrumbFolderName=I.Ya("BreadcrumbFolderName");pa.BreadcrumbFolderUrl=I.Ya("BreadcrumbFolderUrl");pa.DirectInvokeDavUrl=I.Ya("DirectInvokeDAVUrl");pa.EditDocInClientUrl=I.Ya("EditDocInClientUrl");I=I.Ya("BreadcrumbDocName");pa.NewName=Aa.AFrameworkApplication.AIa?I:Qa.a.Jz(I);this.Xnh.execute(lb=>{this.ehj(pa,lb)})}ehj(I,
pa){this.Ish().A2b(I,pa)}}Object(za.a)(gi,"RenamedFileCheckerUsingSettingsRefresh",mk,[]);class ml extends mk{constructor(I,pa,lb,hc,Xc,Gd,ae,we,Re,lf){super(I,lb,hc,Xc,Gd,Re);this.xGb=this.Xlc=null;this.Qrh=pa;this.$f=ae;this.vk=we;lf&&lf.execute(hg=>{this.ilk(hg)})}get g4d(){return"RenamedFileCheckerUsingTask"}ilk(I){this.Xlc=I;this.Xlc.c6e(Object(Uc.a)(this,this.gUb,"handleVisibilityChange"))}gUb(I,pa){!this.AF||0!==pa.newState&&1!==pa.newState||this.xGb||(this.ewe(),this.vde(this.xGb))}ewe(){this.xGb=
new Fb.a(3,2,this.Qrh(),Object(Uc.a)(this,this.vde,"performRenameFileCheckTick"),89);this.vk.lm(this.xGb)}JZg(I){this.vk.Ux(I)}g2e(I){this.Xlc&&2===this.Xlc.bnl?this.smk(I):Aa.AFrameworkApplication.xZa(Object(Uc.a)(this,this.UQc,"onRefreshFilenameSuccess"),Object(Uc.a)(this,this.TQc,"onRefreshFilenameFailure"),!0)}smk(I){this.vk.Ux(I);this.xGb=null}UQc(I){I&&this.csg(I.BreadcrumbFolderName,I.BreadcrumbFolderUrl,I.NewName,null)}wQf(){this.$f.$k(od.a.Xyc,2)}TQc(){}}Object(za.a)(ml,"RenamedFileCheckerUsingTask",
mk,[]);class Fl{constructor(){this.Ea=this.Vh=null;this.fL=()=>{const I=Aa.AFrameworkApplication.ra.$g.Iw;Aa.AFrameworkApplication.ZLa()&&Rj.instance.initialize(Aa.AFrameworkApplication.Wyc,I?null:Aa.AFrameworkApplication.TYa,I?null:Aa.AFrameworkApplication.Ike||Object(lg.a)("RenameFileTooltip"))&&(this.Vh.register(Pk,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Ii(()=>new Pk(()=>Aa.AFrameworkApplication.userCanRename,()=>Aa.AFrameworkApplication.isReadOnlyRecommended,Aa.AFrameworkApplication.YVc,
Aa.AFrameworkApplication.ZLa,new fk.a(()=>Aa.AFrameworkApplication.VI))).Ai(),zj.instance.ko(),this.Ea.ka("RenameDialogIsEnabled")&&(Object(Qf.a)(Si).initialize(Aa.AFrameworkApplication.iu,Aa.AFrameworkApplication.Wyc),Object(Qf.a)(Bl).ko()),Object(Qf.a)(sk).ko(),Aa.AFrameworkApplication.YVc&&Object(Qf.a)(cl).enable(),Object(Qf.a)(sk).dBh())}}get name(){return"Common.App.RenameFile"}co(I){this.Vh=I;this.Ea=Aa.AFrameworkApplication.ea;this.Vh.register(Ok,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Ii(()=>
new Ok(Aa.AFrameworkApplication.xh,Object(Qf.e)(Cl))).Ai();this.Vh.register(ll,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Ii(()=>new ll(Aa.AFrameworkApplication.xh)).Ai();this.Vh.register(576,"Common.App.Rename.IRenamedFileChecker").Ii(()=>this.y$h()).Ai();this.Vh.register(Wj,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Ii(()=>new Wj(Aa.AFrameworkApplication.xh,Yh.FocusManager.instance())).Ai()}y$h(){if(this.Ea.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const I=
Object(fl.b)();if(I&&I.b3f)return new gi(()=>I.Ij("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>Aa.AFrameworkApplication.iu,()=>new Date,()=>Aa.AFrameworkApplication.VI,I,Object(Qf.f)(el),()=>zj.instance,Object(Lk.a)())}return new ml(()=>this.Ea.Ij("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ea.Ij("RenamedFileCheckerPingIntervalInMs",12E4),()=>Aa.AFrameworkApplication.iu,()=>new Date,()=>Aa.AFrameworkApplication.VI,Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.xh,Aa.AFrameworkApplication.Np,
Object(Qf.f)(el),Object(Wh.a)())}init(){this.Ea.cy(this.fL)}dispose(){}}Object(za.a)(Fl,"PackageManager",null,[13,14]);var Qk=a(78),Rk=a(257);class Sk extends je.a{constructor(I){super();this.XAd=this.renameFileManager=null;this.$=I;this.sn()}create(){if(!this.XAd){const I=Rk.a.Eib(Mg.b(),this.ya,"Task","IRenameFileManager");this.XAd=I.task;const pa=Gc.pd.Ma()?Object(Wf.d)(Fc.a.resolve(Gc.pd,{va:this.gi})):Qk.GetServiceTaskFactory.create(this.$.qa,137,this.ya,this.gi),lb=Object(Wf.d)(Fc.a.resolve(Gc.eb,
{va:this.gi}));Yf.TaskExtensions.$e(Yf.TaskExtensions.Dq([lb,pa],this.ya),()=>{const hc=new gc(this.$,pa.result);this.$.qa.Rh(120,hc);I.setResult(hc)},this.ya,3)}this.XAd.continueWith(I=>{this.dl(I.result)})}dispose(){Xa.a.gh(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static Ga(I){I.qa.Rh(119,new Sk(I))}}Object(za.a)(Sk,"RenameFileManagerServiceFactory",je.a,[]);var Gl=a(1097);class nl extends je.a{constructor(){super();this.sn()}create(){this.dl(new Gl.a)}}Object(za.a)(nl,
"CommonUIJsServiceFactory",je.a,[]);var Ti=a(1213),wk=a(1197);class nk{}Object(za.a)(nk,"LokiTokenResult",null,[]);class Tk{constructor(I){this.Mic=I}INd(){const I=this.GQi();return I?Tk.VXb?new Promise((pa,lb)=>{this.Mic.continueWith(()=>{this.Mic.so||this.Mic.Jm?lb(Error.create("Error downloading auth library")):this.Mic.result.nF("Loki",I).then(hc=>{hc=Aa.AFrameworkApplication.ea.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.JQi():hc.IsSuccess&&hc.Token?Object.assign(new nk,{isSuccess:!0,token:hc.Token,
errorMessage:null}):Object.assign(new nk,{isSuccess:!1,token:null,errorMessage:JSON.stringify(hc)});pa(hc);return hc})})}):Promise.resolve(Object.assign(new nk,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new nk,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",wk.a.iFf())}))}JQi(){const I=Aa.AFrameworkApplication.ea.Ya("LokiUserDataSignature")||"";
return Object.assign(new nk,{isSuccess:!0,token:I,errorMessage:null})}GQi(){let I=null;const pa=wk.a.CAc();2===pa?I=Aa.AFrameworkApplication.ea.Ya("LokiAADAppId"):1===pa&&(I=Aa.AFrameworkApplication.ea.Ya("LokiMSAAppId"));return I}static get VXb(){return Aa.AFrameworkApplication.ea.ka("IsO365CommercialHost")||Aa.AFrameworkApplication.ea.ka("IsO365ConsumerHost")}}Object(za.a)(Tk,"LokiTokenManager",null,[575]);var Hl=a(615);class xk{get name(){return"Common.App.LivePersonaUtils"}init(){Object(Ti.a)()}dispose(){}co(I){I.register(Tk,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").Ai().Ii(()=>new Tk(Hl.a.Rw(Object(Xh.a)())))}static main(){Vb.a.instance.Jo(new xk)}}Object(za.a)(xk,"LivePersonaUtilsPackage",null,[13,14]);const Tl=Object(Qf.b)("Common.App.SaveStatus.SaveStatusUIHandler"),Il=Object(Qf.c)(Tl),Ul=Object(Qf.b)("Common.App.SaveStatus.ReactSaveStatusUIHandler"),Vl=Object(Qf.c)(Ul),ol=Object(Qf.b)("Common.App.SaveStatus.SaveStatusPostMessageHandler"),yk=Object(Qf.c)(ol);var ek=a(1214);class pl{constructor(I){this.xta=
this.pta=this.ola=this.Aea=null;this.zcd=this.Bbb=this.yfc=this.Dgc=this.aSe=this.PG=this.eU=!1;this.ujd=this.sSe=null;this.iSe=0;this.Ea=this.TEb=null;this.cea=I;this.tF=3;this.sEb=this.NEa=!0}initialize(I,pa,lb){this.Aea=this.bPd(I,pa);this.ola=Object(lg.a)("SavingStatus");this.pta=Object(lg.a)("ReadOnlyStatus");this.xta=Object(lg.a)("ReviewModeStatus");this.cea&&this.cea.execute(hc=>{hc.iqd(Object(Uc.a)(this,this.Ubc,"updateToSavingStatus"))});this.PG=!0;this.Ea=lb;this.yfc=this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",
!1);this.Bbb=this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",!1);return!0}Sra(I,pa){this.eU=I;this.tF=pa;this.o3(this.NEa)}o3(I){!this.NEa&&I&&(this.TEb=new Date);this.NEa=I;this.zcd=!1;I=null;3===this.tF&&(I=this.NEa?this.Aea:this.ola);this.Bbb&&this.Dgc&&(this.Aea=Object(lg.a)("SavedStatus"));this.trf(I)}n4c(I){!this.sEb&&I&&(this.TEb=new Date);this.sEb=I;this.zcd=!1;I=null;3===this.tF&&(I=this.sEb?this.Aea:this.ola);this.trf(I)}bPd(I,pa){return I?
String.format(Object(lg.a)("SavedToStatus"),Object(lg.a)("OneDriveName")):pa&&pa.length?String.format(Object(lg.a)("SavedToStatus"),pa):Object(lg.a)("SavedStatus")}Ubc(){this.o3(!1)}TNd(){switch(this.tF){case 1:return this.pta;case 2:return this.xta;default:return null}}getMode(){if(3!==this.tF)switch(this.tF){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.zcd?"FailedToSave":this.NEa&&this.sEb?"Saved":"Saving"}Tkj(I){return this.aSe===this.eU&&this.iSe===this.tF&&
this.sSe===I}pDd(I){appChrome.getHeaderApi().then(pa=>{pa.updateDocumentTitleStatus(this.eU,I,this.TNd(),this.TEb,this.NEa&&this.sEb,this.yfc||this.Bbb?pa.getHeaderSaveStatusIconProps(this.getMode(),!1):null);"Saved"===this.getMode()&&this.Bbb&&(this.kkd&&(window.clearTimeout(this.kkd),this.kkd=null),this.mkd&&(window.clearTimeout(this.mkd),this.mkd=null),this.kkd=window.setTimeout(()=>{pa.updateDocumentTitleStatus(this.eU,I,this.TNd(),this.TEb,this.NEa,this.yfc||this.Bbb?pa.getHeaderSaveStatusIconProps(this.getMode(),
!0):null)},500),this.Dgc&&(this.mkd=window.setTimeout(()=>{pa.updateDocumentTitleStatus(!0,I,this.TNd(),this.TEb,this.NEa,this.yfc||this.Bbb?pa.getHeaderSaveStatusIconProps(this.getMode(),!0):null)},3E3)));this.Dgc=!0;return null});this.ujd=null}trf(I){this.PG&&hj.c()&&!this.Tkj(I)&&(!this.Dgc&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.pDd(I):Vj.a.I6b()?(this.ujd&&ea.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.ujd=window.requestIdleCallback(()=>{this.pDd(I)})):window.requestAnimationFrame(()=>{this.pDd(I)}),this.aSe=this.eU,this.sSe=I,this.iSe=this.tF)}}Object(za.a)(pl,"ReactSaveStatusUIHandler",null,[599]);class ql{constructor(I,pa){this.Ew=null;this.Aea=Object(lg.a)("SavedStatus");this.ola=Object(lg.a)("SavingStatus");this.pta=Object(lg.a)("ReadOnlyStatus");this.xta=Object(lg.a)("ReviewModeStatus");this.Mgc=pa;this.cea=I;this.tF=3;this.HFa=!0}cF(){this.cea&&this.cea.execute(I=>{I.iqd(Object(Uc.a)(this,
this.Ubc,"updateToSavingStatus"))});this.Mgc.execute(I=>{this.Ew=I})}Sra(I,pa){this.tF=pa;3===pa?this.o3(this.HFa):2===pa?this.Xze(this.xta):this.Xze(this.pta)}Ubc(){this.o3(!1)}o3(I){this.HFa=I;this.Xze(this.HFa?this.Aea:this.ola)}Xze(I){this.Ew&&this.Ew.sendMessage(ib.a.y6k,this.l2h(I))}l2h(I){const pa={};pa.StatusText=I;return pa}}Object(za.a)(ql,"SaveStatusPostMessageHandler",null,[599]);var rl=a(136),Uk=a(69);class sl{constructor(I,pa,lb,hc){this.xta=this.pta=this.ola=this.Aea=null;this.VTa=
0;this.sO=this.jkd=this.lSa=this.D8c=this.aVa=null;this.gk=I;this.Ska=pa;this.cea=lb;this.Mq=hc;this.lQe=!0;this.eU=!1;this.tF=3;this.HFa=!0}initialize(I,pa){if(!this.gk)return!1;this.Aea=this.bPd(I,pa);this.ola=Object(lg.a)("SavingStatus");this.pta=Object(lg.a)("ReadOnlyStatus");this.xta=Object(lg.a)("ReviewModeStatus");this.cF();return!0}bPd(I,pa){return I?String.format(Object(lg.a)("SavedToStatus"),Object(lg.a)("OneDriveName")):pa&&pa.length?String.format(Object(lg.a)("SavedToStatus"),pa):Object(lg.a)("SavedStatus")}cF(){this.Ska&&
this.Ska.execute(I=>{I.aFh(Object(Uc.a)(this,this.Cnf,"createStatusAndModeElements"));I.UEh(Object(Uc.a)(this,this.BRk,"showHideSaveStatusElement"));I.Q2k&&this.Cnf(null,null)});this.cea&&this.cea.execute(I=>{I.iqd(Object(Uc.a)(this,this.Ubc,"updateToSavingStatus"))})}qF(){this.sO&&this.gk&&this.gk.MQ(this.sO)}BRk(I,pa){this.Sra("true"===pa,this.tF)}Sra(I,pa){this.eU=I;this.tF=pa;this.D8c&&(this.D8c.style.display=this.eU||3===this.tF||!this.aVa?"none":"");this.lSa&&(this.lSa.style.display=this.eU||
3===this.tF?"none":"",this.lSa.innerText=1===this.tF?this.pta:this.xta,this.lSa.title=1===this.tF?Object(lg.a)("ReadOnlyStatusTooltip"):Object(lg.a)("ReviewModeStatusTooltip"));this.jkd&&(this.jkd.style.display=this.eU||1===this.tF||!this.aVa&&!this.lSa?"none":"");this.sO&&(this.sO.style.display=this.eU||1===this.tF?"none":"",this.o3(this.HFa),this.sO.title=Object(lg.a)("SaveStatusTooltip"))}Cnf(I,pa){I=document.getElementById(yj.a.QSf);pa&&pa.Tgl||!I||""===this.Aea||""===this.ola||""===this.pta||
""===this.xta||(this.aVa=document.getElementById(yj.a.kqc),this.D8c=yj.a.QHa(I,"BreadcrumbAppModeDash","-",null,!1),this.lSa=yj.a.QHa(I,"BreadcrumbAppModeStatus",1===this.tF?this.pta:this.xta,null,!1),this.N6g(this.lSa),this.jkd=yj.a.QHa(I,"BreadcrumbSaveStatusDash","-",null,!1),this.sO=yj.a.QHa(I,"BreadcrumbSaveStatus",this.Aea,null,!1),this.N6g(this.sO),this.Sra(this.eU,this.tF))}Ubc(){this.o3(!1)}o3(I){this.HFa=I;this.qbl(this.HFa?this.Aea:this.ola)}qbl(I){!this.sO||3!==this.tF&&2!==this.tF||(this.lQe&&
!this.HFa?(this.VTa=this.sO.offsetWidth<this.VTa?this.VTa:this.sO.offsetWidth,this.K8k(this.ola),this.lQe=!1):this.sO.innerText=I)}N6g(I){I.style.direction=this.Mq?"rtl":"ltr";I.style.width="auto";I.style.textAlign=this.Mq?"right":"left";I.style.display=this.eU?"none":"";I.setAttribute("Unselectable","on")}K8k(I){this.sO&&(this.sO.style.width="",this.sO.innerText=I,this.VTa=this.sO.offsetWidth<this.VTa?this.VTa:this.sO.offsetWidth,I=rl.a.JE(this.sO),this.sO.style.width=this.VTa-Uk.a.BN(I.paddingLeft)-
Uk.a.BN(I.paddingRight)+1+"px")}}Object(za.a)(sl,"SaveStatusUIHandler",null,[599]);var Wl=a(109);class zk{constructor(){this.lkd=this.gjd=this.GUa=this.Vh=null;this.fL=()=>{const I=Aa.AFrameworkApplication.ea,pa=!!Aa.AFrameworkApplication.ra.$g&&4===Aa.AFrameworkApplication.ra.$g.qn;if(I.ka("WordEditorAutoSaveImprovementIsEnabled")||I.ka("PptEditorSaveStatusInHeaderEnabled")||pa&&I.ka("SimplifiedReactRibbonUxIsEnabled")||I.ka("ExcelSaveStatusInHeaderEnabled")||I.ka("VisioSaveStatusInHeaderEnabled"))Aa.AFrameworkApplication.ea.ka("PostMessageEmbedded")&&
Aa.AFrameworkApplication.hideHeaderEmbedded?(this.lkd=Object(Qf.a)(yk))&&this.lkd.cF():Aa.AFrameworkApplication.ra.$g.s4f||Aa.AFrameworkApplication.hideHeader||(Aa.AFrameworkApplication.ra.$g.Iw?(this.gjd=Object(Qf.a)(Vl))&&this.gjd.initialize(I.ka("IsSkyDrive"),I.Ya("HostNameToIncludeInSavedStatus"),Aa.AFrameworkApplication.ea):(this.GUa=Object(Qf.a)(Il))&&this.GUa.initialize(I.ka("IsSkyDrive"),I.Ya("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}co(I){this.Vh=I;Aa.AFrameworkApplication.ea.ka("PostMessageEmbedded")&&
Aa.AFrameworkApplication.hideHeaderEmbedded?this.Vh.register(ql,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ai().Ii(()=>new ql(Object(ek.a)(),Object(Lk.a)())):Aa.AFrameworkApplication.ra.$g.s4f||(Aa.AFrameworkApplication.ra.$g.Iw?this.Vh.register(pl,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ai().Ii(()=>new pl(Object(ek.a)())):this.Vh.register(sl,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ai().Ii(()=>
new sl(Wl.EventHandlerManager.instance,Object(hl.a)(),Object(ek.a)(),Aa.AFrameworkApplication.isRtl)))}init(){Aa.AFrameworkApplication.ea.cy(this.fL)}dispose(){this.GUa&&this.GUa.qF()}}Object(za.a)(zk,"PackageManager",null,[13,14]);class Ak{constructor(I,pa){this.BYe=this.Qdd=!1;this.$Na=(lb,hc)=>{(null===hc||void 0===hc?0:hc.PM)&&Ia.a.yKh([hc.PM])&&(this.B7b=!0)};this.$t=()=>{this.B7b=!1};this.hj=(lb,hc)=>{fg.b(hc)&&this.Sra(!0);this.B7b=!1};this.Dj=()=>{this.D1=this.$.D1;this.Sra()};this.Rqg=()=>
{this.o3()};this.Vpg=()=>{this.D1=this.$.D1};this.Y9d=()=>{Oc.f(this.$).za.Ax(this.Y9d);this.D1=this.$.D1};this.Yia=pa;this.$=I;this.$.userOperationManager.qw(this.Vpg);this.$.nr(this.Dj);this.$.fa.BFh(this.Rqg);this.$.fa.Nq(this.hj);this.$.Mnc(this.$Na);this.$.fa.BO(this.$t);this.Sra()}get Dwj(){return this.$.fa?this.$.fa.n7f:!1}get D1(){return this.Qdd}set D1(I){I?this.Qdd=!0:Oc.f(this.$)&&Oc.f(this.$).za&&(Oc.f(this.$).za.lba()?this.Qdd=!1:Oc.f(this.$).za.qy(this.Y9d));this.o3()}get B7b(){return this.BYe}set B7b(I){this.BYe=
I;this.o3()}dispose(){this.$&&(this.$.$r(this.Dj),this.$.PVc(this.$Na),this.$.userOperationManager&&this.$.userOperationManager.vu(this.Vpg),this.$.fa&&(this.$.fa.oqk(this.Rqg),this.$.fa.Lq(this.hj),this.$.fa.pQ(this.$t)),Oc.f(this.$)&&Oc.f(this.$).za&&Oc.f(this.$).za.Ax(this.Y9d))}Sra(I){I=!this.$.isEditMode||(void 0===I?!1:I);this.Yia.Sra(I,this.$.isEditMode?3:1);this.o3()}o3(){this.$.isEditMode&&this.Yia.o3(!this.D1&&!this.Dwj&&!this.B7b)}}Object(za.a)(Ak,"SaveStatusManager",null,[2]);class Bk extends je.a{constructor(I){super();
this.pj=I;this.sn()}create(){const I=Eg.a.instance;I.Dk("Common.App.SaveStatus.ISaveStatusUIHandler").execute(pa=>{const lb=new Ak(this.pj,pa);I.register(Ak,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Ai().Ii(()=>lb);pa=Object(Xe.a)(this.pj.qa,300,()=>I.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.dl(pa)})}static Ga(I){I.qa.Rh(299,new Bk(I))}}Object(za.a)(Bk,"SaveStatusFactory",je.a,[]);var Jl=a(1405),bk=a(601),Xj=a(675),Jj=a(496),Vk=a(436),
Xl=a(1216);class Kl{g$h(I,pa){if(I&&!(1>I.length)&&pa){var lb=Object.assign(new Vk.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.v7h(I,lb.ControlList);pa.push(lb)}}v7h(I,pa){const lb=Object.assign(new Xj.a,{ExternalId:"ContextCoauthors",LabelText:Object(lg.a)("PresenceMenuSectionTitle"),Menu:Object.assign(new Jj.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(pa,lb);pa=Object.assign(new Vk.a,{Title:"",ControlList:[]});Array.add(lb.Menu.MenuSectionList,
pa);this.K9h(I,pa.ControlList)}K9h(I,pa){for(let lb=0;lb<I.length;lb++){const hc=Object.assign(new Xl.a,{ExternalId:String.format("CoauthorPersona_{0}",lb),Command:"336231556",DisplayName:I[lb].userName,LabelText:I[lb].userName,ImageBackColor:I[lb].color,PersonaId:I[lb].email,IsAnonymous:I[lb].isAnonymous});Array.add(pa,hc)}}}Object(za.a)(Kl,"PresenceContextMenuSectionBuilder",null,[570]);const Yl=Object(Qf.b)("CommonUI.IBusinessBarEntryFactory");var tl=a(1217),Ck=a(668);class ul{constructor(I,pa,
lb,hc){this.oJe=this.Tda=this.Fq=this.gO=this.rka=null;this.pMh=()=>{this.Vkc.paf()};this.CD=Xc=>{1===Xc?(Ck.a.zia(),this.showDialog(Object(lg.a)("AuthenticationLostSigninInProgressMessage")),Aa.AFrameworkApplication.xh.$k(od.a.O2d,2)):(this.V8a(),Aa.AFrameworkApplication.xh.$k(od.a.Ief,2))};this.URh=()=>{this.Pgi();Aa.AFrameworkApplication.xh.$k(od.a.Hef,2)};this.Vkc=I;this.cuh=hc;this.Vkc.y1a&&(this.Fq=new Fb.a(3,2,5E3,this.pMh,2),Aa.AFrameworkApplication.Np.lm(this.Fq),this.ko(pa,lb));this.Vkc.NIb(()=>
{this.oig()});this.Vkc.afb(()=>{this.pig()})}get businessBar(){return this.Tda||(this.Tda=Object(tl.a)())}get Fcf(){return this.oJe||(this.oJe=Object(Qf.f)(Yl))}ko(I,pa){const lb=Aa.AFrameworkApplication.xh;lb.Vk(od.a.authenticationLost,Vg.a.frame,I,96);lb.Vk(od.a.qaf,Vg.a.frame,pa,96);lb.Uh(od.a.Hef,Vg.a.frame,ti.ActionManager.DDd);lb.Uh(od.a.Ief,Vg.a.frame,ti.ActionManager.DDd);lb.Uh(od.a.O2d,Vg.a.frame,ti.ActionManager.DDd)}oig(){this.showDialog(Object(lg.a)("AuthenticationLostMessage"));Aa.AFrameworkApplication.xh.$k(od.a.authenticationLost,
2)}pig(){this.x_k();Aa.AFrameworkApplication.xh.$k(od.a.qaf,2)}x_k(){this.gO&&(this.gO.hide(),this.gO.dispose(),this.gO=null);this.rka&&this.businessBar&&(Aa.AFrameworkApplication.Vl||this.businessBar.removeEntry(this.rka),this.rka.dispose(),this.rka=null)}showDialog(I){Xa.a.gh(this.gO);this.gO=new ej.a;this.cuh||(this.gO.xB=!1,this.gO.Oh=0);this.gO.si(1,Object(lg.a)("SignIn"));this.gO.xW(Object(lg.a)("DefaultDialogTitle"),I,this.CD)}V8a(){this.businessBar&&this.Fcf&&(this.rka=this.Fcf.create(Object(lg.a)("AuthenticationLostTitle"),
Object(lg.a)("AuthenticationLostMessage"),null),this.rka.closeable=!0,this.rka.addButton(Object(lg.a)("SignIn"),ul.RRh,""),this.rka.QX=this.URh,this.businessBar.HF(this.rka,!1))}Pgi(){this.Fq&&(Aa.AFrameworkApplication.Np.Ux(this.Fq),this.Fq=null)}dispose(){this.Fq=this.gO=this.rka=null}static RRh(){Ck.a.zia();Aa.AFrameworkApplication.xh.$k(od.a.O2d,2)}}Object(za.a)(ul,"SignOutResponseUI",null,[2]);class ik{get name(){return"Common.App.UI"}co(I){I.register(Kl,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Ai()}init(){}dispose(){Xa.a.gh(ik.Dea);
ik.Dea=null}static main(){Vb.a.instance.Jo(new ik)}}ik.Dea=null;Object(za.a)(ik,"CommonAppUIPackage",null,[13,14]);var Dk=a(185),Ll=a(733);class Ui extends Ll.a{constructor(){super()}dispose(){Dk.WacAirSpace.CVd()&&Dk.WacAirSpace.H2c()}animate(I,pa,lb,hc,Xc){pa&&Dk.WacAirSpace.ZZ(I.element,pa);Dk.WacAirSpace.animate(I,hc,Xc);lb&&Dk.WacAirSpace.Klk(I.element,lb)}}Object(za.a)(Ui,"AnimationManager",Ll.a,[2]);var Zl=a(126);class Wk extends je.a{constructor(I){super();this.$=I;this.sn()}create(){Aa.AFrameworkApplication.ea.ka("RefreshAccessTokenSilently")?
this.dl(this.k7h()):this.dl(this.$.qa.zh(38)||this.$.qa.Rh(38,new Hd(this.$)))}k7h(){var I=this.$.qa.zh(38);if(I)return I;I=new Zc(Aa.AFrameworkApplication.Np,Aa.AFrameworkApplication.ND(),new cc);return this.$.qa.Rh(38,new pc(this.$,I))}static Ga(I){I.qa.Rh(39,new Wk(I))}}Object(za.a)(Wk,"AccessTokenExpirationManagerFactory",je.a,[]);var Ml=a(1218),$l=a(1219);const Nl=Object(Qf.c)($l.b);var ok;(function(I){I[I.generalException=0]="generalException";I[I.invalidArgument=1]="invalidArgument";I[I.qgg=
2]="notAllowed";I[I.Goc=3]="apiNotAvailable";I[I.c8k=4]="unresolvedPendingRequest";I[I.timeout=5]="timeout";I[I.Mod=6]="adalTimeout";I[I.pCe=7]="userNotSignedIn";I[I.zAb=8]="userAborted";I[I.JXg=9]="silentSignInFailed";I[I.Unb=10]="invalidResourceUrl";I[I.BGc=11]="invalidGrant";I[I.Bjf=12]="connectionLost";I[I.msc=13]="clientError";I[I.serverError=14]="serverError"})(ok||(ok={}));Object(za.b)("ErrorCodes",ok);a(1465);class Kj{constructor(I,pa){this.requestCallback=this.requestParameters=null;this.requestParameters=
I;this.requestCallback=pa}}Object(za.a)(Kj,"OutstandingRequest",null,[]);class ui{}ui.GLj="AADSTS50058";ui.Unb="AADSTS50001";ui.BLj="AADSTS65001";ui.ULj="AADSTS70011";ui.zAb="13002";ui.R9j="Popup Window is null";ui.Q9j="Popup Window closed";ui.Mod="Token renewal operation failed due to timeout";ui.r2k="tokenRevoked";Object(za.a)(ui,"WopiHostErrorType",null,[]);var Ek=a(612),Xk=a(685),am=a(1464);class vl{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=
""}}Object(za.a)(vl,"WopiIdentityInfo",null,[348]);class Ol{constructor(I,pa,lb){this.expiration=this.authority=this.accessToken=null;this.accessToken=I;this.authority=pa;this.expiration=lb}}Object(za.a)(Ol,"WopiIdentityToken",null,[347]);class ug{constructor(I){this._initialized=!1;this.$Zj=pa=>{let lb=null;try{const Xc=pa.Values[Rb.a.Jve],Gd=pa.Values[Rb.a.dWk],ae=pa.Values[Rb.a.KYg],we=pa.Values[Rb.a.lWk];let Re=null,lf=null;const hg=this.Atb[Xc];if("undefined"!==typeof hg&&hg){var hc=[];Array.add(hc,
{name:Rb.a.Ive,string:hg.requestParameters.correlationId});Zg.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:hc});lb=hg.requestCallback;delete this.Atb[Xc];"undefined"!==typeof Gd&&Gd&&Gd.length?lf=new Ol(Gd,ae,we):Re=ok[this.EFj(pa)];hc="getAccessToken_"+Xc;hc in this.k1c&&(this.k1c[hc].stop(),delete this.k1c[hc]);lb(lf,Re)}else ea.ULS.sendTraceTag(37856066,344,10,wh.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Xc}))}catch(Xc){pa=
pa.Values[Rb.a.Jve],pa in this.Atb&&delete this.Atb[pa],this.FMc(),ea.ULS.sendTraceTag(37856067,344,10,wh.c({["error"]:Xc.message,["stack"]:Xc.stack})),lb&&lb(null,"generalException")}};this.Atb={};this.k1c={};this.f_=Aa.AFrameworkApplication.ra.GL;this.jTd=I}jZa(I){this._initialized||(I.kr(ib.a.gxg),I.pq(ib.a.gxg,this.$Zj),this._initialized=!0)}getAccessToken(I,pa,lb){lb=void 0===lb?null:lb;this.GV(I,pa);return new Promise((hc,Xc)=>{if(this.BVd(pa))if(pa in this.Atb)Xc("unresolvedPendingRequest");
else{var Gd=window.setTimeout(()=>{ea.ULS.sendTraceTag(37856032,344,10,wh.c({["error"]:"Request timeout.",["callerId"]:pa}));Xc("timeout")},12E4);this.FKd(I,pa,lb,(ae,we)=>{window.clearTimeout(Gd);ae?hc(ae):(ea.ULS.sendTraceTag(37856033,369,15,wh.c({["error"]:ok[we]})),Xc(we))})}else ea.ULS.sendTraceTag(37856034,344,10,wh.c({["error"]:"Caller is not allowed."})),Xc("notAllowed")})}getPrimaryIdentityInfo(I){return new Promise((pa,lb)=>{this.BVd(I)?this.CUi((hc,Xc)=>{hc?pa(hc):(ea.ULS.sendTraceTag(37856064,
369,10,wh.c({["error"]:Xc.toString()})),lb(Xc))}):(ea.ULS.sendTraceTag(37856065,344,10,wh.c({["error"]:"Caller is not allowed."})),lb("notAllowed"))})}getAuthContext(I){return new Promise((pa,lb)=>{const hc=this.getAuthContextSync(I);hc?pa(hc):lb("notAllowed")})}getAuthContextSync(I){if(this.BVd(I)){const pa=new am.a;pa.upn=Aa.AFrameworkApplication.ea.Ya("UserPrincipalName");pa.userId=Aa.AFrameworkApplication.ea.Ya("LoggableUserId");pa.authority=Aa.AFrameworkApplication.ea.Ya("HostAuthAuthority");
pa.tenantId=Aa.AFrameworkApplication.ea.Ya("TenantId");pa.isAnonymous=Aa.AFrameworkApplication.ea.ka("IsAnonymousUser");pa.supportsAuthToken=this.c$i(I);I=Aa.AFrameworkApplication.ea.Ya("HostAuthType");pa.authorityType="aad"===I.toLowerCase()?2:"msa"===I.toLowerCase()?1:0;return pa}ea.ULS.sendTraceTag(40751647,344,10,wh.c({["error"]:"Caller is not allowed."}));return null}c$i(I){const pa=Ek.a.WUb,lb=Aa.AFrameworkApplication.ea.Ya(Aa.AFrameworkApplication.o_);return"teams"===(null===lb||void 0===lb?
void 0:lb.toLowerCase())||vg.a.gMa?pa&&Ek.a.K0g?Array.contains(Ek.a.K0g,I.toLowerCase()):!1:pa}FKd(I,pa,lb,hc){var Xc=[];Array.add(Xc,{name:"CallerId",string:pa});Array.add(Xc,{name:Rb.a.Ive,string:I.correlationId});Zg.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Xc});Xc=Xk.a.create().toString();const Gd="getAccessToken_"+Xc,ae=this.f_.Oi("ComponentAttach",Gd);this.k1c[Gd]=ae;const we={};we[Rb.a.Jve]=Xc;we[Rb.a.iWk]=I.resource;we[Rb.a.jWk]=
I.scope;we[Rb.a.KYg]=Aa.AFrameworkApplication.ea.Ya("HostAuthType");we[Rb.a.mWk]=Aa.AFrameworkApplication.ea.Ya("UserPrincipalName");we[Rb.a.kWk]=I.silentLogin;we[Rb.a.fWk]=I.options;we[Rb.a.Ive]=I.correlationId;we[Rb.a.gWk]=pa;lb&&(we[Rb.a.addinName]=lb.AddinName,we[Rb.a.eWk]=lb.AddinTrustId);this.jTd.execute(Re=>{this.jZa(Re);Re.sendMessage(ib.a.getAuthToken,we)});this.Atb[Xc]=new Kj(I,hc)}CUi(I){const pa=Aa.AFrameworkApplication.ea.Ya("UserName"),lb=Aa.AFrameworkApplication.ea.Ya("UserPrincipalName"),
hc=Aa.AFrameworkApplication.ea.Ya("LoggableUserIdSpace"),Xc=new vl;Xc.email=lb;Xc.displayName=pa;switch(hc){case "OrgIdPuid":Xc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Xc.authority="MicrosoftAccount";break;default:Xc.authority=hc}I(Xc,null)}BVd(I){var pa=Aa.AFrameworkApplication.H1i();I=I.toLowerCase();for(const lb of pa)if(I===lb.toLowerCase())return!0;pa=Ek.a.Lrd;for(const lb in pa)if(I===pa[lb].toLowerCase())return!0;return!1}EFj(I){I=I.Values[Rb.a.hWk];this.FMc();
ea.ULS.sendTraceTag(39068821,344,50,wh.c({["error"]:I}));return I?-1<I.indexOf(ui.GLj)?9:-1<I.indexOf(ui.R9j)||-1<I.indexOf(ui.Q9j)?12:-1<I.indexOf(ui.Unb)?10:-1<I.indexOf(ui.zAb)?8:-1<I.indexOf(ui.ULj)||-1<I.indexOf(ui.BLj)||I===ui.r2k?11:-1<I.indexOf(ui.Mod)?6:0:13}GV(I,pa){I=this.zik(I.resource);ea.ULS.sendTraceTag(39921882,344,50,wh.c({["callerId"]:pa,["resource"]:I}))}FMc(){ea.ULS.sendTraceTag(39068822,344,50,wh.c({["userAgent"]:window.navigator.userAgent}))}zik(I){return(I?I:"").replace("://",
"__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(za.a)(ug,"WopiIdentityManager",null,[339]);class Fk{constructor(){this.Vh=null;this.fL=()=>{try{Object(Qf.a)(Nl)}catch(I){ea.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+I)}}}get name(){return"Common.App.WopiIdentity"}co(I){this.Vh=I;I.register(ug,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Ai().Ii(()=>new ug(Object(Lk.a)()))}init(){Aa.AFrameworkApplication.ea&&
Aa.AFrameworkApplication.ea.cy(this.fL)}dispose(){}static main(){Vb.a.instance.Jo(new Fk)}}Object(za.a)(Fk,"WopiIdentityPackage",null,[13,14]);const wl=Object(Qf.b)("Common.App.FloatPane.IFloatPaneFactory"),B=Object(Qf.c)(wl),ra=Object(Qf.b)("Common.App.FloatPane.IFloatPaneActor"),vb=Object(Qf.c)(ra);class dc{constructor(I,pa,lb){this.RUa=null;this.N9b=()=>{this.RUa=null;ea.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.yNe.display()};this.iRk=(hc,Xc,
Gd,ae,we)=>hc!==od.a.N9b?2:1===Gd?32:2===Gd&&we?(ea.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",we),we?this.kEg():(this.RUa?(ea.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.vk.Ux(this.RUa)):(ea.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.yNe.remove(null)),this.RUa=null),32):8;this.vk=I;this.$f=pa;this.yNe=lb.create()}kEg(){this.RUa?ea.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):
(ea.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.RUa=new Fb.a(2,1,3E4,this.N9b,67),this.vk.lm(this.RUa))}P6a(){this.$f.Uh(od.a.N9b,Vg.a.frame,this.iRk)}}Object(za.a)(dc,"FloatPaneActor",null,[567]);const Hc=Object(Qf.b)("Common.IFloatPaneContainer");var ed=a(171);class Id{constructor(I,pa,lb,hc,Xc){this.cgd=this.bEb=this.Sjc=this.qta=this.Q_=this.uF=this.p9c=this.jX=this.TFb=this.eFb=this.fFb=this.Ebd=null;this.IXj=()=>{const Gd=this.Ea.Ij("O365AdPaneShowingDuration",
60);this.Rtc();this.jX.style.display="block";this.jX.style.height=this.Q_.height+"px";this.bEb=new Fb.a(2,1,1E3*Gd,Object(Uc.a)(this,this.hide,"hide"),67);this.vk.lm(this.bEb);this.mFg()};this.HXj=()=>{ea.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.mFg();this.Q_=null};this.kqg=()=>{ea.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.bEb&&this.vk.Ux(this.bEb);
this.hide();return!0};this.vk=pa;this.Ea=I;this.Bu=lb;this.Vh=Xc;this.UQ=hc}Rtc(){this.jX=document.createElement("div");this.jX.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.jX.style.width=this.Q_.width+"px";(this.cgd=this.DSi(this.UQ))?(this.qta=document.createElement("a"),this.qta.setAttribute(Ij.a.fk,Ij.a.wz),this.Bu.xa(vd.a.click,this.qta,this.kqg),this.qta.href=this.cgd,this.qta.target="_blank",this.qta.appendChild(this.Q_),this.jX.appendChild(this.qta)):this.jX.appendChild(this.Q_);
this.uF=document.createElement("a");this.uF.setAttribute(Ij.a.fk,Ij.a.KF);this.uF.className="StandardButton WACFloatPaneCloseButton";this.uF.title=Object(lg.a)("Close");this.uF.tabIndex=-1;this.p9c=ed.a(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.p9c.setAttribute(Ij.a.fk,Ij.a.wz);this.uF.appendChild(this.p9c);this.Bu.xa(vd.a.click,this.uF,this.onClose);this.jX.appendChild(this.uF);this.TFb.appendChild(this.jX)}YOi(I){const pa=this.Ea.ka("O365PromotionHasStarted");
switch(I){case 2:return xg.a.CHa(String.format("adppt{0}.png",pa?"sale":""));case 1:return xg.a.CHa(String.format("adxls{0}.png",pa?"sale":""));case 3:return xg.a.CHa(String.format("addoc{0}.png",pa?"sale":""))}return null}DSi(I){const pa=this.Ea.Ya("O365AdPaneRedirectedURL");switch(I){case 1:return String.format(pa,"Excel");case 2:return String.format(pa,"PowerPoint");case 3:return String.format(pa,"Word")}return null}hide(I){this.bEb=null;this.jX&&!this.Sjc&&((void 0===I?0:I)?ea.ULS.sendTraceTag(23674904,
207,50,"The float pane is closed automatically."):ea.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.jX.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.jX.style.height="0px",this.Sjc=new Fb.a(2,1,1E3,Object(Uc.a)(this,this.remove,"remove"),67),this.vk.lm(this.Sjc))}remove(){this.jX&&this.TFb&&(this.qta&&this.Bu.Oa(vd.a.click,this.qta,this.kqg),this.Bu.Oa(vd.a.click,this.uF,this.onClose),this.TFb.removeChild(this.jX),this.jX=null);this.Sjc=
null}display(){if(this.Ebd=Object(Qf.f)(Hc))if(this.TFb=this.Ebd.container){var I=this.YOi(this.UQ);I?(ea.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",I),this.Q_=document.createElement("img"),this.Q_.className="WACFloatPaneImage",this.fFb=this.IXj,Sd.a.addHandler(this.Q_,vd.a.load,this.fFb),this.eFb=this.HXj,Sd.a.addHandler(this.Q_,vd.a.error,this.eFb),this.Q_.src=I):ea.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else ea.ULS.sendTraceTag(23674906,
207,15,"The container is empty, so the float pane can't be shown.");else ea.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}mFg(){this.fFb&&this.Q_&&Sd.a.removeHandler(this.Q_,vd.a.load,this.fFb);this.fFb=null;this.eFb&&this.Q_&&Sd.a.removeHandler(this.Q_,vd.a.error,this.eFb);this.eFb=null}dispose(){this.hide()}}Object(za.a)(Id,"FloatPane",null,[594]);class Pd{constructor(I,pa,lb,hc,Xc){this.vk=pa;this.Ea=I;this.Bu=lb;this.Vh=Xc;this.UQ=
hc}create(){return new Id(this.Ea,this.vk,this.Bu,this.UQ,this.Vh)}}Object(za.a)(Pd,"FloatPaneFactory",null,[568]);class Rd{constructor(){this.Vh=null}get name(){return"Common.App.FloatPane"}get L_f(){return Aa.AFrameworkApplication.ea.ka("O365AdvertisementIsEnabled")&&Aa.AFrameworkApplication.ea.ka("IsShowAdvertisementPaneEnabled")}init(){this.L_f&&(ea.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),Object(Qf.a)(vb).kEg(),ea.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),
Object(Qf.a)(vb).P6a())}co(I){this.Vh=I;this.L_f&&(this.Vh.register(Pd,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Ii(()=>new Pd(Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.Np,Lc.a.instance,Aa.AFrameworkApplication.ra.$g.qn,this.Vh)).Ai(),this.Vh.register(dc,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Ii(()=>new dc(Aa.AFrameworkApplication.Np,Aa.AFrameworkApplication.xh,Object(Qf.a)(B))).Ai())}dispose(){}static main(){Vb.a.instance.Jo(new Rd)}}
Object(za.a)(Rd,"FloatPanePackage",null,[13,14]);const $d=Object(Qf.b)("Common.App.DisplayEnvironmentName.DisplayEnvironmentName"),Ae=Object(Qf.c)($d);class Ke{constructor(I,pa){this.sDb=null;this.U9k=(lb,hc,Xc,Gd,ae)=>{if(1===Xc)return 32;ae[Th.a.Value]=this.sDb;ae[Qi.a.Do]=this.sDb;ae[Th.a.Visible]=!0;return 32};this.$f=I;this.Ea=pa}ko(){(this.sDb=this.Ea.Ya("StatusBarEnvironmentNameToUse"))&&""!==this.sDb&&this.$f.Vk(od.a.$zg,Vg.a.frame,this.U9k,96)}}Object(za.a)(Ke,"DisplayEnvironmentName",null,
[]);class Ze{constructor(){this.Vh=null}get name(){return"Common.App.DisplayEnvironmentName"}co(I){this.Vh=I;this.Vh.register(Ke,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Ai().Ii(()=>new Ke(Aa.AFrameworkApplication.xh,Aa.AFrameworkApplication.ea))}init(){Object(Qf.a)(Ae).ko()}dispose(){}static main(){Vb.a.instance.Jo(new Ze)}}Object(za.a)(Ze,"DisplayEnvironmentNamePackage",null,[13,14]);var cg=a(235),Vf=a(179);class Xf extends cg.a{constructor(I){super();this.tJ=()=>{this.f1a()};
this.mZ=()=>{this.f1a()};this.$=I}dispose(){this.$&&Vf.a(this.$)&&(Vf.a(this.$).n7a(this.mZ),this.$.fa.gI(this.tJ));this.$=null;super.dispose()}aji(){Aa.AFrameworkApplication.ZLa()&&!this.f1a()&&(Vf.a(this.$).AGa(this.mZ),this.$.fa.lK(this.tJ))}f1a(){return this.$.isEditMode&&(Aa.AFrameworkApplication.TYa||se.a.Zl.Iw)?(Vf.a(this.$).n7a(this.mZ),Yf.TaskExtensions.$e(Qk.GetServiceTaskFactory.create(this.$.qa,119,this.ya,1),I=>{I.result.initialize()},this.ya,3),!0):!1}static main(){Rc.a.hh(I=>{Gc.sf.Ma()||
(new Xf(I)).aji()})}}Object(za.a)(Xf,"FileOpSliceDownloaderBootStraper",cg.a,[]);var Pf=a(103),Kg=a(538);class oh{constructor(I){this.e6=null;this.lag=new Set;this.v4f=!1;this.Xba=(pa,lb)=>{if(!this.lag.has(pa)){var hc=[];if(lb){const Xc=Oc.f(this.$).oh.Ml(lb,!1);if(!Xc){1!==lb.top||1!==lb.left||this.v4f||(hc.push(Kb.a.gm("IsTableOnA1","false",Zb.g.Boolean)),Xb.a("MsFormsTableUsage",void 0,void 0,hc),this.v4f=!0);return}if(1!==Xc.usedRange.top||1!==Xc.usedRange.left)return}lb=Mg.b().kp(pa);hc.push(Kb.a.gm("Command",
lb,Zb.g.String));Xb.a("MsFormsTableUsage",void 0,void 0,hc);this.lag.add(pa)}};this.lBe=(pa,lb)=>{if(!this.$.fa.Dn.get(61)||Pf.j(this.$.wl))Pf.j(this.$.wl)&&lb&&lb.item.name===this.e6.YU&&this.Eaf();else if(this.$.sa.Pq(this.e6.oRb)){const hc={};hc.SheetName=this.e6.oRb;hc.NamedObjectName=this.e6.oRb;hc.FirstColumn=0;hc.FirstRow=0;hc.LastColumn=0;hc.LastRow=2;const Xc=ae=>{if(!Pf.j(this.$.wl)){if(null===ae||void 0===ae?0:ae.Result)this.$.workbookContext.MsFormId=ae.Result[0][0],this.e6.YU=ae.Result[1][0],
ae=ae.Result[2][0],this.rW(!!this.$.workbookContext.MsFormId&&this.xuj(ae),1024),this.Eaf();Pf.c(this.$.wl)&&(lb?ea.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${Qa.a.uE(this.$.workbookContext.MsFormId).toString()}`):ea.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${Qa.a.uE(this.$.workbookContext.MsFormId).toString()}`));Pf.c(this.$.wl)&&!lb&&ea.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${Qa.a.uE(this.$.workbookContext.MsFormId).toString()}`);
!Pf.c(this.$.wl)&&lb||this.rW(!0,2048)}},Gd=this.$.oa.ta.Wh();this.$.userOperationManager.kP(new zb.a(159,0,(ae,we,Re)=>Cb.t(this.$.oa.h2,hc,!1,zc.c(ae,Xc),we,Re,null,Gd),16))}else lb||this.rW(!0,2048)};this.jYj=(pa,lb)=>{lb&&lb.item.name===this.e6.oRb&&(this.rW(!1,1024),this.rW(!0,2048))};this.$=I}I5k(){this.e6=Kg.a.current;this.lBe(null,null);this.$.sa.rua(this.lBe);this.$.sa.z4(this.jYj)}dispose(){this.$.sa.iBa(this.lBe)}xuj(I){if(!I)return!0;const pa=RegExp("-","g"),lb=this.$.workbookContext.MsFormDocUrl.toLowerCase();
return lb.includes(I.toLowerCase())||lb.includes(I.toLowerCase().replace(pa,""))?!0:!1}Eaf(){Pf.c(this.$.wl)&&this.e6.YU&&this.$.sa.la&&this.$.sa.la.name!==this.e6.YU&&this.$.sa.Pq(this.e6.YU)&&this.$.sa.getItemByName(this.e6.YU).activate({scenario:"msForm"})}rW(I,pa){this.$.workbookContext.Options=td.HelperMethods.a_(I,this.$.workbookContext.Options,pa)}}Object(za.a)(oh,"MsFormInfoUpdatingService",null,[563,2]);class Hg extends je.a{constructor(I){super();this.msFormInfoUpdatingService=null;this.$=
I;this.sn()}create(){this.dl(Object(Xe.a)(this.$.qa,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new oh(this.$))));this.msFormInfoUpdatingService.I5k()}static Ga(I){I.qa.Rh(236,new Hg(I))}}Object(za.a)(Hg,"MsFormInfoUpdatingServiceFactory",je.a,[]);var Gh=a(1466),xi=a(1099);class Ah{}Ah.D0k=864E5;Ah.sGh=3;Ah.fOj=144E5;Object(za.a)(Ah,"AddinConstantsNum",null,[]);var mi=a(947),em=a(1052),Gk=a(1019);class fm{constructor(I,pa,lb,hc){this.ea=(hc=void 0===hc?null:hc)?hc:Aa.AFrameworkApplication.ea;
this.tdd=2;this.b1a=I;this.pwh=pa;this.Eh=lb}get kya(){return this.tdd}get fdl(){return this.pwh}Sme(I){if(this.ea.ka("AgaveSupportsLiveIdSpoofing")){var pa=(new Date).getTime();this.b1a(I,this.kya,{["ak0"]:pa})}else if(Gk.a.rOk(I)){pa=String.format(Aa.AFrameworkApplication.ra.$g.f2+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",Aa.AFrameworkApplication.ra.$g.qn,this.fdl,Aa.AFrameworkApplication.Oo);const lb=Aa.AFrameworkApplication.lj;let hc=null;this.Eh&&(hc=this.Eh.Oi("ComponentAttach",
em.a[I]+xi.a[this.kya]));lb.qv(pa,1,null,null,!0,4,Xc=>{this.S2j(I,Xc.data.responseData);hc&&hc.stop()},Xc=>{ea.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Xc.data.httpStatus);this.dtb(I,1,"request failed");hc&&hc.stop()},null)}else Gk.a.DRf(I)?(pa=Gk.a.HEf(I),this.b1a(I,this.kya,{["ak0"]:pa})):this.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(this.VM?this.dtb(I,1,"no local timestamp"):this.b1a(I,this.kya,null))}S2j(I,pa){if(pa&&""!==
pa)if(pa=Sys.Net.XMLDOM(pa)){Gk.a.lRa(mi.a.L6e,((new Date).getTime()+Ah.fOj).toString(),I);let lb=pa.getElementsByTagName("update");lb&&lb.length||(lb=pa.getElementsByTagName("o:update"));lb&&0<lb.length?(pa=Date.parse(lb[0].firstChild.nodeValue),Gk.a.HEf(I)<pa||Gk.a.DRf(I)?this.b1a(I,this.kya,{["ak0"]:pa}):this.dtb(I,1,"outdate timestamp in reponse")):this.dtb(I,2,"no timestamp in response")}else this.dtb(I,1,"response data is invalid");else this.dtb(I,1,"no responseData")}dtb(I,pa,lb){this.VM&&
this.b1a(I,this.kya,{["AddinServiceUserState"]:pa,["DiagnosticInfo"]:lb})}get VM(){return this.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.ea.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(za.a)(fm,"AddinCommandsAnonymousAPIInitializer",null,[640]);class xl{constructor(I,pa,lb){this.tdd=lb;this.b1a=I;this.Mo=pa}get kya(){return this.tdd}Sme(I){let pa=null;this.Mo&&(pa=this.Mo.Oi("ComponentAttach",em.a[I]+xi.a[this.kya]));if(null==
this.qte(I)?0:this.qte(I)){const lb=(new Date).getTime()-Ah.sGh*Ah.D0k;this.b1a(I,this.kya,{["ak0"]:lb})}pa&&pa.stop()}}Object(za.a)(xl,"AddinCommandsInitializerBase",null,[640]);class gm extends xl{constructor(I,pa){super(I,pa,5)}qte(){return!0}}Object(za.a)(gm,"AddinCommandsInitializer",xl,[]);class hm extends xl{constructor(I,pa){super(I,pa,1)}qte(I){try{const pa=mi.a.SHf()+I;return Boolean.parse(this.pHi(pa)||"false")}catch(pa){ea.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",
pa.toString())}return null}pHi(I){const pa=localStorage;return void 0!==pa&&null!==pa?pa.getItem(I):null}}Object(za.a)(hm,"AddinCommandsLocalCacheInitializer",xl,[]);var om=a(664);class bm{constructor(I,pa){pa=void 0===pa?null:pa;this.Eh=I;this.ea=pa?pa:Aa.AFrameworkApplication.ea}get appUILocale(){return om.a.bS(Aa.AFrameworkApplication.lcid).name}Fcj(){const I=this.cLd();if(I)if(this.ea.ka("OcpsIsEnabled"))Object(Mc.a)().execute(pa=>{pa.isFeatureEnabled("ConnectedServices",!0).then(lb=>{for(const hc of I){if(!lb&&
0===hc.key){this.VM&&this.n3g(0,hc.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Xc=this.cEf(hc.value);Xc&&Xc.Sme(hc.key)}return null})});else for(const pa of I){const lb=this.cEf(pa.value);lb&&lb.Sme(pa.key)}}Tme(I,pa,lb){lb&&lb[mi.a.PVa]?(lb[mi.a.A$]=I,lb[mi.a.D4]=pa,this.Jfe(od.a.Gqa,lb),Gk.a.lRa(mi.a.PVa,lb[mi.a.PVa].toString(),I)):this.VM?this.n3g(I,pa,lb):this.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&
0===I&&(lb={},lb[mi.a.A$]=I,lb[mi.a.D4]=pa,this.Jfe(od.a.xG,lb))}cEf(I){let pa=null;switch(I){case 1:pa=new hm(Object(Uc.a)(this,this.Tme,"retrieveAddinFlagCompleted"),this.Eh);break;case 2:pa=new fm(Object(Uc.a)(this,this.Tme,"retrieveAddinFlagCompleted"),this.appUILocale,this.Eh,this.ea);break;case 5:pa=new gm(Object(Uc.a)(this,this.Tme,"retrieveAddinFlagCompleted"),this.Eh)}return pa}n3g(I,pa,lb){0===I&&lb&&lb[mi.a.goc]&&(lb[mi.a.A$]=I,lb[mi.a.D4]=pa,ea.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",
lb[mi.a.goc].toString(),JSON.stringify(lb)),this.Jfe(od.a.xG,lb))}get VM(){return this.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.ea.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(za.a)(bm,"AddinCommandsInitializerHost",null,[]);var Yk=a(960),im=a(293),jm=a(398);let cm;class km extends ej.a{constructor(I,pa){super();this.YJe=Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeCheckboxLabel:
CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.RMe=Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeHelpUrlText:CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.SMe=Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeHelpUrl:CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.OFb=!1;this.sKb=()=>{this.hide();this.OFb&&z(this.aea)};this.fQj=()=>{Yk.a.instance.getItem("optedIntoAddinDeveloperMode")?
(Yk.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.OFb=!1):(Yk.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.OFb=!0)};this.aea=I;cm=pa}showDialog(I,pa){try{this.fl=void 0===this.fl||null===this.fl?im.a.T4b(jm.a.v9).toString():this.fl,this.show({["type"]:"StandardDialogProps",["id"]:this.fl,["dialogIcon"]:3,["headerText"]:I,["titleText"]:pa,["resultHandler"]:this.sKb,["messageAreaLink"]:this.v$h(),["permanentDismissCheckbox"]:this.r$h(),["renderMicrosoftLogoInHeader"]:!1})}catch(lb){this.O6c(I,
pa)}}v$h(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.RMe,["handler"]:{["href"]:this.SMe,["target"]:"_blank"},["onExecute"]:null}}r$h(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.YJe,["onExecute"]:this.fQj}}O6c(I,pa){const lb=new kl.a(!1,!1,!1);lb.Oh=1;lb.fl=im.a.T4b(jm.a.v9).toString();lb.rp=String.format(this.m6(),pa,this.SMe,this.RMe,this.YJe);lb.initializeAndShow(I,this.Ueh,{optInCheckbox:!1})}Ueh(I,pa){1==I&&pa.optInCheckbox&&
(Yk.a.instance.getItem("optedIntoAddinDeveloperMode")?(Yk.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.OFb=!1):(Yk.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.OFb=!0,z(this.aea)))}m6(){return"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}Object(za.a)(km,"AppsForOfficeDeveloperModeOptInDialog",ej.a,[]);var pm=a(439);class lm extends bm{constructor(I){super(I.Eh);
this.aea=this.WCb=null;this.bFa=new Jf.a;this.rie=pa=>{1===pa&&this.aea&&this.SDg()};this.$=I;Gh.a.pnb=Gh.a.Wyf}get appUILocale(){return this.$.ua.UICultureTag}h4g(){this.Fcj();this.$5k()}cLd(){const I=new pm.a;this.$.fa.Dn.get(27)&&(I.ga(0,2),""!==Aa.AFrameworkApplication.ea.Ya("HostInstallAddIns")&&I.ga(16,5));this.$.fa.Dn.get(33)&&I.ga(1,1);jd.EwaSettings.Na(52)&&I.ga(8,1);this.$.kk.get(35)&&I.ga(10,5);return I}Jfe(I,pa){this.Wmi(()=>{const lb=new Wd.a(I,0,this.$.ji,0,null);this.$.Ia.qh(lb,pa)})}Wmi(I){(pa=>
{pa=this.$.qa.zh(pa);return!!pa&&P.d(pa)})(198)?this.$.qa.zi(198,pa=>{I(pa)}):I(null)}$5k(){this.aea=Aa.AFrameworkApplication.ea.Ya("DevAddinManifestFileUrl");this.WCb=Aa.AFrameworkApplication.ea.Ya("DevAddinManifestGuid");var I=Aa.AFrameworkApplication.ea.Ya("IsDevAddinTest");if(this.aea&&this.WCb&&I){I="true"===I;var pa=this.bFa.getItem("optedIntoAddinDeveloperMode");const lb=this.bFa.getItem(this.WCb);pa||I&&Aa.AFrameworkApplication.ea.ka("SuppressDeveloperAddinDialogs")?!Aa.AFrameworkApplication.disableWholeAppsForOfficeFeature&&
(lb||I&&Aa.AFrameworkApplication.ea.ka("SuppressDeveloperAddinDialogs"))?this.SDg():(I=new ej.a,I.Oh=4,Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?(pa=CommonUiStrings.AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUiStrings.AppsForOfficeDeveloperManifestUrl,this.aea)+CommonUiStrings.AppsforOfficeLoadManifestUrl,I.xW(CommonUiStrings.AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,pa,this.rie)):(pa=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.aea)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,I.xW(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,pa,this.rie))):(I=new km(this.aea,this.rie),I.Oh=0,Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?I.showDialog(CommonUiStrings.AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUiStrings.AppsforOfficeNotOptedIntoAddinDeveloperModeMessage):I.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,
CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}SDg(){if(Gc.yb.Ma())void Fc.a.resolve(Gc.yb,{va:1}).then(I=>{I.Fl.validateAndCacheNewDevAddinManifest(this.aea);this.bFa.setItem(this.WCb,"true")});else{const I=Qk.GetServiceTaskFactory.create(this.$.qa,106,this.$.ya,1);Yf.TaskExtensions.$e(I,()=>{I.result.Fl.validateAndCacheNewDevAddinManifest(this.aea);this.bFa.setItem(this.WCb,"true")},this.$.ya,3)}}}Object(za.a)(lm,"AddinCommandsInitService",bm,[565]);class dm extends je.a{constructor(I){super();
this.addinCommandsInitService=null;this.hj=()=>{ea.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.fa.ki}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.Kj&16384)}] `);this.addinCommandsInitService.h4g();this.$.fa.Lq(this.hj)};this.$=I;this.sn()}create(){this.$.qa.zi(53,()=>{this.dl(Object(Xe.a)(this.$.qa,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new lm(this.$))));this.$.fa.ki?(ea.ULS.sendTraceTag(537170702,
0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.Kj&16384)}] `),this.addinCommandsInitService.h4g()):this.$.fa.Nq(this.hj)})}static Ga(I){I.qa.Rh(201,new dm(I))}}Object(za.a)(dm,"AddinCommandsInitServiceFactory",je.a,[]);Type.registerNamespace("Common.App.InProductMessaging");Ki.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");nc.main();(()=>{Rc.a.hh(()=>{Rc.a.hh(I=>{Gc.qc.Ma()||id.Ga(I)})})})();
(()=>{Rc.a.hh(()=>{Gc.wd.Ma()||Rc.a.hh(wf.Ga)})})();Rc.a.hh(Jk.Ga);(()=>{Rc.a.hh(I=>{Gc.Nd.Ma()||Kk.Ga(I)})})();(()=>{Rc.a.hh(I=>{he.a.xp()||rk.Ga(I)})})();Type.registerNamespace("Common.App.Rename");Vb.a.instance.Jo(new Fl,7);(()=>{Rc.a.hh(I=>{Gc.sf.Ma()||Sk.Ga(I)})})();jd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(646);(()=>{Rc.a.hh(I=>{I.qa.Rh(203,new nl)})})();Type.registerNamespace("Common.App.LivePersonaUtils");xk.main();Type.registerNamespace("Common.App.SaveStatus");
Vb.a.instance.Jo(new zk);(()=>{Rc.a.hh(I=>{Gc.Jb.Ma()||Object(Jl.a)();Bk.Ga(I)})})();jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8622899_migrate_ShareSectionCss_SharedUIControlsFactory")?a(1461):bk.a.Jy('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Type.registerNamespace("CAUI");ik.main();Zl.a.Yx.Rh(141,new Ui);jd.EwaSettings.isChangeGateEnabled("OfficeVSO:8719582_RemoveVarsFromSlices")||a(1463);(()=>{Rc.a.hh(I=>{Gc.a.Ma()||Wk.Ga(I)})})();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Ml.a;Type.registerNamespace("Common.App.WopiIdentity");Fk.main();Type.registerNamespace("Common.App.FloatPane");Rd.main();Type.registerNamespace("Common.App.DisplayEnvironmentName");Ze.main();
Xf.main();Rc.a.hh(Hg.Ga);Rc.a.hh(dm.Ga);String(F);String(D);String(G);String(Q);String(qe);String(Be);String(O);String(J);String(ic);String(Bc);String(H);String(N);String(L);String(Z);String(ba);String(K);String(E);String(U);String(X);String(ia);String(Ma);String(qa);String(Ha);String(Vh);String(ha);String(La);String(fa);String(ja);String(ta);String(Ka);String(Ga);String(Na);String(cb);String(jb);String(Sa);String(bb);String(oa);String(ka);String(ya);String(Oa);window.___1712031311687_closurehack=
F;window.___1712031311687_closurehack=D;window.___1712031311687_closurehack=G;window.___1712031311687_closurehack=Q;window.___1712031311687_closurehack=qe;window.___1712031311687_closurehack=Be;window.___1712031311687_closurehack=O;window.___1712031311687_closurehack=J;window.___1712031311687_closurehack=ic;window.___1712031311687_closurehack=Bc;window.___1712031311687_closurehack=H;window.___1712031311687_closurehack=N;window.___1712031311687_closurehack=L;window.___1712031311687_closurehack=Z;window.___1712031311687_closurehack=
ba;window.___1712031311687_closurehack=K;window.___1712031311687_closurehack=E;window.___1712031311687_closurehack=U;window.___1712031311687_closurehack=X;window.___1712031311687_closurehack=ia;window.___1712031311687_closurehack=Ma;window.___1712031311687_closurehack=qa;window.___1712031311687_closurehack=Ha;window.___1712031311687_closurehack=Vh;window.___1712031311687_closurehack=ha;window.___1712031311687_closurehack=La;window.___1712031311687_closurehack=fa;window.___1712031311687_closurehack=
ja;window.___1712031311687_closurehack=ta;window.___1712031311687_closurehack=Ka;window.___1712031311687_closurehack=Ga;window.___1712031311687_closurehack=Na;window.___1712031311687_closurehack=cb;window.___1712031311687_closurehack=jb;window.___1712031311687_closurehack=Sa;window.___1712031311687_closurehack=bb;window.___1712031311687_closurehack=oa;window.___1712031311687_closurehack=ka;window.___1712031311687_closurehack=ya;window.___1712031311687_closurehack=Oa},1188:function(y,m,a){a.r(m);a.d(m,
"CalcHelper",function(){return r});y=a(0);var c=a(15),b=a(247),e;(function(t){t[t.paren=0]="paren";t[t.lead=1]="lead";t[t.intern=2]="intern";t[t.trail=3]="trail";t[t.undefined=4]="undefined"})(e||(e={}));Object(y.b)("CurrencyFormatOption",e);var k;(function(t){t[t.none=-1]="none";t[t.mdy=0]="mdy";t[t.dmy=1]="dmy";t[t.ymd=2]="ymd";t[t.myd=3]="myd";t[t.dym=4]="dym";t[t.ydm=5]="ydm"})(k||(k={}));Object(y.b)("DateOrderOption",k);class d{constructor(t,l){({CalcHelper:t}=a(1188));l&&(l.zk||c.ULS.shipAssertTag(537169942,
0,!1,"LocaleHolder constructor - locale information is not available"));this.iqh=t.Emf(l,t.hmf(l.bxa));this.jqh=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.jqh}get localeData(){return this.iqh}}Object(y.a)(d,"LocaleHolder",null,[]);var u=a(1231),n=a(60),v=a(1),f=a(28),w=a(125);class r{constructor(t,l){this.$=t;(this.xA=l)||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");l=v.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?
v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelOnlineCalcWP5",!1)?n.a.current.Tu(79):n.a.current.Tu(77):n.a.current.Tu(78);this.logger=new u.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.aAj=new d(t,this.xA);excelOnlineCalc.config.initCalc(this.logger,this.xA?x=>this.xA.isFeatureEnabled(x):()=>!1,l);this.mE=excelOnlineCalc.config.calcConfig(this.aAj.localeInfo)}get config(){return this.mE}Pbi(){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.sa)return c.ULS.shipAssertTag(537170069,
0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const t=this.$.sa.la;return t?t.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.sa.la.index}createParser(){const t={};t.config=this.config;return excelOnlineCalc.parse.createParser(t)}createAnalyzer(){const t={};t.config=this.config;return excelOnlineCalc.analyze.createAnalyzer(t)}createNumberFormatter(){const t=excelOnlineCalc.numfmt.createFormatGlobals(this.config,
(l,x)=>excelOnlineCalc.calc.getTime(this.config,l,x,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(t)}bai(t,l,x,A){if(!A)return{range:{row:l,col:x},sheet:{document:this.documentLoc,index:t}};l=excelOnlineCalc.location.gridCell(l,x);t=excelOnlineCalc.location.sheetIndex(this.documentLoc,t);return excelOnlineCalc.location.sheetGridCell(t,l)}static Emf(t,l){l=void 0===l?null:l;const x=t.h7h(),A=t.zk.TrueValueString,z=t.zk.FalseValueString,F=t.zk.DecimalSeparator.toString(),D=t.zk.ListSeparator.toString(),
G=t.zk.ColumnSeparator.toString(),Q=t.zk.RowSeparator.toString(),O=t.zk.ThousandsDataArray,J=t.zk.ThousandSeparator.toString(),H=t.zk.Lcid,N=t.zk.Country,L=t.zk.DigitsNumber,Z=t.zk.ExpSeparatedBySpace,ba=t.zk.FractionSeparator.toString(),K=t.zk.PercentSeparatedBySpace,E=f.a.nrc(Enum.toString(e,t.zk.CurrencyFormat)),U=t.zk.CurrencySymbolLead,X=t.zk.CurrencySeparatedBySpace,ia=t.zk.CurrencySymbolString,Ma=t.zk.DigitsCurrency,qa=-1===t.zk.DateOrder?"MDY":w.e(Enum.toString(k,t.zk.DateOrder)),Ha=t.zk.DateSeparator.toString(),
ha=t.zk.DateAlternativeSeparator.toString(),La=t.zk.Year4Digits,fa=t.zk.Month2Digits,ja=t.zk.Day2Digits,ta=t.zk.LongDateFormat,Ka=t.zk.TimeSeparator.toString(),Ga=t.zk.TimeAltSeparator,Na=t.zk.Hour2Digits,cb=t.zk.Use24HourClock,jb=t.zk.AmPmSeparatedBySpace,Sa=[t.zk.AmString,t.zk.PmString],bb=t.zk.DayNameShortArray,oa=t.zk.DayNameLongArray,ka=t.zk.MonthNameShortArray,ya=t.zk.MonthNameLongArray,Oa=t.zk.PictureSpecialArray,za=b.a.map(("\x00"+t.zk.PictureSingleString).split(""),Ea=>"\x00"===Ea?null:Ea),
ea=t.zk.PictureColorArray,Aa=t.zk.PictureDbnumArray,ub=t.zk.RowLetter.toString(),rb=t.zk.ColumnLetter.toString(),Ja=t.zk.LeftBrace.toString(),Xa=t.zk.RightBrace.toString(),Y=t.zk.LeftBracket.toString(),Ia=t.zk.RightBracket.toString(),$a=r.wYi(t.zk);return excelOnlineCalc.calc.localeData(l,x,A,z,ub,rb,Ja,Xa,Y,Ia,F,D,G,Q,O,J,H,N,L,Z,ba,K,E,U,X,ia,Ma,qa,Ha,ha,La,fa,ja,ta,Ka,Ga,Na,cb,jb,Sa,bb,oa,ka,ya,Oa,za,ea,Aa,$a,t.zk.SysDateFormatString,t.zk.SysTimeFormatString)}static hmf(t){const l=[];if(!t)return l;
for(const x of t)t=null,x.IsDynamicUdf||(t=excelOnlineCalc.calc.worksheetFunctionName(x.FunctionIndexInServer,x.NameUI)),t&&l.push(t);return l}static wYi(t){const l=Array(6);l[1]="#"+t.AllStructRefString;l[3]="#"+t.HeadersStructRefString;l[2]="#"+t.DataStructRefString;l[4]="#"+t.TotalsStructRefString;l[5]="#"+t.ThisRowStructRefString;return l}}Object(y.a)(r,"CalcHelper",null,[])},1220:function(y,m,a){a.d(m,"a",function(){return k});y=a(0);var c=a(15),b=a(59),e=a(79);a=a(936);class k extends a.a{constructor(d,
u){super(d,u);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=k.m_message;this.Yga=!0}get linkText(){return k.Kbg}qZ(d){super.qZ(d);b.a.openWindow(4,e.a.SBc(k.Jbg))}WD(d){super.WD(d);k.j5d&&k.j5d(null)}static initialize(d,u,n,v){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");k.m_message=d;k.Kbg=u;k.Jbg=n;k.j5d=v}}k.m_message=null;k.Kbg=null;k.Jbg=null;k.j5d=null;Object(y.a)(k,
"WacGdprNoticeBusinessBarEntry",a.a,[])},1221:function(y,m,a){a.d(m,"a",function(){return"ewa-bb"});a.d(m,"b",function(){return"ewa-bb-content"});a.d(m,"c",function(){return"ewa-bb-entry"});a.d(m,"d",function(){return"ewa-bb-entry-body"});a.d(m,"e",function(){return"ewa-bb-entry-button"});a.d(m,"f",function(){return"ewa-bb-entry-button-holder"});a.d(m,"g",function(){return"ewa-bb-entry-close"});a.d(m,"h",function(){return"ewa-bb-entry-icon"});a.d(m,"i",function(){return"ewa-bb-entry-link"});a.d(m,
"j",function(){return"ewa-bb-entry-message"});a.d(m,"k",function(){return"ewa-bb-entry-title"});a.d(m,"l",function(){return"ewa-bb-icon"});a.d(m,"m",function(){return"ewa-bb-react"})},1222:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);a=a(936);class c extends a.a{constructor(b,e){super(b,e);this.Zx=!0;this.title=c.Pda;this.message=c.Oda}get actionButton(){return c.x9}vr(b){super.vr(b);(b=c.B3)&&b(null)}static initialize(b,e,k,d){c.Pda=b;c.Oda=e;c.x9=k;c.B3=d}}c.Pda=null;c.Oda=null;c.x9=null;
c.B3=null;Object(y.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1223:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);a=a(936);class c extends a.a{constructor(b,e){super(b,e);this.Zx=!0;this.title=c.Pda;this.message=c.Oda}get actionButton(){return c.x9}vr(b){super.vr(b);(b=c.B3)&&b(null)}static initialize(b,e,k,d){c.Pda=b;c.Oda=e;c.x9=k;c.B3=d}}c.Pda=null;c.Oda=null;c.x9=null;c.B3=null;Object(y.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1224:function(y,m,a){a.d(m,
"a",function(){return k});y=a(0);m=a(1053);var c=a(1101),b=a(1102),e=a(15);class k extends m.a{constructor(d,u,n){super(d,u,n);k.x9&&k.B3&&(this.Zx=!0);this.title=k.Pda;this.message=k.Oda;this.Yga=Object(c.c)()}get actionButton(){return k.x9}static initialize(d,u,n,v,f){k.Pda=d;k.Oda=u;k.x9=n;k.B3=v;k.u7c=f}vr(d){super.vr(d);k.B3&&k.B3(null)}WD(d){super.WD(d);k.u7c&&k.u7c(null)}qZ(d){super.qZ(d);e.ULS.sendTraceTag(507561158,0,50,"DataCleansingBusinessBarEntry.onLinkClick was triggered.");Object(b.b)(this.businessBar.$)}}
k.Pda=null;k.Oda=null;k.x9=null;k.B3=null;k.u7c=null;Object(y.a)(k,"DataCleansingBusinessBarEntry",m.a,[])},1225:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);a=a(936);class c extends a.a{constructor(b,e){super(b,e);this.Zx=!0;this.title=c.Pda;this.message=c.Oda}get actionButton(){return c.x9}vr(b){super.vr(b);(b=c.B3)&&b(null)}static initialize(b,e,k,d){c.Pda=b;c.Oda=e;c.x9=k;c.B3=d}}c.Pda=null;c.Oda=null;c.x9=null;c.B3=null;Object(y.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,
[])},1226:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);a=a(936);class c extends a.a{constructor(b,e){super(b,e);this.Zx=!0;this.title=c.m_title;this.message=c.m_message}get actionButton(){return c.rrb}vr(b){super.vr(b);c.WMa&&c.WMa(null)}static initialize(b,e,k,d){c.m_title=b;c.m_message=e;c.rrb=k;c.WMa=d}}c.m_title=null;c.m_message=null;c.rrb=null;c.WMa=null;Object(y.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1227:function(y,m,a){a.d(m,"a",function(){return c});
y=a(0);a=a(936);class c extends a.a{constructor(b,e){super(b,e);c.rrb&&c.WMa&&(this.Zx=!0);this.title=c.m_title;this.message=c.m_message}get actionButton(){return c.rrb}vr(b){super.vr(b);c.WMa&&c.WMa(null)}static initialize(b,e,k,d){c.m_title=b;c.m_message=e;c.rrb=k;c.WMa=d}}c.m_title=null;c.m_message=null;c.rrb=null;c.WMa=null;Object(y.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1233:function(y,m,a){a.d(m,"a",function(){return c});const c=b=>{const e=Array(b.length);for(let k=
0,d=b.length;k<d;k++)e[k]=b[k].cloneNode(!0);return e}},1236:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{}c.v6c="b-ring_Apc_Trans";c.Zbh="cdn_static_resource_ewa_image";Object(y.a)(c,"ResourceHosts",null,[])},1237:function(y,m,a){a.d(m,"a",function(){return e});y=a(0);var c=a(61),b=a(1442);class e{static uKd(k,d,u,n){n=void 0===n?null:n;e.xOc||(e.xOc=Array.isArray(c.a.Vp(u.ua.NetworkMeasurementUrlList))?c.a.Vp(u.ua.NetworkMeasurementUrlList):null);const v=[];for(let f=0;f<e.xOc.length;f++){const w=
e.xOc[f];let r=w.key;r||(r=w.Key);if(n&&!n.includes(r))continue;let t=w.value;t||(t=w.Value);r&&t&&v.push(new b.a(u,r,t,k,d))}return v}}e.xOc=null;Object(y.a)(e,"NetworkConnectionHelpers",null,[])},1397:function(y,m,a){a.r(m);a.d(m,"BusinessBarControl",function(){return Gb});y=a(0);var c=a(15),b=a(98),e=a(159),k=a(17),d=a(95),u=a(85),n=a(34),v=a(37),f=a(16);m=a(266);var w=a(1221),r=a(7),t=a(306),l=a(1222),x=a(936),A=a(1419),z=a(1053);class F extends z.a{constructor(Ub,Ra,Rb){super(Ub,Ra,Rb)}WD(Ub){super.WD(Ub)}}
Object(y.a)(F,"EditAttemptReadOnlyBusinessBarEntry",z.a,[]);var D=a(43);class G extends x.a{constructor(Ub,Ra,Rb,ib){super(Ub,Ra);this.error=Rb;this.options=ib;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.Zx=!(ib&4)}vr(Ub){super.vr(Ub);this.error.Appearance&=-33;D.a(this.businessBar.$).gD([this.error])}}Object(y.a)(G,"ErrorBusinessBarEntry",x.a,[]);var Q=a(84);class O extends G{constructor(Ub,Ra,Rb,ib,la){super(Ub,
Ra,Rb,ib);this.command=la;this.x6=!0}A7(Ub){super.A7(Ub);this.businessBar.$.Ia.qh(new Q.a(this.command,Ub,this.businessBar.$.ji,10,null))}}Object(y.a)(O,"ErrorAndCommandBusinessBarEntry",G,[]);var J=a(12);class H{constructor(Ub,Ra,Rb,ib,la,db,$b,Ic,Tc,Zc,cc){this.bgd=this.fU=this.oka=this.w_=0;this.Ejh=Ub;this.x1k=Ra;this.lR=Rb;this.Znh=$b;this.YDb=n.a.uE(Tc);this.dmh=Tc;this.pJe=Ic;this.$nh=Zc;cc&&(this.bgd=cc);0!==ib&&(this.w_=ib);0!==la&&(this.oka=la);0!==db&&(this.fU=db)}get mMc(){return 0===
this.bgd?"":H.ia(this.bgd)}get title(){return H.ia(this.x1k)}get message(){return H.ia(this.lR)}get messageId(){return this.lR}get iconName(){return this.$nh}get hHa(){return this.Ejh}get actionButton(){return H.ia(this.w_)}get bWa(){return H.ia(this.oka)}get link(){return H.ia(this.fU)}get ay(){return this.Znh}get businessBarType(){return this.pJe}get hash(){return this.YDb}get alt(){const {BusinessBarControl:Ub}=a(1397);switch(this.ay){case Ub.uwa:return H.ia(26);case Ub.pD:return H.ia(25);case Ub.Sp:return H.ia(24);
default:return H.ia(0)}}get YIa(){return this.dmh}set businessBarType(Ub){this.pJe=Ub}static ia(Ub){return J.a.instance.ia(Ub)}}Object(y.a)(H,"EwaBusinessBarEntry",null,[]);class N extends H{constructor(Ub,Ra,Rb,ib,la,db,$b,Ic,Tc){super(Ub,0,Ra,Rb,ib,la,db,$b,Ic,Tc)}get title(){return""}}Object(y.a)(N,"EwaNoTitleBusinessBarEntry",H,[]);var L=a(70),Z=a(1),ba=a(63);class K extends x.a{constructor(Ub,Ra){super(Ub,Ra);this.x6=this.Zx=!0;this.Yga=this.Klj=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WebWorkbookLinkNewTaskPaneEnabled",
!1)}vr(Ub){super.vr(Ub);this.set_visible(!1);this.businessBar.$.qQ();this.businessBar.$.Ia.qh(new Q.a(1038998010,Ub,this.businessBar.$.ji,10,null))}A7(Ub){super.A7(Ub);this.businessBar.$.Ia.qh(new Q.a(-722953877,Ub,this.businessBar.$.ji,10,null))}qZ(Ub){super.qZ(Ub);Ub=new Q.a(-859308420,ba.a.ph,this.businessBar.$.ji,12,null);this.businessBar.$.Ia.qh(Ub,{[ba.a.hl]:"AssetID="+r.a.Izf,["InputMethod"]:ba.a.ph,[ba.a.Pi]:r.a.NK,["ShouldCanvasTakeFocus"]:!0})}WD(Ub){this.businessBar.removeEntry(55);L.g(Ub)}}
Object(y.a)(K,"ExternalLinksEnableContentBusinessBarEntry",x.a,[]);class E extends x.a{constructor(Ub,Ra){super(Ub,Ra);this.Zx=!0;this.x6=!1}vr(Ub){super.vr(Ub);this.businessBar.$.Ia.qh(new Q.a(-722953877,Ub,this.businessBar.$.ji,10,null))}WD(Ub){this.businessBar.removeEntry(5);L.g(Ub)}}Object(y.a)(E,"ExternalLinksShowErrorBusinessBarEntry",x.a,[]);var U=a(13);class X extends x.a{constructor(Ub,Ra,Rb){super(Ub,Ra);this.H0a=Rb;this.Zx=!0}vr(Ub){super.vr(Ub);U.HelperMethods.O7(this.businessBar.$.SN,
this.H0a,this.businessBar.$.NQ)}}Object(y.a)(X,"HelpButtonBusinessBarEntry",x.a,[]);class ia extends x.a{constructor(Ub,Ra,Rb){super(Ub,Ra);this.H0a=Rb;this.Yga=!0}qZ(Ub){super.qZ(Ub);U.HelperMethods.O7(this.businessBar.$.SN,this.H0a,this.businessBar.$.NQ)}}Object(y.a)(ia,"HelpTextBusinessBarEntry",x.a,[]);class Ma extends x.a{constructor(Ub,Ra,Rb,ib){super(Ub,Ra);this.H0a=Rb;this.command=ib;this.Yga=!0;this.Zx=1461300262!==ib}vr(Ub){super.vr(Ub);this.businessBar.$.Ia.qh(new Q.a(this.command,Ub,this.businessBar.$.ji,
10,null))}qZ(Ub){super.qZ(Ub);const Ra=new Q.a(-859308420,Ub,this.businessBar.$.ji,12,null);this.businessBar.$.Ia.qh(Ra,{[ba.a.hl]:"HelpID="+this.H0a,["InputMethod"]:Ub,[ba.a.Pi]:r.a.NK,[r.a.Ara]:!0})}}Object(y.a)(Ma,"HelpTextTaskPaneAndCommandBusinessBarEntry",x.a,[]);class qa extends x.a{constructor(Ub,Ra){super(Ub,Ra);this.x6=this.Zx=!0}vr(Ub){super.vr(Ub);this.set_visible(!1);this.businessBar.$.qQ();this.businessBar.$.Ia.qh(new Q.a(-1081442996,Ub,this.businessBar.$.ji,10,null))}A7(Ub){super.A7(Ub);
this.businessBar.$.Ia.qh(new Q.a(1702917262,Ub,this.businessBar.$.ji,10,null))}WD(Ub){this.businessBar.removeEntry(59);L.g(Ub)}}Object(y.a)(qa,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",x.a,[]);var Ha=a(1225);class ha extends x.a{constructor(Ub,Ra){super(Ub,Ra);(this.policyManager=Ub.$.qa.zh(274))?(this.message=this.policyManager.MSc,this.title=this.policyManager.title,this.Yga=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}qZ(Ub){super.qZ(Ub);
(Ub=this.policyManager.EXj)&&Ub(null)}}Object(y.a)(ha,"PolicyBusinessBarEntry",x.a,[]);var La=a(1223),fa=a(1227),ja=a(1226);a(662);var ta=a(101),Ka=a(26);class Ga extends x.a{constructor(Ub,Ra){super(Ub,Ra);this.Zx=!0;this.title=""}vr(Ub){super.vr(Ub);ta.c(Ka.a.ZKj);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(y.a)(Ga,"UnsupportedBrowserBusinessBarEntry",x.a,[]);var Na=a(1220),cb=a(144),jb=a(1189),Sa=a(1103),bb=a(1409),oa=a(24);class ka{constructor(){this.z8c=
new bb.a;this.x8c=new bb.a;this.w8c=new bb.a;this.qPh(this.z8c);this.pPh(this.x8c);this.oPh(this.w8c);this.$cd=new bb.a;this.Zcd=new bb.a;this.Ycd=new bb.a;this.QRh(this.$cd);this.PRh(this.Zcd);this.ORh(this.Ycd);this.U9c=new bb.a;this.KPh(this.U9c);this.CVa(this.U9c);this.CVa(this.w8c);this.CVa(this.x8c);this.CVa(this.z8c);this.CVa(this.Zcd);this.CVa(this.$cd);this.CVa(this.Ycd)}XYi(Ub,Ra){switch(Ub){case 1:return this.L1i(Ra);case 2:return this.GFi(Ra)}return Sa.a.Gte?this.U9c:null}qPh(Ub){Ub.add("Headline",
Object(oa.a)("WildFireWordBizBarHeadline"));Ub.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Ub.add("CallToAction",Object(oa.a)("WildFireWordBizBarAndroidCallToAction"))}pPh(Ub){Ub.add("Headline",Object(oa.a)("WildFirePPTBizBarHeadline"));Ub.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Ub.add("CallToAction",Object(oa.a)("WildFirePPTBizBarAndroidCallToAction"))}oPh(Ub){Ub.add("Headline",Object(oa.a)("WildFireExcelBizBarHeadline"));Ub.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));
Ub.add("CallToAction",Object(oa.a)("WildFireExcelBizBarAndroidCallToAction"))}QRh(Ub){Ub.add("Headline",Object(oa.a)("WildFireWordBizBarHeadline"));Ub.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Ub.add("InstallButton",Object(oa.a)("WildFireBizBarInstallButtonText"));Ub.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));Ub.add("CallToAction",Object(oa.a)("WildFireWordBizBarIPadCallToAction"));Ub.add("OverlayBig","Get the Word app");Ub.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");
Ub.add("OverlaySmallSplit1","Discover Word");Ub.add("OverlaySmallSplit2","designed for the iPad.");Ub.add("SkipButton","Skip for now")}KPh(Ub){Ub.add("Headline","Get the Office Online extension for Chrome");Ub.add("UseAppButton","Get the extension");Ub.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}PRh(Ub){Ub.add("Headline",Object(oa.a)("WildFirePPTBizBarHeadline"));Ub.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Ub.add("InstallButton",
Object(oa.a)("WildFireBizBarInstallButtonText"));Ub.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));Ub.add("CallToAction",Object(oa.a)("WildFirePPTBizBarIPadCallToAction"));Ub.add("OverlayBig","Get the PowerPoint app");Ub.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Ub.add("OverlaySmallSplit1","Discover PowerPoint");Ub.add("OverlaySmallSplit2","designed for the iPad.");Ub.add("SkipButton","Skip for now")}ORh(Ub){Ub.add("Headline",
Object(oa.a)("WildFireExcelBizBarHeadline"));Ub.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Ub.add("InstallButton",Object(oa.a)("WildFireBizBarInstallButtonText"));Ub.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));Ub.add("CallToAction",Object(oa.a)("WildFireExcelBizBarIPadCallToAction"))}CVa(Ub){Ub.add("Corporation","Microsoft Corporation")}L1i(Ub){switch(Ub){case 3:return this.$cd;case 2:return this.Zcd;case 1:return this.Ycd}return null}GFi(Ub){switch(Ub){case 3:return this.z8c;
case 2:return this.x8c;case 1:return this.w8c}return null}static get instance(){ka.Va||(ka.Va=new ka);return ka.Va}}ka.Va=null;Object(y.a)(ka,"WildFireStringFactory",null,[]);var ya=a(6),Oa=a(59);class za{constructor(Ub,Ra,Rb,ib,la,db){this.Lhd=null;this._id=Ub;this.Did=Ra;this.rnh=void 0===la?null:la;this.tEb=ib;this.JGb=void 0===db?null:db;this.kSa=null;this.ueb=Rb;this.mHb=ka.instance.XYi(Ra,Ub)}Blf(){this.kSa=new jb.a(this.title,this.message,null);this.kSa.addButton(this.Ocf,Object(cb.a)(this,
this.Mig,"onButtonOneClick"),"");this.ueb&&this.kSa.UAh(this.Scf,Object(cb.a)(this,this.Pig,"onButtonTwoClick"));this.kSa.QX=Object(cb.a)(this,this.jrf,"dismissBar");this.kSa.image=3;this.kSa.id=16;this.kSa.closeable=!0}get title(){return this.mHb.ma("Headline")}get message(){return this.mHb.ma("CallToAction")}get Ycl(){return this.ueb}get Ocf(){return this.ueb?this.mHb.ma("InstallButton"):this.mHb.ma("UseAppButton")}get Scf(){return this.ueb?this.mHb.ma("OpenAppButton"):""}Mig(){this.ueb?this.Zfj():
this.Ncl()}Pig(){this.ueb&&this.w3j()}get openUrl(){this.Lhd||(this.Lhd=this.rnh());return this.Lhd}Zfj(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.tEb&&this.JGb&&this.JGb();Sa.a.iDg(this._id,this.Did)}w3j(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.tEb&&this.JGb&&this.JGb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Sa.a.K8e(this._id),this.openUrl,0,!1))}Ncl(){Sa.a.Gte?this.WRh():(c.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),Sa.a.hre("BizBarClicked"),1!==this.Did&&2!==this.Did||Sa.a.hZh(this.openUrl,this.tEb,this._id,this.JGb))}WRh(){this.tEb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Oa.a.kY(ya.AFrameworkApplication.ea.appSettings.WildFireChromeExtensionUrl.toString())}Vgi(){this.tEb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Sa.a.hre(Sa.a.OXh)}jrf(){Sa.a.Gte?
this.Vgi():(Sa.a.hre(Sa.a.rFf(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static mbi(){const Ub=ya.AFrameworkApplication.ra.$g,Ra=new za(Ub.qn,Sa.a.ROf(),8<v.a.ZUb,1===Ub.xNa,()=>Ub.mB,Ub.byk());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return Ra}}Object(y.a)(za,"WildFireBusinessBar",null,[]);class ea extends x.a{constructor(Ub,Ra){super(Ub,Ra);this.TRa=za.mbi();this.Zx=!0;this.x6=this.TRa.Ycl;this.title=this.TRa.title;this.message=this.TRa.message}get actionButton(){return this.TRa.Ocf}get bWa(){return this.TRa.Scf}vr(Ub){super.vr(Ub);
this.TRa.Mig(null)}A7(Ub){super.A7(Ub);this.TRa.Pig(null)}WD(Ub){super.WD(Ub);this.TRa.jrf(null)}}Object(y.a)(ea,"WildFireMobileAppBusinessBarEntry",x.a,[]);var Aa=a(284),ub=a(28),rb=a(208),Ja=a(164),Xa=a(44),Y=a(191),Ia=a(1228),$a=a(155),Ea=a(5),Lb=a(92);class Ib extends x.a{constructor(Ub,Ra,Rb,ib){super(Ub,Ra);this.$P=Lb.a.lh(Ea.re);c.ULS.shipAssertTag(512276321,0,!!this.$P);this.id=Y.a.create();this.$=Rb;this.title=J.a.instance.ia(2282);this.message="";this.nwe=J.a.instance.ia(2278);this.y$g=
J.a.instance.ia(2279);this.v$g=J.a.instance.ia(2280);this.Jjf=J.a.instance.ia(2281);this.update(ib)}update(Ub){this.scriptLink=Ub.scriptLink;this.runStatus=Ub.runStatus;this.buttonText=Ub.buttonText||"";this.vAj(Ub.clickId);this.Ztk();"preparing"===this.runStatus?(this.QBa(0),this.message=String.format(J.a.instance.sh(208),this.buttonText),this.Zx=!0,this.kGa=this.nwe,this.nMb=this.Vta=this.gtb):"running"===this.runStatus?(this.QBa(0),this.message=String.format(J.a.instance.sh(207),this.buttonText),
this.Zx=!0,this.kGa=this.nwe,this.nMb=this.Vta=this.gtb):"succeeded"===this.runStatus?(this.QBa(0),this.message=String.format(J.a.instance.sh(210),this.buttonText),"true"===Ub.hasLogs?(this.Zx=!0,this.kGa=this.v$g,this.Vta=this.ztg,this.x6=!0,this.trd=this.y$g,this.urd=this.Atg):(this.Zx=!0,this.kGa=this.y$g,this.Vta=this.Atg)):"runFailed"===this.runStatus?(this.QBa(1),this.message=String.format(J.a.instance.sh(209),this.buttonText),this.znb=Gb.uwa,"true"===Ub.hasLogs?(this.Zx=!0,this.kGa=this.v$g,
this.Vta=this.ztg,"false"===Ub.isOwner&&(this.x6=!0,this.trd=this.Jjf,this.urd=this.Ujg)):"false"===Ub.isOwner&&(this.Zx=!0,this.kGa=this.Jjf,this.Vta=this.Ujg)):"fetchFailed"===this.runStatus?(this.QBa(1),this.znb=Gb.uwa,this.message=J.a.instance.ia(2284)):"canceled"===this.runStatus?(this.QBa(0),this.znb=Gb.pD,this.message=String.format(J.a.instance.sh(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.QBa(5),this.znb=Gb.pD,this.message=String.format(J.a.instance.sh(211),this.buttonText),
this.Zx=!0,this.kGa=this.nwe,this.nMb=this.Vta=this.gtb):"initializing"===this.runStatus&&(this.QBa(0),this.znb=Gb.Sp,this.message=J.a.instance.ia(2283))}get ay(){return this.znb}get actionButton(){return this.kGa}get bWa(){return this.trd}vr(Ub){super.vr(Ub);this.Vta&&this.Vta()}A7(Ub){super.A7(Ub);this.bWa&&this.urd()}WD(Ub){super.WD(Ub);this.nMb&&this.nMb()}Ztk(){this.message="";this.znb=Gb.Sp;this.Zx=!1;this.kGa="";this.Vta=void 0;this.x6=!1;this.trd="";this.urd=void 0;this.hideCloseButton=!1;
this.nMb=void 0}gtb(){const Ub=Y.a.create().toString();this.$P.$2i(Ub);this.EMc(-2186799,Ub)}ztg(){const Ub=Y.a.create().toString();this.$P.Z2i(Ub);this.EMc(1036446140,Ub)}Atg(){const Ub=Y.a.create();if(this.scriptLink){const Ra=new Ia.b(this.scriptLink);this.$P.nRf(this.id.toString(),JSON.stringify(Ra),Ub)}this.EMc(-585097204,Ub.toString())}Ujg(){const Ub=Y.a.create().toString();this.$P.Y2i(Ub);this.EMc(-639858579,Ub)}vAj(Ub){ta.a($a.a.ONj,void 0,void 0,[{name:"id",string:this.id.toString()},{name:"hasScriptLink",
bool:!!this.scriptLink},{name:"runStatus",string:this.runStatus},{name:"clickId",string:Ub},{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}])}EMc(Ub,Ra){ta.d(Ub,void 0,void 0,void 0,void 0,void 0,[{name:"id",string:this.id.toString()},{name:"hasScriptLink",bool:!!this.scriptLink},{name:"runStatus",string:this.runStatus},{name:"clickId",string:Ra}])}}Object(y.a)(Ib,"OfficeScriptsRunStatusBusinessBarEntry",x.a,[]);var Mb=a(58),mc=a(25);class jc extends z.a{constructor(Ub,Ra,Rb,ib,
la,db){super(Ub,Ra,Rb);Mb.a.instance.create(()=>{this.showCallout(Ra,ib)},la,db,!0,!0)}showCallout(Ub,Ra){if(this.businessBar&&this.businessBar.U6(Ub.hHa)&&this.y7e()){Ub=new Q.a(-847286761,0,this.businessBar.$.ji,0,null);var Rb={};Rb.CalloutName=Ra;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Rb.Target=this.yna():Rb.Target=mc.a.GJc()?this.domElement.getElementsByTagName("button")[0]:this.w_.domElement;this.businessBar.$.Ia.qh(Ub,Rb)}}y7e(){return!0}}
Object(y.a)(jc,"CalloutBusinessBarEntry",z.a,[]);class Fc extends jc{constructor(Ub,Ra,Rb,ib,la,db){super(Ub,Ra,Rb,ib,la,db)}y7e(){if(!Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0))return!0;if(!this.businessBar)return!1;const Ub=Lb.a.lh(Ea.ve);return Ub&&Ub.MXc?!1:!0}}Object(y.a)(Fc,"OptimizeWorkbookCalloutBusinessBarEntry",jc,[]);var Gc=a(19),xc=a(118),Uc=a(130),Pa=a(224),Bb=a(129);class Nb extends x.a{constructor(Ub,Ra,Rb){super(Ub,
Ra);this.update(Rb)}update(Ub){this.title=Ub.title?Ub.title:"";this.message=Ub.message?Ub.message:"";const Ra=this.Z3h(Ub.businessBarType);this.QBa(Ra);this.hideCloseButton=!!Ub.hideCloseButton;if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7958899_LogMsFormsDataSyncBizBarShown")){const Rb=[];Rb.push(Uc.a.gm("Reason",Ub.reason,xc.g.String));Rb.push(Uc.a.gm("Type",Ra.toString(),xc.g.String));ta.a("MsFormsDataSyncBizBarShown",void 0,void 0,Rb)}Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormsDataSyncFGSurveyEnabled",
!1)&&Pa.a.instance.Dk("Common.ISystemInitiatedFeedback").execute(Rb=>{ya.AFrameworkApplication.Np.lm(new Bb.a(5,1,2E4,()=>{Rb.logActivity("ExcelFormsDataSync",null)}))})}Z3h(Ub){switch(Ub){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(y.a)(Nb,"MsFormsDataSyncStatusBusinessBarEntry",x.a,[]);class oc extends x.a{constructor(Ub,Ra,Rb,ib){super(Ub,Ra);this.x6=this.Zx=!0;this.hbk=Rb;this.hIh=ib}vr(Ub){super.vr(Ub);
this.businessBar.$.Ia.qh(new Q.a(this.hbk,Ub,this.businessBar.$.ji,10,null))}A7(Ub){super.vr(Ub);this.businessBar.$.Ia.qh(new Q.a(this.hIh,Ub,this.businessBar.$.ji,10,null))}}Object(y.a)(oc,"DualCommandActionsBusinessBarEntry",x.a,[]);var aa=a(1224),rc=a(366),yb=a(157);class Fb extends x.a{constructor(Ub,Ra){super(Ub,Ra);this.Zx=!0}vr(Ub){super.vr(Ub);void Lb.a.resolve(Ea.tb,{va:1}).then(Ra=>{Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmActiveContent",!1)?Ra.Nzg(()=>{this.businessBar.$.Ia.qh(new Q.a(-1995709983,
Ub,this.businessBar.$.ji,10,null))}):(Ra.Nzg(),this.businessBar.$.Ia.qh(new Q.a(-1995709983,Ub,this.businessBar.$.ji,10,null)),this.businessBar.removeEntry(74))})}}Object(y.a)(Fb,"ExternalConnectionsEnableContentRefreshOnOpenBusinessBarEntry",x.a,[]);var Qb=a(1101);class ac extends x.a{constructor(Ub,Ra){super(Ub,Ra);this.H0a=r.a.n8j;this.Zx=this.Yga=!0}vr(Ub){super.vr(Ub);this.set_visible(!1);this.businessBar.$.qQ();this.businessBar.$.Ia.qh(new Q.a(-1193102612,Ub,this.businessBar.$.ji,10,null))}qZ(Ub){super.qZ(Ub);
const Ra=new Q.a(-859308420,ba.a.ph,this.businessBar.$.ji,12,null);this.businessBar.$.Ia.qh(Ra,{[ba.a.hl]:"AssetID="+this.H0a,["InputMethod"]:Ub,[ba.a.Pi]:r.a.NK,["ShouldCanvasTakeFocus"]:!0})}WD(Ub){this.businessBar.set_visible(!1);L.g(Ub)}}Object(y.a)(ac,"AutoRefreshDisabledBusinessBarEntry",x.a,[]);class Wa extends x.a{constructor(Ub,Ra,Rb){super(Ub,Ra);this.update(Rb)}update(Ub){const Ra=Ub.entryToAdd;this.title=Ra.title;this.message=Ra.message;this.WKb=Ra.WKb;this.Zx=!0;this.WD=Rb=>{super.WD(Rb);
Ra.QX(null)}}get actionButton(){return this.WKb.text}vr(Ub){super.vr(Ub);(Ub=this.WKb.handler)&&Ub(null);this.WKb.ehi&&this.WD(null)}}Object(y.a)(Wa,"SharedBusinessBarEntry",x.a,[]);class Gb extends m.a{constructor(Ub,Ra){super(Ra);this.wCf=f.DOMElementExtensions.cJ+",div";this.o5=Array(76);this.SPe=this.ov=!1;this.E7=Rb=>{if(Rb.La.keyCode===b.a.MG){var ib=this.ij.querySelectorAll(this.wCf);const la=f.DOMElementExtensions.KE(ib);ib=f.DOMElementExtensions.Paa(ib);return f.DOMElementExtensions.x8a(Rb.La,
la,ib)}return!1};this.th=Ub;this.set_visible(!1);e.a.instance.xa(k.a.Wi,this.ij,this.E7);t.a(Ub).Wq(this)}get el(){return Aa.a.Rud}get ij(){return this.domElement}get ap(){return this.get_visible()}get $(){return this.th}Lp(Ub,Ra){Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?Ra||f.DOMElementExtensions.setFocus(f.DOMElementExtensions.KE(this.ij.querySelectorAll(this.wCf))):Ra||f.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Ra}wq(Ub){return f.DOMElementExtensions.Co(this.ij,
Ub)}Rs(){}nu(){}dispose(){this.ov||(e.a.instance.Oa(k.a.Wi,this.ij,this.E7),d.a.gj(this.o5),this.o5=Array(76),this.th=null,super.dispose(),this.ov=!0)}U6(Ub){if(!this.get_visible())return!1;Ub=this.o5[Ub];return!!Ub&&Ub.isVisible}jLd(Ub){return this.U6(Ub)?this.o5[Ub].yna():null}vM(Ub){return!!this.o5[Ub]}dAb(Ub,Ra){if(Ub=this.o5[Ub])Ub.update(Ra),Ub.Z8k()}HF(Ub,Ra,Rb,ib){Rb=void 0===Rb?null:Rb;ib=void 0===ib?null:ib;Object(yb.c)(()=>{this.azh(Ub,Ra,Rb,ib)},this.th.ya)}azh(Ub,Ra,Rb,ib){Rb=void 0===
Rb?null:Rb;ib=void 0===ib?null:ib;let la=!1;if(!this.SPe){var db=mc.a.GJc()?`${w.a} ${w.m}`:w.a;this.addCssClass(db);this.SPe=!0}if(this.vM(Ub))Rb=this.o5[Ub].get_visible();else{this.set_visible(!0);db=Gb.ZOf(this.$)[Ub];this.o5[Ub]=this.WX(Ub,Ra,Rb,ib);Rb=!1;la=!0;ib="";let $b=0;Ra&&(ib=Ra.MessageIdName,$b=Ra.MessageId);const Ic=db.YIa,Tc=Xa.a.instance.Kna();c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Ub}, time from app interactive: ${Tc}`);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&
4===db.businessBarType||Ja.a(this.$).ele(db.hash,ib,$b,u.a.A3c,!0,1,Ra,Ic)}Rb||!A.BusinessBarManager.EDc().includes(Ub)&&!la||(this.o5[Ub].set_visible(!0),this.$.qQ())}removeEntry(Ub){return this.hmk(Ub)}Wie(){d.a.gj(this.o5);this.o5=Array(76);this.set_visible(!1)}hmk(Ub){if(!this.vM(Ub))return!1;d.a.gh(this.o5[Ub]);this.o5[Ub]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.qQ();return!0}WX(Ub,Ra,Rb,ib){Rb=void 0===Rb?null:Rb;ib=void 0===ib?null:ib;const la=Gb.ZOf(this.$)[Ub],db=
!!(this.$.Kj&64),$b=this.$.Bpb();switch(Ub){case 23:Ub=$b?new z.a(this,la,617689800):new x.a(this,la);break;case 2:case 4:case 25:case 26:case 36:case 35:Ub=new x.a(this,la);break;case 12:case 29:case 30:case 31:case 32:case 57:Ub=db?new z.a(this,la,-8805455):new x.a(this,la);break;case 34:Ub=db?new oc(this,la,-8805455,-104572626):new x.a(this,la);break;case 22:Ub=new F(this,la,-8805455);break;case 46:case 45:Ub=db?new O(this,la,Ra,0,-8805455):new G(this,la,Ra,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Ub=
new G(this,la,Ra,0);break;case 19:Ub=new x.a(this,la);break;case 47:Ub=new G(this,la,Ra,0);break;case 6:case 14:Ub=new X(this,la,Ra.HelpTopicId);break;case 67:case 65:Ub=new ia(this,la,Ra.HelpTopicId);break;case 73:Ub=new ia(this,la,rc.a.rxg);break;case 72:Ub=new F(this,la,-1698025133);break;case 37:Ub=new ia(this,la,r.a.pci);break;case 38:Ub=new x.a(this,la);break;case 71:Ub=new x.a(this,la);break;case 68:Ub=new F(this,la,924877417);break;case 16:Ub=new x.a(this,la);Ub.title=n.a.Vr(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);
Ub.message=n.a.Vr(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Ub=new z.a(this,la,-1762562205);Ub.hideCloseButton=!0;break;case 20:Ub=new ea(this,la);break;case 21:case 56:Ub=new x.a(this,la);break;case 28:Ub=new x.a(this,la);break;case 24:Ub=new Ga(this,la);break;case 27:Ub=new ha(this,la);break;case 39:Ub=new Na.a(this,la);break;case 40:Ub=new l.a(this,la);break;case 41:Ub=new La.a(this,la);break;case 42:Ub=new Ha.a(this,la);break;case 48:Ub=new x.a(this,la);break;
case 49:Ub=new x.a(this,la);break;case 50:Ub=new x.a(this,la);break;case 51:Ub=new x.a(this,la);break;case 52:Ub=new x.a(this,la);break;case 53:Ub=new ja.a(this,la);break;case 54:Ub=new fa.a(this,la);break;case 55:Ub=new K(this,la);break;case 5:Ub=new E(this,la);break;case 58:Ub=new z.a(this,la,-1753056834);Ra?(Ra=Ra.Directive,ub.a.Pz(Ra)||"&nbsp;"===Ra||(Ub.message=Ra)):Rb&&(Ub.message=Rb);break;case 59:Ub=new qa(this,la);break;case 60:Ub=new x.a(this,la);break;case 63:Ub=new ia(this,la,r.a.LMj);
break;case 61:Ub=new Ma(this,la,r.a.bNh,-8805455);break;case 44:Ub=new ac(this,la);break;case 66:Ub=new Ma(this,la,r.a.Kgk,1461300262);break;case 62:Ub=new Fc(this,la,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");Ub.message=Rb;break;case 70:Ub=new aa.a(this,la,-1190551534);break;case 64:Ub=new Ib(this,la,this.$,ib);break;case 69:Ub=new Nb(this,la,ib);break;case 74:Ub=new Fb(this,la);break;case 75:Ub=new Wa(this,la,ib);break;default:Ub=new G(this,la,Ra,7)}Ub.Blf();return Ub}static ZOf(Ub){const Ra=
Ub.Bpb();Ub=rb.a.Rya()?261:260;const Rb=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WebWorkbookLinkNewTaskPaneEnabled",!1);return Gb.Ecf||(Gb.Ecf=[new H(0,276,277,278,0,0,Gb.uwa,1,"BB_UnableToRefreshLock"),new H(1,276,277,278,0,0,Gb.uwa,1,"BB_UnableToRefreshLockExpected"),new H(2,268,269,0,0,0,Gb.pD,5,"BB_WorkbookAlmostTooLarge"),new H(3,270,271,272,0,0,Gb.uwa,1,"BB_WorkbookTooLarge"),new H(4,259,Ub,0,0,0,Gb.pD,5,"BB_ExternalWorkbookLinksDisabled"),new H(5,263,262,264,0,0,Gb.uwa,5,
"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new H(6,265,266,267,0,0,Gb.Sp,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new H(7,251,252,253,0,0,Gb.Sp,5,"BB_UnsupportedFeatures"),new H(8,0,0,0,0,0,Gb.Sp,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new H(9,0,0,0,0,0,Gb.Sp,0,"BB_CollabDataStringsLocaleMismatch"),new H(10,0,0,0,0,0,Gb.Sp,0,"BB_CollabDataLocaleMismatch"),new H(11,279,280,281,0,0,Gb.uwa,1,"BB_LastGenericStatusError"),new H(12,282,283,284,0,0,Gb.pD,5,"BB_ScratchPadWarning"),
new H(13,285,286,287,0,0,Gb.uwa,1,"BB_AuthenticationLost"),new H(14,288,289,290,0,0,Gb.pD,5,"BB_OdfCompatibilityIssues"),new H(15,0,575,0,0,0,Gb.pD,5,"BB_PivotChartInteractivityMissingWarning"),new H(16,0,0,0,0,0,Gb.Sp,2,"BB_WorkbookIsIrmProtected"),new H(17,0,0,0,0,0,Gb.Sp,0,"BB_BIFeatureNotAvailable"),new H(18,291,292,287,0,0,Gb.pD,5,"BB_AnonymousCreateMode"),new H(19,254,255,0,0,0,Gb.pD,5,"BB_UnsupportedInteractiveReportEditing"),new H(20,0,0,0,0,0,Gb.Sp,0,"BB_MobileAppCampaignBizBar"),new H(21,
297,298,0,0,0,Gb.Sp,0,"BB_TransientServerCommunicationFailures"),new H(22,1643,1654,1655,0,0,Gb.Sp,5,"BB_EditAttemptInReadOnly"),new H(23,1643,Ra?2348:1654,Ra?2349:0,0,0,Gb.Sp,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new H(24,0,U.HelperMethods.t8k(),1632,0,0,Gb.Sp,3,"BB_UnsupportedBrowser"),new H(25,300,301,0,0,0,Gb.Sp,2,"BB_ReadOnlyPermissions"),new H(26,302,303,0,0,0,Gb.Sp,2,"BB_DocumentIsIrmProtectedWarning"),new H(27,0,0,0,0,0,Gb.pD,5,"BB_PolicyWarningMessage"),new H(28,1285,299,0,0,0,Gb.Sp,
0,"BB_WorkingOnIt"),new H(29,1643,1641,1642,0,0,Gb.Sp,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new H(30,1656,1657,1658,0,0,Gb.Sp,5,"BB_WorkbookIsReadOnlyRecommended"),new H(31,1643,1659,1660,0,0,Gb.Sp,5,"BB_WorkbookHasPasswordToModify"),new H(32,1643,1661,1664,0,0,Gb.Sp,3,"BB_LegacySharedWorkbookEditWarning"),new H(33,1651,1662,253,0,0,Gb.Sp,5,"BB_LegacyConnectionsWarning"),new H(34,1643,1960,1961,1962,0,Gb.Sp,0,"BB_TooManyLoadBlockingFloatingObjects"),new H(35,1652,1653,0,0,0,Gb.Sp,2,"BB_GroupedSlicers"),
new H(36,313,314,0,0,0,Gb.pD,5,"BB_ThirdPartyAddinDisabled"),new H(37,1789,1790,0,0,1791,Gb.Sp,5,"BB_FinanceLinkedEntityDisclaimerBar"),new H(38,1818,1819,0,0,0,Gb.pD,5,"BB_WolframDeprecationAlertBar"),new H(39,0,0,0,0,0,Gb.Sp,0,"BB_WacGdprNotice"),new H(40,0,0,0,0,0,Gb.Sp,0,"BB_AutomaticSensitivityLabel"),new H(41,0,0,0,0,0,Gb.Sp,0,"BB_RecommendedSensitivityLabel"),new H(42,0,0,0,0,0,Gb.Sp,0,"BB_MandatorySensitivityLabel"),new H(43,315,316,317,0,0,Gb.Sp,0,"BB_LocalStorageDisabled"),new H(44,632,
633,2511,0,1319,Gb.Sp,0,"BB_AutoRefreshDisabled"),new H(45,1014,1012,1016,1314,0,Gb.Sp,4,"BB_CorruptedFileRepaired"),new H(46,1015,1013,1016,1314,0,Gb.Sp,5,"CorruptedOdsFileRepaired"),new H(47,273,274,275,0,0,Gb.pD,5,"BB_MinorVersionLimitReached"),new H(48,304,305,0,0,0,Gb.pD,5,"BB_SensitivityApplicationGenericError"),new H(49,306,308,0,0,0,Gb.pD,5,"BB_SensitivityApplicationTooLargeFileError"),new H(50,307,308,0,0,0,Gb.pD,5,"BB_SensitivityApplicationLabelNotSupportedError"),new H(51,309,310,0,0,0,
Gb.pD,5,"BB_SensitivityApplicationLabelDisabledError"),new H(52,311,312,0,0,0,Gb.pD,5,"BB_SensitivityApplicationMandatoryConflictError"),new H(53,0,0,0,0,0,Gb.pD,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new H(54,0,0,0,0,0,Gb.pD,5,"BB_SensitivityApplicationSetLabelError"),new H(55,Rb?2470:2119,Rb?2468:2120,Rb?2469:2121,2124,Rb?2467:0,Gb.Sp,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16",Rb?2512:0),new H(56,297,298,0,0,0,Gb.Sp,0,"BB_NetworkDown"),new H(57,
318,319,320,0,0,Gb.Sp,2,"BB_DefaultToViewDueToCogs"),new H(58,1815,1816,1817,0,0,Gb.Sp,1,"BB_RefreshLinkedEntityErrorBar"),new H(59,1792,1793,1794,1795,0,Gb.Sp,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new N(60,250,0,0,0,Gb.Sp,5,"BB_CanvasHealth"),new H(61,1017,1018,1314,0,1019,Gb.Sp,5,"BB_MismatchedFileFormatConverted"),new H(62,2238,0,2240,0,0,Gb.Sp,5,"BB_OptimizeWorkbook"),new H(63,321,322,0,0,323,Gb.Sp,0,"BB_NovModePostDepreciation"),new H(64,0,0,0,0,0,Gb.Sp,0,"BB_OfficeScriptsRunning"),new H(65,
2214,2215,0,0,2217,Gb.Sp,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new H(66,324,325,0,0,326,Gb.Sp,5,"BB_ReadOnlyPivotTable"),new H(67,2214,2216,0,0,2217,Gb.Sp,0,"BB_PowerQueryRefreshHostNotSupported"),new H(68,1057,v.a.kJc?1059:1058,1056,0,0,Gb.Sp,4,"BB_RefreshPageAfterEnablingTheExtension"),new H(69,0,0,0,0,0,Gb.Sp,0,"BB_MsFormsDataSyncStatus"),new H(70,0,0,0,0,2485,Gb.pD,5,"BB_DataCleansingSuggestions",Object(Qb.a)()),new N(71,2324,0,0,0,Gb.Sp,4,"BB_EditInMiniWAC","EditExcel_16"),new H(72,
2326,2327,2325,0,0,Gb.pD,5,"BB_PowerQueryUnsupportedTeams"),new H(73,2326,2328,0,0,2217,Gb.pD,5,"BB_PowerQueryEnableThirdPartyCookies"),new H(74,2487,2488,2489,0,0,Gb.pD,5,"BB_ExternalConnectionsEnableContentRefreshOnOpen"),new H(75,0,0,0,0,0,Gb.pD,5,"BB_ApplicationNotification")])}}Gb.uwa=Gc.a.hqi;Gb.pD=Gc.a.jqi;Gb.Sp=Gc.a.iqi;Gb.Ecf=null;Object(y.a)(Gb,"BusinessBarControl",m.a,[42])},1415:function(y,m,a){a.d(m,"a",function(){return Ma});y=a(0);var c=a(15),b=a(37),e=a(95),k=a(17),d=a(154),u=a(361);
m=a(80);var n=a(10),v=a(86),f=a(5),w=a(92),r=a(672);class t{constructor(qa,Ha){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=Ha;this.parentElement=qa}M5h(){const qa=this.N5h();f.J.Ma()?void w.a.resolve(f.J,{va:0}).then(Ha=>{this.cardViewManager=Ha;Ha.EVg(this.parentElement,qa)}):r.a(this.$,243,242,0,Ha=>{this.cardViewManager=Ha;Ha.EVg(this.parentElement,qa)})}kTf(){this.cardViewManager&&this.cardViewManager.lnb(-1,
-1,this.parentElement)}N5h(){const qa={layoutId:"AutoDetectTooltip"};qa.description=this.longDescription;qa.convertToDomainName=this.convertToDomainName;qa.longDescription=this.longDescription;qa.urlValue=this.urlValue;qa.imageAltText=this.imageAltText;qa.helpText=this.helpText;qa.helpId=this.helpId;return qa}}Object(y.a)(t,"AutoDetectCardManager",null,[]);var l=a(30),x=a(246),A=a(34),z=a(291),F=a(19),D=a(60);class G extends m.a{constructor(qa,Ha,ha){super();this.rj=La=>{if(La.hi.id===this.VYa.firstChild.id){La=
this.waf;const fa={};fa.Id=La.mKb;this.nt.lzd(fa,!0,La);this.VYa.removeChild(this.VYa.firstChild);return!0}return!1};this.waf=qa;this.nt=Ha;this.VYa=document.createElement("div");this.VYa.className="clip16x16";this.rLa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',A.a.Vr("autodetectid"+this.waf.left),F.a.pGd,D.a.Gn(11));ha.hr(this.VYa,this.rLa);qa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");z.a.instance.xa(k.a.click,
qa,this.rj)}get domElement(){return this.VYa}dispose(){if(this.VYa){const qa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");z.a.instance.Oa(k.a.click,qa,this.rj)}super.dispose()}static get YRh(){return"clip16x16"}}Object(y.a)(G,"AutoDetectColumnHeaderButton",m.a,[]);var Q=a(1),O=a(1233),J=a(13),H=a(23),N=a(233);class L extends m.a{constructor(qa,Ha,ha){super();this.Bi=null;this.$=qa;this.da=H.f(qa);this.nt=Ha;this.Bi=ha;this.Zxd=new N.a}dispose(){super.dispose()}lhi(qa){for(const Ha of this.da.x0)for(const ha of Ha){const La=
ha,fa=La.t1,ja=O.a(La.uSd);this.Ayh(qa,ja,fa);La.CQg(ja)}}Ayh(qa,Ha,ha){if(Ha.length){var La=ha.length;ha[La-1]<qa.left||(ha=J.HelperMethods.nK(new x.a(ha),0,La,qa.left,J.HelperMethods.SS),0>ha||!(Ha=Ha[ha]))||(this.da.rtl?Ha.classList.add(l.vb):Ha.classList.add(l.ub),this.Zxd.mh(qa.left)||this.Zxd.add(qa.left,new G(qa,this.nt,this.Bi)),qa=this.Zxd.ma(qa.left).domElement,!Ha.getElementsByClassName(G.YRh).length&&this.LVk(Ha)&&Ha.appendChild(qa))}}LVk(qa){const Ha=parseInt(qa.style.width,10);var ha=
document.querySelector(".ewrch-col-cellsel")?"bold":"normal";ha=L.z7h(ha);qa=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.Bi.TWi(qa.firstChild.innerHTML),ha,!0,Q.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth"));return 18.4<Ha-(Ha/2+qa/2)?!0:!1}static z7h(qa){return`${"normal"} ${"normal"} ${qa} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(y.a)(L,"AutoDetectColumnHeaderManager",m.a,[]);var Z=a(505),ba=a(27),K=a(73),E=a(141),U=a(16),
X=a(12),ia=a(101);class Ma extends m.a{constructor(qa,Ha,ha,La,fa){super();this.isMac=b.a.isMac;this.Jeb=-1;this.suc=null;this.$Ha=-1;this.E3a=this.iLc=this.Pue=this.wMa=this.xaf=!1;this.O4=null;this.xm=()=>{this.BLa&&this.da&&this.b3()};this.Xi=()=>{this.PD()};this.rj=()=>{this.WXa();H.f(this.$).Lp(!0,!1)};this.MNa=(ta,Ka)=>{Ka?(this.h6g(this.suc),this.SWg()):(ta=[29],this.da.Fh.fr(ta),this.da.Fh.wt(null,ta),this.O4&&this.O4.kTf())};this.nq=()=>{this.hpb()&&this.Jq.hide();1===this.da.ha.Hk&&this.b3()};
this.YE=()=>{const ta=this.da.ha.Hk;this.da.ha.pa.activeCell&&1===ta&&this.b3()};this.onKeyUp=ta=>this.dMc?this.wMa?!1:17===ta.La.keyCode&&this.Pue?(this.E3a?(this.SWg(),this.dwb()):this.vQg(),!0):!1:this.wMa=!1;this.onKeyDown=ta=>{if(!this.dMc)return this.wMa=!1;this.Pue=!1;this.wMa=ta.ctrlKey;switch(ta.La.keyCode){case 27:return this.E3a?(this.MNa(null,!1),this.dwb()):this.O4&&(this.O4.kTf(),this.vQg()),!0;case 13:if(this.E3a)return this.E3a=!1,this.WXa(),!0;break;case 17:return this.Pue=!0}return!1};
const {AutoDetectActionButton:ja}=a(1469);this.$=qa;this.nKb=Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);Ha||c.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.nt=La;La.Z3b();this.Jq=new ja(qa,Ha,this.rj,ha,"");this.tMh=new L(this.$,La,fa);this.da=H.f(this.$);this.da.ha.BX(this.xm);this.da.Dh.RIb(this.xm);this.da.gA(this.YE);qa.Pp(this.Xi);qa.LI(this.nq);this.gridBlockManager=Object(d.a)(6,
this.da.za);this.UD=qa.frame.qI;this.b3()}get ij(){return this.Jq.domElement(1)}get dMc(){const qa=this.Jq.domElement(Ma.Yja);return qa?U.DOMElementExtensions.isVisible(qa):!1}get BLa(){return this.$.isEditMode&&Q.EwaSettings.Na(128)&&Q.EwaSettings.Na(131)&&(new E.a(this.$.sa)).Bn?!1:-1!==this.$Ha}dispose(){this.da&&this.da.ha.JZ(this.xm);if(this.$){const qa=this.$;qa.wu(this.Xi);qa.mL(this.nq);H.f(qa).dF(this.YE)}e.a.gh(this.Jq);this.UD=this.$=this.da=this.Jq=null;super.dispose()}PD(){this.MNa(null,
!1);this.Jeb=-1;this.Jq.hide();this.Z6k();this.E3a=!1}dwb(){this.Jq.getButton(Ma.Yja).N6b();this.E3a=!1}vQg(){this.Jq.getButton(Ma.Yja).gub();this.h6g(this.suc);this.E3a=!0;Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void w.a.uj(f.l).then(qa=>{qa.Fca(X.a.instance.ia(1751))}):this.$.qa.zi(211,qa=>{qa.Fca(X.a.instance.ia(1751))})}onAutoDetectUIShown(){if(this.BLa&&-1!==this.Jeb)this.nt.onAutoDetectUIShown()}uMh(qa){var Ha=new ba.Range(1===qa.top?1:qa.top-
1,qa.left,qa.bottom,qa.right,!0,!1);Ha=this.da.getRangeInformation(Ha);for(const ha of Ha)if(Object(u.a)(Z.AutoDetectRange,ha)&&this.iHc(qa,!1,ha))return!0;return!1}WXa(){if(this.BLa&&-1!==this.Jeb){this.Jq.getButton(Ma.Yja).gub();var qa={};qa.Id=this.$Ha;qa.StringId=null;this.nt.lzd(qa,!0,this.suc);c.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");ia.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,[{name:"Domain",int64:this.$Ha}]);this.$Ha=
-1}}fHi(){let qa=X.a.instance.ia(1747);if(-1!==this.$Ha){qa+=" ";try{qa+=this.nt.CZb(this.$Ha.toString())}catch(Ha){c.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.$Ha}`)}}qa+=" ";return qa=this.nKb?qa+X.a.instance.ia(1750):qa+X.a.instance.ia(this.isMac?1749:1748)}SWg(){this.nKb&&(this.O4||(this.O4=new t(this.ij,this.$),this.O4.convertToDomainName=X.a.instance.ia(1752),this.O4.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",
this.O4.imageAltText=X.a.instance.ia(1754),this.O4.helpId="HID_DataTypes_Wolfram",this.O4.helpText=X.a.instance.ia(1753)),this.O4.longDescription=this.nt.Tye(this.Jeb.toString()),this.O4.M5h())}iHc(qa,Ha,ha){if((new ba.Range(ha.top,ha.left,ha.bottom===n.a.Ok?ha.bottom:ha.bottom+1,ha.right,!0,!1)).$i(qa)){if(Ha){if(ha&&ha.mKb!==this.Jeb){this.Jeb=ha.mKb;qa=ha.mKb.toString();Ha=this.nKb?"":this.nt.Tye(qa);const La=this.nt.z$i(qa);this.Jq.uAb(this.nt.CZb(qa),Ha,La,Ma.Yja)}this.$Ha=ha.mKb;this.suc=ha}return!0}return!1}b3(){if(this.nt){var qa=
this.da.ha.Hk;if(this.gridBlockManager&&this.gridBlockManager.URd){var Ha=this.da.ha.pa.activeCell,ha=!this.gridBlockManager.Wx(Ha),La=this.da.getRangeInformation(this.da.Wp);for(const fa of La)if(Object(u.a)(Z.AutoDetectRange,fa))switch(La=fa,La.YXh){case 3:if(this.iHc(Ha,!0,La)){if(1!==qa||ha){this.PD();return}c.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.Bie();this.Jq.hra(Ha,this.MNa);this.xaf||(this.xaf=!0,this.onAutoDetectUIShown());
return}break;case 2:case 1:(Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.tMh.lhi(La);break;default:c.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.PD()}}h6g(qa){const Ha=[29];this.da.Fh.wt(qa,Ha);this.da.Fh.Qw(Ha)}hpb(){return this.$.fa.isNamedObjectViewMode&&K.f(this.$.la)}Bie(){this.nKb&&
!this.iLc&&this.UD&&(this.UD.aE(k.a.Wi,this.$.domElement,this.onKeyDown,!0),this.UD.aE(k.a.qk,this.$.domElement,this.onKeyUp,!0),this.iLc=!0)}Z6k(){this.nKb&&this.iLc&&this.UD&&(this.UD.lE(k.a.Wi,this.$.domElement,this.onKeyDown,!0),this.UD.lE(k.a.qk,this.$.domElement,this.onKeyUp,!0),this.iLc=!1)}static get Yja(){return 1}static AJi(qa){return X.a.instance.ia(1808)+v.a.space+qa}}Object(y.a)(Ma,"AutoDetectManager",m.a,[])},1419:function(y,m,a){a.r(m);a.d(m,"BusinessBarManager",function(){return E});
y=a(127);m=a(0);var c=a(15),b=a(6),e=a(95),k=a(37),d=a(41),u=a(80),n;(function(U){U[U.unableToRefreshLock=0]="unableToRefreshLock";U[U.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";U[U.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";U[U.workbookTooLarge=3]="workbookTooLarge";U[U.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";U[U.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";U[U.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";
U[U.unsupportedFeatures=7]="unsupportedFeatures";U[U.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";U[U.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";U[U.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";U[U.lastGenericStatusError=11]="lastGenericStatusError";U[U.scratchPadWarning=12]="scratchPadWarning";U[U.authenticationLost=13]="authenticationLost";U[U.odfCompatibilityIssues=14]="odfCompatibilityIssues";U[U.pivotChartInteractivityMissingWarning=
15]="pivotChartInteractivityMissingWarning";U[U.workbookIsIrmProtected=16]="workbookIsIrmProtected";U[U.biFeatureNotAvailable=17]="biFeatureNotAvailable";U[U.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";U[U.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";U[U.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";U[U.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";U[U.editAttemptInReadOnly=22]="editAttemptInReadOnly";U[U.editAttemptInReadOnlyNoEditPermissions=
23]="editAttemptInReadOnlyNoEditPermissions";U[U.unsupportedBrowser=24]="unsupportedBrowser";U[U.readOnlyPermissions=25]="readOnlyPermissions";U[U.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";U[U.policyWarningMessage=27]="policyWarningMessage";U[U.workingOnIt=28]="workingOnIt";U[U.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";U[U.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";U[U.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";
U[U.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";U[U.legacyConnectionsBB=33]="legacyConnectionsBB";U[U.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";U[U.groupedSlicersBB=35]="groupedSlicersBB";U[U.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";U[U.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";U[U.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";U[U.wacGdprNotice=39]="wacGdprNotice";U[U.automaticSensitivityLabel=
40]="automaticSensitivityLabel";U[U.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";U[U.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";U[U.localStorageDisabled=43]="localStorageDisabled";U[U.autoRefreshDisabled=44]="autoRefreshDisabled";U[U.corruptedFileRepaired=45]="corruptedFileRepaired";U[U.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";U[U.minorVersionLimitReached=47]="minorVersionLimitReached";U[U.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";
U[U.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";U[U.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";U[U.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";U[U.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";U[U.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";U[U.sensitivityApplicationSetLabelError=
54]="sensitivityApplicationSetLabelError";U[U.promptEnableExternalLinks=55]="promptEnableExternalLinks";U[U.networkDown=56]="networkDown";U[U.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";U[U.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";U[U.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";U[U.canvasHealth=60]="canvasHealth";U[U.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";U[U.optimizeWorkbook=62]="optimizeWorkbook";
U[U.novModePostDepreciation=63]="novModePostDepreciation";U[U.officeScriptsRunning=64]="officeScriptsRunning";U[U.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";U[U.readOnlyPivotTable=66]="readOnlyPivotTable";U[U.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";U[U.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";U[U.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";U[U.dataCleansingSuggestions=70]="dataCleansingSuggestions";
U[U.editInMiniWAC=71]="editInMiniWAC";U[U.powerQueryUnsupportedTeams=72]="powerQueryUnsupportedTeams";U[U.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";U[U.externalConnectionsEnableContentRefreshOnOpen=74]="externalConnectionsEnableContentRefreshOnOpen";U[U.applicationNotification=75]="applicationNotification";U[U.count=76]="count"})(n||(n={}));Object(m.b)("EwaBusinessBarEntryType",n);var v=a(7),f=a(1222);class w extends Sys.EventArgs{constructor(U,X,ia){ia=void 0===ia?
null:ia;super();this.hHa=U;this.xDd=X;this.data=ia}}Object(m.a)(w,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var r=a(1225),t=a(1223),l=a(1227);a(1226);var x=a(1220),A=a(559),z=a(40),F=a(791),D=a(36),G=a(1),Q=a(23),O=a(71),J=a(75),H=a(1103),N=a(92),L=a(5),Z=a(1224),ba=a(91),K;let E=K=class extends u.a{constructor(U,X){X=void 0===X?!U.ioa:X;super();this.eh=new d.a;this.p0=null;this.Iad=[];this.iPc=()=>{this.$.oa.y1a?this.removeEntry(13):this.Rm(13,null)};this.Ap=(ia,Ma)=>{for(let qa=
0,Ha=K.EDc().length;qa<Ha;qa++)ia=K.EDc()[qa],this.removeEntry(ia);ia=[500,502,503];Ma.context&&0<Ma.context.communicationErrorRetryCount&&ia.includes(Ma.context.S1d)&&(G.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ServerCommunicationBBTimeoutInMs",0)&&!this.vM(21)?c.ULS.sendTraceTag(507359372,0,20,"OnWebMethodSuccess: webMethod failed initially, but succeeded before timeout, hence no business bar was shown"):c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
this.reb&&(window.clearTimeout(this.reb),this.reb=null),this.removeEntry(21));this.isk()};this.Xy=(ia,Ma)=>{var qa;ia=this.Twi(Ma.errors);let Ha=[];for(let La=0,fa=ia.length;La<fa;++La){const ja=ia[La];if(1===ja.Type&&ja.Appearance&32)Ha=this.e6i(ja,Ha);else if(Ma.hDk){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var ha=(null===(qa=Ma.context)||void 0===qa?0:qa.stopwatch)?Ma.context.stopwatch.Ci:
-1;5E3>ha?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${ha}ms).`):b.AFrameworkApplication.Tsj()||this.MBh(ja,Ma.context.methodName)}ha=[...K.EDc()];for(let ta=0,Ka=Ha.length;ta<Ka;++ta){const Ga=Ha[ta];this.Rm(Ga,ja);Array.remove(ha,Ga)}for(let ta=0,Ka=ha.length;ta<Ka;++ta)this.removeEntry(ha[ta])}};this.hj=(ia,Ma)=>{this.Xi(ia,Ma)};this.Xi=()=>{const ia=this.$.fa;ia.ki||ia.$l()||
(this.Wie(),this.Iad.length=0)};this.Dj=(ia,Ma)=>{this.$.fa.$l()&&!Ma.J1||this.xVf(Ma.J1)};this.$2b=()=>{const ia=this.$.userOperationManager.rDc();ia&&ia.operation.flags&1&&this.YVg()};this.xmg=()=>{this.YVg()};this.Wl=()=>{this.Off();this.kWg()};this.tJ=()=>{if(this.$.Noa&&this.$.fa.$l()&&this.$.fa.ki)if(this.$.fa.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);
else{const ia=L.Xb.Ma()?N.a.lh(L.Xb):this.$.qa.zh(331);ia&&ia.V0||this.removeEntry(55);this.removeEntry(5)}};this.$=U;this.Ifb=X;this.reb=null;a(1467);this.fLh();b.AFrameworkApplication.lj&&b.AFrameworkApplication.lj.FIb(this);this.Keb=Array(76);for(let ia=0;76>ia;ia++)this.Keb[ia]=null;this.$p=F.EcmaDateClock.instance;this.w6f=this.$p.vi.getTime();X&&(X=U.oa,X.CX(this.Xy),X.MI(this.Ap),X.NIb(this.iPc),X.afb(this.iPc),U.fa.Nq(this.hj),U.fa.vz(this.Wl),U.nr(this.Dj),U.Pp(this.Xi),U.fa.lK(this.tJ),
U.userOperationManager.qw(this.$2b),G.EwaSettings.Na(158)&&U.fa.Dn.get(45)&&b.AFrameworkApplication.ea.ka("SupportsPolicies")||this.$Qf(),this.xVf(O.c(U)))}$Qf(){D.a.Qx(this.$.fa.eQ)&&this.Xy(this,new A.a(this.$.fa.eQ,null,!1,-1,-1,-1,-1,"",-1,"",-1))}tCh(U){this.eh.addHandler("bBarAttachedOrDetached",U)}get IEd(){return this.Iad}get domElement(){return this.p0?this.p0.domElement:null}dispose(){if(this.$){const U=this.$,X=U.oa;X.KZ(this.Xy);X.oL(this.Ap);X.uVc(this.iPc);X.V5b(this.iPc);U.fa.Lq(this.hj);
U.fa.SB(this.Wl);U.$r(this.Dj);U.wu(this.Xi);U.fa.gI(this.tJ);U.userOperationManager.vu(this.$2b);Q.f(U).Dh.Cv(this.xmg)}e.a.gh(this.p0);this.$=this.p0=null;super.dispose()}Nij(U){switch(U){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;default:return!1}}ZAh(U){switch(U.id){case 16:break;default:return}this.Rm(75,null,null,null,{entryToAdd:U})}Rm(U,X,ia,Ma,qa){ia=void 0===ia?null:ia;Ma=void 0===Ma?null:Ma;qa=void 0===qa?null:qa;if(!this.$.isMobileMode||this.Nij(U))this.Ifb&&
!this.vM(U)&&(this.Keb[U]=this.$p.Xra,this.p0.HF(U,X,Ma,qa),this.eh.raiseEvent("bBarAttachedOrDetached",new w(U,!0,ia))),X&&32===X.Appearance&&J.a(this.$).yj.qpa(X)}XVg(U,X,ia,Ma){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");x.a.initialize(U,X,ia,Ma);this.Rm(39,null)}lQk(U,X,ia,Ma){f.a.initialize(U,X,ia,Ma);this.Rm(40,null)}USk(U,X,ia,Ma){t.a.initialize(U,X,ia,Ma);this.Rm(41,null)}OQk(U,X,ia,Ma,qa){Z.a.initialize(U,X,ia,Ma,qa);this.Rm(70,null)}ZRk(U,X,ia,Ma){r.a.initialize(U,
X,ia,Ma);this.Rm(42,null)}dTk(U,X,ia,Ma){l.a.initialize(U,X,ia,Ma);this.Rm(54,null)}removeEntry(U){this.Ifb&&(G.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(n,U)}`),this.Keb[U]=null,this.p0.removeEntry(U)&&this.eh.raiseEvent("bBarAttachedOrDetached",new w(U,!1)))}U6(U){return this.Ifb?this.p0.U6(U):!1}vM(U){return this.Ifb?this.p0.vM(U):!1}gsb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}Y0b(){c.ULS.sendTraceTag(537170247,
0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}fLh(){const {BusinessBarControl:U}=a(1397);if(this.Ifb&&!this.p0){Q.f(this.$).Dh.Mv(this.xmg);var X=document.getElementById(this.$.xi+v.a.Gcf);this.p0=new U(this.$,X)}}Wie(){this.Ifb&&this.p0.Wie()}isk(){if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const X=this.$p.Xra;if(3E5<=X-this.w6f){this.w6f=X;for(let ia=0;76>ia;ia++){var U=
this.Keb[ia];if(U&&(U=X-U,3E5<=U)){const Ma=Enum.toString(n,ia);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Ma}] was activated but not turned off for ${U} Millis`)}}}}}Twi(U){const X=[];for(const ia of U)switch(ia.MessageId){case -113742550:const Ma=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.fa.isNamedObjectViewMode||D.a.oo(U,Ma))&&X.push(-113742550)}return D.a.iT(U,X)}e6i(U,X){switch(U.MessageId){case 2113407564:const ia=
D.a.Ogb([1821390342,-943219229,-502303485,1437034227]);for(let Ma=0;Ma<ia.length;Ma++)ia[Ma].HelpTopicId=U.HelpTopicId,ia[Ma].HelpDescription=U.HelpDescription,this.Iad.push(ia[Ma])}switch(U.MessageId){case -395951567:this.Rm(6,U);break;case 1643490758:this.Rm(4,U);break;case -907264831:this.Rm(5,U);break;case 757111532:case 2113407564:this.Rm(7,U);break;case 2010656511:this.Rm(15,U);break;case 1321660996:this.$.Kof=!0;this.Rm(8,U);break;case 526339737:this.$.Kof=!0;this.Rm(9,U);break;case -407088521:this.Rm(10,
U);break;case 1756116017:this.Rm(14,U);break;case -1703455218:this.Rm(17,U);break;case 1393475740:this.Rm(25,U);break;case -949523941:this.Rm(26,U);break;case 1779381952:X.push(44);break;case 1421575100:this.Rm(45,U);break;case 613676060:this.Rm(46,U);break;case 1233668252:this.Rm(61,U);break;case 1911608588:U=!!(this.$.Kj&64);!this.$.fa.$l()&&U&&X.push(29);break;case 1544494907:break;case -655555355:X.push(this.n0d()?1:0);break;case -1221382671:X.push(2);break;case 1662282929:X.push(3);break;case 104919273:this.$.fa.$l()||
X.push(30);break;case -689453604:U=!!(this.$.Kj&64);this.$.fa.rSf=!0;!this.$.fa.$l()&&U&&X.push(31);break;case 157762400:this.$.fa.MIc=!0;!this.$.fa.$l()&&this.$.Kj&64&&!this.$.isEditMode&&X.push(32);break;case -1125398042:!this.$.fa.$l()&&this.$.Kj&64&&!this.$.isEditMode&&X.push(34);break;case -73730134:!this.$.fa.$l()&&this.$.Kj&64&&X.push(33);break;case -293349236:X.push(65);break;case 1580811823:X.push(67);break;case -37299333:break;case 136737622:X.push(47);break;case -1780327030:this.Rm(55,
U);break;case -113742550:this.Rm(57,U);break;case -260312420:this.$.fa.$l()||X.push(66);break;case 784737213:this.$.fa.$l()||X.push(70);break;case -156954846:this.Rm(74,U);break;default:this.Rm(11,U)}return X}ucj(){if(b.AFrameworkApplication.ea.ka("WildFireExcelBizBar")&&!H.a.Ioj(H.a.rFf(1))&&(k.a.Gw||k.a.io))if(G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void N.a.resolve(L.eb,{va:1}).then(()=>this.Rm(20,null));else{const U=Object(ba.d)(N.a.resolve(L.eb,
{va:1}));z.TaskExtensions.$e(U,()=>{this.Rm(20,null)},this.ya,3)}}Gbj(U){U||3!==this.$.workbookContext.WorkbookNovType||this.Rm(63,null)}get s8k(){return b.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)}rcj(){this.s8k&&k.a.cuj&&this.Rm(24,null)}xVf(U){(!U&&!this.$.printingEnabled||this.$.kk.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),
this.Rm(16,null));this.ucj();this.Off();this.kWg();this.Gbj(U);this.rcj()}Off(){this.$.workbookContext.Options&32768&&this.gRk()}gRk(){this.Keb[37]||this.Rm(37,null)}LTk(){this.Keb[38]||this.Rm(38,null)}kWg(){this.$.workbookContext.Options&524288&&this.Rm(59,null)}Hue(U,X){this.Rm(58,U,null,X)}fnc(U,X){var ia=null,Ma=null;ia=void 0===ia?null:ia;Ma=void 0===Ma?null:Ma;X=void 0===X?null:X;this.p0.vM(U)?this.p0.dAb(U,X):this.Rm(U,null,ia,Ma,X)}YVg(){this.$.Kj&8&&this.Rm(12,null)}n0d(){const U=L.a.Ma()?
N.a.lh(L.a):this.$.qa.zh(38);return U?U.Kye:!1}MBh(U,X){const ia=G.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ServerCommunicationBBTimeoutInMs",0);this.vM(21)||-1387426400===U.MessageId||this.reb||(this.reb=window.setTimeout(()=>{this.s1k(U,X)},ia))}s1k(U,X){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const ia={};ia.FailedMethod=X;this.Rm(21,U,ia);this.reb=null}static EDc(){return K.w7e||(K.w7e=[0,1,2,3,44])}jLd(U){return this.p0.jLd(U)}};
E.w7e=null;E=K=Object(y.__decorate)([Object(N.d)(L.E),Object(y.__param)(0,Object(L.Ob)())],E);Object(m.a)(E,"BusinessBarManager",u.a,[639,2,103])},1425:function(y,m,a){a.r(m);a.d(m,"NetworkConnectionHealthChecker",function(){return x});y=a(0);var c=a(2),b=a(15),e=a(497),k=a(36),d=a(13),u=a(267);class n{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(y.a)(n,"ConnectionErrorLogInfo",null,[]);var v=a(1236),f=a(1237);class w{constructor(A){this.nTd=[v.a.Zbh,
v.a.v6c];this.Kt=(z,F)=>{this.PZ[F]=z;this.O7i()&&this.Wsk("OnNetworkDownImmediatePing"===z.caller)};this.Xza=A;this.$=A.$;this.PZ={}}Swj(){const A=f.a.uKd(this.Kt,"OnNetworkDownImmediatePing",this.$,this.nTd);for(const z of A)z.runTest()}O7i(){for(const A of this.nTd)if(void 0===this.PZ[A]||null===this.PZ[A])return!1;return!0}Wsk(A){const z=this.$.nm.Cha;A&&this.$Xk(z);for(var F of this.nTd)this.PZ[F]=Sys.Serialization.JavaScriptSerializer.serialize(this.PZ[F]);A=Date.now();F=this.Xza.VPd(x.X0b).returnValue;
const D=this.Xza.VPd(x.k8b).returnValue;this.PZ.isOfflineMode=z;this.PZ.networkDownBBAge=-1===F?F:A-F;this.PZ.transientServerCommunicationFailuresBBAge=-1===D?D:A-D;this.Xza.businessBar?(this.PZ.isNetworkDownBBShown=this.Xza.businessBar.vM(56).toString(),this.PZ.isServerErrorBBShown=this.Xza.businessBar.vM(21).toString()):(this.PZ.isNetworkDownBBShown="unknown",this.PZ.isServerErrorBBShown="unknown");b.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.PZ)}`)}$Xk(A){const {NetworkConnectionHealthChecker:z}=
a(1425),F={};for(const D of Object.keys(this.PZ)){const G=this.PZ[D];F[G.testName]=G.isSuccess}F.isOfflineMode=A;this.Xza.Bwe(z.Lyd,Sys.Serialization.JavaScriptSerializer.serialize(F))}}Object(y.a)(w,"ConnectionHealthTestsRunner",null,[]);var r=a(92),t=a(5),l=a(1);class x{constructor(A){this.businessBar=this.Cqb=null;this.Tp=l.EwaSettings.Tp("NetworkConnectionHealthChecker");this.pPj=(z,F)=>{F.xDd?this.rPj(F):this.qPj(F)};this.Ap=(z,F)=>{z=F.context.methodName;this.Cqb&&z===this.Cqb&&(b.ULS.sendTraceTag(537155230,
0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.Cqb}" has now succeeded. Querying local storage for BB showings.`),this.irb(x.k8b,!0),this.Cqb=null);this.B$f(!1);this.btc=!1};this.Xy=(z,F)=>{k.a.oo(F.errors,[-1387426400])&&!this.btc&&(this.btc=!0,this.jUg()&&window.performance.mark(x.Chg),(new w(this)).Swj())};this.w_b=()=>{this.B$f(!0);this.irb(x.X0b,!1);this.irb(x.k8b,!1)};this.PNa=()=>{this.irb(x.X0b,!0)};this.$=A;this.oa=this.$.oa;this.localStorage=new u.a;this.btc=
!1;this.Tp?this.$.fa.rv(this.w_b):l.EwaSettings.ul()?this.$.fa.lr(this.w_b):this.$.fa.mr(this.w_b);this.oa.nm.YIb(this.PNa);this.oa.MI(this.Ap);void r.a.uj(t.E).then(z=>{const F=this;return xo(function*(){F.businessBar=z;z.tCh(F.pPj)})});this.oa.CX(this.Xy)}dispose(){this.$&&(this.$.fa&&(this.Tp?this.$.fa.az(this.w_b):l.EwaSettings.ul()||this.$.fa.av(this.w_b)),this.oa&&(this.oa.nm.f6b(this.PNa),this.oa.KZ(this.Xy),this.oa.oL(this.Ap)))}rPj(A){const z={};z.Timestamp=Date.now().toString();switch(A.hHa){case 21:this.Cqb=
A.data.FailedMethod;z.FailedMethod=this.Cqb;this.Bwe(x.k8b,JSON.stringify(z));break;case 56:this.Bwe(x.X0b,JSON.stringify(z))}}qPj(A){switch(A.hHa){case 21:this.irb(x.k8b,!0);break;case 56:this.irb(x.X0b,!0)}}Bwe(A,z){try{this.localStorage.zl()&&this.localStorage.setItem(A,z)}catch(F){b.ULS.sendTraceTag(537155231,0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${F.message||"Unknown"}`)}}VPd(A){if(this.localStorage.zl()&&(A=this.localStorage.H_a(A))&&
"null"!==A){var z=JSON.parse(A);A=parseInt(z.Timestamp,10);z=Sys.Serialization.JavaScriptSerializer.serialize(z);return{returnValue:A,rawData:z}}return{returnValue:-1,rawData:null}}B$f(A){if(this.localStorage.zl()){const z=this.localStorage.H_a(x.Lyd);if(z&&"null"!==z){let F=-1;this.btc&&(F=this.zLi(x.Chg,x.XNj));b.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(z)}, Period offline: ${F}, New session: ${A}`);
this.localStorage.removeItem(x.Lyd)}}}zLi(A,z){if(!this.jUg())return-1;window.performance.measure(z,A);A=window.performance.getEntriesByName(z);return A.length&&A[A.length-1]?A[A.length-1].duration:(b.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${z} returned no measures.`),-1)}irb(A,z){try{let F;const D=(()=>{let G=this.VPd(A);({rawData:F}=G);return G})().returnValue;if(-1!==D){const G=Object(c.a)(new n,{timeElapsed:Date.now()-D,scenario:A,
isNewSession:!z,rawData:F});b.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(G)}`)}this.localStorage.removeItem(A)}catch(F){b.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${F.message||"Unknown"}`)}}jUg(){return d.HelperMethods.uud&&e.a.HWa}}x.X0b="NetworkDownBBShown";x.k8b="ServerCommunicationFailureBBShown";x.Lyd="ConnectionHealthPingRsults";x.Chg="offMoStMa";
x.XNj="offMoDuMea";Object(y.a)(x,"NetworkConnectionHealthChecker",null,[2])},1442:function(y,m,a){a.d(m,"a",function(){return d});y=a(0);var c=a(15),b=a(289);class e{constructor(u,n){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=u;this.caller=n;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage=
"";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(y.a)(e,"NetworkTestResult",null,[]);var k=a(703);class d{constructor(u,n,v,f,w){this.url="";this.Inb=!1;this.IQ=-1;this.testIteration=0;this.baseUrl=v;this.Hjg=f;this.fTd=n;this.result=new e(n,w)}runTest(){try{if(this.Inb)return c.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.fTd} is already mid way, not starting a new one.`),!1;this.reset();this.Inb=!0;this.result.startTimeMs=Date.now();const u=
new b.QueryStringBuilder(this.baseUrl);u.Xea("tid",this.result.startTimeMs.toString());this.url=u.toString();this.uBk();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(u){return this.KQb("Exeption: "+u.message),!1}}reset(){this.url="";this.result.reset();this.Inb=!1;this.IQ=-1}clearTimeout(){-1!==this.IQ&&(window.clearTimeout(this.IQ),this.IQ=-1)}uBk(){try{const u=new XMLHttpRequest;u.onreadystatechange=()=>{4===u.readyState&&(200===u.status?this.ayi():this.KQb(`Error when downloading resource. status code: ${u.status}, status text: ${u.statusText}`,
u.status.toString()))};u.onerror=()=>{this.KQb(`Client error when attempting to download resource. status code: ${u.status}, response: ${u.statusText}`)};this.IQ=window.setTimeout(()=>{this.IQ=-1;this.KQb("Request timeout")},1E4);u.open("GET",this.url,!0);u.send(null)}catch(u){this.KQb("Exeption: "+u.message)}}ayi(){this.Inb&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=k.a(this.url),this.result.isSuccess=!0,this.Psc())}KQb(u,
n){n=void 0===n?null:n;this.Inb&&(this.clearTimeout(),this.result.errorMessage=u,this.result.isSuccess=!1,this.result.errorStatusCode=n,this.Psc())}Psc(){this.Inb=!1;this.Hjg&&this.Hjg(this.result,this.fTd)}}Object(y.a)(d,"NetworkTestReq",null,[])},1461:function(y,m,a){m=a(492);a=a(1462);a=a.$q?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1462:function(y,m,a){m=a(493)(!1);m.push([y.i,'.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media (forced-colors:active){.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}',
""]);y.exports=m},1463:function(y,m,a){function c(ja,ta,Ka,Ga,Na,cb){this.ID=ja;this.type=ta;this.Ahl=Ka;this.Mhl=Ga;this.Bhl=Na;this.Nhl=cb}function b(ja,ta){this.value=ja;this.contextId=ta}function e(ja,ta,Ka,Ga,Na,cb,jb,Sa){this.type=ja;this.t5=ta;this.startTime=null==Ka||void 0==Ka.value?new b(Ka,null):Ka;this.endTime=null==Ga||void 0==Ga.value?new b(Ga,null):Ga;this.lda=null==Na||void 0==Na.value?new b(Na,null):Na;this.gZa=null==cb||void 0==cb.value?new b(cb,null):cb;this.yEg=jb;this.operationType=
Sa}function k(){}function d(ja,ta){this.ID=ja;this.n6f=ta}function u(){this.z3=[];this.Kxb=this.Nxb=null;this.Sca=5E3;this.Oxb=0;this.Ysc=[];this.Iib=-1;this.Rxe=0}function n(){this.Index=0;this.Data=[];this.fdc=!1}function v(ja,ta,Ka,Ga,Na,cb){this.odc(ja,ta,Ka,Ga,Na,cb)}function f(ja,ta,Ka,Ga,Na,cb){this.odc(ja,ta,Ka,Ga,Na,cb)}function w(){this.IAa=[];this.Ol=[];this.Lfb=[];this.grb=this.$5a=this.dWa=0;this.duration=this.startTime=null;this.b9d=0;this.Kjb={};this.ngb=-1;this.tib=0;this.Hrb=this.Qrb=
-1}function r(ja,ta,Ka,Ga){D(Ga)&&(Ga="relative"==ja.style.position);var Na=0;switch(ta){case 1:Na=Ka?parseInt(Ga?ja.style.marginRight.replace("px",""):ja.style.right.replace("px","")):parseInt(Ga?ja.style.marginLeft.replace("px",""):ja.style.left.replace("px",""));break;case 2:Na=parseInt(Ga?ja.style.marginTop.replace("px",""):ja.style.top.replace("px",""));break;case 3:Na=parseInt(ja.style.height.replace("px",""));break;case 4:Na=parseInt(ja.style.width.replace("px",""));break;case 5:Na=Q(ja);break;
case 6:Na=parseInt(ja.scrollTop);break;case 7:Na=parseInt(ja.scrollLeft);break;case 8:Na=J(ja)}return Na}function t(ja){return ja*ja*ja}function l(ja){return 3*ja*ja*(1-ja)}function x(ja){return 3*ja*(1-ja)*(1-ja)}function A(ja){return(1-ja)*(1-ja)*(1-ja)}function z(ja,ta,Ka,Ga,Na){return 0*A(Na)+ta*x(Na)+Ga*l(Na)+1*t(Na)}function F(ja){return"object"==typeof ja&&ja instanceof Array}function D(ja){return null==ja||void 0==ja}function G(ja,ta){null!=document.body.style.opacity?ja.style.opacity=ta:
ja.style.filter=1==ta?"":"alpha(opacity="+String(100*ta)+")"}function Q(ja){if(null!=document.body.style.opacity)return ja=ja.style.opacity,null!=ja&&""!=ja?parseFloat(ja):1;ja=ja.style.filter;return null!=ja&&""!=ja?parseInt(ja.replace("alpha(opacity=","").replace(")",""))/100:1}function O(ja,ta){ta="rotate("+ta+"deg)";null!=document.body.style.msTransform?ja.style.msTransform=ta:null!=document.body.style.webkitTransform?ja.style.webkitTransform=ta:null!=document.body.style.u7d?ja.style.u7d=ta:null!=
document.body.style.i9d?ja.style.i9d=ta:null!=document.body.style.transform&&(ja.style.transform=ta)}function J(ja){if(null!=document.body.style.msTransform)var ta=ja.style.msTransform;else null!=document.body.style.webkitTransform?ta=ja.style.webkitTransform:null!=document.body.style.u7d?ta=ja.style.u7d:null!=document.body.style.i9d?ta=ja.style.i9d:null!=document.body.style.transform&&(ta=ja.style.transform);if(!ta)return 0;ta=ta.replace("rotate(","");ta=ta.replace("deg)","");return parseFloat(ta)}
a.r(m);a.d(m,"WacAnimation",function(){return H});a.d(m,"WacCurve",function(){return c});a.d(m,"WacCurveType",function(){return N});a.d(m,"WacCurveID",function(){return L});a.d(m,"g_AnimationCurves",function(){return Z});a.d(m,"WacIntWrapper",function(){return b});a.d(m,"WacKeyFrame",function(){return e});a.d(m,"g_numAnimationAttributes",function(){return ba});a.d(m,"AnimRelativeTo",function(){return K});a.d(m,"WacKeyframeType",function(){return E});a.d(m,"g_AnimationContextVariables",function(){return U});
a.d(m,"WacAnimation_ContextVariableManager",function(){return k});a.d(m,"WacAnim",function(){return d});a.d(m,"g_WacAnimations",function(){return X});a.d(m,"g_WacAnimationEngine",function(){return ia});a.d(m,"g_WacAnimationLogging",function(){return Ma});a.d(m,"g_WacAnimationThrottleFPS",function(){return qa});a.d(m,"g_WacAnimationThrottleNumInstance",function(){return Ha});a.d(m,"WacAnimationEngine",function(){return u});a.d(m,"g_WacRadix",function(){return ha});a.d(m,"WacAnimation_State",function(){return n});
a.d(m,"WacAnimation_Object",function(){return v});a.d(m,"WacAnimationUnit",function(){return f});a.d(m,"WacAnimationTelemetry",function(){return w});a.d(m,"g_WacAnimationTelemetry",function(){return La});a.d(m,"g_LastAnimationData",function(){return fa});a.d(m,"GetCurrentAttributeCssValue",function(){return r});a.d(m,"Bezier1",function(){return t});a.d(m,"Bezier2",function(){return l});a.d(m,"Bezier3",function(){return x});a.d(m,"Bezier4",function(){return A});a.d(m,"CalculateBezier",function(){return z});
a.d(m,"IsArrayCheck",function(){return F});a.d(m,"IsNullOrUndef",function(){return D});a.d(m,"SetCssOpacity",function(){return G});a.d(m,"GetCssOpacity",function(){return Q});a.d(m,"SetCssRotation",function(){return O});a.d(m,"GetCssRotation",function(){return J});var H={},N={Instant:0,ndc:1,Linear:2,ML:3},L={Instant:0,ndc:1,Linear:2,dt:3,dGe:4,mGe:5,tFe:6,uFe:7,kdc:8,vFe:9,Dab:10,bFe:11,aFe:12,$Ee:13,cFe:14,dFe:15,eFe:16,fFe:17,gFe:18,JFe:19,aGe:20,CFe:21},Z=Array(22);Z[L.Instant]=new c(L.Instant,
N.Instant,0,0,0,0);Z[L.ndc]=new c(L.ndc,N.ndc,0,0,0,0);Z[L.Linear]=new c(L.Linear,N.Linear,0,0,0,0);Z[L.dt]=new c(L.dt,N.ML,0,0,0,1);Z[L.dGe]=new c(L.dGe,N.ML,1,0,1,1);Z[L.mGe]=new c(L.mGe,N.ML,0,0,.42,1);Z[L.tFe]=new c(L.tFe,N.ML,.83,0,1,1);Z[L.uFe]=new c(L.uFe,N.ML,0,0,.58,1);Z[L.kdc]=new c(L.kdc,N.ML,.42,0,.58,1);Z[L.vFe]=new c(L.vFe,N.ML,.1,.25,.75,.9);Z[L.Dab]=new c(L.Dab,N.ML,.1,.9,.2,1);Z[L.bFe]=new c(L.bFe,N.ML,.1,.9,.2,1);Z[L.aFe]=new c(L.aFe,N.ML,.9,.1,.2,1);Z[L.$Ee]=new c(L.$Ee,N.ML,.4,
0,0,1);Z[L.cFe]=new c(L.cFe,N.ML,.13,.21,.1,.7);Z[L.dFe]=new c(L.dFe,N.ML,.02,.33,.38,.77);Z[L.eFe]=new c(L.eFe,N.ML,.57,.17,.95,.75);Z[L.fFe]=new c(L.fFe,N.ML,0,.19,.07,.72);Z[L.gFe]=new c(L.gFe,N.ML,0,0,.95,.37);Z[L.JFe]=new c(L.JFe,N.ML,.66,0,.34,1);Z[L.aGe]=new c(L.aGe,N.ML,.8,0,.2,1);Z[L.CFe]=new c(L.CFe,N.ML,.8,0,.2,1);e.prototype={type:0,t5:0,startTime:new b(0,null),endTime:new b(0,null),lda:new b(0,null),gZa:new b(0,null),yEg:0,operationType:0};var ba=8;H.ek={w9:1,ZN:2,Height:3,Width:4,Opacity:5,
i7c:6,h7c:7,xll:8};var K={Initial:0,em:1,Absolute:2},E={Bt:0,Add:1};H.fBb={edc:0};var U=Array(1);U[H.fBb.edc]=new b(0,H.fBb.edc);H.Ril=k;k.prototype={};k.prototype.SetContextVariable=function(ja,ta){U[H.fBb[ja]].value=ta};H.ID={oEe:0,wEe:1,yEe:2,AEe:3,zEe:4,xEe:5,tEe:6,vEe:7,rEe:8,uEe:9,sEe:10,pEe:11,DEe:12,mEe:13,CEe:14,nEe:15,BEe:16,HEe:17,JEe:18,GEe:19,IEe:20,FEe:21,WFe:22,YFe:23,UFe:24,XFe:25,VFe:26,$Fe:27,gGe:28,sGe:29,uGe:30,tGe:31,vGe:32,fGe:33,qEe:34,EEe:35,RFe:36,kFe:37,jFe:38,TGe:39,UGe:40,
SGe:41};var X=Array(42);X[H.ID.oEe]=new d(H.ID.oEe,[new e(H.ek.Opacity,L.Instant,0,0,null,1,K.em,E.Bt)]);X[H.ID.wEe]=new d(H.ID.wEe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,50,null,1,K.em,E.Bt)]);X[H.ID.yEe]=new d(H.ID.yEe,[new e(H.ek.w9,L.dt,0,167,null,0,K.em,E.Add),new e(H.ek.ZN,L.dt,0,167,null,0,K.em,E.Add)]);X[H.ID.AEe]=new d(H.ID.AEe,[new e(H.ek.Height,L.dt,0,167,null,0,K.em,E.Add),new e(H.ek.Width,L.dt,0,167,null,0,K.em,E.Add)]);X[H.ID.zEe]=new d(H.ID.zEe,
[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,167,null,1,K.em,E.Bt)]);X[H.ID.xEe]=new d(H.ID.xEe,[new e(H.ek.Opacity,L.Linear,0,167,null,0,K.em,E.Bt)]);X[H.ID.tEe]=new d(H.ID.tEe,[new e(H.ek.w9,L.dt,0,100,null,0,K.em,E.Add),new e(H.ek.ZN,L.dt,0,100,null,0,K.em,E.Add)]);X[H.ID.vEe]=new d(H.ID.vEe,[new e(H.ek.Height,L.dt,0,100,null,0,K.em,E.Add),new e(H.ek.Width,L.dt,0,100,null,0,K.em,E.Add)]);X[H.ID.rEe]=new d(H.ID.rEe,[new e(H.ek.Opacity,L.Linear,0,100,null,
1,K.em,E.Bt)]);X[H.ID.uEe]=new d(H.ID.uEe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,100,null,1,K.em,E.Bt)]);X[H.ID.sEe]=new d(H.ID.sEe,[new e(H.ek.Opacity,L.Linear,0,100,null,0,K.em,E.Bt)]);X[H.ID.pEe]=new d(H.ID.pEe,[new e(H.ek.w9,L.dt,0,267,null,0,K.em,E.Add),new e(H.ek.ZN,L.dt,0,267,null,0,K.em,E.Add)]);X[H.ID.DEe]=new d(H.ID.DEe,[new e(H.ek.Height,L.dt,0,267,null,0,K.em,E.Add),new e(H.ek.Width,L.dt,0,267,null,0,K.em,E.Add)]);X[H.ID.mEe]=new d(H.ID.mEe,
[new e(H.ek.Opacity,L.Linear,0,267,null,1,K.em,E.Bt)]);X[H.ID.CEe]=new d(H.ID.CEe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,267,null,1,K.em,E.Bt)]);X[H.ID.nEe]=new d(H.ID.nEe,[new e(H.ek.Opacity,L.Linear,0,267,null,0,K.em,E.Bt)]);X[H.ID.BEe]=new d(H.ID.BEe,[new e(H.ek.i7c,L.dt,0,267,null,0,K.em,E.Add),new e(H.ek.h7c,L.dt,0,267,null,0,K.em,E.Add)]);X[H.ID.HEe]=new d(H.ID.HEe,[new e(H.ek.w9,L.dt,0,750,null,0,K.em,E.Add),new e(H.ek.ZN,L.dt,0,750,null,0,K.em,
E.Add)]);X[H.ID.JEe]=new d(H.ID.JEe,[new e(H.ek.Height,L.dt,0,750,null,0,K.em,E.Add),new e(H.ek.Width,L.dt,0,750,null,0,K.em,E.Add)]);X[H.ID.GEe]=new d(H.ID.GEe,[new e(H.ek.Opacity,L.Linear,0,750,null,1,K.em,E.Bt)]);X[H.ID.IEe]=new d(H.ID.IEe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,750,null,1,K.em,E.Bt)]);X[H.ID.FEe]=new d(H.ID.FEe,[new e(H.ek.i7c,L.dt,0,1E3,null,0,K.em,E.Add),new e(H.ek.h7c,L.dt,0,1E3,null,0,K.em,E.Add)]);X[H.ID.WFe]=new d(H.ID.WFe,
[new e(H.ek.w9,L.dt,0,367,null,0,K.em,E.Add),new e(H.ek.ZN,L.dt,0,367,null,0,K.em,E.Add)]);X[H.ID.YFe]=new d(H.ID.YFe,[new e(H.ek.Height,L.dt,0,367,null,0,K.em,E.Add),new e(H.ek.Width,L.dt,0,367,null,0,K.em,E.Add)]);X[H.ID.UFe]=new d(H.ID.UFe,[new e(H.ek.Opacity,L.Linear,0,367,null,1,K.em,E.Bt)]);X[H.ID.XFe]=new d(H.ID.XFe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,367,null,1,K.em,E.Bt)]);X[H.ID.VFe]=new d(H.ID.VFe,[new e(H.ek.Opacity,L.Linear,0,367,null,
0,K.em,E.Bt)]);X[H.ID.$Fe]=new d(H.ID.$Fe,[new e(H.ek.i7c,L.Linear,0,U[H.fBb.edc],null,0,K.em,E.Add),new e(H.ek.h7c,L.Linear,0,U[H.fBb.edc],null,0,K.em,E.Add)]);X[H.ID.gGe]=new d(H.ID.gGe,[new e(H.ek.Opacity,L.Linear,0,0,null,1,K.em,E.Bt),new e(H.ek.Opacity,L.Linear,0,50,null,0,K.em,E.Bt)]);X[H.ID.sGe]=new d(H.ID.sGe,[new e(H.ek.w9,L.dt,0,433,null,0,K.em,E.Add),new e(H.ek.ZN,L.dt,0,433,null,0,K.em,E.Add)]);X[H.ID.uGe]=new d(H.ID.uGe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,
L.Linear,0,50,null,1,K.em,E.Bt),new e(H.ek.ZN,L.dt,0,0,null,40,K.em,E.Add),new e(H.ek.ZN,L.dt,0,100,null,0,K.em,E.Add)]);X[H.ID.tGe]=new d(H.ID.tGe,[new e(H.ek.ZN,L.Instant,0,0,null,32,K.em,E.Add),new e(H.ek.ZN,L.Instant,0,100,null,32,K.em,E.Add),new e(H.ek.ZN,L.dt,101,350,null,0,K.em,E.Add),new e(H.ek.Height,L.Instant,0,0,null,0,K.Absolute,E.Add),new e(H.ek.Height,L.Instant,0,100,null,0,K.Absolute,E.Add),new e(H.ek.Height,L.dt,101,350,null,0,K.em,E.Add),new e(H.ek.Opacity,L.Instant,0,0,null,0,K.Absolute,
E.Bt),new e(H.ek.Opacity,L.Instant,0,100,null,1,K.em,E.Bt)]);X[H.ID.vGe]=new d(H.ID.vGe,[new e(H.ek.ZN,L.dt,0,267,null,32,K.em,E.Add),new e(H.ek.Height,L.dt,0,267,null,0,K.Absolute,E.Add),new e(H.ek.Opacity,L.Linear,0,0,null,1,K.Initial,E.Bt),new e(H.ek.Opacity,L.Linear,0,267,null,0,K.Absolute,E.Bt)]);X[H.ID.fGe]=new d(H.ID.fGe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,100,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,101,267,null,1,K.em,E.Bt)]);
X[H.ID.qEe]=new d(H.ID.qEe,[new e(H.ek.w9,L.Dab,0,300,null,0,K.em,E.Add),new e(H.ek.ZN,L.Dab,0,300,null,0,K.em,E.Add)]);X[H.ID.EEe]=new d(H.ID.EEe,[new e(H.ek.Height,L.Dab,0,300,null,0,K.em,E.Add),new e(H.ek.Width,L.Dab,0,300,null,0,K.em,E.Add)]);X[H.ID.RFe]=new d(H.ID.RFe,[new e(H.ek.w9,L.kdc,0,750,null,0,K.em,E.Add),new e(H.ek.ZN,L.kdc,0,750,null,0,K.em,E.Add)]);X[H.ID.kFe]=new d(H.ID.kFe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,200,null,0,K.Absolute,
E.Bt),new e(H.ek.Opacity,L.dt,201,500,null,1,K.em,E.Bt)]);X[H.ID.jFe]=new d(H.ID.jFe,[new e(H.ek.w9,L.Linear,0,0,null,0,K.Absolute,E.Add),new e(H.ek.ZN,L.Linear,0,0,null,0,K.Absolute,E.Add),new e(H.ek.w9,L.Linear,0,200,null,0,K.Absolute,E.Add),new e(H.ek.ZN,L.Linear,0,200,null,0,K.Absolute,E.Add),new e(H.ek.w9,L.dt,201,267,null,0,K.em,E.Add),new e(H.ek.ZN,L.dt,201,267,null,0,K.em,E.Add)]);X[H.ID.TGe]=new d(H.ID.TGe,[new e(H.ek.w9,L.dt,0,267,null,0,K.em,E.Add),new e(H.ek.ZN,L.dt,0,267,null,0,K.em,
E.Add)]);X[H.ID.UGe]=new d(H.ID.UGe,[new e(H.ek.Opacity,L.Linear,0,0,null,0,K.Absolute,E.Bt),new e(H.ek.Opacity,L.Linear,0,267,null,1,K.em,E.Bt)]);X[H.ID.SGe]=new d(H.ID.SGe,[new e(H.ek.Opacity,L.Linear,0,267,null,0,K.em,E.Bt)]);var ia=null,Ma=-1!=window.location.search.indexOf("AnimationLogging=1"),qa=0,Ha=3;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
function(ja){window.setTimeout(ja,16)}}();H.State=n;H.Object=v;u.prototype={z3:[],Nxb:null,Kxb:null,Sca:5E3,Oxb:0,Ysc:[],Iib:-1,Rxe:0};u.prototype.OFe=function(){ia.oGe()};u.prototype.yeh=function(){ia.oGe();ia.qGe()};u.prototype.Ufh=function(){null==this.Nxb&&null==this.Kxb&&0==this.Oxb&&(this.Nxb=window.requestAnimationFrame(u.prototype.OFe),ia.nGe(),this.Oxb=0,La.Start())};u.prototype.qGe=function(){La.Wfh();ia.pGe();null!=this.Nxb&&(this.Nxb=null);this.Oxb=0;this.Ysc=[];this.z3=[]};u.prototype.k7c=
function(ja){this.z3[this.Oxb++]=ja};u.prototype.l7c=function(ja){for(var ta=0;ta<this.z3.length;ta++)this.z3[ta]==ja&&(this.sfh(ja),this.z3[ta]=null)};u.prototype.oGe=function(){var ja=!1,ta=null;ia.pGe();for(var Ka=0;Ka<this.z3.length;Ka++)null!=this.z3[Ka]&&(D(ta)&&(ta=this.z3[Ka].currentTime),this.Iib=Ka,this.z3[Ka].Vfh(),ja=!0);this.Iib=-1;ja&&!D(ta)&&La.Jbh(new Date-ta);ja?(ia.nGe(),window.requestAnimationFrame(u.prototype.OFe)):this.qGe()};u.prototype.VEe=function(ja,ta){if(null==ja.id||""==
ja.id){var Ka="tempAnimID_"+String(this.Rxe);this.Rxe++;ja.id=Ka}ja=ja.id+"_"+String(ta);Ka=this.Ysc[ja];if(D(Ka)||Ka==this.Iib||null==this.z3[Ka])this.Ysc[ja]=this.Iib;else if(ja=this.z3[Ka],ja.t5.SetAttribute(ta,null),null!=ja.zaa){ta=this.z3[this.Iib];var Ga=ja.zaa,Na=ja.extraData,cb=ta.zaa,jb=ta.extraData;ta.zaa=null==cb?function(){Ga(Na)}:function(){Ga(Na);cb(jb)};ta.extraData=null;ja.zaa=null}};u.prototype.sfh=function(ja){if(F(ja.element))for(var ta=ja.element.length,Ka=0;Ka<ta;Ka++){var Ga=
ja.element[Ka];0==Ga.id.indexOf("tempAnimID_")&&null==Ga.id}else Ga=ja.element,0==Ga.id.indexOf("tempAnimID_")&&null==Ga.id};u.prototype.pGe=function(){null!=this.Kxb&&(window.clearTimeout(this.Kxb),this.Kxb=null)};u.prototype.nGe=function(){this.Kxb=window.setTimeout(u.prototype.yeh,this.Sca)};var ha=10;n.prototype={Index:0,Data:[],fdc:!1};n.prototype.SetAttribute=function(ja,ta){var Ka=this.FFe(ja);-1==Ka?(Ka=this.Data.length,this.Index+=ja*Math.pow(ha,Ka),this.Data[Ka]=ta):this.Data[Ka]=ta};n.prototype.$Ra=
function(ja){ja=this.FFe(ja);return-1==ja?null:this.Data[ja]};n.prototype.FFe=function(ja){for(var ta=0,Ka=this.Index;0!=Ka;){if(Ka%ha==ja)return ta;Ka=Math.floor(Ka/ha);ta++}return-1};n.prototype.SetAnimateRight=function(ja){this.fdc=ja};v.prototype={Erd:-1,delay:0,element:null,EQb:null,zaa:null,extraData:null,agb:null,QUf:0,fdf:null};v.prototype.odc=function(ja,ta,Ka,Ga,Na,cb){if(D(Ka))throw"Argument Error: element cannot be null.";if(F(Ka)&&!F(Ga)||!F(Ka)&&F(Ga))throw"Argument Error: element and finalState counts do not match";
this.Erd=ja;this.delay=ta;this.element=Ka;this.EQb=Ga;this.zaa=Na;this.extraData=cb;this.agb=[];this.QUf=0;this.fdf=U};v.prototype.UT=function(ja){return null==ja.contextId?ja.value:this.fdf[ja.contextId].value};v.prototype.RunAnimation=function(){if(-1!=this.Erd&&null!=this.element){this.Wdh();for(var ja=this.agb.length,ta=0;ta<ja;ta++)this.agb[ta].k7c()}};v.prototype.Wdh=function(){for(var ja=X[this.Erd],ta=null,Ka=ja.n6f.length,Ga,Na=0;Na<Ka;Na++){var cb=ja.n6f[Na],jb=this.Pdh(cb),Sa;if(null!=
jb)if(jb.lda.SetAttribute(cb.type,this.UT(cb.lda)),jb.t5.SetAttribute(cb.type,cb.t5),F(this.element)){var bb=this.element.length;for(Sa=0;Sa<bb;Sa++)if(Ga=this.ldc(cb,Sa),D(Ga)){jb.t5.SetAttribute(cb.type,null);break}else jb.d9[Sa].SetAttribute(cb.type,Ga)}else Ga=this.ldc(cb,-1),D(Ga)?jb.t5.SetAttribute(cb.type,null):jb.d9.SetAttribute(cb.type,Ga);else{jb=new f(this.element,this.UT(cb.startTime)+this.delay,this.UT(cb.endTime)-this.UT(cb.startTime),null,null,this.EQb.fdc);jb.lda.SetAttribute(cb.type,
this.UT(cb.lda));jb.t5.SetAttribute(cb.type,cb.t5);if(F(this.element))for(bb=this.element.length,Sa=0;Sa<bb;Sa++)if(null==jb.d9&&(jb.d9=Array(this.element.length)),null==jb.d9[Sa]&&(jb.d9[Sa]=new n),Ga=this.ldc(cb,Sa),D(Ga)){jb.t5.SetAttribute(cb.type,null);break}else jb.d9[Sa].SetAttribute(cb.type,Ga);else null==jb.d9&&(jb.d9=new n),Ga=this.ldc(cb,-1),D(Ga)?jb.t5.SetAttribute(cb.type,null):jb.d9.SetAttribute(cb.type,Ga);if(null==ta||ta.delay+ta.duration<=jb.delay+jb.duration)ta=jb;this.agb[this.QUf++]=
jb}}null!=ta&&(ta.zaa=this.zaa,ta.extraData=this.extraData)};v.prototype.Pdh=function(ja){for(var ta=this.agb.length,Ka=0;Ka<ta;Ka++){var Ga=this.agb[Ka];if(Ga.delay==this.UT(ja.startTime)+this.delay&&Ga.duration==this.UT(ja.endTime)-this.UT(ja.startTime))return Ga}return null};v.prototype.ldc=function(ja,ta){var Ka=null;if(!D(this.UT(ja.gZa)))switch(ja.yEg){case 0:Ka=F(this.element)?this.element[ta]:this.element;Ka=null==this.UT(ja.lda)?r(Ka,ja.type,this.EQb.fdc):this.UT(ja.lda);Ka=0==ja.operationType?
this.UT(ja.gZa)*Ka:this.UT(ja.gZa)+Ka;break;case 1:ta=(F(this.element)?this.EQb[ta]:this.EQb).$Ra(ja.type);D(ta)||(Ka=0==ja.operationType?this.UT(ja.gZa)*ta:this.UT(ja.gZa)+ta);break;case 2:Ka=this.UT(ja.gZa)}return Ka};f.prototype={element:null,delay:0,duration:0,lda:null,Z5a:null,d9:null,t5:null,zaa:null,extraData:null,startTime:null,qHd:!1,BJb:!1,a7a:!1};f.prototype.odc=function(ja,ta,Ka,Ga,Na,cb){this.element=ja;this.delay=ta;this.duration=Ka;this.zaa=Ga;this.extraData=Na;this.lda=new n;this.d9=
this.Z5a=null;this.t5=new n;this.startTime=null;this.qHd=!1;this.BJb=cb;this.a7a=!1};f.prototype.k7c=function(){null==ia&&(ia=new u);null==ia.Nxb&&ia.Ufh();"relative"==this.element.style.position&&(this.a7a=!0);this.startTime=new Date;this.currentTime=new Date;ia.k7c(this)};f.prototype.l7c=function(){ia.l7c(this)};f.prototype.Vfh=function(){this.currentTime=new Date;var ja=Number(this.currentTime)-Number(this.startTime);if(!(ja<this.delay)){ja-=this.delay;for(var ta=!0,Ka=!this.qHd,Ga=ba,Na=1;Na<=
Ga;Na++){var cb=this.t5.$Ra(Na);if(!D(cb))if(cb=this.efh(ja,this.duration,cb),F(this.element))for(var jb=this.element.length,Sa=0;Sa<jb;Sa++){var bb=this.element[Sa];var oa=this.lda.$Ra(Na);var ka=this.d9[Sa];ka=ka.$Ra(Na);D(oa)&&(null==this.Z5a&&(this.Z5a=Array(this.element.length)),D(this.Z5a[Sa])&&(this.Z5a[Sa]=new n),oa=this.Z5a[Sa].$Ra(Na),D(oa)&&(oa=r(bb,Na,this.BJb,this.a7a),this.Z5a[Sa].SetAttribute(Na,oa)));oa+=cb*(ka-oa);ja>=this.duration||1<cb?oa=ka:ta=!1;Ka&&ia.VEe(bb,Na);this.lGe(Na,
bb,oa)}else oa=this.lda.$Ra(Na),ka=this.d9,ka=ka.$Ra(Na),D(oa)&&(oa=r(this.element,Na,this.BJb,this.a7a),this.lda.SetAttribute(Na,oa)),oa+=cb*(ka-oa),ja>=this.duration||1<cb?oa=ka:ta=!1,Ka&&ia.VEe(this.element,Na),this.lGe(Na,this.element,oa)}this.qHd=!0;ta&&(this.l7c(),null!=this.zaa&&(La.gsa("calling fnishfunc"),this.zaa(this.extraData)))}};f.prototype.efh=function(ja,ta,Ka){var Ga=0;Ka=Z[Ka];switch(Ka.type){case 0:Ga=1;break;case 1:Ga=ja<ta?0:1;break;case 2:Ga=ja/ta;break;case 3:Ga=z(Ka.Ahl,Ka.Mhl,
Ka.Bhl,Ka.Nhl,ja/ta)}return Ga};f.prototype.lGe=function(ja,ta,Ka){La.Kjb[ta.id]=!0;switch(ja){case 1:this.Zfh(ta,Ka);break;case 2:this.dgh(ta,Ka);break;case 3:this.Yfh(ta,Ka);break;case 4:this.egh(ta,Ka);break;case 5:this.$fh(ta,Ka);break;case 6:this.cgh(ta,Ka);break;case 7:this.bgh(ta,Ka);break;case 8:this.agh(ta,Ka)}};f.prototype.Zfh=function(ja,ta){this.BJb?this.a7a?ja.style.marginRight=String(ta)+"px":ja.style.right=String(ta)+"px":this.a7a?ja.style.marginLeft=String(ta)+"px":ja.style.left=String(ta)+
"px";Ma&&La.gsa("element: "+ja.id+", "+(this.BJb?"right":"left")+": "+String(ta)+", timestamp: "+String(Number(new Date)))};f.prototype.dgh=function(ja,ta){this.a7a?ja.style.marginTop=String(ta)+"px":ja.style.top=String(ta)+"px";Ma&&La.gsa("element: "+ja.id+", top: "+String(ja.style.top)+", timestamp: "+String(Number(new Date)))};f.prototype.Yfh=function(ja,ta){ja.style.height=String(ta)+"px";Ma&&La.gsa("element: "+ja.id+", height: "+String(ja.style.height)+", timestamp: "+String(Number(new Date)))};
f.prototype.egh=function(ja,ta){ja.style.width=String(ta)+"px";Ma&&La.gsa("element: "+ja.id+", width: "+String(ja.style.width)+", timestamp: "+String(Number(new Date)))};f.prototype.$fh=function(ja,ta){G(ja,ta);Ma&&La.gsa("element: "+ja.id+", opacity: "+String(ta)+", timestamp: "+String(Number(new Date)))};f.prototype.cgh=function(ja,ta){ja.scrollTop=ta;Ma&&La.gsa("element: "+ja.id+", scrollTop: "+ta+", timestamp: "+String(Number(new Date)))};f.prototype.bgh=function(ja,ta){ja.scrollLeft=ta;Ma&&La.gsa("element: "+
ja.id+", scrollLeft: "+ta+", timestamp: "+String(Number(new Date)))};f.prototype.agh=function(ja,ta){O(ja,ta);Ma&&La.gsa("element: "+ja.id+", rotateZ: "+ta+", timestamp: "+String(Number(new Date)))};w.prototype={IAa:null,Ol:null,d8e:5,Lfb:null,dWa:0,$5a:0,grb:0,startTime:null,duration:null,b9d:0,Kjb:null,ngb:-1,tib:0,Qrb:-1,Hrb:-1};w.prototype.Start=function(){this.startTime=new Date;this.grb=this.$5a=0;this.Kjb={}};w.prototype.Wfh=function(){this.duration=Number(new Date)-Number(this.startTime);
this.b9d=ia.Oxb;this.ych();this.grb=this.$5a=0};w.prototype.Jbh=function(ja){this.IAa[this.$5a++]=ja};w.prototype.gsa=function(ja){this.Ol[this.grb++]=ja};w.prototype.zch=function(){var ja=0,ta=Number.MAX_VALUE,Ka=Number.MIN_VALUE,Ga=0,Na=0,cb="",jb="",Sa=new Date,bb="",oa=this.duration;D(oa)&&(oa=Number(Sa)-Number(this.startTime));if(Ma&&0<this.grb)for(var ka=this.grb,ya=0;ya<ka;ya++)0!=ya&&(cb+="<br/>"),cb+=this.Ol[ya];if(0<this.$5a){ja=this.$5a;for(ya=0;ya<ja;ya++)this.IAa[ya]<ta&&(ta=this.IAa[ya]),
this.IAa[ya]>Ka&&(Ka=this.IAa[ya]),Ga+=this.IAa[ya],0!=ya&&(jb+=", "),jb+=this.IAa[ya];1<ja&&(Ga/=ja-1);Ga=Math.round(100*Ga)/100;for(ya=0;ya<ja;ya++)ka=this.IAa[ya]-Ga,ka*=ka,Na+=ka;1<ja&&(Na/=ja-1);Na=Math.sqrt(Na);Na=Math.round(100*Na)/100;ja=this.$5a/oa*1E3;ja=Math.round(ja)}for(var Oa in this.Kjb)bb+=Oa,bb+=",";if(-1==this.Qrb||ja<this.Qrb)this.Qrb=ja;if(-1==this.Hrb||ja>this.Hrb)this.Hrb=ja;0==this.tib?(this.tib++,this.ngb=ja):(ya=this.ngb*this.tib,this.tib++,this.ngb=(ya+ja)/this.tib);ya=Array(12);
ya[0]=oa;ya[1]=ja;ya[2]=ta;ya[3]=Ka;ya[4]=Ga;ya[5]=Na;ya[6]=jb;ya[7]=cb;ya[8]=this.b9d;ya[9]=Number(this.startTime);ya[10]=Number(Sa);ya[11]=bb;return ya};w.prototype.ych=function(){var ja=this.zch();fa=ja;this.Xfh(ja)};w.prototype.Xfh=function(ja){this.Lfb[this.dWa]=ja;this.dWa++;this.dWa%=this.d8e};w.prototype.GetRecentAnimationStats=function(){for(var ja=[],ta=0,Ka=La.dWa;Ka<La.d8e;Ka++)null!=La.Lfb[Ka]&&(ja[ta]=La.Lfb[Ka],ta++);for(Ka=0;Ka<La.dWa;Ka++)null!=La.Lfb[Ka]&&(ja[ta]=La.Lfb[Ka],ta++);
return ja};w.prototype.GetAnimationSqmStats=function(){var ja=[];ja[0]=0>La.ngb?0:La.ngb;ja[1]=0>La.Qrb?0:La.Qrb;ja[2]=0>La.Hrb?0:La.Hrb;return ja};var La=new w,fa=null;H.Telemetry=La},1467:function(y,m,a){m=a(492);a=a(1468);a=a.$q?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1468:function(y,m,a){m=a(493)(!1);m.push([y.i,".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:700}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-button-holder,.ewa-bb-entry-link,.ewa-bb-entry-message,.ewa-bb-entry-title{vertical-align:middle}.ewa-nov2-ltr .ewa-bb-entry-close,.ewa-root-ltr .ewa-bb-entry-close{right:2px}.ewa-nov2-ltr .ewa-bb-content,.ewa-root-ltr .ewa-bb-content{margin-right:26px}.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-nov2-ltr .ewa-bb-entry-link,.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-root-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-nov2-rtl .ewa-bb-entry-close,.ewa-root-rtl .ewa-bb-entry-close{left:2px}.ewa-nov2-rtl .ewa-bb-content,.ewa-root-rtl .ewa-bb-content{margin-left:26px}.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-nov2-rtl .ewa-bb-entry-link,.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-root-rtl .ewa-bb-entry-link{margin-right:8px}",
""]);y.exports=m},1469:function(y,m,a){a.r(m);a.d(m,"AutoDetectActionButton",function(){return d});y=a(0);m=a(80);var c=a(1415),b=a(60),e=a(12),k=a(23);class d extends m.a{constructor(u,n,v,f,w){super();this.$=u;this.mM=f.wNb(u,n,v,"",b.a.Gn(11),w,"AutoDetectPointerDown",e.a.instance.ia(1808)+"...")}get PE(){return this.mM.PE}dispose(){this.mM.dispose();this.$=null;super.dispose()}domElement(u){return this.mM.domElement(u)}getButton(u){return this.mM.getButton(u,!1)}uAb(u,n,v,f){this.mM.R$a(c.a.AJi(u),
n,f);this.mM.v4c(v,n,f)}hra(u,n){const v=k.f(this.$),f=v.fh.Wn(u);u=v.Hl(u,f);const w=v.ol(f).Zr;if(u&&0<=u.x&&0<=u.y&&w.width>u.width+160){let r=u.bottomRight.x+this.PE,t=u.topLeft.y+this.PE,l=!1;r+160>w.bottomRight.x&&(r=u.topLeft.x-this.PE,l=!0);if(t<w.topLeft.y+this.PE){if(v.fh.r$a){this.hide();return}t=w.topLeft.y+this.PE}this.mM.PEd(n,f);this.hv(r,t,v.rtl,f,l)}else this.hide()}hv(u,n,v,f,w){this.mM.hv(u,n,v,f,!1,w)}hide(){this.mM.hide()}}Object(y.a)(d,"AutoDetectActionButton",m.a,[])},936:function(y,
m,a){a.d(m,"a",function(){return N});y=a(0);var c=a(2),b=a(15),e=a(95),k=a(291),d=a(17),u=a(159),n=a(184),v=a(6),f=a(98);m=a(266);var w=a(1221),r=a(19),t=a(7),l=a(374),x=a(60),A=a(16),z=a(70),F=a(12),D=a(23),G=a(96),Q=a(1100),O=a(1),J=a(157),H=a(25);class N extends m.a{constructor(L,Z){super(document.createElement("div"));this.l8f=this.O7e=this.h2e=this.rsc=this.epa=this.oka=this.w_=this.TI=null;this.Yga=this.x6=this.Zx=this.hideCloseButton=!1;this.zQj=ba=>{this.WD(ba)};this.FQj=ba=>{13===ba.keyCode&&
this.WD(ba)};this.D9d=ba=>{this.vr(ba.Gh);return!0};this.J9d=ba=>{this.A7(ba.Gh);return!0};this.lQc=ba=>{this.qZ(ba.Gh?ba.Gh:0);return!0};this.AQj=ba=>{this.WD(ba.La);return!0};this.ofh=ba=>{ba=void 0===ba?null:ba;this.vr(ba.inputMethod?ba.inputMethod:0);return!0};this.pfh=ba=>{ba=void 0===ba?null:ba;this.A7(ba.inputMethod?ba.inputMethod:0);return!0};this.Tda=L;this.rA=Z;this.ttd=Z.hHa.toString();this.title=Z.title;this.message=Z.message;this.set_visibilityMode(1)}get hHa(){return this.rA.hHa}get businessBar(){return this.Tda}get actionButton(){return this.rA?
this.rA.actionButton:""}get bWa(){return this.rA?this.rA.bWa:""}get linkText(){return this.rA?this.rA.link:""}get mMc(){return this.rA?this.rA.mMc:""}get ay(){return this.rA?this.rA.ay:""}get alt(){return this.rA?this.rA.alt:""}QBa(L){this.rA.businessBarType=L}dispose(){e.a.gj([this.rsc,this.w_,this.oka]);this.Zx&&this.w_&&(k.a.instance.Oa(d.a.click,this.w_.domElement,this.D9d),u.a.instance.n3(this.domElement,this.h2e));this.x6&&this.oka&&(k.a.instance.Oa(d.a.click,this.oka.domElement,this.J9d),u.a.instance.n3(this.domElement,
this.O7e));this.Yga&&this.epa&&(k.a.instance.Oa(d.a.click,this.epa,this.lQc),u.a.instance.n3(this.domElement,this.l8f));this.epa=this.TI=this.Tda=this.oka=this.w_=null;super.dispose()}update(){}Z8k(){this.Zmf(!0)}Blf(){this.Zmf(!1)}p$h(){const L=this.businessBar.$.Eh.wm("DOMUpdate","ReactBusinessBar");L.start();this.message=G.a.Tm(this.message);this.title=G.a.Tm(this.title);n.a.RNd().then(Z=>{Z.initializeMessageBarInStore();const ba=Object(c.a)(new Q.a,{messageTitle:this.title,message:this.message,
isMultiline:!1,messageBarType:this.rA.businessBarType,dismissButtonAriaLabel:F.a.instance.ia(10),closeable:O.EwaSettings.isChangeGateEnabled("OfficeVSO:8549880_BizBarCloseIconChange")?!this.hideCloseButton:void 0});this.hideCloseButton||(ba.onDismiss=this.AQj);this.Yga&&(ba.linkProps=Object.assign({},{["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.lQc},O.EwaSettings.isChangeGateEnabled("OfficeVSO:8717551_AriaLabelForBusinessBarLinks")&&0<this.mMc.length?{["aria-label"]:this.mMc}:
{}));this.Zx&&(ba.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.ofh});this.x6&&(ba.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.bWa,["onExecute"]:this.pfh});O.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.rA.iconName&&(ba.messageBarIconProps={["iconName"]:this.rA.iconName});Z.createNewMessageBarWithCallback(this.domElement,ba,()=>{v.AFrameworkApplication.ea.ka("Fluent2StyleIsEnabled")&&
(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");Object(J.d)(()=>{var K,E;return null===(E=null===(K=this.businessBar)||void 0===K?void 0:K.domElement)||void 0===E?void 0:E.appendChild(this.domElement)});L.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.rA.YIa} in: ${L.Ci} milliSeconds.`)});return null},Z=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.rA.YIa} could not be initialized. ${Z}`);
return null})}x9h(L){const Z=this.businessBar.$.Eh.wm("DOMUpdate","LegacyBusinessBar");Z.start();L||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var ba=this.businessBar.$.xi;L=ba+"ewaBusinessBarEntryBody"+this.ttd;const K=ba+"ewaBusinessBarEntryTitle"+this.ttd;var E=ba+"ewaBusinessBarEntryIcon"+this.ttd;this.domElement.className=w.c;A.DOMElementExtensions.wM(this.domElement);ba=document.createElement("div");ba.className=w.d;ba.id=L;var U=document.createElement("div");
U.className=w.b;var X=document.createElement("a");X.className=w.l;X.title=this.alt;var ia=document.createElement("span");ia.classList.add(r.a.zxd);ia.classList.add(w.h);ia.id=E;this.ay.length&&(E=document.createElement("img"),E.classList.add(this.ay),E.src=x.a.Gn(0),ia.appendChild(E));X.appendChild(ia);U.appendChild(X);X=document.createElement("span");X.classList.add(w.k);X.id=K;X.innerText=G.a.Tm(this.title);U.appendChild(X);X=document.createElement("span");X.classList.add(w.j);X.id="message";X.innerText=
G.a.Tm(this.message);U.appendChild(X);X=document.createElement("a");X.id="link";X.href="#";X.className=w.i;X.innerText=G.a.Tm(this.linkText);U.appendChild(X);X=document.createElement("span");X.classList.add(w.f);ia=document.createElement("button");ia.type="button";ia.id="action";ia.className=w.e;ia.innerText=G.a.Tm(this.actionButton);X.appendChild(ia);U.appendChild(X);X=document.createElement("span");X.classList.add(w.f);ia=document.createElement("button");ia.type="button";ia.id="altAction";ia.className=
w.e;ia.innerText=G.a.Tm(this.bWa);X.appendChild(ia);U.appendChild(X);ba.appendChild(U);U=document.createElement("a");U.className=w.g;U.tabIndex=0;U.setAttribute("role","button");X=document.createElement("span");X.id="close";X.classList.add(r.a.d5);ia=document.createElement("img");ia.classList.add(r.a.qGd);ia.src=x.a.Gn(13);ia.alt=F.a.instance.ia(793);ia.title=F.a.instance.ia(793);ia.setAttribute("role","button");X.appendChild(ia);U.appendChild(X);ba.appendChild(U);this.domElement.appendChild(ba);
A.DOMElementExtensions.wL(this.domElement,t.a.Kua,K,L);this.epa=$get("link",this.domElement);A.DOMElementExtensions.setVisible(this.epa,this.Yga);this.Yga&&(k.a.instance.xa(d.a.click,this.epa,this.lQc),this.l8f=u.a.instance.E2(this.epa,this.lQc,f.a.Au,f.a.oDa));this.w_=new l.a(A.DOMElementExtensions.getElementById(this.domElement,"action"));this.w_.isVisible=this.Zx;this.oka=new l.a(A.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.oka.isVisible=this.x6;this.Zx&&(k.a.instance.xa(d.a.click,
this.w_.domElement,this.D9d),this.h2e=u.a.instance.E2(this.w_.domElement,this.D9d,f.a.Au,f.a.oDa),this.x6&&(k.a.instance.xa(d.a.click,this.oka.domElement,this.J9d),this.O7e=u.a.instance.E2(this.w_.domElement,this.J9d,f.a.Au,f.a.oDa)));this.TI=$get("close",this.domElement);this.rsc=this.ml.Wk(this.TI);this.rsc.Ga("click",this.zQj);this.rsc.Ga("keydown",this.FQj);A.DOMElementExtensions.setVisible(this.TI,!this.hideCloseButton);Z.stop();b.ULS.sendTraceTag(508387361,0,50,`Legacy Business Bar created for ${this.rA.YIa} in: ${Z.Ci} milliSeconds.`)}Zmf(L){H.a.GJc()?
this.p$h():this.x9h(L)}vr(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.rA.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.rA.YIa}`);D.f(this.businessBar.$).Xz(!0)}A7(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.rA.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.rA.YIa}`);D.f(this.businessBar.$).Xz(!0)}qZ(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.rA.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.rA.YIa}`);D.f(this.businessBar.$).Xz(!0)}WD(L){b.ULS.sendTraceTag(21517971,
0,50,`BusinessBar [${this.rA.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.rA.YIa}`);this.set_visible(!1);this.businessBar.removeEntry(this.hHa);z.g(L)}yna(){return H.a.GJc()?this.domElement.getElementsByTagName("button")[0]:this.w_.domElement}}Object(y.a)(N,"BusinessBarEntry",m.a,[])},990:function(y,m,a){a.r(m);a.d(m,"ConvertToLinkedEntityManager",function(){return Ub});y=a(127);m=a(0);var c=a(15),b=a(95),e=a(247),k=a(6),d=a(34),u=a(1022),n=a(146),v=a(224),f=a(41),w=a(19),r=a(7),t=
a(170),l=a(1415),x=a(1182),A=a(191),z=a(664),F=a(398),D=a(64);const G=(Ra,Rb,ib,la,db,$b,Ic,Tc,Zc,cc,Yc)=>{Yc=Ra.Za(1,void 0===Yc?null:Yc);Yc.selectedRanges=Rb;Yc.isChangeObject=ib;Yc.isFloodgateEnabled=la;Yc.isStarterData=db;Yc.starterDataDomainId=$b;return D.h(Ra,"GetDataSelectorPaneData",Yc,Ic,Tc,Zc,cc,4)};var Q=a(144),O=a(962),J=a(1097);class H{}H.t$i="EnrichmentContentFrame";H.width=320;Object(m.a)(H,"EnrichmentConstants",null,[]);class N{constructor(Ra){this.messageType=0;this.messageType=Ra}}
Object(m.a)(N,"EnrichmentResponseMessage",null,[]);class L extends N{constructor(Ra,Rb){super(Ra);this.messageContent=null;this.messageContent=Rb}}Object(m.a)(L,"EnrichmentResponseMessageWithContent",N,[]);class Z extends L{constructor(Ra,Rb,ib){super(Ra,Rb);this.telemetryJson=null;this.telemetryJson=ib}}Object(m.a)(Z,"EnrichmentResponseMessageWithContentAndTelemetryData",L,[]);var ba=a(609),K=a(17),E=a(133),U=a(52),X=a(98),ia=a(159),Ma=a(47),qa=a(79),Ha=a(37),ha=a(138),La=a(929),fa=a(26),ja=a(24);
class ta{constructor(Ra,Rb,ib,la,db){this.uF=this.ht=this.qPe=this.oPe=this.zF=this.pE=null;this.PG=!1;this.Eng=$b=>{$b=$b.La.keyCode;return $b===Sys.UI.Key.enter||$b===Sys.UI.Key.space?(this.tsc(),!0):!1};this.Zmg=()=>{};this.bQc=()=>{};this.$mg=$b=>{$b=$b.rawEvent;if(!this.zF||-1!==this.zF.src.indexOf($b.origin)){try{var Ic=Ma.a($b.data)}catch(Tc){return}if(!La.c(Ic.messageType))switch(Ic.messageType){case 2:this.XSc(new Z(1,Ma.c(this.oPe),this.qPe));break;case 1:this.XSc(new L(0,this.xFi()));break;
case 3:this.pE&&this.pE.selectEntity(Ic.messageContent);break;case 5:this.pE&&this.pE.I0b(Ic.messageContent);break;case 8:this.pE&&(Ic=Ma.a(Ic.messageContent),0<Ic.DomainId?this.pE.voe(Ic.Query,Ic.TelemetryJson,Ic.DomainId,Ic.DomainIdString):this.pE.searchEntity(Ic.Query,Ic.TelemetryJson));break;case 6:this.pE&&this.pE.cancelSearch();break;case 11:Ic=Ma.a(Ic.messageContent);Ic=ta.auc("keydown","f6",X.a.vdc,!0,!1,Ic,!0,!1);this.zF&&this.zF.dispatchEvent(Ic);break;case 12:if(Ma.a(Ic.messageContent).keyCode===
X.a.r_&&(Ic=ta.auc("keydown","esc",X.a.r_,!0,!1,!1,!1,!1),this.zF&&(this.zF.dispatchEvent(Ic),this.hide(),this.pE)))this.pE.onPaneClosed();break;case 13:this.pE&&this.pE.O7b(Ic.messageContent);break;case 14:this.pE&&this.pE.pyb(Ic.messageContent);break;case 15:this.pE&&this.pE.Z9b(Ic.messageContent);break;case 16:this.pE&&(Ic=Ma.a(Ic.messageContent),this.pE.i1a(Ic.DomainId,Ic.DomainIdString))}}};this.Bu=Ra;this.kl=Rb;this.Ika=ib;this.Yi=la;this.$f=db;this.qEa=ia.a.Gy(X.a.FRa,0)}get Wxb(){return!0}get MPb(){return k.AFrameworkApplication.ea.Ya("EnrichmentPaneUrl")}dispose(){this.Wxb&&
this.uF&&(this.Bu.Oa(K.a.click,this.uF,Object(Q.a)(this,this.iAa,"onClosePaneClick")),this.kl.Oa(K.a.qk,this.uF,this.Eng));this.uF=null;this.zF&&(this.J7k(),this.zF.parentNode.removeChild(this.zF),this.zF=null);this.Yi.er("EnrichmentPaneId").$B(this.qEa)}show(Ra,Rb,ib){this.pE=Ra;this.PG||(this.ht=this.Rtc(),this.qne.appendChild(this.ht),this.Xjk(),this.$f.Uh(fa.a.vhf,ha.a.frame,Object(Q.a)(this,this.I3i,"handleEscapeKeyAction")),this.Dre(),this.PG=!0);this.zF.src=this.MPb&&this.MPb.length?this.MPb+
"?culture="+Rb.market+"&appName="+Rb.applicationName+"&themeId="+Rb.themeId+"&featuresBitMask="+Rb.featuresBitMask:ta.Sgg;this.oPe=Rb;this.qPe=ib;this.showInternal()}p4c(Ra,Rb){Ra=new Z(2,Ra,Rb);this.XSc(Ra)}Dre(){const Ra=this.Yi.er("EnrichmentPaneId");Ra.parent=ba.AFrame.xrb;this.Bu.Wmc("EnrichmentPaneId",this.ht);Ra.bindAction(this.qEa,fa.a.vhf)}rQg(){if(this.zF){E.FocusManager.YCa(this.zF.contentWindow);const Ra=new Z(4,null,null);this.XSc(Ra)}}iAa(){this.tsc();return!0}tsc(){this.hide();if(this.pE)this.pE.onPaneClosed()}Rtc(){const Ra=
O.a("div","EnrichmentPaneId","EnrichmentPane");this.Wxb&&Ra.appendChild(this.O7h());this.Jdj(Ra);return Ra}O7h(){const Ra=O.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),Rb=O.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");Rb.innerText=Object(ja.a)("EnrichmentPaneTitle");Rb.title=Object(ja.a)("EnrichmentPaneTitle");const ib=J.a.jh("CloseEnrichmentPane","EnrichmentPaneCloseButton",Object(ja.a)("Close"),"ClosePaneGlyph_16x16x32",!1);this.Bu.xa(K.a.click,ib,Object(Q.a)(this,
this.iAa,"onClosePaneClick"));this.kl.xa(K.a.qk,ib,this.Eng);Ra.appendChild(Rb);Ra.appendChild(ib);this.uF=ib;return Ra}Jdj(Ra){this.zF=O.b("iframe","","EnrichmentFrame");Ra.appendChild(this.zF);this.zF.id=H.t$i;this.zF.setAttribute("role","presentation")}Xjk(){U.a.addHandler(this.zF,"load",this.Zmg);U.a.addHandler(this.zF,"error",this.bQc);$addHandler(window,"message",this.$mg)}J7k(){U.a.removeHandler(this.zF,"load",this.Zmg);U.a.removeHandler(this.zF,"error",this.bQc);$removeHandler(window,"message",
this.$mg)}Oci(){this.zF.src=ta.Sgg}hide(){this.hideInternal();this.Oci()}I3i(Ra,Rb,ib){if(1!==ib&&(this.hide(),this.pE))this.pE.onPaneClosed();return 32}xFi(){return Ma.c([2,1,3,5,8,6])}XSc(Ra){Ra=Ma.c(Ra);this.zF.contentWindow.postMessage(Ra,qa.a.getOrigin(this.MPb))}static auc(Ra,Rb,ib,la,db,$b,Ic,Tc){Ha.a.uV?($b=String.format("{0} {1} {2}",$b?"Shift":"",Ic?"Control":"",Tc?"Alt":""),$b.trim(),ib=document.createEvent("KeyboardEvent"),ib.initKeyboardEvent(Ra,la,db,window.self,Rb,0,$b,!1,"en-US")):
(Rb={},Rb.keyCode=ib,Rb.ctrlKey=Ic,Rb.shiftKey=$b,Rb.altKey=Tc,Rb.bubbles=la,Rb.cancelable=db,ib=new KeyboardEvent(Ra,Rb));return ib}}ta.Sgg="about:blank";Object(m.a)(ta,"EnrichmentPane",null,[665,2]);var Ka=a(1);class Ga extends ta{constructor(Ra){super(k.AFrameworkApplication.ra.IJ,k.AFrameworkApplication.ra.qI,k.AFrameworkApplication.ra.FCa,k.AFrameworkApplication.ra.Nm,k.AFrameworkApplication.xh);this.taskPane=Ra;this.taskPane.IEh(this.rQg)}get qne(){return this.taskPane.ij}showInternal(){this.taskPane.isVisible||
this.taskPane.iF(!0)}hideInternal(){this.taskPane.iF(!1)}get Wxb(){return!Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")}dispose(){this.taskPane&&(this.taskPane.Bpk(this.rQg),this.taskPane=null);super.dispose()}}Object(m.a)(Ga,"EnrichmentTaskPaneWrapper",ta,[]);class Na{constructor(Ra){this.BI=null;this.Bsa=Ra}$wj(Ra,Rb){this.BI=Ra;this.Bsa&&this.Bsa.show(this,Rb,null)}p4c(Ra,Rb){this.Bsa&&this.Bsa.p4c(Ra,Rb)}NSd(){this.Bsa&&this.Bsa.hide()}dispose(){this.Bsa&&
(this.Bsa.dispose(),this.Bsa=null)}selectEntity(Ra){return this.BI?this.BI.selectEntity(Ra):!1}searchEntity(Ra,Rb){this.BI&&this.BI.searchEntity(Ra,Rb)}voe(Ra,Rb,ib,la){this.BI&&this.BI.voe(Ra,Rb,ib,la)}I0b(Ra){return this.BI?this.BI.I0b(Ra):!1}onPaneClosed(){if(this.BI)this.BI.onPaneClosed()}cancelSearch(){this.BI&&this.BI.cancelSearch()}O7b(Ra){this.BI&&this.BI.O7b(Ra)}pyb(Ra){this.BI&&this.BI.pyb(Ra)}Z9b(Ra){this.BI&&this.BI.Z9b(Ra)}i1a(Ra,Rb){this.BI&&this.BI.i1a(Ra,Rb)}}Object(m.a)(Na,"EnrichmentManager",
null,[664,2]);class cb extends Na{constructor(Ra){super(Ra)}dispose(){super.dispose()}}Object(m.a)(cb,"ExcelEnrichmentManager",Na,[]);var jb=a(12);class Sa{constructor(Ra){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Ra;this.commentQuestion=jb.a.instance.sh(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];
this.ratingQuestion=jb.a.instance.sh(195);this.ratingValuesAscending=[jb.a.instance.sh(196),jb.a.instance.sh(197),jb.a.instance.sh(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=jb.a.instance.sh(194)}}Object(m.a)(Sa,"FloodgateSurvey",null,[]);var bb=a(27),oa=a(63),ka=a(495),ya=a(46),Oa=a(431),za=a(216),ea=a(84),Aa=a(36),ub=a(265),rb=a(23);class Ja{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;
this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(m.a)(Ja,"EnrichmentMessageContentAppProperties",null,[]);class Xa{constructor(Ra,Rb,ib,la,db){this.xIa=this.erf=!1;this.Uwb=this.Mya=!0;this.g3b=this.A9b=!1;this.zyb=null;this.cSc=0;this.YE=()=>{(this.Uwb||this.xIa)&&2!==this.cSc&&(this.g3b||this.N2d(!1))};this.hj=()=>{c.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.qRj=$b=>{Aa.a.ll($b.Errors)?($b=Aa.a.fi($b.Errors),
$b.includes("OperationSucceededWithAlert")?c.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):c.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${$b}`)):$b.Result&&(this.$.fa.Lq(this.hj),this.$.fa.Nq(this.hj),$b=$b.Result,this.zyb=$b.SkydanceFeatureBitmask,this.s7d($b),this.A9b=!0)};this.xm=()=>{(this.Uwb||this.xIa)&&this.N2d(!1)};this.VPc=($b,Ic)=>{Aa.a.ll($b.Errors)?c.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Aa.a.fi($b.Errors)}`):
$b.Result&&($b=$b.Result,$b.DisambiguationJson?(this.A9b=!1,this.xRg(Ic),this.zyb=$b.SkydanceFeatureBitmask,Ic=$b.DisambiguationJson,c.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.g3b=!1,this.M7f(Ic)):c.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.EUj=($b,Ic)=>{Aa.a.ll($b.Errors)?(Ic=Aa.a.fi($b.Errors),c.ULS.sendTraceTag(36975689,
0,10,`Failed to retrieve disambiguation data for search. errors: ${Ic}`)):$b.Result&&($b=$b.Result,$b.DisambiguationJson?(this.xRg(Ic),this.zyb=$b.SkydanceFeatureBitmask,Ic=$b.DisambiguationJson,c.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.g3b=!0,this.M7f(Ic)):c.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};
this.hYj=$b=>{Aa.a.ll($b.Errors)?($b=Aa.a.fi($b.Errors),c.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${$b}`),this.Uwb=!0):$b.Result&&($b=$b.Result,this.zyb=$b.SkydanceFeatureBitmask,this.s7d($b),this.A9b=!0)};this.j0j=$b=>{if(Aa.a.ll($b.Errors)){const Ic=Aa.a.fi($b.Errors);c.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${Ic}`)}$b.Result?(this.s7d($b.Result),this.A9b=!0):this.zHa()};this.lrg=$b=>{Aa.a.ll($b.Errors)?
($b=Aa.a.fi($b.Errors),c.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${$b}`)):$b.Result?this.txc.p4c($b.Result,null):(c.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.zHa())};this.WWj=$b=>{Aa.a.ll($b.Errors)?($b=Aa.a.fi($b.Errors),c.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${$b}`)):this.zHa()};
this.$=Ra;this.da=rb.f(this.$);this.da.ha.BX(this.xm);this.da.gA(this.YE);this.wvf=la;this.nt=db;Ra=new Ga(Rb);this.txc=new cb(Ra);v.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute($b=>{$b.isFeatureEnabled("mso_sendASmile",!0).then(Ic=>{this.Mya=Ic;return null})})}dispose(){this.$&&(this.da.ha.JZ(this.xm),this.da.dF(this.YE))}selectEntity(Ra){const Rb=ya.q(this.da.ha.pa.activeCell,this.$),ib=()=>new ka.a;Oa.a(this.$.userOperationManager,(la,db,$b)=>{var Ic=this.$.oa.ta;
la=ub.c(la,this.j0j);const Tc=Ic.Za(9,null);Tc.activeCell=Rb;Tc.selectionIndex=Ra;return D.h(Ic,"SelectLinkedEntityForDisambiguation",Tc,la,db,$b,null,4)},la=>new za.a(109,0,la,void 0,ib),null);return!0}searchEntity(Ra,Rb,ib,la,db){ib=void 0===ib?!1:ib;la=void 0===la?0:la;db=void 0===db?null:db;c.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${Rb}`);const $b=ya.q(this.da.ha.pa.activeCell,this.$);Oa.a(this.$.userOperationManager,
(Ic,Tc,Zc)=>{var cc=this.$.oa.ta,Yc=this.Mya,Vc=ib,wd=la,wc=db;Ic=ub.c(Ic,this.lrg);const Ya=cc.Za(1,null);Ya.searchCell=$b;Ya.searchQuery=Ra;Ya.isFloodgateEnabled=Yc;Ya.isStarterData=Vc;Ya.starterDataDomainId=wd;Ya.starterDataDomainIdString=wc;return D.h(cc,"LinkedEntitySearch",Ya,Ic,Tc,Zc,null,4)},Ic=>new za.a(110,0,Ic,16),null)}I0b(Ra){const Rb=ya.q(this.da.ha.pa.activeCell,this.$);this.Uwb=!1;Oa.a(this.$.userOperationManager,(ib,la,db)=>{var $b=this.$.oa.ta;ib=ub.c(ib,this.hYj);const Ic=$b.Za(1,
null);Ic.activeCell=Rb;Ic.isBackward=Ra;return D.h($b,"MoveToNextAmbiguousLinkedEntity",Ic,ib,la,db,null,4)},ib=>new za.a(111,0,ib,16),null);return!0}onPaneClosed(){this.xIa=!1;this.erf=!0;this.cSc=0;this.g3b=!1}cancelSearch(){const Ra=this.Toe();Ra&&Oa.a(this.$.userOperationManager,(Rb,ib,la)=>{var db=this.$.oa.ta;Rb=ub.c(Rb,this.lrg);const $b=db.Za(9,null);$b.activeCell=Ra;return D.h(db,"CancelSearchLinkedEntity",$b,Rb,ib,la,null,4)},Rb=>new za.a(112,0,Rb,16),null)}O7b(Ra){c.ULS.sendTraceTag(537166977,
0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.zHa();if(Ra&&Ra.length)if(Ra=JSON.parse(Ra))if(null==Ra.domainId)c.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var Rb={};Rb.Id=Ra.domainId;Rb.StringId=Ra.stringId;this.nt.convertToLinkedEntity(Rb)}else c.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else c.ULS.sendTraceTag(537166976,
0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}pyb(Ra){const Rb=new ea.a(-859308420,oa.a.ph,this.$.ji,9,null);this.$.Ia.qh(Rb,{[oa.a.hl]:"HelpID="+Ra,["InputMethod"]:oa.a.ph,["ShouldCanvasTakeFocus"]:!0,[oa.a.Pi]:r.a.NK})}Z9b(Ra){x.a.d9a(new Sa(Ra))}i1a(Ra,Rb){const ib=this.Toe();ib&&Oa.a(this.$.userOperationManager,(la,db,$b)=>{var Ic=this.$.oa.ta;la=ub.c(la,this.WWj);const Tc=Ic.Za(1,null);Tc.cell=ib;Tc.starterDataDomainId=Ra;Tc.starterDataDomainIdString=Rb;return D.h(Ic,
"InsertStarterDataTable",Tc,la,db,$b,null,4)},la=>new za.a(259,0,la,1),null)}N2d(Ra){this.launchOrCloseDisambiguationPane(Ra)}launchDisambiguationPaneForSearch(){c.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const Ra=this.cBk();Ra&&Oa.a(this.$.userOperationManager,(Rb,ib,la)=>G(this.$.oa.ta,Ra,!0,this.Mya,!1,null,ub.c(Rb,this.EUj),ib,la,1),Rb=>new za.a(114,0,Rb,16),null)}launchLinkedEntityDataTypeSelectorPane(Ra,
Rb){Oa.a(this.$.userOperationManager,(ib,la,db)=>{var $b=this.$.oa.ta;ib=ub.c(ib,this.VPc);const Ic=$b.Za(1,null);Ic.selectedRanges=Ra;Ic.letyDomainId=Rb;return D.h($b,"GetDataTypeSelectorData",Ic,ib,la,db,2,4)},ib=>new za.a(233,0,ib,16),null)}Uwj(Ra,Rb){Ra&&Oa.a(this.$.userOperationManager,(ib,la,db)=>G(this.$.oa.ta,Ra,!1,!1,!0,Rb,ub.c(ib,this.VPc),la,db,2),ib=>new za.a(257,0,ib,16),null)}xRg(Ra){Ra&&(this.cSc=Ra)}M7f(Ra){var Rb=new ea.a(-90814711,oa.a.ph,0,10,null);this.$.Ia.qh(Rb,null);this.xIa?
this.txc.p4c(Ra,null):(Rb=3,null!=this.zyb?Rb=this.zyb:c.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Ra=this.ZLi(Ra,Rb))||c.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.wvf||c.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.txc.$wj(this.wvf,Ra),this.xIa=!0)}zHa(){this.xIa&&(c.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.txc.NSd(),
this.xIa=!1,this.cSc=0,this.g3b=!1)}s7d(Ra){var Rb=Ra.Row+1;Ra=Ra.Column+1;0>Rb||0>Ra?(c.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.zHa(),this.$.fa.Lq(this.hj)):(Rb=new bb.Range(Rb,Ra,Rb,Ra,!0,!1),this.da.ha.updateSelection(Rb,Rb,60),this.Uwb=!0)}ZLi(Ra,Rb){const ib=new Ja;ib.applicationVersion=k.AFrameworkApplication.buildVersion;ib.applicationName="ExcelWac";ib.anid="00000000-0000-0000-0000-000000000000";
ib.sessionId=k.AFrameworkApplication.userSessionId;ib.appCorrelationId=A.a.create().toString();var la=z.a.bS(k.AFrameworkApplication.lcid);la=la?la.name:null;ib.uiLanguage=la;ib.market=this.mBc(la);ib.themeId=0;ib.disambiguationJson=Ra;Rb<=F.a.v9?ib.featuresBitMask=Rb:c.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return ib}mBc(Ra){Ra=Ra.split("-");return Ra[Ra.length-1]}launchOrCloseDisambiguationPane(Ra){const Rb=this.da.ha.pa.activeCell;
if(this.Toe()&&Rb)if(this.da.oh.iWb(Rb)){if((!this.erf||Ra||this.A9b)&&!this.da.isEditing){Ra&&(this.Uwb=!0);var ib=ya.s(Rb,this.$);Oa.a(this.$.userOperationManager,(la,db,$b)=>G(this.$.oa.ta,ib,!1,this.Mya,!1,null,ub.c(la,this.VPc),db,$b,1),la=>new za.a(114,0,la,16),null)}}else this.zHa();else this.zHa()}Lik(){if(this.xIa){var Ra=this.da.ha.pa.activeCell;if(Ra){var Rb=ya.s(Ra,this.$);Oa.a(this.$.userOperationManager,(ib,la,db)=>G(this.$.oa.ta,Rb,!1,this.Mya,!1,null,ub.c(ib,this.VPc),la,db,1),ib=>
new za.a(114,0,ib,16),null)}else this.zHa()}}Toe(){const Ra=this.da.ha.pa;return Ra.lza()?ya.q(Ra.activeCell,this.$):null}cBk(){const Ra=this.da.ha.pa;return Ra.lza()?ya.s(Ra.activeCell,this.$):null}}Object(m.a)(Xa,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var Y=a(2),Ia=a(290),$a=a(1232),Ea=a(60),Lb=a(940);class Ib{constructor(Ra,Rb,ib){this.o8f=2;this.n8f="Size64by48";this.$=Ra;this.Wa=Rb;this.nt=ib}mDi(Ra,Rb){var {ConvertToLinkedEntityManager:ib}=a(990);this.w$k();Rb=this.Wa.tw(Rb).lM();
let la=0,db=0,$b=!1;for(var Ic of Ra.Categories){const Tc=this.WDi(Ic,la);Tc&&(db===ib.Wqb&&($b=!0),Rb.MenuSectionList.push(Tc),++la);++db}$b&&la<=ib.p8f&&Rb.MenuSectionList.splice(ib.Wqb,1);ib=this.Wa.ii().sqc();Ic=Ea.a.Gn(11);for(const Tc of Ra.LongButtons)this.nt.fPk(Tc)&&this.QAh(ib,Tc,Ic);0<ib.ControlList.length&&Rb.MenuSectionList.push(ib);return Rb}QAh(Ra,Rb,ib){if(Rb){var la="Data.ConvertToLinkedEntityMenuItem_"+Rb.Name,db=this.nt.H5(Rb.DomainId);db&&(Rb=Object(Y.a)(new Ia.a,{Id:la,ExternalId:la,
Command:"-1662108744",LabelText:Rb.Name,Alt:Rb.SuperTip,Visible:!0,MenuItemId:a(990).ConvertToLinkedEntityManager.yjb(Rb.DomainId),Image16by16:ib,Image16by16Class:this.T$i(db.FontLocator)}),Ra.ControlList.push(Rb))}}PDi(Ra,Rb){return Object(Y.a)(new $a.a,{Id:a(990).ConvertToLinkedEntityManager.ctf+Ra.toString(),ExternalId:a(990).ConvertToLinkedEntityManager.ctf+Ra.toString(),MenuItemId:a(990).ConvertToLinkedEntityManager.jEd+Ra.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",
Icon:this.GUf(Rb.FontLocator),LabelText:Rb.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.XLd(Rb)})}vMh(Ra){switch(Ra){case "Animal":return Lb.a.qIh;case "Apple":return Lb.a.vJh;case "Atom":return Lb.a.cLh;case "Beaker":return Lb.a.lNh;case "Bridge":return Lb.a.UOh;case "Cat":return Lb.a.BVh;case "City":return Lb.a.VXh;case "Constellation":return Lb.a.d2h;case "Dog":return Lb.a.Tii;case "Finance":return Lb.a.dNh;case "GradCap":return Lb.a.c2i;case "HumanAnatomy":return Lb.a.p$i;
case "LocationPointer":return Lb.a.dAj;case "Map":return Lb.a.V3j;case "MedicineNeedle":return Lb.a.iHj;case "Mountain":return Lb.a.CIj;case "Movie":return Lb.a.TIj;case "Music":return Lb.a.aKj;case "OuterSpace":return Lb.a.J4j;case "Planet":return Lb.a.y8j;case "Satellite":return Lb.a.Yxk;case "WolframGeneric":return Lb.a.Owk;default:return Lb.a.a4h}}T$i(Ra){if("PowerBIRibbon"!==Ra)return w.a.pGd;switch(Ra){case "AnimalRibbon":return w.a.Ori;case "AppleRibbon":return w.a.Pri;case "AtomRibbon":return w.a.Qri;
case "BeakerRibbon":return w.a.Rri;case "BridgeRibbon":return w.a.Sri;case "CenterMapRibbon":return w.a.Tri;case "CityRibbon":return w.a.Vri;case "CurrencyRibbon":return w.a.Wri;case "ExerciseRibbon":return w.a.Xri;case "FinanceRibbon":return w.a.ryf;case "FirstAidRibbon":return w.a.Yri;case "GlobeLightningRibbon":return w.a.Zri;case "GradCapRibbon":return w.a.$ri;case "HumanAnatomyRibbon":return w.a.asi;case "LeafRibbon":return w.a.bsi;case "LocationPointerRibbon":return w.a.dsi;case "MapRibbon":return w.a.pyf;
case "MountainRibbon":return w.a.esi;case "MovieRibbon":return w.a.fsi;case "MusicRibbon":return w.a.gsi;case "NotablePeopleRibbon":return w.a.hsi;case "OuterSpaceRibbon":return w.a.isi;case "PartlySunnyWeatherRibbon":return w.a.jsi;case "PowerBIRibbon":return w.a.qyf;case "SatelliteRibbon":return w.a.ksi;case "WolframGenericRibbon":return w.a.csi;case "YogaRibbon":return w.a.msi;default:return w.a.oyf}}GUf(Ra){switch(Ra){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";
case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";
case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";
case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}WDi(Ra,Rb){Rb=this.Wa.GM("ConvertToLinkedEntitySection_"+Rb,this.o8f,this.n8f);var ib=!1;for(var la of Ra.DomainIds){const db=this.nt.H5(la);if(!db||db.DomainBlocked||!db.ShowInRibbon)continue;
ib=db.Name;const $b=a(990).ConvertToLinkedEntityManager.yjb(la);Rb.uD("Data.ConvertToLinkedEntityMenuItem_"+$b,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,$b,this.GUf(db.FontLocator),void 0,void 0,this.XLd(db),ib);ib=!0}if(!ib)return null;la=Rb.rqc(!0);Rb=this.Wa.ii();Rb.title=Ra.Name;Ra=Rb.sqc();Ra.ControlList.push(la);return Ra}w$k(){this.o8f=5;this.n8f="Size112by64"}XLd(Ra){return Ra.RibbonTooltipHeader?Ra.RibbonTooltipHeader+"\n\n"+Ra.RibbonTooltip:Ra.RibbonTooltip}}Object(m.a)(Ib,"ConvertToLinkedEntityMenuRenderer",
null,[650]);var Mb=a(61),mc=a(364),jc=a(128),Fc=a(101);class Gc{constructor(Ra,Rb){this.mSd=this.nSd=!1;this.y2b=ib=>{c.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.nSd=!0;if(Aa.a.ll(ib.Errors))c.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Aa.a.fi(ib.Errors)}`);else{var la=0,db=[],$b=!1;try{if(!ib.Result)return;const Ic=ib.Result;if(!Ic){c.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");
return}db=this.r6j(Ic);if(!db||!db.length)return;la=db.length;this.AHj(db);this.APa.iJg();c.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.APa.kvb.length}`);if(Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const Tc of this.APa.kvb)if(1===(Tc.Id&1048320)>>8){$b=!0;break}c.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${$b}`)}}finally{c.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${la} data types.`),
Fc.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,[{name:"MruCount",int64:la},{name:"MruWolframAvailable",bool:$b}])}this.mSd&&(this.Sah(this.APa.kvb),this.mSd=!1)}};this.d3b=ib=>{c.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Aa.a.ll(ib.Errors)?c.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Aa.a.fi(ib.Errors)}`):ib.Result&&(ib.Result||c.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};
this.C2b=(ib,la,db)=>{ib=jc.a.$j(ib.data);c.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${db}. Errors: ${Aa.a.fi(ib)}.`)};this.$=Ra;this.APa=Rb}GVi(){!this.nSd&&this.$.fa.ki&&(c.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),mc.D(this.$.oa.ta,0,this.y2b,this.C2b,null,null))}Sah(Ra){Ra&&Ra.length?this.nSd?(Ra=this.ZCk(Ra))?(c.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),
mc.K(this.$.oa.ta,0,Ra,this.d3b,this.C2b,null,null)):c.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.mSd=!0:c.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}ZCk(Ra){if(!Ra||!Ra.length)return c.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var Rb=[];for(const ib of Ra)Ra=
{},Ra.Id=ib.Id,ib.StringId&&(Ra.StringId=ib.StringId),Rb.push(Ra);Rb="<DataTypes>"+Mb.a.Di(Rb)+"</DataTypes>";return 1906<Rb.length?(c.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):Rb}r6j(Ra){if(!Ra)return c.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!Ra.startsWith("<DataTypes>")||!Ra.endsWith("</DataTypes>"))return c.ULS.sendTraceTag(537166684,
0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Ra=Ra.substring(11,Ra.length-12);if(!Ra)return c.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let Rb=[];try{Rb=Mb.a.Vp(Ra)}catch(ib){return c.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${ib.message}`),null}c.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Rb.length} data types.`);
return Rb}AHj(Ra){const Rb=this.APa.kvb,ib=this.APa.uhk;if(Rb.length!==ib){for(let la=0;la<Ra.length&&Rb.length<ib;++la){const db=Ra[la];this.APa.H5(db)&&!Rb.includes(db)&&Rb.push(db)}this.APa.kvb=Rb}}}Object(m.a)(Gc,"LinkedDataTypeRoamingHandler",null,[]);var xc=a(66),Uc=a(78),Pa=a(157),Bb=a(40),Nb=a(58),oc=a(33),aa=a(255),rc=a(28),yb=a(107),Fb=a(91),Qb=a(92),ac=a(5),Wa=a(792),Gb;let Ub=Gb=class extends f.a{constructor(Ra,Rb,ib,la,db,$b,Ic){super();this.j4f=this.W_d=this.a1d=this.yZd=this.xZd=this.zJc=
null;this.j1b=this.QRd=0;this.Dza=null;this.SVd=!1;this.XJd=this.yw=this.lne=null;this.HB=0;this.ER=null;this.y0a=8;this.wvd=this.m8f=this.H_f=this.xtb=!1;this.pOa=this.AEf=this.OAf=null;this.ptd=0;this.GMh=5;this.Gpc=3E4;this.Z2g=!1;this.Pua=null;this.IIa=Array(5);this.X5g=this.EAe=!1;this.LKg=this.o3d=0;this.Bi=this.BTe=null;this.rXg=!0;this.hj=(Tc,Zc)=>{Zc.ki&&!Zc.IYb&&this.showUntrustedImageBusinessBarIfNecessary()};this.JVj=Tc=>{if(Tc.Result){var Zc=Tc.Result;if(Zc&&Zc.length){c.ULS.sendTraceTag(537166922,
0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Zc.length} labels`);var cc=Uc.GetServiceTaskFactory.dk(this.$.qa,274,275,0);Bb.TaskExtensions.$e(cc,()=>{cc.result.etd(Zc,2)||c.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ya,3)}}else c.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.Wl=()=>{this.i5k();this.M4i(this.$.fa.Aq.LinkedEntityAsyncRefreshStateId);this.a6i(this.$.fa.Aq.RichDataClassificationLabelStateId)};
this.LSj=()=>{this.EAe=!0;this.yw&&this.yw.Lik()};this.XUj=Tc=>{if(Tc&&!aa.a(Tc))try{Tc.Result.HasUntrustedImageUrl&&(this.businessBar.Rm(59,null),this.X5g=!0)}catch(Zc){c.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Zc}.`)}};this.K7f=()=>{if(!this.m8f&&this.SWb()&&!this.YWd())if(Fc.a("DataTabActive"),xc.a.Zl.PY)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Tc=
this.Ptc();if(Tc){var Zc={};Zc.InputMethod=oa.a.ph;Zc.CalloutName=8;Zc.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ia.qh(Tc,Zc);this.m8f=!0}else c.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else c.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else c.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};
this.rRj=Tc=>{Aa.a.ll(Tc.Errors)||this.raiseEvent("LinkedEntityConverted")};this.q1j=()=>{Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void Qb.a.uj(ac.l).then(Tc=>{Tc.readText(jb.a.instance.ia(1813))}):this.$.qa.zi(211,Tc=>{Tc.readText(jb.a.instance.ia(1813))})};this.Dj=(Tc,Zc)=>{c.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Zc.J1?c.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):
(this.$.isEditMode?this.Xff():this.kuk(),this.EAe&&this.wuf())};this.gVj=Tc=>{this.Yrc();if(Tc.Result){var Zc=Tc.Result;Tc=Zc.DomainDataArray;if(this.Dza=Zc.Ribbon){var cc={};cc.Name=jb.a.instance.ia(1803);cc.DomainIds=this.XY;this.Dza.Categories.splice(Gb.Wqb,0,cc)}0<Zc.MaximumCellsToConvert&&(this.BTe=Zc.MaximumCellsToConvert);this.HB=2;Zc=!1;if(Tc){c.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${Tc.length} domains`);this.H3a||(this.H3a=[]);cc=jb.a.instance.ia(1800);
const Yc=jb.a.instance.ia(1802);for(const Vc of Tc)Vc.DomainId?(this.H3a.push(Vc),Vc.DomainBlocked?(Tc=!!Vc.DomainId.StringId,c.ULS.sendTraceTag(537166861,0,50,`Domain: ${Tc?Vc.DomainId.Id.toString():Vc.Name} is telemetry only, do not show in menu (Has String ID: ${Tc})`)):(this.G5.ga(Gb.yjb(Vc.DomainId),Vc),Vc.Name===cc||268435456===Vc.DomainId.Id?this.OAf=Vc.DomainId.Id.toString():Vc.Name===Yc||536870912===Vc.DomainId.Id?this.AEf=Vc.DomainId.Id.toString():268435712===Vc.DomainId.Id&&Vc.ShowInRibbon&&
(this.wvd=!0),Zc=!0)):c.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Zc||(this.H3a=null);this.L6g();this.lne.GVi();this.Z2g||(this.e5k(),this.Z2g=!0)}else this.H3a=null,this.HB=3,-1<this.y0a&&window.setTimeout(()=>{this.Z3b()},100*(8-this.y0a)),c.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.gie();this.Bmf();this.wvd&&this.l1f&&Pa.e(this.K7f,this.$.ya,500)};this.fVj=Tc=>{Tc=jc.a.$j(Tc.data);c.ULS.sendTraceTag(34415007,
0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Aa.a.fi(Tc)}].`);this.H3a=null;this.HB=3;this.xtb=!0;this.gie()};this.onContentReady=()=>{this.y4g()&&this.da.dF(this.onContentReady);this.rXg&&this.$.workbookContext.Options&1048576&&(this.businessBar.LTk(),this.rXg=!1)};this.nq=()=>{this.Yrc()};this.FXj=Tc=>{if(aa.a(Tc)){if(Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void Qb.a.resolve(ac.E,{va:0}).then(cc=>{let Yc=null;if(null===Tc||void 0===
Tc?0:Tc.Errors)Yc=Tc.Errors[0];cc.Hue(Yc,null)});else{const cc=Object(Fb.d)(Qb.a.resolve(ac.E,{va:0}));Bb.TaskExtensions.$e(cc,()=>{let Yc=null;if(null===Tc||void 0===Tc?0:Tc.Errors)Yc=Tc.Errors[0];cc.result.Hue(Yc,null)},this.$.ya,3)}c.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Aa.a.fi(Tc.Errors)}].`);const Zc=Aa.a.iT(Tc.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");
this.$.fa.yx(Zc)}};this.qvd=()=>{c.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.Gpc} millisecond interval`);this.zXf("Periodic auto-refresh check",this.APj,this.zPj)};this.APj=Tc=>{aa.a(Tc)?(c.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Aa.a.fi(Tc.Errors)}].`),++this.ptd):this.ptd=0;b.a.gh(this.pOa);this.ptd>=this.GMh?
(c.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.pOa=null):(c.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.pOa=Nb.a.instance.create(this.qvd,this.Gpc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.zPj=Tc=>{Tc=jc.a.$j(Tc.data);e.a.Km(Tc)?c.ULS.sendTraceTag(537166791,
0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):c.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Aa.a.fi(Tc)}].`);b.a.gh(this.pOa);this.pOa=Nb.a.instance.create(this.qvd,this.Gpc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.MYj=Tc=>{Tc=!!Tc.Result&&Tc.Result;c.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${Tc.toString()}`);
Tc?(c.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${oc.a.kh.Xj.m-this.QRd} ms, retry count = ${this.j1b}`),this.Z3b()):this.R0c()};this.LYj=()=>{c.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.R0c()};this.IUj=Tc=>{Tc.Result?(Tc=Tc.Result)?(this.Aje(),this.businessBar.Hue(null,Tc)):c.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):c.ULS.sendTraceTag(537166726,
0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=Ra;this.businessBar=$b;this.svgIconProvider=ib;this.Bi=Ic;this.H3a=[];this.XY=[];this.da=rb.f(this.$);this.sEc=-1;this.Loj=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.l1f=Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.G5=new yb.a;this.Lrb=new Ib(Ra,Rb,this);la&&(this.yw=new Xa(Ra,la,db,this,
this));this.$.nr(this.Dj);t.a(this.$)&&t.a(this.$).JEk(this);this.Xff();this.$.fa.vz(this.Wl);Ka.EwaSettings.Na(123)&&Ka.EwaSettings.Na(131)&&(this.y4g()||this.da.gA(this.onContentReady));this.$.LI(this.nq);this.$.fa.Nq(this.hj);this.showUntrustedImageBusinessBarIfNecessary();this.lne=new Gc(this.$,this)}dispose(){this.$.fa.SB(this.Wl);this.$.fa.Lq(this.hj);!this.Pua&&Ka.EwaSettings.Na(123)&&Ka.EwaSettings.Na(131)&&this.da.dF(this.onContentReady);this.yw&&this.yw.dispose();this.$.mL(this.nq);this.$.$r(this.Dj);
b.a.gh(this.pOa)}lEh(Ra){this.addHandler("LinkedEntityConverted",Ra)}lpk(Ra){this.removeHandler("LinkedEntityConverted",Ra)}get uhk(){return 5}get kvb(){return this.XY}set kvb(Ra){this.XY=Ra}selectEntity(Ra){return this.yw?this.yw.selectEntity(Ra):!1}searchEntity(Ra,Rb){this.yw&&this.yw.searchEntity(Ra,Rb)}voe(Ra,Rb,ib,la){this.yw&&this.yw.searchEntity(Ra,Rb,!0,ib,la)}I0b(Ra){return this.yw?this.yw.I0b(Ra):!1}onPaneClosed(){if(this.yw)this.yw.onPaneClosed()}cancelSearch(){this.yw&&this.yw.cancelSearch()}O7b(Ra){this.yw&&
this.yw.O7b(Ra)}pyb(Ra){this.yw&&this.yw.pyb(Ra)}Z9b(Ra){this.yw&&this.yw.Z9b(Ra)}i1a(Ra,Rb){this.yw&&this.yw.i1a(Ra,Rb)}a6i(Ra){if(this.$.isEditMode&&this.LKg!==Ra&&k.AFrameworkApplication.ea.ka("SupportsPolicies")){this.LKg=Ra;c.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");Ra=this.$.oa.ta;var Rb=this.JVj;const ib=Ra.Za(1,null);D.h(Ra,"GetRichDataClassificationLabels",ib,Rb,null,null,null,4)}}wuf(){this.$.userOperationManager.enqueueOperation(new za.a(589,
0,(Ra,Rb,ib)=>{var la=this.$.oa.ta;Ra=ub.c(Ra,this.LSj);const db=la.Za(1,null);return D.h(la,"LinkedEntitiesEnableUntrustedImages",db,Ra,Rb,ib,null,0)},80),null)}showUntrustedImageBusinessBarIfNecessary(){this.EAe||this.X5g||!this.$.fa.ki||this.OBk()}OBk(){this.$.userOperationManager.enqueueOperation(new za.a(588,0,(Ra,Rb,ib)=>{var la=this.$.oa.ta;Ra=ub.c(Ra,this.XUj);const db=la.Za(1,null);return D.h(la,"GetHasUntrustedImageUrls",db,Ra,Rb,ib,null,4)},80),null)}get i0b(){return this.IIa.length}get eHj(){return this.BTe}b4h(Ra){(Ra=
this.Xii(Ra))?this.convertToLinkedEntity(Ra):c.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(Ra){c.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${Ra.Id}].`);if(this.da){var Rb=this.da.ha.pa.oj,ib=Rb.Fk(this.da.i6);this.SVd&&this.EBh(Ra);if(ib){ib=this.da.oh.XLa(ib);if(!this.QRf(Ra)&&this.E2f(Ra.Id)){c.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");
if(xc.a.Zl.PY){Rb=this.mLd();if(!Rb){c.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}ib=this.Ptc();if(!ib){c.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var la={["InputMethod"]:oa.a.ph,CalloutName:3};la.Target=Rb;la.RibbonButtonLabel=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.yKg(Ra):this.CZb(Ra.Id.toString());la.ExampleEntities=this.Myf(Ra);this.$.Ia.qh(ib,
la);return}c.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.E2f(Ra.Id)&&!Ra.StringId)this.launchLinkedEntityDataTypeSelectorPane(Gb.yjb(Ra));else{if(ib){c.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",
!1)&&this.hZk(Ra)){Rb=ya.t(this.da.ha.pa.selectedRanges,this.$);this.yw.Uwj(Rb,Ra);return}if(xc.a.Zl.PY){Rb=this.mLd();if(!Rb){c.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}ib=this.Ptc();if(!ib){c.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}la={["InputMethod"]:oa.a.ph,CalloutName:2};la.Target=Rb;la.RibbonButtonLabel=this.yKg(Ra);la.ExampleEntities=this.Myf(Ra);la.BlankCellResourceId=this.NNh(Ra);la.HasBlankCellWalkthrough=
this.e7i(Ra);la.ServiceDomain=Ra.Id;this.$.Ia.qh(ib,la);return}c.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.lzd(Ra,!1,Rb)}}}else c.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.Pua&&this.Pua.WXa()}onAutoDetectUIShown(){Oa.a(this.$.userOperationManager,(Ra,Rb,ib)=>{var la=this.$.oa.ta;const db=la.Za(1,null);return D.h(la,
"OnAutoDetectUIShown",db,Ra,Rb,ib,null,4)},Ra=>new za.a(230,0,Ra,80),null)}lzd(Ra,Rb,ib){const la=ya.s(ib,this.$),db=()=>new ka.a;Oa.a(this.$.userOperationManager,($b,Ic,Tc)=>{var Zc=this.$.oa.ta;$b=ub.c($b,this.rRj,this.q1j,this.yw.qRj);const cc=Zc.Za(1,null);cc.selectedRanges=la;cc.domainId=Ra;cc.autodetect=Rb;return D.h(Zc,"ConvertToLinkedEntity",cc,$b,Ic,Tc,null,4)},$b=>new za.a(115,0,$b,void 0,db),null)}EBh(Ra){if(this.SVd){var Rb={};Rb.Id=Ra.Id;Ra.StringId&&(Rb.StringId=Ra.StringId);if(!(0<
this.XY.length&&this.XY[0].Id===Rb.Id&&this.XY[0].StringId===Rb.StringId)){Ra=!1;this.XY.splice(0,0,Rb);for(let ib=1;ib<this.XY.length;++ib)if(this.XY[ib].Id===Rb.Id&&this.XY[ib].StringId===Rb.StringId){this.XY.splice(ib,1);Ra=!0;break}for(;5<this.XY.length;)this.XY.pop();this.Dza.Categories[Gb.Wqb].DomainIds=this.XY;this.iJg();Ra||this.lne.Sah(this.XY)}}}convertLinkedEntityToText(){c.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");
if(this.da){var Ra=ya.s(this.da.ha.pa.oj,this.$);Oa.a(this.$.userOperationManager,(Rb,ib,la)=>{var db=this.$.oa.ta;const $b=db.Za(1,null);$b.selectedRanges=Ra;return D.h(db,"ConvertLinkedEntityToText",$b,Rb,ib,la,null,4)},Rb=>new za.a(116,0,Rb),null)}else c.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){c.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(rb.f(this.$)){this.$.isEditMode||
c.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.Aje();var Ra=ya.t(this.da.ha.pa.selectedRanges,this.$);Oa.a(this.$.userOperationManager,(Rb,ib,la)=>{var db=this.$.oa.ta;const $b=db.Za(1,null);$b.selectedRanges=Ra;return D.h(db,"RefreshLinkedEntitiesInRange",$b,Rb,ib,la,null,4)},Rb=>new za.a(248,0,Rb),null)}else c.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}fPk(Ra){Ra=this.H5(Ra.DomainId);
if(!Ra||Ra.DomainBlocked||!Ra.HasCuratedData)return!1;if(this.Loj){for(const Rb of this.G5)if(Rb.value.DomainId.Id===Ra.DomainId.Id&&Rb.value.ShowInRibbon)return!0;return!1}return Ra.ShowInRibbon}yNk(Ra){return 2!==this.HB||!this.IIa[Ra]}launchDisambiguationPaneForSearch(){this.yw&&this.yw.launchDisambiguationPaneForSearch()}dj(Ra,Rb,ib){if("PopulateConvertToLinkedEntityMenu"!==Rb)return!1;this.XJd=ib.MenuId;if(0===this.HB||3===this.HB)return this.e9j(),!0;if(!this.Dza)return c.ULS.sendTraceTag(537166873,
0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.G5)return c.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.ER=this.ER||this.Lrb.mDi(this.Dza,ib.MenuId);ib.MenuItems=this.ER;return this.SVd=!0}e9j(){-1===this.sEc&&(this.Z3b(),this.sEc=window.setInterval(()=>{this.Z3b()},2E3))}Z3b(){if(this.$.fa.ki&&2!==this.HB){this.y0a--;c.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");
this.HB=1;var Ra=this.$.oa.ta,Rb=this.gVj,ib=this.fVj;const la=Ra.Za(1,null);D.h(Ra,"GetLinkedEntityMetadata",la,Rb,ib,null,null,4)}}YWd(){return this.$.isEditMode&&2!==this.HB&&(0<=this.y0a||!this.xtb)}rBe(Ra){k.AFrameworkApplication.Vl?c.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):t.a(this.$)?(this.cal(),Ra&&this.$.Fm()):c.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}kuk(){this.j1b=0;this.y0a=
8;this.xtb=!1;this.HB=this.sEc=0;this.H3a=this.Dza=null;this.Yrc();for(let Ra=0;Ra<this.i0b;++Ra)this.IIa[Ra]=null;this.SWb()&&this.rBe(!0)}Yrc(){this.ER=null}SWb(){const Ra=r.a.fvb,Rb=t.a(this.$);return!!Rb&&Rb.xs.QA===Ra}L6g(){if(this.Dza){let ib=0;var Ra=-1,Rb=-1;let la=0,db=0,$b=0,Ic=0;const Tc=[null,null,null,null,null];for(const Zc of this.Dza.Categories){let cc=!1;for(const Yc of Zc.DomainIds){const Vc=this.H5(Yc);Vc&&!Vc.DomainBlocked&&Vc.ShowInRibbon&&(ib<this.i0b?(this.IIa[ib]=Yc,db===Gb.Wqb&&
(-1===Ra&&(Ra=ib),Rb=ib,Ic=Rb-Ra+1),++ib):ib===this.i0b&&la<Ic&&db!==Gb.Wqb&&(Tc[la]=Yc,++la),cc=!0)}cc&&++$b;++db}if(-1<Ra&&$b<=Gb.p8f){for(;Rb>=Ra;--Rb)this.IIa.splice(Rb,1);for(Ra=0;Ra<Ic;++Ra)this.IIa.splice(ib+Ra,0,Tc[Ra])}for(;ib<this.i0b;)this.IIa[ib]=null,++ib}}y4g(){const Ra=rb.f(this.$).za,Rb=this.da.ha.Hk;if(Ra&&Ra.URd&&1===Rb&&this.da.ha.pa.activeCell){if(Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void Qb.a.resolve(ac.Tf,{va:1}).then(ib=>
{this.Pua=new l.a(this.$,this.svgIconProvider,ib,this,this.Bi)});else{const ib=Object(Fb.d)(Qb.a.resolve(ac.Tf,{va:1}));Bb.TaskExtensions.$e(ib,()=>{this.Pua=new l.a(this.$,this.svgIconProvider,ib.result,this,this.Bi)},this.$.ya,3)}return!0}return!1}Xwj(){this.yw&&this.yw.N2d(!0)}launchLinkedEntityDataTypeSelectorPane(Ra){if(this.yw)if(Ra=this.ODd(Ra))if(Ra.DomainId.StringId)c.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var Rb=ya.t(this.da.ha.pa.selectedRanges,
this.$);this.yw.launchLinkedEntityDataTypeSelectorPane(Rb,Ra.DomainId.Id)}else c.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}i2h(Ra){const Rb=this.S$i(Ra),ib=d.a.Vr(this.CZb(Ra));Ra=d.a.Vr(this.Tye(Ra));return Gb.TCi(Rb,Ea.a.Gn(11),ib,Ra)}Tye(Ra){try{return this.tsf(parseInt(Ra,10)).Description}catch(Rb){}return jb.a.instance.ia(1797)}CZb(Ra){try{return this.tsf(parseInt(Ra,10)).Name}catch(Rb){}return jb.a.instance.ia(1783)}yKg(Ra){try{return this.H5(Ra).Name}catch(Rb){}return this.CZb(Ra.Id.toString())}NNh(Ra){try{return this.H5(Ra).BlankCellResourceId}catch(Rb){}return null}e7i(Ra){try{return this.H5(Ra).HasBlankCellWalkthrough}catch(Rb){}return!1}QRf(Ra){try{const Rb=
Gb.yjb(Ra);if(this.G5.mh(Rb))return this.G5.ma(Rb).HasCuratedData}catch(Rb){}return!1}hZk(Ra){try{return this.H5(Ra).SupportsStarterData}catch(Rb){}return!1}E2f(Ra){return 268435968===Ra}mLd(){return 2===t.a(this.$).iW?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}Ptc(){return new ea.a(-847286761,oa.a.ph,this.$.ji,0,r.a.g8)}Bmf(){if(this.SWb()&&!this.YWd()&&!this.H_f&&Ka.EwaSettings.Na(387)&&this.QRf({Id:268435968,StringId:null}))if(c.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
xc.a.Zl.PY){const ib=this.mLd();if(ib){var Ra=this.Ptc();if(Ra){var Rb={["InputMethod"]:oa.a.ph,CalloutName:6};Rb.Target=ib;Rb.ShouldCanvasTakeFocus=!0;this.$.Ia.qh(Ra,Rb);this.H_f=!0}else c.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else c.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else c.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}z$i(Ra){Ra=
this.ODd(Ra);return Ra?this.Lrb.vMh(Ra.SubdomainFontLocator):(c.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}iHc(Ra){return this.Pua?this.Pua.uMh(Ra):!1}iGi(){return this.Pua?this.Pua.fHi():""}CLi(Ra,Rb){const ib=this.pVf(Ra);if(0>ib)c.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${Ra}`);else if(Ra=(Ra=this.usf(Ra))?this.H5(Ra):null)Rb[u.a.GalleryButtonProps]=
this.Lrb.PDi(ib,Ra),Rb[u.a.Alt]=this.Lrb.XLd(Ra)}iJg(){this.L6g();this.SWb()&&this.rBe(!0);this.Yrc()}S$i(Ra){return Ra===this.OAf?w.a.ryf:Ra===this.AEf?w.a.pyf:w.a.oyf}Myf(Ra){try{return this.H5(Ra).ExampleEntities}catch(Rb){}return jb.a.instance.ia(1805)}gie(){(0>this.y0a||this.xtb)&&c.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.HB||0>this.y0a||this.xtb)&&window.clearInterval(this.sEc);this.YWd()?this.XJd&&this.$.frame.WA(this.XJd):
this.rBe(this.SWb())}Yh(Ra){return this.$.xi+Ra}cal(){var Ra=!0;const Rb=Array(this.i0b),ib=t.a(this.$)?t.a(this.$).xs:null;if(ib){for(let la=0;la<Rb.length;++la)this.yNk(la)?Rb[la]=!0:Ra=Rb[la]=!1;ib.KRg(["ConvertToLinkedEntityGallery"],Ra);if(!Ra)for(Ra=0;Ra<Rb.length;++Ra)Rb[Ra]&&ib.KRg([this.BLi(Ra)],!0)}else c.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}H5(Ra){const Rb=Gb.yjb(Ra);if(this.G5.mh(Rb))return this.G5.ma(Rb);c.ULS.sendTraceTag(592729218,
0,15,`No domain data for domain ID ${Ra.Id} (Has String ID: ${!!Ra.StringId})`);return null}BLi(Ra){return"ConvertToLinkedEntityPreview"+Ra.toString()}jBe(){n.a.get_instance().Hm(10,()=>{this.Bmf();this.wvd&&this.l1f&&Pa.e(this.K7f,this.$.ya,500)})}gEc(Ra,Rb){switch(Ra){case "QueryLinkedEntityGalleryButtons":if(!Rb[u.a.InnerHTML]){Ra=Rb[oa.a.Pi].toString();const ib=rc.a.equals(Ra,jb.a.instance.ia(1800),!0)||rc.a.equals(Ra,jb.a.instance.ia(1801),!0),la=rc.a.equals(Ra,jb.a.instance.ia(1802),!0);ib||
la||this.CLi(Ra,Rb)}break;case "QueryLinkedEntityMenuGalleryButtons":Rb[u.a.InnerHTML]||(Rb[u.a.InnerHTML]=this.i2h(Rb[oa.a.Pi]))}return Rb}Xii(Ra){var Rb=this.usf(Ra);if(Rb)return Rb;if(Rb=this.ODd(Ra))return Rb.DomainId;c.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${Ra}`);return null}tsf(Ra){const Rb={};Rb.Id=Ra;return this.H5(Rb)}ODd(Ra){return this.G5.mh(Ra)?this.G5.ma(Ra):null}pVf(Ra){if(!Ra.startsWith(Gb.jEd))return-1;const Rb=parseInt(Ra.substr(Gb.jEd.length),10);return isNaN(Rb)?
(c.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${Ra}`),-1):Rb}usf(Ra){Ra=this.pVf(Ra);return 0>Ra?null:this.IIa[Ra]}zXf(Ra,Rb,ib){if(this.G5&&this.G5.count){c.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${Ra})`);var la=this.$.oa.ta.Wh();this.$.fa.ki&&(Ra=this.$.oa.ta,Rb=ub.c(this.FXj,Rb),la=Ra.Za(1,void 0===la?null:la),D.h(Ra,"LinkedEntityTryAutoRefresh",la,Rb,ib,null,null,0))}}e5k(){this.zXf("Auto-refresh on load",
null,null)}i5k(){this.G5&&this.G5.count&&(this.pOa?c.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.fa.Aq.HasAutoRefreshableLinkedEntityDomainsEver?(c.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.pOa=Nb.a.instance.create(this.qvd,
this.Gpc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):c.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}R0c(){if(this.$.fa.ki&&null!=this.zJc&&null!=this.xZd&&null!=this.yZd&&null!=this.a1d&&null!=this.W_d)if(++this.j1b,12>=this.j1b){1===this.j1b&&(this.QRd=oc.a.kh.Xj.m,c.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));
const Ra=this.$.oa.ta.Wh();mc.A(this.$.oa.ta,this.myj,this.nyj(),this.MYj,this.LYj,null,Ra)}else c.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${oc.a.kh.Xj.m-this.QRd} ms`),this.xtb=!0,this.gie()}Xff(){if(this.$.isEditMode)if(null!=this.zJc)this.R0c();else{var Ra=oc.a.kh.Xj.m,Rb=[];v.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ib=>{ib.isFeatureEnabled("ExcelPowerBiPro",!1).then(la=>
{c.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${oc.a.kh.Xj.m-Ra} Millisecond.`);c.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${la}]`);return this.zJc=la}).then(()=>{Rb.push(ib.isFeatureEnabled("ExcelWolframAlpha",!1).then(la=>{c.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${oc.a.kh.Xj.m-Ra} Millisecond.`);
c.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${la}]`);return this.a1d=la}))}).then(()=>{Rb.push(ib.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(la=>{c.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${oc.a.kh.Xj.m-Ra} Millisecond.`);c.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${la}]`);
Fc.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,[{name:"IsRestrictedByLicense",bool:la}]);this.j4f=la&&Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return la}))}).then(()=>{Rb.push(ib.isFeatureEnabled("StockHistory",!1).then(la=>{c.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${oc.a.kh.Xj.m-Ra} Millisecond.`);c.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${la}]`);
return this.W_d=la}))}).then(()=>{Rb.push(ib.isFeatureEnabled("ExcelPowerBiFree",!1).then(la=>{c.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${oc.a.kh.Xj.m-Ra} Millisecond.`);c.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${la}]`);return this.xZd=la}))}).then(()=>{Rb.push(ib.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(la=>{c.ULS.sendTraceTag(537166734,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${oc.a.kh.Xj.m-Ra} Millisecond.`);c.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${la}]`);return this.yZd=la}))}).then(()=>{Promise.all(Rb).then(()=>{this.R0c()})})})}}get myj(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}nyj(){return[this.zJc,
this.a1d,this.W_d,this.xZd,this.yZd,this.j4f]}Aje(){this.businessBar&&this.businessBar.U6(58)&&this.businessBar.removeEntry(58)}M4i(Ra){if(this.o3d!==Ra&&this.businessBar)if(this.o3d=Ra){Ra=this.$.oa.ta;var Rb=this.IUj;const ib=Ra.Za(1,null);D.h(Ra,"GetErrorMessageForLinkedDataTypeRefresh",ib,Rb,null,null,null,4)}else this.Aje()}static TCi(Ra,Rb,ib,la){Ra=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Ra,Rb,la);ib=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
ib);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Ra,ib)}static yjb(Ra){return Ra.StringId?Ra.Id.toString()+"."+Ra.StringId:Ra.Id.toString()}};Ub.ctf="ConvertToLinkedEntityPreview";Ub.jEd="PreviewGalleryButtonIndex.";Ub.Wqb=0;Ub.p8f=2;Ub=Gb=Object(y.__decorate)([Object(Qb.d)(ac.jb),Object(y.__param)(0,Object(ac.Ob)()),Object(y.__param)(1,Object(ac.xf)()),Object(y.__param)(2,Object(Wa.h)()),Object(y.__param)(3,Object(ac.Mb)()),Object(y.__param)(4,
Object(ac.lf)()),Object(y.__param)(5,Object(ac.E)()),Object(y.__param)(6,Object(ac.rd)())],Ub);Object(m.a)(Ub,"ConvertToLinkedEntityManager",f.a,[634,635,2,636])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pi.js.map/3459fdb631f2407a2ebf8f9f5c561264/EwaTS.pi.js.map