'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[37],{1511:function(y,m,a){m=a(492);a=a(1512);a=a.$q?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1512:function(y,m,a){m=a(493)(!1);m.push([y.i,".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}",""]);y.exports=m},799:function(y,m,a){function c(Ta){return 0<Ta&&Ta<=Xa.a.Ok}function b(Ta){return 0<Ta&&Ta<=Xa.a.Ak}function e(Ta,
Qa){let Ob="";Qa.sort((tb,zc)=>tb.start-zc.start);let Jb=0,Jc=Qa.shift();const zb=Ta.length;for(;Jb<zb&&Jc;)Jb===Jc.start?(Ob+=Jc.value,Jc.WLa&&(Ob+="#"),Jb=Jc.end,Jc=Qa.shift()):(Ob+=Ta[Jb],Jb++);Jb<zb&&(Ob+=Ta.substring(Jb));return Ob}function k(Ta,Qa){return Ta.top<=Qa.top&&Ta.left<=Qa.left&&Ta.bottom>=Qa.bottom&&Ta.right>=Qa.right}function d(Ta,Qa,Ob,Jb){const Jc=Ob.FirstScrollableRow,zb=Ob.FirstScrollableColumn;switch(Qa){case 1:var tb=Ta.hH.length;return Ta.TB[Ta.TB.length-1]>=Jc&&Ta.hH[tb-
1]>=zb;case 4:var zc;tb=Ob.FirstScrollableRow;Ob=Ob.FirstScrollableColumn;Jb=null===(zc=Ta.TB)||void 0===zc?void 0:zc.length;return 0<Jb&&Ta.TB[Jb-1]>=tb&&Ob>=Ta.hH[0];case 3:zc=Ob.FirstScrollableRow;Ob=Ob.FirstScrollableColumn;var dd=Number.MAX_VALUE;for(const gb of Jb)gb.dr.Y<dd&&(dd=gb.dr.Y);Ta.dr.Y>dd&&zc<Ta.TB[0]?Ta=!1:(Jb=null===(tb=Ta.hH)||void 0===tb?void 0:tb.length,Ta=0<Jb&&Ta.hH[Jb-1]>=Ob);return Ta;case 2:var od;tb=Ob.FirstScrollableRow;Ob=Ob.FirstScrollableColumn;return 0<(null===(dd=
Ta.hH)||void 0===dd?void 0:dd.length)&&Ta.hH[0]<=Ob&&0<(null===(od=Ta.TB)||void 0===od?void 0:od.length)&&Ta.TB[0]<=tb}return!1}function u(Ta,Qa,Ob){const Jb=Ta.jj;var Jc=za.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxHiddenRangeCountForFreezeCSE",1);const zb=za.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxHiddenRowColCountForFreezeCSE",10),{eTf:tb,gnb:zc}=v(Ta,Qa.FirstScrollableRow,!0),{eTf:dd,gnb:od}=v(Ta,Qa.FirstScrollableColumn,!1);if(tb>Jc||dd>Jc||zc>zb||od>zb)return f(`Hidden Row/Col, exceeds supported hidden range limit, hiddenRowCount: ${zc}, hiddenColCount: ${od}, hiddenRowRangeCount: ${tb}, hiddenColRangeCount: ${dd}`,
Ob),!1;Ta=Xa.a.NR;Jc=Xa.a.PR;if(zc&&Qa.FirstScrollableRow>Jc+zc&&(Jc=Math.ceil((Qa.FirstScrollableRow-zc)/Jc)*Jc-Qa.FirstScrollableRow+zc,Jc<zc))return f(`Hidden Row/Col, CSE at block end, rowCountFromBlockEnd: ${Jc}`,Ob),!1;if(od&&Qa.FirstScrollableColumn>Ta+od&&(Ta=Math.ceil((Qa.FirstScrollableColumn-od)/Ta)*Ta-Qa.FirstScrollableColumn+od,Ta<od))return f(`Hidden Row/Col, CSE at block end, colCountFromBlockEnd: ${Ta}`,Ob),!1;Qa=new oa.Range(Math.max(1,Qa.FirstScrollableRow-1),Math.max(1,Qa.FirstScrollableColumn-
1),Qa.FirstScrollableRow,Qa.FirstScrollableColumn,!1,!1);return Jb.Moa(Qa)?(f("Hidden Row/Col, Adjacent range hidden",Ob),!1):!0}function n(Ta){var Qa;const Ob=null!==(Qa=Ta.Cmb())&&void 0!==Qa?Qa:Ta.s6();Ta=Ta.HAc();return null===Ob||null===Ta?null:new oa.Range(Ob.top,Ob.left,Ta.bottom,Ta.right,!0,!0)}function v(Ta,Qa,Ob){var Jb;const Jc=Ta.jj;Ta=null!==(Jb=n(Ta))&&void 0!==Jb?Jb:new oa.Range(1,1,Qa,Qa,!0,!0);Jb=Jc.$Bc([Ta]).filter(tb=>Ob&&!tb.isRow||!Ob&&!tb.hk||Ob&&tb.top>Qa||!Ob&&tb.left>Qa?!1:
Ob?tb.isRow:tb.hk);let zb=0;Jb.forEach(tb=>{zb=Ob?zb+(Math.min(tb.bottom,Qa)-tb.top+1):zb+(Math.min(tb.right,Qa)-tb.left+1)});return{eTf:Jb.length,gnb:zb}}function f(Ta,Qa){Oa.ULS.sendTraceTag(507368522,0,20,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Qa}, CSE Unattempted Reason=${Ta}`)}function w(Ta,Qa){if(!Ta.length||Ta[0]>Qa)return 0;let Ob=0;for(let Jb=0;Jb<Ta.length&&!(Ta[Jb]>=Qa);Jb++)0<Jb&&(Ob+=Ta[Jb]-Ta[Jb-1]-1);return Ob}function r(Ta,Qa,Ob,Jb){var Jc,zb,
tb;const zc=Qa.FirstScrollableColumn;Qa=Xa.a.NR;const dd=zc>Qa?zc<=Qa+Jb?zc:zc%Qa:zc;let od=0,gb=dd-1;const gc=null===(Jc=Ta.ColumnNumbers)||void 0===Jc?void 0:Jc.length;Jc=Jb?w(Ta.ColumnNumbers,zc):0;switch(Ob){case 1:zc<=Qa+Jb?od=gb-Jb:(Ta=zc>Ta.ColumnNumbers[gc-1]?0:dd-1,Ta=0>Ta?Qa-Math.abs(Ta):Ta,od=Ta-Jb);gb-=Jb;gb=Jb&&0>gb?Qa-Math.abs(gb):gb;break;case 2:zc<=Qa+Jb?od=gc-gb+Jb:(gb=Ta=zc>Ta.ColumnNumbers[gc-1]?Ta.ColumnNumbers[gc-1]:zc-(null===(zb=Ta.ColumnNumbers)||void 0===zb?NaN:zb[0]),od=
gc-gb+Jc);break;case 3:zc<=Qa+Jb||(Ta=zc>Ta.ColumnNumbers[gc-1]?Ta.ColumnNumbers[gc-1]:dd-1,gb=Ta=0>Ta?Qa-Math.abs(Ta):Ta);od=gb-Jb;break;case 4:zc<=Qa+Jb?od=gc-gb+Jb:(gb=Ta=zc>Ta.ColumnNumbers[gc-1]?Ta.ColumnNumbers[gc-1]:zc-(null===(tb=Ta.ColumnNumbers)||void 0===tb?NaN:tb[0]),od=gc-gb+Jc)}return{o7b:0,nXc:0,qMb:gb,Asc:od-1}}function t(Ta,Qa,Ob,Jb){var Jc,zb,tb;const zc=Qa.FirstScrollableRow;Qa=Xa.a.PR;const dd=zc>Qa?zc<=Qa+Jb?zc:zc%Qa:zc;let od=0,gb=dd-1;const gc=null===(Jc=Ta.RowNumbers)||void 0===
Jc?void 0:Jc.length;Jc=Jb?w(Ta.RowNumbers,zc):0;switch(Ob){case 1:zc<=Qa+Jb?od=gb-Jb:(Ta=zc>Ta.RowNumbers[gc-1]?0:dd-1,Ta=0>Ta?Qa-Math.abs(Ta):Ta,od=Ta-Jb);gb-=Jb;gb=Jb&&0>gb?Qa-Math.abs(gb):gb;break;case 2:zc<=Qa+Jb?od=gc-gb+Jb:(gb=Ta=zc>Ta.RowNumbers[gc-1]?Ta.RowNumbers[gc-1]:zc-(null===(zb=Ta.RowNumbers)||void 0===zb?NaN:zb[0]),od=gc-gb+Jc);break;case 3:zc<=Qa+Jb?od=gc-gb+Jb:(gb=Ta=zc>Ta.RowNumbers[gc-1]?Ta.RowNumbers[gc-1]:zc-(null===(tb=Ta.RowNumbers)||void 0===tb?NaN:tb[0]),od=gc-gb+Jc);break;
case 4:zc<=Qa+Jb||(Ta=zc>Ta.RowNumbers[gc-1]?Ta.RowNumbers[gc-1]:dd-1,gb=Ta=0>Ta?Qa-Math.abs(Ta):Ta),od=gb-Jb}return{o7b:gb,qMb:0,nXc:od-1,Asc:0}}function l(Ta,Qa,Ob){var Jb,Jc,zb,tb,zc;return(null===(Jb=Ta.TB)||void 0===Jb?void 0:Jb[0])<=Qa&&(null===(Jc=Ta.TB)||void 0===Jc?void 0:Jc[Ta.TB.length-1])>=Qa&&(null===(zb=Ta.hH)||void 0===zb?void 0:zb[0])<=Ob&&(null===(tb=Ta.hH)||void 0===tb?void 0:tb[(null===(zc=Ta.hH)||void 0===zc?NaN:zc.length)-1])>=Ob}function x(Ta,Qa){const Ob={};Ob.X=Ta.X-Qa.X;Ob.Y=
Ta.Y-Qa.Y;return Ob}function A(Ta,Qa,Ob,Jb,Jc){return za.EwaSettings.n2a()?gridRenderer.CanvasRendererGlobals.canMultipleRowColHideOrCascade(Ta,Qa,Ob,Jb,Jc):gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(Ta,Qa,Jb,Jc)}function z(Ta,Qa,Ob,Jb){switch(Ob){case -706918724:case 674605324:var Jc=Ta.destination.zj;if(!Jc)return U("shouldCurrentBlockPairBeProcessed",Ob),!1;if(Jc.right<Qa.left)return Ta.xV=!0,Oa.ULS.sendTraceTag(508150742,0,50,`GridInstantaneousAction.processGridAction command=${Ob}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${Qa.left}, blockRangeRightMostValue=${Jc.right}, hashCode=${Ta.destination.Ti}, isRow=${Jb}`),
!1;break;case 369708605:case 1415868706:Jc=Ta.source.zj;if(!Jc)return U("shouldCurrentBlockPairBeProcessed",Ob),!1;if(Jc.right<Qa.left)return Ta.xV=!0,Oa.ULS.sendTraceTag(508150741,0,50,`GridInstantaneousAction.processGridAction command=${Ob}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${Qa.left}, blockRangeRightMostValue=${Jc.right}, hashCode=${Ta.source.Ti}, isRow=${Jb}`),!1;break;case 1542466017:case -1113896058:Jc=Ta.source.zj;if(!Jc)return U("shouldCurrentBlockPairBeProcessed",
Ob),!1;if(Jc.bottom<Qa.top)return Ta.xV=!0,Oa.ULS.sendTraceTag(508150740,0,50,`GridInstantaneousAction.processGridAction command=${Ob}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${Qa.top}, blockRangeBottomMostValue=${Jc.bottom}, hashCode=${Ta.source.Ti}, isRow=${Jb}`),!1;break;case 1051390410:case 1554436520:Jc=Ta.destination.zj;if(!Jc)return U("shouldCurrentBlockPairBeProcessed",Ob),!1;if(Jc.bottom<Qa.top)return Ta.xV=!0,Oa.ULS.sendTraceTag(508150739,0,50,`GridInstantaneousAction.processGridAction command=${Ob}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${Qa.top}, blockRangeBottomMostValue=${Jc.bottom}, hashCode=${Ta.destination.Ti}, isRow=${Jb}`),
!1}return!0}function F(Ta,Qa,Ob,Jb,Jc){if(za.EwaSettings.A2a()&&Ta.fh.nx&&1===Jc.length){var zb=Jc[0],tb=Ta.fh.en,zc=Ta.fh.Im;Jc=[];if(!Ob&&zb.right<tb){tb=D(Qa,Ob,Jb,2);Ta=D(Qa,Ob,Jb,4);var dd=[],od=[];-706918724!==Jb&&(zb.top<zc&&(od=D(Qa,Ob,Jb,3)),dd=D(Qa,Ob,Jb,1));Jc.push(...tb);Jc.push(...Ta);Jc.push(...od);Jc.push(...dd);return Jc}if(!Ob&&zb.left>=tb)return zb=D(Qa,Ob,Jb,3),Qa=D(Qa,Ob,Jb,1),Jc.push(...zb),Jc.push(...Qa),Jc;if(Ob&&zb.bottom<zc)return zc=D(Qa,Ob,Jb,2),Ta=D(Qa,Ob,Jb,3),dd=[],od=
[],1051390410!==Jb&&(zb.left<tb&&(od=D(Qa,Ob,Jb,4)),dd=D(Qa,Ob,Jb,1)),Jc.push(...zc),Jc.push(...Ta),Jc.push(...od),Jc.push(...dd),Jc;if(Ob&&(zb.top>=zc||Ta.fh.MZd(zb)))return zb=D(Qa,Ob,Jb,4),Qa=D(Qa,Ob,Jb,1),Jc.push(...zb),Jc.push(...Qa),Jc}return D(Qa,Ob,Jb,1)}function D(Ta,Qa,Ob,Jb){const Jc=Ta.filter(zc=>zc.HK().paneType===Jb),zb=Qa?Z(Jc):L(Jc),tb=[];if(!za.EwaSettings.Eha()&&0===zb&&1===Ta.length)return tb.push({destination:Ta[0],source:null,xV:!1}),tb;if(za.EwaSettings.Vya()||za.EwaSettings.Uya()||
za.EwaSettings.GLa())tb.push(...Q(Jc,zb,Qa,Ob));else for(let zc=0;zc<=zb;zc++)for(Ta=Jc.filter(dd=>dd.HK().topLeft.Y===zc),Qa=0;Qa<Ta.length;Qa+=1)tb.push({destination:Ta[Qa],source:Ta[Qa+1]?Ta[Qa+1]:null,xV:!1});Oa.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${tb.length}`);return tb}function G(Ta){const Qa=Z(Ta),Ob=L(Ta),Jb=[],Jc={};Ta.forEach(zb=>{if(!(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8836203_enableFreezePanesCseColumnWidthFailureFix")&&
0>=zb.vs)){var {X:tb,Y:zc}=zb.HK().topLeft;Jc[`${tb},${zc}`]=zb}});for(Ta=0;Ta<=Qa;Ta++)for(let zb=0;zb<=Ob;zb++){const tb=Jc[`${Ta+1},${zb}`],zc=Jc[`${Ta},${zb+1}`],dd=Jc[`${Ta+1},${zb+1}`],od=Jc[`${Ta},${zb}`];Jb.push({destination:null!==od&&void 0!==od?od:null,wYg:null!==tb&&void 0!==tb?tb:null,sYg:null!==zc&&void 0!==zc?zc:null,tYg:null!==dd&&void 0!==dd?dd:null,xV:!1})}Oa.ULS.sendTraceTag(507586694,0,50,`GridInstantaneousAction.getadjacentBlocksInViewport parameter = blockPairsLength, value=${Jb.length}`);
return Jb}function Q(Ta,Qa,Ob,Jb){const Jc=[];for(let zb=0;zb<=Qa;zb++){const tb=Ta.filter(dd=>Ob?dd.HK().topLeft.X===zb:dd.HK().topLeft.Y===zb),zc=tb.length;for(let dd=0;dd<zc;dd+=1)switch(Jb){case -1113896058:case 1542466017:Jc.push({source:tb[dd],destination:O(dd+1,tb),xV:!1});break;case 1554436520:case 1051390410:Jc.push({destination:tb[dd],source:O(dd+1,tb),xV:!1});break;case 1415868706:case 369708605:Jc.push({source:tb[dd],destination:O(dd+1,tb),xV:!1});break;case 674605324:case -706918724:Jc.push({destination:tb[dd],
source:O(dd+1,tb),xV:!1})}}return Jc}function O(Ta,Qa){return Ta<Qa.length?Qa[Ta]:null}function J(Ta,Qa,Ob,Jb,Jc,zb){let tb,zc=0;zc=Ma(Jb)?ka.HelperMethods.vN(()=>{tb=gridRenderer.CanvasRendererGlobals.performModelRowColOperation(Ta,Qa,Ob,Jb,Jc)}):ka.HelperMethods.vN(()=>{tb=gridRenderer.CanvasRendererGlobals.hideRowCols(Ta,Qa,Jc)});ba("HideRowCols",zc,zb);return tb}function H(Ta,Qa,Ob,Jb,Jc,zb,tb){let zc;if(!Ta||!Qa)return zc;zc=Ma(Jc)?gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(Ta,
Qa,Ob,Jb,Jc,zb):gridRenderer.CanvasRendererGlobals.performModelCascade(Ta,Qa,Ob,zb);zc.metric&&ba("ModelCascade",zc.metric.Cxl,tb);return zc}function N(Ta,Qa,Ob,Jb){return Ob?-1113896058===Jb||1542466017===Jb?Ta.RowNumbers[Ta.RowNumbers.length-Qa-1]:Ta.RowNumbers[0]:1415868706===Jb||369708605===Jb?Ta.ColumnNumbers[Ta.ColumnNumbers.length-Qa-1]:Ta.ColumnNumbers[0]}function L(Ta){let Qa=-1;for(let Ob=0;Ob<Ta.length;Ob++){const Jb=Ta[Ob].HK().topLeft.Y;Jb>Qa&&(Qa=Jb)}return Qa}function Z(Ta){let Qa=
-1;for(let Ob=0;Ob<Ta.length;Ob++){const Jb=Ta[Ob].HK().topLeft.X;Jb>Qa&&(Qa=Jb)}return Qa}function ba(Ta,Qa,Ob){Ob=Lb.b().kp(Ob);Oa.ULS.sendTraceTag(509723719,0,20,`GridInstantaneousAction: Time taken to complete operation=${Ta} is time=${Qa} and command=${Ob}`)}function K(Ta,Qa,Ob){var Jb,Jc;for(const tb of Qa)if(!za.EwaSettings.Eha()||tb.source&&tb.destination){if(!(za.EwaSettings.Eha()||tb.source&&tb.destination))return!0;var zb=null===(Jb=tb.destination)||void 0===Jb?void 0:Jb.zj;Qa=null===(Jc=
tb.source)||void 0===Jc?void 0:Jc.zj;if(za.EwaSettings.vIc()&&(!zb||!Qa))return U("isFirstRowColOfNextBlockHidden",Ob),!0;zb=Ta.PKd(zb);Qa=Ta.PKd(Qa);switch(Ob){case -706918724:case 674605324:return zb&&zb.IsFirstColOfNextBlockHidden;case 369708605:case 1415868706:return zb&&(null===zb||void 0===zb?void 0:zb.IsLastColOfPrevBlockHidden)||Qa&&(null===Qa||void 0===Qa?void 0:Qa.IsFirstColOfNextBlockHidden);case 1051390410:case 1554436520:return zb&&zb.IsFirstRowOfNextBlockHidden;case 1542466017:case -1113896058:return zb&&
(null===zb||void 0===zb?void 0:zb.IsLastRowOfPrevBlockHidden)||Qa&&(null===Qa||void 0===Qa?void 0:Qa.IsFirstRowOfNextBlockHidden)}}return!1}function E(Ta,Qa,Ob){for(const Jb of Qa){if(za.EwaSettings.qnj()&&!Jb)return Oa.ULS.sendTraceTag(508339915,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: blockPair or sourceBlock is null and command=${Ob}`),!0;if(!Jb.source||!Jb.destination)if(za.EwaSettings.Eha())continue;else return Oa.ULS.sendTraceTag(507875778,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: sourceBlock or destination Block is null and command=${Ob}`),
!0;if(za.EwaSettings.vIc()){Qa=Jb.source.zj;const Jc=Jb.destination.zj;if(!Qa||!Jc)return U("isSelectedRangeAcrossBlocks",Ob),!0;if(za.EwaSettings.pnj()){if(Qa.$i(Ta)&&Jc.$i(Ta))return!0}else{const zb=-706918724===Ob||674605324===Ob||1051390410===Ob||1554436520===Ob;if(zb&&Qa.$i(Ta)||!zb&&Jc.$i(Ta))return!0}}else if(Jb.source.zj.$i(Ta))return!0}return!1}function U(Ta,Qa){Oa.ULS.sendTraceTag(508347672,0,50,`GridInstantaneousAction: BlockRange was null in the method = ${Ta} and command =${Qa}`)}function X(Ta,
Qa,Ob){if(-706918724===Qa||674605324===Qa||1051390410===Qa||1554436520===Qa){if(Ta.destination)return Ta=Ta.destination.zj,Ta?Ta.$i(Ob):(U("doesBlockRangeIntersectWithSelectedRange",Qa),!1);U("doesBlockRangeIntersectWithSelectedRange destinationBlock",Qa)}else if(369708605===Qa||1415868706===Qa||1542466017===Qa||-1113896058===Qa){if(Ta.source)return Ta=Ta.source.zj,Ta?Ta.$i(Ob):(U("doesBlockRangeIntersectWithSelectedRange",Qa),!1);U("doesBlockRangeIntersectWithSelectedRange sourceBlock",Qa)}return!1}
function ia(Ta){switch(Ta){case -706918724:case 1051390410:return Ib.Hide;case 369708605:case 1542466017:return Ib.Unhide;case 674605324:case 1554436520:return Ib.Delete;case 1415868706:case -1113896058:return Ib.Insert}throw Error(`GridInstantaneousAction::getGridInstantaneousOperation: Command ${Ta} not supported currently`);}function Ma(Ta){switch(Ta){case Ib.Hide:return za.EwaSettings.n2a()||za.EwaSettings.wIc();case Ib.Insert:return za.EwaSettings.Vya()||za.EwaSettings.Uya();case Ib.Delete:return za.EwaSettings.GLa()||
za.EwaSettings.tob();default:return!1}}function qa(Ta){const Qa=za.EwaSettings.Vya()&&-1113896058===Ta;return za.EwaSettings.Uya()&&1415868706===Ta||Qa}function Ha(Ta){const Qa=za.EwaSettings.wIc()&&1051390410===Ta;return za.EwaSettings.Sob()&&-706918724===Ta||Qa}function ha(Ta){const Qa=za.EwaSettings.GLa()&&1554436520===Ta;return za.EwaSettings.tob()&&674605324===Ta||Qa}function La(){return Mb}function fa(){Mb={dispose(){}}}function ja(Ta,Qa,Ob){const Jb=Ta.Yj.PaneViewData;Ta=Ta.CKa();const Jc=
{};switch(Qa){case -1113896058:Jc.Height=Ta.BlockHeight;Jc.AbsoluteTop=Ta.BlockHeight;Jc.FirstScrollableRow=Jb.FirstScrollableRow+Ob;Jc.VisibleRows=Jb.VisibleRows+Ob;Jc.FirstFrozenRow=Jb.FirstFrozenRow;break;case 1554436520:case 1051390410:Jc.Height=Ta.BlockHeight;Jc.AbsoluteTop=Ta.BlockHeight;Jc.FirstScrollableRow=Fc?Math.max(Jb.FirstScrollableRow-Ob,Jb.FirstFrozenRow):Jb.FirstScrollableRow-Ob;Jc.VisibleRows=Jb.VisibleRows-Ob;Jc.FirstFrozenRow=Jb.FirstFrozenRow;break;default:Jc.Height=Jb.Height,
Jc.AbsoluteTop=Jb.AbsoluteTop,Jc.FirstScrollableRow=Jb.FirstScrollableRow,Jc.VisibleRows=Jb.VisibleRows,Jc.FirstFrozenRow=Jb.FirstFrozenRow}switch(Qa){case 1415868706:Jc.AbsoluteLeft=Ta.BlockWidth;Jc.Width=Ta.BlockWidth;Jc.VisibleColumns=Jb.VisibleColumns+Ob;Jc.FirstScrollableColumn=Jb.FirstScrollableColumn+Ob;Jc.FirstFrozenColumn=Jb.FirstFrozenColumn;break;case 674605324:Jc.AbsoluteLeft=Ta.BlockWidth;Jc.Width=Ta.BlockWidth;Jc.VisibleColumns=Jb.VisibleColumns-Ob;Jc.FirstScrollableColumn=Fc?Math.max(Jb.FirstScrollableColumn-
Ob,Jb.FirstFrozenColumn):Jb.FirstScrollableColumn-Ob;Jc.FirstFrozenColumn=Jb.FirstFrozenColumn;break;case -706918724:Jc.FirstScrollableColumn=Jb.FirstScrollableColumn;Jc.AbsoluteLeft=Ta.BlockWidth;Jc.Width=Ta.BlockWidth;Jc.VisibleColumns=Jb.VisibleColumns-Ob;Jc.FirstFrozenColumn=Jb.FirstFrozenColumn;break;default:Jc.AbsoluteLeft=Jb.AbsoluteLeft,Jc.Width=Jb.Width,Jc.VisibleColumns=Jb.VisibleColumns,Jc.FirstScrollableColumn=Jb.FirstScrollableColumn,Jc.FirstFrozenColumn=Jb.FirstFrozenColumn}Jc.State=
Jb.State;Jc.IsEstimated=Jb.IsEstimated;return Jc}function ta(Ta,Qa,Ob){if(-706918724===Qa||1051390410===Qa)return!1;let Jb=!0;if(Ta)switch(Qa){case 1415868706:Ka(Ta,Ob,!0,!1);break;case 674605324:Ka(Ta,Ob,!1,!1);break;case -1113896058:Ka(Ta,Ob,!0,!0);break;case 1554436520:Ka(Ta,Ob,!1,!0)}else Jb=!1;return Jb}function Ka(Ta,Qa,Ob,Jb){if(Ob)if(Jb)for(Ob=0;Ob<Ta.RowNumbers.length;Ob++)Ta.RowNumbers[Ob]+=Qa;else for(Ob=0;Ob<Ta.ColumnNumbers.length;Ob++)Ta.ColumnNumbers[Ob]+=Qa;else if(Jb)for(Ob=0;Ob<
Ta.RowNumbers.length;Ob++)Ta.RowNumbers[Ob]-=Qa;else for(Ob=0;Ob<Ta.ColumnNumbers.length;Ob++)Ta.ColumnNumbers[Ob]-=Qa}function Ga(Ta){return Gc?Math.max(Ta-1,1):Ta-1}a.r(m);var Na={};a.r(Na);a.d(Na,"GridInstantaneousOperation",function(){return Ib});a.d(Na,"GridInstantaneousAction",function(){return Bb});a.d(Na,"canRowColHideOrCascade",function(){return A});a.d(Na,"testableGetBlockPairsInViewport",function(){return F});a.d(Na,"testableGetAdjacentBlocksInViewport",function(){return G});a.d(Na,"testablePerformModelRowColOperation",
function(){return J});a.d(Na,"testablePerformModelCascade",function(){return H});a.d(Na,"testableGetPartialInteractivityState",function(){return La});a.d(Na,"testableInitPartialInteractivityState",function(){return fa});a.d(Na,"testableIsFirstRowColOfNextBlockHidden",function(){return K});a.d(Na,"testableIsSelectedRangeAcrossBlocks",function(){return E});a.d(Na,"testableGetRowColNumberForCascade",function(){return N});var cb={};a.r(cb);a.d(cb,"ResizeCommandHandler",function(){return Ya});var jb=a(127),
Sa=a(0),bb=a(23),oa=a(27),ka=a(13),ya=a(191),Oa=a(15),za=a(1),ea=a(43),Aa=a(12),ub=a(95),rb=a(5),Ja=a(92),Xa=a(10),Y=a(1105);class Ia{constructor(Ta,Qa,Ob){this.TWb=!0;this.Mj=Ta;this.Lia=Qa;this.TWb=Ob||za.EwaSettings.isChangeGateEnabled("OfficeVSO:8453101_deleteRowsRefUpdate")}jbl(Ta,Qa,Ob,Jb){if(Ta){var Jc=Ta.includes(this.Lia);if(!this.Mj)return{isRefError:Ta.includes(this.Lia),newFormula:Ta};var zb=this.Mj.nHd(Ta);if(zb){var tb=0>Ob||0>Qa,zc=[];try{for(const od of zb){const gb=od.ref;switch(gb.type){case Y.a.cell:zb=
gb;const gc=zb.row,Dc=zb.col,hd="Abs"===gc.kind,xd="Abs"===Dc.kind,fd=gc.index+1,kd=Dc.index+1,Yb=oa.Range.yi(fd,kd),Cc=zb.span;if(tb&&k(Jb,Yb)){zc.push({value:this.Lia,start:Cc.start,end:Cc.end});Jc=!0;break}const td=0===Ob?!0:Yb.left<Jb.right,Ad=0===Qa?!0:Yb.bottom<Jb.top;if(td&&Ad)break;zb=Ad?fd:fd+Qa;var dd=td?kd:kd+Ob;if(!c(zb)||!b(dd)){zc.push({value:this.Lia,start:Cc.start,end:Cc.end});Jc=!0;break}const oe=oa.Range.yi(zb,dd).Qga(xd,hd,xd,hd);zc.push({value:oe,start:Cc.start,end:Cc.end,WLa:this.Mj.hXa(Cc.end,
Ta)});break;case Y.a.column:if(!Ob)break;zb=gb;const qe=zb.startIndex,Be=zb.endIndex,Ee=qe.index+1,Ve=Be.index+1,Oe="Abs"===qe.kind,Ye="Abs"===Be.kind,nf=oa.Range.mY(Ee,Ve),of=zb.span;if(tb&&k(Jb,nf)){zc.push({value:this.Lia,start:of.start,end:of.end});Jc=!0;break}const Cf=nf.left<Jb.left,Ff=nf.right<Jb.left;if(Cf&&Ff)break;zb=Cf?Ee:Ee+Ob;dd=Ff?Ve:Ve+Ob;tb&&0<=dd-zb&&1>zb&&(zb=1);this.TWb&&0>Ob&&Cf&&!Ff&&Jb.right>Ve&&1<=Jb.left-1&&(dd=Jb.left-1);if(!b(zb)||!b(dd)){zc.push({value:this.Lia,start:of.start,
end:of.end});Jc=!0;break}const Wf=oa.Range.mY(zb,dd).Qga(Oe,!1,Ye,!1);zc.push({value:Wf,start:of.start,end:of.end});break;case Y.a.row:if(!Qa)break;zb=gb;const Mf=zb.startIndex,ng=zb.endIndex,Rf="Abs"===Mf.kind,$f="Abs"===ng.kind,jf=Mf.index+1,Hf=ng.index+1,Uf=oa.Range.$U(jf,Hf),If=zb.span;if(tb&&k(Jb,Uf)){zc.push({value:this.Lia,start:If.start,end:If.end});Jc=!0;break}const sf=Uf.top<Jb.top,tc=Uf.bottom<Jb.top;if(sf&&tc)break;zb=sf?jf:jf+Qa;dd=tc?Hf:Hf+Qa;tb&&0<=dd-zb&&1>zb&&(zb=1);this.TWb&&0>Qa&&
sf&&!tc&&Jb.bottom>Hf&&1<=Jb.top-1&&(dd=Jb.top-1);if(!c(zb)||!c(dd)){zc.push({value:this.Lia,start:If.start,end:If.end});Jc=!0;break}const ld=oa.Range.$U(zb,dd).Qga(!1,Rf,!1,$f);zc.push({value:ld,start:If.start,end:If.end});break;case Y.a.range:zb=gb;const Ed=zb.top,ze=zb.left,ge=zb.bottom,Ne=zb.right,Ge=Ed.index+1,ca=ze.index+1,sb=ge.index+1,Ba=Ne.index+1,V="Abs"===Ed.kind,Fa="Abs"===ze.kind,sc="Abs"===ge.kind,Kc="Abs"===Ne.kind,qd=new oa.Range(Ge,ca,sb,Ba,!1,!1),Eb=zb.topLeftSpan,vc=zb.bottomRightSpan;
if(tb&&k(Jb,qd)){zc.push({value:this.Lia,start:Eb.start,end:vc.end});Jc=!0;break}const Kd=0===Qa?!0:qd.top<Jb.top,Zd=0===Ob?!0:qd.left<Jb.left,nb=0===Qa?!0:qd.bottom<Jb.top,ic=0===Ob?!0:qd.right<Jb.left;if(Kd&&Zd&&nb&&ic)break;zb=Kd?Ge:Ge+Qa;dd=nb?sb:sb+Qa;let Bc=Zd?ca:ca+Ob,Qc=ic?Ba:Ba+Ob;this.TWb&&0>Qa&&Kd&&!nb&&Jb.bottom>sb&&1<=Jb.top-1&&(dd=Jb.top-1);this.TWb&&0>Ob&&Zd&&!ic&&Jb.right>Ba&&1<=Jb.left-1&&(Qc=Jb.left-1);tb&&0<=dd-zb&&1>zb&&(zb=1);tb&&0<=dd-Bc&&1>Bc&&(Bc=1);if(!b(Bc)||!c(zb)){zc.push({value:this.Lia,
start:Eb.start,end:Eb.end});Jc=!0;break}if(!b(Qc)||!c(dd)){zc.push({value:this.Lia,start:vc.start,end:vc.end});Jc=!0;break}const pd=oa.Range.yi(zb,Bc).Qga(V,Fa,!1,!1),Xd=oa.Range.yi(dd,Qc).Qga(sc,Kc,!1,!1);zc.push({value:pd,start:Eb.start,end:Eb.end,WLa:this.Mj.hXa(Eb.end,Ta)});zc.push({value:Xd,start:vc.start,end:vc.end,WLa:this.Mj.hXa(vc.end,Ta)})}}return{newFormula:e(Ta,zc),isRefError:Jc}}catch(od){if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8793263_improvedExceptionHandlingGlobalStyles"))Oa.ULS.sendTraceTag(507360605,
0,15,`GridReferenceUpdates.UpdateReference failed with error: ${od}`);else throw od;}}}}dispose(){this.Mj=null}}Object(Sa.a)(Ia,"GridReferenceUpdate",null,[2]);var $a=a(410),Ea=a(217),Lb=a(62),Ib;(function(Ta){Ta.Hide="Hide";Ta.Unhide="Unhide";Ta.Insert="Insert";Ta.Delete="Delete";Ta.FreezePane="FreezePane"})(Ib||(Ib={}));Object(Sa.b)("GridInstantaneousOperation",Ib);let Mb=null;const mc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8524738_CanvasAndSelectionHighlightBugFix"),jc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8834132_ReferenceUpdatesNullModel"),
Fc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8851335_paneViewDataUpdates");let Gc=!1,xc=!1;const Uc=Xa.a.MR/4,Pa=Xa.a.H0/4;let Bb=class{constructor(Ta,Qa,Ob){this.$=Ta;this.Mj=Qa;this.xk=Ob;this.i5b="!REF#";this.mq=()=>{Mb&&(ub.a.gh(Mb),Mb=null);this.Doa&&(this.$.VXd=!1)};this.$og=()=>{this.i5b=this.$Ud.zk.ErrorNames[3];this.WQd=new Ia(this.Mj,this.i5b)};this.da=bb.f(this.$);this.za=this.da.za;this.dza=!1;this.TNb=this.$.fa.yk;this.X6b={};this.Ny={};this.lma={};this.Doa=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GlobalStylesSlice1",
!1);this.j2a=za.EwaSettings.Mob();this.za.qy(this.mq);this.Kkj=za.EwaSettings.GLa();this.goj=za.EwaSettings.Vya();this.coj=za.EwaSettings.Uya();this.Jkj=za.EwaSettings.tob();this.PLa=this.coj||this.goj||this.Kkj||this.Jkj;this.x3f=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8619261_EnableRowColCSEForCellEntryPoint");this.xVd=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8645280_EnablingRowColCSEIfFirstRowColOfNextBlockHidden");this.uIc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8702535_EnablingHiddenRangeSlice2Ewa");
this.T3a=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8780264_logFpCseUnattemptedInSingleTag");this.s1f=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8839836_LogUnfreezeAndFreezeAfterFreezeCse");this.lIc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8775076_FreezeCseWhenRowsColumnsHidden")&&za.EwaSettings.MXd();this.SXf=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8788453_hideSelectionForFreezePanesCse");this.PLa&&void Ja.a.uj(rb.Ed).then(Jb=>{this.$Ud=Jb;Jb.zk?(Jb.zk.ErrorNames&&3<Jb.zk.ErrorNames.length&&
(this.i5b=Jb.zk.ErrorNames[3]),this.WQd=new Ia(this.Mj,this.i5b)):Jb.gqd(this.$og)});Gc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8575809_mathMax");xc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8699403_measureValidations");this.bob=za.EwaSettings.Mob()&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8771915_enableAsyncFreezePanesCSEOperation");this.Uoj=za.EwaSettings.MXd()&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8778653_enableFreezePanesCseForSheetsWithMergeCells")}dispose(){this.da=
this.$=null;this.Ny={};this.dza=!1;this.X6b={};this.za.Ax(this.mq);this.$Ud&&this.$Ud.KVc(this.$og)}Xsd(Ta,Qa,Ob,Jb){try{if(this.dza)Oa.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${Ta}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=${Qa}`);else if(this.Rmj(Ta)){const hd=this.za.DAc();this.WLh(Ta,null===Ob||void 0===Ob?void 0:Ob.Rz,hd)}else{za.EwaSettings.isChangeGateEnabled("OfficeVSO:8827257_ErrorHandlingPostInsertSelection")&&
(this.ARj=Jb);var Jc=za.EwaSettings.n2a()?za.EwaSettings.vne():za.EwaSettings.i6d(),zb=this.za.DAc(1554436520===Ta||1051390410===Ta?Jc:0,674605324===Ta||-706918724===Ta?Jc:0);this.QF=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8627749_EnabledSelectedRangePassingAsParameter")&&(null===Ob||void 0===Ob?0:Ob.selectedRanges)?null===Ob||void 0===Ob?void 0:Ob.selectedRanges:this.da.ha.pa.selectedRanges;if(this.x3f){const hd=this.QF[0];var tb=Qa?!(1===hd.left&&hd.right===hd.maxColumns):!(1===hd.top&&hd.bottom===
hd.maxRows)}else tb=!1;this.Frj=tb;if(this.x3f&&this.Frj){var zc=this.QF;if(0===zc.length)var dd=null;else{Jb=[];for(const hd of zc){const xd=hd.clone();Qa?(xd.left=1,xd.right=xd.maxColumns):(xd.top=1,xd.bottom=xd.maxRows);Jb.push(xd)}dd=Jb}this.QF=dd}var od=F(this.da,zb,Qa,Ta,this.QF);this.Ny={};this.PLa&&(this.lma={},this.nvb=0,this.xMb=Ob);if(!xc||!this.hGa("WebServiceResponseReceivedInAttemptInstantaneousGridAction",zb,Ta,Qa)){var gb=performance.now();this.y8d=this.mSi(Ta,Qa);var gc=this.hoj(Ta,
zb,od,Qa),Dc=performance.now()-gb;Dc&&xc&&Oa.ULS.sendTraceTag(507556638,0,50,`GridInstantaneousAction.attemptInstantaneousGridAction command=${Ta}, time taken for isInstantaneousGridActionPossible=${Dc}, isRow=${Qa}`);gc?(this.dza=!0,this.$.VXd=!0,this.dug=performance.now(),this.mzg(Ta,Qa,od,zb)):this.da.tk.Pza(!1)}}}catch(hd){this.eEc("GridInstantaneousAction.AttemptInstantaneousGridAction",hd,Ta)}}Nhe(){this.TNb=this.$.fa.yk}WLh(Ta,Qa,Ob){if(this.Qmj(Ta,Ob,Qa)){this.dug=performance.now();this.dza=
!0;const Jb=G(Ob);this.Ny={};this.bob?(this.Wde(Ob),this.Lfe(Ta,Jb,Ob,Qa,new Map,new Map)):this.Lfe(Ta,Jb,Ob,Qa)}else this.da.tk.Pza(!1)}Qmj(Ta,Qa,Ob){var Jb,Jc,zb;if(!this.Pmj(Ta))return this.s1f&&f("CSE not enabled for command",Ta),!1;if(isNullOrUndefined(Ob))return this.T3a&&f("PaneViewData Null",Ta),!1;if(this.s1f&&this.da.fh.nx)return f("Freeze on top of Freeze",Ta),!1;var tb=this.da;const zc=tb.jj;if(this.lIc){var dd=null!==(Jb=tb.Cmb())&&void 0!==Jb?Jb:tb.s6();if(null===dd||1!==dd.top||1!==
dd.left)return f("Horizontal/Vertical Scroll",Ta),!1;if(!u(tb,Ob,Ta))return!1}else if(Ob.VisibleColumns+1!==Ob.FirstScrollableColumn||Ob.VisibleRows+1!==Ob.FirstScrollableRow)return this.T3a?f("Horizontal/Vertical Scroll",Ta):Oa.ULS.sendTraceTag(507650447,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Ta}, parameter = Scroll present`),!1;for(const xd of Qa){Jb=xd.Yj;if(0<(null===(zb=null===(Jc=null===Jb||void 0===Jb?void 0:Jb.Content)||void 0===Jc?void 0:Jc.MergedRanges)||
void 0===zb?void 0:zb.length)){if(!this.Uoj)return this.T3a?f("Merged Cell",Ta):Oa.ULS.sendTraceTag(507650446,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Ta}, parameter = Merged Cell present`),!1;a:{var od=Qa,gb=xd;tb=Ob;dd=this.da;if(!gb||0>=gb.vs){Jb=!0;break a}Jb=gb.Yj.GridBlockModel;const fd=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8775076_FreezeCseWhenRowsColumnsHidden")&&za.EwaSettings.MXd();var gc=od,Dc=gb,hd=tb;if(d(Dc,1,hd,gc)||d(Dc,4,hd,gc))if(gc=
t(Jb,tb,1,fd?v(dd,tb.FirstScrollableRow,!0).gnb:0),gc=Jb.RowNumbers[0]+gc.o7b-1,gc=gc<Jb.RowNumbers[0]?Jb.RowNumbers[0]:gc,!A(Jb,gc,0,!0,"FreezePane")){Jb=!1;break a}gc=tb;if(d(gb,1,gc,od)||d(gb,3,gc,od))if(tb=r(Jb,tb,1,fd?v(dd,tb.FirstScrollableColumn,!1).gnb:0),tb=Jb.ColumnNumbers[0]+tb.qMb-1,tb=tb<Jb.ColumnNumbers[0]?Jb.ColumnNumbers[0]:tb,!A(Jb,tb,0,!1,"FreezePane")){Jb=!1;break a}Jb=!0}if(!Jb)return this.T3a?f("Merged Cells Spanblocks",Ta):Oa.ULS.sendTraceTag(507360354,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Ta}, parameter = Merged Cells Spanblocks present`),
!1}if(0<xd.cp.count)return this.T3a?f("Floating Objects",Ta):Oa.ULS.sendTraceTag(507650445,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Ta}, parameter = FO present`),!1;if(xd.tl.getHasTable())return this.T3a?f("Table/PivotTable",Ta):Oa.ULS.sendTraceTag(507650444,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Ta}, parameter = Table present`),!1;if(!this.lIc&&zc.Moa(xd.zj))return this.T3a?f("Hidden Row/Col",Ta):Oa.ULS.sendTraceTag(507650443,
0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Ta}, parameter = Hidden row/col present`),!1}return!0}hoj(Ta,Qa,Ob,Jb){const Jc=this.da,zb=this.da.tk;if(!this.AYf(Ta))return zb.KV("CSENotEnabledForCommand"),!1;if(Jc.rtl)return Oa.ULS.sendTraceTag(508171339,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = hasRtl, value=true, isRow=${Jb}`),zb.KV("RTL"),!1;if(!za.EwaSettings.A2a()&&Jc.fh.nx)return Oa.ULS.sendTraceTag(508958784,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = hasPanes, value=true, isRow=${Jb}`),!1;var tb=Jc.jj,zc=this.QF,dd=this.QF[0],od=zc.length;if(1<od)return Oa.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = SelectedRanges, value=${od}, reason = Discontinuous selection, isRow=${Jb}`),zb.KV("Discontinuous selection"),!1;var gb=za.EwaSettings.Vya()&&-1113896058===Ta;od=za.EwaSettings.Uya()&&
1415868706===Ta;if(gb||od){if(gb){if(1!==dd.top){var gc=new oa.Range(dd.top-1,dd.left,dd.top-1,dd.right,!1,!1);gc=tb.Apb(gc)}}else 1!==dd.left&&(gc=new oa.Range(dd.top,dd.left-1,dd.bottom,dd.left-1,!1,!1),gc=tb.oob(gc));if(gc)return Oa.ULS.sendTraceTag(508072654,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = isPreviousRowColHidden, value=true, isRow=${Jb}`),zb.KV("isPreviousRowColHidden"),!1;var Dc;a:{for(const Ad of Ob){if(za.EwaSettings.Eha()){if(!Ad.source)continue}else if(!Ad.source)break;
gc=null===(Dc=Ad.source)||void 0===Dc?void 0:Dc.zj;if(!gc){U("isFirstRowColOfNonInitialModel",Ta);break}if(gc.$i(dd)){Dc=!1;gb?1!==gc.top&&dd.top===gc.top&&(Dc=!0):za.EwaSettings.isChangeGateEnabled("OfficeVSO:8690337_InsertColumnFlickerBugFixV2")&&1===gc.left||dd.left!==gc.left||(Dc=!0);break a}}Dc=!0}if(Dc)return Oa.ULS.sendTraceTag(508065493,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = isFirstRowColInNonInitialModel, value=true, isRow=${Jb}`),zb.KV("isFirstRowColInNonInitialModel"),
!1}if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8598978_EnablingCseForHiddenRangesSlice1")){if(!this.uIc&&!this.hef(dd,Jb))return Oa.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = isPartOfRangeHidden, value=true, isRow=${Jb}`),!1}else if(tb.Moa(dd))return Oa.ULS.sendTraceTag(507635548,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = isPartOfRangeHidden, value=true, isRow=${Jb}`),!1;
tb=this.y8d;if(za.EwaSettings.n2a()?tb>za.EwaSettings.vne():tb>za.EwaSettings.i6d())return Oa.ULS.sendTraceTag(508409418,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = rowColCount, value=${tb}, reason = rowColCount is higher than the limit, isRow=${Jb}`),zb.KV("rowColCount is higher than the limit"),!1;if(gb&&(gb=Jc.usedRange.bottom+tb,gb>Xa.a.kG))return Oa.ULS.sendTraceTag(508061699,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = newRowCount, value=${gb}, reason = newRowCount is higher than the MaxRows, isRow=${Jb}`),
zb.KV("newRowCount is higher than the MaxRows"),!1;if(od&&(od=Jc.usedRange.right+tb,od>Xa.a.WE))return Oa.ULS.sendTraceTag(508061698,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = newColCount, value=${od}, reason = newColCount is higher than the MaxRows, isRow=${Jb}`),zb.KV("newColCount is higher than the MaxCols"),!1;if(E(dd,Ob,Ta))return Oa.ULS.sendTraceTag(508404044,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = isSelectedRangeAcrossBlocks, value=true, isRow=${Jb}`),
zb.KV("isSelectedRangeAcrossBlocks"),!1;if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8624357_DisableRowColCSEForTables")&&!this.oUh(dd,Ta))return Oa.ULS.sendTraceTag(507855194,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = selectedRangeContainingTable, value=true, isRow=${Jb}`),zb.KV("selectedRangeContainingTable"),!1;od=Qa.length;if(od>za.EwaSettings.dGj())return Oa.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = BlocksInViewport, value=${od}, reason = Blocks in viewport limit exceeded, isRow=${Jb}`),
zb.KV("Blocks in viewport limit exceeded"),!1;a:{od=tb-1;for(hd of Ob){if(!hd){Oa.ULS.sendTraceTag(509649925,0,50,`GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null and command=${Ta}`);var hd=!1;break a}tb=hd.source;if(!za.EwaSettings.Eha()||tb){if(!za.EwaSettings.Eha()&&!tb){hd=!1;break a}tb=tb.Yj.GridBlockModel;gb=N(tb,od,Jb,Ta);if(!A(tb,gb,od,Jb,ia(Ta))){hd=!1;break a}}}hd=!0}if(!hd)return Oa.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=${Jb}`),
zb.KV("Model has complex cells"),!1;a:{hd=Jb?dd.top:dd.left;od=Jb?dd.bottom-dd.top:dd.right-dd.left;if(dd=this.za.UJa(dd,this.$.activeItemName))for(xd of dd)if(!A(xd.Yj.GridBlockModel,hd,od,Jb,ia(Ta))){var xd=!1;break a}xd=!0}if(!xd)return Oa.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=${Jb}`),zb.KV("Selected row or Col has complex cells"),
!1;a:{zc=zc[0];xd=0;for(fd of Ob)if(!za.EwaSettings.Eha()||fd.source&&fd.destination){if(!(za.EwaSettings.Eha()||fd.source&&fd.destination))break;hd=fd.destination.zj;dd=fd.source.zj;if(null===hd||null===dd){U("getTransitionCount source or destination block range is null",Ta);var fd=za.EwaSettings.j6d()+1;break a}if(!hd&&za.EwaSettings.vIc()){U("getTransitionCount",Ta);fd=za.EwaSettings.j6d()+1;break a}od=zc;(dd=369708605===Ta||1415868706===Ta||1542466017===Ta||-1113896058===Ta?dd.$i(od):hd.$i(od))||
(dd=Ta,tb=fd,hd=zc,!za.EwaSettings.Eha()||tb.source&&tb.destination?(od=tb.source.zj,tb=tb.destination.zj,!za.EwaSettings.vIc()||tb&&od?dd=-706918724===dd||674605324===dd?tb.left>hd.right:369708605===dd||1415868706===dd?od.left>hd.right:1051390410===dd||1554436520===dd?tb.top>hd.bottom:od.top>hd.bottom:(U("shouldPerformTransitions",dd),dd=!1)):dd=!1);dd&&(xd+=1)}fd=xd}if(fd>za.EwaSettings.j6d())return Oa.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = TransitionCount, value=${fd}, reason = Transition count limit exceeded, isRow=${Jb}`),
zb.KV("Transition count limit exceeded"),!1;if(!this.xVd&&K(Jc,Ob,Ta))return Oa.ULS.sendTraceTag(508564123,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = isFirstRowColOfNextBlockHidden, value=true, isRow=${Jb}`),!1;if(Ob=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8683331_OutlineBugFix")){var kd;a:{var Yb,Cc,td;for(const Ad of Qa)if(Qa=Ad.CKa(),Jb&&Qa&&0<(null===(kd=Qa.RowOutlines)||void 0===kd?void 0:kd.length)&&0<(null===(Yb=Qa.RowOutlinesInformation)||
void 0===Yb?void 0:Yb.length)||!Jb&&Qa&&0<(null===(Cc=Qa.ColumnOutlines)||void 0===Cc?void 0:Cc.length)&&0<(null===(td=Qa.ColumnOutlinesInformation)||void 0===td?void 0:td.length)){kd=!1;break a}kd=!0}Ob=!kd}if(Ob)return Oa.ULS.sendTraceTag(507566090,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = outlines, value=true, isRow=${Jb}`),zb.KV("Outlines are present"),!1;Oa.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ta}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=${Jb}`);
return!0}F4b(Ta,Qa,Ob,Jb,Jc,zb,tb){const zc=zb?Jc.nXc:Jc.Asc;Jc=zb?Jc.qMb:Jc.o7b;const dd=zb?"FreezeRow":"FreezeColumn";a:{const od=Ob.FirstScrollableRow;Ob=Ob.FirstScrollableColumn;switch(Jb){case 1:Jb={mXc:zb?Ta.RowNumbers[0]:Ta.ColumnNumbers[0],vSc:!tb,uSc:!0,performDiagonalCascading:tb,skipCascadingBeforeRowColIndex:!tb};break a;case 2:Jb={mXc:zb?od:Ob,vSc:!0,uSc:!1,performDiagonalCascading:tb,skipCascadingBeforeRowColIndex:!1};break a;case 3:Jb={mXc:zb?od:Ta.ColumnNumbers[0],vSc:!0,uSc:zb?!1:
!0,performDiagonalCascading:tb,skipCascadingBeforeRowColIndex:!1};break a;case 4:Jb={mXc:zb?Ta.RowNumbers[0]:Ob,vSc:!0,uSc:zb?!0:!1,performDiagonalCascading:tb,skipCascadingBeforeRowColIndex:!1};break a}Jb=null}if(!Jb)return Oa.ULS.sendTraceTag(507569417,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${dd}, parameter = isHideRowColumnSuccessful, value=false, reason = "fpConstructionParams failed", `),!1;if(Ta&&0<=zc){if(Jb.vSc&&!gridRenderer.CanvasRendererGlobals.performModelRowColOperation(Ta,
Jb.mXc,zc,Ib.FreezePane,zb))return Oa.ULS.sendTraceTag(507586704,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${dd}, parameter = freezePaneRestructureSuccessful, isRow =${zb}, value=false, reason = "Restructuring was failure", `),!1;if(Qa&&Ta&&Jb.uSc)if(gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(Qa,Ta,zb?Qa.RowNumbers[0]:Qa.ColumnNumbers[0],zc,Ib.FreezePane,zb,{rowColIndexToEndRangeCascade:Jc,skipCascadingBeforeRowColIndex:Jb.skipCascadingBeforeRowColIndex,
performDiagonalCascading:Jb.performDiagonalCascading}).isSuccess)Oa.ULS.sendTraceTag(507576470,0,50,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${dd}, parameter = freezePaneBlockCascadeOperation, value=true, isRow =${zb}, reason = "BlockCascadeRowColsOperations success", `);else return Oa.ULS.sendTraceTag(507586703,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${dd}, parameter = freezePaneBlockCascadeOperation, value=false, isRow =${zb}, reason = "BlockCascadeRowColsOperations was failure", `),
!1}return!0}mzg(Ta,Qa,Ob,Jb){var Jc;try{if(this.AYf(Ta)){var zb=ka.HelperMethods.Mh(),tb=za.EwaSettings.ENc(),zc=Ob.filter(fd=>!fd.xV),dd=this.QF[0],od=this.uIc?this.y8d-1:Qa?dd.bottom-dd.top:dd.right-dd.left,gb=ia(Ta);for(const fd of zc){if(this.hGa("WebServiceResponseReceivedInProcessGridAction",Jb,Ta,Qa))return;if(this.PLa){if(!z(fd,dd,Ta,Qa))continue}else{const oe=fd.destination.zj;if(!oe){U("processGridAction",Ta);return}if(oe.right<dd.left){fd.xV=!0;Oa.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${Ta}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${dd.left}, blockRangeRightMostValue=${oe.right}, hashCode=${fd.destination.Ti}, isRow=false`);
continue}}const kd=Qa?dd.topLeft.top:dd.topLeft.left;let Yb,Cc;za.EwaSettings.Eha()?(Yb=fd.source?this.fxa("SourceModel",fd.source,Ta):null,Cc=fd.destination?this.fxa("DestinationModel",fd.destination,Ta):null):(Yb=this.fxa("SourceModel",fd.source,Ta),Cc=this.fxa("DestinationModel",fd.destination,Ta));const td=fd.destination?fd.destination.Ti:fd.source.Ti;Ob=!1;const Ad=gb===Ib.Hide||gb===Ib.Delete?Cc:Yb;if(X(fd,Ta,dd)){if(!J(Ad,kd,od,gb,Qa,Ta)){this.oU();Oa.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${Ta}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${td}, isRow=${Qa}, rowColNumber=${kd}`);
return}Oa.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${Ta}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${td}, isRow=${Qa}, rowColNumber=${kd}`)}else if(za.EwaSettings.A2a()&&this.da.fh.MZd(dd)){const oe=this.da.fh.Im;if(dd.right<=this.da.fh.en||dd.bottom<=oe)Ob=ta(Ad,Ta,od+1)}if(Yb&&Cc&&!Ob){let oe;oe=this.PLa?N(Yb,od,Qa,Ta):Yb.ColumnNumbers[0];const qe=fd.source.Ti;if(H(Yb,Cc,oe,od,gb,Qa,Ta).isSuccess)fd.xV=
!0,this.xVd&&(this.Ny[qe]||this.OFg(Yb,Qa),this.Ny[null===(Jc=null===fd||void 0===fd?void 0:fd.destination)||void 0===Jc?void 0:Jc.Ti]||this.OFg(Cc,Qa),this.E8k(Yb,Cc,gb,Qa)),Oa.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${Ta}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${qe}, isRow=${Qa}, rowColNumber=${oe}`);else{this.oU();Oa.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${Ta}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${qe}, isRow=${Qa}, rowColNumber=${oe}`);
return}}else fd.xV=!0;this.YXk(Cc,Yb,fd);if(ka.HelperMethods.Mh()-zb>tb){this.ozk(Ta,Qa,zc,Jb);return}}var gc=()=>{try{this.t0h(Qa,Ta,Jb,dd),ba("ProcessGridAction",ka.HelperMethods.Mh()-zb,Ta)}catch(fd){this.eEc("GridInstantaneousAction.ProcessGridAction",fd,Ta)}};if(this.PLa&&this.xMb&&this.xMb.lGc&&this.xMb.lGc.InsertDeleteRangeItems&&0<this.xMb.lGc.InsertDeleteRangeItems.length)if(this.WQd){var Dc=this.xMb.lGc.InsertDeleteRangeItems[0],hd=(fd,kd)=>0!==Dc.DeltaRow?fd>=dd.top:0!==Dc.DeltaColumn?
kd>=dd.left:!1,xd=fd=>this.WQd.jbl(fd,Dc.DeltaRow,Dc.DeltaColumn,dd);xc?window.setTimeout(()=>{this.sBe(Jb,Ta,Qa,hd,xd,gc)},0):this.sBe(Jb,Ta,Qa,hd,xd,gc)}else this.dza=!1,this.da.tk.Pza(!1),Oa.ULS.sendTraceTag(508063873,0,15,`GridInstantaneousAction:processGridAction gridReferenceUpdates is null command=${Ta}`);else gc()}else this.dza=!1,this.da.tk.Pza(!1)}catch(fd){this.eEc("GridInstantaneousAction.ProcessGridAction",fd,Ta)}}h2h(Ta,Qa,Ob,Jb,Jc,zb){var tb,zc,dd,od,gb,gc,Dc=t(Ta,Jc,zb,this.lIc?v(this.da,
Jc.FirstScrollableRow,!0).gnb:0);const hd=r(Ta,Jc,zb,this.lIc?v(this.da,Jc.FirstScrollableColumn,!1).gnb:0);Dc={o7b:Dc.o7b,nXc:Dc.nXc,qMb:hd.qMb,Asc:hd.Asc};switch(zb){case 1:if(!this.F4b(Ta,Ob,Jc,zb,Dc,!0,!1))return this.oU(),Oa.ULS.sendTraceTag(507568152,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${zb} failed, cascadingType=Row`),null;if(!this.F4b(Ta,Qa,Jc,zb,Dc,!1,!1))return this.oU(),Oa.ULS.sendTraceTag(507568151,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${zb} failed, cascadingType=Col`),
null;if(!this.F4b(Ta,Jb,Jc,zb,Dc,!1,!0))return this.oU(),Oa.ULS.sendTraceTag(507568150,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${zb} failed, cascadingType=Diagonal-Col`),null;break;case 2:case 3:case 4:if(!this.F4b(Ta,Ob,Jc,zb,Dc,!0,!1))return this.oU(),Oa.ULS.sendTraceTag(507568149,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${zb} failed, cascadingType=Row`),null;if(!this.F4b(Ta,Qa,Jc,zb,Dc,!1,!1))return this.oU(),Oa.ULS.sendTraceTag(507568148,
0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${zb} failed, cascadingType=Col`),null;break;default:return null}return new oa.Range(null===(tb=Ta.RowNumbers)||void 0===tb?void 0:tb[0],null===(zc=Ta.ColumnNumbers)||void 0===zc?void 0:zc[0],null===(dd=Ta.RowNumbers)||void 0===dd?void 0:dd[(null===(od=Ta.RowNumbers)||void 0===od?NaN:od.length)-1],null===(gb=Ta.ColumnNumbers)||void 0===gb?void 0:gb[(null===(gc=Ta.ColumnNumbers)||void 0===gc?NaN:gc.length)-1],!1,!1)}k2h(Ta,
Qa,Ob,Jb,Jc,zb){a:{var tb=Ob.FirstScrollableRow,zc=Ob.FirstScrollableColumn;for(dd of Jb)if(l(dd,tb,zc)){tb={};tb.X=dd.dr.X;tb.Y=dd.dr.Y;var dd=tb;break a}dd=null}if(!dd||!Ob)return Oa.ULS.sendTraceTag(507576400,0,15,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Qa}, parameter = getRootBlockPostionOfFP, value=false, reason = "Construction failed", blockPosition= Failed to receive the root of FP ops `),!1;tb=Ob.FirstScrollableRow;zc=Ob.FirstScrollableColumn;for(let Yb=
1;4>=Yb;Yb++)if(d(Ta.destination,Yb,Ob,Jb)){var od=Ta.destination,gb=tb,gc=zc,Dc=Yb,hd=dd,xd={};if(l(od,gb,gc))switch(Dc){case 1:xd.X=0;xd.Y=0;break;case 4:xd.X=od.dr.X;xd.Y=0;break;case 3:xd.X=0;xd.Y=od.dr.Y;break;case 2:xd.X=od.dr.X,xd.Y=od.dr.Y}else switch(Dc){case 1:od=x(od.dr,hd);xd.X=od.X;xd.Y=od.Y;break;case 4:var fd=gc=void 0,kd=void 0;(null===(kd=od.TB)||void 0===kd?void 0:kd[0])<=gb&&(null===(fd=od.TB)||void 0===fd?void 0:fd[(null===(gc=od.TB)||void 0===gc?NaN:gc.length)-1])>=gb?(xd.X=od.dr.X,
xd.Y=0):(hd=x(od.dr,hd),xd.X=od.dr.X,xd.Y=hd.Y);break;case 3:kd=fd=gb=void 0;(null===(kd=od.hH)||void 0===kd?void 0:kd[0])<=gc&&(null===(fd=od.hH)||void 0===fd?void 0:fd[(null===(gb=od.hH)||void 0===gb?NaN:gb.length)-1])>=gc?xd.X=0:(hd=x(od.dr,hd),xd.X=hd.X);xd.Y=od.dr.Y;break;case 2:xd.X=od.dr.X,xd.Y=od.dr.Y}xd.PaneType=Dc;Dc=xd;xd=this.fxa("DestinationModel",Ta.destination,Qa);od=Ta.sYg?this.fxa("SourceModel",Ta.sYg,Qa):null;hd=Ta.wYg?this.fxa("SourceModel",Ta.wYg,Qa):null;gb=1===Yb?Ta.tYg?this.fxa("SourceModel",
Ta.tYg,Qa):null:null;if(od=this.h2h(xd,hd,od,gb,Ob,Yb))Jc.set(od,xd),zb.set(od,{dr:Dc,zj:od,$cf:Ta.destination}),Oa.ULS.sendTraceTag(507586701,0,50,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Qa}, parameter = isNewBlockConstructionSuccessful, value=true, reason = "Construction Successful", blockPosition=${JSON.stringify(Dc)}, paneType=${Yb}, `);else return Oa.ULS.sendTraceTag(507586700,0,15,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Qa}, parameter = isNewBlockConstructionSuccessful, value=false, reason = "Construction failed", blockPosition=${JSON.stringify(Dc)}, paneType=${Yb}, `),
!1}return!0}k6g(Ta,Qa,Ob,Jb){if(this.bob&&this.hGa("WebServiceResponseReceivedInUpdateBlockCacheWithConstructedBlock",Jb,1844679312,void 0))return Oa.ULS.sendTraceTag(507381976,0,15,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=1844679312, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" '),!1;try{const Jc=ka.HelperMethods.Mh();let zb=!0;Ta.forEach((tb,zc)=>{if(zb)if(zc=Qa.get(zc)){var dd=this.za.Hn(zc.$cf.la,zc.dr);this.ZXk(tb,dd);this.za.jbk(zc.dr,
zc.$cf.la)?zb=this.za.z9k(dd,tb,zc.dr,this.TNb,Ob):(Oa.ULS.sendTraceTag(507570071,0,50,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=freezeOrUnfreezeOperation, parameter = primeCacheItem, value=false, reason = "Prime Cache Items failed"'),zb=!1)}else zb=!1});if(!zb)return!1;ba("updateBlockCacheWithConstructedBlock",ka.HelperMethods.Mh()-Jc,1844679312);return!0}catch(Jc){return Oa.ULS.sendTraceTag(507570070,0,10,`encountered exception in updateBlockCacheWithConstructedBlock : ${Jc}`),
!1}}Lfe(Ta,Qa,Ob,Jb,Jc,zb){Jb=void 0===Jb?null:Jb;try{if(this.hGa("WebServiceResponseReceivedInProcessFreezePanesGridAction",Ob,Ta,void 0))Oa.ULS.sendTraceTag(507586699,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${Ta}, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" `);else{var tb=ka.HelperMethods.Mh(),zc=za.EwaSettings.ENc(),dd=[];if(this.bob){dd=Qa.filter(gc=>!gc.xV);var od=Jc;var gb=zb}else this.Wde(Ob),dd=Qa,od=new Map,gb=new Map;
for(const gc of dd)if(gc.destination){if(!this.k2h(gc,Ta,Jb,Ob,od,gb)){this.oU();Oa.ULS.sendTraceTag(507586698,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${Ta}, parameter = isBlockConstructionForPairSuccessful, value=false, reason = "Construction failed", hashCode = ${gc.destination.Ti} , `);return}if(this.bob&&(gc.xV=!0,ka.HelperMethods.Mh()-tb>zc)){this.nzk(Ta,Qa,Ob,Jb,od,gb);return}}od.size!==gb.size?Oa.ULS.sendTraceTag(507576399,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${Ta}, parameter = processFreezePaneGridOperation, value=false, reason = "Constructed models not matching with constructed panes" `):
(Qa=!1,(Qa=this.bob?this.k6g(od,gb,Jb,Ob):this.k6g(od,gb,Jb))?this.rrk(Ta,Jb,Ob)?(Oa.ULS.sendTraceTag(507360353,0,50,`GridInstantaneousAction.processFreezePanesGridAction command=${Ta}, parameter = processFreezePanesGridAction, value=true, reason = "Freeze Panes CSE operation complete" `),ba("ProcessFreezePanesGridAction",ka.HelperMethods.Mh()-tb,Ta)):(this.pne(Ob),Oa.ULS.sendTraceTag(507381975,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${Ta}, parameter = renderFreezePanesGrid, value=false, reason = "Updating constructing model failed" `)):
(this.pne(Ob),Oa.ULS.sendTraceTag(507570069,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${Ta}, parameter = updateBlockCacheItem, value=false, reason = "Updating constructing model failed" `)))}}catch(gc){this.pne(Ob),this.eEc("GridInstantaneousAction.ProcessFreezePanesGridAction",gc,Ta)}}t0h(Ta,Qa,Ob,Jb){var Jc;if(!this.hGa("CommitGridInstantaneousActionResults",Ob,Qa,Ta)){var zb=ka.HelperMethods.Mh();if(this.Ny&&0!==Object.keys(this.Ny).length){if(qa(Qa))for(var tb=0;tb<Ob.length;tb++){var zc=
Ob[tb].Ti;zc&&(zc=this.Ny[zc])&&gridRenderer.CanvasRendererGlobals.removeExtraModelRowCol(zc)}if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8712164_ACEFix_AbortRowColCSEWhenRowColOffsetsAreOutOfBoundsV2"))for(tb=Object.keys(this.Ny),zc=0;zc<tb.length;zc++){var dd=this.Ny[tb[zc]];if(dd){if(30<dd.ColumnOffsets.length){Oa.ULS.sendTraceTag(507556629,0,15,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Qa},
              block # of columns = ${dd.ColumnOffsets.length} > MaxAllowedRowColCount`);this.oU();return}if(28<dd.RowOffsets.length){Oa.ULS.sendTraceTag(507556628,0,15,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Qa},
              block # of Rows = ${dd.RowOffsets.length} > MaxAllowedRowColCount`);this.oU();return}}}var od=[];od.push(...Ob);mc&&!this.da.fh.nx&&(tb=this.za.uA().filter(xd=>this.$.activeItemName===xd.la.sheetName),this.fal(Ta,tb,od,Qa));this.Wde(od);if(qa(Qa)||ha(Qa)){tb=this.da.usedRange;for(var gb of od)gb.zK=4,gb.l4a=!0,za.EwaSettings.isChangeGateEnabled("OfficeVSO:8578927_blockModelRestoringBugFix")?this.Ny[gb.Ti]&&!this.Qgl(Ta,gb.CKa(),this.Ny[gb.Ti],gb.HK().paneType)?this.Ny[gb.Ti]=null:za.EwaSettings.isChangeGateEnabled("OfficeVSO:8586105_blockRestoringServerReponseBugFix")&&
this.za.rBa(gb.Ti):this.zMk(gb,tb,Jb,Ta,Qa)?this.Ny[gb.Ti]=null:za.EwaSettings.isChangeGateEnabled("OfficeVSO:8586105_blockRestoringServerReponseBugFix")&&this.za.rBa(gb.Ti)}if(this.PLa&&this.lma)for(var gc in this.lma)gb=this.lma[gc],(!jc||gb)&&(tb=gb.bbk)&&gb.lWd&&this.xk.asc(tb.range,!0);if(this.vgh(Qa,od)){gc=ya.a.create().toString();gb=this.da.jj;tb=this.QF;if(Ha(Qa)||ha(Qa))var Dc=0;else if(qa(Qa)){Dc=Ta?Ga(Jb.top):Jb.top;zc=Ta?Ga(Jb.bottom):Jb.bottom;dd=Ta?Jb.left:Ga(Jb.left);var hd=Ta?Jb.right:
Ga(Jb.right);Dc=new oa.Range(Dc,dd,zc,hd,!1,!1);Dc=Ta?gb.getCellHeight(Dc):gb.getCellWidth(Dc)}gb.qAb(tb,Dc,Ta);if(za.EwaSettings.A2a()&&this.da.fh.nx){Dc=this.GWi(Jb,Ta);tb=!1;zc={};for(const xd of Ob)xd.zK=4,Ob=xd.HK().paneType,dd=this.da.fh.en,hd=this.da.fh.Im,(4===Ob&&!Ta||3===Ob&&(Jb.right<=dd||Jb.bottom<=hd))&&0===Object.keys(zc).length&&(zc=ja(xd,Qa,Dc)),0!==Object.keys(zc).length&&(xd.Yj.PaneViewData=zc,tb=!0,$a.b(xd.la,zc,xd.Ck.Revision,void 0,!0));tb&&this.da.gq.Hze(gb,this.da.fh,!0,Uc,
Pa,this.da.gV())}Jb=Object.keys(this.Ny);this.za.UTc(Jb,gc,Ta?"row":"column",!0,Qa);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8827257_ErrorHandlingPostInsertSelection")&&(null===(Jc=this.ARj)||void 0===Jc?void 0:Jc.call(this));this.dza=!1;Mb=ea.a(this.$).Dm.mGa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,Aa.a.instance.ia(2188));ba("CommitGridInstantaneousActionResults",ka.HelperMethods.Mh()-zb,Qa);this.PLa&&this.lma?window.setTimeout(()=>{this.hGa("commitGridInstantaneousActionResults",
od,Qa,Ta)||(this.cCk(),this.ZCg())},za.EwaSettings.ENc()):this.ZCg()}else this.TJg(od),this.oU()}else this.oU(),Oa.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Qa}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${Ta}`)}}rrk(Ta,Qa,Ob){const Jb=ka.HelperMethods.Mh();if(this.bob&&this.hGa("WebServiceResponseReceivedInRenderFreezePanesGridInstantaneousActionResults",Ob,1844679312,void 0))return Oa.ULS.sendTraceTag(507381974,
0,15,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=1844679312, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" '),!1;Ob=ya.a.create().toString();$a.b(this.$.la,Qa,this.TNb,void 0,!0);Qa=this.da.jj;this.SXf&&this.da.Fh.RUb();this.da.gq.Hze(Qa,this.da.fh,!0,Uc,Pa,this.da.gV());Qa=Object.keys(this.Ny);this.za.UTc(Qa,Ob,"both",!0);this.SXf&&(this.da.Fh.sAb(),this.da.Fh.zja({T2:!0,z1:!0}));this.dza=!1;Mb=ea.a(this.$).Dm.mGa(6,"GridInstantaneousAction.renderFreezePanesGridInstantaneousActionResults",
void 0,Aa.a.instance.ia(2188));this.R9f();ba("renderFreezePaneGridInstantaneousActionResults",ka.HelperMethods.Mh()-Jb,Ta);return!0}pne(Ta){Ta.forEach(Qa=>{Qa.zK=0;Qa.Yj.PaneViewData=null});this.za.GPa({dJa:!0,eJa:"FreezePaneNewCseBlocksDisposed"});this.TJg(Ta);this.oU()}Qgl(Ta,Qa,Ob,Jb){if(this.xVd&&(null===Ob||void 0===Ob?void 0:Ob.AdjacentBlocksHiddensInfo)!==(null===Qa||void 0===Qa?void 0:Qa.AdjacentBlocksHiddensInfo)||za.EwaSettings.isChangeGateEnabled("OfficeVSO:8632989_FreezePanesRowColCSEFlickerBugFix")&&
(2===Jb||3===Jb||4===Jb)||za.EwaSettings.isChangeGateEnabled("OfficeVSO:8595615_CSElogsBugFix")&&!this.R0h(Qa,Ob,Ta))return!0;Jb=this.QF[0];var Jc=Ta?Jb.top:Jb.left;const zb=Ta?null===Qa||void 0===Qa?void 0:Qa.RowNumbers[(null===Qa||void 0===Qa?NaN:Qa.RowNumbers.length)-1]:null===Qa||void 0===Qa?void 0:Qa.ColumnNumbers[(null===Qa||void 0===Qa?NaN:Qa.ColumnNumbers.length)-1],tb=this.da.usedRange,zc=Ta?Qa.RowHeights:Qa.ColumnWidths,dd=Ta?Ob.RowHeights:Ob.ColumnWidths;if((Ta?Jb.bottom:Jb.right)<(Ta?
null===Qa||void 0===Qa?void 0:Qa.RowNumbers[0]:null===Qa||void 0===Qa?void 0:Qa.ColumnNumbers[0]))return 0<Qa.Cells.length||za.EwaSettings.isChangeGateEnabled("OfficeVSO:8615878_willServerSendReponseInsertBugFix")&&0<Ob.Cells.length||!this.Wif(zc,dd);if(Jc>zb)return!1;Jc=this.EYi(Ta,Jc,Qa);return this.Wif(zc,dd)&&(Ta&&Jb.top>tb.bottom||!Ta&&Jb.left>tb.right||!this.AZf(Qa,Jc,Ta)&&!this.AZf(Ob,Jc,Ta))?!1:!0}R0h(Ta,Qa,Ob){Ta=Ob?Ta.RowNumbers:Ta.ColumnNumbers;Qa=Ob?Qa.RowNumbers:Qa.ColumnNumbers;for(Ob=
0;Ob<Math.min(Ta.length,Qa.length);Ob++)if(Ta[Ob]!==Qa[Ob])return!1;return!0}EYi(Ta,Qa,Ob){Ta=Ta?Ob.RowNumbers:Ob.ColumnNumbers;for(Ob=0;Ob<Ta.length;Ob++)if(Ta[Ob]===Qa)return Ob;return!(Qa<Ta[0])&&Qa>Ta[Ta.length-1]?Ta.length-1:0}Wif(Ta,Qa){for(let Ob=0;Ob<Math.min(Ta.length,Qa.length);Ob++)if(Ta[Ob]!==Qa[Ob])return!1;return!0}AZf(Ta,Qa,Ob){if(0===Ta.Cells.length)return!1;if(Ob)return Ta.Cells[Ta.Cells.length-1].Row>=Qa;for(Ob=0;Ob<Ta.Cells.length;Ob++)if(Ta.Cells[Ob].Col>=Qa)return!0;return!1}hef(Ta,
Qa){const Ob=this.da.jj,Jb=Qa&&Ob.Apb(Ta);Ta=!Qa&&Ob.oob(Ta);return!Jb&&!Ta}fal(Ta,Qa,Ob,Jb){for(const Jc of Qa){const zb=Jc.Ti,tb=this.fxa("SourceModel",Jc,Jb);if(!this.Ny[zb]){const zc=this.HJi(Ta,Jc,Qa);if(!zc)continue;const dd=this.Ny[zc.Ti];if(!dd||!zc)break;this.z$k(Ta,tb,dd);Jc.w9b=!0;this.Ny[zb]=tb;Ob.push(Jc)}}}z$k(Ta,Qa,Ob){Ta?(Qa.RowNumbers=Ob.RowNumbers,Qa.RowHeights=Ob.RowHeights,Qa.RowOffsets=Ob.RowOffsets,Qa.RowOutlinesInformation=Ob.RowOutlinesInformation,Qa.RowOutlines=Ob.RowOutlines,
Qa.BlockHeight=Ob.BlockHeight):(Qa.ColumnNumbers=Ob.ColumnNumbers,Qa.ColumnWidths=Ob.ColumnWidths,Qa.ColumnOffsets=Ob.ColumnOffsets,Qa.ColMetadata=Ob.ColMetadata,Qa.FixedColumns=Ob.FixedColumns,Qa.BlockWidth=Ob.BlockWidth)}HJi(Ta,Qa,Ob){for(const Jb of Ob)if(Ta){if(Qa.HK().topLeft.Y===Jb.HK().topLeft.Y&&this.Ny[Jb.Ti])return Jb}else if(Qa.HK().topLeft.X===Jb.HK().topLeft.X&&this.Ny[Jb.Ti])return Jb;return null}cCk(){try{const Ta=[];for(const Qa in this.lma){const Ob=this.lma[Qa];if(jc&&!Ob)continue;
if(Ob.lWd)continue;const Jb=oa.Range.yi(Ob.rowNum,Ob.colNum),Jc=this.da.yh(Jb);Jc&&Ta.push({Xfa:Jc,editText:Ob.cellText})}0<Ta.length&&this.xk.cTh(Ta)}catch(Ta){jc&&Oa.ULS.sendTraceTag(507326976,0,15,`GridInstantaneousAction.sendNewDataEditsToCalc:  exception enountered: ${Ta}`)}}fxa(Ta,Qa,Ob){let Jb=this.Ny[Qa.Ti];if(!Jb){const Jc=ka.HelperMethods.vN(()=>{Jb=Qa.tIi()});ba(Ta,Jc,Ob)}return Jb}Wde(Ta){for(const Qa of Ta)Ta=Qa.Ti,this.X6b[Ta]||(this.X6b[Ta]=Qa.CKa())}TJg(Ta){for(const Qa of Ta){Ta=
Qa.Ti;const Ob=this.X6b[Ta];if(Ob&&!Qa.Xke(Ob)){Oa.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${Ta}`);this.oU();break}}}vgh(Ta,Qa){for(const Ob of Qa)if(Qa=Ob.Ti,this.Ny[Qa]){if(!Ob.Xke(this.Ny[Qa]))return Oa.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${Ta}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${Qa}, isRow=false`),
!1;Ob.l4a=!0}return!0}ozk(Ta,Qa,Ob,Jb){window.setTimeout(()=>{this.mzg(Ta,Qa,Ob,Jb)},0)}nzk(Ta,Qa,Ob,Jb,Jc,zb){window.setTimeout(()=>{this.Lfe(Ta,Qa,Ob,Jb,Jc,zb)},0)}fuj(Ta){for(const Qa of Ta)if(Qa.Yj.Information.Revision>this.TNb)return!0;return!1}hGa(Ta,Qa,Ob,Jb){return this.fuj(Qa)?(this.TNb=this.$.fa.yk,this.oU(),Oa.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${Ob}, parameter = ${Ta}, value=true, reason = "Server response received before completing client side estimation", isRow=${Jb}}`),
!0):!1}oU(){this.Ny={};this.dza=!1;this.X6b={};this.da.tk.Pza(!1);this.PLa&&(this.nvb=0,this.lma={})}eEc(Ta,Qa,Ob){this.oU();Oa.ULS.sendTraceTag(509723721,0,10,`${Ta} encountered exception ${Qa} for command=${Ob}`)}YXk(Ta,Qa,Ob){Ta&&(this.Ny[Ob.destination.Ti]=Ta);Qa&&(this.Ny[Ob.source.Ti]=Qa)}ZXk(Ta,Qa){this.Ny[Qa]=Ta}zMk(Ta,Qa,Ob,Jb,Jc){const zb=Jb?Ta.zj.top>Qa.bottom:Ta.zj.left>Qa.right;Qa=this.Ny[Ta.Ti];if(!Qa)return!1;if(Ta=(Jb?Ob.top>Ta.zj.bottom:Ob.left>Ta.zj.right)||zb){if(0<Qa.Cells.length)return!1;
if(qa(Jc)?Jb?28<Qa.RowNumbers.length:30<Qa.ColumnNumbers.length:Jb?28>Qa.RowNumbers.length:30>Qa.ColumnNumbers.length)return!0}return Ta}sBe(Ta,Qa,Ob,Jb,Jc,zb){try{if(!this.hGa("updateReferenceForBlocks",Ta,Qa,Ob))if(Ta.length-1===this.nvb)zb();else{for(var tb=ka.HelperMethods.Mh();ka.HelperMethods.Mh()-tb<za.EwaSettings.ENc()&&Ta.length-1>=this.nvb;){const zc=Ta[this.nvb].Ti;this.nvb++;const dd=this.hTi(zc);if(jc&&!dd)continue;const od=gridRenderer.CanvasRendererGlobals.getChangedCells(dd,Jb);for(const Dc of od){if(jc&&
!Dc)continue;const hd=oa.Range.yi(Dc.rowNum,Dc.colNum),xd=this.da.yh(hd);if(!jc||xd)this.lma[Dc.rowNum+"|"+Dc.colNum]=Object.assign({},Dc,{lWd:!0,bbk:xd})}const gb=this.Ny[zc];if(jc&&!gb)continue;const gc=gridRenderer.CanvasRendererGlobals.updateReferenceUpdateForModel(gb,this.i5b,Jb,Jc);for(const Dc of gc)if(!jc||Dc)this.lma[Dc.rowNum+"|"+Dc.colNum]=Object.assign({},Dc,{lWd:!1})}Ta.length-1>this.nvb?window.setTimeout(()=>{this.sBe(Ta,Qa,Ob,Jb,Jc,zb)},0):zb()}}catch(zc){jc&&Oa.ULS.sendTraceTag(507326947,
0,15,`GridInstantaneousAction.updateReferenceForBlocks command=${Qa}, isRow=${Ob}, exception enountered: ${zc}`)}}hTi(Ta){Ta=this.za.ro(Ta).Yj;return jc&&!Ta?null:Ta.GridBlockModel}oUh(Ta,Qa){if(674605324===Qa||-706918724===Qa)return!0;Ta=Object(Ea.a)(this.da.$,Ta);if(!Ta)return!0;Ta=Ta.usedRange;if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8616266_RowColCSETableCheckBugFix")){if((Qa=this.da.fh.nx?this.da.s_a():this.da.qY())&&Qa.$i(Ta))return!1}else if(this.da.qY().contains(Ta))return!1;return!0}Rmj(Ta){return-73576432===
Ta||-806625837===Ta||-1564089444===Ta||340334732===Ta||1844679312===Ta||83934709===Ta?!0:!1}Pmj(Ta){switch(Ta){case -806625837:case 340334732:case 1844679312:case -1564089444:case -73576432:return this.j2a;case 83934709:return!1;default:return!1}}AYf(Ta){return-1113896058===Ta||1415868706===Ta||1554436520===Ta||674605324===Ta||1051390410===Ta?za.EwaSettings.isChangeGateEnabled("OfficeVSO:8551204_globalStyle")?this.Doa&&gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled():
gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled():-706918724===Ta}ZCg(){this.R9f()}R9f(){const Ta=performance.now()-this.dug;this.da.tk&&this.$.fa&&this.da.tk.LFj(Ta)}OFg(Ta,Qa){if(Ta.AdjacentBlocksHiddensInfo){var Ob={},Jb=Qa?Ta.RowNumbers[0]:Ta.ColumnNumbers[0],Jc=Qa?Ta.RowNumbers[Ta.RowNumbers.length-1]:Ta.ColumnNumbers[Ta.ColumnNumbers.length-1],zb=Qa?this.QF[0].top:this.QF[0].left,tb=Qa?this.QF[0].bottom:
this.QF[0].right,zc=!1;Qa?(Ta.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden&&(zc=Ob.IsFirstColOfNextBlockHidden=!0),Ta.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden&&(zc=Ob.IsLastColOfPrevBlockHidden=!0),Ta.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden&&Jc<tb&&(zc=Ob.IsFirstRowOfNextBlockHidden=!0),Ta.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden&&Jb<zb&&(zc=Ob.IsLastRowOfPrevBlockHidden=!0)):(Ta.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden&&(zc=Ob.IsFirstRowOfNextBlockHidden=
!0),Ta.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden&&(zc=Ob.IsLastRowOfPrevBlockHidden=!0),Ta.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden&&Jc<tb&&(zc=Ob.IsFirstColOfNextBlockHidden=!0),Ta.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden&&Jb<zb&&(zc=Ob.IsLastColOfPrevBlockHidden=!0));Ta.AdjacentBlocksHiddensInfo=zc?Ob:void 0}}E8k(Ta,Qa,Ob,Jb){const Jc=this.Ohj(Jb?Ta.RowNumbers:Ta.ColumnNumbers,Jb?Qa.RowNumbers:Qa.ColumnNumbers,Ob);if(Jc)switch(Ob){case Ib.Hide:case Ib.Delete:Jc&&
(Jb?(this.qGa(Ta,{IsLastRowOfPrevBlockHidden:!0}),this.qGa(Qa,{IsFirstRowOfNextBlockHidden:!0})):(this.qGa(Ta,{IsLastColOfPrevBlockHidden:!0}),this.qGa(Qa,{IsFirstColOfNextBlockHidden:!0})));break;case Ib.Insert:case Ib.Unhide:Jc&&(Jb?(this.qGa(Ta,{IsFirstRowOfNextBlockHidden:!0}),this.qGa(Qa,{IsLastRowOfPrevBlockHidden:!0})):(this.qGa(Ta,{IsFirstColOfNextBlockHidden:!0}),this.qGa(Qa,{IsLastColOfPrevBlockHidden:!0})))}}Ohj(Ta,Qa,Ob){const Jb=Ta.length,Jc=Qa.length;switch(Ob){case Ib.Hide:case Ib.Delete:return Ta[0]-
1!==Qa[Jc-1];case Ib.Insert:case Ib.Unhide:return Ta[Jb-1]+1!==Qa[0]}return!1}qGa(Ta,Qa){Ta.AdjacentBlocksHiddensInfo?(Qa.IsFirstRowOfNextBlockHidden&&(Ta.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden=!0),Qa.IsLastRowOfPrevBlockHidden&&(Ta.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden=!0),Qa.IsFirstColOfNextBlockHidden&&(Ta.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden=!0),Qa.IsLastColOfPrevBlockHidden&&(Ta.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden=!0)):Ta.AdjacentBlocksHiddensInfo=
Qa}mSi(Ta,Qa){if(!this.uIc||this.hef(this.QF[0],Qa)||-1113896058===Ta||1415868706===Ta)return Qa?this.QF[0].bottom-this.QF[0].top+1:this.QF[0].right-this.QF[0].left+1;Ta=this.da.jj.$Bc([this.QF[0]]).filter(Jb=>Qa?Jb.isRow:Jb.hk);let Ob=0;for(const Jb of Ta)Ob+=Qa?Jb.bottom-Jb.top+1:Jb.right-Jb.left+1;return(Qa?this.QF[0].bottom-this.QF[0].top+1:this.QF[0].right-this.QF[0].left+1)-Ob}GWi(Ta,Qa){return this.uIc?this.y8d:Qa?Ta.bottom-Ta.top+1:Ta.right-Ta.left+1}};Bb=Object(jb.__decorate)([Object(Ja.d)(rb.id),
Object(jb.__param)(0,Object(rb.Ob)()),Object(jb.__param)(1,Object(rb.G)()),Object(jb.__param)(2,Object(rb.zc)())],Bb);Object(Sa.a)(Bb,"GridInstantaneousAction",null,[212]);var Nb=a(494),oc=a(46),aa=a(431),rc=a(216),yb=a(141),Fb=a(40),Qb=a(255),ac=a(265),Wa=a(65);class Gb{constructor(Ta,Qa){this.isRow=!1;this.autoFitRange=null;this.isRow=Ta;this.autoFitRange=Qa}}Object(Sa.a)(Gb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[149]);class Ub{constructor(Ta){this.resizeParameters=null;this.resizeParameters=
Ta}}Object(Sa.a)(Ub,"MacroRecorderSheetRowsColumnsResizedPayload",null,[149]);var Ra=a(154),Rb=a(433),ib=a(63),la=a(28);class db{constructor(Ta){this.dEd=Ta}xkf(Ta){Ta=ka.HelperMethods.HSc(Ta);return Math.max(0,Math.min(db.qdg,Ta))}jkf(Ta){return this.v8j(Ta)}w_h(Ta){return Math.round(this.dEd*Ta+2*this.pHf()+1)}v8j(Ta){return Math.max(0,Math.min(db.Ucg,(Math.max(0,Math.min(Xa.a.FNc,Ta))-2*this.pHf()-1)/this.dEd))}pHf(){return Math.floor(Math.max((this.dEd+3)/4,2))}qCc(Ta,Qa){return Qa?Ta?db.qdg:
Xa.a.p6d:Ta?db.Ucg:Xa.a.FNc}}db.qdg=409;db.Ucg=255;Object(Sa.a)(db,"ResizeHeadersConverter",null,[]);class $b extends Rb.a{constructor(Ta,Qa){super(Ta);this.Gna=(Ob,Jb)=>{Ob=this.sNd(Ob,Jb);return this.pKd(Ob)};this.Muk=(Ob,Jb)=>{var Jc=this.NYb=Jb[$b.Gkj];1===Ob?(Ob=Jb[$b.YTk],Jc=this.uOf(Ob,Jc),Oa.ULS.shipAssertTag(537153996,0,Jc!==$b.qoa,`ResizeHeadersDialogHandler - invalid size input, size = ${Ob}`),Ob=Jc!==this.qUd,Oa.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",
this.isRow,this.NYb,Jc,Ob),Ob&&this.s5h(Jc)):Oa.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===Qa.command;this.da=bb.f(this.$);this.NWc=new db(this.$.workbookContext.DxDigitNormal);this.qUd=this.ATh();Ta=this.V3h(this.qUd);Qa=this.X3h(this.qUd);this.dialogTitle=Aa.a.instance.ia(this.isRow?478:479);Ta=this.fS(Ta,Qa);this.initializeAndShow(this.dialogTitle,this.Muk,Ta);Oa.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get Ji(){return"ResizeHeadersDialog"}get NYb(){return $b.eRe}set NYb(Ta){$b.eRe=
Ta}fS(Ta,Qa){return{[$b.zY]:this.Ji,[$b.Irj]:this.isRow,[$b.Acj]:Ta,[$b.zcj]:Qa,[$b.Xnj]:this.NYb,[$b.qNd]:this.Gna}}ATh(){const Ta=this.SEi();try{return this.XJi(Ta)}finally{Ta&&Ta.dispose()}}s5h(Ta){const Qa={};Qa.SheetMultiRange=oc.t(this.da.ha.pa.selectedRanges,this.$);$b.Rqe(Qa,this.isRow,Ta);this.$.oi(this.isRow?745189930:-445963340,ib.a.ph,8,{["resizeRowColumnParameters"]:Qa})}uOf(Ta,Qa){return la.a.Bha(Ta)?Qa?this.U3h(Ta):this.W3h(Ta):$b.qoa}W3h(Ta){return Math.floor(parseFloat(Ta))}U3h(Ta){Ta=
parseFloat(Ta);return 0>Ta?$b.qoa:Ta?this.isRow?ka.HelperMethods.H8j(Ta):this.NWc.w_h(Ta):0}X3h(Ta){return Ta===$b.qoa?"":this.isRow?this.NWc.xkf(Ta).toString():this.NWc.jkf(Ta).toFixed(2)}V3h(Ta){return Ta===$b.qoa?"":Ta.toString()}XJi(Ta){if(!Ta||!Ta.$$mn()||!Ta.Ku)return $b.qoa;var Qa=Object(Ra.a)(172,Ta.Ku);if(!Qa)return $b.qoa;for(Qa=this.isRow?Qa.joa:Qa.c1a;Ta.$$mn();){const Ob=Object(Ra.a)(172,Ta.Ku);if(Ob&&(this.isRow?Ob.joa:Ob.c1a)!==Qa)return $b.qoa}return Qa}SEi(){const Ta=[];for(const Ob of this.da.ha.pa.selectedRanges){const Jb=
Ob.clone();var Qa=this.da.ol(this.da.fh.Wn(Jb));Qa=Jb.Fk(Qa.Wp);if(!Qa)return null;this.isRow?Jb.right=Jb.left=Qa.left:Jb.top=Jb.bottom=Qa.top;Ta.push(Jb)}return Ta.length?this.da.Nfa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",Ta):null}sNd(Ta,Qa){if(!la.a.Bha(Ta))return 1;Ta=this.uOf(Ta,Qa);return 0!==Ta||this.da.jj.Tdf(this.da.ha.pa.selectedRanges,this.isRow)?this.Euj(Ta)?0:2:3}pKd(Ta){let Qa="";switch(Ta){case 0:Qa="";break;case 1:Qa=Aa.a.instance.ia(767);break;case 2:Qa=String.format(Aa.a.instance.sh(99),
0,this.qCc(this.NYb));break;case 3:Qa=Aa.a.instance.ia(768)}return Qa}Euj(Ta){return 0<=Ta&&Ta<=this.qCc(!1)}qCc(Ta){return this.NWc.qCc(Ta,this.isRow)}static Rqe(Ta,Qa,Ob){if(Qa){Ta.ColumnWidth=$b.qoa;Ta.RowHeight=Ob;for(const Jb of Ta.SheetMultiRange.Ranges)Jb.FirstColumn=0,Jb.LastColumn=0}else{Ta.RowHeight=$b.qoa;Ta.ColumnWidth=Ob;for(const Jb of Ta.SheetMultiRange.Ranges)Jb.FirstRow=0,Jb.LastRow=0}}}$b.zY="id";$b.Irj="isRow";$b.Acj="initialSizeInPx";$b.zcj="initialSizeInDefaultUnits";$b.Xnj="isInitialUnitsDefaultUnits";
$b.qNd="getInputErrorIfInvalid";$b.YTk="size";$b.Gkj="isDefaultUnits";$b.qoa=-1;$b.eRe=!0;Object(Sa.a)($b,"ResizeHeadersDialog",Rb.a,[]);var Ic=a(64);const Tc=(Ta,Qa,Ob,Jb,Jc,zb,tb)=>{tb=Ta.Za(41,void 0===tb?null:tb);tb.resizeRowColumnParameters=Qa;return Ic.h(Ta,"ResizeRowsColumns",tb,Ob,Jb,Jc,zb,0)};var Zc=a(78),cc=a(327),Yc=a(157),Vc=a(36),wd=a(365),wc=a(101);let Ya=class{constructor(Ta,Qa,Ob,Jb){this.t_j=(Jc,zb)=>{if(!Qb.a(Jc)&&zb){const tb=!!Jc&&!!Jc.RequestTelemetryData;bb.f(this.$).tk.c2(zb,
Jc.StateId,tb?Jc.RequestTelemetryData.EcsOperationDuration:0,tb?Jc.RequestTelemetryData.EcsRequestDuration:0,tb?Jc.RequestTelemetryData.WfeRequestDuration:0)}};this.KQj=(Jc,zb)=>{rb.Ag.Ma()?void Ja.a.resolve(rb.Ag,{va:1}).then(tb=>{tb.s3g(zb)}):Fb.TaskExtensions.$e(Zc.GetServiceTaskFactory.dk(this.$.qa,534,535,1),tb=>{tb.result.s3g(zb)},this.$.ya,3)};this.$=Ta;this.xk=Qa;this.gridInstantaneousAction=Ob;this.grid=bb.f(this.$);this.RTb=Jb}Ri(Ta,Qa){Ta=!0;switch(Qa){case -445963340:case 1391094586:Ta=
this.Sj(8);break;case 745189930:case 146338636:Ta=this.Sj(16)}return!Ta}executeCommand(Ta,Qa,Ob){var Jb=bb.f(this.$),Jc=Qa.command;Ta=ya.a.create().toString();var zb=Fb.TaskExtensions.Yq();switch(Jc){case 1391094586:case 146338636:zb=1391094586===Jc;(Ta=Ob.autoFitRanges)&&Ta.Ranges&&Ta.Ranges.length||(Ta=oc.t(Jb.ha.pa.selectedRanges,this.$));zb=this.gii(zb?1:0,Ta,Qa);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:zb=-445963340===Jc||-706918724===
Jc||369708605===Jc;var tb=za.EwaSettings.Sob()||za.EwaSettings.n2a(),zc=za.EwaSettings.wIc();(tb&&-706918724===Jc||zc&&1051390410===Jc)&&Jb.tk.BQ(18,Ta,Nb.a(Jc));if(-445963340===Jc||745189930===Jc){var dd=Nb.a(Qa.command);Jb.tk.BQ(16,Ta,dd);var od=Ob.resizeRowColumnParameters}else{Ob=za.EwaSettings.z0d()&&(369708605===Jc||1542466017===Jc)&&Ob.rangeToUnhide?[Ob.rangeToUnhide]:Jb.ha.pa.selectedRanges;Jb=0;tb=!1;zc="";let Dc=!1;const hd=za.EwaSettings.sXb();hd&&(zc=Nb.a(Qa.command),tb=1<Ob.length?!0:
!1);for(var gb of Ob){if(hd&&this.RTb){var gc=this.grid.za.nY(gb);this.RTb.Pod(gc,zc)}if(-706918724===Jc||369708605===Jc)gc=gb.right-gb.left+1,Jb+=0<gc?gc:-1*gc;else if(1542466017===Jc||1051390410===Jc)Dc=!0,Jb+=gb.bottom-gb.top+1}hd&&this.RTb&&(this.RTb.u4e(Jb,zc),this.RTb.v3e(zc,Dc,Jb,Ob[0],Qa.command));if(369708605===Jc||1542466017===Jc){if(Oa.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${Jb}, isDiscontinuous=${tb}`),za.EwaSettings.isChangeGateEnabled("OfficeVSO:8373854_LogUnhideButtonClickOnNoHiddenRangePresent")){Jb=
gb=!1;tb=this.grid.jj;for(od of Ob)if(gb=od.isRow&&tb.Apb(od),Jb=od.hk&&tb.oob(od),gb||Jb)break;gb||Jb||Oa.ULS.sendTraceTag(508061769,0,50,"ResizeCommandHandler.doResize: unhide Rows/Columns clicked when no hidden range in selected range")}}else-706918724!==Jc&&1051390410!==Jc||Oa.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${Jb}, isDiscontinuous=${tb}`);Jc=369708605===Jc||1542466017===Jc?-2:0;od={};od.SheetMultiRange=oc.t(Ob,this.$);if(zb)for(dd of od.SheetMultiRange.Ranges)dd.FirstRow=
0,dd.LastRow=0;else for(const xd of od.SheetMultiRange.Ranges)xd.FirstColumn=0,xd.LastColumn=0;od.RowHeight=zb?-1:Jc;od.ColumnWidth=zb?Jc:-1}zb=this.zii(od,Qa,Ta,zb);break;case 957527587:case 2040891415:za.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===Qa.tabName&&wc.b("HomeTabFormat"),new $b(this.$,Qa)}return zb}Ei(Ta,Qa,Ob,Jb){if(Ta=!!Ob&&!!Jb&&1===Jb.sM)switch(Qa.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:Ta=!1}return Ta}dj(){return!1}JBj(Ta){Oa.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(cc.c)(Ta)}. Reason: ${Object(cc.c)(Ta)?void 0:Ta.reason}.`)}Sj(Ta){return(new yb.a(this.$.sa)).Sj(Ta)}gii(Ta,Qa,Ob){const Jb=this.$.oa.ta.Wh(),Jc=0===Ta,zb=()=>new Gb(Jc,Qa);return aa.a(this.$.userOperationManager,(tb,zc,dd)=>{var od=this.$.oa.ta;tb=ac.c(tb,this.KQj);var gb={Djj:!Jc,ntd:Qa};const gc=od.Za(41,Jb);gc.isRow=Jc;gc.autoFitRanges=
Qa;return Ic.h(od,"AutoFit",gc,tb,zc,dd,gb,0)},tb=>new rc.a(135,0,tb,void 0,zb),Ob)}zii(Ta,Qa,Ob,Jb){const Jc=Qa.command,zb=bb.f(this.$),tb=oc.h(Ta.SheetMultiRange.Ranges);if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var zc=-706918724===Jc||-445963340===Jc&&0===Ta.ColumnWidth,dd=zb.jj;if((1051390410===Jc||745189930===Jc&&0===Ta.RowHeight||zc)&&!dd.Tdf(tb,!Jb))return this.khi(Jb),Fb.TaskExtensions.Yq()}let od;zc=(za.EwaSettings.Sob()||za.EwaSettings.n2a())&&-706918724===
Jc;dd=za.EwaSettings.wIc()&&1051390410===Jc;let gb=void 0;if(745189930===Jc||-445963340===Jc||zc||dd)Oa.ULS.shipAssertTag(537154002,0,this.$.activeItemName===Ta.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),zc||dd?(this.gridInstantaneousAction.Nhe(),gb=()=>{zb.tk.Pza();this.gridInstantaneousAction.Xsd(Jc,!Jb)},za.EwaSettings.cJc()||Object(Yc.e)(()=>{gb()},this.$.ya,0)):(od=this.xk.pue(zb,tb,Jb?Ta.ColumnWidth:Ta.RowHeight,!Jb),this.JBj(od),Object(cc.c)(od)&&
zb.tk.HT(Ob,Wa.BasicTelemetryCalculator.nS));const gc=this.$.oa.ta.Wh({Oza:!0,rya:3});zc=(hd,xd,fd)=>{this.$.eD();oc.j(tb,",",this.$,!1);return Tc(this.$.oa.ta,Ta,ac.c(hd,this.t_j),xd,za.EwaSettings.cJc()?ac.a(fd,()=>{window.setTimeout(()=>{gb&&gb()},0)}):fd,Ob,gc)};const Dc=()=>new Ub(Ta);return od&&Object(cc.c)(od)?aa.a(this.$.userOperationManager,zc,hd=>new rc.a(136,0,hd,64,Dc),Qa):aa.a(this.$.userOperationManager,zc,hd=>new rc.a(136,0,hd,void 0,Dc),Qa)}khi(Ta){Ta=Vc.a.nj(1,0,Ta?769:771,Ta?770:
772,0,Ta?-2037763134:503471870,Ta?"HideAllColumnsError":"HideAllRowsError");new wd.a(this.$,Ta)}};Ya=Object(jb.__decorate)([Object(Ja.d)(rb.wf),Object(jb.__param)(0,Object(rb.Ob)()),Object(jb.__param)(1,Object(rb.zc)()),Object(jb.__param)(2,Object(rb.id)()),Object(jb.__param)(3,Object(rb.bd)())],Ya);Object(Sa.a)(Ya,"ResizeCommandHandler",null,[36]);var ob=a(601),Cb=a(9),Wb=a(432),ad=a(19),$c=a(72),Ld=a(7),jd=a(30),Td=a(783),re=a(17),Nd=a(37),uc=a(6),pc=a(247),Hd=a(155),wb=a(60),Xb=a(16),Kb=a(70),
Zb=a(106),Oc=a(328),Cd=a(156),Wd=a(435),ee=a(117),he=a(177);class pe extends Zb.a{constructor(Ta,Qa){super(Qa.domElement);this.Msa=this.HJg=!1;this.gx=this.FZb=this.G9a=null;this.ame=!0;this.WJc=!1;this.qt=this.offset=0;this.vY=this.sBa=this.Zyb=null;this.w8i="headerResizeTooltip";this.j9=this.r4d=null;this.qtd=this.LTa=this.kwb=!1;this.Aug=this.wtb=Xa.a.l1a;this.Gcc=!1;this.VJc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ResizeHeaderUXModernization",!1);this.j3f=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8511759_RemoveResizeTooltip");
this.u1a=za.EwaSettings.u1a();this.aMa=za.EwaSettings.aMa();this.A6=za.EwaSettings.rV()&&za.EwaSettings.YXd();this.f_d=!1;this.Ese=!0;this.sSj=Ob=>{Ob=ee.a().xl(Ob);this.qtd&&this.I$i(Ob);if((Ob.La.type.includes("touch")||Ob.La.button===Sys.UI.MouseButton.leftButton)&&this.P2a){Kb.g(Ob.La);this.Kuf();Ob=this.wtb;var Jb=Ob!==this.qt;this.gx&&!Jb&&this.Gcc&&(this.jl.removeRowColFromModel(this.gx.RHb,this.gx.$6a),this.jl.Ora(this.grid.ha.pa.selectedRanges),this.jl.zr("HeaderResizeBehavior::onDocumentMouseUp"));
if(this.G9a&&Jb&&Ob!==Xa.a.l1a){Ob=this.grid;var Jc=this.gMf(Ob);Jb={};Jb.SheetMultiRange=oc.t(Jc,Ob.$);pe.Rqe(Jb,this.isRow,this.qt);Jc=this.gx?this.gx.RHb:-1;const zb=Jb.SheetMultiRange.Ranges[0],tb=pe.Ioa()&&0===this.qt?20:50;Oa.ULS.sendTraceTag(509694147,2,tb,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${Jc}, isResizingHiddenHeader=${this.LTa}, headerViewBlockHashCode=${this.jl.hashCode},
          rangeFirstRow=${zb.FirstRow}, rangeFirstColumn=${zb.FirstColumn}, rangeLastRow=${zb.LastRow}, rangeLastColumn=${zb.LastColumn},`);this.ymi(Jb);Ob.JZk=!0}else this.xm(null,null),this.nVc();this.Gcc=this.LTa=!1;this.u1a&&this.bsc("onDocumentMouseUp")}};this.Gmg=Ob=>{this.Msa?(this.LTa&&!this.Gcc&&(this.yzh(),this.jl.zr("HeaderResizeBehavior::onHeaderResizeChanged")),this.WJc||this.wej(),Ob=new Sys.UI.DomEvent(Ob),Ob=Td.a.create(re.a.GWa,this.domElement,Ob,2),Ob=ee.a().xl(Ob),this.Hmg(Ob.clientPoint),
this.Ese&&(this.Ese=!1,this.jl.DTg()&&(this.jl.MJh(),this.F0f=!0))):Oa.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.gx?this.gx.RHb:-1}, isRow = ${this.isRow}`)};this.Img=Ob=>{Ob=new Sys.UI.DomEvent(Ob);Ob=Td.a.create(re.a.GWa,this.domElement,Ob,2);this.sSj(Ob)};this.tWj=Ob=>{var Jb;if(pe.Ioa()&&!this.gx){Ob=!!this.jl;const Jc=null===(Jb=this.jl)||void 0===Jb?void 0:Jb.hashCode;Oa.ULS.sendTraceTag(508368662,2,
15,`HeaderResizeBehavior.onHeaderResizeTouchStart: cellBeingResized is not set and we don't know which cell needs to be resized. this.isRow=${this.isRow}, isViewBlockSet=${Ob}, this.viewBlock.hashCode=${Jc}`)}else this.jia(Ob,this.gx,!1)};this.Wy=()=>{this.nVc()};this.xm=()=>{if((3===ib.a.ph||Nd.a.Oy)&&this.grid.ha.pa.Yn){var Ob=this.grid.ha.pa.oj;if(!(!Ob.isRow&&!Ob.hk||!this.domElement||Ob.isRow&&this.isRow&&!this.jl.t1.includes(Ob.top)||Ob.hk&&!this.isRow&&!this.jl.t1.includes(Ob.left))){var Jb=
this.grid.Hl(Ob,this.jl.Lr.paneType);if(Jb){var Jc=this.isRow?Ob.bottom:Ob.right;(this.gx=this.jl.HC(oa.Range.yi(Ob.bottom,Ob.right)))?(this.j9||this.Rai(),Ob.isRow&&this.isRow?(this.LZc(!0,"onSelectionEnded"),this.j9.style.top=Jb.bottomRight.y-this.j9.offsetHeight/2+"px"):Ob.isRow||this.isRow||(this.LZc(!0,"onSelectionEnded"),Oc.c(this.j9.style,this.grid.rtl,Jb.bottomRight.x-this.j9.offsetWidth/2+"px"))):Oa.ULS.sendTraceTag(522826880,2,pe.Ioa?15:50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Jc}, is row ${this.isRow}`)}}}};
this.uZ=(Ob,Jb)=>{za.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&Oa.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Jb.sU}`);Jb.sU&&this.uLb()};this.jl=Qa;this.isRow=Qa.isRow;this.rtl=Qa.Lr.rtl;this.grid=Ta;this.sGj=this.isRow?Xa.a.p6d:Xa.a.FNc;this.r8i=Aa.a.instance.ia(436);this.A8i=Aa.a.instance.ia(435);this.u8i=Aa.a.instance.ia(437);Cd.a(this.grid.$,Ob=>{this.r4d=Ob.C0(Hd.a.Uuk,
!1)});this.grid.ha.BX(this.xm);this.grid.ha.Hla(this.Wy);this.grid.gA(this.xm);ea.a(this.grid.$).Dm.vua(this.uZ)}get P2a(){return this.Msa}get y7a(){var Ta,Qa;return null!==(Qa=null===(Ta=this.gx)||void 0===Ta?void 0:Ta.$6a)&&void 0!==Qa?Qa:-1}get Vuk(){this.tni();return pe.lwb}rWj(Ta){za.EwaSettings.tYb()&&!this.P2a&&this.Buj(Ta.$6a)&&this.jl.MZc(Ta.$6a,!1)}uWj(Ta,Qa){za.EwaSettings.tYb()&&!this.P2a&&this.jl.MZc(Ta.$6a,Qa)}jia(Ta,Qa,Ob){var Jb,Jc=new Sys.UI.DomEvent(Ta);Jc=Td.a.create(re.a.GWa,this.domElement,
Jc,2);Jc=ee.a().xl(Jc);this.Oxg(Qa,Jc.clientPoint.x,Jc.clientPoint.y,!1,Ob,Ta);this.A6&&(null===(Jb=Ja.a.lh(rb.ld))||void 0===Jb?void 0:Jb.IQf(!0));Ta=this.Iue();this.oEf(this.G9a,Ta,!0);this.kwb||(Ta=this.domElement.ownerDocument.body,Ta.addEventListener("pointermove",this.Gmg),Ta.addEventListener("pointerup",this.Img),this.kwb=!0)}qWj(Ta,Qa,Ob){this.Oxg(Qa,Ta.clientX,Ta.clientY,!0,Ob,Ta);Ta=this.grid;Qa=this.gMf(Ta);Qa=oc.t(Qa,Ta.$);this.VJc?Ta.Fh.fr([this.isRow?51:52]):Ta.Fh.fr([this.isRow?13:
14]);Ta.Fh.zja();this.nVc();Ta.$.oi(this.isRow?146338636:1391094586,ib.a.ph,30,{["autoFitRanges"]:Qa})}dispose(){this.bsc("dispose");this.grid.ha&&(this.grid.ha.JZ(this.xm),this.grid.ha.Pia(this.Wy));this.grid.dF(this.xm);ea.a(this.grid.$)&&ea.a(this.grid.$).Dm.kBa(this.uZ);this.kwb&&(this.kwb=!1);this.j9&&(pe.Ioa()?this.NFg("dispose"):(this.bsc(""),this.j9=null));this.HJg&&(Xb.DOMElementExtensions.jn(pe.lwb),pe.lwb=null);this.jl=null;super.dispose()}tni(){if(!pe.lwb){document.getElementById(pe.GJg);
this.HJg=!0;var Ta=pe.lwb=document.createElement("div");this.grid.$.frame.Bna().appendChild(Ta);Ta.id=pe.GJg;Ta.className=jd.jb;Xb.DOMElementExtensions.setVisible(Ta,!1)}}Buj(Ta){return-1<=Ta?!0:!1}Kuf(){var Ta;if(this.kwb){const Qa=this.domElement.ownerDocument.body;Qa.removeEventListener("pointermove",this.Gmg);Qa.removeEventListener("pointerup",this.Img);this.kwb=!1}this.Msa=!1;za.EwaSettings.tYb()&&this.jl.MZc(this.gx.$6a,!1);this.Zmk();Wd.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation");
this.A6&&(null===(Ta=Ja.a.lh(rb.ld))||void 0===Ta?void 0:Ta.IQf(!1))}fwk(){this.VJc?this.f_d?(this.f_d=!1,this.grid.Fh.fr(this.isRow?[49,51]:[50,52])):this.grid.Fh.fr(this.isRow?[51]:[52]):this.grid.Fh.fr([this.isRow?13:14]);this.grid.Fh.zja()}yzh(){this.jl.addRowColToModel(this.gx.RHb-1,this.gx.$6a);this.Gcc=!0}Hmg(Ta){if(this.Msa){var Qa=this.isRow,Ob=Qa?Ta.y-this.G9a.y:(this.rtl?-1:1)*(Ta.x-this.G9a.x),Jb=this.wtb;Jb!==Xa.a.l1a&&(Qa?Ta.y-this.FZb.y:(this.rtl?-1:1)*(Ta.x-this.FZb.x))&&(0<this.qt||
0<Jb+Ob)&&Jb+Ob<=this.sGj&&(this.qt=this.Iue(Ob),this.oEf(Ta,this.qt,!1),this.qt>=pe.PSf?(this.ame=!0,this.gx.setCellExtent(this.qt)):this.ame&&(this.ame=!1,this.gx.setCellExtent(pe.PSf)),Ob=this.Aug+Math.max(Ob,-this.wtb+pe.RDc),Xb.DOMElementExtensions.oAb(this.gx.jl.domElement,!Qa,Ob),this.gx.jl.dEk(Ob),this.FZb=new Sys.UI.Point(Ta.x,Ta.y),this.LZc(!1,"onHeaderResizeChangedInternal"))}}LZc(Ta,Qa){var Ob;Xb.DOMElementExtensions.setVisible(this.j9,Ta);pe.Ioa()&&Oa.ULS.sendTraceTag(508150752,2,50,
`HeaderResizeBehavior.setTouchResizerVisible: called with visible: ${Ta}. caller:${Qa} isRow: ${this.isRow}, blockHash: ${null===(Ob=this.jl)||void 0===Ob?void 0:Ob.hashCode}`)}D_a(){return this.gx?this.LTa?pe.K8i:this.gx.D_a():Xa.a.l1a}oEf(Ta,Qa,Ob){this.j3f||(this.vY&&Ob&&(Oa.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.FFg()),this.vY||Ob||Oa.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead"),
this.r4d&&this.r4d(()=>({["Location"]:"canvas"})),this.vY?this.vEf(Qa):(this.vY=document.createElement("div"),this.vY.id=this.w8i,this.vEf(Qa),this.vY.className=jd.K,Qa=document.getElementById(this.grid.$.xi+Ld.a.Ueg),Qa.insertBefore(this.vY,Qa.firstChild),Ta=ee.a().Raa(Ta),this.vY.style.left=(this.rtl?Math.max(Ta.x-this.vY.offsetWidth,0):Ta.x-Math.max(Ta.x+this.vY.offsetWidth-Qa.offsetWidth,0)).toString()+"px",Qa=document.getElementById(Ld.a.OGa),this.vY.style.top=(Ta.y-(uc.AFrameworkApplication.ra&&
uc.AFrameworkApplication.ra.$g.Zk?0:Qa.offsetHeight)-this.vY.offsetHeight).toString()+"px"))}FFg(){this.j3f||(Xb.DOMElementExtensions.jn(this.vY),this.vY=null)}vEf(Ta){var Qa=new db(this.grid.$.workbookContext.DxDigitNormal);Qa=this.isRow?Qa.xkf(Ta).toFixed(2):Qa.jkf(Ta).toFixed(2);this.vY.innerText=`${this.isRow?this.r8i:this.A8i} ${Qa} (${Ta.toString()} ${this.u8i})`}Oxg(Ta,Qa,Ob,Jb,Jc,zb){this.Msa=!0;this.LTa=Jc;this.gx=Ta;this.dag("prepareResizeOperation");this.WJc=!1;this.G9a=this.FZb=new Sys.UI.Point(Qa,
Ob);Ta=this.gx.getRange();this.sBa=Jc?this.gHh(Ta):Ta;this.wtb=this.D_a();this.Aug=this.isRow?this.gx.jl.BR:this.gx.jl.CR;this.rak(zb,Jb)}rak(Ta,Qa){const Ob={["IsResizingHiddenHeader"]:this.LTa,["IsAutoFitting"]:Qa,["NumberOfSelectedRanges"]:this.grid.ha.pa.OV,["Location"]:"canvas",["ResizeRange"]:this.sBa,["ResizedCellAbsoluteIndex"]:this.gx.RHb,["HeaderViewBlockHashCode"]:this.jl.hashCode};Cd.b(this.grid.$).sj(Hd.a.Luk,Ob);this.grid.CPk&&(Qa=Qa?"header_resize_autofit":"header_resize_start",he.b(this.grid.$).iz(Ta,
Qa,void 0));this.offset=this.gx.MKa();this.qt=this.wtb;this.qt!==Xa.a.l1a&&Wd.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal")}gHh(Ta){return this.isRow?new oa.Range(Ta.top-1,Ta.left,Ta.top-1,Ta.right,!1,!0):new oa.Range(Ta.top,Ta.left-1,Ta.bottom,Ta.left-1,!1,!0)}gMf(Ta){const Qa=this.sBa,Ob=Ta.ha.pa.selectedRanges;if(Ta.ha.pa.cPb(Qa))if(this.isRow){if(pc.a.all(Ob,Jb=>Jb.isRow))return Ob}else if(pc.a.all(Ob,Jb=>Jb.hk))return Ob;return[Qa]}Iue(Ta){Ta=void 0===Ta?0:Ta;const Qa=
this.grid;var Ob=this.jl.Lr.paneType;var Jb=this.isRow?3===Ob?[3,2]:[1,4]:4===Ob?[2,4]:[1,3];const Jc=Math.max(Math.max(this.wtb,0)+Ta,0);this.VJc?0===Ta?Ta=[this.isRow?51:52]:(this.f_d=!0,Ta=[this.isRow?49:50]):Ta=[this.isRow?13:14];Qa.Fh.wt(new oa.Range(1,1,Xa.a.Ok,Xa.a.Ak,!1,!0),Ta,!1);if(this.aMa){Ob=new Map;for(var zb of Jb)Jb=Qa.ol(zb),Jb=this.isRow?new $c.a(Jb.Zr.topLeft.x,this.offset,Jb.bI.x,Jc):new $c.a(this.offset,Jb.Zr.topLeft.y,Jc,Jb.bI.y),Ob.set(zb,Jb);Qa.Fh.Qw(Ta,null,null,!1,!0,Ob)}else zb=
Qa.RQi(Ob,this.isRow),zb=this.isRow?new $c.a(0,this.offset,zb,Jc):new $c.a(this.offset,0,Jc,zb),Qa.Fh.Qw(Ta,zb,Jb);return Jc}bsc(Ta){this.sBa=this.G9a=this.FZb=null;if(this.Zyb){const Qa=this.Zyb.parentNode;if(Qa)for(Qa.removeChild(this.Zyb);this.Zyb.firstChild;)Qa.appendChild(this.Zyb.firstChild);this.Zyb=null}pe.Ioa()?this.gx&&(this.gx=null,this.dag("clearResizeState::"+Ta)):this.gx=null;this.Ese=!0;this.Msa=!1}Zmk(){this.WJc=!1;this.FFg();this.F0f&&(this.jl.zmk(),this.F0f=!1);Xb.DOMElementExtensions.setVisible(pe.lwb,
!1);this.LZc(!1,"removeResizeArtifacts");this.fwk()}wej(){this.WJc=!0;const Ta=this.Vuk;Xb.DOMElementExtensions.setVisible(Ta,!0);Ta.style.cursor=this.VJc?this.isRow?"ns-resize":"ew-resize":this.isRow?jd.lb:jd.g;this.Iue()}ymi(Ta){this.grid.$.oi(this.isRow?745189930:-445963340,ib.a.ph,30,{["resizeRowColumnParameters"]:Ta})}Rai(){const Ta=document.createElement("div");Ta.className=jd.pb;const Qa=document.createElement("div");Qa.className=ad.a.d5;Ta.appendChild(Qa);const Ob=document.createElement("img");
Ob.src=wb.a.Gn(0);Ob.className=this.isRow?ad.a.xqi:ad.a.wqi;Qa.appendChild(Ob);this.jl.LF.domElement.parentNode.insertBefore(Ta,this.jl.LF.domElement);Ta.addEventListener("pointerdown",this.tWj);Xb.DOMElementExtensions.setVisible(Ta,!1);this.j9=Ta}dag(Ta){pe.Ioa()&&!this.gx&&Oa.ULS.sendTraceTag(508368661,2,20,`HeaderResizeBehavior.logUndefinedCellBeingResized: Cell being resized is undefined. caller: ${Ta}`)}nVc(){pe.Ioa()&&!this.gx||this.bsc("removeResizer");this.NFg("removeResizer")}NFg(Ta){var Qa,
Ob,Jb,Jc;if(this.j9){const zb=null===(Jb=null===(Ob=null===(Qa=this.jl)||void 0===Qa?void 0:Qa.LF)||void 0===Ob?void 0:Ob.domElement)||void 0===Jb?void 0:Jb.parentNode;pe.Ioa()&&zb?zb.removeChild(this.j9):this.jl.LF.domElement.parentNode.removeChild(this.j9);this.j9=null;pe.Ioa()&&Oa.ULS.sendTraceTag(508150751,2,50,`HeaderResizeBehavior.removeTouchResizer: Touch resized removed. Was called from caller:${Ta}.isRow: ${this.isRow}, blockHash: ${null===(Jc=this.jl)||void 0===Jc?void 0:Jc.hashCode}, is flowContainer define: ${!!zb}`)}}uLb(){this.Msa&&
(this.Hmg(this.G9a),this.Kuf(),this.nVc(),this.Gcc=this.LTa=!1)}I$i(Ta){(Ta=Ta.La.rawEvent)&&Ta.detail===pe.uAk&&(Ta.type===re.a.Ty?(this.Msa=!1,this.qtd=!0):Ta.type===re.a.LS&&(this.Msa=!0,this.qtd=!1))}static S7h(Ta,Qa){return new pe(Ta,Qa)}static Rqe(Ta,Qa,Ob){if(Qa){Ta.ColumnWidth=-1;Ta.RowHeight=Ob;for(const Jb of Ta.SheetMultiRange.Ranges)Jb.FirstColumn=0,Jb.LastColumn=0}else{Ta.RowHeight=-1;Ta.ColumnWidth=Ob;for(const Jb of Ta.SheetMultiRange.Ranges)Jb.FirstRow=0,Jb.LastRow=0}}static Ioa(){return za.EwaSettings.isChangeGateEnabled("OfficeVSO:8257683_JSCrash_during_touch_resizeV2")}}
pe.RDc=1;pe.PSf=1;pe.K8i=0;pe.GJg="ewa-rszrbg";pe.uAk=2;pe.lwb=null;Object(Sa.a)(pe,"HeaderResizeBehavior",Zb.a,[895]);class Se extends Wb.a{constructor(){super();this.sn()}create(){this.dl(pe.S7h)}static Ga(Ta){Ta.qa.Rh(136,new Se)}}Object(Sa.a)(Se,"HeaderResizeBehaviorFactory",Wb.a,[]);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8851896_MigrateRemoveDuplicates_AND_ResizeCSS")?a(1511):ob.a.Jy(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");
(()=>{Cb.a.hh(Ta=>{Se.Ga(Ta)})})();String(Na);String(cb);window.___1712031311703_closurehack=Na;window.___1712031311703_closurehack=cb}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/869cdef49119a572ccacb30ca3b3f7a1/EwaTS.rsz.js.map