'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1336:function(y,m,a){m=a(492);a=a(1522);a=a.$q?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1520:function(y,m,a){m=a(492);a=a(1521);a=a.$q?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1521:function(y,m,a){m=a(493)(!1);m.push([y.i,".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}",
""]);y.exports=m},1522:function(y,m,a){m=a(493)(!1);m.push([y.i,".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}",
""]);y.exports=m},1523:function(y,m,a){(function(c){a.d(m,"a",function(){return O});var b=a(0),e=a(15),k=a(191),d=a(154),u=a(1524),n=a(41),v=a(288),f=a(46),w=a(431),r=a(216),t=a(64),l=a(84),x=a(12),A=a(23),z=a(47),F=a(1525),D=a(1),G=a(101),Q=a(5);class O extends n.a{constructor(J,H,N,L){super();this.Y$i=u.a.getTypeName();this.gVb=this.f5=this.Nh=null;this.imageHeight=this.imageWidth=0;this.Z0a=this.errorMessage=this.tableData=null;this.tTd=0;this.Mnd=!1;this.Fof=Z=>{if(Z){var ba={};if((()=>{let U=
z.d(this.Xci(Z.data));({Fz:ba}=U);return U})().returnValue){var K=Object(d.a)(Object,ba);if("."===K.DataFromPictureWildcard)if(K.SessionId!==this.Z0a)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),K.CmdType){case "ACK":this.Mnd=
!0;this.G0g.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.TBk();0<this.errorMessage.length?this.jOg():0<this.tableData.length&&this.COg();break;case "insert_html":const U=this.$.oa.ta,X={};var E=A.f(this.$).ha.pa.oj.clone();X.PasteId=k.a.create().toString();X.DestinationRanges=f.u(f.x(E,this.$));E=K.Parameters.split("|",3);D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${E[0]}|${E[1]}|${E[2]}.`);E=K.Parameters.indexOf("|");E=K.Parameters.indexOf("|",E+1);E=K.Parameters.indexOf("|",E+1);X.SourceHtml=K.Parameters.substring(E+1);X.CopyOperationId=null;const ia=U.Za(1,U.Wh());ia.pasteHtmlParameters=X;w.a(this.$.userOperationManager,(Ma,qa,Ha)=>t.h(U,"pasteHtmlContent",ia,Ma,qa,Ha,null,64),Ma=>new r.a(204,0,Ma,1),null);this.tTd++;e.ULS.sendTraceTag(523805135,
0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.tTd.toString()}`);G.b("DataFromPictureCompleted")}}}};this.X$i=(Z,ba)=>{if(Z=ba.annotation)if(!ba.parentPath||1>=ba.parentPath.length||ba.parentPath[1]!==this.Z0a)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");
ba=Z.errorCode;switch(ba){case null:case -1:this.errorMessage=x.a.instance.ia(2273);break;case 1:this.errorMessage=x.a.instance.ia(2274);break;case 2:this.errorMessage=x.a.instance.ia(2275)}0<this.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${ba?ba.toString():"null"}.`);this.k8e.stop();this.tableData=Z.html;this.Mnd&&(0<this.errorMessage.length?this.jOg():0<this.tableData.length&&this.COg())}else e.ULS.sendTraceTag(523805125,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=J;this.ddaFacade=L;this.$o=H;this.uploaderCreator=N;this.initialize()}dispose(){window.removeEventListener("message",this.Fof,!1);this.$o.unregister("DataFromPicture");super.dispose()}s1j(J,H){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let N=new Image;N.onload=()=>{var L=document.createElement("canvas");L.width=N.width;L.height=N.height;const Z=
L.getContext("2d");try{Z.drawImage(N,0,0,N.width,N.height)}catch(E){e.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${E.message}`);return}let ba;try{ba=L.toDataURL("image/jpeg")}catch(E){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${E.message}`);return}L=ba.split(",");if(2>L.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{L=L[1];try{var K=window.self.atob(L)}catch(E){e.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${E.message}`);return}28E5<K.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),H.fRk()):(this.zxk(this.Nh,this.f5,L,N.width,N.height),URL.revokeObjectURL(N.src),N=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
N.src=J}hak(J,H,N,L){this.Nh=J;this.f5=L;this.uploaderCreator.mdj(this.$,H,N,L,this)}zxk(J,H,N,L,Z){this.Z0a=k.a.create().toString();this.tTd=0;this.gVb=N;this.imageWidth=L;this.imageHeight=Z;this.errorMessage=this.tableData="";this.Mnd=!1;this.G0g=this.$.Eh.wm("LoadResource","DataFromPictureTaskpaneLaunch");this.G0g.start();this.b4j(J,H);this.k8e=this.$.Eh.wm("LoadResource","DataFromPictureAnnotation");this.k8e.start();this.Dcl()}Dcl(){if(this.gVb.length){var J=window.self.atob(this.gVb),H=new Uint8Array(J.length);
for(let N=0;N<J.length;N++)H[N]=J.charCodeAt(N);this.$o.Ccl(H,this.Z0a,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}b4j(J,H){H.SessionID=this.Z0a;H.DataFromPictureAssetId="FA000000050";H.LoadDataFromPictureTaskpane=!0;J=new l.a(-859308420,J.method,J.mode,J.jk,J.tabName);this.$.Ia.qh(J,H)}SEd(J){try{const H=c.from(J,"utf16le").toString("base64");return F.a.WXa(this.Z0a,H)}catch(H){return e.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Xci(J){try{const H=F.a.WXa(this.Z0a,J);return c.from(H,"base64").toString("utf16le")}catch(H){return e.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}TBk(){if(this.gVb.length){var J=Q.yb.Ma()?this.ddaFacade.a6("FA000000050"):v.a(this.$).a6("FA000000050"),H={["DataFromPictureWildcard"]:"."};H.imageData=this.SEd(this.gVb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(J,
"onCustomMessage",H,N=>{N&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}COg(){if(this.tableData.length){var J=Q.yb.Ma()?this.ddaFacade.a6("FA000000050"):v.a(this.$).a6("FA000000050"),H={["DataFromPictureWildcard"]:"."};H.tableHtml=this.SEd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(J,
"onCustomMessage",H,N=>{N&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}jOg(){if(this.errorMessage.length){var J=Q.yb.Ma()?this.ddaFacade.a6("FA000000050"):v.a(this.$).a6("FA000000050"),H={["DataFromPictureWildcard"]:"."};H.errorMessage=this.SEd(this.errorMessage);
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(J,"onCustomMessage",H,N=>{N&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.Fof,!1);this.$o.register(this.$o.k6().I8("DataFromPicture").H8(()=>
{}).activateAnnotation({annotationType:this.Y$i,EA:!1,NV:this.X$i}).build())}}Object(b.a)(O,"DataFromPictureManager",n.a,[918])}).call(this,a(793).Buffer)},1524:function(y,m,a){a.d(m,"a",function(){return b});y=a(0);m=a(956);var c=a(932);class b extends m.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.getBaseTypes()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(y.a)(b,"DetectedHtmlTableAnnotation",m.a,[])},1525:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{static WXa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const k=Array(256),d=Array(256);let u,n=0,v=0;let f,w="";for(u=0;256>u;u++)k[u]=u;for(u=0;256>u;u++){var r=b.charCodeAt(u%b.length);if(256<=r)return"";n=(n+k[u]+r)%256;r=k[u];k[u]=k[n];k[n]=r}for(u=0;256>u;u++)d[u]=k[256-u-1];n=u=0;for(b=0;b<e.length;b++){u=(u+1)%256;n=(n+k[u])%256;r=k[u];k[u]=k[n];k[n]=r;r=e.charCodeAt(b);
if(256<=r)return"";f=r^k[(k[u]+k[n])%256];v=(v+d[u])%256;r=d[u];d[u]=d[v];d[v]=r;w+=String.fromCharCode(f^k[(d[u]+d[v])%256])}return w}}Object(y.a)(c,"RC4A",null,[])},188:function(y,m,a){function c(C,Ca){if(!Ca)return C;Ca=Ca.sheet;if(!Ca)return C;Ca=Ca.cssRules;if(!Ca)return C;var qb=Array.clone(Ca);qb.reverse();let nc=Ca=0,Rc=0,id=0;for(const Fd of qb){qb=Fd.style;var sd=Fd.selectorText;qb=qb?qb.cssText:null;sd=sd?sd.split(","):null;if(qb&&sd&&Fd.type===Fd.STYLE_RULE){id+=sd.length;for(const S of sd){0<=
S.indexOf("#")&&Ca++;0<=S.indexOf(".")&&nc++;0>S.indexOf("#")&&0>S.indexOf(".")&&Rc++;sd=null;try{sd=C.querySelectorAll(S)}catch(Ua){E.ULS.sendTraceTag(507536148,0,50,"Exception in querySelectorAll: {0}",Ua.message)}if(sd)for(let Ua=0;Ua<sd.length;Ua++)sd[Ua].setAttribute("style",qb+(sd[Ua].getAttribute("style")||""))}}}E.ULS.sendTraceTag(507536147,0,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",id,Ca,nc,Rc);return C}function b(C){if(void 0===C||-1===
C.indexOf("px"))return 0;C=C.match(dh);let Ca=11;C&&(1===C.length?Ca=parseFloat(C[0]):3===C.length&&(Ca=parseFloat(C[1])));return wd.HelperMethods.HSc(Ca)}function e(C){const Ca=[];if("none"!==C.borderTopStyle&&""!==C.borderTopStyle){var qb=b(C.borderTopWidth);Ca.push({BorderLineStyle:k(C.borderTopStyle,qb),BorderPosition:0,Weight:qb,Color:d(C.borderTopColor)})}"none"!==C.borderBottomStyle&&""!==C.borderBottomStyle&&(qb=b(C.borderBottomWidth),Ca.push({BorderLineStyle:k(C.borderTopStyle,qb),BorderPosition:1,
Weight:qb,Color:d(C.borderBottomColor)}));"none"!==C.borderLeftStyle&&""!==C.borderLeftStyle&&(qb=b(C.borderLeftWidth),Ca.push({BorderLineStyle:k(C.borderTopStyle,qb),BorderPosition:2,Weight:qb,Color:d(C.borderLeftColor)}));"none"!==C.borderRightStyle&&""!==C.borderRightStyle&&(qb=b(C.borderRightWidth),Ca.push({BorderLineStyle:k(C.borderTopStyle,qb),BorderPosition:3,Weight:qb,Color:d(C.borderRightColor)}));return Ca}function k(C,Ca){switch(C){case "solid":return 1>Ca?1:1.5>Ca?2:5;case "dashed":return 1>
Ca?3:8;case "double":return 6;case "dotted":return 4;case "dotDash":return 10;case "dotDotDash":return 1>Ca?12:10;case "dotDashSlanted":return 13;case "triple":return 6;case "hairline":return 7;default:return 0}}function d(C){const Ca={};if(void 0===C||""===C)return Ca.Red=0,Ca.Green=0,Ca.Blue=0,Ca;Ma.a.compare(C,"windowtext",!0)?(C=be.a.Pu(C),Ca.Red=C.r,Ca.Green=C.g,Ca.Blue=C.b):(Ca.Red=0,Ca.Green=0,Ca.Blue=0);return Ca}function u(C){C=be.a.Pu(C);return be.a.JJ(C)}function n(C,Ca,qb,nc,Rc){try{if(Ca&&
C.parentElement){qb.fontFamily="Aptos Narrow";if(Rc.map(Fd=>Fd.DHa.fontFamily).some(Fd=>Fd)&&Ca.fontFamily){const Fd=Ca.fontFamily.replace(/['"]+/g,"").split(",");0<Fd.length&&(Sf.hasOwnProperty(Fd[0])?qb.fontFamily=Sf[Fd[0]]:qb.fontFamily=Fd[0])}qb.fontSize=11;const id=Rc.map(Fd=>Fd.DHa.fontSize),sd=Rc.map(Fd=>Fd.element.tagName);(id.some(Fd=>Fd)||sd.some(Fd=>Bg.includes(Fd)))&&Ca.fontSize&&(qb.fontSize=Math.round(b(Ca.fontSize)));Ca.fontWeight&&700<=parseInt(Ca.fontWeight,10)&&(qb.bold=!0);qb.borders=
e(Ca);Ca.textDecoration&&"underline"===Ca.e1g&&("solid"===Ca.f1g?qb.$xe=1:"double"===Ca.f1g&&(qb.$xe=2));Ca.textDecoration&&"line-through"===Ca.e1g&&(qb.DCf=!0);qb.color="#000000";Rc.map(Fd=>Fd.DHa.color).some(Fd=>Fd)&&Ca.color&&(qb.color=u(Ca.color));if(nc){const Fd=C.parentElement.closest("td,th");qb.backgroundColor=Fd.style.backgroundColor?u(Fd.style.backgroundColor):""}if("italic"===Ca.fontStyle||"oblique"===Ca.fontStyle)qb.italic=!0}}catch(id){E.ULS.sendTraceTag(507377813,0,10,"CssStyleProcessor.setHtmlCellStyle: Error while setting cell style",
id)}return qb}a.r(m);var v={};a.r(v);a.d(v,"FocusBasedReadout",function(){return Oa});var f={};a.r(f);a.d(f,"AriaLiveNotifier",function(){return za});var w={};a.r(w);a.d(w,"DataFromPictureCommandHandler",function(){return Y});var r={};a.r(r);a.d(r,"EmbeddedWorkbookReadoutHandler",function(){return $a});var t={};a.r(t);a.d(t,"EwaAccessibilityManager",function(){return Qb});var l={};a.r(l);a.d(l,"GridHighlightBehaviorEventManager",function(){return Wa});var x={};a.r(x);a.d(x,"GridHighlightsBehaviorManager",
function(){return Hf});var A={};a.r(A);a.d(A,"PictureCommandHandler",function(){return He});var z={};a.r(z);a.d(z,"PasteIndicationManager",function(){return Lf});var F={};a.r(F);a.d(F,"PasteShortcutManager",function(){return vf});var D={};a.r(D);a.d(D,"SelectionReadoutHandler",function(){return ma});var G={};a.r(G);a.d(G,"SessionReloadActivity",function(){return pb});var Q={};a.r(Q);a.d(Q,"SessionReloadSilentActivity",function(){return T});var O={};a.r(O);a.d(O,"SparklineManager",function(){return Db});
var J={};a.r(J);a.d(J,"TableManager",function(){return Kf});var H={};a.r(H);a.d(H,"UploaderCreator",function(){return Nf});var N={};a.r(N);a.d(N,"WorkbookReadoutHandler",function(){return fg});var L={};a.r(L);a.d(L,"HtmlProcessor",function(){return lc});var Z={};a.r(Z);a.d(Z,"PastableIframe",function(){return md});var ba=a(127),K=a(0),E=a(15),U=a(30),X=a(7),ia=a(16),Ma=a(28),qa=a(12),Ha=a(441),ha=a(23),La=a(34);class fa{constructor(C){this.zXc=C||""}static get fuf(){return fa.DMe||(fa.DMe=new fa(""))}static get P4d(){return fa.kTe||
(fa.kTe=fa.Dga(2).zXc)}static $wa(C){C=La.a.Vr(C||"");return new fa(C)}static xRb(C){return fa.$wa(qa.a.instance.ia(C))}static Dga(C){return new fa(qa.a.instance.Aa(C))}static sDf(C,...Ca){return fa.xBi(qa.a.instance.sh(C),...Ca)}static xBi(C,...Ca){const qb=Ca.length,nc=Array(qb);for(let Rc=0;Rc<qb;Rc++)nc[Rc]=(Ca[Rc]||fa.fuf).zXc;return new fa(String.format(C,nc))}}fa.DMe=null;fa.kTe=null;Object(K.a)(fa,"SafeHtml",null,[240]);const ja=(C,Ca)=>{Ca&&(C.append(Ca),C.append(fa.P4d))};var ta=a(1),Ka=
a(183),Ga=a(130),Na=a(163),cb=a(102),jb=a(973),Sa=a(37),bb=a(250),oa=a(5),ka=a(92),ya;let Oa=ya=class{constructor(C,Ca,qb){this.Gca=this.C2=this.ZV=null;this.Vwa=oa.wc.Ma()?Ca.cellTextEditBox.Xa.dm:qb;this.w$h(C);this.aak()}get isActive(){return!!this.Vwa&&document.activeElement===this.Vwa}readText(C){C=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?C:String.format(qa.a.instance.sh(30),C);this.ZV.setAttribute(X.a.wD,C);this.C2.setAttribute(X.a.wD,
C);this.BZk()}dispose(){this.Gca&&this.Gca.parentNode&&this.Gca.parentNode.removeChild(this.Gca);this.C2=this.ZV=this.Gca=this.Vwa=null}w$h(C){var Ca=C.xi+"readoutElementWrapper";const qb=C.xi+"readoutElement1",nc=C.xi+"readoutElement2";this.Gca=document.getElementById(Ca);this.Gca||(this.Gca=document.createElement(bb.a.div),this.Gca.id=Ca,this.ZV=document.createElement(bb.a.label),this.ZV.id=qb,this.ZV.setAttribute(X.a.fk,X.a.qpc),this.ZV.setAttribute("aria-roledescription",""),this.ZV.setAttribute("aria-multiline",
!1),this.C2=document.createElement(bb.a.label),this.C2.id=nc,this.C2.setAttribute(X.a.fk,X.a.qpc),this.C2.setAttribute("aria-roledescription",""),this.C2.setAttribute("aria-multiline",!1),this.ZV.style.width="0px",this.ZV.style.height="0px",this.C2.style.width="0px",this.C2.style.height="0px",this.ZV.tabIndex=-1,this.C2.tabIndex=-1,this.Gca.appendChild(this.ZV),this.Gca.appendChild(this.C2),C=C.xi+X.a.ltc,Ca=document.getElementById(C),E.ULS.shipAssertTag(537153942,3,!!Ca,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${C}`),
Ca&&Ca.appendChild(this.Gca))}aak(){this.Vwa&&this.ZV&&this.C2&&(this.Vwa.setAttribute(X.a.ffa,this.ZV.id),this.Vwa.setAttribute(X.a.ppc,`${this.ZV.id} ${this.C2.id}`))}BZk(){if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.isActive){let C="";ia.DOMElementExtensions.hasAttribute(this.Vwa,X.a.ffa)&&(C=this.Vwa.getAttribute(X.a.ffa).toString());this.Vwa.setAttribute(X.a.ffa,C===this.ZV.id?this.C2.id:this.ZV.id)}this.isActive||E.ULS.sendTraceTag(537153941,
0,50,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static Kob(){if(null==ya.hRb)if(Sa.a.Ooa){if(ya.hRb=!1,Sa.a.IP||Sa.a.Cm)ya.hRb=!0}else ya.hRb=!0;return ya.hRb}};Oa.hRb=null;Oa=ya=Object(ba.__decorate)([Object(ka.d)(oa.wc),Object(ba.__param)(0,Object(oa.Ob)()),Object(ba.__param)(1,Object(oa.kd)())],Oa);Object(K.a)(Oa,"FocusBasedReadout",null,[215,2]);let za=class{constructor(C,Ca,qb,nc){qb=void 0===qb?C.wK:qb;nc=void 0===nc?C.Dl:nc;this.fOg=()=>{this.$.fa.ki||Ka.a.sendTelemetryEvent({name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",
dataFields:Ga.a.xn({["AriaLiveOffCount"]:this.DIe,["AriaLivePoliteCount"]:this.EIe,["AriaLiveAssertiveCount"]:this.CIe,["AriaLiveRudeCount"]:this.FIe,["ScreenReaderDivCount"]:this.GYe,["AlertScreenReaderDivCount"]:this.mIe,["AuxScreenReaderDivCount"]:this.NIe,["AriaAlertCount"]:this.AIe,["ReadCommandOnCompletionCount"]:this.kXe,["TotalAriaLiveRegionUpdates"]:this.t0e})})};this.$=C;this.Bi=void 0===Ca?null:Ca;this.nka=document.createElement("div");this.nka.setAttribute(X.a.gfa,X.a.Kr);this.nka.className=
U.J;qb.insertBefore(this.nka,nc);this.pla=document.createElement("div");this.pla.setAttribute(X.a.gfa,X.a.Kr);this.pla.className=U.J;qb.insertBefore(this.pla,this.nka);this.rqh=qa.a.instance.Aa(2);this.jfa=document.createElement("div");this.jfa.setAttribute(X.a.fk,X.a.Kua);this.jfa.setAttribute(X.a.Lua,X.a.TGa);this.jfa.className=U.J;qb.insertBefore(this.jfa,this.pla);this.t0e=this.kXe=this.AIe=this.NIe=this.mIe=this.GYe=this.FIe=this.CIe=this.EIe=this.DIe=0;this.register();ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)||this.$.qa.Rh(211,this)}get Z3a(){return this.rqh}get isActive(){return!0}get LHh(){return this.nka}get Ezk(){return this.pla}get activeCell(){return ha.f(this.$).yh(null)}dispose(){this.$&&this.unregister();ia.DOMElementExtensions.jn(this.jfa);ia.DOMElementExtensions.jn(this.nka);ia.DOMElementExtensions.jn(this.pla);this.pla=this.nka=this.jfa=this.$=null}setEnabled(C){this.WPg(this.pla,C)}sFk(){this.WPg(this.nka,!0)}readText(C){this.b5b(fa.$wa(C),!0)}Fca(C){this.b5b(fa.$wa(C),!1)}pCg(C,Ca){if(1>
Ca||!C)E.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var qb=new Sys.StringBuilder;C=String.format(qa.a.instance.sh(34),Ca,C);ja(qb,C);ja(qb,qa.a.instance.ia(857));this.b5b(fa.$wa(qb.toString()),!1)}}Dgk(C,Ca,qb){if(1>qb||1>Ca||Ca>qb||!C)E.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var nc=new Sys.StringBuilder;ja(nc,C);nc.append(String.format(qa.a.instance.sh(55),Ca,qb));this.b5b(fa.$wa(nc.toString()),!1)}}Bgk(C){C=this.uWi(C);this.b5b(C,
!1,!0)}b5b(C,Ca,qb){qb=void 0===qb?!1:qb;if(C=C?C.zXc:null)Ca=Ca?this.pla:this.nka,Ma.a.equals(Ca.innerHTML,C,!1)&&(C+=fa.P4d),this.Q2g(Ca,qb),this.Bi.hr(Ca,C)}TOa(C,Ca){this.jfa.getAttribute(X.a.Lua)!==Ca&&this.jfa.setAttribute(X.a.Lua,Ca);C=C?fa.$wa(C).zXc:"";this.Q2g(this.jfa);this.Bi.hr(this.jfa,C)}Egk(C,Ca,qb,nc){var Rc=!0;Rc=void 0===Rc?!1:Rc;const id=qa.a.instance.sh(54);E.ULS.shipAssertTag(537153949,0,!(void 0===C||null===C));E.ULS.shipAssertTag(537153948,0,!(void 0===Ca||null===Ca));E.ULS.shipAssertTag(537153947,
0,!(void 0===qb||null===qb));E.ULS.shipAssertTag(537153946,0,!(void 0===nc||null===nc));E.ULS.shipAssertTag(537153945,0,!(void 0===id||null===id));C=String.format(id,C||"",Ca||"",qb||"",nc||"");Rc?this.TOa(C,X.a.UGa):this.readText(C)}M8k(C){var Ca=this.pla.style;C?(C=Ha.a.DRh(C.cell,Ca),Ca=C.jE,Ca.top=Ca.left=Ca.bottom=Ca.right=null,C.J4()):Ca.cssText=""}uWi(C){if(6!==C.jk)return null;const Ca=this.activeCell;if(!Ca)return null;switch(C.command){case -1985798686:return fa.xRb(12);case -911352779:return fa.xRb(11);
case 237279923:return fa.xRb(13);case -1502853784:return fa.Dga(81);case -111689794:return fa.Dga(78);case 368460465:C=ha.f(this.$).oh.Ml(Ca.range,!0);if(null!==C)return this.W_a(2291,!C.hasAutoFilter,!1);C=this.$.sa.la;if(!C)break;return this.W_a(2291,null===C.AL,!1);case -1522760979:return this.W_a(1150,ha.f(this.$).isFormulaView,!1);case 1941920197:return fa.xRb(836);case 1051390410:return fa.Dga(589);case 1542466017:return fa.Dga(591);case -706918724:return fa.Dga(590);case 369708605:return fa.Dga(592);
case -1215659745:return fa.Dga(523);case 1783960667:return fa.Dga(521);case -1355155015:return fa.Dga(554);case -1158102843:return fa.Dga(522);case -287251124:return C=this.eIc(C.command,Ca),null===C?null:this.W_a(1333,C);case -1925065947:return C=this.eIc(C.command,Ca),null===C?null:this.W_a(1334,C);case 1764140053:return C=this.eIc(C.command,Ca),null===C?null:this.W_a(1335,C);case -1590502662:return C=this.eIc(C.command,Ca),null===C?null:this.W_a(1336,C);case 862890474:case 963349338:C=this.lKa(Ca);
if(null===C)break;C=fa.$wa(String(C));return fa.sDf(214,C);case 1896159024:return fa.$wa(qa.a.instance.sh(228));case -1554384558:return fa.$wa(qa.a.instance.sh(229))}return null}register(){E.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(E.ULS.shipAssertTag(537153943,0,!!this.$.Ia,"Can't register to CommandHandlerManager's event"),this.$.fa&&this.$.fa.mK(this.fOg))}unregister(){this.$&&this.$.fa.nL(this.fOg)}WPg(C,Ca){const qb=C===this.nka;Ca?(qb&&Oa.Kob()||
C.setAttribute(X.a.Lua,X.a.UGa),qb&&C.setAttribute(X.a.fk,X.a.Kua),C.setAttribute(X.a.gfa,X.a.qC),C.removeAttribute(X.a.gfa),this.Bi.hr(C,C.innerHTML+" ")):(C.removeAttribute(X.a.Lua),qb&&C.removeAttribute(X.a.fk),C.setAttribute(X.a.gfa,X.a.Kr))}Q2g(C,Ca){Ca=void 0===Ca?!1:Ca;switch(C.getAttribute(X.a.Lua)){case X.a.s$e:++this.DIe;break;case X.a.UGa:++this.EIe;break;case X.a.TGa:++this.CIe;break;case X.a.MKh:++this.FIe}switch(C){case this.Ezk:++this.GYe;break;case this.LHh:++this.mIe;break;case this.jfa:++this.NIe}C.getAttribute(X.a.fk)===
X.a.Kua&&++this.AIe;Ca&&++this.kXe;this.t0e++}W_a(C,Ca,qb){qb=void 0===qb?!0:qb;return fa.sDf(Ca?qb?7:216:qb?8:217,fa.xRb(C))}eIc(C,Ca){return ha.f(this.$).ha.$a.isFloatingObjectSelected?this.Amj(C):this.Bmj(C,Ca)}Amj(C){const Ca={};switch(C){case -287251124:C="QueryBold";break;case -1925065947:C="QueryItalics";break;case 1764140053:C="QueryUnderline";break;case -1590502662:C="QueryStrikethrough";break;default:return!1}const qb=cb.a(this.$);return qb?(qb.x0a(C,Ca),Ca[jb.a.On]):!1}Bmj(C,Ca){if(!Ca)return null;
var qb=ha.f(this.$);Ca=Na.a(Ca);qb.isEditing&&(Ca.Font=qb.Fp.mKa(Ca.Font));qb=Ca.Font;switch(C){case -287251124:return qb.Bold;case -1925065947:return qb.Italic;case 1764140053:return qb.Underline;case -1590502662:return qb.Strikethrough}return!1}lKa(C){if(!C)return null;const Ca=ha.f(this.$);if(Ca.ha.$a.isFloatingObjectSelected)return null;C=Na.a(C);Ca.isEditing&&(C.Font=Ca.Fp.mKa(C.Font));return C.Font.FontSize}};za=Object(ba.__decorate)([Object(ka.d)(oa.l),Object(ba.__param)(0,Object(oa.Ob)()),
Object(ba.__param)(1,Object(oa.rd)())],za);Object(K.a)(za,"AriaLiveNotifier",null,[214,215,2]);var ea=a(97),Aa=a(6),ub=a(1523),rb=a(270),Ja=a(212),Xa=a(68);let Y=class{constructor(C,Ca,qb,nc){this.jOb=null;this.$=C;this.ddaFacade=nc;Ca?(E.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.jOb=new ub.a(C,Ca,qb,this.ddaFacade)):E.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Ri(){return!1}executeCommand(C,
Ca,qb){C=!1;switch(Ca.command){case 73979048:this.jOb&&this.jOb.hak(Ca,ea.TaskManager.instance,Aa.AFrameworkApplication.ea,qb),C=!0}return C?Xa.Task.Ua(!0):Ja.a(Ca.command)}Ei(C,Ca){return 73979048===Ca.command&&Aa.AFrameworkApplication.Iba(rb.a)}dj(){return!1}dispose(){this.jOb&&this.jOb.dispose()}};Y=Object(ba.__decorate)([Object(ka.d)(oa.rb),Object(ba.__param)(0,Object(oa.Ob)()),Object(ba.__param)(1,Object(oa.r)()),Object(ba.__param)(2,Object(oa.Ng)()),Object(ba.__param)(3,Object(oa.yb)())],Y);
Object(K.a)(Y,"DataFromPictureCommandHandler",null,[36,2]);class Ia{constructor(C,Ca){this.$=Ca;this.ariaLiveNotifier=C}tCg(){const C=this.VFi();this.ariaLiveNotifier.TOa(C,X.a.TGa)}VFi(){const C=new Sys.StringBuilder;this.$.workbookContext&&ja(C,this.$.workbookContext.WorkbookFileName);ja(C,qa.a.instance.ia(855));ja(C,this.XFi());ja(C,this.WFi());ja(C,qa.a.instance.ia(856));return C.toString()}XFi(){return this.$.isEditMode?qa.a.instance.ia(860):qa.a.instance.ia(861)}WFi(){var C=this.bgl();const Ca=
this.$.sa.la;C=1!==C?String.format(qa.a.instance.sh(32),C):qa.a.instance.ia(854);C=new Sys.StringBuilder(C);Ca&&Ca.sheetName&&(C.append(fa.P4d),C.append(String.format(qa.a.instance.sh(33),Ca.sheetName)));return C.toString()}bgl(){let C=0;for(const Ca of this.$.sa.items)Ca.visible&&C++;return C}}Object(K.a)(Ia,"WorkbookReadout",null,[]);let $a=class{constructor(C,Ca,qb){this.Hng=()=>{this.PDe.tCg();this.ariaLiveNotifier.setEnabled(!0)};this.$=Ca;this.ariaLiveNotifier=C;this.PDe=new Ia(C,Ca);this.Gzc=
qb.rOd(this.$);this.Gzc.fEh(this.Hng)}dispose(){this.Gzc&&this.Gzc.fpk(this.Hng);this.Gzc=this.ariaLiveNotifier=this.$=null}};$a=Object(ba.__decorate)([Object(ka.d)(oa.Lb),Object(ba.__param)(0,Object(oa.l)()),Object(ba.__param)(1,Object(oa.Ob)()),Object(ba.__param)(2,Object(oa.Tf)())],$a);Object(K.a)($a,"EmbeddedWorkbookReadoutHandler",null,[2]);var Ea=a(135),Lb=a(284),Ib=a(397),Mb=a(680),mc=a(491),jc=a(106),Fc=a(306),Gc=a(170),xc=a(88),Uc=a(309),Pa=a(78),Bb=a(40),Nb=a(84),oc=a(70),aa=a(687),rc=a(25);
class yb extends jc.a{constructor(C,Ca){super(C);this.a4=[];this.CRe=null;this.T4f=!1;this.E7a=qb=>{let nc="forward";qb.Values[Ib.a.direction]?nc=qb.Values[Ib.a.direction].toLowerCase():E.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");qb=0;let Rc=!0;"backward"===nc?(qb=this.B1d.length-1,Rc=!1):"forward"===nc?(qb=0,Rc=!0):E.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${nc}`);this.Beg(Rc,qb,!1)};this.Fng=()=>{this.a4=[]};this.k5a=qb=>{this.$.shortcutKeyManager.Vhk(qb);
const nc=this.$.shortcutKeyManager.KD(qb);if(-411645385===nc&&this.$0f()||this.T4f&&(369708605===nc||1542466017===nc))this.$.Ia.qh(new Nb.a(nc,1,this.$.ji,6,null),{["event"]:qb},qb),qb.stopPropagation()};this.mXj=qb=>{this.rAa(qb)};this.th=Ca;this.yF=ha.f(this.th);this.T4f=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8797275_unhideRowColKeyBoardCommandBugFix");this.qj.Ga("keydown",this.mXj);this.qj.Ga("keyup",this.k5a);Fc.a(Ca).EFh(this.Fng);xc.a(Ca.ua,27)&&(oa.pd.Ma()?void ka.a.resolve(oa.pd,{va:1}).then(qb=>
{qb.kr(Ea.a.mFc);qb.pq(Ea.a.mFc,this.E7a)}):Bb.TaskExtensions.$e(Pa.GetServiceTaskFactory.dk(Ca.qa,21,137,1),qb=>{qb=qb.result;qb.kr(Ea.a.mFc);qb.pq(Ea.a.mFc,this.E7a)},Ca.ya))}get $(){return this.th}get B1d(){this.a4.length||(this.a4=this.sJf());return this.a4}get vza(){return this.CRe}set vza(C){this.CRe=C;this.a4=this.sJf()}dispose(){this.$&&Fc.a(this.$).rqk(this.Fng);this.th=null;this.a4.length=0;super.dispose()}Qbk(C){this.rAa(C)}Beg(C,Ca,qb,nc){nc=void 0===nc?null:nc;var Rc=this.wZk(C,Ca,void 0===
qb?!0:qb,nc);if(!Rc){qb=Ca;var id=C?1:-1,sd=this.B1d;do{Rc=!1;if(xc.a(this.$.ua,27)){if(qb+=id,qb>=sd.length||0>qb)Rc=!0}else qb=(qb+id+sd.length)%sd.length;if(Rc){this.UDj(C,Ca,nc);break}else if(Rc=this.a0g(C,Ca,qb,!1,nc))break}while(qb!==Ca)}}wZk(C,Ca,qb,nc){nc=void 0===nc?null:nc;let Rc=null;0<=Ca&&(Rc=this.a4[Ca]);return(null===Rc||void 0===Rc?0:Rc.ap)&&Rc.Lp(C,void 0===qb?!0:qb)?(nc&&oc.g(nc),E.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${Rc.el} into a sub region`),
Rc.Rs(),!0):!1}a0g(C,Ca,qb,nc,Rc){Rc=void 0===Rc?null:Rc;qb=this.a4[qb];const id=Fc.a(this.th).$F(Lb.a.xJa),sd=Fc.a(this.th).$F(Lb.a.STb),Fd=this.yF.ha.$a.isFloatingObjectSelected;if(qb===sd&&Fd||qb===id&&!nc&&!Fd)return!1;if((null===qb||void 0===qb?0:qb.ap)&&qb.Lp(C,!1)){Rc&&oc.g(Rc);qb.Rs();if(C=this.a4[Ca])C.nu(),E.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${C.el} to ${qb.el}`);return!0}return!1}UDj(C,Ca,qb){(qb=void 0===qb?null:qb)&&oc.g(qb);if(Ca=this.a4[Ca])Ca.nu(),E.ULS.sendTraceTag(537166666,
0,50,`Lost focus from section ${Ca.el}`);oa.pd.Ma()?void ka.a.resolve(oa.pd,{va:0}).then(nc=>{nc.sendMessage(Ea.a.jGa,{[Ib.a.direction]:C?"forward":"backward"})}):Bb.TaskExtensions.$e(Pa.GetServiceTaskFactory.dk(this.$.qa,21,137,0),nc=>{nc.result.sendMessage(Ea.a.jGa,{[Ib.a.direction]:C?"forward":"backward"})},this.$.ya)}rAa(C){var Ca=this.$.isEditMode?Gc.a(this.$):null;yb.M0f(Ca)&&this.$.shortcutKeyManager.l5k(C,Ca.xs);if(!this.$.vh.zha||yb.M0f(Ca))if(117===C.keyCode&&(C.ctrlKey||oc.b(C))){Ca=this.DMf(C.target);
var qb=!C.shiftKey;E.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${Ca}`);var nc=Fc.a(this.th).$F(Lb.a.f7b);nc=this.a4.indexOf(nc);Aa.AFrameworkApplication.ra.$g.jJ&&this.$.g7&&-1!==nc&&Ca===nc&&Mb.a.LX(this.$.h$b,0);this.Beg(qb,Ca,!0,C)}else 117!==C.keyCode||yb.Tzf?-411645385===this.$.shortcutKeyManager.KD(C)?this.$0f()&&(this.$.Ia.qh(new Nb.a(-411645385,1,this.$.ji,6,null),{["event"]:C},C),C.stopPropagation()):1588554917===this.$.shortcutKeyManager.KD(C)?
0===this.mode?(aa.a(this.$)||this.$.Ia.qh(new Nb.a(1588554917,1,this.$.ji,6,null),{["event"]:C},C),C.preventDefault(),C.stopPropagation()):3===this.mode&&(C.preventDefault(),C.stopPropagation()):1058684758===this.$.shortcutKeyManager.KD(C)?(Ca=this.DMf(C.target),nc=Fc.a(this.th).$F(Lb.a.f7b),qb=Fc.a(this.th).$F(Lb.a.xJa),nc=this.a4.indexOf(nc),qb=this.a4.indexOf(qb),Aa.AFrameworkApplication.ra.$g.jJ&&this.$.g7&&-1!==nc&&Ca===nc&&1===this.$.h$b&&Mb.a.LX(1,0),-1!==qb&&Ca!==qb&&this.a0g(!0,Ca,qb,!0,
C)):ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8198803_AddingScopeToShortcuts")&&1===this.$.shortcutKeyManager.$Xi(C)?(Ca=this.$.shortcutKeyManager.KD(C),E.ULS.sendTraceTag(508342917,0,50,`AccessibilityManager.OnKeyDownHandler : RibbonCommand ${Ca} fired in ${this.mode} mode`),0===this.mode?(this.$.Ia.qh(new Nb.a(Ca,1,this.$.ji,6,null)),C.preventDefault(),C.stopPropagation()):4===this.mode&&-1966746939===Ca&&(C.preventDefault(),C.stopPropagation())):this.X3i(C):(C=Uc.a.fB.eL.WX(mc.a.tMi(),!1),
C.image=rc.a.tpb()?3:0,Uc.a.fB.eL.HF(C),yb.Tzf=!0)}DMf(C){const Ca=this.B1d;for(let qb=0,nc=Ca.length;qb<nc;++qb){const Rc=Ca[qb];if(Rc&&Rc.wq(C))return qb}return-1}sJf(){const C=[];for(let Ca=0,qb=this.vza.length;Ca<qb;Ca++){const nc=Fc.a(this.$).$F(this.vza[Ca]);nc&&C.push(nc)}return C}$0f(){return 0===this.mode||4===this.mode}static M0f(C){return C?C.inKeytipMode:!1}}yb.Tzf=!1;Object(K.a)(yb,"AccessibilityManager",jc.a,[921,2]);var Fb=a(179);let Qb=class extends yb{constructor(C){super(document.documentElement,
C);this.$L=0;this.fNh=[Lb.a.Ikf,Lb.a.M8d,Lb.a.REc,Lb.a.Pye,Lb.a.f7b,Lb.a.Rud,Lb.a.EJd,Lb.a.DPf,Lb.a.Otd,Lb.a.Bxe,Lb.a.CUk,Lb.a.tTg,Lb.a.STb,Lb.a.gDf,Lb.a.Vvd,Lb.a.xJa,Lb.a.lse,Lb.a.Zvd,Lb.a.tZg,Lb.a.s8f,Lb.a.nud];this.Cfl=[Lb.a.REc,Lb.a.k$g,Lb.a.j$g,Lb.a.l$g];this.nbk=[Lb.a.REc,Lb.a.Gyg,Lb.a.Hyg,Lb.a.Kyg];this.OVh=[Lb.a.XCf,Lb.a.CPf,Lb.a.WCf,Lb.a.TCf,Lb.a.Oof];this.Jak=[Lb.a.Ikf,Lb.a.M8d,Lb.a.Rud,Lb.a.EJd,Lb.a.Otd,Lb.a.Bxe,Lb.a.STb,Lb.a.Vvd,Lb.a.xJa,Lb.a.lse,Lb.a.$xg,Lb.a.Zvd,Lb.a.nud];this.$ak=[Lb.a.STb,
Lb.a.IJd];const Ca=qa.a.instance.Aa(253);this.WFk=this.$.shortcutKeyManager.bmb(Ca);this.mode=0;oa.pd.Ma()?void ka.a.resolve(oa.pd,{va:1}).then(qb=>{qb.kr(Ea.a.jGa);qb.pq(Ea.a.jGa,this.E7a)}):Bb.TaskExtensions.$e(Pa.GetServiceTaskFactory.dk(C.qa,21,137,1),qb=>{qb=qb.result;qb.kr(Ea.a.jGa);qb.pq(Ea.a.jGa,this.E7a)},C.ya)}get mode(){return this.$L}set mode(C){this.$L=C;switch(C){case 0:this.vza=this.fNh;break;case 2:this.vza=this.Cfl;break;case 3:this.vza=this.nbk;break;case 4:this.vza=this.OVh;break;
case 5:this.vza=this.Jak;break;case 6:this.vza=this.$ak;break;default:E.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}rAa(C){this.$.Kj&65536&&super.rAa(C)}X3i(C){if(Ma.a.equals(this.WFk,this.$.shortcutKeyManager.aNd(C),!1)){const Ca=Fb.b(this.$);if(null===Ca||void 0===Ca?0:Ca.ap)oc.g(C),Ca.Lp(!0,!1)}}};Qb=Object(ba.__decorate)([Object(ka.d)(oa.Nb),Object(ba.__param)(0,Object(oa.Ob)())],Qb);Object(K.a)(Qb,"EwaAccessibilityManager",yb,[]);var ac=a(41);let Wa=
class extends ac.a{constructor(){super()}VFh(C){this.addHandler("TAF",C)}Jqk(C){this.removeHandler("TAF",C)}uek(){this.raiseEvent("TAF")}};Wa=Object(ba.__decorate)([Object(ka.d)(oa.gd),Object(ba.__param)(0,Object(oa.Ob)())],Wa);Object(K.a)(Wa,"GridHighlightBehaviorEventManager",ac.a,[845,2]);var Gb=a(80),Ub=a(308),Ra=a(17),Rb=a(196),ib=a(142);class la extends Sys.EventArgs{constructor(C,Ca){super();this.start=C;this.vVb=Ca}}Object(K.a)(la,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);class db extends ac.a{constructor(C){super();
this.Lcg=[3];this.acb=void 0;this.da=C}get XF(){if(this.acb)return this.acb;const C=ka.a.lh(oa.Gc);C||E.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");C.XF||E.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.acb=C.XF}sEh(C){this.addHandler("mrek",
C)}vqa(C,Ca,qb){for(const nc of this.da.Av)Ub.a.instance.xa(Ra.a.Yy,nc.domElement,C);Ub.a.instance.xa(Ra.a.jp,document.documentElement,Ca);this.da.cellTextEditBox.Tjb(!0);qb&&Ub.a.instance.xa(Ra.a.jL,this.da.$m,Ca)}Njk(C,Ca,qb){document.documentElement.addEventListener("pointermove",C);document.documentElement.addEventListener("pointerup",Ca);this.da.cellTextEditBox.Tjb(!0);qb&&this.da.$m.addEventListener("pointerleave",Ca)}tAe(C,Ca,qb){for(const nc of this.da.Av)Ub.a.instance.Oa(Ra.a.Yy,nc.domElement,
C);Ub.a.instance.Oa(Ra.a.jp,document.documentElement,Ca);this.da.cellTextEditBox.Tjb(!1);qb&&Ub.a.instance.Oa(Ra.a.jL,this.da.$m,Ca)}G7k(C,Ca,qb){document.documentElement.removeEventListener("pointermove",C);document.documentElement.removeEventListener("pointerup",Ca);this.da.cellTextEditBox.Tjb(!1);qb&&this.da.$m.removeEventListener("pointerleave",Ca)}Ojk(C,Ca){for(const qb of this.da.Av)Rb.a.instance.xa(Ra.a.wo,qb.domElement,C);Rb.a.instance.xa(Ra.a.pl,document.documentElement,Ca)}H7k(C,Ca){for(const qb of this.da.Av)Rb.a.instance.Oa(Ra.a.wo,
qb.domElement,C);Rb.a.instance.Oa(Ra.a.pl,document.documentElement,Ca)}Qlf(C,Ca,qb,nc){const Rc=document.createElement("div");Rc.className=Ca;for(const id of qb)Rc.classList.add(id);C.appendChild(Rc);Ub.a.instance.xa(Ra.a.Bj,Rc,nc);return Rc}FMf(C){C=C.hi.parentNode;if(!C)return E.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;C=parseInt(C.getAttribute(X.a.vVb),10);return isNaN(C)?(E.ULS.shipAssertTag(537159393,0,
!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.da.Fh.eV(3,1,C)}T8b(C,Ca,qb){C=(void 0===qb?!0:qb)&&!!this.XF&&this.XF.Poj(C);for(const nc of Ca)ia.DOMElementExtensions.setVisible(nc,C)}IKd(){return this.da.DA?ib.a(this.da.$):this.da.Dh}ECg(){const C=this.IKd();C&&this.XF?C.n_(null):(E.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateFormulaHighlights: Can't UpdateFormulaHighlights, will hide all marquee as a last fallback."),
this.da.Fh.fr(this.Lcg),this.da.Fh.wt(null,this.Lcg))}QAg(C,Ca){this.raiseEvent("mrek",new la(C,Ca))}}Object(K.a)(db,"BehaviorHelperMethods",ac.a,[]);var $b=a(95),Ic=a(59),Tc=a(91);class Zc extends jc.a{constructor(C,Ca){super(C,void 0===Ca?null:Ca)}xfb(){}}Object(K.a)(Zc,"HighlightFlyweightBehavior",jc.a,[]);var cc=a(19),Yc=a(498),Vc=a(63),wd=a(13),wc=a(139),Ya=a(291),ob=a(52),Cb=a(266),Wb=a(10),ad=a(57);class $c extends Cb.a{constructor(C,Ca,qb,nc){super(document.createElement("div"));this.Fuc=
null;this.Dcc=!1;this.onPointerDown=Rc=>{Rc=this.zoomManager?this.zoomManager.xl(Rc):Rc;this.Dcc=!1;if(3===(Vc.a.ph=Rc.Gh)){const id=Rc.La.rawEvent,sd=id.srcElement||id.target;ia.DOMElementExtensions.Co(this.domElement,sd)&&ia.DOMElementExtensions.Co(id.currentTarget,sd)&&(this.Dcc=!0,this.Fuc=Rc.clientPoint)}return!1};this.Ho=Rc=>{Rc=this.zoomManager?this.zoomManager.xl(Rc):Rc;this.raiseEvent("GrPointerUp",Rc);return this.Dcc=!1};this.Yr=Rc=>{Rc=this.zoomManager?this.zoomManager.xl(Rc):Rc;3===Rc.Gh&&
this.Dcc&&this.G7i(Rc.clientPoint)&&(this.raiseEvent("GrDrag"),this.Dcc=!1);return!1};this.rj=Rc=>{this.zoomManager&&this.zoomManager.xl(Rc);return!0};this.$=qb;this.zoom=nc;this.domElement.classList.add(ad.pb);this.domElement.classList.add(ad.rb);C.appendChild(this.domElement);ia.DOMElementExtensions.setVisible(this.domElement,!1);this.t0a=document.createElement("div");this.t0a.classList.add(ad.qb);this.t0a.style.borderColor=Ca;this.domElement.appendChild(this.t0a);Ub.a.instance.xa(Ra.a.Bj,this.domElement,
this.onPointerDown);Ub.a.instance.xa(Ra.a.jp,this.domElement,this.Ho);Rb.a.instance.xa(Ra.a.pl,this.domElement,this.Ho);Ub.a.instance.xa(Ra.a.Yy,this.domElement,this.Yr);Rb.a.instance.xa(Ra.a.wo,this.domElement,this.Yr);Ya.a.instance.xa(Ra.a.click,this.domElement,this.rj)}get zoomManager(){return this.zoom.zoomManager}F5e(C){this.addHandler("GrDrag",C)}wGg(C){this.removeHandler("GrDrag",C)}E5e(C){this.addHandler("GrContxt",C)}vGg(C){this.removeHandler("GrContxt",C)}G5e(C){this.addHandler("GrPointerUp",
C)}xGg(C){this.removeHandler("GrPointerUp",C)}dispose(){ob.a.fPa(this.domElement);super.dispose()}hPg(){this.domElement.classList.remove(ad.rb);this.t0a.classList.remove(ad.qb);this.t0a.classList.add(ta.EwaSettings.gG?ad.vb:ad.ub)}N5g(){this.t0a.classList.remove(ta.EwaSettings.gG?ad.vb:ad.ub);this.t0a.classList.add(ad.qb);this.domElement.classList.add(ad.rb)}G7i(C){return!!this.Fuc&&(3<Math.abs(C.x-this.Fuc.x)||3<Math.abs(C.y-this.Fuc.y))}static cSb(C){return Math.round(9/Math.max(C.zoomManager?C.zoomManager.zoom:
Wb.a.y7,1))}}$c.Z5d=0;Object(K.a)($c,"TouchGrippie",Cb.a,[]);var Ld=a(177);class jd extends Zc{constructor(C,Ca,qb,nc,Rc){super(Ca);this.u0d=this.SJb=!1;this.Hqc=null;this.pN=this.Foa=this.q0d=!1;this.rG=()=>{this.SJb&&this.q0d?this.hCa():this.bha()};this.Bmg=sd=>{3===sd.Gh&&(this.q0d=!0,this.hCa());return!1};this.Cmg=sd=>{if(3===sd.Gh){if(!sd.hi||this.Blj(sd))return!1;this.q0d=!1;this.bha()}return!1};this.xm=()=>{this.Foa&&this.xAe();this.hCa();this.u0d=!1};this.Wy=()=>{this.bha();this.u0d=!0};this.pia=
(sd,Fd)=>{Fd.cba===this.cba&&(Fd.visible?this.u0d||this.hCa():this.bha())};this.Psg=()=>{this.Dmg(this.l3.domElement,!1)};this.Hig=()=>{this.Dmg(this.o0.domElement,!0)};this.$Pc=(sd,Fd)=>{this.pN&&Ld.b(this.da.$).iz(Fd.La.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.XAa(Fd)};this.aQc=(sd,Fd)=>{this.pN&&Ld.b(this.da.$).iz(Fd.La.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.XAa(Yc.b(Fd))};this.j2b=()=>{3===Vc.a.ph?this.hCa():this.bha();this.Foa&&1===Vc.a.ph&&this.xAe()};this.Qsg=
()=>{this.ZDk()};this.jtf=()=>{this.bha()};this.fw=()=>{this.ha.$a.Ih&&this.bha()};this.wig=()=>{this.bha()};this.umg=(sd,Fd)=>{this.xAe();3===Fd.Gh?this.hCa():this.bha()};this.eUc=()=>{this.SJb&&(this.bha(),this.hCa())};const id=qb.$;this.yF=qb;this.zoom=Rc;this.ha=qb.ha;this.lS=C;this.hBk=Ca;this.paneType=nc;C=this.domElement.currentStyle;Ca="#000000";C&&(Ca=C.borderTopColor);this.l3=new $c(this.aBf(),Ca,id,Rc);this.o0=new $c(this.aBf(),Ca,id,Rc);this.l3.F5e(this.Psg);this.l3.E5e(this.$Pc);this.l3.G5e(this.aQc);
this.o0.F5e(this.Hig);this.o0.E5e(this.$Pc);this.o0.G5e(this.aQc);for(const sd of this.da.Av)Rb.a.instance.xa(Ra.a.Om,sd.domElement,this.Cmg),Rb.a.instance.xa(Ra.a.pl,sd.domElement,this.Bmg);qb.view.uz(this.rG);qb.Dh.Mv(this.jtf);qb.Fh.kfb(this.pia);qb.tnc(this.wig);id.LI(this.eUc);qb.gA(this.eUc);this.ha.C4(this.xm);this.ha.Hla(this.Wy);qb.zO(this.fw);this.ha.SIb(this.umg);Vc.a.L5e(this.j2b);Bb.TaskExtensions.$e(Object(Tc.d)(ka.a.resolve(oa.gd,{va:0})),sd=>{sd.result.VFh(this.Qsg)},id.ya,3);this.pN=
ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8836781_TrackAsyncContextMenu")}get da(){return this.yF}dispose(){$b.a.gj([this.l3,this.o0]);this.l3.wGg(this.Psg);this.l3.vGg(this.$Pc);this.l3.xGg(this.aQc);this.o0.wGg(this.Hig);this.o0.vGg(this.$Pc);this.o0.xGg(this.aQc);for(var C of this.da.Av)Rb.a.instance.Oa(Ra.a.Om,C.domElement,this.Cmg),Rb.a.instance.Oa(Ra.a.pl,C.domElement,this.Bmg);this.da.view.gy(this.rG);this.da.Dh.Cv(this.jtf);this.da.Fh.Qvb(this.pia);this.da.vVc(this.wig);this.da.$.mL(this.eUc);
this.da.dF(this.eUc);this.ha.k8(this.xm);this.ha.Pia(this.Wy);this.da.oQ(this.fw);this.ha.$5b(this.umg);Vc.a.DGg(this.j2b);this.Foa&&E.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(C=ka.a.lh(oa.gd))&&C.Jqk(this.Qsg);super.dispose()}S8a(){if(!this.lS.range||!this.lS.range.equals(this.Swb))return!1;const C=!this.da.D2a();return this.da.isEditing&&C&&(this.Swb.isRow||this.Swb.hk)?!1:this.Foa?!0:3===Vc.a.ph}bha(){this.SJb&&(this.l3.set_visible(!1),
this.o0.set_visible(!1),this.SJb=!1)}hCa(){if(this.S8a()){var C=ia.DOMElementExtensions.getBoundingClientRect(this.Hqc);C||E.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.da.$m,this.da.fh.vp);var Ca=ia.DOMElementExtensions.getBoundingClientRect(this.hBk),qb=new Sys.UI.Bounds(Ca.x-C.x,Ca.y-C.y,Ca.width,Ca.height),nc=this.Swb,Rc=nc.topLeft,id=nc.bottomRight,sd=nc.isRow||nc.hk;if(nc.hk){var Fd=this.xxi();nc=qb.x-2*$c.cSb(this.zoom);
var S=Fd;var Ua=qb.x+Ca.width}else nc.isRow?(nc=Ua=this.wxi(),S=qb.y-2*$c.cSb(this.zoom),Fd=qb.y+Ca.height):(S=qb.y,Fd=qb.y+Ca.height,this.da.rtl?(nc=qb.x+Ca.width,Ua=qb.x):(nc=qb.x,Ua=qb.x+Ca.width));Ca=$c.Z5d+(sd?0:$c.cSb(this.zoom));this.l3.style.left=wd.HelperMethods.Li(nc-Ca);this.l3.style.top=wd.HelperMethods.Li(S-Ca);this.o0.style.left=wd.HelperMethods.Li(Ua-Ca);this.o0.style.top=wd.HelperMethods.Li(Fd-Ca);this.l3.set_visible(this.r0f(S,nc,Rc,sd,C));this.o0.set_visible(this.r0f(Fd,Ua,id,sd,
C));this.SJb=!0}}r0f(C,Ca,qb,nc,Rc){const id=ia.DOMElementExtensions.getBoundingClientRect(this.da.ol(this.paneType).domElement);Rc=new Sys.UI.Bounds(id.x-Rc.x-3,id.y-Rc.y-3,id.width+6,id.height+6);return(this.da.fh.Wn(qb)===this.paneType||nc)&&Ic.a.LY(Rc,new Sys.UI.Point(Ca,C))}xxi(){return(this.da.view.visibleArea.height+this.da.fh.height+$c.Z5d-$c.cSb(this.zoom))/2}wxi(){return(this.da.view.visibleArea.width+this.da.fh.width+$c.Z5d-$c.cSb(this.zoom))/2}drg(){this.hCa()}Blj(C){return ia.DOMElementExtensions.Hwb(C.hi,
cc.a.yH)&&(this.hnj(C)||this.inj(C))}inj(C){if(this.da.rtl)C=C.clientPoint.x;else{const Ca=ia.DOMElementExtensions.getBoundingClientRect(C.hi);C=C.clientPoint.x-(Ca.x+Ca.width-wc.a.Ex)}return 0<C&&C<=wc.a.Ex}hnj(C){const Ca=ia.DOMElementExtensions.getBoundingClientRect(C.hi);C=C.clientPoint.y-(Ca.y+Ca.height-wc.a.Ex);return 0<C&&C<=wc.a.Ex}Dmg(C,Ca){this.Foa&&E.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.Nvd(C,Ca,this.Foa);this.bha()}ZDk(){this.Foa||
(E.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Foa=!0,this.l3.hPg(),this.o0.hPg(),this.da.ha.sourceRange=this.da.ha.pa.oj,this.hCa())}xAe(){this.Foa&&(E.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Foa=!1,this.l3.N5g(),this.o0.N5g())}aBf(){this.Hqc||(this.Hqc=this.da.$m);return this.Hqc}}Object(K.a)(jd,"SelectionTouchGrippiesBehaviorBase",Zc,[]);class Td extends jd{constructor(C,Ca,qb,nc,Rc){super(C,Ca,
qb,nc,Rc)}get cba(){return 19}get Swb(){return this.da.ha.pa.activeRange}S8a(){const C=this.da.kq||this.da.isEditing;return!this.da.ha.pa.Yn&&!C&&super.S8a()}}Object(K.a)(Td,"DiscontinuousSelectionTouchGrippiesBehavior",jd,[]);var re=a(783);class Nd extends Zc{constructor(C){super(C);const Ca=document.createElement("div");Ca.className=ad.Mb;C.appendChild(Ca)}}Object(K.a)(Nd,"SelectionBorderBehavior",Zc,[]);class uc{}uc.Fyf="ewr-selection-draghandle-grab";uc.Ysi="ewr-selection-draghandle-top";uc.Zsi=
"ewr-selection-draghandle-top-enhanced";uc.Psi="ewr-selection-draghandle-bottom";uc.Qsi="ewr-selection-draghandle-bottom-enhanced";uc.Ssi="ewr-selection-draghandle-left";uc.Tsi="ewr-selection-draghandle-left-enhanced";uc.Vsi="ewr-selection-draghandle-right";uc.Wsi="ewr-selection-draghandle-right-enhanced";uc.$si="ewr-selection-draghandle-top-updated";uc.Rsi="ewr-selection-draghandle-bottom-updated";uc.Usi="ewr-selection-draghandle-left-updated";uc.Xsi="ewr-selection-draghandle-right-updated";uc.ati=
"ewr-selection-dragtooltip-updated";uc.Osi="ewr-selection-drag-tooltip-fluent";uc.Nsi="ewr-selection-drag-tooltip";uc.Eyf="ewr-selection-drag-tooltip-shift-instruction";uc.Gyf="ewr-selection-draghandle-reduced";uc.oti="ewr_selection_rearrangeleft";uc.pti="ewr_selection_rearrangeright";uc.qti="ewr_selection_rearrangetop";uc.nti="ewr_selection_rearrangebottom";uc.gti="ewr_selection_rearrange-flange-left";uc.kti="ewr_selection_rearrange-fullrowcol-flange-left";uc.hti="ewr_selection_rearrange-flange-right";
uc.lti="ewr_selection_rearrange-fullrowcol-flange-right";uc.iti="ewr_selection_rearrange-flange-top";uc.mti="ewr_selection_rearrange-fullrowcol-flange-top";uc.fti="ewr_selection_rearrange-flange-bottom";uc.jti="ewr_selection_rearrange-fullrowcol-flange-bottom";uc.selecting="selecting";uc.Msi="ewr-selection-drag-shadow";uc.rti="ewr-selection-resizemarqueehandle";uc.uti="ewr-selection-resizemarqueehandle-topleft";uc.vti="ewr-selection-resizemarqueehandle-topright";uc.sti="ewr-selection-resizemarqueehandle-bottomleft";
uc.tti="ewr-selection-resizemarqueehandle-bottomright";uc.Fsi="ewr-marquee-thick";uc.Hsi="ewr-resizemarqueehandle-thick";Object(K.a)(uc,"CssClassNames",null,[]);var pc=a(288);class Hd extends Nd{constructor(C,Ca,qb,nc,Rc){super(C);this.F9a=!1;this.ood=this.pod=null;this.LAb=this.onb=this.HR=this.Bla=0;this.w2=this.Hh=this.sourceRange=this.EOa=null;this.om=ta.EwaSettings.om();this.Ho=id=>{id=this.zoomManager.xl(id);return this.Gpg(id)};this.onPointerDown=id=>{id=this.zoomManager.xl(id);if(!this.ute())return!1;
if(2===id.Gh&&id.Lw===Sys.UI.MouseButton.leftButton&&!this.F9a){var sd=this.jPd(id);if(!sd)return E.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Hh=sd.clone();this.sourceRange=this.Hh.clone();this.om&&(this.EOa=null);if(sd=this.zRi(id))return this.LAb=sd.top-this.sourceRange.top,this.onb=sd.left-this.sourceRange.left,ha.f(this.$).ho.RA(Hd.YDd),this.Yae(id),this.F9a=!0,pc.b(this.$,!0),!0}return!1};this.Yr=id=>{id=this.zoomManager.xl(id);
if(this.Zae(id))return!0;if(id=this.QC?this.ha.K4(id.clientPoint,id.hi,5,!0):this.ha.$y(id.clientPoint,id.hi,5,void 0,void 0,!0)){if(this.om)this.ija(this.kma(id));else{id=this.kma(id);if(this.Hh.equals(id))return!0;this.Hh=id}if(!this.gAb())return E.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Eyc(!0),!1}return!0};this.Epg=id=>{id=new Sys.UI.DomEvent(id);id=re.a.create(id.type,id.target,id,2);return this.ood(id)};this.Kpg=id=>
{id=new Sys.UI.DomEvent(id);id=re.a.create(id.type,id.target,id,2);return this.pod(id)};this.Dj=(id,sd)=>{sd.P1||this.fZc(this.$.isEditMode)};this.ED=[];this.$=Ca;this.da=ha.f(this.$);this.zoom=Rc;this.ha=ha.f(this.$).ha;this.paneType=qb;this.rw=nc;this.QC=ta.EwaSettings.QC();ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragHandleUsabilityImprovement",!1)?this.pYc=[uc.Ysi,uc.Psi,uc.Ssi,uc.Vsi]:ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8683878_UpdateDragDropHitRegionOfActiveCell")?
this.pYc=[uc.$si,uc.Rsi,uc.Usi,uc.Xsi]:this.pYc=[uc.Zsi,uc.Qsi,uc.Tsi,uc.Wsi];this.$.nr(this.Dj)}get zoomManager(){return this.zoom.zoomManager}get Fh(){return ha.f(this.$).Fh}get Ez(){return this.ha.selectionType}set Ez(C){this.ha.selectionType=C}dispose(){this.ED.forEach(C=>{Ub.a.instance.Oa(Ra.a.Bj,C,this.onPointerDown)});this.ED.length=0;this.EOa=this.sourceRange=this.Hh=null;E.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.Bla}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.$r(this.Dj),1===this.Bla&&(E.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.vHa(this.ood,this.pod,!1)));super.dispose()}Gpg(C){if(5!==this.Ez)return!1;(C=this.s5a(C))||this.Eyc(!1);pc.b(this.$,!1);return C}vqa(C,Ca){E.ULS.shipAssertTag(537159377,0,!this.Bla,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.Bla}`);this.Bla+=1;this.ood=C;this.pod=
Ca;this.QC?this.rw.Njk(this.Epg,this.Kpg,this.bbc()):this.rw.vqa(C,Ca,this.bbc())}kma(C){if(!C||!this.Hh)return E.ULS.shipAssertTag(537159376,0,!!C,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),E.ULS.shipAssertTag(537159375,0,!!this.Hh,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const Ca=this.Hh.clone();1!==this.HR&&(Ca.left=Math.max(C.left-this.onb,1),Ca.right=Ca.left+this.sourceRange.width-1);2!==this.HR&&(Ca.top=Math.max(C.top-
this.LAb,1),Ca.bottom=Ca.top+this.sourceRange.height-1);return this.h3d(Ca)}vHa(C,Ca,qb,nc){qb=void 0===qb?!0:qb;nc=void 0===nc?!0:nc;E.ULS.shipAssertTag(537159374,0,1===this.Bla,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.Bla}`);--this.Bla;this.QC?this.rw.G7k(this.Epg,this.Kpg,this.bbc()):this.rw.tAe(C,Ca,this.bbc());qb&&this.ygf(nc);this.HR=0;this.F9a=!1}h3d(C){const Ca=C.clone();Hd.jij&&(Ca.right>Wb.a.Ak&&1!==this.HR&&(Ca.right=Wb.a.Ak,Ca.left=
Ca.right-C.width+1),Ca.bottom>Wb.a.Ok&&2!==this.HR&&(Ca.bottom=Wb.a.Ok,Ca.top=Ca.bottom-C.height+1));var qb=ha.f(this.$);if(qb.fh.nx){const nc=qb.fh.zH;qb=qb.fh.GK;Ca.left<nc&&1!==this.HR&&(Ca.left=nc,Ca.right=Math.min(Ca.left+C.width-1,Wb.a.Ak));Ca.top<qb&&2!==this.HR&&(Ca.top=qb,Ca.bottom=Math.min(Ca.top+C.height-1,Wb.a.Ok))}this.om||(this.EOa=Ca);return Ca}fZc(C){this.ED.forEach(Ca=>{ia.DOMElementExtensions.setVisible(Ca,C)})}uZf(){return!this.Hh.equals(this.EOa)}ija(C){this.EOa=this.Hh;this.Hh=
C}zRi(C){const Ca=C.hi;C=C.clientPoint;if(!Ca||!C)return E.ULS.shipAssertTag(537159373,0,!!Ca,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),E.ULS.shipAssertTag(537159372,0,!!C,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;C.y+=Ca===this.ED[Hd.mPb]?2:Ca===this.ED[Hd.WDd]?-2:0;C.x+=Ca===this.ED[Hd.Mwc]?2:Ca===this.ED[Hd.lPb]?-2:0;return this.QC?this.ha.K4(C,Ca,5,!0):this.ha.$y(C,Ca,5,void 0,void 0,!0)}}Hd.jij=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8676514_appCrashDragDropBugFix");
Hd.Atc="copy";Hd.YDd="grabbing";Hd.mPb=0;Hd.WDd=1;Hd.Mwc=2;Hd.lPb=3;Object(K.a)(Hd,"DragSelectionClickBehaviorBase",Nd,[]);class wb extends Hd{constructor(C,Ca,qb,nc,Rc,id,sd){super(C,Ca,qb,Rc,sd);this.ej=this.oW=null;this.RQf=()=>{this.Eyc(!0)};for(const Fd of this.pYc)Ca=this.rw.Qlf(C,Fd,[uc.Fyf],this.onPointerDown),this.ED.push(Ca);this.fZc(this.$.isEditMode);this.SP=nc;C=ka.a.lh(oa.Gc);E.ULS.shipAssertTag(512312961,0,!!C,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");
this.XF=C.XF;for(const Fd of this.ED)Ub.a.instance.xa(Ra.a.X7,Fd,this.SP.nUf),Ub.a.instance.xa(Ra.a.jL,Fd,this.SP.oUf);this.xfb(id)}xfb(C){this.rw.T8b(C,this.ED);this.SP.NZ()}Yae(C){E.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.da.pLa=!0;this.ej.LO(!1);this.Ez=5;this.SP.Msf(C.hi);this.ej.Xa.removeSelection();this.ej.Hnc(this.RQf);this.vqa(this.Yr,this.Ho);this.HR=this.sourceRange.isRow?1:this.sourceRange.hk?2:0}s5a(){const C=
this.L8();this.Ez=-1;this.vHa(this.Yr,this.Ho);return C}ygf(){this.da.pLa=!1;this.SP.Nsf(this.ED[0]);this.ej.Xa.setCaretPositionToEnd();this.ej.IVc(this.RQf);this.rw.ECg()}Eyc(C){E.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate formula highlights as a fallback in CleanUp.");C&&this.vHa(this.Yr,this.Ho)}jPd(C){this.ej=this.rw.IKd();this.oW=this.rw.FMf(C);return this.ej&&this.oW&&this.oW.range?this.oW.range:(E.ULS.shipAssertTag(537159388,
0,!!this.ej,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),E.ULS.shipAssertTag(537159387,0,!!this.oW,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),E.ULS.shipAssertTag(537159386,0,!!this.oW.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}L8(){return this.oW?this.XF.Deg(this.ej,this.oW,this.Hh):(E.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}gAb(){return this.L8()}bbc(){return!0}Zae(){return!1}ute(){return!0}}Object(K.a)(wb,"DragMarqueeClickBehavior",Hd,[]);var Xb=a(98),Kb=a(159),Zb=a(191),Oc=a(361),Cd=a(943),Wd=a(72),ee=a(234),he=a(36),pe=a(43),Se=a(375),Ta=a(236),Qa=a(46),Ob=a(438);class Jb extends Hd{constructor(C,Ca,qb,nc,Rc,id){super(C,Ca,qb,Rc,id);this.hi=this.Oma=this.FOa=this.oB=null;this.hk=this.isRow=!1;this.Wr=ta.EwaSettings.Wr();this.Jya=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragAnimationTracking",
!1);this.$Yb=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseSPDForDrag",!1);this.Z1a=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8732599_DragInsertIndicatorAlignmentBugFix");this.A6=ta.EwaSettings.rV()&&ta.EwaSettings.YXd();this.Djb=Wd.a.oaa;this.Owc=0;this.o0d=!1;this.Fmg=(sd,Fd)=>{this.vXb=!0;this.onPointerDown(Fd)};this.xm=()=>{this.domElement.classList.remove(uc.selecting);this.fZc(this.$.isEditMode&&!this.Qni());if(Jb.wik&&this.ha.pa.h7){const sd=this.yh(this.ha.pa.oj);null!==
sd&&(sd.hasAutoFilter?this.domElement.classList.add(uc.Gyf):this.domElement.classList.remove(uc.Gyf))}};this.Wy=()=>{this.domElement.classList.add(uc.selecting)};this.Qj=nc;this.aXd=!1;if(0===Jb.twc[qb].length)for(const sd of this.pYc)Ca=document.createElement("div"),Ca.className=sd,Ca.classList.add(uc.Fyf),Jb.twc[qb].push(Ca);for(const sd of Jb.twc[qb])C.appendChild(sd),Ub.a.instance.xa(Ra.a.Bj,sd,this.onPointerDown),this.ED.push(sd);this.fZc(this.$.isEditMode);this.om||(this.hz={});this.da.oV=!1;
this.ha.Hla(this.Wy);this.ha.C4(this.xm);this.QC&&1===this.paneType&&(this.xHa(),this.da.LEh(this.Fmg));this.Jya&&void ka.a.resolve(oa.Gd).then(sd=>{this.xLa=sd})}dispose(){this.ha&&(this.ha.Pia(this.Wy),this.ha.k8(this.xm));if(!this.om){if(this.hz)for(var C=1;4>=C;C++)ia.DOMElementExtensions.jn(this.hz[C.toString()]);this.hz=null}for(C=1;4>=C;C++)Jb.twc[C].length=0;this.oB=null;this.QC&&1===this.paneType&&this.da.Dpk(this.Fmg);super.dispose()}ygf(C){C&&(ha.f(this.$).ho.RA(X.a.Yaa),this.zgf(),this.da.oV=
!1);if(!this.om)for(C=1;4>=C;C++){const Ca=this.hz[C.toString()];Ca&&Ca.parentNode.removeChild(Ca);this.hz[C.toString()]=null}this.oB=null;this.om&&(this.FOa=null)}jPd(){return this.ha.pa.oj}L8(){this.ha.updateSelection(this.Hh,this.Hh.topLeft,0);return!0}a9a(C,Ca){Ca=void 0===Ca?!1:Ca;var qb=!isNullOrUndefined(this.Vfa);if(C&&Ca||C!==qb){qb=this.IY();var nc=this.wba();C&&(qb||nc)?(Ca&&this.Vfa&&(this.Fh.fr(this.Vfa),this.Vfa=null),this.Fh.RUb(!0),this.Vfa=this.$Wd()?[65]:[62,qb?63:64],this.Fh.wt(this.sourceRange,
this.Vfa),this.Fh.Qw(this.Vfa),E.ULS.sendTraceTag(507872737,0,50,`DragSelectionClickBehavior.showOrHideSourceHighlights: show source highlights for ${this.$Wd()?"copy":"cut"} operation`)):this.Vfa&&(this.Fh.fr(this.Vfa),this.Vfa=null,this.Fh.zja(),E.ULS.sendTraceTag(507872736,0,50,"DragSelectionClickBehavior.showOrHideSourceHighlights: hide source highlights"))}}Qef(C){this.Osf=C}Y9b(C){isNullOrUndefined(this.Vfa)&&Math.abs(this.IY()?C.y-this.Osf.y:C.x-this.Osf.x)>=Jb.HVk&&this.a9a(!0)}V4c(){const C=
!isNullOrUndefined(this.Vfa);this.a9a(C,!0)}gAb(C){C=void 0===C?!1:C;if(this.om&&!this.uZf()&&this.Oma)return!0;if(this.Wr){const qb=this.IY();var Ca=this.wba();qb||Ca?(Ca=this.k5f(),this.Oma=qb?Jb.lji:Jb.kji,this.Fh.wt(this.Hh,this.Oma),Ca?(this.Fh.Qw(this.Oma),this.om&&this.PBe(C,!0,!1)):(this.MUb(),this.om&&this.bN())):(this.Oma=Jb.XYa,this.Fh.wt(this.Hh,this.Oma),this.Fh.Qw(this.Oma),this.om&&this.PBe(C,!0,!1))}else this.Fh.wt(this.Hh,Jb.XYa),this.Fh.Qw(Jb.XYa);this.om||this.T$a(C);return!0}MUb(){this.Oma&&
(this.Fh.fr(this.Oma),this.Oma=null)}hAb(C,Ca,qb){C=void 0===C?!1:C;Ca=void 0===Ca?!0:Ca;qb=void 0===qb?!1:qb;const nc=this.LPk();if(!this.om||this.uZf()||nc){this.Fh.wt(this.Hh,this.oB);if(this.Wr){const Rc=this.IY()||this.wba(),id=this.l5f();Rc&&!id?this.FOa&&(this.Fh.fr(this.oB),this.om&&this.bN()):(this.om&&this.FOa&&nc&&this.Fh.fr(this.FOa),this.Fh.Qw(this.oB),this.om&&(this.FOa=this.oB,this.PBe(C,Ca,!0,qb)))}else this.Fh.Qw(this.oB);this.om||this.T$a(C)}}LPk(){return this.FOa&&this.oB?!(this.oB.length===
this.FOa.length&&this.oB.every((C,Ca)=>C===this.FOa[Ca])):!0}xHa(){this.vXb=!1}iTh(C,Ca,qb,nc,Rc,id,sd,Fd,S){Ca?(Ca=sd,Rc=nc.y+Rc.y-id.y-Fd,sd=id.width-S-Ca,nc=nc.height,C=C.y-id.y-Rc):(Ca=qb?nc.x-Rc.right+id.right+Fd:nc.x+Rc.left-id.left-Fd,Rc=sd,sd=nc.width,nc=id.height-S-Rc,C=qb?id.width-(C.x-id.left)-Ca:C.x-id.left-Ca);return{Djb:new Wd.a(Ca,Rc,sd,nc),Owc:C}}jTh(C,Ca,qb,nc,Rc,id){Ca?(Ca=nc.x,C=C.y-id.y-Rc):(Ca=qb?id.width-(C.x-id.left)-Rc:C.x-id.left-Rc,C=nc.y);return new Sys.UI.Point(Ca*(qb?
-1:1),C)}$Ad(){Jb.IW=document.createElement("div");Jb.IW.className=uc.Nsi;var C=document.createElement("div");Jb.IW.appendChild(C);C=document.createElement("div");C.className=uc.Eyf;Jb.IW.appendChild(C);this.da.$m.appendChild(Jb.IW)}V8(){Jb.IW?(ia.DOMElementExtensions.setVisible(Jb.IW,!0),this.o0d=!0):E.ULS.shipAssertTag(507314703,0,!1,"DragSelectionClickBehavior showTooltip: TooltipDiv is null")}bN(){Jb.IW&&(ia.DOMElementExtensions.setVisible(Jb.IW,!1),this.o0d=!1)}PBe(C,Ca,qb,nc){Jb.IW||this.$Ad();
var Rc=this.da.fh.Wn(this.Hh);const id=this.da.Hl(this.Hh,Rc,!0);if(id){var sd=this.da.$m.getBoundingClientRect(),Fd=this.da.ol(Rc),S=Fd.domElement.getBoundingClientRect();Fd=Ob.a.ZM(Rc,Fd.view.tn);Rc=Ca?Fd.x:0;Rc=this.da.rtl?S.right-id.x+Rc:S.x-sd.x+id.x-Rc;Fd=S.y-sd.y+id.y-(Ca?Fd.y:0);var Ua=qb?0:id.height,Hb=qb?0:id.width;Ca=new Ta.a(Jb.IW.style);S=Ca.jE;if(this.IY())qb=this.da.rtl?sd.right-Jb.UTf:Jb.UTf,nc=Fd+Jb.OCa+Ua,S.transform=this.da.rtl?`translate(calc(${qb}px - 100%), ${nc}px)`:`translate(${qb}px, ${nc}px)`;
else if(this.wba())qb=this.da.rtl?Rc+Jb.OCa:Rc+Jb.OCa+Hb,nc=Jb.Gfl,S.transform=`translate(${qb}px, ${nc}px)`;else if(qb&&nc||!qb&&(this.hi===this.ED[Hd.mPb]||this.hi===this.ED[Hd.WDd]))qb=this.da.rtl?Rc-id.width+Jb.Xge*id.width:Rc+Jb.Xge*id.width,this.hi===this.ED[Hd.mPb]?(nc=Fd-Jb.OCa,S.transform=`translate(${qb}px, calc(${nc}px - 100%))`):(nc=Fd+Jb.OCa+Ua,S.transform=`translate(${qb}px, ${nc}px)`);else if(qb&&!nc||!qb&&(this.hi===this.ED[Hd.Mwc]||this.hi===this.ED[Hd.lPb]))nc=Fd+Jb.Xge*id.height,
this.hi===this.ED[Hd.Mwc]?(qb=this.da.rtl?Rc-Jb.OCa-Hb:Rc-Jb.OCa,S.transform=`translate(calc(${qb}px - 100%), ${nc}px)`):(qb=this.ED[Hd.lPb]&&this.da.rtl?Rc+Jb.OCa:Rc+Jb.OCa+Hb,S.transform=`translate(${qb}px, ${nc}px)`);this.T$a(C);Ca.J4();this.o0d||this.V8()}}JSg(C){var Ca=this.da.$m,qb=Ca.getBoundingClientRect(),nc=this.da.oh.lGf(C),Rc=this.da.oh.fLf(nc)||this.da.ol(1);nc=Rc.domElement;const id=nc.getBoundingClientRect();Rc=this.Fh.k_a(this.sourceRange,Rc.paneType,!1);const sd=this.IY(),{Djb:Fd,
Owc:S}=this.iTh(C,sd,this.da.rtl,Rc,id,qb,(sd?this.da.Vca:this.da.x0).eNd(),sd?nc.scrollTop:nc.scrollLeft,wc.a.Ex/this.zoomManager.zoom);this.Djb=Fd;this.Owc=S;Jb.cga||(Jb.cga=document.createElement("div"),Jb.cga.id=`${this.da.$.xi}rowColDragShadow`,Jb.cga.className=uc.Msi,ia.DOMElementExtensions.setVisible(Jb.cga,!1),Ca.appendChild(Jb.cga));Ca=new Ta.a(Jb.cga.style);qb=Ca.jE;qb.height=`${this.Djb.height}px`;qb.width=`${this.Djb.width}px`;this.myb(C,Ca)}NUb(){Jb.cga&&ia.DOMElementExtensions.setVisible(Jb.cga,
!1)}myb(C,Ca){if(Jb.cga){Ca=Ca||new Ta.a(Jb.cga.style);var qb=Ca.jE,nc=this.da.$m.getBoundingClientRect(),{x:Rc,y:id}=this.jTh(C,this.IY(),this.da.rtl,this.Djb,this.Owc,nc);qb.transform=`translate(${Rc}px, ${id}px)`;ia.DOMElementExtensions.mre(Ca,Jb.cga,!0);Ca.J4()}}yh(C){return(C=this.da.za.Wx(C))?new Se.a(C,this.da):null}Qni(){if(this.ha.pa.Yn){const C=this.ha.pa.oj;if(null!=C&&1===C.top&&1===C.left&&C.bottom===C.maxRows&&C.right===C.maxColumns)return!0}return!1}Eyc(){E.ULS.sendTraceTag(508908561,
0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}bbc(){return!1}Cxb(C,Ca,qb,nc){nc=void 0===nc?!1:nc;var Rc=ia.DOMElementExtensions.getBoundingClientRect(Ca);let id=Ca===this.ED[Hd.mPb]||Ca===this.ED[Hd.WDd];var sd=Ca===this.ED[Hd.Mwc]||Ca===this.ED[Hd.lPb];this.isRow&&sd||this.hk&&id?sd="100px":(id=this.isRow||id,sd=this.Wr?id?(nc?Jb.C2k:Jb.H2k)+"px":(nc?Jb.z2k:Jb.D2k)+"px":(id?nc?Jb.B2k:Jb.G2k:nc?Jb.A2k:Jb.E2k)+"px");Ca=id?Ca===this.ED[Hd.mPb]?
"top":"bottom":Ca===this.ED[Hd.lPb]?"right":"left";C=100*(id?C.x-Rc.x:C.y-Rc.y)/(id?Rc.width:Rc.height);for(Rc=1;4>=Rc;Rc++){var Fd=document.createElement("div");const Ua=document.createElement("div");if(!this.om){var S=document.createElement("div");Fd.appendChild(S)}Fd.appendChild(Ua);nc&&(S=document.createElement("div"),Fd.appendChild(S),this.om?S.className=uc.Eyf:Ua.style.fontWeight="bold");Fd.className=this.Wr?uc.Osi:uc.ati;this.hz[Rc.toString()]=Fd;this.Fh.eV(qb,Rc).nl.appendChild(Fd);if(Fd=
this.hz[Rc.toString()])Fd.style[Ca]=sd,Fd.style[id?"left":"top"]=C+"%"}}QKd(C,Ca,qb,nc){var Rc=ha.f(this.$);let id;if(this.Z1a){id=Rc.ol(nc);const sd=Ob.a.ZM(nc,id.view.tn);qb=Cd.a.jz(sd,id.domElement,qb,Rc.rtl);nc=Rc.Hl(C,nc,!0)}else id=Rc.ol(this.paneType),qb=Cd.a.jz(id.view.tn,this.domElement.parentNode,qb,Rc.rtl),nc=Rc.Hl(C,void 0,!0);Rc=this.da.jj;return Ca&&qb.y-nc.topLeft.y>nc.height/2?Qa.E(Rc.h_a(C)):!Ca&&qb.x-nc.topLeft.x>nc.width/2?Qa.E(Rc.X_a(C)):C}C7g(C,Ca,qb,nc){const Rc=ha.f(this.$);
let id;if(this.Z1a){id=Rc.Hl(C,nc);var sd=Rc.ol(nc);nc=Ob.a.ZM(nc,sd.view.tn);qb=Cd.a.jz(nc,sd.domElement,qb,Rc.rtl)}else id=Rc.Hl(C),sd=Rc.ol(this.paneType),qb=Cd.a.jz(sd.view.tn,this.domElement.parentNode,qb,Rc.rtl);sd=!1;nc=2;Ca&&qb.y-id.topLeft.y>id.height/2?(sd=!0,nc=1):!Ca&&qb.x-id.topLeft.x>id.width/2&&(sd=!0);if(sd){Ca=Rc.pt("DragSelectionClickBehavior.updateMouseSelectionRange",Rc.i6,nc);try{Ca.nG(C),Ca.$$mn(),Ca.$$cu()}finally{Ca&&Ca.dispose()}}}rXa(C){this.Fh.fr(this.oB);this.vHa(this.LQc,
this.MQc,void 0,C);this.Jya&&this.c1c()}NX(C){this.Wr?this.MUb():this.Fh.fr(Jb.XYa);this.vHa(this.Yr,this.Ho,void 0,C);this.Jya&&this.c1c()}c1c(){var C;this.UDd&&(null===(C=this.xLa)||void 0===C?void 0:C.stopTrackAnimation(this.UDd));this.UDd=void 0}E$b(C,Ca){var qb;this.c1c();if(null===(qb=this.xLa)||void 0===qb?0:qb.startTrackAnimation(Ca,C))this.UDd=C}sob(C){return C.La.keyCode===Xb.a.dab||Sa.a.isMac&&C.La.keyCode===Xb.a.jcc}JWd(C){return C.La.ctrlKey||Sa.a.isMac&&C.La.altKey}YVb(C){C=ha.f(this.$).getRangeInformation(C);
for(let Ca=0,qb=C.length;Ca<qb;++Ca)if(Object(Oc.a)(ee.PivotTableRange,C[Ca]))return C=he.a.nj(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),pe.a(this.$).gD([C]),!0;return!1}h4e(){this.aXd||(this.ha.k6e(this.sbe),this.aXd=!0)}f7a(){this.ha&&(this.ha.VGg(this.sbe),this.aXd=!1)}m8a(C){var Ca;this.da.oV=C;null===(Ca=ka.a.lh(oa.ld))||void 0===Ca?void 0:Ca.h4i(C)}IY(){return 1===this.HR}wba(){return 2===this.HR}}Jb.E2k=-85;Jb.G2k=-40;Jb.A2k=-120;Jb.B2k=-50;Jb.D2k=-95;Jb.H2k=-50;Jb.z2k=-130;Jb.C2k=
-60;Jb.OCa=15;Jb.UTf=150;Jb.Gfl=100;Jb.Xge=.4;Jb.HVk=2;Jb.XYa=[48];Jb.lji=[66,68];Jb.kji=[67,69];Jb.jhk=[58,60];Jb.ihk=[59,61];Jb.twc=[[],[],[],[],[],[]];Jb.wik=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8196440_ReduceDragAreaIfAutoFilter");Object(K.a)(Jb,"DragSelectionClickBehavior",Hd,[]);var Jc=a(27),zb;(function(C){C[C.none=0]="none";C[C.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";C[C.applyLinkFailed=2]="applyLinkFailed";C[C.pasteHtmlFailed=3]="pasteHtmlFailed";C[C.pasteStringFailed=
4]="pasteStringFailed";C[C.pasteRangeFailed=5]="pasteRangeFailed";C[C.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";C[C.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";C[C.clipboardIsInaccessible=8]="clipboardIsInaccessible";C[C.pasteArtFailed=9]="pasteArtFailed";C[C.noArtSourceItem=10]="noArtSourceItem";C[C.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";C[C.failedToParseShadowWorkbookJson=
12]="failedToParseShadowWorkbookJson";C[C.invalidShadowWorkbook=13]="invalidShadowWorkbook";C[C.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";C[C.failedToPasteExternalImage=15]="failedToPasteExternalImage";C[C.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";C[C.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";C[C.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";C[C.pasteFromSameSessionNotSupportDiscontinuousSelection=
19]="pasteFromSameSessionNotSupportDiscontinuousSelection";C[C.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";C[C.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";C[C.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed";C[C.invalidHtml=23]="invalidHtml";C[C.failedToProcessClipboardHtml=24]="failedToProcessClipboardHtml"})(zb||(zb={}));Object(K.b)("PasteErrorType",zb);class tb{constructor(C,Ca){this.errorName=this.innerError=
null;this.errorName=C;this.innerError=void 0===Ca?null:Ca}}Object(K.a)(tb,"CCPError",null,[]);class zc extends tb{constructor(C,Ca){Ca=void 0===Ca?null:Ca;super(he.a.fi(void 0===C?null:C,"_"),Ca)}}Object(K.a)(zc,"EwaCCPError",tb,[]);class dd extends tb{constructor(C,Ca,qb,nc,Rc){Ca=void 0===Ca?null:Ca;qb=void 0===qb?null:qb;nc=void 0===nc?"":nc;Rc=void 0===Rc?100:Rc;super(zb[C]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=C;this.ewaErrors=
Ca;this.validationFailureReason=Rc;this.innerError=Ca?new zc(Ca,qb):qb;this.message=nc}}Object(K.a)(dd,"PasteInnerError",tb,[]);var od=a(216),gb=a(128),gc=a(265),Dc=a(64);class hd{constructor(C,Ca){this.destinationRange=this.sourceRange=null;this.sourceRange=C;this.destinationRange=Ca}}Object(K.a)(hd,"MacroRecorderTableRowColumnRearrangedPayload",null,[149]);class xd extends Jb{constructor(C,Ca,qb,nc,Rc,id,sd){super(C,Ca,qb,nc,Rc,id);this.nra=null;this.NH=this.hG=!1;this.yZb=0;this.m9b=this.iPb=null;
this.LR=0;this.Ksf=this.om?qa.a.instance.sh(246):qa.a.instance.ia(2269);this.rji=this.om?qa.a.instance.sh(247):qa.a.instance.ia(2270);this.vTg=this.om?qa.a.instance.ia(2552):qa.a.instance.ia(2271);this.dMk=this.om?qa.a.instance.ia(2553):qa.a.instance.ia(2272);this.Bi=null;this.onKeyDown=Fd=>{if(this.sob(Fd)||Fd.La.keyCode===Xb.a.FAb){this.t5b();!this.S6&&this.sob(Fd)&&(this.S6=!0,ha.f(this.$).ho.RA(Hd.Atc),this.Wr&&this.V4c());if(!this.iJ&&Fd.La.keyCode===Xb.a.FAb){this.iJ=!0;const S=this.om?!0:!1;
2===this.LR?(this.NX(!1),this.HR=0,this.hG=this.NH,this.F$b(S,Fd.La.rawEvent)):3===this.LR?(this.qXa(!1),this.HR=this.isRow?1:2,this.kda(S,Fd.La.rawEvent)):1===this.LR&&(this.rXa(!1),this.kda(S,Fd.La.rawEvent))}return!0}return!1};this.onKeyUp=Fd=>this.sob(Fd)||Fd.La.keyCode===Xb.a.FAb?(this.yZb=this.sob(Fd)?0:1,this.om&&this.pRa(this.yZb),1===this.yZb&&(2===this.LR?(this.qXa(!1),this.HR=0,this.kda(!0,Fd.La.rawEvent)):3===this.LR?(this.NX(!1),this.HR=this.isRow?1:2,this.F$b(!0,Fd.La.rawEvent)):1===
this.LR&&(this.NX(!1),this.Jyb(!0,Fd.La.rawEvent))),this.om||this.pRa(this.yZb),0===this.yZb&&(this.da.oV&&ha.f(this.$).ho.RA(Hd.YDd),this.Wr&&this.V4c()),!0):!1;this.MQc=Fd=>{Fd=this.zoomManager.xl(Fd);this.f7a();5===this.Ez?this.Gpg(Fd):(this.A6?this.m8a(!1):this.da.oV=!1,this.Wr&&(this.a9a(!1),this.NUb()),this.om&&this.bN(),!this.$.wy([this.Hh],!1)||this.khk()||this.XYd()||(this.ha.sourceRange=this.sourceRange.clone(),this.gck(),this.NH?this.Hh.top>this.sourceRange.top&&(Fd=this.Hh.height,this.Hh.top-=
Fd,this.Hh.bottom-=Fd):this.Hh.left>this.sourceRange.left&&(Fd=this.Hh.width,this.Hh.left-=Fd,this.Hh.right-=Fd),this.L8()));this.rXa(!0);this.tableRange=null;this.Ez=-1;this.nra=null;this.LR=0;return!0};this.Jpg=()=>{this.A6?this.m8a(!1):this.da.oV=!1;this.f7a();this.LR=0;this.Wr&&(this.a9a(!1),this.NUb());this.om&&this.bN();if(!this.$.wy([this.Hh],!1))return this.qXa(!0),this.Ez=-1,this.xHa(),!0;if(this.Y9g()&&!this.YVb(this.Hh)&&!this.YVb(this.sourceRange)&&!this.XYd()){this.L8();this.ha.sourceRange=
this.sourceRange.clone();var Fd=this.ha.sourceRange;const S=this.ha.pa.oj;this.QC?this.$.oi(-694765314,2,30,{[X.a.dna]:this.S6,[X.a.Lwc]:!0,[X.a.Nwc]:this.hG,[X.a.J5]:Fd,[X.a.I5]:S,[X.a.jwa]:this.iJ,[X.a.Bjb]:this.vXb}):this.$.oi(-694765314,2,30,{[X.a.dna]:this.S6,[X.a.Lwc]:!0,[X.a.Nwc]:this.hG,[X.a.J5]:Fd,[X.a.I5]:S,[X.a.jwa]:this.iJ});this.S6||(this.Hh.top>this.sourceRange.top&&(this.isRow||this.Hh.left===this.sourceRange.left&&this.hG)?(Fd=this.Hh.height,this.Hh.top-=Fd,this.Hh.bottom-=Fd):this.Hh.left>
this.sourceRange.left&&(this.hk||this.Hh.top===this.sourceRange.top&&!this.hG)&&(Fd=this.Hh.width,this.Hh.left-=Fd,this.Hh.right-=Fd),this.L8())}this.qXa(!0);this.nra=this.tableRange=null;this.Ez=-1;this.hG=!1;this.xHa();return!0};this.LQc=Fd=>{Fd=this.zoomManager.xl(Fd);var S=Fd.clientPoint;this.w2=Fd;var Ua=this.QC?this.ha.K4(S,Fd.hi,5,!0):this.ha.$y(S,Fd.hi,5,void 0,void 0,!0);this.Wr&&(this.IY()||this.wba())&&(this.myb(S),this.Y9b(S));if(Ua){if(this.tableRange.contains(Ua.topLeft)){if(Fd=this.Z1a?
this.da.fh.Wn(Ua):void 0,this.$Yb?Ua=this.QKd(Ua,this.NH,S,Fd):this.C7g(Ua,this.NH,S,Fd),this.om?this.ija(this.Z4(Ua)):this.Hh=this.Z4(Ua),this.ha.sourceRange=this.Hh,this.om?this.hAb(!1,Fd===this.da.fh.Wn(this.Hh),this.NH):(this.Fh.wt(this.Hh,this.oB),this.Fh.Qw(this.oB)),this.Wr?this.MUb():this.Fh.fr(Jb.XYa),6!==this.Ez){if(!this.om)for(S=1;4>=S;S++)if(Ua=this.hz[S.toString()])Ua.parentNode.removeChild(Ua),this.Fh.eV(this.NH?11:12,S).nl.appendChild(Ua);this.Ez=6}}else this.om?this.ija(this.kma(Ua)):
this.Hh=this.kma(Ua),this.lQf(Fd,!1);this.om||this.T$a(!1)}return!0};this.Cpg=Fd=>{Fd=this.zoomManager.xl(Fd);var S=Fd.clientPoint;this.w2=Fd;var Ua=this.QC?this.ha.K4(S,Fd.hi,5,!0):this.ha.$y(S,Fd.hi,5,void 0,void 0,!0);this.Wr&&(this.IY()||this.wba())&&(this.myb(S),this.Y9b(S));if(Ua){if(this.ZRf(Ua))return this.om?this.ija(this.kma(Ua)):this.Hh=this.kma(Ua),this.kQf(Fd,!1),!0;var Hb=this.Z1a?this.da.fh.Wn(Ua):void 0;if(this.isRow||this.hk){if(this.$Yb)Ua=this.QKd(Ua,this.isRow,S,Hb);else{Fd=ha.f(this.$);
if(this.Z1a){var Ec=Fd.Hl(Ua,Hb);var cd=Fd.ol(Hb);var Bd=Ob.a.ZM(Hb,cd.view.tn);S=Cd.a.jz(Bd,cd.domElement,S,Fd.rtl)}else Ec=Fd.Hl(Ua),cd=Fd.ol(this.paneType),S=Cd.a.jz(cd.view.tn,this.domElement.parentNode,S,Fd.rtl);cd=!1;Bd=2;this.hG=!1;this.isRow&&S.y-Ec.topLeft.y>Ec.height/2?(cd=!0,Bd=1):this.hk&&S.x-Ec.topLeft.x>Ec.width/2&&(cd=!0);if(cd){Fd=Fd.pt("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Fd.i6,Bd);try{Fd.nG(Ua),Fd.$$mn(),Ua=Fd.$$cu().range}finally{Fd&&Fd.dispose()}}}this.om?
this.ija(this.kma(Ua)):this.Hh=this.kma(Ua)}else{Ec=ha.f(this.$);this.Z1a?(Bd=Ec.ol(Hb),cd=Ob.a.ZM(Hb,Bd.view.tn),S=Cd.a.jz(cd,Bd.domElement,S,Ec.rtl),cd=Ec.Hl(Ua,Hb,!0)):(cd=Ec.Hl(Ua),Bd=Ec.ol(this.paneType),S=Cd.a.jz(Bd.view.tn,this.domElement.parentNode,S,Ec.rtl));Bd=!1;let ce=2;this.hG=!1;this.$Yb?Math.abs(S.x-cd.topLeft.x)<.3*cd.width?this.hG=!1:Math.abs(S.x-cd.bottomRight.x)<.15*cd.width?(this.hG=!1,Bd=!0):S.y-cd.topLeft.y<=cd.height/2?this.hG=!0:S.y-cd.topLeft.y>cd.height/2&&(Bd=this.hG=!0):
S.x-cd.topLeft.x===cd.width?(this.hG=!1,Bd=!0):S.y-cd.topLeft.y>cd.height/2&&(this.hG=Bd=!0,ce=1);this.nra&&(this.hG=this.NH);if(Bd)if(this.$Yb)S=this.da.jj,Ua=this.hG?Qa.E(S.h_a(Ua)):Qa.E(S.X_a(Ua));else{S=Ec.pt("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Ec.i6,ce);try{S.nG(Ua),S.$$mn(),Ua=S.$$cu().range}finally{S&&S.dispose()}}this.om||this.Fh.fr(this.oB);this.oB=this.hG?[11]:[12];if(!this.om){for(S=1;4>=S;S++)(Ec=this.hz[S.toString()])&&Ec.parentNode.removeChild(Ec),this.hz[S.toString()]=
null;this.Cxb(Fd.clientPoint,Fd.hi,this.hG?11:12)}this.om?this.ija(this.Z4(Ua)):this.Hh=this.Z4(Ua)}this.ha.sourceRange=this.Hh;Ua=this.om?Hb===this.da.fh.Wn(this.Hh):!0;this.Wr?this.hAb(!1,Ua,this.om?this.hG:!1):(this.Fh.wt(this.Hh,this.oB),this.Fh.Qw(this.oB));this.Wr?this.MUb():this.Fh.fr(Jb.XYa);if(6!==this.Ez){if(!this.om)for(Ua=1;4>=Ua;Ua++)if(Hb=this.hz[Ua.toString()])Fd=this.Wr?this.isRow?58:this.hk?59:this.hG?11:12:this.isRow||this.hG?11:12,Hb.parentNode.removeChild(Hb),this.Fh.eV(Fd,Ua).nl.appendChild(Hb);
this.Ez=6}this.Wr||this.T$a(!1)}return!0};this.sbe=()=>{this.da.oV&&5<=this.Ez&&(this.tableRange?this.iJ?this.NX(!0):this.rXa(!0):this.iJ?this.isRow||this.hk?this.NX(!0):this.qXa(!0):this.isRow||this.hk?this.qXa(!0):this.NX(!0));this.pRa(void 0);this.LR=0;this.Ez=-1;this.f7a()};this.tableRange=null;this.Wya=this.S6=this.iJ=!1;this.Bi=sd}dispose(){this.pRa(void 0);super.dispose()}Yae(C){this.w2=C;this.om&&(this.hi=this.w2.hi);this.nra=null;this.NH=this.isRow=this.hk=this.hG=!1;Kb.a.instance.xa(Ra.a.Wi,
this.domElement.ownerDocument.body,this.onKeyDown);if(C.La.shiftKey||this.JWd(C))this.t5b(),C.La.shiftKey&&(this.iJ=!0),this.JWd(C)&&(this.S6=!0,ha.f(this.$).ho.RA(Hd.Atc));this.h4e();this.A6?this.m8a(!0):this.da.oV=!0;this.tableRange=this.OTh(this.Qj.Fy(this.sourceRange.topLeft));const Ca=this.om?!0:!1;this.tableRange&&!this.tableRange.equals(this.sourceRange)?(this.nra=this.tableRange,this.LR=1,this.NH=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right,
this.iJ?this.kda(Ca,C.La.rawEvent):this.Jyb(!0,C.La.rawEvent)):(this.tableRange=null,this.isRow=this.sourceRange.isRow,this.hk=this.sourceRange.hk,this.isRow||this.hk?(this.LR=3,this.HR=this.isRow?1:2,this.iJ?this.kda(Ca,C.La.rawEvent):this.F$b(!0,C.La.rawEvent),this.Wr&&(C=C.clientPoint,this.JSg(C),this.Qef(C))):(this.LR=2,this.HR=0,this.iJ?this.F$b(Ca,C.La.rawEvent):this.kda(!0,C.La.rawEvent)))}s5a(){this.A6?this.m8a(!1):this.da.oV=!1;this.f7a();this.LR=0;this.Wr&&(this.a9a(!1),this.NUb());this.om&&
this.bN();if(!this.$.wy([this.Hh],!1))return this.NX(!0),this.xHa(),this.Ez=-1,!0;if(!this.Y9g()||this.YVb(this.Hh)||this.YVb(this.sourceRange))this.Ez=-1;else{this.L8();this.ha.sourceRange=this.sourceRange.clone();const C=this.ha.sourceRange,Ca=this.ha.pa.oj;this.QC?this.$.oi(-694765314,2,30,{[X.a.dna]:this.S6,[X.a.J5]:C,[X.a.I5]:Ca,[X.a.jwa]:this.iJ,[X.a.Bjb]:this.vXb}):this.$.oi(-694765314,2,30,{[X.a.dna]:this.S6,[X.a.J5]:C,[X.a.I5]:Ca,[X.a.jwa]:this.iJ})}this.NX(!0);this.xHa();return!0}Zae(C){const Ca=
C.clientPoint,qb=this.QC?this.ha.K4(Ca,C.hi,5,!0):this.ha.$y(Ca,C.hi,5,void 0,void 0,!0);this.w2=C;this.Wr&&(this.IY()||this.wba())&&(this.myb(Ca),this.Y9b(Ca));return this.ZRf(qb)?(this.om?this.ija(this.Z4(qb)):this.Hh=this.Z4(qb),this.kQf(C,!0),!0):this.l7i(qb)?(this.om?this.ija(this.kma(qb)):this.Hh=this.kma(qb),this.lQf(C,!0),!0):!1}GZi(C){return!this.IY()||this.iJ&&1!==C.height?!this.wba()||this.iJ&&1!==C.width?C.toString():Jc.Range.WO(C.left):C.top.toString()}T$a(C){if(this.om)Jb.IW&&(C='<span style="font-weight:600;">'+
this.GZi(this.Hh)+"</span>",this.Bi.hr(Jb.IW.childNodes[0],String.format(this.iPb,C)),Jb.IW.childNodes[1].innerText=this.iJ?"":this.m9b);else{const Ca=this.Hh.toString();for(let qb=1;4>=qb;qb++){const nc=this.hz[qb.toString()];nc&&nc.childNodes&&0<nc.childNodes.length&&(nc.childNodes[0].innerText=Ca,nc.childNodes[1].innerText=this.iPb,C&&(nc.childNodes[2].innerText=this.m9b))}}}ZRf(C){return!!this.nra&&1!==this.LR&&!!C&&this.nra.contains(C.topLeft)}l7i(C){return!!this.nra&&1===this.LR&&!!C&&!this.nra.contains(C.topLeft)}kQf(C,
Ca){this.tableRange=this.nra;this.LR=1;const qb=!this.iJ;Ca?(this.NX(!1),this.Jyb(this.om?!0:qb,C.La.rawEvent)):(this.qXa(!1),this.kda(this.om?!1:qb,C.La.rawEvent))}lQf(C,Ca){this.tableRange=null;this.LR=2;const qb=!this.iJ;Ca?(this.NX(!1),this.hG=this.NH,this.F$b(this.om?!1:qb,C.La.rawEvent)):(this.rXa(!1),this.kda(this.om?!0:qb,C.La.rawEvent))}ute(){if(!ha.f(this.$).ha.pa.Yn)return E.ULS.sendTraceTag(507875651,0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),
!1;const C=ha.f(this.$).getRangeInformation(this.ha.pa.oj);for(const Ca of C)if(Object(Oc.a)(ee.PivotTableRange,Ca))return E.ULS.sendTraceTag(507875650,0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because intersecting a pivot table"),!1;return!0}OTh(C){if(C&&C.contains(this.sourceRange)&&!C.equals(this.sourceRange)){if(C.Zxa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===C.top){const Ca=new Jc.Range(this.sourceRange.top,this.sourceRange.left,
C.bottom,this.sourceRange.right,!1,!1);if(!Ca.equals(C))return this.sourceRange=Ca,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),C}this.NH=C.left===this.sourceRange.left&&C.right===this.sourceRange.right;if(C.top===this.sourceRange.top&&C.bottom===this.sourceRange.bottom||this.NH)return C}return null}Z4(C){const Ca=C.clone();this.NH?Ca.left=Math.max(C.left-this.onb,1):Ca.top=Math.max(C.top-this.LAb,1);Ca.right=Ca.left+this.sourceRange.width-1;Ca.bottom=Ca.top+this.sourceRange.height-
1;return this.h3d(Ca)}XYd(){const C=this.Hh.topLeft.$i(this.sourceRange);return!C&&(this.tableRange||this.Wr&&(this.isRow||this.hk))?this.NH||this.Wr&&this.isRow?this.Hh.top===this.sourceRange.bottom+1:this.Hh.left===this.sourceRange.right+1:C}khk(){if(this.NH&&this.Hh.left!==this.tableRange.left||!this.NH&&this.Hh.top!==this.tableRange.top){const C=he.a.nj(1,1,0,918,0,2065438552,"RearrangeInvalidDest");pe.a(this.$).gD([C]);return!0}return!1}gck(){const C=this.$.Eh.Oi("UserAction","RearrangeRowColumnClientSide"),
Ca={["CopyPasteTargetType"]:1,["OperationId"]:Zb.a.create().toString(),["Stopwatch"]:C,["DragDropIsShiftKeyDown"]:this.iJ,["EncounteredDeploymentErrors"]:!1},qb=this.S6?2:1,nc=this.$.qa.zh(254);(new Promise((Rc,id)=>{this.jui(sd=>{sd.Errors&&0<sd.Errors.length?id(new dd(22,sd.Errors)):Rc(!0)},sd=>{sd=gb.a.$j(sd.data);id(new dd(22,sd))})})).then(()=>{E.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');nc&&nc.JCj(Ca,qb,
this.sourceRange,this.Hh);return Promise.resolve(!0)},Rc=>{E.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Rc?copyPasteInfra.getStringifiedError(Rc):"null"}, copyPasteTargetType="${1}"`);return nc?nc.ZZj(Rc,Ca,qb,this.sourceRange,this.Hh):Promise.reject(Rc)})}jui(C,Ca){C=void 0===C?null:C;Ca=void 0===Ca?null:Ca;const qb={};this.NH?(qb.FirstRow=this.Hh.top-1,qb.FirstColumn=0,qb.DeltaColumn=0,qb.DeltaRow=this.Hh.bottom-this.Hh.top+1):(qb.FirstRow=
0,qb.FirstColumn=this.Hh.left-1,qb.DeltaColumn=this.Hh.right-this.Hh.left+1,qb.DeltaRow=0);qb.LastRow=Wb.a.kG;qb.LastColumn=Wb.a.WE;qb.SheetName=this.$.sa.la?this.$.sa.la.name:this.$.$h.getItemByName(this.$.$h.la.name).sheetName;const nc=Qa.x(this.sourceRange,this.$);this.$.userOperationManager.enqueueOperation(new od.a(514,0,(Rc,id,sd)=>{var Fd=this.$.oa.ta;Rc=C?gc.c(Rc,C):Rc;id=Ca?gc.b(id,Ca):id;const S=Fd.Za(41,null);S.sourceRange=nc;S.destinationRange=qb;return Dc.h(Fd,"RearrangeRowColumn",S,
Rc,id,sd,null,0)},64,()=>new hd(nc,qb)),null)}pRa(C){void 0===C?this.iJ=this.S6=!1:0===C?this.S6=!1:1===C&&(this.iJ=!1);!this.Wya||this.S6||this.iJ||(Kb.a.instance.Oa(Ra.a.qk,this.domElement.ownerDocument.body,this.onKeyUp),this.Wya=!1)}t5b(){this.Wya||(Kb.a.instance.xa(Ra.a.qk,this.domElement.ownerDocument.body,this.onKeyUp),this.Wya=!0)}zgf(){Kb.a.instance.Oa(Ra.a.Wi,this.domElement.ownerDocument.body,this.onKeyDown);this.pRa(void 0)}uie(C){C=void 0===C?!1:C;this.Ez=5;this.vqa(this.Yr,this.Ho);
this.iPb=this.rji;this.m9b=this.dMk;this.om||this.Cxb(this.w2.clientPoint,this.w2.hi,this.Wr&&this.isRow?66:this.Wr&&this.hk?67:48,C)}tjk(C){C=void 0===C?!1:C;this.Ez=6;let Ca;this.Wr?this.isRow?(this.oB=Jb.jhk,Ca=58):this.hk?(this.oB=Jb.ihk,Ca=59):this.NH?(this.oB=[11],Ca=11):(this.oB=[12],Ca=12):(Ca=this.isRow||this.NH?11:12,this.oB=[Ca]);this.vqa(this.Cpg,this.Jpg);this.iPb=this.Ksf;this.m9b=this.vTg;this.om||this.Cxb(this.w2.clientPoint,this.w2.hi,Ca,C)}Gie(C){C=void 0===C?!1:C;this.Ez=6;this.oB=
this.NH?[11]:[12];this.vqa(this.LQc,this.MQc);this.iPb=this.Ksf;this.m9b=this.vTg;this.om||this.Cxb(this.w2.clientPoint,this.w2.hi,this.NH?11:12,C)}kda(C,Ca){this.Jya&&this.E$b(this.isRow?"drag_row_replace":this.hk?"drag_column_replace":"drag_range_replace",Ca);this.uie(C);this.gAb(C)}F$b(C,Ca){this.Jya&&this.E$b(this.isRow?"drag_row_insert":this.hk?"drag_column_insert":"drag_range_insert",Ca);this.tjk(C);this.hAb(C)}Jyb(C,Ca){this.Jya&&this.E$b(this.NH?"drag_table_row_rearrange":"drag_table_column_rearrange",
Ca);this.Gie(C);this.hAb(C)}qXa(C){this.Fh.fr(this.oB);this.vHa(this.Cpg,this.Jpg,void 0,C);this.Jya&&this.c1c()}k5f(){return!this.Hh.equals(this.sourceRange)}l5f(){return!this.XYd()}$Wd(){return this.S6}Y9g(){return this.ha.pa.oj.equals(this.Hh)?(E.ULS.sendTraceTag(507787463,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Drag Drop Not Allowed because source range and destination range are the same"),!1):!0}}Object(K.a)(xd,"DragSelectionClickBehaviorCellRangeAndTable",Jb,[]);var fd=a(366),kd=
a(141);class Yb extends Jb{constructor(C,Ca,qb,nc,Rc,id){super(C,Ca,qb,nc,Rc,id);this.sbe=()=>{this.da.oV&&this.rXa(!0);5===this.Ez&&this.NX(!0);this.f7a()};this.MQc=sd=>{this.zoomManager.xl(sd);this.A6?this.m8a(!1):this.da.oV=!1;this.f7a();this.Wr&&(this.a9a(!1),this.NUb());this.om&&this.bN();this.ha.sourceRange=this.sourceRange.clone();if(this.b4f)this.$.oi(927125067,Vc.a.ph,30,null);else if(this.lha){this.L8();this.ha.sourceRange=this.sourceRange.clone();sd=this.ha.sourceRange;const Fd=this.ha.pa.oj;
this.QC?this.$.oi(-694765314,2,30,{[X.a.dna]:!0,[X.a.J5]:sd,[X.a.I5]:Fd,[X.a.jwa]:!1,[X.a.Bjb]:this.vXb}):this.$.oi(-694765314,2,30,{[X.a.dna]:!0,[X.a.J5]:sd,[X.a.I5]:Fd,[X.a.jwa]:!1});E.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells");ha.f(this.$).ho.RA(X.a.Yaa);this.lha=!1}else this.Zbk();this.rXa(!0);this.QC&&this.xHa();this.Ez=-1;return!0};this.LQc=sd=>{sd=this.zoomManager.xl(sd);const Fd=sd.clientPoint;this.w2=sd;let S=this.QC?this.ha.K4(Fd,
sd.hi,5,!0):this.ha.$y(Fd,sd.hi,5,void 0,void 0,!0);this.Wr&&(this.IY()||this.wba())&&(this.myb(Fd),this.Y9b(Fd));if(S){if(!this.PZd(S))return this.z3i(sd),!0;sd=this.Z1a?this.da.fh.Wn(S):void 0;this.$Yb?S=this.QKd(S,this.isRow,Fd,sd):this.C7g(S,this.isRow,Fd,sd);if(this.isRow||this.hk)this.om?this.ija(this.Z4(S)):this.Hh=this.Z4(S);this.ha.sourceRange=this.Hh;this.om?this.hAb(!1,sd===this.da.fh.Wn(this.Hh),this.isRow):(this.Fh.wt(this.Hh,this.oB),this.Fh.Qw(this.oB));this.Wr?this.MUb():this.Fh.fr(Jb.XYa);
this.om||this.T$a()}return!0};this.onKeyDown=sd=>this.sob(sd)?(this.t5b(),this.lha||(this.lha=!0,ha.f(this.$).ho.RA(Hd.Atc),this.Wr&&this.V4c()),!0):!1;this.onKeyUp=sd=>{this.sob(sd)&&(this.pRa(),this.da.oV?ha.f(this.$).ho.RA(Hd.YDd):ha.f(this.$).ho.RA(X.a.Yaa),this.Wr&&this.V4c());return!0};this.Dog=sd=>{sd.Errors&&0<sd.Errors.length?(E.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${he.a.fi(sd.Errors)}]`),this.Hh.left=this.sourceRange.left,
this.Hh.right=this.sourceRange.right,this.Hh.top=this.sourceRange.top,this.Hh.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Hh.top&&this.sourceRange.bottom>=this.Hh.top-1?(this.Hh.top=this.sourceRange.top,this.Hh.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Hh.top||(this.Hh.top-=this.sourceRange.height),this.Hh.bottom=this.Hh.top+this.sourceRange.height-1):this.sourceRange.left<=this.Hh.left&&this.sourceRange.right>=this.Hh.left-1?(this.Hh.left=this.sourceRange.left,
this.Hh.right=this.sourceRange.right):(this.sourceRange.left>this.Hh.left||(this.Hh.left-=this.sourceRange.width),this.Hh.right=this.Hh.left+this.sourceRange.width-1);this.L8();this.Ez=-1};this.Cog=sd=>{sd=gb.a.$j(sd.data);E.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${he.a.fi(sd)}]`)};this.lha=this.Wya=!1}dispose(){super.dispose()}Yae(C){this.w2=C;this.om&&(this.hi=C.hi);this.isRow=this.hk=!1;this.h4e();this.HR=null!=this.Hh?this.Hh.isRow?
1:this.Hh.hk?2:0:0;this.A6?this.m8a(!0):this.da.oV=!0;Kb.a.instance.xa(Ra.a.Wi,this.domElement.ownerDocument.body,this.onKeyDown);this.JWd(C)&&(this.t5b(),this.lha=!0,ha.f(this.$).ho.RA(Hd.Atc));this.Qh=this.Qj.Axa(this.sourceRange);this.eZf=this.Uqj(this.Hh);this.Qh||E.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.b4f=(new kd.a(this.$.sa)).Bn;this.PZd(this.Hh)?(this.isRow=this.Krj(),this.hk=
this.Gjj(),this.isRow||this.hk?(this.lpb=!1,this.om?this.ija(this.Z4(this.Hh)):this.Hh=this.Z4(this.Hh),this.Jyb(C)):(this.lpb=!0,this.kda(C))):(this.lpb=!0,this.kda(C),this.Wr&&(this.IY()||this.wba())&&(C=C.clientPoint,this.JSg(C),this.Qef(C)))}s5a(){this.A6?this.m8a(!1):this.da.oV=!1;this.f7a();this.Wr&&(this.a9a(!1),this.NUb());this.om&&this.bN();if(this.b4f)return this.$.oi(927125067,Vc.a.ph,30,null),this.QC&&this.xHa(),this.NX(!0),this.lpb=!1,this.Ez=-1,!0;if(this.lha||this.eZf){this.L8();this.ha.sourceRange=
this.sourceRange.clone();const C=this.ha.sourceRange,Ca=this.ha.pa.oj;this.QC?this.$.oi(-694765314,2,30,{[X.a.dna]:this.lha,[X.a.J5]:C,[X.a.I5]:Ca,[X.a.jwa]:!1,[X.a.Bjb]:this.vXb}):this.$.oi(-694765314,2,30,{[X.a.dna]:this.lha,[X.a.J5]:C,[X.a.I5]:Ca,[X.a.jwa]:!1});E.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.lha}"`);ha.f(this.$).ho.RA(X.a.Yaa);this.NX(!0);this.QC&&this.xHa();this.lpb=!1;this.Ez=-1;this.eZf=
!1;return!0}return 5===this.Ez?(this.NX(!0),this.lpb=!1,this.XQk(),this.Ez=-1,!0):!1}Zae(C){const Ca=C.clientPoint,qb=this.QC?this.ha.K4(Ca,C.hi,5,!0):this.ha.$y(Ca,C.hi,5,void 0,void 0,!0);this.w2=C;this.Wr&&(this.IY()||this.wba())&&(this.myb(Ca),this.Y9b(Ca));return this.lpb?!1:this.PZd(qb)?(this.A3i(C),!0):!1}T$a(){const C=new Jc.Range(this.Hh.top,this.Hh.left,this.Hh.bottom,this.Hh.right,!1,!0);6===this.Ez&&(this.isRow?(--C.top,C.bottom=C.top+this.Hh.height-1):(--C.left,C.right=C.left+this.Hh.width-
1));if(this.om)Jb.IW&&(Jb.IW.childNodes[0].innerText=C.toString(),Jb.IW.childNodes[1].innerText="");else for(let Ca=1;4>=Ca;Ca++){const qb=this.hz[Ca.toString()];qb&&qb.childNodes&&0<qb.childNodes.length&&(qb.childNodes[0].innerText=C.toString())}}ute(){if(!ha.f(this.$).ha.pa.Yn)return E.ULS.sendTraceTag(507875653,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;var C=ha.f(this.$).getRangeInformation(this.ha.pa.oj);
for(var Ca of C)if(Object(Oc.a)(ee.PivotTableRange,Ca)&&(C=this.Qj.Axa(Ca)))return Ca=!C.isOlap||!C.bqb(!0),E.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",C),C.isActionable&&Ca;return!1}Z4(C){C=C.clone();this.isRow?(C.left=this.sourceRange.left,C.right=this.Qh.right,C.bottom=C.top+this.sourceRange.height-1):this.hk?(C.top=this.sourceRange.top,C.bottom=this.Qh.sL?this.Qh.sL.bottom:this.Qh.bottom,C.right=C.left+
this.sourceRange.width-1):E.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.h3d(C)}Zbk(){const C={},Ca=Qa.x(this.sourceRange,this.$);if(this.isRow){Ca.FirstColumn=C.FirstColumn=this.Hh.left-1;Ca.LastColumn=C.LastColumn=this.Hh.right-1;if(this.sourceRange.top<=this.Hh.top&&this.sourceRange.bottom>=this.Hh.top-1){E.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");
return}this.sourceRange.top>this.Hh.top?C.LastRow=C.FirstRow=this.Hh.top-1:(C.FirstRow=this.Hh.top-this.sourceRange.height-1,C.LastRow=C.FirstRow+this.sourceRange.height-1)}else{C.FirstRow=Math.min(this.Hh.top,this.Hh.bottom-1);C.LastRow=this.Hh.bottom-1;if(this.sourceRange.left<=this.Hh.left&&this.sourceRange.right>=this.Hh.left-1){E.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}C.LastColumn=this.sourceRange.left>this.Hh.left?C.FirstColumn=
this.Hh.left-1:C.FirstColumn=this.Hh.left-this.sourceRange.width-1}const qb={};qb.SheetName=this.$.sa.la?this.$.sa.la.name:this.$.$h.getItemByName(this.$.$h.la.name).sheetName;qb.Ranges=Array(2);qb.Ranges[0]=Ca;qb.Ranges[1]=C;this.eui(qb)}eui(C){this.$.userOperationManager.enqueueOperation(new od.a(265,0,(Ca,qb,nc)=>{var Rc=this.$.oa.ta;Ca=this.Dog?gc.c(Ca,this.Dog):Ca;qb=this.Cog?gc.b(qb,this.Cog):qb;const id=Rc.Za(1,null);id.moveRange=C;return Dc.h(Rc,"MoveLineItems",id,Ca,qb,nc,null,0)},64),null)}PZd(C){return null!==
this.Qh&&null!==C&&this.Boj(C)&&this.Crj(C)&&this.Utj(C)&&this.Hij(C)}Boj(C){return this.Qh.sL?C.left>=this.Qh.sL.left:this.Qh.XI?C.left>=this.Qh.XI.left:C.left>=this.Qh.left}Crj(C){return this.Qh.XI?C.right<=this.Qh.XI.right:this.Qh.sL?C.right<=this.Qh.sL.right:C.right<=this.Qh.right}Utj(C){return this.isRow?null!==this.Qh.sL&&C.top>=this.Qh.sL.top:this.hk?null!==this.Qh.XI&&C.top>=this.Qh.XI.top:null===this.Qh.top||C.top>=this.Qh.top}Hij(C){return this.Qh.sL?C.bottom<=this.Qh.sL.bottom:this.Qh.XI?
C.bottom<=this.Qh.XI.bottom:C.bottom<=this.Qh.bottom}Uqj(C){return null!==this.Qh&&this.Qh.left>=C.left&&this.Qh.right<=C.right&&this.Qh.top>=C.top&&this.Qh.bottom<=C.bottom}Krj(){return null!==this.Qh&&null!==this.Qh.sL&&this.Qh.sL.top<=this.Hh.top&&this.Qh.sL.left<=this.Hh.left&&this.Qh.sL.right>=this.Hh.left}Gjj(){return null!==this.Qh&&null!==this.Qh.XI&&this.Qh.XI.top===this.Hh.top&&this.Qh.XI.left<=this.Hh.left&&this.Qh.XI.right>=this.Hh.right}Gie(C){this.Ez=6;this.oB=this.isRow?[11]:[12];this.vqa(this.LQc,
this.MQc);this.om||this.Cxb(C.clientPoint,C.hi,this.isRow?11:12,!1)}uie(C){this.Ez=5;this.vqa(this.Yr,this.Ho);this.om||this.Cxb(C.clientPoint,C.hi,this.Wr&&this.IY()?66:this.Wr&&this.wba()?67:48,!1)}Jyb(C){this.Jya&&this.E$b(this.isRow?"drag_pivot_row_rearrange":"drag_pivot_column_rearrange",C.La.rawEvent);this.Gie(C);this.hAb()}kda(C){this.Jya&&this.E$b("drag_pivot_replace",C.La.rawEvent);this.uie(C);this.gAb()}A3i(C){this.NX(!1);this.om?this.ija(this.Z4(this.Hh)):this.Hh=this.Z4(this.Hh);this.Jyb(C)}z3i(C){this.rXa(!1);
this.kda(C)}XQk(){if((null==this.sourceRange||null==this.Hh||this.sourceRange.ME(!1)!==this.Hh.ME(!1))&&!this.YVb(this.Hh)){var C=he.a.nj(1,0,904,903,0,2069074184,"PivotTableInvalidMove");C.HelpTopicId=fd.a.wVk;C.HelpDescription=qa.a.instance.ia(913);pe.a(this.$).gD([C])}}pRa(){this.lha=!1;this.Wya&&(Kb.a.instance.Oa(Ra.a.qk,this.domElement.ownerDocument.body,this.onKeyUp),this.Wya=!1)}t5b(){this.Wya||(Kb.a.instance.xa(Ra.a.qk,this.domElement.ownerDocument.body,this.onKeyUp),this.Wya=!0)}k5f(){return!this.Hh.equals(this.sourceRange)}l5f(){return!1}$Wd(){return this.lha}zgf(){Kb.a.instance.Oa(Ra.a.Wi,
this.domElement.ownerDocument.body,this.onKeyDown);this.pRa()}}Object(K.a)(Yb,"DragSelectionClickBehaviorPivotTableRange",Jb,[]);var Cc=a(435);class td extends Nd{constructor(C,Ca){super(C);this.xm=()=>{this.domElement.classList.remove(uc.selecting);Cc.c(this.da.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Wy=()=>{this.domElement.classList.add(uc.selecting)};this.onPointerDown=qb=>{2===qb.Gh&&qb.Lw===Sys.UI.MouseButton.leftButton&&(this.da.ha.selectionType=4,this.da.ha.sourceRange=this.da.ha.pa.oj,
Cc.c(this.da.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.KNa=()=>{this.da.$.oi(1983983164,2,30,null);return!0};this.Dj=()=>{ia.DOMElementExtensions.setVisible(this.qna,this.da.$.isEditMode)};this.b3b=()=>{ia.DOMElementExtensions.setVisible(this.qna,!1)};this.a3b=()=>{ia.DOMElementExtensions.setVisible(this.qna,!0)};this.wmg=()=>{ia.DOMElementExtensions.setVisible(this.qna,!1)};this.vmg=()=>{ia.DOMElementExtensions.setVisible(this.qna,!0)};this.S1b=(qb,nc)=>{ia.DOMElementExtensions.setVisible(this.qna,
!nc.uod)};this.da=Ca;Ca=document.createElement("div");Ca.className=ta.EwaSettings.gG()?ad.Lb:ad.Kb;this.qna=Ca;this.Dj(null,null);C.appendChild(Ca);Ub.a.instance.xa(Ra.a.Bj,this.qna,this.onPointerDown);Ya.a.instance.xa(Ra.a.Ut,this.qna,this.KNa);this.da.$.nr(this.Dj);this.da.$.vh.z6e(this.b3b);this.da.$.vh.y6e(this.a3b);this.da.m5e(this.S1b);this.da.cellTextEditBox.Mv(this.wmg);this.da.cellTextEditBox.Ox(this.vmg)}dispose(){Ub.a.instance.Oa(Ra.a.Bj,this.qna,this.onPointerDown);Ya.a.instance.Oa(Ra.a.Ut,
this.qna,this.KNa);this.da.$&&(this.da.ha.Pia(this.Wy),this.da.ha.k8(this.xm),this.da.$.$r(this.Dj),this.da.$.vh.iHg(this.b3b),this.da.$.vh.hHg(this.a3b),this.da.gGg(this.S1b),this.da.cellTextEditBox.Cv(this.wmg),this.da.cellTextEditBox.Ow(this.vmg));super.dispose()}}Object(K.a)(td,"FillHandleClickBehavior",Nd,[]);class Ad{constructor(C){this.nUf=Ca=>{this.j4c(Ca.hi,1);return!0};this.oUf=Ca=>{this.j4c(Ca.hi,-1);return!0};this.xm=()=>{this.lYd=!1};this.Wy=()=>{this.lYd=!0};this.da=C;this.tnb=0;this.lYd=
this.zIc=!1;this.Jha=Number.NaN;this.da.ha.Hla(this.Wy);this.da.ha.C4(this.xm);this.da.ha.k6e(this.xm)}dispose(){this.da.ha.Pia(this.Wy);this.da.ha.k8(this.xm);this.da.ha.VGg(this.xm)}NZ(){this.tnb=0;this.zIc=!1;this.Jha=Number.NaN}Msf(C){this.zIc=!0;this.j4c(C,1)}Nsf(C){this.zIc=!1;this.j4c(C,-1)}j4c(C,Ca){if(C)if(C.parentNode)if(this.lYd)isNaN(this.Jha)||(this.C4c(this.Jha,!1),this.Jha=Number.NaN);else if(C=parseInt(C.parentNode.getAttribute(X.a.vVb),10),isNaN(C))E.ULS.shipAssertTag(537159366,0,
!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.Jha)&&C!==this.Jha){if(this.zIc)return;this.C4c(this.Jha,!1)}if(isNaN(this.Jha)||C!==this.Jha)this.Jha=C,this.tnb=0;!this.tnb&&0<Ca&&this.C4c(C,!0);this.tnb=Math.max(this.tnb+Ca,0);!this.tnb&&0>Ca&&(this.C4c(C,!1),this.Jha=Number.NaN)}else E.ULS.shipAssertTag(537159367,0,!!C.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else E.ULS.shipAssertTag(537159368,
0,!!C,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}C4c(C,Ca){var qb=this.da.fh.Bcc;for(const nc of qb)for(qb=this.da.Fh.eV(3,nc,C).nl,ia.DOMElementExtensions.toggleCssClass(qb,uc.Fsi,Ca),qb=qb.firstChild;qb;qb=qb.nextSibling)Ma.a.contains(qb.className,"resizemarqueehandle",!0)&&ia.DOMElementExtensions.toggleCssClass(qb,uc.Hsi,Ca)}}Object(K.a)(Ad,"MarqueeHoveringManager",null,[]);var oe=a(330),qe=a(154),Be=a(1073),Ee=a(1417),Ve=a(396);class Oe extends Zc{constructor(C,Ca){super(C);
this.uEc=!1;this.KQc=()=>{if(!this.zB)return E.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.zB.ofk(this.Zna);this.zB.rmi(this.$na);if(3===this.zB.model.state)return!0;this.zB.pTd(!0);return!0};this.Lpa=()=>{if(!this.zB)return!1;this.zB.AAg(!1);this.zB.mme(this.$na,!1);if(3===this.zB.model.state)return!0;this.zB.pTd(!1);return!0};this.onPointerDown=qb=>this.zB?2===qb.Gh&&qb.Lw===Sys.UI.MouseButton.leftButton?!0:!1:!1;
this.p2b=()=>{if(!this.zB)return!1;this.zB.mme(this.$na,!0);this.zB.pTd(!1);this.zB.rjb();return!0};this.onDoubleClick=qb=>{if(qb.La)return qb.La.stopPropagation(),!0;E.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.container=C;this.zB=Object(qe.a)(Ee.a,Ca.metadata);this.yUg(Ca)&&this.IWf(Ca.isVisible)}dispose(){this.PEg();this.zB=null;super.dispose()}xfb(C){this.zB=Object(qe.a)(Ee.a,C.metadata);this.yUg(C)?this.IWf(C.isVisible):
this.PEg();!ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")&&C.isVisible!==C.FMa&&this.zB&&(this.zB.CJk(C.isVisible?1:0),ia.DOMElementExtensions.setVisible(this.$na,C.isVisible))}IWf(C){this.uEc||(this.uEc=!0,this.$na=document.createElement("div"),this.$na.id=`${this.container.id}-${X.a.Yef}`,this.$na.className=Be.f,this.Zna=document.createElement("div"),this.Zna.id=`${this.container.id}-${X.a.EVh}`,this.Zna.className=Be.c,this.u1=document.createElement("div"),
this.u1.appendChild(this.Zna),this.u1.className=Be.d,this.$na.appendChild(this.u1),this.container.appendChild(this.$na),E.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created."),Ub.a.instance.xa(Ra.a.X7,this.u1,this.KQc),Ub.a.instance.xa(Ra.a.jL,this.u1,this.Lpa),Ub.a.instance.xa(Ra.a.Bj,this.u1,this.onPointerDown),oe.a.instance.xa(Ra.a.click,this.u1,this.p2b),oe.a.instance.xa(Ra.a.Ut,this.u1,this.onDoubleClick),
ia.DOMElementExtensions.setVisible(this.u1,C))}PEg(){this.uEc&&(this.uEc=!1,Ub.a.instance.Oa(Ra.a.X7,this.u1,this.KQc),Ub.a.instance.Oa(Ra.a.jL,this.u1,this.Lpa),Ub.a.instance.Oa(Ra.a.Bj,this.u1,this.onPointerDown),oe.a.instance.Oa(Ra.a.click,this.u1,this.p2b),oe.a.instance.Oa(Ra.a.Ut,this.u1,this.onDoubleClick),ia.DOMElementExtensions.jn(this.Zna),this.Zna=null,ia.DOMElementExtensions.jn(this.$na),this.$na=null)}yUg(C){C=new Ve.a(C.range,C.sheetId);return!!this.zB&&this.zB.TGc(C)}}Object(K.a)(Oe,
"RangeCatchUpActivityHighlightBehavior",Zc,[]);class Ye extends jd{constructor(C,Ca,qb,nc,Rc){super(C,Ca,qb,nc,Rc)}get cba(){return 16}get Swb(){return this.da.ha.rangePicker.KKd(!1)}S8a(){return(this.da.inRangePicker||this.da.kq)&&super.S8a()}}Object(K.a)(Ye,"RangePickerTouchGrippiesBehavior",jd,[]);class nf extends Zc{constructor(C,Ca,qb){super(C);const nc=document.createElement("div"),Rc=document.createElement("div");ta.EwaSettings.Wr()?qb?(nc.className=Ca?uc.kti:uc.mti,Rc.className=Ca?uc.lti:
uc.jti):(nc.className=Ca?uc.gti:uc.iti,Rc.className=Ca?uc.hti:uc.fti):(nc.className=Ca?uc.oti:uc.qti,Rc.className=Ca?uc.pti:uc.nti);C.appendChild(nc);C.appendChild(Rc)}}Object(K.a)(nf,"RearrangeHighlightBehavior",Zc,[]);var of;(function(C){C[C.topLeft=0]="topLeft";C[C.topRight=1]="topRight";C[C.bottomLeft=2]="bottomLeft";C[C.bottomRight=3]="bottomRight";C[C.error=4]="error"})(of||(of={}));Object(K.b)("Corner",of);class Cf extends Zc{constructor(C,Ca,qb,nc,Rc,id){super(C);this.ej=this.oW=null;this.Rfa=
0;this.Hh=this.sourceRange=null;this.F9a=!1;this.onPointerDown=sd=>{sd=this.zoomManager.xl(sd);if(this.YTg(sd)&&!this.F9a){this.W$f();this.ej=this.rw.IKd();this.oW=this.rw.FMf(sd);if(!this.ej||!this.oW||!this.oW.range)return E.ULS.shipAssertTag(537159361,0,!!this.ej,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),E.ULS.shipAssertTag(537159360,0,!!this.oW,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),E.ULS.shipAssertTag(537159331,0,!!this.oW.range,
"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Hh=this.oW.range.clone();this.sourceRange=this.Hh.clone();this.Rfa=this.RHf(sd);if(4===this.Rfa)return E.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Fd=this.lKf(sd,!0);if(!Fd)return E.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.Pmf(Fd))return E.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.da.pLa=!0;this.ej.LO(!1);this.SP.Msf(sd.hi);this.rw.QAg(!0,this.lS.uma);this.ej.Xa.removeSelection();this.ej.Hnc(this.SQf);this.dEg();this.F9a=!0;pc.b(this.$,!0)}return!0};this.Yr=sd=>{sd=this.zoomManager.xl(sd);sd=this.lKf(sd,!1);if(!sd)return!0;sd=this.Pmf(sd);if(!sd)return E.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.ozc(!0),!1;if(this.Hh.equals(sd))return!0;
this.Hh=sd;sd=this.gAb();sd||(E.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.ozc(!0));return sd};this.Ho=sd=>{this.zoomManager.xl(sd);sd=this.L8();E.ULS.shipAssertTag(537159325,0,sd,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.ozc(!sd);return sd};this.SQf=()=>{this.ozc(!0)};this.da=Ca;this.zoom=id;this.$=Ca.$;this.hW=[];this.ha=this.da.ha;this.SP=qb;this.rw=nc;this.lS=Rc;Ca=ka.a.lh(oa.Gc);E.ULS.shipAssertTag(510255176,
0,!!Ca,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");this.XF=Ca.XF;for(const sd of this.DJg())Ca=this.rw.Qlf(C,sd,this.P6e(),this.onPointerDown),this.hW.push(Ca);for(const sd of this.hW)Ub.a.instance.xa(Ra.a.X7,sd,this.SP.nUf),Ub.a.instance.xa(Ra.a.jL,sd,this.SP.oUf);this.xfb(Rc)}dispose(){this.hW.forEach(C=>{Ub.a.instance.Oa(Ra.a.Bj,C,this.onPointerDown)});this.hW.length=0;super.dispose()}get zoomManager(){return this.zoom.zoomManager}xfb(C){this.lS=
C;this.X6e(C);this.rw.T8b(C,this.hW,this.tte());this.SP.NZ()}lKf(C,Ca){const qb=C.hi;C=C.clientPoint;if(!qb||!C)return E.ULS.shipAssertTag(537159324,0,!!qb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),E.ULS.shipAssertTag(537159323,0,!!C,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;Ca&&(C=this.Eeg(C));Ca=this.ha.$y(C,qb,0,!0,!1,!0);Ca||(C=this.Eeg(C),Ca=this.ha.$y(C,qb,0,!0,!1,!0));return Ca}Eeg(C){C.y+=0===this.Rfa||1===this.Rfa?2:-2;C.x+=0===this.Rfa||
2===this.Rfa?2:-2;return C}Pmf(C){if(!C||!this.sourceRange)return E.ULS.shipAssertTag(537159322,0,!!C,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),E.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.Rfa)return new Jc.Range(C.top,C.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.Rfa)return new Jc.Range(C.top,this.sourceRange.left,this.sourceRange.bottom,C.right,!0,!1);if(2===this.Rfa)return new Jc.Range(this.sourceRange.top,
C.left,C.bottom,this.sourceRange.right,!0,!1);if(3===this.Rfa)return new Jc.Range(this.sourceRange.top,this.sourceRange.left,C.bottom,C.right,!0,!1);E.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${of[this.Rfa]}`);return null}L8(){return this.XF.Deg(this.ej,this.oW,this.Hh)}gAb(){return this.L8()}ozc(C){C&&E.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate formula highlights as a fallback.");
this.SP.Nsf(this.hW[0]);this.rw.QAg(!1,this.lS.uma);this.ej.Xa.setCaretPositionToEnd();this.ej.IVc(this.SQf);this.F5g();this.F9a=this.da.pLa=!1;pc.b(this.$,!1);this.rw.ECg()}}Object(K.a)(Cf,"ResizeMarqueeBehaviorBase",Zc,[]);class Ff extends Cf{constructor(C,Ca,qb,nc,Rc,id){super(C,Ca,qb,nc,Rc,id)}DJg(){return[uc.uti,uc.vti,uc.sti,uc.tti]}P6e(){return[uc.rti]}RHf(C){C=C.hi;if(C===this.hW[0])return 0;if(C===this.hW[1])return 1;if(C===this.hW[2])return 2;if(C===this.hW[3])return 3;E.ULS.shipAssertTag(537159318,
0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}dEg(){this.rw.vqa(this.Yr,this.Ho,!0)}F5g(){this.rw.tAe(this.Yr,this.Ho,!0)}YTg(C){return 2===(Vc.a.ph=C.Gh)&&C.Lw===Sys.UI.MouseButton.leftButton}tte(){return!0}W$f(){E.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}X6e(C){for(const Ca of this.hW)Ca.style.backgroundColor=C.nl.style.borderColor}}Object(K.a)(Ff,"ResizeMarqueeMouseBehavior",
Cf,[]);class Wf extends Cf{constructor(C,Ca,qb,nc,Rc,id){super(C,Ca,qb,nc,Rc,id);this.j2b=()=>{const sd=3===Vc.a.ph;this.Y1d&&!sd?this.rw.T8b(this.lS,this.hW,!1):!this.Y1d&&sd&&this.rw.T8b(this.lS,this.hW,!0);this.Y1d=sd};this.v_j=(sd,Fd)=>{Fd.vVb===this.lS.uma&&this.rw.T8b(this.lS,this.hW,!Fd.start&&this.tte())};Vc.a.L5e(this.j2b);this.Y1d=3===Vc.a.ph;this.rw.sEh(this.v_j)}dispose(){Vc.a.DGg(this.j2b);super.dispose()}DJg(){return[ad.tb,ad.sb]}P6e(){return[ad.pb,ad.rb,ad.qb]}RHf(C){C=C.hi;if(C===
this.hW[0])return 0;if(C===this.hW[1])return 3;E.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}dEg(){Sa.a.uV?this.rw.vqa(this.Yr,this.Ho,!1):this.rw.Ojk(this.Yr,this.Ho)}F5g(){Sa.a.uV?this.rw.tAe(this.Yr,this.Ho,!1):this.rw.H7k(this.Yr,this.Ho)}YTg(C){return 3===(Vc.a.ph=C.Gh)}tte(){return 3===Vc.a.ph}W$f(){E.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}X6e(){}}
Object(K.a)(Wf,"ResizeMarqueeTouchBehavior",Cf,[]);class Mf extends Zc{constructor(C,Ca){super(C);Mf.mNb(C,cc.a.Lsi+" "+ad.v,null===Ca||void 0===Ca?void 0:Ca.horizontal);Mf.mNb(C,cc.a.Ksi+" "+ad.v,null===Ca||void 0===Ca?void 0:Ca.vertical);Mf.mNb(C,cc.a.Isi+" "+ad.v,null===Ca||void 0===Ca?void 0:Ca.horizontal);Mf.mNb(C,cc.a.Jsi+" "+ad.v,null===Ca||void 0===Ca?void 0:Ca.vertical);Mf.mNb(C,ad.Eb)}static mNb(C,Ca,qb){const nc=document.createElement("div");nc.className=Ca;qb&&(nc.style.backgroundImage=
`url("${qb}")`);C.appendChild(nc)}}Object(K.a)(Mf,"SelectionCutCopyBehavior",Zc,[]);class ng extends Zc{constructor(C){super(C);appChrome.renderSpinner(C)}}Object(K.a)(ng,"SelectionPasteBehavior",Zc,[]);class Rf extends Zc{constructor(C,Ca){super(C);Rf.DNb(C,cc.a.eti+" "+ad.v,null===Ca||void 0===Ca?void 0:Ca.horizontal);Rf.DNb(C,cc.a.dti+" "+ad.v,null===Ca||void 0===Ca?void 0:Ca.vertical);Rf.DNb(C,cc.a.bti+" "+ad.v,null===Ca||void 0===Ca?void 0:Ca.horizontal);Rf.DNb(C,cc.a.cti+" "+ad.v,null===Ca||
void 0===Ca?void 0:Ca.vertical);Rf.DNb(C,ad.Pb)}static DNb(C,Ca,qb){const nc=document.createElement("div");nc.className=Ca;qb&&(nc.style.backgroundImage=`url("${qb}")`);C.appendChild(nc)}}Object(K.a)(Rf,"SelectionRangePickerBehavior",Zc,[]);class $f extends jd{constructor(C,Ca,qb,nc,Rc){super(C,Ca,qb,nc,Rc)}get cba(){return 0}get Swb(){return this.da.ha.pa.oj}S8a(){const C=this.da.kq||this.da.isEditing;return this.da.ha.pa.Yn&&!C&&super.S8a()}}Object(K.a)($f,"SelectionTouchGrippiesBehavior",jd,[]);
var jf=a(60);let Hf=class extends Gb.a{constructor(C,Ca,qb,nc){super();this.hKb=(Rc,id)=>{Rc=id.cba;const sd=this.da;id=id.F9i;const Fd=id.nl,S=id.I$;switch(Rc){case 24:id.I$.push(new Oe(Fd,id));break;case 0:id.I$.push(new td(Fd,sd));Sa.a.Oy||(S.push(new xd(Fd,this.da.$,id.paneType,this.Qj,this.rw,this.zoom,this.m$i)),S.push(new Yb(Fd,this.da.$,id.paneType,this.Qj,this.rw,this.zoom)));S.push(new $f(id,Fd,sd,id.paneType,this.zoom));break;case 3:S.push(new Nd(Fd));Sa.a.Oy||(S.push(new wb(Fd,this.da.$,
id.paneType,this.SP,this.rw,id,this.zoom)),S.push(new Ff(Fd,this.da,this.SP,this.rw,id,this.zoom)),S.push(new Wf(Fd,this.da,this.SP,this.rw,id,this.zoom)));break;case 4:case 5:case 65:S.push(new Mf(Fd,this.s8e));break;case 30:S.push(new ng(Fd));break;case 16:S.push(new Rf(Fd,this.s8e));S.push(new Ye(id,Fd,sd,id.paneType,this.zoom));break;case 11:case 12:case 58:case 59:case 60:case 61:S.push(new nf(Fd,11===Rc||58===Rc||60===Rc,58===Rc||59===Rc||60===Rc||61===Rc));break;case 17:S.push(new Nd(Fd));
break;case 19:S.push(new Nd(Fd)),S.push(new Td(id,Fd,sd,id.paneType,this.zoom))}id.uKb=!0};this.$=C;this.zoom=qb;this.da=ha.f(C);this.m$i=nc;this.Qj=Ca;this.SP=new Ad(this.da);this.rw=new db(this.da);this.da.Fh&&(this.da.Fh.MDh(this.hKb),this.da.Fh.update(!1))}get s8e(){ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.r8e&&(this.r8e={vertical:jf.a.current.Tu(105),horizontal:jf.a.current.Tu(106)});return this.r8e}dispose(){this.da.Fh.Nok(this.hKb);this.SP&&(this.SP.dispose(),
this.SP=null);super.dispose()}};Hf=Object(ba.__decorate)([Object(ka.d)(oa.hd),Object(ba.__param)(0,Object(oa.Ob)()),Object(ba.__param)(1,Object(oa.yg)()),Object(ba.__param)(2,Object(oa.dh)()),Object(ba.__param)(3,Object(oa.rd)())],Hf);Object(K.a)(Hf,"GridHighlightsBehaviorManager",Gb.a,[]);var Uf=a(186),If=a(1337),sf=a(295),tc=a(1014),ld=a(190),Ed=a(24);class ze extends If.a{constructor(C,Ca,qb){super(C,Ca,qb);this.ojc=this.$Fa=null}get f_(){return Aa.AFrameworkApplication.ra.GL}AHf(C){switch(C){case 1:return Object(Ed.a)("ImageUploadNoFileSpecified");
case 2:return Object(Ed.a)("ImageUploadUnsupportedFileType");default:return""}}L9g(C){return ze.Yra(C,this.z0i())}z0i(){return ze.i1e}Yra(C,Ca){Ca=void 0===Ca?null:Ca;C=this.L9g(C);return 0!==C?(Ca&&Ca.C3e(),2===C&&(Ca=this.AHf(C),this.lp(0,Ca)),!1):!0}finalizeUpload(C,Ca){E.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.Obe=Ca;this.URk();sf.a.mark(5576);this.ojc=this.f_.Oi("LoadResource","PictureUploadTime")}lp(C,Ca){const qb=new ld.a;qb.Oh=0;qb.CL(C,Object(Ed.a)("ImageUploadFailedTitle"),
Ca,null)}Y2b(){E.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.Y2b();this.ojc&&(this.ojc.stop(),this.ojc=null);this.JZh()}URk(){this.$Fa=(new tc.a).create();this.$Fa.message=Object(Ed.a)("ImageUploadWait");this.$Fa.Oh=5;this.$Fa.xB=!1;this.$Fa.zQa(null,null,null)}JZh(){this.$Fa&&(this.$Fa.close(),this.$Fa=null)}static c8i(C,Ca){C=La.a.As(C);for(let qb=0;qb<Ca.length;++qb)if(C.endsWith(Ca[qb]))return!0;return!1}static Yra(C,Ca){Ca=void 0===Ca?null:Ca;Ca||(Ca=ze.i1e);return C?
ze.c8i(C,Ca)?0:2:1}}ze.i1e=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(K.a)(ze,"PictureUploader",If.a,[]);var ge=a(108),Ne=a(224),Ge=a(664),ca=a(431),sb=a(364),Ba=a(255),V=a(242),Fa=a(133),sc=a(249),Kc;(function(C){C[C.unknown=0]="unknown";C[C.bing=1]="bing";C[C.M365=2]="M365"})(Kc||(Kc={}));Object(K.b)("InsertMediaProviders",Kc);var qd=a(96),Eb=a(365),vc=a(1087),Kd=a(79);class Zd extends vc.a{constructor(C,Ca){super(C,Kd.a.getOrigin(Ca))}u5b(C,Ca){this.isEnabled()&&this.xX(this.targetOrigin)&&
(this.kr(C),this.pq(C,Ca))}}Object(K.a)(Zd,"InsertMediaCrossDocumentMessenger",vc.a,[901,441,2]);var nb=a(2);class ic{}Object(K.a)(ic,"OnlineMediaSearchResult",null,[]);var Bc=a(437),Qc;(function(C){C[C.OK=0]="OK";C[C.cancel=1]="cancel";C[C.error=2]="error";C[C.open=3]="open"})(Qc||(Qc={}));Object(K.b)("HubbleAction",Qc);class pd extends V.a{constructor(C,Ca,qb,nc,Rc,id){super();this.EIc=!1;this.c3d=this.kL=this.sLa=null;this.h3f=!1;this.correlationId=null;this.FPj=()=>{this.gJa(this.Kgb);this.dxb(1)};
this.y1d=sd=>{sd.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==sd.target.id||sd.shiftKey?"KeepFocusStartDiv"===sd.target.id&&sd.shiftKey&&(sd.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(sd.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.wXj=()=>{this.HJb&&(this.HJb.launchUpsellExperience("stockimages"),E.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.$Yj=sd=>{sd&&sd.Values&&(sd=sd.Values,delete sd.m_Origin,
delete sd.m_Source,delete sd.m_ReceivedTime,E.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+sd.eventName||!1),Ka.a.sendOtelEvent({otelEvent:sd}))};this.dialogTitle=id;this.$=C;this.NWf=Ca;this.HJb=qb;this.bja=[];this.Irb=nc;this.dgi=Rc;this.I7e=this.$.ua.InsertOnlinePictureMaxCountOfImagesToInsert;this.rp=this.h8h();this.h3f=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8665911_RemoveMediaDetailsInTelemetry")}JRk(C){this.EIc=!1;this.showDialog(this.dialogTitle,null);this.sLa=document.getElementById(this.hp("InsertMediaFrame"));
if(!this.sLa)throw this.gJa(this.Kgb),Error.invalidOperation("Couldn't get InsertMediaIframe.");const Ca=document.getElementById(this.hp("WACDialogPanel"));Ca&&Ca.setAttribute(mc.a.fk,mc.a.mWa);var qb=document.createElement("div");qb.id="KeepFocusStartDiv";qb.tabIndex=0;qb.className="keep-focus-start";this.sLa.parentNode.insertBefore(qb,this.sLa.parentNode.firstChild);qb=document.createElement("div");qb.id="KeepFocusDiv";qb.tabIndex=0;qb.className="keep-focus";this.correlationId=Zb.a.create();this.sLa.parentNode.appendChild(qb);
$addHandler(this.ijb,"keydown",this.y1d);this.sLa.src=this.NWf;this.sLa.frameBorder="0";qb=document.getElementById(this.hp("WACDialogButtonPanel"));if(!qb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");qb.className="display-none";qb=document.getElementById(this.hp("WACDialogTitleText"));if(!qb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");qb.className="display-none";2===this.Irb&&(document.getElementById(this.hp("WACDialogTitlePanel")).className="display-none",
document.getElementById(this.hp("WACDialogBodyPanel")).className="padding-zero");ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8728224_StockImagesDialogHeightFix")&&Ca&&(Ca.style.overflow="hidden",Ca.style.height="auto",qb=document.getElementById(this.hp("WACDialogOuterContainer")))&&(Ca.style.marginTop="",Ca.style.top=(qb.parentElement.clientHeight-Ca.clientHeight)/2+"px");Fa.FocusManager.instance().j1().scope.S1=!0;this.kL=new Zd(this.sLa.contentWindow,this.NWf);this.kL.xX("https://osiziwuspersimmon002.blob.core.windows.net");
this.kL.xX("https://osizewuspersimmon001.blob.core.windows.net");this.kL.xX("https://osizpscuspersimmon000.blob.core.windows.net");this.kL.xX("https://cdn.hubblecontent.msit.osi.office.net");this.kL.xX("https://cdn.hubblecontent.osi.office.net");this.kL.u5b(Ea.a.Ezh,nc=>{this.rOj(nc,C.Wja)});this.kL.u5b(Ea.a.insert,()=>{this.SWj(C.Wja)});this.kL.u5b(Ea.a.Avd,this.FPj);this.kL.u5b(Ea.a.jAh,nc=>{this.$Yj(nc)});2===this.Irb&&0===this.dgi&&(this.kL.u5b(Ea.a.mxj,this.wXj),this.c3d=this.HJb.R6a("MsoPremiumStockImages",
nc=>{E.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");nc.isEnabled?this.kL.sendMessage(Ea.a.vcl,{["LicenseTier"]:nc.toString()}):E.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.dxb(3)}dispose(){this.bja=null;this.HJb&&this.c3d&&this.HJb.fje("MsoPremiumStockImages",this.c3d);this.kL&&(this.kL.dispose(),this.kL=null);super.dispose()}hide(){super.hide();qd.a.lZc(this.$)}get Ega(){return sc.a.Kvc+
"/InsertMediaDialog"}get ufa(){return!1}rOj(C,Ca){C=C&&C.Values?(C=C.Values)?Object(nb.a)(new ic,{Action:C.action||"",Caption:C.caption||"",ContentType:C.contentType||"",FileExtension:C.extension||"",PageUrl:C.pageUrl||"",SourceUrl:C.sourceUrl||"",ThumbnailUrl:C.thumbnailUrl||"",LicenseUrl:C.licenseUrl||"",LicenseDisplayName:C.licenseDisplayName||"",Height:C.height||0,Width:C.width||0}):null:null;C&&(this.bja.push(C),this.EIc&&(E.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),
Ca(this.bja),this.EIc=!1,this.gJa(this.Kgb)))}SWj(C){this.bja&&0<this.bja.length?this.bja.length<=this.I7e?(C(this.bja),this.dxb(0),this.gJa(this.Kgb)):(this.CL(),E.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.bja.length=0,this.dxb(2)):this.EIc=!0}h8h(){const C=document.createElement("div");C.id="InsertMediaDialog";C.className=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":
"insert-media-dialog-old";const Ca=document.createElement("div");Ca.id="InsertMediaPanel";Ca.className=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";const qb=document.createElement("iframe");qb.id="InsertMediaFrame";qb.className="insert-media-frame";C.appendChild(Ca);Ca.appendChild(qb);return Bc.b(C)}CL(){const C=he.a.nj(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");C.Description=
String.format(qa.a.instance.sh(206),this.I7e.toLocaleString());new Eb.a(this.$,C)}XQi(){return 2===this.Irb?"M365":"bing"}dxb(C){var Ca,qb;if(2===this.Irb||1===this.Irb){const Rc=Aa.AFrameworkApplication.ea.Ya("InsertMediaDialogAriaTenantNameSpace");if(Rc&&""!==Rc){var nc=[{name:"DialogMode",string:this.XQi()},{name:"Provider",string:Kc[this.Irb]},{name:"InsertedFiles",int64:null===(Ca=this.bja)||void 0===Ca?void 0:Ca.length},{name:"DialogResult",string:Qc[C]},{name:"CorrelationId",string:null===
(qb=this.correlationId)||void 0===qb?void 0:qb.toString()}];this.h3f||nc.push({name:"MediaDetails",string:this.bja?JSON.stringify(this.bja.map(id=>id.SourceUrl)):null});Ka.a.sendTelemetryEvent({name:String.format("{0}.{1}",Rc,"InsertOnlineImages"),dataFields:nc})}}}}Object(K.a)(pd,"InsertMediaDialog",V.a,[]);var Xd=a(442),ue=a(337),Ie=a(363);class Je extends ze{constructor(C,Ca,qb,nc,Rc,id){super(null,qb,nc);this.Gag=0;this.Wja=sd=>{if(sd){var Fd=Array(sd.length);for(var S=0;S<sd.length;S++){const Ec=
sd[S];Fd[S]={};Fd[S].SourceUrl=Ec.SourceUrl;La.a.uha(Ec.LicenseUrl)&&La.a.uha(Ec.PageUrl)&&(Fd[S].LicenseUrl=Ec.LicenseUrl,Fd[S].LicenseDisplayName=Ec.LicenseDisplayName,Fd[S].PageUrl=Ec.PageUrl);Fd[S].AltText=-2053056795===this.Nh.command?Ec.Caption:"";Fd[S].IsCellPicture=15735758===this.Nh.command||570484235===this.Nh.command}var Ua=-2009825598===this.Nh.command?"bing":"M365";S=ha.f(this.$);var Hb=Qa.q(S.ha.pa.activeCell,this.$);ca.a(this.$.userOperationManager,(Ec,cd,Bd)=>sb.x(this.$.oa.ta,Hb,
Fd,Ua,gc.c(Ec,this.rZj),gc.b(cd,this.qZj),Bd,null),Ec=>new od.a(595,0,Ec),this.Nh);wd.HelperMethods.yba?(S=new Map,S.set("MediaProvider",Ua),S.set("ImagesCount",sd.length.toString()),S.set("TimeTakenToOpenDialog",this.Gag.toString()),ge.Health.instance.recordKpiUsage(ue.a.Kfj,Ie.b.SuccessBased,Xd.a.P0g,S)):E.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Y2b()}else E.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};
this.rZj=sd=>{if(Ba.a(sd))E.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${he.a.fi(sd.Errors)}`);else{E.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");const Fd=this.Nh.command;15735758!==Fd&&570484235!==Fd&&(sd.Result?cb.a(this.$).IPa(1,sd.Result):E.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};
this.qZj=()=>{E.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=C;this.Nh=Ca;this.KT=id;this.y8e=Ne.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let C=null;C=this.$.Eh.Oi("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Nh.command){case -2009825598:case 15735758:this.QQk();break;case -2053056795:case 570484235:this.y8e.execute(Ca=>{Ca.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(qb=>E.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${qb}`)).then(qb=>{this.RQk(qb);return null})})}C.stop();this.Gag=C.Ci}QQk(){let C=this.$.ua.BingPictureEndpoint;const Ca=Ge.a.bS(Aa.AFrameworkApplication.lcid),qb=Zb.a.create();C?(C=0<C.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(C,1,1):String.format(C,1,Aa.AFrameworkApplication.lcid,Ca?Ca.name:"en-us",Aa.AFrameworkApplication.buildVersion,
qb.toString(),1,this.$.ua.DocumentHostInfo.LoggableUserId),this.Ltc(C,1,-1,qa.a.instance.ia(1764))):(E.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.KT.setException(Error.create("Failed to access the Bing service endpoint")))}RQk(C){var Ca=this.$.ua.M365PictureEndpoint,qb=Zb.a.create();if(Ca){var nc=this.$.ua.DocumentHostInfo.UserId;nc=nc?La.a.uE(nc).toString():"0";var Rc=this.y8e.instance.isFreemiumUpsellEnabled();
C=C?1:Rc?0:-1;qb=qb.toString();Rc=Ge.a.bS(Aa.AFrameworkApplication.lcid).name;Ca=String.format(Ca,Aa.AFrameworkApplication.lcid,Rc,Aa.AFrameworkApplication.buildVersion,qb,1,nc,C,1);this.Ltc(Ca,2,C,qa.a.instance.ia(1763))}else E.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.KT.setException(Error.create("Failed to access the M365 service endpoint"))}Ltc(C,Ca,qb,nc){try{(new pd(this.$,C,Ne.a.instance.rI("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Ca,qb,nc)).JRk(this),this.KT.setResult(!0)}catch(Rc){E.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${Rc}] [MediaProvider : ${Ca}] [DialogLicenseTier : ${qb}]`),this.KT.setException(Rc)}}}Object(K.a)(Je,"OnlinePictureUploaderWrapper",ze,[2]);let He=class{constructor(C,Ca){this.$=C;this.uploaderCreator=Ca}executeCommand(C,Ca,qb){C=Ca.command;switch(C){case 1403967063:case -2060689045:if(qb&&"dataUrl"in qb)return Ca=new Uf.a,this.uploaderCreator&&
this.uploaderCreator.Xcj(this.$,ea.TaskManager.instance,Aa.AFrameworkApplication.ea,qb,qb.dataUrl,Ca),Ca.task;this.uploaderCreator&&this.uploaderCreator.iej(this.$,Ca,ea.TaskManager.instance,Aa.AFrameworkApplication.ea,qb);return Xa.Task.Ua(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return C=new Uf.a,new Je(this.$,Ca,ea.TaskManager.instance,Aa.AFrameworkApplication.ea,qb,C),C.task;default:return Ja.a(C)}}Ei(C,Ca){let qb=this.$.isEditMode;if(qb)switch(Ca.command){case 1403967063:qb=
!0;break;case -2053056795:qb=!0;break;case -2009825598:qb=!0;break;case -2060689045:case 15735758:case 570484235:qb=rc.a.FXb()&&1===C;break;default:qb=!1}return qb}dj(){return!1}Ri(){return!1}};He=Object(ba.__decorate)([Object(ka.d)(oa.Bd),Object(ba.__param)(0,Object(oa.Ob)()),Object(ba.__param)(1,Object(oa.Ng)())],He);Object(K.a)(He,"PictureCommandHandler",null,[36]);var hf=a(73);class rf{}rf.rhi="DisplayNotInvoked";rf.xDd="Displayed";rf.zak="PrerequisitesNotReady";Object(K.a)(rf,"PasteIndicationDisplayStatus",
null,[]);var qf=a(58),We=a(54),Jf=a(33),tf=a(311),ff=a(940),xf;let Lf=xf=class{constructor(C){this.QNb="";this.oG=this.tC=null;this.Mtb=new Map;this.Pea=null;this.gTc=!1;this.jTf=(Ca,qb)=>{this.hide(void 0===Ca?null:Ca,void 0===qb?null:qb)};this.$=C;this.da=ha.f(C);this.da.ha.cx(this.jTf)}QDd(){this.gTc||(E.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.da.$.q6(C=>{C.Iaa(0).then(()=>{this.gTc=!0})}))}fzk(C){this.QDd();this.QNb=
C;this.aNg(C)}PMg(C){const Ca=C.commandParameters.id;E.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${Ca}, cancelCtx is null = ${!this.tC}, PrerequisitesDownloaded = ${this.gTc}`);this.QDd();this.QNb=Ca;const qb=!this.Tfg();if(!this.tC||qb)this.nef(),this.tC=qf.a.instance.create(()=>{this.qhi(C)},void 0===C.timeoutToShowSpinnerInMs||null===C.timeoutToShowSpinnerInMs?100:C.timeoutToShowSpinnerInMs,We.a.T6j);this.Pea=C.commandParameters.originalDestinations;
this.aNg(Ca)}qhi(C){this.gTc?(this.display(C.commandParameters.originalDestinations),C.pasteIndicationDisplayStatus=rf.xDd):(E.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),C.pasteIndicationDisplayStatus=rf.zak)}aNg(C){this.Mtb.set(C,Jf.a.kh.Xj);qf.a.instance.create(()=>{this.Chi(C)},this.$.ua.PasteToastNotificationDelayTime,We.a.U6j)}Chi(C){this.Mtb.has(C)&&(this.oG?this.oG.displayTimeoutSeconds+=this.$.ua.PasteToastNotificationDefaultDisplayDuration:
(C=qa.a.instance.ia(2341),this.oG=Uc.a.fB.eL.WX(C,!1),this.oG.image=5,this.oG.v1=ff.a.Aik,this.oG.displayTimeoutSeconds=this.$.ua.PasteToastNotificationDefaultDisplayDuration,Uc.a.fB.eL.HF(this.oG)))}cha(C,Ca,qb){C&&this.oG&&(C=qb?`"${Ca}" ${qa.a.instance.ia(2433)}`:qa.a.instance.ia(2342),this.oG.w4c(C),this.oG.image=5,this.oG.v1=qb?ff.a.F1k:ff.a.lgf);setTimeout(()=>{this.bnk()},3E3)}bnk(){this.oG&&(Uc.a.fB.eL.removeEntry(this.oG),this.oG=null)}display(C){E.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");
this.da.Fh.wQ(Ve.a.l$a(hf.d(this.da.$.la),C),xf.kSc,!0);this.da.Fh.Qw(xf.kSc)}I0a(C,Ca,qb,nc){Ca=void 0===Ca?!0:Ca;qb=void 0===qb?null:qb;nc=void 0===nc?!1:nc;E.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${C}, currentPasteCommandId = ${this.QNb}`);C&&Ma.a.equals(C,this.QNb,!1)&&this.hide();if(C&&this.Mtb.has(C)){const Rc=tf.a(Jf.a.kh.Xj,this.Mtb.get(C));6E4<Rc&&E.ULS.sendTraceTag(508839751,0,50,`PasteIndicationManager.hideForPasteId: large paste. CommandId (${C}), scheduleDisplayToHideDurationInMs (${Rc}))`);
this.Mtb.delete(C);null!=this.oG&&0===this.Mtb.size&&this.cha(Ca,qb,nc)}}hide(C){this.Pea&&(void 0===C?0:C)&&this.Tfg()&&E.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.QNb="";this.nef();this.Pea=null;0!==this.da.Fh.VKd([30]).length&&(this.da.Fh.fr(xf.kSc),this.da.Fh.wt(null,xf.kSc))}Tfg(){return Qa.X(this.da.ha.pa.selectedRanges,this.Pea)}nef(){this.tC&&($b.a.gh(this.tC),
this.tC=null)}dispose(){this.hide();this.oG&&this.cha(!1);this.da.ha.Bx(this.jTf)}};Lf.kSc=[30];Lf=xf=Object(ba.__decorate)([Object(ka.d)(oa.De),Object(ba.__param)(0,Object(oa.Ob)())],Lf);Object(K.a)(Lf,"PasteIndicationManager",null,[842,2]);var Ig=a(160);Object(ka.b)(oa.Ee,{rk:"singleton"})(C=>xo(function*(){const Ca=yield ka.a.resolve(oa.Ob,C),qb=Kb.a.instance,nc=Ig.a.instance.KU();return new vf(Ca,qb,nc)}));class vf extends ac.a{constructor(C,Ca,qb){super();this.statusBarManager=null;this.Zqf=
()=>{this.awc()};this.Igi=()=>{this.awc()};this.Yqf=nc=>{10===nc&&this.awc()};this.onKeyDown=nc=>13===nc.La.keyCode?(nc=new Nb.a(237279923,1,2,6,null),this.$.Ia.qh(nc,{[X.a.skipClipboardAccess]:!0,[X.a.vvf]:!0}),!0):!1;this.$=C;this.UD=Ca;this.du=qb;this.rFd=!1;this.$.qa.zi(29,nc=>{this.statusBarManager=nc;nc.vO(this)})}dispose(){this.xo();this.du=this.UD=this.$=null;this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null)}Up(){return!0}Aw(C,Ca){if("QueryPasteShortcutEnabledLabel"!==
C&&!vf.zXk.includes(C))return!1;const qb=this.JP();"QueryPasteShortcutEnabledLabel"===C?(Ca.Visible=qb,E.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${qb} for commandId ${C}`)):(Ca.Visible=!qb,E.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!qb} for commandId ${C}`));return!0}Yli(){this.Kp();this.raiseEvent("pasteShortcutStatusChanged")}awc(){this.xo();this.raiseEvent("pasteShortcutStatusChanged")}JP(){return this.rFd}ry(C){this.addHandler("pasteShortcutStatusChanged",
C)}fy(C){this.removeHandler("pasteShortcutStatusChanged",C)}Kp(){if(!this.JP()){this.rFd=!0;ha.f(this.$).Fp.Mv(this.Zqf);this.du.Ga("blur",this.Igi);const C=ka.a.lh(oa.Rb);C&&C.Ifa&&C.Ifa.registerForCommentEvents(this.Yqf);this.UD.aE(Ra.a.Wi,this.$.wK,this.onKeyDown,!0)}}xo(){if(this.JP()){this.rFd=!1;ha.f(this.$).Fp.Cv(this.Zqf);this.du.detach("blur");const C=ka.a.lh(oa.Rb);C&&C.Ifa&&C.Ifa.unregisterForCommentEvents(this.Yqf);this.UD.lE(Ra.a.Wi,this.$.wK,this.onKeyDown,!0)}}}vf.zXk=["QuerySheetNumberButton",
"QueryWorkbookStatisticsButton"];Object(K.a)(vf,"PasteShortcutManager",ac.a,[844,176,177,2]);const rg=C=>{switch(C){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;
case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var jg=a(217),sg=a(122);class af{static get Dfk(){return af.cXe||(af.cXe=RegExp("([A-Z]+)","g"))}static get Cfk(){return af.bXe||(af.bXe=RegExp("([A-Z])","g"))}static get wXh(){return af.VJe||(af.VJe=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static OOd(C){return af.JLf(C.toString())}static JLf(C){return af.wXh.test(C)?
C.replace(af.Dfk,"$1 ").replace(af.Cfk,' "$1"').trim():C}static Zrk(C){const Ca=C.lastIndexOf("!");return C.substring(0,-1<Ca?Ca+1:0)+af.JLf(C.substring(-1<Ca?Ca+1:0,C.length))}}af.cXe=null;af.bXe=null;af.VJe=null;Object(K.a)(af,"RangeAriaExtensions",null,[]);class Ef{constructor(){this.activeItemName=null;this.I3f=!1;this.tableName=null;this.Phb=0;this.U1c=!1}}Object(K.a)(Ef,"SelectionReadoutState",null,[]);var be=a(199),h=a(971),qc;let ma=qc=class{constructor(C,Ca,qb,nc,Rc){this.kHa=this.gridReadoutNotifier=
null;this.dNg=!1;this.mqa=()=>{ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?E.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):ha.f(this.$).isEditing&&!ha.f(this.$).inRangePicker||this.tpc.PA()};this.mOj=()=>{if(!ha.f(this.$).ha.$a.jZd){var id,sd=(()=>{let Fd=this.QEi();({activeCell:id}=Fd);return Fd})().returnValue;this.readText(sd,id)}};this.WS=()=>{const id=this.activeCell;this.readText("Editing",id);
ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||id&&id.CEc&&!ha.f(this.$).NRf||this.tpc.cancel()};this.Gj=()=>{ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?E.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):this.mqa()};this.$=Ca;this.ariaLiveNotifier=C;this.A$b=nc;this.Qj=qb;this.FN=new Ef;this.Kob=Oa.Kob();this.dNg=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8582263_ScreenReaderShapeInfoReadoutEnabled");
this.Kob&&(this.gridReadoutNotifier=Rc,E.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7945213_removeActiveCellDelayForBraille")?qc.bod=0:qc.bod=700);this.tpc=qf.a.instance.create(this.mOj,qc.bod,We.a.nBk,!1);this.Kp()}get activeCell(){return ha.f(this.$).yh(null)}dispose(){this.$&&this.xo();$b.a.gh(this.tpc);this.A$b=this.$=this.tpc=null}NAc(C,Ca,qb){qb=void 0===qb?!0:qb;
if(null!==this.$.vh.Pn&&"FindAndReplaceDialog"===this.$.vh.Pn.Ji||!C)return"";var nc=this.$.qa;const Rc=new Sys.StringBuilder;this.rJh(Rc,C,Ca);if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var id=this.Qj.Axa(C.range);(null===id||void 0===id?0:id.Zte)&&this.R8e(Rc,id);id=this.Qj.Fy(C.range);(null===id||void 0===id?0:id.Zxa)&&this.R8e(Rc,id)}id=C.y6?this.VIf(C):C.text;ja(Rc,id);id=this.$.activeItemName;this.FN.activeItemName!==id&&(ja(Rc,id),this.FN.activeItemName=
id);id=1===Ca.length?Qa.R(Ca).isSingle?"":qa.a.instance.ia(853):String.format(qa.a.instance.sh(31),Ca.length);ja(Rc,id);for(var sd of Ca)id=this.Kob?sd.toString():af.OOd(sd),ja(Rc,id),1===Ca.length&&qc.Ytj(sd)&&(id=ha.f(this.$).za.Wx(sd.bottomRight),void 0!==id&&null!==id&&id.text&&(id=id.y6?this.UIf(id,id.text):id.text,ja(Rc,id)));sd=C.cell;sd=this.rTi(sd.bxk,sd.D_h);ja(Rc,sd);this.aJh(Rc,C);qb&&(C.opb?ja(Rc,qa.a.instance.ia(841)):C.F2a&&ja(Rc,qa.a.instance.ia(842)));if(C.hasAutoFilter||C.Una)this.sJh(Rc,
C.hasAutoFilter?C.cell.autoFilterType:C.cell.X7j),qb&&ja(Rc,qa.a.instance.ia(844));jg.d(this.$,C.range)&&ja(Rc,qa.a.instance.ia(848));this.ZIh(Rc,C);qb=(qb=ka.a.lh(oa.ub))?qb.SFi():"";ja(Rc,qb);C.LC&&(qb=ha.f(this.$).za.Wx(C.range),qb=!!qb&&qb.hasIgnorableError,qc.nMk(C)?qc.$Ih(Rc,C):ta.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&qb?ja(Rc,qa.a.instance.ia(846)):ja(Rc,qa.a.instance.ia(845)));C.jS&&(ja(Rc,qa.a.instance.ia(847)),C.oUb&&ja(Rc,String.format(qa.a.instance.sh(16),
C.tci)),ja(Rc,C.iconName));C.hasRichValueIcon&&(sd=ka.a.lh(oa.jb),qb="",sd&&C.cell.pMc&&(sd=sd.H5(C.cell.pMc))&&sd.DomainId.Id!==qc.Ugl&&(qb=sd.Name),C.cell.eij?(ja(Rc,String.format(qa.a.instance.sh(187),qb)),ja(Rc,qa.a.instance.ia(1812))):(ja(Rc,String.format(qa.a.instance.sh(185),qb)),ja(Rc,qa.a.instance.ia(1811))));this.u7i(C)&&ja(Rc,qc.PNi(C));(nc=nc.zh(231))&&ja(Rc,nc.kJf(Ca,!0));1===Ca.length&&Ca[0].isSingle&&qc.mMk(C,Ca[0])&&(Ca=ka.a.lh(oa.jb))&&ja(Rc,Ca.iGi());C.Tac&&C.Uac&&ja(Rc,C.Uac);(Ca=
C.cell.gwd)&&ja(Rc,Ca);this.YIh(Rc,C);C.C2a&&C.N3b&&(C=C.Bde)&&(ja(Rc,qa.a.instance.ia(1985)),ja(Rc,C));return Rc.toString()}bdf(C){this.kHa=this.FN;this.FN=Object(nb.a)(new Ef,{activeItemName:this.kHa.activeItemName,U1c:C?this.kHa.U1c:!1,tableName:C?this.kHa.tableName:"",Phb:C?this.kHa.Phb:-1})}VJg(){this.kHa&&(this.FN=this.kHa,this.kHa=null)}rTi(C,Ca){return 2===C||2===Ca?qa.a.instance.ia(875):1===C||1===Ca?qa.a.instance.ia(876):""}VIf(C){return this.UIf(C.cell,C.text)}rJh(C,Ca,qb){if(qb&&1===qb.length&&
qb[0].isSingle){qb="";var nc=this.Qj.Axa(Ca.range);if(nc){qb=nc.pivotTableName;this.Prd(C,qb);var Rc=nc.KHc?qa.a.instance.ia(835):"";ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Rc+=(nc.altText?nc.altText+" . ":"")+(nc.altTextSummary?nc.altTextSummary:""));this.T8e(C,!0,qb,Rc);ja(C,this.Qj.Hrj(nc,Ca.range)?qa.a.instance.ia(838):"");ja(C,this.Qj.Ejj(nc,Ca.range)?qa.a.instance.ia(837):"")}else if(nc=this.Qj.Fy(Ca.range)){qb=(Rc=ha.f(this.$).oh.Ml(Ca.range))?
Rc.name:"";this.Prd(C,qb);let id="";Rc&&(id=(Rc.U9a?Rc.U9a+" . ":"")+(Rc.V9a?Rc.V9a:""));this.T8e(C,!1,qb,id);ja(C,this.Qj.s0f(nc,Ca.range)?qa.a.instance.ia(837):"")}else this.Prd(C,qb),this.FN.tableName="",this.FN.Phb=-1}}Prd(C,Ca){Ca!==this.FN.tableName&&this.FN.tableName&&(C.append(qa.a.instance.ia(this.FN.U1c?834:833)),ja(C," "+this.FN.tableName))}T8e(C,Ca,qb,nc){qb!==this.FN.tableName&&(C.append(qa.a.instance.ia(Ca?832:831)),ja(C," "+qb),ja(C,nc),this.FN.tableName=qb,this.FN.U1c=Ca,this.FN.Phb=
-1)}R8e(C,Ca){const qb=ha.f(this.$).ha.pa.activeCell;if(qb.top!==Ca.top&&qb.left!==this.FN.Phb){C.append(qa.a.instance.ia(837));Ca=new Jc.Range(Ca.top,qb.left,Ca.top,qb.left,!0,!0);ja(C,af.OOd(Ca));if(Ca=ha.f(this.$).yh(Ca))Ca=Ca.y6?this.VIf(Ca):Ca.text,ja(C,Ca);this.FN.Phb=qb.left}}UIf(C,Ca){const qb=C.QE;return C.Wxa?String.format(qa.a.instance.sh(14),Ca,qb):String.format(qa.a.instance.sh(13),Ca,af.Zrk(qb))}Kp(){E.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var C=
ha.f(this.$);E.ULS.shipAssertTag(537153929,0,!!C,"Can't register to grid's events");C&&(C.Dh.Mv(this.WS),C.za.qy(this.mqa),C.zO(this.mqa),C=C.ha,E.ULS.shipAssertTag(537153928,0,!!C,"Can't register to selectionManager's events"),C&&(C.cx(this.Gj),C.add_activeCellChanged(this.mqa),C.$a.AO(this.mqa)))}}xo(){if(this.$){var C=ha.f(this.$);C&&(C.Dh.Cv(this.WS),C.za.Ax(this.mqa),C.oQ(this.mqa),C=C.ha)&&(C.Bx(this.mqa),C.remove_activeCellChanged(this.mqa),C.$a.dW(this.mqa))}}readText(C,Ca){this.Kob&&this.gridReadoutNotifier&&
(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.gridReadoutNotifier.isActive)?this.gridReadoutNotifier.readText(C):(this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(C),Ca&&this.ariaLiveNotifier.M8k(Ca))}QEi(){let C;C=null;var Ca=ha.f(this.$).ha;if(1!==Ca.Hk&&!Ca.$a.Ih)return E.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${Ca.Hk} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:C};
switch(Ca.Hk){case 2:return{returnValue:this.fIi(Ca),activeCell:C};case 64:var qb=Ca.$a.Ih.floatingObject;let nc="";if(Ca=Ca.$a.Ih.bC||Ca.$a.Ih.Pj)nc=(Ca=Ca.firstChild)?ia.DOMElementExtensions.getTextContent(Ca):"";return this.dNg?{returnValue:this.IXi(qb),activeCell:C}:{returnValue:String.format(qa.a.instance.sh(53),qc.oAc(qb.altText,qb.altTextDescription,qb.name),nc,qb.altTextDescription),activeCell:C};case 4:return{returnValue:qc.iIh(Ca.$a.Ih.floatingObject),activeCell:C};case 512:return{returnValue:sg.a.qHf(Ca.$a.Ih.floatingObject.kEd),
activeCell:C};case 8:return qb=Ca.$a.Ih.floatingObject,{returnValue:String.format(qa.a.instance.sh(51),qb?qb.name:""),activeCell:C};case 1:return C=this.activeCell,qb=Ca.pa.selectedRanges,ha.f(this.$).inRangePicker?this.rVi(Ca,C):{returnValue:this.NAc(C,qb),activeCell:C}}return{returnValue:"",activeCell:C}}rVi(C,Ca){C=C.rangePicker.DZ.map(nc=>nc.range);const qb=ha.f(this.$).yh(C[0]);return{returnValue:this.NAc(qb,C),activeCell:Ca}}fIi(C){const Ca=new Sys.StringBuilder;Ca.append(qc.HWh(C));const qb=
this.$.qa.zh(231);qb&&ja(Ca,qb.kJf(C.$a.Ih.floatingObject,!1));return Ca.toString()}IXi(C){var Ca,qb,nc,Rc,id,sd=null;isNullOrUndefined(null===(Ca=C.Ch)||void 0===Ca?void 0:Ca.ShapeFillColor)||(-1===C.Ch.ShapeFillColor?sd=C.Ch.HasEffects?"gradient":null:(sd=(null===(qb=C.Ch)||void 0===qb?0:qb.IsShapeConnector)?be.a.j3(C.Ch.ShapeOutlineColor):be.a.j3(C.Ch.ShapeFillColor),sd=be.a.Pu(sd.toUpperCase()),sd=h.a.rKa(sd)));qb=!La.a.rHa(sd);return(Ca=!La.a.rHa(null===(nc=C.Ch)||void 0===nc?void 0:nc.ShapeText))&&
qb?String.format(qa.a.instance.sh(235),C.altText,C.altTextDescription,C.name,sd,null===(Rc=C.Ch)||void 0===Rc?void 0:Rc.ShapeText):!qb&&Ca?String.format(qa.a.instance.sh(236),C.altText,C.altTextDescription,C.name,null===(id=C.Ch)||void 0===id?void 0:id.ShapeText):!Ca&&qb?String.format(qa.a.instance.sh(237),C.altText,C.altTextDescription,C.name,sd):String.format(qa.a.instance.sh(234),C.altText,C.altTextDescription,C.name)}u7i(C){C=C.MYf();let Ca=!1;this.FN.I3f!==C&&(this.FN.I3f=C,Ca=!0);return Ca}aJh(C,
Ca){if(Ca.anb)if(Ca=this.A$b.uYi(Ca)){var qb=qa.a.instance,nc=qb.ia;a:switch(Ca.type){case 0:var Rc=828;break a;case 1:Rc=829;break a;default:Rc=830}qb=nc.call(qb,Rc);ja(C,String.format(qa.a.instance.sh(25),qb));Ca=String.format(qa.a.instance.sh(24),af.OOd(Ca.PVk));ja(C,Ca)}else E.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),ja(C,String.format(qa.a.instance.sh(25),""))}sJh(C,Ca){switch(Ca){case 1:case 11:ja(C,qa.a.instance.ia(849));break;case 6:ja(C,qa.a.instance.ia(849));
ja(C,qa.a.instance.ia(851));break;case 7:ja(C,qa.a.instance.ia(849));ja(C,qa.a.instance.ia(852));break;case 2:ja(C,qa.a.instance.ia(850));ja(C,qa.a.instance.ia(851));break;case 3:ja(C,qa.a.instance.ia(850));ja(C,qa.a.instance.ia(852));break;default:ja(C,qa.a.instance.ia(850))}}ZIh(C,Ca){var qb;const nc=ka.a.lh(oa.Rb);Ca=nc?nc.aKa(Ca.range):null;let Rc="";const id=Object(qe.a)(432,Ca);if(Ca)Rc=!Ca.Xob&&id&&id.vtj?String.format(qa.a.instance.sh(29),id.n_k):String.format(qa.a.instance.sh(23),Ca.author);
else if(null===(qb=null===nc||void 0===nc?void 0:nc.zv)||void 0===qb?0:qb.xP)Rc=String.format(qa.a.instance.sh(28),nc.zv.gZ.author);ja(C,Rc)}YIh(C,Ca){const qb=oa.L.Ma()?ka.a.lh(oa.L):this.$.qa.zh(286);qb&&(Ca=qb.UFi(hf.d(this.$.la),Ca.range))&&0<Ca.length&&(Ca=String.format(qa.a.instance.sh(1===Ca.length?220:221),Ca[0]),ja(C,Ca))}static iIh(C){return String.format(qa.a.instance.sh(52),qc.oAc(C.altText,C.altTextDescription,C.name),C.altTextDescription)}static PNi(C){return qa.a.instance.ia(C.MYf()?
839:840)}static oAc(C,Ca,qb){return C||Ca?C:qb}static HWh(C){var Ca=C.$a.Ih;C=Ca.floatingObject;const qb=C.Ui,nc=qb.ChartTitle,Rc=C.altText,id=C.altTextDescription,sd=!!(qb.Attributes&4);return(Ca=Ca.getSelectionDescription())?Ca:qb.DataRangeForDisplay?String.format(qa.a.instance.sh(sd?49:47),qc.oAc(Rc,id,C.name),id,nc,qa.a.instance.ia(rg(qb.ChartCategory)),qb.DataRangeForDisplay):String.format(qa.a.instance.sh(sd?50:48),qc.oAc(Rc,id,C.name),id,nc,qa.a.instance.ia(rg(qb.ChartCategory)))}static nMk(C){return ta.EwaSettings.Na(101)&&
(C.XWb||C.GHc)}static $Ih(C,Ca){Ca.A9a?Ca.XWb?ja(C,String.format(qa.a.instance.sh(26),Ca.A9a.topLeft.toString())):Ca.GHc&&(Ca=Ca.A9a.mF(),ja(C,String.format(qa.a.instance.sh(27),(Ca.LastColumn-Ca.FirstColumn+1).toString(),(Ca.LastRow-Ca.FirstRow+1).toString()))):E.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static mMk(C,Ca){return C.LC||!ta.EwaSettings.Na(131)?!1:(C=ka.a.lh(oa.jb))?
C.iHc(Ca):!1}static Ytj(C){return C.top===C.bottom&&C.left+1===C.right||C.top+1===C.bottom&&C.left===C.right}};ma.Pol="#";ma.Ugl=268435712;ma.bod=500;ma=qc=Object(ba.__decorate)([Object(ka.d)(oa.Ff),Object(ba.__param)(0,Object(oa.l)()),Object(ba.__param)(1,Object(oa.Ob)()),Object(ba.__param)(2,Object(oa.yg)()),Object(ba.__param)(3,Object(oa.sg)()),Object(ba.__param)(4,Object(oa.wc)())],ma);Object(K.a)(ma,"SelectionReadoutHandler",null,[840,2]);var Ab=a(8),ec=a(131),na=a(38);let pb=class extends ec.a{constructor(C,
Ca){C=void 0===C?Ab.a.hxb:C;Ca=void 0===Ca?Ab.a.gH:Ca;super(C,Ca)}execute(C){const Ca=Object(qe.a)(10,C.Jk);E.ULS.shipAssertTag(537153921,0,he.a.TJb(C.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");Ca.lQ(!0,!0);C.activityState[na.a.Emc]=Ca.fa.sessionId;C.activityState[na.a.jIb]=!0;C.activityState[na.a.Kmc]=!0;E.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}};pb=Object(ba.__decorate)([Object(ka.d)(oa.Jf)],
pb);Object(K.a)(pb,"SessionReloadActivity",ec.a,[]);var R=a(61),ua=a(312),xb=a(42),W=a(44),xa=a(280),kb=a(115);const Pb=(C,Ca)=>new T(C,Ca,Ab.a.gH,Ab.a.Xp,Ab.a.Fzb);Object(ka.b)(oa.Kf,{rk:"singleton"})(()=>Pb(Ab.a.Uqa,Ab.a.pgb));Object(ka.b)(oa.Lf,{rk:"singleton"})(()=>Pb(Ab.a.q8b,Ab.a.fOa));Object(ka.b)(oa.Mf,{rk:"singleton"})(()=>Pb(Ab.a.r8b,Ab.a.ERc));Object(ka.b)(oa.Nf,{rk:"singleton"})(()=>Pb(Ab.a.XPa,Ab.a.LW));class T extends ec.a{constructor(C,Ca,qb,nc,Rc){super(C,Ca);T.G5d=[-1468309555,611268539,
-2087635043,2100961153,810218235,1112506702];T.F5d=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];T.dcg=[-1468309555,611268539,-1750576502,61029505,-658377927];T.ccg=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-658377927,-1337545025];this.h0c=qb;this.STk=nc;this.S2k=Rc}execute(C){var Ca=Object(qe.a)(10,C.Jk);C.activityState[na.a.pGa]=!0;var qb=T.jYi(C);if(T.CMk(C,qb))return T.RFj(C),qb=50,0<C.errors.length&&(qb=15),E.ULS.sendTraceTag(537153891,
0,qb,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${he.a.fi(C.errors)}`),C.activityState[na.a.pGa]=!1,this.vo(Ab.a.idle),3;switch(qb){case 1:case 3:this.mfj(C,qb);break;case 2:this.lfj(C);break;case 0:C.activityState[na.a.Peb]=null}E.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${qb}. activityName:${this.activityName}. NextActivityName:${this.gca}. TimeFromLastStatefulResponse:${Ca.fa.h9}.`);var nc=xb.a.Ym(C.activityState,
kb.a.Mzb);E.ULS.shipAssertTag(40502925,0,!nc||nc&&(1===qb||3===qb),`triggerSilentReloadAfterTokenRefresh: ${nc}, silentReloadType: ${qb}`);Ca=Ca.Xs.reloadCount;return 0!==qb&&0<Ca?(nc=ua.a.wmb(Ca,200),E.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${qb}] retryNum [${Ca}] delayInMs [${nc}] activityName [${this.activityName}]`),qf.a.instance.create(()=>{T.EU(C)},nc,We.a.yDk),1):3}mfj(C,Ca){E.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");
const qb=Object(qe.a)(10,C.Jk);C.activityState[na.a.jIb]=!0;qb.UGc||W.a.instance.Sm("ReopenOnLoad");T.isEditMode(C)&&ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient")&&T.N1a(C)||!he.a.TJb(C.errors)||(E.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),C.activityState[na.a.Emc]=qb.fa.sessionId,C.activityState[na.a.Kmc]=!0);C.$5d();3===Ca?(qb.fa.$l()||qb.fa.FMj(),qb.lQ(!0,
!0),this.vo(this.S2k),C.activityState[na.a.U2e]=qb.workbookContext.CalcMode):(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===Ca&&qb.lQ(!0,!0),C.activityState[na.a.Cod]=!1,this.vo(this.h0c))}lfj(C){E.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");C.activityState[na.a.Peb]=null;C.$5d();this.vo(this.STk);C=Object(qe.a)(10,C.Jk);C.UGc||(W.a.instance.Sm("RefreshOnLoad"),C.A6b())}static EU(C){C.EU()}static jYi(C){const Ca=
Object(qe.a)(10,C.Jk),qb=Ca.fa,nc=T.isEditMode(C),Rc=T.N1a(C);var id=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient"),sd=he.a.oo(C.errors,nc||id&&Rc?T.F5d:T.G5d);id=he.a.oo(C.errors,nc||id&&Rc?T.ccg:T.dcg);const Fd=Ca.D1,S=Ca.Xs.reloadCount,Ua=Ca.ua.MaxConsecutiveSilentReloadAllowed,Hb=Ca.Xs.lSf(),Ec=he.a.fi(C.errors),cd=he.a.fi(C.IOa),Bd=0<he.a.eY(pf=>!pf.triggerSilentReopenOnly,C.errors).length;let ce=sd;const Fe=xb.a.Ym(C.activityState,kb.a.Mzb);Fe&&(ce=
!0);const Ue={name:"SessionReloadSilentActivity.GetSilentReloadType"};Ue.editMode=nc;Ue.isSilentReopenError=sd;Ue.isSilentRefreshError=id;Ue.reloadSequenceCount=Ca.Xs.b7a;Ue.reloadCount=S;Ue.maxReloads=Ua;Ue.stopSilentReloads=Hb;Ue.errorNames=Ec;Ue.processedErrorNames=cd;Ue.isClientDirty=Fd;Ue.errorsForSilentReopenOnly=Bd;Ue.triggerSilentReloadAfterTokenRefresh=Fe;Ue.IsReopenDisabled=Ca.N2a;Ue.isCollabViewMode=Rc;sd=R.a.Di(Ue);E.ULS.sendTraceTag(21837004,0,50,sd);if(!Hb){if(ce&&(nc||ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8671789_FixSilentRefreshInCollabView")&&
Rc?T.rMk(C):T.uMk(C)))return xa.a.FTg(C,Ca)?3:Ca.N2a?2:1;if(id&&(nc||ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8671789_FixSilentRefreshInCollabView")&&Rc||!qb.hvb))return 2}return 0}static CMk(C,Ca){for(const qb of C.errors)if(-1337545025===qb.MessageId||-238814601===qb.MessageId)return!1;return he.a.eY(qb=>!qb.triggerSilentReopenOnly,C.errors).length?3!==Ca:!1}static RFj(C){const Ca=he.a.eY(qb=>!qb.triggerSilentReopenOnly,C.errors);for(const qb of Ca)C.qpa(qb)}static isEditMode(C){const Ca=Object(qe.a)(10,
C.Jk);return Ca.fa.ki?Ca.ox&&!!(Ca.Kj&64):xb.a.Ym(C.activityState,na.a.dA)}static N1a(C){const Ca=Object(qe.a)(10,C.Jk);E.ULS.sendTraceTag(507618584,0,50,`SessionReloadSilentActivity.isEditMode: isEditMode [${Ca.isEditMode}] Edit Mode capabilities [${Ca.Kj&64}]`);return Ca.fa.ki?Ca.fa.N1a:xb.a.Ym(C.activityState,na.a.yod)}static uMk(C){const Ca=Object(qe.a)(10,C.Jk);if(he.a.tga(C.errors,T.G5d).some(qb=>qb.ForceVersionUpgrade))return!1;C=he.a.TJb(C.errors);return!Ca.fa.hvb||C?!0:!1}static rMk(C){return!he.a.tga(C.errors,
T.F5d).some(Ca=>Ca.ForceVersionUpgrade)}}T.G5d=null;T.F5d=null;T.dcg=null;T.ccg=null;Object(K.a)(T,"SessionReloadSilentActivity",ec.a,[]);var Za=a(563);let Db=class extends Za.a{constructor(C){super(Object(ha.f)(C))}uYi(C){for(const Ca of this.rangeList)if(C.range.contains(Ca))return Ca;return null}Pge(C){return C.GridBlockModel&&(C=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(C.GridBlockModel))?C.getSparklineRanges():null}};Db=Object(ba.__decorate)([Object(ka.d)(oa.sg),Object(ba.__param)(0,
Object(oa.Ob)())],Db);Object(K.a)(Db,"SparklineManager",Za.a,[843]);var kc=a(620),Wc=a(195),yd=a(192);class Od extends jc.a{constructor(C,Ca,qb,nc,Rc){super(C);this.u0g=[6];this.p0g=[26];this.xz=null;this.RXb=this.GKc=!1;this.CB=this.Tna=null;this.onPointerDown=id=>{if(1!==this.$.Ia.cS())return!0;id=this.zoomManager.xl(id);if(this.YK)return!0;var sd=pe.a(this.$).gYd||pe.a(this.$).wv();if(this.D_d||sd)return this.cwb(),!0;this.CB=this.Fv;this.eje();this.WSd();sd=2===id.Gh&&id.Lw===Sys.UI.MouseButton.leftButton;
const Fd=3===id.Gh;if(sd||Fd)id=this.ha.$y(id.clientPoint,id.hi,5,void 0,void 0,!0),id||(id=this.CB),this.RXb=sd,this.GKc=Fd,this.CB=this.rOf(id),this.WSd(),sd?this.kkk():Fd&&this.alk(),pc.b(this.$,!0);return!0};this.Yr=id=>{id=this.zoomManager.xl(id);if(!this.YK)return!1;let sd=this.RXb?this.ha.$y(id.clientPoint,id.hi,5,void 0,void 0,!0):this.ha.$y(id.clientPoint,id.hi,5,!0,!1,!0);sd||(sd=this.ha.K4(id.clientPoint,id.hi,5));sd&&(id=this.rOf(this.VGh(sd)),this.lqc(id.bottomRight),this.CB.equals(id)||
(this.CB=id,this.K5b(!1),this.eje(!1),this.WSd(!1),this.z9i(),this.Fh.update(!1)),this.C9k(this.CB));return!0};this.Ho=id=>{this.zoomManager.xl(id);if(!this.YK)return!1;this.resizeTable();this.cwb();return!0};this.V2b=id=>{this.zoomManager.xl(id);if(!this.YK)return E.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.cwb();return!0};this.Lpa=id=>{this.zoomManager.xl(id);this.cwb();return!0};this.Tig=()=>{this.YK&&
this.cwb()};this.da=Ca;this.zoom=Rc;this.$=Ca.$;this.Qj=nc;this.ha=Ca.ha;this.Fh=Ca.Fh;this.parentElement=C;this.wRh();Sa.a.Oy||Sa.a.H1||Ub.a.instance.xa(Ra.a.Bj,this.Tna,this.onPointerDown);this.Fv=qb;this.Wed=this.D_d=!1;this.Qj.xCh(this.Tig)}get YK(){return this.RXb||this.GKc}get w4f(){return this.Wed}dispose(){this.cwb();this.Qj.Hnk(this.Tig);this.w4f||Sa.a.Oy||Sa.a.H1||Ub.a.instance.Oa(Ra.a.Bj,this.Tna,this.onPointerDown);if(this.YK){pc.b(this.$,!1);try{this.qF()}catch(C){E.ULS.sendTraceTag(537151236,
0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${C}`)}}this.parentElement&&this.parentElement.contains(this.Tna)&&this.parentElement.removeChild(this.Tna);this.Tna=this.parentElement=null;super.dispose()}get zoomManager(){return this.zoom.zoomManager}rOf(C){const Ca=C.bottom-this.Fv.topLeft.bottom-1;return 0<=C.right-this.Fv.topLeft.right+1&&0<=Ca&&C.bottom>=this.Fv.top&&C.right>=this.Fv.left?new Jc.Range(this.Fv.top,this.Fv.left,C.bottom,C.right,!1,!1):this.CB}WSd(C){this.nZc([this.CB],
6,void 0===C?!0:C);this.Fh.Qw(this.u0g)}K5b(C){C=void 0===C?!0:C;this.Fh.fr(this.u0g);this.nZc([null],6,C)}eje(C){C=void 0===C?!0:C;this.Fh.fr(this.p0g);this.nZc([null],26,C)}z9i(){var C=!1;C=void 0===C?!0:C;const Ca=this.$Zk();0<Ca.length&&(this.nZc(Ca,26,C),this.Fh.Qw(this.p0g))}$Zk(){const C=[];this.Fv.contains(this.CB)&&(this.Fv.right!==this.CB.right&&C.push(new Jc.Range(this.Fv.top,this.CB.right+1,this.CB.bottom,this.Fv.right,!1,!1)),this.Fv.bottom!==this.CB.bottom&&C.push(new Jc.Range(this.CB.bottom+
1,this.Fv.left,this.Fv.bottom,this.Fv.right,!1,!1)));return C}resizeTable(){if(!this.CB.equals(this.Fv)){const C=new Jc.Range(this.Fv.top,this.Fv.left,this.CB.bottom,this.CB.right,!1,!1);this.G4k(C);this.D_d=!0}}onKeyDown(C){this.zoomManager.xl(C);return!0}E$d(){this.w4f&&(Sa.a.Oy||Sa.a.H1||(Ub.a.instance.xa(Ra.a.Bj,this.Tna,this.onPointerDown),this.Tna.classList.remove("ewr-table-resize-default-cursor"),this.Wed=this.Tna.disabled=!1),this.Wed=!1)}wRh(){const C=document.createElement("div");C.className=
"ewr-table-resize-handle";const Ca=document.createElement("div");Ca.className="ewr-table-resize-fillhandle-higher";const qb=document.createElement("div");qb.className="ewr-table-resize-fillhandle-broader";C.appendChild(Ca);C.appendChild(qb);this.Tna=C;this.parentElement.appendChild(this.Tna)}lqc(C){let Ca=60;const qb=this.CB.contains(C);let nc=C.top,Rc=C.bottom,id=C.left,sd=C.right,Fd=null;if(qb){if(this.da.SD(this.Fv.topLeft)&&!this.Fv.u9a)return;C.bottom<this.CB.bottom?(nc=Math.max(1,Rc-2,this.Fv.top),
Ca=16):(id=Math.max(1,sd-2,this.Fv.left),Ca=4);Rc=nc;sd=id;Fd=new Jc.Range(nc,id,nc,id,!1,!1)}else C.right>=this.Fv.right?(sd+=2,Ca=8):C.bottom>=this.Fv.bottom&&(Rc+=2,Ca=32),nc=Rc,id=sd,Fd=new Jc.Range(Rc,sd,Rc,sd,!1,!1),Ca=16;this.da.SD(Fd)||(this.xz?this.xz.Wt||(this.xz=qf.a.instance.create(()=>{this.da.KC(Fd,Ca,"TableResizeBehavior.BringRangeIntoView")},40,We.a.s0g)):this.xz=qf.a.instance.create(()=>{this.da.KC(Fd,Ca,"TableResizeBehavior.BringRangeIntoView")},40,We.a.s0g))}VGh(C){let Ca=C;if(this.da.fh.nx){if(!this.da.yh(C.topLeft)){const qb=
this.da.pt("TableResizeBehavior.AdjustHiddenRowColumns",this.da.i6,this.CB.top!==C.top?1:2);try{qb.ls=this.CB.top<C.top||this.CB.left<C.left,qb.nG(C.topLeft),Ca=qb.$$cu().range}finally{qb&&qb.dispose()}}Ca.right=Ca.left+C.width-1;Ca.bottom=Ca.top+C.height-1}return Ca}nZc(C,Ca,qb){qb=void 0===qb?!0:qb;const nc=[];for(const Rc of C)nc.push(new Ve.a(Rc,hf.d(this.$.la)));this.Fh.wQ(nc,[Ca],!0,void 0,qb)}kkk(){Ub.a.instance.xa(Ra.a.Yy,document.documentElement,this.Yr);for(const C of this.da.Av)Ub.a.instance.xa(Ra.a.Yy,
C.domElement,this.Yr);Ub.a.instance.xa(Ra.a.jp,document.documentElement,this.Ho);this.Xqf()}alk(){Rb.a.instance.xa(Ra.a.wo,document.documentElement,this.Yr);for(const C of this.da.Av)Rb.a.instance.xa(Ra.a.wo,C.domElement,this.Yr);Rb.a.instance.xa(Ra.a.pl,document.documentElement,this.V2b);this.Xqf()}qF(){this.RXb&&this.N7k();this.GKc&&this.Y7k()}N7k(){Ub.a.instance.Oa(Ra.a.Yy,document.documentElement,this.Yr);for(const C of this.da.Av)Ub.a.instance.Oa(Ra.a.Yy,C.domElement,this.Yr);Ub.a.instance.Oa(Ra.a.jp,
document.documentElement,this.Ho);this.lDg()}Y7k(){Rb.a.instance.Oa(Ra.a.wo,document.documentElement,this.Yr);for(const C of this.da.Av)Rb.a.instance.Oa(Ra.a.wo,C.domElement,this.Yr);Rb.a.instance.Oa(Ra.a.pl,document.documentElement,this.V2b);this.lDg()}Xqf(){this.da.cellTextEditBox.Tjb(!0)}lDg(){this.da.cellTextEditBox.Tjb(!1)}G4k(C){this.$.oi(-1400250766,Vc.a.ph,30,{["ResizeTableRange"]:C,["OriginalTableRange"]:this.Fv})}C9k(C){if(!this.Fv.contains(C)){C=this.ZZk();for(const Ca of C)if(this.Qj.d0d(Ca)){this.da.ho.RA(X.a.SLj);
return}}this.da.rtl?this.da.ho.RA(X.a.UKj):this.da.ho.RA(X.a.qNj)}cwb(){if(this.YK){pc.b(this.$,!1);try{this.qF()}catch(C){E.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${C}`)}}this.xz&&(this.xz.cancel(),this.xz.dispose());this.GKc=this.RXb=!1;this.K5b();this.eje();pc.b(this.$,!1);this.da.ho.RA(X.a.Yaa)}ZZk(){const C=[];this.Fv.right!==this.CB.right&&C.push(new Jc.Range(this.Fv.top,this.Fv.right+1,this.CB.bottom,this.CB.right,!1,!1));
this.Fv.bottom!==this.CB.bottom&&C.push(new Jc.Range(this.Fv.bottom+1,this.Fv.left,this.CB.bottom,this.Fv.right,!1,!1));return C}static createInstance(C,Ca,qb,nc,Rc){if(!Ca)return null;const id=C.Fh;id.wQ(qb,[27],!0);id.Qw(Od.UZk);qb=id.eV(27,C.fh.Wn(Ca.bottomRight),Od.lLi(Ca,qb)).nl;return new Od(qb,C,Ca,nc,Rc)}static lLi(C,Ca){var qb;for(let nc=0;nc<Ca.length;nc++)if((null===(qb=Ca[nc])||void 0===qb?0:qb.range)&&Ca[nc].range.equals(C))return nc;return 0}}Od.UZk=[27];Object(K.a)(Od,"TableResizeBehavior",
jc.a,[]);var me=a(56),De=a(155),Le=a(156),Pe=a(326);class ef extends Cb.a{constructor(C,Ca){super(document.createElement("div"));this.god=this.bXd=this.evg=this.s1=!1;this.Roe=null;this.p0d=!1;this.onActiveCellChanged=()=>{jg.d(this.$,this.da.ha.pa.activeCell)?(this.q1a=!0,this.iNb(!1)):(this.rba=this.q1a=!1,this.S5g())};this.Vy=()=>{this.q1a?this.iNb(!0):this.rba=!1};this.GNa=()=>{this.god=!0;this.q1a&&(this.rba=!1)};this.onContentReady=()=>{this.$.isEditMode?jg.d(this.$,this.da.ha.pa.activeCell)&&
(this.q1a=!0,this.iNb(!1)):this.rba=!1};this.FNa=()=>{this.god=!1;this.q1a?this.iNb(!1):this.rba=!1};this.onBlockCacheItemChanged=(qb,nc)=>{this.q1a&&(qb=this.da.M5a(nc.Oj.block.Ck.BlockCachePosition.PaneType).XN(nc.Oj.hash))&&(qb.Bke(this.KSf),qb.Lqd(this.KSf))};this.KSf=()=>{this.zHg()};this.$=C;this.zoom=Ca;this.da=ha.f(this.$);this.parentElement=this.domElement;this.parentElement.className="ewa-ttrd-buttonarea";this.o0a=this.da.$m;this.CId=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");
this.p0d=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8842054_TotalTableRowOptionsButtonRenderingBugFix");this.q1a=!0;this.Ddj();this.CId&&this.cbj();this.yLh();this.iNb(!1);E.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get zoomManager(){return this.zoom.zoomManager}get rba(){return this.bXd}set rba(C){this.bXd!==C&&(this.bXd=this.isVisible=C)}get ZYb(){return!!(this.$.Kj&16)}get xoj(){const C=this.da.ha.pa.activeCell;return C.right===C.maxColumns}get cIb(){const C=
this.da.yh(null);return C&&this.da.Eba(C.range)?this.Ina(C):(C&&E.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.lfi();this.$=this.da=this.parentElement=this.o0a=null;super.dispose()}IIi(C){const Ca=this.C_i(this.da.yh(null).range);return Ca?this.CId?`=${this.DNf()}(${C}${this.$.listSeparator}${Ca})`:`=SUBTOTAL(${C},${Ca})`:null}DNf(){var C,Ca,qb;return null!==(qb=null===(Ca=null===(C=this.Mj)||void 0===
C?void 0:C.localeInfo)||void 0===Ca?void 0:Ca.getWorksheetFuncName(344))&&void 0!==qb?qb:"SUBTOTAL"}C_i(C){var Ca=ha.f(this.$).oh.Ml(C);if(!Ca)return null;Ca=yd.a(Ca,!1);Ca.right=Ca.left=C.left;return Ca.toString()}Ddj(){ef.wU={};ef.wU["100"]=qa.a.instance.ia(1105);ef.wU["101"]=qa.a.instance.ia(1108);ef.wU["102"]=qa.a.instance.ia(1107);ef.wU["103"]=qa.a.instance.ia(1112);ef.wU["104"]=qa.a.instance.ia(1109);ef.wU["105"]=qa.a.instance.ia(1110);ef.wU["109"]=qa.a.instance.ia(1106);ef.wU["107"]=qa.a.instance.ia(1113);
ef.wU["110"]=qa.a.instance.ia(1115);ef.wU["111"]=qa.a.instance.ia(1166)}cbj(){void ka.a.resolve(oa.G).then(C=>this.Mj=C)}Y5j(){var C=this.da.yh(null);if(C&&(C=C.LC?C.formulaBarText:null))if(this.CId){const Ca="="+this.DNf()+"(",qb=Ca.length;if(C.toUpperCase().startsWith(Ca)){if(C=C.substring(qb,qb+3),C in ef.wU)return C}else return"111"}else if("=SUBTOTAL("===C.substring(0,10)){if(C=C.substring(10,13),C in ef.wU)return C}else return"111";return"100"}yLh(){this.da.za.sz(this.onBlockCacheItemChanged);
this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.gA(this.onContentReady);this.da.cellTextEditBox.Mv(this.GNa);this.da.cellTextEditBox.Ox(this.FNa)}lfi(){this.da&&(this.da.ha&&(this.da.ha.remove_activeCellChanged(this.onActiveCellChanged),this.da.za.Vz(this.onBlockCacheItemChanged)),this.da.dF(this.onContentReady),this.da.cellTextEditBox&&(this.da.cellTextEditBox.Cv(this.GNa),this.da.cellTextEditBox.Ow(this.FNa)),this.S5g())}iNb(C){this.R9k(C);this.ZYb&&(this.xYk(),this.cIb?(this.evg||
this.JLh(),this.god?this.rba=!1:(this.rba=!0,this.zHg())):(E.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.rba=!1))}zHg(){appChrome.renderTableTotalRowOptions(this.parentElement,ef.wU,ef.wU[this.Y5j()].toString(),Math.round(this.zoomManager.Zm(17)),C=>{E.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${C}`);const Ca={["SelectedOption"]:ef.wU[C],["FunctionKeyCode"]:C,
["Location"]:"canvas"};Le.b(this.$).sj(De.a.d_k,Ca,null,!0);if("111"===C)return this.ahj(),!0;if("100"!==C){this.Roe=this.IIi(C);if(!this.Roe)return E.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.r8a(this.Roe)}else this.r8a("");ia.DOMElementExtensions.setFocus(this.da.Dh.Xa.domElement);return!0})}ahj(){E.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const C=
new Nb.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ia.qh(C)}Ina(C){if(!C)return null;var Ca=this.da.cellTextEditBox.Xa.domElement;var qb=0<ia.DOMElementExtensions.getHeight(Ca)&&0<ia.DOMElementExtensions.getWidth(Ca)&&0<=Ca.offsetTop&&0<=Ca.offsetLeft;if(qb&&!this.p0d)Ca=ia.DOMElementExtensions.Ina(Ca,this.da.$m);else{Ca=this.da.getCellBounds(C.cell);var nc=ia.DOMElementExtensions.getBoundingClientRect(this.da.$m);Ca=new Sys.UI.Bounds(Ca.x-nc.x,Ca.y-nc.y,Ca.width,Ca.height)}if(Ca)if(qb&&!this.p0d)2<
Ca.height&&2<Ca.height&&(Ca.x+=1,Ca.y+=1,Ca.height-=2,Ca.width-=2);else if(qb=ha.f(this.$).cV(C.cell))qb=qb.width,nc=Ma.a.equals(Ha.a.kSb(C.cell,this.da.rtl),"right",!0),this.da.rtl&&nc&&(Ca.x=Ca.x+Ca.width-qb),C.mza&&this.da.rtl===nc&&(Ca.width=qb);else return null;return Ca}R9k(C){var Ca=this.cIb;if(Ca){var qb=17>=Ca.height?Ca.y:Ca.y+Ca.height-17-2;Ca=this.xoj?this.da.rtl?Ca.x:Ca.x+Ca.width-(17<Ca.height?17:Ca.height):this.da.rtl?Ca.x-(17<Ca.height?17:Ca.height):Ca.x+Ca.width;var nc=this.zoomManager.Raa(new Sys.UI.Point(Ca,
qb));this.parentElement.style.top=wd.HelperMethods.Li(nc.y);this.parentElement.style.left=wd.HelperMethods.Li(nc.x);this.zoomManager.wHk(this.parentElement);C&&(this.rba=this.da.XKc(new me.a(Ca,qb)))}else this.rba=!1}JLh(){this.o0a.insertBefore(this.parentElement,this.o0a.firstChild);this.evg=!0}xYk(){this.s1||(this.da.view.uz(this.Vy),this.s1=!0)}S5g(){this.s1&&this.da.view&&(this.da.view.gy(this.Vy),this.s1=!1)}r8a(C){const Ca=this.da.Dh,qb=this.da.yh(null);qb&&(C=Object(nb.a)(new Pe.a,{Text:C}),
this.da.setCell(C,qb.range,0,127,null),Ca.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}ef.c_k="TableTotalRowDropDownIconButtonId";ef.wU=null;Object(K.a)(ef,"TableTotalRowOptions",Cb.a,[2]);var yf=a(1336);let Kf=class extends Za.a{constructor(C,Ca){super(ha.f(C));this.iLb=this.sda=this.Y1c=this.gLb=null;this.v8e=!1;this.HRe=null;this.gfc=0;this.Nuc=null;this.Dpc=()=>{const qb={},nc=this.SOd();for(const id in nc){const sd=nc[id];if(!sd)continue;const Fd=this.yZi(sd);if(Fd){if(Fd in this.wVa){var Rc=
this.wVa[Fd];if(Rc.YK){Rc.Fv.equals(sd)||(Rc.Fv=sd);delete this.wVa[Fd];qb[Fd]=Rc;continue}}(Rc=Od.createInstance(ha.f(this.$),sd,this.qFi(),this,this.zoom))?qb[Fd]=Rc:E.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${sd.ME(!1)}`)}}this.Qrc(null,null);this.Ddc=qb};this.Qrc=()=>{const qb=this.wVa;for(const id in qb){var nc=id,Rc=qb[id];Rc&&(Rc.dispose(),delete this.wVa[nc])}this.Ddc={}};this.EBg=()=>{this.Qrc(null,null);this.Dpc(null,null)};
this.onFocus=()=>{this.HRe=ha.f(this.$).ha.pa.activeCell};this.IA=()=>{if(this.$.isEditMode)this.onActiveCellChanged(null,null)};this.onActiveCellChanged=()=>{!this.v8e&&jg.d(this.$,this.da.ha.pa.activeCell)&&this.uzj()};this.qG=()=>{this.FVb(1);ta.EwaSettings.ul()||this.$.fa.av(this.qG)};this.a4b=()=>{this.v8e=!0;this.Y1c=new ef(this.$,this.zoom)};this.$=C;this.zoom=Ca;this.da=ha.f(this.$);this.Ddc={};this.Dpc(null,null);this.$.sa&&this.$.sa.vn(this.EBg);this.xqd(this.Dpc);this.$.fa.lK(this.IA);
this.da.ha.add_activeCellChanged(this.onActiveCellChanged);if(this.$.isEditMode)this.onActiveCellChanged(null,null)}xqd(C){this.addHandler(Za.a.U4b,C)}qke(C){this.removeHandler(Za.a.U4b,C)}xCh(C){this.addHandler("tce",C)}Hnk(C){this.removeHandler("tce",C)}get wVa(){return this.Ddc}get G1d(){return this.HRe}get wYa(){return this.gfc}get zy(){const C=ha.f(this.$);return C.oh.Ml(C.ha.pa.activeCell,!1)}get qfe(){return this.G1d?ha.f(this.$).oh.Ml(this.G1d,!1):null}d0d(C){return!!this.eLf(C)}Fy(C){return this.pVi(this.NLf(C))}SRb(C){return this.NLf(C)}Ykk(C){C?
(this.iLb?this.iLb!==C&&($b.a.gh(this.sda),this.sda=null,this.iLb=C):this.iLb=C,this.sda||(this.sda=Ig.a.instance.Wk(this.iLb)),this.sda.Zv("focusin")||this.sda.Ga("focusin",this.onFocus)):E.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement received")}s0f(C,Ca){return C?C.Zxa&&C.top===Ca.top:(E.ULS.shipAssertTag(537151244,0,!!C,"autofilterRange can't be null"),!1)}Axa(C){C=this.gLb?Qa.O(C,this.gLb):this.view.getRangeInformation(C);return 0<C.length&&
Object(Oc.a)(ee.PivotTableRange,C[0])?C[0]:null}Ejj(C,Ca){return C?!C.KHc&&!!C.XI&&C.XI.$i(Ca):(E.ULS.shipAssertTag(537151243,0,!!C,"Pivot table can't be null"),!1)}Hrj(C,Ca){return C?!C.KHc&&!!C.sL&&C.sL.$i(Ca):(E.ULS.shipAssertTag(537151242,0,!!C,"Pivot table can't be null"),!1)}knc(C){super.knc(C);if((C=wd.HelperMethods.pLf(C))&&0<C.length){this.gLb=Array(C.length);for(let Ca=0;Ca<C.length;Ca++)this.gLb[Ca]=Wc.a.dJ(C[Ca])}}D5b(){super.D5b();this.gLb=null}J4h(C,Ca){let qb;qb=!1;if(!C||!Ca)return{returnValue:!1,
J$:qb};C=C.clone();C.right+=1;C.left=C.right;if(!C.EB)return{returnValue:!1,J$:qb};if(C.top<Ca.fh.Im){const nc=C.clone();nc.bottom>=Ca.fh.Im&&(nc.bottom=Ca.fh.Im-1);if(!(()=>{let Rc=this.Xkf(nc,Ca);({J$:qb}=Rc);return Rc})().returnValue)return{returnValue:!1,J$:qb}}if(C.bottom>=Ca.fh.Im){const nc=C.clone();nc.top<=Ca.fh.Im&&(nc.top=Ca.fh.Im);if(!(()=>{let Rc=this.Xkf(nc,Ca);({J$:qb}=Rc);return Rc})().returnValue)return{returnValue:!1,J$:qb}}return{returnValue:!0,J$:qb}}t0g(C){(C=this.Fy(C.topLeft))&&
C.toString()in this.wVa&&(this.wVa[C.toString()].D_d=!1)}hek(){this.raiseEvent("tce")}Iq(C,Ca){if(!this.Y1c)return!1;switch(Ca){case -569786022:case 541421805:if(this.Y1c.rba){const qb=document.getElementById(ef.c_k);qb&&qf.a.instance.create(()=>{ia.DOMElementExtensions.FGc(qb,null)},0,We.a.WZk,!0,!0)}return!0;default:return!1}}dispose(){this.Qrc(null,null);this.qke(this.Dpc);this.$.sa.Nn(this.EBg);this.$.wu(this.Qrc);this.Ddc=null;this.$.fa&&this.$.fa.gI(this.IA);this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);
this.Y1c=null;this.sda&&($b.a.gh(this.sda),this.sda=null);super.dispose()}tRf(C,Ca,qb,nc){var Rc=this.da.oh.Ml(new Jc.Range(Ca,qb,Ca,qb,!1,!1));if(this.Nuc=Rc){var id=Rc.usedRange,sd=C.ctrlKey||Sa.a.isMac&&oc.b(C);Rc=!C.shiftKey&&sd;C=C.shiftKey&&!sd;ha.f(this.$).ha.selectionType=3;switch(nc){case 0:this.gfc=0;Ca=this.WAd(C,id.top,qb,id.bottom,qb);this.cre(Ca,Rc,C);break;case 1:this.gfc=1;Ca=this.WAd(C,Ca,id.left,Ca,id.right);this.cre(Ca,Rc,C);break;case 2:this.gfc=2;Ca=this.WAd(C,id.top,id.left,
id.bottom,id.right);this.cre(Ca,Rc,C);break;default:E.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${nc.toString()}`);return}ha.f(this.$).ha.selectionType=3;E.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else E.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}PMk(C){const Ca=
this.Nuc.usedRange;return this.S2f(C)||1!==this.wYa&&this.S2f(new Jc.Range(Ca.top,C.left,Ca.bottom,C.right,!1,!1))?!0:!1}Pge(C){return C.Autofilters}Xkf(C,Ca){let qb;qb=!1;const nc=Ca.fh.Wn(C),Rc=Ca.ol(nc).Wp;if(!Rc)return E.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${nc}`),{returnValue:!1,J$:qb};if(!Rc.Fk(C))return{returnValue:!0,J$:qb};C=Ca.pt("TableManager.CouldExpandImpl",C,2);try{for(;C.$$mn();){if(C.$$cu().text||C.Ku.B0a)return qb=!0,{returnValue:!1,
J$:qb};if(C.$$cu().LH)return{returnValue:!1,J$:qb}}}finally{C&&C.dispose()}return{returnValue:!0,J$:qb}}pVi(C){if(!C)return null;const Ca=new kc.AutofilterRange(C.top,C.left,C.bottom,C.right,null,null,null,C.id,C.Zxa);Ca.u9a=C.u9a;const qb=this.da.oh.Ml(C,!0);if(!qb)return null;for(let nc=0,Rc=this.rangeList.length;nc<Rc;nc++){const id=this.rangeList[nc],sd=this.da.oh.Ml(id,!0);sd&&sd.name===qb.name&&id!==C&&this.Nqj(id)&&(Ca.union(id),id.u9a&&(Ca.u9a=!0))}return Ca}Nqj(C){return!!ha.f(this.$).oh.Ml(C)}qFi(){const C=
[];for(const Ca of this.rangeList){const qb=new Ve.a(this.Fy(Ca.topLeft),hf.d(this.$.la));C.push(qb)}return C}SOd(){const C={};for(const Ca of this.rangeList){if(!Ca)continue;const qb=this.Fy(Ca.topLeft);qb&&(C[qb.toString()]=this.Fy(Ca.topLeft))}return C}uzj(){this.$.fa.um?this.FVb(0):ta.EwaSettings.ul()?this.$.fa.lr(this.qG):this.$.fa.mr(this.qG)}FVb(C){this.$.q6(Ca=>{Ca.Iaa(C).then(this.a4b)})}yZi(C){const Ca=this.da.oh.Ml(C);return Ca?Ca.name:C.toString()}cre(C,Ca,qb){C&&(qb=qb?ha.f(this.$).ha.pa.activeCell:
C.topLeft,Ca?this.da.ha.updateSelection(C,qb,0,1):this.da.ha.zL([C],0,qb,0))}WAd(C,Ca,qb,nc,Rc){const id=yd.d(this.Nuc),sd=yd.g(this.Nuc),Fd=Ca+(1!==this.wYa&&id?1:0),S=nc-(1!==this.wYa&&sd?1:0),Ua=this.da.inRangePicker||this.da.kq;if(C){var Hb=Ua&&!Ve.a.fuc(this.da.ha.rangePicker.DZ).length?new Jc.Range(Fd,qb,S,Rc,!1,!1):Ua?this.da.ha.rangePicker.activeCell:this.da.ha.pa.activeCell;Hb=new Jc.Range(Hb.top<Fd?Hb.top:Fd,Hb.left<qb?Hb.left:qb,Hb.bottom>S?Hb.bottom:S,Hb.right>Rc?Hb.right:Rc,!1,!1)}else Hb=
new Jc.Range(Fd,qb,S,Rc,!1,!1);if(1!==this.wYa&&(id||sd)&&(!C||C&&this.zyd(Hb,Fd,qb,S,Rc))){C=Ua?Ve.a.fuc(this.da.ha.rangePicker.DZ):this.da.ha.pa.selectedRanges;for(const Ec of C)if(this.zyd(Ec,Fd,qb,S,Rc)){Hb.top=Ca;Hb.bottom=nc;break}}return Hb}S2f(C){const Ca=this.da.inRangePicker||this.da.kq?Ve.a.fuc(this.da.ha.rangePicker.DZ):this.da.ha.pa.selectedRanges;for(const qb of Ca)if(this.zyd(qb,C.top,C.left,C.bottom,C.right))return!0;return!1}zyd(C,Ca,qb,nc,Rc){return!!C&&C.top===Ca&&C.bottom===nc&&
C.left===qb&&C.right===Rc}};Kf=Object(ba.__decorate)([Object(ka.d)(oa.yg),Object(ba.__param)(0,Object(oa.Ob)()),Object(ba.__param)(1,Object(oa.dh)())],Kf);Object(K.a)(Kf,"TableManager",Za.a,[839,2]);String(yf);window.___1712031281165_closurehack=yf;var ig=a(784),kg=a(655),vg=a(1338);class yg extends V.a{constructor(C,Ca){Ca=void 0===Ca?!0:Ca;super(!1,!1,!0);this.rdb=null;this.hNe=!1;this.$w=[];this.uq=null;this.dUj=qb=>{this.Lth&&(this.uq=this.lSg(qb,this.Llc))};this.w2j=()=>{this.uq&&this.uq.nP&&
(this.hNe||(this.uq.qkk(this.K$d),this.hNe=!0),this.uq.tAf())};this.K$d=qb=>{this.rdb.uploadStatusLabel=qb;this.rRa(this.titleText,this.SUd,this.rdb)};this.SUd=qb=>{1===qb&&this.isEnabled()?this.uq.nP&&!this.uq.nP.value?(this.rdb.uploadStatusLabel=Object(Ed.a)("FileUploadNoFileSpecified"),this.rRa(this.titleText,this.SUd,this.rdb)):(this.inb(),this.Llc.finalizeUpload(this.uq,this.dispose)):0===qb&&this.hide()};this.Pbe=()=>{this.izg()};this.onKeyDown=qb=>{4!==Fa.FocusManager.instance().nzg(qb)&&qb.preventDefault()};
this.Llc=C;this.Lth=Ca;this.DI=this.N_e=!1;this.Pta=null;this.fl="InsertFileDialog";this.si(1,this.actionButtonText);this.rdb={["id"]:this.fl,["bodyControls"]:{["uploadButtonProps"]:{["label"]:Object(Ed.a)("DialogChooseFile"),["onExecute"]:this.w2j}},["uploadStatusLabel"]:Object(Ed.a)("DialogNoFileChosen"),["onFrameReady"]:this.dUj};this.initializeAndShow(this.titleText,this.SUd,this.rdb);this.uad=!0}get Hcl(){return this.Llc}tJk(){this.fNe=!1;this.uq=this.lSg(document.getElementById("uploadFrameContainer"),
this.Llc);Aa.AFrameworkApplication.ea.ka("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Pta=this.Pbe,ob.a.addHandler(this.uq.xTd,"load",this.Pta));this.uq.nP||E.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.izg()}izg(){if(this.uq&&!this.fNe){var C=this.uq.nP;C&&(ob.a.addHandler(C,Ra.a.Wi,this.onKeyDown),C=[C],this.$w=C.concat.apply(C,this.$w),this.eal(),this.fNe=!0)}}dispose(){if(this.uq){const C=this.uq.nP;C&&ob.a.removeHandler(C,Ra.a.Wi,this.onKeyDown);this.Pta&&
ob.a.removeHandler(this.uq.xTd,"load",this.Pta)}this.uq=null;super.dispose()}eal(){if(0<this.$w.length){const C=new vg.a(this.$w),Ca=Fa.FocusManager.instance().j1();Ca&&(this.$w[0].focus(),Ca.Go=C,Ca.Rha=!0)}}static CL(C){const Ca=document.getElementById("errorText");Ca.innerText=C;Ca.style.display="inline-block"}}Object(K.a)(yg,"InsertFileDialog",V.a,[]);class ag{static get rp(){return V.a.tB(ag.ww,Object(Ed.a)("ImageUploadDialogText"),Object(Ed.a)("ImageUploadNoFileSpecified"))}}ag.ww="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(K.a)(ag,"InsertImageDialogHtml",null,[]);class gg extends yg{constructor(C,Ca){super(C,void 0===Ca?!0:Ca)}get actionButtonText(){return Object(Ed.a)("ImageUploadButtonText")}get titleText(){return Object(Ed.a)("ImageUploadingTitle")}validate(){this.uq.nP||E.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var C=Object(qe.a)(ze,this.Hcl);const Ca=C.L9g(this.uq.nP.value);return 0!==Ca?(C=C.AHf(Ca),yg.CL(C),!1):!0}}Object(K.a)(gg,"InsertImageDialog",yg,[]);var ch=a(875),
Eg=a(144),ph=a(1570);class Rg extends ph.a{constructor(C,Ca,qb,nc,Rc,id,sd,Fd){Fd=void 0===Fd?!1:Fd;super(C,Ca,qb,nc,Rc,"UploadFrame",id.fa.sessionId,"image/*",!1,null,void 0===sd?!1:sd);this.$=id;this.X8g=!0;this.fjj=Fd;this.GUd()}ia(C){return C}cPg(C){E.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");gb.a.Rrd(C,this.$.ua);C.Xea(Wb.a.sessionId,this.sessionId);var Ca=ha.f(this.$).ha;Ca=Qa.q(Ca.pa.Haa,this.$);C.Xea(Wb.a.Vzg,this.$.sa.la.name);C.Xea(Wb.a.$ck,Ca.FirstRow.toString());
C.Xea(Wb.a.Zck,Ca.FirstColumn.toString());C.Xea(Wb.a.Ofj,this.fjj.toString())}zRf(){this.QJg("ServerUploadError")}B5a(C){this.QJg(C)}static Olj(C){return!C||Ma.a.equals(C,"ServerUploadError",!1)}}Object(K.a)(Rg,"UploadFrameWrapper",ph.a,[]);class Dg extends gg{constructor(C,Ca,qb,nc){super(C,!1);this.wwa=null;this.LQa=!1;this.Bi=null;this.DPc=()=>{this.WAe("");this.J3c();return!1};this.$=Ca;this.a5c=C;this.x1=ch.a.instance;this.ea=qb;this.Bi=nc;this.tJk();this.bdj();this.$.vh.UE=!0}lSg(C,Ca){return new Rg(C,
Object(Eg.a)(Ca,Ca.A5a,"onUploadFrameInitialized"),Object(Eg.a)(Ca,Ca.Wja,"uploadResponseReceived"),this.ea,!0,this.$)}dispose(){this.J3c();this.x1=this.a5c=null;super.dispose()}hide(){super.hide();this.$.vh.UE=!1}validate(){var C=this.a5c.occ(this.uq.nP.value,this.a5c.$3g(this.uq));return 0!==C?(C=this.a5c.mMd(C).Description,this.WAe(C),this.Kwe(),!1):!0}isEnabled(){return!0}WAe(C){var Ca;null===(Ca=this.Bi)||void 0===Ca?void 0:Ca.$Pg(this.wwa,C)}bdj(){this.wwa=document.getElementById("errorText");
this.wwa.style.display="inline-block";this.LQa=!1;this.WAe("");this.ijb.style.maxWidth=this.ijb.currentStyle.minWidth}Kwe(){this.x1.xa(Ra.a.click,this.uq.nP,this.DPc);this.x1.xa(Ra.a.Wi,this.uq.nP,this.DPc);this.LQa=!0}J3c(){this.LQa&&(this.x1.Oa(Ra.a.click,this.uq.nP,this.DPc),this.x1.Oa(Ra.a.Wi,this.uq.nP,this.DPc),this.LQa=!1)}}Object(K.a)(Dg,"InsertImageDialogWrapper",gg,[]);var fb=a(62);class Va extends ze{constructor(C,Ca,qb,nc,Rc){Rc=void 0===Rc?!0:Rc;super(null,Ca,qb);this.Fwa=this.FQ=null;
this.cWd=this.Ypb=!1;this.Dde=null;this.Wja=id=>{this.zDe.stop();this.xpc.cancel();if(Rg.Olj(id))this.i9?this.oQf(4):(id=new ig.a(0,2,null,null,!1,null,null,null),id.status=8,this.uze(new kg.a(id),null,"InsertPictureWebMethod")),E.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.i9}`);else{const sd=Va.Wel(id);0!==sd?(E.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${id}`),this.oQf(sd)):this.z6i(id)}this.Y2b();this.dispose()};this.iTj=id=>{this.Yra(id,
this.uq)&&this.finalizeUpload(this.uq,null)};this.A5a=id=>{E.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.uq=id;if(!this.sIa){if(this.d5c){if(this.Wdf()||this.C4a&&Sa.a.kJ){id.YOb(this.iTj);return}const sd=id.YOb(null);if(!this.Yra(sd,id))return}this.finalizeUpload(id,null)}};this.X1j=()=>{this.i9=!0};this.th=C;this.zDe=C.Eh.wm("WebServiceCall","InsertPictureOperation");this.xpc=qf.a.instance.create(this.X1j,1E5,We.a.hNh,!1);this.i9=!1;this.DNc=this.$.ua.InsertPictureMaxFileSizeBytes;
nc&&(this.Ypb="TestOnly"in nc);nc&&(this.cWd="IsCellPicture"in nc);Rc&&this.showDialog()}get $(){return this.th}get eGj(){return this.DNc/1024/1024}dispose(){$b.a.gh(this.xpc);this.uq&&this.uq.C3e();this.uq=this.xpc=this.th=null}Mgk(C){if(!this.$)return E.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),Xa.Task.Ua(!0);if(!this.$.vha)return Xa.Task.Ua(!0);const Ca=new Uf.a,qb=new FileReader;C=C.nP.files[0];const nc=()=>{Ca.pF(!0)};qb.onload=()=>{this.Dde=qb.result;Ca.pF(!0)};
qb.onerror=nc;qb.onabort=nc;qb.readAsDataURL(C);return Ca.task}$3g(C){let Ca=-1;C=C.nP;(null===C||void 0===C?0:C.files)&&0<C.files.length&&(Ca=C.files[0].size);return Ca}occ(C,Ca){let qb=Va.g4h(ze.Yra(C));0===qb?-1!==Ca&&(E.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${Ca}, maxAllowedSize: ${this.DNc}, remainingWorkbookSize: ${this.$.fa.h7f}`),Ca>this.DNc?qb=3:Ca>this.$.fa.h7f&&(qb=7)):6===qb&&this.CDj(C);E.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${qb}`);
return qb}Yra(C,Ca){C=this.occ(C,this.$3g(Ca));return 0!==C?(this.sIa||1===C||this.que(C),!1):!0}j3g(C){C.uYk()}mMd(C){let Ca=0,qb=1,nc=-1100324317,Rc="InsertPictureUnknownError",id=null;switch(C){case 1:Ca=1758;qb=0;nc=940870981;Rc="InsertPictureNoFileSelected";break;case 3:qb=0;nc=1250467391;Rc="InsertPicturePictureTooBig";id=String.format(qa.a.instance.sh(181),this.eGj.toLocaleString());break;case 6:Ca=1762;qb=0;nc=1380041209;Rc="InsertPictureUnsupportedFormat";break;case 7:Ca=1759;qb=0;nc=-903115058;
Rc="InsertPictureExceedWorkbookSize";break;case 4:Ca=1760;qb=0;nc=1218352119;Rc="InsertPictureUploadTimeout";break;case 5:Ca=1761,qb=0,nc=1979899005,Rc="InsertPictureServiceNonDeterministicError"}C=Va.nj(Ca,qb,nc,Rc);id&&(C.Description=id);return C}showDialog(){if(this.Wdf())this.sIa=!1,this.uq=new Rg(this.$.domElement,this.A5a,this.Wja,this.ea,!1,this.$,!0,this.cWd);else if(E.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.Ypb&&(Sa.a.uV||Sa.a.kJ&&72>Sa.a.qgf))this.sIa=!1,this.uq=
new Rg(this.$.domElement,this.A5a,this.Wja,this.ea,!1,this.$);else{this.sIa=!0;const C=Object(Tc.d)(ka.a.resolve(oa.rd,{va:0}));Bb.TaskExtensions.$e(C,()=>{this.uq=(new Dg(this,this.$,this.ea,C.result)).uq},this.$.ya,3)}}z6i(C){let Ca={};try{if(Ca=R.a.Vp(C),fb.b().JI(this.zDe.id,Ca.ServerCorrelationId,"actions","ServerActions"),!he.a.ll(Ca.Errors)&&Ca.Result&&(this.$.fa.n9(Ca.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.cWd)){const qb=Ca.Result;cb.a(this.$).IPa(1,qb);const nc=
ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?ka.a.lh(oa.Pg):this.$.qa.zh(277);nc&&nc.$od(this.$,1,Ca.Result,Ca,"InsertPicture");E.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(qb){E.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${C?C.length:-1}, errror: ${qb}`)}this.f3c(Ca,null,"InsertPictureWebMethod")}oQf(C){C=this.mMd(C);const Ca=
{};Ca.Errors=[C];this.f3c(Ca,null,"InsertPictureWebMethod")}f3c(C,Ca,qb){this.FQ(C,Ca,qb)}uze(C,Ca,qb){this.Fwa(C,Ca,qb)}que(C){C=this.mMd(C);new Eb.a(this.$,C)}CDj(C){const Ca=this.$.ua.InsertPicturUnsupportedExtensionsForLogging;C=La.a.As(C);for(let qb=0;qb<Ca.length;++qb)if(C.endsWith(Ca[qb])){E.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${Ca[qb]}`);break}}static Wel(C){return!C||Ma.a.equals(C,Wb.a.insertPictureUnknownError,!0)?2:Ma.a.equals(C,Wb.a.insertPictureNoFileSelectedError,
!0)?1:Ma.a.equals(C,Wb.a.Nfj,!0)?3:Ma.a.equals(C,Wb.a.Qfj,!0)?5:0}static nj(C,Ca,qb,nc){return he.a.nj(1,0,0,C,Ca,qb,nc)}static g4h(C){switch(C){case 1:return 1;case 2:return 6}return 0}Wdf(){return this.Ypb||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(K.a)(Va,"BasePictureUploaderWrapper",ze,[2]);class bd extends Va{constructor(C,Ca,qb,nc,Rc,id){id=void 0===id?!0:id;super(C,Ca,qb,nc,!1);this.nwi=Rc;this.Yyc=C.Eh.wm("LoadResource","FileReaderUploaderLoadResource");id&&
this.showDialog()}fRk(){this.DNc=28E5;this.que(3)}UHd(C){E.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const Ca=new FileReader;C=C.nP.files;if(0==C.length)E.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var qb=C[0];Ca.onload=()=>{this.Yyc.stop();this.nwi.s1j(Ca.result,this);E.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${qb.type}, Size:${qb.size.toString()}`)};
Ca.onerror=()=>{this.Yyc.stop();E.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${qb.type}, Size:${qb.size.toString()}`)};Ca.onabort=()=>{this.Yyc.stop();E.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${qb.type}, Size:${qb.size.toString()}`)};this.Yyc.start();Ca.readAsDataURL(qb)}}finalizeUpload(C,Ca){this.UHd(C,Ca)}}Object(K.a)(bd,"FileReaderUploaderWrapper",Va,[869]);class je{constructor(C,
Ca){this.dataUri=this.sheetName=null;this.sheetName=C;this.dataUri=Ca}getSheetName(){return this.sheetName}}Object(K.a)(je,"MacroRecorderPictureInsertedPayload",null,[149]);class se extends Va{constructor(C,Ca,qb,nc,Rc,id){id=void 0===id?!0:id;super(C,qb,nc,Rc,!1);this.Nh=Ca;id&&this.showDialog()}UHd(C,Ca){super.finalizeUpload(C,Ca);ca.a(this.$.userOperationManager,(qb,nc)=>{this.FQ=qb;this.Fwa=nc;this.zDe.start();this.xpc.PA();this.i9=!1;this.j3g(C);return this.Mgk(C)},qb=>{const nc={};this.$.Qq(nc);
const Rc=nc.SheetName;qb=new od.a(510,0,qb,72,()=>new je(Rc,this.Dde?this.Dde:""));qb.fQa(()=>!0);qb.Nh=this.Nh;return qb},this.Nh)}finalizeUpload(C,Ca){this.UHd(C,Ca)}}Object(K.a)(se,"PictureUploaderWrapper",Va,[]);class Xe{constructor(C,Ca){this.filename=C;this.blob=Ca}}Object(K.a)(Xe,"UploadBlobParameters",null,[]);class wf extends se{constructor(C,Ca,qb,nc,Rc,id,sd){super(C,Ca,qb,nc,Rc,!1);this.d5c=!1;this.KT=sd;this.DFc=wf.JCi(id);C=this.occ(this.DFc.name,this.DFc.size);0!==C?(this.que(C),this.KT.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),
this.dispose()):this.uq=new Rg(this.$.domElement,this.A5a,this.Wja,nc,!1,this.$)}uze(C,Ca,qb){super.uze(C,Ca,qb);this.KT.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}f3c(C,Ca,qb){super.f3c(C,Ca,qb);he.a.ll(C.Errors)?this.KT.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${he.a.fi(C.Errors)}`)):this.KT.setResult(!0)}j3g(C){const Ca=new Xe(this.DFc.name,this.DFc);C.j_g(Ca)}static JCi(C){var Ca=
C.split(",");C=Ca[0].includes("base64")?window.self.atob(Ca[1]):window.self.decodeURI(Ca[1]);Ca=Ca[0].split(":")[1].split(";")[0];const qb=new Uint8Array(C.length);for(let nc=0;nc<C.length;nc++)qb[nc]=C.charCodeAt(nc);C=new Blob([qb],{type:Ca});C.name="Image.png";return C}}Object(K.a)(wf,"DataUrlUploaderWrapper",se,[]);let Nf=class{constructor(){}iej(C,Ca,qb,nc,Rc){-2060689045===Ca.command&&(Rc.IsCellPicture=!0);new se(C,Ca,qb,nc,Rc,!0)}Xcj(C,Ca,qb,nc,Rc,id){new wf(C,null,Ca,qb,nc,Rc,id)}mdj(C,Ca,
qb,nc,Rc){new bd(C,Ca,qb,nc,Rc,!0)}};Nf=Object(ba.__decorate)([Object(ka.d)(oa.Ng)],Nf);Object(K.a)(Nf,"UploaderCreator",null,[841]);let fg=class{constructor(C,Ca){this.L7=()=>{this.Jj||this.m8e()};this.Jj=!1;this.daa=Ca.XX;this.ariaLiveNotifier=C;this.PDe=new Ia(C,Ca);this.daa&&this.daa.EY?this.m8e():this.Kp()}dispose(){this.xo();this.ariaLiveNotifier=this.daa=null;this.Jj=!0}Kp(){if(this.daa){this.daa.gA(this.L7);this.daa.za.qy(this.L7);this.daa.zO(this.L7);var C=Object(qe.a)(138,this.daa);C&&(C.Dh.Mv(this.L7),
C.ha.cx(this.L7),C.ha.add_activeCellChanged(this.L7),C.ha.$a.AO(this.L7))}else E.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}xo(){if(this.daa){this.daa.za.Ax(this.L7);this.daa.oQ(this.L7);const C=Object(qe.a)(138,this.daa);C&&(C.Dh.Cv(this.L7),C.ha.Bx(this.L7),C.ha.remove_activeCellChanged(this.L7),C.ha.$a.dW(this.L7))}}m8e(){this.PDe.tCg();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.sFk();this.dispose()}};fg=Object(ba.__decorate)([Object(ka.d)(oa.Xg),
Object(ba.__param)(0,Object(oa.l)()),Object(ba.__param)(1,Object(oa.Ob)())],fg);Object(K.a)(fg,"WorkbookReadoutHandler",null,[2]);var Of=a(262);const Bg="H1 H2 H3 H4 H5 H6".split(" "),uf=["TD","TH"],Lg=["P","DIV","TABLE","TBODY","THEAD","TFOOT","ARTICLE","ADDRESS","ASIDE","BLOCKQUOTE","CAPTION","CODE","FORM","DETAILS","SUMMARY","LEGEND","FIELDSET","FOOTER","HEADER","KBD","MAIN","SECTION",...Bg],zg="SPAN A ABBR ACRONYM B STRONG I EM SUB SUP BDO BDI BUTTON CITE DATA LABEL DEL INS DFN DIALOG HGROUP MARK S TIME U V FONT".split(" "),
mh=["UL","OL","LI","INPUT","SELECT","AREA","AUDIO","B","BASE","BR","CANVAS","COL","COLGROUP","DATALIST","DD","DETAILS","DFN","DIR","DL","DT","EMBED","FIGCAPTION","FIGURE","HR","IFRAME","IMG","LINK","MAP","MENU","MENUITEM","META","METER","NAV","NOSCRIPT","OBJECT","OPTGROUP","OPTION","OUTPUT","PICTURE","PRE","PROGRESS","Q","RP","RT","RUBY","SAMP","SMALL","SOURCE","TEMPLATE","TEXTAREA","TR","TRACK","VAR","VIDEO",...Lg,...zg,...uf],Cg="table table;table ul;table ol;table dl;ul ul;ol ol;ol ul;ul ol;dl;img".split(";"),
Sf={"sans-serif":"Arial",Owl:"Times New Roman",Zpl:"Courier New",Wnl:"Comic Sans MS",vol:"Algerian"},dh=/^(\d+|\d+\.\d+)(\w+)$/,jh=/>\s+</g;let lc=class{constructor(C){this.sTd=[];this.mV=[];this.I1d=this.MLc=this.Nma=this.Rma=0;this.F3b=C}m6j(C,Ca){this.gQ={l$i:-1,qUf:-1,n$i:-1,Vol:C.length,i$i:0};const qb=[];if(!Ca.token.gN)try{const nc=this.knk(C),Rc=performance.now();this.vnb=this.F3b.Vxk(nc);if(!this.vnb)return E.ULS.sendTraceTag(507377812,0,50,"HtmlProcessor.parseHtml: htmlContent is null after sanitizeAndAppendPastedHtml call"),
Of.a.Ua({Q0a:qb,cseStatus:46,gQ:this.gQ});this.gQ.l$i=performance.now()-Rc;C=!1;for(const S of Cg)if(this.vnb.querySelector(S)){C=!0;break}if(C){const S=performance.now();this.F3b.zFg();this.gQ.qUf=performance.now()-S;return Of.a.Ua({Q0a:qb,cseStatus:41,gQ:this.gQ})}this.yak();this.initialize();const id=performance.now(),sd=this.ivj(this.vnb,qb,Ca);this.gQ.n$i=performance.now()-id;const Fd=performance.now();this.F3b.zFg();this.gQ.qUf=performance.now()-Fd;return sd?(this.gQ.i$i=qb.length,Of.a.Ua({Q0a:qb,
cseStatus:1,gQ:this.gQ})):Of.a.Ua({Q0a:qb,cseStatus:39,gQ:this.gQ})}catch(nc){return E.ULS.sendTraceTag(507377811,0,10,"HtmlProcessor.parseHtml: Error parsing the html",nc),Of.a.Ua({Q0a:qb,cseStatus:46,gQ:this.gQ})}return Of.a.Ua({Q0a:qb,cseStatus:39,gQ:this.gQ})}initialize(){this.I1d=this.MLc=this.Nma=this.Rma=0;this.cP=null;this.tVb=!1;this.mV=[]}yak(){try{E.ULS.sendTraceTag(507377810,0,50,"HtmlProcessor.preprocessStyle: start");const C=this.vnb.getElementsByTagName("style");if(C&&0<C.length){E.ULS.sendTraceTag(507536152,
0,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let Ca=0;Ca<C.length;Ca++)this.vnb=c(this.vnb,C[Ca]),C[Ca]&&(C[Ca].parentNode.removeChild(C[Ca]),Ca--)}}catch(C){E.ULS.sendTraceTag(507377809,0,10,"HtmlProcessor.preprocessStyle: Error while converting style elements to inline style",C)}}ivj(C,Ca,qb){try{const nc=C.childNodes;for(C=0;C<nc.length;C++){if(qb.token.gN)return!1;this.NQf(nc[C],Ca)}return!0}catch(nc){return E.ULS.sendTraceTag(507377808,0,10,"HtmlProcessor.iterateOverChildNodesOfBody: Error while iterating over child nodes of body",
nc),!1}}knk(C){return C.replace(jh,"><")}w4a(){this.Rma++;this.Rma>this.MLc&&(this.MLc=this.Rma);this.cP=null}Geg(){this.Nma++;this.Nma>this.I1d&&(this.I1d=this.Nma);this.cP=null}$tc(C){const Ca={borders:[],fontFamily:"",cellText:"",$xe:0,DCf:!1,color:"",fontSize:11,italic:!1,backgroundColor:"",bold:!1,QE:"",rowIndex:this.Rma,colIndex:this.Nma};C.push(Ca);return Ca}tHc(){var C;return!(null===(C=this.cP)||void 0===C?0:C.cellText)||0===this.cP.cellText.length}nZb(C,Ca){C=C.childNodes;for(let qb=0;qb<
C.length;qb++)this.NQf(C[qb],Ca)}M6i(C,Ca){let qb;if(C.textContent){if(this.mV.map(nc=>nc.element.tagName).some(nc=>uf.includes(nc))||C.nextElementSibling&&zg.includes(C.nextElementSibling.nodeName))qb=C.textContent;else if(qb=C.textContent.trim(),!qb||0===qb.length)return;this.cP||(this.cP=this.$tc(Ca));this.cP.cellText=this.cP.cellText?`${this.cP.cellText}${qb}`:qb;C.parentElement?(Ca=this.F3b.hAf(C.parentElement))?this.cP=n(C,Ca,this.cP,this.tVb,this.mV):E.ULS.sendTraceTag(507536151,0,50,"Computed style is null for parent element"):
E.ULS.sendTraceTag(507536150,0,50,"Parent element is null")}}L4i(C,Ca){const qb=C.getAttribute("href");qb&&0<qb.trim().length&&(this.cP||(this.cP=this.$tc(Ca)),this.cP.QE=qb);this.OQf(C,Ca)}gRd(C,Ca){this.tHc()||this.w4a();this.mV.push({element:C,DHa:C.style});this.nZb(C,Ca);this.mV.pop();this.tHc()||this.w4a()}OQf(C,Ca){this.mV.push({element:C,DHa:C.style});this.nZb(C,Ca);this.mV.pop()}H6i(C,Ca){const qb=this.Nma,nc=this.Rma;this.tHc()||this.w4a();this.mV.push({element:C,DHa:C.style});this.nZb(C,
Ca);this.mV.pop();this.Rma=this.MLc;this.Rma===nc&&this.Nma>qb&&this.w4a();this.Nma=qb}G6i(C,Ca){const qb=this.Rma;this.tVb=!0;this.mV.push({element:C,DHa:C.style});this.nZb(C,Ca);this.mV.pop();this.tVb=!1;this.Rma=qb;this.Geg()}X2i(C){this.cP||(this.cP=this.$tc(C));this.tVb?this.cP.cellText=`${this.cP.cellText}\n`:this.w4a()}f4i(C,Ca){this.mV.push({element:C,DHa:C.style});this.sTd=[];this.gRd(C,Ca);this.mV.pop()}N4i(C,Ca){var qb=C.closest("ul, ol");if(qb){this.sTd.push(C);this.tHc()||this.w4a();
var nc=this.Nma;if("OL"===qb.nodeName){qb=this.$tc(Ca);qb.cellText=`${this.sTd.length}`;const Rc=this.F3b.hAf(C);Rc?n(C,Rc,qb,this.tVb,this.mV):E.ULS.sendTraceTag(507536149,0,50,"Computed style is null for list item element");this.Geg()}this.mV.push({element:C,DHa:C.style});this.nZb(C,Ca);this.mV.pop();this.Nma=nc;this.w4a()}}NQf(C,Ca){switch(C.nodeName){case "#text":this.M6i(C,Ca);break;case "A":this.L4i(C,Ca);break;case "TR":this.H6i(C,Ca);break;case "TD":case "TH":this.G6i(C,Ca);break;case "BR":this.X2i(Ca);
break;case "UL":case "OL":this.f4i(C,Ca);break;case "LI":this.N4i(C,Ca);break;case "CAPTION":C.parentElement&&"TABLE"===C.parentElement.nodeName&&this.gRd(C,Ca);break;default:C.nodeType===Node.ELEMENT_NODE&&(-1<Lg.indexOf(C.nodeName)?this.gRd(C,Ca):-1<zg.indexOf(C.nodeName)&&this.OQf(C,Ca))}}};lc=Object(ba.__decorate)([Object(ka.d)(oa.qd),Object(ba.__param)(0,Object(oa.Ce)())],lc);Object(K.a)(lc,"HtmlProcessor",null,[]);let md=class{constructor(C){this.Bi=C;this.umf()}Vxk(C){try{E.ULS.sendTraceTag(507377807,
0,50,"PastableIframe.sanitizeAndAppendPastedHtml: start");const Ca=this.Bi.UWi(C);if(this.Wna.contentDocument)return this.Wna.contentDocument.body.replaceWith(Ca),this.Wna.contentDocument.body;E.ULS.sendTraceTag(507529291,0,15,"iframe not loaded when append method was called");return Ca}catch(Ca){return E.ULS.sendTraceTag(507377806,0,10,"PastableIframe.sanitizeAndAppendPastedHtml: Error while sanitizing and appending html to iframe",Ca),null}}zFg(){if(this.Wna.contentDocument){var C=this.Wna.contentDocument.body;
C?this.Bi.wM(C):E.ULS.sendTraceTag(507529290,0,15,"iframe body itself is null")}}hAf(C){var Ca;const qb=null===(Ca=this.Wna.contentDocument)||void 0===Ca?void 0:Ca.body;return(null===qb||void 0===qb?0:qb.contains(C))?getComputedStyle(C):C?C.style:null}umf(){const C=performance.now();this.Wna=document.createElement("iframe");Object.assign(this.Wna.style,{visibility:"hidden",zIndex:"-100",position:"absolute",contain:"strict"});this.Wna.setAttribute("sandbox","allow-same-origin");this.Wna.setAttribute("data-debug-id",
"paste-iframe");const Ca=document.getElementsByTagName("body")[0];Ca?Ca.appendChild(this.Wna):E.ULS.sendTraceTag(507529289,0,15,"Body not found");E.ULS.sendTraceTag(507529288,0,50,"Time taken to create iframe: "+(performance.now()-C))}};md=Object(ba.__decorate)([Object(ka.d)(oa.Ce),Object(ba.__param)(0,Object(oa.rd)())],md);Object(K.a)(md,"PastableIframe",null,[]);var Yd=a(729),ke=a(29);const bf=Object(ke.c)(Yd.b);var cf=a(286);const Df=Object(ke.c)(cf.b);var Af=a(635);const qg=Object(ke.c)(Af.b);
var Pg=a(681);const Mg=Object(ke.c)(Pg.b);var gh=a(873),Hh=a(658),Ph=a(1199),rh=a(1075),eh;(function(C){C[C.KDj=0]="loki";C[C.gnl=1]="augloopACLP"})(eh||(eh={}));Object(K.b)("AlternateAuthSupportApp",eh);var Yf=a(612),Qg=a(47);class uh{constructor(){this.Token=null;this.ExpirationTime=0}}Object(K.a)(uh,"WacAlternateAuthToken",null,[]);class Kh{constructor(C,Ca){this.p2k=3E5;this.$5j=qb=>{let nc=null;({Fz:nc}=Qg.d(qb));return nc};if(void 0===C||null===C||void 0===Ca||null===Ca)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ea=C;this.Odc=new gh.a(Hh.a.tm());this.eEb=new Ph.a(C,Ca);void 0!==Yf.a.O4d&&null!==Yf.a.O4d&&void 0!==Yf.a.XMc&&null!==Yf.a.XMc&&0<Yf.a.XMc&&(C=new uh,C.Token=Yf.a.O4d,C.ExpirationTime=Yf.a.XMc,this.Odc.ga("loki",C))}BFi(){let C=null;this.Odc.mh(eh[0])&&(C=this.Odc.ma(eh[0]));return void 0===C||null===C||this.n0d(C)?this.Rvi():Promise.resolve(C.Token)}n0d(C){return C.ExpirationTime-Date.now()<this.p2k}Rvi(){const C=new gh.a(Hh.a.tm());C.ga("X-AlternateAuthApp",eh[0]);return this.eEb.fYa(this.Dna("/afhs/AlternateAuthHelperHandler.ashx",
this.Ea.ka("OwlOriginForAFHSIsEnabled")),this.$5j,2,C).then(Ca=>{E.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",eh[0]);this.Odc.ga(eh[0],Ca);return Ca.Token},Ca=>{Ca=Object(qe.a)(rh.a,Ca);E.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Ca.message,Ca.httpStatusCode);return null})}Dna(C,Ca){C=String.format("{0}{1}?{2}",Ca?this.Ea.Ya("OwlOrigin"):
this.Ea.Ya("WebServiceBase"),C,Aa.AFrameworkApplication.Oo);Ca&&(C+="&usid="+Aa.AFrameworkApplication.userSessionId);return C}}Object(K.a)(Kh,"AlternateAuthHelper",null,[868]);var ai=a(1191),fh=a(1422),Uh=a(1441),Sg=a(283),xh=a(1334),Fg=a(1333),Tg=a(1335),sh=a(1163);class Vh{constructor(){this.Vh=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}co(C){this.Vh=C;this.Vh.register(81,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Ai().Ii(()=>
Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)||Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.DemandLoadCloudPolicySettingsHelper",!1)?Object(Fg.a)():new fh.a(Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.lj));E.ULS.sendTraceTag(507295630,3004,50,"ApplicationFeatureHelperPackage:: configure:: CloudPolicySettingsHelper registered");this.Vh.register(80,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Ai().Ii(()=>
Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?Object(Tg.a)():new Uh.a(Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.lj));this.Vh.register(868,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Ai().Ii(()=>new Kh(Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.lj));this.Vh.register(57,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Ai().Ii(()=>Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",
!1)?(Object(ke.a)(Mg),Object(ke.a)(qg),Object(sh.a)()):new ai.a(Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.lj,Object(ke.a)(Mg),Object(ke.a)(qg),Aa.AFrameworkApplication.xh))}init(){Aa.AFrameworkApplication.ea.cy(()=>{const C=Object(ke.a)(Df);Aa.AFrameworkApplication.ea.ka("LicensingIsEnabled")&&(C.isFeatureEnabled("LicensingTestFeature",!1).then(Ca=>{E.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
Ca,Aa.AFrameworkApplication.ea.Ya("IsAnonymousUser"));return null}),C.getFeatureTier("LicensingTestFeature",0).then(Ca=>{E.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Ca,Aa.AFrameworkApplication.ea.Ya("IsAnonymousUser"));return null}));Object(ke.a)(bf);this.K_k()})}dispose(){}K_k(){try{Aa.AFrameworkApplication.ea.ka("SideCarIsEnabled")&&xh.a.vXg().then(C=>{E.ULS.sendTraceTag(594057429,3004,50,
"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",C);return C})}catch(C){}}static main(){Sg.a.instance.Jo(new Vh)}}Object(K.a)(Vh,"ApplicationFeatureHelperPackage",null,[13,14]);var Qf=a(432),vh=a(373),bg=a(372);const Wh=C=>{C?(C.isAsyncCopy=!1,C.isSelectionAllowed=!1,C.isFromCache=!1,C.plainTextPayloadSize=0,C.shadowWorkbookPayloadSize=0,C.htmlPayloadSize=0,C.htmlSizeExceedsLimit=!1,C.clientSideCopyTime=0,C.encounteredDeploymentErrors=!1,C.shadowWorkbookSizeExceedsLimit=!1,C.originalSourceRangesCountExceedsLimit=
!1,C.copyTotalSizeExceedsLimit=!1):E.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.")},Zg=(C,Ca,qb,nc,Rc)=>{const id=C.Stopwatch,sd={};sd.a=Rc;sd.e=id.id;sd.c="RearrangeRowColumn";sd.b="mouse";sd.d=C.OperationId.toString();sd.f=qb.toString();sd.g=nc.toString();sd.h=Ca.toString();sd.i=C.DragDropIsShiftKeyDown;sd.j=!0;sd.o=id.Ci;sd.q=!1;sd.r=C.CopyPasteTargetType.toString();sd.s=C.EncounteredDeploymentErrors;return sd};class sa{constructor(C,Ca){this.uCi=
()=>{const qb={};qb.SourceItem=this.toString();return qb};this.sessionStateId=C;this.sessionId=Ca;this.toJSON=this.uCi}LHc(C){return C?this.sessionStateId===C.sessionStateId&&this.sessionId===C.sessionId:!1}isFromCurrentSession(C){return this.sessionId===C.ua.UserSessionId}}Object(K.a)(sa,"SourceItem",null,[]);class Vb extends sa{constructor(C,Ca,qb,nc,Rc){super(qb,nc);this.activeFloatingObjectControlId=C;this.sheetName=Ca;this.type=Rc}isEqual(C){return C&&Object.getType(C)===Vb?this.LHc(C)&&this.activeFloatingObjectControlId===
C.activeFloatingObjectControlId&&this.sheetName===C.sheetName:!1}toString(){return this.type.toString()}}Object(K.a)(Vb,"ArtSourceItem",sa,[]);var Sc;(function(C){C[C.valid=0]="valid";C[C.notPairwiseDisjoint=1]="notPairwiseDisjoint";C[C.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";C[C.notValidForm=3]="notValidForm";C[C.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Sc||(Sc={}));Object(K.b)("CopySourceValidationOptions",Sc);class ud extends sa{constructor(C,
Ca){super(C,Ca)}isEqual(C){return this.LHc(C)}}Object(K.a)(ud,"NonGridSourceItem",sa,[]);class va extends sa{constructor(C,Ca,qb,nc,Rc){super(nc,Rc);E.ULS.shipAssertTag(537167645,0,!!Ca&&0<Ca.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=C;this.ranges=Ca;this.sheetName=qb}isEqual(C){return C&&Object.getType(C)===va?this.LHc(C)&&Qa.X(this.ranges,C.ranges)&&this.sheetName===C.sheetName:!1}toString(){return Qa.j(this.ranges,",",this.$,!1)}}Object(K.a)(va,"RangeSourceItem",
sa,[]);const mb=C=>!!C&&Object.getType(C)===va,Tb=C=>!!C&&Object.getType(C)===ud;class yc{}yc.kdl="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(K.a)(yc,"ExpectedErrorNames",null,[]);var Nc=a(953);const zd=C=>C.clipboardItems&&(C=C.clipboardItems.getItem(Nc.a.zoj))&&"1"===C?!0:!1,fe=C=>zd(C)&&!(void 0===C.clipboardItems||null===C.clipboardItems)&&!!C.clipboardItems.getItem(Nc.a.png)&&!C.clipboardItems.getItem(Nc.a.plainText),Ud=C=>C.clipboardItems&&(C=C.clipboardItems.getItem(Nc.a.vjj))&&
"1"===C?!0:!1,P=C=>C&&(C=C.getCachedMetadata(),null===C||void 0===C?0:C.lastCopy)?C.lastCopy:null;class Da{constructor(C,Ca,qb,nc,Rc){this.$=C;this.zoom=Rc;this.originalDestinations=Ca;this.syc=qb;this.jih=nc;this.Bsh=this.originalDestinations;this.lmh=this.syc;this.Zph="PasteRecoveryUI"}get zoomManager(){return this.zoom.zoomManager}get NGh(){return this.jih}get R7f(){return this.Zph}get qik(){return this.Bsh}get uzf(){return this.lmh}cKa(){return Da.Y6j}hLi(){return this.syc&&1===this.syc.length?
this.iLi(this.syc[0]):null}aMd(){return"PasteRecoveryUI-Floatie"}iLi(C){var Ca=ha.f(this.$);const qb=Ca.fh.Wn(C);var nc=Ca.Hl(C,qb);Ca=Ca.rtl;if(!nc)return null;C=ha.f(this.$).ol(qb);const Rc=C.Zr;if(!Rc.$i(nc))return null;nc=Rc.Fk(nc);const id=nc.topLeft.y;var sd=nc.bottomRight.y;const Fd=Ca?nc.bottomRight.x:nc.topLeft.x;nc=Ca?nc.topLeft.x:nc.bottomRight.x;var S=new me.a(nc+(Ca?-81:81),sd+38+6);if(Rc.Dva(S))return this.rmb(C,Rc,qb,nc,sd,Ca?12:-3,66);S=new me.a(nc+(Ca?-81:81),sd);if(Rc.Dva(S))return this.rmb(C,
Rc,qb,nc,sd,Ca?20:3,22);S=new me.a(nc,sd+38+6);if(Rc.Dva(S))return this.rmb(C,Rc,qb,nc,sd,-81+(Ca?18:0),66);nc=new me.a(Fd+(Ca?81:-81),sd);if(Rc.Dva(nc))return this.rmb(C,Rc,qb,Fd,sd,-81+(Ca?12:-6),22);sd=new me.a(Fd,id-38-6);return Rc.Dva(sd)?this.rmb(C,Rc,qb,Fd,id,Ca?15:0,16):this.rmb(C,Rc,qb,Ca?Rc.topLeft.x:Rc.bottomRight.x,Rc.bottomRight.y,-81+(Ca?15:-6),22)}rmb(C,Ca,qb,nc,Rc,id,sd){var Fd=ha.f(this.$);const S=Fd.rtl;C=Sys.UI.DomElement.getLocation(C.domElement);nc=new Sys.UI.Point(nc+(S?0:C.x)-
Ca.topLeft.x,Rc+C.y-Ca.topLeft.y);S&&(Fd=Fd.view.visibleArea,nc.x=Fd.bottomRight.x-Fd.topLeft.x-nc.x,2===qb||4===qb)&&(nc.x+=Ca.bottomRight.x);nc=this.zoomManager.Raa(nc);return new Sys.UI.Point(nc.x+id,nc.y+sd)}}Da.Y6j=["PasteRecoveryUI"];Object(K.a)(Da,"PasteRecoveryUI",null,[906]);var eb=a(661);class bc{}bc.Jxh="ActiveSelection";bc.shadowWorkbook="ShadowWorkbook";bc.Vdh="GVML";bc.plainText="PlainText";bc.html="Html";bc.INh="Bitmap";Object(K.a)(bc,"PayloadType",null,[]);class Pc{}Pc.GUk="Slice6";
Object(K.a)(Pc,"SliceName",null,[]);class gd{}gd.TLj="NotCalled";gd.success="Success";gd.failed="Failed";Object(K.a)(gd,"SucceededPopulatingSystemClipboardOptions",null,[]);var nd=a(319);const Vd=(C,Ca)=>C?Ca&&Ca.ua?C.sessionId!==Ca.ua.UserSessionId:(E.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(E.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),ie=C=>{switch(C){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},vd=
C=>{if(!C)return"null";const Ca=[];for(const qb of C.get())Ca.push(`${qb.clipboardDataFormat}(${qb.data.length})`);Ca.sort();return Ca.join(",")};var Sd;(function(C){C[C.valid=0]="valid";C[C.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";C[C.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";C[C.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";C[C.multipleSourcesAndMultipleDestinationsAreNotSupported=
4]="multipleSourcesAndMultipleDestinationsAreNotSupported";C[C.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";C[C.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";C[C.copySourceNotValid=7]="copySourceNotValid";C[C.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";C[C.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";C[C.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";
C[C.unknown=100]="unknown"})(Sd||(Sd={}));Object(K.b)("PasteValidationOptions",Sd);var te=a(245),ne=a(145),Ce=a(132),Qe=a(676),df=a(107);class da extends Sys.EventArgs{constructor(C,Ca,qb){super();this.command=C;this.destinationRange=Ca;this.sourceRange=qb}}Object(K.a)(da,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var hb=a(143);class Ac extends Da{constructor(C,Ca,qb,nc,Rc){super(C,Ca,qb,nc,Rc);this.Fxj="DragRecoveryUI"}get R7f(){return this.Fxj}cKa(){return Ac.oji}aMd(){return"DragRecoveryUI-Floatie"}}
Ac.oji=["DragRecoveryUI"];Object(K.a)(Ac,"DragFillRecoveryUI",Da,[]);var Lc=a(778),Qd=a(433);class de extends Qd.a{constructor(C,Ca,qb){super(C);this.Oh=0;this.initializeAndShow(qa.a.instance.ia(1060),Ca,qb)}get Ji(){return"CopyPasteShortcutReactDialog"}}Object(K.a)(de,"CopyPasteShortcutReactDialog",Qd.a,[]);var Me=a(434);class Te{constructor(C){this.tK=null;this.wXa=Ca=>{this.tK(1===Ca?Te.mMb:Lc.a[Ca],!1);Te.Bia=!1};this.$=C}showDialog(C,Ca,qb,nc){this.tK=nc;Te.KXb=Sa.a.isMac||Sa.a.io;this.tK||(this.tK=
()=>{});Te.Bia?nc(Te.lMb,!1):(Te.Bia=!0,Ca={},C?(Ca.forwardElementText=qa.a.instance.ia(1061),Ca.cutText=Te.KXb?qa.a.instance.ia(1050):qa.a.instance.ia(1062),Ca.copyText=Te.KXb?qa.a.instance.ia(1051):qa.a.instance.ia(1063),Ca.pasteText=Te.KXb?qa.a.instance.ia(1052):qa.a.instance.ia(1064),Ca.pasteTextOnly=Te.KXb?qa.a.instance.ia(1055):qa.a.instance.ia(1065)):(Ca.forwardElementText=qa.a.instance.ia(1066),Ca.cutText=qa.a.instance.ia(1067)),new de(this.$,this.wXa,{[Me.a.Gz]:Te.id,["bodyControls"]:Ca}))}}
Te.Bia=!1;Te.KXb=!1;Te.lMb="notOpened";Te.mMb="ok";Te.id="CopyPasteShortcutDialog";Object(K.a)(Te,"CopyPasteShortcutDialog",null,[900]);class zf extends Qd.a{constructor(C,Ca,qb){super(C);this.Oh=0;this.si(1,qa.a.instance.ia(1054));this.jja(1);this.initializeAndShow(qa.a.instance.ia(1046),Ca,qb)}get Ji(){return"CopyPasteInstallReactDialog"}}Object(K.a)(zf,"CopyPasteInstallReactDialog",Qd.a,[]);class dg{constructor(C){this.tK=null;this.wXa=Ca=>{1===Ca?(E.ULS.sendTraceTag(508359137,0,50,"User clicked the install button"),
this.X5h(),this.O9j(),this.tK(dg.mMb,!0)):(E.ULS.sendTraceTag(508359136,0,50,"User clicked the cancel button"),this.tK(Lc.a[Ca],!1));dg.Bia=!1};this.$=C}showDialog(C,Ca,qb,nc){this.tK=nc=void 0===nc?()=>{}:nc;Ca=Sa.a.isMac||Sa.a.io;dg.Bia?nc(dg.lMb,!1):(dg.Bia=!0,nc={},C&&(nc.extensionStartText=nc.extensionStartText=Sa.a.kJc?qa.a.instance.ia(1048):qa.a.instance.ia(1047),nc.extensionLink=null,nc.extensionEndText=null,nc.shortcutsMessageText=qa.a.instance.ia(1049),nc.cutText=Ca?qa.a.instance.ia(1050):
qa.a.instance.ia(1062),nc.copyText=Ca?qa.a.instance.ia(1051):qa.a.instance.ia(1063),nc.pasteText=Ca?qa.a.instance.ia(1052):qa.a.instance.ia(1064),nc.pasteTextOnly=Ca?qa.a.instance.ia(1055):qa.a.instance.ia(1065)),new zf(this.$,this.wXa,{[Me.a.Gz]:dg.id,["bodyControls"]:nc}))}X5h(){void ka.a.resolve(oa.E,{va:0}).then(C=>{C.Rm(68,null)})}O9j(){const C=this.$.ua;Ic.a.Em(`${C.ChromeClipboardAccessExtensionLink}${Sa.a.kJc?C.ChromeClipboardAccessExtensionId:C.OfficeOnlineChromeExtensionId}`,"_blank",void 0,
"ChromeCCPInstallDialog")}}dg.Bia=!1;dg.lMb="notOpened";dg.mMb="ok";dg.id="CopyPasteInstallDialog";Object(K.a)(dg,"CopyPasteInstallDialog",null,[900]);class tg extends Sys.EventArgs{constructor(C,Ca){super();this.gqf=C;this.uo=Ca}}Object(K.a)(tg,"PasteSucceededEventArgs",Sys.EventArgs,[]);var Gg=a(157);class ah extends Qd.a{constructor(C,Ca,qb){super(C);this.Oh=0;Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?this.si(1,CommonUiStrings.DialogOk):this.si(1,CommonUIStrings.l_DialogOk);this.jja(1);
this.initializeAndShow(qa.a.instance.ia(2390),Ca,qb)}get Ji(){return"CopyPasteNoClipboardAccessReactDialog"}}Object(K.a)(ah,"CopyPasteNoClipboardAccessReactDialog",Qd.a,[]);class bh{constructor(C){this.tK=null;this.wXa=Ca=>{1===Ca?this.tK(bh.mMb,!0):this.tK(Lc.a[Ca],!1);bh.Bia=!1;this.uzd&&URL.revokeObjectURL(this.uzd)};this.$=C}showDialog(C,Ca,qb,nc){this.tK=nc=void 0===nc?()=>{}:nc;Ca=Sa.a.isMac||Sa.a.io;bh.Bia?nc(bh.lMb,!1):(bh.Bia=!0,nc={},C&&(nc.startText=qa.a.instance.ia(2391),nc.endText=qa.a.instance.ia(2392),
Aa.AFrameworkApplication.ea.ka("IsNewStringEnabled")?(nc.cutText=CommonUiStrings.CutString,nc.copyText=CommonUiStrings.CopyString,nc.pasteText=CommonUiStrings.PasteString,nc.cutShortcutText=Ca?CommonUiStrings.CutShortcut_Mac:CommonUiStrings.CutShortcut,nc.copyShortcutText=Ca?CommonUiStrings.CopyShortcut_Mac:CommonUiStrings.CopyShortcut,nc.pasteShortcutText=Ca?CommonUiStrings.PasteShortcut_Mac:CommonUiStrings.PasteShortcut,nc.imageAltText=CommonUiStrings.NoClipboardAccessDialogImageAltText,nc.primaryButtonLabel=
CommonUiStrings.DialogOk):(nc.cutText=CommonUIStrings.l_CutString,nc.copyText=CommonUIStrings.l_CopyString,nc.pasteText=CommonUIStrings.l_PasteString,nc.cutShortcutText=Ca?CommonUIStrings.l_CutShortcut_Mac:CommonUIStrings.l_CutShortcut,nc.copyShortcutText=Ca?CommonUIStrings.l_CopyShortcut_Mac:CommonUIStrings.l_CopyShortcut,nc.pasteShortcutText=Ca?CommonUIStrings.l_PasteShortcut_Mac:CommonUIStrings.l_PasteShortcut,nc.imageAltText=CommonUIStrings.l_NoClipboardAccessDialogImageAltText,nc.primaryButtonLabel=
CommonUIStrings.l_DialogOk),this.uzd=URL.createObjectURL(new Blob(['\n<svg width="440" height="114" viewBox="0 0 457 114" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g filter="url(#filter0_dd_2_4645)">\n<rect x="15" y="8" width="427" height="85" rx="8" fill="#F3F3F3"/>\n<g clip-path="url(#clip0_2_4645)">\n<rect x="15" y="8" width="427" height="40" fill="#CECECE"/>\n<mask id="mask0_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="15" y="40" width="427" height="12">\n<rect x="15" y="40" width="427" height="12" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask0_2_4645)">\n<g filter="url(#filter1_dd_2_4645)">\n<rect x="15" y="48" width="427" height="4" fill="#F3F3F3"/>\n</g>\n</g>\n<mask id="mask1_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="23" y="12" width="256" height="36">\n<rect x="23" y="12" width="256" height="36" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask1_2_4645)">\n<g filter="url(#filter2_dd_2_4645)">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M31 24C31 19.5817 34.5817 16 39 16H263C267.418 16 271 19.5817 271 24V40C271 44.4183 274.582 48 279 48V52H271H31H23V48C27.4183 48 31 44.4183 31 40V24Z" fill="#F3F3F3"/>\n</g>\n</g>\n<g clip-path="url(#clip1_2_4645)">\n<path d="M251.089 28.2157L251.146 28.1464C251.32 27.9729 251.589 27.9536 251.784 28.0886L251.854 28.1464L255 31.293L258.146 28.1464C258.342 27.9512 258.658 27.9512 258.854 28.1464C259.049 28.3417 259.049 28.6583 258.854 28.8536L255.707 32L258.854 35.1464C259.027 35.32 259.046 35.5894 258.911 35.7843L258.854 35.8536C258.68 36.0271 258.411 36.0464 258.216 35.9114L258.146 35.8536L255 32.707L251.854 35.8536C251.658 36.0488 251.342 36.0488 251.146 35.8536C250.951 35.6583 250.951 35.3417 251.146 35.1464L254.293 32L251.146 28.8536C250.973 28.68 250.954 28.4106 251.089 28.2157L251.146 28.1464L251.089 28.2157Z" fill="#1A1A1A"/>\n</g>\n<g clip-path="url(#clip2_2_4645)">\n<path d="M55 28.6641V32L52.3359 33L49.6641 32L43 28.6641V25.3359C43 25.1484 43.0651 24.9896 43.1953 24.8594C43.3255 24.7292 43.4818 24.6641 43.6641 24.6641H49.6641L55 28.6641Z" fill="#21A366"/>\n<path d="M55 25.3359V28.6641H49.6641V24.6641H54.3359C54.4245 24.6641 54.5104 24.6823 54.5938 24.7188C54.6719 24.7552 54.7422 24.8047 54.8047 24.8672C54.862 24.9245 54.9089 24.9948 54.9453 25.0781C54.9818 25.1562 55 25.2422 55 25.3359Z" fill="#33C481"/>\n<path d="M55 35.3359V38.6641C55 38.8516 54.9349 39.0104 54.8047 39.1406C54.6745 39.2708 54.5182 39.3359 54.3359 39.3359H43.6641C43.4818 39.3359 43.3255 39.2708 43.1953 39.1406C43.0651 39.0104 43 38.8516 43 38.6641V35.375V32H49.6641L55 35.3359Z" fill="#185C37"/>\n<path d="M49.6641 28.6797V32H43V28.6797H49.6641ZM55 35.3359H49.6641V32.0078H55V35.3359Z" fill="black" fill-opacity="0.5"/>\n<path d="M48.2188 28C48.4375 28 48.6224 28.0755 48.7734 28.2266C48.9245 28.3776 49 28.5625 49 28.7812V36.4297C49 36.5391 48.974 36.6484 48.9219 36.7578C48.8698 36.862 48.7995 36.9583 48.7109 37.0469C48.6224 37.1302 48.5234 37.2005 48.4141 37.2578C48.2995 37.3099 48.1849 37.3359 48.0703 37.3359H43V28H48.2188Z" fill="black" fill-opacity="0.498"/>\n<path d="M47.5547 36.6641H39.7812C39.5625 36.6641 39.3776 36.5911 39.2266 36.4453C39.0755 36.2943 39 36.1094 39 35.8906V28.1094C39 27.8906 39.0755 27.7083 39.2266 27.5625C39.3776 27.4115 39.5625 27.3359 39.7812 27.3359H47.5547C47.7734 27.3359 47.9583 27.4115 48.1094 27.5625C48.2604 27.7083 48.3359 27.8906 48.3359 28.1094V35.8906C48.3359 36.1094 48.2604 36.2943 48.1094 36.4453C47.9583 36.5911 47.7734 36.6641 47.5547 36.6641Z" fill="#107C41"/>\n<path d="M41.2812 34.6641L43.0078 31.9922L41.4297 29.3359H42.7031L43.5625 31.0312C43.6042 31.1146 43.638 31.1849 43.6641 31.2422C43.6849 31.2995 43.7057 31.349 43.7266 31.3906H43.7422C43.7682 31.3281 43.7969 31.2656 43.8281 31.2031C43.8542 31.1406 43.8854 31.0781 43.9219 31.0156L44.8438 29.3359H46.0078L44.3828 31.9766L46.0469 34.6641H44.8047L43.8125 32.7969C43.7656 32.7292 43.724 32.6458 43.6875 32.5469H43.6719C43.6615 32.5781 43.6484 32.6146 43.6328 32.6562C43.612 32.6927 43.5885 32.737 43.5625 32.7891L42.5312 34.6641H41.2812Z" fill="white"/>\n</g>\n<rect x="67" y="29" width="96" height="6" rx="3" fill="#B2AFAC"/>\n<path d="M289 24.5C289 24.2239 288.776 24 288.5 24C288.224 24 288 24.2239 288 24.5V31H281.5C281.224 31 281 31.2239 281 31.5C281 31.7761 281.224 32 281.5 32H288V38.5C288 38.7761 288.224 39 288.5 39C288.776 39 289 38.7761 289 38.5V32H295.5C295.776 32 296 31.7761 296 31.5C296 31.2239 295.776 31 295.5 31H289V24.5Z" fill="#1A1A1A"/>\n</g>\n<rect x="15" y="48" width="427" height="38" fill="#F3F3F3"/>\n<rect x="15" y="86" width="427" height="1" fill="#CCCCCC"/>\n<path d="M42.159 73.3666C42.3629 73.5528 42.6792 73.5384 42.8654 73.3345C43.0515 73.1305 43.0371 72.8143 42.8332 72.6281L36.6653 66.9974H50.4961C50.7722 66.9974 50.9961 66.7735 50.9961 66.4974C50.9961 66.2212 50.7722 65.9974 50.4961 65.9974H36.6682L42.8332 60.3693C43.0371 60.1831 43.0515 59.8668 42.8654 59.6629C42.6792 59.459 42.3629 59.4446 42.159 59.6307L35.2426 65.9448C35.1027 66.0725 35.0229 66.2401 35.0031 66.4132C34.9985 66.4406 34.9961 66.4687 34.9961 66.4974C34.9961 66.5242 34.9982 66.5506 35.0023 66.5763C35.0205 66.7522 35.1006 66.9229 35.2426 67.0526L42.159 73.3666Z" fill="#1A1A1A"/>\n<g opacity="0.3">\n<path d="M87.8371 59.6307C87.6332 59.4446 87.3169 59.459 87.1307 59.6629C86.9446 59.8668 86.959 60.1831 87.1629 60.3693L93.3307 66H79.5C79.2239 66 79 66.2239 79 66.5C79 66.7761 79.2239 67 79.5 67H93.3279L87.1629 72.6281C86.959 72.8143 86.9446 73.1305 87.1307 73.3345C87.3169 73.5384 87.6332 73.5528 87.8371 73.3666L94.7535 67.0526C94.8934 66.9248 94.9732 66.7573 94.993 66.5841C94.9976 66.5568 95 66.5287 95 66.5C95 66.4731 94.9979 66.4468 94.9938 66.421C94.9756 66.2451 94.8955 66.0745 94.7535 65.9448L87.8371 59.6307Z" fill="#1A1A1A"/>\n</g>\n<path d="M124.066 66.05C124.59 62.2198 128.121 59.5401 131.951 60.0648C133.894 60.3309 135.54 61.3695 136.623 62.8297L136.749 63H133.5C133.224 63 133 63.2239 133 63.5C133 63.7761 133.224 64 133.5 64H137.5C137.776 64 138 63.7761 138 63.5V59.5C138 59.2239 137.776 59 137.5 59C137.224 59 137 59.2239 137 59.5V61.7073C135.776 60.3185 134.065 59.3451 132.087 59.074C127.709 58.4744 123.675 61.5369 123.075 65.9143C122.475 70.2917 125.538 74.3264 129.915 74.926C134.293 75.5256 138.327 72.4631 138.927 68.0857C139.001 67.5445 139.019 67.0079 138.986 66.4821C138.968 66.2065 138.73 65.9974 138.455 66.015C138.179 66.0326 137.97 66.2703 137.988 66.5459C138.017 67.0055 138.001 67.4752 137.936 67.95C137.412 71.7802 133.881 74.4599 130.051 73.9353C126.221 73.4106 123.541 69.8802 124.066 66.05Z" fill="#1A1A1A"/>\n<g filter="url(#filter3_d_2_4645)">\n<rect x="159" y="52" width="275" height="30" rx="8" fill="#FBFBFB"/>\n</g>\n<rect x="171" y="55" width="27" height="24" rx="4" fill="#F3F2F1"/>\n<path d="M190.051 65.3663V73H178.527V65.3663H180.686V62.1832C180.686 61.7458 180.782 61.3333 180.973 60.9457C181.159 60.558 181.415 60.2201 181.741 59.9318C182.067 59.6436 182.45 59.4175 182.888 59.2535C183.327 59.0845 183.794 59 184.289 59C184.784 59 185.251 59.0845 185.689 59.2535C186.128 59.4175 186.51 59.6436 186.837 59.9318C187.163 60.2201 187.422 60.558 187.613 60.9457C187.798 61.3333 187.891 61.7458 187.891 62.1832V65.3663H190.051ZM181.412 65.3663H187.166V62.1832C187.166 61.8353 187.09 61.5073 186.938 61.1991C186.786 60.886 186.581 60.6152 186.322 60.3866C186.063 60.158 185.76 59.9766 185.411 59.8424C185.057 59.7082 184.683 59.6411 184.289 59.6411C183.889 59.6411 183.515 59.7082 183.167 59.8424C182.818 59.9766 182.514 60.158 182.256 60.3866C181.997 60.6152 181.792 60.886 181.64 61.1991C181.488 61.5073 181.412 61.8353 181.412 62.1832V65.3663ZM189.325 66H179.252V72.3589H189.325V66Z" fill="black"/>\n</g>\n<defs>\n<filter id="filter0_dd_2_4645" x="0.6" y="4.76837e-07" width="455.8" height="113.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="6.4"/>\n<feGaussianBlur stdDeviation="7.2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="1.2"/>\n<feGaussianBlur stdDeviation="1.8"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter1_dd_2_4645" x="7.8" y="44" width="441.4" height="18.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter2_dd_2_4645" x="15.8" y="12" width="270.4" height="50.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter3_d_2_4645" x="155" y="50" width="283" height="38" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="2"/>\n<feGaussianBlur stdDeviation="2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_2_4645" result="shape"/>\n</filter>\n<clipPath id="clip0_2_4645">\n<path d="M15 16C15 11.5817 18.5817 8 23 8H434C438.418 8 442 11.5817 442 16V48H15V16Z" fill="white"/>\n</clipPath>\n<clipPath id="clip1_2_4645">\n<rect width="12" height="12" fill="white" transform="translate(249 26)"/>\n</clipPath>\n<clipPath id="clip2_2_4645">\n<rect width="16" height="16" fill="white" transform="translate(39 24)"/>\n</clipPath>\n</defs>\n</svg>\n'],
{type:"image/svg+xml"})),nc.imageSrc=this.uzd,nc.learnMoreLink=null),new ah(this.$,this.wXa,{[Me.a.Gz]:bh.id,["bodyControls"]:nc}))}}bh.Bia=!1;bh.lMb="notOpened";bh.mMb="ok";bh.id="CopyPasteNoClipboardAccessDialog";Object(K.a)(bh,"CopyPasteNoClipboardAccesslDialog",null,[900]);var Bh=a(201),Qh=a(74),Lh=a(65),Rh;(function(C){C[C.source=0]="source";C[C.destination=1]="destination"})(Rh||(Rh={}));Object(K.b)("RangeType",Rh);class Gf extends ac.a{constructor(C,Ca,qb,nc,Rc,id,sd,Fd,S,Ua,Hb,Ec){Ec=void 0===
Ec?null:Ec;super();this.u1g=this.v1g=this.Otb=this.nPb=null;this.Ipb=!1;this.b3a=ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StickyFormattingEnabled",!1);this.krf=()=>{var cd;(null===(cd=this.nPb)||void 0===cd?0:cd.$2f())&&!Qa.X(ha.f(this.$).ha.pa.selectedRanges,this.nPb.KLc)&&(this.nPb.ewa(),this.nPb=null);this.da.ha.Bx(this.krf)};this.Aae=cd=>{this.FMk(cd)&&(this.nA.ISd(),E.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
this.dDj=(cd,Bd)=>{E.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${cd}]. userPressedExtensionLink=${Bd}`);this.da.focus()};this.dCj=(cd,Bd)=>{E.ULS.sendTraceTag(508130372,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got No Clipboard Access Dialog, user pressed [${cd}]. userPressedOK=${Bd}`);this.da.focus()};this.Dj=(cd,Bd)=>{Bd.P1||Bd.$l||this.Sx("OnWorkbookOpened",!1).catch(()=>{})};this.Bq=(cd,Bd)=>
{cd=P(this.wN);const ce=this.nA.RCc(cd);ce&&(Bd.la&&Bd.la.sheetName===ce.sheetName&&ce.isFromCurrentSession(this.$)?this.nA.ITf(ce.ranges,cd.commandParameters.commandType):this.nA.ISd())};this.fQc=(cd,Bd)=>{cd=P(this.wN);(cd=this.nA.RCc(cd))&&Bd.item&&Bd.item.sheetName===cd.sheetName&&cd.isFromCurrentSession(this.$)&&this.Sx("OnItemDeleting",!1).catch(()=>{})};this.K7=()=>{this.v1g()};this.pZ=()=>{this.u1g()};this.m2=(cd,Bd)=>{1===Bd.zx&&Bd.Xl.operation.flags&2&&this.Sx("OnQueueItemChanged/ItemRemoved",
!1).catch(()=>{})};this.$=C;this.zoom=S;this.Grh=Hb;this.xk=qb;this.da=ha.f(C);this.nA=Rc;this.Afj=id;this.wN=Ca;this.ZXa=nc;this.rUf=Ua;this.getStringifiedError=Ec||copyPasteInfra.getStringifiedError;this.RUg=1===Fd;this.Kp();sd||(E.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),sd=Gf.Ndi);this.userHash=La.a.uE(sd);this.EHj="CultureTag: "+qa.a.instance.ovc+" HASH: ";this.wN.addMetadataChangeListener(Gf.Zdg,this.Aae);this.JGj=this.$.ua.CCPPastePlainTextLimit;
this.l0b=this.$.ua.CCPCopyPasteHtmlLimit;void ka.a.uj(oa.Ee).then(cd=>{this.Otb=cd});this.v1g=te.b(()=>{this.i1j()},1,this.$.ya,"CopyPasteInfrastructure.OnStartEditInternal",!0);this.u1g=te.b(()=>{this.PSj()},1,this.$.ya,"CopyPasteInfrastructure.onEndEditInternal",!0)}get vwj(){return this.Uph}BIa(){var C=P(this.wN);return C?(C=C.sourceItem)&&!C.isFromCurrentSession(this.$)?(E.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return oa.De.Ma()?this.Grh:this.$.qa.zh(373)}YEh(C){this.addHandler(Gf.Gbe,C)}Kpk(C){this.removeHandler(Gf.Gbe,C)}bJb(C){this.addHandler(Gf.T6c,C)}Rpk(C){this.removeHandler(Gf.T6c,C)}copy(C){C.stopwatch=this.$.Eh.Oi("UserAction",fb.b().kp(C.ribbonCommandInfo.command)+"ClientSide");void ka.a.resolve(oa.Ee).then(id=>{this.Otb=id});const Ca=!!P(this.wN);eb.a.v1a&&(this.Ipb=!1);this.Sx("Copy/before/"+vh.a[C.ribbonCommandInfo.method],!1,void 0,!0,C.copyPasteTargetType).catch(()=>
{});var qb=-1985798686===C.ribbonCommandInfo.command;if(1===this.da.Hk&&(qb=this.nA.jZf(this.da.ha.pa.selectedRanges,qb),0!==qb)){const id=Gf.r3h(qb);this.wOa(id,Sc[qb],!1);return Promise.reject(!1)}C.userHash=this.userHash;C.id=Zb.a.create().toString();const nc=this,Rc=this;return this.ZXa.onCopy(C).then(id=>{var sd;id.isAsyncCopy||C.stopwatch.stop();nc.pasteIndicationManager.QDd();var Fd=nd.d(C);E.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${Fd}`);
nc.QAj(id,Ca);Fd=1===C.copyPasteTargetType;!C.isFormatPainter&&Fd&&(nc.Otb?nc.Otb.Yli():E.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));ta.EwaSettings.Dba()&&mb(id.sourceItem)&&1===id.sourceItem.ranges.length&&(id=id.sourceItem.ranges[0],Fd=this.da.za.sxa(id,this.$.activeItemName),id=null===Fd||void 0===Fd?void 0:Fd.HC(id),this.Uph=null===(sd=null===id||void 0===id?void 0:id.formattedText)||void 0===sd?void 0:sd.Text);return Promise.resolve(!0)},id=>{let sd=!1,Fd="none",
S=Gf.Xib,Ua=!0,Hb=-1,Ec=Gf.copyErrorName+Gf.ZIa,cd=!1,Bd=null;if(id){Bd=id.copyContext;Hb=id.reason;Ec+=Gf.nKa(id);id.message&&(S=id.message);var ce=Gf.q3h(id);if(ce)if(3===ce.copyErrorName)sd=!0,S=Fd="Async Copy canceled by the user.",Ua=!1;else if(he.a.Qx(ce.ewaErrors))if(S=Rc.BBc(ce.ewaErrors),he.a.oo(ce.ewaErrors,Gf.operationSucceededWithAlert))cd=sd=!0;else if(he.a.oo(ce.ewaErrors,Gf.pasteDataLimitHit)||he.a.oo(ce.ewaErrors,Gf.copyThrottlingError))sd=!0;13===id.reason?(sd=!0,Ua=!1):11===id.reason&&
(Ua=!1)}ce=id?Rc.getStringifiedError(id):"null";sd?(ce=nd.d(C),E.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${Ua}, Friendly message: ${Fd}, Error Message: ${S}, CommandParameters: ${ce}`)):E.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${Ua}, Error Message: ${ce}, CommandParameters: ${nd.d(C)}`);Ua&&Rc.Sx("Copy/fail/"+vh.a[C.ribbonCommandInfo.method],
!0,void 0,void 0,C.copyPasteTargetType).catch(()=>{});Rc.J9f(C,sd,S,Ec,Hb,cd,Bd);return Promise.reject(id)})}writeToClipboard(C){C.stopwatch=this.$.Eh.Oi("UserAction",fb.b().kp(C.ribbonCommandInfo.command)+"ClientSide");this.Sx("Copy/before/"+vh.a[C.ribbonCommandInfo.method],!1,void 0,!0,C.copyPasteTargetType).catch(()=>{});C.userHash=this.userHash;C.id=Zb.a.create().toString();return this.ZXa.onCopy(C).then(()=>{C.stopwatch.stop();return Promise.resolve(!0)},Ca=>{let qb=Gf.Xib,nc=-1,Rc=Gf.copyErrorName+
Gf.ZIa,id=null;Ca&&(id=Ca.copyContext,nc=Ca.reason,Rc+=Gf.nKa(Ca),Ca.message&&(qb=Ca.message));const sd=nd.d(C);E.ULS.sendTraceTag(508074081,0,15,`CopyPasteInfrastructure.writeToClipboard: Copy operation failed with an error. Error Message: ${qb}, CommandParameters: ${sd}`);this.J9f(C,!1,qb,Rc,nc,!1,id);return Promise.reject(Ca)})}s7j(C){if(this.BIa())return Tc.a(this.QUd(C.commandType,C.ribbonCommandInfo));const Ca=Qa.d(this.da.ha.pa.selectedRanges);C.originalDestinations=Ca;C.expandDestinations=
this.Sqc(C.originalDestinations,C.commandType);if(this.crc(C.commandType,C.expandDestinations)||this.Xdf())C.userHash=this.userHash,C.id=Zb.a.create().toString(),this.ZXa.onPaste(C).then(()=>Promise.resolve(!0),qb=>Promise.reject(qb));return Promise.resolve(!0)}p7j(C){const Ca=nd.b();Ca.ribbonCommandInfo=C;Ca.userHash=this.userHash;Ca.id=Zb.a.create().toString();Ca.isKeyboardEvent=!1;Ca.copyPasteTargetType=this.CMa();Ca.skipSystemClipboardAccess=!1;Ca.stopwatch=this.$.Eh.Oi("UserAction",fb.b().kp(Ca.ribbonCommandInfo.command)+
"ClientSide");this.Sx("CopyPasteInfrastructure.performFullSheetCopy",!1).catch(qb=>Promise.reject(qb));return this.ZXa.onCopy(Ca).then(()=>{const qb=nd.d(Ca);E.ULS.sendTraceTag(507818122,0,50,`CopyPasteInfrastructure.performFullSheetCopy: Operation finished successfully. ${qb}`);return Promise.resolve(!0)},qb=>Promise.reject(qb))}q7j(C,Ca){if(this.BIa())return Promise.resolve(null);const qb=nd.c();qb.ribbonCommandInfo=C;qb.id=Zb.a.create().toString();qb.clearStateOnFinish=!1;qb.isKeyboardEvent=this.Nob(C,
Ca);qb.skipClipboardAccess=Bh.d(Ca,X.a.skipClipboardAccess);qb.copyPasteTargetType=this.CMa();qb.skipSystemClipboardAccess=!1;return this.ZXa.onPaste(qb).then(nc=>nc).catch(nc=>Promise.reject(nc))}PXd(){var C;return null===(C=P(this.wN))||void 0===C?void 0:C.isFullSheetCopy}llg(C,Ca){if(C.method){var qb=new Ac(this.$,Qa.d(this.da.ha.pa.selectedRanges),Qa.d(this.da.ha.pa.selectedRanges),{},this.zoom);(nc=>{const Rc=Object(Tc.d)(ka.a.resolve(oa.of,{va:0}));Bb.TaskExtensions.$e(Rc,()=>{C.method&&nc(Rc.result)},
this.ya,8)})(nc=>{nc.Ptd(qb);nc.Gue(C.method,Ca);this.nPb=nc});E.ULS.sendTraceTag(508680074,0,50,"CopyPasteInfrastructure.OnFill: Drag Copy Fill Floatie");this.da.ha.cx(this.krf)}}paste(C){C.stopwatch=this.$.Eh.Oi("UserAction",fb.b().kp(C.ribbonCommandInfo.command)+"ClientSide");eb.a.v1a&&(E.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.Ipb=!1);ha.f(this.$).tk&&ha.f(this.$).tk.BQ(this.oOd(C.ribbonCommandInfo.command),C.stopwatch.id);
if(C.isPasteCommandFromRecoveryUI){var Ca=ka.a.lh(oa.of);var qb=Qa.d(Ca.KLc);if(!qb)return E.ULS.sendTraceTag(508699777,0,20,"RecoveryUI paste destinations must not be null or undefined"),Promise.resolve(!0);Ca=Ca.H1d;C.pasteRecoveryCachedClipboardItems=Ca?Ca[Gf.Fvg]:null}else qb=Qa.d(this.da.ha.pa.selectedRanges);C.originalDestinations=qb;C.expandDestinations=this.Sqc(C.originalDestinations,C.commandType);if(this.crc(C.commandType,C.expandDestinations)||this.Xdf())return C.userHash=this.userHash,
C.id=Zb.a.create().toString(),qi(this.$)&&(C.isAsyncSystemClipboardEnabled=!0),this.ZXa.onPaste(C).then(nc=>this.HQc(nc,C),nc=>this.w2b(C,nc));this.$.oi(927125067,Vc.a.ph,30,null);qb=Qa.j(C.expandDestinations,",",this.$,!1);E.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${qb}, CommandType: ${C.commandType}, copyPasteTargetType="${C.copyPasteTargetType}"`);return Promise.resolve(!0)}oOd(C){switch(C){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}Xdf(){return!!ha.f(this.$).ha.$a.activeFloatingObjectControlId&&this.$.wy(null,!1,470)}CMa(){const C=P(this.wN);return C&&C.commandParameters?C.commandParameters.copyPasteTargetType:0}yoj(){return!!P(this.wN)&&Vd(P(this.wN),this.$)}Sx(C,Ca,qb,nc,Rc){qb=void 0===qb?!1:qb;nc=void 0===nc?!1:nc;Rc=void 0===Rc?0:Rc;try{this.Otb&&this.Otb.awc();let id=Rc;const sd=this.wwj();if(!nc&&2===sd)return E.ULS.sendTraceTag(537167821,
0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${Ca}', isExplicit = '${qb}', isForce = '${nc}', Current CCP operation copyPasteTargetType = '${Rc}', LastCopyPasteTargetType = '${sd}'`),Promise.reject(null);0===id&&(id=sd);const Fd=this.$.Eh.Oi("UserAction","ClearCopyState"),S=Fd.id;E.ULS.sendTraceTag(537167820,0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${Ca}', isExplicit = '${qb}', isForce = '${nc}', Current CCP operation copyPasteTargetType = '${Rc}', LastCopyPasteTargetType = '${sd}'`);
this.nA.ISd();this.pfk();return this.ZXa.onCancelCopy(Ca).then(()=>{Ca&&eb.a.v1a&&(this.Ipb=!1);Fd.stop();this.I9f(C,S,!0,qb,Ca,"","",Fd.Ci,id);return Promise.resolve(!0)},Ua=>{var Hb=Ua?this.getStringifiedError(Ua):"null";E.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${Hb}`);Fd.stop();Hb=Gf.bVh+Gf.ZIa;let Ec=Gf.Xib;Ua&&(Hb+=Gf.nKa(Ua),Ua.message&&(Ec=Ua.message));this.I9f(C,S,!1,qb,Ca,Ec,Hb,Fd.Ci,id);return Promise.reject(Ua)})}catch(id){return Promise.reject(null)}}oxd(C,
Ca,qb,nc){var Rc=void 0;Rc=void 0===Rc?!1:Rc;qb=void 0===qb?!1:qb;nc=void 0===nc?0:nc;return qb||this.BIa()?this.Sx(C,Ca,Rc,qb,nc):(E.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}wOa(C,Ca,qb){E.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${Ca}`);
const nc=new df.a;nc.ga("reason",Ca);Qe.a(ne.a.discontinuousSelectionBlocking,[qb?Ce.a.Q6j:Ce.a.v4h],!0,!0,!1,!1,nc);C=he.a.nj(1,1,751,C,0,371863010,"DiscontinuousSelectionBlocking");new Eb.a(this.$,C)}wwj(){const C=P(this.wN);return C&&C.sourceItem&&Object.getType(C.sourceItem)!==ud?Object.getType(C.sourceItem)===Vb?2:1:0}nji(C,Ca,qb,nc,Rc){Rc=void 0===Rc?!1:Rc;C.stopwatch=this.$.Eh.Oi("UserAction","DragDropReplaceClientSide");C.isDragDrop=!0;this.oxd("DragDropReplace/before/"+vh.a[C.ribbonCommandInfo.method],
!1,void 0,C.copyPasteTargetType).catch(()=>{});const id=Rc?2:1;let sd=0;sd=Rc?4:nc?256:128;const Fd={encounteredDeploymentErrors:!1};Fd.commandParameters=C;C.isDragInsert=!1;C.userHash=this.userHash;C.id=Zb.a.create().toString();return this.nA.pasteRange(C.ribbonCommandInfo,Qa.s(Ca,this.$),Qa.s(qb,this.$),id,sd,[C.stopwatch],Fd,!1,()=>{E.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${C.copyPasteTargetType}"`);this.P9f(C,id,Ca,qb,Fd)},
S=>this.xkg(S,C,id,Ca,qb,Fd)).then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},S=>Promise.reject(S))}mji(C,Ca,qb,nc,Rc){Rc=void 0===Rc?!1:Rc;C.stopwatch=this.$.Eh.Oi("UserAction","DragDropInsertClientSide");this.oxd("DragDropInsert/before/"+vh.a[C.ribbonCommandInfo.method],!1,void 0,C.copyPasteTargetType).catch(()=>{});const id=Rc?2:1,sd=Qa.R(this.Sqc([qb],id));var Fd=this.$.fa.la.sheetName;const S=this.$.fa.la.sheetName,Ua=Qa.x(Ca,this.$);Ua.SheetName=Fd;Fd=Qa.x(sd,this.$);Fd.SheetName=
S;nc=sd.isRow||Ca.isRow||nc?1:0;const Hb={encounteredDeploymentErrors:!1};C.isDragInsert=!0;Hb.commandParameters=C;C.userHash=this.userHash;C.id=Zb.a.create().toString();Rc=this.nA.qji(Hb,Ua,Fd,Rc,nc,C.ribbonCommandInfo,()=>{E.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${C.copyPasteTargetType}"`);this.P9f(C,id,Ca,qb,Hb)},Ec=>{this.xkg(Ec,C,id,Ca,qb,Hb)});return Tc.d(Rc.then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},
Ec=>Promise.reject(Ec))).nB(()=>!0)}QUd(C,Ca,qb,nc,Rc,id){var sd=P(this.wN);if(!sd)return E.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),Xa.Task.Ua(!1);if(!mb(sd.sourceItem))return E.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),Xa.Task.Ua(!1);var Fd=sd.sourceItem;if(!Fd)return E.ULS.shipAssertTag(537167810,0,!!Fd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),Xa.Task.Ua(!1);if(1<Fd.ranges.length)return E.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.wOa(2192,"InsertCopiedCutCells",!0),Xa.Task.Ua(!1);sd=Qa.R(Fd.ranges);var S=this.da.ha.pa.oj.clone();C=Qa.R(this.Sqc([S],C));const Ua=this.b7f();Fd=Fd.sheetName;S=this.$.fa.la.sheetName;const Hb=Qa.x(sd,this.$);Hb.SheetName=Fd;const Ec=Qa.x(C,this.$);Ec.SheetName=S;Fd=this.da.ha.pa.activeRange;const cd=()=>{E.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},Bd=()=>{E.ULS.sendTraceTag(508929746,
0,50,"InsertCopiedCutCellsCrossSession Failed")};return(C.hk||sd.hk||this.nA.DOk(this.$,sd,Fd)?Xa.Task.Ua(0):C.isRow||sd.isRow||this.nA.EOk(this.$,sd,Fd)?Xa.Task.Ua(1):this.Afj.Ltc(this.$,ha.f(this.$).rtl)).nB(ce=>this.BIa()?this.nA.executeInsertCopiedCutCellsOperation(Hb,Ec,Ua,ce.result,Ca,null,null):this.nA.executeInsertCopiedCutCellsAcrossSession(Hb,Ec,Ua,ce.result,Ca,cd,Bd,qb,nc,Rc,id)).continueWith(()=>{this.Sx("InsertCopiedCutCells/success/"+vh.a[Ca.method],!0)})}EXb(){const C=P(this.wN),Ca=
this.da.ha.pa.Yn;return!!C&&mb(C.sourceItem)&&Ca&&1===C.sourceItem.ranges.length}b7f(){return this.c7f(-911352779)}Hpb(){var C,Ca;const qb=P(this.wN);return qb?(null===(C=qb.asyncClipboardItemsKeys)||void 0===C?void 0:C.includes(Nc.a.shadowWorkbook))||(null===(Ca=qb.syncClipboardItemsKeys)||void 0===Ca?void 0:Ca.includes(Nc.a.shadowWorkbook))||3!==qb.copyStatus:!1}JLc(){return this.c7f(-1985798686)}crc(C,Ca){var qb=new kd.a(this.$.sa),nc=36===C;const Rc=qb.Sj(4);C=2===this.CMa()&&qb.Sj(1);nc=nc&&
Rc;qb=!qb.Bn||!this.JLc()||!kd.a.ywc(Ca,ha.f(this.$));return nc||C||this.$.wy(Ca,!0)&&qb}Nob(C,Ca){return this.nA.Nob(C,Ca)}dispose(){super.dispose();this.xo();this.wN.removeMetadataChangeListener(Gf.Zdg)}EDd(C,Ca,qb,nc,Rc){if(!this.dZh(C.commandParameters.ribbonCommandInfo.command))return C.cseStatus=2,!1;if(nc.width%Ca.width||nc.height%Ca.height)return C.cseStatus=16,!1;if(nc.hk||nc.isRow)return C.cseStatus=31,!1;const id=nc.Fk(this.da.Wp);if(!id)return C.cseStatus=7,!1;var sd=this.lbf(this.da,
C.commandParameters.ribbonCommandInfo.command,Ca);if(0!==sd)return C.cseStatus=sd,!1;sd=this.lbf(this.da,C.commandParameters.ribbonCommandInfo.command,id);if(0!==sd)return C.cseStatus=sd,!1;sd=Qa.x(Ca,this.$);sd.SheetName=qb;qb=this.xk.V6j(this.da,sd,Qa.x(id,this.$),C.commandParameters.ribbonCommandInfo.command,C.commandParameters.stopwatch);1===qb&&(Rc&&(Ca.$i(nc)?(nc=Qa.fb(Ca,C.commandParameters.expandDestinations[0]),this.xk.gxd(nc,!1,C.commandParameters.id),this.xk.gxd(nc,!0,C.commandParameters.id)):
(this.xk.asc(Ca,!1),this.xk.asc(Ca,!0))),Ca=new da(C.commandParameters.ribbonCommandInfo.command,id,Ca),ha.f(this.$).Gge(Ca),this.pasteIndicationManager.I0a(C.commandParameters.id,!0),this.Pwb(C.commandParameters.expandDestinations,C.commandParameters.isPasteCommandFromRecoveryUI),this.dsc("DoPasteClientEstimation/"+vh.a[C.commandParameters.ribbonCommandInfo.method],C));C.cseStatus=qb;return 1===qb}lbf(C,Ca,qb){C=new hb.a("CopyPasteInfrastructure.blockCseForPaste",C,qb);try{for(;C.moveNext();){const nc=
C.get_current().cell;if(nc.fG)return 8;if(237279923===Ca||1804571062===Ca){if(!ta.EwaSettings.nMa()&&nc.sF)return 18;if(nc.jS)return 19}}}catch(nc){Qh.a.lo(nc,"CopyPasteInfrastructure.BlockCseForPasteRange: exception thrown before CSE")}finally{C&&C.dispose()}return 0}dxg(){qi(this.$)?(new bh(this.$)).showDialog(!0,!1,!1,this.dCj):(Sa.a.$v||Sa.a.kJc||Sa.a.UYf?new dg(this.$):new Te(this.$)).showDialog(!0,!1,!1,this.dDj)}JCj(C,Ca,qb,nc){C=Zg(C,Ca,qb,nc,this.$.ua.UserSessionId);C.k=!0;fb.b().Ol(45,C,
!0)}ZZj(C,Ca,qb,nc,Rc){var id=!1,sd=!1,Fd=Gf.Xib,S=Gf.Hsf+Gf.ZIa;C&&(S+=Gf.nKa(C),he.a.Qx(C.ewaErrors)?(Fd=this.BBc(C.ewaErrors),he.a.oo(C.ewaErrors,[-103190598,1512686094])&&(id=!0)):C.message&&(Fd=C.message));sd||(sd=this.qXd(C));Ca=Zg(Ca,qb,nc,Rc,this.$.ua.UserSessionId);Ca.k=!1;Ca.l=sd;Ca.n=Fd;Ca.p=S;Ca.q=id;fb.b().Ol(45,Ca,!0);return Promise.reject(C)}Wsd(C,Ca,qb,nc){let Rc;if(!this.rUf)return C.cseStatus=40,Of.a.Ua(!1);const id=this.Jlj(C.commandParameters.ribbonCommandInfo.command,qb,this.da);
if(0!==id)return C.cseStatus=id,Of.a.Ua(!1);Bb.TaskExtensions.ts(Of.a.delay(0),()=>{Rc=this.rUf.m6j(Ca,nc).result;return Of.a.Ua(!0)},nc.token).continueWith(()=>{E.ULS.sendTraceTag(507582610,0,50,`CopyPasteInfrastructure.AttemptExternalHtmlPasteClientEstimation: pasteId=${C.id}, result=${JSON.stringify(null===Rc||void 0===Rc?void 0:Rc.gQ)}`);if(1!==(null===Rc||void 0===Rc?void 0:Rc.cseStatus))return C.cseStatus=Rc?Rc.cseStatus:46,Of.a.Ua(!1);if(nc.token.gN)return C.cseStatus=39,Of.a.Ua(!1);var sd=
qb.topLeft?this.Z7h(qb.topLeft,Rc.Q0a):qb;C.commandParameters.expandDestinations=[sd];if(!ha.h(this.da,sd))return C.cseStatus=7,Of.a.Ua(!1);C.cseStatus=this.xk.S6j(this.da,Rc.Q0a,qb.topLeft,nc,C.commandParameters.stopwatch);return 1===C.cseStatus?(sd=new da(C.commandParameters.ribbonCommandInfo.command,qb,null),ha.f(this.$).tk.HT(C.commandParameters.stopwatch.id,Lh.BasicTelemetryCalculator.nS),ha.f(this.$).Gge(sd),this.pasteIndicationManager.I0a(C.commandParameters.id,!0),this.Pwb(C.commandParameters.expandDestinations,
C.commandParameters.isPasteCommandFromRecoveryUI),this.dsc("AttemptExternalHtmlPasteClientEstimation/"+vh.a[C.commandParameters.ribbonCommandInfo.method],C),Of.a.Ua(!0)):Of.a.Ua(!1)});return Of.a.Ua(!1)}VLh(C,Ca,qb){C.cseStatus=0;C.cseStatus=this.Llj(C.commandParameters.ribbonCommandInfo.command,qb,this.da,Ca);if(0!==C.cseStatus)return!1;C.cseStatus=this.xk.W6j(this.da,Ca,qb,C.commandParameters.stopwatch);Ca=new da(C.commandParameters.ribbonCommandInfo.command,qb,null);1===C.cseStatus&&(ha.f(this.$).Gge(Ca),
this.pasteIndicationManager.I0a(C.commandParameters.id,!0),this.Pwb(C.commandParameters.expandDestinations,C.commandParameters.isPasteCommandFromRecoveryUI),this.dsc("AttemptExternalPlainTextPasteClientEstimation/"+vh.a[C.commandParameters.ribbonCommandInfo.method],C));return 1===C.cseStatus}Jlj(C,Ca,qb){return 237279923!==C?2:qb.oh.dpb(Ca)?8:qb.oh.NY(Ca)?11:this.xk.Jwc(Ca)?12:0}Z7h(C,Ca){return new Jc.Range(C.top,C.left,C.top+Math.max(...Ca.map(qb=>qb.rowIndex)),C.left+Math.max(...Ca.map(qb=>qb.colIndex)),
!0,!0)}Llj(C,Ca,qb,nc){if(-875588320!==C&&-185374993!==C&&237279923!==C)return 2;if(qb.oh.dpb(Ca))return 8;if(!ta.EwaSettings.nMa()&&qb.oh.Zuj(Ca))return 18;if(qb.oh.NY(Ca))return 11;if(this.xk.Jwc(Ca))return 12;C=this.hTh(Ca,nc);return ha.h(this.da,C)?0:7}hTh(C,Ca){var qb=Ca.indexOf("\r");qb=-1!==qb?"\n"===Ca[qb+1]?Ca.split("\r\n"):Ca.split("\r"):Ca.split("\n");Ca=qb.length;qb=qb[0].split("\t").length;return new Jc.Range(C.top,C.left,C.top+Ca-1,C.left+qb-1,!0,!0)}dZh(C){switch(C){case 237279923:case 808159687:case -185374993:case 1804571062:case -875588320:return!0;
case 264209770:return ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PasteWithColumnWidthCSEEnabled",!1);default:return!1}}c7f(C){const Ca=P(this.wN);return Ca?Ca.commandParameters.ribbonCommandInfo.command===C:!1}FMk(C){return C&&C.lastCopy?Vd(C.lastCopy,this.$):!0}nHf(C,Ca,qb,nc,Rc){const id={};id.a=this.$.ua.UserSessionId;id.e=C.stopwatch.id;id.c=fb.b().kp(C.ribbonCommandInfo.command);id.b=vh.a[C.ribbonCommandInfo.method];id.d=C.id;id.f=qb.toString();id.g=nc.toString();id.h=Ca.toString();
id.o=C.stopwatch.Ci;id.q=!1;id.r=C.copyPasteTargetType.toString();id.s=Rc.encounteredDeploymentErrors;id.i=Rc.commandParameters.dragDropIsShiftKeyDown;id.j=Rc.commandParameters.isDragInsert;ta.EwaSettings.QC()&&(id.t=Rc.commandParameters.isHeaderDrag);return id}P9f(C,Ca,qb,nc,Rc){C=this.nHf(C,Ca,qb,nc,Rc);C.k=!0;fb.b().Ol(45,C,!0)}YAj(C,Ca,qb,nc,Rc,id,sd,Fd,S){C=this.nHf(C,Ca,qb,nc,S);C.k=!1;C.l=Rc;C.n=id;C.p=sd;C.q=Fd;fb.b().Ol(45,C,!0)}I9f(C,Ca,qb,nc,Rc,id,sd,Fd,S){const Ua={};Ua.a=this.$.ua.UserSessionId;
Ua.b=Ca;Ua.c=C;Ua.f=qb;Ua.e=nc;Ua.d=Rc;Ua.g=id;Ua.h=sd;Ua.i=Fd;Ua.j=S.toString();fb.b().Ol(46,Ua,!0)}QAj(C,Ca){C=this.IGf(C.commandParameters,C);C.l=!0;C.j=Ca;fb.b().Ol(43,C,!0)}J9f(C,Ca,qb,nc,Rc,id,sd){C=this.IGf(C,sd);C.l=!1;C.m=Ca;C.o=qb;C.y=nc;C.x=Rc;C.z=id;fb.b().Ol(43,C,!0);E.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${C.y},ErrorReason=${C.x},IsExpectedError=${C.m},IsSucceededWithAlert=${C.z},ErrorMessage=${C.o}`)}IGf(C,Ca){const qb={};qb.a=this.$.ua.UserSessionId;
qb.f=C.stopwatch.id;qb.g=C.id;qb.c=fb.b().kp(C.ribbonCommandInfo.command);qb.b=vh.a[C.ribbonCommandInfo.method];qb.q=C.stopwatch.Ci;qb.bd=Gf.JAc();qb.bg=C.copyPasteHandlerName;qb.bj=void 0===C.ribbonCommandInfo.jk||null===C.ribbonCommandInfo.jk?null:bg.a[C.ribbonCommandInfo.jk];qb.bq=C.uploadToClipService;qb.br=C.floatingObjectType;qb.s=C.copyPasteTargetType.toString();qb.bc=ie(C.copyPasteTargetType);qb.z=!1;if(Ca){qb.bk=Ca.id;qb.bl=Ca.serverRequestTimeInMs;Ca.requestTelemetryData&&(qb.bm=Ca.requestTelemetryData.EcsOperationDuration,
qb.bn=Ca.requestTelemetryData.EcsRequestDuration,qb.bo=Ca.requestTelemetryData.WfeRequestDuration);qb.d=Ca.sourceItem?Ca.sourceItem.toString():null;qb.e=-1;if(mb(Ca.sourceItem)){qb.e=0;C=Ca.sourceItem.ranges;for(const nc of C)qb.e+=nc.zz}qb.h=Ca.isAsyncCopy;qb.i=Ca.isFromCache;qb.k=Ca.isSelectionAllowed;qb.r=Ca.plainTextPayloadSize;qb.u=Ca.htmlPayloadSize;qb.v=Ca.htmlSizeExceedsLimit;qb.w=Ca.copyTotalSizeExceedsLimit;qb.t=Ca.shadowWorkbookPayloadSize;qb.p=Ca.clientSideCopyTime;qb.ba=Ca.encounteredDeploymentErrors;
qb.bb=Ca.shadowWorkbookSizeExceedsLimit;qb.be=Ca.syncClipboardItemsKeys;qb.bf=Ca.asyncClipboardItemsKeys;qb.bh=this.Ckf(Ca.succeededPopulatingSystemClipboardSync);qb.bi=this.Ckf(Ca.succeededPopulatingSystemClipboardAsync);qi(this.$)&&(qb.bs=Ca.commandParameters.isAsyncClipboardAPI)}return qb}Pwb(C,Ca){Ca=void 0===Ca?!1:Ca;if(!this.da.isEditing&&!this.da.kq){var qb=this.da.ha.pa,nc=!Ca&&1===C.length&&Qa.X(C,qb.selectedRanges),Rc=nc?qb.activeCell:C[0].topLeft;C[0].contains(Rc)||(E.ULS.shipAssertTag(537167775,
0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${qb.selectedRanges}, IndexOfActiveRange ${qb.Ly}, ActiveCell ${qb.activeCell}, calculatedDestinationRanges ${C}, keepThePreviousActiveCell ${nc}, newActiveCell ${Rc}, isPasteCommandFromRecoveryUI ${Ca}`),Rc=C[0].topLeft);this.da.ha.zL(C,0,Rc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}iLf(C,Ca){const qb={};qb.a=this.$.ua.UserSessionId;qb.g=C.stopwatch.id;qb.t=C.stopwatch.Ci;qb.bz=!1;Ca&&(qb.bv=Ca.id,qb.bw=Ca.serverRequestTimeInMs,
qb.n=Ca.commandParameters.clipboardFormatReadTimes,qb.o=Ca.commandParameters.clipboardFormatReadStatus,qb.q=Ca.commandParameters.asyncApiReadTimedOut,Ca.requestTelemetryData&&(qb.cb=Ca.requestTelemetryData.EcsOperationDuration,qb.cc=Ca.requestTelemetryData.EcsRequestDuration,qb.cd=Ca.requestTelemetryData.WfeRequestDuration));qb.x=C.copyPasteTargetType.toString();qb.bl=ie(C.copyPasteTargetType);qb.br=C.copyPasteHandlerName;qb.i=(null===Ca||void 0===Ca?0:Ca.isHtmlPaste)?Qa.j(Qa.h(Ca.pastedRange.Ranges),
",",this.$,!1):Qa.j(C.expandDestinations,",",this.$,!1);qb.h=Qa.j(C.originalDestinations,",",this.$,!1);qb.e=C.id;qb.d=C.commandType;qb.c=fb.b().kp(C.ribbonCommandInfo.command);qb.b=vh.a[C.ribbonCommandInfo.method];qb.bf=!1;qb.bg=!1;qb.bp=Gf.JAc();qb.bt=void 0===C.ribbonCommandInfo.jk||null===C.ribbonCommandInfo.jk?null:bg.a[C.ribbonCommandInfo.jk];qb.cj=C.isPasteCommandFromEnterShortcut;if(qb.ca=C.isPasteCommandFromRecoveryUI)qb.cf=C.pasteRecoveryUndoStopwatch.id,qb.cg=C.pasteRecoveryUndoStopwatch.Ci;
if(Ca){if((C=Ca.copyContextSnapshot)&&!Ca.wasLastCopyExternal){qb.f=C.commandParameters.id;qb.j=C.sourceItem.toString();qb.k=-1;if(mb(C.sourceItem)){qb.k=0;const nc=C.sourceItem.ranges;for(const Rc of nc)qb.k+=Rc.zz}qb.bg=1===C.commandParameters.commandType}else Ca.clipboardItems?qb.f=Ca.clipboardItems.getItem(Nc.a.Btc):E.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");qb.bz=Ca.pasteRecoveryUIDisplayed;qb.ci=Ca.cseStatus}else E.ULS.sendTraceTag(537167773,
0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return qb}mCj(C,Ca,qb,nc,Rc,id,sd,Fd,S){var Ua,Hb;C=this.iLf(C,Fd);C.l=!1;C.m=Ca;C.s=qb;C.bc=nc;C.be=Rc;C.bd=id;C.bf=sd;if(Fd){C.y=zd(Fd)||!Fd.copyContextSnapshot;C.bi=!C.y&&Vd(Fd.copyContextSnapshot,this.$);C.bj=Fd.shadowWorkbookSizeExceedsLimit;C.v=Fd.shadowWorkbookPayloadSize;C.w=Fd.htmlPayloadSize;C.bq=vd(Fd.clipboardItems);C.bb=Fd.activeSelectionType;C.bs=Fd.isSameSession;C.bn=Fd.payloadOrigin;C.bo=Fd.payloadType;C.bu=Fd.externalAppSource;
C.bx=Fd.indicationDisplayScheduled;C.by=Fd.pasteIndicationDisplayStatus;C.ck=Fd.pasteDestinationHasMergedCells;if(ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))C.cl=Fd.ArtSourceItemType;qi(this.$)&&(C.cm=null===(Ua=Fd.commandParameters)||void 0===Ua?void 0:Ua.isAsyncClipboardAPI);ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&
(C.cn=null===(Hb=Fd.commandParameters)||void 0===Hb?void 0:Hb.isChromiumExtension)}else C.bi=Vd(S,this.$);fb.b().Ol(44,C,!0);E.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${C.be},ErrorReason=${C.bd},IsExpectedError=${C.m},IsSucceededWithAlert=${C.bf},ErrorMessage=${C.s}`)}oCj(C){var Ca,qb;const nc=this.iLf(C.commandParameters,C);nc.y=C.wasLastCopyExternal;nc.l=!0;nc.u=C.plainTextPayloadSize;nc.v=C.shadowWorkbookPayloadSize;nc.w=C.htmlPayloadSize;nc.z=
C.isClipboardDataContainShadowWorkbook;nc.ba=C.isShadowWorkbookParsedSuccessfully;nc.bb=C.activeSelectionType;nc.bc=C.pasteResult;nc.bh=C.encounteredDeploymentErrors;nc.bj=C.shadowWorkbookSizeExceedsLimit;nc.bk=Ud(C);nc.bq=vd(C.clipboardItems);nc.bs=C.isSameSession;nc.bn=C.payloadOrigin;nc.bo=C.payloadType;nc.bu=C.externalAppSource;nc.bx=C.indicationDisplayScheduled;nc.by=C.pasteIndicationDisplayStatus;nc.ck=C.pasteDestinationHasMergedCells;nc.bm=C.clipboardItems?C.clipboardItems.getItem(Nc.a.QXh):
null;nc.bi=!C.isSameSession&&!C.wasLastCopyExternal;nc.ci=C.cseStatus;if(ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))nc.cl=C.ArtSourceItemType;qi(this.$)&&(nc.cm=null===(Ca=C.commandParameters)||void 0===Ca?void 0:Ca.isAsyncClipboardAPI);ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(nc.cn=null===(qb=C.commandParameters)||
void 0===qb?void 0:qb.isChromiumExtension);fb.b().Ol(44,nc,!0)}Kp(){this.$.sa.vn(this.Bq);this.$.sa.ZDh(this.fQc);this.$.userOperationManager.qw(this.m2);this.$.nr(this.Dj);ha.f(this.$).Dh.Mv(this.K7);ha.f(this.$).Dh.zX(this.pZ)}xo(){this.$&&this.$.sa&&(this.$.sa.Nn(this.Bq),this.$.sa.Zok(this.fQc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.vu(this.m2);this.da&&this.da.Dh&&(this.da.Dh.Cv(this.K7),this.da.Dh.J2(this.pZ))}w2b(C,Ca){var qb=null;let nc=!1;var Rc=null;let id="UnknownFailure",
sd=-1,Fd=Gf.Xib,S=Gf.pasteErrorName+Gf.ZIa,Ua=!1;this.pasteIndicationManager.I0a(C.id,!1);this.pasteDestinationHasMergedCells(C.expandDestinations)&&(Ca.pasteContext.pasteDestinationHasMergedCells=!0);const Hb=P(this.wN);(C.clearStateOnFinish||C.clearSystemClipboard)&&this.Sx("Paste/fail/"+vh.a[C.ribbonCommandInfo.method],!0,void 0,void 0,C.copyPasteTargetType).catch(()=>{});if(Ca){sd=Ca.reason;S+=Gf.nKa(Ca);Ca.message&&(Fd=Ca.message);if(qb=Gf.H3h(Ca))if(1===qb.pasteErrorName)nc=!0,id="CopyPasteLengthTooLongPopup",
Fd=Rc="The pasted content is too long. Popup a dialog to the user.",E.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rc}, copyPasteTargetType="${C.copyPasteTargetType}"`),qb=he.a.nj(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),new Eb.a(this.$,qb);else if(7===qb.pasteErrorName)nc=!0,id="No-Op",Fd=Rc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",E.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rc}, copyPasteTargetType="${C.copyPasteTargetType}"`);
else if(8===qb.pasteErrorName)nc=!0,id="UseShortcutsPopup",Fd=Rc="Unable to paste content from the system clipboard. Popup dialog to the user.",E.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rc}, copyPasteTargetType="${C.copyPasteTargetType}"`),this.dxg();else if(18===qb.pasteErrorName){nc=!0;id="PasteExternalNotSupportMultipleSelectionPopup";Fd="Paste external not support multiple selection.";Rc="Unknown";var Ec=2192;100!==qb.validationFailureReason&&(Rc=Sd[qb.validationFailureReason],
Ec=Gf.skf(qb.validationFailureReason));this.wOa(Ec,Rc,!0)}else 20===qb.pasteErrorName||19===qb.pasteErrorName?(nc=!0,20===qb.pasteErrorName?(id="PasteAcrossSessionNotSupportMultipleSelectionPopup",Fd="Paste across session does not support multiple selection."):(id="PasteInSameSessionNotSupportMultipleSelectionPopup",Fd="This kind of multiple selection is not supported for same session paste."),Rc="Unknown",Ec=2192,100!==qb.validationFailureReason&&(Rc=Sd[qb.validationFailureReason],Ec=Gf.skf(qb.validationFailureReason)),
qb=6===qb.validationFailureReason,this.crc(C.commandType,C.expandDestinations)&&qb&&this.Pwb(C.expandDestinations),this.wOa(Ec,Rc,!0)):6===qb.pasteErrorName?(nc=!0,id="No-Op",Fd=Rc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",E.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rc}, copyPasteTargetType="${C.copyPasteTargetType}"`)):17===qb.pasteErrorName?(nc=!0,id="No-Op",Fd=Rc="Paste text on Art is not yet a supported operation",
E.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rc}, copyPasteTargetType="${C.copyPasteTargetType}"`)):16===qb.pasteErrorName?(nc=!0,id="No-Op",Fd=Rc="Paste has failed because the previous copy has failed",qb=this.getStringifiedError(qb),E.ULS.sendTraceTag(537167771,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Rc}, copyPasteTargetType="${C.copyPasteTargetType}", error=${qb}`)):he.a.Qx(qb.ewaErrors)?(he.a.efa(qb.ewaErrors)||he.a.oo(qb.ewaErrors,he.a.JDc())?(nc=!0,id="CommunicationError",
Rc=he.a.fi(qb.ewaErrors),E.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Fd} copyPasteTargetType="${C.copyPasteTargetType}"`)):he.a.oo(qb.ewaErrors,Gf.Myk)?(nc=!0,id="SavingWorkbookError",Rc=he.a.fi(qb.ewaErrors),E.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Fd} copyPasteTargetType="${C.copyPasteTargetType}"`)):he.a.oo(qb.ewaErrors,Gf.operationSucceededWithAlert)&&(Ua=nc=!0,id="OperationSucceededWithAlert",Rc=he.a.fi(qb.ewaErrors),E.ULS.sendTraceTag(36304161,
0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Fd} copyPasteTargetType="${C.copyPasteTargetType}"`)),nc||(Fd=this.BBc(qb.ewaErrors),nc=this.qXd(Ca))):11===qb.pasteErrorName&&(nc=!0,id="No-Op",Fd="Paste has failed because user try copy cross-session oart object");15===Ca.reason&&(nc=!0,id="No-Op",Fd="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");Ma.a.equals(S,yc.kdl,!1)&&(nc=!0,id="No-Op",Fd="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}nc||
(qb=Ca?this.getStringifiedError(Ca):"null",E.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${qb}, copyPasteTargetType="${C.copyPasteTargetType}"`));this.mCj(C,nc,Fd,id,S,sd,Ua,Ca.pasteContext,Hb);return Promise.reject(Ca)}HQc(C,Ca){var qb;E.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${Ca.copyPasteTargetType}"`);this.pasteIndicationManager.I0a(Ca.id,!0);if(this.a7j(Ca.copyPasteTargetType,C)){eb.a.v1a&&C.wasLastCopyExternal&&
C.payloadType===bc.shadowWorkbook&&(this.Ipb=!0);let nc=null;(null===(qb=C.pastedRange)||void 0===qb?0:qb.Ranges)&&0<C.pastedRange.Ranges.length?nc=Qa.h(C.pastedRange.Ranges):C.wasLastCopyExternal||(nc=Ca.expandDestinations);this.VAk(C,nc);if(this.cPk(C,nc)){qb=Qa.d(Ca.originalDestinations);const Rc=1028===Ca.commandType?Qa.d(Ca.expandDestinations):Qa.d(nc);let id=null;C.wasLastCopyExternal&&(Ca.isKeyboardEvent||Ca.isPasteCommandFromRecoveryUI)&&(id={[Gf.Fvg]:C.clipboardItems});this.pasteDestinationHasMergedCells(Ca.expandDestinations)&&
(C.pasteDestinationHasMergedCells=!0);C.pasteRecoveryUIDisplayed=!0;const sd=new Da(this.$,qb,Rc,id,this.zoom),Fd=Object(Tc.d)(ka.a.resolve(oa.of,{va:0}));264209770===Ca.ribbonCommandInfo.command?this.da.za.QNa(()=>{Bb.TaskExtensions.$e(Fd,()=>{const S=Fd.result;S.Ptd(sd);S.Gue(Ca.ribbonCommandInfo.method)},this.ya,8)}):Bb.TaskExtensions.$e(Fd,()=>{const S=Fd.result;S.Ptd(sd);S.Gue(Ca.ribbonCommandInfo.method,Ca.event)},this.ya,8)}this.LRj(C,nc)}this.dsc("Paste/success/"+vh.a[Ca.ribbonCommandInfo.method],
C);this.oCj(C);this.RUg&&(!Ca.isKeyboardEvent||Ud(C))&&this.$.fa.Dn.get(66)&&(E.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.RUg=!1,this.w5h());C=new tg(Ca.expandDestinations,C.commandParameters.ribbonCommandInfo.command);this.Vek(C);return Promise.resolve(!0)}LRj(C,Ca){oa.Ag.Ma()?void ka.a.resolve(oa.Ag,{va:1}).then(qb=>{qb.t3g(C,Ca)}):Bb.TaskExtensions.$e(Pa.GetServiceTaskFactory.dk(this.$.qa,534,535,1),qb=>{qb.result.t3g(C,
Ca)},this.$.ya,3)}cPk(C,Ca){return!Ca||1!==Ca.length||C.commandParameters.clearSystemClipboard||C.commandParameters.clearStateOnFinish||C.commandParameters.skipClipboardAccess?!1:zd(C)&&(Ca=C.clipboardItems.getItem(Nc.a.plainText),C=C.clipboardItems.getItem(Nc.a.html),void 0===Ca||null===Ca||Ca.length>this.JGj||void 0===C||null===C||C.length>this.l0b)?(E.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}a7j(C,
Ca){return 1===C||Ca.payloadType===bc.plainText||Ca.payloadType===bc.html||eb.a.v1a&&Ca.payloadType===bc.shadowWorkbook}pasteDestinationHasMergedCells(C){const Ca=ha.f(this.$).za.uA();if(!Ca||!Ca.length)return!1;for(const qb of Ca)if(qb.wB(C[0]))return!0;return!1}dsc(C,Ca){let qb;(()=>{let nc=this.sjj(Ca);({sXa:qb}=nc);return nc})().returnValue&&this.Sx(C,qb,void 0,void 0,Ca.commandParameters.copyPasteTargetType).catch(()=>{})}xkg(C,Ca,qb,nc,Rc,id){const sd=C?this.getStringifiedError(C):"null";let Fd=
!1,S=!1,Ua=!1,Hb=Gf.Xib,Ec=Gf.Hsf+Gf.ZIa;C&&(Ec+=Gf.nKa(C),he.a.Qx(C.ewaErrors)?(Hb=this.BBc(C.ewaErrors),he.a.oo(C.ewaErrors,Gf.operationSucceededWithAlert)&&(Fd=!0),he.a.oo(C.ewaErrors,Gf.dragDropNonEmptyRange)&&(S=Ua=!0)):C.message&&(Hb=C.message));Ua||(Ua=this.qXd(C));S?this.da.ha.selectionType=-1:this.nA.xik(Rc);Ua||E.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${sd}, copyPasteTargetType="${Ca.copyPasteTargetType}`);this.YAj(Ca,qb,nc,Rc,Ua,Hb,Ec,Fd,id)}Sqc(C,
Ca){let qb=C;const nc=this.dQi();if(null===nc||void 0===nc?0:nc.ranges)qb=this.nA.FTh(Ca,nc.ranges,C);return qb}dQi(){const C=P(this.wN);return C&&mb(C.sourceItem)?C.sourceItem:null}pfk(){this.raiseEvent(Gf.Gbe,null)}Vek(C){Object(Gg.d)(()=>{this.raiseEvent(Gf.T6c,C)})}VAk(C,Ca){const qb=C.commandParameters.originalDestinations;Ca&&(Qa.X(this.da.ha.pa.selectedRanges,qb)?(this.Pwb(Ca),C=wd.HelperMethods.$Jb(Ca),E.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${C}`)):
C.commandParameters.isPasteCommandFromRecoveryUI?(this.Pwb(Ca,!0),E.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${Ca}, active cell: ${Ca[0].topLeft}`)):(C=wd.HelperMethods.$Jb(qb),E.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${C}`)))}sjj(C){if(C.isPlainTextPaste||
C.isHtmlPaste||fe(C)||C.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,sXa:!1};var Ca=C.copyContextSnapshot;if(C.commandParameters.clearStateOnFinish)return{returnValue:!0,sXa:!0};if(Ca&&mb(Ca.sourceItem)){var qb=Ca.sourceItem;if(!qb.isFromCurrentSession(this.$))return{returnValue:!1,sXa:!0};Ca=-1985798686===Ca.commandParameters.ribbonCommandInfo.command;if(!(1<qb.ranges.length||1<C.commandParameters.expandDestinations.length)){const nc=Qa.R(qb.ranges),Rc=Qa.R(C.commandParameters.expandDestinations),
id=this.$.fa.la.sheetName;qb=qb.sheetName;if(qb===id&&Rc.equals(nc))return{returnValue:!1,sXa:!0};if(qb===id&&Rc.Fk(nc))return{returnValue:!(this.b3a&&C.commandParameters.isFormatPainter),sXa:!1}}return{returnValue:Ca,sXa:!0}}return{returnValue:!1,sXa:!0}}i1j(){P(this.wN)&&this.Sx("OnStartEdit",!1).catch(()=>{})}PSj(){P(this.wN)&&this.Sx("OnEndEdit",!0).catch(()=>{})}BBc(C){C=he.a.fMi(C,Gf.ZIa);return this.EHj+La.a.uE(C).toString()}qXd(C){C=Gf.nKa(C);return!!C&&Ma.a.IPb(C,Gf.DHj)}w5h(){const C=he.a.nj(1,
2,327,328,Sa.a.$v?329:Sa.a.IP?330:331,530046625,"ActivateLocalStorage"),Ca=Object(Tc.d)(ka.a.resolve(oa.E,{va:0}));Bb.TaskExtensions.$e(Ca,()=>{Ca.result.Rm(43,C)},this.ya,3)}Ckf(C){return void 0===C||null===C?gd.TLj:C?gd.success:gd.failed}static H3h(C){const Ca=C.innerError;return Ca&&0!==Ca.pasteErrorName?C.innerError:null}static q3h(C){const Ca=C.innerError;return Ca&&0!==Ca.copyErrorName?C.innerError:null}static nKa(C){let Ca="";if(!C)return Gf.gpf;C.errorName&&(Ca=C.errorName,C.innerError&&(Ca+=
Gf.ZIa+Gf.nKa(C.innerError)));Ca||(Ca=C&&C.name?C.name:Gf.gpf);return Ca}static JAc(){Gf.Ra||(Gf.Ra=Pc.GUk);return Gf.Ra}static skf(C){switch(C){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return E.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${C}`),2199}}static r3h(C){switch(C){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;
default:return E.ULS.shipAssertTag(537167763,0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${C}`),2199}}}Gf.Zdg="EwaJsMetadataChangeListenerId";Gf.Gbe="cpiOSC";Gf.T6c="cpiPS";Gf.Ndi="cpiDID";Gf.Xib="Unknown";Gf.gpf="UnknownError";Gf.ZIa="_";Gf.Hsf="DragAndDropError";Gf.pasteErrorName="PasteError";Gf.bVh="CancelError";Gf.copyErrorName="CopyError";Gf.DHj="MergedCellOverlap";Gf.Fvg="PasteRecoveryCachedClipboardItems";Gf.Myk=[1352631530,1679665408];
Gf.operationSucceededWithAlert=[-103190598,1512686094];Gf.pasteDataLimitHit=[1306609195];Gf.copyThrottlingError=[-386183710];Gf.dragDropNonEmptyRange=[563945982];Gf.Ra=null;Object(K.a)(Gf,"CopyPasteInfrastructure",ac.a,[889,890,2]);class Yh{constructor(){this.Jhb=this.lhf=null}}Object(K.a)(Yh,"ClipboardPlatformInitializationResult",null,[]);var wg=a(788),Ai=a(787),yh=a(247),bi=a(121);const vi=(C,Ca,qb,nc,Rc,id,sd,Fd)=>{Fd=void 0===Fd?null:Fd;sd=C.Za(1,sd);sd.pasteHtmlParameters=Ca;return Dc.h(C,"PasteHtmlContent",
sd,qb,nc,Rc,id,64,Fd)},Vi=(C,Ca,qb,nc,Rc,id,sd,Fd,S,Ua)=>{Ua=void 0===Ua?null:Ua;S=C.Za(9,S);const Hb={};Hb.DestinationRange=Ca;Hb.Source=qb;Hb.AutoAdjustColumnsOn=nc;S.pasteStringParameters=Hb;return Dc.h(C,"PasteString",S,Rc,id,sd,Fd,64,Ua)},Wi=(C,Ca,qb,nc,Rc,id,sd,Fd)=>{Fd=void 0===Fd?null:Fd;sd=C.Za(1,void 0===sd?null:sd);sd.copyParameters=Ca;return Dc.h(C,"Copy",sd,qb,nc,Rc,id,0,Fd)},wi=(C,Ca,qb,nc,Rc,id,sd,Fd)=>{Fd=void 0===Fd?null:Fd;sd=C.Za(1,void 0===sd?null:sd);sd.pasteParameters=Ca;return Dc.h(C,
"Paste",sd,qb,nc,Rc,id,64,Fd)};class Xi{constructor(C,Ca,qb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=C;this.destinationRange=Ca;this.pasteFlags=qb}}Object(K.a)(Xi,"MacroRecorderPasteRangePayload",null,[149]);class fj{constructor(C,Ca){this.content=this.destinationRange=null;this.destinationRange=C;this.content=Ca}getContent(){return this.content}}Object(K.a)(fj,"MacroRecorderPasteStringPayload",null,[149]);class Mi{constructor(C){this.pasteParameters=null;this.pasteParameters=
C}}Object(K.a)(Mi,"MacroRecorderPastePayload",null,[149]);var pj=a(708),Yi=a(244);class qj{constructor(C){this.parameters=null;this.parameters=C}getParameters(){return this.parameters}}Object(K.a)(qj,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[149]);class ni{constructor(C){this.sheetName=null;this.sheetName=C}getSheetName(){return this.sheetName}}Object(K.a)(ni,"MacroRecorderFullSheetCopyPayload",null,[149]);class Zh{constructor(C,Ca){this.IZb=this.xza=null;this.qHc=ta.EwaSettings.getBooleanFeatureGate(eb.a.JNb,
!1);this.sVd=!1;this.i0=null;this.$E=(qb,nc)=>{if(2===nc.zx)this.LB=[],this.xza=null;else if(1===nc.zx&&this.LB&&this.LB.includes(nc.Xl)){qb=bi.a(nc.Xl.operation.operationName);const Rc=nc.Xl.dequeueUtcTime.getTime()-nc.Xl.enqueueUtcTime.getTime();E.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${qb} returned, it took ${Rc} milliseconds to complete.`);this.LB.splice(this.LB.indexOf(nc.Xl),1);this.xza=null}};this.$=C;this.da=Ca;this.sVd&&(this.$.userOperationManager.qw(this.$E),
this.LB=[]);rc.a.toa()&&void ka.a.resolve(oa.s,{va:1}).then(qb=>{this.i0=qb})}get l0b(){return this.$.ua.CCPCopyPasteHtmlLimit}get bdg(){return this.$.ua.CCPPastePlainTextLimit}copy(C,Ca,qb,nc,Rc){nc=void 0===nc?null:nc;Rc=void 0===Rc?null:Rc;const id=this.$.oa.ta.Wh();this.sVd&&this.n$();this.IZb=id.ClientRequestId;var sd=new od.a(505,0,(Fd,S,Ua)=>{const Hb={CopyPasteTargetType:1};Hb.SourceRanges=C;Hb.CopyOperationId=Ca.id;return this.xza=Wi(this.$.oa.vzd,Hb,gc.c(Fd,qb),nc?gc.b(S,nc):S,Ua,Ca.ribbonCommandInfo,
id,Rc)},80);sd=this.$.userOperationManager.enqueueOperation(sd,Ca.ribbonCommandInfo);this.sVd&&this.LB.push(sd)}fullSheetCopy(C,Ca,qb,nc){nc=void 0===nc?null:nc;const Rc=this.$.oa.ta.Wh();this.IZb=Rc.ClientRequestId;const id=new od.a(609,0,(sd,Fd,S)=>{var Ua=this.$.oa.ta;sd=gc.c(sd,qb);Fd=nc?gc.b(Fd,nc):Fd;var Hb=Ca.ribbonCommandInfo;const Ec=Ua.Za(1,void 0===Rc?null:Rc);Ec.sheetName=C;return this.xza=Dc.h(Ua,"CopySheetToShadowWorkbook",Ec,sd,Fd,S,Hb,0)},80,()=>new ni(C));this.$.userOperationManager.enqueueOperation(id,
Ca.ribbonCommandInfo)}Evg(C,Ca,qb,nc,Rc,id){return new Promise((sd,Fd)=>{var S;const Ua=id.commandParameters.stopwatch.Ci;let Hb=2;20===id.commandParameters.commandType&&(Hb=16);36===id.commandParameters.commandType&&(Hb=32);68===id.commandParameters.commandType&&(Hb=64);rc.a.Z0d(this.$)&&1028===id.commandParameters.commandType&&(Hb=1024);4100===id.commandParameters.commandType&&(Hb=4096);let Ec=null;if(null===(S=id.copyContextSnapshot)||void 0===S?0:S.commandParameters)Ec=id.copyContextSnapshot.commandParameters.id;
Zh.npe(this.$,C,nc,Ca,qb,null,cd=>{Zh.hEc(cd,id,sd,Fd,Ua,this.$,null,!0,null,null)},cd=>{id.serverRequestTimeInMs=id.commandParameters.stopwatch.Ci-Ua;cd=gb.a.$j(cd.data);Fd(new dd(5,cd))},Rc,Hb,Ec,id.commandParameters.id)})}pasteRange(C,Ca,qb,nc,Rc,id,sd,Fd,S,Ua){return new Promise((Hb,Ec)=>{const cd=sd.commandParameters.stopwatch.Ci;Zh.fCk(this.$,C,Ca,qb,nc|-5&Rc,Bd=>{Zh.hEc(Bd,sd,Hb,Ec,cd,this.$,null,!0,S,Ua)},Bd=>{sd.serverRequestTimeInMs=sd.commandParameters.stopwatch.Ci-cd;Bd=gb.a.$j(Bd.data);
Bd=new dd(5,Bd);null===Ua||void 0===Ua?void 0:Ua(Bd);Ec(Bd)},id,Fd)})}dck(C,Ca,qb,nc,Rc,id,sd,Fd){const S=new wg.a;return new Promise((Ua,Hb)=>{if(Ca)if(Ca.length>this.l0b){var Ec=sd.clipboardItems.getItem(Nc.a.plainText);let cd=-1;void 0!==Ec&&null!==Ec&&(cd=Ec.length);E.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${Ca.length}, MaxHtmlImportLength: ${this.l0b}, PlainTextLength: ${cd}`);Hb(new dd(1))}else Ec=new od.a(204,
0,(cd,Bd,ce)=>{this.$.eD();const Fe=sd.commandParameters.stopwatch.Ci;cd=gc.c(cd,pg=>{oa.qd.Ma()&&S.cancel();Zh.hEc(pg,sd,Ua,Hb,Fe,this.$,Ca,!1,null,null)});Bd=gc.b(Bd,pg=>{sd.serverRequestTimeInMs=sd.commandParameters.stopwatch.Ci-Fe;pg=gb.a.$j(pg.data);oa.qd.Ma()&&S.cancel();Hb(new dd(3,pg))});const Ue=this.$.oa.ta.Wh(),pf=Qa.x(C,this.$),Tf={};Tf.SourceHtml=Ca;Tf.DestinationRanges=pf?Qa.u(pf):null;Tf.CopyOperationId=qb;Tf.PasteId=nc;Tf.AutoAdjustColumnsOn=this.jM();return vi(this.$.oa.vzd,Tf,cd,
Bd,ce,null,Ue,id)},65),this.$.userOperationManager.enqueueOperation(Ec,Rc),oa.qd.Ma()&&this.Wsd(sd,Ca,C,Fd,S),this.nCj(Ca);else Ua("")})}Wsd(C,Ca,qb,nc,Rc){return nc.Wsd(C,Ca,qb,Rc)}nCj(C){if(C&&C.trim()&&ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8472105_EnablePasteHtmlTelemetry")){var Ca=performance.now(),qb=(new DOMParser).parseFromString(C,"text/html");if(qb){C=[];qb.querySelector("table table")&&C.push("NestedTable");qb.querySelector("table ol")&&C.push("OrderedListInsideTable");qb.querySelector("table ul")&&
C.push("UnorderedListInsideTable");qb.querySelector("ol table")&&C.push("TableInsideOrderedList");qb.querySelector("ul table")&&C.push("TableInsideUnorderedList");qb.querySelector("ol ol")&&C.push("NestedOrderedList");qb.querySelector("ul ul")&&C.push("NestedUnorderedList");qb.querySelector("ol ul")&&C.push("UnorderedListInsideOrderedList");qb.querySelector("ul ol")&&C.push("OrderedListInsideUnorderedList");qb.querySelector("td[rowspan], td[colspan], th[rowspan], th[colspan]")&&C.push("TableWithCellSpan");
var nc=new Set;qb.querySelectorAll("*").forEach(Rc=>{Rc.nodeType===Node.ELEMENT_NODE&&ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8708534_PasteHtmlTelemetryFix")&&mh.includes(Rc.tagName)&&nc.add(Rc.tagName)});qb=Array.from(nc);C.push(...qb);Ca=performance.now()-Ca;E.ULS.sendTraceTag(507545676,0,50,`htmlClipboardItem.logPasteHtmlStructureTelemetry | tagAnalysisTotalTime: ${Ca.toFixed(2)} ms, htmlTagAnalysisResult: ${JSON.stringify(C)}`)}}}jM(){return null==this.i0?!1:this.i0.jM}eck(C,Ca,qb,nc,Rc){return new Promise((id,
sd)=>{E.ULS.sendTraceTag(537167754,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${Rc.id}`);Ca&&(Ca=Ma.a.trimEnd(Ca,"\n","\r"));E.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${Rc.id}`);if(Ca)if(Ca.length>this.bdg)E.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",
Ca.length,this.bdg),sd(new dd(1));else{let S,Ua;const Hb=Qa.x(C,this.$);E.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${Rc.id}`);var Fd=!this.$.fa.isNamedObjectViewMode&&!Ca.includes("\n")&&!Ca.includes("\t");E.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${Rc.id}. treatAsLink=${Fd}`);Fd=Fd&&Ma.a.k1f(Ca);E.ULS.sendTraceTag(537167750,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${Rc.id}. treatAsLink=${Fd}`);const Ec=this.$.oa.ta.Wh();if(Fd){Ua=526;E.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${Rc.id}`);const cd=Yi.a.zzc(Ca);E.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${Rc.id}`);const Bd=Qa.u(Hb);Fd=(ce,
Fe,Ue)=>{const pf=Rc.commandParameters.stopwatch.Ci;ce=gc.c(ce,Tf=>{E.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${Rc.id}`);Rc.requestTelemetryData=Tf.RequestTelemetryData;Rc.serverRequestTimeInMs=Rc.commandParameters.stopwatch.Ci-pf;Tf.Errors&&0<Tf.Errors.length?sd(new dd(2,Tf.Errors)):id(Ca)});Fe=gc.b(Fe,Tf=>{Rc.serverRequestTimeInMs=Rc.commandParameters.stopwatch.Ci-pf;Tf=gb.a.$j(Tf.data);sd(new dd(2,
Tf))});this.$.eD();E.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${Rc.id}`);return Dc.b(this.$.oa.ta,Bd,Ca,cd,!1,!1,63,ce,Fe,Ue,C,Ec,nc)};S=()=>new pj.a(Bd,Ca,cd)}else Ua=180,Fd=(cd,Bd,ce)=>{this.$.eD();const Fe=Rc.commandParameters.stopwatch.Ci;cd=gc.c(cd,Ue=>{E.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${Rc.id}`);Zh.hEc(Ue,
Rc,id,sd,Fe,this.$,Ca,!1,null,null)});Bd=gc.b(Bd,Ue=>{Rc.serverRequestTimeInMs=Rc.commandParameters.stopwatch.Ci-Fe;Ue=gb.a.$j(Ue.data);sd(new dd(4,Ue))});E.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${Rc.id}`);return Vi(this.$.oa.vzd,Hb,Ca,this.jM(),cd,Bd,ce,null,Ec,nc)},S=()=>new fj(Hb,Ca);E.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${Rc.id}`);
Fd=new od.a(Ua,0,Fd,65,S);E.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${Rc.id}`);this.$.userOperationManager.enqueueOperation(Fd,qb)}else id("")})}ITf(C,Ca){Ca=[1===Ca?4:5];this.da.Fh.wQ(Ve.a.l$a(hf.d(this.$.la),C),Ca,!0);this.da.Fh.Qw(Ca);this.da.Fh.update(!0)}ISd(){const C=[4,5];this.da.Fh.fr(C,!1,!1);this.da.Fh.wt(null,C,!1);1===this.da.ha.Hk&&this.da.Qw(!1,!1);this.da.Fh.update(!1,!1)}FTh(C,Ca,qb){const nc=[];for(const Rc of qb)nc.push(this.MTh(C,
Ca,Rc));return nc}n$(){if(this.LB)for(const C of this.LB)if(this.$&&this.$.userOperationManager){if(C.operation){const Ca=bi.a(C.operation.operationName);E.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${Ca}.`)}this.$Uh();this.$.userOperationManager.Wma(C)}}$Uh(){if(this.xza){const C=this.xza.rC;E.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${C}`);gb.a.lD(C);!ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&
this.IZb&&Dc.i(this.$.oa.ta,this.IZb,null,null,null);this.IZb=this.xza=null}}MTh(C,Ca,qb){E.ULS.shipAssertTag(537167713,0,!!Ca,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");E.ULS.shipAssertTag(537167712,0,0<Ca.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let nc=0,Rc=0;var id=new Set;const sd=new Set;for(const Fd of Ca){Ca=`${Fd.left}_${Fd.right}`;const S=`${Fd.top}_${Fd.bottom}`;sd.has(Ca)||(sd.add(Ca),Rc+=Fd.width);id.has(S)||
(id.add(S),nc+=Fd.height)}if(36===C)return qb.isSingle?Zh.rzf(Rc,nc,qb):qb.clone();516===C&&(C=nc,nc=Rc,Rc=C);C=!(qb.width%Rc)&&!(qb.height%nc);id=qb.QY&&!(qb.height%nc);qb.Kba&&!(qb.width%Rc)||id?qb=Zh.rzf(Rc,nc,qb):C?qb=qb.clone():(qb=qb.clone(),qb.bottom=Math.min(Wb.a.Ok,qb.top+nc-1),qb.right=Math.min(Wb.a.Ak,qb.left+Rc-1));return qb}wKh(C,Ca,qb,nc,Rc,id,sd,Fd,S,Ua,Hb){if(!nc||!nc.length)return 1;if(1<nc.length){if(!this.qHc&&id)return 3;if(Ua)return 0;if(Fd)return 9;if(S)return 8;if(Hb)return 2;
if(1<Ca.length)return 4;const Ec=Ca[0];if(!sd&&!yh.a.all(nc,cd=>cd.isSingle||!(cd.width%Ec.width)&&!(cd.height%Ec.height)))return 5;if((!this.qHc||!id)&&Ma.a.equals(C,qb,!0))for(const cd of Rc)if(cd.$i(Ec)&&!cd.equals(Ec))return 6}else if(Ca&&0<Ca.length){if(0!==this.jZf(Ca,S))return 7;if(1<Ca.length){if(!this.qHc&&id)return 3;if((!this.qHc||!id)&&Ma.a.equals(C,qb,!0))for(const Ec of Ca)if(C=Rc[0],Ec.$i(C)&&!Ec.equals(C))return 6}}return 0}jZf(C,Ca){if(!C||1>=C.length)return 0;if(Ca)return 2;if(!Qa.Z(C))return 1;
Ca=new Ai.a(Hh.a.tm());for(const qb of C)for(const nc of C){const Rc=qb.top===nc.top&&qb.bottom===nc.bottom,id=qb.left===nc.left&&qb.right===nc.right,sd=Math.max(qb.left,nc.left)<Math.min(qb.right,nc.right);if(Math.max(qb.top,nc.top)<Math.min(qb.bottom,nc.bottom)&&!Rc||sd&&!id)return 3;Ca.add(`${qb.top}-${qb.bottom}-${nc.left}-${nc.right}`);Ca.add(`${nc.top}-${nc.bottom}-${qb.left}-${qb.right}`)}for(const qb of C)Ca.remove(`${qb.top}-${qb.bottom}-${qb.left}-${qb.right}`);return 0<Ca.count?3:0}xik(C){const Ca=
this.da.ha;Ca.updateSelection(C,C.topLeft,0);Ca.selectionType=-1}RCc(C){if(null===C||void 0===C?0:C.sourceItem){if(!mb(C.sourceItem))return null;if((C=C.sourceItem)&&Qa.mb(C.ranges,!0))return C}return null}Nob(C,Ca){E.ULS.shipAssertTag(537167711,0,!!C,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Ca&&X.a.kF in Ca||C.tabName?!1:1===C.method}static fCk(C,Ca,qb,nc,Rc,id,sd,Fd,S){const Ua=C.oa.ta.Wh(S?{Oza:!0,rya:1}:{Oza:!1,rya:0});S=new od.a(506,0,(Hb,Ec,cd)=>{C.eD();
var Bd=C.oa.ta;Hb=gc.c(Hb,id);Ec=gc.b(Ec,sd);var ce=Fd;ce=void 0===ce?null:ce;const Fe=Bd.Za(9,Ua);Fe.sourceRanges=qb;Fe.destinationRanges=nc;Fe.flags=Rc;return Dc.h(Bd,"PasteRange",Fe,Hb,Ec,cd,null,64,ce)},65,()=>new Xi(qb,nc,Rc));C.userOperationManager.enqueueOperation(S,Ca)}static hEc(C,Ca,qb,nc,Rc,id,sd,Fd,S,Ua){sd=void 0===sd?null:sd;E.ULS.sendTraceTag(537167710,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${Ca.id}`);Ca.requestTelemetryData=
C.RequestTelemetryData;Ca.serverRequestTimeInMs=Ca.commandParameters.stopwatch.Ci-Rc;he.a.ll(C.Errors)?he.a.Hua(C.Errors)?(Ca&&(Ca.encounteredDeploymentErrors=!0),C=he.a.fi(C.Errors),E.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${C}`)):(C=new dd(5,C.Errors),null===Ua||void 0===Ua?void 0:Ua(C),nc(C)):C.Result?(nc=!!C&&!!C.RequestTelemetryData,ha.f(id).tk.c2(Ca.commandParameters.stopwatch.id,
C.StateId,nc?C.RequestTelemetryData.EcsOperationDuration:0,nc?C.RequestTelemetryData.EcsRequestDuration:0,nc?C.RequestTelemetryData.WfeRequestDuration:0),nc=C.Result,Ca.pastedRange=nc.SheetMultiRange,E.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${Ca.id}`),null===S||void 0===S?void 0:S(),qb(!0),ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&Fd&&!Ca.commandParameters.isDragDrop?(Ca=ka.a.lh(oa.ve))&&Ca.Nja(6,C):rc.a.toa()&&nc.AutoAdjustedColumns&&void ka.a.resolve(oa.s,{va:1}).then(Hb=>{Hb.qig("Paste")})):(E.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${Ca.id}`),qb(sd||!0))}static npe(C,Ca,qb,nc,Rc,id,sd,Fd,S,Ua,Hb,Ec){const cd=C.oa.ta.Wh(),Bd=Zh.cnf(qb,nc,Rc,Ua,Hb,Ec);qb=new od.a(503,0,(ce,Fe,Ue)=>{C.eD();return wi(C.oa.ta,
Bd,gc.c(ce,sd),gc.b(Fe,Fd),Ue,id,cd,S)},65,()=>new Mi(Bd));C.userOperationManager.enqueueOperation(qb,Ca)}static cnf(C,Ca,qb,nc,Rc,id){const sd={};sd.ShadowWorkbookBase64=C.shadowWorkbookBase64;sd.SourceRanges={};sd.SourceRanges.Ranges=Array(1);sd.SourceRanges.Ranges[0]={};sd.SourceRanges.Ranges[0].FirstRow=C.rangeRowStart;sd.SourceRanges.Ranges[0].LastRow=C.rangeRowEnd;sd.SourceRanges.Ranges[0].FirstColumn=C.rangeColumnStart;sd.SourceRanges.Ranges[0].LastColumn=C.rangeColumnEnd;ta.EwaSettings.getBooleanFeatureGate(eb.a.JNb,
!1)?qb?sd.DestinationRanges=Qa.w(qb.SheetName,qb.NamedObjectName,Qa.h(qb.Ranges)):(E.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),sd.DestinationRanges=null):sd.DestinationRanges=Ca?Qa.u(Ca):null;sd.CopyPasteTargetType=1;sd.PasteType=nc;sd.CopyOperationId=Rc;sd.PasteId=id;sd.SourceClientPath=C.sourceClientPath;sd.SourceSheetName=C.sourceSheetName;sd.SourceWorkbookName=C.sourceWorkbookName;if(!C.originalSourceRangesCountExceedsLimit&&
C.originalSourceRanges&&0<C.originalSourceRanges.length&&1024===nc){sd.OriginalSourceMultiRange={};Ca=Array(C.originalSourceRanges.length);for(qb=0;qb<Ca.length;++qb)Ca[qb]={},Ca[qb].FirstRow=C.originalSourceRanges[qb][0],Ca[qb].FirstColumn=C.originalSourceRanges[qb][1],Ca[qb].LastRow=C.originalSourceRanges[qb][2],Ca[qb].LastColumn=C.originalSourceRanges[qb][3];sd.OriginalSourceMultiRange.Ranges=Ca}return sd}static rzf(C,Ca,qb){qb=qb.clone();qb.height<Ca&&(qb.bottom=Math.min(Wb.a.Ok,qb.top+Ca-1));
qb.width<C&&(qb.right=Math.min(Wb.a.Ak,qb.left+C-1));return qb}EOk(C,Ca,qb){return(C=ha.f(C).oh.Ml(qb))?Ca.width===C.usedRange.width&&qb.left===C.usedRange.left||qb.left===C.usedRange.left&&qb.right===C.usedRange.right&&0===qb.width%Ca.width:!1}DOk(C,Ca,qb){return(C=ha.f(C).oh.Ml(qb))?Ca.height===C.usedRange.height&&qb.top===C.usedRange.top||qb.top===C.usedRange.top&&qb.bottom===C.usedRange.bottom&&0===qb.height%Ca.height:!1}executeInsertCopiedCutCellsOperation(C,Ca,qb,nc,Rc,id,sd){id=void 0===id?
null:id;sd=void 0===sd?null:sd;const Fd={};Fd.InsertDirection=nc;Fd.SourceRange=C;Fd.DestRange=Ca;Fd.CopyCutOperation=qb?0:1;const S=this.$.oa.ta,Ua=this.$.oa.ta.Wh(),Hb=()=>new qj(Fd);return ca.a(this.$.userOperationManager,(Ec,cd,Bd)=>{Ec=id?gc.c(Ec,id):Ec;cd=sd?gc.b(cd,sd):cd;const ce=S.Za(41,null);ce.insertCopiedCutCellsParameters=Fd;return Dc.h(S,"InsertCopiedCutCellsV2",ce,Ec,cd,Bd,Ua,0)},Ec=>new od.a(104,0,Ec,void 0,Hb),Rc)}qji(C,Ca,qb,nc,Rc,id,sd,Fd){return new Promise((S,Ua)=>{this.executeInsertCopiedCutCellsOperation(Ca,
qb,nc,Rc,id,Hb=>{C.requestTelemetryData=Hb.RequestTelemetryData;if(Hb.Errors&&0<Hb.Errors.length){const Ec=new dd(21,Hb.Errors);null===Fd||void 0===Fd?void 0:Fd(Ec);Ua(new dd(21,Hb.Errors))}else null===sd||void 0===sd?void 0:sd(),S(!0)},Hb=>{Hb=gb.a.$j(Hb.data);Hb=new dd(21,Hb);null===Fd||void 0===Fd?void 0:Fd(Hb);Ua(Hb)})})}executeInsertCopiedCutCellsAcrossSession(C,Ca,qb,nc,Rc,id,sd,Fd,S,Ua,Hb){id=void 0===id?null:id;sd=void 0===sd?null:sd;const Ec={};Ec.PasteParameters=Zh.cnf(Ua,Fd,S,2,Hb.copyContextSnapshot.commandParameters.id,
Hb.commandParameters.id);Ec.InsertDirection=nc;Ec.SourceRange=C;Ec.DestRange=Ca;Ec.CopyCutOperation=qb?0:1;const cd=this.$.oa.ta,Bd=this.$.oa.ta.Wh(),ce=()=>new qj(Ec);return ca.a(this.$.userOperationManager,(Fe,Ue,pf)=>{Fe=id?gc.c(Fe,id):Fe;Ue=sd?gc.b(Ue,sd):Ue;const Tf=cd.Za(41,null);Tf.insertCopiedCutCellsParameters=Ec;return Dc.h(cd,"InsertCopiedCutCellsCrossSession",Tf,Fe,Ue,pf,Bd,0)},Fe=>new od.a(106,0,Fe,void 0,ce),Rc)}}Object(K.a)(Zh,"CopyPasteUtils",null,[888]);var Ni=a(511),Xh;(function(C){C[C.range=
0]="range";C[C.art=1]="art";C[C.nonGrid=2]="nonGrid";C[C.fullSheet=3]="fullSheet"})(Xh||(Xh={}));Object(K.b)("SourceItemType",Xh);class di extends sa{constructor(C,Ca,qb){super(Ca,qb);this.sheetName=C}isEqual(C){return C&&Object.getType(C)===di?this.LHc(C)&&this.sheetName===C.sheetName:!1}}Object(K.a)(di,"FullSheetSourceItem",sa,[]);class gj{constructor(C){this.ZZg={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1,["SourceItemType.NonGrid"]:2,["SourceItemType.FullSheet"]:3};this.x9a={};this.VZg=
{["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.Gsd={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",
["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.YZg={["RibbonCommand.Copy"]:-911352779,["RibbonCommand.Cut"]:-1985798686,["RibbonCommand.WriteToClipboard"]:396830482,["RibbonCommand.FullSheetCopy"]:-207190267};this.bne={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut",
["396830482"]:"RibbonCommand.WriteToClipboard",["-207190267"]:"RibbonCommand.FullSheetCopy"};this.XZg={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.oya={};this.WZg={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.ilb={};this.$Zg={["UILocation.Unknown"]:0,["UILocation.UpperRibbon"]:1,
["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,["UILocation.ContextMenu"]:19,
["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.VA={};this.$=C;this.oya.notDefined="InputManager.InputMethod.NotDefined";this.oya.unknown="InputManager.InputMethod.Unknown";this.oya.keyboard="InputManager.InputMethod.Keyboard";this.oya.mouse="InputManager.InputMethod.Mouse";this.oya.touch="InputManager.InputMethod.Touch";this.oya.crossSlide="InputManager.InputMethod.CrossSlide";this.ilb.none="FrameMode.None";
this.ilb.reading="FrameMode.Reading";this.ilb.edit="FrameMode.Edit";this.VA.unknown="UILocation.Unknown";this.VA.upperRibbon="UILocation.UpperRibbon";this.VA.ribbon="UILocation.Ribbon";this.VA.QAT="UILocation.QAT";this.VA.jewel="UILocation.Jewel";this.VA.navigationPane="UILocation.NavigationPane";this.VA.keyboardShortcut="UILocation.KeyboardShortcut";this.VA.statusBar="UILocation.StatusBar";this.VA.dialog="UILocation.Dialog";this.VA.floatie="UILocation.Floatie";this.VA.notificationBar="UILocation.NotificationBar";
this.VA.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.VA.taskPane="UILocation.TaskPane";this.VA.heroDock="UILocation.HeroDock";this.VA.singleLineRibbon="UILocation.SingleLineRibbon";this.VA.multilineRibbon="UILocation.MultilineRibbon";this.VA.overflow="UILocation.Overflow";this.VA.tellMe="UILocation.TellMe";this.VA.farPeripheralControls="UILocation.FarPeripheralControls";this.VA.header="UILocation.Header";this.VA.fileMenu="UILocation.FileMenu";this.VA.contextMenu="UILocation.ContextMenu";
this.VA.dialogMenu="UILocation.DialogMenu";this.VA.toolbar="UILocation.Toolbar";this.VA.canvas="UILocation.Canvas";this.x9a.range="SourceItemType.Range";this.x9a.art="SourceItemType.Art";this.x9a.nonGrid="SourceItemType.NonGrid";this.x9a.fullSheet="SourceItemType.FullSheet"}serializeSourceItem(C){const Ca={};if(C&&Object.getType(C)===va)Ca.sheetName=C.sheetName,Ca.topArray=yh.a.map(C.ranges,qb=>qb.top),Ca.leftArray=yh.a.map(C.ranges,qb=>qb.left),Ca.bottomArray=yh.a.map(C.ranges,qb=>qb.bottom),Ca.rightArray=
yh.a.map(C.ranges,qb=>qb.right),Ca.sessionStateId=C.sessionStateId,Ca.sessionId=C.sessionId,Ca.sourceItemType=this.EYc(0);else if(C&&Object.getType(C)===Vb)Ca.activeFloatingObjectControlId=C.activeFloatingObjectControlId,Ca.sheetName=C.sheetName,Ca.sessionStateId=C.sessionStateId,Ca.sessionId=C.sessionId,Ca.floatingObjectType=this.QCk(C.type),Ca.sourceItemType=this.EYc(1);else if(C&&Object.getType(C)===ud)Ca.sessionStateId=C.sessionStateId,Ca.sessionId=C.sessionId,Ca.sourceItemType=this.EYc(2);else if(C&&
Object.getType(C)===di)Ca.sheetName=C.sheetName,Ca.sessionStateId=C.sessionStateId,Ca.sessionId=C.sessionId,Ca.sourceItemType=this.EYc(3);else return E.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Ca)}serializeCommandParameters(C){if(!C)return E.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const Ca={};Ca.id=C.id;Ca.commandType=
C.commandType;Ca.copyPasteTargetType=C.copyPasteTargetType;C.ribbonCommandInfo&&(Ca.ribbonCommandName=this.$Ck(C.ribbonCommandInfo.command),Ca.inputMethodName=this.UCk(C.ribbonCommandInfo.method),Ca.frameModeName=this.SCk(C.ribbonCommandInfo.mode),Ca.uiLocationName=this.dDk(C.ribbonCommandInfo.jk),Ca.tabName=C.ribbonCommandInfo.tabName);return JSON.stringify(Ca)}deserializeSourceItem(C){if(!C)return null;try{const Ca=JSON.parse(C);if(!Ca)return E.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),
null;let qb=null;switch(this.bfi(Ca.sourceItemType)){case 0:qb=new va(this.$,this.Zei(Ca),Ca.sheetName,Ca.sessionStateId,Ca.sessionId);break;case 1:qb=new Vb(Ca.activeFloatingObjectControlId,Ca.sheetName,Ca.sessionStateId,Ca.sessionId,this.Wei(Ca.floatingObjectType));break;case 2:qb=new ud(Ca.sessionStateId,Ca.sessionId);break;case 3:qb=new di(Ca.sheetName,Ca.sessionStateId,Ca.sessionId)}return qb}catch(Ca){return E.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${C?
C.length:0}, errror: ${Ca}`),null}}deserializeCommandParameters(C){if(!C)return null;try{const Ca=JSON.parse(C);if(!Ca)return E.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const qb=nd.a();qb.id=Ca.id;qb.ribbonCommandInfo=this.afi(Ca);qb.commandType=Ca.commandType;qb.copyPasteTargetType=Ca.copyPasteTargetType;return qb}catch(Ca){return E.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${C?
C.length:0}, errror: ${Ca}`),null}}Zei(C){const Ca=[];E.ULS.shipAssertTag(537167699,0,!!C.topArray&&0<C.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${C.topArray?"empty":"null"}.`);E.ULS.shipAssertTag(537167698,0,!!C.leftArray&&0<C.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${C.leftArray?"empty":"null"}.`);E.ULS.shipAssertTag(537167697,0,!!C.bottomArray&&0<C.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${C.bottomArray?
"empty":"null"}.`);E.ULS.shipAssertTag(537167696,0,!!C.rightArray&&0<C.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${C.rightArray?"empty":"null"}.`);if(!(C.topArray&&C.leftArray&&C.bottomArray&&C.rightArray))return Ca;E.ULS.shipAssertTag(537167695,0,C.topArray.length===C.bottomArray.length&&C.topArray.length===C.leftArray.length&&C.topArray.length===C.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${C.topArray.length}), BottomArray(${C.bottomArray.length}), LeftArray(${C.leftArray.length}), RightArray(${C.rightArray.length}) should be the same.`);
const qb=Math.min(C.topArray.length,C.bottomArray.length,C.leftArray.length,C.rightArray.length);for(let nc=0;nc<qb;nc++)Ca.push(new Jc.Range(C.topArray[nc],C.leftArray[nc],C.bottomArray[nc],C.rightArray[nc],!1,!1));return Ca}afi(C){return new Nb.a(this.$ei(C.ribbonCommandName),this.Yei(C.inputMethodName),this.Xei(C.frameModeName),this.dfi(C.uiLocationName),C.tabName)}$Ck(C){return void 0!==C&&null!==C&&C.toString()in this.bne?this.bne[C.toString()]:(E.ULS.shipAssertTag(537167694,0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${C}`),
this.bne["-911352779"])}$ei(C){return C&&C in this.YZg?this.YZg[C]:(E.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${C}`),-911352779)}UCk(C){return void 0!==C&&null!==C&&vh.a[C]in this.oya?this.oya[vh.a[C]]:(E.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${C}`),this.oya.unknown)}Yei(C){return C&&
C in this.XZg?this.XZg[C]:(E.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${C}`),0)}SCk(C){return void 0!==C&&null!==C&&Ni.a[C]in this.ilb?this.ilb[Ni.a[C]]:(E.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${C}`),this.ilb.edit)}Xei(C){return C&&C in this.WZg?this.WZg[C]:(E.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${C}`),
2)}EYc(C){return void 0!==C&&null!==C&&Xh[C]in this.x9a?this.x9a[Xh[C]]:(E.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${C}`),this.x9a.range)}bfi(C){return C&&C in this.ZZg?this.ZZg[C]:(E.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${C}`),0)}QCk(C){return void 0!==C&&null!==C&&C.toString()in this.Gsd?this.Gsd[C.toString()]:(E.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${C}`),
this.Gsd["99"])}Wei(C){return C&&C in this.VZg?this.VZg[C]:(E.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${C}`),99)}dDk(C){return void 0!==C&&null!==C&&bg.a[C]in this.VA?this.VA[bg.a[C]]:(E.ULS.shipAssertTag(36229129,0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${C}`),this.VA.ribbon)}dfi(C){return C&&C in this.$Zg?this.$Zg[C]:(E.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${C}`),
2)}}Object(K.a)(gj,"EnvironmentSerializationHelper",null,[]);class kh{}kh.RLg="SameSession";kh.dBd="CrossSession";kh.V7f="LegacyCrossSession";kh.external="External";Object(K.a)(kh,"PayloadOrigin",null,[]);const Bi=C=>C?C.shadowWorkbookSizeExceedsLimit&&void 0!==C.shadowWorkbookBlockedSize&&null!==C.shadowWorkbookBlockedSize?C.shadowWorkbookBlockedSize:C.shadowWorkbookBase64?C.shadowWorkbookBase64.length:0:0,Ci=C=>C.shadowWorkbookSizeExceedsLimit?!0:Bi(C)>Wb.a.HNc;var hj=a(101);class ij{constructor(C,
Ca,qb){qb=void 0===qb?null:qb;this.TVa=!1;this._name=Ca;this.$=C;this.Xq=qa.a.instance;this.nA=new Zh(C,ha.f(C));this.bNb=qb}get name(){return this._name}get bKb(){return this.Xq.Aa(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}Q5k(C){let Ca;Ca=null;try{const qb=C.getItem(Nc.a.shadowWorkbook);if(!qb)return{returnValue:!1,MN:Ca};Ca=JSON.parse(qb);return{returnValue:this.Auj(Ca),MN:Ca}}catch(qb){return E.ULS.sendTraceTag(537167835,0,50,
"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+qb),{returnValue:!1,MN:Ca}}}Auj(C){return!!C&&(!!C.shadowWorkbookBase64||C.shadowWorkbookSizeExceedsLimit)&&void 0!==C.rangeRowStart&&void 0!==C.rangeRowEnd&&void 0!==C.rangeColumnStart&&void 0!==C.rangeColumnEnd}jSc(C){C.wasLastCopyExternal=!0;ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&C.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(C.commandParameters.commandType=
-185374993===this.$.shortcutKeyManager.kvc?20:4);if(eb.a.v1a&&516!==C.commandParameters.commandType&&1028!==C.commandParameters.commandType){let Ca=null;if((()=>{let qb=this.Q5k(C.clipboardItems);({MN:Ca}=qb);return qb})().returnValue)return C.isShadowWorkbookParsedSuccessfully=!0,this.R6j(C,Ca)}if(516!==C.commandParameters.commandType&&36!==C.commandParameters.commandType&&4100!==C.commandParameters.commandType){if(20!==C.commandParameters.commandType){const Ca=C.clipboardItems.getItem(Nc.a.html),
qb=this.i5f(Ca),nc=C.clipboardItems.getItem(Nc.a.Btc),Rc=Na.f(C.clipboardItems.getItem(Nc.a.plainText));return!qb||!nc&&Rc?(Rc&&E.ULS.sendTraceTag(508863578,0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.ede(C)):this.zvg(C,Ca,void 0===nc?null:nc)}return this.ede(C)}return Promise.reject(new dd(6))}R6j(C,Ca){E.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");C.pasteResult="SystemClipboardShadowWorkbookPaste";
C.payloadType=bc.shadowWorkbook;C.payloadOrigin=kh.external;C.shadowWorkbookPayloadSize=Bi(Ca);C.shadowWorkbookSizeExceedsLimit=Ci(Ca);let qb=null,nc=null;const Rc=C.commandParameters.originalDestinations;ta.EwaSettings.getBooleanFeatureGate(eb.a.JNb,!1)?qb=Qa.t(Rc,this.$):nc=Qa.x(Qa.R(Rc),this.$);Ca.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(C.originalSourceRangesCountExceedsLimit=Ca.originalSourceRangesCountExceedsLimit);if(C.shadowWorkbookSizeExceedsLimit)return E.ULS.sendTraceTag(537167833,
0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${C.shadowWorkbookPayloadSize}) is over the limit(${Wb.a.HNc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Ca.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new dd(1));E.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${C.commandParameters.id}`);return this.nA.Evg(C.commandParameters.ribbonCommandInfo,nc,qb,Ca,[C.commandParameters.stopwatch],
C)}ede(C){var Ca=C.clipboardItems.getItem(Nc.a.plainText);if(void 0!==Ca&&null!==Ca&&Ca.trim()===this.bKb)return Promise.reject(new dd(7));void 0!==Ca&&null!==Ca&&(C.plainTextPayloadSize=Ca.length);let qb=!1;null!==this.bNb&&(qb=this.bNb.VLh(C,Ma.a.trimEnd(Ca,"\n","\r"),Qa.R(C.commandParameters.originalDestinations)));qb&&ha.f(this.$).tk.HT(C.commandParameters.stopwatch.id,Lh.BasicTelemetryCalculator.nS);this.TVa||(this.TVa=!0,hj.b("AutoAdjustColumnWidthTriggered"));C.isPlainTextPaste=!0;C.pasteResult=
"SystemClipboardPaste";C.payloadOrigin=Ud(C)?kh.V7f:kh.external;C.payloadType=bc.plainText;E.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${C.id}, PasteOperationId=${C.commandParameters.id}`);Ca=this.nA.eck(Qa.R(C.commandParameters.originalDestinations),Ca,C.commandParameters.ribbonCommandInfo,[C.commandParameters.stopwatch],C);E.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${C.id}`);
return Ca}zvg(C,Ca,qb){this.TVa||(this.TVa=!0,hj.b("AutoAdjustColumnWidthTriggered"));C.htmlPayloadSize=Ca.length;C.isHtmlPaste=!0;C.pasteResult="SystemClipboardHtmlPaste";C.payloadType=bc.html;C.payloadOrigin=Ud(C)?kh.V7f:kh.external;C.cseStatus=3;E.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${C.commandParameters.id}`);return this.nA.dck(Qa.R(C.commandParameters.originalDestinations),Ca,qb,C.commandParameters.id,C.commandParameters.ribbonCommandInfo,
[C.commandParameters.stopwatch],C,this.bNb)}MAd(C){const Ca={};C&&(Ca.shadowWorkbookBase64=C.ShadowWorkbookBase64,Ca.shadowWorkbookSizeExceedsLimit=C.ShadowWorkbookSizeExceedsLimit,Ca.originalSourceRangesCountExceedsLimit=C.OriginalSourceRangesCountExceedsLimit,Ca.originalSourceRangesCount=C.OriginalSourceRangesCount,Ca.shadowWorkbookBlockedSize=C.ShadowWorkbookBlockedSize);return Ca}M9g(C,Ca){const qb=zd(C),nc=32===(C.commandParameters.commandType&32),Rc=1024===(C.commandParameters.commandType&1024);
let id=!1,sd=null,Fd=null,S=!1;if(!qb){id=-1985798686===C.commandParameters.ribbonCommandInfo.command;var Ua=C.copyContextSnapshot;if(Ca)S=!Ua.sourceItem.isFromCurrentSession(this.$);else if(Ua=this.nA.RCc(Ua))sd=Ua.ranges,Fd=Ua.sheetName,S=!C.isSameSession}return this.nA.wKh(Fd,sd,this.$.la.sheetName,C.commandParameters.originalDestinations,C.commandParameters.expandDestinations,S,nc,Rc,id,Ca,qb)}i5f(C){return!(void 0===C||null===C)&&!!C&&C.trim()!==this.bKb&&(C.startsWith("<")||Sa.a.Cm&&C.startsWith("\n<"))}}
Object(K.a)(ij,"BaseCopyPasteHandler",null,[919,899,920]);class wh{constructor(C){this.clipboardItems=this.key=null;this.v0=C}LK(C){return this.key&&this.key.isEqual(C)?this.createClipboardItems(this.clipboardItems):null}setValue(C,Ca){this.key=C;this.clipboardItems=this.createClipboardItems(Ca)}createClipboardItems(C){const Ca=this.v0.create();var qb=C.getItem(Nc.a.plainText);qb&&Ca.setItem(Nc.a.plainText,qb);(qb=C.getItem(Nc.a.shadowWorkbook))&&Ca.setItem(Nc.a.shadowWorkbook,qb);(C=C.getItem(Nc.a.html))&&
Ca.setItem(Nc.a.html,C);return Ca}}Object(K.a)(wh,"CopyCache",null,[]);class Ih extends ij{constructor(C,Ca,qb,nc,Rc){Rc=void 0===Rc?null:Rc;super(C,nc,Ca);this.bNb=Ca;this.v0=qb;this.$Mb=Rc||new wh(this.v0);this.da=ha.f(C);this.ha=this.da.ha;ta.EwaSettings.mWd()||(this.clipboardRangeFactory=C.qa.zh(169))}getSourceItem(){const C=Qa.d(this.da.ha.pa.selectedRanges);return new va(this.$,C,this.$.fa.la.sheetName,this.$.fa.yk,this.$.ua.UserSessionId)}beforeSerialize(C){C.isSelectionAllowed=!1;C.isAsyncCopy=
!1;C.isFromCache=!1;C.encounteredDeploymentErrors=!1;C.plainTextPayloadSize=0;C.shadowWorkbookPayloadSize=0;C.htmlPayloadSize=0;C.clientSideCopyTime=0;if(!C.isFullSheetCopy){var Ca=new kd.a(this.$.sa),qb=C.sourceItem;C.isSelectionAllowed=yh.a.all(qb.ranges,nc=>this.isSelectionAllowed(Ca,nc));C.isSelectionAllowed&&this.nA.ITf(qb.ranges,C.commandParameters.commandType)}}K2a(C){return this.da.za.lba()&&ha.h(this.da,C)}v7j(C,Ca,qb,nc){if(!this.$.sa.Pq(qb.sheetName))return Promise.reject(new dd(5));let Rc=
!1;const id=1===Ca.commandParameters.commandType,sd=nc[0].zz;1===qb.ranges.length&&1===nc.length?id&&1!==sd&&sd!==qb.ranges[0].zz?C.cseStatus=17:Rc=this.bNb.EDd(C,Qa.R(qb.ranges),qb.sheetName,Qa.R(C.commandParameters.expandDestinations),id):C.cseStatus=5;Rc&&ha.f(this.$).tk.HT(C.commandParameters.stopwatch.id,Lh.BasicTelemetryCalculator.nS);return this.Z6j(C,qb,Qa.w(this.$.la.sheetName,null,nc),Ca.commandParameters.commandType,Rc)}isSelectionAllowed(C,Ca){return C.Ppb(Ca,this.da)}Z6j(C,Ca,qb,nc,Rc){Ca=
Qa.w(Ca.sheetName,null,Ca.ranges);C.pasteResult="SameSessionPaste";C.payloadOrigin=kh.RLg;C.payloadType=bc.Jxh;E.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${C.commandParameters.id}`);return this.nA.pasteRange(C.commandParameters.ribbonCommandInfo,Ca,qb,nc,C.commandParameters.commandType,[C.commandParameters.stopwatch],C,Rc,null,null)}}Object(K.a)(Ih,"BaseRangeCopyPasteHandler",ij,[]);class jj{constructor(C){this.y5=new xb.a(!0);
this.$=C}onDeferredPasteStarted(C){this.y5.mh(C.id)||this.y5.add(C.id,!0);if(0<this.y5.count)if(ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void ka.a.resolve(oa.E,{va:0}).then(Ca=>{Ca.Rm(28,null)});else{const Ca=Object(Tc.d)(ka.a.resolve(oa.E,{va:0}));Bb.TaskExtensions.$e(Ca,()=>{Ca.result.Rm(28,null)},this.$.ya,3)}}onDeferredPasteCompleted(C){const Ca=0<this.y5.count;this.y5.mh(C.id)&&this.y5.remove(C.id);if(Ca&&!this.y5.count)if(ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",
!1))void ka.a.resolve(oa.E,{va:0}).then(qb=>{qb.removeEntry(28)});else{const qb=Object(Tc.d)(ka.a.resolve(oa.E,{va:0}));Bb.TaskExtensions.$e(qb,()=>{qb.result.removeEntry(28)},this.$.ya,3)}}}Object(K.a)(jj,"DeferredPasteTracker",null,[]);var kj;(function(C){C[C.none=0]="none";C[C.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";C[C.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";C[C.asyncCopyCanceled=3]="asyncCopyCanceled";C[C.loadCopiedArtDataFromServerFailed=4]=
"loadCopiedArtDataFromServerFailed"})(kj||(kj={}));Object(K.b)("CopyErrorType",kj);class Dh extends tb{constructor(C,Ca){Ca=void 0===Ca?null:Ca;super(kj[C]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=C;this.ewaErrors=Ca;if(null===Ca||void 0===Ca?0:Ca.length)this.innerError=new zc(Ca,null)}}Object(K.a)(Dh,"CopyInnerError",tb,[]);var oi=a(738);class og extends Ih{constructor(C,Ca,qb,nc){super(C,Ca,qb,"AcrossSessionRangeCopyPasteHandler",void 0===nc?null:nc);this.y5=new jj(C)}serialize(C){const Ca=
C.sourceItem,qb={};let nc=this.$Mb.LK(Ca);if(nc)qb.synchronousResult=nc,C.isFromCache=!0,C.clientSideCopyTime=C.commandParameters.stopwatch.Ci;else{let id=null;var Rc=Qa.K(Ca.ranges);if(!rc.a.G0f()&&this.K2a(Rc)){E.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Rc=ta.EwaSettings.mWd()?new oi.a(this.da,Rc):this.clipboardRangeFactory.create(Rc);try{id=Rc.toString(),nc=this.v0.create(),nc.setItem(Nc.a.plainText,
id),this.$Mb.setValue(Ca,nc),qb.synchronousResult=nc,C.clientSideCopyTime=C.commandParameters.stopwatch.Ci}finally{Rc&&Rc.dispose()}}else C.isAsyncCopy=!0,qb.synchronousResult=this.v0.create(),qb.synchronousResult.setItem(Nc.a.plainText,this.bKb);qb.asynchronousResult=this.v_a(C,Ca,id)}C.syncClipboardItemsKeys=vd(qb.synchronousResult);return qb}shouldWaitForCopyToComplete(C){if(!C||!C.copyContextSnapshot)return E.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),
!1;E.ULS.shipAssertTag(537167906,0,!!this.$.ua,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(C.copyContextSnapshot.sessionId===this.$.ua.UserSessionId)return E.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;E.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(C){this.y5.onDeferredPasteStarted(C)}onDeferredPasteCompleted(C){this.y5.onDeferredPasteCompleted(C)}deserialize(C){var Ca;
C.isClipboardDataContainShadowWorkbook=!(void 0===C.clipboardItems.getItem(Nc.a.shadowWorkbook)||null===C.clipboardItems.getItem(Nc.a.shadowWorkbook));if(ha.f(this.$).ha.Hk&326)return zd(C)&&(C.wasLastCopyExternal=!0),Promise.reject(new dd(17));var qb=this.M9g(C,!1);if(0!==qb)return Promise.reject(new dd(zd(C)?18:C.isSameSession?19:20,void 0,void 0,void 0,qb));qb=C.copyContextSnapshot;var nc=this.nA.RCc(qb);if(zd(C)||(null===(Ca=C.copyContextSnapshot)||void 0===Ca?0:Ca.sourceItem)&&Tb(C.copyContextSnapshot.sourceItem))return this.jSc(C);
Ca=C.commandParameters.originalDestinations;if(nc&&C.isSameSession)return this.v7j(C,qb,nc,Ca);if(516!==C.commandParameters.commandType){let Rc=null;if((()=>{let id=this.jbc(C.clipboardItems);({MN:Rc}=id);return id})().returnValue)return C.isShadowWorkbookParsedSuccessfully=!0,nc=qb=null,ta.EwaSettings.getBooleanFeatureGate(eb.a.JNb,!1)?qb=Qa.t(Ca,this.$):nc=Qa.x(Qa.R(Ca),this.$),this.O6j(C,nc,qb,Rc);if(C.isClipboardInaccessible)return Promise.reject(new dd(8));if(36!==C.commandParameters.commandType)return this.ede(C)}return Promise.reject(new dd(6))}beforePaste(C){oa.De.Ma()?
ka.a.lh(oa.De).PMg(C):this.$.qa.zh(373).PMg(C);C.indicationDisplayScheduled=!0}Fze(C){let Ca;if(!(C&&C.SourceRanges&&C.SourceRanges.Ranges&&C.SourceRanges.Ranges.length&&(C.OriginalSourceRangesCountExceedsLimit||C.OriginalSourceMultiRange&&C.OriginalSourceMultiRange.Ranges&&C.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,MN:null};var qb=C.SourceRanges.Ranges[0];if(!C.ShadowWorkbookBase64&&!C.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,MN:null};Ca=this.MAd(C);Ca.rangeRowStart=
qb.FirstRow;Ca.rangeRowEnd=qb.LastRow;Ca.rangeColumnStart=qb.FirstColumn;Ca.rangeColumnEnd=qb.LastColumn;Ca.sourceClientPath=C.SourceClientPath;Ca.sourceSheetName=C.SourceSheetName;Ca.sourceWorkbookName=C.SourceWorkbookName;if(!C.OriginalSourceRangesCountExceedsLimit)for(C=C.OriginalSourceMultiRange.Ranges,Ca.originalSourceRanges=Array(C.length),qb=0;qb<C.length;++qb)Ca.originalSourceRanges[qb]=[C[qb].FirstRow,C[qb].FirstColumn,C[qb].LastRow,C[qb].LastColumn];return{returnValue:!0,MN:Ca}}jbc(C){let Ca;
Ca=null;C=C.getItem(Nc.a.shadowWorkbook);if(!C)return{returnValue:!1,MN:Ca};Ca=JSON.parse(C);return{returnValue:this.K0d(Ca),MN:Ca}}v_a(C,Ca,qb){E.ULS.shipAssertTag(537167901,0,!!C,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const nc=C.commandParameters.stopwatch.Ci,Rc=Qa.w(Ca.sheetName,null,Ca.ranges);return new Promise((id,sd)=>{E.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${C.id}`);
this.nA.copy(Rc,C.commandParameters,Fd=>{C.requestTelemetryData=Fd.RequestTelemetryData;C.serverRequestTimeInMs=C.commandParameters.stopwatch.Ci-nc;if(he.a.ll(Fd.Errors))if(he.a.Hua(Fd.Errors))C.encounteredDeploymentErrors=!0,Fd=he.a.fi(Fd.Errors),E.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Fd}. copy Id: ${C.id}`);else{var S=he.a.fi(Fd.Errors);if(he.a.oo(Fd.Errors,
[-591377245])){var Ua=this.ME(Rc);if(Ua){Ua=String.format(this.Xq.sh(218),Ua.toLocaleUpperCase());var Hb=Fd.Errors.findIndex(Bd=>-591377245===Bd.MessageId);Fd.Errors[Hb].Description=Ua;E.ULS.sendTraceTag(509125507,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${C.id}`)}}E.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${S}. copy Id: ${C.id}`);
sd(new Dh(2,Fd.Errors))}else if(E.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${C.id}`),C.markForCancellation)sd(new Dh(3,Fd.Errors));else{var Ec=Fd.Result;Ua=Ec.PlainTextResult;void 0!==qb&&null!==qb&&(Ua=qb);void 0!==Ua&&null!==Ua&&(C.plainTextPayloadSize=Ua.length);S=this.v0.create();var cd;(()=>{let Bd=this.Fze(Ec);({MN:cd}=Bd);return Bd})().returnValue&&(C.shadowWorkbookPayloadSize=Bi(cd),C.shadowWorkbookSizeExceedsLimit=
Ci(cd),C.originalSourceRangesCountExceedsLimit=Ec.OriginalSourceRangesCountExceedsLimit,Hb=JSON.stringify(cd),S.setItem(Nc.a.shadowWorkbook,Hb));S.setItem(Nc.a.plainText,Ua);rc.a.G0f()&&(Ua=Ec.HtmlResult,C.htmlSizeExceedsLimit=Ec.HtmlSizeExceedsLimit,void 0!==Ua&&null!==Ua&&(C.htmlPayloadSize=Ua.length),S.setItem(Nc.a.html,Ua));C.copyTotalSizeExceedsLimit=Ec.CopyTotalSizeExceedsLimit;S.setItem(Nc.a.Btc,C.commandParameters.id);this.$Mb.setValue(Ca,S);C.asyncClipboardItemsKeys=vd(S);id(S);ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&(S=1===C.commandParameters.commandType?8:7,(Ua=ka.a.lh(oa.ve))&&Ua.Nja(S,Fd))}},Fd=>{C.serverRequestTimeInMs=C.commandParameters.stopwatch.Ci-nc;Fd=gb.a.$j(Fd.data);const S=he.a.fi(Fd);E.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${S}. copy Id: ${C.id}`);sd(new Dh(2,Fd))},[C.commandParameters.stopwatch])})}K0d(C){return!!C&&(!!C.shadowWorkbookBase64||C.shadowWorkbookSizeExceedsLimit)&&void 0!==C.rangeRowStart&&
void 0!==C.rangeRowEnd&&void 0!==C.rangeColumnStart&&void 0!==C.rangeColumnEnd}O6j(C,Ca,qb,nc){E.ULS.shipAssertTag(537167903,0,!!nc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");C.pasteResult="CrossSessionPaste";C.payloadOrigin=kh.dBd;C.payloadType=bc.shadowWorkbook;C.shadowWorkbookPayloadSize=Bi(nc);C.shadowWorkbookSizeExceedsLimit=Ci(nc);C.cseStatus=3;nc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(C.originalSourceRangesCountExceedsLimit=
nc.originalSourceRangesCountExceedsLimit);if(C.shadowWorkbookSizeExceedsLimit)return E.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${C.shadowWorkbookPayloadSize}) is over the limit(${Wb.a.HNc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${nc.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new dd(1));if(1028===C.commandParameters.commandType&&C.originalSourceRangesCountExceedsLimit)return E.ULS.sendTraceTag(572617859,
0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${nc.originalSourceRangesCount}) is over the limit(${Wb.a.mGj}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${nc.originalSourceRangesCountExceedsLimit}`),Promise.reject(new dd(1));E.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${C.commandParameters.id}`);return this.nA.Evg(C.commandParameters.ribbonCommandInfo,
Ca,qb,nc,[C.commandParameters.stopwatch],C)}ME(C){return null==C||null==C.Ranges||0===C.Ranges.length?(E.ULS.sendTraceTag(509125506,0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===C.Ranges.length?Qa.F(C.Ranges[0]):Qa.K(Qa.h(C.Ranges))).toString()}}Object(K.a)(og,"AcrossSessionRangeCopyPasteHandler",Ih,[]);var Jh=a(1325);class rj{constructor(C,Ca,qb,nc,Rc,id,sd){this.floatingObjectId=C;this.commandParameters=Ca;this.FQ=qb;this.Zbi=nc;this.Gwa=void 0===id?null:
id;this.jCe=void 0===sd?null:sd;this.o4h=Rc}}Object(K.a)(rj,"CopyArtRequest",null,[]);class ei{constructor(C,Ca,qb,nc,Rc,id,sd,Fd,S){this.promise=null;this.ribbonCommandInfo=C;this.destination=Ca;this.eqf=qb;this.jCe=Rc;this.MN=id;this.item=sd;this.pasteContext=Fd;this.$3a=qb||Ca.FirstRow+"_"+Ca.FirstColumn;this.c1f=!0;this.hhf=S}}Object(K.a)(ei,"PasteArtRequest",null,[]);class Bj{constructor(C,Ca){this.K6b=new df.a;this.pWa=C;this.$=Ca;this.Ick=qb=>Promise.resolve(qb);this.w2b=qb=>Promise.reject(qb)}U5i(C){if(this.$pj(C.$3a)){E.ULS.sendTraceTag(537167681,
5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${C.$3a}`);const Ca=this.K6b.ma(C.$3a);this.K6b.ga(C.$3a,C);const qb=Ca.promise;Ca.c1f=!1;return this.xmi(C,qb)}this.K6b.ga(C.$3a,C);return this.xxj(C)}$pj(C){return this.K6b.mh(C)}xxj(C){return new Promise((Ca,qb)=>{C.promise=this.pWa.yvg(C).then(nc=>{Ca(null);return this.HQc(C,nc)},nc=>{qb(null);return this.w2b(nc)})})}xmi(C,Ca){return new Promise((qb,nc)=>{C.promise=Ca.then(Rc=>{this.Lal(C,
Rc);return this.pWa.yvg(C).then(id=>{qb(null);return this.HQc(C,id)},id=>{nc(null);return this.w2b(id)})},Rc=>this.w2b(Rc))})}HQc(C,Ca){C.c1f&&(this.DYh(C.$3a),this.Ooe(C,Ca));return this.Ick(Ca)}DYh(C){this.K6b.remove(C)}Ooe(C,Ca){const qb=this.lXi();C.$3a===qb&&this.pWa.Ooe(C.destination,Ca,C.item.type)}lXi(){var C=ha.f(this.$).ha.$a.activeFloatingObjectControlId;C||(C=Qa.x(ha.f(this.$).ha.pa.activeCell,this.$),C=C.FirstRow+"_"+C.FirstColumn);return C}Lal(C,Ca){C.destination=null;C.eqf=Ca}}Object(K.a)(Bj,
"PasteArtRequestManager",null,[]);var Ch=a(213);class Cj extends ij{constructor(C,Ca,qb,nc,Rc){Rc=void 0===Rc?null:Rc;super(C,"ArtCopyPasteHandler");this.vZh="XLO";this.wZh="3";this.y5=new jj(C);this.v0=Ca;this.pWa=qb;this.ha=ha.f(C).ha;this.ztc=Rc||new wh(this.v0);this.P6j=new Bj(qb,C);this.aKb=nc}getSourceItem(){E.ULS.shipAssertTag(537167896,0,!!this.ha.$a.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");E.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ha.$a.activeFloatingObjectControlId}]`);
return new Vb(this.ha.$a.activeFloatingObjectControlId,this.$.fa.la.sheetName,this.$.fa.yk,this.$.ua.UserSessionId,this.ha.$a.Ih.floatingObject.type)}beforeSerialize(C){C&&C.commandParameters?(Wh(C),C.commandParameters.copyPasteTargetType=2):E.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(C){const Ca=C.sourceItem,qb={};if(!Ca)return E.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),
qb;if(!this.ltj())return E.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),qb;E.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${Ca.activeFloatingObjectControlId}]`);this.Fee();let nc=this.ztc.LK(Ca);if(nc)qb.synchronousResult=nc,C.isFromCache=!0,C.isAsyncCopy=!1,C.clientSideCopyTime=C.commandParameters.stopwatch.Ci,1===C.commandParameters.commandType&&
this.$.oi(2045211913,C.commandParameters.ribbonCommandInfo.method,C.commandParameters.ribbonCommandInfo.jk,null);else{C.isFromCache=!1;C.isAsyncCopy=!0;nc=this.v0.create();if(C.commandParameters.uploadToClipService){const Rc={};Rc["data-clipservice-ccpid"]=C.commandParameters.id;Rc["data-pkey"]=C.commandParameters.pKey;Rc["data-clipservice-type"]=C.commandParameters.clipServiceDataType;Rc["data-clipservice-count"]=C.commandParameters.objectCount.toString();Rc["data-clipservice-dc"]=C.commandParameters.clipServiceDataCenter;
Rc["data-clipservice-client"]=this.vZh;Rc["data-TimeStamp"]=(new Date).toUTCString();Rc["data-clipservice-version"]=this.wZh;nc.setItem(Nc.a.OGh,JSON.stringify(Rc))}rc.a.Pya()?(qb.synchronousResult=this.nZi(nc),qb.asynchronousResult=this.$Fi(C,Ca,nc)):(qb.synchronousResult=this.V3e(nc),qb.asynchronousResult=this.v_a(C,Ca,nc))}C.syncClipboardItemsKeys=vd(qb.synchronousResult);return qb}nZi(C){return this.ha.$a.Ih.floatingObject.W6?(C.setItem(Nc.a.plainText,this.bKb),C):this.V3e(C)}V3e(C){E.ULS.shipAssertTag(537167891,
0,!!this.ha.$a.Ih,"Expecting a floating object to be currently selected for copy");C||(C=this.v0.create());const Ca=this.ha.$a.Ih.CRb();Ca&&C.setItem(Nc.a.html,`<img src='${Ca}'>`);return C}Fee(){const C=this.ha.$a.Ih;this.aKb.Fee(sg.a.Lhb(C.floatingObject),sg.a.yZh(C.Iz))}shouldWaitForCopyToComplete(){E.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(C){this.y5.onDeferredPasteStarted(C)}onDeferredPasteCompleted(C){this.y5.onDeferredPasteCompleted(C)}deserialize(C){var Ca=
zd(C),qb=null;let nc=null;var Rc=!1;if(!Ca){qb=C.copyContextSnapshot;nc=qb.sourceItem;if(!nc)return Promise.reject(new dd(10));Rc=nc.isFromCurrentSession(this.$)}var id=this.M9g(C,!0);if(0!==id)return Promise.reject(new dd(Ca?18:Rc?19:20,void 0,void 0,void 0,id));if(Ca)return this.jSc(C);if(!Rc&&!Cj.ckj(nc))return C=`User attempted to paste art of type [${nc.type}] between sessions.`,E.ULS.sendTraceTag(537167889,0,50,C),Promise.reject(new dd(11,void 0,void 0,C));if(qb.isAsyncSerializeFailed)return Promise.reject(new dd(16,
void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let sd;try{const Fd=C.clipboardItems.getItem(Nc.a.shadowWorkbook);if(rc.a.Pya()&&!Fd&&1===nc.type)return this.Kbk(C);sd=JSON.parse(Fd)}catch(Fd){return C=copyPasteInfra.getStringifiedError(Fd),E.ULS.sendTraceTag(507798424,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${C}`),Promise.reject(new dd(12,void 0,Fd))}sd.floatingObjectId!==nc.activeFloatingObjectControlId?
E.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${nc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${sd.floatingObjectId}]`):E.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${nc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${sd.floatingObjectId}]`);if(!sd||
!sd.shadowWorkbookBase64)return Promise.reject(new dd(13,void 0,void 0,`shadowWorkbookPayload is null = ${!sd}`));C.isShadowWorkbookParsedSuccessfully=!0;C.shadowWorkbookPayloadSize=Bi(sd);C.shadowWorkbookSizeExceedsLimit=Ci(sd);C.payloadOrigin=Rc?kh.RLg:kh.dBd;C.payloadType=bc.Vdh;C.cseStatus=0;if(Ci(sd))return C=`Shadow workbook size [${C.shadowWorkbookPayloadSize}] is over the limit [${Wb.a.HNc}]. ShadowWorkbookSizeExceedsLimit: ${sd.shadowWorkbookSizeExceedsLimit}`,E.ULS.sendTraceTag(36304156,
0,15,`ArtCopyPasteHandler.Deserialize: ${C}`),Promise.reject(new dd(1,void 0,void 0,C));qb=Ca=null;ha.f(this.$).ha.Hk&326?qb=ha.f(this.$).ha.$a.activeFloatingObjectControlId:Ca=this.$.la&&this.$.la.activeCell?Qa.x(this.$.la.activeCell,this.$):Qa.x(Qa.R(C.commandParameters.originalDestinations),this.$);Rc||!ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&!ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)||
(C.ArtSourceItemType=Jh.a[nc.type],E.ULS.sendTraceTag(508422155,0,20,`User is attempting to paste art of type [${nc.type}] between sessions.`));Rc=null;if(this.aKb.oUg(nc))try{Rc=this.aKb.EDd(),C.cseStatus=1}catch(Fd){C.cseStatus=15,id=copyPasteInfra.getStringifiedError(Fd),E.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${id}`)}else C.cseStatus=26;return this.P6j.U5i(new ei(C.commandParameters.ribbonCommandInfo,
Ca,qb,C.commandParameters.commandType,[C.commandParameters.stopwatch],sd,nc,C,Rc))}jSc(C){C.wasLastCopyExternal=!0;if(C.clipboardItems.getItem("image/png")){const Ca=C.commandParameters.stopwatch.Ci;C.payloadType=bc.INh;return Tc.c(this.$.oi(1403967063,C.commandParameters.ribbonCommandInfo.method,C.commandParameters.ribbonCommandInfo.jk,{["dataUrl"]:C.clipboardItems.getItem("image/png")})).then(qb=>{C.serverRequestTimeInMs=C.commandParameters.stopwatch.Ci-Ca;return qb?Promise.resolve(null):Promise.reject(new dd(15))},
()=>{C.serverRequestTimeInMs=C.commandParameters.stopwatch.Ci-Ca;return Promise.reject(new dd(15))})}E.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return super.jSc(C)}Kbk(C){try{const Ca=C.clipboardItems.getItem(Nc.a.html);return this.i5f(Ca)?this.zvg(C,Ca,null):Promise.reject(new dd(23))}catch(Ca){return C=copyPasteInfra.getStringifiedError(Ca),E.ULS.sendTraceTag(507782405,0,10,`ArtCopyPasteHandler.processClipboardHtml: Failed to process clipboard html with exception: ${C}`),
Promise.reject(new dd(24,void 0,Ca))}}ltj(){const C=ha.f(this.$).ha;return C.$a.activeFloatingObjectControlId&&C.$a.Ih&&C.$a.Ih.floatingObject?C.$a.Ih.floatingObject.Wwe():!1}$Fi(C,Ca,qb){return this.ha.$a.Ih.floatingObject.W6?new Promise((nc,Rc)=>{const id=this.aGi(C,qb),sd=this.v_a(C,Ca,qb);void Promise.allSettled([id,sd]).then(Fd=>{var [S,Ua]=Fd;"rejected"===S.status?(1===C.commandParameters.commandType&&this.pWa.W4g(Ca.type,Ca.activeFloatingObjectControlId),Rc(S.reason)):("rejected"===Ua.status&&
E.ULS.sendTraceTag(507811728,0,50,`ArtCopyPasteHandler.getAsyncData: Promise fetching data from server has failed with error ${Ua.reason}. Proceeding with resolving clipboard items from asyncArtData.`),Fd=S.value,this.ztc.setValue(Ca,Fd),nc(Fd))})}):this.v_a(C,Ca,qb)}aGi(C,Ca){return new Promise((qb,nc)=>{const Rc=this.ha.$a.Ih;Rc.tlb().continueWith(id=>{var sd;try{const Fd=id.result;Ca.setItem(Nc.a.plainText,"");if(Fd){const S=new Image;S.src=Fd;Ca.setItem(Nc.a.html,Bc.b(S))}else return E.ULS.sendTraceTag(507811727,
0,15,`ArtCopyPasteHandler.getAsyncImageData: Base64 URL of picture is null. ArtSourceItem id: ${Rc.floatingObject.wi}`),nc(new Dh(4));C.asyncClipboardItemsKeys=vd(Ca);qb(Ca)}catch(Fd){id=null===(sd=null===Rc||void 0===Rc?void 0:Rc.floatingObject)||void 0===sd?void 0:sd.wi,E.ULS.sendTraceTag(507811726,0,10,`ArtCopyPasteHandler.getAsyncImageData: Failed to fetch base64 URL of picture. ArtSourceItem id: ${id}. Exception: ${Fd}`),nc(new Dh(4))}})})}v_a(C,Ca,qb){return new Promise((nc,Rc)=>{const id=C.commandParameters.stopwatch.Ci,
sd=this.ha.$a.Ih;E.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.pWa.r4h(new rj(Ca.activeFloatingObjectControlId,C.commandParameters,Fd=>{var S;C.requestTelemetryData=Fd.RequestTelemetryData;C.serverRequestTimeInMs=C.commandParameters.stopwatch.Ci-id;if(he.a.ll(Fd.Errors))if(he.a.Hua(Fd.Errors))C.encounteredDeploymentErrors=!0,Fd=he.a.fi(Fd.Errors),E.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Fd}`);
else{var Ua=he.a.fi(Fd.Errors);E.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Ua}`);Rc(new Dh(4,Fd.Errors))}else if(E.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${Ca.activeFloatingObjectControlId}].`),C.markForCancellation)Rc(new Dh(3,Fd.Errors));else{if(he.a.Qx(Fd.Errors)){var Hb=he.a.fi(Fd.Errors);E.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${Hb}`)}if(Hb=
Fd.Result){Hb=this.MAd(Hb);Hb.floatingObjectId=Ca.activeFloatingObjectControlId;C.shadowWorkbookPayloadSize=Bi(Hb);C.shadowWorkbookSizeExceedsLimit=Ci(Hb);try{Ua=JSON.stringify(Hb)}catch(Ec){Rc(new dd(14,void 0,Ec,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${C.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${Hb.floatingObjectId}]`));return}E.ULS.shipAssertTag(537167881,0,!!qb,"Expecting syncClipboardItems to be defined");rc.a.Pya()&&(null===
(S=null===sd||void 0===sd?void 0:sd.floatingObject)||void 0===S?0:S.W6)?(S=new Blob([Ua]),1048576<S.size?E.ULS.sendTraceTag(507798425,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: ShadowWorkbookPayload size is ${S.size} for floating object id ${sd.floatingObject.wi}. Ignoring shadow workbook to avoid failure in saving to local storage.`):qb.setItem(Nc.a.shadowWorkbook,Ua)):qb.setItem(Nc.a.shadowWorkbook,Ua);1===C.commandParameters.commandType&&(this.$$j(Ca.type,Ca.activeFloatingObjectControlId,
Fd.StateId),this.deleteFloatingObject(Ca.activeFloatingObjectControlId,Ca.type));this.ztc.setValue(Ca,qb);C.asyncClipboardItemsKeys=vd(qb);nc(qb)}else E.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${Ca.activeFloatingObjectControlId}`),nc(this.ztc.LK(Ca))}},C.commandParameters.commandType,Ca.type,Fd=>{C.serverRequestTimeInMs=C.commandParameters.stopwatch.Ci-id;Fd=gb.a.$j(Fd.data);1!==C.commandParameters.commandType||
rc.a.Pya()&&sd.floatingObject.W6||this.pWa.W4g(Ca.type,Ca.activeFloatingObjectControlId);const S=he.a.fi(Fd);E.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${S}`);Rc(new Dh(4,Fd))},[C.commandParameters.stopwatch]))})}deleteFloatingObject(C,Ca){C=Ch.a.mH(Ca,C);if(C=cb.a(this.$).Xx(C))cb.a(this.$).deleteFloatingObject(C,14,!0),ha.f(this.$).ha.$a.AK=null}$$j(C,Ca,qb){const nc=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?
ka.a.lh(oa.Pg):this.$.qa.zh(277);if(nc){let id=null;C=Ch.a.mH(C,Ca);C=cb.a(this.$).Xx(C);if(null===C||void 0===C?0:C.Zp)id=C.Zp.block;if(id){var Rc=C.floatingObject.Hn();nc.Vmc(()=>!id.cp.mh(Rc),qb,"CutArt")}}}static ckj(C){return 1===C.type||5===C.type||ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&0===C.type||ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)&&8===C.type}}Object(K.a)(Cj,"ArtCopyPasteHandler",
ij,[]);class sj extends Mi{constructor(C,Ca,qb,nc){super(C);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=Ca;this.top=qb;this.left=nc}}Object(K.a)(sj,"MacroRecorderPasteArtPayload",Mi,[]);class Md{constructor(C,Ca){this.$=C;this.aKb=Ca}gbj(C,Ca,qb,nc,Rc,id,sd){id=void 0===id?null:id;sd=void 0===sd?null:sd;const Fd=this.$.oa.ta.Wh();let S=null;const Ua={CopyPasteTargetType:2};Ua.FloatingObjectId=C;Ua.CopyOperationId=qb.id;qb.floatingObjectType=Ca;Ua.UploadToClipService=
qb.uploadToClipService;Ua.PKey=qb.pKey;Ua.ClipServiceDataCenter=qb.clipServiceDataCenter;let Hb=0;2===Rc?(Rc=505,Hb=16,S=(Ec,cd,Bd)=>Wi(this.$.oa.ta,Ua,gc.c(Ec,nc),id?gc.b(cd,id):cd,Bd,qb.ribbonCommandInfo,Fd,sd)):(Rc=179,S=(Ec,cd,Bd)=>{this.jii(Ca,C);this.$.eD();var ce=this.$.oa.ta;Ec=gc.c(Ec,nc);cd=id?gc.b(cd,id):cd;var Fe=qb.ribbonCommandInfo,Ue=sd;Ue=void 0===Ue?null:Ue;const pf=ce.Za(1,void 0===Fd?null:Fd);pf.copyParameters=Ua;return Dc.h(ce,"Cut",pf,Ec,cd,Bd,Fe,0,Ue)});this.$.userOperationManager.enqueueOperation(new od.a(Rc,
0,S,Hb|64),qb.ribbonCommandInfo)}jii(C,Ca){var qb=Ch.a.mH(C,Ca);(qb=cb.a(this.$).Xx(qb))?(ha.f(this.$).ha.$a.iP(qb),qb.isVisible=!1):E.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${C}, FloatingObjectId: ${Ca}`)}W4g(C,Ca){C=Ch.a.mH(C,Ca);if(C=cb.a(this.$).Xx(C))C.isVisible=!0}r4h(C){this.gbj(C.floatingObjectId,C.o4h,C.commandParameters,C.FQ,C.Zbi,C.Gwa,C.jCe)}Nbj(C,Ca,qb,nc,Rc,id,sd,Fd,S){Fd=void 0===Fd?null:Fd;S=void 0===
S?!0:S;return new Promise((Ua,Hb)=>{const Ec=id.commandParameters.stopwatch.Ci;this.npe(C,Rc,Ca,qb,cd=>{id.requestTelemetryData=cd.RequestTelemetryData;id.serverRequestTimeInMs=id.commandParameters.stopwatch.Ci-Ec;if(he.a.Hua(cd.Errors))id&&(id.encounteredDeploymentErrors=!0),cd=he.a.fi(cd.Errors),E.ULS.sendTraceTag(537167875,0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${cd}`);else if(he.a.ll(cd.Errors)){var Bd=he.a.fi(cd.Errors);
E.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Bd}`);Hb(new dd(9,cd.Errors))}else cd.Result?(Bd=cd.Result,E.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.nak(sd,Bd.FloatingObjectId,cd.StateId),Ua(Md.NTd(Bd.FloatingObjectId))):(E.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Hb(new dd(9,cd.Errors)))},cd=>{id.serverRequestTimeInMs=id.commandParameters.stopwatch.Ci-
Ec;cd=gb.a.$j(cd.data);E.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${he.a.fi(cd)}`);Hb(new dd(9,cd))},nc,Fd,S)})}nak(C,Ca,qb){const nc=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?ka.a.lh(oa.Pg):this.$.qa.zh(277);if(nc){const Rc=Ch.a.mH(C,Md.NTd(Ca));nc.Vmc(()=>!!cb.a(this.$).Xx(Rc),qb,"PasteArt")}}fAe(C,Ca){Ca&&this.aKb.fAe(C,Ch.a.mH(C.type,Ca))}yvg(C){return this.Nbj(C.ribbonCommandInfo,C.destination,C.eqf,
C.jCe,C.MN,C.pasteContext,C.item.type,C.hhf,C.item.isFromCurrentSession(this.$)).then(Ca=>Ca,Ca=>{this.fAe(C.item,C.hhf);return Promise.reject(Ca)})}Ooe(C,Ca,qb){C||(C=Qa.x(ha.f(this.$).ha.pa.activeCell,this.$));ha.f(this.$).FJc(Qa.H(C),1)?cb.a(this.$).IPa(qb,Ca,!0):ha.f(this.$).ha.$a.mXa(C,Ca,qb).continueWith(nc=>{nc.result?E.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${Ca}]`):E.ULS.sendTraceTag(537167842,5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${Ca}]`)})}npe(C,
Ca,qb,nc,Rc,id,sd,Fd,S){S=void 0===S?!0:S;const Ua=this.$.oa.ta.Wh(),Hb={};Hb.ShadowWorkbookBase64=Ca.shadowWorkbookBase64;Hb.FloatingObjectId=nc;Hb.DestinationRanges=qb?Qa.u(qb):null;Hb.CopyPasteTargetType=2;Hb.ClientEstimationFloatingObjectId=Fd;qb=new od.a(503,0,(Ec,cd,Bd)=>{Fd||this.$.eD();return wi(this.$.oa.ta,Hb,gc.c(Ec,Rc),gc.b(cd,id),Bd,null,Ua,sd)},void 0,()=>{if(S){let Ec;Ec=R.a.Vp(R.a.Di(Hb));Ec.FloatingObjectId=Ca.floatingObjectId;Hb.DestinationRanges||(Ec.DestinationRanges=Qa.r(this.$.sa.la.sheetName,
"",0,0,0,0));return new sj(Ec,S,0,0)}return new sj(Hb,S,0,0)});qb.flags=65;this.$.userOperationManager.enqueueOperation(qb,C)}static NTd(C){return`${C.length+2}.{${C.toUpperCase()}}`}}Object(K.a)(Md,"ArtCopyPasteUtils",null,[909]);var ve=a(209);class Oi{constructor(C){this.rzd=this.OHa=null;this.Ntb=15;this.$=C}Fee(C,Ca){this.OHa=C;this.rzd=Ca}EDd(){if(!this.OHa||!this.rzd)return E.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";const C=sg.a.Lhb(new Ch.a(this.OHa));C.Id=Md.NTd(Zb.a.create().toString());C.Version=-1;C.Name="";C.IsClientEstimation=!0;var Ca=this.pdj(C);if(!Ca)return null;const qb=new Ch.a(C);Ca.block.cp.add(qb);qb.hwb();const nc=cb.a(this.$);nc.Jtc(qb,Ca);Ca=nc.Xx(Ch.a.vOi(C));!Ca||Ca.floatingObject.XK||Ca.floatingObject.S2a||Ca.v8a(this.rzd);nc.IPa(C.Type,C.Id,!0);return C.Id}oUg(C){return ta.EwaSettings.Na(205)&&C.isFromCurrentSession(this.$)&&!ha.f(this.$).rtl&&!ha.f(this.$).fh.vp}fAe(C,Ca){this.oUg(C)&&
(C=cb.a(this.$).Xx(Ca))&&(E.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${Ca}] of type [${C.floatingObject.type}]`),cb.a(this.$).deleteFloatingObject(C,15,!0),C.Zp&&C.zvb(C.Zp,!1))}pdj(C){if(!C)return E.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(ha.f(this.$).ha.$a.activeFloatingObjectControlId){var Ca=
ha.f(this.$).ha.$a.AK.floatingObject;C.OriginDeltaX=Ca.offsetX+this.Ntb;C.OriginDeltaY=Ca.offsetY+this.Ntb;C.AbsoluteLeft+=this.Ntb;C.AbsoluteTop+=this.Ntb;C.AbsoluteRight+=this.Ntb;C.AbsoluteBottom+=this.Ntb;C.ZOrder=Ca.TJ+1;return ha.f(this.$).ha.$a.AK.Zp}if(!this.$.la||!this.$.la.activeCell)return E.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var qb=this.$.la.activeCell;
Ca=ha.f(this.$).OW(qb);if(!Ca)return E.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${qb.toString()} is null.`),null;const nc=wd.HelperMethods.kOd(Ca.domElement,Ca.Lr.domElement);qb=Ca.da.Hl(qb,2);if(!nc||!qb)return E.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!nc}. cellPositionRelativeToGridOrigin is null: ${!qb} .`),null;C.OriginDeltaX=
qb.topLeft.x-nc.x;C.OriginDeltaY=qb.topLeft.y-nc.y;C.AbsoluteLeft=qb.topLeft.x;C.AbsoluteTop=qb.topLeft.y;C.AbsoluteRight=C.AbsoluteLeft+Math.abs(this.OHa.AbsoluteRight-this.OHa.AbsoluteLeft);C.AbsoluteBottom=C.AbsoluteTop+Math.abs(this.OHa.AbsoluteBottom-this.OHa.AbsoluteTop);C.ZOrder=this.OHa.ZOrder+100;return new ve.a(Ca.da.za.ro(Ca.hashCode),Ca.hashCode)}}Object(K.a)(Oi,"ArtPasteClientEstimation",null,[908]);class nh{create(){const C=window.clipboardPlatform;return C?C.createClipboardItems():
null}}Object(K.a)(nh,"ClipboardItemsFactory",null,[907]);class ii{}ii.undefined="Undefined";Object(K.a)(ii,"CCPTelemetryConsts",null,[]);class Ei{}Ei.cells="Cells";Ei.floatingObject="FloatingObject";Ei.unknown="Unknown";Object(K.a)(Ei,"ActiveSelection",null,[]);class tj extends og{constructor(C,Ca,qb,nc){super(C,Ca,qb,void 0===nc?null:nc);this.$Xa=null}beforePaste(){E.ULS.sendTraceTag(508121693,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(C){C.isClipboardDataContainShadowWorkbook=
!(void 0===C.clipboardItems.getItem(Nc.a.shadowWorkbook)||null===C.clipboardItems.getItem(Nc.a.shadowWorkbook));const Ca=C.commandParameters.originalDestinations;if(!C.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let qb=null;if((()=>{let nc=this.jbc(C.clipboardItems);({MN:qb}=nc);return nc})().returnValue){C.isShadowWorkbookParsedSuccessfully=!0;let nc=null,Rc=null;ta.EwaSettings.getBooleanFeatureGate(eb.a.JNb,!1)?nc=Qa.t(Ca,this.$):Rc=Qa.x(Qa.R(Ca),this.$);return this.m7j(C,Rc,
nc,qb)}return C.isClipboardInaccessible?Promise.reject(new dd(8)):Promise.reject(new dd(6))}get copyPasteInfrastructure(){var C;null!==(C=this.$Xa)&&void 0!==C?C:this.$Xa=this.$.qa.zh(254,!0);return this.$Xa}zfj(C,Ca,qb,nc){return this.copyPasteInfrastructure?Tc.a(this.copyPasteInfrastructure.QUd(null,nc.commandParameters.ribbonCommandInfo,C,Ca,qb,nc)):Promise.reject(new dd(0))}m7j(C,Ca,qb,nc){C.pasteResult="CrossSessionPaste";C.payloadOrigin=kh.dBd;C.payloadType=bc.shadowWorkbook;C.shadowWorkbookPayloadSize=
Bi(nc);C.shadowWorkbookSizeExceedsLimit=Ci(nc);nc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(C.originalSourceRangesCountExceedsLimit=nc.originalSourceRangesCountExceedsLimit);return C.shadowWorkbookSizeExceedsLimit?Promise.reject(new dd(1)):1028===C.commandParameters.commandType&&C.originalSourceRangesCountExceedsLimit?Promise.reject(new dd(1)):this.zfj(Ca,qb,nc,C)}}Object(K.a)(tj,"AcrossSessionInsertCopiedCutCellsHandler",og,[]);class Zi{constructor(C,Ca){this.$=C;this.v0=Ca}get name(){return"NonGridCopyHandler"}getSourceItem(){return new ud(this.$.fa.yk,
this.$.ua.UserSessionId)}beforeSerialize(C){Wh(C);C.commandParameters.copyPasteTargetType=0}serialize(C){const Ca={};if(!C.sourceItem)return E.ULS.sendTraceTag(508074082,0,10,"NonGridCopyHandler.Serialize: sourceItem should not be null"),Ca;C.isFromCache=!1;C.isAsyncCopy=!1;const qb=this.v0.create();Nc.a.plainText in C.commandParameters.clipboardItems&&qb.setItem(Nc.a.plainText,C.commandParameters.clipboardItems[Nc.a.plainText]);Nc.a.html in C.commandParameters.clipboardItems&&qb.setItem(Nc.a.html,
C.commandParameters.clipboardItems[Nc.a.html]);Ca.synchronousResult=qb;return Ca}}Object(K.a)(Zi,"NonGridCopyHandler",null,[899]);class uj extends og{constructor(C,Ca,qb,nc){super(C,Ca,qb,void 0===nc?null:nc)}getSourceItem(){return new di(this.$.fa.la.sheetName,this.$.fa.yk,this.$.ua.UserSessionId)}beforeSerialize(C){C.isFullSheetCopy=!0;super.beforeSerialize(C)}Fze(C){if(!C.ShadowWorkbookBase64&&!C.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,MN:null};const Ca=this.MAd(C);Ca.sourceClientPath=
C.SourceClientPath;Ca.sourceSheetName=C.SourceSheetName;Ca.sourceWorkbookName=C.SourceWorkbookName;return{returnValue:!0,MN:Ca}}v_a(C,Ca){E.ULS.shipAssertTag(507834589,0,!!C,"AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const qb=C.commandParameters.stopwatch.Ci;return new Promise((nc,Rc)=>{E.ULS.sendTraceTag(507815952,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${C.id}`);
this.nA.fullSheetCopy(Ca.sheetName,C.commandParameters,id=>{C.requestTelemetryData=id.RequestTelemetryData;C.serverRequestTimeInMs=C.commandParameters.stopwatch.Ci-qb;if(!he.a.ll(id.Errors)){E.ULS.sendTraceTag(507834588,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for copy Id: ${C.id}`);const sd=this.v0.create();let Fd;const S=id.Result;(()=>{let Ua=this.Fze(S);({MN:Fd}=Ua);return Ua})().returnValue&&(C.shadowWorkbookPayloadSize=Bi(Fd),C.shadowWorkbookSizeExceedsLimit=
Ci(Fd),C.originalSourceRangesCountExceedsLimit=S.OriginalSourceRangesCountExceedsLimit,ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8790502_FullSheetCCPEnhancement")&&!C.shadowWorkbookSizeExceedsLimit&&(id=JSON.stringify(Fd),sd.setItem(Nc.a.shadowWorkbook,id)));sd.setItem(Nc.a.Btc,C.commandParameters.id);this.$Mb.setValue(Ca,sd);C.asyncClipboardItemsKeys=vd(sd);nc(sd)}},id=>{C.serverRequestTimeInMs=C.commandParameters.stopwatch.Ci-qb;id=gb.a.$j(id.data);const sd=he.a.fi(id);E.ULS.sendTraceTag(507834587,
0,10,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${sd}. copy Id: ${C.id}`);Rc(new Dh(2,id))})})}beforePaste(){}deserialize(C){C.isClipboardDataContainShadowWorkbook=!C.clipboardItems.getItem(Nc.a.shadowWorkbook);return C.isClipboardDataContainShadowWorkbook?this.jbc(C.clipboardItems).returnValue?(C.isShadowWorkbookParsedSuccessfully=!0,Promise.resolve(!0)):C.isClipboardInaccessible?Promise.reject(new dd(8)):Promise.reject(new dd(6)):Promise.resolve(!0)}serialize(C){const Ca=
C.sourceItem,qb={},nc=this.$Mb.LK(Ca);nc?(qb.synchronousResult=nc,C.isFromCache=!0,C.clientSideCopyTime=C.commandParameters.stopwatch.Ci):(C.isAsyncCopy=!0,qb.synchronousResult=this.v0.create(),qb.synchronousResult.setItem(Nc.a.plainText,this.bKb),qb.asynchronousResult=this.v_a(C,Ca,null));C.syncClipboardItemsKeys=vd(qb.synchronousResult);return qb}}Object(K.a)(uj,"AcrossSessionFullSheetCopyPasteHandler",og,[]);class $i{constructor(C){this.qhd=this.Tbd=this.Cdd=this.K8c=this.djd=null;this.$=C}get KLj(){!this.qhd&&
this.$.qa.zh(254,!0)&&(this.qhd=new Zi(this.$,new nh));return this.qhd}get Oge(){if(!this.djd){const C=this.$.qa.zh(254,!0);C&&(this.djd=new og(this.$,C,new nh))}return this.djd}get Cfj(){if(!this.Cdd){const C=this.$.qa.zh(254,!0);C&&(this.Cdd=new tj(this.$,C,new nh))}return this.Cdd}get vDf(){if(!this.Tbd){const C=this.$.qa.zh(254,!0);C&&(this.Tbd=new uj(this.$,C,new nh))}return this.Tbd}get Fsd(){if(!this.K8c&&this.$.qa.zh(254,!0)){const C=new Oi(this.$);this.K8c=new Cj(this.$,new nh,new Md(this.$,
C),C)}return this.K8c}getCopyFlowHandler(C){if(-207190267===C.commandParameters.ribbonCommandInfo.command)return this.vDf;if(C.commandParameters.clipboardItems)return this.KLj;const Ca=this.FJi(ha.f(this.$).Hk);C.commandParameters.copyPasteHandlerName=Ca.name;return Ca}getPasteFlowHandler(C){var Ca=C.copyContextSnapshot;switch(C.commandParameters.ribbonCommandInfo.command){case 440556491:return C=this.vDf;case -160032004:case -1065525230:return C=this.Cfj;default:return Ca=fe(C)?this.Fsd:zd(C)?this.Oge:
(null===Ca||void 0===Ca?0:Ca.sourceItem)&&Object.getType(Ca.sourceItem)===Vb?this.Fsd:this.Oge,C.commandParameters.copyPasteHandlerName=Ca.name,Ca}}initializePasteContext(C){if(C){C.isSameSession=!1;C.isShadowWorkbookParsedSuccessfully=!1;C.pasteResult=ii.undefined;C.payloadOrigin=ii.undefined;C.payloadType=ii.undefined;C.encounteredDeploymentErrors=!1;C.shadowWorkbookSizeExceedsLimit=!1;C.originalSourceRangesCountExceedsLimit=!1;C.activeSelectionType=this.TEi();C.indicationDisplayScheduled=!1;C.pasteDestinationHasMergedCells=
!1;C.cseStatus=0;C.pasteIndicationDisplayStatus=rf.rhi;if(ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))C.ArtSourceItemType=ii.undefined;if(C.copyContextSnapshot){var Ca=C.copyContextSnapshot;const sd=mb(Ca.sourceItem);var qb=Ca.sourceItem;var nc=!!qb&&Object.getType(qb)===Vb;qb=0;var Rc=!1;sd?(Rc=Ca.sourceItem,C.isSameSession=Rc.isFromCurrentSession(this.$),
qb=1,Rc=this.cqj(Rc,C)):nc&&(C.isSameSession=Ca.sourceItem.isFromCurrentSession(this.$),qb=2);if(C.copyContextSnapshot.commandParameters){const Fd=-1985798686===Ca.commandParameters.ribbonCommandInfo.command;nc=C.commandParameters;var id=this.$;Ca?id&&id.ua?Ca=Ca.sessionId===id.ua.UserSessionId:(E.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Ca=!1):(E.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Ca=!1);nc.clearSystemClipboard=Ca&&Fd&&sd&&!Rc;C.commandParameters.copyPasteTargetType=
qb}}}}getSessionId(){return this.$.ua.UserSessionId}cqj(C,Ca){const qb=C.ranges.some(nc=>nc.hk)&&Ca.commandParameters.originalDestinations.some(nc=>1!==nc.top);return C.ranges.some(nc=>nc.isRow)&&Ca.commandParameters.originalDestinations.some(nc=>1!==nc.left)||qb}FJi(C){switch(C){case 1:return this.Oge;case 64:case 4:case 2:case 256:return this.Fsd;default:throw Error.invalidOperation("Unsupported selection");}}TEi(){return ha.f(this.$).ha.Hk&470?Ei.floatingObject:1===ha.f(this.$).ha.Hk?Ei.cells:
Ei.unknown}getDialogResponse(){}}Object(K.a)($i,"ExcelCopyPasteApplicationHost",null,[887]);class ji extends Qd.a{constructor(C,Ca){super(C);this.DC=null;this.Bfj=(qb,nc)=>{1===qb?(qb=ji.zgi[nc[ji.ygi]],E.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===qb?"Horizontal":"Vertical"}`),this.DC.setResult(qb)):(E.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),
this.DC.fD())};this.fn(Ca)}get Ji(){return"InsertCopiedCutCellsDialog"}fn(C){this.DC=new Uf.a;const Ca=qa.a.instance.ia(16);C=this.fS(C);this.initializeAndShow(Ca,this.Bfj,C)}fS(C){return{[ji.Gz]:this.Ji,[ji.Orj]:C}}}ji.ygi="direction";ji.Orj="isRtl";ji.zgi={["Vertical"]:1,["Horizontal"]:0};Object(K.a)(ji,"InsertCopiedCutCellsDialog",Qd.a,[]);class ci{Ltc(C,Ca){return(new ji(C,Ca)).DC.task}}Object(K.a)(ci,"InsertCopiedCutCellsDialogFactory",null,[886]);var Tj=a(1231),pi=a(939),ki=a(619);const lh=
()=>{var C=navigator.userAgentData;if(C)for(let Ca=0;Ca<C.brands.length;Ca++){if("Microsoft Edge"===C.brands[Ca].brand&&79<=parseFloat(C.brands[Ca].version))return!0}else if(navigator.userAgent&&(C=navigator.userAgent.match(/(Edg|EdgiOS|EdgA)\/(\d+)/i))&&79<=parseFloat(C[2]))return!0;return!1},qi=C=>{const Ca=eb.a.nij&&!C.isMobileMode,qb=eb.a.oij&&C.isMobileMode&&C.isEditMode;C=C.kk.get(57);return(Ca||qb)&&!C&&!!(navigator&&navigator.clipboard&&navigator.clipboard.read&&navigator.clipboard.write&&
(lh()||Sa.a.$v&&Sa.a.ELa(86)))};class Fi extends Qf.a{constructor(C){super();this.uZh="clipboard-read";this.$=C;this.Xq=qa.a.instance;this.wjj=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8282600_EnableClipboardPermissionLogging");this.sn()}create(){const C=jf.a.q7([75,76],4,this.gi,void 0,void 0,void 0,Fi.m8b),Ca=Object(Tc.d)(ka.a.resolve(oa.zc,{va:this.gi})),qb=Object(Tc.d)(ka.a.resolve(oa.dh)),nc=oa.qd.Ma()?Object(Tc.d)(ka.a.resolve(oa.qd,{va:this.gi})):Of.a.Ua(null),Rc=oa.De.Ma()?Object(Tc.d)(ka.a.resolve(oa.De,
{va:this.gi})):Of.a.Ua(null);Bb.TaskExtensions.$e(Bb.TaskExtensions.Dq([Ca,C,qb,nc,Rc],this.ya),()=>{const id=new Tj.a;let sd=null;this.x1h(id).then(Fd=>{sd=Fd.lhf;const S=copyPasteInfra.createCopyPasteInfra(sd,new $i(this.$),id);E.ULS.shipAssertTag(537167762,0,!!this.$.ua,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");E.ULS.shipAssertTag(537167761,0,!!this.$.ua&&!!this.$.ua.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");
const Ua=sd.getMetadataManager();var Hb=Object(pi.a)(this.$.qa,254,()=>new Gf(this.$,Ua,Ca.result,S,new Zh(this.$,ha.f(this.$)),new ci,this.$.ua.DocumentHostInfo.UserId,sd.getInitializationError(),qb.result,nc.result,Rc.result));this.dl(Hb);if(Fd.Jhb){Hb=Gf.JAc();const Ec=JSON.stringify(Fd.Jhb.dataClipboardCapabilities),cd=Fd.Jhb.clipboardStrategiesToInitialize[0].clipboardStrategyType===Fd.Jhb.dataClipboardStrategyType,Bd=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?
"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();E.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${Hb}, StrategyType=${Fd.Jhb.dataClipboardStrategyType}, StrategyCapabilities=${Ec}, IsBestStrategyTypeInitialized=${cd}, InfraLoadTimeMS=${Bd}`)}else E.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},Fd=>{const S=
Gf.JAc();Fd=Fd?copyPasteInfra.getStringifiedError(Fd):"null";E.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${S} error: ${Fd}`)})},this.ya,3)}dispose(){super.dispose()}x1h(C){var Ca,qb;let nc=null;var Rc=window.clipboardPlatform;Rc&&(nc=Rc.getClipboardPlatformEnvironment(),null===(Ca=Rc.setClipboardPlatformFeatureGateManager)||void 0===Ca?void 0:
Ca.call(Rc,ki.a()));if(!nc)return E.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);Ca=this.$.ua;Rc=[Ca.OfficeOnlineChromeExtensionId,Ca.ChromeClipboardAccessExtensionId];const id=this.Xq.Aa(5),sd=this.$.kk.get(57);let Fd=!sd&&this.$.kk.get(5);var S=this.$.fa.Kh;S&&(S.inWebPart||S.inViewerFromWebPart||S.isDivSyndicated)&&(Fd=!1);(S=qi(this.$))&&E.ULS.sendTraceTag(508703874,
0,50,"CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Async System Clipboard is allowed");try{this.wjj&&(null===(qb=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===qb?0:qb.query)&&navigator.permissions.query({name:this.uZh}).then(Ua=>{E.ULS.sendTraceTag(508151361,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Clipboard read permission state: ${null===Ua||void 0===Ua?void 0:Ua.state}`)}).catch(Ua=>{E.ULS.sendTraceTag(508151360,
0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(Ua)}`)})}catch(Ua){E.ULS.sendTraceTag(508151331,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(Ua)}`)}qb=this.sIi(Fd,!sd,S);E.ULS.shipAssertTag(537167758,0,!!Ca.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");
return nc.init(C,Rc,Ca.SharedClipboardHostingApp,Ca.SharedClipboardHostingApps,Ca.SharedClipboardHostingEnvironments,Ca.SharedClipboardOverrideOrigin,Ca.SharedClipboardSchemaVersion,Ca.SharedClipboardExpirationInMinutes,Ca.ClipboardPromiseTimeoutInMinutes,id,Ca.MachineCluster,new gj(this.$),qb,Ca.DocumentHostInfo.UserId,Ca.ClipboardTtlInMS,ta.EwaSettings.Na(273),Ca.UserSessionId,Ca.BulsEndpointUrl).then(Ua=>Object(nb.a)(new Yh,{lhf:nc,Jhb:Ua}),Ua=>Promise.reject(Ua))}sIi(C,Ca,qb){const nc=[];C&&qb&&
nc.push(this.Hnf(9));C&&Ca&&nc.push(this.Hnf(6));Ca&&(nc.push(this.VAd(7)),nc.push(this.VAd(0)));C&&nc.push(this.Dmf());nc.push({clipboardStrategyType:4});qb=nc?nc.map(Rc=>JSON.stringify(Rc)).join(","):"[]";E.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${C}, isSystemClipboardAllowed=${Ca}, result = ${qb}`);return nc}Dmf(){const C=this.$.ua,Ca={clipboardStrategyType:5};Ca.sessionId=
C.UserSessionId;Ca.useSharedClipboardIframe=!0;Ca.sharedClipboardHostingApp=C.SharedClipboardHostingApp;Ca.sharedClipboardHostingApps=C.SharedClipboardHostingApps;Ca.sharedClipboardHostingEnvironments=C.SharedClipboardHostingEnvironments;Ca.sharedClipboardOverrideOrigin=C.SharedClipboardOverrideOrigin;Ca.sharedClipboardSchemaVersion=C.SharedClipboardSchemaVersion;Ca.sharedClipboardExpirationInMinutes=C.SharedClipboardExpirationInMinutes;Ca.wacCluster=C.MachineCluster;return Ca}Hnf(C){const Ca={};
Ca.clipboardStrategyType=C;Ca.localStorageStrategyParameters=this.Dmf();Ca.systemClipboardStrategyParameters=this.VAd(0);return Ca}VAd(C){const Ca={};Ca.clipboardStrategyType=C;Ca.skipFilesIfPlainTextExists=!0;return Ca}static Ga(C){oa.De.Ma()||C.qa.Rh(373,new Lf(C));C.qa.Rh(Fi.m8b,new Fi(C))}}Fi.m8b=255;Object(K.a)(Fi,"CopyPasteInfrastructureFactory",Qf.a,[]);var Sh=a(9),Dj=a(601);const Pi=Object(ke.b)("Common.App.GestureManager.GestureInputManager"),Uj=Object(ke.c)(Pi);var Ej=a(215),aj=a(447);class Fj{constructor(){this.oqa=
this.BEf=null}}Object(K.a)(Fj,"GestureAdapterInfo",null,[]);var eg=a(663),gf=a(338);class Eh{constructor(){this.jad=null}$yj(){if(!this.jad){var C="hammer.min.js";Aa.AFrameworkApplication.ea.Rv("IsServerFlavorDebug")&&(C=Aa.AFrameworkApplication.ea.ka("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");C=Aa.AFrameworkApplication.uL(String.format("{0}",C),5);C=gf.a.create(C,null,null);eg.a.UIa(C);this.jad=C.brb}return this.jad}static get instance(){Eh.Va||(Eh.Va=new Eh);return Eh.Va}}Eh.Va=null;Object(K.a)(Eh,
"HammerJsDependencyLoader",null,[904]);var th;(function(C){C[C.none=-1]="none";C[C.BSc=0]="pinch";C[C.pan=1]="pan";C[C.jxe=2]="swipe"})(th||(th={}));Object(K.b)("GestureEvent",th);var qh=a(83);class Lj extends qh.a{constructor(C,Ca,qb,nc,Rc,id,sd,Fd){super(C,qb,nc,id);this.mCb=Ca;this.Cta=sd;this.J9=Fd;this.cnh=Rc}get shiftKey(){return this.Cta}get ctrlKey(){return this.J9}get clientPoint(){return this.mCb}get NJa(){return this.cnh}static create(C,Ca,qb,nc,Rc,id){if(qb.rawEvent)if(id){var sd=qb.rawEvent;
sd=new Sys.UI.Point(sd.clientX,sd.clientY)}else sd=qh.a.eSb(qb);else sd=new Sys.UI.Point(qb.clientX,qb.clientY);return new Lj(C,sd,Ca,qb,nc,Rc,qb.shiftKey,qb.ctrlKey,id)}}Object(K.a)(Lj,"GestureEventArgs",qh.a,[]);class vj{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=
this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(K.a)(vj,"GestureManagerData",null,[]);class Gi{}Gi.Gfh=2;Gi.Hfh=4;Gi.Ifh=8;Gi.Jfh=8;Object(K.a)(Gi,"HammerConstants",null,[]);var Pj=a(109),mf=a(222),Hi=a(173);class lj extends ob.a{constructor(C,Ca){super();this.LEa=aj.a.AEi;this.Eid=!!window.PointerEvent;this.u0e=window.hasOwnProperty("ontouchstart");this.ccb=this.LFb=null;this.Rka=!1;this.e4=new df.a;this.eGb=new df.a;this.dnh=
new Ej.a;this.eEa=null;this.cbb=this.ocd=this.UJe=this.R9c=this.lgd=this.HXe=this.$Je=this.KHb=!1;this.qFb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.Eld=null;this.XNa=(qb,nc,Rc)=>{qb=this.gJf(qb);nc=this.kPi(Rc);Hammer.inputHandler(this,qb,nc);this.Rka&&Rc.preventDefault();return this.Rka};this.r5a=(qb,nc,Rc)=>{var id=Rc.rawEvent.pointerType.toString();const sd=Rc.rawEvent.pointerId.toString();if("touch"!==id)return!1;qb=this.gJf(qb);if(1!==qb&&!this.e4.mh(sd))return!1;this.$Je&&
1===qb&&Rc.rawEvent.isPrimary&&this.e4.count&&(E.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.jrc());this.KHb?this.fAh(sd,nc,Rc):this.e4.ga(sd,Rc);this.lgd&&2===qb&&(!this.R9c||this.R9c&&"function"===typeof Rc.rawEvent.getCoalescedEvents)&&(nc=Rc.rawEvent.getCoalescedEvents())&&this.CRf()&&(this.qFb=Math.max(this.qFb,nc.length));this.HXe&&(this.Rka=!1);id=this.jPi(this.e4,Rc,id);Hammer.inputHandler(this,qb,id);if(4===qb||8===qb)this.KHb?this.BFg(sd):this.e4.remove(sd),this.e4.count||
(this.session=null,this.lgd&&-1!==this.qFb&&(E.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.qFb),this.qFb=-1));this.Rka&&Rc.preventDefault();return this.Rka};this.vQc=()=>!1;this.gk=Pj.EventHandlerManager.instance;this.Eid?(E.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.LFb=this.r5a,this.ccb=Ra.a.CEi):this.u0e?(E.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.LFb=this.XNa,this.ccb=Ra.a.Hzb):(E.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),
this.LFb=this.vQc,this.ccb=Ra.a.BEi);this.Mo=Ca;this.ysa=C;Aa.AFrameworkApplication.ea&&(this.KHb=Aa.AFrameworkApplication.ea.ka("UsePointerCaptureIsEnabled"),this.$Je=Aa.AFrameworkApplication.ea.ka("ClearCacheOnPrimaryPointerIsEnabled"),this.HXe=Aa.AFrameworkApplication.ea.ka("ResetHandledBeforeInputHandlerIsEnabled"),this.lgd=Aa.AFrameworkApplication.ea.ka("LogCoalescedEventsIsEnabled"),this.R9c=Aa.AFrameworkApplication.ea.ka("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.UJe=Aa.AFrameworkApplication.ea.ka("CheckIfHammerExistsAfterDownloadIsEnabled"),
this.ocd=Aa.AFrameworkApplication.ea.ka("HammerJsPerformanceTimersIsEnabled"),this.cbb=this.KHb&&Aa.AFrameworkApplication.ea.ka("CancelDragFromGestureInputManagerIsEnabled")&&Aa.AFrameworkApplication.ea.ka("UseGestureInputManagerPointerCacheIsEnabled"))}aOi(){return this.Eid?0:this.u0e?1:2}Xv(C){super.Xv(C);this.gk.mya(this.ccb,C,0,this.LFb)}Mu(C){super.Mu(C);this.gk.KYa(C,this.ccb)}Hjk(C,Ca,qb){qb=void 0===qb?null:qb;var nc=void 0===nc?null:nc;Aa.AFrameworkApplication.$Ic()?Eh.instance.$yj().continueWith(Rc=>
{this.cXk();if(Rc.Jm||Rc.so)E.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Rc.status);else{E.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Rc.status);if(this.UJe){Rc=window.Hammer;if("undefined"===typeof Rc){E.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.h1c();return}if("undefined"===typeof Rc.inputHandler){E.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.h1c();return}}if(!C)throw this.h1c(),Error.argumentNull("source element can not be null");
Rc=mf.a.uKa(C,this.LEa);if(void 0===Rc||null===Rc)Rc=new df.a,mf.a.txb(C,this.LEa,Rc),this.Ijk(C);var id=null;if(!Rc.mh(th[0])){id=Object;var sd=id.assign,Fd=new Fj,S=th[0],Ua=nc;Ua=void 0===Ua?null:Ua;if(void 0===this||null===this)throw E.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Hb=null;switch(S){case Ra.a.BSc:Hb=new Hammer.Pinch(Ua);break;case Ra.a.pan:Hb=new Hammer.Pan(Ua)}Hb&&(Hb.manager=this);id=sd.call(id,Fd,{oqa:Hb,BEf:Ca});
Rc.add(th[0],id)}if(void 0!==qb&&null!==qb)for(sd=0;sd<qb.length;sd++)Rc.mh(th[qb[sd]])&&(Fd=Rc.ma(th[qb[sd]]),id.oqa.recognizeWith(Fd.oqa))}this.h1c()}):E.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}cXk(){this.ocd&&(this.Mo?this.Eld=this.Mo.Oi("Task","RegisterGestureAdapterAfterLoad"):E.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}h1c(){this.ocd&&(this.Eld?this.Eld.stop():E.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Ijk(C){this.dnh.add(C);
this.gk.mya(this.ccb,C,0,this.LFb)}recognize(C){var Ca=Array(C.pointers.length);for(var qb=0;qb<C.pointers.length;qb++)Ca[qb]=C.pointers[qb].target;qb=null;for(this.eEa=this.MQi(Ca);void 0!==this.eEa&&null!==this.eEa&&(qb=mf.a.uKa(this.eEa,this.LEa),void 0===qb||null===qb);this.eEa=this.eEa.parentNode);if(void 0!==qb&&null!==qb){this.curRecognizer&&this.curRecognizer.state===Gi.Jfh&&(this.curRecognizer=null);Ca=qb.keys;for(const nc of Ca){Ca=qb.ma(nc);void 0!==Ca&&null!==Ca&&void 0!==Ca.oqa&&null!==
Ca.oqa&&(void 0===this.curRecognizer||null===this.curRecognizer||Ca.oqa===this.curRecognizer||Ca.oqa.canRecognizeWith(this.curRecognizer))&&Ca.oqa.recognize(C);const Rc=Ca.oqa.state;this.curRecognizer||Gi.Gfh!==Rc&&Gi.Hfh!==Rc&&Gi.Ifh!==Rc||(this.curRecognizer=Ca.oqa)}}}emit(C,Ca){if("hammer.input"!==C){this.Rka=!1;Ca=Lj.create(C,this.eEa,Ca.srcEvent,Ca,3,this.Eid);var qb=mf.a.uKa(this.eEa,this.LEa);if(this.iqj(C))var nc=0;else if(this.Upj(C))nc=1;else if(this.qtj(C))nc=2;else{E.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:qb}=qb.tj(th[nc]));void 0!==qb&&null!==qb&&((qb=qb.BEf,qb.$mj())?C.endsWith("start")?this.Rka=qb.kUj(Ca):C.endsWith("end")?(qb.iUj(Ca),this.Rka=!0):C.endsWith("cancel")?(qb.hUj(Ca),this.Rka=!0):C.endsWith("move")&&(this.Rka=qb.jUj(Ca)):E.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",C))}}get(C){return Object(qe.a)(Hammer.Recognizer,C)}MQi(C){if(1>C.length)return null;if(1===C.length)return C[0];
var Ca=C[0],qb=!0;for(let nc=1;nc<C.length;nc++){if(!C[nc])return null;if(Ca!==C[nc]){qb=!1;break}}if(qb)return Ca;Ca=this.QEf(C[0]);qb=0;for(const nc of C){C=this.QEf(nc);if(Ca.ma(Ca.count-1)!==C.ma(C.count-1))return null;for(let Rc=Ca.count-2,id=C.count-2;Rc>=qb&&0<=id;Rc--,id--)if(Ca.ma(Rc)!==C.ma(id)){qb=Rc+1;break}}return Ca.ma(qb)}QEf(C){const Ca=new Ej.a;for(;void 0!==C&&null!==C;C=C.parentNode)Ca.add(C);return Ca}gJf(C){switch(C){case Ra.a.Om:case Ra.a.ava:return 1;case Ra.a.wo:case Ra.a.GWa:return 2;
case Ra.a.pl:case Ra.a.HKb:return 4;case Ra.a.X2c:case Ra.a.rud:return 8}return 0}CRf(){return 1<this.e4.count}jrc(){E.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.KHb)for(const C of this.e4)this.BFg(C.key);else this.e4=new df.a;this.session=null}fAh(C,Ca,qb){E.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",C);if(!this.eGb.mh(C)){try{Ca.setPointerCapture(C)}catch(nc){E.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",nc)}this.eGb.add(C,
Ca)}this.e4.ga(C,qb);this.cbb&&1<this.e4.count&&this.ysa&&!this.ysa.rLb&&(this.ysa.rLb=!0)}BFg(C){E.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",C);if(this.eGb.mh(C)){try{this.eGb.ma(C).releasePointerCapture(C)}catch(Ca){E.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Ca)}this.eGb.remove(C)}else E.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",C);this.e4.remove(C);this.cbb&&1>=this.e4.count&&this.ysa&&this.ysa.rLb&&
(this.ysa.rLb=!1)}kPi(C){const Ca=new vj;var qb=C.rawEvent;const nc=qb.touches;qb=qb.changedTouches;Ca.pointers=Array.clone(nc);Ca.pointers=Array.clone(0<nc.length?nc:qb);Ca.changedPointers=Array.clone(qb);Ca.srcEvent=C;Ca.pointerType="touch";return Ca}jPi(C,Ca,qb){const nc=new vj;nc.pointers=Hi.toArray(C.values);nc.changedPointers=[Ca];nc.pointerType=qb;nc.srcEvent=Ca;return nc}iqj(C){return La.a.startsWith(C,Ra.a.BSc)}Upj(C){return La.a.startsWith(C,Ra.a.pan)}qtj(C){return La.a.startsWith(C,Ra.a.jxe)}}
Object(K.a)(lj,"GestureInputManager",ob.a,[891,892]);var Mj=a(390);class Yg{constructor(){this.Vh=null;this.PG=!1}get name(){return"Common.App.GestureInputManager"}co(C){C.register(lj,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Ai().Ii(()=>new lj(Mj.a.instance,Aa.AFrameworkApplication.ra.GL));this.Vh=C}init(){this.PG||(Object(ke.a)(Uj),this.PG=!0)}dispose(){}static main(){Sg.a.instance.Jo(new Yg)}}Object(K.a)(Yg,"GestureInputManagerPackage",null,[13,14]);const Gj=
Object(ke.b)("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor"),Zj=Object(ke.b)("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo");var mj=a(116);class ri extends mj.a{constructor(){super()}static instance(){return ri.Va||(ri.Va=new ri)}}ri.O1j="OnTextSelectionHighlightChangeEvent";ri.Va=null;Object(K.a)(ri,"TextSelectionHighlightChangeEvent",mj.a,[]);class Qi extends V.a{constructor(C,Ca){super(!1,!1,!0);this.$6b=(qb,nc)=>{1===qb&&(this.fSa.rTd=nc.tooltipPersistenceEnabled,
qb=nc.textSelectionChangeEnabled,this.fSa.wac!==qb&&this.yvh.raiseEvent(ri.O1j),this.fSa.wac=qb)};this.fSa=C;this.yvh=Ca}start(){const C={["tooltipPersistenceEnabled"]:this.fSa.rTd};C.textSelectionChangeEnabled=this.fSa.wac;this.initializeAndShow("",this.$6b,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:C});E.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}Object(K.a)(Qi,"AccessibilitySettingsDialog",V.a,[]);var Mh=a(138),Ri=a(26);class nj{constructor(C,
Ca){this.$Pk=()=>{(new Qi(this.fSa,ri.instance())).start();return 32};this.$f=C;this.fSa=Ca}ko(){this.$f.Uh(Ri.a.ZPk,Mh.a.frame,this.$Pk)}}Object(K.a)(nj,"AccessibilitySettingsDialogActor",null,[893]);const ck=C=>{const Ca=new Uf.a;Aa.AFrameworkApplication.lj.qv(Th(C),1,null,null,!0,2,qb=>{200===qb.data.httpStatus?Ca.setResult("true"===qb.data.responseData.toLowerCase()):Ca.setResult(!1)},()=>{Ca.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return Ca.task},Vg=(C,Ca)=>{Aa.AFrameworkApplication.lj.qv(Th(C),
2,Ca.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},Th=C=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",Aa.AFrameworkApplication.ea.appSettings.RoamingServiceHandlerWebServiceBase||"",C,Aa.AFrameworkApplication.Oo);var lg=a(112);class Qj{constructor(){this.keb=this.icb=null}get rTd(){return!!this.icb}set rTd(C){C!==this.icb&&(this.icb=C,lg.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(C),this.ZJc()&&Vg("saveHoverableRibbonTooltipIsEnabled",
C))}get wac(){return!!this.keb}set wac(C){C!==this.keb&&(this.keb=C,this.ZJc()&&Vg("saveTextSelectionHighlightChangeIsEnabled",C))}gzj(){const C=new Uf.a;if(this.icb)C.setResult(this.icb);else if(this.ZJc()){const Ca=ck("getHoverableRibbonTooltipIsEnabled");Ca.continueWith(()=>{this.icb=Ca.result;lg.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Ca.result);C.setResult(Ca.result)},8)}else C.setResult(!1)}Gzj(){const C=new Uf.a;if(this.keb)C.setResult(this.keb);else if(this.ZJc()){const Ca=
ck("getTextSelectionHighlightChangeIsEnabled");Ca.continueWith(()=>{this.keb=Ca.result;C.setResult(Ca.result)},8)}else C.setResult(!1)}ZJc(){const C=Aa.AFrameworkApplication.ea.ka("IsRoamingServiceEnabled"),Ca=Aa.AFrameworkApplication.ea.ka("IsAnonymousUser");return C&&!Ca}}Object(K.a)(Qj,"AccessibilitySettingsInfo",null,[885]);var M=a(105);class wa{constructor(){this.Vh=null}get name(){return"Common.App.AccessibilitySettings"}co(C){this.Vh=C;this.Vh.register(Qj,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ii(()=>
new Qj).Ai();this.Vh.register(nj,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ii(()=>new nj(Aa.AFrameworkApplication.xh,Object(ke.f)(Zj))).Ai()}init(){const C=Object(ke.f)(Zj),Ca=Object(ke.f)(Gj);C&&Ca?(Ca.ko(),C.gzj(),C.Gzj(),M.a(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",C.wac)):M.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){Sg.a.instance.Jo(new wa)}}
Object(K.a)(wa,"AccessibilitySettingsPackage",null,[13,14]);const ab=Object(ke.b)("Common.App.RibbonSettings.IRibbonSettingsDialogActor");class Sb extends V.a{constructor(C,Ca){super(!1,!1,!0);this.$6b=(qb,nc)=>{if(1===qb){qb=nc.showRibbonChoice;if(this.XXe!==nc.ribbonLayoutChoice)appChrome.onRibbonModeToggle();this.OZe!==qb&&("AlwaysShow"===qb?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.XXe=C;this.OZe=Ca}start(){this.initializeAndShow("",this.$6b,{["id"]:"RibbonSettingsDialog",
["bodyControls"]:{["ribbonLayoutChoice"]:this.XXe,["showRibbonChoice"]:this.OZe}})}}Object(K.a)(Sb,"RibbonSettingsDialog",V.a,[]);class fc{constructor(C){this.$f=C}ko(){this.$f.Uh(Ri.a.$Sk,Mh.a.frame,this.aTk)}aTk(){let C="SingleLineRibbon";"Multiline"===appChrome.selectors.getRibbonMode()&&(C="ClassicRibbon");const Ca=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new Sb(C,Ca)).start();return 32}}Object(K.a)(fc,"RibbonSettingsDialogActor",null,[884]);class Mc{constructor(){this.Vh=
null}get name(){return"Common.App.RibbonSettings"}co(C){this.Vh=C;this.Vh.register(fc,"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").Ii(()=>new fc(Aa.AFrameworkApplication.xh)).Ai()}init(){const C=Object(ke.f)(ab);C?C.ko():M.a(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){Sg.a.instance.Jo(new Mc)}}Object(K.a)(Mc,"RibbonSettingsPackage",null,[13,14]);
class rd extends Qf.a{constructor(C){super();this.$=C;this.sn()}create(){const C=Object(Tc.d)(ka.a.resolve(oa.rd,{va:this.gi}));Bb.TaskExtensions.$e(Bb.TaskExtensions.Dq([C],this.$.ya),()=>{this.dl(this.$.qa.zh(211)||new za(this.$,C.result,this.$.wK,this.$.Dl))},this.ya,3)}static Ga(C){C.qa.Rh(212,new rd(C))}}Object(K.a)(rd,"AriaLiveNotifierFactory",Qf.a,[]);var Jd=a(1146);const le=Object(ke.c)(Jd.b);var ye=a(1147);const $e=Object(ke.c)(ye.b);var kf=a(1145);const Bf=Object(ke.c)(kf.b);var Zf=a(608),
xg=a(1294),Og=a(1444);class hh extends Og.a{constructor(){super();this.Gld=this.cGb=null;this.state=0;this.Idd=this.APe=!1}get WV(){return this.cGb}get qCa(){return this.Gld}get igj(){return this.APe}iMf(){return"GetMoreInfo Result"}}Object(K.a)(hh,"GetMoreInfoResult",Og.a,[905,605]);var ih=a(1149),Ii=a(129);class Fh{constructor(C,Ca,qb){this.xkc=this.Fq=null;this.Kjd=0;this.Fth=C;this.vk=Ca;this.CLe=qb}rHh(){this.Kjd=this.pwb+1}rme(C){this.Fq&&(this.vk.Ux(this.Fq),this.Fq=null);C&&(this.Kjd=0)}VWk(C){const Ca=
this.p1k;0<=Ca?(this.rHh(),this.rme(!1),this.Fq=new Ii.a(4,1,Ca,C,107),this.vk.lm(this.Fq)):(this.rme(!0),E.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.CLe}))}get pwb(){return this.Kjd}get p1k(){return this.pwb>=this.NOg.length?-1:this.NOg[this.pwb]}get NOg(){if(!this.xkc){const C=(this.Fth.value||"0").split(",");this.xkc=[];for(let Ca=0;Ca<C.length;Ca++){const qb=parseInt(C[Ca]);isNaN(qb)?E.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
{["Action"]:this.CLe,["Entry"]:C[Ca]}):Array.add(this.xkc,qb)}}return this.xkc}}Object(K.a)(Fh,"RetryHelper",null,[]);class $g extends xg.a{constructor(C,Ca){super();this.tea=C;this.FGb=new Fh(Ca,this.E0b.yOc,"GetMoreInfo");this.bA=new hh}WEj(){this.R5d("Document opened")}F8h(C){return()=>{this.R5d(C,!0)}}Eqg(C,Ca){Ca=void 0===Ca?null:Ca;E.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:C});3===this.bA.state?(Ca&&this.buf(Ca,this.bA),E.ULS.sendTraceTag(5849619,
202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:C})):this.R5d(C);return this.bA}R5d(C,Ca){this.FGb.rme(!(void 0===Ca?0:Ca));1===this.bA.state?E.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:C,["RetryIndex"]:this.FGb.pwb}):(E.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:C,["RetryIndex"]:this.FGb.pwb}),this.bA.state=1,Ca=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.E0b.f2,Aa.AFrameworkApplication.Oo),
this.E0b.isb.w$(Ca,1,null,null,[$g.iWe,$g.t_e],!1,5,this.J7h(),this.I7h(C),null))}J7h(){return C=>{var Ca=!1;let qb=!1;var nc=!1,Rc;if(Aa.AFrameworkApplication.ea.ka("GetMoreInfoDataFromResponseBody"))if(C.data.responseData){let id=Qg.d(C.data.responseData);({Fz:Rc}=id);id.returnValue?Rc?(nc=!0,this.bA.Gld=Rc.StorageServiceDisplayName,this.bA.cGb=$g.n5f(Rc.PersonalFileStorageUrl)?Rc.PersonalFileStorageUrl:"",""===this.bA.WV&&"SharePointOnlineConsumer"===Aa.AFrameworkApplication.ea.Ya("FileSource")&&
(this.bA.cGb=Kd.a.Lca(Aa.AFrameworkApplication.breadcrumbFolderUrl)),Ca=""===this.bA.WV&&""!==this.bA.qCa):E.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):E.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else E.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");
nc||((Rc=C.data.responseHeaders)?(this.bA.Gld=(Rc[$g.t_e]||"").toString(),Ca=(Rc[$g.iWe]||"").toString(),this.bA.cGb=$g.n5f(Ca)?Ca:"",""===this.bA.WV&&"SharePointOnlineConsumer"===Aa.AFrameworkApplication.ea.Ya("FileSource")?(this.bA.cGb=Kd.a.Lca(Aa.AFrameworkApplication.breadcrumbFolderUrl),Ca=""===this.bA.WV&&""!==this.bA.qCa):Ca=""===Ca&&""!==this.bA.qCa):(E.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),qb=!0));nc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.FGb.pwb,qb,Ca,nc);this.E0b.jpa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",C.data,nc);this.bPg(3,Ca,qb)}}I7h(C){return Ca=>{this.E0b.jpa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Ca.data,"Failure");this.bPg(2);this.FGb.VWk(this.F8h(C))}}bPg(C,Ca,qb){this.bA.state=C;this.bA.APe=void 0===Ca?!1:Ca;this.bA.Idd=void 0===qb?!1:qb;this.LEd(this.bA)}get E0b(){return this.tea.value}static get instance(){return $g.Va||($g.Va=$g.pY())}static pY(){return new $g(new Zf.a(()=>
ih.a.instance),new Zf.a(()=>Aa.AFrameworkApplication.vRi))}static n5f(C){if(!C)return E.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(La.a.As(C).startsWith("https://"))return!0;E.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}$g.iWe="PersonalFileStorageUrl";$g.t_e="StorageServiceDisplayName";$g.Va=null;Object(K.a)($g,"GetMoreInfoActor",xg.a,[]);class si{constructor(C,Ca,qb,nc,Rc){this.joh=6E4;this.iVf="inactive";
this.v2e="active";this.aK=!0;this.vk=C;this.knh=Ca;this.ccd=qb;this.zlc=nc;this.ih=new mj.a;Rc&&this.KWk();this.IRe=this.zJf()}o3e(C){this.ih.addHandler(this.v2e,C)}dAh(C){this.ih.addHandler(this.iVf,C)}KWk(){const C=new Ii.a(5,2,this.joh,Object(Eg.a)(this,this.naj,"inactiveLoop"),108);this.oaj.lm(C)}naj(){const C=this.zJf(),Ca=this.ZF()-C;Ca>this.A2c&&this.aK&&(E.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Ca}),this.aK=!1,this.ih.raiseEvent(this.iVf));C-this.IRe>
this.A2c&&(this.aK=!0,this.ih.raiseEvent(this.v2e));this.IRe=C}get oaj(){return this.vk.value}get zJf(){return this.knh}get ZF(){return this.ccd}get A2c(){return this.zlc.value}static get instance(){return si.Va||(si.Va=si.pY())}static pY(){return new si(new Zf.a(()=>ea.TaskManager.instance),()=>Aa.AFrameworkApplication.B3a.getTime(),()=>(new Date).getTime(),new Zf.a(()=>Aa.AFrameworkApplication.A2c),!0)}}si.Va=null;Object(K.a)(si,"InactivityManager",null,[]);var Nh=a(1418);class ti{constructor(){this.JHb=
this.mXe=this.Vh=null;this.ov=!1;this.tei=()=>{ea.TaskManager.instance.Ux(this.Neg)};this.S3e=()=>{ea.TaskManager.instance.lm(this.Neg)}}get name(){return"Common.App.NewAndOpen.Core"}co(C){this.Vh=C;C.register(603,"Common.INewAndOpenCommonHelpers").Ai().Ii(()=>ih.a.instance);C.register(606,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Ai().Ii(()=>$g.instance);C.register(606,"Common.IEventEmitter<Common.IMruResult>").Ai().Ii(()=>Nh.a.instance)}init(){Aa.AFrameworkApplication.ea.cy(()=>{this.yVb()})}yVb(){Object(ke.a)(Bf);
Object(ke.a)(le);Object(ke.a)($e);var C=!1;ih.a.instance.njk();Aa.AFrameworkApplication.yN&&(C=!0);Aa.AFrameworkApplication.oCg&&(Nh.a.instance.YEj(),0<Aa.AFrameworkApplication.Meg&&this.S3e(),this.HKk(),C=!0);Aa.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&C&&$g.instance.WEj();Aa.AFrameworkApplication.mal&&(C=Nh.a.instance,C.jlk(),C.gFj(),ea.TaskManager.instance.lm(this.nal))}HKk(){si.instance.o3e(Object(Eg.a)(Nh.a.instance,Nh.a.instance.XEj,"makeGetMruRequestActivityTrigger"));si.instance.o3e(this.S3e);
si.instance.dAh(this.tei)}get Neg(){return this.mXe||(this.mXe=new Ii.a(5,2,Aa.AFrameworkApplication.Meg,Object(Eg.a)(Nh.a.instance,Nh.a.instance.FRi,"getMruFromServerTask"),109))}get nal(){return this.JHb||(this.JHb=new Ii.a(2,2,6E4*Aa.AFrameworkApplication.ea.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(Eg.a)(Nh.a.instance,Nh.a.instance.hFj,"makeUpdateMruTask"),197))}dispose(){this.ov||(this.ov=!0,this.JHb&&(ea.TaskManager.instance.Ux(this.JHb),this.JHb=
null))}}Object(K.a)(ti,"CorePackageManager",null,[13,14,2]);const bj=Object(ke.b)("Common.App.O365Shell.O365ShellActor"),oj=Object(ke.c)(bj);var Hj=a(988);class Oh{constructor(C,Ca){this.Skd=this.Rkd=null;this.Wdb=new Uf.a;this.P2b=qb=>{let nc=null;nc&&nc.length||!qb||!qb.data||(nc=qb.data.responseData);if(nc&&nc.length)try{const Rc=Qg.a(nc);this.Rkd=Rc.NavBarDataJson;E.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.Rkd?(()=>{let id=Qg.d(Rc.NavBarDataJson);
({Fz:this.Skd}=id);return id})().returnValue?(this.bCj(this.Skd),this.Wdb.setResult(this.Skd)):(E.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Hj.a.v$a(this.Rkd)}),this.Wdb.fD()):(E.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Wdb.fD())}catch(Rc){E.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Wdb.fD()}else E.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.Y1b=()=>
{this.Wdb.fD();E.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.$n=C;this.yla=Ca.appSettings[Oh.Egl]||""}get bMk(){return this.Wdb.task}get sma(){return this.$n.value}Itk(){const C={};C[Oh.$6i]=Aa.AFrameworkApplication.Oo;C["Content-Type"]="application/json; charset=utf-8";E.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Ca=Kd.a.Jr(this.yla+Oh.cMk,Oh.INj,Aa.AFrameworkApplication.ra.$g.qn.toString());this.sma.qv(Ca,
1,"",C,!0,2,this.P2b,this.Y1b,null,void 0,void 0,void 0,void 0,"20")}bCj(C){try{const Ca={};Ca.FlightName=C.FlightName;Ca.SessionID=C.SessionID;E.ULS.sendTraceTag(594883776,215,50,Qg.c(Ca))}catch(Ca){E.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return Oh.Va||(Oh.Va=Oh.dxa())}static dxa(){return new Oh(new Zf.a(()=>Aa.AFrameworkApplication.lj),Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.ra.$g.qn)}}Oh.$6i="X-qs";Oh.INj="at";Oh.cMk="O365ShellServiceProxy.ashx";
Oh.Va=null;Oh.Egl="ShellWebServiceBase";Object(K.a)(Oh,"O365ShellActor",null,[883]);class xj{constructor(){this.Vh=null;this.fL=()=>{Aa.AFrameworkApplication.useO365ShellService&&Aa.AFrameworkApplication.ra.$g.Iw&&Object(ke.a)(oj).Itk()}}get name(){return"Common.App.O365Shell"}co(C){this.Vh=C;this.Vh.register(Oh,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").Ai().Ii(()=>new Oh(new Zf.a(()=>Aa.AFrameworkApplication.lj),Aa.AFrameworkApplication.ea,Aa.AFrameworkApplication.ra.$g.qn))}init(){Aa.AFrameworkApplication.ea.cy(this.fL)}dispose(){}static main(){Sg.a.instance.Jo(new xj)}}
Object(K.a)(xj,"PackageManager",null,[13,14]);class cj extends Qf.a{constructor(C,Ca){super();this.activityName=C;this.NU=Ca;this.sn()}create(){this.dl(new T(this.activityName,this.NU,Ab.a.gH,Ab.a.Xp,Ab.a.Fzb))}static Ga(C){C.qa.Rh(143,new cj(Ab.a.Uqa,Ab.a.pgb));C.qa.Rh(144,new cj(Ab.a.q8b,Ab.a.fOa));C.qa.Rh(145,new cj(Ab.a.r8b,Ab.a.ERc));C.qa.Rh(154,new cj(Ab.a.XPa,Ab.a.LW))}}Object(K.a)(cj,"SessionReloadSilentActivityFactory",Qf.a,[]);var dj=a(146),Ki=a(1076);class ak{constructor(C){this.P_b=C}get name(){return"CopilotBootVisibilityCheck"}co(){}init(){const C=
Ca=>{const qb=this;return xo(function*(){var nc=Date.now();const Rc=yield Ca.isFeatureEnabled("Copilot",!1);nc=Date.now()-nc;E.ULS.sendTraceTag(507839317,3050,50,"[Copilot Chat] Early call to Copilot license check latency: "+nc);Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?lg.c()?(E.ULS.sendTraceTag(507331603,306,50,"Copilot Chat loaded so dispatching visibility"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(qb.P_b,!Rc))):
(E.ULS.sendTraceTag(507331602,3050,50,"[Copilot Chat] AppChrome not loaded so setting cached visibility in local storage"),Object(Ki.b)(qb.P_b,Rc),dj.a.get_instance().Hm(10,()=>{lg.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(qb.P_b,!Rc)),E.ULS.sendTraceTag(507839316,306,50,"Copilot Chat visibility marked early"))})):dj.a.get_instance().Hm(10,()=>{lg.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(qb.P_b,!Rc)),E.ULS.sendTraceTag(507331601,306,50,
"Copilot Chat visibility marked early"))})})};Aa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?Object(Ki.a)(this.P_b)?E.ULS.sendTraceTag(507331875,306,50,"Copilot Chat visibility already cached, skipping early check"):Aa.AFrameworkApplication.ea.cy(()=>C(Object(sh.a)())):Object(cf.a)().execute(C)}dispose(){}}Object(K.a)(ak,"CopilotBootVisibilityCheck",null,[13,14]);(()=>{var C;null!==(C=Aa.AFrameworkApplication.ea)&&void 0!==C&&C.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DemandLoadApplicationFeatureHelper",
!1)||(Type.registerNamespace("Common"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),Vh.main())})();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(()=>{Sh.a.hh(C=>{Fi.Ga(C)})})();ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8827847_MigrateInsertPictureCss")?a(1520):Dj.a.Jy(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
Type.registerNamespace("Common.App.GestureManager");Yg.main();Type.registerNamespace("Common.App.AccessibilitySettings");wa.main();Type.registerNamespace("Common.App.RibbonSettings");Mc.main();(()=>{Sh.a.hh(C=>{ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||rd.Ga(C)})})();Dj.a.Jy(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(1px + 4px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1));border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:calc(-1px - 2px/var(--zoom-level-canvas,1));height:calc(1px + 2px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1));border-top:1.25px solid transparent}.ewr-selection-draghandle-left{top:0;left:calc(-1px - 1px/var(--zoom-level-canvas,1));bottom:0;width:calc(1px + 5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1));border-left:1.5px solid transparent}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(1px + 5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1));border-right:1.5px solid transparent}.ewr-selection-draghandle-top-updated{border-top:1px solid transparent;top:-2px;left:-2px;right:-2px;height:calc(3.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-updated{border-top:.75px solid transparent;right:0;left:-2px;bottom:-2px;height:calc(2.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-updated{border-left:1.25px solid transparent;top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-updated{border-right:1.25px solid transparent;top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr-selection-drag-tooltip-fluent,.ewr-selection-drag-tooltip{position:absolute;background-color:#fff;box-shadow:0 0 2px 0 #0000001f,0 4px 8px 0 #00000024;outline:1px solid transparent;border-radius:4px;height:fit-content;width:max-content;font-size:10px;padding:4px 8px 6px 8px}.ewr-selection-drag-tooltip{pointer-events:none;z-index:53;left:0;top:0}.ewr-selection-drag-tooltip-shift-instruction{font-style:italic;color:#8a8886}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-top-enhanced{height:calc(3px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-bottom-enhanced{height:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right-enhanced,.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right{width:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left-enhanced,.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left{width:calc(3px/var(--zoom-level-canvas,1))}.ewr_selection_rearrangeleft{border-left:3px solid #107c41;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #107c41;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #107c41;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #107c41;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr_selection_rearrange-flange-left,.ewr_selection_rearrange-fullrowcol-flange-left{border-left:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;left:-2px;top:-3.5px}.ewr_selection_rearrange-flange-right,.ewr_selection_rearrange-fullrowcol-flange-right{border-right:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;right:-5px;top:-3.5px}.ewr_selection_rearrange-flange-top,.ewr_selection_rearrange-fullrowcol-flange-top{border-top:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;top:-2px;left:-3.5px}.ewr_selection_rearrange-flange-bottom,.ewr_selection_rearrange-fullrowcol-flange-bottom{border-bottom:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;bottom:-5px;left:-3.5px}.ewr_selection_rearrange-fullrowcol-flange-left{left:0}.ewr_selection_rearrange-fullrowcol-flange-right{right:-3px}.ewr_selection_rearrange-fullrowcol-flange-top{top:0}.ewr_selection_rearrange-fullrowcol-flange-bottom{bottom:-3px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-drag-shadow{position:absolute;top:0;background-color:#107c41;opacity:15%;z-index:52;pointer-events:none;border-radius:2px}.ewa-grid-ltr .ewr-selection-drag-shadow{left:0}.ewa-grid-rtl .ewr-selection-drag-shadow{right:0}@media(forced-colors:active){.ewr-selection-drag-shadow{forced-color-adjust:none;background-color:#fff;opacity:20%}}@media(forced-colors:active) and (prefers-color-scheme:light){.ewr-selection-drag-shadow{background-color:#000}}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#107c41;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}");
Type.registerNamespace("Common.App.NewAndOpen.Core");Sg.a.instance.Jo(new ti);Type.registerNamespace("Common.App.O365Shell");xj.main();ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1336);Sg.a.instance.Jo(new ak("Copilot"));(()=>{Sh.a.hh(C=>{oa.Kf.Ma()||cj.Ga(C)})})();String(f);String(w);String(r);String(t);String(v);String(l);String(x);String(A);String(z);String(F);String(D);String(G);String(Q);String(O);String(J);String(H);String(N);String(L);String(Z);
window.___1712031311659_closurehack=f;window.___1712031311659_closurehack=w;window.___1712031311659_closurehack=r;window.___1712031311659_closurehack=t;window.___1712031311659_closurehack=v;window.___1712031311659_closurehack=l;window.___1712031311659_closurehack=x;window.___1712031311659_closurehack=A;window.___1712031311659_closurehack=z;window.___1712031311659_closurehack=F;window.___1712031311659_closurehack=D;window.___1712031311659_closurehack=G;window.___1712031311659_closurehack=Q;window.___1712031311659_closurehack=
O;window.___1712031311659_closurehack=J;window.___1712031311659_closurehack=H;window.___1712031311659_closurehack=N;window.___1712031311659_closurehack=L;window.___1712031311659_closurehack=Z}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.frs.js.map/6d45731c70d38ed5dca718eb26825ccd/EwaTS.frs.js.map