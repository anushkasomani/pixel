!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=250)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.incrementNumericVal=t.duplicateFont=t.duplicateBorderStyle=t.duplicateOnlyStyleWithoutFont=t.duplicateStyle=t.getRenderingRegionKey=t.updateCellMergeInformation=t.isPLTRegressionInMFPFixEnabled=t.isGridRenderPerfFixEnabled=t.isOffscreenCanvasSupported=t.isModernFontPickerEnabled=t.isSubPixelRenderingEnabled=t.getDynamicImageInformationFromCell=t.getDynamicImages=t.extendHighContrastScheme=t.extendRenderingContext=t.getPreviewCellsRange=t.areTwoRectsEqual=t.isPointInRect=t.doRangesIntersect=t.intersects1D=t.rgbToColorHex=t.getModelColumnIndex=t.getModelRowIndex=t.isDefined=t.prepareTextRunRanges=t.removeHardBreaks=t.shouldRenderFormulaOnCell=t.updateCellText=t.getDisplayText=t.getFormattedTextForMetadata=t.getFormattedText=t.isHighContrastMode=t.hasWorkbookBackgroundColor=t.getWorkbookBackgroundColor=t.setCellCachedDisplayText=t.getTextRunText=t.getCellPositionInArray=t.getCellFont=t.getColumnWidth=t.setCellAndSpannedOverCellsDirty=t.initializeCellCachedObjects=t.isCellAdjacentToMergedCell=t.getLinePixelTranslation=t.throwError=t.verifyCellStyleAndFont=t.binarySearch=t.numbersComparer=t.assertArgumentNotNull=t.NumberOfUniqueStyleIDs=void 0,t.afterBorderStyleEdit=t.setBordersNew=t.prepareBorderStyleForEdit=t.updateModelWithRowHeightOverrides=t.isFixedRows=t.getBreakOpForThaiText=t.doesTextContainThaiCharacter=t.getLastNonUniqueStyleID=t.getChangedCellsFromModel=t.updateReferenceUpdate=t.isCellPreviewTextDefined=t.isSafari=t.isMac=t.getLastBorderStyleID=t.removeBorderFromCell=t.addBorderToCellIfNotPresent=t.addLeftBorderToAdjacentCell=t.attachCellToModel=t.setBordersToBorderStyle=t.removeBordersWithinSpillCellRange=t.removeBordersWithinASpillCell=t.duplicateTextRun=t.updateGlobalFontIdsOfTextRuns=t.duplicateTextRuns=t.getCellStyleHashesFromModel=t.removeValueFromArray=t.addNewValueToArray=t.registerCanvasHitRegionsFromCache=t.renderingRegionContainsDirtyCells=t.isLargeBlock=t.validateRenderingRegion=t.getDrawingOffsetXForRenderingRegion=void 0;var r=n(1),o=n(3),i=n(7),l=n(109),a=n(14),s=n(30),d=n(5);t.NumberOfUniqueStyleIDs=2;var u,c,g,f;function h(e,t){return e-t}function C(e,t,n,r,o){for(var i=t,l=t+n-1;i<=l;){var a=i+(l-i>>1),s=o(e instanceof Array?e[a]:e.item(a),r);if(0===s)return a;s<0?i=a+1:l=a-1}return~i}function m(e,t){if((0,d.verifyArgumentNotNull)(e,"cell","getCellFont"),(0,d.verifyArgumentNotNull)(t.Styles,"Styles","getCellFont"),(0,d.verifyArgumentNotNull)(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){var n=(0,r.getCellStyle)(t,e);e.CachedFont=(0,r.getFontByID)(n,t,(null==e?void 0:e.StyleID)||0)}return e.CachedFont}function p(e,t){var n=C(t,0,t.length,e,r.cellsPositionComparer);return n<0&&(n=~n),n}function y(e){return!(0,i.isNullOrUndefined)(e)}function v(e,t,n){var r;if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:null!==(r=t.CachedDisplayTextRuns)&&void 0!==r?r:t.TextRuns,Fonts:n.Fonts}}function S(e,t){if(q(e.PreviewText))return e.PreviewText;if(e.DisplayFormula)return e.FormulaInfo.Formula;if((0,a.shouldRenderVerticalText)(e)&&e.Text&&e.OriginalText&&(n=e.Text,/^(#)+$/.test(n)))return e.OriginalText;var n;if(!x(e))return e.Text;if((0,i.isNullOrUndefined)(e.CachedDisplayText))if(!(0,i.isNullOrUndefined)(e.Text)&&(0,i.isNullOrUndefined)(e.WrapText)&&e.Text.indexOf(o.HardBreak)>=0){var r=v(e.Text,e,t);!(0,i.isNullOrUndefined)(r)&&r.Text.indexOf(o.HardBreak)>=0&&(e.CachedDisplayTextRuns=function(e){var t=e.TextRuns,n=[],r=e.Text;F(t,r);for(var i=0,l=0;l<t.length;l++){var a=t[l];(0,d.verifyArgumentNotNull)(a.EndIndex,"EndIndex","getAdjustedTextRuns"),(0,d.verifyArgumentNotNull)(a.StartIndex,"StartIndex ","getAdjustedTextRuns");var s=a.StartIndex,u=a.EndIndex;i!==s&&(u+=i-s,s=i);for(var c=a.StartIndex;c<a.EndIndex;c++)r.charAt(c)!==o.HardBreak||e.WrapText||u--;n.push({StartIndex:s,EndIndex:u,FontID:a.FontID,GlobalFontID:a.GlobalFontID,CachedFont:a.CachedFont}),i=u}return n}(e)),e.CachedDisplayText=R(e.Text)}else e.CachedDisplayText=e.Text;return e.CachedDisplayText}function R(e){return-1!==e.indexOf(o.HardBreakCRLF)||-1!==e.indexOf(o.HardBreak)?e.replace(/\r\n|\n/g,""):e}function F(e,t){var n;if(void 0===(null===(n=e[0])||void 0===n?void 0:n.EndIndex))for(var r=0;r<e.length;r++){var o=e[r],i=r<e.length-1?e[r+1].StartIndex:t.length;o.EndIndex=i}}function w(e){for(var t=Number(e).toString(16);t.length<6;)t="0"+t;return"#"+t}function T(e,t,n,r){return!(t<n||r<e)}function I(e){return!(0,i.isNullOrUndefined)(e.Text)&&(0,i.isNullOrUndefined)(e.WrapText)&&e.Text.indexOf(o.HardBreak)>=0&&e.Text!==e.CachedDisplayText}function x(e){var t,n=e.ValueType===r.CellValueType.Number,o=(0,r.shouldOverrideText)(e),i=I(e),l=(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Fill;return n||i||l||o}function b(e){return void 0!==u?u:u=(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.ModernFontPicker,e)&&(!U()||!(0,r.isChangeGateEnabled)(r.ChangeGate.DisableMFPInSafari))}function D(e,t,n,o){var i=A(t,n,o);if(e.Fonts){var l=(0,r.getFontByID)(t,e,void 0);l.RefCount=H(l.RefCount||0)}return i}function A(e,t,n){return{BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment||r.HorizontalAlignment.Automatic,ID:t||0,NamedStyleId:e.NamedStyleId||0,RefCount:n||0,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation||0,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder||r.ReadingOrderType.Context,FontID:e.FontID||0,GlobalFontID:e.GlobalFontID,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient,Orientation:e.Orientation||0,VerticalText:e.VerticalText||!1,PatternStyle:e.PatternStyle||0,PatternColor:e.PatternColor}}function P(e,t,n){for(var r=[],o=0;o<e.Borders.length;o++){var i=e.Borders[o],l={BorderLineStyle:i.BorderLineStyle,BorderPosition:i.BorderPosition,Weight:i.Weight,Color:{Red:i.Color.Red,Blue:i.Color.Blue,Green:i.Color.Green}};r.push(l)}return{Borders:r,ID:t||0,RefCount:n||0}}function H(e){return(0,i.isNullOrUndefined)(e)?1:e+1}function B(e,t){return{FontID:null!=t?t:e.FontID||0,GlobalFontID:e.GlobalFontID,StartIndex:e.StartIndex,CachedFont:e.CachedFont}}function M(e,t,n,o){for(var i=1===n?o+1:o,l=1===n?1:0;l<i;l++){var a=(0,r.getCell)(t.Row,t.Col+n*l,e);if(a){var s=(0,r.getCellBorderStyle)(e,a);s&&s.Borders&&s.Borders.length>0&&z(a,s,e)}}}function O(e,t,n){if((0,r.isRenderFlagEnabled)(r.RenderFlagsArray.MoveSpillCellBeforeRendering,t))E(e,n,t);else{(0,d.verifyArgumentNotNull)(e,"cell","setBorders"),(0,d.verifyArgumentNotNull)(n,"BorderStyle","setBorders");var o=(0,r.getCellBorderStyle)(t,e),i=N(t)+1;n.ID=i,o.RefCount=Math.max(0,(o.RefCount||0)-1),t.BorderStyles.splice(i,0,n),e.BorderStyleID=i,e.CachedBorderStyle=n}}function k(e,t){if((0,d.verifyArgumentNotNull)(e,"cell","attachCellToModel"),(0,d.verifyArgumentNotNull)(t.Cells,"this.model.Cells","attachCellToModel"),!(0,r.getCell)(e.Row,e.Col,t)){var n=(0,r.getModelClientCache)(t),o=p(e,t.Cells);t.Cells.splice(o,0,e),n.CellLookup[(0,r.getCellLookupKey)(e.Row,e.Col)]=e;var i=(0,r.getCellStyle)(t,e);(0,d.verifyArgumentNotNull)(i,"style","attachCellToModel"),i.RefCount=H(i.RefCount||0);var l=(0,r.getCellBorderStyle)(t,e);(0,d.verifyArgumentNotNull)(l,"borderStyle","attachCellToModel"),l.RefCount=H(l.RefCount||0),e.CachedBorderStyle=l}}function L(e,t,n,o){var i=(0,r.getCellBorderStyle)(t,e);if(i){for(var l=!1,a=0;a<i.Borders.length;a++){if(i.Borders[a].BorderPosition===o){l=!0;break}}if(!l)Z(e,t),(0,r.getCellBorderStyle)(t,e).Borders.push(n),$(e,t)}}function N(e){return e.BorderStyles.length-1}function E(e,t,n){(0,d.verifyArgumentNotNull)(e,"cell","setBorders"),(0,d.verifyArgumentNotNull)(t,"BorderStyle","setBorders");var o=(0,r.getCellBorderStyle)(n,e),i=N(n)+1;t.ID=i,o.RefCount=Math.max(0,(o.RefCount||0)-1),n.BorderStyles.splice(i,0,t),e.BorderStyleID=i,e.CachedBorderStyle=t}function z(e,t,n){var o=P(t,t.ID||0,1);if(o&&o.Borders)for(var i=o.Borders.length,l=0;l<i;l++){var a=o.Borders[l];a&&a.BorderPosition===r.BorderPositionType.Left&&(o.Borders.splice(l),(0,r.isGlobalBorderStylesEnabled)(n)?ee(e,n,o,!0):E(e,o,n))}}function W(e,t){var n=(0,r.getReferencedObjectById)(t.FontID||0,e.Fonts);return V(t.IsUnlocked)+"|"+V(t.IsHidden)+"|"+V(t.VerticalText)+"|"+V(t.IsPattern)+"|"+V(t.ShrinkToFit)+"|"+j(t.HorizontalAlignment)+"|"+j(t.VerticalAlignment)+"|"+j(t.ReadingOrder)+"|"+j(t.NamedStyleId||0)+"|"+j(t.Orientation||0)+"|"+j(t.Indentation||0)+"|"+j(t.BackgroundColor)+"|"+function(e){var t;if(!e)return"0";for(var n="",r=0;r<(null===(t=e.Stops)||void 0===t?void 0:t.length);r++){var o=e.Stops[r];o&&(n+=G(o)+"|")}return j(e.ShadingStyle)+"|"+n}(t.Gradient)+"|"+function(e){return V(e.Bold)+"|"+V(e.Italic)+"|"+V(e.StrikeThrough)+"|"+j(e.FontName)+"|"+j(e.Size)+"|"+j(e.Color)+"|"+j(e.Underline)+"|"+j(e.VerticalAlign)+"|"+j(e.FontScheme)}(n)+"|"}function G(e){return j(e.Color)+"|"+j(e.Position)}function V(e){return e?1:0}function j(e){return e||0}function _(){var e;return(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.userAgent.indexOf("Macintosh"))>=0}function U(){if(window&&window.navigator){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1}function q(e){return null!=e}function Y(e){return e.Styles.length-t.NumberOfUniqueStyleIDs-1}function X(e,t){var n=Y(e)+1,o=D(e,(0,r.getCellStyleByID)(t,e),n,1);return o.HorizontalAlignment=r.HorizontalAlignment.Center,o.VerticalAlignment=r.VerticalAlignment.Center,e.Styles.splice(n,0,o),{refErrorStyle:o,refErrorGlobalId:(0,r.getGlobalCellStylesMap)().getOrCreateID(o)}}function J(e,t,n){e.HorizontalAlignmentSet=!1,e.CachedStyle=t,e.GlobalCellStyleID=n,e.StyleID=t.ID}function K(e,t,n){var r=!1;if(e.Merge){var o=e.Row+e.Merge.Rows,i=t.RowNumbers[o],l=e.Col+e.Merge.Columns;r=n(i,t.ColumnNumbers[l])}return r}function Z(e,t){var n=(0,r.getCellBorderStyle)(t,e);if((0,r.isGlobalBorderStylesEnabled)(t)){Q(e,t,P(n,0,1),!1)}else{if((n.ID||0)!==r.UniqueStyleID.DefaultBorder&&(n.RefCount||0)<=1)return;O(e,t,P(n,0,1))}}function Q(e,t,n,o){if((0,r.isRenderFlagEnabled)(r.RenderFlagsArray.MoveSpillCellBeforeRendering,t))ee(e,t,n,o);else{(0,d.verifyArgumentNotNull)(e,"cell","setBordersNew"),(0,d.verifyArgumentNotNull)(n,"BorderStyle","setBordersNew");var i=(0,r.getCellBorderStyle)(t,e),l=N(t)+1;n.ID=l,i.RefCount=Math.max(0,(i.RefCount||0)-1),t.BorderStyles.splice(l,0,n),e.BorderStyleID=l,o?(e.GlobalBorderStyleID=(0,r.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,r.getBorderStyleByID)(e,t)):e.CachedBorderStyle=n}}function $(e,t){var n=(0,r.getCellBorderStyle)(t,e);e.GlobalBorderStyleID=(0,r.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,r.getBorderStyleByID)(e,t)}function ee(e,t,n,o){(0,d.verifyArgumentNotNull)(e,"cell","setBorders"),(0,d.verifyArgumentNotNull)(n,"BorderStyle","setBorders");var i=(0,r.getCellBorderStyle)(t,e),l=N(t)+1;n.ID=l,i.RefCount=Math.max(0,(i.RefCount||0)-1),t.BorderStyles.splice(l,0,n),e.BorderStyleID=l,o?(e.GlobalBorderStyleID=(0,r.getGlobalBorderStyleMap)().getOrCreateID(n),e.CachedBorderStyle=(0,r.getBorderStyleByID)(e,t)):e.CachedBorderStyle=n}t.assertArgumentNotNull=function(e,t,n){if(null==e)throw Error("".concat(n,".assertArgumentNotNull: ").concat(t," cannot be null or undefined"))},t.numbersComparer=h,t.binarySearch=C,t.verifyCellStyleAndFont=function(e,t,n){(0,d.verifyArgumentNotNull)(t,"cell",n),t.CachedStyle||(0,r.getCellStyle)(e,t),t.CachedFont||m(t,e),(null==t?void 0:t.TextRuns)&&t.TextRuns.forEach((function(t){t.CachedFont||(t.CachedFont=(0,r.getFontByID)(t,e,void 0))}))},t.throwError=function(e,t){throw Error("".concat(t,": ").concat(e))},t.getLinePixelTranslation=function(e){return e/2},t.isCellAdjacentToMergedCell=function(e,t,n){(0,d.verifyArgumentNotNull)(n,"model","isCellAdjacentToMergedCell");for(var o=function(e,t,n){return[(0,r.getCell)(e-1,t,n),(0,r.getCell)(e+1,t,n),(0,r.getCell)(e,t-1,n),(0,r.getCell)(e,t+1,n)]}(e,t,n),i=0;i<o.length;i++)if(o[i]&&o[i].Merge)return!0;return!1},t.initializeCellCachedObjects=function(e,t,n){if((0,d.verifyArgumentNotNull)(e.Styles,"styles","helpers.initCellCachedObjects"),(0,d.verifyArgumentNotNull)(e.Fonts,"fonts","helpers.initCellCachedObjects"),t.CachedStyle=(0,r.getCellStyleByID)(t,e),(0,i.isNullOrUndefined)(e.BorderStyles)||(t.CachedBorderStyle=(0,r.getBorderStyleByID)(t,e)),t.CachedFont=(0,r.getFontByID)(t.CachedStyle,e,t.StyleID||0),t.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}},t.CachedIndent=t.CachedStyle.Indentation,!(0,i.isNullOrUndefined)(t.TextRuns))for(var o=0;o<t.TextRuns.length;o++){var l=t.TextRuns[o];l.CachedFont=(0,r.getFontByID)(l,e,void 0)}t.CachedDisplayText=void 0,t.CachedDisplayTextRuns=void 0,n&&t.Text&&(t.CachedDisplayText=S(t,e))},t.setCellAndSpannedOverCellsDirty=function(e,t){var n=(0,r.getModelClientCache)(e);n.DirtyCellsKeys||(n.DirtyCellsKeys=[]),n.DirtyCellsKeys.push((0,r.getCellLookupKey)(t.Row,t.Col));var o=p(t,e.Cells),i=(0,r.getAllSpanningCellsKeys)(e.Cells,t,o);n.DirtyCellsKeys=n.DirtyCellsKeys.concat(i)},t.getColumnWidth=function(e,t){if((0,d.verifyArgumentNotNull)(t,"model","getColumnWidth"),(0,d.verifyArgumentNotNull)(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error("getColumnWidth: column width requested for a cell which is not in range of the model. colIndex: ".concat(e,", columnWidths.length: ").concat(t.ColumnWidths.length));return t.ColumnWidths[e]},t.getCellFont=m,t.getCellPositionInArray=p,t.getTextRunText=function(e,t,n){var r=t[e].StartIndex,o=n.length;return e<t.length-1&&(o=t[e+1].StartIndex),n.substring(r,o)},t.setCellCachedDisplayText=function(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0},t.getWorkbookBackgroundColor=function(e,t){return(0,i.isNullOrUndefined)(e)?y(t)?t:o.DefaultBackgroundColor:w(e.BackgroundColor)},t.hasWorkbookBackgroundColor=y,t.isHighContrastMode=function(e){return!(0,i.isNullOrUndefined)(e.highContrastScheme)},t.getFormattedText=v,t.getFormattedTextForMetadata=function(e,t,n){if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:t.TextRuns,Fonts:n.Fonts}},t.getDisplayText=S,t.updateCellText=function(e,t,n){t.Text=n,x(t)&&(I(t)&&(t.CachedDisplayText=void 0),t.CachedDisplayText=S(t,e)),(0,r.isAccAndCustomNumFmtApplicable)(t)?(0,l.updateNumFmtFromCell)(t):t.NumFmt=void 0},t.shouldRenderFormulaOnCell=function(e,t){var n;return!(!t||!(null===(n=e.FormulaInfo)||void 0===n?void 0:n.Formula))&&(e.FormulaInfo.FormulaType===r.CellFormulaType.Formula||e.FormulaInfo.FormulaType===r.CellFormulaType.ArrayFormula&&e.FormulaInfo.IsArrayRoot)},t.removeHardBreaks=R,t.prepareTextRunRanges=F,t.isDefined=function(e){return void 0!==e},t.getModelRowIndex=function(e,t){return(0,d.verifyArgumentNotNull)(e,"model","getModelRowIndex"),(0,d.verifyArgumentNotNull)(e.RowNumbers,"RowNumbers","getModelRowIndex"),C(e.RowNumbers,0,e.RowNumbers.length,t,h)},t.getModelColumnIndex=function(e,t){return(0,d.verifyArgumentNotNull)(e,"model","getModelColumnIndex"),(0,d.verifyArgumentNotNull)(e.ColumnNumbers,"ColumnNumbers","getModelColumnIndex"),C(e.ColumnNumbers,0,e.ColumnNumbers.length,t,h)},t.rgbToColorHex=w,t.intersects1D=T,t.doRangesIntersect=function(e,t){var n=T(e.FirstColumn,e.LastColumn,t.FirstColumn,t.LastColumn),r=T(e.FirstRow,e.LastRow,t.FirstRow,t.LastRow);return n&&r},t.isPointInRect=function(e,t){return T(t.x,t.x,e.x,e.x+e.width)&&T(t.y,t.y,e.y,e.y+e.height)},t.areTwoRectsEqual=function(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height==e.height},t.getPreviewCellsRange=function(e){var t,n,r,o;return null!==(r=null===(n=null===(t=e.ClientOnlyCache)||void 0===t?void 0:t.PreviewCellsSettings)||void 0===n?void 0:n.PreviewCellsRange)&&void 0!==r?r:null===(o=e.ClientOnlyCache)||void 0===o?void 0:o.PreviewCellsRange},t.extendRenderingContext=function(e){(0,d.verifyArgumentNotNull)(e.zoom,"context.zoom","extendRenderingContext");var t=e;return t.scaleFactor=e.devicePixelRatio*e.zoom,t},t.extendHighContrastScheme=function(e,t){var n=t;n.HeaderPartialSelectionFontColor=r.PartialRowColSelectionHCFontColor,e.highContrastScheme=n},t.getDynamicImages=function(e,t){switch(t){case s.ImageType.Sparkline:return e.Sparklines;case s.ImageType.InCellImage:return e.InCellImages;default:throw Error("getDynamicImages: unsupported image type = ".concat(t))}},t.getDynamicImageInformationFromCell=function(e,t){switch(t){case s.ImageType.Sparkline:return e.Sparkline;case s.ImageType.InCellImage:return e.InCellImage;default:throw Error("getDynamicImageInformationFromCell: unsupported image type = ".concat(t))}},t.isSubPixelRenderingEnabled=function(){return!((0,r.isChangeGateEnabled)(r.ChangeGate.FixBoldFontsOnMac)&&_())&&(function(){if(window&&window.navigator)return!(navigator.userAgent.indexOf("Edge/")>=0)&&navigator.userAgent.indexOf("Chrome/")>=0;return!1}()||function(){if(window&&window.navigator)return navigator.userAgent.indexOf(" Firefox/")>=0;return!1}())},t.isModernFontPickerEnabled=b,t.isOffscreenCanvasSupported=function(){return"undefined"!=typeof OffscreenCanvas},t.isGridRenderPerfFixEnabled=function(){return void 0!==g?g:g=(0,r.isChangeGateEnabled)(r.ChangeGate.GridRenderPerfFix)},t.isPLTRegressionInMFPFixEnabled=function(e){return void 0===f&&(f=(0,r.isChangeGateEnabled)(r.ChangeGate.PLTRegressionInMFPFix)&&b(e)),f},t.updateCellMergeInformation=function(e,t,n){var r=t.Merge;if(r.SpansBlocks){r.HeightAdjustedForDrawing=Math.round(r.Height*n),r.WidthAdjustedForDrawing=Math.round(r.Width*n),r.OriginDeltaXAdjustedForDrawing=Math.round(r.OriginDeltaX*n),r.OriginDeltaYAdjustedForDrawing=Math.round(r.OriginDeltaY*n);var o=e.RowOffsets[t.Row]-r.OriginDeltaY;r.SpansNextBlockVertically=o+r.Height>e.BlockHeight;var i=e.ColumnOffsets[t.Col]-r.OriginDeltaX;r.SpansNextBlockHorizontally=i+r.Width>e.BlockWidth}},t.getRenderingRegionKey=function(e){return(e.startOffsetX<<10)+e.startOffsetY},t.duplicateStyle=D,t.duplicateOnlyStyleWithoutFont=A,t.duplicateBorderStyle=P,t.duplicateFont=function(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,FontScheme:e.FontScheme,ID:t||0,Italic:e.Italic,RefCount:n||0,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign,GlobalId:e.GlobalId}},t.incrementNumericVal=H,t.getDrawingOffsetXForRenderingRegion=function(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX},t.validateRenderingRegion=function(e,t,n){(0,d.verifyArgumentNotNull)(e,"renderingRegion","validateRenderingRegion");var r=t.RowOffsets[e.startRow],o=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],i=t.ColumnOffsets[e.startColumn],l=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(r>e.startOffsetY||o<e.endOffsetY)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetY= ".concat(e.startOffsetY,", endOffsetY = ").concat(e.endOffsetY,", firstRowStartOffset= ").concat(r,", lastRowEndOffset= ").concat(o,", modelHeight= ").concat(t.BlockHeight,", rowHeights= ").concat(t.RowHeights,", rowOffsets= ").concat(t.RowOffsets,", startRow = ").concat(e.startRow,", endRow = ").concat(e.endRow,", isRTL = ").concat(t.IsRtl,", DPR: ").concat(n.devicePixelRatio,", zoom: ").concat(n.zoom));if(i>e.startOffsetX||l<e.endOffsetX)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetX= ".concat(e.startOffsetX,", endOffsetX = ").concat(e.endOffsetX,", firstColumnStartOffset= ").concat(i,", lastColumnEndOffset= ").concat(l,", modelWidth= ").concat(t.BlockWidth,", colWidths= ").concat(t.ColumnWidths,", colOffsets= ").concat(t.ColumnOffsets,", startColumn = ").concat(e.startColumn,", endColumn = ").concat(e.endColumn,", isRTL = ").concat(t.IsRtl,", DPR: ").concat(n.devicePixelRatio,", zoom: ").concat(n.zoom))},t.isLargeBlock=function(e,t){return t.startOffsetX>0||t.startOffsetY>0||!(e.BlockWidth===t.endOffsetX&&e.BlockHeight===t.endOffsetY)},t.renderingRegionContainsDirtyCells=function(e,t){if(0===e.startOffsetX&&0===e.startOffsetY&&e.endOffsetX===t.BlockWidth&&e.endOffsetY===t.BlockHeight)return!0;for(var n=t.ClientOnlyCache.DirtyCellsKeys,o=0;o<n.length;o++){var i=n[o],l=(0,r.getRowColFromCellKey)(i),a=l.row,s=l.column,d=T(s,s,e.startColumn,e.endColumn),u=T(a,a,e.startRow,e.endRow);if(d&&u)return!0}return!1},t.registerCanvasHitRegionsFromCache=function(e,t){if(e)for(var n in e)for(var r=e[n],o=0;o<r.length;o++)t(r[o])},t.addNewValueToArray=function(e,t,n){if(!(t>=0&&t<=e.length))throw Error("addNewValueToArray: Index ".concat(t," is out of range"));e.splice(t,0,n)},t.removeValueFromArray=function(e,t){if(!(t>=0&&t<e.length))throw Error("addNewValueToArray: Index ".concat(t," is out of range"));e.splice(t,1)},t.getCellStyleHashesFromModel=function(e){for(var t=new Set,n=e.Styles||[],o=0;o<n.length;o++){var i=n[o];if(i)if((0,r.isRenderFlagEnabled)(r.RenderFlagsArray.GlobalStylesSlice1,e)){var l=(0,r.getReferencedObjectById)(i.FontID||0,e.Fonts);t.add((0,r.generateKeyFromModelStyles)(r.StyleType.CellStyle,n[o])+(0,r.generateKeyFromModelStyles)(r.StyleType.Font,l))}else t.add(W(e,n[o]))}return t},t.duplicateTextRuns=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];n[r]=B(o,t[o.FontID||0])}return n},t.updateGlobalFontIdsOfTextRuns=function(e,t){for(var n=0;n<e.length;n++)e[n].GlobalFontID=(0,r.getGlobalStyleId)(e[n].FontID,t)},t.duplicateTextRun=B,t.removeBordersWithinASpillCell=function(e,t){M(e,t,1,t.Spill.SpanToEnd),M(e,t,-1,t.Spill.SpanToStart)},t.removeBordersWithinSpillCellRange=M,t.setBordersToBorderStyle=O,t.attachCellToModel=k,t.addLeftBorderToAdjacentCell=function(e,t){if((0,d.verifyArgumentNotNull)(e,"cell","addLeftBorderToAdjacentCell"),e.Col!==t.ColumnNumbers.length-1){var n=(0,r.getOrCreateCell)(t,e.Row,e.Col+1);k(n,t);var o=(0,r.getCellBorderStyle)(t,e);if(o&&0!==o.Borders.length){for(var i=void 0,l=0;l<o.Borders.length;l++){var a=o.Borders[l];if(a.BorderPosition===r.BorderPositionType.Left){i={BorderLineStyle:a.BorderLineStyle,BorderPosition:r.BorderPositionType.Left,Color:a.Color,Weight:a.Weight};break}}i&&L(n,t,i,r.BorderPositionType.Left)}}},t.addBorderToCellIfNotPresent=L,t.removeBorderFromCell=function(e,t,n){(0,d.verifyArgumentNotNull)(e,"cell","removeBorderFromCell");var o=(0,r.getCellBorderStyle)(t,e);if(o&&o.Borders&&0!==o.Borders.length){for(var i=!1,l=0;l<o.Borders.length;l++){(s=o.Borders[l])&&s.BorderPosition===n&&(i=!0)}if(i){Z(e,t);var a=(0,r.getCellBorderStyle)(t,e);for(l=0;l<a.Borders.length;l++){var s;if((s=a.Borders[l])&&s.BorderPosition===n){a.Borders.splice(l,1);break}}$(e,t)}}},t.getLastBorderStyleID=N,t.isMac=_,t.isSafari=U,t.isCellPreviewTextDefined=q,t.updateReferenceUpdate=function(e,t,n,o){var i=[];if(!e)return i;if(e.Cells&&0===e.Cells.length)return i;for(var l=void 0,a=void 0,s=0;s<e.Cells.length;s++){var d=e.Cells[s];if(d){var u=void 0,c=e.RowNumbers[d.Row],g=e.ColumnNumbers[d.Col];if(d.FormulaInfo&&d.FormulaInfo.FormulaType!==r.CellFormulaType.Value){var f=o(d.FormulaInfo.Formula);if(f&&f.newFormula){if(d.FormulaInfo.Formula=f.newFormula,u=f.newFormula,d.CachedDisplayText=void 0,d.CachedDisplayTextRuns=void 0,f.isRefError){if(d.Text=t,d.HasIgnorableError=!0,d.ValueType=r.CellValueType.Error,d.Value="4",u=t,!l){var h=X(e,d);l=h.refErrorStyle,a=h.refErrorGlobalId}J(d,l,a)}i.push({rowNum:c,colNum:g,cellText:u||d.Text||""});continue}}(d.Text||d.Value)&&(n(c,g)||K(d,e,n))&&i.push({rowNum:c,colNum:g,cellText:d.Text||""})}}return i},t.getChangedCellsFromModel=function(e,t){var n=[];if(!e)return n;if(e.Cells&&0===e.Cells.length)return n;for(var r=0;r<e.Cells.length;r++){var o=e.Cells[r];if(o){var i=e.RowNumbers[o.Row],l=e.ColumnNumbers[o.Col];(o.Text||o.Value)&&(t(i,l)||K(o,e,t))&&n.push({rowNum:i,colNum:l,cellText:""})}}return n},t.getLastNonUniqueStyleID=Y,t.doesTextContainThaiCharacter=function(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n>=o.MinUnicodeThaiRange&&n<=o.MaxUnicodeThaiRange)return!0}return!1},t.getBreakOpForThaiText=function(e){if(Intl.Segmenter){c||(c=new Intl.Segmenter("th",{granularity:"word"}));for(var t=c.segment(e)[Symbol.iterator](),n=[],r=0;r<e.length;r++)n.push("2");for(var o=t.next();!1===o.done;){var i=o.value;i.isWordLike&&i.index>0&&(n[i.index]="1"),o=t.next()}return n.join("")}},t.isFixedRows=function(e,t){return t>28||0!=(e&1<<t)},t.updateModelWithRowHeightOverrides=function(e,t){if(t){for(var n=0;n<e.RowHeights.length;n++){var r=e.RowNumbers[n],o=t.get(r);!o||void 0!==o.serverHeight&&o.serverHeight!==e.RowHeights[n]||(o.serverHeight=e.RowHeights[n],e.RowHeights[n]=o.clientHeight)}!function(e){for(var t=0,n=0;n<e.RowHeights.length;n++)e.RowOffsets[n]=t,t+=e.RowHeights[n];e.BlockHeight=t}(e)}},t.prepareBorderStyleForEdit=Z,t.setBordersNew=Q,t.afterBorderStyleEdit=$},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=t.RowHeadersNSVStylesArray=t.HeadersNSVFonts=t.OldHeadersNSVFonts=t.PartialSelectionFontColor=t.PartialRowColSelectionAndHoverBackgroundColor=t.PartialRowColSelectionBackgroundColor=t.PartialRowColSelectionHCFontColor=t.DefaultHiddenRowColInnerGapPx=t.MinimalCellExtent=t.DefaultHeaderBackgroundColor=t.DefaultRowHeaderWidth=t.DefaultColHeaderHeight=t.RowHeaderWidthWithDragSquaresArea=t.ColHeaderHeightWithDragSquaresArea=t.getRowHeaderStylesArray=t.createHeaderCell=t.calculateRowHeaderWidth=t.columnNumberToTitle=t.createHeaderBlockModel=t.CalcBlockModel=t.verifyArgumentNotNull=t.overrideRenderFlagForMismatch=t.isRenderFlagEnabled=t.isHeaderInsertEnabled=t.isIncreasedHeaderSizeEnabled=t.processGlobalStyles=t.getCellBorderStyle=t.initCellLookup=t.validateCellShouldExistInModelUnsafe=t.getRenderingRegionHitTestCache=t.getOrCreateCell=t.cellsPositionComparer=t.getCellStyle=t.getCell=t.isDifferentialRenderingSupported=t.cleanHitTestCache=t.initModelClientCache=t.getModelClientCache=t.getAdjacentCellsKeysOld=t.getAdjacentCellsKeys=t.getSpilledOverCount=t.getRowColFromCellKey=t.uniqueValuesFilter=t.getAllSpanningCellsKeys=t.getDefaultCell=t.isAccAndCustomNumFmtApplicable=t.shouldOverrideText=t.getReferencedObjectToCache=t.getCellLookupKey=void 0,t.StyleType=t.generateKeyFromModelStyles=t.isChangeGateEnabled=t.ChangeGate=t.MaxBitsPerRenderFlag=t.MaxAllowedRowColCount=t.isModelCellContainedInRange=t.getCellLog=t.getRangeLog=t.isCellContainedInRange=t.getRangeTopLeftCell=t.getReferencedObjectById=t.compareHeaderBlockModels=t.areMergeInformationEqual=t.areNumberFormatInformationEqual=t.areInCellControlOptionsEqual=t.areGridArraysEqual=t.areGridCellsEqual=t.comparePartialGridBlockModels=t.compareGridBlockModels=t.areFormattedTextsEqual=t.annonymize=t.SpillDirection=t.serializeCell=t.HoverFontColor=t.WholeRowColSelectionBackgroundColor=t.PartialRowColSelectionBackgroundColorBeforeFluent=t.NSVHeaderBackgroundColorBeforeFluent=t.RowHeadersStylesArrayBeforeFluent=t.RowHeadersNSVStylesArrayBeforeFluent=t.OldHeadersNSVFontsBeforeFluent=t.OldHeadersFontsBeforeFluent=t.HeadersNSVFontsBeforeFluent=t.HeadersFontsBeforeFluent=t.ColumnHeadersStylesArrayBeforeFluent=t.ColumnHeadersNSVStylesArrayBeforeFluent=t.HoverHeadersStylesSet=t.WholeSelectionHeadersStylesSet=t.PartiallySelectionHeadersStylesSet=t.NSVGridinesColor=t.NSVOutlinesColor=t.OutlinesColor=t.SelectedCellsGridlinesColor=t.NSVHeaderBackgroundColor=t.ColumnHeadersStylesArray=t.RowHeadersStylesArrayBeforeHeaderDragImprovements=t.RowHeadersStylesArray=t.HeadersFonts=t.OldHeadersFonts=t.ColumnHeadersNSVStylesArray=void 0,t.getCellStyleByID=t.getFontByID=t.getBorderStyleByID=t.isGlobalFontsAndCellStylesEnabled=t.isGlobalFontsAndCellStylesFlightEnabled=t.disableGlobalFonts=t.disableGlobalCellStyles=t.GlobalCellStyles=t.getGlobalCellStylesMap=t.updateGlobalFontIDInCell=t.GlobalFonts=t.getGlobalFontsMap=t.GlobalBorderStyles=t.isGlobalBorderStylesEnabledNew=t.disableGlobalBorderStyles=t.isGlobalBorderStylesEnabled=t.getGlobalBorderStyleMap=t.getGlobalStyleId=t.getGlobalStylesTelemetry=t.preprocessModelStyles=void 0;var r=n(4);r.__exportStar(n(25),t),r.__exportStar(n(147),t);var o=n(42);Object.defineProperty(t,"getCellLookupKey",{enumerable:!0,get:function(){return o.getCellLookupKey}}),Object.defineProperty(t,"getReferencedObjectToCache",{enumerable:!0,get:function(){return o.getReferencedObjectToCache}}),Object.defineProperty(t,"shouldOverrideText",{enumerable:!0,get:function(){return o.shouldOverrideText}}),Object.defineProperty(t,"isAccAndCustomNumFmtApplicable",{enumerable:!0,get:function(){return o.isAccAndCustomNumFmtApplicable}}),Object.defineProperty(t,"getDefaultCell",{enumerable:!0,get:function(){return o.getDefaultCell}}),Object.defineProperty(t,"getAllSpanningCellsKeys",{enumerable:!0,get:function(){return o.getAllSpanningCellsKeys}}),Object.defineProperty(t,"uniqueValuesFilter",{enumerable:!0,get:function(){return o.uniqueValuesFilter}}),Object.defineProperty(t,"getRowColFromCellKey",{enumerable:!0,get:function(){return o.getRowColFromCellKey}}),Object.defineProperty(t,"getSpilledOverCount",{enumerable:!0,get:function(){return o.getSpilledOverCount}}),Object.defineProperty(t,"getAdjacentCellsKeys",{enumerable:!0,get:function(){return o.getAdjacentCellsKeys}}),Object.defineProperty(t,"getAdjacentCellsKeysOld",{enumerable:!0,get:function(){return o.getAdjacentCellsKeysOld}}),Object.defineProperty(t,"getModelClientCache",{enumerable:!0,get:function(){return o.getModelClientCache}}),Object.defineProperty(t,"initModelClientCache",{enumerable:!0,get:function(){return o.initModelClientCache}}),Object.defineProperty(t,"cleanHitTestCache",{enumerable:!0,get:function(){return o.cleanHitTestCache}}),Object.defineProperty(t,"isDifferentialRenderingSupported",{enumerable:!0,get:function(){return o.isDifferentialRenderingSupported}}),Object.defineProperty(t,"getCell",{enumerable:!0,get:function(){return o.getCell}}),Object.defineProperty(t,"getCellStyle",{enumerable:!0,get:function(){return o.getCellStyle}}),Object.defineProperty(t,"cellsPositionComparer",{enumerable:!0,get:function(){return o.cellsPositionComparer}}),Object.defineProperty(t,"getOrCreateCell",{enumerable:!0,get:function(){return o.getOrCreateCell}}),Object.defineProperty(t,"getRenderingRegionHitTestCache",{enumerable:!0,get:function(){return o.getRenderingRegionHitTestCache}}),Object.defineProperty(t,"validateCellShouldExistInModelUnsafe",{enumerable:!0,get:function(){return o.validateCellShouldExistInModelUnsafe}}),Object.defineProperty(t,"initCellLookup",{enumerable:!0,get:function(){return o.initCellLookup}}),Object.defineProperty(t,"getCellBorderStyle",{enumerable:!0,get:function(){return o.getCellBorderStyle}}),Object.defineProperty(t,"processGlobalStyles",{enumerable:!0,get:function(){return o.processGlobalStyles}}),Object.defineProperty(t,"isIncreasedHeaderSizeEnabled",{enumerable:!0,get:function(){return o.isIncreasedHeaderSizeEnabled}}),Object.defineProperty(t,"isHeaderInsertEnabled",{enumerable:!0,get:function(){return o.isHeaderInsertEnabled}});var i=n(29);Object.defineProperty(t,"isRenderFlagEnabled",{enumerable:!0,get:function(){return i.isRenderFlagEnabled}}),Object.defineProperty(t,"overrideRenderFlagForMismatch",{enumerable:!0,get:function(){return i.overrideRenderFlagForMismatch}}),Object.defineProperty(t,"verifyArgumentNotNull",{enumerable:!0,get:function(){return i.verifyArgumentNotNull}});var l=n(154);Object.defineProperty(t,"CalcBlockModel",{enumerable:!0,get:function(){return l.CalcBlockModel}});var a=n(155);Object.defineProperty(t,"createHeaderBlockModel",{enumerable:!0,get:function(){return a.createHeaderBlockModel}}),Object.defineProperty(t,"columnNumberToTitle",{enumerable:!0,get:function(){return a.columnNumberToTitle}}),Object.defineProperty(t,"calculateRowHeaderWidth",{enumerable:!0,get:function(){return a.calculateRowHeaderWidth}}),Object.defineProperty(t,"createHeaderCell",{enumerable:!0,get:function(){return a.createHeaderCell}}),Object.defineProperty(t,"getRowHeaderStylesArray",{enumerable:!0,get:function(){return a.getRowHeaderStylesArray}});var s=n(105);Object.defineProperty(t,"ColHeaderHeightWithDragSquaresArea",{enumerable:!0,get:function(){return s.ColHeaderHeightWithDragSquaresArea}}),Object.defineProperty(t,"RowHeaderWidthWithDragSquaresArea",{enumerable:!0,get:function(){return s.RowHeaderWidthWithDragSquaresArea}}),Object.defineProperty(t,"DefaultColHeaderHeight",{enumerable:!0,get:function(){return s.DefaultColHeaderHeight}}),Object.defineProperty(t,"DefaultRowHeaderWidth",{enumerable:!0,get:function(){return s.DefaultRowHeaderWidth}}),Object.defineProperty(t,"DefaultHeaderBackgroundColor",{enumerable:!0,get:function(){return s.DefaultHeaderBackgroundColor}}),Object.defineProperty(t,"MinimalCellExtent",{enumerable:!0,get:function(){return s.MinimalCellExtent}}),Object.defineProperty(t,"DefaultHiddenRowColInnerGapPx",{enumerable:!0,get:function(){return s.DefaultHiddenRowColInnerGapPx}}),Object.defineProperty(t,"PartialRowColSelectionHCFontColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionHCFontColor}}),Object.defineProperty(t,"PartialRowColSelectionBackgroundColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionBackgroundColor}}),Object.defineProperty(t,"PartialRowColSelectionAndHoverBackgroundColor",{enumerable:!0,get:function(){return s.PartialRowColSelectionAndHoverBackgroundColor}}),Object.defineProperty(t,"PartialSelectionFontColor",{enumerable:!0,get:function(){return s.PartialSelectionFontColor}}),Object.defineProperty(t,"OldHeadersNSVFonts",{enumerable:!0,get:function(){return s.OldHeadersNSVFonts}}),Object.defineProperty(t,"HeadersNSVFonts",{enumerable:!0,get:function(){return s.HeadersNSVFonts}}),Object.defineProperty(t,"RowHeadersNSVStylesArray",{enumerable:!0,get:function(){return s.RowHeadersNSVStylesArray}}),Object.defineProperty(t,"RowHeadersNSVStylesArrayBeforeHeaderDragImprovements",{enumerable:!0,get:function(){return s.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements}}),Object.defineProperty(t,"ColumnHeadersNSVStylesArray",{enumerable:!0,get:function(){return s.ColumnHeadersNSVStylesArray}}),Object.defineProperty(t,"OldHeadersFonts",{enumerable:!0,get:function(){return s.OldHeadersFonts}}),Object.defineProperty(t,"HeadersFonts",{enumerable:!0,get:function(){return s.HeadersFonts}}),Object.defineProperty(t,"RowHeadersStylesArray",{enumerable:!0,get:function(){return s.RowHeadersStylesArray}}),Object.defineProperty(t,"RowHeadersStylesArrayBeforeHeaderDragImprovements",{enumerable:!0,get:function(){return s.RowHeadersStylesArrayBeforeHeaderDragImprovements}}),Object.defineProperty(t,"ColumnHeadersStylesArray",{enumerable:!0,get:function(){return s.ColumnHeadersStylesArray}}),Object.defineProperty(t,"NSVHeaderBackgroundColor",{enumerable:!0,get:function(){return s.NSVHeaderBackgroundColor}}),Object.defineProperty(t,"SelectedCellsGridlinesColor",{enumerable:!0,get:function(){return s.SelectedCellsGridlinesColor}}),Object.defineProperty(t,"OutlinesColor",{enumerable:!0,get:function(){return s.OutlinesColor}}),Object.defineProperty(t,"NSVOutlinesColor",{enumerable:!0,get:function(){return s.NSVOutlinesColor}}),Object.defineProperty(t,"NSVGridinesColor",{enumerable:!0,get:function(){return s.NSVGridinesColor}}),Object.defineProperty(t,"PartiallySelectionHeadersStylesSet",{enumerable:!0,get:function(){return s.PartiallySelectionHeadersStylesSet}}),Object.defineProperty(t,"WholeSelectionHeadersStylesSet",{enumerable:!0,get:function(){return s.WholeSelectionHeadersStylesSet}}),Object.defineProperty(t,"HoverHeadersStylesSet",{enumerable:!0,get:function(){return s.HoverHeadersStylesSet}}),Object.defineProperty(t,"ColumnHeadersNSVStylesArrayBeforeFluent",{enumerable:!0,get:function(){return s.ColumnHeadersNSVStylesArrayBeforeFluent}}),Object.defineProperty(t,"ColumnHeadersStylesArrayBeforeFluent",{enumerable:!0,get:function(){return s.ColumnHeadersStylesArrayBeforeFluent}}),Object.defineProperty(t,"HeadersFontsBeforeFluent",{enumerable:!0,get:function(){return s.HeadersFontsBeforeFluent}}),Object.defineProperty(t,"HeadersNSVFontsBeforeFluent",{enumerable:!0,get:function(){return s.HeadersNSVFontsBeforeFluent}}),Object.defineProperty(t,"OldHeadersFontsBeforeFluent",{enumerable:!0,get:function(){return s.OldHeadersFontsBeforeFluent}}),Object.defineProperty(t,"OldHeadersNSVFontsBeforeFluent",{enumerable:!0,get:function(){return s.OldHeadersNSVFontsBeforeFluent}}),Object.defineProperty(t,"RowHeadersNSVStylesArrayBeforeFluent",{enumerable:!0,get:function(){return s.RowHeadersNSVStylesArrayBeforeFluent}}),Object.defineProperty(t,"RowHeadersStylesArrayBeforeFluent",{enumerable:!0,get:function(){return s.RowHeadersStylesArrayBeforeFluent}}),Object.defineProperty(t,"NSVHeaderBackgroundColorBeforeFluent",{enumerable:!0,get:function(){return s.NSVHeaderBackgroundColorBeforeFluent}}),Object.defineProperty(t,"PartialRowColSelectionBackgroundColorBeforeFluent",{enumerable:!0,get:function(){return s.PartialRowColSelectionBackgroundColorBeforeFluent}}),Object.defineProperty(t,"WholeRowColSelectionBackgroundColor",{enumerable:!0,get:function(){return s.WholeRowColSelectionBackgroundColor}}),Object.defineProperty(t,"HoverFontColor",{enumerable:!0,get:function(){return s.HoverFontColor}});var d=n(106);Object.defineProperty(t,"serializeCell",{enumerable:!0,get:function(){return d.serializeCell}});var u=n(102);Object.defineProperty(t,"SpillDirection",{enumerable:!0,get:function(){return u.SpillDirection}});var c=n(106);Object.defineProperty(t,"annonymize",{enumerable:!0,get:function(){return c.annonymize}});var g=n(157);Object.defineProperty(t,"areFormattedTextsEqual",{enumerable:!0,get:function(){return g.areFormattedTextsEqual}}),Object.defineProperty(t,"compareGridBlockModels",{enumerable:!0,get:function(){return g.compareGridBlockModels}}),Object.defineProperty(t,"comparePartialGridBlockModels",{enumerable:!0,get:function(){return g.comparePartialGridBlockModels}}),Object.defineProperty(t,"areGridCellsEqual",{enumerable:!0,get:function(){return g.areGridCellsEqual}}),Object.defineProperty(t,"areGridArraysEqual",{enumerable:!0,get:function(){return g.areGridArraysEqual}}),Object.defineProperty(t,"areInCellControlOptionsEqual",{enumerable:!0,get:function(){return g.areInCellControlOptionsEqual}}),Object.defineProperty(t,"areNumberFormatInformationEqual",{enumerable:!0,get:function(){return g.areNumberFormatInformationEqual}}),Object.defineProperty(t,"areMergeInformationEqual",{enumerable:!0,get:function(){return g.areMergeInformationEqual}});var f=n(158);Object.defineProperty(t,"compareHeaderBlockModels",{enumerable:!0,get:function(){return f.compareHeaderBlockModels}});var h=n(61);Object.defineProperty(t,"getReferencedObjectById",{enumerable:!0,get:function(){return h.getReferencedObjectById}});var C=n(159);Object.defineProperty(t,"getRangeTopLeftCell",{enumerable:!0,get:function(){return C.getRangeTopLeftCell}}),Object.defineProperty(t,"isCellContainedInRange",{enumerable:!0,get:function(){return C.isCellContainedInRange}}),Object.defineProperty(t,"getRangeLog",{enumerable:!0,get:function(){return C.getRangeLog}}),Object.defineProperty(t,"getCellLog",{enumerable:!0,get:function(){return C.getCellLog}}),Object.defineProperty(t,"isModelCellContainedInRange",{enumerable:!0,get:function(){return C.isModelCellContainedInRange}});var m=n(78);Object.defineProperty(t,"MaxAllowedRowColCount",{enumerable:!0,get:function(){return m.MaxAllowedRowColCount}}),Object.defineProperty(t,"MaxBitsPerRenderFlag",{enumerable:!0,get:function(){return m.MaxBitsPerRenderFlag}});var p=n(37);Object.defineProperty(t,"ChangeGate",{enumerable:!0,get:function(){return p.ChangeGate}}),Object.defineProperty(t,"isChangeGateEnabled",{enumerable:!0,get:function(){return p.isChangeGateEnabled}});var y=n(52);Object.defineProperty(t,"generateKeyFromModelStyles",{enumerable:!0,get:function(){return y.generateKeyFromModelStyles}});var v=n(53);Object.defineProperty(t,"StyleType",{enumerable:!0,get:function(){return v.StyleType}});var S=n(104);Object.defineProperty(t,"preprocessModelStyles",{enumerable:!0,get:function(){return S.preprocessModelStyles}}),Object.defineProperty(t,"getGlobalStylesTelemetry",{enumerable:!0,get:function(){return S.getGlobalStylesTelemetry}}),Object.defineProperty(t,"getGlobalStyleId",{enumerable:!0,get:function(){return S.getGlobalStyleId}});var R=n(51);Object.defineProperty(t,"getGlobalBorderStyleMap",{enumerable:!0,get:function(){return R.getGlobalBorderStyleMap}}),Object.defineProperty(t,"isGlobalBorderStylesEnabled",{enumerable:!0,get:function(){return R.isGlobalBorderStylesEnabled}}),Object.defineProperty(t,"disableGlobalBorderStyles",{enumerable:!0,get:function(){return R.disableGlobalBorderStyles}}),Object.defineProperty(t,"isGlobalBorderStylesEnabledNew",{enumerable:!0,get:function(){return R.isGlobalBorderStylesEnabledNew}}),Object.defineProperty(t,"GlobalBorderStyles",{enumerable:!0,get:function(){return R.GlobalBorderStyles}});var F=n(43);Object.defineProperty(t,"getGlobalFontsMap",{enumerable:!0,get:function(){return F.getGlobalFontsMap}}),Object.defineProperty(t,"GlobalFonts",{enumerable:!0,get:function(){return F.GlobalFonts}}),Object.defineProperty(t,"updateGlobalFontIDInCell",{enumerable:!0,get:function(){return F.updateGlobalFontIDInCell}});var w=n(55);Object.defineProperty(t,"getGlobalCellStylesMap",{enumerable:!0,get:function(){return w.getGlobalCellStylesMap}}),Object.defineProperty(t,"GlobalCellStyles",{enumerable:!0,get:function(){return w.GlobalCellStyles}}),Object.defineProperty(t,"disableGlobalCellStyles",{enumerable:!0,get:function(){return w.disableGlobalCellStyles}});var T=n(54);Object.defineProperty(t,"disableGlobalFonts",{enumerable:!0,get:function(){return T.disableGlobalFonts}}),Object.defineProperty(t,"isGlobalFontsAndCellStylesFlightEnabled",{enumerable:!0,get:function(){return T.isGlobalFontsAndCellStylesFlightEnabled}}),Object.defineProperty(t,"isGlobalFontsAndCellStylesEnabled",{enumerable:!0,get:function(){return T.isGlobalFontsAndCellStylesEnabled}});var I=n(103);Object.defineProperty(t,"getBorderStyleByID",{enumerable:!0,get:function(){return I.getBorderStyleByID}}),Object.defineProperty(t,"getFontByID",{enumerable:!0,get:function(){return I.getFontByID}}),Object.defineProperty(t,"getCellStyleByID",{enumerable:!0,get:function(){return I.getCellStyleByID}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayFormulaChildInFormulaView=t.clipForOutlinesIfNecessary=t.doesHeaderModelContainOutlines=t.drawVerticalLine=t.drawHorizontalLine=t.isAdjustedForDrawingOffsetsInitialized=t.initializeOffsetsForDrawing=t.getClipMaskWidth=t.getReOrderDiv=t.isCellShrunk=t.getHighContrastTextColor=t.isRtlChar=t.getColOffsetAdjustedForDrawing=t.shouldRenderGridLines=t.cellIntersectsRenderingRegion=t.hexToRgb=t.drawLine=t.restoreClipping=t.applyClipping=t.drawClipRect=t.getContainerClipMaskWidth=t.getTextDrawingMaxHeight=t.getTextDrawingMaxWidth=t.getBlockDimensionsAdjustedForDrawing=t.getRowHeightFromOffsets=t.getColWidthFromOffsets=t.getDefaultBorderLineWidth=void 0;var r=n(1),o=n(3),i=n(7),l=n(38),a=n(0),s={},d={},u={};function c(e,t){return Math.round(e*t)}function g(e){return e-o.GridLineWidthPx}function f(e,t,n,r,o){e.beginPath(),e.rect(t,n,r,o),e.stroke(),e.clip()}function h(e,t){t&&(e.save(),e.strokeStyle="transparent",f(e,t.x,t.y,t.width,t.height))}function C(e,t){return t?2===e.ColumnOffsets.length:2===e.RowOffsets.length}t.getDefaultBorderLineWidth=function(e){return(0,i.isNullOrUndefined)(s[e])?(s[e]=Math.max(Math.round(e),1),s[e]):s[e]},t.getColWidthFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getColWidthFromOffsets:: invalid colIndex ".concat(e);return t[e+1]-t[e]},t.getRowHeightFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getRowHeightFromOffsets:: invalid colIndex ".concat(e);return t[e+1]-t[e]},t.getBlockDimensionsAdjustedForDrawing=c,t.getTextDrawingMaxWidth=function(e,t,n,r,i){var a=0;n&&(a=n+l.IconTextMinimalPadding);var s=t+a+r+i;return Math.max(0,e-o.GridLineWidthPx-s)},t.getTextDrawingMaxHeight=function(e,t){return Math.max(0,e-o.GridLineWidthPx-t)},t.getContainerClipMaskWidth=g,t.drawClipRect=f,t.applyClipping=h,t.restoreClipping=function(e,t){t&&e.restore()},t.drawLine=function(e,t,n,r,o){e.moveTo(t,n),e.lineTo(r,o)},t.hexToRgb=function(e){var t="#"===e[0]?e.substr(1):e,n=parseInt(t,16);return{Red:n>>16&255,Green:n>>8&255,Blue:255&n}},t.cellIntersectsRenderingRegion=function(e,t){var n=e.Row,r=e.Row,o=e.Col,i=e.Col;e.Merge?(r+=e.Merge.Rows,i+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(o=0),e.Merge.OriginDeltaY&&(n=0))):e.Spill&&(o-=e.Spill.SpanToStart,i+=e.Spill.SpanToEnd);var l=(0,a.intersects1D)(o,i,t.startColumn,t.endColumn),s=(0,a.intersects1D)(n,r,t.startRow,t.endRow);return l&&s},t.shouldRenderGridLines=function(e,t){return e||!t},t.getColOffsetAdjustedForDrawing=function(e,t){var n=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,r=n[n.length-1];return t.IsRtl?r-n[e+1]:n[e]},t.isRtlChar=function(e){var t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647},t.getHighContrastTextColor=function(e,t,n){var o=e.CachedStyle.BackgroundColor;if((0,r.isRenderFlagEnabled)(r.RenderFlagsArray.FluentStyle,n)){if(!(0,i.isNullOrUndefined)(t.HeaderPartialSelectionFontColor)&&(o===r.PartialRowColSelectionBackgroundColor||o===r.PartialRowColSelectionAndHoverBackgroundColor))return t.HeaderPartialSelectionFontColor}else if(!(0,i.isNullOrUndefined)(t.HeaderPartialSelectionFontColor)&&o===r.PartialRowColSelectionBackgroundColorBeforeFluent)return t.HeaderPartialSelectionFontColor;return(0,i.isNullOrUndefined)(e.Hyperlink)?function(e){u[e]||(u[e]=(0,a.rgbToColorHex)(e));return u[e]}(t.TextColor):function(e){d[e]||(d[e]=(0,a.rgbToColorHex)(e));return d[e]}(t.LinkColor)},t.isCellShrunk=function(e){return!(!e.ShrunkSize||!e.CachedFont)&&e.ShrunkSize<e.CachedFont.Size},t.getReOrderDiv=function(e,t){var n=document.createElement("div");return n.style.visibility="hidden",n.style.direction=e.BaseDir,n.style.position="absolute",n.style.width=Math.max(2e3,1.1*t)+"px",n},t.getClipMaskWidth=function(e,t,n){var r=g(e)-t-n;return Math.max(0,r)},t.initializeOffsetsForDrawing=function(e,t){var n=e.RowHeights,o=e.ColumnWidths,i=e.RowOffsets,l=e.ColumnOffsets;(0,r.verifyArgumentNotNull)(n,"rowHeights","initializeOffsetsForDrawing"),(0,r.verifyArgumentNotNull)(o,"colWidths","initializeOffsetsForDrawing"),(0,r.verifyArgumentNotNull)(i,"rowOffsets","initializeOffsetsForDrawing"),(0,r.verifyArgumentNotNull)(l,"colOffsets","initializeOffsetsForDrawing");var a=(0,r.getModelClientCache)(e);a.RowOffsetsAdjustedForDrawing=[];for(var s=0;s<i.length;s++){var d=i[s];a.RowOffsetsAdjustedForDrawing.push(Math.round(d*t))}for(a.ColOffsetsAdjustedForDrawing=[],s=0;s<l.length;s++){d=l[s];a.ColOffsetsAdjustedForDrawing.push(Math.round(d*t))}a.RowOffsetsAdjustedForDrawing.push(c(e.BlockHeight,t)),a.ColOffsetsAdjustedForDrawing.push(c(e.BlockWidth,t))},t.isAdjustedForDrawingOffsetsInitialized=function(e){return!!e.ClientOnlyCache&&!!e.ClientOnlyCache.RowOffsetsAdjustedForDrawing&&!!e.ClientOnlyCache.ColOffsetsAdjustedForDrawing},t.drawHorizontalLine=function(e,t,n,r){e.moveTo(t,r),e.lineTo(n,r)},t.drawVerticalLine=function(e,t,n,r){e.moveTo(r,t),e.lineTo(r,n)},t.doesHeaderModelContainOutlines=C,t.clipForOutlinesIfNecessary=function(e,t,n){var o=void 0;if((0,r.isRenderFlagEnabled)(r.RenderFlagsArray.RenderHeaderOutlinesInCanvas,t)){var i=!!t.IsRow;if(!C(t,i))return o;var l=n.scaleFactor,a=t.IsRtl;h(e,o=i?{x:a?0:Math.ceil(t.ColumnOffsets[1]*l),y:0,width:a?Math.floor(t.ColumnWidths[1]*l):Math.ceil(t.ColumnWidths[1]*l),height:Math.ceil(t.BlockHeight*l)}:{x:0,y:Math.ceil(t.RowOffsets[1]*l),width:Math.ceil(t.BlockWidth*l),height:Math.ceil(t.RowHeights[1]*l)})}return o},t.isArrayFormulaChildInFormulaView=function(e,t){var n;return t.isFormulaView&&(null===(n=e.FormulaInfo)||void 0===n?void 0:n.FormulaType)===r.CellFormulaType.ArrayFormula&&!e.FormulaInfo.IsArrayRoot}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnderlineMarginFromTextBaseline=t.UnderlineLineWidth=t.MediumDotDashedLineDash=t.MediumDashedLineDash=t.DashedDotDotLineDash=t.DashedDotLineDash=t.DashedLineDash=t.DottedLineDash=t.ColoredGridLineDash=t.DefaultDash=t.ThickBorderWeight=t.MediumBorderWeight=t.ThinBorderWeight=t.HardBreakCRLF=t.HardBreakCR=t.HardBreak=t.FullWidthSpace=t.Whitespace=t.EmptyString=t.RightHorizontalAlignmentItalicExtraPadding=t.EmptyLineTextToken=t.EmptyFormattedText=t.EmptyLine=t.DefaultPreviewSuggestionContentFontColor=t.DefaultCellFontColor=t.DefaultBackgroundColor=t.HighContrastPageLayoutWidthPx=t.SelectionBorderWidth=t.GridLineWidthPx=t.TextLineHeightPx=t.InCellVerticalPaddingPx=t.InCellIndentPaddingPx=t.InCellBottomAndCenterVerticalPaddingPx=t.InCellEndOfTextHorizontalPaddingPx=t.InCellHorizontalPaddingPx=t.MinimalScaleFactorForGridlinesRendering=t.PageLayoutLineColor=t.NSVHiddenRowColumnIndicatorWithSelectionLineColor=t.NSVHiddenRowColumnIndicatorLineColor=t.WholeRowColSelectionHiddenRowColumnIndicatorLineColor=t.PartialRowColSelectionHiddenRowColumnIndicatorLineColor=t.HiddenRowColumnIndicatorGapColor=t.HiddenRowColumnIndicatorLineColor=t.NSVDefaultBorderGridLineColor=t.DefaultBorderGridLineColor=t.NSVSelectedCellsGridLineColor=t.NSVDefaultGridLineColor=t.SelectedCellsGridLineColor=t.DefaultGridLineColorBeforeFluent=t.DefaultGridLineColor=void 0,t.MaxRowHeaderTextWidth=t.MaxColumnHeaderTextWidth=t.HeaderTextLineHeight=t.HeaderCornerRadius=t.RowHeaderCellHorizontalPaddingPx=t.ColumnHeaderGutterSize=t.CellIconBottomSizeRatioPadding=t.CellFontUnicodeFontFamily=t.PatternTileSize=t.pixelTranslation=t.ColumnCountInBlock=t.RowCountInBlock=t.BlockColumnEndIndex=t.BlockColumnStartIndex=t.BlockRowEndIndex=t.BlockRowStartIndex=t.GapBetweenRotatedDoubleUnderline=t.GapBetweenDoubleUnderline=t.NinetyDegreeInRadians=t.RightTextAlign=t.LeftTextAlign=t.RotatedTextPaddingMultiplier=t.MaxOrientationRange=t.MinOrientationRange=t.MaxUnicodeThaiRange=t.MinUnicodeThaiRange=t.FormulaErrorBorderStyle=t.FormulaErrorFontColor=t.FormulaErrorBackgroundColor=t.FontHeightToBaselineGapRatio=t.SkeletonCellsColor=t.SkeletonColor=void 0;var r=n(1);t.DefaultGridLineColor="#E0E0E0",t.DefaultGridLineColorBeforeFluent="#d4d4d4",t.SelectedCellsGridLineColor="#A0D8B9",t.NSVDefaultGridLineColor="#525252",t.NSVSelectedCellsGridLineColor="#BDBDBD",t.DefaultBorderGridLineColor="#BDBDBD",t.NSVDefaultBorderGridLineColor="#BDBDBD",t.HiddenRowColumnIndicatorLineColor="#818181",t.HiddenRowColumnIndicatorGapColor="#FFFFFF",t.PartialRowColSelectionHiddenRowColumnIndicatorLineColor="#666666",t.WholeRowColSelectionHiddenRowColumnIndicatorLineColor="#FFFFFF",t.NSVHiddenRowColumnIndicatorLineColor="#B3B3B3",t.NSVHiddenRowColumnIndicatorWithSelectionLineColor="#FFFFFF",t.PageLayoutLineColor="#9e9e9e",t.MinimalScaleFactorForGridlinesRendering=.4,t.InCellHorizontalPaddingPx=2,t.InCellEndOfTextHorizontalPaddingPx=2,t.InCellBottomAndCenterVerticalPaddingPx=1,t.InCellIndentPaddingPx=9,t.InCellVerticalPaddingPx=-1,t.TextLineHeightPx=20,t.GridLineWidthPx=1,t.SelectionBorderWidth=2,t.HighContrastPageLayoutWidthPx=2,t.DefaultBackgroundColor="#ffffff",t.DefaultCellFontColor="#000000",t.DefaultPreviewSuggestionContentFontColor="#66706F",t.EmptyLine={text:"",width:0,underlineWidth:0},t.EmptyFormattedText={Text:"",Fonts:[],TextRuns:[]},t.EmptyLineTextToken={tokens:[{text:"",width:0,start:0,containsThaiCharacters:!1}],containsThaiCharacters:!1},t.RightHorizontalAlignmentItalicExtraPadding=3,t.EmptyString="",t.Whitespace=" ",t.FullWidthSpace="",t.HardBreak="\n",t.HardBreakCR="\r",t.HardBreakCRLF="\r\n",t.ThinBorderWeight=1,t.MediumBorderWeight=2,t.ThickBorderWeight=3,t.DefaultDash=[],t.ColoredGridLineDash=[1,1],t.DottedLineDash=[2,2],t.DashedLineDash=[6,2],t.DashedDotLineDash=[9,3,3,3],t.DashedDotDotLineDash=[9,3,3,3,3,3],t.MediumDashedLineDash=[9,3],t.MediumDotDashedLineDash=[9,3,3,3],t.UnderlineLineWidth=1,t.UnderlineMarginFromTextBaseline=1,t.SkeletonColor="#E4E4E4",t.SkeletonCellsColor="#aaaaaa",t.FontHeightToBaselineGapRatio=.22;var o={Red:255,Green:0,Blue:0};t.FormulaErrorBackgroundColor="#FFFFFF",t.FormulaErrorFontColor="#000000",t.FormulaErrorBorderStyle={Borders:[{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Top,Color:o,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Bottom,Color:o,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Left,Color:o,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Right,Color:o,Weight:2}],ID:r.UniqueStyleID.FormulaError,RefCount:0},t.MinUnicodeThaiRange=3584,t.MaxUnicodeThaiRange=3711,t.MinOrientationRange=-90,t.MaxOrientationRange=90,t.RotatedTextPaddingMultiplier=4,t.LeftTextAlign="left",t.RightTextAlign="right",t.NinetyDegreeInRadians=Math.PI/2,t.GapBetweenDoubleUnderline=2,t.GapBetweenRotatedDoubleUnderline=3.14,t.BlockRowStartIndex=0,t.BlockRowEndIndex=27,t.BlockColumnStartIndex=0,t.BlockColumnEndIndex=29,t.RowCountInBlock=28,t.ColumnCountInBlock=30,t.pixelTranslation=.5,t.PatternTileSize=8,t.CellFontUnicodeFontFamily="XLYellow",t.CellIconBottomSizeRatioPadding=.1,t.ColumnHeaderGutterSize=11,t.RowHeaderCellHorizontalPaddingPx=2,t.HeaderCornerRadius=2,t.HeaderTextLineHeight=20,t.MaxColumnHeaderTextWidth=40,t.MaxRowHeaderTextWidth=53},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return o})),n.d(t,"__assign",(function(){return i})),n.d(t,"__rest",(function(){return l})),n.d(t,"__decorate",(function(){return a})),n.d(t,"__param",(function(){return s})),n.d(t,"__esDecorate",(function(){return d})),n.d(t,"__runInitializers",(function(){return u})),n.d(t,"__propKey",(function(){return c})),n.d(t,"__setFunctionName",(function(){return g})),n.d(t,"__metadata",(function(){return f})),n.d(t,"__awaiter",(function(){return h})),n.d(t,"__generator",(function(){return C})),n.d(t,"__createBinding",(function(){return m})),n.d(t,"__exportStar",(function(){return p})),n.d(t,"__values",(function(){return y})),n.d(t,"__read",(function(){return v})),n.d(t,"__spread",(function(){return S})),n.d(t,"__spreadArrays",(function(){return R})),n.d(t,"__spreadArray",(function(){return F})),n.d(t,"__await",(function(){return w})),n.d(t,"__asyncGenerator",(function(){return T})),n.d(t,"__asyncDelegator",(function(){return I})),n.d(t,"__asyncValues",(function(){return x})),n.d(t,"__makeTemplateObject",(function(){return b})),n.d(t,"__importStar",(function(){return A})),n.d(t,"__importDefault",(function(){return P})),n.d(t,"__classPrivateFieldGet",(function(){return H})),n.d(t,"__classPrivateFieldSet",(function(){return B})),n.d(t,"__classPrivateFieldIn",(function(){return M}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function l(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function a(e,t,n,r){var o,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(i<3?o(l):i>3?o(t,n,l):o(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l}function s(e,t){return function(n,r){t(n,r,e)}}function d(e,t,n,r,o,i){function l(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,s=r.kind,d="getter"===s?"get":"setter"===s?"set":"value",u=!t&&e?r.static?e:e.prototype:null,c=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),g=!1,f=n.length-1;f>=0;f--){var h={};for(var C in r)h[C]="access"===C?{}:r[C];for(var C in r.access)h.access[C]=r.access[C];h.addInitializer=function(e){if(g)throw new TypeError("Cannot add initializers after decoration has completed");i.push(l(e||null))};var m=(0,n[f])("accessor"===s?{get:c.get,set:c.set}:c[d],h);if("accessor"===s){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=l(m.get))&&(c.get=a),(a=l(m.set))&&(c.set=a),(a=l(m.init))&&o.push(a)}else(a=l(m))&&("field"===s?o.push(a):c[d]=a)}u&&Object.defineProperty(u,r.name,c),g=!0}function u(e,t,n){for(var r=arguments.length>2,o=0;o<t.length;o++)n=r?t[o].call(e,n):t[o].call(e);return r?n:void 0}function c(e){return"symbol"==typeof e?e:"".concat(e)}function g(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,n,r){return new(n||(n=Promise))((function(o,i){function l(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((r=r.apply(e,t||[])).next())}))}function C(e,t){var n,r,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(l=0)),l;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,r=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!(o=l.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){l.label=a[1];break}if(6===a[0]&&l.label<o[1]){l.label=o[1],o=a;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(a);break}o[2]&&l.ops.pop(),l.trys.pop();continue}a=t.call(e,l)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var m=Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function p(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return l}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function R(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],l=0,a=i.length;l<a;l++,o++)r[o]=i[l];return r}function F(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function T(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=o[e](t)).value instanceof w?Promise.resolve(n.value.v).then(s,d):u(i[0][2],n)}catch(e){u(i[0][3],e)}var n}function s(e){a("next",e)}function d(e){a("throw",e)}function u(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function I(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:w(e[r](t)),done:!1}:o?o(t):t}:o}}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=y(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}}function b(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var D=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return D(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function H(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function B(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyArgumentNotNull=void 0,t.verifyArgumentNotNull=function(e,t,n){if(null==e)throw Error("".concat(n,".verifyArgumentNotNull: ").concat(t," cannot be null or undefined"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSpillCellStartCol=t.getSpillCellEndCol=t.isIconAlignedToTheLeft=t.getAdjustedCellArea=t.getCellDimensionsAdjustedForDrawing=t.getSpillCellStartOffset=t.getOffsetLeftSpill=t.getSpillCellWidthAdjustedForDrawing=t.getSpillCellWidth=t.isCellSpansMultipleRowsOrBlocks=t.getCellTopAdjustedForDrawing=t.getCellCenterXAdjustedForDrawing=t.getCellCenterYAdjustedForDrawing=t.getCellBottomAdjustedForDrawing=t.getSpillCellRightAdjustedForDrawing=t.getCellRightAdjustedForDrawing=t.getSpillCellLeftAdjustedForDrawing=t.getCellLeftAdjustedForDrawing=t.getCellHeightAdjustedForDrawing=t.getCellWidthAdjustedForDrawing=t.getCellTop=t.getCellBottom=t.getCellRight=t.getCellLeft=t.getCellHeight=t.getCellWidth=void 0;var r=n(0),o=n(5),i=n(2),l=n(3),a=n(7),s=n(44);function d(e,t,n){return(0,o.verifyArgumentNotNull)(t,"cell","getCellWidth"),(0,o.verifyArgumentNotNull)(e,"model","getCellWidth"),(0,o.verifyArgumentNotNull)(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&(0,o.verifyArgumentNotNull)(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),T(e,t,n,!1)}function u(e,t,n){return(0,o.verifyArgumentNotNull)(t,"cell","getCellHeight"),(0,o.verifyArgumentNotNull)(e,"model","getCellHeight"),(0,o.verifyArgumentNotNull)(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge&&(0,o.verifyArgumentNotNull)(e.RowOffsets,"model.RowOffsets","getCellHeight"),w(e,t,n,!1)}function c(e,t){return F(e,t,!1,!1)}function g(e,t){return(0,o.verifyArgumentNotNull)(e,"model","getCellWidthAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(t,"cell","getCellWidthAdjustedForDrawing"),T(e,t,!1,!0)}function f(e,t){return(0,o.verifyArgumentNotNull)(e,"model","getCellHeightAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(t,"cell","getCellHeightAdjustedForDrawing"),w(e,t,!1,!0)}function h(e,t,n,r){return(0,o.verifyArgumentNotNull)(e,"model","getCellWidthAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getCellWidthAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),(0,o.verifyArgumentNotNull)(t,"cell","getCellWidthAdjustedForDrawing"),I(e,t,void 0,n,!0,r)}function C(e,t){return!e.IsRtl||t.RichValueIcon?h(e,t,!1,!1):m(e,t,!1)-y(t,e)+l.GridLineWidthPx}function m(e,t,n){var r=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,o=r.length-1,i=t.Col;if(!e.IsRtl||n)return h(e,t,n,!1)+g(e,t)-l.GridLineWidthPx;var a=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return r[o]+a-r[i]}function p(e,t,n){return F(e,t,!0,n)}function y(e,t){var n=b(t,R(e),!0),r=S(e,t),o=b(t,r,!0);return(0,i.getColWidthFromOffsets)(r,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+Math.abs(o-n)}function v(e,t){var n;return!!(0,s.isCFIconAlignedToTheLeft)(e,t)||(!!t.RichValueIcon||!(0,a.isNullOrUndefined)(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)&&!e.IsRtl)}function S(e,t){return(0,o.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}function R(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}function F(e,t,n,r){var o=x(e,t.Row,n);return t.Merge&&t.Merge.SpansBlocks&&!r&&(o-=function(e,t){return t?e.Merge.OriginDeltaYAdjustedForDrawing:e.Merge.OriginDeltaY}(t,n)),o}function w(e,t,n,r){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.HeightAdjustedForDrawing:e.Merge.Height}(t,r);var o=x(e,t.Row,r);return function(e,t,n){var r=t.Row+t.Merge.Rows;return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[r+1]:e.RowOffsets[r]+e.RowHeights[r]}(e,t,r)-o}return function(e,t,n){if(n)return(0,i.getRowHeightFromOffsets)(t.Row,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing);return e.RowHeights[t.Row]}(e,t,r)}function T(e,t,n,o){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.WidthAdjustedForDrawing:e.Merge.Width}(t,o);var l=b(e,t.Col,o);return function(e,t,n){var r=t.Col+t.Merge.Columns;return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[r+1]:e.ColumnOffsets[r]+e.ColumnWidths[r]}(e,t,o)-l}return function(e,t,n){return n?(0,i.getColWidthFromOffsets)(t.Col,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing):(0,r.getColumnWidth)(t.Col,e)}(e,t,o)}function I(e,t,n,r,o,i){var a=b(e,t.Col,o);return t.Merge&&t.Merge.SpansBlocks&&!i&&(a-=function(e,t){return t?e.Merge.OriginDeltaXAdjustedForDrawing:e.Merge.OriginDeltaX}(t,o)),!e.IsRtl||r?a:(o?m(e,t,r):n-a)-T(e,t,!1,o)+l.GridLineWidthPx}function x(e,t,n){return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[t]:e.RowOffsets[t]}function b(e,t,n){return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[t]:e.ColumnOffsets[t]}t.getCellWidth=d,t.getCellHeight=u,t.getCellLeft=function(e,t,n){return(0,o.verifyArgumentNotNull)(t,"cell","getCellWidth"),(0,o.verifyArgumentNotNull)(e,"model","getCellWidth"),(0,o.verifyArgumentNotNull)(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&(0,o.verifyArgumentNotNull)(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),I(e,t,n,!1,!1,!1)},t.getCellRight=function(e,t,n){var r=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(r-=t.Merge.OriginDeltaX),e.IsRtl?n-r:r+d(e,t,!1)-l.GridLineWidthPx},t.getCellBottom=function(e,t){return c(e,t)+u(e,t,!1)},t.getCellTop=c,t.getCellWidthAdjustedForDrawing=g,t.getCellHeightAdjustedForDrawing=f,t.getCellLeftAdjustedForDrawing=h,t.getSpillCellLeftAdjustedForDrawing=C,t.getCellRightAdjustedForDrawing=m,t.getSpillCellRightAdjustedForDrawing=function(e,t){return!t.Spill&&e.IsRtl?m(e,t,!1):h(e,t,!1,!1)+y(t,e)-l.GridLineWidthPx},t.getCellBottomAdjustedForDrawing=function(e,t){return p(e,t,!1)+f(e,t)},t.getCellCenterYAdjustedForDrawing=function(e,t){return p(e,t,!1)+f(e,t)/2},t.getCellCenterXAdjustedForDrawing=function(e,t,n){return(m(e,t,n)+h(e,t,n,!1))/2},t.getCellTopAdjustedForDrawing=p,t.isCellSpansMultipleRowsOrBlocks=function(e){return!(0,a.isNullOrUndefined)(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)},t.getSpillCellWidth=function(e,t){var n=t.ColumnOffsets[R(e)],r=S(e,t),o=t.ColumnOffsets[r];return t.ColumnWidths[r]+Math.abs(o-n)},t.getSpillCellWidthAdjustedForDrawing=y,t.getOffsetLeftSpill=function(e,t){var n=b(t,e.Col,!1),r=b(t,t.IsRtl?Math.max(R(e),S(e,t)):Math.min(R(e),S(e,t)),!1);return Math.abs(r-n)},t.getSpillCellStartOffset=function(e,t,n,r){var o=function(e,t,n,r){var o=v(e,t)?n:0,i=e.IsRtl?0:r;return o+i}(t,e,n,r),i=t.ColumnOffsets[R(e)]+o;if(t.IsRtl){var a=S(e,t),s=t.ColumnOffsets[a],d=t.ColumnWidths[a];return t.BlockWidth-s-d+o+l.GridLineWidthPx}return i},t.getCellDimensionsAdjustedForDrawing=function(e,t,n){return{x:h(e,t,n,!1)-l.GridLineWidthPx,y:p(e,t,!1)-l.GridLineWidthPx,width:g(e,t)+l.GridLineWidthPx,height:f(e,t)+l.GridLineWidthPx}},t.getAdjustedCellArea=function(e,t,n){var r=t.Spill&&n,o=r?C(e,t):h(e,t,!1,!1);return{x:o=e.IsRtl?o-l.GridLineWidthPx:o,y:p(e,t,!1),width:r?y(t,e):g(e,t),height:f(e,t)}},t.isIconAlignedToTheLeft=v,t.getSpillCellEndCol=S,t.getSpillCellStartCol=R},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringFormat=t.isNullOrUndefined=void 0,t.isNullOrUndefined=function(e){return null==e},t.stringFormat=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}},function(e,t,n){"use strict";n.r(t),n.d(t,"UlsLoggerWrapper",(function(){return o.b})),n.d(t,"ULS",(function(){return o.a})),n.d(t,"initializeLogger",(function(){return o.c})),n.d(t,"RemoteUlsLogger",(function(){return d})),n.d(t,"getUlsLogger",(function(){return u})),n.d(t,"getUlsLoggerDeprecated",(function(){return c})),n.d(t,"formatForUpload",(function(){return l})),n.d(t,"uploadLogs",(function(){return i})),n.d(t,"LogCategory",(function(){return f.a})),n.d(t,"LogType",(function(){return r})),n.d(t,"TraceLevel",(function(){return a.a})),n.d(t,"UnitTestLogger",(function(){return m})),n.d(t,"ConsoleLogger",(function(){return p.a})),n.d(t,"CategoryLogger",(function(){return y})),n.d(t,"NoopLogger",(function(){return C.a}));var r,o=n(50);function i(e,t,n){if(t){var r=window.navigator;if(r&&r.sendBeacon)try{return void r.sendBeacon(t,e)}catch(e){}!function(e,t,n){var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",t,n),r.send(e))}(e,t,n)}}function l(e,t,n,r){var o=[],i=e.map((function(e){return function(e,t,n){var r={};if(r.G=e.tag,r.T=e.timestamp-t,r.M=e.message,r.C=e.category,e.correlationId){var o=n.findIndex((function(t){return t===e.correlationId}));o<0&&(o=n.push(e.correlationId)-1),r.I=o}var i=1e3*e.type+e.level;return r.D=i,r}(e,r,o)})),l=function(e,t,n,r,o){var i={};i.T=e,i.L=t,i.S=n,i.I=r,o&&o.length>0&&(i.W=o);return i.V=1,i}(r,i,t,n,o);return JSON.stringify(l)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(r||(r={}));var a=n(16),s=function(){function e(t,n,r){var o=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){o.triggerUpload(!1,!1)},this.flush=function(){o.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return o.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,n){(window.clearTimeout(o.timeoutId),o.logCache.length>0)&&(o.uploadId+=1,i(l(o.logCache,o.userSessionId,o.uploadId,o.timestampBase),o.remoteUrlEndpoint,n),o.logCache=[],o.timestampBase=Date.now());t&&(o.timeoutId=window.setTimeout(o.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t;var a=n+"?usid="+t;void 0!==r&&r.forEach((function(e,t){a+="&"+t+"="+e})),this.remoteUrlEndpoint=a,window.setTimeout((function(){return o.triggerUpload(!0,!0)}),0)}return e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===a.a.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}(),d=function(){function e(e,t,n){this.correlationId="",this.cache=new s(e,t,n)}return e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.sendTraceTag=function(e,t,n,r){g(this.cache,e,t,n,r,this.correlationId)},e.prototype.debugAssertTag=function(e,t,n,r){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},e.prototype.shipAssertTag=function(e,t,n,r){n&&g(this.cache,e,t,a.a.Error,r,this.correlationId)},e.prototype.flush=function(){this.cache.flush()},e.prototype.flushOnClose=function(){this.cache.flushOnClose},e}();function u(e,t){return new d(e,t)}function c(e,t){var n=new s(e,t);return{sendTraceTag:function(e,t,r,o){return g(n,e,t,r,o,"")},shipAssertTag:function(e,t,r,o){r&&g(n,e,t,a.a.Error,o,"")},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:n.flush,flushOnClose:n.flushOnClose,setCorrelationId:function(){}}}function g(e,t,n,o,i,l){if(!(o>a.a.Info)){var s={timestamp:Date.now(),category:n,tag:t,level:o,type:r.Trace,message:i,correlationId:l};e.handleTrace(s)}}var f=n(77),h=n(4),C=n(49),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.__extends)(t,e),t}(C.a),p=n(81),y=function(){function e(e){this.category=e}return e.prototype.info=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];o.a.sendTraceTag(e,this.category,a.a.Info,this.messageToLog(t,n))},e.prototype.warn=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];o.a.sendTraceTag(e,this.category,a.a.Warning,this.messageToLog(t,n))},e.prototype.error=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];o.a.sendTraceTag(e,this.category,a.a.Error,this.messageToLog(t,n))},e.prototype.messageToLog=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!t.length)return e;var r=t.map((function(e){return JSON.stringify(e)})).join(", ");return"".concat(e,": ").concat(r)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellHorizontalIndentationPaddingPx=t.doesExpandCollapseButtonShiftText=t.getDistanceFromCellStartToIconEnd=t.getOverhangHashWidth=t.getNumFmtHashWidth=t.getNumFmtSeparatorWidth=t.getFormattedTextLineFontMetrics=t.getFormattedTextLineHeight=t.getLargestFont=t.getTextLineHeight=t.getBidiContext=t.measureTextHeightForVerticalText=t.measureTextRunsHeightForVerticalText=t.measureTextRunsWidth=t.cacheLegacyTextWidthOnCell=t.getTextWidthNoCaching=t.getTextWidth=t.getTextHorizontalPosition=t.getTextDecorationLineWidth=t.getYPositionForFontVerticalAlignmentRtf=t.getMiddleBaseline=t.getTextOffsetYAlphabeticBaseline=t.isCellBottomPaddingRequired=t.getTextVerticalPosition=t.getFontLineHeight=t.getCellAdornmentPadding=t.getHorizontalPadding=t.getWrapTextAdditionalPadding=t.getCellTextClipMask=t.getCellTextHorizontalPaddingWithoutVisualElements=t.getCellTextHorizontalPadding=t.getIndentationPaddingPx=t.getCellTextCenterX=t.calculateSubSuperOffsetY=t.calculateVerticalAlignment=t.measureTextWidth=void 0;var r=n(4),o=n(1),i=n(3),l=n(8),a=n(40),s=n(7),d=n(0),u=n(10),c=n(5),g=n(64),f=n(82),h=n(83),C=n(65),m=n(12),p=n(15),y=n(6),v=n(114),S=n(2),R=n(14),F=n(68),w=n(44),T=n(13),I=n(18),x=n(84),b=n(11),D=n(21),A=n(47),P=n(45),H=!0,B={},M={},O={},k={},L=0,N=0,E=0;function z(e,t,n,r){if(!t)return 0;if(r){N++;var o=e.font,i=(0,u.getFontNameFromCssString)(o),a=!!i&&(0,P.getFontLoadStatus)(i)!==P.FontLoadStatus.Pending,s=k[o];if(s){var d=s[t];if(d)return E++,d}else s={};var c=U(e,t,n);return a&&(s[t]=c,k[o]=s,L++),L===(0,b.getServiceSetting)(12,200)&&(l.ULS.sendTraceTag(544310413,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Info,'measureTextWidth: Cache Reset, {"cacheHits"='.concat(E,', "totalCalls"=').concat(N,"}")),L=0,k={},E=0,N=0),c}return U(e,t,n)}function W(e,t,n,r){var o=le(e,t,n,r),l=(0,y.isIconAlignedToTheLeft)(e,t)?o:0,a=(0,m.getExpandCollapseButtonPadding)(t),s=(0,m.shouldExpandCollapseButtonShiftText)(e,t)?a:0,d=e.IsRtl?i.GridLineWidthPx:0,u=(0,y.getCellLeft)(e,t,e.BlockWidth)+l+s,c=(0,y.getCellWidth)(e,t,!1)-o-a;return u+(c=Math.max(0,c))/2-d}function G(e){return e*i.InCellIndentPaddingPx}function V(e,t,n,r){return se(t,e,_(t,e,n,r))}function j(e,t,n,r,i,l,a,s){void 0===s&&(s=0);var d=ae(t,i),u=(0,p.getEffectiveHorizontalAlignment)(e,t),c=h.CalibriRegularPadding;switch(u){case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return d+(0,f.approximateValue)(n,c)+a+((0,o.isIncreasedHeaderSizeEnabled)(e)?s:0);case o.HorizontalAlignment.Right:return r&&(c=h.CalibriItalicPadding),d+(0,f.approximateValue)(n,c)+a+((0,o.isIncreasedHeaderSizeEnabled)(e)?s:0);case o.HorizontalAlignment.Center:case o.HorizontalAlignment.CenterAcrossSelection:return l?(0,f.approximateValue)(n,c):0;default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: ".concat(u))}}function _(e,t,n,r){var i=function(e,t,n,r){if(function(e,t){var n,r=(0,w.isCFIconAlignedToTheLeft)(e,t),i=!!(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)||!!t.RichValueIcon;if((r||i)&&!(0,D.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont)){var l=(0,y.isIconAlignedToTheLeft)(e,t),a=(0,p.getEffectiveHorizontalAlignment)(e,t);switch(a){case o.HorizontalAlignment.Right:return!l;case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return l;case o.HorizontalAlignment.Center:case o.HorizontalAlignment.CenterAcrossSelection:return!0;default:throw Error("unexpected context alignment ".concat(a))}}return!1}(e,t))return le(e,t,n,r);return 0}(e,t,n,r);return(0,m.shouldExpandCollapseButtonShiftText)(e,t)&&(i+=(0,m.getExpandCollapseButtonPadding)(t)),i+=(0,I.shouldAddAutoFilterPadding)(e,t)?(0,I.getAutoFilterButtonPadding)(e,t,n,r):0}function U(e,t,n){if(!t)return 0;if(n&&H){try{var r=t.replace(/^\s+|\s+$/g,""),o=e.measureText(r);if(!(0,s.isNullOrUndefined)(o.actualBoundingBoxLeft)&&!(0,s.isNullOrUndefined)(o.actualBoundingBoxRight)){var i=Math.abs(o.actualBoundingBoxRight)+Math.abs(o.actualBoundingBoxLeft),l=t.length-r.length,a=0;if(l>0)a=l*e.measureText(" ").width;return i+a}}catch(e){}H=!1}return de(e,t)}function q(e,t,n){var r=function(e,t,n){return(0,g.getCachedFontMetrics)(n,t,e).height}(e,t,n);return Math.ceil(r*a.LineHeightUsingDivFontFactor)}function Y(e,t){return(0,v.cellHasBottomDoubleBorder)(t,e)||(0,S.isCellShrunk)(t)}function X(e,t,n,r){switch(e){case o.FontVerticalAlignment.Subscript:var i=J(r);return n+t.baseline/2-i;case o.FontVerticalAlignment.Superscript:return n-2*(t.middle-t.baseline);default:throw Error("getYPositionForFontVerticalAlignmentRtf: Font vertical alignment ".concat(e," is unexpected here"))}}function J(e){return e?a.SubscriptVerticalPaddingForUnderlinePx:0}function K(e,t,n,r){return Q(e-(t+i.GridLineWidthPx-n)/2,r)}function Z(e,t,n){return Q(e+t,n)}function Q(e,t){return e-a.LineHeightBottomConstantPx-t}function $(e,t,n){n.CachedDrawingLayout||(n.CachedDrawingLayout={CellTextLayout:{}}),n.CachedDisplayText||(0,d.updateCellText)(t,n,n.Text);var r=!n.DisplayFormula&&n.TextRuns;if(n.CachedDrawingLayout.CellTextLayout.Width){if(r&&!n.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:n.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:n.CachedDrawingLayout.TextRunDrawingInformation}}var i=!(0,x.isTestRun)(),l=(0,d.getDisplayText)(n,t);if(r){var a=re(n),s=ee(e,n.TextRuns,n.Text,t,a);return{width:s.totalSize,textRunsDrawingInformation:s.textRunsDrawingInformation}}return{width:z(e,l,i,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t))}}function ee(e,t,n,r,o){var i=e.textAlign;e.textAlign="left";var l=te(e,r,n,!1,o,t);return e.textAlign=i,l}function te(e,t,n,i,l,a){for(var s=[],c=function(e,t,n){if(void 0!==e&&e.HasBidi)return(0,C.prepareTextRunsForBidiLayout)(t,n);return t}(l,a,n),g=0,f=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t),h=0;h<c.length;h++){var m=c[h],p={FontID:m.FontID||0,GlobalFontID:m.GlobalFontID,StartIndex:m.StartIndex},y=(0,d.getTextRunText)(h,c,n),v=m.CachedFont,S=(0,u.getFontCssStringFromFont)(v,void 0,t);if(i){var R=q(t,v.Size,v.FontName),F=ne(R,y);p.HeightPx=F,p.WidthPx=R,g+=F}else{e.font=S;var w=z(e,y,h===c.length-1,f);p.Underline=v.Underline,p.WidthPx=w,g+=w}p.Strikethrough=v.StrikeThrough,p.Text=y,p.FontCss=S,s[h]=r.__assign(r.__assign({},p),m)}return{textRunsDrawingInformation:s,totalSize:g}}function ne(e,t){return e*(0,F.breakToGraphemes)(t).length}function re(e){(0,c.verifyArgumentNotNull)(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");var t=e.CachedDrawingLayout.BidiContext;if(t)return t;var n=(0,C.analyzeBidiText)(e.Text,e.CachedStyle.ReadingOrder||o.ReadingOrderType.Context);return e.CachedDrawingLayout.BidiContext=n,n}function oe(e,t){(0,c.verifyArgumentNotNull)(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),(0,c.verifyArgumentNotNull)(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),(0,c.verifyArgumentNotNull)(e.CachedFont,"CachedFont","getTextLineHeight");var n,r=!!e.TextRuns;if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;r&&(n=ie(t,e.TextRuns));var o=r?n.Size:(0,u.getActualFontSizeFromFont)(t,e,e.CachedFont,!0),i=r?n.FontName:e.CachedFont.FontName;(0,s.isNullOrUndefined)(i)&&(0,T.setRenderingResultInfo)("\n    isRichText: ".concat(r,",\n    fontSize: ").concat(o,"\n    "));var l=q(t,o,i);return e.CachedDrawingLayout.CellTextLayout.LineHeight=l,l}function ie(e,t){for(var n,r=0;r<t.length;r++){var i=t[r],l=(0,o.getFontByID)(i,e,void 0);(!n||n.Size<l.Size)&&(n=l)}if(!n)throw"getLargestFont: Largest fonts is supposed to be defined";return n}function le(e,t,n,r){var o;if((0,d.isCellPreviewTextDefined)(t.PreviewText))return 0;if((!!(null===(o=t.LinkedEntity)||void 0===o?void 0:o.IconWidth)||!!t.RichValueIcon)&&t.DisplayFormula)return 0;var i=(0,u.getActualFontSize)(e,t);return(0,m.getIconSizeAndPadding)(e,t,i,n,r)}function ae(e,t){return(0,R.shouldRenderVerticalText)(e)?0:G(t)}function se(e,t,n){var r=t.CachedIndent||0,o=(0,u.getActualFontSize)(e,t),l=!(0,s.isNullOrUndefined)(t.WrapText)||(0,u.cellHasShrinkToFit)(t),a=(0,R.shouldRenderVerticalText)(t)?oe(t,e)/2:0,d=function(e){return e.IsRow?i.RowHeaderCellHorizontalPaddingPx:0}(e);return j(e,t,o,t.CachedFont.Italic,r,l,n,d)+a}function de(e,t){return e.measureText(t).width}function ue(e,t,n,r){var i=M[r];if((i||(M[r]=de(e,"#"),i=M[r]),n.CachedFont.Italic)&&!O[r]){var l=z(e,"#",!0,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t));O[r]=l-i}}t.measureTextWidth=z,t.calculateVerticalAlignment=function(e,t,n,r,i){if(i)return o.VerticalAlignment.Bottom;var l=t.CachedStyle,a=l.VerticalAlignment;return t.WrapText||t.Merge||l.VerticalText||!(n>r)||(0,D.shouldDrawRotatedText)(e,l,t.CachedFont)||(0,A.isVerticalAlignmentJustifyOrDistributed)(a)?a:o.VerticalAlignment.Center},t.calculateSubSuperOffsetY=function(e,t,n,r,o,i){return i?X(t,o,r,(0,m.isBottomPaddingNeededForSubscriptUnderline)(n,e.CachedStyle.VerticalAlignment)):0},t.getCellTextCenterX=W,t.getIndentationPaddingPx=G,t.getCellTextHorizontalPadding=V,t.getCellTextHorizontalPaddingWithoutVisualElements=function(e,t){return se(e,t,0)},t.getCellTextClipMask=function(e,t,n,r,o,i,l){return{x:t+(e.IsRtl&&!l?0:i),y:n,width:(0,S.getContainerClipMaskWidth)(r)-i,height:o}},t.getWrapTextAdditionalPadding=function(e,t,n){var r=(0,u.getActualFontSize)(e,t),o=!(0,s.isNullOrUndefined)(t.WrapText)||(0,u.cellHasShrinkToFit)(t),i=(0,I.shouldAddAutoFilterPadding)(e,t)?(0,I.getAutoFilterButtonPadding)(e,t,n.zoom,n.devicePixelRatio):0;return j(e,t,r,t.CachedFont.Italic,0,o,i)},t.getHorizontalPadding=j,t.getCellAdornmentPadding=_,t.getFontLineHeight=q,t.getTextVerticalPosition=function(e,t,n,r,l,a){var s,d,c=e.TextRuns,f=c?ie(t,e.TextRuns):e.CachedFont,h=c?f.Size:(0,u.getActualFontSize)(t,e),C=(0,y.getCellTop)(t,e),p=(0,y.getCellBottom)(t,e),v=Y(t,e)?i.InCellVerticalPaddingPx:0;if((0,u.isFontContainsVerticalAlignment)(f))if(a)s=a;else{var S=(0,g.getCachedFontMetrics)(f.FontName,h,t),R=(0,m.isBottomPaddingNeededForSubscriptUnderline)(f,l);s=function(e,t,n){switch(t){case o.FontVerticalAlignment.Subscript:return e.baseline/2+J(n);case o.FontVerticalAlignment.Superscript:return e.middle+(e.middle-e.baseline);default:return e.baseline}}(S,c?o.FontVerticalAlignment.None:f.VerticalAlign||0,R)}else s=a||(0,g.getCachedFontMetrics)(f.FontName,h,t).baseline;switch(l){case o.VerticalAlignment.Bottom:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:d=v+Q(p,s);break;case o.VerticalAlignment.Top:d=Z(C,n,s);break;case o.VerticalAlignment.Center:d=K(p,r,n,s);break;default:throw Error("getTextVerticalPosition: unsupported verticalAlignment: ".concat(l))}return{absoluteY:d,lastTextLineAlphabeticBaselineOffset:s}},t.isCellBottomPaddingRequired=Y,t.getTextOffsetYAlphabeticBaseline=function(e,t,n,r,i,l){var a=q(e,r,i),s=(0,g.getCachedFontMetrics)(i,r,e).baseline;switch(l){case o.VerticalAlignment.Center:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return K(t,n,a,s);case o.VerticalAlignment.Bottom:return Q(t,s);case o.VerticalAlignment.Top:return Z(t-n,a,s)}},t.getMiddleBaseline=function(e,t,n,r){var o=(0,g.getCachedFontMetrics)(n.FontName,r,e);return t-(o.middle-o.baseline)},t.getYPositionForFontVerticalAlignmentRtf=X,t.getTextDecorationLineWidth=function(e){return(0,f.approximateValue)(e,h.CalibriTextDecorationLineWidth)},t.getTextHorizontalPosition=function(e,t,n){var r=(0,p.getEffectiveHorizontalAlignment)(e,t),l=V(t,e,n.zoom,n.devicePixelRatio);switch(r){case o.HorizontalAlignment.Right:return(0,y.getCellRight)(e,t,e.BlockWidth)-l;case o.HorizontalAlignment.Center:return W(e,t,n.zoom,n.devicePixelRatio);case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return(0,y.getCellLeft)(e,t,e.BlockWidth)+l;case o.HorizontalAlignment.CenterAcrossSelection:return function(e,t,n,r){if(t.Spill){var o=le(e,t,n,r),l=(0,m.getExpandCollapseButtonPadding)(t),a=e.IsRtl?i.GridLineWidthPx:0,s=(0,y.getSpillCellWidth)(t,e)-o-l;return(0,y.getSpillCellStartOffset)(t,e,o,l)+s/2-a}return W(e,t,n,r)}(e,t,n.zoom,n.devicePixelRatio);default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: ".concat(r))}},t.getTextWidth=function(e,t,n){var r=$(e,t,n),o=r.width,i=r.textRunsDrawingInformation;return n.CachedDrawingLayout.CellTextLayout.Width=o,n.CachedDrawingLayout.TextRunDrawingInformation=i,o},t.getTextWidthNoCaching=function(e,t,n){return $(e,t,n).width},t.cacheLegacyTextWidthOnCell=function(e,t,n){var r=z(e,n.CachedDisplayText,!1,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TextWidthClientPhase1,t));n.CachedDrawingLayout.CellTextLayout.Width=r},t.measureTextRunsWidth=ee,t.measureTextRunsHeightForVerticalText=function(e,t,n,r,o,i,l){return o?{textRunsDrawingInformation:[],totalSize:i*n.length}:te(e,r,n,!0,l,t)},t.measureTextHeightForVerticalText=ne,t.getBidiContext=re,t.getTextLineHeight=oe,t.getLargestFont=ie,t.getFormattedTextLineHeight=function(e,t){var n=ie(e,t.TextRuns);return q(e,n.Size,n.FontName)},t.getFormattedTextLineFontMetrics=function(e,t){var n=ie(e,t.TextRuns);return(0,g.getCachedFontMetrics)(n.FontName,n.Size,e)},t.getNumFmtSeparatorWidth=function(e,t,n,r){(0,c.verifyArgumentNotNull)(r,"numFmt","getNumFmtSeparatorWidth"),(0,c.verifyArgumentNotNull)(r.Separator,"separator","getNumFmtSeparatorWidth");var o=r.Separator,i=(0,u.getFontCssStringFromCell)(n,t)+o,l=B[i];if((0,s.isNullOrUndefined)(l)||0===l){var a=de(e,o);return B[i]=a,a}return B[i]},t.getNumFmtHashWidth=function(e,t,n){(0,c.verifyArgumentNotNull)(n,"cell","getNumFmtSeparatorWidth");var r=(0,u.getFontCssStringFromCell)(n,t);return ue(e,t,n,r),M[r]},t.getOverhangHashWidth=function(e,t,n){(0,c.verifyArgumentNotNull)(n,"cell","getOverhangHashWidth");var r=(0,u.getFontCssStringFromCell)(n,t);return ue(e,t,n,r),O[r]},t.getDistanceFromCellStartToIconEnd=le,t.doesExpandCollapseButtonShiftText=function(e,t){var n=(0,p.getEffectiveHorizontalAlignment)(e,t);switch(n){case o.HorizontalAlignment.Left:case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Center:return!e.IsRtl;case o.HorizontalAlignment.Right:return e.IsRtl;case o.HorizontalAlignment.Automatic:default:throw Error("doesExpandCollapseButtonShiftText: unsupported horizontalAlignment: ".concat(n))}},t.getCellHorizontalIndentationPaddingPx=ae},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActualFontSizeFromFont=t.getActualFontSize=t.cellHasShrinkToFit=t.getShrunkFontSize=t.getFontLookupKey=t.getCellFontWeightStyle=t.getFontNameFromCssString=t.getFontCssString=t.isFontContainsVerticalAlignment=t.getFontCssStringFromFont=t.getFontCssStringFromCell=t.canonizeFontNameNoLowercase=t.canonizeFontName=t.getRenderedFontsCount=t.incrementFontCount=t.isFontSupportedNew=t.isKnownFont=t.sanitizeFontName=t.getFontNameForLogging=void 0;var r=n(40),o=n(11),i=n(1),l=n(0),a=n(13),s=n(7),d=n(161),u=n(38),c=n(162),g={},f={totalCount:0,unknown:0,static:0,flat:0,hierarchical:0},h=new Set;function C(e){var t="Custom Font";return p(e)&&(t=m(e)),t}function m(e){return"Sanitized_".concat(e)}function p(e){return r.KnownFontNamesLowerCase.indexOf(e.replace(/\s/g,"").toLowerCase())>-1}function y(e,t){if(!h.has(e))switch(h.add(e),f.totalCount+=1,t){case 0:f.unknown+=1;break;case 1:f.static+=1;break;case 2:f.flat+=1;break;case 3:f.hierarchical+=1}}function v(e){var t=e,n=e.indexOf("(Body)");return n>0&&(t=e.substring(0,n).trim()),t.replace(/[\""]/g,"").toLowerCase()}function S(e,t,n){var o,i=!!e.Bold,l=w(i,!!e.Italic),a=null!==(o=null!=t?t:e.Size)&&void 0!==o?o:r.DefaultFontSizePt;return R(e)&&(a=(0,d.getVerticalAlignmentFontSizeAdjusted)(a)),F(n,l,a,e.FontName,i)}function R(e){return!(0,s.isNullOrUndefined)(e.VerticalAlign)&&e.VerticalAlign!==i.FontVerticalAlignment.None}function F(e,t,n,r,o){void 0===o&&(o=!1);var l=v(r);e.ClientOnlyCache&&e.ClientOnlyCache.FallbackFonts&&e.ClientOnlyCache.FallbackFonts[T(l,n)]&&(l=u.DefaultFallbackFontName);var a="".concat(t," ").concat(n,'pt "').concat(l,'"'),s=(0,i.isRenderFlagEnabled)(i.RenderFlagsArray.FluentStyle,e)&&(0,i.isChangeGateEnabled)(i.ChangeGate.CanonizedFontCssString),d=(0,c.cssFontToCanvasFont)(a,o,s);return g[d]=r,d}function w(e,t){return e&&t?"bold italic":e?"bold":t?"italic":"normal"}function T(e,t){var n=v(e);return"".concat(t,"pt ").concat(n)}function I(e){if(x(e))return e.ShrunkSize}function x(e){return!((0,l.isCellPreviewTextDefined)(e.PreviewText)||e.DisplayFormula||!e.CachedStyle.ShrinkToFit||e.WrapText)}function b(e,t,n,r){var o,l,s=x(t),u=s?t.ShrunkSize:n.Size;return((0,i.isRenderFlagEnabled)(i.RenderFlagsArray.FluentStyle,e)&&(0,i.isChangeGateEnabled)(i.ChangeGate.ActualFontSizeOptimization)&&!r&&R(n)||R(n)&&!r)&&(u=(0,d.getVerticalAlignmentFontSizeAdjusted)(u)),u<0&&(0,a.setRenderingResultInfo)("\n      actual font size < 0.\n      doesCellHaveShrinkToFit: ".concat(s,",\n      cell.ShrunkSize: ").concat(t.ShrunkSize,",\n      Font:\n        size: ").concat(n.Size,";\n        fontName: ").concat(C(n.FontName),";\n        refCount: ").concat(n.RefCount||0,";\n      cell.CachedStyle:\n        isHidden: ").concat(!!(null===(o=t.CachedStyle)||void 0===o?void 0:o.IsHidden),";\n        shrinkToFit: ").concat(!!(null===(l=t.CachedStyle)||void 0===l?void 0:l.ShrinkToFit),";\n      cell.Ifmt: ").concat(t.Ifmt||0,";\n      cell.WrapText: ").concat(t.WrapText,";\n    ")),u}t.getFontNameForLogging=C,t.sanitizeFontName=m,t.isKnownFont=p,t.isFontSupportedNew=function(e,t){if((0,l.isModernFontPickerEnabled)(t)){var n=(0,o.getFontFamilyEndPoint)(e);return y(e,n),0!==n}return p(e)},t.incrementFontCount=y,t.getRenderedFontsCount=function(){return f},t.canonizeFontName=v,t.canonizeFontNameNoLowercase=function(e){var t=e,n=e.indexOf("(Body)");return n>0&&(t=e.substring(0,n).trim()),t.replace(/[\""]/g,"")},t.getFontCssStringFromCell=function(e,t){return S(e.CachedFont,I(e),t)},t.getFontCssStringFromFont=S,t.isFontContainsVerticalAlignment=R,t.getFontCssString=F,t.getFontNameFromCssString=function(e){return g[e]},t.getCellFontWeightStyle=w,t.getFontLookupKey=T,t.getShrunkFontSize=I,t.cellHasShrinkToFit=x,t.getActualFontSize=function(e,t){return b(e,t,t.CachedFont,!0)},t.getActualFontSizeFromFont=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onAutoFilterPointerDown=t.isexternalCallbacksRegistered=t.getTooltipTitle=t.isEditing=t.getTopBorderForBottomCell=t.getLeftBorderForNextCell=t.inRangePicker=t.getFontFamilyEndPoint=t.isFontSupported=t.headerInsertButtonInvokedCallback=t.headerInsertHitAreaHoveredCallback=t.isHeaderInsertAllowed=t.isHeaderDragAllowed=t.isResizeAllowed=t.getBlockStatisticLog=t.blockCacheSizeCallback=t.getTablesRangeContainingRange=t.showOrHideHyperlinkFloatie=t.showCtrlClickHyperlinkCallout=t.invalidHyperlinkCallback=t.shouldHitTestHandleEvent=t.getDevicePixelRatio=t.getAppZoom=t.getServiceSetting=t.expandCollapseOutlines=t.onHeaderDragStartCallback=t.onHeaderUnhideRowColCallback=t.onHeaderResizeStartCallback=t.setOrRemoveResizeZoneHoveredCallback=t.setOrRemoveHoveredCellCallback=t.tableSelectorsCallback=t.setLastInputMethod=t.togglePivotDrill=t.togglePivotDrillFromChildElement=t.handleGoTo=t.followHyperlink=t.invokeRibbonCommandWithCellReference=t.showOrCloseFloatingCommentCallback=t.pivotFilterClickHandler=t.handleRibbonCommand=t.registerExternalCallbacks=void 0;var r,o=n(7),i=n(5);t.registerExternalCallbacks=function(e){r=e},t.handleRibbonCommand=function(e,t,n,o,l,a){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","handleRibbonCommand"),r.handleRibbonCommandCallback(e,t,n,o,l,a)},t.pivotFilterClickHandler=function(e,t,n,o,l){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","showPivotFilterMenu"),r.pivotFilterClickHandlerCallback(e,t,n,o,l)},t.showOrCloseFloatingCommentCallback=function(e,t,n){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","showFloatingCommentCallback"),r.showOrCloseFloatingCommentCallback(e,t,n)},t.invokeRibbonCommandWithCellReference=function(e,t,n,o){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","invokeRibbonCommandWithCellReference"),r.invokeRibbonCommandWithCellReferenceCallback(e,t,n,o)},t.followHyperlink=function(e,t){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","followHyperlink"),r.followHyperlinkCallback(e,t)},t.handleGoTo=function(e,t,n,o,l,a,s){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","handleGoTo"),r.handleGoToCallback(e,t,n,o,l,a,s)},t.togglePivotDrillFromChildElement=function(e){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","togglePivotDrillFromChildElement"),r.togglePivotDrillFromChildElementCallback(e)},t.togglePivotDrill=function(e,t,n,o,l){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","togglePivotDrill"),r.togglePivotDrillCallback(e,t,n,o,l)},t.setLastInputMethod=function(e){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","setLastInputMethod"),r.setLastInputMethod(e)},t.tableSelectorsCallback=function(e,t,n,o){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","tableSelectorsCallback"),r.tableSelectorsCallback(e,t,n,o)},t.setOrRemoveHoveredCellCallback=function(e,t,n,o){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","setOrRemoveHoveredCellCallback"),r.setOrRemoveHoveredCellCallback(e,t,n,o)},t.setOrRemoveResizeZoneHoveredCallback=function(e,t,n,o){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","setOrRemoveResizeZoneHoveredCallback"),r.setOrRemoveResizeZoneHoveredCallback(e,t,n,o)},t.onHeaderResizeStartCallback=function(e,t,n,o,l,a,s){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","onHeaderResizeStartCallback"),r.onHeaderResizeStartCallback(e,t,n,o,l,a,s)},t.onHeaderUnhideRowColCallback=function(e,t,n,o,l){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","onHeaderUnhideRowColCallback"),r.onHeaderUnhideRowColCallback(e,t,n,o,l)},t.onHeaderDragStartCallback=function(e,t,n){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","onHeaderDragStartCallback"),r.onHeaderDragStartCallback(e,t,n)},t.expandCollapseOutlines=function(e,t,n,o){(0,i.verifyArgumentNotNull)(r,"externalCallbacks","setOutlineLevelCanvas"),r.expandCollapseOutlines(e,t,n,o)};var l={};t.getServiceSetting=function(e,t){if(!r)return t;if(!(0,o.isNullOrUndefined)(l[e]))return l[e];var n=r.getServiceSetting(e);return l[e]=n,(0,o.isNullOrUndefined)(n)?t:n},t.getAppZoom=function(){return r.getAppZoom()},t.getDevicePixelRatio=function(){return r.getDevicePixelRatio()},t.shouldHitTestHandleEvent=function(){return r.shouldHitTestHandleEvent()},t.invalidHyperlinkCallback=function(){return r.invalidHyperlinkCallback()},t.showCtrlClickHyperlinkCallout=function(e,t){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","showCtrlClickHyperlinkCallout"),r.showCtrlClickHyperlinkCallout&&r.showCtrlClickHyperlinkCallout(e,t)},t.showOrHideHyperlinkFloatie=function(e,t,n,o){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","showOrHideHyperlinkFloatie"),r.showOrHideHyperlinkFloatie(e,t,n,o)},t.getTablesRangeContainingRange=function(e,t){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","getTablesRangeContainingRangeCallback"),r.getTablesRangeContainingRange(e,t)},t.blockCacheSizeCallback=function(){return r.blockCacheSizeCallback()},t.getBlockStatisticLog=function(){return r.getBlockStatisticLog()},t.isResizeAllowed=function(e){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","isResizeAllowed"),r.isResizeAllowed(e)},t.isHeaderDragAllowed=function(){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","isHeaderDragAllowed"),r.isHeaderDragAllowed()},t.isHeaderInsertAllowed=function(e,t,n){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","isHeaderInsertAllowed"),r.isHeaderInsertAllowed(e,t,n)},t.headerInsertHitAreaHoveredCallback=function(e,t,n,o){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","onHeaderInsertAreaHovered"),r.headerInsertHitAreaHoveredCallback(e,t,n,o)},t.headerInsertButtonInvokedCallback=function(e,t,n,o){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","onHeaderInsertButtonClick"),r.headerInsertButtonInvokedCallback(e,t,n,o)},t.isFontSupported=function(e){return r.isFontSupported(e)},t.getFontFamilyEndPoint=function(e){return"function"==typeof r.getFontFamilyEndPoint?r.getFontFamilyEndPoint(e):0},t.inRangePicker=function(){return(0,i.verifyArgumentNotNull)(r,"externalCallbacks","inRangePicker"),r.inRangePicker()},t.getLeftBorderForNextCell=function(e,t){return r.getLeftBorderForNextCell(e,t)},t.getTopBorderForBottomCell=function(e,t){return r.getTopBorderForBottomCell(e,t)},t.isEditing=function(){return r.isEditing()},t.getTooltipTitle=function(e){return r.getTooltipTitle(e)},t.isexternalCallbacksRegistered=function(){return!(0,o.isNullOrUndefined)(r)},t.onAutoFilterPointerDown=function(){if(r.onAutoFilterPointerDown)return r.onAutoFilterPointerDown()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pointsToPixels=t.cellTextReplacedWithHashes=t.getCellRightVisualElementsPadding=t.shouldExpandCollapseButtonShiftText=t.getExpandCollapseButtonWidth=t.getExpandCollapseButtonPadding=t.getIconSizeAndPadding=t.adjustNumberToRange=t.isBottomPaddingNeededForSubscriptUnderline=t.getIconHorizontalPadding=t.getIconSize=void 0;var r=n(82),o=n(83),i=n(1),l=n(57),a=n(3),s=n(15),d=n(66),u=n(163),c=n(18),g=n(38);function f(e,t){return Math.floor((0,r.approximateValue)(e,o.FontSizeToIconSize)*t)}function h(e,t){return Math.floor((0,r.approximateValue)(e,o.IconHorizontalPadding)*t)}function C(e){var t;return(null===(t=e.PivotTable)||void 0===t?void 0:t.HasExpandCollapseIndicator)?l.ExpandCollapseButtonSizePx+l.PaddingBetweenExpandCollapseButtonAndTextPx:0}t.getIconSize=f,t.getIconHorizontalPadding=h,t.isBottomPaddingNeededForSubscriptUnderline=function(e,t){return t===i.VerticalAlignment.Bottom&&(e.Underline===i.FontUnderline.Single||e.Underline===i.FontUnderline.Double)},t.adjustNumberToRange=function(e,t,n){return e<t?t:e>n?n:e},t.getIconSizeAndPadding=function(e,t,n,r,o){var i;if(null===(i=t.CondFormat)||void 0===i?void 0:i.Icon)return f(n,1)+h(n,1)+a.GridLineWidthPx;if(t.RichValueIcon){var l=(0,u.shouldAddRichValueIconPadding)(e,t)?(0,c.getAutoFilterButtonPadding)(e,t,r,o):0;return t.RichValueIcon.Width+d.RichValueIconRightHorizontalPadding+l}return 0},t.getExpandCollapseButtonPadding=C,t.getExpandCollapseButtonWidth=function(e){return e?l.ExpandCollapseButtonSizePx+l.PaddingBetweenExpandCollapseButtonAndTextPx:0},t.shouldExpandCollapseButtonShiftText=function(e,t){var n=(0,s.getEffectiveHorizontalAlignment)(e,t);switch(n){case i.HorizontalAlignment.Left:case i.HorizontalAlignment.CenterAcrossSelection:case i.HorizontalAlignment.Center:return!e.IsRtl;case i.HorizontalAlignment.Right:return e.IsRtl;case i.HorizontalAlignment.Automatic:default:throw Error("shouldExpandCollapseButtonShiftText: unsupported horizontalAlignment: ".concat(n))}},t.getCellRightVisualElementsPadding=function(e,t){var n;return e.IsRtl&&(null===(n=t.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator)?C(t):0},t.cellTextReplacedWithHashes=function(e){if(!e.Text)return!1;var t=e.Text.split("#").length-1;return e.CachedIsTextWidthExceedsCellWidth||t===e.Text.length&&e.ValueType===i.CellValueType.Number},t.pointsToPixels=function(e,t){return void 0===t&&(t=1),Math.round(e*t*g.pixelsPerPoint)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRenderingResultInfo=t.setRenderingResultMonitorable=t.getRenderingMessage=t.RenderPerformanceMetric=t.trackDuration=t.clearPerformanceMetrics=t.createRenderResult=t.verifyPerformanceNowSupported=t.perf=void 0;var r=n(1),o="",i=[],l=[];t.perf=u()?window.performance:void 0;var a,s,d=void 0;function u(){if(d)return d;d=!1,window.performance&&"function"==typeof window.performance.now&&(d=!0);try{window.performance.now()}catch(e){d=!1}return d}function c(e,t){var n;e&&""!==e&&(o=(o+"; "+e).substring(0,2500),(n=t)>g()&&(s=n))}function g(){return void 0===s?0:s}t.verifyPerformanceNowSupported=u,t.createRenderResult=function(e,t){return{succeeded:e,message:t,performance:i,counters:l,messageLevel:g()}},t.clearPerformanceMetrics=function(){i=[],l=[]},t.trackDuration=function(e,n,o,a){var s=t.perf?t.perf.now():-1;if(n(),t.perf){var d=t.perf.now()-s,u=(0,r.isChangeGateEnabled)(r.ChangeGate.FixAggregatedPerfTelemetry),c=(0,r.isChangeGateEnabled)(r.ChangeGate.OptimizeHeaderTextRendering);!o||u&&!i[e]?(i[e]=d,c&&a&&(l[e]=1)):(i[e]+=d,c&&a&&l[e]++)}},function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderInternalDurationMs=3]="RenderInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs",e[e.ReorderBidiTextRuns=17]="ReorderBidiTextRuns",e[e.DrawPageBreaksDurationMs=18]="DrawPageBreaksDurationMs",e[e.DrawSkeletonMs=19]="DrawSkeletonMs",e[e.DrawPrintAreasDurationMs=20]="DrawPrintAreasDurationMs",e[e.ClearGridLinesForPivotTable=21]="ClearGridLinesForPivotTable",e[e.DrawEmptyPivotTableTitleContainers=22]="DrawEmptyPivotTableTitleContainers",e[e.DrawEmptyPivotTableImages=23]="DrawEmptyPivotTableImages",e[e.DrawEmptyPivotTableTitleText=24]="DrawEmptyPivotTableTitleText",e[e.DrawDataBarsMs=25]="DrawDataBarsMs",e[e.DrawSparklines=26]="DrawSparklines",e[e.DrawExpandCollapseButtonsMs=27]="DrawExpandCollapseButtonsMs",e[e.DrawAutoFiltersMs=28]="DrawAutoFiltersMs",e[e.RegisterHitRegionsMs=29]="RegisterHitRegionsMs",e[e.DrawInCellImagesMs=30]="DrawInCellImagesMs",e[e.DrawRichErrorMs=31]="DrawRichErrorMs",e[e.DrawCommentsMs=32]="DrawCommentsMs",e[e.DrawRichValueIcons=33]="DrawRichValueIcons",e[e.DrawPhoneticTextDurationMs=34]="DrawPhoneticTextDurationMs",e[e.HyperlinkEventRegistrationMs=35]="HyperlinkEventRegistrationMs",e[e.CellTooltipRegistrationMs=36]="CellTooltipRegistrationMs",e[e.RegisterTableSelectorsMs=37]="RegisterTableSelectorsMs",e[e.DrawPreviewCellsModeOverlayMs=38]="DrawPreviewCellsModeOverlayMs",e[e.DrawSkeletonCellsMs=39]="DrawSkeletonCellsMs",e[e.RegisterHeaderHitRegionsToModelMs=40]="RegisterHeaderHitRegionsToModelMs",e[e.DrawTableBordersMs=41]="DrawTableBordersMs",e[e.DrawHiddenRowColDurationMs=42]="DrawHiddenRowColDurationMs",e[e.DrawOutlines=43]="DrawOutlines",e[e.DrawPatternMs=44]="DrawPatternMs",e[e.DrawAutoFiltersForHeaderSnappingMs=45]="DrawAutoFiltersForHeaderSnappingMs",e[e.DrawInCellControls=46]="DrawInCellControls",e[e.DrawRowColDragAndDropSixSquaresDurationMs=47]="DrawRowColDragAndDropSixSquaresDurationMs",e[e.DrawResizePillDurationMs=48]="DrawResizePillDurationMs",e[e.ClearColumnHeaderGutterAreaDurationMs=49]="ClearColumnHeaderGutterAreaDurationMs",e[e.DrawHeaderCellTextDurationMs=50]="DrawHeaderCellTextDurationMs",e[e.DrawSingleCellTextDurationMs=51]="DrawSingleCellTextDurationMs",e[e.DrawInsertDotAndInsertButton=52]="DrawInsertDotAndInsertButton",e[e.DrawTextTextLineHeight=53]="DrawTextTextLineHeight",e[e.DrawTextTextMaxWidth=54]="DrawTextTextMaxWidth",e[e.DrawTextUpdateCellContext=55]="DrawTextUpdateCellContext"}(a||(t.RenderPerformanceMetric=a={})),t.getRenderingMessage=function(){var e=o;o="";var t=g();return s=void 0,{message:e,level:t}},t.setRenderingResultMonitorable=function(e){c(e,1)},t.setRenderingResultInfo=function(e){c(e,0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHorizontalAlignmentJustifiedOrDistributedForVerticalText=t.isVerticalAlignmentJustifiedOrDistributedForVerticalText=t.shouldRenderVerticalText=void 0;var r=n(1);function o(e){var t;return!0===(null===(t=e.CachedStyle)||void 0===t?void 0:t.VerticalText)&&!e.DisplayFormula&&!e.PreviewText}t.shouldRenderVerticalText=o,t.isVerticalAlignmentJustifiedOrDistributedForVerticalText=function(e){if(o(e))switch(e.CachedStyle.VerticalAlignment){case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:return!0}return!1},t.isHorizontalAlignmentJustifiedOrDistributedForVerticalText=function(e){var t;if(o(e))switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Distributed:return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustXForHorizontalAlignment=t.getEffectiveHorizontalAlignment=t.getTextAlignment=t.isHorizontalAlignmentAdvance=t.isHorizontalAlignmentJustifiedAndDistributed=t.isHorizontalAlignmentCenteredAcrossSelection=void 0;var r=n(1),o=n(7),i=n(2),l=n(21),a=n(14),s=n(0);function d(e,t){var n,d,u,c;if(t.DisplayFormula)return r.HorizontalAlignment.Left;if((0,s.isCellPreviewTextDefined)(t.PreviewText)&&(null===(n=t.PreviewCellStyle)||void 0===n?void 0:n.HorizontalAlignment))return t.PreviewCellStyle.HorizontalAlignment;var g=(null===(d=t.CachedStyle)||void 0===d?void 0:d.HorizontalAlignment)||r.HorizontalAlignment.Automatic;if((null===(u=t.PivotTable)||void 0===u?void 0:u.HasExpandCollapseIndicator)&&!(0,o.isNullOrUndefined)(t.Spill)&&g!==r.HorizontalAlignment.CenterAcrossSelection)return e.IsRtl?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;if((0,l.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont))return(0,l.getOrientationInCanvas)(e.IsRtl,null===(c=t.CachedStyle)||void 0===c?void 0:c.Orientation)<0?r.HorizontalAlignment.Left:r.HorizontalAlignment.Right;switch(g){case r.HorizontalAlignment.Fill:return e.IsRtl?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.Automatic:return(0,a.shouldRenderVerticalText)(t)?r.HorizontalAlignment.Left:function(e,t){var n,l,a,s=(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)||r.HorizontalAlignment.Automatic;if((null===(l=t.PivotTable)||void 0===l?void 0:l.HasExpandCollapseIndicator)&&(s===r.HorizontalAlignment.Distributed||s===r.HorizontalAlignment.Fill))return e.IsRtl?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;switch((null===(a=t.CachedStyle)||void 0===a?void 0:a.ReadingOrder)||r.ReadingOrderType.Context){case r.ReadingOrderType.LeftToRight:return r.HorizontalAlignment.Left;case r.ReadingOrderType.RightToLeft:return r.HorizontalAlignment.Right;case r.ReadingOrderType.Context:var d=t.Text;if(!(0,o.isNullOrUndefined)(d)&&""!==d)return(0,i.isRtlChar)(d[0])?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left}return r.HorizontalAlignment.Left}(e,t)}return g}t.isHorizontalAlignmentCenteredAcrossSelection=function(e){var t;return(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.CenterAcrossSelection},t.isHorizontalAlignmentJustifiedAndDistributed=function(e){var t;switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Distributed:return!0}return!1},t.isHorizontalAlignmentAdvance=function(e){return e>r.HorizontalAlignment.Right},t.getTextAlignment=function(e,t){if((0,a.shouldRenderVerticalText)(t))return"center";var n=d(e,t);switch(n){case r.HorizontalAlignment.Right:return"right";case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return"center";case r.HorizontalAlignment.Left:return"left";default:throw Error("getTextAlignment: unsupported horizontalAlignment: ".concat(n))}},t.getEffectiveHorizontalAlignment=d,t.adjustXForHorizontalAlignment=function(e,t,n,o){var i=0,l=d(e,t);switch(l){case r.HorizontalAlignment.Left:i=n;break;case r.HorizontalAlignment.Right:i=n-o;break;case r.HorizontalAlignment.Center:case r.HorizontalAlignment.CenterAcrossSelection:i=n-o/2;break;default:throw Error("unexpected context alignment ".concat(l))}return i}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);r.__exportStar(n(79),t),r.__exportStar(n(148),t),r.__exportStar(n(80),t),r.__exportStar(n(149),t),r.__exportStar(n(150),t),r.__exportStar(n(151),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilterLeftAdjustedForDrawing=t.getFilterBottomAdjustedForDrawing=t.isTextAlignedOnButton=t.shouldAddAutoFilterPaddingForMetadata=t.shouldAddAutoFilterPadding=t.getAutoFilterPaddingForAdvancedHorizontalAlignment=t.getAutoFilterButtonPaddingForShrinkToFit=t.getAutoFilterButtonPadding=t.getFilterSizeAdjustedForDrawing=void 0;var r=n(1),o=n(6),i=n(2),l=n(23),a=n(46),s=n(66);function d(e,t,n,r){return(0,l.getInteractiveIconMaxSizeAdjustedForDrawing)(a.AutoFilterIconRectPx,e,t,n,r,!1,!0)}function u(e,t,n,o){var i=d(e,t,1,n);if((0,r.isChangeGateEnabled)(r.ChangeGate.RichIconFilterScale)&&t.RichValueIcon&&!t.PivotTable){var l=(a.AutoFilterTextHorizontalPaddingPx+s.RichValueIconLeftHorizontalPadding)/o;return Math.round(i/n+l)}return Math.round(t.PivotTable&&t.RichValueIcon?(i/n+a.AutoFilterTextHorizontalPaddingPx)*o:i/n+a.AutoFilterTextHorizontalPaddingPx*o)}function c(e,t){return(null==t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Right&&!e.IsRtl||(null==t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Left&&e.IsRtl}t.getFilterSizeAdjustedForDrawing=d,t.getAutoFilterButtonPadding=u,t.getAutoFilterButtonPaddingForShrinkToFit=function(e,t,n,o){return function(e,t){var n,o;if(!(null===(n=t.CachedStyle)||void 0===n?void 0:n.ShrinkToFit))return!1;var i=(null===(o=t.CachedStyle)||void 0===o?void 0:o.HorizontalAlignment)||r.HorizontalAlignment.Automatic,l=e.IsRtl?i===r.HorizontalAlignment.Right:i===r.HorizontalAlignment.Left;return t.AutoFilter&&l}(e,t)?u(e,t,n,o):0},t.getAutoFilterPaddingForAdvancedHorizontalAlignment=function(e,t,n,o){return function(e){var t,n=((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)||r.HorizontalAlignment.Automatic)>3;return e.AutoFilter&&n}(t)?u(e,t,n,o):0},t.shouldAddAutoFilterPadding=function(e,t){var n;return(t.AutoFilter||(null===(n=t.PivotFilter)||void 0===n?void 0:n.DisplayFilter)&&t.RichValueIcon)&&c(e,t.CachedStyle)},t.shouldAddAutoFilterPaddingForMetadata=function(e,t){return t.Autofilter&&c(e,t.CachedStyle)},t.isTextAlignedOnButton=c,t.getFilterBottomAdjustedForDrawing=function(e,t,n,l,s){var d,u=(0,i.getDefaultBorderLineWidth)(s*l),c=(0,o.getCellHeightAdjustedForDrawing)(e,t)-2*u>n?Math.round(a.AutoFilterPaddingBottomPx*l):0;switch(null===(d=t.CachedStyle)||void 0===d?void 0:d.VerticalAlignment){case r.VerticalAlignment.Top:return(0,o.getCellTopAdjustedForDrawing)(e,t,!1)+c+u+n;case r.VerticalAlignment.Center:return(0,o.getCellBottomAdjustedForDrawing)(e,t)-Math.round((0,o.getCellHeightAdjustedForDrawing)(e,t)/2)+Math.round(n/2);case r.VerticalAlignment.Bottom:default:return(0,o.getCellBottomAdjustedForDrawing)(e,t)-c-u}},t.getFilterLeftAdjustedForDrawing=function(e,t,n,r,l){var s=(0,i.getDefaultBorderLineWidth)(l*r),d=(0,o.getCellWidthAdjustedForDrawing)(e,t)-2*s>n?Math.round(a.AutoFilterHorizontalPaddingPx*r):0;return e.IsRtl?(0,o.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+s:(0,o.getCellRightAdjustedForDrawing)(e,t,!1)-n-s-d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeLinesAdjustment=t.ShapeOutlineWidthPx=void 0;var r=n(0);t.ShapeOutlineWidthPx=1,t.ShapeLinesAdjustment=(0,r.getLinePixelTranslation)(t.ShapeOutlineWidthPx)},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CircledExclamationMarkWidthRectSizeRatio=t.ExclamationMarkMinSpaceBetweenRectangels=t.ExclamationMarkTopRectHeightSizeRatio=t.ExclamationMarkSpaceBetweenRectanglesRatio=t.ExclamationMarkLeftRectanglePaddingRatio=t.ExclamationMarkWidthRectSizeRatio=t.ExclamationMarkBottomRectHeightSizeRatio=t.CrossMarkInnerSmallPaddingRatio=t.CrossMarkInnerBigPaddingRatio=t.CrossMarkInnerCenterRatio=t.CrossMarkOuterSmallPaddingRatio=t.CrossMarkOuterBigPaddingRatio=t.CircledCheckMarkTopMiddleXRatio=t.CircledCheckMarkTopMiddleYRatio=t.CircledCheckMarkTopLeftXRatio=t.CircledCheckMarkTopLeftYRatio=t.CircledCheckMarkMiddleRightXRatio=t.CircledCheckMarkMiddleRightYRatio=t.CircledCheckMarkTopRightXRatio=t.CircledCheckMarkTopRightYRatio=t.CircledCheckMarkBottomYRatio=t.CircledCheckMarkMiddleYRatio=t.CircledCheckMarkMiddleXRatio=t.CheckMarkTopMiddleXRatio=t.CheckMarkTopMiddleYRatio=t.CheckMarkTopLeftXRatio=t.CheckMarkTopLeftYRatio=t.CheckMarkMiddleRightYRatio=t.CheckMarkTopRightXRatio=t.CheckMarkTopRightYRatio=t.CheckMarkBottomYRatio=t.CheckMarkMiddleYRatio=t.CheckMarkMiddleXRatio=t.UnusedColor=t.Circle360Deg=t.Circle180Deg=t.Circle90Deg=t.Circle0Deg=t.Circle270Deg=t.StarInset=t.StarRotation2Cos=t.StarRotationCos=t.StarRotation2Sin=t.StarRotationSin=t.MinimalIconSize=t.MinimalIconPadding=t.FlagPoleWidth=t.CirclePaddingFromBoundariesPx=t.IconImageLookup=t.CFIconImage=void 0,t.StripedCircleLowerLineAngle=t.StripedCircleMiddleLineAngle=t.StripedCircleUpperLineAngle=t.CircleHighContrastLargeRadiusPortion=t.CircleHighContrastMediumRadiusPortion=t.CircleHighContrastSmallRadiusPortion=t.QuarterPiTan=t.CircledCrossMarkPaddingFromCircleRatio=t.CircledCrossMarkInnerBigPaddingRatio=t.CircledCrossMarkInnerSmallPaddingRatio=t.CircledCrossMarkInnerCenterRatio=t.CircledCrossMarkOuterBigPaddingRatio=t.CircledCrossMarkOuterSmallPaddingRatio=t.ArrowAngle=t.ArrowUpRightTipYRatio=t.ArrowUpRightTipXRatio=t.ArrowDownRightTipYRatio=t.ArrowDownRightTipXRatio=t.ArrowHeightRatio=t.ArrowWidthRatio=t.CircledExclamationMarkPaddingFromCircle=t.CircledExclamationMarkTopRectHeightSizeRatio=t.CircledExclamationMarkLeftCircleSizeRatio=void 0,function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(r||(t.CFIconImage=r={})),t.IconImageLookup=[[r.ColoredArrowDown,r.ColoredArrowRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowRight,r.GrayArrowUp],[r.FlagLow,r.FlagMedium,r.FlagHigh],[r.CircleLow,r.CircleMedium,r.CircleHigh],[r.TrafficLow,r.TrafficMedium,r.TrafficHigh],[r.SignLow,r.SignMedium,r.CircleHigh],[r.CircleSymbolLow,r.CircleSymbolMedium,r.CircleSymbolHigh],[r.SymbolLow,r.SymbolMedium,r.SymbolHigh],[r.ColoredArrowDown,r.ColoredArrowDownRight,r.ColoredArrowUpRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowDownRight,r.GrayArrowUpRight,r.GrayArrowUp],[r.FourCircleLow,r.FourCircleMedium1,r.FourCircleMedium2,r.FourCircleHigh],[r.SignalBarLow,r.SignalBarMedium1,r.SignalBarMedium2,r.SignalBarHigh],[r.FourCircleLow,r.CircleLow,r.CircleMedium,r.CircleHigh],[r.ColoredArrowDown,r.ColoredArrowDownRight,r.ColoredArrowRight,r.ColoredArrowUpRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowDownRight,r.GrayArrowRight,r.GrayArrowUpRight,r.GrayArrowUp],[r.SignalBarEmpty,r.SignalBarLow,r.SignalBarMedium1,r.SignalBarMedium2,r.SignalBarHigh],[r.CircleEmpty,r.Circle25,r.CircleHalf,r.Circle75,r.CircleFilled],[r.StarLow,r.StarMedium,r.StarHigh],[r.TriangleLow,r.TriangleMedium,r.TriangleHigh],[r.QuadrantEmpty,r.Quadrant25,r.QuadrantHalf,r.Quadrant75,r.QuadrantFull]],t.CirclePaddingFromBoundariesPx=2,t.FlagPoleWidth=1,t.MinimalIconPadding=3,t.MinimalIconSize=4;var o=Math.PI/5;t.StarRotationSin=Math.sin(o),t.StarRotation2Sin=Math.sin(2*o),t.StarRotationCos=Math.cos(o),t.StarRotation2Cos=Math.cos(2*o),t.StarInset=.4,t.Circle270Deg=1.5*Math.PI,t.Circle0Deg=0,t.Circle90Deg=.5*Math.PI,t.Circle180Deg=Math.PI,t.Circle360Deg=2*Math.PI,t.UnusedColor="unused",t.CheckMarkMiddleXRatio=.375,t.CheckMarkMiddleYRatio=.5625,t.CheckMarkBottomYRatio=.9375,t.CheckMarkTopRightYRatio=.125,t.CheckMarkTopRightXRatio=.8125,t.CheckMarkMiddleRightYRatio=.3125,t.CheckMarkTopLeftYRatio=.34375,t.CheckMarkTopLeftXRatio=.1875,t.CheckMarkTopMiddleYRatio=.53125,t.CheckMarkTopMiddleXRatio=0,t.CircledCheckMarkMiddleXRatio=.4,t.CircledCheckMarkMiddleYRatio=.575,t.CircledCheckMarkBottomYRatio=.87,t.CircledCheckMarkTopRightYRatio=.22,t.CircledCheckMarkTopRightXRatio=.775,t.CircledCheckMarkMiddleRightYRatio=.37,t.CircledCheckMarkMiddleRightXRatio=.91,t.CircledCheckMarkTopLeftYRatio=.4,t.CircledCheckMarkTopLeftXRatio=.24,t.CircledCheckMarkTopMiddleYRatio=.55,t.CircledCheckMarkTopMiddleXRatio=.09,t.CrossMarkOuterBigPaddingRatio=.8125,t.CrossMarkOuterSmallPaddingRatio=.1875,t.CrossMarkInnerCenterRatio=.5,t.CrossMarkInnerBigPaddingRatio=.6875,t.CrossMarkInnerSmallPaddingRatio=.3125,t.ExclamationMarkBottomRectHeightSizeRatio=.25,t.ExclamationMarkWidthRectSizeRatio=.25,t.ExclamationMarkLeftRectanglePaddingRatio=.375,t.ExclamationMarkSpaceBetweenRectanglesRatio=.125,t.ExclamationMarkTopRectHeightSizeRatio=.6,t.ExclamationMarkMinSpaceBetweenRectangels=2,t.CircledExclamationMarkWidthRectSizeRatio=.4,t.CircledExclamationMarkLeftCircleSizeRatio=.325,t.CircledExclamationMarkTopRectHeightSizeRatio=.625,t.CircledExclamationMarkPaddingFromCircle=2,t.ArrowWidthRatio=.18,t.ArrowHeightRatio=.62,t.ArrowDownRightTipXRatio=.875,t.ArrowDownRightTipYRatio=.875,t.ArrowUpRightTipXRatio=.875,t.ArrowUpRightTipYRatio=.13,t.ArrowAngle=Math.PI/4,t.CircledCrossMarkOuterSmallPaddingRatio=.305,t.CircledCrossMarkOuterBigPaddingRatio=1-t.CircledCrossMarkOuterSmallPaddingRatio,t.CircledCrossMarkInnerCenterRatio=.5,t.CircledCrossMarkInnerSmallPaddingRatio=.325,t.CircledCrossMarkInnerBigPaddingRatio=1-t.CircledCrossMarkInnerSmallPaddingRatio,t.CircledCrossMarkPaddingFromCircleRatio=.125,t.QuarterPiTan=Math.tan(Math.PI/4),t.CircleHighContrastSmallRadiusPortion=.4,t.CircleHighContrastMediumRadiusPortion=.55,t.CircleHighContrastLargeRadiusPortion=.7,t.StripedCircleUpperLineAngle=.05*Math.PI,t.StripedCircleMiddleLineAngle=.25*Math.PI,t.StripedCircleLowerLineAngle=.45*Math.PI},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUnderlinePadding=t.degreeToRadians=t.getRotatedTextVerticalPadding=t.getRotatedTextVerticalPosition=t.getRotatedTextHorizontalPosition=t.getEffectiveHorizontalAlignmentForRotatedText=t.getIndexOfMaxLineWidth=t.getRotatedWrapTextWidth=t.getRotatedTextBoxHeight=t.getRotatedTextBoxWidth=t.applyRotation=t.getOrientationInCanvas=t.isRotatedTextSlice2Enabled=t.isRotatedTextSlice1Enabled=t.shouldDrawRotateTextSlice1=t.shouldDrawRotatedText=void 0;var r=n(1),o=n(0),i=n(10),l=n(82),a=n(83),s=n(3);function d(e,t){return u(e)&&!!(null==(o=t)?void 0:o.Orientation)&&!((n=null==t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Fill||n===r.HorizontalAlignment.CenterAcrossSelection);var n,o}function u(e){return(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextOrientationSlice1,e)}function c(e){return(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextOrientationSlice2,e)}function g(e,t,n){return e*Math.abs(Math.cos(n))+t}t.shouldDrawRotatedText=function(e,t,n){var r;return!(!(r=n)||!r.StrikeThrough&&!r.Underline&&!r.VerticalAlign)?c(e)&&d(e,t):d(e,t)},t.shouldDrawRotateTextSlice1=d,t.isRotatedTextSlice1Enabled=u,t.isRotatedTextSlice2Enabled=c,t.getOrientationInCanvas=function(e,t){(t>s.MaxOrientationRange||t<s.MinOrientationRange)&&(0,o.throwError)("Orientation is not in the defined range","getOrientationInCanvas");var n=-1*t;return e?-1*n:n},t.applyRotation=function(e,t,n,r){e.save(),e.textAlign=r<0?s.LeftTextAlign:s.RightTextAlign,e.translate(t,n),e.rotate(r)},t.getRotatedTextBoxWidth=g,t.getRotatedTextBoxHeight=function(e,t,n){return e*Math.abs(Math.sin(n))+t*Math.abs(Math.cos(n))},t.getRotatedWrapTextWidth=function(e,t,n){var r=e.length;if(1===r)return g(e[0].width,t[0],n);if(r>1){for(var o=Math.abs(Math.cos(n)),i=Math.abs(Math.sin(n)),l=e[0].width*o,a=0,s=1;s<e.length;s++)a+=t[s]/i,l=Math.max(l,a+e[s].width*o);return l+t[0]}return 0},t.getIndexOfMaxLineWidth=function(e){for(var t=0,n=0,r=0;r<e.length;r++)e[r].width>n&&(n=e[r].width,t=r);return t},t.getEffectiveHorizontalAlignmentForRotatedText=function(e,t){switch(e){case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.JustifyDistributed:return t?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;case r.HorizontalAlignment.Left:case r.HorizontalAlignment.Right:case r.HorizontalAlignment.Center:return e;case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Fill:default:throw Error("getEffectiveHorizontalAlignmentForRotatedText: Unsupported horizontal alignment ".concat(e))}},t.getRotatedTextHorizontalPosition=function(e,t,n,o,i,l,a,s,d){var u=s<0;switch(e){case r.HorizontalAlignment.Left:return u?t+o*Math.abs(Math.sin(s))+i:t+a-o+i+l;case r.HorizontalAlignment.Right:return u?n-a-i-l+o:n-o*Math.abs(Math.sin(s))-i;case r.HorizontalAlignment.Center:return u?t+(d-a)/2+o:n-(d-a)/2-o;default:throw Error("getRotatedTextHorizontalPosition: unsupported horizontalAlignment: ".concat(e))}},t.getRotatedTextVerticalPosition=function(e,t,n,o,i,l,a){switch(e){case r.VerticalAlignment.Top:return l+o+t;case r.VerticalAlignment.Center:return a-(i-o)/2;case r.VerticalAlignment.Bottom:case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:default:return a-(t-(n?s.InCellVerticalPaddingPx:0))}},t.getRotatedTextVerticalPadding=function(e,t){var n=!!e.WrapText||(0,i.cellHasShrinkToFit)(e),o=a.CalibriRegularPadding;switch(e.CachedStyle.VerticalAlignment){case r.VerticalAlignment.Center:return n?(0,l.approximateValue)(t,o):0;case r.VerticalAlignment.Top:return e.CachedFont.Italic&&(o=a.CalibriItalicPadding),(0,l.approximateValue)(t,o);case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:case r.VerticalAlignment.Bottom:default:return(0,l.approximateValue)(t,o)}},t.degreeToRadians=function(e){return e*Math.PI/180},t.getUnderlinePadding=function(e,t){return e.Underline?function(e){return Math.abs(e)===s.NinetyDegreeInRadians}(t)?2*s.GridLineWidthPx:s.GridLineWidthPx:0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHitRegionInternal=t.registerMouseLeaveHitRegion=t.registerMouseEnterHitRegion=t.registerTooltipHitRegion=t.registerLongPressHitRegion=t.registerCursorHitRegion=t.registerHitRegion=void 0;var r=n(1);function o(e,t,n){(function(e,t){var n=(0,r.getCellLookupKey)(t.Row,t.Col),o=e[n];o||(e[n]=[],o=e[n]);return o})(t,e).push(n)}function i(e){var t=e.scaleFactor,n=e.rect,r=n.x/t,o=n.y/t,i=n.width/t,l=n.height/t,a=e.renderingRegion,s=r-(e.isRtl?e.blockWidth-a.endOffsetX:a.startOffsetX),d=o-a.startOffsetY;return{x:e.isMirrored?a.endOffsetX-r-i:s,y:d,width:i,height:l}}t.registerHitRegion=function(e,t,n,r,l,a){var s={eventType:a,callback:l,zIndex:r,region:i(n)};o(e,t.CellHitRegions,s)},t.registerCursorHitRegion=function(e,t,n,r,l,a){void 0===a&&(a=function(){return!0});var s={cursorType:r,zIndex:l,region:i(n),shouldChangeCursor:a};o(e,t.CellCursorHitRegions,s)},t.registerLongPressHitRegion=function(e,t,n,r,l,a){var s={zIndex:r,region:i(n),onStart:l,onEnd:a};o(e,t.CellLongPressHitRegions,s)},t.registerTooltipHitRegion=function(e,t,n,r,l){var a={tooltipText:r,zIndex:l,region:i(n)};o(e,t.CellTooltipHitRegions,a)},t.registerMouseEnterHitRegion=function(e,t,n,r,l){var a={zIndex:r,eventType:"mouseenter",callback:l,region:i(n)};o(e,t.CellHitRegions,a)},t.registerMouseLeaveHitRegion=function(e,t,n,r,l){var a={zIndex:r,eventType:"mouseleave",callback:l,region:i(n)};o(e,t.CellHitRegions,a)},t.registerHitRegionInternal=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDynamicImageCallback=t.createRichErrorCallback=t.createCommentsCallback=t.getUnadjustedHitRegionFromRect=t.getInteractiveIconMaxSizeAdjustedForDrawing=void 0;var r=n(6),o=n(2),i=n(11),l=n(0),a=n(7),s=n(30);function d(e,t,n,r){var o=function(e,t){var n,r,o=e.RowNumbers[t.Row]-1,i=e.ColumnNumbers[t.Col]-1,l=(null===(n=t.Merge)||void 0===n?void 0:n.OriginRow)||0,a=(null===(r=t.Merge)||void 0===r?void 0:r.OriginColumn)||0;l&&a&&(o=l,i=a);return{commentRow:o,commentColumn:i}}(e,t),l=o.commentRow,a=o.commentColumn;return n?function(o){return t.HasIgnorableError&&u(e,t,e.RibbonCommands.CardViewHideTemporaryCard,!0)(o),c(e,t,!1,!0)(o),(0,i.showOrCloseFloatingCommentCallback)(l,a,n),r}:function(o){return c(e,t,!0,!0)(o),(0,i.showOrCloseFloatingCommentCallback)(l,a,n),r}}function u(e,t,n,r){var o=e.RowNumbers[t.Row],l=e.ColumnNumbers[t.Col];return function(a){var s=n===e.RibbonCommands.CardViewShowTemporaryErrorCard;return t.Comment&&s&&d(e,t,!1,!1)(a),(0,i.invokeRibbonCommandWithCellReference)(a,n,o,l),r}}function c(e,t,n,r){var o=e.RowNumbers[t.Row],d=e.ColumnNumbers[t.Col];return function(u){var c=(0,l.getDynamicImageInformationFromCell)(t,s.ImageType.InCellImage);return(0,a.isNullOrUndefined)(c)||(0,i.invokeRibbonCommandWithCellReference)(u,n?e.RibbonCommands.CardViewShowTemporaryDataCard:e.RibbonCommands.CardViewHideTemporaryCard,o,d),r}}t.getInteractiveIconMaxSizeAdjustedForDrawing=function(e,t,n,i,l,a,s){var d=(0,o.getDefaultBorderLineWidth)(l*i),u=(0,r.getCellWidthAdjustedForDrawing)(t,n)-d,c=(0,r.getCellHeightAdjustedForDrawing)(t,n)-d,g=e;return s&&(g*=i),a&&(g*=l),Math.ceil(Math.max(Math.min(g,u,c),0))},t.getUnadjustedHitRegionFromRect=function(e,t,n,r){return{isMirrored:r,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n.x,y:n.y,width:n.width,height:n.height},isRtl:e.IsRtl,blockWidth:e.BlockWidth}},t.createCommentsCallback=d,t.createRichErrorCallback=u,t.createDynamicImageCallback=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyTrueCallback=t.EmptyFalseCallback=t.TouchCallback=t.MinLongPressDurationMs=t.DoubleClickEventType=t.ClickEventType=t.DefaultTooltip=t.GrabCursorType=t.ColResizeModernizeCursorType=t.ColResizeCursorType=t.RowResizeModerinzeCursorType=t.RowResizeCursorType=t.DefaultCursorType=t.PointerCursorType=t.UnsetCursorType=t.OutsideCanvasPoint=t.PointerUpEvent=t.PointerDownEvent=t.PointerLeaveEvent=t.PointerMoveEvent=t.LongPressEventType=t.TooltipEventType=t.CursorEventType=t.HitMapKeyXShift=t.MaxHitMapOffsetCount=t.DefaultHitMapSectionsCount=void 0;var r=n(11);t.DefaultHitMapSectionsCount=30,t.MaxHitMapOffsetCount=32,t.HitMapKeyXShift=5,t.CursorEventType="cursor",t.TooltipEventType="tooltip",t.LongPressEventType="longpress",t.PointerMoveEvent="pointermove",t.PointerLeaveEvent="pointerleave",t.PointerDownEvent="pointerdown",t.PointerUpEvent="pointerup",t.OutsideCanvasPoint={x:-1,y:-1},t.UnsetCursorType="unset",t.PointerCursorType="pointer",t.DefaultCursorType="default",t.RowResizeCursorType="row-resize",t.RowResizeModerinzeCursorType="ns-resize",t.ColResizeCursorType="col-resize",t.ColResizeModernizeCursorType="ew-resize",t.GrabCursorType="grab",t.DefaultTooltip="",t.ClickEventType="click",t.DoubleClickEventType="dblclick",t.MinLongPressDurationMs=800;t.TouchCallback=function(e){return(0,r.setLastInputMethod)(e),!1};t.EmptyFalseCallback=function(){return!1};t.EmptyTrueCallback=function(){return!0}},function(e,t,n){"use strict";var r,o,i,l,a,s,d,u,c,g,f,h,C,m,p,y,v,S,R,F,w,T,I,x,b,D,A,P,H,B,M,O,k,L,N,E,z,W,G,V;Object.defineProperty(t,"__esModule",{value:!0}),t.DelayRenderToNextAnimationFrameState=t.ModelType=t.PatternStyleType=t.UniqueHeadersFontID=t.UniqueHeadersStyleID=t.TolType=t.DirtyType=t.SparklineType=t.CFIconSet=t.RichValueIconType=t.RichValueCellType=t.MenuEntryIdentifier=t.OutlineState=t.FontSchemeOption=t.FontVerticalAlignment=t.FontUnderline=t.BorderPositionType=t.BorderLineType=t.MenuItemType=t.RenderFlagsArray=t.CellsEncoding=t.AutoFilterType=t.CellFormulaType=t.CellValueType=t.UniqueStyleID=t.VerticalAlignment=t.HorizontalAlignment=t.ReadingOrderType=t.BackgroundFillType=t.GradientShadingStyle=t.ViewMode=t.RangeType=t.PivotMeasureType=t.PivotSortInfo=t.PivotFilterType=t.PivotTableDataFieldFormatType=t.PivotTableDataFieldAggregationType=t.InCellControlType=t.MenuDisplayType=t.InsertButtonType=void 0,function(e){e[e.InsertDot=0]="InsertDot",e[e.InsertButton=1]="InsertButton"}(r||(t.InsertButtonType=r={})),function(e){e[e.Gallery=0]="Gallery",e[e.List=1]="List"}(o||(t.MenuDisplayType=o={})),function(e){e[e.None=0]="None",e[e.Checkbox=1]="Checkbox",e[e.Dropdown=2]="Dropdown"}(i||(t.InCellControlType=i={})),function(e){e[e.None=-1]="None",e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Average=2]="Average",e[e.Max=3]="Max",e[e.Min=4]="Min",e[e.Product=5]="Product",e[e.CountNumbers=6]="CountNumbers",e[e.StdDeviation=7]="StdDeviation",e[e.StdDeviationPercent=8]="StdDeviationPercent",e[e.Variant=9]="Variant",e[e.VariantPercent=10]="VariantPercent",e[e.DistinctCountPPM=11]="DistinctCountPPM",e[e.Median=12]="Median",e[e.AggregationTypeMax=12]="AggregationTypeMax"}(l||(t.PivotTableDataFieldAggregationType=l={})),function(e){e[e.None=-1]="None",e[e.NoCalculation=0]="NoCalculation",e[e.DifferenceFrom=1]="DifferenceFrom",e[e.PercentOf=2]="PercentOf",e[e.PercentDifferenceFrom=3]="PercentDifferenceFrom",e[e.RunningTotalIn=4]="RunningTotalIn",e[e.PercentOfRowTotal=5]="PercentOfRowTotal",e[e.PercentOfColumnTotal=6]="PercentOfColumnTotal",e[e.PercentOfGrandTotal=7]="PercentOfGrandTotal",e[e.Index=8]="Index",e[e.PercentOfParentRowTotal=9]="PercentOfParentRowTotal",e[e.PercentOfParentColumnTotal=10]="PercentOfParentColumnTotal",e[e.PercentOfParentTotal=11]="PercentOfParentTotal",e[e.PercentRunningTotalIn=12]="PercentRunningTotalIn",e[e.RankSmallestToLargest=13]="RankSmallestToLargest",e[e.RankLargestToSmallest=14]="RankLargestToSmallest",e[e.DataFormatMax=14]="DataFormatMax"}(a||(t.PivotTableDataFieldFormatType=a={})),function(e){e[e.Invalid=0]="Invalid",e[e.FirstTop10=1]="FirstTop10",e[e.Count=1]="Count",e[e.Percent=2]="Percent",e[e.Sum=3]="Sum",e[e.LastTop10=3]="LastTop10",e[e.CaptionFirst=4]="CaptionFirst",e[e.CaptionEquals=4]="CaptionEquals",e[e.CaptionDoesNotEqual=5]="CaptionDoesNotEqual",e[e.CaptionBeginsWith=6]="CaptionBeginsWith",e[e.CaptionDoesNotBeginWith=7]="CaptionDoesNotBeginWith",e[e.CaptionEndsWith=8]="CaptionEndsWith",e[e.CaptionDoesNotEndWith=9]="CaptionDoesNotEndWith",e[e.CaptionContains=10]="CaptionContains",e[e.CaptionDoesNotContain=11]="CaptionDoesNotContain",e[e.CaptionIsGreaterThan=12]="CaptionIsGreaterThan",e[e.CaptionIsGreaterThanOrEqualTo=13]="CaptionIsGreaterThanOrEqualTo",e[e.CaptionIsLessThan=14]="CaptionIsLessThan",e[e.CaptionIsLessThanOrEqualTo=15]="CaptionIsLessThanOrEqualTo",e[e.CaptionIsBetween=16]="CaptionIsBetween",e[e.CaptionIsNotBetween=17]="CaptionIsNotBetween",e[e.ValueFirst=18]="ValueFirst",e[e.ValueEqual=18]="ValueEqual",e[e.ValueNotEqual=19]="ValueNotEqual",e[e.ValueGreaterThan=20]="ValueGreaterThan",e[e.ValueGreaterThanOrEqual=21]="ValueGreaterThanOrEqual",e[e.ValueLessThan=22]="ValueLessThan",e[e.ValueLessThanOrEqual=23]="ValueLessThanOrEqual",e[e.ValueBetween=24]="ValueBetween",e[e.ValueNotBetween=25]="ValueNotBetween",e[e.DateFirst=26]="DateFirst",e[e.DateEquals=26]="DateEquals",e[e.DateOlderThan=27]="DateOlderThan",e[e.DateNewerThan=28]="DateNewerThan",e[e.DateBetween=29]="DateBetween",e[e.DateTomorrow=30]="DateTomorrow",e[e.DateToday=31]="DateToday",e[e.DateYesterday=32]="DateYesterday",e[e.DateNextWeek=33]="DateNextWeek",e[e.DateThisWeek=34]="DateThisWeek",e[e.DateLastWeek=35]="DateLastWeek",e[e.DateNextMonth=36]="DateNextMonth",e[e.DateThisMonth=37]="DateThisMonth",e[e.DateLastMonth=38]="DateLastMonth",e[e.DateNextQuarter=39]="DateNextQuarter",e[e.DateThisQuarter=40]="DateThisQuarter",e[e.DateLastQuarter=41]="DateLastQuarter",e[e.DateNextYear=42]="DateNextYear",e[e.DateThisYear=43]="DateThisYear",e[e.DateLastYear=44]="DateLastYear",e[e.DateYearToDate=45]="DateYearToDate",e[e.DateAllDatesInPeriodQuarter1=46]="DateAllDatesInPeriodQuarter1",e[e.DateAllDatesInPeriodQuarter2=47]="DateAllDatesInPeriodQuarter2",e[e.DateAllDatesInPeriodQuarter3=48]="DateAllDatesInPeriodQuarter3",e[e.DateAllDatesInPeriodQuarter4=49]="DateAllDatesInPeriodQuarter4",e[e.DateAllDatesInPeriodJanuary=50]="DateAllDatesInPeriodJanuary",e[e.DateAllDatesInPeriodFebruary=51]="DateAllDatesInPeriodFebruary",e[e.DateAllDatesInPeriodMarch=52]="DateAllDatesInPeriodMarch",e[e.DateAllDatesInPeriodApril=53]="DateAllDatesInPeriodApril",e[e.DateAllDatesInPeriodMay=54]="DateAllDatesInPeriodMay",e[e.DateAllDatesInPeriodJune=55]="DateAllDatesInPeriodJune",e[e.DateAllDatesInPeriodJuly=56]="DateAllDatesInPeriodJuly",e[e.DateAllDatesInPeriodAugust=57]="DateAllDatesInPeriodAugust",e[e.DateAllDatesInPeriodSeptember=58]="DateAllDatesInPeriodSeptember",e[e.DateAllDatesInPeriodOctober=59]="DateAllDatesInPeriodOctober",e[e.DateAllDatesInPeriodNovember=60]="DateAllDatesInPeriodNovember",e[e.DateAllDatesInPeriodDecember=61]="DateAllDatesInPeriodDecember",e[e.DateNotEqual=62]="DateNotEqual",e[e.DateOlderOrEqual=63]="DateOlderOrEqual",e[e.DateNewerOrEqual=64]="DateNewerOrEqual",e[e.DateNotBetween=65]="DateNotBetween",e[e.Last=65]="Last"}(s||(t.PivotFilterType=s={})),function(e){e[e.None=0]="None",e[e.SortAscending=1]="SortAscending",e[e.SortDescending=2]="SortDescending",e[e.SortAscendingByValue=3]="SortAscendingByValue",e[e.SortDescendingByValue=4]="SortDescendingByValue"}(d||(t.PivotSortInfo=d={})),function(e){e[e.None=0]="None",e[e.Explicit=1]="Explicit",e[e.Implicit=2]="Implicit"}(u||(t.PivotMeasureType=u={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedRange=1]="UsedRange",e[e.PivotTable=2]="PivotTable",e[e.Hyperlink=3]="Hyperlink",e[e.Autofilter=4]="Autofilter",e[e.DataValidation=5]="DataValidation",e[e.Sparkline=6]="Sparkline",e[e.FloatingObjectAnchor=7]="FloatingObjectAnchor",e[e.DynamicArray=8]="DynamicArray",e[e.AutoDetect=9]="AutoDetect"}(c||(t.RangeType=c={})),function(e){e[e.Default=0]="Default",e[e.NamedSheetView=1]="NamedSheetView",e[e.PresentMode=2]="PresentMode"}(g||(t.ViewMode=g={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(f||(t.GradientShadingStyle=f={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(h||(t.BackgroundFillType=h={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(C||(t.ReadingOrderType=C={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(m||(t.HorizontalAlignment=m={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(p||(t.VerticalAlignment=p={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(y||(t.UniqueStyleID=y={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(v||(t.CellValueType=v={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(S||(t.CellFormulaType=S={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(R||(t.AutoFilterType=R={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(F||(t.CellsEncoding=F={})),function(e){e[e.NewVerticalAlignExp=0]="NewVerticalAlignExp",e[e.InCellControls=1]="InCellControls",e[e.FontServiceIntegration=2]="FontServiceIntegration",e[e.TextWidthClientPhase2=3]="TextWidthClientPhase2",e[e.CanvasHitTest=4]="CanvasHitTest",e[e.TextWidthClientNewProcessing=5]="TextWidthClientNewProcessing",e[e.FiltersUXModernization=6]="FiltersUXModernization",e[e.HeaderDragImprovements=8]="HeaderDragImprovements",e[e.DelayRenderToNextAnimationFrame=9]="DelayRenderToNextAnimationFrame",e[e.ResizeHeaderUXModernization=10]="ResizeHeaderUXModernization",e[e.RenderHeaderOutlinesInCanvas=11]="RenderHeaderOutlinesInCanvas",e[e.RenderHeaderSnappingInCanvas=12]="RenderHeaderSnappingInCanvas",e[e.DoubleBorderFormattingFix=13]="DoubleBorderFormattingFix",e[e.WrapTextCse=14]="WrapTextCse",e[e.RenderResizePill=16]="RenderResizePill",e[e.FormulaViewCellImagesFix=17]="FormulaViewCellImagesFix",e[e.ModernFontPicker=19]="ModernFontPicker",e[e.DoubleBorderMergeCellFix=20]="DoubleBorderMergeCellFix",e[e.DoubleBorderBlockEdgeFix=21]="DoubleBorderBlockEdgeFix",e[e.TextWidthClientPhase1=22]="TextWidthClientPhase1",e[e.TableSelectorsHitTest=23]="TableSelectorsHitTest",e[e.CanvasHeaders=24]="CanvasHeaders",e[e.TextOrientationSlice1=25]="TextOrientationSlice1",e[e.ByExamplePreviewMode=26]="ByExamplePreviewMode",e[e.ShowDynamicImageCardOnHover=27]="ShowDynamicImageCardOnHover",e[e.TextOrientationSlice2=28]="TextOrientationSlice2",e[e.TableBordersInHighContrast=29]="TableBordersInHighContrast",e[e.UseOffscreenCanvas=30]="UseOffscreenCanvas",e[e.RenderPatternStyle=33]="RenderPatternStyle",e[e.GlobalStylesSlice1=34]="GlobalStylesSlice1",e[e.NewDefaultTemplate=35]="NewDefaultTemplate",e[e.GlobalStylesSlice2=37]="GlobalStylesSlice2",e[e.FluentStyle=38]="FluentStyle",e[e.GlobalStylesSlice3=39]="GlobalStylesSlice3",e[e.HideColumnSlice1=40]="HideColumnSlice1",e[e.HideColumnMergedCellSlice1=41]="HideColumnMergedCellSlice1",e[e.HideColumnAutoFilterSlice1=42]="HideColumnAutoFilterSlice1",e[e.HideColumnFormulaSlice1=43]="HideColumnFormulaSlice1",e[e.MoveSpillCellBeforeRendering=44]="MoveSpillCellBeforeRendering",e[e.NewThemeFontForHeaderFBarNBox=45]="NewThemeFontForHeaderFBarNBox"}(w||(t.RenderFlagsArray=w={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(T||(t.MenuItemType=T={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(I||(t.BorderLineType=I={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}(x||(t.BorderPositionType=x={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(b||(t.FontUnderline=b={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(D||(t.FontVerticalAlignment=D={})),function(e){e[e.None=0]="None",e[e.Major=1]="Major",e[e.Minor=2]="Minor"}(A||(t.FontSchemeOption=A={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(P||(t.OutlineState=P={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter",e[e.SortAtoZ=30]="SortAtoZ",e[e.SortZtoA=31]="SortZtoA",e[e.SortSmallestToLargest=32]="SortSmallestToLargest",e[e.SortLargestToSmallest=33]="SortLargestToSmallest",e[e.SortOldestToNewest=34]="SortOldestToNewest",e[e.SortNewestToOldest=35]="SortNewestToOldest",e[e.SortByColor=36]="SortByColor",e[e.FilterByColor=37]="FilterByColor",e[e.AnalyzeData=38]="AnalyzeData"}(H||(t.MenuEntryIdentifier=H={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(B||(t.RichValueCellType=B={})),function(e){e[e.Disambiguation=0]="Disambiguation",e[e.Sync=1]="Sync",e[e.LinkedEntity=2]="LinkedEntity"}(M||(t.RichValueIconType=M={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(O||(t.CFIconSet=O={})),function(e){e[e.Line=0]="Line",e[e.Column=1]="Column",e[e.Stacked=2]="Stacked"}(k||(t.SparklineType=k={})),function(e){e[e.None=0]="None",e[e.ModelCellChanges=2]="ModelCellChanges",e[e.ModelCoreChanges=4]="ModelCoreChanges",e[e.ScaleFactorChange=8]="ScaleFactorChange",e[e.ViewportChange=16]="ViewportChange",e[e.ExternalChanges=32]="ExternalChanges",e[e.NoCanvasCache=64]="NoCanvasCache",e[e.ModelCellPreviewChanges=128]="ModelCellPreviewChanges"}(L||(t.DirtyType=L={})),function(e){e[e.None=0]="None",e[e.Autofit=1]="Autofit",e[e.Spill=2]="Spill"}(N||(t.TolType=N={})),function(e){e[e.Default=-1]="Default",e[e.PartialRowColSelection=0]="PartialRowColSelection",e[e.WholeRowColSelection=1]="WholeRowColSelection",e[e.Hover=2]="Hover",e[e.PartialSelectionAndHover=3]="PartialSelectionAndHover",e[e.SelectionAndHover=3]="SelectionAndHover",e[e.WholeSelectionAndHover=4]="WholeSelectionAndHover",e[e.NoHeadings=5]="NoHeadings",e[e.PartialRowColSelectionLeftAlignment=6]="PartialRowColSelectionLeftAlignment",e[e.PartialRowColSelectionRightAlignment=7]="PartialRowColSelectionRightAlignment",e[e.WholeRowColSelectionLeftAlignment=8]="WholeRowColSelectionLeftAlignment",e[e.WholeRowColSelectionRightAlignment=9]="WholeRowColSelectionRightAlignment",e[e.HoverLeftAlignment=10]="HoverLeftAlignment",e[e.HoverRightAlignment=11]="HoverRightAlignment",e[e.PartialSelectionAndHoverLeftAlignment=12]="PartialSelectionAndHoverLeftAlignment",e[e.PartialSelectionAndHoverRightAlignment=13]="PartialSelectionAndHoverRightAlignment",e[e.WholeSelectionAndHoverLeftAlignment=14]="WholeSelectionAndHoverLeftAlignment",e[e.WholeSelectionAndHoverRightAlignment=15]="WholeSelectionAndHoverRightAlignment",e[e.LeftAlignment=16]="LeftAlignment",e[e.RightAlignment=17]="RightAlignment"}(E||(t.UniqueHeadersStyleID=E={})),function(e){e[e.Default=-1]="Default",e[e.Hover=0]="Hover",e[e.PartialSelection=1]="PartialSelection",e[e.PartialSelectionAndHover=2]="PartialSelectionAndHover",e[e.WholeSelection=3]="WholeSelection",e[e.WholeSelectionAndHover=4]="WholeSelectionAndHover"}(z||(t.UniqueHeadersFontID=z={})),function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.Gray50=2]="Gray50",e[e.Gray75=3]="Gray75",e[e.Gray25=4]="Gray25",e[e.HorzStripe=5]="HorzStripe",e[e.VertStripe=6]="VertStripe",e[e.ReverseDiagStripe=7]="ReverseDiagStripe",e[e.DiagStripe=8]="DiagStripe",e[e.DiagCross=9]="DiagCross",e[e.ThickDiagCross=10]="ThickDiagCross",e[e.ThinHorzStripe=11]="ThinHorzStripe",e[e.ThinVertStripe=12]="ThinVertStripe",e[e.ThinReverseDiagStripe=13]="ThinReverseDiagStripe",e[e.ThinDiagStripe=14]="ThinDiagStripe",e[e.ThinHorzCross=15]="ThinHorzCross",e[e.ThinDiagCross=16]="ThinDiagCross",e[e.Gray125=17]="Gray125",e[e.Gray0625=18]="Gray0625"}(W||(t.PatternStyleType=W={})),function(e){e[e.GridBlockModel=0]="GridBlockModel",e[e.HeaderBlockModel=1]="HeaderBlockModel"}(G||(t.ModelType=G={})),function(e){e[e.None=0]="None",e[e.Delay=1]="Delay",e[e.DoNotDelay=2]="DoNotDelay"}(V||(t.DelayRenderToNextAnimationFrameState=V={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=void 0,t.isNullOrUndefined=function(e){return null==e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRoundRectangleOld=t.drawRoundRectangle=t.drawRectangle=void 0;var r=n(1),o=n(19);t.drawRectangle=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawRectangle"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawRectangle");var n=t.innerColor,i=t.outerColor,l=t.left,a=t.bottom,s=t.height,d=t.width,u=l+o.ShapeLinesAdjustment,c=a-s-o.ShapeLinesAdjustment;i&&function(e,t,n,r,o,i){e.strokeStyle=i,e.beginPath(),e.rect(t,n,r,o),e.stroke()}(e,u,c,d,s,i),n&&function(e,t,n,r,o,i){e.fillStyle=i,e.beginPath(),e.fillRect(t,n,r,o),e.fill()}(e,l+o.ShapeOutlineWidthPx,a-s,d-o.ShapeOutlineWidthPx,s-o.ShapeOutlineWidthPx,n)},t.drawRoundRectangle=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawRoundRectangle"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawRoundRectangle");var n=t.innerColor,i=t.outerColor,l=t.left,a=t.bottom,s=t.height,d=t.width,u=t.radius;if(0===u.length||u.length>4)throw new Error("Invalid radius array length: ".concat(u.length));var c=[];switch(u.length){case 1:c=[u[0],u[0],u[0],u[0]];break;case 2:c=[u[0],u[1],u[0],u[1]];break;case 3:c=[u[0],u[1],u[2],u[1]];break;case 4:c=u}var g=l+o.ShapeLinesAdjustment,f=a-s-o.ShapeLinesAdjustment,h=g+d,C=f+s;e.beginPath(),e.roundRect?e.roundRect(g,f,d,s,c):(e.moveTo(g+c[0],f),e.lineTo(h-c[1],f),e.quadraticCurveTo(h,f,h,f+c[1]),e.lineTo(h,C-c[2]),e.quadraticCurveTo(h,C,h-c[2],C),e.lineTo(g+c[3],C),e.quadraticCurveTo(g,C,g,C-c[3]),e.lineTo(g,f+c[0]),e.quadraticCurveTo(g,f,g+c[0],f)),e.closePath(),n&&(e.fillStyle=n,e.fill()),i&&(e.strokeStyle=i,e.stroke())},t.drawRoundRectangleOld=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawRoundRectangleOld"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawRoundRectangleOld");var n=t.innerColor,i=t.outerColor,l=t.left,a=t.bottom,s=t.height,d=t.width,u=t.radius,c=l+o.ShapeLinesAdjustment,g=a-s-o.ShapeLinesAdjustment,f=c+d,h=g+s;e.beginPath(),e.roundRect?e.roundRect(c,g,d,s,[u]):(e.moveTo(c+u,g),e.lineTo(f-u,g),e.quadraticCurveTo(f,g,f,g+u),e.lineTo(f,h-u),e.quadraticCurveTo(f,h,f-u,h),e.lineTo(c+u,h),e.quadraticCurveTo(c,h,c,h-u),e.lineTo(c,g+u),e.quadraticCurveTo(c,g,c+u,g)),e.closePath(),n&&(e.fillStyle=n,e.fill()),i&&(e.strokeStyle=i,e.stroke())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolHighOuterColor=t.SymbolMediumInnerColor=t.SymbolMediumOuterColor=t.SymbolLowInnerColor=t.SymbolLowOuterColor=t.SignLowInnerColor=t.SignLowOuterColor=t.SignMediumInnerColor=t.SignMediumOuterColor=t.StarEmptyInnerColor=t.StarEmptyOuterColor=t.StarFilledInnerColor=t.StarFilledOuterColor=t.TriangleHighInnerColor=t.TriangleHighOuterColor=t.TriangleMediumInnerColor=t.TriangleMediumOuterColor=t.TriangleLowInnerColor=t.TriangleLowOuterColor=t.FlagHighInnerColor=t.FlagHighOuterColor=t.FlagMediumInnerColor=t.FlagMediumOuterColor=t.FlagLowInnerColor=t.FlagLowOuterColor=t.FlagPoleColor=t.QuadrantBoxesOutlineColor=t.QuadrantBoxesFilledColor=t.QuadrantBoxesEmptyColor=t.SignalBarOutlineColor=t.SignalBarFilledColor=t.SignalBarEmptyColor=t.TrafficHighRimmedRectColor=t.FourCircleHighOuterColor=t.FourCircleHighInnerColor=t.FourCircleLowOuterColor=t.FourCircleMedium1OuterColor=t.FourCircleMedium1InnerColor=t.FourCircleMedium2OuterColor=t.FourCircleMedium2InnerColor=t.CircleEmptyOuterColor=t.CircleEmptyInnerColor=t.CircleFilledOuterColor=t.CircleFilledInnerColor=t.CircleHighOuterColor=t.CircleHighInnerColor=t.CircleMediumOuterColor=t.CircleMediumInnerColor=t.CircleLowOuterColor=t.CircleLowInnerColor=void 0,t.CircleSymbolInnerShapeInnerColor=t.ArrowRightOuterColor=t.ArrowDownOuterColor=t.ArrowUpOuterColor=t.ArrowRightInnerColor=t.ArrowDownInnerColor=t.ArrowUpInnerColor=t.ArrowGrayInnerColor=t.ArrowGrayOuterColor=t.SymbolHighInnerColor=void 0,t.CircleLowInnerColor="#FF9198",t.CircleLowOuterColor="#D42314",t.CircleMediumInnerColor="#F8DB8F",t.CircleMediumOuterColor="#DE6C00",t.CircleHighInnerColor="#A1DDAA",t.CircleHighOuterColor="#309048",t.CircleFilledInnerColor="#797774",t.CircleFilledOuterColor="#3A3A38",t.CircleEmptyInnerColor="#FAFAFA",t.CircleEmptyOuterColor="#3A3A38",t.FourCircleMedium2InnerColor="#D492D8",t.FourCircleMedium2OuterColor="#922E9B",t.FourCircleMedium1InnerColor="#C8C6C4",t.FourCircleMedium1OuterColor="#3A3A38",t.FourCircleLowOuterColor="#3A3A38",t.FourCircleHighInnerColor="#FF9198",t.FourCircleHighOuterColor="#D42314",t.TrafficHighRimmedRectColor="#3A3A38",t.SignalBarEmptyColor="#FAFAFA",t.SignalBarFilledColor="#83BEEC",t.SignalBarOutlineColor="#3A3A38",t.QuadrantBoxesEmptyColor="#FAFAFA",t.QuadrantBoxesFilledColor="#83BEEC",t.QuadrantBoxesOutlineColor="#3A3A38",t.FlagPoleColor="#3A3A38",t.FlagLowOuterColor="#D42314",t.FlagLowInnerColor="#FF9198",t.FlagMediumOuterColor="#DE6C00",t.FlagMediumInnerColor="#F8DB8F",t.FlagHighOuterColor="#309048",t.FlagHighInnerColor="#A1DDAA",t.TriangleLowOuterColor="#D42314",t.TriangleLowInnerColor="#FF9198",t.TriangleMediumOuterColor="#DE6C00",t.TriangleMediumInnerColor="#F8DB8F",t.TriangleHighOuterColor="#309048",t.TriangleHighInnerColor="#A1DDAA",t.StarFilledOuterColor="#DE6C00",t.StarFilledInnerColor="#F8DB8F",t.StarEmptyOuterColor="#3A3A38",t.StarEmptyInnerColor="#FAFAFA",t.SignMediumOuterColor="#DE6C00",t.SignMediumInnerColor="#F8DB8F",t.SignLowOuterColor="#D42314",t.SignLowInnerColor="#FF9198",t.SymbolLowOuterColor="#D42314",t.SymbolLowInnerColor="#FF9198",t.SymbolMediumOuterColor="#DE6C00",t.SymbolMediumInnerColor="#F8DB8F",t.SymbolHighOuterColor="#309048",t.SymbolHighInnerColor="#A1DDAA",t.ArrowGrayOuterColor="#797774",t.ArrowGrayInnerColor="#C8C6C4",t.ArrowUpInnerColor="#A1DDAA",t.ArrowDownInnerColor="#FF9198",t.ArrowRightInnerColor="#F8DB8F",t.ArrowUpOuterColor="#309048",t.ArrowDownOuterColor="#D42314",t.ArrowRightOuterColor="#DE6C00",t.CircleSymbolInnerShapeInnerColor="#FAFAFA"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyArgumentNotNull=t.overrideRenderFlagForMismatch=t.isRenderFlagEnabled=void 0;var r=n(78),o=n(26);t.isRenderFlagEnabled=function(e,t){if(!(0,o.isNullOrUndefined)(t.RenderFlagsArray)){var n=Math.floor(e/r.MaxBitsPerRenderFlag);if(n<t.RenderFlagsArray.length){var i=e%r.MaxBitsPerRenderFlag;return 0!=(t.RenderFlagsArray[n]&1<<i)}}return!1},t.overrideRenderFlagForMismatch=function(e,t,n){if(!(0,o.isNullOrUndefined)(e.RenderFlagsArray)){var i=Math.floor(t/r.MaxBitsPerRenderFlag);if(i<e.RenderFlagsArray.length){var l=1<<t%r.MaxBitsPerRenderFlag;n!==!!(e.RenderFlagsArray[i]&l)&&(e.RenderFlagsArray[i]^=l)}}},t.verifyArgumentNotNull=function(e,t,n){if(null==e)throw Error("".concat(n,".verifyArgumentNotNull: ").concat(t," cannot be null or undefined"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testHelper=t.getOrLoadStaticImage=t.getOrLoadVersionedImage=t.clearImageFromCache=t.setStaticImageUrl=t.initializeGridRendererImageLoader=t.ImageType=t.ImageLoadStatus=void 0;var r,o,i=n(1);!function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.LoadFailed=3]="LoadFailed"}(r||(t.ImageLoadStatus=r={})),function(e){e[e.Sparkline=0]="Sparkline",e[e.InCellImage=1]="InCellImage"}(o||(t.ImageType=o={}));var l={onImageLoadSuccessCallback:void 0,onImageLoadFailureCallback:void 0},a={};function s(e,t,n,o){var i=f(e);if(i||(h(e,i={blockIdentifiers:[t],status:r.Initialized,version:n,url:o}),o))switch(i.status){case r.Loaded:return i.image;case r.LoadFailed:return;case r.Loading:return void c(t,i);case r.Initialized:return c(t,i),void(i.url&&g(i));default:throw Error("getOrLoadImageByKey: unexpected image statue: ".concat(i.status))}}function d(e){return"STATIC"+e}function u(e,t){return e+t}function c(e,t){-1===t.blockIdentifiers.indexOf(e)&&t.blockIdentifiers.push(e)}function g(e){if(!e.url)throw Error("image url is not set, unexpected call");var t=new Image;t.onload=function(){e.status=r.Loaded,(0,i.verifyArgumentNotNull)(l.onImageLoadSuccessCallback,"onImageLoadSuccessCallback","imageLoader::onload"),l.onImageLoadSuccessCallback(e.blockIdentifiers),e.blockIdentifiers=[]},t.onerror=function(){e.status=r.LoadFailed,(0,i.verifyArgumentNotNull)(l.onImageLoadFailureCallback,"onImageLoadFailureCallback","imageLoader::onerror"),l.onImageLoadFailureCallback("image failed to load, URL: ".concat(e.url,", registeredModelsCount: ").concat(e.blockIdentifiers.length,", registeredModelsCount: ").concat(e.blockIdentifiers)),e.blockIdentifiers=[]},t.src=e.url,e.image=t,e.status=r.Loading}function f(e){return a[e]}function h(e,t){a[e]=t}function C(e){a[e]=void 0}t.initializeGridRendererImageLoader=function(e,t){l.onImageLoadSuccessCallback=e,l.onImageLoadFailureCallback=t},t.setStaticImageUrl=function(e,t){(0,i.verifyArgumentNotNull)(t,"url","setStaticImageUrl");var n=d(e),o=f(n);if(o){if(o.url)throw Error("setStaticImageUrl: image url already defined. image: ".concat(e,", old url: ").concat(o.url,", new url: ").concat(t));o.url=t,g(o)}else h(n,{blockIdentifiers:[],status:r.Initialized,url:t})},t.clearImageFromCache=function(e,t){var n=u(e,t);f(n)&&C(n)},t.getOrLoadVersionedImage=function(e,t,n,r,o){var i=u(e,r),l=f(i);return!l||l.version===t&&l.url===n||C(i),s(i,o,t,n)},t.getOrLoadStaticImage=function(e,t){return s(d(e),t,void 0,void 0)},t.testHelper={getImageCacheItem:function(e){return f(e)},resetImageCache:function(){for(var e in a)delete a[e]},getImageKey:function(e,t){return u(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdjustedOffsetXforHorizontalAlignment=t.measureFormattedTextWidth=t.substringFormattedText=t.fillRichTextFormat=void 0;var r=n(1),o=n(0),i=n(10),l=n(5),a=n(9),s=n(65),d=n(41),u=n(2),c=n(6),g=n(13),f=n(3),h=n(15),C=n(35),m=n(7),p=n(85),y=n(64),v=n(69),S=n(14),R=n(12),F=n(68),w=n(40),T=n(18);function I(e,t){return e>=t.StartIndex&&e<t.EndIndex}function x(e,t,n){for(var r=[],o=0;o<t.length;o++){var i=t[o];if(I(e,i))return o;i&&r.push({index:o,startIndex:i.StartIndex,endIndex:i.EndIndex})}var l=n.text,a=n.formattedTextLength,s=n.isCarriageReturnExists,d=(0,F.breakToGraphemes)(l);throw Error("Failed to find text run index for textOffsetIndex: ".concat(e,", runs.length: ").concat(t.length,", runsIndices: ").concat(JSON.stringify(r),", formattedTextLength: ").concat(a,", isCarriageReturnExists:").concat(s,", isGraphemeExists: ").concat((null==l?void 0:l.length)!==d.length," "))}function b(e,t,n){var r=e.CachedFont;e.ShrunkSize=r.Size*t,e.FontCss=(0,i.getFontCssStringFromFont)(r,e.ShrunkSize,n),e.WidthPx=e.WidthPx*t}function D(e,t,n){var r=t.CachedFont;t.ShrunkSize=n;var o=(0,a.getFontLineHeight)(e,t.ShrunkSize,null==r?void 0:r.FontName),l=(0,a.measureTextHeightForVerticalText)(o,t.Text);t.FontCss=(0,i.getFontCssStringFromFont)(r,t.ShrunkSize,e),t.MaxGlyphHeightPx=o,t.HeightPx=l}function A(e,t){for(var n=0,o=t,i=!1,l=!1,a=t;a<e.length;a++){var s=e[a];if(s.Underline===r.FontUnderline.None)break;s.Underline===r.FontUnderline.Single?i=!0:s.Underline===r.FontUnderline.Double&&(l=!0);var d=s.CachedFont;n=Math.max(n,s.ShrunkSize||d.Size),o=a}return{maxFontSize:n,sequenceEndRunIndex:o,hasMixedUnderlineTypes:i&&l}}function P(e,t,n,r,o,i){var l=r&&!(0,m.isNullOrUndefined)(i)?i:o;return(0,h.adjustXForHorizontalAlignment)(e,t,n,l)}function H(e,t,n,r,o){return r?n:o?t:e}function B(e,t,n,o,i,l){var s,d=l,u=0;return(s=t===r.FontVerticalAlignment.Subscript||t===r.FontVerticalAlignment.Superscript)&&(u=(0,a.calculateSubSuperOffsetY)(e,t||r.FontVerticalAlignment.None,n,o,i,s),d=!0),{subSuperOffsetY:u,hasVerticalAlignedFont:d,isFontVerticalAlignment:s}}function M(e,t,n,o,i,l,a,s,u,c,g,f,h,C){var m=l,y=i;if(h)!function(e,t,n,o,i,l,a,s,u,c,g){var f,h;if(!n.JustifyDistributedLine)return;var C=t+(u?0:n.JustifyDistributedLine.Start.Offset),m=C,p=!0===n.Strikethrough;O(e,i,l,n.JustifyDistributedLine.Start,t,o,u,n.MaxGlyphHeightPx,a,p,s,c,g),C=t+(u?0:n.JustifyDistributedLine.Start.Offset+n.JustifyDistributedLine.Start.Width),(null===(f=n.JustifyDistributedLine)||void 0===f?void 0:f.Middle)&&(O(e,i,l,n.JustifyDistributedLine.Middle,t,o,u,n.MaxGlyphHeightPx,a,p,s,c,g),C=t+(u?0:n.JustifyDistributedLine.Middle.Offset+n.JustifyDistributedLine.Middle.Width));(null===(h=n.JustifyDistributedLine)||void 0===h?void 0:h.End)&&(O(e,i,l,n.JustifyDistributedLine.End,t,o,u,n.MaxGlyphHeightPx,a,p,s,c,g),C=t+(u?0:n.JustifyDistributedLine.End.Offset+n.JustifyDistributedLine.End.Width));if(!u&&(n.Underline!==r.FontUnderline.None||n.Strikethrough)){var y={clipRect:c,textPositionX:m,textPositionY:o,textWidth:C-m,partOfMixedUnderlineSequence:n.HasMixedUnderline};(0,d.cacheTextDecorationLayout)(i,l,a,y,s,n.UnderlineWidth)}}(e,i,a,l,t,n,o,a.CachedFont,f,c,C);else{if(k(e,t,n,a.Text,i,l,f,a.MaxGlyphHeightPx,o,!0===a.Strikethrough,a.CachedFont,c),!f&&(a.Underline!==r.FontUnderline.None||a.Strikethrough)){var v={clipRect:c,textPositionX:i,textPositionY:l,textWidth:a.WidthPx,containSubscript:g===r.FontVerticalAlignment.Subscript,partOfMixedUnderlineSequence:a.HasMixedUnderline};(0,d.cacheTextDecorationLayout)(t,n,o,v,a.CachedFont,a.UnderlineWidth)}f?m=function(e,t,n,o,i){var l=i+1<o.length?(0,p.getTextRun)(!0,o,i+1).HeightPx:0;switch(e){case r.VerticalAlignment.Top:return t-l;case r.VerticalAlignment.Center:return t-(n.HeightPx+l)/2;case r.VerticalAlignment.Bottom:case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:return t-n.HeightPx}}(n.CachedStyle.VerticalAlignment,l,a,s,u):y+=a.WidthPx}return{offsetX:y,offsetY:m}}function O(e,t,n,r,o,i,l,a,s,d,u,c,g){var f=o,h=i;l?h-=r.Offset:f+=r.Offset,k(e,t,n,r.Text,f,h,l,a,s,d,u,c,g)}function k(e,t,n,r,o,i,l,a,s,d,u,c,g){l?(0,v.fillVerticalTextForRTF)(e,t,n,r,o,i,a,s,d,u,c,g):e.fillText(r,o,i)}function L(e,t){for(var n=0,r=t[0],o=0;o<e.length;o++){var i=e[o].CachedFont;n=Math.max(n,i.Size),r.Size<n&&(r=i)}return r}t.fillRichTextFormat=function(e,t,n,o,i,f,v,F,I,x){if((0,l.verifyArgumentNotNull)(o,"cell","fillRichTextFormat"),(0,l.verifyArgumentNotNull)(n,"model","fillRichTextFormat"),(0,l.verifyArgumentNotNull)(i,"formattedText","fillRichTextFormat"),(0,l.verifyArgumentNotNull)(i.TextRuns[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat"),0!==i.Text.length){var O=i.TextRuns;(0,l.verifyArgumentNotNull)(O[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat");var k=function(e,t){if(!t)return!1;if((0,S.isVerticalAlignmentJustifiedOrDistributedForVerticalText)(e))return!(t.breakType===C.BreakType.Justify&&t.isProcessingLastLine);return(0,h.isHorizontalAlignmentJustifiedAndDistributed)(e)}(o,x),N=function(e,t,n,o,i,l,d,f,h){var C=(0,a.getBidiContext)(n),y=(0,S.shouldRenderVerticalText)(n),v=function(e,t,n,r,o){var i,l,s=t.Fonts;if(n.WrapText){var d=(0,a.measureTextRunsWidth)(e,r,o,t,(0,a.getBidiContext)(n));l=d.totalSize,i=d.textRunsDrawingInformation}else l=(0,a.getTextWidth)(e,t,n),i=n.CachedDrawingLayout.TextRunDrawingInformation;if(!i||!r)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";var u=L(i,s);return{totalTextRunWidth:l,largestFont:u,preparedRuns:i}}(e,t,n,i,l),F=0,I=v.totalTextRunWidth,x=v.largestFont,P=v.preparedRuns;!y&&C.HasRtl&&(0,g.trackDuration)(g.RenderPerformanceMetric.ReorderBidiTextRuns,(function(){(0,s.reorderTextRunsForBidiDrawing)(P,l,C,I)}),!0);y&&(F=function(e,t){for(var n=0,r=0;r<t.length;r++){var o=t[r],i=o.CachedFont,l=(0,a.getFontLineHeight)(e,null==i?void 0:i.Size,null==i?void 0:i.FontName),s=(0,a.measureTextHeightForVerticalText)(l,o.Text);o.MaxGlyphHeightPx=l,o.HeightPx=s,n+=s}return n}(t,P));n.CachedStyle.ShrinkToFit&&(y?F=function(e,t,n,r){var o=(0,c.getCellHeight)(e,t,!1);if(r<o)return r;return function(e,t,n,r){for(var o=0,i=0;i<t.length;i++){var l=(d=t[i]).CachedFont,a=Math.floor(l.Size*r);D(e,d,a),o+=d.HeightPx}for(;o<n;){o=0;for(i=0;i<t.length;i++){if((d=t[i]).ShrunkSize<w.MaxAllowedFontSize){var s=d.ShrunkSize+1;D(e,d,s)}o+=d.HeightPx}}for(;o>n;){o=0;for(i=0;i<t.length;i++){var d;if((d=t[i]).ShrunkSize>w.MinAllowedFontSize){s=d.ShrunkSize-1;D(e,d,s)}o+=d.HeightPx}}return o}(e,n,o,o/r)}(t,n,P,F):I=function(e,t,n,r,o){var i=(0,c.getCellWidth)(e,t,!1),l=t.CachedStyle.Indentation||0,s=(0,T.shouldAddAutoFilterPadding)(e,t)?(0,T.getAutoFilterButtonPadding)(e,t,n.zoom,n.devicePixelRatio):0,d=r[0].CachedFont,g=(0,a.getHorizontalPadding)(e,t,d.Size,t.CachedFont.Italic,l||0,!0,s),f=(0,u.getTextDrawingMaxWidth)(i,g,(0,a.getDistanceFromCellStartToIconEnd)(e,t,n.zoom,n.devicePixelRatio),(0,R.getExpandCollapseButtonPadding)(t),0);if(o<f)return o;for(var h=f/(o+g),C=0,m=0;m<r.length;m++){var p=r[m];b(p,h,e),C+=p.WidthPx}return C}(t,n,o,P,I));(function(e){var t=0;for(;t<e.length;){if(e[t].Underline===r.FontUnderline.None)t++;else for(var n=A(e,t),o=n.maxFontSize,i=n.sequenceEndRunIndex,l=n.hasMixedUnderlineTypes,s=(0,a.getTextDecorationLineWidth)(o);t<=i;t++)e[t].UnderlineWidth=s,e[t].HasMixedUnderline=l}})(P),!d||(0,m.isNullOrUndefined)(f)||(0,m.isNullOrUndefined)(h)||(0,p.prepareTextRunsForJustifyAndDistributed)(e,t,h,f,P,y);return{totalTextRunHeight:F,totalTextRunWidth:I,largestFont:x,preparedRuns:P}}(e,n,o,t,O,i.Text,k,I,x),E=N.totalTextRunHeight,z=N.totalTextRunWidth,W=N.largestFont,G=N.preparedRuns,V=(0,r.getCellStyle)(n,o);(0,l.verifyArgumentNotNull)(V,"cellStyle","fillRichTextFormat"),function(e,t,n,o,i,s,g,f,h,C,v,R,F){var T,I,x,b=e.textAlign,D=e.textBaseline,A=e.font,O=e.fillStyle,k=(0,S.shouldRenderVerticalText)(o),N=f;k&&(N=function(e,t,n,o,i,l,a){var s;if(!l&&(null===(s=t.CachedStyle)||void 0===s?void 0:s.VerticalAlignment)===r.VerticalAlignment.Justify){var d=L(n,e.Fonts),u=(0,y.getCachedFontMetrics)(d.FontName,d.Size,e).baseline;return(0,c.getCellBottom)(e,t)-w.LineHeightBottomConstantPx-u-(a-o)}return i}(n,o,h,C,N,v,F));N=function(e,t,n,o,i,s,d){if(t)return function(e,t,n,o){var i=e.CachedStyle.VerticalAlignment,l=o.length-1,a=o[l].HeightPx||0;switch(i){case r.VerticalAlignment.Top:return t+n-a;case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:case r.VerticalAlignment.Bottom:return t;case r.VerticalAlignment.Center:return t+(n-a)/2}}(n,o,i,s);return function(e,t,n,o){var i=n.CachedStyle.VerticalAlignment,s=(0,a.getFontLineHeight)(e,t.Size,t.FontName),d=(0,y.getCachedFontMetrics)(t.FontName,t.Size,e).baseline;(0,l.verifyArgumentNotNull)(d,"textBaselineAdjustY","adjustYForVerticalAlignment");var u=o-d;if(i===r.VerticalAlignment.Center)return u+(s-d)/2;return u}(e,d,n,o)}(n,k,o,N,C,h,s);var E=k?g:P(n,o,g,v,i,F),z=!1;e.textAlign="left",e.textBaseline="alphabetic",t.highContrastScheme&&(e.fillStyle=(0,u.getHighContrastTextColor)(o,t.highContrastScheme,n));for(var W=0;W<h.length;W++){var G=(0,p.getTextRun)(k,h,W);(0,l.verifyArgumentNotNull)(G.CachedFont,"run.CachedFont","drawTextRuns");var V=G.CachedFont,j=V.VerticalAlign,_=0,U=!1;k||o.WrapText||(T=B(o,j,V,f,(0,y.getCachedFontMetrics)(V.FontName,V.Size,n),z),_=T.subSuperOffsetY,U=T.isFontVerticalAlignment,z=T.hasVerticalAlignedFont),e.font=G.FontCss,t.highContrastScheme||(e.fillStyle=G.CachedFont.Color),I=M(e,n,o,t,E,H(f,_,N,k,U),G,h,W,R,j,k,v,F),E=I.offsetX,N=I.offsetY}z&&!(0,m.isNullOrUndefined)(null===(x=o.CachedDrawingLayout)||void 0===x?void 0:x.UnderlineRuns)&&(0,d.alignVerticalUnderlineRuns)(n,o,o.CachedDrawingLayout.UnderlineRuns);e.textAlign=b,e.textBaseline=D,e.font=A,e.fillStyle=O}(e,t,n,o,z,W,f,v,G,E,k,F,null==x?void 0:x.maxWidth)}},t.substringFormattedText=function(e,t,n){if((0,l.verifyArgumentNotNull)(e.Text,"formattedText.Text","substringFormattedText"),0===e.Text.length)return f.EmptyFormattedText;var r=e.Text.substring(t,n);if(0===r.length)return{Text:r,Fonts:e.Fonts,TextRuns:[]};var i=e.TextRuns;if((0,l.verifyArgumentNotNull)(i,"formattedText.runs","substringFormattedText"),0===i.length)throw Error("Invalid param: formattedText runs.length === 0");(0,o.prepareTextRunRanges)(i,e.Text);var a=e.Text.length,s={isCarriageReturnExists:-1!==e.Text.indexOf("\r"),formattedTextLength:a,text:e.Text},d=x(t,i,s),u=n&&n<e.Text.length?x(n-1,i,s):i.length-1,c=[],g=i[d];c.push({StartIndex:0,FontID:g.FontID||0,CachedFont:g.CachedFont});for(var h=d+1;h<=u;h++){var C=i[h],m=C.StartIndex-t;c.push({StartIndex:m,FontID:C.FontID||0,CachedFont:C.CachedFont})}return{Text:r,Fonts:e.Fonts,TextRuns:c}},t.measureFormattedTextWidth=function(e,t,n){return(0,a.measureTextRunsWidth)(e,t.TextRuns,t.Text,n).totalSize},t.getAdjustedOffsetXforHorizontalAlignment=P},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridCanvasClassName=t.CanvasTagName=t.PeriodToEvalInMs=t.CanvasHeight=t.CanvasWidth=t.ResultMessageCollectorDisabled=t.ResultMessageInsufficientData=void 0,t.ResultMessageInsufficientData="Insufficient Data",t.ResultMessageCollectorDisabled="Collector Disabled",t.CanvasWidth=1,t.CanvasHeight=1,t.PeriodToEvalInMs=10,t.CanvasTagName="canvas",t.GridCanvasClassName="ewr-sheettable"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractPassiveTelemetryCollector=void 0;var r=n(137),o=function(){function e(e){this.isDisabled=!1,this.name=e,this.data=[]}return e.prototype.canCollectorExecute=function(){return!this.isDisabled&&!!this.data},e.prototype.getCollectorName=function(){return this.name},e.prototype.disable=function(){this.isDisabled=!0},e.prototype.register=function(e){this.data.push(e),(0,r.registerCollector)(this)},e}();t.AbstractPassiveTelemetryCollector=o},,function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.LineDirection=t.BreakType=void 0,function(e){e[e.Wrap=0]="Wrap",e[e.Justify=1]="Justify",e[e.Distributed=2]="Distributed"}(r||(t.BreakType=r={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(o||(t.LineDirection=o={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeArraysTestOnly=t.initializeChangeGatesDataStructure=t.isChangeGateEnabled=t.ChangeGate=void 0;var r,o=n(17);!function(e){e[e.CanonizedFontCssString=0]="CanonizedFontCssString",e[e.ActualFontSizeOptimization=1]="ActualFontSizeOptimization",e[e.OptimizeHeaderTextRendering=2]="OptimizeHeaderTextRendering",e[e.OptimizeHeaderBoldGridlinesRendering=3]="OptimizeHeaderBoldGridlinesRendering",e[e.WrapTextNullFontFix=4]="WrapTextNullFontFix",e[e.TreatZeroAndUndefinedAsEqual=5]="TreatZeroAndUndefinedAsEqual",e[e.AdjacentCellsMergeFix=6]="AdjacentCellsMergeFix",e[e.FixBoldFontsOnMac=7]="FixBoldFontsOnMac",e[e.TableSelectionDragSelection=8]="TableSelectionDragSelection",e[e.FixUserContentList=9]="FixUserContentList",e[e.FixRotatedTextWidth=10]="FixRotatedTextWidth",e[e.ResetContentList=11]="ResetContentList",e[e.addTelemetryForStyleIdCrash=12]="addTelemetryForStyleIdCrash",e[e.AddAptosToCachedFontMetrics=13]="AddAptosToCachedFontMetrics",e[e.protectIsCellPartiallySelected=14]="protectIsCellPartiallySelected",e[e.RichIconFilterScale=15]="RichIconFilterScale",e[e.FixCellImageAlignmentWithRichPivotDrill=16]="FixCellImageAlignmentWithRichPivotDrill",e[e.DontShowRichValueIconForSpilledArrayFormulasInFormulaView=17]="DontShowRichValueIconForSpilledArrayFormulasInFormulaView",e[e.UseClippedX=18]="UseClippedX",e[e.CellIconBottomPadding=19]="CellIconBottomPadding",e[e.FBEFormattedCellsPreviewStyle=20]="FBEFormattedCellsPreviewStyle",e[e.HeaderWithGlobalStyles=21]="HeaderWithGlobalStyles",e[e.HideColMergeCellTelemetry=22]="HideColMergeCellTelemetry",e[e.FixHeaderSnappingAutoFilterNone=23]="FixHeaderSnappingAutoFilterNone",e[e.ArrayOverflowInvestigation=24]="ArrayOverflowInvestigation",e[e.FixAggregatedPerfTelemetry=25]="FixAggregatedPerfTelemetry",e[e.ReRenderGridAndHeaderOnFontLoad=26]="ReRenderGridAndHeaderOnFontLoad",e[e.FixBorderStylesEqual=27]="FixBorderStylesEqual",e[e.PreviewCellsSettings=28]="PreviewCellsSettings",e[e.FixBorderWithMergeCellComparison=29]="FixBorderWithMergeCellComparison",e[e.RotatedTextDecorationWithMergeCellBugFix=30]="RotatedTextDecorationWithMergeCellBugFix",e[e.HandlePointerLeaveEventFromHeaderCanvas=31]="HandlePointerLeaveEventFromHeaderCanvas",e[e.GlobalStyleTrace=32]="GlobalStyleTrace",e[e.RapidClicksOnCheckbox=33]="RapidClicksOnCheckbox",e[e.CursorChangeOnIsEditMode=34]="CursorChangeOnIsEditMode",e[e.CheckboxFallbackFont=35]="CheckboxFallbackFont",e[e.ModernHeaderResizeHitRegion=36]="ModernHeaderResizeHitRegion",e[e.ResizePillHighContrastFix=37]="ResizePillHighContrastFix",e[e.InsertRowColBorderCascadingBugFix=38]="InsertRowColBorderCascadingBugFix",e[e.ResizePillAlignmentFix=39]="ResizePillAlignmentFix",e[e.EnablingRowColCSEForComplexCellsSlice2=40]="EnablingRowColCSEForComplexCellsSlice2",e[e.FontLoadInSafari=41]="FontLoadInSafari",e[e.BlockEdgeBorderThicknessFix=42]="BlockEdgeBorderThicknessFix",e[e.EnablingHiddenRangesSlice2=43]="EnablingHiddenRangesSlice2",e[e.HideCheckboxOnShowFormula=44]="HideCheckboxOnShowFormula",e[e.CellHoverStateProperty=45]="CellHoverStateProperty",e[e.UseClippedXCheckbox=46]="UseClippedXCheckbox",e[e.BorderRowColOps=47]="BorderRowColOps",e[e.BorderRowColOpsV2=48]="BorderRowColOpsV2",e[e.StyleIdCrashFix=49]="StyleIdCrashFix",e[e.FixCopyBlankCellToACellWithCheckbox=50]="FixCopyBlankCellToACellWithCheckbox",e[e.CanvasTextMeasure=51]="CanvasTextMeasure",e[e.BetterExceptionHandling=52]="BetterExceptionHandling",e[e.AutofitWidthGlobalStyle=53]="AutofitWidthGlobalStyle",e[e.MaxAllowedRowColLimitBugFix=54]="MaxAllowedRowColLimitBugFix",e[e.HideCommentIndicators=55]="HideCommentIndicators",e[e.InsertCSEBorderCopyBugFix=56]="InsertCSEBorderCopyBugFix",e[e.InsertRowHeightMismatchBugFix=57]="InsertRowHeightMismatchBugFix",e[e.RemoveCellFromExtraModelBugFix=58]="RemoveCellFromExtraModelBugFix",e[e.EnableEdgeBorderStyleSupportForFreezePanesCSE=59]="EnableEdgeBorderStyleSupportForFreezePanesCSE",e[e.FixOnCanvasPointerLeave=60]="FixOnCanvasPointerLeave",e[e.HideColMergedCellAcrossBlocks=61]="HideColMergedCellAcrossBlocks",e[e.DisableMFPInSafari=62]="DisableMFPInSafari",e[e.EnableMergeCellSupportForFreezePanesCse=63]="EnableMergeCellSupportForFreezePanesCse",e[e.CheckboxInCellImageCheck=64]="CheckboxInCellImageCheck",e[e.ImprovedExceptionHandling=65]="ImprovedExceptionHandling",e[e.GridRenderPerfFix=66]="GridRenderPerfFix",e[e.FixInsertButtonSpill=67]="FixInsertButtonSpill",e[e.HeaderCellCompareFix=68]="HeaderCellCompareFix",e[e.FixStyleIdIssue=69]="FixStyleIdIssue",e[e.TakeAutoFilterBeforePivotFilter=70]="TakeAutoFilterBeforePivotFilter",e[e.PLTRegressionInMFPFix=71]="PLTRegressionInMFPFix",e[e.BorderScenarioForCascade=72]="BorderScenarioForCascade",e[e.ReduceDuplicateInsertDrawing=73]="ReduceDuplicateInsertDrawing",e[e.LastChangeGateDontDelete=74]="LastChangeGateDontDelete"}(r||(t.ChangeGate=r={}));var i=r.LastChangeGateDontDelete,l=g(i,32),a=l.changeGatesNamesArray,s=l.changeGatesBitMap,d=l.cachedChangeGatesBitMap;function u(e,t,n){return 0!=(e[t]&n)}function c(e,t,n){e[t]|=n}function g(e,t){var n=new Array(e),r=Math.ceil(e/t);return{changeGatesNamesArray:n,changeGatesBitMap:f(r),cachedChangeGatesBitMap:f(r)}}function f(e){return Array.apply(null,new Array(e)).map((function(){return 0}))}a[r.CanonizedFontCssString]="OfficeVSO:8669814_canonizedFontCssStringV2",a[r.ActualFontSizeOptimization]="OfficeVSO:8662390_ActualFontSizeOptimization",a[r.OptimizeHeaderTextRendering]="OfficeVSO:8643312_OptimizeHeaderTextRendering",a[r.OptimizeHeaderBoldGridlinesRendering]="OfficeVSO:8749932_OptimizeFluentBoldGridlines",a[r.WrapTextNullFontFix]="OfficeVSO:8547550_WrapTextNullFontFix",a[r.TreatZeroAndUndefinedAsEqual]="OfficeVSO:5010362_TreatZeroAndUndefinedAsEqual",a[r.AdjacentCellsMergeFix]="OfficeVSO:5230472_adjacentCellsMergeFix2",a[r.FixBoldFontsOnMac]="OfficeVSO:7477362_FixBoldFontsOnMacn",a[r.TableSelectionDragSelection]="OfficeVSO:5501896_TableSelectionDragSelection",a[r.FixUserContentList]="OfficeVSO:6006812_FixUserContentList",a[r.FixRotatedTextWidth]="OfficeVSO:6582281_FixRotatedTextWidth",a[r.ResetContentList]="OfficeVSO:7259557_ResetContentList",a[r.addTelemetryForStyleIdCrash]="OfficeVSO:7426943_addTelemetryForStyleIdCrash2",a[r.AddAptosToCachedFontMetrics]="OfficeVSO:8557915_AddAptosToCachedFontMetrics",a[r.protectIsCellPartiallySelected]="OfficeVSO:7733119_protectIsCellPartiallySelected",a[r.RichIconFilterScale]="OfficeVSO:7525144_RichIconFilterScale",a[r.FixCellImageAlignmentWithRichPivotDrill]="OfficeVSO:7910214_FixCellImageAlignmentWithRichPivotDrill",a[r.UseClippedX]="OfficeVSO:7868644_InCellControlCheckboxClippingInXLO",a[r.CellIconBottomPadding]="OfficeVSO:7944046_CellIconBottomPadding",a[r.FixHeaderSnappingAutoFilterNone]="OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone",a[r.DontShowRichValueIconForSpilledArrayFormulasInFormulaView]="OfficeVSO:7971025_dontShowRichValueIconForSpilledArrayFormulasInFormulaView",a[r.HeaderWithGlobalStyles]="OfficeVSO:8126763_HeaderWithGlobalStyles",a[r.HideColMergeCellTelemetry]="OfficeVSO:8137545_HideColMergeCellTelemetry",a[r.ArrayOverflowInvestigation]="OfficeVSO:8174620_CanvasArrayOverflowInvestigationLog",a[r.FixAggregatedPerfTelemetry]="OfficeVSO:8365978_FixEmptyPreviewText",a[r.ReRenderGridAndHeaderOnFontLoad]="OfficeVSO:8369387_ReRenderGridAndHeaderOnFontLoadV2",a[r.FixBorderStylesEqual]="OfficeVSO:8353755_fixBorderStylesEqual",a[r.FixBorderWithMergeCellComparison]="OfficeVSO:8381160_FixBorderWithMergeCellComparison",a[r.PreviewCellsSettings]="OfficeVSO:8390976_PreviewCellsSettings",a[r.RotatedTextDecorationWithMergeCellBugFix]="OfficeVSO:8429004_RotatedTextDecorationWithMergeCellBugFix",a[r.HandlePointerLeaveEventFromHeaderCanvas]="OfficeVSO:8444516_HandlePointerLeaveEventFromHeaderCanvas",a[r.GlobalStyleTrace]="OfficeVSO:8546428_globalStyleTrace",a[r.RapidClicksOnCheckbox]="OfficeVSO:8520577_Bug8492612RapidClicksOnCheckbox",a[r.CursorChangeOnIsEditMode]="OfficeVSO:8519736_Bug8046450CursorChangeOnIsEditMode",a[r.CheckboxFallbackFont]="OfficeVSO:8573746_CheckboxFallbackFontEnabled",a[r.ModernHeaderResizeHitRegion]="OfficeVSO:8553924_ResizeNewHitRegion",a[r.ResizePillHighContrastFix]="OfficeVSO:8606316_ResizePillHighContrastFix",a[r.InsertRowColBorderCascadingBugFix]="OfficeVSO:8614087_InsertRowColBorderCascadingBugFix",a[r.ResizePillAlignmentFix]="OfficeVSO:8596873_ResizePillAlignmentFix",a[r.EnablingRowColCSEForComplexCellsSlice2]="OfficeVSO:8633190_EnablingRowColCSEForComplexCellsSlice2",a[r.FontLoadInSafari]="OfficeVSO:8548876_FontLoadInSafariV5",a[r.BlockEdgeBorderThicknessFix]="OfficeVSO:8612257_BlockEdgeBorderThicknessFix",a[r.EnablingHiddenRangesSlice2]="OfficeVSO:8606744_EnablingCseForHiddenRangesSlice2",a[r.HideCheckboxOnShowFormula]="OfficeVSO:8595087_HideCheckboxOnShowFormula",a[r.CellHoverStateProperty]="OfficeVSO:8640780_CellHoverStateProperty",a[r.BorderRowColOps]="OfficeVSO:8675285_borderRowColOps",a[r.BorderRowColOpsV2]="OfficeVSO:8675285_borderRowColOpsV2",a[r.UseClippedXCheckbox]="OfficeVSO:8654438_UseClippedXCheckbox",a[r.StyleIdCrashFix]="OfficeVSO:8683770_StyleIdCrashV2",a[r.CanvasTextMeasure]="OfficeVSO:8699044_canvasTextMeasure",a[r.FixCopyBlankCellToACellWithCheckbox]="OfficeVSO:8689743_FixCopyBlankCellToACellWithCheckbox",a[r.AutofitWidthGlobalStyle]="OfficeVSO:8708631_AutofitWidthGlobalStyles",a[r.InsertCSEBorderCopyBugFix]="OfficeVSO:8708035_InsertCSEBorderCopyBuFix",a[r.BetterExceptionHandling]="OfficeVSO:8712993_BetterExceptionHandlingForGlobalStyle",a[r.MaxAllowedRowColLimitBugFix]="OfficeVSO:8712187_MaxAllowedRowColLimitBugFix",a[r.HideCommentIndicators]="OfficeVSO:8608691_HideCommentIndicators",a[r.InsertRowHeightMismatchBugFix]="OfficeVSO:8736452_InsertRowHeightMismatchBugFix",a[r.RemoveCellFromExtraModelBugFix]="OfficeVSO:8748429_removeCellFromExtraModelBugFix",a[r.EnableEdgeBorderStyleSupportForFreezePanesCSE]="OfficeVSO:8750362_enableEdgeBorderStyleSupportForFreezePanesCSE",a[r.FixOnCanvasPointerLeave]="OfficeVSO:8761594_FixOnCanvasPointerLeave",a[r.HideColMergedCellAcrossBlocks]=" OfficeVSO:8776386_HideColMergedCellAcrossBlocksEnabled",a[r.DisableMFPInSafari]="OfficeVSO:8522252_disableMFPInSafari",a[r.EnableMergeCellSupportForFreezePanesCse]="OfficeVSO:8778653_enableFreezePanesCseForSheetsWithMergeCells",a[r.CheckboxInCellImageCheck]="OfficeVSO:8766511_CheckboxInCellImageCheck",a[r.ImprovedExceptionHandling]="OfficeVSO:8793263_improvedExceptionHandlingGlobalStyles",a[r.GridRenderPerfFix]="OfficeVSO:8752178_GridRenderPerfFix",a[r.FixInsertButtonSpill]="OfficeVSO:8781275_FixInsertButtonSpill",a[r.HeaderCellCompareFix]="OfficeVSO:8802160_HeaderCellCompareFix",a[r.FixStyleIdIssue]="OfficeVSO:8805047_FixStyleIdIssue",a[r.TakeAutoFilterBeforePivotFilter]="OfficeVSO:8812177_TakeAutoFilterBeforePivotFilter",a[r.BorderScenarioForCascade]="OfficeVSO:8852132_BorderScenarioForCascade",a[r.PLTRegressionInMFPFix]="OfficeVSO:8830767_PLTRegressionInMFPFix",a[r.ReduceDuplicateInsertDrawing]="OfficeVSO:8830459_ReduceDuplicateInsertDrawing",t.isChangeGateEnabled=function(e){var t=Math.floor(e/32),n=1<<e%32;return function(e,t,n){if(!u(d,t,n)){(0,o.isChangeGateEnabled)(a[e])&&c(s,t,n),c(d,t,n)}}(e,t,n),u(s,t,n)},t.initializeChangeGatesDataStructure=g,t.initializeArraysTestOnly=function(e){i=e.length,a=e;var t=Math.ceil(i/32);s=new Array(t).fill(0),d=new Array(t).fill(0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pixelsPerPoint=t.DistanceBetweenCFIconAndExpandCollapseButton=t.DefaultFallbackFontName=t.IconTextMinimalPadding=t.DefaultTextBaseline=void 0,t.DefaultTextBaseline="alphabetic",t.IconTextMinimalPadding=1,t.DefaultFallbackFontName="calibri",t.DistanceBetweenCFIconAndExpandCollapseButton=2,t.pixelsPerPoint=1.33333333333333},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDimensionAdjustedForDrawing=t.getColumnHeaderGutterOffsetForDrawing=t.getColumnHeaderGutterSizeForDrawing=t.getCellAbsoluteIndex=t.isCellWhollySelected=t.isCellPartiallySelected=void 0;var r=n(1),o=n(8),i=n(3);function l(e,t){return t?a(i.ColumnHeaderGutterSize,e):0}function a(e,t){return Math.round(e*t)}t.isCellPartiallySelected=function(e,t){return e?t?r.PartiallySelectionHeadersStylesSet.has(e.StyleID||0):(e.StyleID||0)===r.UniqueHeadersStyleID.PartialRowColSelection:(o.ULS.sendTraceTag(509097937,o.LogCategory.msoulscat_ES_EWAJSGrid,o.TraceLevel.Error,"isCellPartiallySelected: cell is not defined"),!1)},t.isCellWhollySelected=function(e,t){return e?t?r.WholeSelectionHeadersStylesSet.has(e.StyleID||0):(e.StyleID||0)===r.UniqueHeadersStyleID.WholeRowColSelection:(o.ULS.sendTraceTag(508059907,o.LogCategory.msoulscat_ES_EWAJSGrid,o.TraceLevel.Error,"isCellWhollySelected: cell is not defined"),!1)},t.getCellAbsoluteIndex=function(e,t,n){return n?e.RowNumbers[t]:e.ColumnNumbers[t]},t.getColumnHeaderGutterSizeForDrawing=l,t.getColumnHeaderGutterOffsetForDrawing=function(e,t){return t?l(e,t)+1:0},t.getDimensionAdjustedForDrawing=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptVerticalPaddingForUnderlinePx=t.KnownFontNamesLowerCase=t.LineHeightBottomConstantPx=t.LineHeightUsingDivFontFactor=t.LineLeading=t.LineHeightFontFactor=t.DefaultCanvasFontString=t.DefaultFontName=t.DefaultFontSizePt=t.MaxAllowedFontSize=t.MinAllowedFontSize=void 0,t.MinAllowedFontSize=1,t.MaxAllowedFontSize=409,t.DefaultFontSizePt=11,t.DefaultFontName="Calibri",t.DefaultCanvasFontString="".concat(t.DefaultFontSizePt,"pt ").concat(t.DefaultFontName),t.LineHeightFontFactor=1.28,t.LineLeading=.06,t.LineHeightUsingDivFontFactor=1+t.LineLeading,t.LineHeightBottomConstantPx=1,t.KnownFontNamesLowerCase=["angsananew","aptosnarrow","aptosdisplay","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho","xlyellow"],t.SubscriptVerticalPaddingForUnderlinePx=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.alignVerticalUnderlineRuns=t.drawTextDecoration=t.cacheTextDecorationLayout=t.measureAndCacheTextDecorationLayout=void 0;var r=n(1),o=n(3),i=n(0),l=n(10),a=n(5),s=n(2),d=n(9),u=n(6),c=n(15),g=n(7),f=n(14),h=n(21),C=(0,r.isChangeGateEnabled)(r.ChangeGate.RotatedTextDecorationWithMergeCellBugFix);function m(e,t,n,o,i,l){if((0,a.verifyArgumentNotNull)(t,"cell","CacheUnderlineLayout"),(0,a.verifyArgumentNotNull)(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),(0,a.verifyArgumentNotNull)(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),(0,a.verifyArgumentNotNull)(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),i.Underline!==r.FontUnderline.None&&!(0,f.shouldRenderVerticalText)(t)){var s={underline:i.Underline},d=S(e,t,n,o,s,i,!1,l),u=t.CachedDrawingLayout.UnderlineRuns;if(d&&u.push(d),R(s)){var c=S(e,t,n,o,{underline:s.underline===r.FontUnderline.DoubleAccounting?r.FontUnderline.SingleAccounting:r.FontUnderline.Single},i,!0,l);c&&u.push(c)}}if(i.StrikeThrough){var g=S(e,t,n,o,{strikethrough:!0},i,!1,void 0);if(g)t.CachedDrawingLayout.StrikethroughRuns.push(g)}}function p(e,t,n,r){var o=r.CachedDrawingLayout.TextOrientationLayout,i=r.CachedDrawingLayout.UnderlineRuns,l=r.CachedDrawingLayout.StrikethroughRuns,a=n.highContrastScheme?(0,s.getHighContrastTextColor)(r,n.highContrastScheme,e):void 0,d=null==o?void 0:o.clipRect,u=void 0;d&&(u={x:d.x*n.scaleFactor,y:d.y*n.scaleFactor,width:d.width*n.scaleFactor,height:d.height*n.scaleFactor}),(0,s.applyClipping)(t,u),(0,h.applyRotation)(t,o.TranslateX*n.scaleFactor,o.TranslateY*n.scaleFactor,o.Angle),t.beginPath(),y(t,void 0,void 0,a,i,l),t.stroke(),t.restore(),(0,s.restoreClipping)(t,u)}function y(e,t,n,r,o,i){for(var l=0,a=[o,i];l<a.length;l++){var s=a[l];if(s&&s.length>0){if(!t||!n){var d=s[0];t=c=null!=r?r:d.Color,n=d.LineWidth,e.strokeStyle=c,e.lineWidth=d.LineWidth}for(var u=0;u<s.length;u++){var c,g=s[u],f=t!==(c=null!=r?r:g.Color),h=n!==g.LineWidth;(f||h)&&(t=c,n=g.LineWidth,e.stroke(),e.strokeStyle=c,e.lineWidth=g.LineWidth,e.beginPath()),I(e,g)}}}return{lineColor:t,lineWidth:n}}function v(e){return e[0].Y>e[1].Y?{top:e[1],bottom:e[0]}:{top:e[0],bottom:e[1]}}function S(e,t,n,i,s,C,m,p){var y=n.scaleFactor,v=m||i.partOfMixedUnderlineSequence&&s.underline===r.FontUnderline.Single,S=(0,l.getActualFontSizeFromFont)(e,t,C,!1),F=function(e,t,n,o,i,l,s,h){var C,m,p,y,v=o.textPositionX,S=o.textWidth,R=n.scaleFactor;if(i.underline===r.FontUnderline.SingleAccounting||i.underline===r.FontUnderline.DoubleAccounting){var F=(0,d.getCellTextHorizontalPadding)(t,e,n.zoom,n.devicePixelRatio);m=(0,u.getCellLeft)(e,t,e.BlockWidth)+F,p=(0,u.getCellRight)(e,t,e.BlockWidth)-F}else{var w=!(0,g.isNullOrUndefined)(t.TextRuns)||(0,c.isHorizontalAlignmentJustifiedAndDistributed)(t);C=function(e,t,n,o,i){var l,a,s=i?r.HorizontalAlignment.Left:(0,c.getEffectiveHorizontalAlignment)(e,t);(0,f.shouldRenderVerticalText)(t)&&(s=r.HorizontalAlignment.Center);switch(s){case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:l=n,a=n+o;break;case r.HorizontalAlignment.Right:l=n-o,a=n;break;case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:l=n-o/2,a=n+o/2;break;default:l=n,a=n+o}return{startX:l,endX:a}}(e,t,v,S,w),m=C.startX,p=C.endX}y=i.strikethrough?function(e,t,n,r,o){var i=n.textPositionY;(0,a.verifyArgumentNotNull)(t.CachedFont,"cell.CachedFont","calculateStrikethroughY");var l=(0,d.getTextDecorationLineWidth)(o.Size);return(0,d.getMiddleBaseline)(e,i,o,r)-l/2}(e,t,o,l,s):function(e,t,n,r){var o=t.textPositionY;(0,a.verifyArgumentNotNull)(e.CachedFont,"cell.CachedFont","calculateUnderlineY");var i=null!=r?r:(0,d.getTextDecorationLineWidth)(n);return o+2*i}(t,o,l,h);return m=Math.round(m*R),p=Math.round(p*R),y=Math.round(y*R),{startX:m,endX:p,Y:y}}(e,t,n,i,s,S,C,p),I=F.startX,x=F.endX,b=F.Y,D=function(e,t,n){var r=(null!=n?n:(0,d.getTextDecorationLineWidth)(t))*e;return Math.max(Math.floor(r),1)}(y,S,p),A=Math.round(o.UnderlineMarginFromTextBaseline*D);R(s)&&(b+=A);var P=(0,h.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont);v&&(b=b-D*(P?o.GapBetweenRotatedDoubleUnderline:o.GapBetweenDoubleUnderline)+A);return P?{StartX:I,EndX:x,Y:b,LineWidth:D,Color:C.Color}:function(e,t,n,r,i,l,a,s,d){var c=r.clipRect,g=n.scaleFactor;if(function(e,t,n,r,o,i,l,a){return function(e,t,n,r){var o=(0,u.getCellTopAdjustedForDrawing)(e,t,!1),i=r+n;return r<=o&&i<=o}(e,t,o,i)||w(e,t,o,i)||function(e,t,n,r){var o=e.clipRect,i=t.scaleFactor,l=o?(o.x+o.width)*i:0,a=!1;o&&(a=n>=l&&r>=l);return a}(r,n,l,a)||function(e,t,n,r){var o=e.clipRect,i=t.scaleFactor,l=o?o.x*i:0,a=!1;o&&(a=n<=l&&r<=l);return a}(r,n,l,a)}(e,t,n,r,i,l,a,s)&&(!r.containSubscript||!w(e,t,i,l)))return;if(c){var f=Math.round(c.x*g),h=Math.round(c.width*g)+f,C=T(a,s,f,h);a=C.start,s=C.end}if(function(e,t,n,r){var i=r+n,l=(0,u.getCellTopAdjustedForDrawing)(e,t,!1)+o.GridLineWidthPx,a=(0,u.getCellBottomAdjustedForDrawing)(e,t)-o.GridLineWidthPx;return r<=l||i>=a}(e,t,i,l)&&(!r.containSubscript||!w(e,t,i,l))){f=(0,u.getCellTopAdjustedForDrawing)(e,t,!1),h=(0,u.getCellBottomAdjustedForDrawing)(e,t)-o.GridLineWidthPx;var m=T(l,l+i,f,h);l=m.start,i=m.end-l}return{StartX:a,EndX:s,Y:l,LineWidth:i,Color:d.Color}}(e,t,n,i,D,b,I,x,C)}function R(e){return e.underline===r.FontUnderline.Double||e.underline===r.FontUnderline.DoubleAccounting}function F(e,t){return e[t].StartX===e[t+1].StartX}function w(e,t,n,r){var o=(0,u.getCellBottomAdjustedForDrawing)(e,t);return r>=o&&r+n>=o}function T(e,t,n,r){var o=Math.min(e,t),i=Math.max(e,t),l=Math.min(n,r),a=Math.max(n,r);return{start:Math.max(o,l),end:Math.min(i,a)}}function I(e,t){if(0!==t.LineWidth){var n=t.Y+(0,i.getLinePixelTranslation)(t.LineWidth);!function(e,t,n,r){e.moveTo(t,r),e.lineTo(n,r)}(e,t.StartX,t.EndX,n)}}t.measureAndCacheTextDecorationLayout=function(e,t,n,r,o){var i=n.CachedFont.Underline,l=n.CachedFont.StrikeThrough;(i||l)&&""!==n.CachedDisplayText&&(o.textWidth=(0,d.getTextWidth)(e,t,n),m(t,n,r,o,n.CachedFont))},t.cacheTextDecorationLayout=m,t.drawTextDecoration=function(e,t,n){var r,i,l,d,c;e.beginPath();for(var g=[],f=t.ClientOnlyCache.CellsToRender,m=0;m<f.length;m++){var v=f[m];if((0,s.cellIntersectsRenderingRegion)(v,n.renderingRegion)&&((0,a.verifyArgumentNotNull)(v.CachedFont,"cell.CachedFont","drawTextDecoration"),(v.CachedFont.StrikeThrough||v.CachedFont.Underline||v.TextRuns)&&!(v.CondFormat&&(null===(r=v.CondFormat)||void 0===r?void 0:r.Icon)&&(null===(l=null===(i=v.CondFormat)||void 0===i?void 0:i.Icon)||void 0===l?void 0:l.IconOnly)||v.ShowSkeleton))){(0,a.verifyArgumentNotNull)(v.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");var S=v.CachedDrawingLayout.TextOrientationLayout,R=v.CachedDrawingLayout.UnderlineRuns,F=v.CachedDrawingLayout.StrikethroughRuns,w=n.highContrastScheme?(0,s.getHighContrastTextColor)(v,n.highContrastScheme,t):void 0;if(!!S&&(0,h.shouldDrawRotatedText)(t,v.CachedStyle,v.CachedFont))g.push(v);else{var T=y(e,d,c,w,R,F);d=T.lineColor,c=T.lineWidth}}}e.stroke(),g.length>0&&function(e,t,n,r){for(var i=void 0,l=-1,a=[],d=0;d<r.length;d++){var c=r[d],g=(e.RowHeights[c.Row]-o.GridLineWidthPx)*n.scaleFactor,f=e.ClientOnlyCache?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[c.Row]:e.RowOffsets[c.Row];c.Row!==l&&(-1!==l&&(0,s.restoreClipping)(t,i),i={x:0,y:f,width:e.BlockWidth*n.scaleFactor,height:g},(0,s.applyClipping)(t,i),l=c.Row),C&&(0,u.isCellSpansMultipleRowsOrBlocks)(c)?a.push(c):p(e,t,n,c)}if((0,s.restoreClipping)(t,i),C)for(var h=0,m=a;h<m.length;h++){c=m[h];p(e,t,n,c)}}(t,e,n,g)},t.alignVerticalUnderlineRuns=function(e,t,n){if(!((0,g.isNullOrUndefined)(n)||n.length<=0))for(var r=function(e,t,n){for(var r=-1,o=-1,i=0,l=!1,a=0;a<n.length;a++)if(!(a>0&&F(n,a-1)))if(a<n.length-1&&F(n,a)){var s=v([n[a],n[a+1]]),d=s.top,c=s.bottom;d.Y>r&&(r=d.Y),c.Y>o&&(o=c.Y,i=Math.max(c.LineWidth,1),l=!0)}else n[a].Y>r&&(r=n[a].Y,l||(i=Math.max(n[a].LineWidth,1)));w(e,t,i,o)&&(o=(0,u.getCellBottomAdjustedForDrawing)(e,t)-i,r=o-2*i);r-o<2*i&&(r=o-2*i);return{closestToBottomUnderline:r,closestToBottomDoubleUnderline:o,closestToBottomUnderlineWidth:i}}(e,t,n),o=0;o<n.length;o++)if(!(o>0&&n[o].StartX===n[o-1].StartX)){if(o<n.length-1&&n[o].StartX===n[o+1].StartX){var i=v([n[o],n[o+1]]),l=i.top,a=i.bottom;l.Y=r.closestToBottomUnderline,a.Y=r.closestToBottomDoubleUnderline,n[o+1].LineWidth=r.closestToBottomUnderlineWidth}else n[o].Y=r.closestToBottomUnderline;n[o].LineWidth=r.closestToBottomUnderlineWidth}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIncreasedHeaderSizeEnabled=t.isHeaderInsertEnabled=t.processGlobalStyles=t.getCellBorderStyle=t.cloneOutlines=t.initCellLookup=t.getSpilledOverCount=t.uniqueValuesFilter=t.cellsPositionComparer=t.getCellStyle=t.getCell=t.isDifferentialRenderingSupported=t.getRenderingRegionHitTestCache=t.cleanHitTestCache=t.initModelClientCache=t.validateCellShouldExistInModelUnsafe=t.getOrCreateCell=t.getModelClientCache=t.getAdjacentCellsKeys=t.getAdjacentCellsKeysOld=t.getAllSpillingOverCells=t.getAllSpanningCellsKeys=t.getDefaultCell=t.isAccAndCustomNumFmtApplicable=t.shouldOverrideText=t.getReferencedObjectToCache=t.getRowColFromCellKey=t.getCellLookupKey=void 0;var r=n(4),o=n(61),i=n(25),l=n(26),a=n(78),s=n(102),d=n(37),u=n(103),c=n(29),g=n(8),f=n(104),h=n(153),C=n(51),m=n(54),p=n(17);function y(e,t){return(e<<a.CellLookupRowShift)+t}function v(e){var t=e%a.CellLookupColumnMod;return{row:e>>a.CellLookupRowShift,column:t}}function S(e,t,n,r){void 0===n&&(n=void 0),void 0===r&&(r=void 0);var l=n&&0!==n.length?(0,o.getReferencedObjectById)(i.UniqueStyleID.Default,n):void 0;return{Col:t,CachedStyle:l,CachedFont:r&&0!==r.length&&l?(0,o.getReferencedObjectById)(l.FontID||0,r):void 0,HorizontalAlignmentSet:!1,Ifmt:0,IfmtStamped:0,Row:e,StyleID:i.UniqueStyleID.Default,BorderStyleID:i.UniqueStyleID.DefaultBorder,CachedBorderStyle:{Borders:[],ID:0},Text:"",ValueType:i.CellValueType.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}}function R(e,t){for(var n=[],r=0;r<t.length;r++){var o=v(t[r]),i=o.row,l=o.column,a=N(e,i,l),d=a.cellBefore,u=a.cellAfter;d&&O(d)&&L(d,l,s.SpillDirection.End)&&n.push(y(d.Row,d.Col)),u&&O(u)&&L(u,l,s.SpillDirection.Start)&&n.push(y(u.Row,u.Col))}return n}function F(e){return e.ClientOnlyCache||I(e),e.ClientOnlyCache}function w(e,t,n){var r=D(t,n,e);return r||(T(e,t,n),S(t,n,e.Styles,e.Fonts))}function T(e,t,n){if((0,c.verifyArgumentNotNull)(e.RowNumbers,"RowNumbers","validateCellShouldExistInModelUnsafe"),(0,c.verifyArgumentNotNull)(e.ColumnNumbers,"ColumnNumbers","validateCellShouldExistInModelUnsafe"),(0,c.verifyArgumentNotNull)(e.Styles,"Styles","validateCellShouldExistInModelUnsafe"),t<0||n<0||t>=e.RowNumbers.length||n>=e.ColumnNumbers.length)throw Error("validateCellShouldExistInModelUnsafe: cell requested for a cell which is not in range of the model. rowIndex:  ".concat(t,", RowNumbers.length: ").concat(e.RowNumbers.length,",  colIndex:  ").concat(n,", ColumnNumbers.length: ").concat(e.ColumnNumbers.length))}function I(e){e.ClientOnlyCache||(e.ClientOnlyCache={},e.ClientOnlyCache.DirtyType=i.DirtyType.None),e.ClientOnlyCache.RenderingRegionsHitTestCache||function(e){e.ClientOnlyCache&&(e.ClientOnlyCache.RenderingRegionsHitTestCache={})}(e);var t=e.ClientOnlyCache;if(b(e)){var n=t.DirtyCellsKeys.filter(P);t.DirtyCellsKeys=n.sort(E)}t.CellsToRender=function(e){if(!b(e))return e.Cells;return e.ClientOnlyCache.CellLookup=B(e),W(e,e.ClientOnlyCache.DirtyCellsKeys)}(e),t.GridlineOverridingCellsToRender=function(e,t){if(!b(e))return e.Cells;if(function(e){return(0,c.verifyArgumentNotNull)(e,"model","modelType"),void 0!==e.IsRow?i.ModelType.HeaderBlockModel:i.ModelType.GridBlockModel}(e)===i.ModelType.HeaderBlockModel)return[];for(var n=[],r=0;r<t.length;r++){var o=t[r],l=G(e,o);n.push(o);for(var a=0;a<l.length;a++)n.push(l[a])}var s=n.filter(P).sort(E);return W(e,s)}(e,t.DirtyCellsKeys),e.ClientOnlyCache.FallbackFonts={}}function x(e,t){e.ClientOnlyCache&&e.ClientOnlyCache.RenderingRegionsHitTestCache||I(e);var n=e.ClientOnlyCache.RenderingRegionsHitTestCache[t];return n||(e.ClientOnlyCache.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}},e.ClientOnlyCache.RenderingRegionsHitTestCache[t])}function b(e){var t=F(e);return t.IsDirty&&!t.DisableDiffRendering&&t.DirtyCellsKeys&&t.DirtyCellsKeys.length>0}function D(e,t,n){(0,c.verifyArgumentNotNull)(n,"model","initCellLookup");var r=F(n);return r.CellLookup||(r.CellLookup=B(n)),r.CellLookup[y(e,t)]}function A(e,t){return(0,c.verifyArgumentNotNull)(t,"cell","getCellStyle"),(0,c.verifyArgumentNotNull)(e.Styles,"Styles","getCellStyle"),t.CachedStyle||(t.CachedStyle=(0,u.getCellStyleByID)(t,e)),t.CachedStyle}function P(e,t,n){return n.indexOf(e)===t}function H(e,t){return t.Spill?e===s.SpillDirection.Start?t.Spill.SpanToStart:t.Spill.SpanToEnd:0}function B(e){(0,c.verifyArgumentNotNull)(e,"model","initCellLookup"),(0,c.verifyArgumentNotNull)(e.Cells,"model.Cells","initCellLookup");for(var t={},n=0;n<e.Cells.length;n++){var r=e.Cells[n];if(r)if(t[y(r.Row,r.Col)]=r,r.Merge)for(var o=0;o<=r.Merge.Rows;o++)for(var i=0;i<=r.Merge.Columns;i++)t[y(r.Row+o,r.Col+i)]=r;else t[y(r.Row,r.Col)]=r}return t}function M(e,t){return(0,c.verifyArgumentNotNull)(t,"cell","getCellBorderStyle"),(0,c.verifyArgumentNotNull)(e.BorderStyles,"BorderStyles","getCellBorderStyle"),t.CachedBorderStyle?t.CachedBorderStyle:(0,u.getBorderStyleByID)(t,e)}function O(e){return e&&!!e.Text&&""!==e.Text}function k(e,t,n,r,o){for(var i=t+n;i>=0&&i<e.length;){var l=e[i];if(l.Row!==r)return;if(O(l))return L(l,o,-n)?l:void 0;i+=n}}function L(e,t,n){var r=Math.abs(t-e.Col);return!!(e.Spill&&H(n,e)>=r)}function N(e,t,n){for(var r=void 0,o=void 0,i=0;i<e.length;i++){var l=e[i];if(!(l.Row<t)){if(l.Row>t)break;if(l.Col<n&&(r=l),l.Col>n){o=l;break}}}return{cellBefore:r,cellAfter:o}}function E(e,t){var n=v(e),r=v(t);return z(n.row,n.column,r.row,r.column)}function z(e,t,n,r){return e===n&&t===r?0:e>n||e===n&&t>r?1:-1}function W(e,t){for(var n=[],r=e.ClientOnlyCache,o=0;o<t.length;o++){var i=t[o],l=r.CellLookup[i],a=v(i),s=a.row,d=a.column;l&&l.Row===s&&l.Col===d&&n.push(l)}return n}function G(e,t){for(var n=[],r=v(t),o=r.row,i=r.column,l=Math.max(0,i-1),a=Math.min(e.ColumnNumbers.length-1,i+1),s=Math.max(0,o-1),d=Math.min(e.RowNumbers.length,o+1),u=s;u<=d;u++)for(var c=l;c<=a;c++){var g=D(u,c,e);g&&V(e,g)&&n.push(y(g.Row,g.Col))}return n}function V(e,t){var n=A(e,t),r=M(e,t);return!!n.BackgroundColor||!!n.Gradient||r.Borders.length>0||!!t.HasError||(0,c.isRenderFlagEnabled)(i.RenderFlagsArray.RenderPatternStyle,e)&&!!n.PatternStyle}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];e[r]&&(e[r]=[])}}function _(e,t,n,r){try{T(e,n,r);var o=w(e,n,r);t.push(y(o.Row,o.Col)),o.Row===n&&o.Col===r||t.push(y(n,r))}catch(e){return}}function U(e){g.ULS.sendTraceTag(508363660,g.LogCategory.msoulscat_ES_EWAJSGrid,g.TraceLevel.Info,e)}function q(e){return(0,c.isRenderFlagEnabled)(i.RenderFlagsArray.FluentStyle,e)&&(0,p.getBooleanFeatureGate)("Microsoft.Office.Excel.HeaderInsert",!1)}t.getCellLookupKey=y,t.getRowColFromCellKey=v,t.getReferencedObjectToCache=function(e,t){if((0,d.isChangeGateEnabled)(d.ChangeGate.TreatZeroAndUndefinedAsEqual)){if((0,c.verifyArgumentNotNull)(e,"Id","helpers.getReferencedObjectToCache"),!(0,l.isNullOrUndefined)(t))return(0,o.getReferencedObjectById)(e,t)}else if(!(0,l.isNullOrUndefined)(t)&&!(0,l.isNullOrUndefined)(e))return(0,o.getReferencedObjectById)(e,t)},t.shouldOverrideText=function(e){if(e.RichValueType)return!1;var t=e.ValueType;return t===i.CellValueType.Number||t===i.CellValueType.Boolean||t===i.CellValueType.Error},t.isAccAndCustomNumFmtApplicable=function(e){return!!function(e){return e.ValueType===i.CellValueType.Number}(e)&&(!(0,l.isNullOrUndefined)(e.NumFmt)&&""!==e.Text)},t.getDefaultCell=S,t.getAllSpanningCellsKeys=function(e,t,n){var r=[];if(0===(r=r.concat(function(e,t,n){if(!t.Merge&&!t.Spill)return[];var r=[];if(t.Merge)for(var o=0;o<=t.Merge.Rows;o++)for(var i=0;i<=t.Merge.Columns;i++)r.push(y(t.Row+o,t.Col+i));if(t.Spill){for(var l=0;l<t.Spill.SpanToEnd;l++)r.push(y(t.Row,t.Col+l+1));for(l=0;l<t.Spill.SpanToStart;l++)r.push(y(t.Row,t.Col-l-1));if(t.Spill.SpanToEnd){var a=t.Col+t.Spill.SpanToEnd,d=k(e,n,s.SpillDirection.End,t.Row,a);d&&r.push(y(d.Row,d.Col))}if(t.Spill.SpanToStart){a=t.Col-t.Spill.SpanToStart;var u=k(e,n,s.SpillDirection.Start,t.Row,a);u&&r.push(y(u.Row,u.Col))}}return r}(e,t,n))).length){var o=k(e,n,s.SpillDirection.Start,t.Row,t.Col);o&&r.push(y(o.Row,o.Col));var i=k(e,n,s.SpillDirection.End,t.Row,t.Col);i&&r.push(y(i.Row,i.Col))}return r},t.getAllSpillingOverCells=R,t.getAdjacentCellsKeysOld=function(e,t,n){var r=[];if(t-1>=0){var o=w(e,t-1,n);r.push(y(o.Row,o.Col))}if(n-1>=0){o=w(e,t,n-1);r.push(y(o.Row,o.Col))}if(t+1<e.RowNumbers.length){o=w(e,t+1,n);r.push(y(o.Row,o.Col))}if(n+1<e.ColumnNumbers.length){o=w(e,t,n+1);r.push(y(o.Row,o.Col))}return r},t.getAdjacentCellsKeys=function(e,t){for(var n,r,o=[],i=Math.max(0,t.Row-1),l=Math.min(e.RowNumbers.length-1,t.Row+1+((null===(n=null==t?void 0:t.Merge)||void 0===n?void 0:n.Rows)||0)),a=Math.max(0,t.Col-1),s=Math.min(e.ColumnNumbers.length-1,t.Col+1+((null===(r=t.Merge)||void 0===r?void 0:r.Columns)||0)),d=i;d<=l;d++)_(e,o,d,a),_(e,o,d,s);for(var u=a;u<=s;u++)_(e,o,i,u),_(e,o,l,u);return o=o.concat(R(e.Cells,o))},t.getModelClientCache=F,t.getOrCreateCell=w,t.validateCellShouldExistInModelUnsafe=T,t.initModelClientCache=I,t.cleanHitTestCache=function(e,t){var n=x(e,t),r=e.ClientOnlyCache;b(e)?(j(n.CellHitRegions,r.DirtyCellsKeys),j(n.CellCursorHitRegions,r.DirtyCellsKeys),j(n.CellTooltipHitRegions,r.DirtyCellsKeys),j(n.CellLongPressHitRegions,r.DirtyCellsKeys)):r.RenderingRegionsHitTestCache&&(r.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}})},t.getRenderingRegionHitTestCache=x,t.isDifferentialRenderingSupported=b,t.getCell=D,t.getCellStyle=A,t.cellsPositionComparer=function(e,t){return z(e.Row,e.Col,t.Row,t.Col)},t.uniqueValuesFilter=P,t.getSpilledOverCount=H,t.initCellLookup=B,t.cloneOutlines=function(e){if(e&&0!==e.length){for(var t=[],n=0;n<e.length;++n){for(var o=e[n],i={Outlines:[]},l=0;l<o.Outlines.length;++l){var a=o.Outlines[l],s=r.__assign({},a);i.Outlines.push(s)}t.push(i)}return t}},t.getCellBorderStyle=M,t.processGlobalStyles=function(e){if(function(e){return!(0,l.isNullOrUndefined)(e.Cells)&&((0,c.isRenderFlagEnabled)(i.RenderFlagsArray.GlobalStylesSlice1,e)&&!(0,l.isNullOrUndefined)(e.BorderStyles)||(0,c.isRenderFlagEnabled)(i.RenderFlagsArray.GlobalStylesSlice2,e)&&!(0,l.isNullOrUndefined)(e.Fonts)&&(0,c.isRenderFlagEnabled)(i.RenderFlagsArray.GlobalStylesSlice3,e)&&!(0,l.isNullOrUndefined)(e.Styles))}(e)){var t=Math.random()<a.LogSamplingPercentage,n=(0,h.trackDuration)((function(){return(0,f.preprocessModelStyles)(e)}));if(t&&n>=0){var r=e.Cells?e.Cells.length:0,o="processGlobalStyles: preprocessing time: ".concat(n,", Cells count: ").concat(r);(0,C.isGlobalBorderStylesEnabled)(e)&&!(0,l.isNullOrUndefined)(e.BorderStyles)&&(o+=", Borders Styles count: ".concat(e.BorderStyles.length)),!(0,m.isGlobalFontsAndCellStylesFlightEnabled)(e)||(0,l.isNullOrUndefined)(e.Fonts)||(0,l.isNullOrUndefined)(e.Styles)||(o+=", Fonts count: ".concat(e.Fonts.length),o+=", Cell styles count: ".concat(e.Styles.length)),window.requestIdleCallback?window.requestIdleCallback((function(){U(o)})):setTimeout((function(){U(o)}),100)}}},t.isHeaderInsertEnabled=q,t.isIncreasedHeaderSizeEnabled=function(e){return(0,c.isRenderFlagEnabled)(i.RenderFlagsArray.HeaderDragImprovements,e)||q(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateFont=t.updateGlobalFontIDInCell=t.isGlobalFontsEnabled=t.isGlobalFontsFlightEnabled=t.getGlobalFontsMap=t.getDefaultFont=t.getFontByGlobalID=t.GlobalFonts=void 0;var r=n(4),o=n(25),i=n(52),l=n(53),a=n(8),s=n(62),d=n(29),u=function(e){function t(){var t=e.call(this)||this;return t.initializeDefaultStyles(),t}return r.__extends(t,e),t.prototype.initializeDefaultStyles=function(){t.DefaultFontID=this.getOrCreateID(s.DefaultGridFont)},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getOrCreateID=function(e){var t=(0,i.generateKeyFromFont)(e),n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;var r=f(e,e.ID||0,e.RefCount||0);return this.styles.push(r),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n},t.prototype.clear=function(){a.ULS.sendTraceTag(508389603,a.LogCategory.msoulscat_ES_EWAJSGrid,a.TraceLevel.Warning,"GlobalFonts: Total unique style count is ".concat(this.count)),e.prototype.clear.call(this),this.initializeDefaultStyles()},t.prototype.getDefaultFont=function(){return this.styles[t.DefaultFontID]},t.prototype.isEnabled=function(){return this.enabled},t.prototype.testExports=function(){return{forceEnableGlobalFonts:this.forceEnableGlobalFonts}},t.prototype.forceEnableGlobalFonts=function(){t.getInstance().enabled=!0},t.instance=void 0,t}(l.GlobalStyles);function c(){return u.getInstance()}function g(){return c().isEnabled()}function f(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,FontScheme:e.FontScheme,ID:t||0,GlobalId:e.GlobalId,Italic:e.Italic,RefCount:n||0,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign}}t.GlobalFonts=u,t.getFontByGlobalID=function(e){return c().getObject(e)},t.getDefaultFont=function(){return c().getDefaultFont()},t.getGlobalFontsMap=c,t.isGlobalFontsFlightEnabled=function(e){return(0,d.isRenderFlagEnabled)(o.RenderFlagsArray.GlobalStylesSlice2,e)&&g()},t.isGlobalFontsEnabled=g,t.updateGlobalFontIDInCell=function(e){e.CachedStyle&&e.CachedStyle.FontID&&e.CachedFont&&(e.CachedStyle.GlobalFontID=c().getOrCreateID(e.CachedFont))},t.duplicateFont=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCFIconAlignedToTheLeft=t.drawIconFromPoints=t.fillAndStroke=void 0;var r=n(1),o=n(15);function i(e,t,n){t&&(e.fillStyle=t,e.fill()),e.strokeStyle=n,e.stroke()}t.fillAndStroke=i,t.drawIconFromPoints=function(e,t,n,r){e.beginPath(),e.moveTo(r[0].x,r[0].y);for(var o=1;o<r.length;o++)e.lineTo(r[o].x,r[o].y);i(e,t,n)},t.isCFIconAlignedToTheLeft=function(e,t){var n,i=null===(n=t.CondFormat)||void 0===n?void 0:n.Icon;if(i){if(i.IconOnly){var l=(0,o.getEffectiveHorizontalAlignment)(e,t);return l===r.HorizontalAlignment.Left||l===r.HorizontalAlignment.Automatic}return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFontUsedInModel=t.updateFontLoadStatus=t.setFontVisited=t.isFontVisited=t.doesFontExist=t.setFontLoadStatus=t.getFontLoadStatus=t.isFontLoadFailed=t.isFontLoaded=t.getFontsLoadStatus=t.getFontFaceLoadStatus=t.verifyFontLoadStatus=t.isValidCellFontLoaded=t.setFontLoadDivWithFontFamily=t.isFontValid=t.documentFontsCheck=t.getFontFaceSetReady=t.fontFaceSetSupported=t.FontLoadStatus=void 0;var r,o=n(1),i=n(10),l=n(13),a=n(11),s=n(0);!function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(r||(t.FontLoadStatus=r={}));var d={},u=new Set;function c(){return void 0!==document.fonts}function g(e,t){try{return!!document.fonts.check(e)||(!t||"arial"!==(0,i.canonizeFontName)(t))&&window.parent.document.fonts.check(e)}catch(e){return(0,l.setRenderingResultInfo)("Error in documentFontsCheck"),!1}}function f(e){switch(e){case"inherit":case"initial":case"unset":case"revert":return!1}return!0}function h(e,t){if("function"!=typeof document.fonts.values)return!1;for(var n=document.fonts.values(),o=n.next();!o.done;){if(o.value&&o.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())switch(t){case r.Loaded:if("loaded"===o.value.status)return!0;break;case r.Failed:if("error"===o.value.status)return!0}o=n.next()}return!1}function C(e,t){switch(e){case 0:return!1;case 1:return 0===t;case 2:return 0===t||1===t;default:return!0}}function m(e){switch(e){case r.Loaded:return 0;case r.Failed:return 1;case r.Pending:return 2;default:return 6}}function p(e){switch(e){case"loaded":return 0;case"error":return 1;case"loading":return 2;case"unloaded":return 3;default:return 6}}function y(e){return d[e]}function v(e,t){d[e]=t}function S(e){return null!==d[e]&&void 0!==d[e]}function R(e){var t=e;return(0,s.isGridRenderPerfFixEnabled)()&&(t=e.toLowerCase()),g("11pt "+t,t)}t.fontFaceSetSupported=c,t.getFontFaceSetReady=function(){return document.fonts.ready},t.documentFontsCheck=g,t.isFontValid=f,t.setFontLoadDivWithFontFamily=function(e,t){e.style.fontFamily=t},t.isValidCellFontLoaded=function(e,t){var n,r,o=null===(n=t.CachedFont)||void 0===n?void 0:n.FontName;return!!f(null===(r=t.CachedFont)||void 0===r?void 0:r.FontName)&&g((0,i.getFontCssStringFromCell)(t,e),o)},t.verifyFontLoadStatus=h,t.getFontFaceLoadStatus=function(e){if("function"==typeof document.fonts.values)for(var t=document.fonts.values(),n=t.next();!n.done;){if(n.value&&n.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())return n.value.status;n=t.next()}},t.getFontsLoadStatus=function(e){if(0===e.length)return[];var t=new Map;return e.forEach((function(e){t.set(e.toLowerCase(),{font:e,status:5,fromCache:!1})})),function(e){var t=0;for(var n in d){var r=m(y(n)),o=e.get(n);void 0!==o&&C(o.status,r)&&(void 0===o.status&&t++,o.status=r,o.fromCache=!0)}return t===e.size}(t)||function(e){if("function"!=typeof document.fonts.values)return;e.forEach((function(e){5===e.status&&(e.status=4)}));var t=document.fonts.values(),n=t.next();for(;!n.done;){if(n.value){var r=n.value.family.replace(/[\""]/g,"").toLowerCase(),o=e.get(r),i=p(n.value.status);void 0!==o&&C(o.status,i)&&(o.status=i)}n=t.next()}}(t),Array.from(t.values())},t.isFontLoaded=function(e){return h(e,r.Loaded)},t.isFontLoadFailed=function(e){return h(e,r.Failed)},t.getFontLoadStatus=y,t.setFontLoadStatus=v,t.doesFontExist=S,t.isFontVisited=function(e){return u.has(e)},t.setFontVisited=function(e){u.add(e)},t.updateFontLoadStatus=function(e,t){var n=e;(0,s.isGridRenderPerfFixEnabled)()&&(n=e.toLowerCase());var i=(0,s.isModernFontPickerEnabled)(t)&&(0,o.isChangeGateEnabled)(o.ChangeGate.FontLoadInSafari)?a.isFontSupported:R;c()&&!S(n)&&f(n)&&i(e)&&v(n,r.Loaded)},t.isFontUsedInModel=function(e,t){return!!(e.Fonts&&e.Fonts[t]&&e.Fonts[t].RefCount)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RightArrowPosition=t.LeftArrowPosition=t.ArrowTipWidthPx=t.ArrowLengthPx=t.FilterPoints=t.MiniChevronPoints=t.ChevronPoints=t.FilterDrawingThresholdPx=t.AutoFilterRectRadius=t.AutoFilterIconRectPx=t.FilterStrokeColor=t.NoneFilterTypeStrokeColor=t.AutoFilterStrokeColor=t.AutoFilterBackgroundColor=t.AutoFilterBorderColor=t.AutoFilterLineWidthPx=t.AutoFilterDefaultSizePx=t.AutoFilterTextHorizontalPaddingPx=t.AutoFilterHorizontalPaddingPx=t.AutoFilterPaddingBottomPx=t.AutoFilterColor=void 0,t.AutoFilterColor="#3A3A38",t.AutoFilterPaddingBottomPx=1,t.AutoFilterHorizontalPaddingPx=1,t.AutoFilterTextHorizontalPaddingPx=2,t.AutoFilterDefaultSizePx=17,t.AutoFilterLineWidthPx=1,t.AutoFilterBorderColor="gray",t.AutoFilterBackgroundColor="white",t.AutoFilterStrokeColor="black",t.NoneFilterTypeStrokeColor="#858585",t.FilterStrokeColor="#10893c",t.AutoFilterIconRectPx=16,t.AutoFilterRectRadius=2,t.FilterDrawingThresholdPx=3;t.ChevronPoints=[{x:5,y:6},{x:8,y:9},{x:11,y:6}];t.MiniChevronPoints=[{x:3,y:9},{x:5,y:11},{x:7,y:9}];var r={x:8,y:3};t.FilterPoints=[r,{x:8,y:5},{x:10,y:6},{x:10,y:10},{x:12,y:10},{x:12,y:6},{x:14,y:5},{x:14,y:3},r],t.ArrowLengthPx=8,t.ArrowTipWidthPx=3,t.LeftArrowPosition={x:4,y:3},t.RightArrowPosition={x:11,y:3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdvancedVerticalAlignmentOffsetYForWrapText=t.getAdvancedVerticalAlignmentLineGapHeightForWraptext=t.getEffectiveVerticalAlignment=t.isVerticalAlignmentJustifyOrDistributed=t.AdvVerticalAlignmentFormat=void 0;var r,o=n(1);!function(e){e[e.WrapText=0]="WrapText",e[e.CFIcon=1]="CFIcon"}(r||(t.AdvVerticalAlignmentFormat=r={})),t.isVerticalAlignmentJustifyOrDistributed=function(e){switch(e){case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return!0}return!1},t.getEffectiveVerticalAlignment=function(e,t,n,i,l,a,s){if(s)return o.VerticalAlignment.Bottom;switch(e){case o.VerticalAlignment.Top:case o.VerticalAlignment.Bottom:case o.VerticalAlignment.Center:return e;case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return function(e,t,n,i,l,a){switch(t){case r.WrapText:return function(e,t,n,r,i){if(1===i||t<r)switch(e){case o.VerticalAlignment.Justify:return o.VerticalAlignment.Top;case o.VerticalAlignment.Distributed:return o.VerticalAlignment.Center}if(t<n&&t>=r)switch(e){case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return o.VerticalAlignment.Top}return e}(e,n,i,l,a);case r.CFIcon:return function(e){switch(e){case o.VerticalAlignment.Justify:return o.VerticalAlignment.Top;case o.VerticalAlignment.Distributed:default:return o.VerticalAlignment.Center}}(e)}}(e,t,n,i,l,a)}},t.getAdvancedVerticalAlignmentLineGapHeightForWraptext=function(e,t,n){return(e-t)/(n-1)},t.getAdvancedVerticalAlignmentOffsetYForWrapText=function(e,t,n){return e-t*n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClippedDrawingContext=t.createShapePath=t.shouldClipHorizontally=t.shouldClipVertically=t.getClipRect=void 0;var r=n(1),o=n(6),i=n(3);function l(e,t,n,r){return n>=(0,o.getCellBottomAdjustedForDrawing)(e,t)-i.GridLineWidthPx||n-r<=(0,o.getCellTopAdjustedForDrawing)(e,t,!1)}function a(e,t,n,r,l){var a,s=e.IsRtl,d=t.Spill&&(l||(null===(a=t.PivotTable)||void 0===a?void 0:a.HasExpandCollapseIndicator));return n<=(d?(0,o.getSpillCellLeftAdjustedForDrawing)(e,t):(0,o.getCellLeftAdjustedForDrawing)(e,t,s,!1))||n+r>=(d?(0,o.getSpillCellRightAdjustedForDrawing)(e,t):(0,o.getCellRightAdjustedForDrawing)(e,t,!1)-i.GridLineWidthPx)}function s(e,t,n){return e>n?n:e<t?t:e}t.getClipRect=function(e,t,n,r,s,d){var u=function(e,t,n,r,o,i){return a(e,t,n,o,i)||l(e,t,r,o)}(e,t,n,r,s,d),c=t.Spill&&d;if(u)return{x:c?(0,o.getSpillCellLeftAdjustedForDrawing)(e,t):(0,o.getCellLeftAdjustedForDrawing)(e,t,!1,!1),y:(0,o.getCellTopAdjustedForDrawing)(e,t,!1),width:c?(0,o.getSpillCellWidthAdjustedForDrawing)(t,e)-i.GridLineWidthPx:(0,o.getCellWidthAdjustedForDrawing)(e,t)-i.GridLineWidthPx,height:(0,o.getCellHeightAdjustedForDrawing)(e,t)-i.GridLineWidthPx}},t.shouldClipVertically=l,t.shouldClipHorizontally=a,t.createShapePath=function(e,t){if(t&&!(t.length<2)){var n=t[0];e.moveTo(n.x,n.y);for(var r=1;r<t.length;r++){var o=t[r];e.lineTo(o.x,o.y)}}},t.getClippedDrawingContext=function(e,t,n,l){var a=l.x,d=l.y,u=l.width,c=l.height,g=i.GridLineWidthPx*n.scaleFactor,f=(0,o.getCellLeftAdjustedForDrawing)(e,t,!1,!1),h=(0,o.getCellRightAdjustedForDrawing)(e,t,!1),C=(0,o.getCellTopAdjustedForDrawing)(e,t,!1),m=(0,o.getCellBottomAdjustedForDrawing)(e,t)-g,p=s(a,f,h),y=s(d,C,m),v=a+u,S=d+c;return{x:p,y:y,width:(v=s(v,f,h))-((0,r.isChangeGateEnabled)(r.ChangeGate.UseClippedXCheckbox)?p:a),height:(S=s(S,C,m))-y}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return l}));var r=n(49),o=function(){function e(){this.externalLogger=new r.a}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}(),i=new o;function l(e){if(!e)throw new Error("The 'logger' argument is missing");i.setLogger(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateBorderStyle=t.disableGlobalBorderStyles=t.isGlobalBorderStylesEnabledNew=t.isGlobalBorderStylesEnabled=t.getGlobalBorderStyleMap=t.getDefaultBorderStyle=t.getBorderStyleByGlobalID=t.GlobalBorderStyles=void 0;var r=n(4),o=n(25),i=n(52),l=n(53),a=n(8),s=n(29),d=n(62),u=function(e){function t(){var t=e.call(this)||this;return t.initializeDefaultStyles(),t}return r.__extends(t,e),t.prototype.initializeDefaultStyles=function(){t.DefaultBorderStyleID=this.getOrCreateID({Borders:[],ID:d.DefaultGlobalBorderID})},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getOrCreateID=function(e){var t=(0,i.generateKeyFromBorderStyle)(e),n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;var r=g(e,e.ID||0,e.RefCount||0);return this.styles.push(r),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n},t.prototype.clear=function(){a.ULS.sendTraceTag(508941207,a.LogCategory.msoulscat_ES_EWAJSGrid,a.TraceLevel.Warning,"GlobalBorderStyles: Total unique style count is ".concat(this.count)),e.prototype.clear.call(this),this.initializeDefaultStyles()},t.prototype.getDefaultBorderStyle=function(){return this.styles[t.DefaultBorderStyleID]},t.prototype.isEnabled=function(){return this.enabled},t.prototype.testExports=function(){return{forceEnableGlobalBorderStyles:this.forceEnableGlobalBorderStyles}},t.prototype.forceEnableGlobalBorderStyles=function(){t.getInstance().enabled=!0},t.instance=void 0,t}(l.GlobalStyles);function c(){return u.getInstance()}function g(e,t,n){for(var r=[],o=0;o<e.Borders.length;o++){var i=e.Borders[o],l={BorderLineStyle:i.BorderLineStyle,BorderPosition:i.BorderPosition,Weight:i.Weight,Color:{Red:i.Color.Red,Blue:i.Color.Blue,Green:i.Color.Green}};r.push(l)}return{Borders:r,GlobalId:e.GlobalId,ID:t||0,RefCount:n||0}}t.GlobalBorderStyles=u,t.getBorderStyleByGlobalID=function(e){return c().getObject(e)},t.getDefaultBorderStyle=function(){return c().getDefaultBorderStyle()},t.getGlobalBorderStyleMap=c,t.isGlobalBorderStylesEnabled=function(e){return(0,s.isRenderFlagEnabled)(o.RenderFlagsArray.GlobalStylesSlice1,e)&&c().isEnabled()},t.isGlobalBorderStylesEnabledNew=function(){return c().isEnabled()},t.disableGlobalBorderStyles=function(e){return c().disable(e)},t.duplicateBorderStyle=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyFromBorderStyle=t.generateKeyFromFont=t.generateKeyFromCellStyle=t.generateKeyFromModelStyles=t.setPatternStyleEnabledForGlobalStyle=void 0;var r=n(53),o=!1;function i(e){var t=[c(e.VerticalText),"|",c(e.ShrinkToFit),"|",g(e.HorizontalAlignment),"|",g(e.VerticalAlignment),"|",g(e.ReadingOrder),"|",g(e.Orientation||0),"|",g(e.Indentation||0),"|",g(e.BackgroundColor),"|",d(e.Gradient),"|",c(e.IsUnlocked),"|",c(e.IsHidden),"|",g(e.NamedStyleId||0),"|"];return o&&t.push.apply(t,[g(e.PatternStyle),"|",g(e.PatternColor),"|"]),t.join("")}function l(e){return[c(e.Bold),"|",c(e.Italic),"|",c(e.StrikeThrough),"|",g(e.FontName),"|",g(e.Size),"|",g(e.Color),"|",g(e.Underline),"|",g(e.VerticalAlign),"|",g(e.FontScheme),"|"].join("")}function a(e){for(var t,n=[c(e.HasDiagBorder),"|"],r=0;r<(null===(t=e.Borders)||void 0===t?void 0:t.length);r++){var o=e.Borders[r];o&&n.push(s(o),"|")}return n.join("")}function s(e){var t,n;return[g(e.BorderLineStyle),"|",g(e.BorderPosition),"|",g(e.Weight),"|",(t=e.Color,n=[g(t.Red),"|",g(t.Green),"|",g(t.Blue)],n.join(""))].join("")}function d(e){var t;if(!e)return"0";for(var n=[g(e.ShadingStyle)],r=0;r<(null===(t=e.Stops)||void 0===t?void 0:t.length);r++){var o=e.Stops[r];o&&n.push("|",u(o))}return n.join("")}function u(e){return[g(e.Color),"|",g(e.Position)].join("")}function c(e){return e?"1":"0"}function g(e){return e?e.toString():"0"}t.setPatternStyleEnabledForGlobalStyle=function(e){o=e},t.generateKeyFromModelStyles=function(e,t){if(!t)return"0";switch(e){case r.StyleType.CellStyle:return i(t);case r.StyleType.BorderStyle:return a(t);case r.StyleType.Font:return l(t);default:return""}},t.generateKeyFromCellStyle=i,t.generateKeyFromFont=l,t.generateKeyFromBorderStyle=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalStyles=t.StyleType=void 0;var r,o=n(37),i=n(26),l=n(62),a=n(8);!function(e){e[e.CellStyle=0]="CellStyle",e[e.BorderStyle=1]="BorderStyle",e[e.Font=2]="Font"}(r||(t.StyleType=r={}));var s=function(){function e(){this.count=0,this.styles=[],this.keyToGlobalIDMap=new Map,this.enabled=!0}return e.prototype.process=function(e){if(0!==e.length)for(var t=0;t<e.length;t++)if(e[t]){var n=e[t];if(!(0,i.isNullOrUndefined)(n.GlobalId))continue;n.ID||(n.ID=l.DefaultGlobalStyleID);var r=this.getOrCreateID(n);if(void 0===r)throw new Error("GlobalStyle::Interface::Process: global style ID is undefined");n.GlobalId=r}},e.prototype.getObject=function(e){if(e<0||e>=this.count)throw new Error("GlobalStyle::Interface::GetStyle: global style ID ".concat(e," is not valid"));return this.styles[e]},e.prototype.clear=function(){this.count=0,this.styles.splice(0,this.styles.length),this.keyToGlobalIDMap.clear(),this.initializeDefaultStyles()},e.prototype.disable=function(e){this.enabled=!1;var t=(0,o.isChangeGateEnabled)(o.ChangeGate.GlobalStyleTrace)&&new Error(e).stack||"",n="GlobalStyle::Interface::Disable: ".concat(e," ").concat(t);a.ULS.sendTraceTag(508900295,a.LogCategory.msoulscat_ES_EWAJSGrid,a.TraceLevel.Warning,n)},e}();t.GlobalStyles=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGlobalFontsAndCellStylesEnabled=t.isGlobalFontsAndCellStylesFlightEnabled=t.disableGlobalFonts=void 0;var r=n(29),o=n(25),i=n(55),l=n(43);function a(){return(0,i.isGlobalCellStylesEnabled)()&&(0,l.isGlobalFontsEnabled)()}t.disableGlobalFonts=function(e){(0,l.getGlobalFontsMap)().disable(e),(0,i.getGlobalCellStylesMap)().disable("GlobalFonts: Due to disabling of Global Fonts")},t.isGlobalFontsAndCellStylesFlightEnabled=function(e){return(0,r.isRenderFlagEnabled)(o.RenderFlagsArray.GlobalStylesSlice2,e)&&(0,r.isRenderFlagEnabled)(o.RenderFlagsArray.GlobalStylesSlice3,e)&&a()},t.isGlobalFontsAndCellStylesEnabled=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateCellStyleKey=t.disableGlobalCellStyles=t.getCellStyleByGlobalID=t.isGlobalCellStylesEnabled=t.getGlobalCellStylesMap=t.GlobalCellStyles=void 0;var r=n(4),o=n(53),i=n(62),l=n(152),a=n(52),s=n(43),d=function(e){function t(){var t=e.call(this)||this;return t.initializeDefaultStyles(),t}return r.__extends(t,e),t.prototype.initializeDefaultStyles=function(){t.DefaultCellStyleID=this.getOrCreateID(i.DefaultCellStyle)},t.getInstance=function(){if(!t.instance)try{return t.instance=new t,t.instance}catch(e){throw new Error("exception while creating GlobalCellStyles: ".concat(e))}return t.instance},t.prototype.getOrCreateID=function(e){var t=g(e);if(void 0!==t){var n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;var r=(0,l.duplicateOnlyStyleWithoutFont)(e,e.ID||0,e.RefCount||0);return this.styles.push(r),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}},t.prototype.getDefaultCellStyle=function(){return this.styles[t.DefaultCellStyleID]},t.prototype.isEnabled=function(){return this.enabled},t.prototype.testExports=function(){return{forceEnableGlobalCellStyles:this.forceEnableGlobalCellStyles}},t.prototype.forceEnableGlobalCellStyles=function(){t.getInstance().enabled=!0},t.instance=void 0,t}(o.GlobalStyles);function u(){return d.getInstance()}function c(e){u().disable(e),(0,s.getGlobalFontsMap)().disable("GlobalCellStyles: Due to disabling of Global Cell Styles")}function g(e){if(null!==e.GlobalFontID&&void 0!==e.GlobalFontID)try{var t=(0,s.getFontByGlobalID)(e.GlobalFontID);return(0,a.generateKeyFromCellStyle)(e)+(0,a.generateKeyFromFont)(t)+"|"}catch(e){c("".concat(e))}else c("GenerateCellStyleKey:: Global font ID is not present")}t.GlobalCellStyles=d,t.getGlobalCellStylesMap=u,t.isGlobalCellStylesEnabled=function(){return u().isEnabled()},t.getCellStyleByGlobalID=function(e){return u().getObject(e)},t.disableGlobalCellStyles=c,t.generateCellStyleKey=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdjustedHeaderDrawingOffset=t.getAdjustedDrawingOffset=t.getMaxLineOffset=t.shouldDrawGridLinesAndValidation=t.drawHeadersGridLines=t.drawGridLinesInternal=t.drawGridLines=void 0;var r=n(1),o=n(3),i=n(2),l=n(0),a=n(7),s=n(0),d=n(39),u=n(8),c=n(17),g=n(27);function f(e,t,n,r,i){if(h(t,n)){F(e,t),i||(e.strokeStyle=S(t,n,r,!1,i));var a=(0,l.getLinePixelTranslation)(o.GridLineWidthPx),s=C(t.BlockWidth,n.scaleFactor,!1),d=C(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),i&&(e.strokeStyle=S(t,n,r,r&&!t.IsRow,i)),y(e,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*n.scaleFactor,a,d,n.renderingRegion),i&&(e.stroke(),e.beginPath(),e.strokeStyle=S(t,n,r,r&&t.IsRow,i)),v(e,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*n.scaleFactor,a,s,n.renderingRegion),e.stroke()}}function h(e,t){if(!(e.RowOffsets&&e.ColumnOffsets&&e.RowHeights&&e.ColumnWidths))throw"drawGridLines:: one or more elements is null: RowOffset: ".concat(!e.RowOffsets,", ColumnOffsets: ").concat(!e.ColumnOffsets,", RowHeights: ").concat(!e.RowHeights,", ColumnWidths: ").concat(!e.ColumnWidths);if(e.RowOffsets.length!==e.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(e.ColumnOffsets.length!==e.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";return!!e.ShowGridLines&&(!(t.scaleFactor<o.MinimalScaleFactorForGridlinesRendering)&&!!(0,i.shouldRenderGridLines)((0,l.isHighContrastMode)(t),(0,l.hasWorkbookBackgroundColor)(e.BackgroundColor)))}function C(e,t,n){var r=Math.round(e*t)-o.GridLineWidthPx/2;if(n&&(0,s.isSafari)()){var i=window?window.devicePixelRatio:-1;2===i&&t===i/2&&(r-=1)}return r}function m(e,t,n,r){var o=e+t-n;return Math.min(o,r)}function p(e,t,n){var r=Math.max(e-t,0);return Math.min(r,n)}function y(e,t,n,r,o,l){for(var a=l.startRow,s=l.endRow,d=a;d<=s;d++){var u=m(t[d],(0,i.getRowHeightFromOffsets)(d,t),r,o);(0,i.drawLine)(e,0,u,n,u)}}function v(e,t,n,r,o,l){for(var a=l.startColumn,s=l.endColumn,d=a;d<=s;d++){var u=m(t[d],(0,i.getColWidthFromOffsets)(d,t),r,o);(0,i.drawLine)(e,u,0,u,n)}}function S(e,t,n,i,l){return(0,a.isNullOrUndefined)(t.highContrastScheme)?(0,a.isNullOrUndefined)(e.GridLineColor)?l?n&&t.viewMode===r.ViewMode.NamedSheetView?i?o.NSVDefaultBorderGridLineColor:o.NSVDefaultGridLineColor:i?o.DefaultBorderGridLineColor:o.DefaultGridLineColor:o.DefaultGridLineColorBeforeFluent:e.GridLineColor:"".concat((0,s.rgbToColorHex)(t.highContrastScheme.TextColor))}function R(e){return e.viewMode===r.ViewMode.NamedSheetView?o.NSVSelectedCellsGridLineColor:o.SelectedCellsGridLineColor}function F(e,t){e.lineWidth=o.GridLineWidthPx,e.setLineDash(function(e){if(!(0,a.isNullOrUndefined)(e.GridLineColor))return o.ColoredGridLineDash;return o.DefaultDash}(t))}t.drawGridLines=function(e,t,n){h(t,n)&&f(e,t,n,!1,!1)},t.drawGridLinesInternal=f,t.drawHeadersGridLines=function(e,t,n,a,s){if(h(t,n)&&(a?function(e,t,n){if(!h(t,n))return;F(e,t);var r=(0,l.getLinePixelTranslation)(o.GridLineWidthPx),i=n.scaleFactor,a=C(t.BlockWidth,i,!1),s=C(t.BlockHeight,i,!0),d=!!t.IsRow,u=t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,c=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,g=t.BlockWidth*i,f=t.BlockHeight*i,m=n.renderingRegion,p=S(t,n,!0,!0,!0),R=S(t,n,!0,!1,!0);e.beginPath(),e.strokeStyle=R,d?y(e,u,g,r,s,m):v(e,c,f,r,a,m);e.stroke(),e.beginPath(),e.strokeStyle=p,d?v(e,c,f,r,a,m):y(e,u,g,r,s,m);e.stroke()}(e,t,n):f(e,t,n,!0,a),!(0,l.isHighContrastMode)(n))){var m=t.IsRow,w=function(e,t,n,r){for(var o=[],i=n?t.startRow:t.startColumn,l=n?t.endRow:t.endColumn,a=l+1,s=!1,c=function(t){var n=e[t];if(!n){var a=e.map((function(e,t,n){return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t}),{})}(e,"Row","Col")}));u.ULS.sendTraceTag(509677844,u.LogCategory.msoulscat_ES_EWAJSGrid,u.TraceLevel.Error,"getHeaderSelectedGridLines: firstGridLine:".concat(i,", lastRowColInRenderingRegion:").concat(l,", gridLineIndex:").concat(t,", cells.length:").concat(e.length,", cells:").concat(JSON.stringify(a),", "))}(0,d.isCellPartiallySelected)(n,r)?((r||0!==t)&&o.push(t),s=!0):s&&(o.push(t),s=!1)},g=i;g<a;++g)c(g);s&&o.push(a);return o}(t.Cells,n.renderingRegion,m,a);if(a||0!==w.length){a||(e.strokeStyle=r.SelectedCellsGridlinesColor,e.beginPath());var T=(0,l.getLinePixelTranslation)(o.GridLineWidthPx),I=n.scaleFactor;if(a){var x=C(t.BlockHeight,I,!0),b=C(t.BlockWidth,I,!1),D=(0,c.getBooleanFeatureGate)("Microsoft.Office.Excel.FluentHeadersAndSelectionWithBoldGridLine",void 0);m?(function(e,t,n,r,o,l,a){var s=a.length,d=n[n.length-1];e.beginPath(),e.strokeStyle=R(t);for(var u=0;u<s;++u){var c=a[u];if(0!==c){var g=p(r[c],o,l);(0,i.drawLine)(e,0,g,d,g)}}e.stroke()}(e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,T,x,w),D&&function(e,t,n,i,l,a){var s=i.scaleFactor,d=o.SelectionBorderWidth*s,u=o.HeaderCornerRadius*s,c=a,f=Math.max(d,u),h=[r.WholeRowColSelectionBackgroundColor,r.WholeRowColSelectionBackgroundColor],C=h[0],m=h[1];if((0,r.isChangeGateEnabled)(r.ChangeGate.OptimizeHeaderBoldGridlinesRendering)){if(0===t.length)return;for(var p=!1,y=0;y<t.length;y++){var v=t[y];if(r.WholeSelectionHeadersStylesSet.has(v.StyleID||0)){if(y>0&&!p&&e[y-1]===e[y]-1){var S=Math.max(u-d,0),R=l[y]+1+S,F={outerColor:m,innerColor:C,left:0,bottom:R,width:c,height:f,radius:[u,0,0,0]};(0,g.drawRoundRectangle)(n,F)}if(y<t.length-1){var w=t[y+1];if(!r.WholeSelectionHeadersStylesSet.has(w.StyleID||0)&&e[y+1]===e[y]+1){R=l[y+1]+d-1,F={outerColor:m,innerColor:C,left:0,bottom:R,width:c,height:f,radius:[0,0,0,u]};(0,g.drawRoundRectangle)(n,F)}p=!0}}else p=!1}}else for(var T=t.filter((function(e){return r.WholeSelectionHeadersStylesSet.has(e.StyleID||0)})).map((function(e){return e.Row})),I=0,x=T;I<x.length;I++){if((y=x[I])>0&&!T.includes(y-1)&&e[y-1]===e[y]-1){S=Math.max(u-d,0),R=l[y]+1+S,F={outerColor:m,innerColor:C,left:0,bottom:R,width:c,height:f,radius:[u,0,0,0]};(0,g.drawRoundRectangle)(n,F)}if(y<t.length-1&&!T.includes(y+1)&&e[y+1]===e[y]+1){R=l[y+1]+d-1,F={outerColor:m,innerColor:C,left:0,bottom:R,width:c,height:f,radius:[0,0,0,u]};(0,g.drawRoundRectangle)(n,F)}}n.stroke()}(t.RowNumbers,t.Cells,e,n,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*I)):(function(e,t,n,r,o,l,a){var s=a.length,d=r[r.length-1];e.beginPath(),e.strokeStyle=R(t);for(var u=0;u<s;++u){var c=a[u];if(0!==c){var g=p(n[c],o,l);(0,i.drawLine)(e,g,0,g,d)}}e.stroke()}(e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,T,b,w),D&&function(e,t,n,i,l,a,s){var u=i.scaleFactor,c=o.SelectionBorderWidth*u,f=o.HeaderCornerRadius*u,h=Math.max(c,f),C=a-(0,d.getColumnHeaderGutterSizeForDrawing)(u,s),m=a,p=[r.WholeRowColSelectionBackgroundColor,r.WholeRowColSelectionBackgroundColor],y=p[0],v=p[1];if((0,r.isChangeGateEnabled)(r.ChangeGate.OptimizeHeaderBoldGridlinesRendering)){if(0===t.length)return;for(var S=!1,R=0;R<t.length;R++){var F=t[R];if(r.WholeSelectionHeadersStylesSet.has(F.StyleID||0)){if(R>0&&!S&&e[R-1]===e[R]-1){var w=l[R]-c,T={outerColor:v,innerColor:y,left:w,bottom:m,width:h,height:C,radius:[f,0,0,0]};(0,g.drawRoundRectangle)(n,T)}if(R<t.length-1){var I=t[R+1];if(!r.WholeSelectionHeadersStylesSet.has(I.StyleID||0)&&e[R+1]===e[R]+1){var x=Math.max(f-c,0);w=l[R+1]-o.SelectionBorderWidth-x,T={outerColor:v,innerColor:y,left:w,bottom:m,width:h,height:C,radius:[0,f,0,0]};(0,g.drawRoundRectangle)(n,T)}S=!0}}else S=!1}}else for(var b=t.filter((function(e){return r.WholeSelectionHeadersStylesSet.has(e.StyleID||0)})).map((function(e){return e.Col})),D=0,A=b;D<A.length;D++){if((R=A[D])>0&&!b.includes(R-1)&&e[R-1]===e[R]-1){w=l[R]-c,T={outerColor:v,innerColor:y,left:w,bottom:m,width:h,height:C,radius:[f,0,0,0]};(0,g.drawRoundRectangle)(n,T)}if(R<t.length-1&&!b.includes(R+1)&&e[R+1]===e[R]+1){x=Math.max(f-c,0),w=l[R+1]-o.SelectionBorderWidth-x,T={outerColor:v,innerColor:y,left:w,bottom:m,width:h,height:C,radius:[0,f,0,0]};(0,g.drawRoundRectangle)(n,T)}}n.stroke()}(t.ColumnNumbers,t.Cells,e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*I,s))}else{if(m){x=C(t.BlockHeight,I,!0);!function(e,t,n,r,o,l){for(var a=l.length,s=0;s<a;++s){var d=l[s],u=p(t[d],r,o);(0,i.drawLine)(e,0,u,n,u)}}(e,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*I,T,x,w)}else{b=C(t.BlockWidth,I,!1);!function(e,t,n,r,o,l){for(var a=l.length,s=0;s<a;++s){var d=l[s],u=p(t[d],r,o);(0,i.drawLine)(e,u,0,u,n)}}(e,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*I,T,b,w)}e.stroke()}}}},t.shouldDrawGridLinesAndValidation=h,t.getMaxLineOffset=C,t.getAdjustedDrawingOffset=m,t.getAdjustedHeaderDrawingOffset=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoIndent=t.ExpandCollapseButtonVerticalPaddingPx=t.PaddingBetweenExpandCollapseButtonAndTextPx=t.ExpandCollapseButtonOuterColor=t.ExpandCollapseButtonInnerColor=t.ExpandCollapseButtonSizePx=t.EmptyPivotTableImageWidthHeightRatio=t.EmptyPivotTableMinimalImageWidthPx=t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableImageMinimalPaddingYPx=t.EmptyPivotTableTitleContainerWidthRatio=t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerHeightPx=t.EmptyPivotTableTitleContainerTopPaddingPx=t.EmptyPivotTableImagePlaceholderThicknessPx=t.EmptyPivotTableTitleContainerBorderThicknessPx=t.EmptyPivotTableTitleTextColor=t.EmptyPivotTableTitleContainerBorderColor=void 0,t.EmptyPivotTableTitleContainerBorderColor="#969696",t.EmptyPivotTableTitleTextColor="#969696",t.EmptyPivotTableTitleContainerBorderThicknessPx=2,t.EmptyPivotTableImagePlaceholderThicknessPx=1,t.EmptyPivotTableTitleContainerTopPaddingPx=32,t.EmptyPivotTableTitleContainerHeightPx=19,t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerTopPaddingPx+t.EmptyPivotTableTitleContainerHeightPx,t.EmptyPivotTableTitleContainerWidthRatio=.75,t.EmptyPivotTableImageMinimalPaddingYPx=24,t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableMinimalHeightForDrawingTitle+t.EmptyPivotTableTitleContainerHeightPx+t.EmptyPivotTableImageMinimalPaddingYPx,t.EmptyPivotTableMinimalImageWidthPx=80,t.EmptyPivotTableImageWidthHeightRatio=184/164,t.ExpandCollapseButtonSizePx=9,t.ExpandCollapseButtonInnerColor="#FAFAFA",t.ExpandCollapseButtonOuterColor="#3A3A38",t.PaddingBetweenExpandCollapseButtonAndTextPx=3,t.ExpandCollapseButtonVerticalPaddingPx=4,t.NoIndent=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellFontColor=t.updateContextForCurrentCell=t.getDefaultContextState=void 0;var r=n(1),o=n(0),i=n(10),l=n(38),a=n(15),s=n(3),d=n(2);function u(e,t,n){var o;return t?(0,d.getHighContrastTextColor)(e,t,n):(0,r.isChangeGateEnabled)(r.ChangeGate.PreviewCellsSettings)&&e.PreviewText&&(null===(o=n.ClientOnlyCache.PreviewCellsSettings)||void 0===o?void 0:o.RetainCellTextOnPreview)&&!e.RetainTextOnPreview?s.DefaultPreviewSuggestionContentFontColor:e.HasError?s.FormulaErrorFontColor:e.CachedFont.Color}function c(e){return e?"rtl":"ltr"}t.getDefaultContextState=function(e,t){return{fontColor:e?(0,o.rgbToColorHex)(e.TextColor):s.DefaultCellFontColor,fontProperties:"",direction:c(t),textBaseline:"bottom",textAlign:"start"}},t.updateContextForCurrentCell=function(e,t,n,o,s){var d=(0,a.getTextAlignment)(o,n);t.textAlign!==d&&(t.textAlign=d,e.textAlign=d);var g=l.DefaultTextBaseline;g!==t.textBaseline&&(e.textBaseline=g,t.textBaseline=g);var f=(0,i.getFontCssStringFromCell)(n,o);t.fontProperties===f&&e.font===f||(t.fontProperties=f,e.font=f);var h=u(n,s,o);t.fontColor!==h&&(t.fontColor=h,e.fillStyle=h);var C=function(e,t){switch(e){case r.ReadingOrderType.RightToLeft:return"rtl";case r.ReadingOrderType.LeftToRight:return"ltr";case r.ReadingOrderType.Context:return c(t);default:throw Error("getCanvasDirection: unsupported readingOrder: ".concat(e))}}(n.CachedStyle.ReadingOrder||r.ReadingOrderType.Context,o.IsRtl);C!==t.direction&&(t.direction=C,e.direction=C)},t.getCellFontColor=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGridRendererStringsInitialized=t.initGridRendererStrings=t.gridRendererStrings=void 0;var r=n(8),o=n(7);void 0===window.gridRendererStringsCounter?window.gridRendererStringsCounter=1:window.gridRendererStringsCounter++,t.initGridRendererStrings=function(e){t.gridRendererStrings=e,(0,o.isNullOrUndefined)(t.gridRendererStrings)&&r.ULS.sendTraceTag(507847511,r.LogCategory.msoulscat_ES_EWAJSGrid,r.TraceLevel.Error,"initGridRendererStrings: gridRendererStrings is null or undefined")},t.isGridRendererStringsInitialized=function(){return!(0,o.isNullOrUndefined)(t.gridRendererStrings)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTrianglePathOnCellCorner=t.getRightAngledTriangleSize=t.drawTriangle=void 0;var r=n(0),o=n(5),i=n(92),l=n(48),a=n(23),s=n(3);t.drawTriangle=function(e,t,n){(0,o.verifyArgumentNotNull)(e,"ctx","drawTriangle"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawTriangle");var r=t.innerColor,i=t.outerColor,l=t.left,a=t.bottom,s=t.height,d=t.width,u=l+d/2,c=n?a+s:a-s;e.beginPath(),e.moveTo(l,a),e.lineTo(l+d,a),e.lineTo(u,c),e.closePath(),r&&(e.fillStyle=r,e.fill()),i&&(e.strokeStyle=i,e.stroke())},t.getRightAngledTriangleSize=function(e,t,n,r,o){return(0,a.getInteractiveIconMaxSizeAdjustedForDrawing)(n,e,t,r,o,!0,!0)},t.createTrianglePathOnCellCorner=function(e,t,n){var o=(0,r.getLinePixelTranslation)(s.GridLineWidthPx),a=t.left,d=t.bottom,u=t.height,c=t.width,g=n===i.Position.Right,f=d-u,h=g?a-o:a,C=[{x:h,y:f},{x:h+c+o,y:f},{x:h+(g?c+o:0),y:f+u+o},{x:h,y:f}];(0,l.createShapePath)(e,C)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReferencedObjectById=void 0;var r=n(25),o=n(26);t.getReferencedObjectById=function(e,t){var n;switch(e){case r.UniqueStyleID.Default:case r.UniqueStyleID.Hyperlink:n=t[t.length+e];break;default:n=t[e]}if((0,o.isNullOrUndefined)(n))throw Error("RefObject is null or undefined, id: ".concat(e));if((n.ID||0)!==e)throw Error("RefIDs are not sorted as expected");return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCellStyle=t.DefaultCellStyleID=t.DefaultGridFont=t.DefaultGlobalBorderID=t.DefaultGlobalFontID=t.DefaultGlobalStyleID=void 0,t.DefaultGlobalStyleID=0,t.DefaultGlobalFontID=0,t.DefaultGlobalBorderID=0,t.DefaultGridFont={Color:"#000000",FontName:"Calibri",FontScheme:2,Size:11,Underline:0,VerticalAlign:0},t.DefaultCellStyleID=0,t.DefaultCellStyle={VerticalAlignment:2,GlobalFontID:0,ID:-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderIncludeLists=t.SerializationClasses=t.SerializationPropertyKey=t.SerializationProperties=t.UserContentList=t.propertyToClassMap=t.propertyNameToTypeMap=t.propertyLists=t.ignoreCaseLists=t.comparisonIgnoreLists=void 0,t.comparisonIgnoreLists={},t.comparisonIgnoreLists.GridBlockModel=["ColMetadata","FixedColumns","IsBitwiseFixedRows","RowOutlines","ColumnOutlines","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","UniqueId","ShowHeaders","IsRow","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlagsArray","HandleFlagsMismatch","AllRichValueFields","ClientOnlyCache","AdjacentBlocksHiddensInfo","RichValueTypes","IsCanvasHeadersSupported","HeadersFallbackReason","HasTable","HasOutline"],t.comparisonIgnoreLists.Cell=["StyleID","GlobalCellStyleID","Ifmt","IfmtStamped","BorderStyleID","GlobalBorderStyleID","HorizontalAlignmentSet","Spill","ShrunkSize","RichValueType","RichValueFieldsIndexes","DynamicArrayInfo","ValueType","SrvDx","SrvDy","TolType","BitwiseBorderPosition","IsCellSnapped","CachedDrawingLayout","CachedDisplayText","CachedDisplayTextRuns","CachedIsTextWidthExceedsCellWidth","CachedIndent","DisplayFormula","PreviewText","PreviewNumFmt","PreviewCellStyle","RetainTextOnPreview","ShowSkeleton","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],t.comparisonIgnoreLists.HeaderCell=["ShowResizePill","InsertButtons","IsHovered"],t.comparisonIgnoreLists.InsertButtons=["Start","End"],t.comparisonIgnoreLists.InsertButton=["Type","Offset"],t.comparisonIgnoreLists.AutoFilter=["Menu","CommandData"],t.comparisonIgnoreLists.PivotFilter=["IsPivotPageField","CommandData","IsHeaderSnapped"],t.comparisonIgnoreLists.ReferencedObject=["ID","RefCount","GlobalId"],t.comparisonIgnoreLists.CellStyle=["IsPattern","NamedStyleId","FontID","GlobalFontID","IsUnlocked","IsHidden"],t.comparisonIgnoreLists.SpillInformation=["IsSpillingOutsideOfBlock"],t.comparisonIgnoreLists.FormulaInformation=["Formula","FormulaType","IsArrayRoot"],t.comparisonIgnoreLists.DynamicArrayInformation=["IsAnchor","Range"],t.comparisonIgnoreLists.MergeInformation=["IsOrigin","WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],t.comparisonIgnoreLists.BorderStyle=["HasDiagBorder"],t.comparisonIgnoreLists.Font=["FontScheme"],t.comparisonIgnoreLists.TextRun=["FontID","GlobalFontID","EndIndex","IsSpecialCharTextRun"],t.comparisonIgnoreLists.RangeInformation=["RangeType"],t.comparisonIgnoreLists.PivotTableRangeInformation=["ConnectionName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","StyleIndex","IsRefreshableTabularOlap","SlicerConnections","AutoRefresh","SupportsAutoRefresh","OriginPTWidthAdjustedForDrawing","OriginPTHeightAdjustedForDrawing","DeltaXFromOriginPTAdjustedForDrawing","DeltaYFromOriginPTAdjustedForDrawing"],t.comparisonIgnoreLists.Hyperlink=["IsHyperlinkChecked"],t.comparisonIgnoreLists.DynamicImageInformation=["AltText"],t.comparisonIgnoreLists.Sparklines=["Ranges"],t.comparisonIgnoreLists.LinkedEntityInformation=["Domain"],t.comparisonIgnoreLists.PivotTableCellInformation=["ShouldShowExpandCollapseMenu","SourceIndex","ConfirmRequired","CanShowDetails"],t.ignoreCaseLists={},t.ignoreCaseLists.Font=["Color"],t.propertyLists={},t.propertyLists.GridBlockModel=["BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers","ColMetadata","FixedColumns","IsBitwiseFixedRows","RowOutlines","ColumnOutlines","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","UniqueId","ShowGridLines","ShowHeaders","IsRtl","IsRow","PermissionSet","GridLineColor","BackgroundColor","Cells","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlagsArray","HandleFlagsMismatch","PageBreaks","PrintAreas","PivotTables","Sparklines","InCellImages","AllRichValueFields","RibbonCommands","AdjacentBlocksHiddensInfo","RichValueTypes","IsCanvasHeadersSupported","HeadersFallbackReason","HasTable","HasOutline"],t.propertyLists.Cell=["Col","Row","Text","StyleID","Ifmt","IfmtStamped","BorderStyleID","HorizontalAlignmentSet","Spill","Merge","NumFmt","WrapText","AutoFilter","PivotFilter","TextRuns","CondFormat","PhonInfo","Comment","RichValueType","RichValueFieldsIndexes","FormulaInfo","DynamicArrayInfo","ValueType","HasError","Hyperlink","Sparkline","InCellImage","LinkedEntity","RichValueIcon","PivotTable","HasIgnorableError","SrvDx","SrvDy","TolType","TableColHeader","TableRowHeader","InCellControlOptions","BitwiseBorderPosition","Value","PhoneticInfo","OriginalText","ErrorTooltip"],t.propertyLists.AutoFilter=["Type","Title","Menu","RenderingContext","CommandData"],t.propertyLists.ShowAutoFilterMenuCommandData=["MenuId","Cell","IsHeaderSnapped"],t.propertyLists.PivotFilter=["Type","DisplayFilter","IsPivotPageField","CommandData","Title","IsHeaderSnapped"],t.propertyLists.ConditionalFormattingInformation=["Icon","DataBar"],t.propertyLists.ConditionalFormattingIcon=["Set","Index","IconOnly","CFIconHorizontalAlignment"],t.propertyLists.DataBarInformation=["AxisPostion","AxisColor","Length","Color","GradientColor","BorderColor","Direction"],t.propertyLists.PhoneticInformation=["Text","PhoneticTextRuns"],t.propertyLists.WrapTextInformation=["BreakOp"],t.propertyLists.AutoFilterMenu=["Id","Sections"],t.propertyLists.AutoFilterRenderingContext=["IsRenderingPermitted","IsHeaderSnapped","IsHidden"],t.propertyLists.MenuSection=["Id","MenuItems","Title","DisplayType"],t.propertyLists.MenuItem=["Disabled","Type","Identifier","RibbonCommand","CommandData","Label","SubMenu","IsChecked","IconName","Id","TooltipText"],t.propertyLists.ReferencedObject=["ID","RefCount"],t.propertyLists.CellStyle=["HorizontalAlignment","VerticalAlignment","BackgroundColor","Gradient","IsPattern","Indentation","ReadingOrder","ShrinkToFit","NamedStyleId","FontID","IsUnlocked","IsHidden","VerticalText","Orientation","PatternStyle","PatternColor"],t.propertyLists.SpillInformation=["SpanToEnd","SpanToStart","IsSpillBlocked"],t.propertyLists.FormulaInformation=["Formula","FormulaType","IsArrayRoot"],t.propertyLists.DynamicArrayInformation=["IsAnchor","Range"],t.propertyLists.MergeInformation=["Columns","Rows","IsOrigin","OriginRow","OriginColumn","SpansBlocks","Width","Height","OriginDeltaX","OriginDeltaY"],t.propertyLists.NumberFormatInformation=["Start","End","Separator"],t.propertyLists.InCellControlOptions=["Type"],t.propertyLists.BorderStyle=["Borders","HasDiagBorder"],t.propertyLists.Border=["BorderLineStyle","BorderPosition","Weight","Color"],t.propertyLists.RGBColor=["Red","Green","Blue"],t.propertyLists.FormattedText=["Text","TextRuns","Fonts"],t.propertyLists.PhoneticRun=["BaseStartIndex","PhoneticStartIndex","BaseTextLength","PhoneticLength"],t.propertyLists.Font=["Size","FontName","FontScheme","Color","Bold","Italic","StrikeThrough","VerticalAlign","Underline"],t.propertyLists.TextRun=["FontID","StartIndex"],t.propertyLists.ColorScheme=["BackgroundColor","LinkColor","TextColor"],t.propertyLists.GradientFill=["Stops","ShadingStyle"],t.propertyLists.ColorStop=["Color","Position"],t.propertyLists.PageBreaksInformation=["Row","Col"],t.propertyLists.RowColBreak=["Index","Min","Max"],t.propertyLists.SharedRange=["FirstRow","FirstColumn","LastRow","LastColumn"],t.propertyLists.RangeInformation=["RangeType"],t.propertyLists.PivotTableRangeInformation=["ConnectionName","PivotTableName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","OriginPTWidth","OriginPTHeight","DeltaXFromOriginPT","DeltaYFromOriginPT","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","HideGridLines","IsEmptyPivot","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","FirstRowIndex","FirstColIndex","LastRowIndex","LastColIndex","StyleIndex","IsRefreshableTabularOlap","SlicerConnections","AutoRefresh","SupportsAutoRefresh"],t.propertyLists.PivotTableFieldInfo=["Index","Caption","ShowBlankLineAfterEachItem","ShowSubtotal","RepeatItemLabels","ShowItemsWithNoData","ShowSubtotalAtTop","IsCompactLayout","BaseFieldIndex","DataFieldAggregationType","DataFieldFormatType","SortInfo","LabelOrDateFilterType","ValueFilterType","MeasureType","HasManualFilter","IsDateField","IsImplicitMeasure","IsNumeric"],t.propertyLists.Hyperlink=["Text","IsValidHyperlink","IsHyperlinkFormula","IsHyperlinkExternal","IsHyperlinkChecked","Tooltip","InternalLink"],t.propertyLists.Outline=["StartIndex","ButtonIndex","IsExpanded","IsButtonHidden","IsNonDefaultDirection","ECTitle"],t.propertyLists.OutlinesLevel=["Outlines"],t.propertyLists.InternalLink=["ObjectName","SheetName"],t.propertyLists.DynamicImages=["ImageUrl","Version"],t.propertyLists.DynamicImageInformation=["ClusterOffsetY","ClusterOffsetX","AltText","Height","Width","ClusterImageHeight","ClusterImageWidth"],t.propertyLists.Sparklines=["Ranges"],t.propertyLists.SparklineRangeInformation=["LocationRow","LocationColumn","SparklineType"],t.propertyLists.LinkedEntityInformation=["Domain","IconWidth"],t.propertyLists.RichValueIconInformation=["Width","Type","Unicode"],t.propertyLists.LinkedEntityServiceDomainId=["Id","StringId"],t.propertyLists.RichValueField=["Value","Index","RefersToDotFunction"],t.propertyLists.PivotTableCellInformation=["HasExpandCollapseIndicator","IsExpanded","ECButtonTitle","ShouldShowExpandCollapseMenu","CanExpandCollapse","SourceIndex","ConfirmRequired","CanShowDetails"],t.propertyLists.SharedSheetCell=["SheetName","NamedObjectName","FirstRow","FirstColumn"],t.propertyLists.SharedSheetRange=["LastRow","LastColumn"],t.propertyLists.SharedSheetFilterRange=["FilteredColumns"],t.propertyLists.RibbonCommands=["ShowAutoFilterMenu","CardViewShowTemporaryDataCard","CardViewShowTemporaryErrorCard","CardViewHideTemporaryCard","CardViewShowDataCardOrDisambiguationPane","ToggleInCellControlCheckbox"],t.propertyLists.PermissionSet=["IsAutoFilterDisabled","IsSortDisabled"],t.propertyLists.CommentData=["Row","Column","IsThreadedComment","IsResolved"],t.propertyLists.ColMetadata=["SrvDx","Text","CellValueType","CellStyleId","Autofilter","ExpandColButton","CondWidthIcon","RichValueIcon","IconWidth","TextRuns"],t.propertyLists.PivotTableSlicerConnectionInfo=["Name","Caption","WorksheetName","Enabled"],t.propertyLists.AdjacentBlocksHiddensInfo=["IsFirstRowOfNextBlockHidden","IsFirstColOfNextBlockHidden","IsLastRowOfPrevBlockHidden","IsLastColOfPrevBlockHidden"],t.propertyLists.PreviewCellsSettings=["PreviewCellsRange","RetainCellTextOnPreview"],t.propertyNameToTypeMap={},t.propertyNameToTypeMap.ColMetadata="ColMetadata",t.propertyNameToTypeMap.RowOutlines="OutlineState",t.propertyNameToTypeMap.ColumnOutlines="OutlineState",t.propertyNameToTypeMap.RowOutlinesInformation="OutlinesLevel",t.propertyNameToTypeMap.ColumnOutlinesInformation="OutlinesLevel",t.propertyNameToTypeMap.PermissionSet="PermissionSet",t.propertyNameToTypeMap.Cells="Cell",t.propertyNameToTypeMap.Styles="CellStyle",t.propertyNameToTypeMap.Fonts="Font",t.propertyNameToTypeMap.BorderStyles="BorderStyle",t.propertyNameToTypeMap.PageBreaks="PageBreaksInformation",t.propertyNameToTypeMap.PrintAreas="SharedRange",t.propertyNameToTypeMap.PivotTables="PivotTableRangeInformation",t.propertyNameToTypeMap.Sparklines="Sparklines",t.propertyNameToTypeMap.InCellImages="InCellImages",t.propertyNameToTypeMap.AllRichValueFields="RichValueField",t.propertyNameToTypeMap.RibbonCommands="RibbonCommands",t.propertyNameToTypeMap.AdjacentBlocksHiddensInfo="AdjacentBlocksHiddensInfo",t.propertyNameToTypeMap.RichValueTypes="RichValueCellType",t.propertyNameToTypeMap.Spill="SpillInformation",t.propertyNameToTypeMap.Merge="MergeInformation",t.propertyNameToTypeMap.NumFmt="NumberFormatInformation",t.propertyNameToTypeMap.WrapText="WrapTextInformation",t.propertyNameToTypeMap.AutoFilter="AutoFilter",t.propertyNameToTypeMap.PivotFilter="PivotFilter",t.propertyNameToTypeMap.TextRuns="TextRun",t.propertyNameToTypeMap.CondFormat="ConditionalFormattingInformation",t.propertyNameToTypeMap.PhonInfo="PhoneticInformation",t.propertyNameToTypeMap.Comment="CommentData",t.propertyNameToTypeMap.RichValueType="RichValueCellType",t.propertyNameToTypeMap.FormulaInfo="FormulaInformation",t.propertyNameToTypeMap.DynamicArrayInfo="DynamicArrayInformation",t.propertyNameToTypeMap.ValueType="CellValueType",t.propertyNameToTypeMap.Hyperlink="Hyperlink",t.propertyNameToTypeMap.Sparkline="SparklineInformation",t.propertyNameToTypeMap.InCellImage="InCellImageInformation",t.propertyNameToTypeMap.LinkedEntity="LinkedEntityInformation",t.propertyNameToTypeMap.RichValueIcon="RichValueIconInformation",t.propertyNameToTypeMap.PivotTable="PivotTableCellInformation",t.propertyNameToTypeMap.TolType="TolType",t.propertyNameToTypeMap.InCellControlOptions="InCellControlOptions",t.propertyNameToTypeMap.Type="RichValueIconType",t.propertyNameToTypeMap.Menu="AutoFilterMenu",t.propertyNameToTypeMap.RenderingContext="AutoFilterRenderingContext",t.propertyNameToTypeMap.Cell="SharedSheetCell",t.propertyNameToTypeMap.Icon="ConditionalFormattingIcon",t.propertyNameToTypeMap.DataBar="DataBarInformation",t.propertyNameToTypeMap.Set="CFIconSet",t.propertyNameToTypeMap.CFIconHorizontalAlignment="HorizontalAlignment",t.propertyNameToTypeMap.Direction="ReadingOrderType",t.propertyNameToTypeMap.PhoneticTextRuns="PhoneticRun",t.propertyNameToTypeMap.Sections="MenuSection",t.propertyNameToTypeMap.MenuItems="MenuItem",t.propertyNameToTypeMap.DisplayType="MenuDisplayType",t.propertyNameToTypeMap.Identifier="MenuEntryIdentifier",t.propertyNameToTypeMap.SubMenu="AutoFilterMenu",t.propertyNameToTypeMap.HorizontalAlignment="HorizontalAlignment",t.propertyNameToTypeMap.VerticalAlignment="VerticalAlignment",t.propertyNameToTypeMap.Gradient="GradientFill",t.propertyNameToTypeMap.ReadingOrder="ReadingOrderType",t.propertyNameToTypeMap.PatternStyle="PatternStyleType",t.propertyNameToTypeMap.FormulaType="CellFormulaType",t.propertyNameToTypeMap.Range="SharedRange",t.propertyNameToTypeMap.Borders="Border",t.propertyNameToTypeMap.BorderLineStyle="BorderLineType",t.propertyNameToTypeMap.BorderPosition="BorderPositionType",t.propertyNameToTypeMap.Color="RGBColor",t.propertyNameToTypeMap.FontScheme="FontSchemeOption",t.propertyNameToTypeMap.VerticalAlign="FontVerticalAlignment",t.propertyNameToTypeMap.Underline="FontUnderline",t.propertyNameToTypeMap.Stops="ColorStop",t.propertyNameToTypeMap.ShadingStyle="GradientShadingStyle",t.propertyNameToTypeMap.Row="RowColBreak",t.propertyNameToTypeMap.Col="RowColBreak",t.propertyNameToTypeMap.RangeType="RangeType",t.propertyNameToTypeMap.ColumnHeaderRange="RangeInformation",t.propertyNameToTypeMap.RowHeaderRange="RangeInformation",t.propertyNameToTypeMap.RowAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.ColumnAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.ValueAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.PageAreaFields="PivotTableFieldInfo",t.propertyNameToTypeMap.SlicerConnections="PivotTableSlicerConnectionInfo",t.propertyNameToTypeMap.DataFieldAggregationType="PivotTableDataFieldAggregationType",t.propertyNameToTypeMap.DataFieldFormatType="PivotTableDataFieldFormatType",t.propertyNameToTypeMap.SortInfo="PivotSortInfo",t.propertyNameToTypeMap.LabelOrDateFilterType="PivotFilterType",t.propertyNameToTypeMap.ValueFilterType="PivotFilterType",t.propertyNameToTypeMap.MeasureType="PivotMeasureType",t.propertyNameToTypeMap.InternalLink="InternalLink",t.propertyNameToTypeMap.Outlines="Outline",t.propertyNameToTypeMap.Ranges="SparklineRangeInformation",t.propertyNameToTypeMap.SparklineType="SparklineType",t.propertyNameToTypeMap.Domain="LinkedEntityServiceDomainId",t.propertyNameToTypeMap.CellValueType="CellValueType",t.propertyNameToTypeMap.PreviewCellsRange="SharedRange",t.propertyToClassMap={},t.propertyToClassMap.ColMetadata=["ColMetadata"],t.propertyToClassMap.RowOutlinesInformation=["OutlinesLevel"],t.propertyToClassMap.ColumnOutlinesInformation=["OutlinesLevel"],t.propertyToClassMap.PermissionSet=["PermissionSet"],t.propertyToClassMap.Cells=["Cell"],t.propertyToClassMap.Styles=["CellStyle","ReferencedObject"],t.propertyToClassMap.Fonts=["Font","ReferencedObject"],t.propertyToClassMap.BorderStyles=["BorderStyle","ReferencedObject"],t.propertyToClassMap.PageBreaks=["PageBreaksInformation"],t.propertyToClassMap.PrintAreas=["SharedRange"],t.propertyToClassMap.PivotTables=["PivotTableRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Sparklines=["Sparklines","DynamicImages"],t.propertyToClassMap.InCellImages=["InCellImages","DynamicImages"],t.propertyToClassMap.AllRichValueFields=["RichValueField"],t.propertyToClassMap.RibbonCommands=["RibbonCommands"],t.propertyToClassMap.AdjacentBlocksHiddensInfo=["AdjacentBlocksHiddensInfo"],t.propertyToClassMap.Spill=["SpillInformation"],t.propertyToClassMap.Merge=["MergeInformation"],t.propertyToClassMap.NumFmt=["NumberFormatInformation"],t.propertyToClassMap.WrapText=["WrapTextInformation"],t.propertyToClassMap.AutoFilter=["AutoFilter"],t.propertyToClassMap.PivotFilter=["PivotFilter"],t.propertyToClassMap.TextRuns=["TextRun"],t.propertyToClassMap.CondFormat=["ConditionalFormattingInformation"],t.propertyToClassMap.PhonInfo=["PhoneticInformation"],t.propertyToClassMap.Comment=["CommentData"],t.propertyToClassMap.FormulaInfo=["FormulaInformation"],t.propertyToClassMap.DynamicArrayInfo=["DynamicArrayInformation"],t.propertyToClassMap.Hyperlink=["Hyperlink"],t.propertyToClassMap.Sparkline=["SparklineInformation","DynamicImageInformation"],t.propertyToClassMap.InCellImage=["InCellImageInformation","DynamicImageInformation"],t.propertyToClassMap.LinkedEntity=["LinkedEntityInformation"],t.propertyToClassMap.RichValueIcon=["RichValueIconInformation"],t.propertyToClassMap.PivotTable=["PivotTableCellInformation"],t.propertyToClassMap.InCellControlOptions=["InCellControlOptions"],t.propertyToClassMap.CachedStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.CachedFont=["Font","ReferencedObject"],t.propertyToClassMap.CachedBorderStyle=["BorderStyle","ReferencedObject"],t.propertyToClassMap.CachedDisplayTextRuns=["TextRun"],t.propertyToClassMap.PreviewNumFmt=["NumberFormatInformation"],t.propertyToClassMap.PreviewCellStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.InsertButtons=["InsertButtons"],t.propertyToClassMap.Start=["InsertButton"],t.propertyToClassMap.End=["InsertButton"],t.propertyToClassMap.Menu=["AutoFilterMenu"],t.propertyToClassMap.RenderingContext=["AutoFilterRenderingContext"],t.propertyToClassMap.Cell=["SharedSheetCell"],t.propertyToClassMap.Icon=["ConditionalFormattingIcon"],t.propertyToClassMap.DataBar=["DataBarInformation"],t.propertyToClassMap.PhoneticTextRuns=["PhoneticRun"],t.propertyToClassMap.Sections=["MenuSection"],t.propertyToClassMap.MenuItems=["MenuItem"],t.propertyToClassMap.SubMenu=["AutoFilterMenu"],t.propertyToClassMap.Gradient=["GradientFill"],t.propertyToClassMap.Range=["SharedRange"],t.propertyToClassMap.Borders=["Border"],t.propertyToClassMap.Color=["RGBColor"],t.propertyToClassMap.Stops=["ColorStop"],t.propertyToClassMap.Row=["RowColBreak"],t.propertyToClassMap.Col=["RowColBreak"],t.propertyToClassMap.ColumnHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ColumnAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ValueAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.PageAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.SlicerConnections=["PivotTableSlicerConnectionInfo"],t.propertyToClassMap.InternalLink=["InternalLink","SharedRange"],t.propertyToClassMap.Outlines=["Outline"],t.propertyToClassMap.Ranges=["SparklineRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Domain=["LinkedEntityServiceDomainId"],t.propertyToClassMap.CachedFormattedText=["FormattedText"],t.propertyToClassMap.PreviewCellsRange=["SharedRange"],t.UserContentList={},t.UserContentList.Cell=["Text","CachedDisplayText","PreviewText","Value","UserInput","OriginalText"],t.UserContentList.AutoFilter=["CommandData"],t.UserContentList.PivotFilter=["CommandData"],t.UserContentList.PhoneticInformation=["Text"],t.UserContentList.MenuItem=["CommandData","Label"],t.UserContentList.FormulaInformation=["Formula"],t.UserContentList.NumberFormatInformation=["Start","End","Separator"],t.UserContentList.FormattedText=["Text"],t.UserContentList.Font=["FontName"],t.UserContentList.PivotTableFieldInfo=["Caption"],t.UserContentList.Hyperlink=["Text","Tooltip"],t.UserContentList.InternalLink=["ObjectName","SheetName"],t.UserContentList.DynamicImages=["ImageUrl"],t.UserContentList.SharedSheetCell=["SheetName"],t.UserContentList.ColMetadata=["Text"],t.SerializationProperties={},t.SerializationPropertyKey="{className}.{propertyName}",t.SerializationProperties["GridBlockModel.BlockWidth"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BlockHeight"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowHeights"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnWidths"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColMetadata"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.FixedColumns"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsBitwiseFixedRows"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOutlines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOutlines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOutlinesInformation"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOutlinesInformation"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.MaxRowOutlineLevelInSheet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.MaxColOutlineLevelInSheet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.UniqueId"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowGridLines"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowHeaders"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsRtl"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsRow"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PermissionSet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.GridLineColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Cells"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Styles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Fonts"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BorderStyles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.CellsEncoding"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RenderFlagsArray"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HandleFlagsMismatch"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PageBreaks"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PrintAreas"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PivotTables"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Sparklines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.InCellImages"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.AllRichValueFields"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RibbonCommands"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ClientOnlyCache"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["GridBlockModel.AdjacentBlocksHiddensInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RichValueTypes"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsCanvasHeadersSupported"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HeadersFallbackReason"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HasTable"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HasOutline"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Col"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Row"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Text"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.StyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.GlobalCellStyleID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Ifmt"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.IfmtStamped"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.BorderStyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.GlobalBorderStyleID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.HorizontalAlignmentSet"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Spill"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Merge"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.NumFmt"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.WrapText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ShrunkSize"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.AutoFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TextRuns"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CondFormat"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PhonInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Comment"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueFieldsIndexes"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.FormulaInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.DynamicArrayInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Hyperlink"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Sparkline"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.InCellImage"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.LinkedEntity"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueIcon"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotTable"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasIgnorableError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.SrvDx"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.SrvDy"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.TolType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TableColHeader"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TableRowHeader"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.InCellControlOptions"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.BitwiseBorderPosition"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CachedStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedFont"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedBorderStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.IsCellSnapped"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDrawingLayout"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayTextRuns"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedIsTextWidthExceedsCellWidth"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedIndent"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.DisplayFormula"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewNumFmt"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewCellStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.RetainTextOnPreview"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.ShowSkeleton"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Value"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.UserInput"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PhoneticInfo"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.OriginalText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ErrorTooltip"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.HorizontalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Gradient"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsPattern"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Indentation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ReadingOrder"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ShrinkToFit"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.NamedStyleId"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.FontID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.GlobalFontID"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["CellStyle.IsUnlocked"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsHidden"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalText"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Orientation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.PatternStyle"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.PatternColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["BorderStyle.Borders"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.HasDiagBorder"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Font.Size"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.FontName"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.FontScheme"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Color"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.Bold"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.Italic"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.StrikeThrough"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.VerticalAlign"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Underline"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.GlobalId"]={type:"number",ignoreOnSerialize:!0},t.SerializationClasses={},t.SerializationClasses.Cell="Cells",t.SerializationClasses.CellStyle="Styles",t.SerializationClasses.Font="Fonts",t.SerializationClasses.BorderStyle="BorderStyles",t.HeaderIncludeLists={},t.HeaderIncludeLists.GridBlockModel=["BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","IsRtl","AdjacentBlocksHiddensInfo","IsCanvasHeadersSupported","HasTable","HasOutline"],t.HeaderIncludeLists.Cell=["Col","Row","Text","CachedStyle","CachedFont"],t.HeaderIncludeLists.HeaderCell=["InsertButtons"],t.HeaderIncludeLists.InsertButtons=["Start","End"],t.HeaderIncludeLists.InsertButton=["Type","Offset"],t.HeaderIncludeLists.CellStyle=["BackgroundColor"],t.HeaderIncludeLists.Font=["Color"],t.HeaderIncludeLists.Outline=["StartIndex","ButtonIndex","IsExpanded","IsButtonHidden","IsNonDefaultDirection"],t.HeaderIncludeLists.OutlinesLevel=["Outlines"],t.HeaderIncludeLists.AdjacentBlocksHiddensInfo=["IsFirstRowOfNextBlockHidden","IsFirstColOfNextBlockHidden","IsLastRowOfPrevBlockHidden","IsLastColOfPrevBlockHidden"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recalculateFontMetrics=t.getCachedFontMetrics=void 0;var r=n(4),o=n(13),i=n(10),l=n(45),a=n(1),s=n(38),d=n(0),u=!0,c=document.createElement("div"),g=document.createElement("img"),f=document.createElement("img");c.innerText=".",c.style.visibility="hidden",g.style.height="0px",f.style.height="0px",c.appendChild(g),c.appendChild(f),(null===document||void 0===document?void 0:document.body)&&document.body.appendChild(c);var h={"6pt arial":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:4.072916}},"7pt arial":{fontSize:7,fontMetrics:{height:11,baseline:2,middle:4.416666698}},"8pt arial":{fontSize:8,fontMetrics:{height:12,baseline:2.666666030883789,middle:4.765625}},"9pt arial":{fontSize:9,fontMetrics:{height:14,baseline:3.33333,middle:6.109375}},"10pt arial":{fontSize:10,fontMetrics:{height:15,baseline:3.6666666,middle:6.453125}},"11pt arial":{fontSize:11,fontMetrics:{height:16,baseline:4,middle:6.796875}},"12pt arial":{fontSize:12,fontMetrics:{height:19,baseline:4.33333333,middle:8.15625}},"13pt arial":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666679,middle:9.15625}},"14pt arial":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.84375}},"16pt arial":{fontSize:16,fontMetrics:{height:25,baseline:5.33333333,middle:11.53125}},"18pt arial":{fontSize:18,fontMetrics:{height:28,baseline:5.66666666,middle:12.21875}},"20pt arial":{fontSize:20,fontMetrics:{height:30,baseline:6,middle:12.9166666}},"22pt arial":{fontSize:22,fontMetrics:{height:34,baseline:6.666667938232422,middle:14.609375}},"24pt arial":{fontSize:24,fontMetrics:{height:37,baseline:7.333333,middle:15.63541}},"25pt arial":{fontSize:25,fontMetrics:{height:39,baseline:8,middle:16.6458339}},"26pt arial":{fontSize:26,fontMetrics:{height:40,baseline:8,middle:16.984375}},"28pt arial":{fontSize:28,fontMetrics:{height:43,baseline:8.6666666,middle:18.3437}},"36pt arial":{fontSize:36,fontMetrics:{height:55,baseline:10.666667938232422,middle:23.453125}},"20pt arial black":{fontSize:20,fontMetrics:{height:37,baseline:8,middle:14.90625}},"16pt browallia new":{fontSize:16,fontMetrics:{height:27,baseline:8,middle:11.6145839}},"1pt calibri":{fontSize:1,fontMetrics:{height:1,baseline:0,middle:.3125}},"2pt calibri":{fontSize:2,fontMetrics:{height:3,baseline:.7407407760620117,middle:1.3541667461395264}},"3pt calibri":{fontSize:3,fontMetrics:{height:4,baseline:.7407407760620117,middle:1.6666667461395264}},"4pt calibri":{fontSize:4,fontMetrics:{height:7,baseline:1.4814815521240234,middle:2.719907522201538}},"5pt calibri":{fontSize:5,fontMetrics:{height:8,baseline:1.4814815521240234,middle:3.032407760620117}},"6pt calibri":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:3.8541669}},"7pt calibri":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.8333333969}},"8pt calibri":{fontSize:8,fontMetrics:{height:13,baseline:2.6666669845581055,middle:5.46875}},"9pt calibri":{fontSize:9,fontMetrics:{height:15,baseline:3.3333330154418945,middle:5.78125}},"10pt calibri":{fontSize:10,fontMetrics:{height:17,baseline:3.3333330154418945,middle:7.09375}},"11pt calibri":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.40625}},"12pt calibri":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.71875}},"13pt calibri":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666,middle:8.6875}},"14pt calibri":{fontSize:14,fontMetrics:{height:21,baseline:5.33333396911621,middle:9.328125}},"15pt calibri":{fontSize:15,fontMetrics:{height:23,baseline:5.6666666667,middle:9.640625}},"16pt calibri":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:10.953125}},"17pt calibri":{fontSize:17,fontMetrics:{height:27,baseline:5.925926208496094,middle:11.192131042480469}},"18pt calibri":{fontSize:18,fontMetrics:{height:29,baseline:6.666666030883789,middle:11.578125}},"19pt calibri":{fontSize:19,fontMetrics:{height:31,baseline:6.666666030883789,middle:12.546297073364258}},"20pt calibri":{fontSize:20,fontMetrics:{height:32,baseline:7.333333969116211,middle:13.1875}},"21pt calibri":{fontSize:21,fontMetrics:{height:34,baseline:7.407405853271484,middle:13.91203498840332}},"22pt calibri":{fontSize:22,fontMetrics:{height:36,baseline:8,middle:14.8125}},"23pt calibri":{fontSize:23,fontMetrics:{height:37,baseline:8.148151397705078,middle:15.266206741333008}},"24pt calibri":{fontSize:24,fontMetrics:{height:39,baseline:8.666666793,middle:16.09375}},"25pt calibri":{fontSize:25,fontMetrics:{height:41,baseline:8.88888931274414,middle:16.63194465637207}},"26pt calibri":{fontSize:26,fontMetrics:{height:43,baseline:9.333333,middle:17.3854179}},"27pt calibri":{fontSize:27,fontMetrics:{height:44,baseline:9.629631042480469,middle:17.98611068725586}},"28pt calibri":{fontSize:28,fontMetrics:{height:45,baseline:10,middle:18.666666}},"29pt calibri":{fontSize:29,fontMetrics:{height:47,baseline:10.370368957519531,middle:19.351852416992188}},"30pt calibri":{fontSize:30,fontMetrics:{height:48,baseline:10.370372772216797,middle:19.652780532836914}},"31pt calibri":{fontSize:31,fontMetrics:{height:50,baseline:11.11111068725586,middle:20.70602035522461}},"32pt calibri":{fontSize:32,fontMetrics:{height:52,baseline:11.11111068725586,middle:21.018518447875977}},"33pt calibri":{fontSize:33,fontMetrics:{height:54,baseline:11.851852416992188,middle:22.06018829345703}},"34pt calibri":{fontSize:34,fontMetrics:{height:55,baseline:11.851852416992188,middle:22.37268829345703}},"35pt calibri":{fontSize:35,fontMetrics:{height:57,baseline:12.592594146728516,middle:23.425926208496094}},"36pt calibri":{fontSize:36,fontMetrics:{height:59,baseline:12.666666679,middle:24.140625}},"37pt calibri":{fontSize:37,fontMetrics:{height:60,baseline:13.333335876464844,middle:24.791667938232422}},"38pt calibri":{fontSize:38,fontMetrics:{height:61,baseline:13.333335876464844,middle:25.104167938232422}},"39pt calibri":{fontSize:39,fontMetrics:{height:64,baseline:14.444446563720703,middle:26.510421752929688}},"40pt calibri":{fontSize:40,fontMetrics:{height:65,baseline:14.074073791503906,middle:26.458335876464844}},"41pt calibri":{fontSize:41,fontMetrics:{height:67,baseline:14.444446563720703,middle:27.135421752929688}},"42pt calibri":{fontSize:42,fontMetrics:{height:68,baseline:14.814811706542969,middle:27.812496185302734}},"43pt calibri":{fontSize:43,fontMetrics:{height:70,baseline:15.555553436279297,middle:28.871524810791016}},"44pt calibri":{fontSize:44,fontMetrics:{height:71,baseline:15.555557250976562,middle:29.18402862548828}},"45pt calibri":{fontSize:45,fontMetrics:{height:73,baseline:16.296295166015625,middle:30.21990966796875}},"46pt calibri":{fontSize:46,fontMetrics:{height:76,baseline:16.666664123535156,middle:30.90277862548828}},"47pt calibri":{fontSize:47,fontMetrics:{height:77,baseline:16.666667938232422,middle:31.215282440185547}},"48pt calibri":{fontSize:48,fontMetrics:{height:72,baseline:17.333332061767578,middle:31.859375}},"49pt calibri":{fontSize:49,fontMetrics:{height:80,baseline:17.777774810791016,middle:32.951385498046875}},"50pt calibri":{fontSize:50,fontMetrics:{height:81,baseline:17.77777862548828,middle:33.24652862548828}},"51pt calibri":{fontSize:51,fontMetrics:{height:83,baseline:18.518516540527344,middle:34.30555725097656}},"52pt calibri":{fontSize:52,fontMetrics:{height:84,baseline:18.888893127441406,middle:34.982643127441406}},"53pt calibri":{fontSize:53,fontMetrics:{height:87,baseline:18.888893127441406,middle:35.295143127441406}},"54pt calibri":{fontSize:54,fontMetrics:{height:88,baseline:18.888885498046875,middle:35.607635498046875}},"55pt calibri":{fontSize:55,fontMetrics:{height:90,baseline:20,middle:37.02546310424805}},"56pt calibri":{fontSize:56,fontMetrics:{height:91,baseline:20,middle:37.32638931274414}},"57pt calibri":{fontSize:57,fontMetrics:{height:92,baseline:20,middle:37.638893127441406}},"58pt calibri":{fontSize:58,fontMetrics:{height:94,baseline:21.111114501953125,middle:39.062503814697266}},"59pt calibri":{fontSize:59,fontMetrics:{height:96,baseline:21.111106872558594,middle:39.375}},"60pt calibri":{fontSize:60,fontMetrics:{height:98,baseline:21.111114501953125,middle:39.687503814697266}},"61pt calibri":{fontSize:61,fontMetrics:{height:100,baseline:22.22222900390625,middle:41.111114501953125}},"62pt calibri":{fontSize:62,fontMetrics:{height:101,baseline:22.22222137451172,middle:41.40625}},"63pt calibri":{fontSize:63,fontMetrics:{height:102,baseline:22.22222900390625,middle:41.718753814697266}},"64pt calibri":{fontSize:64,fontMetrics:{height:104,baseline:23.333335876464844,middle:43.142364501953125}},"65pt calibri":{fontSize:65,fontMetrics:{height:106,baseline:23.3333328,middle:43.458332061}},"66pt calibri":{fontSize:66,fontMetrics:{height:107,baseline:23.333335876464844,middle:43.767364501953125}},"67pt calibri":{fontSize:67,fontMetrics:{height:110,baseline:24.44445037841797,middle:45.19097900390625}},"68pt calibri":{fontSize:68,fontMetrics:{height:111,baseline:24.444442749023438,middle:45.50347137451172}},"69pt calibri":{fontSize:69,fontMetrics:{height:112,baseline:24.44445037841797,middle:45.798614501953125}},"70pt calibri":{fontSize:70,fontMetrics:{height:114,baseline:25.555557250976562,middle:47.22222137451172}},"71pt calibri":{fontSize:71,fontMetrics:{height:116,baseline:25.55554962158203,middle:47.53472137451172}},"72pt calibri":{fontSize:72,fontMetrics:{height:117,baseline:25.925926208496094,middle:48.21759033203125}},"85pt calibri":{fontSize:85,fontMetrics:{height:138,baseline:30,middle:56.31945037841797}},"98pt calibri":{fontSize:98,fontMetrics:{height:160,baseline:35.55554962158203,middle:65.88541412353516}},"100pt calibri":{fontSize:100,fontMetrics:{height:162,baseline:35.55555725097656,middle:66.51620483398438}},"111pt calibri":{fontSize:111,fontMetrics:{height:181,baseline:40,middle:74.35763549804688}},"124pt calibri":{fontSize:124,fontMetrics:{height:202,baseline:44.44444274902344,middle:82.82986450195312}},"137pt calibri":{fontSize:137,fontMetrics:{height:223,baseline:48.888885498046875,middle:91.30209350585938}},"150pt calibri":{fontSize:150,fontMetrics:{height:243,baseline:53.33332824707031,middle:99.77430725097656}},"163pt calibri":{fontSize:163,fontMetrics:{height:266,baseline:58.88890075683594,middle:109.34028625488281}},"176pt calibri":{fontSize:176,fontMetrics:{height:287,baseline:63.333343505859375,middle:117.81251525878906}},"189pt calibri":{fontSize:189,fontMetrics:{height:308,baseline:67.77778625488281,middle:126.28474426269531}},"202pt calibri":{fontSize:202,fontMetrics:{height:329,baseline:72.22222900390625,middle:134.7569580078125}},"215pt calibri":{fontSize:215,fontMetrics:{height:350,baseline:76.66668701171875,middle:143.22918701171875}},"228pt calibri":{fontSize:228,fontMetrics:{height:371,baseline:81.11111450195312,middle:151.70138549804688}},"241pt calibri":{fontSize:241,fontMetrics:{height:392,baseline:86.66665649414062,middle:161.26736450195312}},"254pt calibri":{fontSize:254,fontMetrics:{height:413,baseline:91.11111450195312,middle:169.7395782470703}},"267pt calibri":{fontSize:267,fontMetrics:{height:434,baseline:95.5555419921875,middle:178.2117919921875}},"280pt calibri":{fontSize:280,fontMetrics:{height:456,baseline:100,middle:186.68402099609375}},"293pt calibri":{fontSize:293,fontMetrics:{height:477,baseline:104.4444580078125,middle:195.13888549804688}},"306pt calibri":{fontSize:306,fontMetrics:{height:499,baseline:110,middle:204.72222900390625}},"319pt calibri":{fontSize:319,fontMetrics:{height:519,baseline:114.4444580078125,middle:213.1944580078125}},"332pt calibri":{fontSize:332,fontMetrics:{height:540,baseline:118.88885498046875,middle:221.66665649414062}},"345pt calibri":{fontSize:345,fontMetrics:{height:561,baseline:123.33334350585938,middle:230.138916015625}},"358pt calibri":{fontSize:358,fontMetrics:{height:582,baseline:127.77777099609375,middle:238.61111450195312}},"371pt calibri":{fontSize:371,fontMetrics:{height:604,baseline:133.33331298828125,middle:248.17709350585938}},"384pt calibri":{fontSize:384,fontMetrics:{height:626,baseline:137.77780151367188,middle:256.6493225097656}},"397pt calibri":{fontSize:397,fontMetrics:{height:647,baseline:142.22222900390625,middle:265.12152099609375}},"409pt calibri":{fontSize:409,fontMetrics:{height:666,baseline:146.66668701171875,middle:273.2812805175781}},"12pt calibri light":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.6979169845581055}},"14pt comic sans ms":{fontSize:14,fontMetrics:{height:26,baseline:5.3333332061,middle:10.03125}},"9pt georgia":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.890625}},"8pt microsoft sans serif":{fontSize:8,fontMetrics:{height:12,baseline:2,middle:4.760416507720947}},"8pt meiryo ui":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.9375}},"9pt meiryo ui":{fontSize:9,fontMetrics:{height:16,baseline:3,middle:6.3125}},"11pt meiryo ui":{fontSize:11,fontMetrics:{height:19,baseline:3,middle:7.046875}},"10pt segoe ui":{fontSize:10,fontMetrics:{height:18,baseline:3.3333330154418945,middle:6.666666030883789}},"6pt times new roman":{fontSize:6,fontMetrics:{height:10,baseline:2.666665,middle:4.45833301}},"7pt times new roman":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.75}},"8pt times new roman":{fontSize:8,fontMetrics:{height:11,baseline:2.666666030883789,middle:4.390625}},"8.5pt times new roman":{fontSize:8.5,fontMetrics:{height:12,baseline:2.8888888888884,middle:4.53125}},"9pt times new roman":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:6.6875}},"10pt times new roman":{fontSize:10,fontMetrics:{height:15,baseline:3.3333333,middle:6.984375}},"11pt times new roman":{fontSize:11,fontMetrics:{height:17,baseline:4,middle:7.28125}},"12pt times new roman":{fontSize:12,fontMetrics:{height:18,baseline:4.3333333,middle:7.578125}},"13pt times new roman":{fontSize:13,fontMetrics:{height:19,baseline:4.5,middle:8.875}},"14pt times new roman":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.171875}},"15pt times new roman":{fontSize:15,fontMetrics:{height:23,baseline:4.6666667938,middle:9.13541793}},"16pt times new roman":{fontSize:16,fontMetrics:{height:25,baseline:5.333333,middle:10.765625}},"18pt times new roman":{fontSize:18,fontMetrics:{height:28,baseline:6,middle:11.375}},"19pt times new roman":{fontSize:19,fontMetrics:{height:29,baseline:6,middle:11.666666603}},"20pt times new roman":{fontSize:20,fontMetrics:{height:31,baseline:6.666666603,middle:12.635416}},"8pt tahoma":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"10pt tahoma":{fontSize:10,fontMetrics:{height:16,baseline:2.6666666,middle:6.30208301}},"11pt tahoma":{fontSize:11,fontMetrics:{height:18,baseline:3.3333333015,middle:7.333333015}},"12pt trebuchet ms":{fontSize:12,fontMetrics:{height:19,baseline:3.333333,middle:7.5208339691}},"14pt trebuchet ms":{fontSize:14,fontMetrics:{height:22,baseline:4,middle:8.875}},"8pt verdana":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"9pt verdana":{fontSize:9,fontMetrics:{height:15,baseline:3,middle:6.265625}},"10pt verdana":{fontSize:10,fontMetrics:{height:16,baseline:2.66666603,middle:6.302083015}},"14pt webdings":{fontSize:14,fontMetrics:{height:19,baseline:4.000000953674316,middle:8.666667938232422}},"36pt wingdings":{fontSize:36,fontMetrics:{height:53,baseline:10,middle:22.000001907348633}}};function C(e){var t=-1,n=-1,r=-1,i=g,l=f;return c.style.font=e,i.style.verticalAlign="baseline",l.style.verticalAlign="middle",(0,o.trackDuration)(o.RenderPerformanceMetric.GetFontMetrics,(function(){t=c.clientHeight,n=m(i),r=m(l)}),!0),{height:t,baseline:n,middle:r}}function m(e){if(!c||!e)throw Error("getFontBaselineHeight: arguments cannot be null or undefined, fontMetricsDiv: ".concat(c,", baselineLocator: ").concat(e));try{var t=c.getBoundingClientRect(),n=e.getBoundingClientRect();return t.bottom-n.bottom}catch(e){return(0,o.setRenderingResultInfo)("Error in getFontBaselineHeight: "+e),0}}function p(e,t){var n,r=(0,i.getFontLookupKey)(e,t);if(t>=0&&t<1)return h[r]={fontSize:t,fontMetrics:{baseline:0,height:1,middle:0}},h[r].fontMetrics;try{n=C(r)}catch(n){return v(t,e,r,"Exception in getFontMetrics, error:".concat(n))}return 0===n.height&&t>=1?v(t,e,r,"fontMetricsDivHeight == 0."):(h[r]={fontSize:t,fontMetrics:n},n)}function y(e){return{height:e.height,baseline:e.baseline,middle:e.middle}}function v(e,t,n,r){var l=null!==c.parentNode?"Has Parent":"Parent is null",a=window.getComputedStyle(c).getPropertyValue("display");c.style.display="block",(null===document||void 0===document?void 0:document.body)&&document.body.appendChild(c);var s=C(n),d=window.getComputedStyle(c),u=d.getPropertyValue("display"),g=d.getPropertyValue("height"),f=c.getBoundingClientRect();if(0!==s.height)return h[n]={fontSize:e,fontMetrics:s},s;c.style.overflow="hidden";var m=C(n);if(0!==m.height)return h[n]={fontSize:e,fontMetrics:s},m;var p="\n       ".concat(r,"\n       Font name: ").concat((0,i.getFontNameForLogging)(t)," }, font size: ").concat(e,".\n       fontMetricsDiv ").concat(l,". fontMetricsDivDisplayMode: ").concat(a,".\n       After another appendChild:\n       FontMetricsDivHeight2: ").concat(s.height," (getFontMetricsDivHeight), fontMetricsDivDisplayMode: ").concat(u," (getComputedStyle),\n       fontBoundingClientRect.height: ").concat(f.height," }, top:").concat(f.top," }, bottom:").concat(f.bottom,".\n       css.height: ").concat(d.height," }, css.line-height: ").concat(d.lineHeight," }, computedHeight: ").concat(g,".\n       FontMetricsDiv.scrollWidth: ").concat(c.scrollWidth," }, fontMetricsDiv.scrollHeight: ").concat(c.scrollHeight);if((0,o.setRenderingResultInfo)(p),!(0,i.isKnownFont)(t)){var y=Math.round(e),v="".concat(y,"pt calibri");if(h[v])return h[v].fontMetrics}throw Error(p)}function S(e){var t=h[(0,i.getFontLookupKey)(s.DefaultFallbackFontName,e)];return y(t?t.fontMetrics:p(s.DefaultFallbackFontName,e))}t.getCachedFontMetrics=function(e,t,n){if(!(0,d.isPLTRegressionInMFPFixEnabled)(n)){var s=(0,d.isGridRenderPerfFixEnabled)()?(0,i.canonizeFontNameNoLowercase)(e):(0,i.canonizeFontName)(e);(0,l.updateFontLoadStatus)(s,n)}u&&(u=(0,a.isRenderFlagEnabled)(a.RenderFlagsArray.FluentStyle,n)&&(0,a.isChangeGateEnabled)(a.ChangeGate.AddAptosToCachedFontMetrics)),u&&(h=r.__assign(r.__assign({},h),{"8pt aptos narrow":{fontSize:8,fontMetrics:{height:13,baseline:3,middle:5.640625}},"9pt aptos narrow":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.984375}},"10pt aptos narrow":{fontSize:10,fontMetrics:{height:17,baseline:4,middle:7.3125}},"11pt aptos narrow":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.640625}},"12pt aptos narrow":{fontSize:12,fontMetrics:{height:20,baseline:5,middle:8.96875}},"14pt aptos narrow":{fontSize:14,fontMetrics:{height:23,baseline:5,middle:9.625}},"16pt aptos narrow":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:11.296875}},"18pt aptos narrow":{fontSize:18,fontMetrics:{height:30,baseline:7,middle:12.953125}},"20pt aptos narrow":{fontSize:20,fontMetrics:{height:33,baseline:8,middle:14.609375}},"24pt aptos narrow":{fontSize:24,fontMetrics:{height:39,baseline:9,middle:16.9375}},"26pt aptos narrow":{fontSize:26,fontMetrics:{height:43,baseline:10,middle:18.59375}},"28pt aptos narrow":{fontSize:28,fontMetrics:{height:46,baseline:11,middle:20.265625}},"36pt aptos narrow":{fontSize:36,fontMetrics:{height:59,baseline:14,middle:25.90625}},"48pt aptos narrow":{fontSize:48,fontMetrics:{height:78,baseline:18,middle:33.875}},"72pt aptos narrow":{fontSize:72,fontMetrics:{height:117,baseline:27,middle:50.8125}}}),u=!1);var c=(0,i.getFontLookupKey)(e,t),g=h[c];if(g)return y(g.fontMetrics);try{return y(p(e,t))}catch(r){(0,o.setRenderingResultInfo)("FontName:".concat((0,i.getFontNameForLogging)(e),", FontSize:").concat(t," is trying to fallback to calibri ").concat(r)),n.ClientOnlyCache.FallbackFonts[c]=!0;try{return S(t)}catch(e){var f=Math.max(Math.round(t),1);try{return S(f)}catch(e){var C=13*Math.round((f-72)/13)+72;return S(C=Math.min(C,409))}}throw r}},t.recalculateFontMetrics=function(e){for(var t=Object.getOwnPropertyNames(h),n=e.toLowerCase(),r=0;r<t.length;r++){var o=t[r];if(o.indexOf(n)>=0){var i=h[o].fontSize;try{p(n,i)}catch(e){p(s.DefaultFallbackFontName,i)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reorderTextRunsForBidiDrawing=t.prepareTextRunsForBidiLayout=t.analyzeBidiText=void 0;var r=n(1),o=n(0),i=n(2);function l(e,t){var n=[d(e,0)];if(1===t.length)return n;for(var r=void 0,o=0;o<t.length;o++){if(c(t[o])){a(o,r)&&n.push(u(e,o));var i=o+1;s(i,t.length)&&n.push(d(e,i)),r=o}}return n}function a(e,t){return e>0&&!(e-1===t)}function s(e,t){return e<t}function d(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont}}function u(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont,IsSpecialCharTextRun:!0}}function c(e){return" "===e||'"'===e||"'"===e||"."===e||"?"===e||":"===e||";"===e||"-"===e||","===e||"!"===e||"("===e||")"===e}t.analyzeBidiText=function(e,t){for(var n=!1,o=!1,l=0;l<e.length;l++){var a=e[l];if((0,i.isRtlChar)(a)?n=!0:o=!0,o&&n)break}return{HasLtr:o,HasRtl:n,HasBidi:o&&n,BaseDir:function(e,t){if(!e)return"ltr";switch(t){case r.ReadingOrderType.LeftToRight:return"ltr";case r.ReadingOrderType.RightToLeft:return"rtl";case r.ReadingOrderType.Context:return(0,i.isRtlChar)(e[0])?"rtl":"ltr"}}(e,t)}},t.prepareTextRunsForBidiLayout=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=l(e[r],(0,o.getTextRunText)(r,e,t));n.push.apply(n,i)}return n},t.reorderTextRunsForBidiDrawing=function(e,t,n,r){if(!n.HasRtl||n.HasLtr){for(var l=(0,i.getReOrderDiv)(n,r),a=0;a<e.length;a++){var s=(0,o.getTextRunText)(a,e,t),d=document.createElement("span");d.innerText=s,d.setAttribute("rid",a.toString()),l.appendChild(d)}document.body.appendChild(l);for(var u=0;u<l.children.length;u++){var c=l.children[u],g=c.getAttribute("rid");if(!g)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");var f=c.getBoundingClientRect().left;e[a=parseInt(g,10)].OffsetX=f}e.sort((function(e,t){return e.OffsetX-t.OffsetX})),document.body.removeChild(l)}else e.reverse()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichValueIconRightHorizontalPadding=t.RichValueIconLeftHorizontalPadding=void 0,t.RichValueIconLeftHorizontalPadding=2,t.RichValueIconRightHorizontalPadding=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canCellContainExpandCollapseAndCFIcon=t.isPivotIntersectsRenderingRegion=t.getPivotTableLeftAdjustedForDrawing=t.getPivotTableTopAdjustedForDrawing=void 0;var r=n(1),o=n(7),i=n(0),l=n(12);function a(e,t){if(!t)return e.FirstRow;var n=e.ColumnHeaderRange;return!(0,o.isNullOrUndefined)(n)&&n.FirstColumn!==n.LastColumn&&n.FirstRow!==n.LastRow?e.ColumnHeaderRange.FirstRow:e.RowHeaderRange.FirstRow}t.getPivotTableTopAdjustedForDrawing=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"model","getPivotTableTopAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");var o=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;if((0,r.verifyArgumentNotNull)(o,"RowOffsetsAdjustedForDrawing","getPivotTableTopAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(t,"pivotTable","getPivotTableTopAdjustedForDrawing"),n&&!t.IsEmptyPivot&&0===t.DeltaYFromOriginPTAdjustedForDrawing){var l=a(t,n);return o[(0,i.getModelRowIndex)(e,l)]}return o[t.FirstRowIndex]+t.DeltaYFromOriginPTAdjustedForDrawing},t.getPivotTableLeftAdjustedForDrawing=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"model","getPivotTableLeftAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");var o=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return(0,r.verifyArgumentNotNull)(o,"ColOffsetsAdjustedForDrawing","getPivotTableLeftAdjustedForDrawing"),(0,r.verifyArgumentNotNull)(t,"pivotTable","getPivotTableLeftAdjustedForDrawing"),n||!e.IsRtl?o[t.FirstColIndex]+t.DeltaXFromOriginPTAdjustedForDrawing:o[o.length-1]-t.DeltaXFromOriginPTAdjustedForDrawing-o[t.FirstColIndex]-t.OriginPTWidthAdjustedForDrawing},t.isPivotIntersectsRenderingRegion=function(e,t,n,o){return(0,r.verifyArgumentNotNull)(e,"model","isPivotIntersectsRenderingRegion"),(0,r.verifyArgumentNotNull)(t,"pivotTable","isPivotIntersectsRenderingRegion"),(0,r.verifyArgumentNotNull)(n,"renderingRegion","isPivotIntersectsRenderingRegion"),!(t.LastRowIndex<n.startRow)&&(!((t.IsEmptyPivot?t.FirstRowIndex:(0,i.getModelRowIndex)(e,a(t,o)))>n.endRow)&&(!(t.FirstColIndex<n.startColumn)&&!(t.LastColIndex>n.endColumn)))},t.canCellContainExpandCollapseAndCFIcon=function(e,t,n){var o,i;if(!(null===(i=null===(o=e.CondFormat)||void 0===o?void 0:o.Icon)||void 0===i?void 0:i.IconOnly))return!0;var a=e.CachedFont.Size,s=(0,l.getIconHorizontalPadding)(a,n),d=(0,l.getIconSize)(a,n),u=(0,l.getExpandCollapseButtonPadding)(e)*n;switch(e.CondFormat.Icon.CFIconHorizontalAlignment){case r.HorizontalAlignment.Left:case r.HorizontalAlignment.Right:return t-d-s-u>0;case r.HorizontalAlignment.Center:return t/2-d/2-u>0;default:return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakToGraphemes=void 0;var r=n(116),o=n(164);function i(e,t){return 55296<=e&&e<=56319&&56320<=t&&t<=57343}t.breakToGraphemes=function(e){if(!e)return[];for(var t=[],n=0,l=e.charCodeAt(n),a=(0,o.classifyChar)(e.codePointAt(n)),s=r.CombiningClass.Other,d=1;d<e.length;d++){var u=e.charCodeAt(d);d>=1&&i(l,u)||(s=(0,o.classifyChar)(e.codePointAt(d)),(0,r.shouldBreak)(a,s)&&(t.push(e.substring(n,d)),n=d),a=s,l=u)}return n<=e.length-1&&t.push(e.substring(n)),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillVerticalTextForRTF=t.getVerticalTextMetadata=t.fillVerticalText=void 0;var r=n(1),o=n(9),i=n(68),l=n(41),a=n(14),s=n(117),d=n(84);function u(e,t,n,r,o,i,l,a,s,d,u,g){var h=e.textAlign;"center"!==h&&(e.textAlign="center");var C=f(t,n,r,l,o,g),m=C.graphemes,p=C.maxFontHeight;!function(e,t,n,r,o,i,l,a,s,d,u){for(var g=i,f=r.length-1;f>=0;f--){var h=r[f];" "!==h&&(e.fillText(h,o,g),c(e,t,n,o,g,h,a,s,d,u)),g-=l}}(e,t,n,m,i,C.adjustedOffsetY,p,a,s,d,u),"center"!==h&&(e.textAlign=h)}function c(e,t,n,i,s,u,c,g,f,h){g&&(0,a.shouldRenderVerticalText)(n)&&(0,l.cacheTextDecorationLayout)(t,n,c,{textPositionX:i,textPositionY:s,textWidth:(0,o.measureTextWidth)(e,u,!(0,d.isTestRun)(),(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextWidthClientPhase1,t)),clipRect:h},f)}function g(e,t,n,o,i){var l=function(e,t,n,o){var i=(0,s.getVerticalTextPadding)(t);switch(e){case r.VerticalAlignment.Top:return n+o+i;case r.VerticalAlignment.Center:return n+o/2;case r.VerticalAlignment.Bottom:default:return n-i}}(e,t,n,o);return i&&e===r.VerticalAlignment.Distributed&&i<=0?l-i:l}function f(e,t,n,r,l,a){var s,d=(0,i.breakToGraphemes)(n),u=r||(0,o.getTextLineHeight)(t,e),c=function(e,t){return(e.length-1)*t}(d,u);return{graphemes:d,maxFontHeight:u,adjustedOffsetY:g(t.CachedStyle.VerticalAlignment,(null===(s=t.CachedStyle)||void 0===s?void 0:s.Indentation)||0,l,c,a),textHeight:c}}t.fillVerticalText=function(e,t,n,r,o,i,l,a,s){u(e,t,n,r,i,o,void 0,l,!0===n.CachedFont.StrikeThrough,n.CachedFont,a,s)},t.getVerticalTextMetadata=function(e,t,n,r,o,i){var l=f(e,t,n,r,o,i);return{adjustedOffsetY:l.adjustedOffsetY,textHeight:l.textHeight}},t.fillVerticalTextForRTF=function(e,t,n,r,o,i,l,a,s,d,c,g){u(e,t,n,r,i,o,l,a,s,d,c,g)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBreakType=t.computeMaxTextWidthForWrapText=t.getSpaceWidthBetweenLines=t.getOffsetXForVerticalText=t.adjustOrderingOfLinesForVerticalText=t.drawTextLine=void 0;var r=n(1),o=n(35),i=n(31),l=n(14),a=n(69),s=n(15),d=n(6),u=n(9),c=n(12);t.drawTextLine=function(e,t,n,r,o,s,d,u,c,g,f,h,C){g?(0,i.fillRichTextFormat)(e,t,n,r,g,d,u,f,h,C):(0,l.shouldRenderVerticalText)(r)?(0,a.fillVerticalText)(e,n,r,s,d,u,t,f,c):o?e.fillText(s,d,u):e.fillText(s,d,u,c)},t.adjustOrderingOfLinesForVerticalText=function(e,t,n){var o;(null===(o=e.CachedStyle)||void 0===o?void 0:o.ReadingOrder)!==r.ReadingOrderType.RightToLeft&&n.HasLtr&&!n.HasBidi&&(t.textLines=t.textLines.reverse(),t.tokensPerLine=t.tokensPerLine.reverse())},t.getOffsetXForVerticalText=function(e,t,n,o,i,a){return function(e,t,n,o,i){switch((0,s.getEffectiveHorizontalAlignment)(e,t)){case r.HorizontalAlignment.Right:return n-o*(i-1);case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return n-o*(i-1)/2;default:case r.HorizontalAlignment.Left:return n}}(e,t,function(e,t,n,o,i){var a;if(1===i&&(0,l.isHorizontalAlignmentJustifiedOrDistributedForVerticalText)(t)){var s=(0,u.getCellTextHorizontalPadding)(t,e,n.zoom,n.devicePixelRatio);switch((null===(a=t.CachedStyle)||void 0===a?void 0:a.HorizontalAlignment)||r.HorizontalAlignment.Automatic){case r.HorizontalAlignment.Distributed:return(0,u.getCellTextCenterX)(e,t,n.zoom,n.devicePixelRatio);case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:return(0,d.getCellLeft)(e,t,e.BlockWidth)+s}}return o}(e,t,n,o,a),i,a)},t.getSpaceWidthBetweenLines=function(e,t,n,r,o){if(!(0,l.isHorizontalAlignmentJustifiedOrDistributedForVerticalText)(t)||1===r)return 0;var i=(0,c.getCellRightVisualElementsPadding)(e,t),a=n,s=(0,d.getCellRight)(e,t,e.BlockWidth)-(0,u.getCellTextHorizontalPaddingWithoutVisualElements)(e,t)-i-a-o*(r-1);return s<0?0:s/(r-1)},t.computeMaxTextWidthForWrapText=function(e,t,n,r,i){var l=n-(0,u.getWrapTextAdditionalPadding)(r,e,i);return t===o.BreakType.Distributed&&(l-=(0,u.getIndentationPaddingPx)(e.CachedStyle.Indentation||0)),l},t.getBreakType=function(e){var t;return(0,l.shouldRenderVerticalText)(e)?function(e){switch(e){case r.VerticalAlignment.Justify:return o.BreakType.Justify;case r.VerticalAlignment.Distributed:return o.BreakType.Distributed;default:return o.BreakType.Wrap}}(e.CachedStyle.VerticalAlignment):function(e){switch(e){case r.HorizontalAlignment.Justify:return o.BreakType.Justify;case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Distributed:return o.BreakType.Distributed;default:return o.BreakType.Wrap}}((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)||r.HorizontalAlignment.Automatic)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhoneticTextHeightPx=t.PhoneticRotatedTextAlign=t.PhoneticTextAlign=t.PhoneticTextDirection=t.VerticalDistancePhoneticFromTopCellPx=t.PhoneticFontSizePt=t.PhoneticFontName=void 0,t.PhoneticFontName="Yu Gothic",t.PhoneticFontSizePt=6,t.VerticalDistancePhoneticFromTopCellPx=7,t.PhoneticTextDirection="ltr",t.PhoneticTextAlign="start",t.PhoneticRotatedTextAlign="left",t.PhoneticTextHeightPx=14},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawCircle=t.drawCircleIcon=void 0;var r=n(0),o=n(5),i=n(20),l=n(28),a=n(178),s=n(19);function d(e,t,n,o){var d=t.image,g=t.highContrastScheme,f=function(e){var t=e.left,n=e.bottom,r=e.size/2,o=r-s.ShapeOutlineWidthPx,i=Math.round(t+r),l=Math.round(n-r);return{centerX:i,centerY:l,innerRadius:o,outlineRadius:r}}(t),h=f.outlineRadius;h<=0||(u(e,f.centerX,f.centerY,h,i.Circle0Deg,i.Circle360Deg,n),o&&f.innerRadius>0&&function(e,t,n,o,s){var d=t.centerX,g=t.centerY,f=t.innerRadius;if(s)!function(e,t,n,o){var l=t.centerX,s=t.centerY,d=t.innerRadius,g=(0,a.getHighContrastFillingType)(o),f=(0,r.rgbToColorHex)(n.BackgroundColor),h=(0,r.rgbToColorHex)(n.TextColor);switch(g){case a.FillType.Full:break;case a.FillType.FillPortion:var C=c(o);u(e,l,s,d,C,i.Circle270Deg,f);break;case a.FillType.Empty:u(e,l,s,d,i.Circle0Deg,i.Circle360Deg,f);break;case a.FillType.InnerCircle:u(e,l,s,d,i.Circle0Deg,i.Circle360Deg,f);var m=(0,a.getInnerCircleRadius)(o,d);u(e,l,s,m,i.Circle0Deg,i.Circle360Deg,h);break;case a.FillType.Stripes:u(e,l,s,d,i.Circle0Deg,i.Circle360Deg,f),(0,a.drawStripes)(e,l,s,d,h);break;default:throw Error("circle-fillHighContrastCircle: unsupported filling type")}}(e,t,s,o);else switch(o){case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:var h=c(o);u(e,d,g,f,i.Circle270Deg,h,n),u(e,d,g,f,h,i.Circle270Deg,l.CircleEmptyInnerColor);break;default:u(e,d,g,f,i.Circle0Deg,i.Circle360Deg,n)}}(e,f,o,d,g))}function u(e,t,n,r,o,i,l){e.fillStyle=l,e.beginPath(),e.moveTo(t,n),e.arc(t,n,r,o,i),e.fill()}function c(e){switch(e){case i.CFIconImage.Circle25:return i.Circle0Deg;case i.CFIconImage.CircleHalf:return i.Circle90Deg;case i.CFIconImage.Circle75:return i.Circle180Deg;default:throw Error("getFillAngle: image: ".concat(e," not supported"))}}t.drawCircleIcon=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawCircleIcon"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawCircleIcon");var n=t.image,a=t.highContrastScheme;d(e,t,function(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return l.CircleHighOuterColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return l.CircleMediumOuterColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return l.CircleLowOuterColor;case i.CFIconImage.CircleEmpty:return l.CircleEmptyOuterColor;case i.CFIconImage.CircleFilled:case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return l.CircleFilledOuterColor;case i.CFIconImage.FourCircleHigh:return l.FourCircleHighOuterColor;case i.CFIconImage.FourCircleLow:return l.FourCircleLowOuterColor;case i.CFIconImage.FourCircleMedium1:return l.FourCircleMedium1OuterColor;case i.CFIconImage.FourCircleMedium2:return l.FourCircleMedium2OuterColor;default:throw Error("getCircleOutlineColor: unsupported image type = ".concat(e))}}(n,a),function(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return l.CircleHighInnerColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return l.CircleMediumInnerColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return l.CircleLowInnerColor;case i.CFIconImage.CircleEmpty:return l.CircleEmptyInnerColor;case i.CFIconImage.CircleFilled:return l.CircleFilledInnerColor;case i.CFIconImage.FourCircleHigh:return l.FourCircleHighInnerColor;case i.CFIconImage.FourCircleLow:return;case i.CFIconImage.FourCircleMedium1:return l.FourCircleMedium1InnerColor;case i.CFIconImage.FourCircleMedium2:return l.FourCircleMedium2InnerColor;case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return l.CircleFilledInnerColor;default:throw Error("getCircleInnerColor: unsupported image type = ".concat(e))}}(n,a))},t.drawCircle=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateClosestNonEmptyCellsSpill=t.updateCellSpill=void 0;var r=n(1),o=n(15),i=n(21),l=n(90),a=n(14),s=n(0),d=n(10),u=n(5),c=n(12),g=n(9);function f(e,t,n,o,c){if((0,u.verifyArgumentNotNull)(n,"cell","spillCell.updateCellSpill"),(0,u.verifyArgumentNotNull)(t,"model","spillCell.updateCellSpill"),!(!n.Text||n.WrapText||n.Merge||(0,d.cellHasShrinkToFit)(n)||n.ValueType===r.CellValueType.Number||(0,a.shouldRenderVerticalText)(n))){(0,s.verifyCellStyleAndFont)(t,n,"updateCellSpill");var f=(0,i.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont);e.font=(0,d.getFontCssStringFromCell)(n,t);var C=(0,g.getTextWidth)(e,t,n);if(f){var y=(0,g.getTextLineHeight)(n,t);C=(0,l.getRotatedTextWidth)(t,C,y,n.CachedStyle),n.Spill=void 0}var v=h(n,t,C,r.SpillDirection.End,f,o,c),S=h(n,t,C,r.SpillDirection.Start,f,o,c),R=v.isSpillingOutsideOfBlock||S.isSpillingOutsideOfBlock,F=v.isBlockedByCellContent||S.isBlockedByCellContent;if(0!==v.spilledOverCellsCount||0!==S.spilledOverCellsCount){var w=m(n,t,r.SpillDirection.Start,f),T=m(n,t,r.SpillDirection.End,f),I=p(w,n,t,r.SpillDirection.Start),x=p(T,n,t,r.SpillDirection.End);n.Spill={SpanToStart:Math.min(S.spilledOverCellsCount,I),SpanToEnd:Math.min(v.spilledOverCellsCount,x),IsSpillBlocked:R||S.spilledOverCellsCount>I||v.spilledOverCellsCount>x,IsSpillingOutsideOfBlock:R}}else(R||F)&&(n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0,IsSpillingOutsideOfBlock:R})}}function h(e,t,n,i,l,a,d){var f=(0,r.getCellStyle)(t,e);(0,u.verifyArgumentNotNull)(f,"cell.CachedStyle","spillCell.getNumberOfSpilledOverCells");var h=f.HorizontalAlignment||r.HorizontalAlignment.Automatic,m=!!l||R(e,h,t.IsRtl);return m?function(e,t,n,i,l,a,d){var u=e.Col,f=function(e,t,n,i,l,a,d){var u=(0,s.getColumnWidth)(t.Col,e),f=function(e,t){var n;if(!(null===(n=t.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator))return!1;var i=(0,o.getEffectiveHorizontalAlignment)(e,t);return!(0,g.doesExpandCollapseButtonShiftText)(e,t)||i===r.HorizontalAlignment.Center}(e,t)?(0,c.getExpandCollapseButtonPadding)(t):0,h=(0,g.getCellTextHorizontalPadding)(t,e,a,d)+n+f-u;if(h<=0)return 0;if(i===r.HorizontalAlignment.Center)return h/2;var C=e.IsRtl;if(!S(i,l,C))return 0;return h}(t,e,n,i,l,a,d),h=0,m=!1;if(0===f)return{spilledOverCellsCount:h,isSpillingOutsideOfBlock:m,isBlockedByCellContent:!1};var p=t.ColumnNumbers.length;u+=l;for(;C(u,p)&&f>0;)h++,f-=(0,s.getColumnWidth)(u,t),u+=l;return m=!C(u,p)&&f>0,{spilledOverCellsCount:h,isSpillingOutsideOfBlock:m,isBlockedByCellContent:!1}}(e,t,n,h,i,a,d):{spilledOverCellsCount:0,isSpillingOutsideOfBlock:!1,isBlockedByCellContent:!m}}function C(e,t){return e>=0&&e<t}function m(e,t,n,o){for(var i=e.Row,l=e.Col+n;!o&&C(l,t.ColumnNumbers.length);){var a=(0,r.getCell)(i,l,t);if(a&&y(a))return a;l+=n}return null}function p(e,t,n,o){return e?Math.abs(e.Col-t.Col)-1:o===r.SpillDirection.End?n.ColumnNumbers.length-t.Col:t.Col}function y(e){var t;return!!e&&(!!e.Text||!!(null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula)||!!e.PreviewText)}function v(e,t,n,o,i,l,a){var d=p(t,n,o,i);if(t&&t.Spill){var c=(0,r.getCellStyle)(o,t);(0,u.verifyArgumentNotNull)(c,"blockingCellStyle","spillCell.updateClosestNonEmptyCell");var g=c.HorizontalAlignment||r.HorizontalAlignment.Automatic,h=-i,C=R(t,g,o.IsRtl),m=S(g,h,o.IsRtl);if(C&&m)if(n&&n.Text&&""!==n.Text){var y=(0,r.getSpilledOverCount)(h,t);t.Spill.IsSpillBlocked=d<=y;var v=Math.min(y,d);v!==y&&((0,s.setCellAndSpannedOverCellsDirty)(o,t),h===r.SpillDirection.Start?t.Spill.SpanToStart=v:t.Spill.SpanToEnd=v)}else{n.Spill=void 0;var F=(0,r.getSpilledOverCount)(h,t);f(e,o,t,l,a),F!==(0,r.getSpilledOverCount)(h,t)&&(0,s.setCellAndSpannedOverCellsDirty)(o,t)}}return d}function S(e,t,n){return e===r.HorizontalAlignment.Center||(t===r.SpillDirection.Start?n?e===r.HorizontalAlignment.Left:e===r.HorizontalAlignment.Right:t===r.SpillDirection.End&&(e===r.HorizontalAlignment.Automatic||(n?e===r.HorizontalAlignment.Right:e===r.HorizontalAlignment.Left)))}function R(e,t,n){return!e.RichValueIcon||(t===r.HorizontalAlignment.Left||!n&&t===r.HorizontalAlignment.Automatic)}t.updateCellSpill=f,t.updateClosestNonEmptyCellsSpill=function(e,t,n,o,l){var a=(0,i.shouldDrawRotatedText)(n,t.CachedStyle,t.CachedFont),s=m(t,n,r.SpillDirection.Start,a),d=m(t,n,r.SpillDirection.End,a);v(e,s,t,n,r.SpillDirection.Start,o,l),v(e,d,t,n,r.SpillDirection.End,o,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetColWidthCacheByCol=t.resetCache=t.setColMetadata=t.getColSrvDx=t.removeColMetadata=t.getColMetadata=void 0;var r={};t.getColMetadata=function(e){return r[e]},t.removeColMetadata=function(e){r[e]=void 0},t.getColSrvDx=function(e){var t=r[e];return t?t.SrvDx:-1},t.setColMetadata=function(e,t){r[e]=t},t.resetCache=function(){r={}},t.resetColWidthCacheByCol=function(e){r[e]=void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderDrawingsWhiteColor=t.HeaderDrawingsGreenColor=t.RowHeaderDragAndInsertHitRegionWidth=t.MaxRowValue=t.MaxColValue=t.MaxCellPixelsAllocatedToUnhideZone=t.OverlappingUnhideZonePercentage=t.MinCellPixelsAllocatedToResizeZone=t.MaxCellPixelsAllocatedToResizeZone=t.CellPercentageAllocatedToResizeZone=void 0,t.CellPercentageAllocatedToResizeZone=.1,t.MaxCellPixelsAllocatedToResizeZone=5,t.MinCellPixelsAllocatedToResizeZone=0,t.OverlappingUnhideZonePercentage=.5,t.MaxCellPixelsAllocatedToUnhideZone=12,t.MaxColValue=16384,t.MaxRowValue=1048576,t.RowHeaderDragAndInsertHitRegionWidth=17,t.HeaderDrawingsGreenColor="#107C41",t.HeaderDrawingsWhiteColor="#ffffff"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldTextBeClipped=t.getCurrentTimeInMs=t.calculateExecutionsPerSecond=void 0;var r=n(1),o=n(15);function i(){return Date.now()}t.calculateExecutionsPerSecond=function(e,t){for(var n=i(),r=0;i()-n<t;)e(r),r++;return r*(1e3/t)},t.getCurrentTimeInMs=i,t.shouldTextBeClipped=function(e,t){var n,i,l,a;return t.CachedStyle||(0,r.getCellStyle)(e,t),t.TextRuns||t.Spill||t.Merge||t.DisplayFormula||t.PreviewText||(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)||t.WrapText||(0,o.isHorizontalAlignmentCenteredAcrossSelection)(t)||(null===(i=t.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)===r.HorizontalAlignment.Fill||(null===(l=t.CachedStyle)||void 0===l?void 0:l.ShrinkToFit)||((null===(a=t.CachedStyle)||void 0===a?void 0:a.Indentation)||0)>0}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogSamplingPercentage=t.CellLookupColumnMod=t.MaxAllowedRowColCount=t.CellLookupRowShift=t.MaxBitsPerRenderFlag=void 0,t.MaxBitsPerRenderFlag=32,t.CellLookupRowShift=5,t.MaxAllowedRowColCount=32,t.CellLookupColumnMod=1<<t.CellLookupRowShift,t.LogSamplingPercentage=.01},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var r={};function o(){return void 0===globalThis.__get_feature_gate_dictionary_variable?r:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var n;return null!==(n=o()[e])&&void 0!==n?n:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var n,r=null===(n=i(e))||void 0===n?void 0:n.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){var n,r=null===(n=i(e))||void 0===n?void 0:n.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;var o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var n,r=null===(n=i(e))||void 0===n?void 0:n.trim();if(void 0===r)return t;var o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,n){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){var t;return null===(t=r()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(77),i=function(){function e(){this.correlationId=""}return e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.prototype.getLogMessage=function(t,n,r){var i="tag_".concat(e.tagIntToString(t)," [").concat(o.a[n],"] ").concat(r);return this.correlationId&&""!==this.correlationId&&(i+="\t\t".concat(this.correlationId)),i},e.prototype.sendTraceTag=function(e,t,n,o){var i=this.logMessage;switch(n){case r.a.Error:i=this.logError;break;case r.a.Warning:i=this.logWarning;break;case r.a.Info:i=this.logInfo;break;case r.a.Verbose:i=this.logVerbose;break;case r.a.Spam:default:i=this.logMessage}try{i(this.getLogMessage(e,t,o))}catch(e){var l="undefined"!=typeof navigator?navigator:void 0;if(l&&!/rv:11.0/i.test(l.userAgent))throw e}},e.prototype.shipAssertTag=function(e,t,n,r){console.assert(n,this.getLogMessage(e,t,r))},e.prototype.debugAssertTag=function(e,t,n,r){this.shipAssertTag(e,t,n,r)},e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789",e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.approximateValue=void 0;var r=n(40);t.approximateValue=function(e,t){var n=Math.round(e);if(n<r.MinAllowedFontSize&&e>0&&(n=r.MinAllowedFontSize),n>r.MaxAllowedFontSize&&(n=r.MaxAllowedFontSize),n<0)throw Error("TextLayout.approximateValue: ".concat(n," in Excel must be between 1pt and 409pt"));var o=t[n];if(o)return o;for(var i=n;i>r.MinAllowedFontSize&&!t[i];)i--;for(var l=n;l<r.MaxAllowedFontSize&&!t[l];)l++;return o=function(e,t,n,r,o){var i=(n-r)/(o-r)*(e-t);return Math.round(t+i)}(t[l],t[i],n,i,l),t[n]=o,o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconHorizontalPadding=t.FontSizeToIconSize=t.CalibriTextDecorationLineWidth=t.CalibriRegularPadding=t.CalibriItalicPadding=void 0,t.CalibriItalicPadding={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},t.CalibriRegularPadding={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},t.CalibriTextDecorationLineWidth={1:0,2:0,3:0,4:0,5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},t.FontSizeToIconSize={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},t.IconHorizontalPadding={1:0,3:0,4:0,5:1,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTestRun=void 0,t.isTestRun=function(){return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStartOffset=t.getTextRun=t.reorderTextTokens=t.prepareTextRunsForJustifyAndDistributed=t.getSpaceWidthBetweenWords=t.getJustifyDistributedLine=void 0;var r=n(7),o=n(35),i=n(3),l=n(1),a=n(9),s=n(65),d=n(165),u=n(13);function c(e,t,n,l){if(void 0===l&&(l=0),e.isProcessingLastLine&&e.breakType===o.BreakType.Justify){var a=function(e,t,n){void 0===n&&(n=0);for(var r="",o=0,l=0;l<e.length;l++)r+=e[l].text,o+=e[l].width,l!==e.length-1&&(r+=i.Whitespace,o+=t);return{Start:{Offset:n,Text:r,Width:o},SpaceWidthBetweenWords:t}}(t,e.singleSpaceWidth,l);return e.lineDirection===o.LineDirection.Vertical&&(a.Start.Offset=e.maxWidth-a.Start.Width),a}if(e.lineDirection===o.LineDirection.Vertical&&function(e){if(e.length>=2){var t=e[0];e[0]=e[e.length-1],e[e.length-1]=t}}(t),t.length>0){var s=l,d=0,c=t[d],g=(a={Start:{Offset:s,Text:c.text,Width:c.width},SpaceWidthBetweenWords:n},Math.floor(n/e.singleSpaceWidth));g<1&&(g=1);var f=function(e,t,n,r){if(e.lineDirection===o.LineDirection.Vertical&&r>3)return n-t*e.singleSpaceWidth>=0?Math.floor((n-t*e.singleSpaceWidth)*(r-3)/2):0;return 0}(e,g,n,t.length);s+=c.width+n+f,d++,(void 0===g||isNaN(g)||g===1/0)&&((0,u.setRenderingResultInfo)("getJustifyDistributedLine: Invalid count variable. numberOfSpaces: ".concat(g,", spaceWidthBetweenTokens: ").concat(n,", singleSpaceWidth: ").concat(e.singleSpaceWidth," ")),g=1);for(var h="",C=s,m=0;d<t.length-1;d++)h+=(c=t[d]).text,m+=c.width,d!==t.length-2&&(h+=i.Whitespace.repeat(g),m+=e.singleSpaceWidth*g);if(""!==h&&(a.Middle={Offset:C,Text:h,Width:m}),t.length>1){var p=t[t.length-1],y=(0,r.isNullOrUndefined)(a.Middle)?s:C+m+n+f;a.End={Offset:y,Text:p.text,Width:p.width}}return a}}function g(e,t){var n=e;if(n.length<=1)return 0;if(t.breakType===o.BreakType.Justify&&t.isProcessingLastLine)return t.singleSpaceWidth;for(var r=0,i=0;i<n.length;i++){r+=n[i].width}var l=(t.maxWidth-r)/(n.length-1);return l<t.singleSpaceWidth?t.singleSpaceWidth:l}function f(e,t,n){return e?t[t.length-1-n]:t[n]}function h(e,t){return e.isProcessingLastLine&&e.breakType===o.BreakType.Distributed&&1===t.length&&e.isCompleteTextVisible?(e.maxWidth-t[0].width)/2:0}function C(e,t,n,r,o,i,l){for(var a=[],s=0,d=!1,u=0;u<n.length;u++){var c=n[u];if(p(c,r,o))if(y(c,r,o))a.push(c),s+=c.width;else{var g=v(e,t,c,r,o,i,l);d=i?d||!c.text.startsWith(g.text):S(c.text)?!c.text.startsWith(g.text):!c.text.endsWith(g.text),a.push(g),s+=g.width}}return{currentTextTokens:a,currentTokenWidthPx:s,combinePartialTokens:d}}function m(e){if(e.Start&&e.End){var t={Start:{Offset:e.Start.Offset,Text:e.End.Text,Width:e.End.Width},SpaceWidthBetweenWords:e.SpaceWidthBetweenWords},n=t.Start.Offset;return e.Middle&&(t.Middle=e.Middle,n=t.Start.Offset+t.Start.Width+t.SpaceWidthBetweenWords,t.Middle.Offset=n,t.Middle.Text=e.Middle.Text.split(" ").reverse().join(" "),n=t.Middle.Offset+t.Middle.Width),t.End={Text:e.Start.Text,Width:e.Start.Width,Offset:n+t.SpaceWidthBetweenWords},t}return e}function p(e,t,n){return e.start<n&&e.start+e.text.length>t}function y(e,t,n){return t<=e.start&&e.start+e.text.length<=n}function v(e,t,n,r,o,i,s){var d=n.start<r?r-n.start:0,u=d+o-(r>n.start?r:n.start),c=n.text.substring(d,u);return{text:c,start:n.start>r?n.start:r,width:i?(0,a.measureTextHeightForVerticalText)(s,c):(0,a.measureTextWidth)(e,c,!0,(0,l.isRenderFlagEnabled)(l.RenderFlagsArray.TextWidthClientPhase1,t)),containsThaiCharacters:n.containsThaiCharacters}}function S(e){return!!e&&(0,s.analyzeBidiText)(e,l.ReadingOrderType.LeftToRight).HasRtl}function R(e){return{singleSpaceWidth:e.singleSpaceWidth,breakType:e.breakType,isCompleteTextVisible:e.isCompleteTextVisible,isProcessingLastLine:e.isProcessingLastLine,maxWidth:e.maxWidth,lineDirection:e.lineDirection}}function F(e,t,n){return e===o.LineDirection.Vertical?n:t.measureText(" ").width}t.getJustifyDistributedLine=c,t.getSpaceWidthBetweenWords=g,t.prepareTextRunsForJustifyAndDistributed=function(e,t,n,l,a,s){if(0===a.length)throw Error("prepareTextRunsForJustifyAndDistributed: At least one textRun expected");if(0!==l.length){s&&(n.maxWidth=n.maxWidth-2*i.GridLineWidthPx);var d=h(n,l);if(1===a.length){var u=e.font,p=u,y=a[0],v=y.FontCss;p!==v&&(e.font=v,p=v);var w=R(n);w.singleSpaceWidth=F(n.lineDirection,e,y.MaxGlyphHeightPx);var T=c(w,l,g(l,n),d);s||!S(y.Text)||(0,r.isNullOrUndefined)(T)||(T=m(T)),y.JustifyDistributedLine=T,y.WidthPx=function(e,t){var n=0;if(t&&e.breakType===o.BreakType.Justify)return n+=null==t?void 0:t.Start.Width,(null==t?void 0:t.Middle)&&(n+=null==t?void 0:t.Middle.Width),(null==t?void 0:t.End)&&(n+=null==t?void 0:t.End.Width),n;return e.maxWidth}(n,T),p!==u&&(e.font=u)}else!function(e,t,n,i,l,a,s){void 0===s&&(s=0);for(var d=g(n,i),u=function(e){for(var t=e[0].start,n=1;n<e.length;n++)e[n].start<t&&(t=e[n].start);return t}(n),h=e.font,p=h,y=s,v=0;v<l.length;v++){var w=f(a,l,v),T=w.FontCss;p!==T&&(e.font=T,p=T);var I=R(i);I.singleSpaceWidth=F(i.lineDirection,e,w.MaxGlyphHeightPx);var x=w.StartIndex+u,b=x+(void 0!==w.Text?w.Text.length:0),D=C(e,t,n,x,b,a,w.MaxGlyphHeightPx),A=D.currentTextTokens,P=D.currentTokenWidthPx,H=D.combinePartialTokens;if(0!==A.length){var B=c(I,A,d,y);a||(0,r.isNullOrUndefined)(B)||S(w.Text)&&(B=m(B)),w.JustifyDistributedLine=B,a&&i.lineDirection===o.LineDirection.Vertical?w.HeightPx=P+d*(A.length-1):w.WidthPx=P+d*(A.length-1),H||w.IsSpecialCharTextRun?y+=P+d*(A.length-1):y+=P+d*A.length}}p!==h&&(e.font=h)}(e,t,l,n,a,s,d)}},t.reorderTextTokens=function(e,t,n,r){if(!n.HasRtl||n.HasLtr)(0,d.reorderTextTokensUsingDom)(e,t,n,r);else for(var o=0;o<e.tokensPerLine.length;o++)e.tokensPerLine[o].tokens.reverse()},t.getTextRun=f,t.getStartOffset=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testCombineThaiTokensPerLine=t.breakTextToLines=void 0;var r=n(4),o=n(5),i=n(167),l=n(168),a=n(3),s=n(1),d=n(31),u=n(35),c=n(9),g=n(14),f=n(0);function h(e,t){(e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth)&&(P(e,t.width),e.curLineStart=t.start,e.curLineWidth=t.width);e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(t),e.lastFittingToken=t}function C(e,t,n,r,o,a){if(t.type!==i.BreakOpTokenType.Space){void 0!==e.lastFittingToken&&(e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(e.lastFittingToken),P(e));for(var s=a?(0,d.substringFormattedText)(a,t.start,t.start+t.len):void 0,u=e.isVerticalText?(0,l.breakWideWordVerticalText)(t.value,e.maxWidth,e.textLineHeight):(0,l.breakWideWord)(r,t.value,e.maxWidth,o,s),c=t.start,g=0;g<u.length-1;g++){var h=u[g],C={text:h.value,width:h.size,underlineWidth:h.size,startIndex:c,endIndex:c+h.value.length};if(c+=h.value.length,e.textLines.push(C),e.isBreakTypeJustifyOrDistributed){var m=(0,f.doesTextContainThaiCharacter)(h.value);e.tokensPerLine.push({tokens:[{text:h.value,width:h.size,start:c,containsThaiCharacters:m}],containsThaiCharacters:m}),B(e,m)}e.isSingleCharTooWide=x(C.width,C.text.length,e.maxWidth,e.isSingleCharTooWide)}var p,y,S,R,F,w=(y=t,S=(p=u)[p.length-1],R=y.start+y.len-S.value.length,F=S.size,{start:R,len:S.value.length,value:S.value,type:i.BreakOpTokenType.Word,width:F});e.lastFittingToken=w,e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(w),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}else v(e,t,n)}function m(e,t,n){void 0!==e.lastFittingToken&&P(e);var r=function(e){switch(e.type){case i.BreakOpTokenType.HardBreak:return e.len;case i.BreakOpTokenType.HardBreakCRLF:return e.len/2;default:throw"breakToLines - this token should be hardBreak token"}}(t);0!==n&&n!==e.tokens.length-1&&r--;for(var o=0;o<r;o++)e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(a.EmptyLineTextToken),e.textLines.push(p(o,t));e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function p(e,t){var n=t.start+e;return{text:"",width:0,underlineWidth:0,startIndex:n,endIndex:n+function(e){return e.type===i.BreakOpTokenType.HardBreakCRLF?a.HardBreakCRLF.length:a.HardBreak.length}(t)}}function y(e,t,n){if(D(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,n){if(I(e.tokens,n),!F(e,n))return!1;return n===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||T(e,t,n)}(e,t,n)?e.curLineWidth+t.width>e.maxWidth||T(e,t,n)?v(e,t,n):(e.curLineWidth+=t.width,e.lastFittingToken=t):w(e,t)}function v(e,t,n){D(t);var r=t.width/t.len,o=e.maxWidth-e.curLineWidth;if(!(o<0)){var i=Math.floor(o/r);t.width=r*i,e.curLineWidth+=t.width,e.lastFittingToken=t,(R(e.tokens,n)||F(e,n))&&w(e,t)}}function S(e,t){if(I(e,t),!e[t])throw"breakTextToLines - validateToken - tokens[index] is undefined"}function R(e,t){return I(e,t),S(e,t),0===t&&e[t].type===i.BreakOpTokenType.Space}function F(e,t){var n=e.tokens;return I(n,t),t>0&&n[t].type===i.BreakOpTokenType.Space&&A(n[t-1])&&void 0===e.lastFittingToken}function w(e,t){if(t.type!==i.BreakOpTokenType.Space)throw"breakTextToLines - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";var n=r.__assign({},a.EmptyLine),o=t.start+t.len;n.underlineWidth=t.width,n.startIndex=t.start,n.endIndex=o,e.textLines.push(n),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(a.EmptyLineTextToken),e.curLineStart=o,e.curLineWidth=0,e.lastFittingToken=void 0}function T(e,t,n){if(D(t),n>=e.tokens.length-1)return!1;var r=e.tokens[n+1];return e.curLineWidth+t.width+r.width>e.maxWidth}function I(e,t){if(t<0||t>=e.length)throw"breakTextToLines - invalid token index"}function x(e,t,n,r){if(r)return!0;if(e>n){if(1!==t)throw"breakTextToLines - non single char line is too wide!";return!0}return r}function b(e,t){return e.width<t}function D(e){if(e.type!==i.BreakOpTokenType.Space)throw"breakTextToLines - wrong token type, expected spaces token!"}function A(e){return e.type===i.BreakOpTokenType.HardBreak||e.type===i.BreakOpTokenType.HardBreakCRLF}function P(e,t){void 0===t&&(t=0),(0,o.verifyArgumentNotNull)(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");var n=e.curLineWidth-t,r=n;if(e.lastFittingToken.type===i.BreakOpTokenType.Space&&(r-=e.lastFittingToken.width),e.isBreakTypeJustifyOrDistributed){var l=function(e){for(var t=[],n=!1,r=0;r<e.length;r++){var o=e[r],i=(0,f.doesTextContainThaiCharacter)(o.value);t.push({text:o.value,width:o.width,start:o.start,containsThaiCharacters:i}),i&&!n&&(n=!0)}return{tokens:t,containsThaiCharacters:n}}(e.unprocessedTokens);e.tokensPerLine.push(l),B(e,l.containsThaiCharacters),e.unprocessedTokens=[]}var a=function(e){if(void 0===e.lastFittingToken)throw"breakTextToLines -invalid lastFittingToken - no token was set";var t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e),s=a.text,d=a.start,u=a.end;e.textLines.push({text:s,underlineWidth:n,width:r,startIndex:d,endIndex:u})}function H(e){for(var t,n,r={tokens:[],containsThaiCharacters:!0},o=void 0,i=0;i<e.length;i++){var l=e[i];(0,f.doesTextContainThaiCharacter)(l.text)?o?(n=l,o={text:(t=o).text+n.text,width:t.width+n.width,start:t.start,containsThaiCharacters:t.containsThaiCharacters||n.containsThaiCharacters}):o=l:(o&&(r.tokens.push(o),o=void 0),r.tokens.push(l))}return o&&r.tokens.push(o),r}function B(e,t){!e.containsThaiCharacters&&t&&(e.containsThaiCharacters=!0)}t.breakTextToLines=function(e,t,n,r,l,a,d,f,p){if((0,o.verifyArgumentNotNull)(e,"canvas2dCtx","breakTextToLines"),""===t)return{textLines:[],tokensPerLine:[],requireClipping:!1};for(var v,F=(0,g.shouldRenderVerticalText)(d),w=F?(0,c.getTextLineHeight)(d,a):0,T=(0,i.tokenizeTextToWrap)(e,t,l,a,F,w,f,p),I={text:t,tokens:T,maxWidth:n,unprocessedTokens:[],isSingleCharTooWide:!1,textLines:[],tokensPerLine:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0,isBreakTypeJustifyOrDistributed:(v=r,v===u.BreakType.Justify||v===u.BreakType.Distributed),containsThaiCharacters:!1,isVerticalText:F,textLineHeight:w},D=0;D<T.length;D++){var B=T[D];if(S(T,D),A(B))m(I,B,D);else if(b(B,n)){if(B.type===i.BreakOpTokenType.Space&&!R(T,D)){y(I,B,D);continue}h(I,B)}else C(I,B,D,e,a,f)}if(void 0!==I.lastFittingToken&&function(e){P(e),e.isSingleCharTooWide=x(e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(I),I.isBreakTypeJustifyOrDistributed&&I.textLines.length!==I.tokensPerLine.length)throw new Error("breakTextToLines::breakTextToLines Mismatch in textLines and textTokenLines.\n      textTokenLines = ".concat(I.tokensPerLine.length,", textLineLength = ").concat(I.textLines.length,", MaxWidth = ").concat(n,", Text = ").concat((0,s.annonymize)(I.text)));return I.isBreakTypeJustifyOrDistributed&&(null==p?void 0:p.BreakOp)&&I.containsThaiCharacters&&(I.tokensPerLine=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.containsThaiCharacters?t.push(H(r.tokens)):t.push(r)}return t}(I.tokensPerLine)),{textLines:I.textLines,tokensPerLine:I.tokensPerLine,requireClipping:I.isSingleCharTooWide}},t.testCombineThaiTokensPerLine=function(e){return H(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateContextForPhonetic=t.drawPhoneticText=t.drawCellsPhoneticText=void 0;var r=n(9),o=n(21),i=n(0),l=n(10),a=n(5),s=n(6),d=n(58),u=n(2),c=n(71),g=n(88),f=n(89),h=n(31),C=n(14),m=n(13),p=n(3);function y(e,t,n,o,i,l){var a;if(n.PhonInfo&&n.PhonInfo.Text){if(function(e){return e.TextRuns||e.WrapText||(0,C.shouldRenderVerticalText)(e)}(n)||n.PhonInfo&&!n.PhonInfo.PhoneticTextRuns){var s=l;s||(n.TextRuns?(e.save(),s=(0,r.getTextWidth)(e,t,n),e.restore()):s=(0,r.getTextWidth)(e,t,n));var d=S(t,n,s,i),u=(0,f.getNoControlPhoneticText)(n.PhonInfo,n.Text);return e.fillText(u,d,o),void(0,m.setRenderingResultMonitorable)("drawPhoneticText: Row:"+n.Row.toString()+" Col:"+n.Col.toString())}var c=(0,f.getPhoneticTextRunsForRendering)(n),g=c.phoneticTextRuns,h=c.textRuns;e.save();var p=(0,r.measureTextRunsWidth)(e,h,n.Text,t,void 0);e.restore();for(var y=S(t,n,p.totalSize,i),v=0;v<g.length;v++){var R=g[v];if(p.textRunsDrawingInformation[v]){if(0!==R.PhoneticLength){var F=n.PhonInfo.Text.substr(R.PhoneticStartIndex,R.PhoneticLength);e.fillText(F,y,o)}y+=null!==(a=p.textRunsDrawingInformation[v].WidthPx)&&void 0!==a?a:0}}}}function v(e,t,n){var r=(0,l.getCellFontWeightStyle)(!1,!1);e.font=(0,l.getFontCssString)(t,r,c.PhoneticFontSizePt,c.PhoneticFontName);var o=(0,d.getDefaultContextState)(n,t.IsRtl);e.fillStyle=o.fontColor,e.direction=c.PhoneticTextDirection,e.textAlign=c.PhoneticTextAlign}function S(e,t,n,i){if((0,o.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont))return t.CachedDrawingLayout.TextOrientationLayout.Angle>0?-n:0;if((0,C.shouldRenderVerticalText)(t)||t.WrapText){var l=(0,r.getCellTextHorizontalPadding)(t,e,i.zoom,i.devicePixelRatio);return(0,s.getCellLeft)(e,t,e.BlockWidth)+l}var a=(0,r.getTextHorizontalPosition)(e,t,i);return(0,h.getAdjustedOffsetXforHorizontalAlignment)(e,t,a,!1,n,void 0)}function R(e,t){return!!t&&(!!(0,u.cellIntersectsRenderingRegion)(t,e.renderingRegion)&&(!(0,g.shouldDrawWrapText)(t)&&(!(0,i.isCellPreviewTextDefined)(t.PreviewText)&&(!t.ShowSkeleton&&(!!t.Text&&!!t.PhonInfo&&t.PhonInfo.Text!==p.EmptyString)))))}function F(e,t,n,i){var l=(0,f.getPhoneticTextVerticalPosition)(t,i),a=function(e,t,n,o){var i=(0,g.shouldDrawSpillCell)(t),l=(0,g.shouldDrawWrapText)(t),a=(0,s.getCellWidth)(e,t,!0),d=(0,s.getCellHeight)(e,t,!0),u=(0,s.getCellTop)(e,t),c=(0,r.getDistanceFromCellStartToIconEnd)(e,t,n,o);return(0,g.getCellClippingForPhonetic)(e,t,l,i,a,d,c,u)}(t,i,n.zoom,n.devicePixelRatio);(0,u.applyClipping)(e,a),function(e,t,n){if((0,o.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)){var r=n.CachedDrawingLayout.TextOrientationLayout;(0,o.applyRotation)(e,r.TranslateX,r.TranslateY,r.Angle),e.textAlign=c.PhoneticRotatedTextAlign}}(e,t,i),y(e,t,i,l,n),function(e,t,n){(0,o.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)&&(e.restore(),e.textAlign=c.PhoneticTextAlign)}(e,t,i),(0,u.restoreClipping)(e,a)}t.drawCellsPhoneticText=function(e,t,n){(0,a.verifyArgumentNotNull)(e,"ctx","drawCellsPhoneticText"),(0,a.verifyArgumentNotNull)(t,"model","drawCellsPhoneticText"),(0,a.verifyArgumentNotNull)(n,"context","drawCellsPhoneticText"),(0,a.verifyArgumentNotNull)(t.Cells,"model.Cells","drawCellsPhoneticText");var r=t.ClientOnlyCache.CellsToRender,o=!1;v(e,t,n.highContrastScheme);for(var i=0;i<r.length;i++){var l=r[i];if(R(n,l))try{F(e,t,n,l),o=!0}catch(e){throw(0,m.setRenderingResultMonitorable)("Error drawSingleCellPhoneticText: "+e),e}}o&&(0,m.setRenderingResultMonitorable)("drawCellsPhoneticText: Phonetic rendered")},t.drawPhoneticText=y,t.updateContextForPhonetic=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDrawWrapText=t.shouldDrawSpillCell=t.getCellClippingForPhonetic=t.shouldClipText=t.getCellClipping=void 0;var r=n(1),o=n(6),i=n(12),l=n(9),a=n(47),s=n(15),d=n(2),u=n(118),c=n(14),g=n(0);function f(e,t,n){return!!t||n||(0,s.isHorizontalAlignmentCenteredAcrossSelection)(e)||(0,c.shouldRenderVerticalText)(e)||!!e.DisplayFormula||(0,g.isCellPreviewTextDefined)(e.PreviewText)}t.getCellClipping=function(e,t,n,r,i,a,s,d,g,h,C,m){var p,y=(0,o.getCellLeft)(e,t,e.BlockWidth),v=(0,o.getCellTop)(e,t),S=!!(null===(p=t.CondFormat)||void 0===p?void 0:p.Icon)||!!t.RichValueIcon;return t.Merge||a?function(e,t,n,r,i,a,s,d,u,g,f,h){if(t.Merge&&((0,o.isCellSpansMultipleRowsOrBlocks)(t)||i||(0,l.getTextWidth)(n,e,t)>=r||(0,c.shouldRenderVerticalText)(t))||h)return(0,l.getCellTextClipMask)(e,d,u,a,s,g,f);return}(e,t,n,r,i,d,g,y,v,h,S,a):s?(0,u.getClipMaskForSpillCell)(e,t,i,h,m,C,g):f(t,i,m)?(0,l.getCellTextClipMask)(e,y,v,d,g,h,S):void 0},t.shouldClipText=f,t.getCellClippingForPhonetic=function(e,t,n,r,a,s,u,c){var g,f=(0,o.getCellLeft)(e,t,e.BlockWidth),h=(0,o.getCellTop)(e,t),C=void 0!==(null===(g=t.CondFormat)||void 0===g?void 0:g.Icon);if(t.Merge||n)return(0,l.getCellTextClipMask)(e,f,h,a,s,u,C);if(r){var m=(0,i.getExpandCollapseButtonPadding)(t),p=(0,o.getSpillCellWidth)(t,e),y=(0,d.getClipMaskWidth)(p,u,m);return{x:(0,o.getSpillCellStartOffset)(t,e,u,m),y:c,width:y,height:s}}return(0,l.getCellTextClipMask)(e,f,h,a,s,u,C)},t.shouldDrawSpillCell=function(e){return!e.DisplayFormula&&!(0,g.isCellPreviewTextDefined)(e.PreviewText)&&!!e.Spill},t.shouldDrawWrapText=function(e){var t;return!e.DisplayFormula&&!(0,g.isCellPreviewTextDefined)(e.PreviewText)&&!!e.WrapText&&function(e){if((0,c.shouldRenderVerticalText)(e))return!0;if((0,s.isHorizontalAlignmentJustifiedAndDistributed)(e)||(0,a.isVerticalAlignmentJustifyOrDistributed)(e.CachedStyle.VerticalAlignment))return!(e.CachedIsTextWidthExceedsCellWidth&&e.ValueType===r.CellValueType.Number);return!(e.ValueType===r.CellValueType.Number)}(e)&&!((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Fill)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPhoneticTextRunsForRendering=t.getNoControlPhoneticText=t.getPhoneticVerticalPosition=t.getPhoneticTextVerticalPosition=void 0;var r=n(6),o=n(69),i=n(14),l=n(9),a=n(71),s=n(21);function d(e,t,n,l,a){var d=n+l-a;return(0,i.shouldRenderVerticalText)(t)?function(e,t,n){var i=(0,o.getVerticalTextMetadata)(e,t,t.Text,void 0,n,(0,r.getCellHeight)(e,t,!0));return i.adjustedOffsetY-i.textHeight}(e,t,d):(0,s.shouldDrawRotatedText)(e,t.CachedStyle,t.CachedFont)?l-a:d}t.getPhoneticTextVerticalPosition=function(e,t){var n=(0,l.getTextLineHeight)(t,e),o=a.PhoneticTextHeightPx,i=(0,r.getCellHeight)(e,t,!0),s=(0,l.calculateVerticalAlignment)(e,t,n,i,!!t.DisplayFormula),u=(0,l.getTextVerticalPosition)(t,e,n+o,i,s,void 0);return d(e,t,u.absoluteY,u.lastTextLineAlphabeticBaselineOffset,n)},t.getPhoneticVerticalPosition=d,t.getNoControlPhoneticText=function(e,t){if(!e.PhoneticTextRuns)return e.Text?e.Text:"";for(var n="",r=0,o=0;o<e.PhoneticTextRuns.length;o++){var i=e.PhoneticTextRuns[o];r<i.BaseStartIndex&&(n+=t.substring(r,i.BaseStartIndex)),n+=e.Text.substring(i.PhoneticStartIndex,i.PhoneticStartIndex+i.PhoneticLength),r=i.BaseStartIndex+i.BaseTextLength}return r<t.length&&(n+=t.substring(r)),n},t.getPhoneticTextRunsForRendering=function(e){var t,n,r,o,i,l=[],a=[];if(!e.PhonInfo||!e.PhonInfo.PhoneticTextRuns)return{phoneticTextRuns:l,textRuns:a};for(var s=0,d=0;d<e.PhonInfo.PhoneticTextRuns.length;d++){var u=e.PhonInfo.PhoneticTextRuns[d];if(s<u.BaseStartIndex){var c={FontID:null!==(n=null===(t=e.CachedFont)||void 0===t?void 0:t.ID)&&void 0!==n?n:0,StartIndex:s,EndIndex:u.BaseStartIndex,IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};a.push(c),l.push({BaseStartIndex:s,PhoneticStartIndex:0,BaseTextLength:u.BaseStartIndex-s,PhoneticLength:0})}var g={FontID:null!==(o=null===(r=e.CachedFont)||void 0===r?void 0:r.ID)&&void 0!==o?o:0,StartIndex:u.BaseStartIndex,EndIndex:u.BaseStartIndex+(null!==(i=u.BaseTextLength)&&void 0!==i?i:0),IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};a.push(g),l.push(u),s=u.BaseStartIndex+u.BaseTextLength}return{phoneticTextRuns:l,textRuns:a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRotatedTextWidth=void 0;var r=n(1),o=n(21);t.getRotatedTextWidth=function(e,t,n,i){var l=(0,o.degreeToRadians)((0,o.getOrientationInCanvas)(e.IsRtl,i.Orientation||0));return(0,r.isChangeGateEnabled)(r.ChangeGate.FixRotatedTextWidth)?t*Math.abs(Math.cos(l))+n*Math.abs(Math.sin(l)):(0,o.getRotatedTextBoxWidth)(t,n,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIconOutOfCellVerticalBoundaries=t.getIconBottomWhenAlignedWithMiddleBaseline=t.getIconLeftPosition=t.getIconVerticalPosition=t.getVerticalAlignmentForIcons=void 0;var r=n(1),o=n(9),i=n(6),l=n(12),a=n(20),s=n(10),d=n(47),u=n(15),c=n(67),g=n(38),f=n(3);function h(e,t){var n=e.RowHeights[t.Row]-f.GridLineWidthPx,r=(0,o.getTextLineHeight)(t,e);return(0,o.calculateVerticalAlignment)(e,t,r,n,t.DisplayFormula)}function C(e,t,n,r,l){var a=(0,o.getTextVerticalPosition)(t,e,(0,o.getTextLineHeight)(t,e),(0,i.getCellHeight)(e,t,!1),l,void 0).absoluteY,d=(0,o.getMiddleBaseline)(e,a,t.CachedFont,(0,s.getActualFontSize)(e,t))*n+.5*r;return Math.round(d)}function m(e,t,n,r){return(0,i.getCellBottomAdjustedForDrawing)(e,t)-a.MinimalIconPadding<n||(0,i.getCellTopAdjustedForDrawing)(e,t,!1)+a.MinimalIconPadding>n+r}t.getVerticalAlignmentForIcons=h,t.getIconVerticalPosition=function(e,t,n,o){var s,u,c=(0,d.getEffectiveVerticalAlignment)(h(e,t),d.AdvVerticalAlignmentFormat.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),g=C(e,t,n,o,c),f=null===(u=null===(s=t.CondFormat)||void 0===s?void 0:s.Icon)||void 0===u?void 0:u.IconOnly,p=(0,i.getCellBottomAdjustedForDrawing)(e,t)-a.MinimalIconPadding,y=(0,i.getCellTopAdjustedForDrawing)(e,t,!1)+a.MinimalIconPadding+o;switch(c){case r.VerticalAlignment.Bottom:return f?p:(0,l.adjustNumberToRange)(g,y,p);case r.VerticalAlignment.Top:return f?y:(0,l.adjustNumberToRange)(g,y,p);case r.VerticalAlignment.Center:return f||m(e,t,g,o)?Math.floor((0,i.getCellCenterYAdjustedForDrawing)(e,t)+o/2):g;default:throw Error("getIconVerticalPosition: Vertical alignment ".concat(c," is not supported in CF Icon!"))}},t.getIconLeftPosition=function(e,t,n,o,a){var s,d;return(null===(d=null===(s=t.CondFormat)||void 0===s?void 0:s.Icon)||void 0===d?void 0:d.IconOnly)?function(e,t,n,o,a){var s=t.CondFormat.Icon.CFIconHorizontalAlignment;switch(s){case r.HorizontalAlignment.Right:var d=(0,l.getIconHorizontalPadding)(o,a)+function(e,t,n,o){if(!t.PivotTable||!t.PivotTable.HasExpandCollapseIndicator)return 0;if(!(0,c.canCellContainExpandCollapseAndCFIcon)(t,(0,i.getCellWidthAdjustedForDrawing)(e,t),o))return 0;if(n===r.HorizontalAlignment.Right)return((0,l.getExpandCollapseButtonPadding)(t)+g.DistanceBetweenCFIconAndExpandCollapseButton)*o;return 0}(e,t,s,a)+n;return Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-d);case r.HorizontalAlignment.Fill:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:return Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+(0,l.getIconHorizontalPadding)(o,a));case r.HorizontalAlignment.Center:return Math.floor((0,i.getCellCenterXAdjustedForDrawing)(e,t,!1)-n/2);default:throw Error("getIconLeftOnlyPosition: unsupported horizontalAlignment: ".concat(s))}}(e,t,n,o,a):((0,u.isHorizontalAlignmentCenteredAcrossSelection)(t)&&t.Spill?(0,i.getSpillCellLeftAdjustedForDrawing)(e,t):(0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1))+(0,l.getIconHorizontalPadding)(o,a)},t.getIconBottomWhenAlignedWithMiddleBaseline=C,t.isIconOutOfCellVerticalBoundaries=m},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Position=void 0,function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(r||(t.Position=r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdjustedButtonSize=t.drawExpandCollapseButton=void 0;var r=n(48),o=n(2),i=n(27),l=n(194);function a(e,t,n,r){var i=Math.round(n+r/2)-l.MinusPlusLineAdjustment,a=t.left+l.MinusPlusPaddingPx+l.MinusPlusWidthPx,s=t.left+r-l.MinusPlusWidthPx;e.strokeStyle=t.outerColor,e.beginPath(),(0,o.drawLine)(e,a,i,s,i),e.stroke()}t.drawExpandCollapseButton=function(e,t,n,s,d,u){var c,g=s.width;u&&(c=(0,r.getClipRect)(t,n,s.left,s.bottom,g,!0)),(0,o.applyClipping)(e,c),(0,i.drawRectangle)(e,s);var f=s.bottom-g;d?a(e,s,f,g):function(e,t,n,r){a(e,t,n,r),function(e,t,n,r){var i=t+Math.round(r/2)+l.MinusPlusLineAdjustment,a=n+l.MinusPlusPaddingPx,s=n+r-l.MinusPlusPaddingPx-l.MinusPlusWidthPx;e.beginPath(),(0,o.drawLine)(e,i,a,i,s),e.stroke()}(e,t.left,n,r)}(e,s,f,g),(0,o.restoreClipping)(e,c)},t.getAdjustedButtonSize=function(e,t){var n=Math.floor(t*e);return n%2==0?n:n-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDrawAutoFilter=t.drawAutoFilters=void 0;var r=n(1),o=n(0),i=n(24),l=n(22),a=n(3),s=n(2),d=n(46),u=n(195),c=n(27),g=n(11),f=n(18),h=n(23),C=n(8),m=n(17);function p(e,t){var n=e.AutoFilter;if(!n&&!e.PivotFilter)return!1;if(!(0,s.cellIntersectsRenderingRegion)(e,t.renderingRegion))return!1;if(e.PivotFilter)return e.PivotFilter.DisplayFilter;if(!n.RenderingContext)return!1;var r=n.RenderingContext,i=r.IsHidden,l=r.IsRenderingPermitted;return!(i||!l)&&(!(0,o.isCellPreviewTextDefined)(e.PreviewText)&&!e.ShowSkeleton)}function y(e,t,n,a,s,h,p){var y=(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.FluentStyle,t),v=function(e,t,n,r,o,i){var l=n.devicePixelRatio,a=(0,f.getFilterSizeAdjustedForDrawing)(e,t,l,n.zoom);return i?{bottom:(0,f.getFilterBottomAdjustedForDrawing)(e,t,a,l,n.zoom),left:(0,f.getFilterLeftAdjustedForDrawing)(e,t,a,l,n.zoom),height:a,width:a,outerColor:r,innerColor:o,radius:[d.AutoFilterRectRadius]}:{bottom:(0,f.getFilterBottomAdjustedForDrawing)(e,t,a,l,n.zoom),left:(0,f.getFilterLeftAdjustedForDrawing)(e,t,a,l,n.zoom),height:a,width:a,outerColor:r,innerColor:o,radius:d.AutoFilterRectRadius}}(t,n,a,s,h,y);y?(0,c.drawRoundRectangle)(e,v):(0,c.drawRoundRectangleOld)(e,v);var R=n.PivotFilter,F=n.AutoFilter,w=!(!R||(0,r.isChangeGateEnabled)(r.ChangeGate.TakeAutoFilterBeforePivotFilter)&&F);v.width>d.FilterDrawingThresholdPx&&function(e,t,n,o){switch(e.strokeStyle=o,t){case r.AutoFilterType.Both:case r.AutoFilterType.Filtered:(0,u.drawFilterDownChevronIcon)(e,n);break;case r.AutoFilterType.BothAsc:case r.AutoFilterType.BothTop:(0,u.drawSortUpFilterIcon)(e,n);break;case r.AutoFilterType.BothDesc:case r.AutoFilterType.BothBottom:(0,u.drawSortDownFilterIcon)(e,n);break;case r.AutoFilterType.SortedAsc:case r.AutoFilterType.SortedTop:(0,u.drawSortUpChevronDownIcon)(e,n);break;case r.AutoFilterType.SortedDesc:case r.AutoFilterType.SortedBottom:(0,u.drawSortDownChevronDownIcon)(e,n);break;default:(0,u.drawDownChevronIcon)(e,n)}}(e,w?R.Type:F.Type,v,p);var T=w?R.Title:F.Title;if(!w&&(0,m.getBooleanFeatureGate)("Microsoft.Office.Excel.AddLocalizedAutoFilterTitleMapping",!1)){var I=(0,g.getTooltipTitle)(F.Type)===F.Title;C.ULS.sendTraceTag(507561123,C.LogCategory.msoulscat_ES_EWAJSGrid,C.TraceLevel.Info,"AutoFilter title mapping is correct: ".concat(I,", title in model: ").concat(F.Title," , title in mapping: ").concat((0,g.getTooltipTitle)(F.Type)))}if(function(e,t){var n=t.PivotFilter;if(n)return n.DisplayFilter&&!n.IsHeaderSnapped;if(!e.PermissionSet)return!1;var r=e.PermissionSet,o=r.IsAutoFilterDisabled,i=r.IsSortDisabled;return!(o&&i||!e.RibbonCommands)}(t,n)){var x=function(e,t){var n=e.RowNumbers[t.Row];return void 0===e.IsRow||e.IsRow?n:-1}(t,n),b=t.ColumnNumbers[n.Col];!function(e,t,n,a,s,d){var u=S(e,n,a),c=(0,r.getRenderingRegionHitTestCache)(e,(0,o.getRenderingRegionKey)(n.renderingRegion));(0,l.registerCursorHitRegion)(t,c,u,i.PointerCursorType,r.RenderFeaturesZIndex.AutoFilter),(0,l.registerTooltipHitRegion)(t,c,u,d,r.RenderFeaturesZIndex.AutoFilter),(0,l.registerHitRegion)(t,c,u,r.RenderFeaturesZIndex.AutoFilter,s,"click"),(0,l.registerHitRegion)(t,c,u,r.RenderFeaturesZIndex.AutoFilter,s,"touchend"),(0,l.registerHitRegion)(t,c,u,r.RenderFeaturesZIndex.AutoFilter,(function(e){return(0,g.onAutoFilterPointerDown)(),!0}),"pointerdown"),(0,l.registerHitRegion)(t,c,u,r.RenderFeaturesZIndex.AutoFilter,(function(e){return!0}),"dblclick"),(0,l.registerHitRegion)(t,c,u,r.RenderFeaturesZIndex.AutoFilter,i.TouchCallback,"touchstart")}(t,n,a,v,w?function(e){return(0,g.pivotFilterClickHandler)(e,R.CommandData,R.IsPivotPageField,x,b),!0}:function(e){return(0,g.handleRibbonCommand)(e,t.RibbonCommands.ShowAutoFilterMenu,F.CommandData,void 0,x,b),!0},T)}else{var D=S(t,a,v),A=(0,r.getRenderingRegionHitTestCache)(t,(0,o.getRenderingRegionKey)(a.renderingRegion));(0,l.registerTooltipHitRegion)(n,A,D,T,r.RenderFeaturesZIndex.AutoFilter),(0,l.registerCursorHitRegion)(n,A,D,i.DefaultCursorType,r.RenderFeaturesZIndex.AutoFilter)}}function v(e,t){return e?(0,o.rgbToColorHex)(e.TextColor):t===r.AutoFilterType.None?d.NoneFilterTypeStrokeColor:d.FilterStrokeColor}function S(e,t,n){var r={x:n.left,y:n.bottom-n.height,width:n.width,height:n.height};return(0,h.getUnadjustedHitRegionFromRect)(e,t,r,!1)}t.drawAutoFilters=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","drawAutoFilters"),(0,r.verifyArgumentNotNull)(t,"model","drawAutoFilters"),(0,r.verifyArgumentNotNull)(n,"context","drawAutoFilters");var i,l=t.ClientOnlyCache.CellsToRender,s=!1,u=function(e){return e?(0,o.rgbToColorHex)(e.TextColor):d.AutoFilterBorderColor}(n.highContrastScheme),c=function(e){return e?(0,o.rgbToColorHex)(e.BackgroundColor):d.AutoFilterBackgroundColor}(n.highContrastScheme),g=(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.FiltersUXModernization,t),f=n.highContrastScheme;g||(i=function(e){return e?(0,o.rgbToColorHex)(e.TextColor):d.AutoFilterStrokeColor}(n.highContrastScheme)),g&&f&&(i=v(f,void 0));for(var h=0;h<l.length;h++){var C=l[h];p(C,n)&&(s||(e.setLineDash(a.DefaultDash),e.lineWidth=d.AutoFilterLineWidthPx,s=!0),g&&!f&&(i=v(f,C.AutoFilter?C.AutoFilter.Type:C.PivotFilter.Type)),y(e,t,C,n,u,c,i))}},t.shouldDrawAutoFilter=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGridRendererCustomCursorsInitialized=t.initGridRendererCustomCursors=t.gridRendererCustomCursors=void 0;var r=n(8),o=n(7);t.initGridRendererCustomCursors=function(e){r.ULS.sendTraceTag(509110487,r.LogCategory.msoulscat_ES_EWAJSGrid,r.TraceLevel.Info,"GridRendererCustomCursors: initGridRendererCustomCursors:: isNullOrUndefined(strings): ".concat((0,o.isNullOrUndefined)(e))),t.gridRendererCustomCursors=e},t.isGridRendererCustomCursorsInitialized=function(){return!(0,o.isNullOrUndefined)(t.gridRendererCustomCursors)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeTableRanges=t.initializeCachedObjects=t.updateCellsBeforeDrawing=t.updatePivotTablesInformationBeforeDrawing=t.preprocessAutofitWidth=void 0;var r=n(1),o=n(0),i=n(10),l=n(5),a=n(73),s=n(216),d=n(40),u=n(130),c=n(74),g=n(3),f=n(11),h=n(7),C=n(2),m=n(8);t.preprocessAutofitWidth=function(e,t,n,i){var l=[];if(!t.ColMetadata)return l;try{for(var s=0;s<t.ColMetadata.length;s++){var g=t.ColMetadata[s],f=t.ColumnNumbers[s];g?g.SrvDx&&g.SrvDx>0&&(0,c.getColSrvDx)(f)!==g.SrvDx&&(0,c.removeColMetadata)(f):(0,c.removeColMetadata)(f)}var p=0;for(s=0;s<t.ColMetadata.length;s++){g=t.ColMetadata[s],f=t.ColumnNumbers[s];if(t.ColumnOffsets[s]=p,g&&g.SrvDx&&g.SrvDx>0){var y=(0,c.getColMetadata)(f);if(y&&g.SrvDx===y.SrvDx)y.CachedColWidth&&(l.push({colIndex:f,newWidth:y.CachedColWidth,isCacheChanged:!1}),t.ColumnWidths[s]=y.CachedColWidth);else{if(g.CachedStyle=(0,r.getReferencedObjectById)(g.CellStyleId||0,t.Styles),g.CachedFont=(0,r.getReferencedObjectById)(g.CachedStyle.FontID||0,t.Fonts),g.CachedStyle.VerticalText)continue;g.CachedColWidth=(0,u.calculateColWidthForMetadata)(e,t,g),l.push({colIndex:f,newWidth:g.CachedColWidth,isCacheChanged:!0}),t.ColumnWidths[s]=g.CachedColWidth,(0,c.setColMetadata)(f,g)}}p+=t.ColumnWidths[s]}return t.BlockWidth=p,(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextWidthClientNewProcessing,t)&&void 0!==n&&void 0!==i&&function(e,t,n,i){(0,r.initModelClientCache)(t),(0,C.initializeOffsetsForDrawing)(t,n*i);for(var l=t.Cells,s=0;s<l.length;s++){var u=l[s];if(u.CachedStyle=(0,r.getReferencedObjectById)(u.StyleID||0,t.Styles),u.CachedFont=(0,r.getReferencedObjectById)(u.CachedStyle.FontID||0,t.Fonts),!(0,h.isNullOrUndefined)(u.TextRuns))for(var c=0;c<u.TextRuns.length;c++){var g=u.TextRuns[c];g.CachedFont=(0,r.getReferencedObjectById)(g.FontID||0,t.Fonts)}var f=u.CachedFont.Italic,m=u.CachedFont.FontName!==d.DefaultFontName,p=!!u.TextRuns,y=u.CachedFont.Underline!==r.FontUnderline.None||u.CachedFont.StrikeThrough,v=!!u.AutoFilter;if(u.Text&&(u.CachedDisplayText=(0,o.getDisplayText)(u,t)),!u.DisplayFormula&&!(0,o.isCellPreviewTextDefined)(u.PreviewText))if(u.TolType===r.TolType.Autofit)switch(u.ValueType){case r.CellValueType.Number:u.Spill=void 0;break;case r.CellValueType.String:(f||m||y||p||v)&&(0,a.updateCellSpill)(e,t,u,n,i)}else(u.TolType===r.TolType.Spill||v)&&(0,a.updateCellSpill)(e,t,u,n,i)}}(e,t,n,i),l}catch(e){if((0,r.isChangeGateEnabled)(r.ChangeGate.ImprovedExceptionHandling))return m.ULS.sendTraceTag(507360604,m.LogCategory.msoulscat_ES_EWAJSGrid,m.TraceLevel.Warning,"GridCanvasRenderer.preprocessAutofitWidth: Error occurred while preprocessing autofit width. Error: ".concat(e)),l;throw e}},t.updatePivotTablesInformationBeforeDrawing=function(e,t){if(e&&0!==e.length)for(var n=0;n<e.length;n++){var r=e[n];r.DeltaXFromOriginPTAdjustedForDrawing=Math.round(r.DeltaXFromOriginPT*t),r.DeltaYFromOriginPTAdjustedForDrawing=Math.round(r.DeltaYFromOriginPT*t),r.OriginPTHeightAdjustedForDrawing=Math.round(r.OriginPTHeight*t),r.OriginPTWidthAdjustedForDrawing=Math.round(r.OriginPTWidth*t)}},t.updateCellsBeforeDrawing=function(e,t,n){for(var l=t.ClientOnlyCache.CellsToRender,u=(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.ByExamplePreviewMode,t),c=0;c<l.length;c++){var g=l[c],f=g.CachedFont.Italic,h=g.CachedFont.FontName!==d.DefaultFontName,C=!!g.TextRuns,m=g.CachedFont.Underline!==r.FontUnderline.None||g.CachedFont.StrikeThrough,p=!!g.AutoFilter;if(g.DisplayFormula=(0,o.shouldRenderFormulaOnCell)(g,n.isFormulaView),u){var y=(0,o.getPreviewCellsRange)(t);y&&n.isCellsPreviewMode&&(0,r.isModelCellContainedInRange)(t,y,g)||(g.PreviewText=void 0,g.PreviewNumFmt=void 0,g.PreviewCellStyle=void 0,(0,r.isChangeGateEnabled)(r.ChangeGate.PreviewCellsSettings)&&(g.RetainTextOnPreview=void 0))}else g.PreviewText&&(g.PreviewText=void 0),g.PreviewNumFmt&&(g.PreviewNumFmt=void 0),g.PreviewCellStyle&&(g.PreviewCellStyle=void 0),(0,r.isChangeGateEnabled)(r.ChangeGate.PreviewCellsSettings)&&(g.RetainTextOnPreview=void 0);if(g.Text&&(g.CachedDisplayText=(0,o.getDisplayText)(g,t)),!g.DisplayFormula&&!(0,o.isCellPreviewTextDefined)(g.PreviewText))if(g.Text&&(0,i.cellHasShrinkToFit)(g)&&(0,s.updateCellShrinkToFit)(e,t,g,n),(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextWidthClientPhase1,t))if(g.TolType===r.TolType.Autofit)switch(g.ValueType){case r.CellValueType.Number:g.Spill=void 0;break;case r.CellValueType.String:(f||h||m||C||p)&&(0,a.updateCellSpill)(e,t,g,n.zoom,n.devicePixelRatio)}else(g.TolType===r.TolType.Spill||p)&&((0,a.updateCellSpill)(e,t,g,n.zoom,n.devicePixelRatio),(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.MoveSpillCellBeforeRendering,t)&&((0,o.setCellAndSpannedOverCellsDirty)(t,g),g.Spill&&(0,o.removeBordersWithinASpillCell)(t,g)));else(f||h||m||C||p)&&(0,a.updateCellSpill)(e,t,g,n.zoom,n.devicePixelRatio);g.Merge&&(0,o.updateCellMergeInformation)(t,g,n.scaleFactor)}},t.initializeCachedObjects=function(e,t,n){(0,l.verifyArgumentNotNull)(e.Cells,"cells","GridCanvasRenderer.initializeCachedObjects"),(0,l.verifyArgumentNotNull)(e.Styles,"styles","GridCanvasRenderer.initializeCachedObjects"),(0,l.verifyArgumentNotNull)(e.Fonts,"fonts","GridCanvasRenderer.initializeCachedObjects"),(0,r.processGlobalStyles)(e),(0,r.initModelClientCache)(e),n&&(0,r.cleanHitTestCache)(e,(0,o.getRenderingRegionKey)(t));for(var i=0;i<e.Cells.length;i++){var a=e.Cells[i];(0,o.initializeCellCachedObjects)(e,a,!1)}},t.initializeTableRanges=function(e){var t={FirstRow:e.RowNumbers[g.BlockRowStartIndex],FirstColumn:e.ColumnNumbers[g.BlockColumnStartIndex],LastRow:e.RowNumbers[g.BlockRowEndIndex],LastColumn:e.ColumnNumbers[g.BlockColumnEndIndex]},n=(0,f.getTablesRangeContainingRange)(t,!1);if(n){var o=(0,r.getModelClientCache)(e);o.TableRangesCache=n,o.DisableDiffRendering=!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InsertButtonStrokeWidth=t.ThreeSixtyDegreeInRadians=t.InsertButtonLineHeight=t.InsertButtonRowPadding=t.InsertButtonColumnPadding=t.InsertButtonRadius=t.InsertDotRowPadding=t.InsertDotColumnPadding=t.InsertDotRadius=t.RowHeaderBottomInsertHitRegionHeight=t.RowHeaderTopInsertHitRegionHeight=t.ColumnHeaderEndInsertHitRegionWidth=t.ColumnHeaderStartInsertHitRegionWidth=void 0,t.ColumnHeaderStartInsertHitRegionWidth=7,t.ColumnHeaderEndInsertHitRegionWidth=8,t.RowHeaderTopInsertHitRegionHeight=5,t.RowHeaderBottomInsertHitRegionHeight=6,t.InsertDotRadius=2,t.InsertDotColumnPadding=1,t.InsertDotRowPadding=6,t.InsertButtonRadius=5,t.InsertButtonColumnPadding=0,t.InsertButtonRowPadding=4,t.InsertButtonLineHeight=7,t.ThreeSixtyDegreeInRadians=2*Math.PI,t.InsertButtonStrokeWidth=1},function(e,t,n){"use strict";n.r(t);var r=n(99);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(140);n.d(t,"toastElementId",(function(){return i.d})),n.d(t,"UnavailabilityToast",(function(){return i.a})),n.d(t,"UnavailabilityToastFactory",(function(){return i.b})),n.d(t,"UnavailabilityToastManager",(function(){return i.c}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);r.__exportStar(n(146),t),r.__exportStar(n(101),t),r.__exportStar(n(100),t),r.__exportStar(n(232),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRendererFactory=void 0;var r=n(101),o=n(218),i=n(1),l=n(0),a=n(5),s=n(219),d=n(222),u=n(224),c=function(){function e(){}return e.prototype.getModelAccessor=function(e){return(0,a.verifyArgumentNotNull)(e,"model","CanvasRendererFactory.getModelAccessor"),new o.GridBlockModelAccessor(e)},e.prototype.getGridCanvasRenderer=function(){return new r.GridCanvasRenderer},e.prototype.getHeaderCanvasRenderer=function(){return new u.HeaderCanvasRenderer},e.prototype.createRenderingCanvasElement=function(e){return new s.InteractableCanvasElement((0,l.isSubPixelRenderingEnabled)(),!!e)},e.prototype.createHeaderBlockModelAccessor=function(e,t,n){(0,a.verifyArgumentNotNull)(e,"gridModel","CanvasRendererFactory.createHeaderBlockModelAccessor"),(0,a.verifyArgumentNotNull)(n,"viewMode","CanvasRendererFactory.createHeaderBlockModelAccessor");var r=(0,i.createHeaderBlockModel)(e,t,n);return new d.HeaderBlockModelAccessor(r,t)},e}();t.CanvasRendererFactory=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridCanvasRenderer=void 0;var r=n(4),o=n(1),i=n(56),l=n(160),a=n(111),s=n(13),d=n(112),u=n(122),c=n(176),g=n(0),f=n(114),h=n(115),C=n(41),m=n(177),p=n(188),y=n(189),v=n(190),S=n(191),R=n(193),F=n(125),w=n(94),T=n(30),I=n(126),x=n(196),b=n(198),D=n(200),A=n(120),P=n(87),H=n(201),B=n(202),M=n(204),O=n(128),k=n(96),L=n(2),N=n(217),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderInternal=function(e,t,n){var r=this;try{(0,g.validateRenderingRegion)(n.renderingRegion,t,n);var a=n.scaleFactor,O=Math.round(t.BlockWidth*a),k=n.renderingRegion,L=-1*k.startOffsetY*a,E=(0,g.getDrawingOffsetXForRenderingRegion)(t,k)*a,z=(0,o.isDifferentialRenderingSupported)(t);return z&&(this.setTransform(1,!1,E,L,O),(0,I.maskDifferentialRenderingAreas)(t,this.ctx)),this.setTransform(1,!1,0,0,O),this.clearCanvas(t,e.getWidth(),e.getHeight(),n),this.setTransform(1,t.IsRtl,E,L,O),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawGridlinesDurationMs,(function(){return(0,i.drawGridLines)(r.ctx,t,n)})),n.skeletonMode?(this.setTransform(1,!1,E,L,O),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawSkeletonMs,(function(){return(0,l.drawSkeleton)(r.ctx,t,n)})),this.debugModeDrawings(t,n,E,L,O,z,a),(0,s.createRenderResult)(!0,"finished grid skeleton rendering")):((0,s.trackDuration)(s.RenderPerformanceMetric.ClearGridlinesMs,(function(){(0,s.trackDuration)(s.RenderPerformanceMetric.ClearGridLinesForSpannedCellsMs,(function(){(0,h.clearGridLinesForSpannedCells)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.ClearGridLinesForPivotTable,(function(){(0,h.clearGridLinesForPivotTables)(r.ctx,t,n)}))})),this.setTransform(1,!1,E,L,O),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawBackgroundFillMs,(function(){return(0,u.drawGridCellsBackgroundFill)(r.ctx,t,n)})),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderPatternStyle,t)&&(0,s.trackDuration)(s.RenderPerformanceMetric.DrawPatternMs,(function(){return(0,c.drawGridCellsPattern)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawEmptyPivotTableTitleContainers,(function(){return(0,v.drawEmptyPivotTableTitleContainers)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawEmptyPivotTableImages,(function(){return(0,v.drawEmptyPivotTableImages)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawDataBarsMs,(function(){return(0,S.drawDataBars)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawCFIconsMs,(function(){return(0,m.drawConditionalFormattingIcons)(r.ctx,t,n)})),n.modelFromCache||((0,s.trackDuration)(s.RenderPerformanceMetric.DrawSparklines,(function(){(0,R.drawDynamicImages)(r.ctx,t,n,T.ImageType.Sparkline)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawInCellImagesMs,(function(){return(0,R.drawDynamicImages)(r.ctx,t,n,T.ImageType.InCellImage)}))),(0,s.trackDuration)(s.RenderPerformanceMetric.ClearGridlinesForBorderMs,(function(){(0,f.clearGridLinesForBorder)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawBordersMs,(function(){return(0,f.drawBorders)(r.ctx,t,n)})),(0,g.isHighContrastMode)(n)&&(0,s.trackDuration)(s.RenderPerformanceMetric.DrawTableBordersMs,(function(){return(0,N.drawTableBordersInHighContrast)(r.ctx,t,n)})),this.setTransform(1,t.IsRtl,E,L,O),(0,s.trackDuration)(s.RenderPerformanceMetric.CellTooltipRegistrationMs,(function(){return(0,H.registerCellsGeneralTooltip)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawCommentsMs,(function(){return(0,x.drawComments)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawRichErrorMs,(function(){return(0,b.drawRichError)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.RegisterTableSelectorsMs,(function(){return(0,B.registerTableSelectors)(r.ctx,t,n)})),this.setTransform(n.scaleFactor,!1,E,L,O),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawTextDurationMs,(function(){return(0,d.drawText)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawPhoneticTextDurationMs,(function(){return(0,P.drawCellsPhoneticText)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawEmptyPivotTableTitleText,(function(){return(0,v.drawEmptyPivotTableTitleText)(r.ctx,t,n)})),this.setTransform(1,!1,E,L,O),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawTextDecoration,(function(){return(0,C.drawTextDecoration)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawExpandCollapseButtonsMs,(function(){return(0,F.drawExpandCollapseButtons)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawRichValueIcons,(function(){return(0,D.drawRichValueIcons)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawAutoFiltersMs,(function(){return(0,w.drawAutoFilters)(r.ctx,t,n)})),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.InCellControls,t)&&(0,s.trackDuration)(s.RenderPerformanceMetric.DrawInCellControls,(function(){return(0,A.drawInCellControls)(r.ctx,t,n)})),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.ByExamplePreviewMode,t)&&(0,s.trackDuration)(s.RenderPerformanceMetric.DrawSkeletonCellsMs,(function(){return(0,l.drawSkeletonCells)(r.ctx,t,n)})),this.setTransform(1,t.IsRtl,E,L,O),n.renderPageLayout&&((0,s.trackDuration)(s.RenderPerformanceMetric.DrawPrintAreasDurationMs,(function(){return(0,y.drawPrintAreas)(r.ctx,t,n)})),(0,s.trackDuration)(s.RenderPerformanceMetric.DrawPageBreaksDurationMs,(function(){return(0,p.drawPageBreaks)(r.ctx,t,n)}))),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.ByExamplePreviewMode,t)&&(0,s.trackDuration)(s.RenderPerformanceMetric.DrawPreviewCellsModeOverlayMs,(function(){return(0,M.drawPreviewModeOverlay)(t,r.ctx,n)})),z&&this.ctx.restore(),this.debugModeDrawings(t,n,E,L,O,z,a),(0,s.createRenderResult)(!0,"finished rendering"))}catch(e){return(0,s.createRenderResult)(!1,"exception caught in renderInternal: message: ".concat(e.message," name: ").concat(e.name," stack: ").concat(e.stack," error: ").concat(e))}},t.prototype.shouldInitializeCanvasHitTest=function(e,t){return!t},t.prototype.preprocessModel=function(e,t,n,r){(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.TableBordersInHighContrast,e)&&(0,g.isHighContrastMode)(n)&&(0,k.initializeTableRanges)(e),(0,k.initializeCachedObjects)(e,t,this.shouldInitializeCanvasHitTest(e,r)),(0,L.initializeOffsetsForDrawing)(e,n.scaleFactor),(0,k.updateCellsBeforeDrawing)(this.ctx,e,n),(0,k.updatePivotTablesInformationBeforeDrawing)(e.PivotTables,n.scaleFactor)},t.prototype.clearCanvas=function(e,t,n,r){var o=this;r.subPixelRenderingEnabled||(0,g.hasWorkbookBackgroundColor)(e.BackgroundColor)?(0,s.trackDuration)(s.RenderPerformanceMetric.FillRectDurationMs,(function(){o.ctx.fillStyle=(0,g.getWorkbookBackgroundColor)(r.highContrastScheme,e.BackgroundColor),o.ctx.fillRect(0,0,t,n)})):(0,s.trackDuration)(s.RenderPerformanceMetric.ClearRectDurationMs,(function(){o.ctx.clearRect(0,0,t,n)}))},t.prototype.debugModeDrawings=function(e,t,n,r,o,i,l){t.debugMode&&(this.setTransform(1,e.IsRtl,n,r,o),(0,a.addWatermark)(e,this.ctx,t,i),this.setTransform(l,!1,0,0,0),t.isCanvasHitTestDebugHighlight&&(0,a.highlightHitRegions)(e,this.ctx,t.renderingRegion))},t}(O.CanvasRenderer);t.GridCanvasRenderer=E},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SpillDirection=void 0,function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(r||(t.SpillDirection=r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellStyleByID=t.getFontByID=t.getBorderStyleByID=void 0;var r=n(61),o=n(51),i=n(43),l=n(54),a=n(55),s=n(26),d=n(37);t.getBorderStyleByID=function(e,t){var n=void 0;if((0,o.isGlobalBorderStylesEnabled)(t)&&!(0,s.isNullOrUndefined)(e.GlobalBorderStyleID))try{return(0,o.getBorderStyleByGlobalID)(e.GlobalBorderStyleID)}catch(e){n=void 0,(0,o.disableGlobalBorderStyles)("getBorderStyleByID failed with exception: ".concat(e.message))}return void 0===n?(0,r.getReferencedObjectById)(e.BorderStyleID||0,t.BorderStyles):n},t.getFontByID=function(e,t,n){var o=void 0,a=e.GlobalFontID,u=e.FontID||0,c=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(t);if(c&&!(0,s.isNullOrUndefined)(a))try{(o=(0,i.getFontByGlobalID)(a))||(0,l.disableGlobalFonts)("getFontByGlobalID returned null or undefined")}catch(e){o=void 0,(0,l.disableGlobalFonts)("getFontByID failed with exception: ".concat(e.message))}if(void 0===o){try{if(c&&!(0,s.isNullOrUndefined)(n)){var g=(0,r.getReferencedObjectById)(n||0,t.Styles);return(0,r.getReferencedObjectById)(g.FontID||0,t.Fonts)}}catch(e){if((0,d.isChangeGateEnabled)(d.ChangeGate.BetterExceptionHandling))return(0,r.getReferencedObjectById)(u||0,t.Fonts);throw e}return(0,r.getReferencedObjectById)(u||0,t.Fonts)}return o},t.getCellStyleByID=function(e,t){var n=void 0;if((0,l.isGlobalFontsAndCellStylesFlightEnabled)(t)&&!(0,s.isNullOrUndefined)(e.GlobalCellStyleID))try{return(0,a.getCellStyleByGlobalID)(e.GlobalCellStyleID)}catch(e){n=void 0,(0,a.disableGlobalCellStyles)("getCellStyleByID failed with exception: ".concat(e.message))}return void 0===n?(0,r.getReferencedObjectById)(e.StyleID||0,t.Styles):n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalStyleId=t.getGlobalStylesTelemetry=t.preprocessModelStyles=void 0;var r=n(26),o=n(51),i=n(43),l=n(54),a=n(55),s=n(29),d=n(61),u=n(52);function c(e,t){try{return(0,d.getReferencedObjectById)(e,t).GlobalId}catch(e){return}}t.preprocessModelStyles=function(e){(0,s.verifyArgumentNotNull)(e,"model","preprocessModelStyles"),(0,s.verifyArgumentNotNull)(e.Cells,"model.Cells","preprocessModelStyles");var t=(0,l.isGlobalFontsAndCellStylesFlightEnabled)(e);if((0,o.isGlobalBorderStylesEnabled)(e)&&!(0,r.isNullOrUndefined)(e.BorderStyles))try{!function(e,t){var n=(0,o.getGlobalBorderStyleMap)();n.process(t);for(var r=0;r<e.length;r++){var i=e[r],l=i.BorderStyleID||0,a=void 0;if(null==(a=void 0!==i.GlobalBorderStyleID&&null!==i.GlobalBorderStyleID&&n.getObject(i.GlobalBorderStyleID)?i.GlobalBorderStyleID:c(l,t)))throw new Error("GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalBorderStyles: Local Cell BorderStyleID ".concat(l," not mapped to a Global Border Style ID"));i.GlobalBorderStyleID=a}}(e.Cells,e.BorderStyles)}catch(e){(0,o.disableGlobalBorderStyles)("".concat(e))}if(t&&!(0,r.isNullOrUndefined)(e.Fonts)&&!(0,r.isNullOrUndefined)(e.Styles))try{!function(e,t,n){var r=(0,i.getGlobalFontsMap)();r.process(n);for(var o=0;o<t.length;o++){var l=t[o];if(l){var a=l.FontID||0,s=void 0;if(null==(s=void 0!==l.GlobalFontID&&null!==l.GlobalFontID&&r.getObject(l.GlobalFontID)?l.GlobalFontID:c(a,n)))throw new Error("GlobalStyle::GlobalStylesManager::preprocessModelFontsWithGlobalStyles: Local FontID ".concat(a," not mapped to a Global Font ID"));l.GlobalFontID=s}}for(o=0;o<e.length;o++){var d=e[o];if(d&&d.TextRuns)for(var u=d.TextRuns,g=0;g<u.length;g++){var f=u[g],h=void 0;if(null==(h=void 0!==f.GlobalFontID&&null!==f.GlobalFontID&&r.getObject(f.GlobalFontID)?f.GlobalFontID:c(f.FontID||0,n)))throw new Error("GlobalStyle::GlobalStylesManager::preprocessModelFontsWithGlobalStyles: Local Cell Text run FontID ".concat(f.FontID," not mapped to a Global Font ID"));f.GlobalFontID=h}}}(e.Cells,e.Styles,e.Fonts)}catch(e){(0,l.disableGlobalFonts)("".concat(e))}if(t&&!(0,r.isNullOrUndefined)(e.Styles))try{(0,u.setPatternStyleEnabledForGlobalStyle)(!0),function(e,t){var n=(0,a.getGlobalCellStylesMap)();n.process(t);for(var r=0;r<e.length;r++){var o=e[r],i=o.StyleID||0,l=void 0;if(null==(l=void 0!==o.GlobalCellStyleID&&null!==o.GlobalCellStyleID&&n.getObject(o.GlobalCellStyleID)?o.GlobalCellStyleID:c(i,t)))throw new Error("GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalStyles: Local Cell StyleID ".concat(i," not mapped to a Global Style ID"));o.GlobalCellStyleID=l}}(e.Cells,e.Styles)}catch(e){(0,a.disableGlobalCellStyles)("".concat(e))}},t.getGlobalStylesTelemetry=function(){return'{"GlobalBorderStylesCount": '.concat((0,o.getGlobalBorderStyleMap)().count,', "GlobalFontsCount": ').concat((0,i.getGlobalFontsMap)().count,', "GlobalCellStylesCount": ').concat((0,a.getGlobalCellStylesMap)().count," }")},t.getGlobalStyleId=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeadersFonts=t.AlphaRadix=t.LetterA=t.DefaultHiddenRowColInnerGapPx=t.RowWidthExtensionPerDigitPx=t.MaxNumberOfDigitsInDefaultRowHeader=t.ColHeaderHeightWithDragSquaresArea=t.DefaultColHeaderHeight=t.RowHeaderWidthWithDragSquaresArea=t.DefaultRowHeaderWidth=t.MinimalCellExtent=t.GroupingLevelExtensionPx=t.GroupingFirstLevelExtensionPx=t.NSVOutlinesColor=t.OutlinesColor=t.NSVGridinesColor=t.SelectedCellsGridlinesColor=t.NSVWholeRowColSelectionBackgroundColorBeforeFluent=t.NSVPartialRowColSelectionBackgroundColorBeforeFluent=t.NSVHoverBackgroundColorBeforeFluent=t.NSVHeaderBackgroundColorBeforeFluent=t.WholeRowColSelectionBackgroundColorBeforeFluent=t.PartialRowColSelectionBackgroundColorBeforeFluent=t.HoverBackgroundColorBeforeFluent=t.NSVWholeRowColSelectionAndHoverBackgroundColor=t.NSVPartialRowColSelectionAndHoverBackgroundColor=t.NSVWholeRowColSelectionBackgroundColor=t.NSVPartialRowColSelectionBackgroundColor=t.NSVHoverBackgroundColor=t.NSVHeaderBackgroundColor=t.NoHeadingsGridLineBorderBackgroundColor=t.WholeRowColSelectionAndHoverBackgroundColor=t.WholeRowColSelectionBackgroundColor=t.PartialRowColSelectionAndHoverBackgroundColor=t.PartialRowColSelectionBackgroundColor=t.HoverBackgroundColor=t.DefaultHeaderBackgroundColor=t.SelectionFontColor=t.DefaultHeaderFontColorBeforeFluent=t.OldDefaultHeaderFont=t.PartialRowColSelectionHCFontColor=t.NSVHeaderFontColor=t.WholeSelectionAndHoverFontColor=t.WholeSelectionFontColor=t.PartialSelectionAndHoverFontColor=t.PartialSelectionFontColor=t.HoverFontColor=t.DefaultHeaderFontColor=t.DefaultHeaderFontSize=t.DefaultHeaderFont=void 0,t.HoverHeadersStylesSet=t.WholeSelectionHeadersStylesSet=t.PartiallySelectionHeadersStylesSet=t.ColumnHeadersNSVStylesArrayBeforeFluent=t.ColumnHeadersNSVStylesArray=t.RowHeadersNSVStylesArrayBeforeFluent=t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=t.RowHeadersNSVStylesArray=t.ColumnHeadersStylesArrayBeforeFluent=t.ColumnHeadersStylesArray=t.RowHeadersStylesArrayBeforeFluent=t.RowHeadersStylesArrayBeforeHeaderDragImprovements=t.RowHeadersStylesArray=t.OldHeadersNSVFonts=t.OldHeadersNSVFontsBeforeFluent=t.HeadersNSVFonts=t.HeadersNSVFontsBeforeFluent=t.OldHeadersFontsBeforeFluent=t.OldHeadersFonts=t.HeadersFontsBeforeFluent=void 0;var r=n(25);t.DefaultHeaderFont="Aptos Narrow",t.DefaultHeaderFontSize=11,t.DefaultHeaderFontColor="#616161",t.HoverFontColor="#616161",t.PartialSelectionFontColor="#0F703B",t.PartialSelectionAndHoverFontColor="#0C5F32",t.WholeSelectionFontColor="#FFFFFF",t.WholeSelectionAndHoverFontColor="#FFFFFF",t.NSVHeaderFontColor="#FFFFFF",t.PartialRowColSelectionHCFontColor="#000000",t.OldDefaultHeaderFont="Calibri",t.DefaultHeaderFontColorBeforeFluent="#5E5E5E",t.SelectionFontColor="#217346",t.DefaultHeaderBackgroundColor="#F5F5F5",t.HoverBackgroundColor="#EBEBEB",t.PartialRowColSelectionBackgroundColor="#CAEAD8",t.PartialRowColSelectionAndHoverBackgroundColor="#A0D8B9",t.WholeRowColSelectionBackgroundColor="#107C41",t.WholeRowColSelectionAndHoverBackgroundColor="#0F703B",t.NoHeadingsGridLineBorderBackgroundColor="#DAD8D6",t.NSVHeaderBackgroundColor="#333333",t.NSVHoverBackgroundColor="#4D4D4D",t.NSVPartialRowColSelectionBackgroundColor="#637C6E",t.NSVWholeRowColSelectionBackgroundColor="#107C41",t.NSVPartialRowColSelectionAndHoverBackgroundColor="#596D62",t.NSVWholeRowColSelectionAndHoverBackgroundColor="#0F703B",t.HoverBackgroundColorBeforeFluent="#9FD5B7",t.PartialRowColSelectionBackgroundColorBeforeFluent="#DAD8D6",t.WholeRowColSelectionBackgroundColorBeforeFluent="#D3F0E0",t.NSVHeaderBackgroundColorBeforeFluent="#363636",t.NSVHoverBackgroundColorBeforeFluent="#6F7872",t.NSVPartialRowColSelectionBackgroundColorBeforeFluent="#69796d",t.NSVWholeRowColSelectionBackgroundColorBeforeFluent="#577C68",t.SelectedCellsGridlinesColor="#BFBFBF",t.NSVGridinesColor="#DFDFDF",t.OutlinesColor="#AAAEB1",t.NSVOutlinesColor="#AAAEB1",t.GroupingFirstLevelExtensionPx=26,t.GroupingLevelExtensionPx=12,t.MinimalCellExtent=1,t.DefaultRowHeaderWidth=36.5,t.RowHeaderWidthWithDragSquaresArea=42.5,t.DefaultColHeaderHeight=19,t.ColHeaderHeightWithDragSquaresArea=30,t.MaxNumberOfDigitsInDefaultRowHeader=3,t.RowWidthExtensionPerDigitPx=10,t.DefaultHiddenRowColInnerGapPx=3,t.LetterA=65,t.AlphaRadix=26,t.HeadersFonts=[{Color:t.HoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.PartialSelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.PartialSelectionAndHoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.WholeSelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:r.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.WholeSelectionAndHoverFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.DefaultHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.HeadersFontsBeforeFluent=[{Color:t.DefaultHeaderFontColorBeforeFluent,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.SelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.SelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.SelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.SelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.DefaultHeaderFontColorBeforeFluent,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.OldHeadersFonts=[{Color:t.HoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.PartialSelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.PartialSelectionAndHoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.WholeSelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:r.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.WholeSelectionAndHoverFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.DefaultHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.OldHeadersFontsBeforeFluent=[{Color:t.DefaultHeaderFontColorBeforeFluent,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.SelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.SelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.SelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.SelectionFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.DefaultHeaderFontColorBeforeFluent,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.HeadersNSVFontsBeforeFluent=[{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.HeadersNSVFonts=[{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:r.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.OldHeadersNSVFontsBeforeFluent=[{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.OldHeadersNSVFonts=[{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Hover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:r.UniqueHeadersFontID.WholeSelection,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,Bold:!0,ID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1},{Color:t.NSVHeaderFontColor,FontName:t.OldDefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersStylesArray=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersStylesArrayBeforeHeaderDragImprovements=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersStylesArrayBeforeFluent=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.ColumnHeadersStylesArray=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.HoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:r.UniqueHeadersStyleID.HoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.PartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.WholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.LeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1},{ID:r.UniqueHeadersStyleID.RightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.ColumnHeadersStylesArrayBeforeFluent=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.PartialSelection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.HoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.HoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Hover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.PartialSelectionAndHover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.HoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.LeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1},{ID:r.UniqueHeadersStyleID.RightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersNSVStylesArray=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.RowHeadersNSVStylesArrayBeforeFluent=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.ColumnHeadersNSVStylesArray=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelection,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.HoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.HoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.WholeSelectionAndHover,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionAndHoverBackgroundColor},{ID:r.UniqueHeadersStyleID.LeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1},{ID:r.UniqueHeadersStyleID.RightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.ColumnHeadersNSVStylesArrayBeforeFluent=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHover,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.NoHeadings,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NoHeadingsGridLineBorderBackgroundColor},{ID:r.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVPartialRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVWholeRowColSelectionBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.HoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.HoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.NSVHoverBackgroundColorBeforeFluent},{ID:r.UniqueHeadersStyleID.LeftAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Left,FontID:r.UniqueHeadersFontID.Default,RefCount:1},{ID:r.UniqueHeadersStyleID.RightAlignment,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Right,FontID:r.UniqueHeadersFontID.Default,RefCount:1},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Bottom,HorizontalAlignment:r.HorizontalAlignment.Center,FontID:r.UniqueHeadersFontID.Default,RefCount:1}],t.PartiallySelectionHeadersStylesSet=new Set([r.UniqueHeadersStyleID.PartialRowColSelection,r.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment,r.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment,r.UniqueHeadersStyleID.PartialSelectionAndHover,r.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,r.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment]),t.WholeSelectionHeadersStylesSet=new Set([r.UniqueHeadersStyleID.WholeRowColSelection,r.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment,r.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment,r.UniqueHeadersStyleID.WholeSelectionAndHover,r.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,r.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment]),t.HoverHeadersStylesSet=new Set([r.UniqueHeadersStyleID.Hover,r.UniqueHeadersStyleID.HoverLeftAlignment,r.UniqueHeadersStyleID.HoverRightAlignment,r.UniqueHeadersStyleID.PartialSelectionAndHover,r.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment,r.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment,r.UniqueHeadersStyleID.WholeSelectionAndHover,r.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment,r.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.annonymize=t.serializeModel=t.serializeCell=void 0;var r=n(63),o=n(156),i=n(42),l=n(37),a=!1,s=[];function d(e){return e.toLowerCase().replace(o.DigitReplaceValue,o.CharacterReplaceValue).replace(o.Digit,o.DigitReplaceValue).replace(o.ValueAnnonymizerRegex,o.CharacterReplaceValue)}function u(e){return function(t,n){return n&&e&&e.indexOf(t)>-1?d(n):n}}s=r.UserContentList.Cell.concat(r.UserContentList.GridBlockModel).concat(r.UserContentList.CellStyle).concat(r.UserContentList.Font).concat(r.UserContentList.BorderStyle).concat(r.UserContentList.AutoFilter).concat(r.UserContentList.PivotFilter).concat(r.UserContentList.MenuItem).concat(r.UserContentList.FormulaInformation).concat(r.UserContentList.NumberFormatInformation).concat(r.UserContentList.InCellControlType).concat(r.UserContentList.InCellControlOptions),t.serializeCell=function(e,t){if((0,l.isChangeGateEnabled)(l.ChangeGate.FixUserContentList)&&!a){for(var n in s=[],r.UserContentList)s=s.concat(r.UserContentList[n]);a=!0}return e&&t?(e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles),e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles),e.CachedFont=(0,i.getReferencedObjectToCache)(e.CachedStyle.FontID||0,t.Fonts),s?JSON.stringify(e,u(s)):JSON.stringify(e)):""},t.serializeModel=function(e){if((0,l.isChangeGateEnabled)(l.ChangeGate.FixUserContentList)&&!a){for(var t in s=[],r.UserContentList)s=s.concat(r.UserContentList[t]);a=!0}return e?s?JSON.stringify(e,u(s)):JSON.stringify(e):""},t.annonymize=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.comparePartialCellsInGridBlockModel=t.comparePartialColumnsInGridBlockModel=t.comparePartialRowsInGridBlockModel=t.getRowColIndexFromNumber=t.ensureCachedFontsInTextRuns=t.compareModelCells=t.areObjectsEqual=t.areArraysEqual=t.areCellsEqual=void 0;var r=n(26),o=n(63),i=n(42),l=n(37),a=n(29),s=n(55),d=n(43),u=n(54),c=n(51),g=n(108),f=n(17);function h(e,t,n,r,o,l,a){(0,u.isGlobalFontsAndCellStylesFlightEnabled)(n)&&(0,u.isGlobalFontsAndCellStylesFlightEnabled)(r)&&(0,c.isGlobalBorderStylesEnabled)(n)&&(0,c.isGlobalBorderStylesEnabled)(r)?(T(e,n),T(t,r),I(e,n),I(t,r),w(e,n),w(t,r)):(e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,n.Styles),t.CachedStyle=(0,i.getReferencedObjectToCache)(t.StyleID||0,r.Styles),e.CachedFont=(0,i.getReferencedObjectToCache)(e.CachedStyle.FontID||0,n.Fonts),t.CachedFont=(0,i.getReferencedObjectToCache)(t.CachedStyle.FontID||0,r.Fonts),e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,n.BorderStyles),t.CachedBorderStyle=(0,i.getReferencedObjectToCache)(t.BorderStyleID||0,r.BorderStyles));var s=l(e,t);p(e.TextRuns,n.Fonts),p(t.TextRuns,r.Fonts);var d=m(e,t,s,o,a);return d.isEqual||(d.message+="\nareCellsEqual: cell1.Row = ".concat(e.Row,", cell1.Col = ").concat(e.Col,", cell2.Row = ").concat(t.Row,", cell2.Col = ").concat(t.Col)),d}function C(e,t,n,r,o,i){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:"areArraysEqual: arrays length are different. length1: ".concat(e.length,", length2: ").concat(t.length)};for(var l=0;l<e.length;l++){var a=m(e[l],t[l],n,r,o,i);if(!a.isEqual)return a.message+="\nareArraysEqual: array objects are different. index: ".concat(l),a}return{isEqual:!0}}function m(e,t,n,o,i,l){var a=function(e,t,n){if(e===t)return{shouldContinue:!1,result:{isEqual:!0}};if((0,r.isNullOrUndefined)(e)&&(0,r.isNullOrUndefined)(t))return{shouldContinue:!1,result:{isEqual:!0}};if(null==e||null==t)return{shouldContinue:!1,result:{isEqual:!1,message:"".concat(n,": one object is null, o1 = ").concat(!e,", o2 = ").concat(!t)}};if(e!=e)return{shouldContinue:!1,result:{isEqual:e!=e,message:"${callerMethod}: NaN comparison"}};return{shouldContinue:!0,result:{isEqual:!0}}}(e,t,"areObjectsEqual"),s=a.shouldContinue,d=a.result;if(!s)return d;var u=function(e,t){if(!e||!t)return e||t;var n=t.filter((function(t){return-1===e.indexOf(t)}));return e.push.apply(e,n),e}(o(e,n),o(t,n));if(0===u.length)return S(e)&&S(t)?{isEqual:!0}:e instanceof Date||e instanceof Number||e instanceof Boolean?{isEqual:e.valueOf()===t.valueOf(),message:"areObjectsEqual: simple object comparison"}:{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(var c=0;c<u.length;c++){var g=u[c],f=e[g],h=t[g],p=typeof f,R=typeof h;if(!(0,r.isNullOrUndefined)(f)||!(0,r.isNullOrUndefined)(h)){if(p!==R){if(v(f)&&v(h))continue;return{isEqual:!1,message:"areObjectsEqual: object types are different. propName = ".concat(g," type1 = ").concat(p,", type2 = ").concat(R)}}switch(p){case"string":if(f!==h){if(!l||-1===l.indexOf(g))return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = ".concat(g)};if(f.toUpperCase()!==h.toUpperCase())return{isEqual:!1,message:"areObjectsEqual: ignore case comparison, propertyName = ".concat(g)}}break;case"undefined":case"boolean":case"number":if(f!==h)return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = ".concat(g)};break;case"object":if(f instanceof Array){if(!(h instanceof Array))return{isEqual:!1,message:"areObjectsEqual: array 2 is not an array, propertyName = ".concat(g)};var F=(T=y(g,i)).ignoreCaseProps,w=C(f,h,T.filterByProps,o,i,F);if(!w.isEqual)return w.message+="\nareObjectsEqual: arrays mismatch, propertyName = ".concat(g),w}else{F=(T=y(g,i)).ignoreCaseProps;var T,I=m(f,h,T.filterByProps,o,i,F);if(!I.isEqual)return I.message+="\nareObjectsEqual: objects mismatch, propertyName = ".concat(g),I}break;default:return{isEqual:!1,message:"areObjectsEqual: unexpected type: ".concat(p,", propertyName = ").concat(g)}}}}return{isEqual:!0}}function p(e,t){if(e&&0!==e.length&&t)for(var n=0;n<e.length;n++){var r=e[n];(0,d.isGlobalFontsEnabled)()?r.CachedFont=x(r.GlobalFontID,r.FontID,t):r.CachedFont=(0,i.getReferencedObjectToCache)(r.FontID||0,t)}}function y(e,t){var n,r={filterByProps:void 0,ignoreCaseProps:void 0},i=o.propertyToClassMap[e];if(!i)return r;for(var l=[],a=new Set,s=0;s<i.length;s++)null===(n=t[i[s]])||void 0===n||n.forEach((function(e){return a.add(e)})),l.push.apply(l,o.ignoreCaseLists[i[s]]);return r.filterByProps=a,r.ignoreCaseProps=l,r}function v(e){return(0,l.isChangeGateEnabled)(l.ChangeGate.TreatZeroAndUndefinedAsEqual)?null==e||""===e||!1===e||0===e:null==e||""===e||!1===e}function S(e){if("object"==typeof e&&e.constructor===Object){for(var t in e)return!1;return!0}return!1}function R(e,t,n,r,o){var i=[];if(v(i))return[];for(var l=0;l<e.Cells.length;l++){var a=e.Cells[l];a.Row>=t&&a.Row<=n&&a.Col>=r&&a.Col<=o&&i.push(a)}return i}function F(e,t,n,r,o,i,l){var a=e,s=e,d=t,u=n;return d>=r?(s=o[u],u++):u>=i||l[d].Row<o[u].Row||l[d].Row===o[u].Row&&l[d].Col<o[u].Col?(a=l[d],d++):l[d].Row!==o[u].Row||l[d].Col!==o[u].Col?(s=o[u],u++):(a=l[d],s=o[u],d++,u++),{cell1:a,cell2:s,index1:d,index2:u}}function w(e,t){try{if(!(0,r.isNullOrUndefined)(e.GlobalBorderStyleID))return void(e.CachedBorderStyle=(0,c.getBorderStyleByGlobalID)(e.GlobalBorderStyleID||0));e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles)}catch(n){e.CachedBorderStyle=(0,i.getReferencedObjectToCache)(e.BorderStyleID||0,t.BorderStyles),(0,c.disableGlobalBorderStyles)("".concat(n))}}function T(e,t){try{if(!(0,r.isNullOrUndefined)(e.GlobalCellStyleID))return void(e.CachedStyle=(0,s.getCellStyleByGlobalID)(e.GlobalCellStyleID));e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles)}catch(n){e.CachedStyle=(0,i.getReferencedObjectToCache)(e.StyleID||0,t.Styles),(0,s.disableGlobalCellStyles)("".concat(n))}}function I(e,t){var n,r,o;try{e.CachedFont=x(null===(n=e.CachedStyle)||void 0===n?void 0:n.GlobalFontID,null===(r=e.CachedStyle)||void 0===r?void 0:r.FontID,t.Fonts)}catch(n){e.CachedFont=(0,i.getReferencedObjectToCache)((null===(o=e.CachedStyle)||void 0===o?void 0:o.FontID)||0,t.Fonts),(0,u.disableGlobalFonts)("".concat(n))}}function x(e,t,n){return(0,r.isNullOrUndefined)(e)?(0,i.getReferencedObjectToCache)(t||0,n):(0,d.getFontByGlobalID)(e)}t.areCellsEqual=h,t.areArraysEqual=C,t.areObjectsEqual=m,t.compareModelCells=function(e,t,n,r,o,a){var s,d=e.Cells,u=t.Cells,c=0;if(d===u)return{isEqual:!0,canDiffRender:!0};for(var C=d.length,p=u.length,y=0,v=0,S=(0,i.getDefaultCell)(-1,-1,e.Styles,e.Fonts),R=[],w=!0,T="";y<C||v<p;){var I,x,b=y,D=v;I=(s=F(S,y,v,C,u,p,d)).cell1,x=s.cell2,y=s.index1,v=s.index2;var A=h(I,x,e,t,r,o,a),P=-1===(null==I?void 0:I.Row)?null==x?void 0:x.Row:I.Row,H=-1===(null==I?void 0:I.Col)?null==x?void 0:x.Col:I.Col;if(!A.isEqual){w&&(w=!1,T+=A.message+"\n"),R.push((0,i.getCellLookupKey)(P,H));var B=(0,g.getComparisonIgnoreLists)((0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListFix",!1)).ReferencedObject;if(!m(I.CachedBorderStyle,x.CachedBorderStyle,B,r,a).isEqual||!m(I.HasError,x.HasError,void 0,r,a).isEqual){var M=[];(0,l.isChangeGateEnabled)(l.ChangeGate.AdjacentCellsMergeFix)?(-1!==I.Row&&(M=(0,i.getAdjacentCellsKeys)(e,I)),-1!==x.Row&&(M=M.concat((0,i.getAdjacentCellsKeys)(t,x)))):M=(0,i.getAdjacentCellsKeysOld)(t,P,H),R=(R=(R=R.concat(M)).concat((0,i.getAllSpillingOverCells)(d,M))).concat((0,i.getAllSpillingOverCells)(u,M))}if(n&&++c>=n)return{isEqual:w,canDiffRender:!1,changedCellsKeys:void 0,message:"".concat(T," \n maxAllowedDiffRenderCells reached")};I!==S&&(R=R.concat((0,i.getAllSpanningCellsKeys)(d,I,b))),x!==S&&(R=R.concat((0,i.getAllSpanningCellsKeys)(u,x,D)))}}return{isEqual:w,canDiffRender:!0,changedCellsKeys:R.filter(i.uniqueValuesFilter),message:T}},t.ensureCachedFontsInTextRuns=p,t.getRowColIndexFromNumber=function(e,t){if(e.length<1)return 0;if(t<e[0])return 0;var n=e.length-1;if(t>e[n])return n;for(var r=0;r<e.length;r++)if(t===e[r])return r;return-1},t.comparePartialRowsInGridBlockModel=function(e,t,n,r){!function(e,t){(0,a.verifyArgumentNotNull)(e.RowOffsets,"model1.RowOffsets","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowOffsets,"model2.RowOffsets","validateRowArgs"),(0,a.verifyArgumentNotNull)(e.RowHeights,"model1.RowHeights","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowHeights,"model2.RowHeights","validateRowArgs"),(0,a.verifyArgumentNotNull)(e.RowNumbers,"model1.RowNumbers","validateRowArgs"),(0,a.verifyArgumentNotNull)(t.RowNumbers,"model2.RowNumbers","validateRowArgs")}(e,t);for(var o=n;o<=r;o++){if(e.RowHeights[o]!==t.RowHeights[o])return{isEqual:!1,message:"Mismatch in RowHeights, index = "+o+" model1 value = "+e.RowHeights[o]+" model2 value = "+t.RowHeights[o],canDiffRender:!1,changedCellsKeys:void 0};if(e.RowNumbers[o]!==t.RowNumbers[o])return{isEqual:!1,message:"Mismatch in RowNumbers, index = "+o+" model1 value = "+e.RowNumbers[o]+" model2 value = "+t.RowNumbers[o],canDiffRender:!1,changedCellsKeys:void 0};if(e.RowOffsets[o]!==t.RowOffsets[o])return{isEqual:!1,message:"Mismatch in RowOffsets, index = "+o+" model1 value = "+e.RowOffsets[o]+" model2 value = "+t.RowOffsets[o],canDiffRender:!1,changedCellsKeys:void 0}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}},t.comparePartialColumnsInGridBlockModel=function(e,t,n,r){!function(e,t){(0,a.verifyArgumentNotNull)(e.ColumnNumbers,"model1.ColumnNumbers","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnNumbers,"model2.ColumnNumbers","validateColumnArgs"),(0,a.verifyArgumentNotNull)(e.ColumnWidths,"model1.ColumnWidths","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnWidths,"model2.ColumnWidths","validateColumnArgs"),(0,a.verifyArgumentNotNull)(e.ColumnOffsets,"model1.ColumnOffsets","validateColumnArgs"),(0,a.verifyArgumentNotNull)(t.ColumnOffsets,"model2.ColumnOffsets","validateColumnArgs")}(e,t);for(var o=n;o<=r;o++){if(e.ColumnWidths[o]!==t.ColumnWidths[o])return{isEqual:!1,message:"Mismatch in ColumnWidths, index = "+o+" model1 value = "+e.ColumnWidths[o]+" model2 value = "+t.ColumnWidths[o],canDiffRender:!1,changedCellsKeys:void 0};if(e.ColumnOffsets[o]!==t.ColumnOffsets[o])return{isEqual:!1,message:"Mismatch in ColumnOffsets, index = "+o+" model1 value = "+e.ColumnOffsets[o]+" model2 value = "+t.ColumnOffsets[o],canDiffRender:!1,changedCellsKeys:void 0};if(e.ColumnNumbers[o]!==t.ColumnNumbers[o])return{isEqual:!1,message:"Mismatch in ColumnNumbers, index = "+o+" model1 value = "+e.ColumnNumbers[o]+" model2 value = "+t.ColumnNumbers[o],canDiffRender:!1,changedCellsKeys:void 0}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}},t.comparePartialCellsInGridBlockModel=function(e,t,n,r,o,l,a,s,d){for(var u,c=R(e,n,r,o,l),g=R(t,n,r,o,l),f=c.length,C=g.length,m=0,p=0,y=(0,i.getDefaultCell)(-1,-1,e.Styles,e.Fonts);m<f||p<C;){var v,S;v=(u=F(y,m,p,f,g,C,c)).cell1,S=u.cell2,m=u.index1,p=u.index2;var w=h(v,S,e,t,a,s,d);if(!w.isEqual)return{isEqual:w.isEqual,canDiffRender:!0,changedCellsKeys:[],message:w.message}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getComparisonIgnoreLists=void 0;var r=n(63),o=!1;t.getComparisonIgnoreLists=function(e){if(!e&&!o){var t=new Set(["RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","AdjacentBlocksHiddensInfo","IsCanvasHeadersSupported","HasTable","HasOutline"]),n=new Set(["InsertButtons"]),i=new Set(["Start","End"]),l=new Set(["Type","Offset"]),a=r.comparisonIgnoreLists.GridBlockModel.filter((function(e){return!t.has(e)})),s=r.comparisonIgnoreLists.HeaderCell.filter((function(e){return!n.has(e)})),d=r.comparisonIgnoreLists.InsertButtons.filter((function(e){return!i.has(e)})),u=r.comparisonIgnoreLists.InsertButton.filter((function(e){return!l.has(e)}));r.comparisonIgnoreLists.GridBlockModel=a,r.comparisonIgnoreLists.HeaderCell=s,r.comparisonIgnoreLists.InsertButtons=d,r.comparisonIgnoreLists.InsertButton=u,o=!0}return r.comparisonIgnoreLists}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateNumFmtFromCell=void 0;var r=n(1),o=n(7);t.updateNumFmtFromCell=function(e){var t,n,i,l;if((0,r.verifyArgumentNotNull)(e.Text,"cell.Text","updateNumFmt"),(0,r.verifyArgumentNotNull)(e.NumFmt,"cell.NumFmt","updateNumFmt"),!(0,o.isNullOrUndefined)(e.NumFmt.End)&&!(0,o.isNullOrUndefined)(e.NumFmt.Separator)){var a=function(e,t){for(var n=0,r=0;r<e.length&&e[r]===t;r++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),s=function(e,t){for(var n=0,r=e.length-1;r>0&&e[r]===t;r++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),d=function(e,t,n){var r=e.length-t,o=e.substring(0,r),i=o.lastIndexOf(n);if(-1===i)return o;return o.substr(i+1)}(e.Text,s,e.NumFmt.Separator);e.NumFmt.End=function(e,t,n,r){return t.repeat(n)+e+t.repeat(r)}(d,e.NumFmt.Separator,a,s),(null===(t=null==e?void 0:e.Text)||void 0===t?void 0:t.endsWith((null===(n=e.NumFmt)||void 0===n?void 0:n.Separator)+e.NumFmt.End))&&(null===(i=null==e?void 0:e.Text)||void 0===i?void 0:i.startsWith((null===(l=e.NumFmt)||void 0===l?void 0:l.Start)||""))||(e.NumFmt=void 0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderingCanvasElement=void 0;var r=n(0),o=n(13),i=function(){function e(e,t){this.renderingRegion=void 0,this.canvas=document.createElement("canvas"),this.parentElement=null;var n=!!t&&(0,r.isOffscreenCanvasSupported)();if(this.ctxOptions={alpha:!e},n)try{this.offscreenCanvas=this.canvas.transferControlToOffscreen()}catch(e){(0,o.setRenderingResultInfo)("RenderingCanvasElement.ctor:: OffscreenCanvas failed."),this.offscreenCanvas=void 0}else this.offscreenCanvas=void 0}return e.prototype.dispose=function(){this.parentElement&&(this.parentElement.removeChild(this.canvas),this.parentElement=null),this.canvas.style.width="0px",this.canvas.style.height="0px",this.setWidth(0),this.setHeight(0),this.renderingRegion&&(this.renderingRegion.isRendered=!1)},e.prototype.appendToParent=function(e){e&&(e.appendChild(this.canvas),this.parentElement=e)},e.prototype.getContext2d=function(e){return this.offscreenCanvas?this.offscreenCanvas.getContext("2d",this.ctxOptions):this.canvas.getContext("2d",this.ctxOptions)},e.prototype.getWidth=function(){return this.offscreenCanvas?this.offscreenCanvas.width:this.canvas.width},e.prototype.setWidth=function(e){this.offscreenCanvas?this.offscreenCanvas.width=e:this.canvas.width=e},e.prototype.getHeight=function(){return this.offscreenCanvas?this.offscreenCanvas.height:this.canvas.height},e.prototype.setHeight=function(e){this.offscreenCanvas?this.offscreenCanvas.height=e:this.canvas.height=e},e.prototype.getStyle=function(){return this.canvas.style},e.prototype.setClassName=function(e){this.canvas.className=null!=e?e:""},e.prototype.updatePosition=function(e,t,n,r){if(this.canvas){var o=e+"px",i=t+"px",l=this.canvas.style;if(n||(r?l.right!==o:l.left!==o)||l.top!==i)return r?l.right=o:l.left=o,l.top=i,!0}return!1},e.prototype.setDimensions=function(e,t,n){var r=Math.round(e*n),o=Math.round(t*n);this.setStyleDimensions(r,o,n),this.setWidth(r),this.setHeight(o)},e.prototype.setRenderingRegion=function(e){e&&(this.renderingRegion=e)},e.prototype.getRenderingRegion=function(){return this.renderingRegion},e.prototype.setStyleDimensions=function(e,t,n){this.canvas.style.width=e/n+"px",this.canvas.style.height=t/n+"px"},e}();t.RenderingCanvasElement=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.highlightHitRegions=t.addWatermark=t.hitRegionsToHighlight=void 0;var r=n(1),o=n(0),i=n(22),l={red:{color:"Red",infoString:"Full render"},blue:{color:"Blue",infoString:"Full render from PLT cache"},green:{color:"Green",infoString:"Partial Rendering (Rendering only changed cells)"}};t.hitRegionsToHighlight={general:!1,toolTip:!1,cursor:!1,longPress:!1},t.addWatermark=function(e,t,n,a){var s=1*n.scaleFactor,d=5*n.scaleFactor,u=function(e,t){if(e)return l.blue;if(t)return l.green;return l.red}(n.modelFromCache,a);!function(e,t,n,r){e.beginPath(),e.lineWidth=1,e.setLineDash([]),e.strokeStyle="white",e.rect(t,t,n,n),e.strokeStyle=r.color,e.rect(t,t,n,n),e.stroke()}(t,s,d,u),function(e,t,n,a,s){var d,u=(0,r.getRenderingRegionHitTestCache)(e,(0,o.getRenderingRegionKey)(t.renderingRegion)),c=2*a,g={isMirrored:e.IsRtl,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n,y:n,width:c,height:c},isRtl:e.IsRtl,blockWidth:e.BlockWidth},f=null===(d=e.Cells)||void 0===d?void 0:d[0];f||(f=(0,r.getDefaultCell)(0,0));(0,i.registerCursorHitRegion)(f,u,g,"help",r.RenderFeaturesZIndex.DebugWatermark),(0,i.registerTooltipHitRegion)(f,u,g,function(e){var t="",n="".concat(e.color," - ").concat(e.infoString);return Object.keys(l).forEach((function(e){return t+="".concat(l[e].color," - ").concat(l[e].infoString,"\n")})),"".concat(n,"\n\n").concat(t)}(s),r.RenderFeaturesZIndex.DebugWatermark)}(e,n,s,d,u)},t.highlightHitRegions=function(e,n,i){var l=(0,r.getRenderingRegionHitTestCache)(e,(0,o.getRenderingRegionKey)(i));[l.CellHitRegions,l.CellCursorHitRegions,l.CellTooltipHitRegions,l.CellLongPressHitRegions].forEach((function(e){e&&Object.values(e).forEach((function(e){for(var r=0;r<e.length;r++){var o=e[r],i=o.region,l=i.x,a=i.y,s=i.width,d=i.height;o.eventType&&t.hitRegionsToHighlight.general&&(n.fillStyle="rgba(255, 255, 0, 0.2)",n.fillRect(l,a,s,d)),o.tooltipText&&t.hitRegionsToHighlight.toolTip&&(n.fillStyle="rgba(0, 255, 51, 0.2)",n.fillRect(l,a,s,d)),o.cursorType&&t.hitRegionsToHighlight.cursor&&(n.fillStyle="rgba(255, 0, 0, 0.2)",n.fillRect(l,a,s,d)),o.onStart&&t.hitRegionsToHighlight.longPress&&(n.fillStyle="rgba(236, 0, 255, 0.2)",n.fillRect(l,a,s,d))}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawText=void 0;var r=n(1),o=n(2),i=n(113),l=n(3),a=n(118),s=n(0),d=n(5),u=n(166),c=n(9),g=n(6),f=n(170),h=n(171),C=n(12),m=n(58),p=n(18),y=n(13),v=n(172),S=n(88),R=n(71),F=n(21),w=n(173),T=n(120),I=n(7);function x(e,t,n,l,h,m,v){var T,I,x,D,A=n.zoom,P=n.devicePixelRatio,H=(0,r.isChangeGateEnabled)(r.ChangeGate.CanvasTextMeasure),B=-1;H?(0,y.trackDuration)(y.RenderPerformanceMetric.DrawTextTextLineHeight,(function(){B=(0,c.getTextLineHeight)(l,t)}),!0,!0):B=(0,c.getTextLineHeight)(l,t);var M=(0,c.calculateVerticalAlignment)(t,l,B,v,l.DisplayFormula),O=(null===(T=l.CachedStyle)||void 0===T?void 0:T.HorizontalAlignment)===r.HorizontalAlignment.Fill,k=(0,g.getCellWidth)(t,l,!1),L=(0,c.getDistanceFromCellStartToIconEnd)(t,l,A,P),N=0;H?(0,y.trackDuration)(y.RenderPerformanceMetric.DrawTextTextMaxWidth,(function(){var e;N=(0,o.getTextDrawingMaxWidth)(k,(0,c.getCellTextHorizontalPaddingWithoutVisualElements)(t,l),L,(0,C.getExpandCollapseButtonWidth)(null===(e=l.PivotTable)||void 0===e?void 0:e.HasExpandCollapseIndicator),(0,p.getAutoFilterPaddingForAdvancedHorizontalAlignment)(t,l,A,P))}),!0,!0):N=(0,o.getTextDrawingMaxWidth)(k,(0,c.getCellTextHorizontalPaddingWithoutVisualElements)(t,l),L,(0,C.getExpandCollapseButtonWidth)(null===(I=l.PivotTable)||void 0===I?void 0:I.HasExpandCollapseIndicator),(0,p.getAutoFilterPaddingForAdvancedHorizontalAlignment)(t,l,A,P)),b(t,l,e,N,O,h,n),l.PreviewNumFmt&&(0,f.updatePreviewTextFormatting)(e,t,l,N),l.CachedIndent!==(null===(x=l.CachedStyle)||void 0===x?void 0:x.Indentation)&&(N=(0,o.getTextDrawingMaxWidth)(k,(0,c.getCellTextHorizontalPaddingWithoutVisualElements)(t,l),L,(0,C.getExpandCollapseButtonWidth)(null===(D=l.PivotTable)||void 0===D?void 0:D.HasExpandCollapseIndicator),(0,p.getAutoFilterPaddingForAdvancedHorizontalAlignment)(t,l,A,P)));var E=l.PhonInfo?R.PhoneticTextHeightPx:0,z=(0,s.getDisplayText)(l,t),W=(0,s.getFormattedText)(z,l,t),G=(0,S.shouldDrawSpillCell)(l),V=(0,S.shouldDrawWrapText)(l),j=(0,S.getCellClipping)(t,l,e,N,W,V,G,k,v,L,m,O);(0,F.shouldDrawRotatedText)(t,l.CachedStyle,l.CachedFont)?(0,w.drawRotatedText)(e,t,l,n,z,N,v,B,E,W,j):function(e,t,n,l,s,f,h,C,m,p,y,v,R,F,w,T,I){var x=(0,c.getTextHorizontalPosition)(t,n,l),b=(0,c.getTextVerticalPosition)(n,t,C+m,s,v,void 0).absoluteY;if(F){(0,d.verifyArgumentNotNull)(I,"clipRect","drawSingleCellText");var D=(0,o.getContainerClipMaskWidth)(f),A=(0,g.isCellSpansMultipleRowsOrBlocks)(n);(0,u.drawWrapText)(e,l,t,n,y,x,h,I,D,s,A,C,T)}else n.Merge?function(e,t,n,o,l,a,s,d,u,c){var g;c?(0,i.fillTextClipped)(e,t,a,s,d,c,o,n,(null===(g=o.CachedStyle)||void 0===g?void 0:g.HorizontalAlignment)===r.HorizontalAlignment.Fill,l):(0,i.fillTextUnclipped)(e,a,s,d,u,o,n,t)}(e,l,t,n,T,y,x,b,h,I):R?(0,a.drawSpillCellText)(e,l,t,n,y,x,b,I,w,p,T):(0,S.shouldClipText)(n,T,w)?((0,d.verifyArgumentNotNull)(I,"clipRect","drawSingleCellText"),(0,i.fillTextClipped)(e,l,y,x,b,I,n,t,w,T)):(0,i.fillTextUnclipped)(e,y,x,b,h,n,t,l)}(e,t,l,n,v,k,N,B,E,L,z,M,G,V,O,W,j)}function b(e,t,n,o,i,l,a){(0,r.isChangeGateEnabled)(r.ChangeGate.CanvasTextMeasure)?(0,y.trackDuration)(y.RenderPerformanceMetric.DrawTextUpdateCellContext,(function(){(0,m.updateContextForCurrentCell)(n,l,t,e,a.highContrastScheme)}),!0,!0):(0,m.updateContextForCurrentCell)(n,l,t,e,a.highContrastScheme),(0,r.shouldOverrideText)(t)&&(0,f.updateNumberFormattingInformation)(n,e,t,o,a.zoom,a.devicePixelRatio),i&&(0,h.updateCachedDisplayTextForFill)(n,e,t,a)}t.drawText=function(e,t,n){!function(e,t,n){var a,u,f,h;(0,d.verifyArgumentNotNull)(e,"ctx","drawCellsText"),(0,d.verifyArgumentNotNull)(t,"model","drawCellsText"),(0,d.verifyArgumentNotNull)(n,"context","drawCellsText"),(0,d.verifyArgumentNotNull)(t.RowOffsets,"model.RowOffsets","drawCellsText"),(0,d.verifyArgumentNotNull)(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),(0,d.verifyArgumentNotNull)(t.RowHeights,"model.RowHeights","drawCellsText"),(0,d.verifyArgumentNotNull)(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),(0,d.verifyArgumentNotNull)(t.Styles,"model.Styles","drawCellsText");for(var C=t.ClientOnlyCache.CellsToRender,p=t.BlockWidth,v=[],S=function(e,t,n){var r=(0,m.getDefaultContextState)(t,n.IsRtl);return e.direction=r.direction,e.fillStyle=r.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",function(e){Array.isArray(e.getLineDash())&&0!==e.getLineDash().length&&e.setLineDash([])}(e),r}(e,n.highContrastScheme,t),R=void 0,F=-1,w=function(d){var w=C[d];if(!w)return"continue";if((0,o.isArrayFormulaChildInFormulaView)(w,n))return"continue";if((0,r.isRenderFlagEnabled)(r.RenderFlagsArray.InCellControls,t)&&(0,T.shouldDrawInCellControl)(w))return"continue";if(!(w.Text||w.PreviewText||w.PreviewNumFmt)){if(!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.FormulaViewCellImagesFix,t))return"continue";if(!n.isFormulaView||!w.FormulaInfo)return"continue"}if(0===w.ShrunkSize||0===(null===(a=w.CachedFont)||void 0===a?void 0:a.Size))return"continue";if(!(0,o.cellIntersectsRenderingRegion)(w,n.renderingRegion))return"continue";if(w.CondFormat&&(null===(u=w.CondFormat)||void 0===u?void 0:u.Icon)&&(null===(h=null===(f=w.CondFormat)||void 0===f?void 0:f.Icon)||void 0===h?void 0:h.IconOnly))return"continue";if(w.ShowSkeleton)return"continue";var D=t.RowHeights[w.Row]-l.GridLineWidthPx,A=t.RowOffsets[w.Row];if(w.Row!==F&&(-1!==F&&(S=function(e,t,n,r){return(0,o.restoreClipping)(n,r),(0,m.getDefaultContextState)(e,t)}(n.highContrastScheme,t.IsRtl,e,R)),R={x:0,y:A,width:p,height:D},(0,o.applyClipping)(e,R),F=w.Row),(0,g.isCellSpansMultipleRowsOrBlocks)(w))v.push(w);else if(function(e,t){if(!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.FluentStyle,e)||!(0,r.isChangeGateEnabled)(r.ChangeGate.OptimizeHeaderTextRendering)||(0,I.isNullOrUndefined)(e.IsRow))return!1;if(e.IsRow)return!0;return!t.IsCellSnapped&&(0,s.getColumnWidth)(t.Col,e)>l.MaxColumnHeaderTextWidth}(t,w)){var P=t.IsRow?l.MaxRowHeaderTextWidth:l.MaxColumnHeaderTextWidth;(0,y.trackDuration)(y.RenderPerformanceMetric.DrawHeaderCellTextDurationMs,(function(){!function(e,t,n,r,o,a,s){var d=n.CachedStyle.VerticalAlignment,u=(0,c.getTextHorizontalPosition)(t,n,r),g=(0,c.getTextVerticalPosition)(n,t,l.HeaderTextLineHeight,o,d,void 0).absoluteY;b(t,n,e,a,!1,s,r),(0,i.fillTextUnclipped)(e,n.Text,u,g,a,n,t,r)}(e,t,w,n,D,P,S)}),!0,!0)}else(0,r.isChangeGateEnabled)(r.ChangeGate.OptimizeHeaderTextRendering)?(0,y.trackDuration)(y.RenderPerformanceMetric.DrawSingleCellTextDurationMs,(function(){x(e,t,n,w,S,A,D)}),!0,!0):x(e,t,n,w,S,A,D)},D=0;D<C.length;D++)w(D);(0,o.restoreClipping)(e,R),S=(0,m.getDefaultContextState)(n.highContrastScheme,t.IsRtl);for(D=0;D<v.length;D++){var A=v[D],P=(0,g.getCellHeight)(t,A,!1)-l.GridLineWidthPx,H=(0,g.getCellTop)(t,A);x(e,t,n,A,S,H,P)}}(e,t,n),function(e,t,n){(0,y.trackDuration)(y.RenderPerformanceMetric.HyperlinkEventRegistrationMs,(function(){return(0,v.registerHyperlinkEventHandlers)(e,t,n)}))}(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillTextClipped=t.fillTextUnclipped=void 0;var r=n(31),o=n(2),i=n(41),l=n(69),a=n(14),s=n(0);t.fillTextUnclipped=function(e,t,n,r,o,l,a,s){if(o>0){e.fillText(t,n,r,o);var d={textPositionX:n,textPositionY:r};(0,i.measureAndCacheTextDecorationLayout)(e,a,l,s,d)}},t.fillTextClipped=function(e,t,n,d,u,c,g,f,h,C){if((0,o.applyClipping)(e,c),!C&&(0,a.shouldRenderVerticalText)(g))(0,l.fillVerticalText)(e,f,g,n,d,u,t,c);else if(!C||h||g.DisplayFormula||(0,s.isCellPreviewTextDefined)(g.PreviewText)){e.fillText(n,d,u);var m={textPositionX:d,textPositionY:u,clipRect:c};(0,i.measureAndCacheTextDecorationLayout)(e,f,g,t,m)}else(0,r.fillRichTextFormat)(e,t,f,g,C,d,u,c);(0,o.restoreClipping)(e,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellHasBottomDoubleBorder=t.drawBorders=t.clearGridLinesForBorder=void 0;var r,o=n(1),i=n(2),l=n(7),a=n(3),s=n(0),d=n(115),u=n(6),c=n(0),g=n(5),f={},h={};function C(e){(0,g.verifyArgumentNotNull)(e,"model","validateModel"),(0,g.verifyArgumentNotNull)(e.RowOffsets,"model.RowOffsets","validateModel"),(0,g.verifyArgumentNotNull)(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),(0,g.verifyArgumentNotNull)(e.RowHeights,"model.RowHeights","validateModel"),(0,g.verifyArgumentNotNull)(e.ColumnWidths,"model.ColumnWidths","validateModel")}function m(e,t){return{BorderLineStyle:o.BorderLineType.Thin,Color:t,Weight:a.ThinBorderWeight,BorderPosition:e}}function p(e,t,n,l){var a,s,d=(null===(a=n.CachedStyle)||void 0===a?void 0:a.BackgroundColor)?(0,i.hexToRgb)(null===(s=n.CachedStyle)||void 0===s?void 0:s.BackgroundColor):l;if(d===l)switch(t.BorderPosition){case o.BorderPositionType.Top:var u=y(n,r.Top,e);d=u?(0,i.hexToRgb)(u):l;break;case o.BorderPositionType.Left:var c=y(n,r.Left,e);d=c?(0,i.hexToRgb)(c):l}return d}function y(e,t,n){var i,l=void 0;switch(t){case r.Top:e.Row>0&&(l=(0,o.getCell)(e.Row-1,e.Col,n));break;case r.Left:e.Col>0&&(l=(0,o.getCell)(e.Row,e.Col-1,n))}return null===(i=null==l?void 0:l.CachedStyle)||void 0===i?void 0:i.BackgroundColor}function v(e,t,n,r,o,i){var l=F(e,t,n.BorderPosition,r),a=A(n);a in i||(o.push(n),i[a]=[]),i[a].push(l)}function S(e,t,n,r,i){var l=[],s="",d=a.ThinBorderWeight;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=a.ThinBorderWeight}(e),e.beginPath();for(var u=0;u<t.length;u++){var c=t[u],g=i||D(c.Color),f=P(c.BorderLineStyle),h=d!==c.Weight*r,C=s!==g,m=!(0,o.areGridArraysEqual)(l,f,[]).isEqual;(h||C||m)&&(e.stroke(),e.beginPath(),h&&(d=c.Weight*r,e.lineWidth=d),C&&(s=g,e.strokeStyle=g),m&&(e.setLineDash(f),l=f));for(var p=n[A(c)],y=0;y<p.length;y++){var v=p[y];R(e,c.Weight,v,r)}}e.stroke()}function R(e,t,n,r){!function(e){return e.Y1===e.Y2}(n)?(0,i.drawLine)(e,b(n.X1,t,r),n.Y1-r,b(n.X2,t,r),n.Y2):(0,i.drawLine)(e,n.X1-r,b(n.Y1,t,r),n.X2,b(n.Y2,t,r))}function F(e,t,n,r){if(!e.IsRtl){var i=(0,o.isChangeGateEnabled)(o.ChangeGate.BlockEdgeBorderThicknessFix)&&M(t,e)||x(e,t,n)?a.GridLineWidthPx:r;return w(n,{X:(0,u.getCellLeftAdjustedForDrawing)(e,t,!1,!1),Y:(0,u.getCellTopAdjustedForDrawing)(e,t,!1)},{X:(0,u.getCellRightAdjustedForDrawing)(e,t,!1)+i,Y:(0,u.getCellBottomAdjustedForDrawing)(e,t)})}var l=(0,o.isChangeGateEnabled)(o.ChangeGate.BlockEdgeBorderThicknessFix)&&M(t,e)||x(e,t,n)?r-a.GridLineWidthPx:0,s=w(n,{X:(0,u.getCellRightAdjustedForDrawing)(e,t,!1)+r,Y:(0,u.getCellTopAdjustedForDrawing)(e,t,!1)},{X:(0,u.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+l,Y:(0,u.getCellBottomAdjustedForDrawing)(e,t)});if(n===o.BorderPositionType.Top||n===o.BorderPositionType.Bottom){var d=s.X2;s.X2=s.X1,s.X1=d}return s}function w(e,t,n){switch(e){case o.BorderPositionType.Top:return{X1:t.X,Y1:t.Y,X2:n.X,Y2:t.Y};case o.BorderPositionType.Bottom:return{X1:t.X,Y1:n.Y,X2:n.X,Y2:n.Y};case o.BorderPositionType.Right:return{X1:n.X,Y1:t.Y,X2:n.X,Y2:n.Y};case o.BorderPositionType.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:n.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function T(e){switch(e){case o.BorderLineType.Thin:case o.BorderLineType.Medium:case o.BorderLineType.Hair:case o.BorderLineType.Thick:return!0;default:return!1}}function I(e,t,n){return!!M(n,t)||(!!x(t,n,e)||(n.HasError?B(e):e===o.BorderPositionType.Top||e===o.BorderPositionType.Left))}function x(e,t,n){return!(!t.Merge&&!(0,s.isCellAdjacentToMergedCell)(t.Row,t.Col,e))&&B(n)}function b(e,t,n){var r=(0,s.getLinePixelTranslation)(n);return t===a.MediumBorderWeight&&n%2==1?e:e-r}function D(e){var t=e.Red+"_"+e.Green+"_"+e.Blue,n=f[t];return(0,l.isNullOrUndefined)(n)?(n="rgb(".concat(e.Red,",").concat(e.Green,",").concat(e.Blue,")"),f[t]=n,n):n}function A(e){return"".concat(D(e.Color),"-").concat(e.Weight,"-").concat(e.BorderLineStyle)}function P(e){var t=h[e];if(!(0,l.isNullOrUndefined)(t))return t;switch(e){case o.BorderLineType.Dotted:t=a.DottedLineDash;break;case o.BorderLineType.DashDot:case o.BorderLineType.MediumDashDot:t=a.DashedDotLineDash;break;case o.BorderLineType.DashDotDot:case o.BorderLineType.MediumDashDotDot:t=a.DashedDotDotLineDash;break;case o.BorderLineType.MediumDashed:t=a.MediumDashedLineDash;break;case o.BorderLineType.SlantDashDot:case o.BorderLineType.Dashed:t=a.DashedLineDash;break;default:t=[]}return h[e]=t,t}function H(e){return e.HasError?a.FormulaErrorBorderStyle:e.CachedBorderStyle}function B(e){return e<=o.BorderPositionType.Right}function M(e,t){return e.Row===t.RowNumbers.length-1||e.Col===t.ColumnNumbers.length-1}!function(e){e[e.Top=0]="Top",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom"}(r||(r={})),t.clearGridLinesForBorder=function(e,t,n){if(t.ShowGridLines&&(0,i.shouldRenderGridLines)((0,s.isHighContrastMode)(n),(0,s.hasWorkbookBackgroundColor)(t.BackgroundColor))){C(t),(0,d.setContextForClearingGridLine)(e,n,t.BackgroundColor);var r=t.ClientOnlyCache.GridlineOverridingCellsToRender;e.beginPath();for(var l=0;l<r.length;l++){var u=r[l],c=H(u);if((0,i.cellIntersectsRenderingRegion)(u,n.renderingRegion)&&(c&&c.Borders&&0!==c.Borders.length&&!u.CachedStyle.BackgroundColor))for(var g=c.Borders,f=0;f<g.length;f++){var h=g[f];h.BorderLineStyle!==o.BorderLineType.None&&(T(h.BorderLineStyle)||I(h.BorderPosition,t,u)&&R(e,a.ThinBorderWeight,F(t,u,h.BorderPosition,a.GridLineWidthPx),a.GridLineWidthPx))}}e.stroke()}},t.drawBorders=function(e,t,n){C(t);var r,l,a=(0,i.getDefaultBorderLineWidth)(n.scaleFactor),d=(0,s.getWorkbookBackgroundColor)(n.highContrastScheme,t.BackgroundColor),u=function(e,t,n,r){for(var l={},a=[],s=[],d={},u=e.ClientOnlyCache.GridlineOverridingCellsToRender,c=0;c<u.length;c++){var g=u[c],f=H(g);if(((0,i.cellIntersectsRenderingRegion)(g,r.renderingRegion)||(F=g,w=r.renderingRegion,T=void 0,x=void 0,T=F.Col===w.endColumn+1&&F.Row>=w.startRow&&F.Row<=w.endRow,x=F.Row===w.endRow+1&&F.Col>=w.startColumn&&F.Col<=w.endColumn,T||x))&&(f&&f.Borders&&0!==f.Borders.length))for(var h=f.Borders,C=0;C<h.length;C++){var y=h[C];if(y.BorderLineStyle!==o.BorderLineType.None&&I(y.BorderPosition,e,g)){if(y.BorderLineStyle===o.BorderLineType.Double){var S=g.CachedStyle.BackgroundColor?(0,i.hexToRgb)(g.CachedStyle.BackgroundColor):n;(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.DoubleBorderFormattingFix,e)&&(S=p(e,y,g,n));var R=m(y.BorderPosition,S);v(e,g,R,t,s,d)}v(e,g,y,t,a,l)}}}var F,w,T,x;return{distinctBorderTypes:a,borderTypeToLineMap:l,distinctClearingDoubleBorderTypes:s,clearingDoubleBordersToLineMap:d}}(t,a,(0,i.hexToRgb)(d),n);n.highContrastScheme?(l=(0,c.rgbToColorHex)(n.highContrastScheme.TextColor),r=(0,c.rgbToColorHex)(n.highContrastScheme.BackgroundColor),S(e,u.distinctBorderTypes,u.borderTypeToLineMap,a,l),S(e,u.distinctClearingDoubleBorderTypes,u.clearingDoubleBordersToLineMap,a,r)):(S(e,u.distinctBorderTypes,u.borderTypeToLineMap,a,void 0),S(e,u.distinctClearingDoubleBorderTypes,u.clearingDoubleBordersToLineMap,a,void 0))},t.cellHasBottomDoubleBorder=function(e,t){(0,g.verifyArgumentNotNull)(e,"cell","cellHasBottomDoubleBorder");var n=(0,o.getCell)(e.Row+1,e.Col,t);if((0,l.isNullOrUndefined)(n)||(0,l.isNullOrUndefined)(n.CachedBorderStyle)||(0,l.isNullOrUndefined)(n.CachedBorderStyle.Borders))return!1;for(var r=n.CachedBorderStyle.Borders,i=0;i<r.length;i++){var a=r[i];if(a.BorderPosition===o.BorderPositionType.Top&&a.BorderLineStyle===o.BorderLineType.Double)return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearGridLinesForPivotTables=t.setContextForClearingGridLine=t.clearGridLinesForSpannedCells=void 0;var r=n(0),o=n(5),i=n(2),l=n(56),a=n(7),s=n(6),d=n(3),u=n(67);function c(e,t,n){var o=(0,r.getWorkbookBackgroundColor)(t.highContrastScheme,n);e.strokeStyle=o,e.lineWidth=d.GridLineWidthPx,e.setLineDash(d.DefaultDash)}function g(e,t,n,r,o){var a=e.Col,u=e.Col,c=n.ClientOnlyCache.ColOffsetsAdjustedForDrawing;e.Merge?(u+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(u=c.length-1)):e.Spill&&(a-=e.Spill.SpanToStart,u+=e.Spill.SpanToEnd),a=Math.max(0,a),u=Math.min(n.ColumnNumbers.length,u);for(var g=(0,s.getCellHeightAdjustedForDrawing)(n,e),f=(0,s.getCellTopAdjustedForDrawing)(n,e,!1),h=g-d.GridLineWidthPx,C=a;C<u;C++){var m=(0,l.getAdjustedDrawingOffset)(c[C],(0,i.getColWidthFromOffsets)(C,c),r,o);(0,i.drawLine)(t,m,f,m,f+h)}}function f(e,t,n,r,o){var a=e.Row,u=e.Row+e.Merge.Rows,c=n.ClientOnlyCache.RowOffsetsAdjustedForDrawing;a=Math.max(0,a),u=Math.min(n.RowNumbers.length,u),e.Merge.SpansNextBlockVertically&&(u=c.length-1);for(var g=(0,s.getCellLeftAdjustedForDrawing)(n,e,n.IsRtl,!1),f=(0,s.getCellWidthAdjustedForDrawing)(n,e)-d.GridLineWidthPx,h=a;h<u;h++){var C=(0,l.getAdjustedDrawingOffset)(c[h],(0,i.getRowHeightFromOffsets)(h,c),r,o);(0,i.drawLine)(t,g,C,g+f,C)}}t.clearGridLinesForSpannedCells=function(e,t,n){if((0,o.verifyArgumentNotNull)(t,"model","clearGridLinesForText"),(0,o.verifyArgumentNotNull)(e,"ctx","clearGridLinesForText"),(0,o.verifyArgumentNotNull)(n,"context","clearGridLinesForText"),t.ShowGridLines&&(0,i.shouldRenderGridLines)((0,r.isHighContrastMode)(n),(0,r.hasWorkbookBackgroundColor)(t.BackgroundColor))){var u=t.ClientOnlyCache.CellsToRender,h=(0,r.getLinePixelTranslation)(d.GridLineWidthPx),C=(0,l.getMaxLineOffset)(t.BlockWidth,n.scaleFactor,!1),m=(0,l.getMaxLineOffset)(t.BlockHeight,n.scaleFactor,!0);c(e,n,t.BackgroundColor),e.beginPath();for(var p=0;p<u.length;p++){var y=u[p],v=!(0,a.isNullOrUndefined)(y)&&!(0,a.isNullOrUndefined)(y.Spill),S=!(0,a.isNullOrUndefined)(y)&&!(0,a.isNullOrUndefined)(y.Merge)&&((0,a.isNullOrUndefined)(y.CachedStyle.BackgroundColor)||!(0,a.isNullOrUndefined)(n.highContrastScheme));(0,i.cellIntersectsRenderingRegion)(y,n.renderingRegion)&&((v||S)&&(g(y,e,t,h,C),S&&(0,s.isCellSpansMultipleRowsOrBlocks)(y)&&f(y,e,t,h,m)))}e.stroke()}},t.setContextForClearingGridLine=c,t.clearGridLinesForPivotTables=function(e,t,n){if((0,o.verifyArgumentNotNull)(t,"model","clearGridLinesForEmptyPivotTables"),(0,o.verifyArgumentNotNull)(e,"ctx","clearGridLinesForEmptyPivotTables"),(0,o.verifyArgumentNotNull)(n,"context","clearGridLinesForEmptyPivotTables"),t.ShowGridLines&&(0,i.shouldRenderGridLines)((0,r.isHighContrastMode)(n),(0,r.hasWorkbookBackgroundColor)(t.BackgroundColor))&&t.PivotTables&&0!==t.PivotTables.length){for(var l=!1,s=0;s<t.PivotTables.length;s++){var c=t.PivotTables[s];if(c.HideGridLines&&((c.IsEmptyPivot||!(0,a.isNullOrUndefined)(c.RowHeaderRange))&&(0,u.isPivotIntersectsRenderingRegion)(t,c,n.renderingRegion,!0))){l||(e.fillStyle=(0,r.getWorkbookBackgroundColor)(n.highContrastScheme,t.BackgroundColor),e.beginPath(),l=!0);var g=(0,u.getPivotTableLeftAdjustedForDrawing)(t,c,t.IsRtl),f=(0,u.getPivotTableTopAdjustedForDrawing)(t,c,!0),h=c.OriginPTWidthAdjustedForDrawing-d.GridLineWidthPx,C=c.OriginPTHeightAdjustedForDrawing-d.GridLineWidthPx;e.rect(g,f,h,C)}}l&&e.fill()}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.shouldBreak=t.CombiningClass=void 0,function(e){e[e.Other=1]="Other",e[e.CR=2]="CR",e[e.LF=4]="LF",e[e.Control=8]="Control",e[e.Extend=16]="Extend",e[e.Regional_Indicator=32]="Regional_Indicator",e[e.SpacingMark=64]="SpacingMark",e[e.L=128]="L",e[e.V=256]="V",e[e.T=512]="T",e[e.LV=1024]="LV",e[e.LVT=2048]="LVT",e[e.Prepend=4096]="Prepend",e[e.ZWJ=8192]="ZWJ"}(r||(t.CombiningClass=r={}));var o=0|r.Control|r.CR|r.LF,i=0|r.L|r.V|r.LV|r.LVT,l=0|r.V|r.LV,a=0|r.V|r.T,s=0|r.LVT|r.T;function d(e,t){return 0!=(e&t)}t.shouldBreak=function(e,t){return(e!==r.CR||t!==r.LF)&&(!!d(o,e)||(!!d(o,t)||(e!==r.L||!d(i,t))&&((!d(l,e)||!d(a,t))&&((!d(s,e)||t!==r.T)&&((e!==r.Regional_Indicator||t!==r.Regional_Indicator)&&(t!==r.Extend&&t!==r.ZWJ&&(t!==r.SpacingMark&&e!==r.Prepend)))))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerticalTextPadding=void 0;var r=n(9);t.getVerticalTextPadding=function(e){return(0,r.getIndentationPaddingPx)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClipMaskForSpillCell=t.drawSpillCellText=void 0;var r=n(1),o=n(2),i=n(113),l=n(5),a=n(9),s=n(6),d=n(12);t.drawSpillCellText=function(e,t,n,r,u,c,g,f,h,C,m){(0,l.verifyArgumentNotNull)(r.Spill,"cell.Spill","spillCells.drawSpillCellText");var p=(0,s.getSpillCellWidth)(r,n);if(f)(0,i.fillTextClipped)(e,t,u,c,g,f,r,n,h,m);else{var y=(0,a.getCellTextHorizontalPaddingWithoutVisualElements)(n,r),v=(0,o.getTextDrawingMaxWidth)(p,y,C,(0,d.getExpandCollapseButtonPadding)(r),0);(0,i.fillTextUnclipped)(e,u,c,g,v,r,n,t)}},t.getClipMaskForSpillCell=function(e,t,n,i,l,a,u){var c,g=(0,s.getSpillCellWidth)(t,e);if(t.Spill.IsSpillBlocked||n||(null===(c=t.CachedStyle)||void 0===c?void 0:c.HorizontalAlignment)===r.HorizontalAlignment.CenterAcrossSelection||l){var f=(0,d.getExpandCollapseButtonPadding)(t),h=(0,o.getClipMaskWidth)(g,i,f);return{x:(0,s.getSpillCellStartOffset)(t,e,i,f),y:a,width:h,height:u}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableIntersectsRenderingRegion=t.getIntersectionRange=t.getColumnRightOffset=t.getColumnLeftOffset=t.getRowBottomOffset=t.getRowTopOffset=void 0;var r=n(0),o=n(3);function i(e,t,n,r){return{start:Math.max(e,n),end:Math.min(t,r)}}t.getRowTopOffset=function(e,t){var n,r=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.RowOffsetsAdjustedForDrawing;if(r)return r[t]},t.getRowBottomOffset=function(e,t){var n,r=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.RowOffsetsAdjustedForDrawing;if(r)return r[t+1]},t.getColumnLeftOffset=function(e,t){var n,r=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.ColOffsetsAdjustedForDrawing;if(r)return e.IsRtl?r[r.length-1]-r[t]:r[t]},t.getColumnRightOffset=function(e,t){var n,r=null===(n=e.ClientOnlyCache)||void 0===n?void 0:n.ColOffsetsAdjustedForDrawing;if(r)return e.IsRtl?r[r.length-1]-r[t+1]:r[t+1]},t.getIntersectionRange=i,t.tableIntersectsRenderingRegion=function(e,t,n){return function(e,t,n){var l=i(t.FirstColumn,t.LastColumn,e.FirstColumn,e.LastColumn),a=l.start,s=l.end;return(0,r.intersects1D)((a-1)%o.ColumnCountInBlock,(s-1)%o.ColumnCountInBlock,n.startColumn,n.endColumn)}(e,t,n)&&function(e,t,n){var l=i(t.FirstRow,t.LastRow,e.FirstRow,e.LastRow),a=l.start,s=l.end;return(0,r.intersects1D)((a-1)%o.RowCountInBlock,(s-1)%o.RowCountInBlock,n.startRow,n.endRow)}(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDrawInCellControl=t.drawInCellControls=void 0;var r=n(121),o=n(1),i=n(2);function l(e,t){return null!=e&&(!e.DisplayFormula&&(!(t&&!(0,i.cellIntersectsRenderingRegion)(e,t.renderingRegion))&&(!!e.InCellControlOptions&&(!((0,o.isChangeGateEnabled)(o.ChangeGate.HideCheckboxOnShowFormula)&&t&&(0,i.isArrayFormulaChildInFormulaView)(e,t))&&((!(0,o.isChangeGateEnabled)(o.ChangeGate.CheckboxInCellImageCheck)||!e.InCellImage)&&!(e.InCellControlOptions.Type!==o.InCellControlType.Checkbox||!(0,r.isCellDataValidForCheckboxOrBlankCheckbox)(e)))))))}t.drawInCellControls=function(e,t,n){var i;(0,o.verifyArgumentNotNull)(e,"ctx","drawInCellControls"),(0,o.verifyArgumentNotNull)(t,"model","drawInCellControls"),(0,o.verifyArgumentNotNull)(n,"context","drawInCellControls");for(var a=t.ClientOnlyCache.CellsToRender,s=0;s<a.length;s++){var d=a[s];l(d,n)&&((null===(i=d.InCellControlOptions)||void 0===i?void 0:i.Type)===o.InCellControlType.Checkbox&&(0,r.drawInCellCheckboxControl)(e,t,d,n))}},t.shouldDrawInCellControl=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCellDataValidForCheckboxOrBlankCheckbox=t.drawInCellCheckboxControl=void 0;var r=n(174),o=n(1),i=n(6),l=n(3),a=n(15),s=n(12),d=n(2),u=n(48),c=n(91),g=n(0),f=n(11),h=n(22),C=n(23),m=n(24),p=n(59),y=n(45);function v(e){return!!e.Text&&(e.ValueType===o.CellValueType.Boolean&&void 0!==e.Value)}function S(e){var t;return!e.Text&&!e.CachedDisplayText&&(null===(t=e.InCellControlOptions)||void 0===t?void 0:t.Type)===o.InCellControlType.Checkbox}function R(e,t,n,v,S){var R,F,w=null!==(F=null===(R=n.CachedFont)||void 0===R?void 0:R.Size)&&void 0!==F?F:r.CheckboxDefaultFontSize,T=function(e,t){return(0,s.pointsToPixels)(e,t)}(w,v.scaleFactor),I=function(e,t,n,r,d){var u=function(e,t,n,r,l){var d=(0,a.getEffectiveHorizontalAlignment)(e,t),u=(0,s.getIconHorizontalPadding)(r,l);t.HorizontalAlignmentSet||(d=o.HorizontalAlignment.Center);switch(d){case o.HorizontalAlignment.Fill:case o.HorizontalAlignment.Justify:case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Distributed:case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+u);case o.HorizontalAlignment.Right:return Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-n-u);case o.HorizontalAlignment.Center:return Math.floor((0,i.getCellCenterXAdjustedForDrawing)(e,t,!1)-n/2);default:throw Error("getCheckboxIconHorizontalPosition: Horizontal alignment ".concat(d," is not supported for checkbox icon!"))}}(e,t,d,r,n.scaleFactor),g=(0,o.isChangeGateEnabled)(o.ChangeGate.CellIconBottomPadding)?Math.round(d*l.CellIconBottomSizeRatioPadding):0,f=(0,c.getIconVerticalPosition)(e,t,n.scaleFactor,d),h=f-d-g;e.RowOffsets[t.Row+1]-f>h-e.RowOffsets[t.Row]&&(h+=g);return{x:u,y:h,width:d,height:d}}(t,n,v,w,T),x=(0,u.getClipRect)(t,n,I.x,I.y,T,!1);(0,d.applyClipping)(e,x),function(e,t,n,i,a,s){var d,c,v=s?r.BlankCheckboxOpacity:r.CheckboxOpacity;!function(e,t,n,i,a){var s,d=e.globalAlpha,u=e.textAlign,c=e.textBaseline;e.textAlign="left",e.textBaseline="alphabetic",function(e,t,n,r){var o,i,a=n.highContrastScheme;e.fillStyle=a?(0,g.rgbToColorHex)(a.TextColor):null!==(i=null===(o=t.CachedFont)||void 0===o?void 0:o.Color)&&void 0!==i?i:l.DefaultCellFontColor,e.font=(s=r.width,"".concat(s,"px ").concat(l.CellFontUnicodeFontFamily));var s}(e,t,n,i);var f="1"===t.Value||"true"===t.Value,h=String.fromCharCode(null!==(s=function(e){if((0,o.isChangeGateEnabled)(o.ChangeGate.CheckboxFallbackFont)&&(0,y.getFontLoadStatus)(l.CellFontUnicodeFontFamily)!==y.FontLoadStatus.Loaded)return e?r.CheckboxTrueFallbackFont:r.CheckboxFalseFallbackFont;return e?r.CheckboxTrueYellowFont:r.CheckboxFalseYellowFont}(f))&&void 0!==s?s:r.CheckboxFalseYellowFont),C=i.x,m=i.y,p=i.height,v=m+p;e.globalAlpha=a,e.fillText(h,C,v),e.globalAlpha=d,e.textAlign=u,e.textBaseline=c}(e,n,i,a,v);(null===(d=n.FormulaInfo)||void 0===d?void 0:d.FormulaType)!==o.CellFormulaType.ArrayFormula&&(null===(c=n.FormulaInfo)||void 0===c?void 0:c.FormulaType)!==o.CellFormulaType.Formula&&function(e,t,n,r,i){var l,a=r.y+r.height;if((0,u.shouldClipHorizontally)(e,t,r.x,r.width,!1)||(0,u.shouldClipVertically)(e,t,a,r.width)){var s=(0,u.getClippedDrawingContext)(e,t,n,r);l=(0,C.getUnadjustedHitRegionFromRect)(e,n,s,!1)}else l=(0,C.getUnadjustedHitRegionFromRect)(e,n,r,!1);var d=p.gridRendererStrings.inCellControlCheckboxTooltip?p.gridRendererStrings.inCellControlCheckboxTooltip:void 0,c=(0,o.getRenderingRegionHitTestCache)(e,(0,g.getRenderingRegionKey)(n.renderingRegion));!function(e,t,n,r,i,l){if((0,o.isChangeGateEnabled)(o.ChangeGate.CursorChangeOnIsEditMode)){(0,h.registerCursorHitRegion)(e,t,n,m.PointerCursorType,r,(function(e){return!(0,f.isEditing)()}))}else(0,h.registerCursorHitRegion)(e,t,n,m.PointerCursorType,r);(0,h.registerHitRegion)(e,t,n,r,l,m.ClickEventType),(0,o.isChangeGateEnabled)(o.ChangeGate.RapidClicksOnCheckbox)&&(0,h.registerHitRegion)(e,t,n,r,l,m.DoubleClickEventType);i&&(0,h.registerTooltipHitRegion)(e,t,n,i,r)}(t,c,l,o.RenderFeaturesZIndex.CheckboxIcon,d,i)}(t,n,i,a,(function(e){return(0,f.handleRibbonCommand)(e,t.RibbonCommands.ToggleInCellControlCheckbox,"",void 0,n.Row,n.Col),!0}))}(e,t,n,v,I,S),(0,d.restoreClipping)(e,x)}t.drawInCellCheckboxControl=function(e,t,n,r){(0,o.verifyArgumentNotNull)(e,"ctx","drawInCellCheckboxControl"),(0,o.verifyArgumentNotNull)(t,"model","drawInCellCheckboxControl"),(0,o.verifyArgumentNotNull)(r,"context","drawInCellCheckboxControl"),(0,o.verifyArgumentNotNull)(n,"cell","drawInCellCheckboxControl"),v(n)?R(e,t,n,r,!1):S(n)&&R(e,t,n,r,!0)},t.isCellDataValidForCheckboxOrBlankCheckbox=function(e){return v(e)||S(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawHeaderCellsBackgroundFill=t.drawGridCellsBackgroundFill=void 0;var r,o=n(1),i=n(2),l=n(6),a=n(0),s=n(5),d=n(7),u=n(3),c=n(175);function g(e,t,n,i,a,s){var d=(0,l.getCellDimensionsAdjustedForDrawing)(t,n,!1);if(i===r.Gradient)return(0,c.fillCellWithGradientBackground)(e,n.CachedStyle.Gradient,d,a);var g=function(e,t,n){if(t===r.FormulaParseError)return u.FormulaErrorBackgroundColor;if(n&&e.CachedStyle.BackgroundColor===o.PartialRowColSelectionAndHoverBackgroundColor)return o.PartialRowColSelectionBackgroundColor;return e.CachedStyle.BackgroundColor}(n,i,s);return a!==g&&(e.fillStyle=g),e.fillRect(d.x,d.y,d.width,d.height),g}function f(e){return e.HasError?r.FormulaParseError:(0,d.isNullOrUndefined)(e.CachedStyle.Gradient)?(0,d.isNullOrUndefined)(e.CachedStyle.BackgroundColor)?r.None:r.Solid:r.Gradient}t.drawGridCellsBackgroundFill=function(e,t,n){if((0,s.verifyArgumentNotNull)(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),(0,s.verifyArgumentNotNull)(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),(0,s.verifyArgumentNotNull)(t.RowHeights,"model.RowHeights","drawBackgroundFill"),(0,s.verifyArgumentNotNull)(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),(0,s.verifyArgumentNotNull)(t.Styles,"model.Styles","drawBackgroundFill"),!n.highContrastScheme){for(var o,a=[],d=t.ClientOnlyCache.GridlineOverridingCellsToRender,u=0;u<d.length;u++){(h=f(c=d[u]))!==r.None&&((0,i.cellIntersectsRenderingRegion)(c,n.renderingRegion)&&((0,l.isCellSpansMultipleRowsOrBlocks)(c)?a.push([c,h]):o=g(e,t,c,h,o)))}for(u=0;u<a.length;u++){var c,h,C=a[u];o=g(e,t,c=C[0],h=C[1],o)}}},t.drawHeaderCellsBackgroundFill=function(e,t,n,l){if(!(0,d.isNullOrUndefined)(t.Cells))for(var s,u,c=(0,a.isHighContrastMode)(n),h=t.ClientOnlyCache.CellsToRender,C=0;C<h.length;C++){var m=h[C];if(f(m)!==r.None&&(0,i.cellIntersectsRenderingRegion)(m,n.renderingRegion)){var p=m.CachedStyle.BackgroundColor;if(l){if(c&&((u=p)!==o.PartialRowColSelectionAndHoverBackgroundColor&&u!==o.PartialRowColSelectionBackgroundColor))continue}else if(c&&p!==o.PartialRowColSelectionBackgroundColorBeforeFluent)continue;s=g(e,t,m,r.Solid,s,c)}}},function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSymbols=void 0;var r=n(0),o=n(5),i=n(20),l=n(27),a=n(28),s=n(44),d=n(72),u=n(19);function c(e,t,n,r,o,i,a){var s={left:t,bottom:n,outerColor:a,height:r,width:o,innerColor:i};(0,l.drawRectangle)(e,s)}t.drawSymbols=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawSymbols"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawSymbols");var n=t.image,g=t.highContrastScheme,f=function(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:return a.SymbolHighInnerColor;case i.CFIconImage.SymbolMedium:return a.SymbolMediumInnerColor;case i.CFIconImage.SymbolLow:return a.SymbolLowInnerColor;case i.CFIconImage.CircleSymbolHigh:case i.CFIconImage.CircleSymbolMedium:case i.CFIconImage.CircleSymbolLow:return a.CircleSymbolInnerShapeInnerColor;default:throw Error("getSymbolInnerColor: unsupported image type = ".concat(e))}}(n,g),h=function(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:return a.SymbolHighOuterColor;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:return a.SymbolMediumOuterColor;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:return a.SymbolLowOuterColor;default:throw Error("getSymbolOuterColor: unsupported image type = ".concat(e))}}(n,g);switch(n){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:!function(e,t,n,r){var o,l=t.size,a=t.left,d=t.bottom,c=t.image;switch(c){case i.CFIconImage.SymbolHigh:var g=a+u.ShapeLinesAdjustment;o=function(e,t,n){var r=t-n,o=e+i.CheckMarkMiddleXRatio*n,l={x:e+i.CheckMarkTopLeftXRatio*n,y:i.CheckMarkTopLeftYRatio*n+r},a={x:e+i.CheckMarkTopMiddleXRatio*n,y:i.CheckMarkTopMiddleYRatio*n+r},s={x:o,y:i.CheckMarkBottomYRatio*n+r},d={x:e+n,y:i.CheckMarkMiddleRightYRatio*n+r},u={x:e+i.CheckMarkTopRightXRatio*n,y:i.CheckMarkTopRightYRatio*n+r},c={x:o,y:i.CheckMarkMiddleYRatio*n+r};return[l,a,s,d,u,c,l]}(g,d,l);break;case i.CFIconImage.CircleSymbolHigh:o=function(e,t,n){var r=t-n,o=e+i.CircledCheckMarkMiddleXRatio*n,l={x:e+i.CircledCheckMarkTopLeftXRatio*n,y:i.CircledCheckMarkTopLeftYRatio*n+r},a={x:e+i.CircledCheckMarkTopMiddleXRatio*n,y:i.CircledCheckMarkTopMiddleYRatio*n+r},s={x:o,y:i.CircledCheckMarkBottomYRatio*n+r},d={x:e+i.CircledCheckMarkMiddleRightXRatio*n,y:i.CircledCheckMarkMiddleRightYRatio*n+r},u={x:e+i.CircledCheckMarkTopRightXRatio*n,y:i.CircledCheckMarkTopRightYRatio*n+r},c={x:o,y:i.CircledCheckMarkMiddleYRatio*n+r};return[l,a,s,d,u,c,l]}(a,d,l);break;default:throw Error("drawCheckMark: unsupported image type = ".concat(c))}(0,s.drawIconFromPoints)(e,n,r,o)}(e,t,f,h);break;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:!function(e,t,n,r){var o=t.image;switch(o){case i.CFIconImage.SymbolMedium:!function(e,t,n,r){var o=t.size,a=t.left,s=t.bottom,d=Math.floor(o*i.ExclamationMarkTopRectHeightSizeRatio),u=Math.floor(o*i.ExclamationMarkBottomRectHeightSizeRatio),g=Math.floor(o*i.ExclamationMarkWidthRectSizeRatio),f=d+Math.max(i.ExclamationMarkMinSpaceBetweenRectangels,Math.floor(i.ExclamationMarkSpaceBetweenRectanglesRatio*o)),h=Math.floor(i.ExclamationMarkLeftRectanglePaddingRatio*o),C=a+h;c(e,C,s-(o-d),d,g,n,r),function(e,t,n,r,o,i,a,s,d){var u={left:t,bottom:n-(r-d-o),outerColor:s,height:o,width:i,innerColor:a};(0,l.drawRectangle)(e,u)}(e,C,s,o,u,g,n,r,f)}(e,t,n,r);break;case i.CFIconImage.CircleSymbolMedium:!function(e,t,n,r){var o=t.size,l=t.left,a=t.bottom,s=t.image,g=o-2*i.CircledExclamationMarkPaddingFromCircle,f=Math.floor(g*i.CircledExclamationMarkTopRectHeightSizeRatio),h=function(e){var t=Math.floor(e*i.CircledExclamationMarkWidthRectSizeRatio);return t%2==0?t-1:t}(f),C=l+o/2,m=Math.round(C-(h+1)/2),p=a-i.CircledExclamationMarkPaddingFromCircle,y=function(e){var t=Math.floor(e*i.CircledExclamationMarkLeftCircleSizeRatio);return t%2==0?t:t-1}(g),v=function(e,t,n){return e+u.ShapeLinesAdjustment-(t-n)/2}(m,y,h),S={image:s,bottom:p,highContrastScheme:void 0,left:v,size:y},R=Math.floor(a-i.CircledExclamationMarkPaddingFromCircle-(y+1));c(e,m,R,f,h,n,r),(0,d.drawCircle)(e,S,r,n)}(e,t,n,r);break;default:throw Error("drawExclamationMark: unsupported image type = ".concat(o))}}(e,t,f,h);break;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:!function(e,t,n,r){var o,l=t.size,a=t.left,d=t.bottom,c=t.image;switch(c){case i.CFIconImage.SymbolLow:var g=a+u.ShapeLinesAdjustment;o=function(e,t,n){var r=t-n,o=i.CrossMarkOuterSmallPaddingRatio*n,l=o+e,a=o+r,s=i.CrossMarkOuterBigPaddingRatio*n,d=s+e,u=s+r,c=i.CrossMarkInnerSmallPaddingRatio*n,g=c+e,f=c+r,h=i.CrossMarkInnerCenterRatio*n,C=h+e,m=h+r,p=i.CrossMarkInnerBigPaddingRatio*n,y={x:l,y:r};return[y,{x:e,y:a},{x:g,y:m},{x:e,y:u},{x:l,y:n+r},{x:C,y:p+r},{x:d,y:n+r},{x:e+n,y:u},{x:e+p,y:m},{x:e+n,y:a},{x:d,y:r},{x:C,y:f},y]}(g,d,l);break;case i.CFIconImage.CircleSymbolLow:o=function(e,t,n){var r=(R=n,R%2==1?R+1:R),o=t-n,l=i.CircledCrossMarkOuterSmallPaddingRatio*r,a=l+e,s=l+o,d=i.CircledCrossMarkOuterBigPaddingRatio*r,u=d+e,c=d+o,g=i.CircledCrossMarkInnerSmallPaddingRatio*r,f=g+e,h=g+o,C=i.CircledCrossMarkInnerCenterRatio*r,m=C+e,p=C+o,y=i.CircledCrossMarkInnerBigPaddingRatio*r,v=i.CircledCrossMarkPaddingFromCircleRatio*r,S={x:a,y:o+v};var R;return[S,{x:e+v,y:s},{x:f,y:p},{x:e+v,y:c},{x:a,y:r+o-v},{x:m,y:y+o},{x:u,y:r+o-v},{x:e+r-v,y:c},{x:e+y,y:p},{x:e+r-v,y:s},{x:u,y:o+v},{x:m,y:h},S]}(a,d,l);break;default:throw Error("drawCrossMark: unsupported image type = ".concat(c))}(0,s.drawIconFromPoints)(e,n,r,o)}(e,t,f,h);break;default:throw Error("drawSymbols: unsupported image type = ".concat(n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLineWidth=t.setPageLayoutLine=void 0;var r=n(3),o=n(7),i=n(0);function l(e){return(0,i.isHighContrastMode)(e)?r.HighContrastPageLayoutWidthPx:r.GridLineWidthPx}t.setPageLayoutLine=function(e,t){e.lineWidth=l(t),e.setLineDash(r.DefaultDash),e.strokeStyle=(0,o.isNullOrUndefined)(t.highContrastScheme)?r.PageLayoutLineColor:"".concat((0,i.rgbToColorHex)(t.highContrastScheme.TextColor))},t.getLineWidth=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTextWidthAdjustedForDrawing=t.drawExpandCollapseButtons=void 0;var r=n(1),o=n(3),i=n(6),l=n(15),a=n(57),s=n(2),d=n(9),u=n(19),c=n(0),g=n(10),f=n(14),h=n(67),C=n(12),m=n(22),p=n(11),y=n(24),v=n(93),S=n(30);function R(e,t,n,r){return function(e){if(e.CachedDrawingLayout&&e.CachedDrawingLayout.CellTextLayout&&e.CachedDrawingLayout.CellTextLayout.Width)return!0;return!1}(n)?Math.ceil(n.CachedDrawingLayout.CellTextLayout.Width*r):Math.ceil((0,d.getTextWidthNoCaching)(e,t,n)*r)}function F(e,t,n){var r,o;return!(!(null==n?void 0:n.PivotTable)||!(null==n?void 0:n.PivotTable.CanExpandCollapse))&&(!!(0,s.cellIntersectsRenderingRegion)(n,t.renderingRegion)&&(!(0,c.isCellPreviewTextDefined)(n.PreviewText)&&(!n.ShowSkeleton&&!((null===(o=null===(r=n.CondFormat)||void 0===r?void 0:r.Icon)||void 0===o?void 0:o.IconOnly)&&!(0,h.canCellContainExpandCollapseAndCFIcon)(n,(0,i.getCellWidthAdjustedForDrawing)(e,n),t.scaleFactor)))))}function w(e,t,n,l,a){var s;if(a)return Math.floor((0,i.getCellCenterYAdjustedForDrawing)(e,t)-l/2);var u=null===(s=t.CachedStyle)||void 0===s?void 0:s.VerticalAlignment;if(u===r.VerticalAlignment.Justify)return Math.floor(Math.floor((0,i.getCellCenterYAdjustedForDrawing)(e,t)-l/2));var c=function(e,t,n,r){var l=(0,d.getTextLineHeight)(t,e),a=(0,i.getCellHeight)(e,t,!1)-o.GridLineWidthPx,s=(0,d.getTextVerticalPosition)(t,e,l,a,n,void 0).absoluteY*r,u=l*r/2;return s+o.InCellBottomAndCenterVerticalPaddingPx-u/2}(e,t,u,n);return Math.round(c-l/2)}function T(e,t,n,o,s,u){var g,f=n.scaleFactor,h=a.PaddingBetweenExpandCollapseButtonAndTextPx*f;if(u)return e.IsRtl?Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-h)-o:Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+h);var C=(0,d.getDistanceFromCellStartToIconEnd)(e,t,n.zoom,n.devicePixelRatio),m=0;if((0,r.isChangeGateEnabled)(r.ChangeGate.FixCellImageAlignmentWithRichPivotDrill)){var p=(0,c.getDynamicImageInformationFromCell)(t,S.ImageType.InCellImage);(null==p?void 0:p.Width)&&(m=(null==p?void 0:p.Width)*f)}var y=0;C>0&&t.RichValueIcon&&!(null===(g=t.CondFormat)||void 0===g?void 0:g.Icon)&&(y=C*f,C=0);var v=t.CachedIndent||a.NoIndent,R=(0,d.getCellHorizontalIndentationPaddingPx)(t,v),F=(0,l.getEffectiveHorizontalAlignment)(e,t);if(function(e,t,n,r,o){if(!t.WrapText)return!1;var i=I(e,t,n,o);return t.WrapText&&i<r}(e,t,C,s,f))return function(e,t,n,o,l,s,u,c){var g=function(e,t){if(t)return e===r.HorizontalAlignment.Right;return e===r.HorizontalAlignment.Center||e===r.HorizontalAlignment.Left}(n,e.IsRtl)?(0,d.getCellHorizontalIndentationPaddingPx)(t,o)*c:a.NoIndent;if(e.IsRtl){var f=(0,i.getCellRightAdjustedForDrawing)(e,t,!1);return t.WrapText&&g===a.NoIndent&&n===r.HorizontalAlignment.Left&&u<=0?Math.floor(f):Math.min(Math.floor(f-l-s-g),f)}return Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+l+g)}(e,t,F,v,h,o,I(e,t,C,f),f);var w=(0,d.getTextHorizontalPosition)(e,t,n)*f;switch(F){case r.HorizontalAlignment.Left:if(e.IsRtl)return Math.min(Math.floor(w+s+m+h),t.RichValueIcon?Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-h)-o:Number.MAX_VALUE);var T=(R+C+a.PaddingBetweenExpandCollapseButtonAndTextPx)*f;return Math.floor((0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1)+T);case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return e.IsRtl?Math.min(Math.floor(w+s/2+m/2+h),t.RichValueIcon?Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-h)-o:Number.MAX_VALUE):Math.max(Math.floor(w-s/2-m/2-y-h)-o,(0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1));case r.HorizontalAlignment.Right:return e.IsRtl?Math.floor((0,i.getCellRightAdjustedForDrawing)(e,t,!1)-h-R*f)-o:Math.max(Math.floor(w-s-m-y-h)-o,(0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1));default:throw Error("getAdjustedButtonLeft: unsupported horizontalAlignment: ".concat(F))}}function I(e,t,n,r){var o=(0,i.getCellWidth)(e,t,!1);return(0,s.getTextDrawingMaxWidth)(o,(0,d.getCellTextHorizontalPaddingWithoutVisualElements)(e,t),n,(0,C.getExpandCollapseButtonPadding)(t),0)*r}function x(e,t,n,o){var l=t.PivotTable,a=!!l.ConfirmRequired,s=e.RowNumbers[t.Row]-1,d=e.ColumnNumbers[t.Col]-1,u=function(e){return(0,p.togglePivotDrill)(e,a,s,d,l.SourceIndex),!0},g=(0,i.getAdjustedCellArea)(e,t,!0),f=function(e,t,n){return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:n,isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,g),h=(0,r.getRenderingRegionHitTestCache)(e,(0,c.getRenderingRegionKey)(n.renderingRegion));if(b(t,h,f,y.DoubleClickEventType,u),o&&function(e,t){if(e.x+e.width<t.left)return!1;if(e.x>t.left+t.width)return!1;if(e.y>t.bottom)return!1;if(e.y+e.height<t.bottom-t.height)return!1;return!0}(g,o)){var C=function(e,t,n,r){var o=n.width,i=n.left,l=n.bottom-o,a=o,s=o,d=Math.min(a,r.x+r.width-i),u=Math.max(l,r.y),c=Math.min(l+s,r.y+r.height)-u;return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:Math.max(i,r.x),y:u,width:d,height:c},isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,o,g);b(t,h,C,y.ClickEventType,u);var v=l.ECButtonTitle;(0,m.registerTooltipHitRegion)(t,h,C,v,r.RenderFeaturesZIndex.DrillIndicator),(0,m.registerCursorHitRegion)(t,h,C,y.PointerCursorType,r.RenderFeaturesZIndex.DrillIndicator)}}function b(e,t,n,o,i){(0,m.registerHitRegion)(e,t,n,r.RenderFeaturesZIndex.DrillIndicator,i,o),(0,m.registerHitRegion)(e,t,n,r.RenderFeaturesZIndex.DrillIndicator,y.TouchCallback,"touchstart")}function D(e,t,n,r){var o=n.scaleFactor,i=(0,v.getAdjustedButtonSize)(o,a.ExpandCollapseButtonSizePx),l=R(e,t,r,o),s=(0,f.shouldRenderVerticalText)(r),d=T(t,r,n,i,l,s),u=w(t,r,o,i,s),g=n.highContrastScheme;return{outerColor:g?(0,c.rgbToColorHex)(g.TextColor):a.ExpandCollapseButtonOuterColor,innerColor:g?(0,c.rgbToColorHex)(g.BackgroundColor):a.ExpandCollapseButtonInnerColor,left:d,bottom:u+i,height:i,width:i}}function A(e,t,n,r){return(0,d.getDistanceFromCellStartToIconEnd)(e,t,n.zoom,n.devicePixelRatio)*n.scaleFactor+(t.Spill?(0,i.getSpillCellLeftAdjustedForDrawing)(e,t):(0,i.getCellLeftAdjustedForDrawing)(e,t,!1,!1))>r.left}t.drawExpandCollapseButtons=function(e,t,n){var i,l;if((0,r.verifyArgumentNotNull)(e,"ctx","drawExpandCollapseButtons"),(0,r.verifyArgumentNotNull)(t,"model","drawExpandCollapseButtons"),(0,r.verifyArgumentNotNull)(n,"context","drawExpandCollapseButtons"),t.PivotTables)for(var a=t.ClientOnlyCache.CellsToRender,s=!1,d=0;d<a.length;d++){var c=a[d];if(F(t,n,c)){var f=void 0;if(null===(i=c.PivotTable)||void 0===i?void 0:i.HasExpandCollapseIndicator){if(s||(e.lineWidth=u.ShapeOutlineWidthPx,e.setLineDash(o.DefaultDash),s=!0),e.font=(0,g.getFontCssStringFromFont)(c.CachedFont,void 0,t),f=D(e,t,n,c),(null===(l=c.CondFormat)||void 0===l?void 0:l.Icon)&&A(t,c,n,f))continue;var h=!!c.PivotTable.IsExpanded;(0,v.drawExpandCollapseButton)(e,t,c,f,h,!0)}x(t,c,n,f)}}},t.getTextWidthAdjustedForDrawing=R},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maskDifferentialRenderingAreas=void 0;var r=n(1),o=n(3),i=n(2);function l(e,t){var n=t.x,r=t.y,o=t.width,i=t.height;e.moveTo(n,r),e.lineTo(n+o,r),e.lineTo(n+o,r+i),e.lineTo(n,r+i),e.lineTo(n,r)}function a(e,t){var n=(0,r.getRowColFromCellKey)(t),l=n.row,a=n.column,s=(0,i.getColOffsetAdjustedForDrawing)(a,e);return{x:e.IsRtl?s:s-o.GridLineWidthPx,y:e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[l]-o.GridLineWidthPx,width:(0,i.getColWidthFromOffsets)(a,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+o.GridLineWidthPx,height:(0,i.getRowHeightFromOffsets)(l,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing)+o.GridLineWidthPx}}t.maskDifferentialRenderingAreas=function(e,t){t.save(),t.beginPath();for(var n=0;n<e.ClientOnlyCache.DirtyCellsKeys.length;n++){var r=a(e,e.ClientOnlyCache.DirtyCellsKeys[n]);r&&l(t,r)}t.strokeStyle="transparent",t.stroke(),t.clip()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommentHitRegionProportionConstant=t.CommentWithFilterPaddingPx=t.MinCommentIconSizePx=t.LegacyCommentSizePx=t.LegacyCommentColor=t.ThreadedCommentSizePx=t.ResolvedThreadedCommentColor=t.ActiveThreadedCommentColor=void 0,t.ActiveThreadedCommentColor="#bd67c9",t.ResolvedThreadedCommentColor="#808080",t.ThreadedCommentSizePx=8,t.LegacyCommentColor="#ff0000",t.LegacyCommentSizePx=8,t.MinCommentIconSizePx=4,t.CommentWithFilterPaddingPx=2,t.CommentHitRegionProportionConstant=1.5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRenderer=void 0;var r=n(1),o=n(13),i=n(0),l=n(7),a=n(206),s=n(129),d=n(40),u=n(17),c=function(){function e(){this.isDefaultFontFixEnabled=void 0,this.ctx=null}return e.prototype.render=function(e,t,n){var s,c=this;try{if((0,o.clearPerformanceMetrics)(),!e)return(0,o.createRenderResult)(!1,"render:: canvas is undefined");if(!t)return(0,o.createRenderResult)(!1,"render:: model is undefined");if(!n)return(0,o.createRenderResult)(!1,"render:: context is undefined");if((0,a.loadPolyFills)(t),t.RowOffsets.length>r.MaxAllowedRowColCount)return(0,o.createRenderResult)(!1,"render:: block # of rows = ".concat(t.RowOffsets.length," > MaxAllowedRowColCount"));if(t.ColumnOffsets.length>r.MaxAllowedRowColCount)return(0,o.createRenderResult)(!1,"render:: block # of columns = ".concat(t.ColumnOffsets.length," > MaxAllowedRowColCount"));if((0,o.trackDuration)(o.RenderPerformanceMetric.GetContextDurationMs,(function(){c.ctx=e.getContext2d({alpha:!n.subPixelRenderingEnabled}),void 0===c.isDefaultFontFixEnabled&&(c.isDefaultFontFixEnabled=(0,u.isChangeGateEnabled)("OfficeVSO:8844869_defaultFontCrash")),c.isDefaultFontFixEnabled&&c.ctx?c.ctx.font=d.DefaultCanvasFontString:c.isDefaultFontFixEnabled||(c.ctx.font="".concat(d.DefaultFontSizePt,"pt ").concat(d.DefaultFontName))})),!this.ctx){var g=this.prepareOffscreenCanvasMsg(t);return(0,o.createRenderResult)(!1,"render:: ctx is undefined - ".concat(g))}var f=(0,i.extendRenderingContext)(n);if((0,o.trackDuration)(o.RenderPerformanceMetric.ModelPreparationsMs,(function(){c.preprocessModel(t,n.renderingRegion,f,n.skeletonMode)})),(0,r.isDifferentialRenderingSupported)(t)&&!(0,i.renderingRegionContainsDirtyCells)(n.renderingRegion,t))return(0,o.createRenderResult)(!0,"skipped rendering since rendering region doesn't have dirty cells");if((0,o.trackDuration)(o.RenderPerformanceMetric.RenderInternalDurationMs,(function(){s=c.renderInternal(e,t,f)})),(0,o.trackDuration)(o.RenderPerformanceMetric.RegisterHitRegionsMs,(function(){c.shouldInitializeCanvasHitTest(t,n.skeletonMode)&&c.initializeCanvasHitTest(e,t,f.renderingRegion,f.zoom)})),f.renderingRegion.isRendered=!0,(0,l.isNullOrUndefined)(s)&&(s=(0,o.createRenderResult)(!0,"")),s.message+=this.prepareOffscreenCanvasMsg(t),s.succeeded){var h=(0,o.getRenderingMessage)();s.message=(0,l.isNullOrUndefined)(s.message)?h.message:s.message+"; "+h.message,s.messageLevel=h.level}}catch(e){if((0,u.isChangeGateEnabled)("OfficeVSO:8793204_addTryCatchToRenderer"))return(0,o.createRenderResult)(!1,"exception caught in render: message: ".concat(e.message," name: ").concat(e.name," stack: ").concat(e.stack," error: ").concat(e))}return s},e.prototype.setTransform=function(e,t,n,r,o){t?this.ctx.setTransform(-e,0,0,e,o+n,r):this.ctx.setTransform(e,0,0,e,n,r)},e.prototype.prepareOffscreenCanvasMsg=function(e){var t=(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.UseOffscreenCanvas,e),n=!!t&&(0,i.isOffscreenCanvasSupported)();return"- offscreenCanvasFG: "+(t?"ON offscreenCanvasSupported: ".concat(n):"OFF")},e.prototype.initializeCanvasHitTest=function(e,t,n,o){e.removeAllEventListeners(),(0,s.setHitMapOffsets)(e,t,n),e.setAppZoom(o);var l=(0,r.getRenderingRegionHitTestCache)(t,(0,i.getRenderingRegionKey)(n)),a=l.CellHitRegions;(0,i.registerCanvasHitRegionsFromCache)(a,(function(t){e.addRegionEventListener(t)}));var d=l.CellCursorHitRegions;(0,i.registerCanvasHitRegionsFromCache)(d,(function(t){e.addCursorRegion(t)}));var u=l.CellTooltipHitRegions;(0,i.registerCanvasHitRegionsFromCache)(u,(function(t){e.addTooltipRegion(t)}));var c=l.CellLongPressHitRegions;(0,i.registerCanvasHitRegionsFromCache)(c,(function(t){e.addLongPressRegion(t)})),e.optimizeHitMapLookup()},e}();t.CanvasRenderer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultLongPressState=t.getEventCoordinates=t.areTwoHitRegionsSame=t.hitRegionComparer=t.setHitMapOffsets=void 0;var r=n(0),o=n(13);function i(e,t,n,r,i,l){var a;if(0===r&&n===e.length-1)a=e.slice(0);else{(a=e.slice(t,n+1))[0]=0;for(var s=1;s<a.length;s++)a[s]=a[s]-r,a[s]<0&&((0,o.setRenderingResultInfo)("getHitMapAxisOffsets: Unexpected input params: startOffsetPx: ".concat(r,", startOffset: ").concat(t,", offsets: ").concat(e)),a.splice(s,1),s--)}if(i){a=function(e,t){var n=e.slice(1).map((function(t,n){return t-e[n]})).concat([t-e[e.length-1]]);return e=e.map((function(e,r){return t-e-n[r]})).reverse()}(a,l);for(s=0;s<a.length;s++)a[s]<0&&((0,o.setRenderingResultInfo)("getHitMapAxisOffsets: Unexpected RTL conversion results: index: ".concat(s,", offset: ").concat(a[s])),a.splice(s,1),s--)}return a}t.setHitMapOffsets=function(e,t,n){var r=i(t.ColumnOffsets,n.startColumn,n.endColumn,n.startOffsetX,t.IsRtl,n.endOffsetX),o=i(t.RowOffsets,n.startRow,n.endRow,n.startOffsetY,!1);e.setHitMapOffsets(r,o,t.BlockWidth,t.BlockHeight,n)},t.hitRegionComparer=function(e,t){return t.zIndex-e.zIndex},t.areTwoHitRegionsSame=function(e,t){return e.zIndex===t.zIndex&&(0,r.areTwoRectsEqual)(e.region,t.region)},t.getEventCoordinates=function(e,t){var n=e,r=e;if("touchstart"===t){var o=n.touches[0];return{clientX:o.clientX,clientY:o.clientY}}if("touchend"===t){var i=n.changedTouches.length,l=n.changedTouches[i-1];return{clientX:l.clientX,clientY:l.clientY}}return{clientX:r.clientX,clientY:r.clientY}},t.getDefaultLongPressState=function(){return{callbackScheduled:!1,longPressModeEnabled:!1,callbackId:-1,eventPointerId:-1,lastHitRegion:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFontMargin=t.calculateColWidthForMetadata=void 0;var r=n(1),o=n(0),i=n(10),l=n(9),a=n(3),s=n(12),d=n(66),u=n(18),c=n(46),g=n(31),f=n(21),h=n(90),C=n(8);function m(e){var t=(0,l.measureTextWidth)(e,"1234567890",!0,!0);return Math.ceil(t/10)}t.calculateColWidthForMetadata=function(e,t,n){if(n.CachedStyle||(n.CachedStyle=(0,r.getReferencedObjectById)(n.CellStyleId||0,t.Styles)),n.CachedFont||(n.CachedFont=(0,r.getReferencedObjectById)(n.CachedStyle.FontID||0,t.Fonts)),n.TextRuns){n.CachedFormattedText=(0,o.getFormattedTextForMetadata)(n.Text,n,t);for(var p=n.CachedFormattedText,y=0;y<n.CachedFormattedText.TextRuns.length;y++){var v=p.TextRuns[y],S=v.FontID||0;try{p.TextRuns[y].CachedFont=(0,r.getReferencedObjectById)(S,t.Fonts)}catch(e){return C.ULS.sendTraceTag(520382479,C.LogCategory.msoulscat_ES_EWAJSGrid,C.TraceLevel.Warning,"calculateColWidthForMetadata: Exception in getting FontID: "+S+", ich: "+v.StartIndex+" index: "+y+", ModelFontSize: "+t.Fonts.length),n.SrvDx}}}return function(e,t,n){(0,r.verifyArgumentNotNull)(n.CachedStyle,"CachedStyle","Preproccessor::Helper"),(0,r.verifyArgumentNotNull)(n.CachedFont,"CachedFont","Preproccessor::Helper");var o=0;n.TextRuns&&(o=(0,g.measureFormattedTextWidth)(e,n.CachedFormattedText,t));var C=(0,i.getFontCssStringFromFont)(n.CachedFont,n.CachedFont.Size,t);e.font!==C&&(e.font=C);n.TextRuns||(o=(0,l.measureTextWidth)(e,n.Text,!0,!0));if((0,f.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)){var p=n.TextRuns&&(0,r.isChangeGateEnabled)(r.ChangeGate.FixRotatedTextWidth)?(0,l.getFormattedTextLineHeight)(t,n.CachedFormattedText):(0,l.getFontLineHeight)(t,n.CachedFont.Size,n.CachedFont.FontName);o=(0,h.getRotatedTextWidth)(t,o,p,n.CachedStyle)}var y=function(e,t){var n,r=t.CachedStyle.VerticalText,o=t.CachedStyle.Indentation||0,i=r?0:(0,l.getIndentationPaddingPx)(o),g=(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)?(0,l.getFontLineHeight)(e,t.CachedFont.Size,t.CachedFont.FontName):0,f=function(e,t){var n;if(t.CondWidthIcon){var r=null===(n=t.CachedFont)||void 0===n?void 0:n.Size,o=(0,s.getIconSize)(r,1),i=(0,s.getIconHorizontalPadding)(r,1);return o+i+a.GridLineWidthPx}if(t.RichValueIcon){var l=(0,u.shouldAddAutoFilterPaddingForMetadata)(e,t)?Math.round(c.AutoFilterIconRectPx+c.AutoFilterTextHorizontalPaddingPx):0;return t.IconWidth||0+d.RichValueIconRightHorizontalPadding+l}return 0}(e,t)||0,h=(0,s.getExpandCollapseButtonWidth)(t.ExpandColButton),C=0;t.Autofilter&&(C=c.AutoFilterIconRectPx,(0,u.shouldAddAutoFilterPaddingForMetadata)(e,t)&&(C+=c.AutoFilterTextHorizontalPaddingPx));return i+g+h+f+C}(t,n),v=m(e);return Math.min(Math.round(o+y+v),1790)}(e,t,n)},t.getFontMargin=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlockModelAccessor=void 0;var r=n(1),o=n(8),i=n(18),l=n(2),a=n(0),s=n(6),d=n(5),u=function(){function e(t){this.canvasInstance=null,e.verifyArgumentNotNull(t,"model","constructor"),this.model=t}return e.throwErrorWrapper=function(e,t){(0,a.throwError)(e,"BlockModelAccessor.".concat(t))},e.verifyArgumentNotNull=function(e,t,n){(0,d.verifyArgumentNotNull)(e,t,"BlockModelAccessor.".concat(n))},e.prototype.getColumnWidth=function(e){return(0,a.getColumnWidth)(e,this.model)},e.prototype.getRowHeight=function(t){return e.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(t>this.model.RowHeights.length-1||t<0)&&e.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[t]},e.prototype.getColumnOffset=function(t){return e.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(t>this.model.ColumnOffsets.length-1||t<0)&&e.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[t]},e.prototype.getRowOffset=function(t){return e.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(t>this.model.RowOffsets.length-1||t<0)&&e.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[t]},e.prototype.getRowNumber=function(t){return e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[t]},e.prototype.getColumnNumber=function(t){return e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[t]},e.prototype.getColumnOffsets=function(){var e;return null===(e=this.model.ColumnOffsets)||void 0===e?void 0:e.slice()},e.prototype.setColumnOffsets=function(t){e.verifyArgumentNotNull(t,"newOffsets","setColumnOffsets"),this.model.ColumnOffsets=t,this.setDirty("setColumnOffsets",r.DirtyType.ModelCoreChanges)},e.prototype.getColumnNumbers=function(){var e;return null===(e=this.model.ColumnNumbers)||void 0===e?void 0:e.slice()},e.prototype.setColumnNumbers=function(t){e.verifyArgumentNotNull(t,"newNumbers","setColumnNumbers"),this.model.ColumnNumbers=t,this.setDirty("setColumnNumbers",r.DirtyType.ModelCoreChanges)},e.prototype.getColumnWidths=function(){var e;return null===(e=this.model.ColumnWidths)||void 0===e?void 0:e.slice()},e.prototype.setColumnWidths=function(t){e.verifyArgumentNotNull(t,"newWidths","setColumnWidths"),this.model.ColumnWidths=t,this.setDirty("setColumnWidths",r.DirtyType.ModelCoreChanges)},e.prototype.setIsColumnWidthFixed=function(t,n){this.model.FixedColumns&&((t<0||t>=this.model.FixedColumns.length)&&e.throwErrorWrapper("columnIndex ".concat(t," is out of bounds!"),"setIsColumnWidthFixed"),this.model.FixedColumns[t]=n)},e.prototype.getRowOffsets=function(){var e;return null===(e=this.model.RowOffsets)||void 0===e?void 0:e.slice()},e.prototype.setRowOffsets=function(t){e.verifyArgumentNotNull(t,"newOffsets","setRowOffsets"),this.model.RowOffsets=t,this.setDirty("setRowOffsets",r.DirtyType.ModelCoreChanges)},e.prototype.getRowNumbers=function(){var e;return null===(e=this.model.RowNumbers)||void 0===e?void 0:e.slice()},e.prototype.setRowNumbers=function(t){e.verifyArgumentNotNull(t,"newNumbers","setRowNumbers"),this.model.RowNumbers=t,this.setDirty("setRowNumbers",r.DirtyType.ModelCoreChanges)},e.prototype.getRowHeights=function(){var e;return null===(e=this.model.RowHeights)||void 0===e?void 0:e.slice()},e.prototype.setRowHeights=function(t){e.verifyArgumentNotNull(t,"newHeights","setRowHeights"),this.model.RowHeights=t,this.setDirty("setRowHeights",r.DirtyType.ModelCoreChanges)},e.prototype.getBlockWidth=function(){return this.model.BlockWidth},e.prototype.setBlockWidth=function(e){this.model.BlockWidth=e,this.setDirty("setBlockWidth",r.DirtyType.ModelCoreChanges)},e.prototype.getBlockHeight=function(){return this.model.BlockHeight},e.prototype.setBlockHeight=function(e){this.model.BlockHeight=e,this.setDirty("setBlockHeight",r.DirtyType.ModelCoreChanges)},e.prototype.isDirty=function(){var e,t;return null!==(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.IsDirty)&&void 0!==t&&t},e.prototype.isDirtyDueToViewportChangeOnly=function(){var e;return!!(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyType)&&this.model.ClientOnlyCache.DirtyType===r.DirtyType.ViewportChange},e.prototype.setDirty=function(t,n){e.verifyArgumentNotNull(n,"dirtyType","setDirty"),this.setDirtyInternal(n),o.ULS.sendTraceTag(529278243,o.LogCategory.msoulscat_ES_EWAJSGrid,o.TraceLevel.Info,"BlockModelAccessor::setDirty called, caller ".concat(t)),(0,r.getModelClientCache)(this.model).DisableDiffRendering=!0},e.prototype.onRenderingCompleted=function(){var e=(0,r.getModelClientCache)(this.model);e.DirtyCellsKeys=void 0,e.DisableDiffRendering=!1,e.IsDirty=!1,e.DirtyTimestamp=void 0,e.DirtyType=r.DirtyType.None,e.delayRenderingToNextAnimationFrame=r.DelayRenderToNextAnimationFrameState.None},e.prototype.getColumnIndex=function(t){return e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),(0,a.binarySearch)(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,t,a.numbersComparer)},e.prototype.getRowIndex=function(e){return(0,a.getModelRowIndex)(this.model,e)},e.prototype.getHasTable=function(){return!!this.model.HasTable},e.prototype.getHasOutline=function(){return!!this.model.HasOutline},e.prototype.getHeadersFallbackReason=function(){var e;return null!==(e=this.model.HeadersFallbackReason)&&void 0!==e?e:""},e.prototype.getDirtyTimestamp=function(){var e,t;return null!==(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyTimestamp)&&void 0!==t?t:-1},e.prototype.getMaxRowOutlineLevelInSheet=function(){var e;return null!==(e=this.model.MaxRowOutlineLevelInSheet)&&void 0!==e?e:0},e.prototype.getMaxColOutlineLevelInSheet=function(){var e;return null!==(e=this.model.MaxColOutlineLevelInSheet)&&void 0!==e?e:0},e.prototype.resetCellLookup=function(){(0,r.getModelClientCache)(this.model).CellLookup=(0,r.initCellLookup)(this.model)},e.prototype.setCellsDirty=function(e){if(e){this.ensureDirtyCellsKeysInitialized();var t=(0,r.getModelClientCache)(this.model);t.DirtyCellsKeys=t.DirtyCellsKeys.concat(e),this.setDirtyInternal(r.DirtyType.ModelCellChanges)}},e.prototype.getDirtyCellsCount=function(){var e;return(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyCellsKeys)?this.model.ClientOnlyCache.DirtyCellsKeys.filter(r.uniqueValuesFilter).length:0},e.prototype.getDirtyCellsKeys=function(){var e;return(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyCellsKeys)?this.model.ClientOnlyCache.DirtyCellsKeys:[]},e.prototype.isDifferentialRenderingSupported=function(){var e,t=(0,r.isDifferentialRenderingSupported)(this.model),n=(0,r.getModelClientCache)(this.model),i=(0,r.isChangeGateEnabled)(r.ChangeGate.FixInsertButtonSpill)?this.getDirtyCellsCount():null===(e=n.DirtyCellsKeys)||void 0===e?void 0:e.length;return o.ULS.sendTraceTag(512267551,o.LogCategory.msoulscat_ES_EWAJSGrid,o.TraceLevel.Info,"BlockModelAccessor::isDifferentialRenderingSupported result: ".concat(t,", isDisabled: ").concat(n.DisableDiffRendering,", isDirty: ").concat(n.IsDirty,", dirtyCellsCount: ").concat(i,", delayToNextAnimationFrame: ").concat(n.delayRenderingToNextAnimationFrame)),t},e.prototype.getIsContainedOutlinesByHtmlHeadersData=function(){var e=void 0!==this.model.RowOutlines&&this.model.RowOutlines.length>0,t=void 0!==this.model.ColumnOutlines&&this.model.ColumnOutlines.length>0;return e||t},e.prototype.isRenderFlagEnabled=function(e){return(0,r.isRenderFlagEnabled)(e,this.model)},e.prototype.overrideHeaderDragImprovementsRenderFlag=function(e){(0,r.overrideRenderFlagForMismatch)(this.model,r.RenderFlagsArray.HeaderDragImprovements,e)},e.prototype.overrideFluentStyleRenderFlag=function(e){(0,r.overrideRenderFlagForMismatch)(this.model,r.RenderFlagsArray.FluentStyle,e)},e.prototype.updateOutlinesRenderFlag=function(e){if(this.model.RenderFlagsArray){var t=Math.floor(r.RenderFlagsArray.RenderHeaderOutlinesInCanvas/r.MaxBitsPerRenderFlag);if(t<this.model.RenderFlagsArray.length){var n=r.RenderFlagsArray.RenderHeaderOutlinesInCanvas%r.MaxBitsPerRenderFlag,o=this.model.RenderFlagsArray[t];this.model.RenderFlagsArray[t]=e?o|1<<n:o&~(1<<n)}}},e.prototype.isDelayRenderingToNextFrame=function(){return(0,r.getModelClientCache)(this.model).delayRenderingToNextAnimationFrame===r.DelayRenderToNextAnimationFrameState.Delay},e.prototype.delayRenderingToNextAnimationFrame=function(){var e=(0,r.getModelClientCache)(this.model);e.delayRenderingToNextAnimationFrame!==r.DelayRenderToNextAnimationFrameState.DoNotDelay&&(e.delayRenderingToNextAnimationFrame=r.DelayRenderToNextAnimationFrameState.Delay)},e.prototype.doNotDelayRenderingToNextAnimationFrame=function(){(0,r.getModelClientCache)(this.model).delayRenderingToNextAnimationFrame=r.DelayRenderToNextAnimationFrameState.DoNotDelay},e.prototype.setDirtyInternal=function(e,t){void 0===t&&(t=!1);var n=(0,r.getModelClientCache)(this.model);n.IsDirty||(n.DirtyTimestamp=Date.now()),n.IsDirty=!0,n.DirtyType|=e,(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.DelayRenderToNextAnimationFrame,this.model)&&!t&&this.doNotDelayRenderingToNextAnimationFrame()},e.prototype.getOrCreateCanvasContext=function(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));var e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e},e.prototype.getAutoFilterMenuOffsetsFromCellStartInternal=function(e,t,n){var r=t*n;this.ensureCachedObjectsInitialized(this.model,e,r),(0,l.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,l.initializeOffsetsForDrawing)(this.model,r);var o=!this.model.IsRtl,a=(0,s.getCellLeftAdjustedForDrawing)(this.model,e,!1,o),d=(0,s.getCellTopAdjustedForDrawing)(this.model,e,!0),u=(0,i.getFilterSizeAdjustedForDrawing)(this.model,e,n,t),c=(0,i.getFilterLeftAdjustedForDrawing)(this.model,e,u,n,t)-a,g=(0,i.getFilterBottomAdjustedForDrawing)(this.model,e,u,n,t)-d;return{x:Math.round(c/r),y:Math.round(g/r)}},e.prototype.getAutoFilterButtonTotalSizeInternal=function(e,t,n){var r=t*n;this.ensureCachedObjectsInitialized(this.model,e,r),(0,l.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,l.initializeOffsetsForDrawing)(this.model,r);var o=(0,i.getFilterSizeAdjustedForDrawing)(this.model,e,n,t),a=(0,l.getDefaultBorderLineWidth)(r);return Math.round((o+a)/r)},e.prototype.ensureCachedObjectsInitialized=function(t,n,r){var o,i,s;e.verifyArgumentNotNull(t,"model","ensureCachedObjectsInitialized"),e.verifyArgumentNotNull(n,"cell","ensureCachedObjectsInitialized"),(0,l.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,l.initializeOffsetsForDrawing)(this.model,r),n.CachedStyle&&n.CachedBorderStyle&&n.CachedFont&&n.CachedIndent&&(null===(o=n.CachedDrawingLayout)||void 0===o?void 0:o.UnderlineRuns)&&(null===(i=n.CachedDrawingLayout)||void 0===i?void 0:i.StrikethroughRuns)&&(null===(s=n.CachedDrawingLayout)||void 0===s?void 0:s.CellTextLayout)||(0,a.initializeCellCachedObjects)(t,n,!0);var d=n.Merge;!d||d.HeightAdjustedForDrawing&&d.OriginDeltaXAdjustedForDrawing&&d.WidthAdjustedForDrawing&&d.OriginDeltaYAdjustedForDrawing||(0,a.updateCellMergeInformation)(t,n,r)},e.prototype.ensureDirtyCellsKeysInitialized=function(){var e=(0,r.getModelClientCache)(this.model);return e.DirtyCellsKeys||(e.DirtyCellsKeys=[]),e.DirtyCellsKeys},e}();t.BlockModelAccessor=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInsertButtonSize=t.setCellsDirtyForInsertButtonSpill=t.getHeaderInsertButtonHitRegions=void 0;var r=n(1),o=n(97);function i(e,t){if(!e)return 0;var n=e.Offset*(t?1:-1);return e.Type===r.InsertButtonType.InsertButton?o.InsertButtonRadius+o.InsertButtonStrokeWidth+n:e.Type===r.InsertButtonType.InsertDot?o.InsertDotRadius+o.InsertButtonStrokeWidth+n:0}t.getHeaderInsertButtonHitRegions=function(e,t,n,r,o,i){var l,a,s=function(e,t,n,r){var o=e?t.height:t.width;if(o<n+r){var i=o/2;return{startHitRegionSize:i,endHitRegionSize:i}}return{startHitRegionSize:n,endHitRegionSize:r}}(t,e,o,i),d=s.startHitRegionSize,u=s.endHitRegionSize;if(t){var c=n?e.x+e.width-r:e.x;l={x:c,y:e.y,width:r,height:d},a={x:c,y:e.y+e.height-u,width:r,height:u}}else n?(l={x:e.x+e.width-d,y:e.y,width:d,height:r},a={x:e.x,y:e.y,width:u,height:r}):(l={x:e.x,y:e.y,width:d,height:r},a={x:e.x+e.width-u,y:e.y,width:u,height:r});return{cellStartHitRegion:l,cellEndHitRegion:a}},t.setCellsDirtyForInsertButtonSpill=function(e,t,n,r,l,a){for(var s,d,u=l-t.getCellExtent(n),c=0,g=o.InsertButtonRadius+o.InsertButtonStrokeWidth,f=e.IsRow?e.RowNumbers.length:e.ColumnNumbers.length,h=n;(u>0||c<g)&&(r?++h:--h,!(h<0||h>=f));){var C=e.Cells[h],m=t.getCellExtent(h);u>0&&(a(h),u-=m),(r?i(null===(s=C.InsertButtons)||void 0===s?void 0:s.End,!1):i(null===(d=C.InsertButtons)||void 0===d?void 0:d.Start,!0))>(c+=m)&&a(h)}},t.getInsertButtonSize=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinRowHeightToAccomadateResizePillAnd1pxSelectionArea=t.MinRowHeightToAccomadateResizePillAndMinSelectionArea=t.MinRowHeightToAllocateMaxResizeArea=t.MinColWidthToAccomadateResizePillAnd1pxSelectionArea=t.MinColWidthToAccomadateResizePillAndMinSelectionArea=t.MinColWidthToAllocateMaxResizeArea=t.CellPercentageAllocatedToResize=t.MinCellPixelsAllocatedForCellSelection=t.MaxCellPixelsAllocatedToRowResizeZone=t.MaxCellPixelsAllocatedToColumnResizeZone=t.DefaultSpaceFromRowHeaderRightBorderPx=t.ResizePillBorderRadius=t.DefaultColResizePillHeightPx=t.DefaultColResizePillWidthPx=t.DefaultRowResizePillHeightPx=t.DefaultRowResizePillWidthPx=void 0,t.DefaultRowResizePillWidthPx=20,t.DefaultRowResizePillHeightPx=3,t.DefaultColResizePillWidthPx=5,t.DefaultColResizePillHeightPx=16,t.ResizePillBorderRadius=90,t.DefaultSpaceFromRowHeaderRightBorderPx=2,t.MaxCellPixelsAllocatedToColumnResizeZone=5.5,t.MaxCellPixelsAllocatedToRowResizeZone=3.5,t.MinCellPixelsAllocatedForCellSelection=5,t.CellPercentageAllocatedToResize=.25,t.MinColWidthToAllocateMaxResizeArea=2*t.MaxCellPixelsAllocatedToColumnResizeZone+t.MinCellPixelsAllocatedForCellSelection,t.MinColWidthToAccomadateResizePillAndMinSelectionArea=t.DefaultColResizePillWidthPx+t.MinCellPixelsAllocatedForCellSelection,t.MinColWidthToAccomadateResizePillAnd1pxSelectionArea=t.DefaultColResizePillWidthPx+1,t.MinRowHeightToAllocateMaxResizeArea=2*t.MaxCellPixelsAllocatedToRowResizeZone+t.MinCellPixelsAllocatedForCellSelection,t.MinRowHeightToAccomadateResizePillAndMinSelectionArea=t.DefaultRowResizePillHeightPx+t.MinCellPixelsAllocatedForCellSelection,t.MinRowHeightToAccomadateResizePillAnd1pxSelectionArea=t.DefaultRowResizePillHeightPx+1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutlinesStartSizePx=t.OutlinesPaddingPx=t.OutlinesLevelHeightWidthPx=t.ExpandCollapseButtonSizePx=void 0,t.ExpandCollapseButtonSizePx=10,t.OutlinesLevelHeightWidthPx=12,t.OutlinesPaddingPx=6,t.OutlinesStartSizePx=4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHeaderDragSquareHitRegionRectInfo=t.getHeaderDragSquareRegionRectInfo=void 0;var r=n(136),o=n(6),i=n(39),l=n(75);function a(e,t,n,r){var i=e.IsRow?(0,o.getCellCenterYAdjustedForDrawing)(e,t):(0,o.getCellCenterXAdjustedForDrawing)(e,t,e.IsRtl);return Math.round(i-n/2-r-n)}function s(e,t,n){return e*t+(e-1)*n}t.getHeaderDragSquareRegionRectInfo=function(e,t,n,l,d){var u=a(e,t,l,d),c=Math.round((e.IsRow?(0,o.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1):(0,o.getCellTopAdjustedForDrawing)(e,t,!1))+(0,i.getDimensionAdjustedForDrawing)(e.IsRow?r.RowHeaderDragSquarePadding:r.ColumnHeaderDragSquarePadding,n)),g=s(r.DragSquareNumberOfDotsInLongEdge,l,d),f=s(r.DragSquareNumberOfDotsInShortEdge,l,d);return e.IsRow?{x:c,y:u,width:f,height:g}:{x:u,y:c,width:g,height:f}},t.getHeaderDragSquareHitRegionRectInfo=function(e,t,n){var d=(0,i.getDimensionAdjustedForDrawing)(r.DragSquareDimension,n),u=(0,i.getDimensionAdjustedForDrawing)(r.DragSquareGap,n),c=s(r.DragSquareNumberOfDotsInLongEdge,d,u),g=e.IsRow?(0,o.getCellHeightAdjustedForDrawing)(e,t):(0,o.getCellWidthAdjustedForDrawing)(e,t);if(!(g<=c)){var f=a(e,t,d,u);if(e.IsRow){var h=(0,o.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1),C=(0,i.getDimensionAdjustedForDrawing)(l.RowHeaderDragAndInsertHitRegionWidth,n),m=(0,i.getDimensionAdjustedForDrawing)(r.RowHeaderDragHitRegionVerticalPadding,n),p=c+2*m;return p<g?{x:h,y:f-m,width:C,height:p}:{x:h,y:(0,o.getCellTopAdjustedForDrawing)(e,t,!1),width:C,height:g}}var y=(0,o.getCellTopAdjustedForDrawing)(e,t,!1),v=(0,i.getDimensionAdjustedForDrawing)(r.ColumnHeaderDragHitRegionHeight,n),S=(0,i.getDimensionAdjustedForDrawing)(r.ColumnHeaderDragHitRegionHorizontalPadding,n),R=c+2*S;return R<g?{x:f-S,y:y,width:R,height:v}:{x:(0,o.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1),y:y,width:g,height:v}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeaderDragHitRegionHeight=t.ColumnHeaderDragHitRegionHorizontalPadding=t.RowHeaderDragHitRegionVerticalPadding=t.ColumnHeaderDragSquarePadding=t.RowHeaderDragSquarePadding=t.DragSquareNumberOfDotsInShortEdge=t.DragSquareNumberOfDotsInLongEdge=t.DragSquareGap=t.DragSquareDimension=void 0,t.DragSquareDimension=2,t.DragSquareGap=2,t.DragSquareNumberOfDotsInLongEdge=3,t.DragSquareNumberOfDotsInShortEdge=2,t.RowHeaderDragSquarePadding=6,t.ColumnHeaderDragSquarePadding=1,t.RowHeaderDragHitRegionVerticalPadding=2,t.ColumnHeaderDragHitRegionHorizontalPadding=5,t.ColumnHeaderDragHitRegionHeight=11},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCollector=t.initPassiveTelemetryManager=void 0;var r,o,i,l=n(11),a=n(76),s=n(234),d=n(8),u=[],c={},g=(0,a.getCurrentTimeInMs)(),f=!1;function h(){for(var e=(0,a.getCurrentTimeInMs)();(0,a.getCurrentTimeInMs)()-e<r&&u.length>0&&!m();){var t=Math.floor(Math.random()*u.length),n=u[t],l=(0,a.getCurrentTimeInMs)();if(n.canCollectorExecute())try{var s=n.collect();s.isValid&&c[n.getCollectorName()].push(s.value);var f=(0,a.getCurrentTimeInMs)()-l;f>r&&(d.ULS.sendTraceTag(572602177,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,"Name: ".concat(n.getCollectorName()," is disabled because it exceeded execution threshold.\n            Threshold: ").concat(r,", TimeTaken: ").concat(f)),n.disable())}catch(e){d.ULS.sendTraceTag(572602178,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,"Name: ".concat(n.getCollectorName(),", Exception encountered in collector, Collector will be disabled. Exception - ").concat(e)),n.disable()}u.splice(t,1)}u.length<1&&i.stopTracking(),(0,a.getCurrentTimeInMs)()-g>o&&setTimeout(C,0)}function C(){if(c)for(var e=Object.keys(c),t=0;t<e.length;t++){var n=e[t],r=c[n];r&&r.length>0&&d.ULS.sendTraceTag(572602179,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,JSON.stringify({Name:n,Results:r}))}c={},g=(0,a.getCurrentTimeInMs)()}function m(){return!(!navigator.scheduling||!navigator.scheduling.isInputPending)&&navigator.scheduling.isInputPending()}t.initPassiveTelemetryManager=function(){if(!f){r=(0,l.getServiceSetting)(3,25),o=(0,l.getServiceSetting)(5,6e4);var e=(0,l.getServiceSetting)(4,1e4);i=new s.IdleTracker({onReportUserIsIdle:function(){window.requestIdleCallback?window.requestIdleCallback(h):setTimeout(h,0)}},e),u.length>0&&i.startTrackingIfApplicable(),f=!0}},t.registerCollector=function(e){u.length<100&&u.push(e);var t=e.getCollectorName();c[t]||(c[t]=[]),f&&i.startTrackingIfApplicable()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateCell=t.duplicateModel=void 0;var r=n(4),o=n(0),i=(0,n(17).isChangeGateEnabled)("OfficeVSO:8688175_bitwiseBorderDuplicate");function l(e){var t=function(e){if(!e)return;return{SpanToEnd:e.SpanToEnd,SpanToStart:e.SpanToStart,IsSpillBlocked:e.IsSpillBlocked,IsSpillingOutsideOfBlock:e.IsSpillingOutsideOfBlock}}(e.Spill),n=function(e){if(!e)return;return{Columns:e.Columns,Rows:e.Rows,IsOrigin:e.IsOrigin,OriginRow:e.OriginRow||0,OriginColumn:e.OriginColumn||0,SpansBlocks:e.SpansBlocks,Width:e.Width,Height:e.Height,OriginDeltaX:e.OriginDeltaX,OriginDeltaY:e.OriginDeltaY,WidthAdjustedForDrawing:e.WidthAdjustedForDrawing,HeightAdjustedForDrawing:e.HeightAdjustedForDrawing,OriginDeltaXAdjustedForDrawing:e.OriginDeltaXAdjustedForDrawing,OriginDeltaYAdjustedForDrawing:e.OriginDeltaYAdjustedForDrawing,SpansNextBlockVertically:e.SpansNextBlockVertically,SpansNextBlockHorizontally:e.SpansNextBlockHorizontally}}(e.Merge),l=function(e){if(!e)return;return{Start:e.Start,End:e.End,Separator:e.Separator}}(e.NumFmt),a=function(e){if(!e)return;var t=[];if(e.PhoneticTextRuns)for(var n=0;n<e.PhoneticTextRuns.length;n++)t.push({BaseStartIndex:(r=e.PhoneticTextRuns[n]).BaseStartIndex,PhoneticStartIndex:r.PhoneticStartIndex,BaseTextLength:r.BaseTextLength,PhoneticLength:r.PhoneticLength});var r;return{Text:e.Text,PhoneticTextRuns:t}}(e.PhonInfo),g=function(e){var t,n;if(!e)return;var r=void 0;e.Domain&&(r={Id:null===(t=e.Domain)||void 0===t?void 0:t.Id,StringId:null===(n=e.Domain)||void 0===n?void 0:n.StringId});return{Domain:r,IconWidth:e.IconWidth}}(e.LinkedEntity),f=function(e){if(!e)return;return{Width:e.Width,Type:e.Type,Unicode:e.Unicode}}(e.RichValueIcon),h=function(e){if(!e)return;return{Type:e.Type}}(e.InCellControlOptions),C=function(e){if(!e)return;return{Icon:s(e.Icon),DataBar:d(e.DataBar)}}(e.CondFormat),m=function(e){if(!e)return;var t=void 0;e.InternalLink&&(t={ObjectName:e.InternalLink.ObjectName,SheetName:e.InternalLink.SheetName,FirstRow:e.InternalLink.FirstRow,FirstColumn:e.InternalLink.FirstColumn,LastRow:e.InternalLink.LastRow,LastColumn:e.InternalLink.LastColumn});return{Text:e.Text,IsValidHyperlink:e.IsValidHyperlink,IsHyperlinkFormula:e.IsHyperlinkFormula,IsHyperlinkExternal:e.IsHyperlinkExternal,IsHyperlinkChecked:e.IsHyperlinkChecked,Tooltip:e.Tooltip,InternalLink:t}}(e.Hyperlink),p=u(e.Sparkline),y=u(e.InCellImage),v=function(e){if(!e)return;return{HasExpandCollapseIndicator:e.HasExpandCollapseIndicator,IsExpanded:e.IsExpanded,ECButtonTitle:e.ECButtonTitle,ShouldShowExpandCollapseMenu:e.ShouldShowExpandCollapseMenu,CanExpandCollapse:e.CanExpandCollapse,SourceIndex:e.SourceIndex,ConfirmRequired:e.ConfirmRequired,CanShowDetails:e.CanShowDetails}}(e.PivotTable),S=function(e){if(!e)return;return{Row:e.Row,Column:e.Column,IsThreadedComment:e.IsThreadedComment,HideCommentIndicator:e.HideCommentIndicator}}(e.Comment),R=function(e){if(!e)return;return{Formula:e.Formula,FormulaType:e.FormulaType,IsArrayRoot:e.IsArrayRoot}}(e.FormulaInfo),F=function(e){if(!e)return;return{Type:e.Type,Title:e.Title,Menu:e.Menu,RenderingContext:e.RenderingContext,CommandData:e.CommandData?e.CommandData:void 0}}(e.AutoFilter),w=function(e){if(!e)return;return{Type:e.Type,DisplayFilter:e.DisplayFilter,IsPivotPageField:e.IsPivotPageField,CommandData:e.CommandData,Title:e.Title,IsHeaderSnapped:e.IsHeaderSnapped}}(e.PivotFilter),T=function(e){if(!e)return;return{IsAnchor:e.IsAnchor,Range:e.Range?c(e.Range):void 0}}(e.DynamicArrayInfo),I=[];if(e.TextRuns)for(var x=0;x<e.TextRuns.length;x++)I.push((0,o.duplicateTextRun)(e.TextRuns[x],e.TextRuns[x].FontID||0));else I=void 0;return{Col:e.Col,Row:e.Row,Text:e.Text,StyleID:e.StyleID||0,GlobalCellStyleID:e.GlobalCellStyleID,Ifmt:e.Ifmt||0,IfmtStamped:e.IfmtStamped||0,BorderStyleID:e.BorderStyleID||0,GlobalBorderStyleID:e.GlobalBorderStyleID,HorizontalAlignmentSet:e.HorizontalAlignmentSet,Spill:t,Merge:n,NumFmt:l,WrapText:e.WrapText,ShrunkSize:e.ShrunkSize,AutoFilter:F,PivotFilter:w,TextRuns:I,CondFormat:C,PhonInfo:a,Comment:S,RichValueType:e.RichValueType,RichValueFieldsIndexes:e.RichValueFieldsIndexes?r.__spreadArray([],e.RichValueFieldsIndexes,!0):void 0,FormulaInfo:R,ValueType:e.ValueType,HasError:e.HasError,Hyperlink:m,Sparkline:p,InCellImage:y,LinkedEntity:g,RichValueIcon:f,InCellControlOptions:h,PivotTable:v,HasIgnorableError:e.HasIgnorableError,SrvDx:e.SrvDx||0,SrvDy:e.SrvDy||0,TolType:e.TolType,TableColHeader:e.TableColHeader,TableRowHeader:e.TableRowHeader,Value:e.Value,PhoneticInfo:e.PhoneticInfo,OriginalText:e.OriginalText,ErrorTooltip:e.ErrorTooltip,DynamicArrayInfo:T,BitwiseBorderPosition:i&&e.BitwiseBorderPosition||0}}function a(e){var t,n=[];if(e.Outlines)for(var r=0;r<e.Outlines.length;r++)n.push({StartIndex:(t=e.Outlines[r]).StartIndex,ButtonIndex:t.ButtonIndex,IsExpanded:t.IsExpanded,IsButtonHidden:t.IsButtonHidden,IsNonDefaultDirection:t.IsNonDefaultDirection,ECTitle:t.ECTitle});return{Outlines:n}}function s(e){if(e)return{Set:e.Set,Index:e.Index,IconOnly:e.IconOnly,CFIconHorizontalAlignment:e.CFIconHorizontalAlignment}}function d(e){if(e)return{AxisColor:e.AxisColor,AxisPostion:e.AxisPostion,Length:e.Length,Color:e.Color,GradientColor:e.GradientColor,BorderColor:e.BorderColor,Direction:e.Direction}}function u(e){if(e)return{ClusterOffsetX:e.ClusterOffsetX,ClusterOffsetY:e.ClusterOffsetY,AltText:e.AltText,Width:e.Width,Height:e.Height,ClusterImageWidth:e.ClusterImageWidth,ClusterImageHeight:e.ClusterImageHeight}}function c(e){return{FirstRow:e.FirstRow,FirstColumn:e.FirstColumn,LastRow:e.LastRow,LastColumn:e.LastColumn}}function g(e){return{Index:e.Index,Caption:e.Caption,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowSubtotal:e.ShowSubtotal,RepeatItemLabels:e.RepeatItemLabels,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotalAtTop:e.ShowSubtotalAtTop,IsCompactLayout:e.IsCompactLayout,BaseFieldIndex:e.BaseFieldIndex,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}}function f(e){var t=e.RowAreaCaptions?r.__spreadArray([],e.RowAreaCaptions,!0):void 0,n=e.RowAreaFields?[]:void 0;if(e.RowAreaFields)for(var o=0;o<e.RowAreaFields.length;o++)n.push(g(e.RowAreaFields[o]));var i=e.ColumnAreaFields?[]:void 0;if(e.ColumnAreaFields)for(o=0;o<e.ColumnAreaFields.length;o++)i.push(g(e.ColumnAreaFields[o]));var l=e.ValueAreaFields?[]:void 0;if(e.ValueAreaFields)for(o=0;o<e.ValueAreaFields.length;o++)l.push(g(e.ValueAreaFields[o]));var a=e.PageAreaFields?[]:void 0;if(e.PageAreaFields)for(o=0;o<e.PageAreaFields.length;o++)a.push(g(e.PageAreaFields[o]));var s,d=e.SlicerConnections?[]:void 0;if(e.SlicerConnections)for(o=0;o<e.SlicerConnections.length;o++)d.push({Name:(s=e.SlicerConnections[o]).Name,Caption:s.Caption,WorksheetName:s.WorksheetName,Enabled:s.Enabled});return{FirstRow:e.FirstRow,FirstColumn:e.FirstColumn,LastRow:e.LastRow,LastColumn:e.LastColumn,RangeType:e.RangeType,ConnectionName:e.ConnectionName,PivotTableName:e.PivotTableName,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,ColumnTotalIndexes:e.ColumnTotalIndexes,RowTotalIndexes:e.RowTotalIndexes,ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,RowMemberPropIndexes:e.RowMemberPropIndexes,OriginPTWidth:e.OriginPTWidth,OriginPTHeight:e.OriginPTHeight,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaYFromOriginPT:e.DeltaYFromOriginPT,ColumnHeaderRange:e.ColumnHeaderRange,RowHeaderRange:e.RowHeaderRange,RowAreaCaptions:t,ExternalSourceIndex:e.ExternalSourceIndex,IsActionable:e.IsActionable,IsOlap:e.IsOlap,SupportsBIExplore:e.SupportsBIExplore,HideGridLines:e.HideGridLines,IsEmptyPivot:e.IsEmptyPivot,Xluid:e.Xluid,ShowDrillIndicators:e.ShowDrillIndicators,ShowColumnStripes:e.ShowColumnStripes,ShowRowStripes:e.ShowRowStripes,ShowRowHeaders:e.ShowRowHeaders,ShowColumnHeaders:e.ShowColumnHeaders,DataSource:e.DataSource,RowLocation:e.RowLocation,ColGrandTotalOn:e.ColGrandTotalOn,RwGrandTotalOn:e.RwGrandTotalOn,IndentIncrement:e.IndentIncrement,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,SaveSourceDataWithFile:e.SaveSourceDataWithFile,RefreshOnLoad:e.RefreshOnLoad,AltText:e.AltText,AltTextSummary:e.AltTextSummary,ErrorString:e.ErrorString,NullString:e.NullString,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,HasActiveFilter:e.HasActiveFilter,IsPageArea:e.IsPageArea,RowAreaFields:n,ColumnAreaFields:i,ValueAreaFields:l,PageAreaFields:a,CurrentStyleName:e.CurrentStyleName,FirstRowIndex:e.FirstRowIndex,FirstColIndex:e.FirstColIndex,LastRowIndex:e.LastRowIndex,LastColIndex:e.LastColIndex,StyleIndex:e.StyleIndex,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,SlicerConnections:d,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaXFromOriginPTAdjustedForDrawing,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,AutoRefresh:e.AutoRefresh,SupportsAutoRefresh:e.SupportsAutoRefresh}}t.duplicateModel=function(e){if(!e)return null;var t=e.ColumnNumbers?r.__spreadArray([],e.ColumnNumbers,!0):void 0,n=e.ColumnWidths?r.__spreadArray([],e.ColumnWidths,!0):void 0,i=e.ColumnOffsets?r.__spreadArray([],e.ColumnOffsets,!0):void 0,s=e.ColMetadata?r.__spreadArray([],e.ColMetadata,!0):void 0,d=e.FixedColumns?r.__spreadArray([],e.FixedColumns,!0):void 0,u=e.RowNumbers?r.__spreadArray([],e.RowNumbers,!0):void 0,g=e.RowHeights?r.__spreadArray([],e.RowHeights,!0):void 0,h=e.RowOffsets?r.__spreadArray([],e.RowOffsets,!0):void 0,C=[];if(e.Cells)for(var m=0;m<e.Cells.length;m++)C.push(l(e.Cells[m]));var p=[];if(e.Styles)for(m=0;m<e.Styles.length;m++){var y=e.Styles[m];y&&(y=(0,o.duplicateOnlyStyleWithoutFont)(y,y.ID||0,y.RefCount||0)),p.push(y)}var v=[];if(e.BorderStyles)for(m=0;m<e.BorderStyles.length;m++){var S=e.BorderStyles[m];S&&(S=(0,o.duplicateBorderStyle)(S,S.ID||0,S.RefCount||0)),v.push(S)}var R=[];if(e.Fonts)for(m=0;m<e.Fonts.length;m++){var F=e.Fonts[m];F&&(F=(0,o.duplicateFont)(F,F.ID||0,F.RefCount||0)),R.push(F)}var w=e.PrintAreas?[]:void 0;if(e.PrintAreas)for(m=0;m<e.PrintAreas.length;m++)w.push(c(e.PrintAreas[m]));var T=e.PivotTables?[]:void 0;if(e.PivotTables)for(m=0;m<e.PivotTables.length;m++)T.push(f(e.PivotTables[m]));var I,x=e.AllRichValueFields?[]:void 0;if(e.AllRichValueFields)for(m=0;m<e.AllRichValueFields.length;m++)x.push({Index:(I=e.AllRichValueFields[m]).Index,RefersToDotFunction:I.RefersToDotFunction,Value:I.Value});var b,D,A,P,H,B,M,O=r.__spreadArray([],e.RenderFlagsArray,!0),k=e.RibbonCommands?{ShowAutoFilterMenu:(b=e.RibbonCommands).ShowAutoFilterMenu,CardViewShowTemporaryDataCard:b.CardViewShowTemporaryDataCard,CardViewShowTemporaryErrorCard:b.CardViewShowTemporaryErrorCard,CardViewHideTemporaryCard:b.CardViewHideTemporaryCard,CardViewShowDataCardOrDisambiguationPane:b.CardViewShowDataCardOrDisambiguationPane,ToggleInCellControlCheckbox:b.ToggleInCellControlCheckbox}:void 0,L=e.PageBreaks?(D=e.PageBreaks,A=D.Row?r.__spreadArray([],D.Row,!0):void 0,P=D.Col?r.__spreadArray([],D.Col,!0):void 0,{Row:A,Col:P}):void 0,N=e.Sparklines?function(e){for(var t=[],n=0;n<e.Ranges.length;n++)t.push({LocationRow:(r=e.Ranges[n]).LocationRow,LocationColumn:r.LocationColumn,SparklineType:r.SparklineType,FirstRow:r.FirstRow,FirstColumn:r.FirstColumn,LastRow:r.LastRow,LastColumn:r.LastColumn,RangeType:r.RangeType});var r;return{Ranges:t,ImageUrl:e.ImageUrl,Version:e.Version}}(e.Sparklines):void 0,E=e.InCellImages?{ImageUrl:(H=e.InCellImages).ImageUrl,Version:H.Version}:void 0,z=e.PermissionSet?{IsAutoFilterDisabled:(B=e.PermissionSet).IsAutoFilterDisabled,IsSortDisabled:B.IsSortDisabled}:void 0,W=e.AdjacentBlocksHiddensInfo?{IsFirstColOfNextBlockHidden:(M=e.AdjacentBlocksHiddensInfo).IsFirstColOfNextBlockHidden,IsFirstRowOfNextBlockHidden:M.IsFirstRowOfNextBlockHidden,IsLastRowOfPrevBlockHidden:M.IsLastRowOfPrevBlockHidden,IsLastColOfPrevBlockHidden:M.IsLastColOfPrevBlockHidden}:void 0,G=e.RowOutlinesInformation?[]:void 0;if(e.RowOutlinesInformation)for(m=0;m<e.RowOutlinesInformation.length;m++)G.push(a(e.RowOutlinesInformation[m]));var V=e.ColumnOutlinesInformation?[]:void 0;if(e.ColumnOutlinesInformation)for(m=0;m<e.ColumnOutlinesInformation.length;m++)V.push(a(e.ColumnOutlinesInformation[m]));return{BlockWidth:e.BlockWidth,BlockHeight:e.BlockHeight,RowOffsets:h,ColumnOffsets:i,RowHeights:g,ColumnWidths:n,RowNumbers:u,ColumnNumbers:t,ColMetadata:s,FixedColumns:d,RowOutlinesInformation:G,ColumnOutlinesInformation:V,MaxRowOutlineLevelInSheet:e.MaxRowOutlineLevelInSheet,MaxColOutlineLevelInSheet:e.MaxColOutlineLevelInSheet,UniqueId:e.UniqueId,ShowGridLines:e.ShowGridLines,ShowHeaders:e.ShowHeaders,IsRtl:e.IsRtl,PermissionSet:z,GridLineColor:e.GridLineColor,BackgroundColor:e.BackgroundColor,Cells:C,Styles:p,Fonts:R,BorderStyles:v,CellsEncoding:e.CellsEncoding||0,RenderFlagsArray:O,HandleFlagsMismatch:e.HandleFlagsMismatch,PageBreaks:L,PrintAreas:w,PivotTables:T,Sparklines:N,InCellImages:E,AllRichValueFields:x,RibbonCommands:k,AdjacentBlocksHiddensInfo:W,IsCanvasHeadersSupported:e.IsCanvasHeadersSupported,HeadersFallbackReason:e.HeadersFallbackReason,HasTable:e.HasTable,HasOutline:e.HasOutline,IsBitwiseFixedRows:e.IsBitwiseFixedRows}},t.duplicateCell=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateMergedCellHeight=t.updateMergedCellWidth=t.getMergedCellUpdatedWidthOrHeight=t.isMergedCellSpanningAcrossBlocksVerticallyAndHorizontally=t.doesMergedCellSpansPrevBlockHorizontally=t.doesMergedCellSpansPrevBlockVertically=t.doesMergedCellSpansNextBlockVertically=t.doesMergedCellSpansNextBlockHorizontally=t.getBorderAtPosition=t.duplicateBorder=t.cascadeMergeCellSpanningBlocksFully=t.updateMergeCellInfoForColumn=t.updateMergeInfoForRow=t.updateMergeInfoForSrcModelCell=t.updateSrcModelMergeCellSpanningBlocks=t.resetMergeCellInfo=t.isCellAdjacentToMergedCell=t.changeBorderForMergedCellSpanningBlocks=t.isHideColMergedCellAcrossBlocksEnabled=void 0;var r=n(4),o=n(1),i=n(0);function l(e,t,n,r){return e===n&&(t===r+1||t===r-1)||t===r&&(e===n+1||e===n-1)}function a(e){return r.__assign(r.__assign({},e),{SpansBlocks:!1,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0,OriginRow:void 0,OriginColumn:void 0,WidthAdjustedForDrawing:void 0,HeightAdjustedForDrawing:void 0,OriginDeltaXAdjustedForDrawing:void 0,OriginDeltaYAdjustedForDrawing:void 0,SpansNextBlockHorizontally:void 0,SpansNextBlockVertically:void 0})}function s(e,t,n,r,o,i,l,a){a?d(e,t,n,r,o,i,l):u(e,t,n,r,o,i,l)}function d(e,t,n,r,o,i,l){e.Rows-=i+l-t.Row+1,e.OriginDeltaY=p(r.RowHeights,t.Row,i+l)+p(o.RowHeights,n.Row,n.Row+n.Merge.Rows),n.Merge.Rows+=l+1,e.Height=n.Merge.Height}function u(e,t,n,r,o,i,l){e.Columns-=i+l-t.Col+1,e.OriginDeltaX=p(r.ColumnWidths,t.Col,i+l)+p(o.ColumnWidths,n.Col,n.Col+n.Merge.Columns),n.Merge.Columns+=l+1,e.Width=n.Merge.Width}function c(e){return{BorderLineStyle:e.BorderLineStyle,BorderPosition:e.BorderPosition,Color:e.Color,Weight:e.Weight}}function g(e,t,n){for(var r=0,i=(0,o.getBorderStyleByID)(e,t).Borders;r<i.length;r++){var l=i[r];if(l.BorderPosition===n)return l}return null}function f(e,t){var n=e.Merge;return t.ColumnOffsets[e.Col]-n.OriginDeltaX+n.Width>t.BlockWidth}function h(e,t){var n=e.Merge;return t.RowOffsets[e.Row]-n.OriginDeltaY+n.Height>t.BlockHeight}function C(e){if(!e)return!1;var t=e.Merge;return!(0!==e.Row||!t||!t.SpansBlocks)&&(e.Row!==t.OriginRow&&t.Height>t.OriginDeltaY)}function m(e){if(!e)return!1;var t=e.Merge;return!(0!==e.Col||!t||!t.SpansBlocks)&&(e.Col!==t.OriginColumn&&t.Width>t.OriginDeltaX)}function p(e,t,n){for(var r=0,o=t;o<=n;o++)r+=e[o];return r}function y(e,t,n,r,i,l){var a={},s=l?r.Borders.findIndex((function(e){return e.BorderPosition===o.BorderPositionType.Bottom})):r.Borders.findIndex((function(e){return e.BorderPosition===o.BorderPositionType.Right}));return-1!==s&&(a=c(r.Borders[s]),r.Borders.splice(s,1),e.BorderStyleID=n,t.BorderStyles.push(r),i&&(e.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(r))),a}function v(e,t,n){var r=g(e,t,n?o.BorderPositionType.Right:o.BorderPositionType.Bottom);return r?c(r):{}}function S(e){return e.filter((function(e){return e.Merge&&e.Merge.SpansBlocks}))}t.isHideColMergedCellAcrossBlocksEnabled=(0,o.isChangeGateEnabled)(o.ChangeGate.HideColMergedCellAcrossBlocks),t.changeBorderForMergedCellSpanningBlocks=function(e,t,n){var r=(0,o.isGlobalBorderStylesEnabled)(e),a=S(t);if(0!==a.length)for(var s=0,d=a;s<d.length;s++){for(var u=d[s],c=(0,i.getLastBorderStyleID)(e)+1,g=(0,i.duplicateBorderStyle)((0,o.getBorderStyleByID)(u,e),c,1),f=y(u,e,c,g,r,n),h=0,C=t;h<C.length;h++){if(l((b=C[h]).Row,b.Col,u.Row,u.Col)&&(b.Row===u.Row-1||b.Col===u.Col-1)){var m=v(b,e,n);if(Object.keys(m).length>0){m.BorderPosition=n?o.BorderPositionType.Left:o.BorderPositionType.Top,g.Borders.splice(0,0,m);var p=(0,i.getLastBorderStyleID)(e)+1;u.BorderStyleID=p,e.BorderStyles.push(g),r&&(u.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(g));var R=n?o.BorderPositionType.Right:o.BorderPositionType.Bottom;(0,i.removeBorderFromCell)(b,e,R)}}}var F=[];if(n)for(var w=u.Col;w<=u.Col+u.Merge.Columns;w++)F.push((0,o.getOrCreateCell)(e,u.Row+u.Merge.Rows+1,w));else for(w=u.Row;w<=u.Row+u.Merge.Rows;w++)F.push((0,o.getOrCreateCell)(e,w,u.Col+u.Merge.Columns+1));if(Object.keys(f).length>0){var T=n?o.BorderPositionType.Top:o.BorderPositionType.Left;f.BorderPosition=T;for(var I=0,x=F;I<x.length;I++){var b=x[I];(0,i.attachCellToModel)(b,e),(0,i.addBorderToCellIfNotPresent)(b,e,f,T)}}}},t.isCellAdjacentToMergedCell=l,t.resetMergeCellInfo=a,t.updateSrcModelMergeCellSpanningBlocks=function(e,t,n,r,o,i){var l=e.Merge,a=n.Cells.find((function(t){return(i?t.Col===e.Col:t.Row===e.Row)&&t.Merge&&t.Merge.SpansBlocks&&(i?t.Row>0:t.Col>0)}));a&&s(l,e,a,t,n,r,o,i)},t.updateMergeInfoForSrcModelCell=s,t.updateMergeInfoForRow=d,t.updateMergeCellInfoForColumn=u,t.cascadeMergeCellSpanningBlocksFully=function(e,n,r,l,s,d,u){if(t.isHideColMergedCellAcrossBlocksEnabled){var p=n.Cells.find((function(e){return(u?e.Col===r.Col:e.Row===r.Row)&&e.Merge&&e.Merge.SpansBlocks&&(u?e.Row>0:e.Col>0)}));u?p.Merge.Rows+=r.Merge.Rows+1:p.Merge.Columns+=r.Merge.Columns+1;var y=u?!(p.Row+p.Merge.Rows===n.RowNumbers[n.RowNumbers.length-1]):!(p.Col+p.Merge.Columns===n.ColumnNumbers[n.ColumnNumbers.length-1]),v=f(p,n)||m(p),S=h(p,n)||C(p);!y||v&&S||(p.Merge=a(p.Merge));var R=g(r,e,u?o.BorderPositionType.Bottom:o.BorderPositionType.Right);if(R){var F=e.BorderStyles.length,w=n.BorderStyles.length,T=(0,i.duplicateBorderStyle)((0,o.getBorderStyleByID)(p,n),w,1);u?T.Borders.splice(0,0,R):T.Borders.push(R),n.BorderStyles.push(T),p.BorderStyleID=w,d&&(p.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(T));var I=c(R);I.BorderPosition=u?o.BorderPositionType.Top:o.BorderPositionType.Left;var x=[],b=r.Col+r.Merge.Columns,D=r.Row+r.Merge.Rows;if(u)for(var A=r.Col;A<=b;A+=1)x.push((0,o.getDefaultCell)(D+1,A,e.Styles,e.Fonts));else for(A=r.Row;A<=D;A+=1)x.push((0,o.getDefaultCell)(A,b+1,e.Styles,e.Fonts));var P=(0,i.duplicateBorderStyle)((0,o.getBorderStyleByID)(x[0],e),F,1);P.Borders.push(I),e.BorderStyles.push(P);for(var H=0,B=x;H<B.length;H++){var M=B[H];u?M.Row-=l+1:M.Col-=l+1,s.push(M),M.BorderStyleID=F,d&&(M.GlobalBorderStyleID=(0,o.getGlobalBorderStyleMap)().getOrCreateID(P))}}}},t.duplicateBorder=c,t.getBorderAtPosition=g,t.doesMergedCellSpansNextBlockHorizontally=f,t.doesMergedCellSpansNextBlockVertically=h,t.doesMergedCellSpansPrevBlockVertically=C,t.doesMergedCellSpansPrevBlockHorizontally=m,t.isMergedCellSpanningAcrossBlocksVerticallyAndHorizontally=function(e){var t=S(e.Cells);if(0===t.length)return!1;for(var n=0,r=t;n<r.length;n++){var o=r[n];if(f(o,e)&&h(o,e))return!0}return!1},t.getMergedCellUpdatedWidthOrHeight=p,t.updateMergedCellWidth=function(e,t,n,r){for(var o=e;o<t;o++)n.Width-=r.ColumnWidths[o]},t.updateMergedCellHeight=function(e,t,n,r){for(var o=e;o<t;o++)n.Height-=r.RowHeights[o]}},function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return w}));var r,o="UnavailabilityToast",i=function(){function e(e,t,n,r,o,i){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.hasSpinner=null!=i&&i,this.isRTL=r,this.elementsMargin=r?"margin-left: 8px;":"margin-right: 8px;",this.toastIconElement=this.createToastIcon(o),this.toastElement=this.createToastContainer(),this.setTitle(t),this.setMessage(n),e.appendChild(this.toastElement)}return e.prototype.setVisibility=function(e){this.toastElement.style.visibility=e?"visible":"hidden"},e.prototype.dispose=function(){var e;null===(e=this.toastElement.parentNode)||void 0===e||e.removeChild(this.toastElement)},e.prototype.setTitle=function(e){e?this.toastTitleElement?this.toastTitleElement.innerText=e:(this.toastTitleElement=this.createToastTitle(e),this.toastElement.appendChild(this.toastTitleElement)):this.toastTitleElement&&(this.toastElement.removeChild(this.toastTitleElement),this.toastTitleElement=void 0)},e.prototype.setMessage=function(e){e?this.toastMessageElement?this.toastMessageElement.innerText=e:(this.toastMessageElement=this.createToastMessage(e),this.toastElement.appendChild(this.toastMessageElement)):this.toastMessageElement&&(this.toastElement.removeChild(this.toastMessageElement),this.toastMessageElement=void 0)},e.prototype.setIcon=function(e,t){this.hasSpinner=!!t,this.toastElement.removeChild(this.toastIconElement),this.toastIconElement=this.createToastIcon(e),this.toastElement.insertBefore(this.toastIconElement,this.toastElement.firstChild)},e.prototype.createToastContainer=function(){var e=document.createElement("div");return e.id=o,e.setAttribute("role","alert"),e.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;\n      border: 2px solid transparent;'),e.appendChild(this.toastIconElement),e},e.prototype.createToastIcon=function(e){var t=document.createElement("span");if(t.id="UnavailabilityToastIcon",this.hasSpinner)!function(e,t){var n=document.createElement("div");n.id="UnavailbilitySpinner",n.setAttribute("style","border: 1.5px solid black;\n    border-top: 1.5px solid gray;\n    border-radius: 100%;\n    font-size: 12px;\n    width: 20px;\n    height: 20px;\n    -webkit-animation: spin 1.2s linear infinite; /* Safari */\n    animation: spin 1.2s linear infinite;"),t?n.style.marginLeft="7px":n.style.marginRight="7px";var r=document.createElement("style");r.type="text/css";var o=document.createTextNode("  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    20% { transform: rotate(50deg); }\n    70% { transform: rotate(270deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @-webkit-keyframes spin {\n    0% { -webkit-transform: rotate(0deg); }\n    20% { -webkit-transform: rotate(50deg); }\n    70% { -webkit-transform: rotate(270deg); }\n    100% { -webkit-transform: rotate(360deg); }\n  }\n  ");r.appendChild(o),n.appendChild(r),e.appendChild(n)}(t,this.isRTL);else{var n=null!=e?e:this.OpenWorkbookIcon;t.setAttribute("style",'display: inline-block;\n        height: 20px;\n        width: 20px;\n        background-repeat: no-repeat;\n        background-image: url("data:image/svg+xml;charset=utf8,'.concat(n,'");')+this.elementsMargin)}return t},e.prototype.createToastTitle=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t},e.prototype.createToastMessage=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t},e}(),l=function(){function e(){}return e.createInstance=function(e,t,n,r,o,l){return new i(e,t,n,r,o,l)},e}(),a=n(50),s=n(77),d=n(16);function u(e,t){return e?t(e)?e:u(e.parentElement,t):null}var c,g=function(e,t){return r?r.getStringFeatureGate(e,t):t};function f(e,t){return c&&c[e]?c[e]:t}var h,C=n(141),m=function(e){return new Set(e.toLowerCase().trim().split(",").map((function(e){return e.trim()})).filter((function(e){return Boolean(e)})))},p={},y=function(e){var t,n;return n=function(){return m(f(e,""))},p[t=e]&&p[t].size||(p[t]=n(t)),p[t]},v=function(e,t){return"string"==typeof t?function(e,t){return e.indexOf(t)>-1}(e,t):function(e,t){return t.filter((function(t){return v(e,t)})).length>0}(e,t)},S=["SharedOnline.","WordOnline.","ExcelOnline.","PowerPointOnline.","OneNoteOnline.","VisioOnline."],R=function(e){return function(e){return S.filter((function(t){return 0===e.indexOf(t)&&e.length>t.length})).length>0}(e)&&v(e,".ChangeGate.")},F=function(e){!function(e){if(!R(e)){var t="Change Gate Name validation failed: ".concat(e," should follow change gate naming convention.");throw a.a.shipAssertTag(538972812,s.a.msoulscat_Wac_Ribbon,!1,t),Error(t)}}(e);var t=e.toLowerCase();return!!g("Microsoft.Office.SharedOnline.ListOfForceEnabledChangeGates","").toLowerCase().includes(t)||!g("Microsoft.Office.SharedOnline.ListOfForceDisabledChangeGates","").toLowerCase().includes(t)&&(!y("SharedUxSafeVelocityStoppedGates").has(t)&&Object(C.isChangeGateEnabled)(e))},w=function(){function e(){this.toast=void 0,this.isVisible=!1}return e.getInstance=function(){return h||(h=new e),h},e.prototype.showToast=function(e,t,n,r,o,i,a,s){if(!this.isToastVisible()||s){if(this.toast)this.toast.setIcon(r,o),this.toast.setTitle(e),this.toast.setMessage(t);else{var d=document.createElement("div");d.setAttribute("style",function(e){return"position: absolute;\n        display: flex;\n        z-index: 2000;\n        left: 0px;\n        right: 0px;\n        top: ".concat(e?"40px":"8px",";\n        margin: auto;\n        align-items: center;\n        justify-content: center;\n        pointer-events: none;\n        opacity : 0;\n        transition: opacity 0.35s;\n        transition-timing-function: ease-in;")}(i)),document.body.appendChild(d),this.toast=l.createInstance(d,e,t,n,r,o),requestAnimationFrame((function(){d.style.opacity="1"}))}this.isToastVisible()||(this.toast.setVisibility(!0),this.isVisible=!0),this.logToastVisibilityChange(!0,a),this.displayTime=window.performance.now()}},e.prototype.dismissToast=function(e){var t;this.isToastVisible()&&(null===(t=this.toast)||void 0===t||t.setVisibility(!1),this.isVisible=!1,this.logToastVisibilityChange(!1,e),this.displayTime=void 0)},e.prototype.isToastVisible=function(){var e,t;return F("SharedOnline.ChangeGate.IsToastVisibleModified")?this.isVisible||"visible"===(null===(e=document.getElementById(o))||void 0===e?void 0:e.style.visibility)&&!u(document.getElementById(o),(function(e){return"none"===getComputedStyle(e).display})):this.isVisible||"visible"===(null===(t=document.getElementById(o))||void 0===t?void 0:t.style.visibility)},e.prototype.logToastVisibilityChange=function(e,t){var n="Unavailability Toast Visibility Changed: ".concat(e?"Shown":"Dismissed");!e&&this.displayTime&&(n+=", Duration Visible: ".concat(Math.trunc(window.performance.now()-this.displayTime))),t&&(n+=", Kind: ".concat(t)),a.a.sendTraceTag(537249949,s.a.msoulscat_Wac_Telemetry,d.a.Info,n)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);r.__exportStar(n(248),t),r.__exportStar(n(249),t)},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRendererFactoryGlobal=void 0;var r=n(100);t.CanvasRendererFactoryGlobal=new r.CanvasRendererFactory},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.RenderFeaturesZIndex=t.HitTestEvents=void 0,t.HitTestEvents=["pointerdown","pointerup","click","mouseenter","mouseleave","touchstart","touchend","dblclick"],function(e){e[e.DebugWatermark=0]="DebugWatermark",e[e.Headers=1]="Headers",e[e.HeaderResize=2]="HeaderResize",e[e.UnhideSkittle=3]="UnhideSkittle",e[e.HeaderDragDropSquares=4]="HeaderDragDropSquares",e[e.HeaderInsert=5]="HeaderInsert",e[e.GeneralCellTooltip=6]="GeneralCellTooltip",e[e.DynamicImage=7]="DynamicImage",e[e.Comments=8]="Comments",e[e.RichError=9]="RichError",e[e.DrillIndicator=1]="DrillIndicator",e[e.Hyperlink=11]="Hyperlink",e[e.ColumnOrRowSelector=12]="ColumnOrRowSelector",e[e.TableSelector=13]="TableSelector",e[e.RichValueIcon=14]="RichValueIcon",e[e.AutoFilter=15]="AutoFilter",e[e.CheckboxIcon=16]="CheckboxIcon"}(r||(t.RenderFeaturesZIndex=r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var r=n(79);t.makeGetTypedFeatureGate=function(e){return function(t){var n=e[t];switch(typeof n){case"boolean":return(0,r.getBooleanFeatureGate)(t,n);case"number":return(0,r.getNumberFeatureGate)(t,n);case"string":return(0,r.getStringFeatureGate)(t,n);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var r=n(80);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,r.isChangeGateEnabled)(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var r=n(4),o=n(80);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var n=void 0!==t?t():{};return r.__assign(r.__assign({},n),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var r=n(4),o=n(79);function i(e){for(var t,n,i={},l=0,a=Object.keys(e);l<a.length;l++){var s=a[l];i[s]=null===(t=e[s])||void 0===t?void 0:t.toString()}var d=null!==(n=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==n?n:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return r.__assign(r.__assign({},d()),i)})),d}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateOnlyStyleWithoutFont=void 0;var r=n(25);t.duplicateOnlyStyleWithoutFont=function(e,t,n){return{BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment||r.HorizontalAlignment.Automatic,ID:t||0,GlobalId:e.GlobalId,NamedStyleId:e.NamedStyleId||0,RefCount:n||0,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation||0,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder||r.ReadingOrderType.Context,FontID:e.FontID||0,GlobalFontID:e.GlobalFontID||0,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient,Orientation:e.Orientation||0,VerticalText:e.VerticalText||!1,PatternStyle:e.PatternStyle||0,PatternColor:e.PatternColor}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackDuration=t.verifyPerformanceNowSupported=t.perf=void 0,t.perf=o()?window.performance:void 0;var r=void 0;function o(){if(r)return r;r=!1,window.performance&&"function"==typeof window.performance.now&&(r=!0);try{window.performance.now()}catch(e){r=!1}return r}t.verifyPerformanceNowSupported=o,t.trackDuration=function(e){var n=t.perf?t.perf.now():-1;return e(),t.perf?t.perf.now()-n:-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalcBlockModel=void 0;var r=n(42),o=n(26),i=n(25),l=function(){function e(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}return e.prototype.createCell=function(e){var t,n=void 0,r=i.CellValueType.None,o=i.CellFormulaType.Value;e.Merge&&!e.Merge.IsOrigin||(n=e.Value,r=e.ValueType,o=e.FormulaInfo?e.FormulaInfo.FormulaType:i.CellFormulaType.Value);var l={col:e.Col,row:e.Row,text:e.Text,formula:null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula,value:n,ifmt:e.Ifmt||0,formulaType:o};return l.valueType=r,l},e.prototype.addCell=function(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[(0,r.getCellLookupKey)(e.row,e.col)]=e,this.keys=null},e.prototype.addHeaders=function(e,t){this.RowNumbers=e,this.ColumnNumbers=t},e.prototype.getRowNumbers=function(){return this.RowNumbers},e.prototype.getColumnNumbers=function(){return this.ColumnNumbers},e.prototype.getCell=function(e,t){return(0,o.isNullOrUndefined)(this.Cells)?null:this.Cells[(0,r.getCellLookupKey)(e,t)]},e.prototype.reset=function(){this.index=0,(0,o.isNullOrUndefined)(this.keys)&&(this.keys=Object.keys(this.Cells))},e.prototype.getNextCell=function(){if((0,o.isNullOrUndefined)(this.Cells)||(0,o.isNullOrUndefined)(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;var e=this.Cells[this.keys[this.index]];return this.index++,e},e}();t.CalcBlockModel=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRowHeaderStylesArray=t.createHeaderCell=t.calculateRowHeaderWidth=t.columnNumberToTitle=t.createHeaderBlockModel=void 0;var r=n(4),o=n(25),i=n(42),l=n(26),a=n(105),s=n(8),d=n(29);function u(e){if(e)for(var t=0,n=e;t<n.length;t++){var r=n[t];r&&(r.GlobalId=void 0)}}function c(e){for(var t=e-1,n=[];t>=0;)n.unshift(String.fromCharCode(a.LetterA+t%a.AlphaRadix)),t=Math.floor(t/a.AlphaRadix)-1;return n.join("")}function g(e,t){return(Math.max(a.MaxNumberOfDigitsInDefaultRowHeader,e)-a.MaxNumberOfDigitsInDefaultRowHeader)*a.RowWidthExtensionPerDigitPx+(t?a.RowHeaderWidthWithDragSquaresArea:a.DefaultRowHeaderWidth)}function f(e,t,n,r,i){var l=!r||i?0:1,a=i?"":function(e,t){return t?e.toString():c(e)}(t,n);return{Row:n?e:l,Col:n?l:e,StyleID:o.UniqueHeadersStyleID.Default,BorderStyleID:o.UniqueHeadersStyleID.Default,HorizontalAlignmentSet:!1,ValueType:o.CellValueType.String,Text:a}}function h(e,t){var n;switch(e){case o.ViewMode.Default:n=a.RowHeadersStylesArray;break;case o.ViewMode.NamedSheetView:n=a.RowHeadersNSVStylesArray;break;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelStyles: unsupported ViewMode")}return n.map((function(e){return r.__assign(r.__assign({},e),{HorizontalAlignment:t&&e.HorizontalAlignment===o.HorizontalAlignment.Left?o.HorizontalAlignment.Right:t&&e.HorizontalAlignment===o.HorizontalAlignment.Right?o.HorizontalAlignment.Left:e.HorizontalAlignment})}))}function C(e,t,n){var r,o=t?e.RowNumbers:e.ColumnNumbers;e.Cells=[];for(var i=n>0,l=[],a=0;a<o.length;a++){var s=f(a,o[a],t,i,!1);if(e.Cells.push(s),i){var d=f(a,o[a],t,i,!0);l.push(d)}}i&&(r=e.Cells).push.apply(r,l)}function m(e,t,n){var r=(0,d.isRenderFlagEnabled)(o.RenderFlagsArray.FluentStyle,e);switch(t){case o.ViewMode.Default:if(r){var l=(0,i.isIncreasedHeaderSizeEnabled)(e)?h(o.ViewMode.Default,e.IsRtl):a.RowHeadersStylesArrayBeforeHeaderDragImprovements;return n?l:a.ColumnHeadersStylesArray}return n?a.RowHeadersStylesArrayBeforeFluent:a.ColumnHeadersStylesArrayBeforeFluent;case o.ViewMode.NamedSheetView:if(r){l=(0,i.isIncreasedHeaderSizeEnabled)(e)?h(o.ViewMode.NamedSheetView,e.IsRtl):a.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements;return n?l:a.ColumnHeadersNSVStylesArray}return n?a.RowHeadersNSVStylesArrayBeforeFluent:a.ColumnHeadersNSVStylesArrayBeforeFluent;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelStyles: unsupported ViewMode")}}function p(e,t){var n=(0,d.isRenderFlagEnabled)(o.RenderFlagsArray.FluentStyle,e),r=(0,d.isRenderFlagEnabled)(o.RenderFlagsArray.NewDefaultTemplate,e)&&(0,d.isRenderFlagEnabled)(o.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,e)&&document.fonts.check("11pt ".concat(a.DefaultHeaderFont));switch(t){case o.ViewMode.Default:return r?n?a.HeadersFonts:a.HeadersFontsBeforeFluent:n?a.OldHeadersFonts:a.OldHeadersFontsBeforeFluent;case o.ViewMode.NamedSheetView:return r?n?a.HeadersNSVFonts:a.HeadersNSVFontsBeforeFluent:n?a.OldHeadersNSVFonts:a.OldHeadersNSVFontsBeforeFluent;case o.ViewMode.PresentMode:default:throw Error("headerBlockModelCreator.getModelFonts: unsupported ViewMode")}}function y(e){return(0,d.verifyArgumentNotNull)(e,"array","headerBlockModel.duplicateArray"),r.__spreadArray([],e,!0)}function v(e){return e?r.__assign({},e):e}function S(e,t,n){return t?e.BlockHeight:(0,i.isIncreasedHeaderSizeEnabled)(e)?a.ColHeaderHeightWithDragSquaresArea+n:a.DefaultColHeaderHeight+n}function R(e,t,n){return t?function(e,t,n){var r=e.length-1;return e[r]?g(e[r].toString().length,n)+t:(s.ULS.sendTraceTag(508966366,s.LogCategory.msoulscat_ES_EWAJSGrid,s.TraceLevel.Warning,"HeaderBlockModelCreator.getRowHeaderWidth: rowNumbers[lastRowIndex] is undefined, rowNumbers.length: ".concat(e.length,", lastRowIndex: ").concat(r,", rowNumbers: ").concat(e)),0)}(e.RowNumbers,n,(0,i.isIncreasedHeaderSizeEnabled)(e)):e.BlockWidth}t.createHeaderBlockModel=function(e,t,n){(0,d.verifyArgumentNotNull)(e,"gridModel","headerBlockModel.createHeaderBlockModel");var r=function(e,t){if(!(0,d.isRenderFlagEnabled)(o.RenderFlagsArray.RenderHeaderOutlinesInCanvas,e))return 0;var n=t?e.MaxRowOutlineLevelInSheet:e.MaxColOutlineLevelInSheet;if((0,l.isNullOrUndefined)(n)||0===n)return 0;return a.GroupingFirstLevelExtensionPx+(n-1)*a.GroupingLevelExtensionPx}(e,t),s={RenderFlagsArray:y(e.RenderFlagsArray),BlockHeight:S(e,t,r),BlockWidth:R(e,t,r),IsRtl:e.IsRtl,ShowGridLines:!0,Fonts:p(e,n),Styles:m(e,n,t),ShowHeaders:e.ShowHeaders,AdjacentBlocksHiddensInfo:v(e.AdjacentBlocksHiddensInfo),IsRow:t,PermissionSet:e.PermissionSet,RibbonCommands:e.RibbonCommands};return(0,i.isIncreasedHeaderSizeEnabled)(s)&&(u(s.Fonts),u(s.Styles)),t?function(e,t,n){return function(e,t,n){var r;t.RowNumbers=y(e.RowNumbers),t.RowOffsets=y(e.RowOffsets),t.RowHeights=y(e.RowHeights),n>0&&(t.RowOutlinesInformation=(0,i.cloneOutlines)(e.RowOutlinesInformation));t.MaxRowOutlineLevelInSheet=null!==(r=e.MaxRowOutlineLevelInSheet)&&void 0!==r?r:0}(e,t,n),C(t,!0,n),function(e,t){if(0===t)e.ColumnNumbers=[0],e.ColumnOffsets=[0],e.ColumnWidths=[e.BlockWidth];else{e.ColumnNumbers=[0,1],e.ColumnOffsets=[0,t];var n=e.BlockWidth-t;e.ColumnWidths=[t,n]}}(t,n),t}(e,s,r):function(e,t,n){return function(e,t,n){var r;t.ColumnNumbers=y(e.ColumnNumbers),t.ColumnOffsets=y(e.ColumnOffsets),t.ColumnWidths=y(e.ColumnWidths),n>0&&(t.ColumnOutlinesInformation=(0,i.cloneOutlines)(e.ColumnOutlinesInformation));t.MaxColOutlineLevelInSheet=null!==(r=e.MaxColOutlineLevelInSheet)&&void 0!==r?r:0}(e,t,n),C(t,!1,n),function(e,t){0===t?(e.RowNumbers=[0],e.RowOffsets=[0],e.RowHeights=(0,i.isIncreasedHeaderSizeEnabled)(e)?[a.ColHeaderHeightWithDragSquaresArea]:[a.DefaultColHeaderHeight]):(e.RowNumbers=[0,1],e.RowOffsets=[0,t],e.RowHeights=(0,i.isIncreasedHeaderSizeEnabled)(e)?[t,a.ColHeaderHeightWithDragSquaresArea]:[t,a.DefaultColHeaderHeight])}(t,n),t}(e,s,r)},t.columnNumberToTitle=c,t.calculateRowHeaderWidth=g,t.createHeaderCell=f,t.getRowHeaderStylesArray=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Digit=t.ValueAnnonymizerRegex=t.CharacterReplaceValue=t.DigitPattern=t.DigitReplaceValue=t.AllowedCharactersToLog=t.SetCellOfInterestSymbols=t.CurrencySymbols=void 0,t.CurrencySymbols="$",t.SetCellOfInterestSymbols='=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*'+t.CurrencySymbols,t.AllowedCharactersToLog=t.SetCellOfInterestSymbols+"\\s",t.DigitReplaceValue="d",t.DigitPattern="[0-9]",t.CharacterReplaceValue="w",t.ValueAnnonymizerRegex=new RegExp("[^"+t.AllowedCharactersToLog+t.DigitReplaceValue+"]","gm"),t.Digit=new RegExp(t.DigitPattern,"gm")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areGridObjectsEqual=t.areGridArraysEqual=t.areGridCellsEqual=t.getCellIgnoreList=t.getNonIgnoredPropertyNames=t.areMergeInformationEqual=t.areNumberFormatInformationEqual=t.areInCellControlOptionsEqual=t.areFormattedTextsEqual=t.areStylesEqual=t.comparePartialGridBlockModels=t.compareGridBlockModels=void 0;var r,o,i,l,a,s,d,u,c,g,f,h,C,m,p,y,v,S,R,F,w=n(4),T=n(42),I=n(107),x=n(29),b=n(108),D=n(17),A=!1;function P(e,t){if(B(),"object"!=typeof e)return[];var n=Object.getOwnPropertyNames(e);return t?t instanceof Set?n.filter((function(e){return!t.has(e)})):n.filter((function(e){return-1===t.indexOf(e)})):n}function H(e,t){B();var n=(0,T.isAccAndCustomNumFmtApplicable)(e)&&(0,T.isAccAndCustomNumFmtApplicable)(t),r=t.DisplayFormula;return n?r?v:S:r?R:F}function B(){A||(r=(0,b.getComparisonIgnoreLists)((0,D.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListFix",!1)),o=r.GridBlockModel.concat(["Cells"]).concat(r.RangeInformation).concat(r.PivotTableRangeInformation).concat(r.DynamicImageInformation).concat(r.Sparklines),i=r.Cell.concat(["Row","Col"]),l=i.concat(["Text"]),a=i.concat(["FormulaInfo"]),s=l.concat(["FormulaInfo"]),d=r.ReferencedObject,u=r.CellStyle.concat(d),c=u.concat(r.AutoFilter).concat(r.FormulaInformation).concat(r.MergeInformation).concat(r.TextRun).concat(r.Hyperlink).concat(r.LinkedEntityInformation).concat(r.PivotTableCellInformation),g=r.TextRun,f=[],h=[],C=[],m=g.concat(["Fonts"]),p=new Set(o),y=new Set(w.__spreadArray(w.__spreadArray([],o,!0),["BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers"],!1)),v=new Set(w.__spreadArray(w.__spreadArray([],l,!0),c,!0)),S=new Set(w.__spreadArray(w.__spreadArray([],s,!0),c,!0)),R=new Set(w.__spreadArray(w.__spreadArray([],i,!0),c,!0)),F=new Set(w.__spreadArray(w.__spreadArray([],a,!0),c,!0)),A=!0)}t.compareGridBlockModels=function(e,t,n){B();var o=p,i=(0,I.areObjectsEqual)(e,t,o,P,r);return i.isEqual?(0,I.compareModelCells)(e,t,n,P,H,r):{isEqual:i.isEqual,message:i.message,canDiffRender:!1,changedCellsKeys:void 0}},t.comparePartialGridBlockModels=function(e,t,n,o,i,l){B();var a=(0,I.areObjectsEqual)(e,t,y,P,r);if(!a.isEqual)return{isEqual:a.isEqual,message:a.message,canDiffRender:!1,changedCellsKeys:void 0};(0,x.verifyArgumentNotNull)(e.RowNumbers,"model1.RowNumbers","comparePartialGridBlockModels"),(0,x.verifyArgumentNotNull)(t.RowNumbers,"model2.RowNumbers","comparePartialGridBlockModels");var s=(0,I.getRowColIndexFromNumber)(e.RowNumbers,n),d=(0,I.getRowColIndexFromNumber)(e.RowNumbers,o),u=(0,I.comparePartialRowsInGridBlockModel)(e,t,s,d);if(!u.isEqual)return u;(0,x.verifyArgumentNotNull)(e.ColumnNumbers,"model1.ColumnNumbers","comparePartialGridBlockModels"),(0,x.verifyArgumentNotNull)(t.ColumnNumbers,"model2.ColumnNumbers","comparePartialGridBlockModels");var c=(0,I.getRowColIndexFromNumber)(e.ColumnNumbers,i),g=(0,I.getRowColIndexFromNumber)(e.ColumnNumbers,l),f=(0,I.comparePartialColumnsInGridBlockModel)(e,t,c,g);return f.isEqual?(0,I.comparePartialCellsInGridBlockModel)(e,t,s,d,c,g,P,H,r):f},t.areStylesEqual=function(e,t,n,r){return B(),(0,I.areObjectsEqual)(e,t,u,n,r)},t.areFormattedTextsEqual=function(e,t){if(B(),e&&t){if(e.TextRuns&&!e.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText1 has Textruns without Fonts."};if(t.TextRuns&&!t.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText2 has Textruns without Fonts."};(0,I.ensureCachedFontsInTextRuns)(e.TextRuns,e.Fonts),(0,I.ensureCachedFontsInTextRuns)(t.TextRuns,t.Fonts)}return(0,I.areObjectsEqual)(e,t,m,P,r)},t.areInCellControlOptionsEqual=function(e,t){return B(),(0,I.areObjectsEqual)(e,t,f,P,r)},t.areNumberFormatInformationEqual=function(e,t){return B(),(0,I.areObjectsEqual)(e,t,h,P,r)},t.areMergeInformationEqual=function(e,t){return B(),(0,I.areObjectsEqual)(e,t,C,P,r)},t.getNonIgnoredPropertyNames=P,t.getCellIgnoreList=H,t.areGridCellsEqual=function(e,t,n,o){return B(),(0,I.areCellsEqual)(e,t,n,o,P,H,r)},t.areGridArraysEqual=function(e,t,n){return B(),(0,I.areArraysEqual)(e,t,n,P,r)},t.areGridObjectsEqual=function(e,t,n,o){return B(),(0,I.areObjectsEqual)(e,t,n,P,r,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareHeaderBlockModels=void 0;var r=n(107),o=n(37),i=n(63),l=n(26),a=i.HeaderIncludeLists.GridBlockModel;function s(e,t){return(0,l.isNullOrUndefined)(t)?[]:t instanceof Array?t:Array.from(t)}function d(e,t){return(0,o.isChangeGateEnabled)(o.ChangeGate.HeaderCellCompareFix)?i.HeaderIncludeLists.Cell.concat(i.HeaderIncludeLists.HeaderCell):i.HeaderIncludeLists.Cell}t.compareHeaderBlockModels=function(e,t){var n=(0,r.areObjectsEqual)(e,t,a,s,i.HeaderIncludeLists);return n.isEqual?(0,r.compareModelCells)(e,t,void 0,s,d,i.HeaderIncludeLists):{isEqual:!1,message:n.message,canDiffRender:!1,changedCellsKeys:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellLog=t.getRangeLog=t.getRangeTopLeftCell=t.isModelCellContainedInRange=t.isCellContainedInRange=void 0,t.isCellContainedInRange=function(e,t){return(!e.NamedObjectName&&!t.NamedObjectName||e.NamedObjectName===t.NamedObjectName)&&((!e.SheetName&&!t.SheetName||e.SheetName===t.SheetName)&&(e.FirstColumn<=t.FirstColumn&&e.LastColumn>=t.FirstColumn&&e.FirstRow<=t.FirstRow&&e.LastRow>=t.FirstRow))},t.isModelCellContainedInRange=function(e,t,n){var r=e.ColumnNumbers[n.Col],o=e.RowNumbers[n.Row];return t.FirstColumn<=r&&t.LastColumn>=r&&t.FirstRow<=o&&t.LastRow>=o},t.getRangeTopLeftCell=function(e){return{SheetName:e.SheetName,NamedObjectName:e.NamedObjectName,FirstRow:e.FirstRow,FirstColumn:e.FirstColumn}},t.getRangeLog=function(e){return"(".concat(e.FirstRow,"-").concat(e.LastRow,", ").concat(e.FirstColumn,"-").concat(e.LastColumn,")")},t.getCellLog=function(e){return"(".concat(e.FirstRow,",").concat(e.FirstColumn,")")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSkeletonCells=t.drawSkeleton=void 0;var r=n(3),o=n(2),i=n(5),l=n(6);function a(e,t,n,r,o){var i=Math.min(r/4,16),l=Math.min(o/4,8),a=t+r/2-i/2,s=n+o/2-l/2;e.fillRect(a,s,i,l)}t.drawSkeleton=function(e,t,n){(0,i.verifyArgumentNotNull)(e,"ctx","drawSkeleton"),(0,i.verifyArgumentNotNull)(t,"model","drawSkeleton"),(0,i.verifyArgumentNotNull)(n,"context","drawSkeleton");var l=t.ClientOnlyCache;if((0,i.verifyArgumentNotNull)(l,"ClientOnlyCache","drawSkeleton"),(0,i.verifyArgumentNotNull)(l.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),(0,i.verifyArgumentNotNull)(l.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),(0,i.verifyArgumentNotNull)(t.RowHeights,"RowHeights","drawSkeleton"),(0,i.verifyArgumentNotNull)(t.ColumnWidths,"ColumnWidths","drawSkeleton"),!(n.scaleFactor<r.MinimalScaleFactorForGridlinesRendering)&&t.ShowGridLines){e.fillStyle=r.SkeletonColor;for(var s=0;s<l.RowOffsetsAdjustedForDrawing.length-1;s++)for(var d=l.RowOffsetsAdjustedForDrawing[s],u=(0,o.getRowHeightFromOffsets)(s,l.RowOffsetsAdjustedForDrawing),c=0;c<l.ColOffsetsAdjustedForDrawing.length-1;c++){a(e,(0,o.getColOffsetAdjustedForDrawing)(c,t),d,(0,o.getColWidthFromOffsets)(c,l.ColOffsetsAdjustedForDrawing),u)}}},t.drawSkeletonCells=function(e,t,n){if((0,i.verifyArgumentNotNull)(e,"ctx","drawSkeletonCells"),(0,i.verifyArgumentNotNull)(t,"model","drawSkeletonCells"),(0,i.verifyArgumentNotNull)(n,"context","drawSkeletonCells"),!(n.scaleFactor<r.MinimalScaleFactorForGridlinesRendering)){var s=t.ClientOnlyCache.CellsToRender;e.fillStyle=r.SkeletonCellsColor;for(var d=0;d<s.length;d++){var u=s[d];if((null==u?void 0:u.ShowSkeleton)&&(0,o.cellIntersectsRenderingRegion)(u,n.renderingRegion)){var c=(0,l.getCellTopAdjustedForDrawing)(t,u,!0),g=(0,l.getCellHeightAdjustedForDrawing)(t,u);a(e,(0,l.getCellLeftAdjustedForDrawing)(t,u,!1,!0),c,(0,l.getCellWidthAdjustedForDrawing)(t,u),g)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerticalAlignmentFontSizeAdjusted=void 0,t.getVerticalAlignmentFontSizeAdjusted=function(e){return 2*e/3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cssFontToCanvasFont=void 0;var r=n(0),o=n(110),i=void 0,l=void 0,a=!1,s={};t.cssFontToCanvasFont=function(e,t,n){if(!n||t&&(0,r.isSafari)())return e;if(a||((i=new o.RenderingCanvasElement(!1,!0)).setWidth(1),i.setHeight(1),l=i.getContext2d(),a=!0),!l)return e;var d=s[e];return d||(l.font=e,d=l.font,s[e]=d,d)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldAddRichValueIconPadding=void 0;var r=n(18);t.shouldAddRichValueIconPadding=function(e,t){if(t.PivotTable)return!1;var n=!!t.RichValueIcon&&!!t.AutoFilter;return e.IsRtl&&n&&!(0,r.isTextAlignedOnButton)(e,t.CachedStyle)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.classifyChar=void 0;var r=n(116);t.classifyChar=function(e){return 8205===e?r.CombiningClass.ZWJ:13===e?r.CombiningClass.CR:10===e?r.CombiningClass.LF:function(e){return 0<=e&&e<=9||11<=e&&e<=12||14<=e&&e<=31||127<=e&&e<=159||173===e||1564===e||6158===e||8203===e||8206<=e&&e<=8207||8232===e||8233===e||8234<=e&&e<=8238||8288<=e&&e<=8292||8293===e||8294<=e&&e<=8303||55296<=e&&e<=57343||65279===e||65520<=e&&e<=65528||65529<=e&&e<=65531||113824<=e&&e<=113827||119155<=e&&e<=119162||917504===e||917505===e||917506<=e&&e<=917535||917632<=e&&e<=917759||918e3<=e&&e<=921599}(e)?r.CombiningClass.Control:function(e){return 768<=e&&e<=879||1155<=e&&e<=1159||1160<=e&&e<=1161||1425<=e&&e<=1469||1471===e||1473<=e&&e<=1474||1476<=e&&e<=1477||1479===e||1552<=e&&e<=1562||1611<=e&&e<=1631||1648===e||1750<=e&&e<=1756||1759<=e&&e<=1764||1767<=e&&e<=1768||1770<=e&&e<=1773||1809===e||1840<=e&&e<=1866||1958<=e&&e<=1968||2027<=e&&e<=2035||2070<=e&&e<=2073||2075<=e&&e<=2083||2085<=e&&e<=2087||2089<=e&&e<=2093||2137<=e&&e<=2139||2260<=e&&e<=2273||2275<=e&&e<=2306||2362===e||2364===e||2369<=e&&e<=2376||2381===e||2385<=e&&e<=2391||2402<=e&&e<=2403||2433===e||2492===e||2494===e||2497<=e&&e<=2500||2509===e||2519===e||2530<=e&&e<=2531||2561<=e&&e<=2562||2620===e||2625<=e&&e<=2626||2631<=e&&e<=2632||2635<=e&&e<=2637||2641===e||2672<=e&&e<=2673||2677===e||2689<=e&&e<=2690||2748===e||2753<=e&&e<=2757||2759<=e&&e<=2760||2765===e||2786<=e&&e<=2787||2810<=e&&e<=2815||2817===e||2876===e||2878===e||2879===e||2881<=e&&e<=2884||2893===e||2902===e||2903===e||2914<=e&&e<=2915||2946===e||3006===e||3008===e||3021===e||3031===e||3072===e||3134<=e&&e<=3136||3142<=e&&e<=3144||3146<=e&&e<=3149||3157<=e&&e<=3158||3170<=e&&e<=3171||3201===e||3260===e||3263===e||3266===e||3270===e||3276<=e&&e<=3277||3285<=e&&e<=3286||3298<=e&&e<=3299||3328<=e&&e<=3329||3387<=e&&e<=3388||3390===e||3393<=e&&e<=3396||3405===e||3415===e||3426<=e&&e<=3427||3530===e||3535===e||3538<=e&&e<=3540||3542===e||3551===e||3633===e||3636<=e&&e<=3642||3655<=e&&e<=3662||3761===e||3764<=e&&e<=3769||3771<=e&&e<=3772||3784<=e&&e<=3789||3864<=e&&e<=3865||3893===e||3895===e||3897===e||3953<=e&&e<=3966||3968<=e&&e<=3972||3974<=e&&e<=3975||3981<=e&&e<=3991||3993<=e&&e<=4028||4038===e||4141<=e&&e<=4144||4146<=e&&e<=4151||4153<=e&&e<=4154||4157<=e&&e<=4158||4184<=e&&e<=4185||4190<=e&&e<=4192||4209<=e&&e<=4212||4226===e||4229<=e&&e<=4230||4237===e||4253===e||4957<=e&&e<=4959||5906<=e&&e<=5908||5938<=e&&e<=5940||5970<=e&&e<=5971||6002<=e&&e<=6003||6068<=e&&e<=6069||6071<=e&&e<=6077||6086===e||6089<=e&&e<=6099||6109===e||6155<=e&&e<=6157||6277<=e&&e<=6278||6313===e||6432<=e&&e<=6434||6439<=e&&e<=6440||6450===e||6457<=e&&e<=6459||6679<=e&&e<=6680||6683===e||6742===e||6744<=e&&e<=6750||6752===e||6754===e||6757<=e&&e<=6764||6771<=e&&e<=6780||6783===e||6832<=e&&e<=6845||6846===e||6912<=e&&e<=6915||6964===e||6966<=e&&e<=6970||6972===e||6978===e||7019<=e&&e<=7027||7040<=e&&e<=7041||7074<=e&&e<=7077||7080<=e&&e<=7081||7083<=e&&e<=7085||7142===e||7144<=e&&e<=7145||7149===e||7151<=e&&e<=7153||7212<=e&&e<=7219||7222<=e&&e<=7223||7376<=e&&e<=7378||7380<=e&&e<=7392||7394<=e&&e<=7400||7405===e||7412===e||7416<=e&&e<=7417||7616<=e&&e<=7673||7675<=e&&e<=7679||8204===e||8400<=e&&e<=8412||8413<=e&&e<=8416||8417===e||8418<=e&&e<=8420||8421<=e&&e<=8432||11503<=e&&e<=11505||11647===e||11744<=e&&e<=11775||12330<=e&&e<=12333||12334<=e&&e<=12335||12441<=e&&e<=12442||42607===e||42608<=e&&e<=42610||42612<=e&&e<=42621||42654<=e&&e<=42655||42736<=e&&e<=42737||43010===e||43014===e||43019===e||43045<=e&&e<=43046||43204<=e&&e<=43205||43232<=e&&e<=43249||43302<=e&&e<=43309||43335<=e&&e<=43345||43392<=e&&e<=43394||43443===e||43446<=e&&e<=43449||43452===e||43493===e||43561<=e&&e<=43566||43569<=e&&e<=43570||43573<=e&&e<=43574||43587===e||43596===e||43644===e||43696===e||43698<=e&&e<=43700||43703<=e&&e<=43704||43710<=e&&e<=43711||43713===e||43756<=e&&e<=43757||43766===e||44005===e||44008===e||44013===e||64286===e||65024<=e&&e<=65039||65056<=e&&e<=65071||65438<=e&&e<=65439||66045===e||66272===e||66422<=e&&e<=66426||68097<=e&&e<=68099||68101<=e&&e<=68102||68108<=e&&e<=68111||68152<=e&&e<=68154||68159===e||68325<=e&&e<=68326||69633===e||69688<=e&&e<=69702||69759<=e&&e<=69761||69811<=e&&e<=69814||69817<=e&&e<=69818||69888<=e&&e<=69890||69927<=e&&e<=69931||69933<=e&&e<=69940||70003===e||70016<=e&&e<=70017||70070<=e&&e<=70078||70090<=e&&e<=70092||70191<=e&&e<=70193||70196===e||70198<=e&&e<=70199||70206===e||70367===e||70371<=e&&e<=70378||70400<=e&&e<=70401||70460===e||70462===e||70464===e||70487===e||70502<=e&&e<=70508||70512<=e&&e<=70516||70712<=e&&e<=70719||70722<=e&&e<=70724||70726===e||70832===e||70835<=e&&e<=70840||70842===e||70845===e||70847<=e&&e<=70848||70850<=e&&e<=70851||71087===e||71090<=e&&e<=71093||71100<=e&&e<=71101||71103<=e&&e<=71104||71132<=e&&e<=71133||71219<=e&&e<=71226||71229===e||71231<=e&&e<=71232||71339===e||71341===e||71344<=e&&e<=71349||71351===e||71453<=e&&e<=71455||71458<=e&&e<=71461||71463<=e&&e<=71467||72193<=e&&e<=72198||72201<=e&&e<=72202||72243<=e&&e<=72248||72251<=e&&e<=72254||72263===e||72273<=e&&e<=72278||72281<=e&&e<=72283||72330<=e&&e<=72342||72344<=e&&e<=72345||72752<=e&&e<=72758||72760<=e&&e<=72765||72767===e||72850<=e&&e<=72871||72874<=e&&e<=72880||72882<=e&&e<=72883||72885<=e&&e<=72886||73009<=e&&e<=73014||73018===e||73020<=e&&e<=73021||73023<=e&&e<=73029||73031===e||92912<=e&&e<=92916||92976<=e&&e<=92982||94095<=e&&e<=94098||113821<=e&&e<=113822||119141===e||119143<=e&&e<=119145||119150<=e&&e<=119154||119163<=e&&e<=119170||119173<=e&&e<=119179||119210<=e&&e<=119213||119362<=e&&e<=119364||121344<=e&&e<=121398||121403<=e&&e<=121452||121461===e||121476===e||121499<=e&&e<=121503||121505<=e&&e<=121519||122880<=e&&e<=122886||122888<=e&&e<=122904||122907<=e&&e<=122913||122915<=e&&e<=122916||122918<=e&&e<=122922||125136<=e&&e<=125142||125252<=e&&e<=125258||917536<=e&&e<=917631||917760<=e&&e<=917999}(e)?r.CombiningClass.Extend:function(e){return 127462<=e&&e<=127487}(e)?r.CombiningClass.Regional_Indicator:function(e){return 2307===e||2363===e||2366<=e&&e<=2368||2377<=e&&e<=2380||2382<=e&&e<=2383||2434<=e&&e<=2435||2495<=e&&e<=2496||2503<=e&&e<=2504||2507<=e&&e<=2508||2563===e||2622<=e&&e<=2624||2691===e||2750<=e&&e<=2752||2761===e||2763<=e&&e<=2764||2818<=e&&e<=2819||2880===e||2887<=e&&e<=2888||2891<=e&&e<=2892||3007===e||3009<=e&&e<=3010||3014<=e&&e<=3016||3018<=e&&e<=3020||3073<=e&&e<=3075||3137<=e&&e<=3140||3202<=e&&e<=3203||3262===e||3264<=e&&e<=3265||3267<=e&&e<=3268||3271<=e&&e<=3272||3274<=e&&e<=3275||3330<=e&&e<=3331||3391<=e&&e<=3392||3398<=e&&e<=3400||3402<=e&&e<=3404||3458<=e&&e<=3459||3536<=e&&e<=3537||3544<=e&&e<=3550||3570<=e&&e<=3571||3635===e||3763===e||3902<=e&&e<=3903||3967===e||4145===e||4155<=e&&e<=4156||4182<=e&&e<=4183||4228===e||6070===e||6078<=e&&e<=6085||6087<=e&&e<=6088||6435<=e&&e<=6438||6441<=e&&e<=6443||6448<=e&&e<=6449||6451<=e&&e<=6456||6681<=e&&e<=6682||6741===e||6743===e||6765<=e&&e<=6770||6916===e||6965===e||6971===e||6973<=e&&e<=6977||6979<=e&&e<=6980||7042===e||7073===e||7078<=e&&e<=7079||7082===e||7143===e||7146<=e&&e<=7148||7150===e||7154<=e&&e<=7155||7204<=e&&e<=7211||7220<=e&&e<=7221||7393===e||7410<=e&&e<=7411||7415===e||43043<=e&&e<=43044||43047===e||43136<=e&&e<=43137||43188<=e&&e<=43203||43346<=e&&e<=43347||43395===e||43444<=e&&e<=43445||43450<=e&&e<=43451||43453<=e&&e<=43456||43567<=e&&e<=43568||43571<=e&&e<=43572||43597===e||43755===e||43758<=e&&e<=43759||43765===e||44003<=e&&e<=44004||44006<=e&&e<=44007||44009<=e&&e<=44010||44012===e||69632===e||69634===e||69762===e||69808<=e&&e<=69810||69815<=e&&e<=69816||69932===e||70018===e||70067<=e&&e<=70069||70079<=e&&e<=70080||70188<=e&&e<=70190||70194<=e&&e<=70195||70197===e||70368<=e&&e<=70370||70402<=e&&e<=70403||70463===e||70465<=e&&e<=70468||70471<=e&&e<=70472||70475<=e&&e<=70477||70498<=e&&e<=70499||70709<=e&&e<=70711||70720<=e&&e<=70721||70725===e||70833<=e&&e<=70834||70841===e||70843<=e&&e<=70844||70846===e||70849===e||71088<=e&&e<=71089||71096<=e&&e<=71099||71102===e||71216<=e&&e<=71218||71227<=e&&e<=71228||71230===e||71340===e||71342<=e&&e<=71343||71350===e||71456<=e&&e<=71457||71462===e||72199<=e&&e<=72200||72249===e||72279<=e&&e<=72280||72343===e||72751===e||72766===e||72873===e||72881===e||72884===e||94033<=e&&e<=94078||119142===e||119149===e}(e)?r.CombiningClass.SpacingMark:function(e){return 4352<=e&&e<=4447||43360<=e&&e<=43388}(e)?r.CombiningClass.L:function(e){return 44033<=e&&e<=44059||44061<=e&&e<=44087||44089<=e&&e<=44115||44117<=e&&e<=44143||44145<=e&&e<=44171||44173<=e&&e<=44199||44201<=e&&e<=44227||44229<=e&&e<=44255||44257<=e&&e<=44283||44285<=e&&e<=44311||44313<=e&&e<=44339||44341<=e&&e<=44367||44369<=e&&e<=44395||44397<=e&&e<=44423||44425<=e&&e<=44451||44453<=e&&e<=44479||44481<=e&&e<=44507||44509<=e&&e<=44535||44537<=e&&e<=44563||44565<=e&&e<=44591||44593<=e&&e<=44619||44621<=e&&e<=44647||44649<=e&&e<=44675||44677<=e&&e<=44703||44705<=e&&e<=44731||44733<=e&&e<=44759||44761<=e&&e<=44787||44789<=e&&e<=44815||44817<=e&&e<=44843||44845<=e&&e<=44871||44873<=e&&e<=44899||44901<=e&&e<=44927||44929<=e&&e<=44955||44957<=e&&e<=44983||44985<=e&&e<=45011||45013<=e&&e<=45039||45041<=e&&e<=45067||45069<=e&&e<=45095||45097<=e&&e<=45123||45125<=e&&e<=45151||45153<=e&&e<=45179||45181<=e&&e<=45207||45209<=e&&e<=45235||45237<=e&&e<=45263||45265<=e&&e<=45291||45293<=e&&e<=45319||45321<=e&&e<=45347||45349<=e&&e<=45375||45377<=e&&e<=45403||45405<=e&&e<=45431||45433<=e&&e<=45459||45461<=e&&e<=45487||45489<=e&&e<=45515||45517<=e&&e<=45543||45545<=e&&e<=45571||45573<=e&&e<=45599||45601<=e&&e<=45627||45629<=e&&e<=45655||45657<=e&&e<=45683||45685<=e&&e<=45711||45713<=e&&e<=45739||45741<=e&&e<=45767||45769<=e&&e<=45795||45797<=e&&e<=45823||45825<=e&&e<=45851||45853<=e&&e<=45879||45881<=e&&e<=45907||45909<=e&&e<=45935||45937<=e&&e<=45963||45965<=e&&e<=45991||45993<=e&&e<=46019||46021<=e&&e<=46047||46049<=e&&e<=46075||46077<=e&&e<=46103||46105<=e&&e<=46131||46133<=e&&e<=46159||46161<=e&&e<=46187||46189<=e&&e<=46215||46217<=e&&e<=46243||46245<=e&&e<=46271||46273<=e&&e<=46299||46301<=e&&e<=46327||46329<=e&&e<=46355||46357<=e&&e<=46383||46385<=e&&e<=46411||46413<=e&&e<=46439||46441<=e&&e<=46467||46469<=e&&e<=46495||46497<=e&&e<=46523||46525<=e&&e<=46551||46553<=e&&e<=46579||46581<=e&&e<=46607||46609<=e&&e<=46635||46637<=e&&e<=46663||46665<=e&&e<=46691||46693<=e&&e<=46719||46721<=e&&e<=46747||46749<=e&&e<=46775||46777<=e&&e<=46803||46805<=e&&e<=46831||46833<=e&&e<=46859||46861<=e&&e<=46887||46889<=e&&e<=46915||46917<=e&&e<=46943||46945<=e&&e<=46971||46973<=e&&e<=46999||47001<=e&&e<=47027||47029<=e&&e<=47055||47057<=e&&e<=47083||47085<=e&&e<=47111||47113<=e&&e<=47139||47141<=e&&e<=47167||47169<=e&&e<=47195||47197<=e&&e<=47223||47225<=e&&e<=47251||47253<=e&&e<=47279||47281<=e&&e<=47307||47309<=e&&e<=47335||47337<=e&&e<=47363||47365<=e&&e<=47391||47393<=e&&e<=47419||47421<=e&&e<=47447||47449<=e&&e<=47475||47477<=e&&e<=47503||47505<=e&&e<=47531||47533<=e&&e<=47559||47561<=e&&e<=47587||47589<=e&&e<=47615||47617<=e&&e<=47643||47645<=e&&e<=47671||47673<=e&&e<=47699||47701<=e&&e<=47727||47729<=e&&e<=47755||47757<=e&&e<=47783||47785<=e&&e<=47811||47813<=e&&e<=47839||47841<=e&&e<=47867||47869<=e&&e<=47895||47897<=e&&e<=47923||47925<=e&&e<=47951||47953<=e&&e<=47979||47981<=e&&e<=48007||48009<=e&&e<=48035||48037<=e&&e<=48063||48065<=e&&e<=48091||48093<=e&&e<=48119||48121<=e&&e<=48147||48149<=e&&e<=48175||48177<=e&&e<=48203||48205<=e&&e<=48231||48233<=e&&e<=48259||48261<=e&&e<=48287||48289<=e&&e<=48315||48317<=e&&e<=48343||48345<=e&&e<=48371||48373<=e&&e<=48399||48401<=e&&e<=48427||48429<=e&&e<=48455||48457<=e&&e<=48483||48485<=e&&e<=48511||48513<=e&&e<=48539||48541<=e&&e<=48567||48569<=e&&e<=48595||48597<=e&&e<=48623||48625<=e&&e<=48651||48653<=e&&e<=48679||48681<=e&&e<=48707||48709<=e&&e<=48735||48737<=e&&e<=48763||48765<=e&&e<=48791||48793<=e&&e<=48819||48821<=e&&e<=48847||48849<=e&&e<=48875||48877<=e&&e<=48903||48905<=e&&e<=48931||48933<=e&&e<=48959||48961<=e&&e<=48987||48989<=e&&e<=49015||49017<=e&&e<=49043||49045<=e&&e<=49071||49073<=e&&e<=49099||49101<=e&&e<=49127||49129<=e&&e<=49155||49157<=e&&e<=49183||49185<=e&&e<=49211||49213<=e&&e<=49239||49241<=e&&e<=49267||49269<=e&&e<=49295||49297<=e&&e<=49323||49325<=e&&e<=49351||49353<=e&&e<=49379||49381<=e&&e<=49407||49409<=e&&e<=49435||49437<=e&&e<=49463||49465<=e&&e<=49491||49493<=e&&e<=49519||49521<=e&&e<=49547||49549<=e&&e<=49575||49577<=e&&e<=49603||49605<=e&&e<=49631||49633<=e&&e<=49659||49661<=e&&e<=49687||49689<=e&&e<=49715||49717<=e&&e<=49743||49745<=e&&e<=49771||49773<=e&&e<=49799||49801<=e&&e<=49827||49829<=e&&e<=49855||49857<=e&&e<=49883||49885<=e&&e<=49911||49913<=e&&e<=49939||49941<=e&&e<=49967||49969<=e&&e<=49995||49997<=e&&e<=50023||50025<=e&&e<=50051||50053<=e&&e<=50079||50081<=e&&e<=50107||50109<=e&&e<=50135||50137<=e&&e<=50163||50165<=e&&e<=50191||50193<=e&&e<=50219||50221<=e&&e<=50247||50249<=e&&e<=50275||50277<=e&&e<=50303||50305<=e&&e<=50331||50333<=e&&e<=50359||50361<=e&&e<=50387||50389<=e&&e<=50415||50417<=e&&e<=50443||50445<=e&&e<=50471||50473<=e&&e<=50499||50501<=e&&e<=50527||50529<=e&&e<=50555||50557<=e&&e<=50583||50585<=e&&e<=50611||50613<=e&&e<=50639||50641<=e&&e<=50667||50669<=e&&e<=50695||50697<=e&&e<=50723||50725<=e&&e<=50751||50753<=e&&e<=50779||50781<=e&&e<=50807||50809<=e&&e<=50835||50837<=e&&e<=50863||50865<=e&&e<=50891||50893<=e&&e<=50919||50921<=e&&e<=50947||50949<=e&&e<=50975||50977<=e&&e<=51003||51005<=e&&e<=51031||51033<=e&&e<=51059||51061<=e&&e<=51087||51089<=e&&e<=51115||51117<=e&&e<=51143||51145<=e&&e<=51171||51173<=e&&e<=51199||51201<=e&&e<=51227||51229<=e&&e<=51255||51257<=e&&e<=51283||51285<=e&&e<=51311||51313<=e&&e<=51339||51341<=e&&e<=51367||51369<=e&&e<=51395||51397<=e&&e<=51423||51425<=e&&e<=51451||51453<=e&&e<=51479||51481<=e&&e<=51507||51509<=e&&e<=51535||51537<=e&&e<=51563||51565<=e&&e<=51591||51593<=e&&e<=51619||51621<=e&&e<=51647||51649<=e&&e<=51675||51677<=e&&e<=51703||51705<=e&&e<=51731||51733<=e&&e<=51759||51761<=e&&e<=51787||51789<=e&&e<=51815||51817<=e&&e<=51843||51845<=e&&e<=51871||51873<=e&&e<=51899||51901<=e&&e<=51927||51929<=e&&e<=51955||51957<=e&&e<=51983||51985<=e&&e<=52011||52013<=e&&e<=52039||52041<=e&&e<=52067||52069<=e&&e<=52095||52097<=e&&e<=52123||52125<=e&&e<=52151||52153<=e&&e<=52179||52181<=e&&e<=52207||52209<=e&&e<=52235||52237<=e&&e<=52263||52265<=e&&e<=52291||52293<=e&&e<=52319||52321<=e&&e<=52347||52349<=e&&e<=52375||52377<=e&&e<=52403||52405<=e&&e<=52431||52433<=e&&e<=52459||52461<=e&&e<=52487||52489<=e&&e<=52515||52517<=e&&e<=52543||52545<=e&&e<=52571||52573<=e&&e<=52599||52601<=e&&e<=52627||52629<=e&&e<=52655||52657<=e&&e<=52683||52685<=e&&e<=52711||52713<=e&&e<=52739||52741<=e&&e<=52767||52769<=e&&e<=52795||52797<=e&&e<=52823||52825<=e&&e<=52851||52853<=e&&e<=52879||52881<=e&&e<=52907||52909<=e&&e<=52935||52937<=e&&e<=52963||52965<=e&&e<=52991||52993<=e&&e<=53019||53021<=e&&e<=53047||53049<=e&&e<=53075||53077<=e&&e<=53103||53105<=e&&e<=53131||53133<=e&&e<=53159||53161<=e&&e<=53187||53189<=e&&e<=53215||53217<=e&&e<=53243||53245<=e&&e<=53271||53273<=e&&e<=53299||53301<=e&&e<=53327||53329<=e&&e<=53355||53357<=e&&e<=53383||53385<=e&&e<=53411||53413<=e&&e<=53439||53441<=e&&e<=53467||53469<=e&&e<=53495||53497<=e&&e<=53523||53525<=e&&e<=53551||53553<=e&&e<=53579||53581<=e&&e<=53607||53609<=e&&e<=53635||53637<=e&&e<=53663||53665<=e&&e<=53691||53693<=e&&e<=53719||53721<=e&&e<=53747||53749<=e&&e<=53775||53777<=e&&e<=53803||53805<=e&&e<=53831||53833<=e&&e<=53859||53861<=e&&e<=53887||53889<=e&&e<=53915||53917<=e&&e<=53943||53945<=e&&e<=53971||53973<=e&&e<=53999||54001<=e&&e<=54027||54029<=e&&e<=54055||54057<=e&&e<=54083||54085<=e&&e<=54111||54113<=e&&e<=54139||54141<=e&&e<=54167||54169<=e&&e<=54195||54197<=e&&e<=54223||54225<=e&&e<=54251||54253<=e&&e<=54279||54281<=e&&e<=54307||54309<=e&&e<=54335||54337<=e&&e<=54363||54365<=e&&e<=54391||54393<=e&&e<=54419||54421<=e&&e<=54447||54449<=e&&e<=54475||54477<=e&&e<=54503||54505<=e&&e<=54531||54533<=e&&e<=54559||54561<=e&&e<=54587||54589<=e&&e<=54615||54617<=e&&e<=54643||54645<=e&&e<=54671||54673<=e&&e<=54699||54701<=e&&e<=54727||54729<=e&&e<=54755||54757<=e&&e<=54783||54785<=e&&e<=54811||54813<=e&&e<=54839||54841<=e&&e<=54867||54869<=e&&e<=54895||54897<=e&&e<=54923||54925<=e&&e<=54951||54953<=e&&e<=54979||54981<=e&&e<=55007||55009<=e&&e<=55035||55037<=e&&e<=55063||55065<=e&&e<=55091||55093<=e&&e<=55119||55121<=e&&e<=55147||55149<=e&&e<=55175||55177<=e&&e<=55203}(e)?r.CombiningClass.LVT:function(e){return 4448<=e&&e<=4519||55216<=e&&e<=55238}(e)?r.CombiningClass.V:function(e){return 4520<=e&&e<=4607||55243<=e&&e<=55291}(e)?r.CombiningClass.T:function(e){return 44032===e||44060===e||44088===e||44116===e||44144===e||44172===e||44200===e||44228===e||44256===e||44284===e||44312===e||44340===e||44368===e||44396===e||44424===e||44452===e||44480===e||44508===e||44536===e||44564===e||44592===e||44620===e||44648===e||44676===e||44704===e||44732===e||44760===e||44788===e||44816===e||44844===e||44872===e||44900===e||44928===e||44956===e||44984===e||45012===e||45040===e||45068===e||45096===e||45124===e||45152===e||45180===e||45208===e||45236===e||45264===e||45292===e||45320===e||45348===e||45376===e||45404===e||45432===e||45460===e||45488===e||45516===e||45544===e||45572===e||45600===e||45628===e||45656===e||45684===e||45712===e||45740===e||45768===e||45796===e||45824===e||45852===e||45880===e||45908===e||45936===e||45964===e||45992===e||46020===e||46048===e||46076===e||46104===e||46132===e||46160===e||46188===e||46216===e||46244===e||46272===e||46300===e||46328===e||46356===e||46384===e||46412===e||46440===e||46468===e||46496===e||46524===e||46552===e||46580===e||46608===e||46636===e||46664===e||46692===e||46720===e||46748===e||46776===e||46804===e||46832===e||46860===e||46888===e||46916===e||46944===e||46972===e||47e3===e||47028===e||47056===e||47084===e||47112===e||47140===e||47168===e||47196===e||47224===e||47252===e||47280===e||47308===e||47336===e||47364===e||47392===e||47420===e||47448===e||47476===e||47504===e||47532===e||47560===e||47588===e||47616===e||47644===e||47672===e||47700===e||47728===e||47756===e||47784===e||47812===e||47840===e||47868===e||47896===e||47924===e||47952===e||47980===e||48008===e||48036===e||48064===e||48092===e||48120===e||48148===e||48176===e||48204===e||48232===e||48260===e||48288===e||48316===e||48344===e||48372===e||48400===e||48428===e||48456===e||48484===e||48512===e||48540===e||48568===e||48596===e||48624===e||48652===e||48680===e||48708===e||48736===e||48764===e||48792===e||48820===e||48848===e||48876===e||48904===e||48932===e||48960===e||48988===e||49016===e||49044===e||49072===e||49100===e||49128===e||49156===e||49184===e||49212===e||49240===e||49268===e||49296===e||49324===e||49352===e||49380===e||49408===e||49436===e||49464===e||49492===e||49520===e||49548===e||49576===e||49604===e||49632===e||49660===e||49688===e||49716===e||49744===e||49772===e||49800===e||49828===e||49856===e||49884===e||49912===e||49940===e||49968===e||49996===e||50024===e||50052===e||50080===e||50108===e||50136===e||50164===e||50192===e||50220===e||50248===e||50276===e||50304===e||50332===e||50360===e||50388===e||50416===e||50444===e||50472===e||50500===e||50528===e||50556===e||50584===e||50612===e||50640===e||50668===e||50696===e||50724===e||50752===e||50780===e||50808===e||50836===e||50864===e||50892===e||50920===e||50948===e||50976===e||51004===e||51032===e||51060===e||51088===e||51116===e||51144===e||51172===e||51200===e||51228===e||51256===e||51284===e||51312===e||51340===e||51368===e||51396===e||51424===e||51452===e||51480===e||51508===e||51536===e||51564===e||51592===e||51620===e||51648===e||51676===e||51704===e||51732===e||51760===e||51788===e||51816===e||51844===e||51872===e||51900===e||51928===e||51956===e||51984===e||52012===e||52040===e||52068===e||52096===e||52124===e||52152===e||52180===e||52208===e||52236===e||52264===e||52292===e||52320===e||52348===e||52376===e||52404===e||52432===e||52460===e||52488===e||52516===e||52544===e||52572===e||52600===e||52628===e||52656===e||52684===e||52712===e||52740===e||52768===e||52796===e||52824===e||52852===e||52880===e||52908===e||52936===e||52964===e||52992===e||53020===e||53048===e||53076===e||53104===e||53132===e||53160===e||53188===e||53216===e||53244===e||53272===e||53300===e||53328===e||53356===e||53384===e||53412===e||53440===e||53468===e||53496===e||53524===e||53552===e||53580===e||53608===e||53636===e||53664===e||53692===e||53720===e||53748===e||53776===e||53804===e||53832===e||53860===e||53888===e||53916===e||53944===e||53972===e||54e3===e||54028===e||54056===e||54084===e||54112===e||54140===e||54168===e||54196===e||54224===e||54252===e||54280===e||54308===e||54336===e||54364===e||54392===e||54420===e||54448===e||54476===e||54504===e||54532===e||54560===e||54588===e||54616===e||54644===e||54672===e||54700===e||54728===e||54756===e||54784===e||54812===e||54840===e||54868===e||54896===e||54924===e||54952===e||54980===e||55008===e||55036===e||55064===e||55092===e||55120===e||55148===e||55176===e}(e)?r.CombiningClass.LV:r.CombiningClass.Other}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reorderTextTokensUsingDom=void 0;var r=n(65),o=n(2);t.reorderTextTokensUsingDom=function(e,t,n,i){for(var l=(0,o.getReOrderDiv)(n,i),a=0;a<e.textLines.length;a++){var s=e.textLines[a],d=e.tokensPerLine[a],u=(0,r.analyzeBidiText)(s.text,t);if(n.HasBidi)if(u.HasRtl&&!u.HasLtr)d.tokens.reverse();else{(h=document.createElement("div")).setAttribute("textLineId",a.toString());for(var c=0;c<d.tokens.length;c++){var g=d.tokens[c].text;(v=document.createElement("span")).innerText=g,v.setAttribute("textTokenId",c.toString()),h.appendChild(v)}l.appendChild(h)}}document.body.appendChild(l);for(var f=0;f<l.children.length;f++){var h,C=(h=l.children[f]).getAttribute("textLineId");if(!C)throw Error("reorderTextTokensUsingDom: textLineIndexAttr is undefined");for(var m=parseInt(C,10),p=e.tokensPerLine[m].tokens,y=0;y<h.children.length;y++){var v,S=(v=h.children[y]).getAttribute("textTokenId");if(!S)throw Error("reorderTextTokensUsingDom: tokenIndexAttr is undefined");var R=v.getBoundingClientRect().left;p[c=parseInt(S,10)].OffsetX=R}p.sort((function(e,t){return e.OffsetX-t.OffsetX}))}document.body.removeChild(l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawWrapText=void 0;var r=n(2),o=n(35),i=n(1),l=n(9),a=n(41),s=n(31),d=n(86),u=n(169),c=n(85),g=n(3),f=n(7),h=n(70),C=n(15),m=n(47),p=n(14),y=n(71),v=n(87),S=n(89),R=n(13),F=n(117);function w(e,t,n,r,o,i,l,a){var s=a?e+t-n-r:e-n;return l&&(s=(0,m.getAdvancedVerticalAlignmentOffsetYForWrapText)(s,o,i)),s}function T(e,t,n,r){return e&&!t.HasRtl?0===n:n===r-1}t.drawWrapText=function(e,t,n,I,x,b,D,A,P,H,B,M,O){var k,L,N,E=(0,p.shouldRenderVerticalText)(I),z=(0,h.getBreakType)(I),W=E?(0,r.getTextDrawingMaxHeight)(H,(0,F.getVerticalTextPadding)((null===(k=I.CachedStyle)||void 0===k?void 0:k.Indentation)||0)):H;if(!(W<=0||D<=0)){var G=E?W:D,V=(0,h.computeMaxTextWidthForWrapText)(I,z,G,n,t),j=E?M:e.measureText(g.Whitespace).width,_=I.WrapText,U=(0,d.breakTextToLines)(e,x,V,z,j,n,I,O,_),q=(0,l.getBidiContext)(I);E&&(0,h.adjustOrderingOfLinesForVerticalText)(I,U,q);var Y=U.textLines,X=function(e,t,n,r){var o=[],i=[],a=[];i=[0],a=[0];var d=0;if(n)for(var u=0;u<t.length;u++){var c=t.length-1-u,g=t[c],f=(0,s.substringFormattedText)(n,g.startIndex,g.endIndex);o[u]=f;var h=(0,l.getFormattedTextLineFontMetrics)(e,f);a[u]=h.baseline;var C=(0,l.getFormattedTextLineHeight)(e,f);i[u+1]=i[u]+C,d+=C}else i=function(e,t){for(var n=[],r=0;r<e;r++)n.push(r*t);return n}(t.length,r),d=r*t.length;return{rowsBottomY:i,rowsAlphabeticY:a,textHeight:d,formattedLines:o}}(n,Y,O,M),J=X.rowsBottomY,K=X.rowsAlphabeticY,Z=X.textHeight,Q=X.formattedLines,$=!(0,f.isNullOrUndefined)(I.PhonInfo),ee=U.requireClipping||B||$||function(e,t,n,r){return e&&t<n*r}(E,P,M,Y.length),te=void 0;ee&&(te=A);var ne=e.textAlign,re=e.textBaseline,oe=!1;(0,C.isHorizontalAlignmentJustifiedAndDistributed)(I)&&!E&&(e.textAlign="left",e.textBaseline="alphabetic",oe=!0,q.HasRtl&&(0,c.reorderTextTokens)(U,(null===(L=I.CachedStyle)||void 0===L?void 0:L.ReadingOrder)||i.ReadingOrderType.Context,q,V));var ie=$?y.PhoneticTextHeightPx:0,le=E?I.CachedStyle.VerticalAlignment:(0,m.getEffectiveVerticalAlignment)(I.CachedStyle.VerticalAlignment,m.AdvVerticalAlignmentFormat.WrapText,H,Z,M,Y.length,I.DisplayFormula),ae=E?(0,p.isVerticalAlignmentJustifiedOrDistributedForVerticalText)(I):(0,m.isVerticalAlignmentJustifyOrDistributed)(le),se=ae&&Y.length>1&&!E?(0,m.getAdvancedVerticalAlignmentLineGapHeightForWraptext)(H,Z,Y.length):0;!function(e,t){t&&(0,r.applyClipping)(e,t)}(e,te);var de=K[0],ue=(0,l.getTextVerticalPosition)(I,n,Z+ie,H,le,de),ce=ue.absoluteY,ge=E?(0,h.getOffsetXForVerticalText)(n,I,t,b,M,Y.length):b,fe=0;(0,p.isHorizontalAlignmentJustifiedOrDistributedForVerticalText)(I)&&(fe=(0,h.getSpaceWidthBetweenLines)(n,I,ge,Y.length,M));for(var he=function(e,t,n,r,o){if(e)return(0,l.getTextVerticalPosition)(t,n,r,o,t.CachedStyle.VerticalAlignment,void 0).absoluteY;return 0}(E,I,n,M,H),Ce=0;Ce<Y.length;Ce++){var me=Y.length-1-Ce,pe=Y[me],ye=pe.text;E&&Ce>0&&(ge+=M+fe);var ve=E?he:w(ce,de,J[Ce],K[Ce],se,Ce,ae,!(0,f.isNullOrUndefined)(O));if(z===o.BreakType.Wrap)(0,h.drawTextLine)(e,t,n,I,ee,ye,ge,ve,D,Q[Ce],A),O||E||(0,a.cacheTextDecorationLayout)(n,I,t,{textPositionX:ge,textPositionY:ve,textWidth:pe.underlineWidth,clipRect:A},I.CachedFont);else{var Se={breakType:z,singleSpaceWidth:j,maxWidth:V,isProcessingLastLine:T(E,q,me,Y.length),isCompleteTextVisible:Z<H,lineDirection:E?o.LineDirection.Vertical:o.LineDirection.Horizontal};(0,u.drawJustifyOrDistributedTextLine)(e,t,n,I,U,me,ge,Se,ee,ve,V,Q[Ce],A,ye,ve,!(0,f.isNullOrUndefined)(O))}}try{if($){(0,v.updateContextForPhonetic)(e,n,t.highContrastScheme);ve=(0,S.getPhoneticVerticalPosition)(n,I,ce,ue.lastTextLineAlphabeticBaselineOffset,Z);(0,v.drawPhoneticText)(e,n,I,ve,t),(null===(N=I.PhonInfo)||void 0===N?void 0:N.Text)!==g.EmptyString&&(0,R.setRenderingResultMonitorable)("drawWrapText: PhoneticRendered")}}catch(e){throw(0,R.setRenderingResultMonitorable)("drawWrapText: Error in drawing phonetic: "+e),e}oe&&(e.textAlign=ne,e.textBaseline=re),function(e,t){(0,r.restoreClipping)(e,t)}(e,te)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeTextToWrap=t.BreakOpTokenType=void 0;var r,o=n(3),i=n(1),l=n(31),a=n(9);!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(r||(t.BreakOpTokenType=r={}));var s="1".charCodeAt(0);function d(e,t,n,r,o,s,d,u){return d?r?(0,a.measureTextRunsHeightForVerticalText)(e,r.TextRuns,r.Text,t,s,o).totalSize:(0,a.measureTextHeightForVerticalText)(u,n):r?(0,l.measureFormattedTextWidth)(e,r,t):function(e,t,n,r,o){if(o)return r*n.length;if((0,i.isRenderFlagEnabled)(i.RenderFlagsArray.TextWidthClientPhase1,t))return(0,a.measureTextWidth)(e,n,!1,!0);return e.measureText(n).width}(e,t,n,o,s)}function u(e){switch(e){case o.FullWidthSpace:case o.Whitespace:return r.Space;case o.HardBreak:return r.HardBreak;case o.HardBreakCRLF:return r.HardBreakCRLF}return r.Word}function c(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?o.HardBreakCRLF:e[t]}function g(e,t){return t===r.HardBreakCRLF?e+2:e+1}function f(e,t,n){return!(!t||n!==r.Word||e>t.length-1)&&t.charCodeAt(e)===s}t.tokenizeTextToWrap=function(e,t,n,o,i,a,s,h){for(var C=[],m=0,p=n,y=null==h?void 0:h.BreakOp;m<t.length;){for(var v=u(c(t,m)),S=g(m,v),R=c(t,S),F=u(R);S<t.length&&v===F&&!f(S,y,v);)F=u(R=c(t,S=g(S,v)));var w=S-m,T=t.substring(m,S),I=s?(0,l.substringFormattedText)(s,m,S):void 0,x=0;switch(v){case r.Word:case r.Space:x=d(e,o,T,I,p,v===r.Space,i,a);break;case r.HardBreak:case r.HardBreakCRLF:break;default:throw"breakToTextLines - textTokenizer - unexpected run type"}C.push({start:m,len:w,value:T,type:v,width:x}),m=S}return C}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakWideWordVerticalText=t.breakWideWord=void 0;var r=n(0),o=n(31),i=n(68),l=function(){function e(e,t,n,r,o){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=n,this.wordFormattedText=o,this.model=r}return Object.defineProperty(e.prototype,"width",{get:function(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=(0,o.measureFormattedTextWidth)(this.ctx,this.formattedValue,this.model)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this.wordFormattedText&&(this.cachedFormattedValue=(0,o.substringFormattedText)(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue},enumerable:!1,configurable:!0}),e}(),a=function(){function e(e,t,n,r){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=r,this.model=n}return e.prototype.item=function(e){var t=this.cachedItems[e];return t||(t=new l(this.ctx,this.word,e+1,this.model,this.formattedText),this.cachedItems[e]=t),t},e}();function s(e,t,n,i,l){if(0!==t.length){var s=new a(e,t,i,l),d={width:n,value:"IGNORED"},u=(0,r.binarySearch)(s,0,t.length,d,(function(e,t){return e.width-t.width}));u<0&&0!==(u=~u)&&(u-=1);var c=s.item(u);return{width:c.width,value:c.value,remaining:t.substring(c.value.length),formattedRemaining:l?(0,o.substringFormattedText)(l,c.value.length):void 0}}}t.breakWideWord=function(e,t,n,r,o){for(var i=[],l=s(e,t,n,r,o);l;)i.push({value:l.value,size:l.width}),l=s(e,l.remaining,n,r,l.formattedRemaining);return i},t.breakWideWordVerticalText=function(e,t,n){for(var r=[],o=(0,i.breakToGraphemes)(e),l=n,a=o[0],s=1;s<o.length;s++)l+n>t?(r.push({value:a,size:l}),l=n,a=o[s]):(l+=n,a+=o[s]);return a&&l>0&&r.push({value:a,size:l}),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawJustifyOrDistributedTextLine=void 0;var r=n(35),o=n(15),i=n(70),l=n(85),a=n(41);function s(e,t,n,o,i){var l=n,a=o;return e.lineDirection===r.LineDirection.Horizontal?l=i+t.Offset:e.lineDirection===r.LineDirection.Vertical&&(a=i-t.Offset),{textPortionOffsetX:l,textPortionOffsetY:a}}t.drawJustifyOrDistributedTextLine=function(e,t,n,d,u,c,g,f,h,C,m,p,y,v,S,R){var F=u.tokensPerLine[c].tokens,w=f.lineDirection===r.LineDirection.Horizontal?(0,o.adjustXForHorizontalAlignment)(n,d,g,m):C;if(p)(0,i.drawTextLine)(e,t,n,d,h,v,g,C,m,p,y,F,f);else{var T=(0,l.getStartOffset)(f,F),I=(0,l.getJustifyDistributedLine)(f,F,(0,l.getSpaceWidthBetweenWords)(F,f),T);if(I){var x=s(f,I.Start,g,C,w),b=x.textPortionOffsetX,D=x.textPortionOffsetY;if((0,i.drawTextLine)(e,t,n,d,h,I.Start.Text,b,D,m,p,y),I.Middle){var A=s(f,I.Middle,g,C,w),P=A.textPortionOffsetX,H=A.textPortionOffsetY;(0,i.drawTextLine)(e,t,n,d,h,I.Middle.Text,P,H,m,p,y)}if(I.End){var B=s(f,I.End,g,C,w),M=B.textPortionOffsetX,O=B.textPortionOffsetY;(0,i.drawTextLine)(e,t,n,d,h,I.End.Text,M,O,m,p,y)}if(!R&&f.lineDirection!==r.LineDirection.Vertical){var k=u.textLines[c],L=function(e,t,n,o,i){switch(e){case r.BreakType.Justify:return o?t.underlineWidth:n;case r.BreakType.Distributed:return o&&1===i?t.underlineWidth:n;case r.BreakType.Wrap:default:return t.underlineWidth}}(f.breakType,k,f.maxWidth,f.isProcessingLastLine,F.length);(0,a.cacheTextDecorationLayout)(n,d,t,{textPositionX:f.lineDirection===r.LineDirection.Horizontal?w+T:g,textPositionY:S,textWidth:L,clipRect:y},d.CachedFont)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updatePreviewTextFormatting=t.updateNumberFormattingInformation=void 0;var r=n(1),o=n(0),i=n(5),l=n(9),a=n(7),s=n(10),d=n(45),u=n(14),c=n(13),g=n(84),f=n(12),h=n(18),C=n(2),m=n(6),p=n(21),y=n(90);function v(e,t,n,r){var o=(0,l.getNumFmtHashWidth)(e,r,t);o<0&&(0,c.setRenderingResultInfo)("buildNumFmtHashesString:: Invalid hashWidth. hashWidth: "+o+" MeasuredWidth: "+(0,s.getFontNameForLogging)(t.CachedFont.FontName)+", FontSize:"+t.CachedFont.Size);var i=F(e,r,t,n,o,!0),a="";return a+="#".repeat(i)}function S(e,t,n,r,o,i){var l=r.Start||"";try{l+=r.Separator.repeat(o),l+=r.End||""}catch(o){return(0,c.setRenderingResultInfo)("buildNumFmtText:: Invalid separatorCount."+R(e,t,n,r,i)),r.Start||""+r.End||""}return l}function R(e,t,n,o,i){var l,a=(0,d.isFontValid)(null===(l=n.CachedFont)||void 0===l?void 0:l.FontName),u=!!a&&(0,d.documentFontsCheck)((0,s.getFontCssStringFromCell)(n,t));return(0,r.annonymize)(o.Separator)+" CachedWidth: "+i+" MeasuredWidth: "+e.measureText(o.Separator).width+", IsSpace: "+(" "===o.Separator)+", FontName:"+(0,s.getFontNameForLogging)(n.CachedFont.FontName)+", FontSize:"+n.CachedFont.Size+", Length: "+o.Separator.length+", MLetterWidth: "+e.measureText("M").width+", IsDocumentAttached: "+function(e){try{return e instanceof CanvasRenderingContext2D?document.contains(e.canvas):"Offscreen"}catch(e){return!1}}(e)+", isFontValid: "+a+", FontLoadCheck: "+u}function F(e,t,n,r,o,i){var s=0;if(n.CachedFont.Italic&&i){var d=(0,l.getOverhangHashWidth)(e,t,n);s=Math.max(Math.floor((r-d)/o),0)}else s=Math.max(Math.floor(r/o),0);return((0,a.isNullOrUndefined)(s)||isNaN(s)||s===1/0)&&((0,c.setRenderingResultInfo)("calculateSeparatorCountInMaxWidth: Invalid count variable. hashCount: ".concat(s,", cellWidth: ").concat(r,", hashWidth: ").concat(o," ")),s=0),s}t.updateNumberFormattingInformation=function(e,t,n,w,T,I){var x,b,D,A;(0,i.verifyArgumentNotNull)(n,"cell","updateNumberFormattingInformation"),(0,i.verifyArgumentNotNull)(n.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),(0,i.verifyArgumentNotNull)(t,"model","updateNumberFormattingInformation");var P=(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextWidthClientPhase1,t);if(!((0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextWidthClientPhase1,t)&&n.TolType!==r.TolType.Autofit&&n.ValueType!==r.CellValueType.Error&&n.ValueType!==r.CellValueType.Boolean||(0,u.shouldRenderVerticalText)(n))){var H=!(0,g.isTestRun)();if((0,a.isNullOrUndefined)(n.NumFmt)||(0,a.isNullOrUndefined)(n.NumFmt.Separator)||""===n.NumFmt.Separator){var B=Math.round((0,l.getTextWidth)(e,t,n));if((0,p.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)&&(0,r.isChangeGateEnabled)(r.ChangeGate.FixRotatedTextWidth)){var M=(0,l.getTextLineHeight)(n,t);B=(0,y.getRotatedTextWidth)(t,B,M,n.CachedStyle)}if(B>w&&!(0,s.cellHasShrinkToFit)(n))n.CachedIndent=0,(L=v(e,n,(null===(A=n.CachedStyle)||void 0===A?void 0:A.Indentation)?function(e,t,n,r){var o,i=(0,m.getCellWidth)(e,t,!1),a=(0,l.getDistanceFromCellStartToIconEnd)(e,t,n,r);return(0,C.getTextDrawingMaxWidth)(i,(0,l.getCellTextHorizontalPaddingWithoutVisualElements)(e,t),a,(0,f.getExpandCollapseButtonWidth)(null===(o=t.PivotTable)||void 0===o?void 0:o.HasExpandCollapseIndicator),(0,h.getAutoFilterPaddingForAdvancedHorizontalAlignment)(e,t,n,r))}(t,n,T,I):w,t))!==n.CachedDisplayText&&(n.CachedIsTextWidthExceedsCellWidth=!0,(0,o.setCellCachedDisplayText)(n,L),(0,l.cacheLegacyTextWidthOnCell)(e,t,n))}else{var O=(0,l.measureTextWidth)(e,null===(x=n.NumFmt)||void 0===x?void 0:x.Start,H,P),k=(0,l.measureTextWidth)(e,null===(b=n.NumFmt)||void 0===b?void 0:b.End,H,P);if(O+k>w&&!(0,s.cellHasShrinkToFit)(n)){var L=v(e,n,w,t);(0,o.setCellCachedDisplayText)(n,L),(0,l.cacheLegacyTextWidthOnCell)(e,t,n)}else{var N=(0,l.getNumFmtSeparatorWidth)(e,t,n,n.NumFmt);if(!(0,d.fontFaceSetSupported)())return;var E=(0,d.isValidCellFontLoaded)(t,n);if(0===N&&!E)return;if(0===N)return void(0,c.setRenderingResultInfo)("updateNumberFormattingInformation:: Invalid SeparatorWidth."+R(e,t,n,n.NumFmt,N));var z=F(e,t,n,w-O-k,N,"#"===(null===(D=n.NumFmt)||void 0===D?void 0:D.Separator)),L=S(e,t,n,n.NumFmt,z,N);(0,o.setCellCachedDisplayText)(n,L)}}}},t.updatePreviewTextFormatting=function(e,t,n,o){var s;if((0,i.verifyArgumentNotNull)(n,"cell","updatePreviewTextFormatting"),(0,i.verifyArgumentNotNull)(n.CachedFont,"cell.CachedFont","updatePreviewTextFormatting"),(0,i.verifyArgumentNotNull)(t,"model","updatePreviewTextFormatting"),!(0,a.isNullOrUndefined)(n.PreviewNumFmt)&&!(0,a.isNullOrUndefined)(n.PreviewNumFmt.Separator)&&""!==n.PreviewNumFmt.Separator){var u=!(0,g.isTestRun)(),f=(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextWidthClientPhase1,t),h=(0,l.measureTextWidth)(e,n.PreviewNumFmt.Start,u,f),C=(0,l.measureTextWidth)(e,n.PreviewNumFmt.End,u,f),m=(0,l.getNumFmtSeparatorWidth)(e,t,n,n.PreviewNumFmt);if(0!==m){var p=F(e,t,n,o-h-C,m,"#"===(null===(s=n.PreviewNumFmt)||void 0===s?void 0:s.Separator));n.PreviewText=S(e,t,n,n.PreviewNumFmt,p,m)}else{if(!(0,d.isValidCellFontLoaded)(t,n))return;(0,c.setRenderingResultInfo)("updatePreviewTextFormatting:: Invalid SeparatorWidth."+R(e,t,n,n.PreviewNumFmt,m))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCachedDisplayTextForFill=void 0;var r=n(1),o=n(2),i=n(0),l=n(9),a=n(6),s=n(13),d=n(12),u=n(18);t.updateCachedDisplayTextForFill=function(e,t,n,c){var g=n.Text;if(g){var f=function(e,t,n){var r=n.zoom,i=n.devicePixelRatio,s=t.Spill?(0,a.getSpillCellWidth)(t,e):(0,a.getCellWidth)(e,t,!1);return(0,o.getTextDrawingMaxWidth)(s,(0,l.getCellTextHorizontalPadding)(t,e,r,i),(0,l.getDistanceFromCellStartToIconEnd)(e,t,r,i),(0,d.getExpandCollapseButtonPadding)(t),(0,u.getAutoFilterPaddingForAdvancedHorizontalAlignment)(e,t,r,i))}(t,n,c),h=(0,l.measureTextWidth)(e,g,!1,(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.TextWidthClientPhase1,t)),C=Math.floor(f/h);C<1&&(C=1),(void 0===C||isNaN(C)||C===1/0)&&((0,s.setRenderingResultInfo)("updateCachedDisplayTextForFill: Invalid count variable. repeatCount: ".concat(C,", maxTextWidth: ").concat(f,", textWidth: ").concat(h," ")),C=1);var m=g.repeat(C);(0,i.setCellCachedDisplayText)(n,m)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHyperlinkEventHandlers=void 0;var r=n(1),o=n(17),i=n(0),l=n(10),a=n(11),s=n(22),d=n(6),u=n(9),c=n(7),g=n(47),f=n(15),h=n(3),C=n(2),m=n(23),p=n(59),y=n(24),v=n(119),S=!1,R=!1,F=void 0;function w(e,t){return!(0,c.isNullOrUndefined)(e.Hyperlink)&&!!(0,C.cellIntersectsRenderingRegion)(e,t.renderingRegion)}function T(e,t,n,o){!function(e,t,n,o){var l=(0,m.getUnadjustedHitRegionFromRect)(e,n,o,!1),d=(0,r.getRenderingRegionHitTestCache)(e,(0,i.getRenderingRegionKey)(n.renderingRegion)),u=function(){return!(0,a.inRangePicker)()},g=function(e){var t=!!e.metaKey&&e.metaKey,n=!!e.ctrlKey&&e.ctrlKey;return(0,i.isMac)()?t:n};x()?((0,s.registerMouseEnterHitRegion)(t,d,l,r.RenderFeaturesZIndex.Hyperlink,(function(n){return u()&&x()&&a.showOrHideHyperlinkFloatie&&(0,a.showOrHideHyperlinkFloatie)(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col],!0,n.clientX),!1})),(0,s.registerMouseLeaveHitRegion)(t,d,l,r.RenderFeaturesZIndex.Hyperlink,(function(n){return x()&&a.showOrHideHyperlinkFloatie&&(0,a.showOrHideHyperlinkFloatie)(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col],!1,n.clientX),!1})),(0,s.registerCursorHitRegion)(t,d,l,"pointer",r.RenderFeaturesZIndex.Hyperlink,g)):((0,s.registerCursorHitRegion)(t,d,l,"pointer",r.RenderFeaturesZIndex.Hyperlink,u),(0,s.registerTooltipHitRegion)(t,d,l,function(e){var t,n,r;if(null===(t=e.Hyperlink)||void 0===t?void 0:t.Tooltip)return null===(n=e.Hyperlink)||void 0===n?void 0:n.Tooltip;if(p.gridRendererStrings.hyperlinkToolTip)return(0,c.stringFormat)(p.gridRendererStrings.hyperlinkToolTip,null===(r=e.Hyperlink)||void 0===r?void 0:r.Text);return h.EmptyString}(t),r.RenderFeaturesZIndex.Hyperlink));(0,s.registerHitRegion)(t,d,l,r.RenderFeaturesZIndex.Hyperlink,(function(n){var r,o,i;if(u()&&!S)if(x()&&g(n)||!x())if(null===(r=t.Hyperlink)||void 0===r?void 0:r.IsValidHyperlink){if(null===(o=t.Hyperlink)||void 0===o?void 0:o.IsHyperlinkExternal)(0,a.followHyperlink)(n,null===(i=t.Hyperlink)||void 0===i?void 0:i.Text);else if(t.Hyperlink.InternalLink){var l=t.Hyperlink.InternalLink;(0,a.handleGoTo)(n,l.ObjectName,l.SheetName,l.FirstRow,l.FirstColumn,l.LastRow,l.LastColumn)}}else(0,a.invalidHyperlinkCallback)();else x()&&(0,a.showCtrlClickHyperlinkCallout)(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col]);return x()?(S=!0,setTimeout((function(){S=!1}),500)):S=!1,!1}),"click"),(0,s.registerLongPressHitRegion)(t,d,l,r.RenderFeaturesZIndex.Hyperlink,(function(){R=!0}),(function(){R&&(S=!0),R=!1})),(0,s.registerHitRegion)(t,d,l,r.RenderFeaturesZIndex.Hyperlink,y.EmptyFalseCallback,"touchend")}(t,n,o,function(e,t,n,o){var i=function(e,t,n,o){var i;if(I(n)||!x()&&n.Spill)return{leftX:(0,d.getCellLeftAdjustedForDrawing)(t,n,!1,!1),width:(0,d.getCellWidthAdjustedForDrawing)(t,n)};var l=(0,u.getTextWidth)(e,t,n),a=function(e,t,n,o){var i,l=(0,u.getTextHorizontalPosition)(e,t,n),a=(null===(i=t.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)||r.HorizontalAlignment.Automatic;switch(a){case r.HorizontalAlignment.Right:return l-o;case r.HorizontalAlignment.Center:return l-o/2;case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:return l;default:throw Error("getHyperlinkBoundsOnTextRectLeftX: unsupported horizontalAlignment for hyperlinks on text rect: ".concat(a))}}(t,n,o,l),s=l*o.scaleFactor,c=a*o.scaleFactor;if(!x()&&!n.Spill)return{leftX:Math.max((0,d.getCellLeftAdjustedForDrawing)(t,n,!1,!1),c),width:Math.min((0,d.getCellWidthAdjustedForDrawing)(t,n),s)};if(null===(i=n.Spill)||void 0===i?void 0:i.IsSpillBlocked){var g=t.IsRtl?(0,d.getSpillCellEndCol)(n,t):(0,d.getSpillCellStartCol)(n),f=t.IsRtl?(0,d.getSpillCellStartCol)(n):(0,d.getSpillCellEndCol)(n,t),h=t.IsRtl?(0,v.getColumnRightOffset)(t,g):(0,v.getColumnLeftOffset)(t,g),C=t.IsRtl?(0,v.getColumnLeftOffset)(t,f):(0,v.getColumnRightOffset)(t,f);if(h&&C){var m=Math.max(h,c),p=Math.min(C,c+s);return{leftX:m,width:p-m}}}return{leftX:c,width:s}}(e,t,n,o),l=i.leftX,a=i.width,s=function(e,t,n){var o;if(I(t)){var i=(0,d.getCellHeightAdjustedForDrawing)(e,t);return{topY:(0,d.getCellTopAdjustedForDrawing)(e,t,!1),height:i}}var l=(0,u.getTextLineHeight)(t,e)*n.scaleFactor,a=function(e,t,n){var o,i=null===(o=t.CachedStyle)||void 0===o?void 0:o.VerticalAlignment;switch(i){case r.VerticalAlignment.Bottom:return(0,d.getCellBottomAdjustedForDrawing)(e,t)-n-h.GridLineWidthPx;case r.VerticalAlignment.Center:return(0,d.getCellCenterYAdjustedForDrawing)(e,t)-n/2;case r.VerticalAlignment.Top:return(0,d.getCellTopAdjustedForDrawing)(e,t,!1);default:throw Error("getHyperlinkBoundsOnTextRectTopY: unsupported verticalAlignment: ".concat(i))}}(e,t,l),s=l,c=null===(o=t.CachedDrawingLayout)||void 0===o?void 0:o.UnderlineRuns;c&&c.length>0&&(s=c[0].Y+c[0].LineWidth-a);return{topY:Math.max(a,(0,d.getCellTopAdjustedForDrawing)(e,t,!1)),height:Math.min(s,(0,d.getCellHeightAdjustedForDrawing)(e,t))}}(t,n,o),c=s.topY,g=s.height;return{x:l,y:c,width:a,height:g}}(e,t,n,o))}function I(e){var t,n=e.CachedStyle;if((0,c.isNullOrUndefined)(n))throw Error("shouldHyperlinkEventsBeRegisteredOnFullCell: cell.CachedStyle is null");return!!(e.WrapText||n.ShrinkToFit||n.Indentation||n.VerticalText||(0,g.isVerticalAlignmentJustifyOrDistributed)(n.VerticalAlignment)||(0,f.isHorizontalAlignmentAdvance)(n.HorizontalAlignment)||e.ValueType===r.CellValueType.Number||e.TextRuns||(null===(t=e.LinkedEntity)||void 0===t?void 0:t.IconWidth)||e.RichValueIcon||e.HasIgnorableError||(0,c.isNullOrUndefined)(e.Text))}function x(){return void 0===F&&(F=(0,o.getBooleanFeatureGate)("Microsoft.Office.Excel.HyperlinkImprovementSlice1",!1)),F}t.registerHyperlinkEventHandlers=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","registerHyperlinkEventHandlers"),(0,r.verifyArgumentNotNull)(t,"model","registerHyperlinkEventHandlers"),(0,r.verifyArgumentNotNull)(n,"context","registerHyperlinkEventHandlers");for(var o=t.ClientOnlyCache.CellsToRender,i="",a=0;a<o.length;a++){var s=o[a];if(w(s,n)){var d=(0,l.getFontCssStringFromCell)(s,t);i!==d&&(i=d,e.font=d),T(e,t,s,n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRotatedText=void 0;var r=n(10),o=n(5),i=n(9),l=n(2),a=n(64),s=n(21),d=n(6),u=n(31),c=n(88),g=n(86),f=n(35),h=n(3),C=n(70),m=n(41),p=n(7),y=n(13),v=n(87);function S(e,t,n,r,o,l,a,u){var c,g=(0,s.getEffectiveHorizontalAlignmentForRotatedText)(null===(c=t.CachedStyle)||void 0===c?void 0:c.HorizontalAlignment,e.IsRtl),f=(0,i.getCellAdornmentPadding)(e,t,a,u),h=(0,s.getUnderlinePadding)(t.CachedFont,l),C=(0,d.getCellLeft)(e,t,e.BlockWidth),m=(0,d.getCellRight)(e,t,e.BlockWidth);return(0,s.getRotatedTextHorizontalPosition)(g,C,m,o,f,h,r,l,n)}function R(e,t,n,r,i){(0,o.verifyArgumentNotNull)(e.CachedDrawingLayout,"CachedDrawingLayout","cacheOrientationLayout");var l={TranslateX:t,TranslateY:n,Angle:r,clipRect:i};e.CachedDrawingLayout.TextOrientationLayout=l}t.drawRotatedText=function(e,t,n,o,F,w,T,I,x,b,D){var A,P=(0,s.degreeToRadians)((0,s.getOrientationInCanvas)(t.IsRtl,null===(A=n.CachedStyle)||void 0===A?void 0:A.Orientation)),H=b?(0,i.getLargestFont)(t,b.TextRuns):n.CachedFont,B=(0,r.getActualFontSizeFromFont)(t,n,H,!0);(0,c.shouldDrawWrapText)(n)?function(e,t,n,o,c,F,w,T,I,x,b,D,A){var P,H=o.zoom,B=o.devicePixelRatio,M=(0,s.getRotatedTextVerticalPadding)(n,F),O=I-h.GridLineWidthPx-h.RotatedTextPaddingMultiplier*M,k=O/T,L=Math.atan(k),N=0;N=Math.abs(w)>=L?Math.round(O/Math.abs(Math.sin(w))):Math.round(T/Math.abs(Math.cos(w)));if(N<=0)return;var E=(0,i.measureTextWidth)(e,h.Whitespace,!1,!0),z=n.WrapText,W=(0,g.breakTextToLines)(e,c,N,f.BreakType.Wrap,E,t,n,D,z).textLines,G=function(e,t,n,o,l,s){var d=[],c=[],g=[],f=0;if(s){for(var h=0;h<n.length;h++){var C=n[h],m=(0,u.substringFormattedText)(s,C.startIndex,C.endIndex);d[h]=m;var p=(0,i.getFormattedTextLineFontMetrics)(e,m);g[h]=p.baseline,f=(0,i.getFormattedTextLineHeight)(e,m),c[h]=f+l}return{textLinesHeight:c,linesAlphabeticOffset:g,formattedLines:d}}var y=t.CachedFont,v=(0,r.getActualFontSize)(e,t),S=(0,a.getCachedFontMetrics)(y.FontName,v,e).baseline;for(h=0;h<n.length;h++)c.push(o+l),g.push(S);return{textLinesHeight:c,linesAlphabeticOffset:g,formattedLines:d}}(t,n,W,x,b,D),V=G.textLinesHeight,j=G.linesAlphabeticOffset,_=G.formattedLines,U=function(e,t,n,r,o,i,l,a,d){var u=(0,s.getRotatedWrapTextWidth)(n,r,l),c=r[0]-o[0];return S(e,t,i,u,c,l,a,d)}(t,n,W,V,j,T,w,H,B),q=function(e,t,n,r,o,i,l,a,u){var c=(0,s.getIndexOfMaxLineWidth)(n),g=(0,s.getRotatedTextBoxHeight)(n[c].width,r[c],l),f=(0,d.getCellTop)(e,t),h=(0,d.getCellBottom)(e,t);return(0,s.getRotatedTextVerticalPosition)(t.CachedStyle.VerticalAlignment,a,u,g,i,f,h)-o[c]*Math.abs(Math.cos(l))}(t,n,W,V,j,I,w,M,(0,i.isCellBottomPaddingRequired)(t,n)),Y=e.textAlign,X=e.textBaseline;(0,l.applyClipping)(e,A),(0,s.applyRotation)(e,U,q,w),R(n,U,q,w,A);for(var J=0,K=0,Z=Math.abs(Math.cos(w))/Math.abs(Math.sin(w)),Q=0;Q<W.length;Q++)Q>0&&(K=K+j[Q-1]+V[Q]-j[Q],J=K*Z*(w<0?1:-1)),(0,C.drawTextLine)(e,o,t,n,!0,W[Q].text,J,K,T,_[Q],A),D||(0,m.cacheTextDecorationLayout)(t,n,o,{textPositionX:J,textPositionY:K,textWidth:W[Q].underlineWidth,clipRect:A},n.CachedFont);var $=!(0,p.isNullOrUndefined)(n.PhonInfo);try{if($&&W.length>0){(0,v.updateContextForPhonetic)(e,t,o.highContrastScheme);var ee=-(V[0]-b-j[0]);e.textAlign="left",(0,v.drawPhoneticText)(e,t,n,ee,o,W[0].width),(null===(P=n.PhonInfo)||void 0===P?void 0:P.Text)!==h.EmptyString&&(0,y.setRenderingResultMonitorable)("drawWrapText: RotatedPhoneticRendered")}}catch(e){throw(0,y.setRenderingResultMonitorable)("drawWrapText: Error in drawing rotated phonetic: "+e),e}e.restore(),e.textAlign=Y,e.textBaseline=X,(0,l.restoreClipping)(e,A)}(e,t,n,o,F,B,P,w,T,I,x,b,D):function(e,t,n,r,o,c,g,f,h,C,p,y){var v,F=r.zoom,w=r.devicePixelRatio,T=(0,i.getTextWidth)(e,t,n),I=(0,a.getCachedFontMetrics)(null===(v=n.CachedFont)||void 0===v?void 0:v.FontName,c,t).baseline,x=function(e,t,n,r,o,i,l,a,d){var u=(0,s.getRotatedTextBoxWidth)(n,o,l);return S(e,t,r,u,o-i,l,a,d)}(t,n,T,f,C,I,g,F,w),b=function(e,t,n,r,o,i,l,a,u){var c,g=(0,s.getRotatedTextVerticalPadding)(t,r),f=(0,s.getRotatedTextBoxHeight)(o,i,a),h=(0,d.getCellTop)(e,t),C=(0,d.getCellBottom)(e,t);return(0,s.getRotatedTextVerticalPosition)(null===(c=t.CachedStyle)||void 0===c?void 0:c.VerticalAlignment,g,u,f,n,h,C)-l*Math.abs(Math.cos(a))}(t,n,h,c,T,C,I,g,(0,i.isCellBottomPaddingRequired)(t,n));(0,l.applyClipping)(e,y),(0,s.applyRotation)(e,x,b,g),R(n,x,b,g,y),p&&!n.DisplayFormula?(0,u.fillRichTextFormat)(e,r,t,n,p,0,0,y):(e.fillText(o,0,0),(0,m.cacheTextDecorationLayout)(t,n,r,{textPositionX:0,textPositionY:0,textWidth:T,clipRect:y},n.CachedFont));e.restore(),(0,l.restoreClipping)(e,y)}(e,t,n,o,F,B,P,w,T,I+x,b,D)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckboxDefaultFontSize=t.CheckboxTrueFallbackFont=t.CheckboxFalseFallbackFont=t.CheckboxTrueYellowFont=t.CheckboxFalseYellowFont=t.BlankCheckboxOpacity=t.CheckboxOpacity=t.AdjustedCheckboxIconTopOffset=void 0,t.AdjustedCheckboxIconTopOffset=2,t.CheckboxOpacity=1,t.BlankCheckboxOpacity=.6,t.CheckboxFalseYellowFont=57944,t.CheckboxTrueYellowFont=57945,t.CheckboxFalseFallbackFont=9744,t.CheckboxTrueFallbackFont=9745,t.CheckboxDefaultFontSize=16},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillCellWithGradientBackground=void 0;var r=n(1),o=n(5);function i(e,t,n,i){(0,o.verifyArgumentNotNull)(n,"cell.CachedStyle.Gradient.Stops","createGradientFill");for(var l=function(e,t){var n=t.x,o=t.y,i=t.width,l=t.height;switch(e){case r.GradientShadingStyle.Vertical:case r.GradientShadingStyle.Center:case r.GradientShadingStyle.TopRightCorner:return{x0:n,y0:0,x1:n+i,y1:0};case r.GradientShadingStyle.ReversedVertical:case r.GradientShadingStyle.TopLeftCorner:return{x0:n+i,y0:0,x1:n,y1:0};case r.GradientShadingStyle.Horizontal:case r.GradientShadingStyle.BottomRightCorner:case r.GradientShadingStyle.BottomLeftCorner:return{x0:0,y0:o,x1:0,y1:o+l};case r.GradientShadingStyle.ReversedHorizontal:return{x0:0,y0:o+l,x1:0,y1:o};case r.GradientShadingStyle.DiagonalUp:case r.GradientShadingStyle.DiagonalDown:case r.GradientShadingStyle.ReversedDiagonalUp:case r.GradientShadingStyle.ReversedDiagonalDown:return function(e,t){var n=t.width*t.width,o=t.height*t.height,i=n+o,l=t.x+t.width/2,a=t.y+t.height/2,s=t.width*o/i,d=n*t.height/i;switch(e){case r.GradientShadingStyle.DiagonalUp:break;case r.GradientShadingStyle.DiagonalDown:s=-s;break;case r.GradientShadingStyle.ReversedDiagonalUp:d=-d;break;case r.GradientShadingStyle.ReversedDiagonalDown:s=-s,d=-d;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:l-s,y0:a-d,x1:l+s,y1:a+d}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,i),a=e.createLinearGradient(l.x0,l.y0,l.x1,l.y1),s=0;s<n.length;s++)a.addColorStop(n[s].Position,n[s].Color);return a}t.fillCellWithGradientBackground=function(e,t,n,o){var l=i(e,t.ShadingStyle,t.Stops,n);return l!==o&&(e.fillStyle=l),e.fillRect(n.x,n.y,n.width,n.height),function(e){switch(e){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.TopRightCorner:case r.GradientShadingStyle.BottomLeftCorner:case r.GradientShadingStyle.BottomRightCorner:case r.GradientShadingStyle.Center:return!0;default:return!1}}(t.ShadingStyle)&&(l=e.fillStyle=i(e,function(e){switch(e){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.TopRightCorner:return r.GradientShadingStyle.ReversedHorizontal;case r.GradientShadingStyle.BottomLeftCorner:return r.GradientShadingStyle.ReversedVertical;case r.GradientShadingStyle.BottomRightCorner:return r.GradientShadingStyle.Vertical;case r.GradientShadingStyle.Center:return r.GradientShadingStyle.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,n),function(e,t,n){var o=n.x,i=n.y,l=n.width,a=n.height;switch(e.beginPath(),e.moveTo(o,i),e.lineTo(o+l,i),t){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.BottomRightCorner:e.lineTo(o+l,i+a);break;case r.GradientShadingStyle.TopRightCorner:case r.GradientShadingStyle.BottomLeftCorner:e.lineTo(o,i+a);break;case r.GradientShadingStyle.Center:e.lineTo(o,i+a),e.lineTo(o+l,i+a);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(o,i)}(e,t.ShadingStyle,n),e.fill()),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawGridCellsPattern=void 0;var r=n(1),o=n(2),i=n(6),l=n(3);function a(e,t,n){if(e===n.RowNumbers.length-1)return!0;var o=(0,r.getCell)(e+1,t,n);if(!o)return!0;var i=o.CachedStyle;return!(null==i?void 0:i.BackgroundColor)&&!(null==i?void 0:i.Gradient)&&!(null==i?void 0:i.PatternStyle)}function s(e,t,n){if(t===n.ColumnNumbers.length-1)return!0;var o=(0,r.getCell)(e,t+1,n);if(!o)return!0;var i=o.CachedStyle;return!(null==i?void 0:i.BackgroundColor)&&!(null==i?void 0:i.Gradient)&&!(null==i?void 0:i.PatternStyle)}t.drawGridCellsPattern=function(e,t,n){if(!n.highContrastScheme){for(var d,u,c=new Map,g=t.ClientOnlyCache.GridlineOverridingCellsToRender,f=0;f<g.length;f++){var h=g[f];if((0,o.cellIntersectsRenderingRegion)(h,n.renderingRegion)){var C={styleType:(u=h).CachedStyle.PatternStyle,color:u.CachedStyle.PatternColor},m=C.styleType;if(m&&m!==r.PatternStyleType.Solid){var p="".concat((d=C).styleType,"_").concat(d.color);c.has(p)?c.get(p).push(h):c.set(p,[h])}}}c.forEach((function(o,d){var u=function(e,t){var n=document.createElement("canvas"),o=t<=1?1:Math.trunc(t);n.width=l.PatternTileSize*o,n.height=l.PatternTileSize*o;var i=n.getContext("2d");switch(i.scale(o,o),i.fillStyle=e.color,i.strokeStyle=e.color,e.styleType){case r.PatternStyleType.Gray75:i.beginPath(),i.lineWidth=1,i.moveTo(1+l.pixelTranslation,0),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,0),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,0),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,0),i.lineTo(7+l.pixelTranslation,n.height),i.stroke(),i.beginPath(),i.setLineDash([1,1]),i.moveTo(l.pixelTranslation,0),i.lineTo(l.pixelTranslation,n.height),i.moveTo(2+l.pixelTranslation,1),i.lineTo(2+l.pixelTranslation,n.height),i.moveTo(4+l.pixelTranslation,0),i.lineTo(4+l.pixelTranslation,n.height),i.moveTo(6+l.pixelTranslation,1),i.lineTo(6+l.pixelTranslation,n.height),i.stroke();break;case r.PatternStyleType.Gray50:i.beginPath(),i.setLineDash([1,1]),i.lineWidth=1,i.moveTo(l.pixelTranslation,1),i.lineTo(l.pixelTranslation,n.height),i.moveTo(1+l.pixelTranslation,0),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(2+l.pixelTranslation,1),i.lineTo(2+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,0),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(4+l.pixelTranslation,1),i.lineTo(4+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,0),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(6+l.pixelTranslation,1),i.lineTo(6+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,0),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case r.PatternStyleType.Gray25:i.beginPath(),i.setLineDash([1,1]),i.lineWidth=1,i.moveTo(1+l.pixelTranslation,0),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,1),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,0),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,1),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case r.PatternStyleType.Gray125:i.beginPath(),i.setLineDash([1,3]),i.lineWidth=1,i.moveTo(1+l.pixelTranslation,3),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,1),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,3),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,1),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case r.PatternStyleType.Gray0625:i.beginPath(),i.setLineDash([1,3]),i.lineWidth=1,i.moveTo(3+l.pixelTranslation,1),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,3),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case r.PatternStyleType.DiagStripe:i.beginPath(),i.setLineDash([2,2]),i.lineWidth=1,i.moveTo(2,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(1,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(3,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(2,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(1,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(0,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(3,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke(),i.fillRect(0,3,1,1),i.fillRect(0,7,1,1);break;case r.PatternStyleType.ThinDiagStripe:i.beginPath(),i.setLineDash([1,3]),i.lineWidth=1,i.moveTo(3,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(2,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(1,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(3,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(2,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(1,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke();break;case r.PatternStyleType.ReverseDiagStripe:i.beginPath(),i.setLineDash([2,2]),i.lineWidth=1,i.moveTo(1,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(2,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(3,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(1,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(2,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(3,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke(),i.fillRect(0,2,1,1),i.fillRect(0,6,1,1);break;case r.PatternStyleType.ThinReverseDiagStripe:i.beginPath(),i.setLineDash([1,3]),i.lineWidth=1,i.moveTo(1,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(2,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(3,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(1,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(2,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(3,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke();break;case r.PatternStyleType.HorzStripe:i.beginPath(),i.lineWidth=2,i.moveTo(0,1),i.lineTo(n.width,1),i.moveTo(0,5),i.lineTo(n.width,5),i.stroke();break;case r.PatternStyleType.ThinHorzStripe:i.beginPath(),i.lineWidth=1,i.moveTo(0,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.stroke();break;case r.PatternStyleType.VertStripe:i.beginPath(),i.lineWidth=2,i.moveTo(1,0),i.lineTo(1,n.height),i.moveTo(5,0),i.lineTo(5,n.height),i.stroke();break;case r.PatternStyleType.ThinVertStripe:i.beginPath(),i.lineWidth=1,i.moveTo(1+l.pixelTranslation,0),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,0),i.lineTo(5+l.pixelTranslation,n.height),i.stroke();break;case r.PatternStyleType.ThinHorzCross:i.beginPath(),i.lineWidth=1,i.moveTo(0,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(3+l.pixelTranslation,0),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,0),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case r.PatternStyleType.ThinDiagCross:i.beginPath(),i.setLineDash([1,1]),i.lineWidth=1,i.moveTo(0+l.pixelTranslation,0),i.lineTo(0+l.pixelTranslation,n.height),i.moveTo(2+l.pixelTranslation,0),i.lineTo(2+l.pixelTranslation,n.height),i.moveTo(4+l.pixelTranslation,0),i.lineTo(4+l.pixelTranslation,n.height),i.moveTo(6+l.pixelTranslation,0),i.lineTo(6+l.pixelTranslation,n.height),i.stroke(),i.beginPath(),i.setLineDash([1,3]),i.moveTo(1+l.pixelTranslation,3),i.lineTo(1+l.pixelTranslation,n.height),i.moveTo(3+l.pixelTranslation,1),i.lineTo(3+l.pixelTranslation,n.height),i.moveTo(5+l.pixelTranslation,3),i.lineTo(5+l.pixelTranslation,n.height),i.moveTo(7+l.pixelTranslation,1),i.lineTo(7+l.pixelTranslation,n.height),i.stroke();break;case r.PatternStyleType.DiagCross:i.beginPath(),i.setLineDash([2,2]),i.lineWidth=1,i.moveTo(2,l.pixelTranslation),i.lineTo(n.width,l.pixelTranslation),i.moveTo(2,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(2,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(2,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(0,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke();break;case r.PatternStyleType.ThickDiagCross:i.beginPath(),i.lineWidth=1,i.moveTo(0,1+l.pixelTranslation),i.lineTo(n.width,1+l.pixelTranslation),i.moveTo(0,3+l.pixelTranslation),i.lineTo(n.width,3+l.pixelTranslation),i.moveTo(0,5+l.pixelTranslation),i.lineTo(n.width,5+l.pixelTranslation),i.moveTo(0,7+l.pixelTranslation),i.lineTo(n.width,7+l.pixelTranslation),i.stroke(),i.beginPath(),i.setLineDash([2,2]),i.moveTo(2,0+l.pixelTranslation),i.lineTo(n.width,0+l.pixelTranslation),i.moveTo(0,2+l.pixelTranslation),i.lineTo(n.width,2+l.pixelTranslation),i.moveTo(2,4+l.pixelTranslation),i.lineTo(n.width,4+l.pixelTranslation),i.moveTo(0,6+l.pixelTranslation),i.lineTo(n.width,6+l.pixelTranslation),i.stroke();break;default:throw Error("getPatternStyleTile:: Pattern not supported: ".concat(e.styleType))}return n}(function(e){var t={styleType:r.PatternStyleType.None,color:""};if(!e)return t;var n=e.split("_");if(2!==n.length)return t;return t.styleType=r.PatternStyleType[r.PatternStyleType[parseInt(n[0],10)]],t.color=n[1],t}(d),n.devicePixelRatio),c=e.createPattern(u,"repeat");if(!c)throw Error("CanvasPattern from patternTile is null for ".concat(d));e.fillStyle=c;for(var g=0;g<o.length;g++){var f=o[g],h=(0,i.getCellDimensionsAdjustedForDrawing)(t,f,!1),C=a(f.Row,f.Col,t)?h.height:h.height-l.GridLineWidthPx,m=h.width,p=h.x;s(f.Row,f.Col,t)||(t.IsRtl?p+=l.GridLineWidthPx:m-=l.GridLineWidthPx),e.fillRect(p,h.y,m,C)}}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawConditionalFormattingIcons=void 0;var r=n(0),o=n(10),i=n(5),l=n(2),a=n(20),s=n(72),d=n(3),u=n(179),c=n(91),g=n(12),f=n(180),h=n(181),C=n(182),m=n(183),p=n(184),y=n(185),v=n(123),S=n(186),R=n(187),F=n(48),w=n(19);function T(e,t,n,r,i){var d=function(e,t,n,r){var i=t.CondFormat.Icon.IconOnly?t.CachedFont.Size:(0,o.getActualFontSize)(e,t),l=(0,g.getIconSize)(i,n),s=t.CondFormat.Icon,d=a.IconImageLookup[s.Set][s.Index],u=(0,c.getIconLeftPosition)(e,t,l,i,n),f=(0,c.getIconVerticalPosition)(e,t,n,l);return{size:l,image:d,left:u,bottom:f,highContrastScheme:r}}(t,n,r,i),w=(0,F.getClipRect)(t,n,d.left,d.bottom,d.size,!1);if(!(d.size<=a.MinimalIconSize)){switch((0,l.applyClipping)(e,w),d.image){case a.CFIconImage.CircleLow:case a.CFIconImage.CircleMedium:case a.CFIconImage.CircleHigh:case a.CFIconImage.CircleEmpty:case a.CFIconImage.CircleFilled:case a.CFIconImage.FourCircleHigh:case a.CFIconImage.FourCircleLow:case a.CFIconImage.FourCircleMedium1:case a.CFIconImage.FourCircleMedium2:case a.CFIconImage.Circle25:case a.CFIconImage.CircleHalf:case a.CFIconImage.Circle75:(0,s.drawCircleIcon)(e,d);break;case a.CFIconImage.CircleSymbolHigh:case a.CFIconImage.CircleSymbolMedium:case a.CFIconImage.CircleSymbolLow:(0,R.drawCircledSymbols)(e,d);break;case a.CFIconImage.TrafficHigh:case a.CFIconImage.TrafficMedium:case a.CFIconImage.TrafficLow:(0,u.drawTrafficLightRimmed)(e,d);break;case a.CFIconImage.SignalBarEmpty:case a.CFIconImage.SignalBarLow:case a.CFIconImage.SignalBarMedium1:case a.CFIconImage.SignalBarMedium2:case a.CFIconImage.SignalBarHigh:(0,f.drawSignalBar)(e,d);break;case a.CFIconImage.QuadrantEmpty:case a.CFIconImage.Quadrant25:case a.CFIconImage.QuadrantHalf:case a.CFIconImage.Quadrant75:case a.CFIconImage.QuadrantFull:(0,h.drawQuadrantBoxes)(e,d);break;case a.CFIconImage.FlagHigh:case a.CFIconImage.FlagMedium:case a.CFIconImage.FlagLow:(0,C.drawFlag)(e,d);break;case a.CFIconImage.TriangleHigh:case a.CFIconImage.TriangleMedium:case a.CFIconImage.TriangleLow:(0,m.drawTriangleSet)(e,d);break;case a.CFIconImage.StarHigh:case a.CFIconImage.StarMedium:case a.CFIconImage.StarLow:(0,p.drawStarIcon)(e,d);break;case a.CFIconImage.SignLow:case a.CFIconImage.SignMedium:(0,y.drawSigns)(e,d);break;case a.CFIconImage.SymbolHigh:case a.CFIconImage.SymbolMedium:case a.CFIconImage.SymbolLow:(0,v.drawSymbols)(e,d);break;case a.CFIconImage.ColoredArrowDown:case a.CFIconImage.ColoredArrowDownRight:case a.CFIconImage.ColoredArrowRight:case a.CFIconImage.ColoredArrowUp:case a.CFIconImage.ColoredArrowUpRight:case a.CFIconImage.GrayArrowDown:case a.CFIconImage.GrayArrowDownRight:case a.CFIconImage.GrayArrowRight:case a.CFIconImage.GrayArrowUp:case a.CFIconImage.GrayArrowUpRight:(0,S.drawArrows)(e,d);break;default:throw Error("drawConditionalFormattingIcon: imageType: ".concat(d.image," not supported"))}(0,l.restoreClipping)(e,w)}}t.drawConditionalFormattingIcons=function(e,t,n){var o;(0,i.verifyArgumentNotNull)(e,"ctx","drawConditionalFormattingIcons"),(0,i.verifyArgumentNotNull)(t,"model","drawConditionalFormattingIcons"),(0,i.verifyArgumentNotNull)(n,"context","drawConditionalFormattingIcons");var a=t.ClientOnlyCache.CellsToRender;a.length>0&&(e.lineWidth=w.ShapeOutlineWidthPx,e.setLineDash(d.DefaultDash));for(var s=null!==n.highContrastScheme?n.highContrastScheme:void 0,u=0;u<a.length;u++){var c=a[u];(null===(o=null==c?void 0:c.CondFormat)||void 0===o?void 0:o.Icon)&&((0,r.isCellPreviewTextDefined)(c.PreviewText)||c.ShowSkeleton||(0,l.cellIntersectsRenderingRegion)(c,n.renderingRegion)&&T(e,t,c,n.scaleFactor,s))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawStripes=t.getInnerCircleRadius=t.getHighContrastFillingType=t.FillType=void 0;var r,o=n(20),i=n(2),l=n(19);!function(e){e[e.Empty=0]="Empty",e[e.Stripes=1]="Stripes",e[e.InnerCircle=2]="InnerCircle",e[e.FillPortion=3]="FillPortion",e[e.Full=4]="Full"}(r||(t.FillType=r={})),t.getHighContrastFillingType=function(e){switch(e){case o.CFIconImage.Circle25:case o.CFIconImage.CircleHalf:case o.CFIconImage.Circle75:return r.FillPortion;case o.CFIconImage.CircleLow:case o.CFIconImage.CircleEmpty:case o.CFIconImage.FourCircleHigh:case o.CFIconImage.TrafficLow:case o.CFIconImage.CircleSymbolLow:case o.CFIconImage.CircleSymbolMedium:case o.CFIconImage.CircleSymbolHigh:return r.Empty;case o.CFIconImage.CircleHigh:case o.CFIconImage.TrafficHigh:case o.CFIconImage.CircleFilled:return r.Full;case o.CFIconImage.CircleMedium:case o.CFIconImage.TrafficMedium:return r.Stripes;case o.CFIconImage.FourCircleLow:case o.CFIconImage.FourCircleMedium1:case o.CFIconImage.FourCircleMedium2:return r.InnerCircle;default:throw Error("getHighContrastFillingType: image: ".concat(e," not supported"))}},t.getInnerCircleRadius=function(e,t){switch(e){case o.CFIconImage.FourCircleMedium2:return t*o.CircleHighContrastSmallRadiusPortion;case o.CFIconImage.FourCircleMedium1:return t*o.CircleHighContrastMediumRadiusPortion;case o.CFIconImage.FourCircleLow:return t*o.CircleHighContrastLargeRadiusPortion;default:throw Error("highContrastCircles::getInnerRadius: unsupported image for drawing inner circle")}},t.drawStripes=function(e,t,n,r,a){e.strokeStyle=a,e.beginPath();var s={p1:{x:t+r*Math.cos(o.StripedCircleUpperLineAngle)-l.ShapeLinesAdjustment,y:n+r*Math.sin(o.StripedCircleUpperLineAngle)-l.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(o.Circle270Deg-o.StripedCircleUpperLineAngle)+l.ShapeLinesAdjustment,y:n+r*Math.sin(o.Circle270Deg-o.StripedCircleUpperLineAngle)+l.ShapeLinesAdjustment}},d={p1:{x:t+r*Math.cos(o.StripedCircleMiddleLineAngle)-l.ShapeLinesAdjustment,y:n+r*Math.sin(o.StripedCircleMiddleLineAngle)-l.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(o.Circle270Deg-o.StripedCircleMiddleLineAngle)+l.ShapeLinesAdjustment,y:n+r*Math.sin(o.Circle270Deg-o.StripedCircleMiddleLineAngle)+l.ShapeLinesAdjustment}},u={p1:{x:t+r*Math.cos(o.StripedCircleLowerLineAngle)-l.ShapeLinesAdjustment,y:n+r*Math.sin(o.StripedCircleLowerLineAngle)-l.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(o.Circle270Deg-o.StripedCircleLowerLineAngle)+l.ShapeLinesAdjustment,y:n+r*Math.sin(o.Circle270Deg-o.StripedCircleLowerLineAngle)+l.ShapeLinesAdjustment}};(0,i.drawLine)(e,s.p1.x,s.p1.y,s.p2.x,s.p2.y),(0,i.drawLine)(e,d.p1.x,d.p1.y,d.p2.x,d.p2.y),(0,i.drawLine)(e,u.p1.x,u.p1.y,u.p2.x,u.p2.y),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawTrafficLightRimmed=void 0;var r=n(0),o=n(5),i=n(20),l=n(27),a=n(72),s=n(28);t.drawTrafficLightRimmed=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawTrafficLightRimmed"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawTrafficLightRimmed");var n=t.size,d=n;n%2==0&&(d=n-1);var u={left:t.left,bottom:t.bottom,outerColor:function(e){return e?(0,r.rgbToColorHex)(e.TextColor):s.TrafficHighRimmedRectColor}(t.highContrastScheme),height:d,width:d,innerColor:void 0};(0,l.drawRectangle)(e,u),t.size=d;var c=function(e){var t=e.image,n=e.left,r=e.bottom,o=e.highContrastScheme,l=e.size-2*i.CirclePaddingFromBoundariesPx,a=n+i.CirclePaddingFromBoundariesPx+.5,s=r-i.CirclePaddingFromBoundariesPx-.5;return{size:l,left:a,bottom:s,image:t,highContrastScheme:o}}(t);(0,a.drawCircleIcon)(e,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSignalBar=void 0;var r=n(0),o=n(5),i=n(27),l=n(20),a=n(28),s=n(2),d=n(19);function u(e,t,n,o){var i=o.left,l=o.bottom;return{innerColor:t,outerColor:function(e){if(e)return(0,r.rgbToColorHex)(e.TextColor);return a.SignalBarOutlineColor}(o.highContrastScheme),bottom:l,left:i+n*(e+1),height:n*(e+2),width:n}}t.drawSignalBar=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawSignalBar"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawSignalBar");for(var n=t.image,c=t.size,g=t.highContrastScheme,f=Math.floor(c/5),h=function(e,t){var n=function(e){if(e)return(0,r.rgbToColorHex)(e.BackgroundColor);return a.SignalBarEmptyColor}(t),o=function(e){if(e)return(0,r.rgbToColorHex)(e.TextColor);return a.SignalBarFilledColor}(t);switch(e){case l.CFIconImage.SignalBarEmpty:return[n,n,n,n];case l.CFIconImage.SignalBarLow:return[o,n,n,n];case l.CFIconImage.SignalBarMedium1:return[o,o,n,n];case l.CFIconImage.SignalBarMedium2:return[o,o,o,n];case l.CFIconImage.SignalBarHigh:return[o,o,o,o];default:throw Error("getBarsColors: image: ".concat(e," not supported"))}}(n,g),C=0;C<h.length;C++){var m=u(C,h[C],f,t);(0,i.drawRectangle)(e,m)}g&&function(e,t,n,o){var i=n.left,a=n.bottom,u=n.highContrastScheme,c=function(e,t,n,r){for(var o=function(e){switch(e){case l.CFIconImage.SignalBarEmpty:case l.CFIconImage.SignalBarLow:return 0;case l.CFIconImage.SignalBarMedium1:return 1;case l.CFIconImage.SignalBarMedium2:return 2;case l.CFIconImage.SignalBarHigh:return 3;default:throw Error("getSeperators: image: ".concat(e," not supported"))}}(e),i=[],a=n-2*r+d.ShapeLinesAdjustment,s=t+2*r+d.ShapeLinesAdjustment,u=0;u<o;u++)i.push({X:s,startY:a,endY:n-1.5}),a-=r,s+=r;return i}(e,i,a,o);t.strokeStyle=(0,r.rgbToColorHex)(u.BackgroundColor),t.beginPath();for(var g=0;g<c.length;g++)(0,s.drawLine)(t,c[g].X,c[g].startY,c[g].X,c[g].endY);t.stroke()}(n,e,t,f)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawQuadrantBoxes=void 0;var r=n(0),o=n(5),i=n(27),l=n(20),a=n(28),s=n(2),d=n(19);function u(e,t,n,o,i){var l=i.left,s=i.bottom;return{innerColor:n,outerColor:function(e){if(e)return(0,r.rgbToColorHex)(e.TextColor);return a.SignalBarOutlineColor}(i.highContrastScheme),bottom:s-e*o,left:l+t*o,height:o,width:o}}t.drawQuadrantBoxes=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawQuadrantBoxes"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawQuadrantBoxes");for(var n=t.image,c=t.size,g=t.highContrastScheme,f=Math.floor(c/2),h=function(e,t){var n=function(e){if(e)return(0,r.rgbToColorHex)(e.TextColor);return a.SignalBarFilledColor}(t),o=function(e){if(e)return(0,r.rgbToColorHex)(e.BackgroundColor);return a.SignalBarEmptyColor}(t);switch(e){case l.CFIconImage.QuadrantEmpty:return[[o,o],[o,o]];case l.CFIconImage.Quadrant25:return[[n,o],[o,o]];case l.CFIconImage.QuadrantHalf:return[[n,n],[o,o]];case l.CFIconImage.Quadrant75:return[[n,n],[n,o]];case l.CFIconImage.QuadrantFull:return[[n,n],[n,n]];default:throw Error("getBoxesColors: image: ".concat(e," not supported"))}}(n,g),C=0;C<h.length;C++)for(var m=0;m<h.length;m++){var p=u(C,m,h[C][m],f,t);(0,i.drawRectangle)(e,p)}g&&function(e,t,n,o){var i=t.left,a=t.bottom,u=t.highContrastScheme,c=i+n+d.ShapeLinesAdjustment,g=a-n-d.ShapeLinesAdjustment,f=function(e,t,n,r){switch(e){case l.CFIconImage.QuadrantEmpty:return[];case l.CFIconImage.Quadrant25:return[{x:t,y:n+r-d.ShapeLinesAdjustment},{x:t-r+d.ShapeLinesAdjustment,y:n}];case l.CFIconImage.QuadrantHalf:return[{x:t+r,y:n},{x:t,y:n+r-d.ShapeLinesAdjustment},{x:t-r+d.ShapeLinesAdjustment,y:n}];case l.CFIconImage.Quadrant75:case l.CFIconImage.QuadrantFull:return[{x:t,y:n-r+d.ShapeLinesAdjustment},{x:t+r-d.ShapeLinesAdjustment,y:n},{x:t,y:n+r-d.ShapeLinesAdjustment},{x:t-r+d.ShapeLinesAdjustment,y:n}];default:throw Error("getSeparatorsCoordinates: image: ".concat(e," not supported"))}}(o,c,g,n);e.strokeStyle=(0,r.rgbToColorHex)(u.BackgroundColor),e.beginPath();for(var h=0;h<f.length;h++)(0,s.drawLine)(e,c,g,f[h].x,f[h].y);e.stroke()}(e,t,f,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawFlag=void 0;var r=n(0),o=n(5),i=n(20),l=n(27),a=n(28),s=n(2),d=n(3),u=n(19);function c(e,t){(0,o.verifyArgumentNotNull)(t.outerColor,"outerColor","drawFlags");var n,r,l,a,d,c,g,f,h,C=t.outerColor,m=(r=(n=t).left,l=n.bottom,a=n.width,d=n.height,c=d/2,g={x:r+a+u.ShapeLinesAdjustment,y:l-c-u.ShapeLinesAdjustment},f=r+a-c/i.QuarterPiTan+u.ShapeLinesAdjustment,h=l-d-u.ShapeLinesAdjustment,{p1:g,p2:{x:f,y:h}}),p=function(e){var t=e.left,n=e.bottom,r=e.width/2,o={x:t+r+u.ShapeLinesAdjustment,y:n-u.ShapeLinesAdjustment},l=n-r*i.QuarterPiTan-u.ShapeLinesAdjustment,a={x:t+u.ShapeLinesAdjustment,y:l};return{p1:o,p2:a}}(t);e.strokeStyle=C,e.beginPath(),(0,s.drawLine)(e,m.p1.x,m.p1.y,m.p2.x,m.p2.y),(0,s.drawLine)(e,p.p1.x,p.p1.y,p.p2.x,p.p2.y),e.stroke()}t.drawFlag=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawFlags"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawFlags");var n=t.image,g=t.size,f=t.left,h=t.bottom,C=t.highContrastScheme,m=Math.floor(g/2),p=Math.floor(g/3),y=function(e,t){if(t)return function(e,t){if(e===i.CFIconImage.FlagHigh)return(0,r.rgbToColorHex)(t.TextColor);return}(e,t);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighInnerColor;case i.CFIconImage.FlagMedium:return a.FlagMediumInnerColor;case i.CFIconImage.FlagLow:return a.FlagLowInnerColor;default:throw Error("getFlagInnerColor: unsupported image type = ".concat(e))}}(n,C),v=function(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighOuterColor;case i.CFIconImage.FlagMedium:return a.FlagMediumOuterColor;case i.CFIconImage.FlagLow:return a.FlagLowOuterColor;default:throw Error("getFlagOuterColor: unsupported image type = ".concat(e))}}(n,C);!function(e,t,n,r,o,a){var s=a.left,d=a.bottom,u=a.image,g=a.highContrastScheme,f={left:s,bottom:d-t,outerColor:o,height:t,width:n,innerColor:r};(0,l.drawRectangle)(e,f),u===i.CFIconImage.FlagMedium&&g&&c(e,f)}(e,m,p,y,v,t),function(e,t,n,r,o,a){var s=a.left,d=a.bottom,u=a.size,g=a.image,f=a.highContrastScheme,h=Math.floor(u/8),C={left:s+n,bottom:d-t+h,outerColor:o,height:t,width:n,innerColor:r};(0,l.drawRectangle)(e,C),g===i.CFIconImage.FlagMedium&&f&&c(e,C)}(e,m,p,y,v,t),function(e,t,n,o,l){var c=o-u.ShapeLinesAdjustment,g=c-n,f=t+u.ShapeLinesAdjustment;e.lineWidth=i.FlagPoleWidth,e.setLineDash(d.DefaultDash),e.strokeStyle=function(e){return e?(0,r.rgbToColorHex)(e.TextColor):a.FlagPoleColor}(l),e.beginPath(),(0,s.drawLine)(e,f,c,f,g),e.stroke()}(e,f,2*m,h,C)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawTriangleSet=void 0;var r=n(0),o=n(5),i=n(20),l=n(28),a=n(60),s=n(27),d=n(19);function u(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.TriangleLow:return l.TriangleLowOuterColor;case i.CFIconImage.TriangleMedium:return l.TriangleMediumOuterColor;case i.CFIconImage.TriangleHigh:return l.TriangleHighOuterColor;default:throw Error("getTriangleOuterColor: unsupported image type = ".concat(e))}}function c(e,t){if(t)return(0,r.rgbToColorHex)(t.BackgroundColor);switch(e){case i.CFIconImage.TriangleLow:return l.TriangleLowInnerColor;case i.CFIconImage.TriangleMedium:return l.TriangleMediumInnerColor;case i.CFIconImage.TriangleHigh:return l.TriangleHighInnerColor;default:throw Error("getTriangleInnerColor: unsupported image type = ".concat(e))}}t.drawTriangleSet=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawTriangleSet"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawTriangleSet");var n=t.image,r=t.size,l=t.left,g=t.bottom,f=t.highContrastScheme;switch(n){case i.CFIconImage.TriangleHigh:case i.CFIconImage.TriangleLow:var h=function(e){var t=e.image,n=e.left,r=e.bottom,o=e.size,l=e.highContrastScheme,a=Math.floor(o/2),s=Math.floor(o/4),g=r-s-d.ShapeLinesAdjustment,f=n+d.ShapeLinesAdjustment;switch(t){case i.CFIconImage.TriangleHigh:return{outerColor:u(t,l),innerColor:c(t,l),left:f,bottom:g,height:a,width:o};case i.CFIconImage.TriangleLow:return{outerColor:u(t,l),innerColor:c(t,l),left:n+d.ShapeLinesAdjustment,bottom:r-s-a-d.ShapeLinesAdjustment,height:a,width:o};default:throw Error("getTriangleDrawingContext: unsupported image type = ".concat(t))}}(t);(0,a.drawTriangle)(e,h,n===i.CFIconImage.TriangleLow);break;case i.CFIconImage.TriangleMedium:var C=Math.floor(r/3),m={left:l,outerColor:u(n,f),innerColor:c(n,f),bottom:g-C,height:C,width:r};(0,s.drawRectangle)(e,m);break;default:throw Error("drawTriangleSet: unsupported image type = ".concat(n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawStarIcon=void 0;var r=n(0),o=n(5),i=n(20),l=n(28),a=n(44),s=n(19);t.drawStarIcon=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawStarIcon"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawStarIcon");var n=t.image,d=t.size,u=t.left,c=t.bottom,g=t.highContrastScheme,f=Math.floor(d/2);if(!(f<=1)){var h=function(e,t,n){var r=n*i.StarInset,o=e+n+.5,l=t-n,a=r*i.StarRotationSin,d=r*i.StarRotationCos,u=n*i.StarRotation2Sin,c=r*i.StarRotation2Sin,g=r*i.StarRotation2Cos,f=n*i.StarRotationSin,h=n*i.StarRotationCos,C=Math.floor(d)+s.ShapeLinesAdjustment,m=l+(d-C),p=m-d,y=m+g,v=m+h;return{topOuter:{x:o,y:m-n},topRightInner:{x:o+a,y:p},topRightOuter:{x:o+u,y:p},middleRightInner:{x:o+c,y:y},bottomRightOuter:{x:o+f,y:v},bottomInner:{x:o,y:m+r},bottomLeftOuter:{x:o-f,y:v},middleLeftInner:{x:o-c,y:y},topLeftOuter:{x:o-u,y:p},topLeftInner:{x:o-a,y:p}}}(u,c,f),C=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return(0,r.rgbToColorHex)(t.TextColor);case i.CFIconImage.StarLow:return;default:throw Error("getStarLeftInnerColorHighContrast: unsupported image type = ".concat(e))}}(e,t);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return l.StarFilledInnerColor;case i.CFIconImage.StarLow:return l.StarEmptyInnerColor;default:throw Error("getStarLeftInnerColor: unsupported image type = ".concat(e))}}(n,g),m=function(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return l.StarFilledOuterColor;case i.CFIconImage.StarLow:return l.StarEmptyOuterColor;default:throw Error("getStarLeftOuterColor: unsupported image type = ".concat(e))}}(n,g),p=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:return(0,r.rgbToColorHex)(t.TextColor);case i.CFIconImage.StarLow:case i.CFIconImage.StarMedium:return;default:throw Error("getStarRightInnerColorHighContrast: unsupported image type = ".concat(e))}}(e,t);switch(e){case i.CFIconImage.StarHigh:return l.StarFilledInnerColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return l.StarEmptyInnerColor;default:throw Error("getStarRightInnerColor: unsupported image type = ".concat(e))}}(n,g),y=function(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.StarHigh:return l.StarFilledOuterColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return l.StarEmptyOuterColor;default:throw Error("getStarRightOuterColor: unsupported image type = ".concat(e))}}(n,g),v=n===i.CFIconImage.StarMedium;e.beginPath(),function(e,t){e.moveTo(t.topOuter.x,t.topOuter.y),e.lineTo(t.topRightInner.x,t.topRightInner.y),e.lineTo(t.topRightOuter.x,t.topRightOuter.y),e.lineTo(t.middleRightInner.x,t.middleRightInner.y),e.lineTo(t.bottomRightOuter.x,t.bottomRightOuter.y),e.lineTo(t.bottomInner.x,t.bottomInner.y)}(e,h),v&&((0,a.fillAndStroke)(e,p,y),e.beginPath()),function(e,t){e.moveTo(t.bottomInner.x,t.bottomInner.y),e.lineTo(t.bottomLeftOuter.x,t.bottomLeftOuter.y),e.lineTo(t.middleLeftInner.x,t.middleLeftInner.y),e.lineTo(t.topLeftOuter.x,t.topLeftOuter.y),e.lineTo(t.topLeftInner.x,t.topLeftInner.y),e.lineTo(t.topOuter.x,t.topOuter.y)}(e,h),(0,a.fillAndStroke)(e,C,m)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSigns=void 0;var r=n(0),o=n(5),i=n(20),l=n(28),a=n(60),s=n(44),d=n(19);function u(e,t){if(!t)switch(e){case i.CFIconImage.SignLow:return l.SignLowInnerColor;case i.CFIconImage.SignMedium:return l.SignMediumInnerColor;default:throw Error("getInnerColor: unsupported image type = ".concat(e))}}function c(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case i.CFIconImage.SignLow:return l.SignLowOuterColor;case i.CFIconImage.SignMedium:return l.SignMediumOuterColor;default:throw Error("getOuterColor: unsupported image type = ".concat(e))}}t.drawSigns=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawSigns"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawSigns");var n=t.image;switch(n){case i.CFIconImage.SignLow:!function(e,t){var n=t.image,r=t.highContrastScheme,o=u(n,r),i=c(n,r),l=function(e){var t=e.size,n=e.left,r=e.bottom,o=Math.floor(t/2),i=n+o+d.ShapeLinesAdjustment,l=r-o-d.ShapeLinesAdjustment;return{top:{x:i,y:l-o},right:{x:i+o,y:l},bottom:{x:i,y:l+o},left:{x:i-o,y:l}}}(t);e.beginPath(),e.moveTo(l.top.x,l.top.y),e.lineTo(l.right.x,l.right.y),e.lineTo(l.bottom.x,l.bottom.y),e.lineTo(l.left.x,l.left.y),e.lineTo(l.top.x,l.top.y),(0,s.fillAndStroke)(e,o,i)}(e,t);break;case i.CFIconImage.SignMedium:var r=function(e){var t=e.left,n=e.bottom,r=e.size,o=e.highContrastScheme,i=e.image,l=t+d.ShapeLinesAdjustment,a=n-d.ShapeLinesAdjustment,s=u(i,o);return{outerColor:c(i,o),innerColor:s,left:l,bottom:a,height:r,width:r}}(t);(0,a.drawTriangle)(e,r,!1);break;default:throw Error("drawSigns: unsupported image type = ".concat(n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawArrows=void 0;var r=n(0),o=n(5),i=n(28),l=n(20),a=n(44),s=n(19);function d(e){var t=Math.round(l.ArrowWidthRatio*e);return t=t%2!=0?t+1:t}function u(e){var t=Math.round(l.ArrowHeightRatio*e);return t=t%2!=0?t+1:t}t.drawArrows=function(e,t){(0,o.verifyArgumentNotNull)(e,"ctx","drawArrows"),(0,o.verifyArgumentNotNull)(t,"drawingContext","drawArrows");var n=t.image,c=t.size,g=t.left,f=t.bottom,h=t.highContrastScheme,C=function(e,t){if(t)return(0,r.rgbToColorHex)(t.TextColor);switch(e){case l.CFIconImage.GrayArrowDown:case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.GrayArrowRight:case l.CFIconImage.GrayArrowUp:case l.CFIconImage.GrayArrowUpRight:return i.ArrowGrayOuterColor;case l.CFIconImage.ColoredArrowUp:return i.ArrowUpOuterColor;case l.CFIconImage.ColoredArrowDown:return i.ArrowDownOuterColor;case l.CFIconImage.ColoredArrowUpRight:case l.CFIconImage.ColoredArrowRight:case l.CFIconImage.ColoredArrowDownRight:return i.ArrowRightOuterColor;default:throw Error("getArrowOuterColor: unsupported image type = ".concat(e))}}(n,h),m=function(e,t){if(t)return function(e,t){switch(e){case l.CFIconImage.GrayArrowDown:case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.GrayArrowRight:case l.CFIconImage.GrayArrowUp:case l.CFIconImage.GrayArrowUpRight:return(0,r.rgbToColorHex)(t.TextColor);case l.CFIconImage.ColoredArrowUp:case l.CFIconImage.ColoredArrowDown:case l.CFIconImage.ColoredArrowUpRight:case l.CFIconImage.ColoredArrowRight:case l.CFIconImage.ColoredArrowDownRight:return(0,r.rgbToColorHex)(t.BackgroundColor);default:throw Error("getArrowHighContrastInnerColor: unsupported image type = ".concat(e))}}(e,t);switch(e){case l.CFIconImage.GrayArrowDown:case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.GrayArrowRight:case l.CFIconImage.GrayArrowUp:case l.CFIconImage.GrayArrowUpRight:return i.ArrowGrayInnerColor;case l.CFIconImage.ColoredArrowUp:return i.ArrowUpInnerColor;case l.CFIconImage.ColoredArrowDown:return i.ArrowDownInnerColor;case l.CFIconImage.ColoredArrowUpRight:case l.CFIconImage.ColoredArrowRight:case l.CFIconImage.ColoredArrowDownRight:return i.ArrowRightInnerColor;default:throw Error("getArrowInnerColor: unsupported image type = ".concat(e))}}(n,h),p=[];switch(n){case l.CFIconImage.GrayArrowDown:case l.CFIconImage.ColoredArrowDown:p=function(e,t,n){var r=l.ArrowHeightRatio*n,o=d(n),i=Math.floor(n/2+e)+s.ShapeLinesAdjustment,a=Math.round(t),u=i+r*Math.cos(-3*l.ArrowAngle),c=a+r*Math.sin(-3*l.ArrowAngle),g=u+o*Math.cos(-l.ArrowAngle),f=c+o*Math.sin(-l.ArrowAngle),h=i-o/2,C=f+r/2*Math.sin(l.ArrowAngle),m=C-r,p=h+o,y=m,v=p,S=C,R=i+(i-g),F=f,w=i+(i-u),T=c,I={x:i,y:a},x={x:u,y:c},b={x:g,y:f},D={x:h,y:C},A={x:h,y:Math.round(m)-s.ShapeLinesAdjustment},P={x:p,y:Math.round(y)-s.ShapeLinesAdjustment};return[I,x,b,D,A,P,{x:v,y:S},{x:R,y:F},{x:w,y:T},I]}(g,f,c);break;case l.CFIconImage.GrayArrowUp:case l.CFIconImage.ColoredArrowUp:p=function(e,t,n){var r=t-n,o=l.ArrowHeightRatio*n,i=d(n),a=Math.floor(n/2+e)+s.ShapeLinesAdjustment,u=Math.round(r),c=a+o*Math.cos(3*l.ArrowAngle),g=u+o*Math.sin(3*l.ArrowAngle),f=c+i*Math.cos(l.ArrowAngle),h=g+i*Math.sin(l.ArrowAngle),C=a-i/2,m=h+o/2*Math.sin(-l.ArrowAngle),p=m+o,y=C+i,v=p,S=y,R=m,F=a+(a-f),w=h,T=a+(a-c),I=g,x={x:a,y:u},b={x:c,y:g},D={x:f,y:h},A={x:C,y:m},P={x:C,y:Math.round(p)-s.ShapeLinesAdjustment},H={x:y,y:Math.round(v)-s.ShapeLinesAdjustment};return[x,b,D,A,P,H,{x:S,y:R},{x:F,y:w},{x:T,y:I},x]}(g,f,c);break;case l.CFIconImage.GrayArrowRight:case l.CFIconImage.ColoredArrowRight:p=function(e,t,n){var r=t-n,o=l.ArrowHeightRatio*n,i=d(n),a=Math.round(e+n),u=Math.floor(n/2+r)+s.ShapeLinesAdjustment,c=a+o*Math.cos(-3*l.ArrowAngle),g=u+o*Math.sin(-3*l.ArrowAngle),f=c+i*Math.cos(3*l.ArrowAngle),h=g+i*Math.sin(3*l.ArrowAngle),C=f+o/2*Math.cos(l.ArrowAngle),m=u-i/2,p=C-o,y=m,v=p,S=y+i,R=C,F=u+(u-m),w=f,T=u+(u-h),I=c,x=u+(u-g),b={x:a,y:u},D={x:c,y:g},A={x:f,y:h},P={x:C,y:m},H={x:Math.round(p)+s.ShapeLinesAdjustment,y:y},B={x:Math.round(v)+s.ShapeLinesAdjustment,y:S};return[b,D,A,P,H,B,{x:R,y:F},{x:w,y:T},{x:I,y:x},b]}(g,f,c);break;case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.ColoredArrowDownRight:p=function(e,t,n){var r=t-n,o=Math.round(l.ArrowWidthRatio*n),i=u(n),a=Math.floor(l.ArrowDownRightTipXRatio*n+e)+s.ShapeLinesAdjustment,d=Math.floor(l.ArrowDownRightTipYRatio*n+r)+s.ShapeLinesAdjustment,c=a,g=d-i,f=c-o,h=g,C=f,m=d-o-o/Math.sqrt(2),p=C+i*Math.cos(-3*l.ArrowAngle),y=m+i*Math.sin(-3*l.ArrowAngle),v=p+o*Math.cos(3*l.ArrowAngle),S=y+o*Math.sin(3*l.ArrowAngle),R=a-i,F=d,w=R,T=F-o,I=a-o-o/Math.sqrt(2),x={x:a,y:d};return[x,{x:c,y:g},{x:f,y:h},{x:C,y:m},{x:p,y:y},{x:v,y:S},{x:I,y:T},{x:w,y:T},{x:R,y:F},x]}(g,f,c);break;case l.CFIconImage.GrayArrowUpRight:case l.CFIconImage.ColoredArrowUpRight:p=function(e,t,n){var r=t-n,o=Math.round(l.ArrowWidthRatio*n),i=u(n),a=Math.floor(l.ArrowUpRightTipXRatio*n+e)+s.ShapeLinesAdjustment,d=Math.floor(l.ArrowUpRightTipYRatio*n+r)+s.ShapeLinesAdjustment,c=a-i,g=d,f=c,h=g+o,C=a-o-o/Math.sqrt(2),m=h,p=C+i*Math.cos(3*l.ArrowAngle),y=m+i*Math.sin(3*l.ArrowAngle),v=p+o*Math.cos(l.ArrowAngle),S=y+o*Math.sin(l.ArrowAngle),R=a,F=d+i,w=R-o,T=F,I=w,x=d+o+o/Math.sqrt(2),b={x:a,y:d};return[b,{x:c,y:g},{x:f,y:h},{x:C,y:m},{x:p,y:y},{x:v,y:S},{x:I,y:x},{x:w,y:T},{x:R,y:F},b]}(g,f,c);break;default:throw Error("drawArrows: unsupported image type = ".concat(n))}(0,a.drawIconFromPoints)(e,m,C,p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawCircledSymbols=void 0;var r=n(5),o=n(72),i=n(123);t.drawCircledSymbols=function(e,t){(0,r.verifyArgumentNotNull)(e,"ctx","drawCircleSymbols"),(0,r.verifyArgumentNotNull)(t,"drawingContext","drawCircleSymbols"),t.size>0&&((0,o.drawCircleIcon)(e,t),(0,i.drawSymbols)(e,function(e){var t=e.left,n=e.bottom,r=e.image,o=e.highContrastScheme,i=e.size,l=Math.round(t),a=Math.round(n);return{size:Math.round(i),left:l,bottom:a,image:r,highContrastScheme:o}}(t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPageBreaks=void 0;var r=n(2),o=n(56),i=n(0),l=n(124);function a(e,t,n,o,i,l,a){var s=o.Index,g=o.Min,f=o.Max;if(d(s,g,f,n.renderingRegion,!0)){var h=t.ClientOnlyCache,C=c(h.RowOffsetsAdjustedForDrawing,s,i,a),m=-1===o.Min?0:u(h.ColOffsetsAdjustedForDrawing,g,i,l),p=-1===o.Max?t.BlockWidth*n.scaleFactor:u(h.ColOffsetsAdjustedForDrawing,f,i,l);(0,r.drawLine)(e,m,C,p,C)}}function s(e,t,n,o,i,l,a){var s=o.Index,g=o.Min,f=o.Max;if(d(s,g,f,n.renderingRegion,!1)){var h=t.ClientOnlyCache,C=u(h.ColOffsetsAdjustedForDrawing,s,i,l),m=-1===o.Min?0:c(h.RowOffsetsAdjustedForDrawing,g,i,a),p=-1===o.Max?t.BlockHeight*n.scaleFactor:c(h.RowOffsetsAdjustedForDrawing,f,i,a);(0,r.drawLine)(e,C,m,C,p)}}function d(e,t,n,r,o){var i,l,a=o?r.startRow:r.startColumn,s=o?r.endRow:r.endColumn;return l=s,a<=(i=e)&&i<=l&&(s=o?r.endColumn:r.endRow,!(-1!==t&&t>s)&&(a=o?r.startColumn:r.startRow,!(-1!==n&&n<a)))}function u(e,t,n,i){return t>=0?(0,o.getAdjustedDrawingOffset)(e[t],(0,r.getColWidthFromOffsets)(t,e),n,i):0}function c(e,t,n,i){return t>=0?(0,o.getAdjustedDrawingOffset)(e[t],(0,r.getRowHeightFromOffsets)(t,e),n,i):0}t.drawPageBreaks=function(e,t,n){if(null!=t.PageBreaks){(0,l.setPageLayoutLine)(e,n);var r=(0,i.getLinePixelTranslation)((0,l.getLineWidth)(n)),d=(0,o.getMaxLineOffset)(t.BlockWidth,n.scaleFactor,!1),u=(0,o.getMaxLineOffset)(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),function(e,t,n,r,o,i){var l,s=null===(l=t.PageBreaks)||void 0===l?void 0:l.Row;if(null==s)return;for(var d=0;d<s.length;++d)a(e,t,n,s[d],r,o,i)}(e,t,n,r,d,u),function(e,t,n,r,o,i){var l,a=null===(l=t.PageBreaks)||void 0===l?void 0:l.Col;if(null==a)return;for(var d=0;d<a.length;++d)s(e,t,n,a[d],r,o,i)}(e,t,n,r,d,u),e.stroke()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPrintAreas=void 0;var r=n(56),o=n(0),i=n(5),l=n(124),a=n(2);function s(e,t){return!(e.startRow>t.LastRow)&&(!(e.startColumn>t.LastColumn)&&(!(e.endRow+1<t.FirstRow)&&(!(e.endColumn+1<t.FirstColumn)&&!(e.startRow>t.FirstRow&&e.startColumn>t.FirstColumn&&e.endRow<t.LastRow&&e.endColumn<t.LastColumn))))}function d(e,t,n,o,i,l,s){var d=t.ClientOnlyCache,u=s.FirstColumn<=0?-1:(0,r.getAdjustedDrawingOffset)(d.ColOffsetsAdjustedForDrawing[s.FirstColumn],0,o,l),c=s.FirstRow<=0?-1:(0,r.getAdjustedDrawingOffset)(d.RowOffsetsAdjustedForDrawing[s.FirstRow],0,o,i),g=s.LastColumn>=t.ColumnNumbers.length?t.BlockWidth*n.scaleFactor+1:(0,r.getAdjustedDrawingOffset)(d.ColOffsetsAdjustedForDrawing[s.LastColumn],(0,a.getColWidthFromOffsets)(s.LastColumn,d.ColOffsetsAdjustedForDrawing),o,l),f=s.LastRow>=t.RowNumbers.length?t.BlockHeight*n.scaleFactor+1:(0,r.getAdjustedDrawingOffset)(d.RowOffsetsAdjustedForDrawing[s.LastRow],(0,a.getRowHeightFromOffsets)(s.LastRow,d.RowOffsetsAdjustedForDrawing),o,i);e.rect(u,c,g-u,f-c)}t.drawPrintAreas=function(e,t,n){var a;if(function(e){(0,i.verifyArgumentNotNull)(e.BlockWidth,"model.BlockWidth","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.BlockHeight,"model.BlockHeight","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.RowNumbers,"model.RowNumbers","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.ColumnNumbers,"model.ColumnNumbers","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.ClientOnlyCache,"ClientOnlyCache","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawPrintAreas"),(0,i.verifyArgumentNotNull)(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawPrintAreas")}(t),t.PrintAreas){(0,l.setPageLayoutLine)(e,n);var u=(0,o.getLinePixelTranslation)((0,l.getLineWidth)(n)),c=(0,r.getMaxLineOffset)(t.BlockWidth,n.scaleFactor,!1),g=(0,r.getMaxLineOffset)(t.BlockHeight,n.scaleFactor,!0);e.beginPath();for(var f=0;f<(null===(a=t.PrintAreas)||void 0===a?void 0:a.length);f++)s(n.renderingRegion,t.PrintAreas[f])&&d(e,t,n,u,g,c,t.PrintAreas[f]);e.stroke()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawEmptyPivotTableTitleText=t.drawEmptyPivotTableImages=t.drawEmptyPivotTableTitleContainers=void 0;var r=n(1),o=n(2),i=n(3),l=n(57),a=n(67),s=n(0),d=n(10),u=n(30),c=n(9),g=n(38);function f(e,t,n){var r=l.EmptyPivotTableImagePlaceholderThicknessPx,o=(0,s.getLinePixelTranslation)(r);e.lineWidth=r,e.fillStyle=e.strokeStyle=n?(0,s.rgbToColorHex)(n.TextColor):l.EmptyPivotTableTitleContainerBorderColor,e.strokeRect(t.x+o,t.y+o,t.width,t.height)}function h(e,t,n,r){var o=n?(0,s.rgbToColorHex)(n.TextColor):l.EmptyPivotTableTitleTextColor;e.font=(0,d.getFontCssStringFromFont)(t,void 0,r),e.fillStyle=o,e.textBaseline=g.DefaultTextBaseline,e.textAlign="center"}function C(e,t,n){var r=m(e,t,n),o=(0,a.getPivotTableLeftAdjustedForDrawing)(e,t,!1),i=(0,a.getPivotTableTopAdjustedForDrawing)(e,t,!1),s=t.OriginPTWidthAdjustedForDrawing,d=t.OriginPTHeightAdjustedForDrawing,u=r.y+r.height,c=i+d,g=r.width,f=c-u-2*l.EmptyPivotTableImageMinimalPaddingYPx*n,h=Math.min(g,l.EmptyPivotTableImageWidthHeightRatio*f),C=Math.min(f,g/l.EmptyPivotTableImageWidthHeightRatio),p=(u+c)/2;return{x:o+Math.round((s-h)/2),y:Math.round(p-C/2),width:h,height:C}}function m(e,t,n){var r=Math.round(t.OriginPTWidthAdjustedForDrawing*l.EmptyPivotTableTitleContainerWidthRatio);return{x:S(e,t,r),y:y(e,t,n),width:r,height:Math.round(l.EmptyPivotTableTitleContainerHeightPx*n)}}function p(e,t){var n=Math.round(t.OriginPTWidth*l.EmptyPivotTableTitleContainerWidthRatio);return{x:R(e,t,n),y:v(e,t),width:n-l.EmptyPivotTableTitleContainerBorderThicknessPx,height:l.EmptyPivotTableTitleContainerHeightPx-l.EmptyPivotTableTitleContainerBorderThicknessPx}}function y(e,t,n){return(0,a.getPivotTableTopAdjustedForDrawing)(e,t,!1)+Math.round(l.EmptyPivotTableTitleContainerTopPaddingPx*n)}function v(e,t){return e.RowOffsets[t.FirstRowIndex]+t.DeltaYFromOriginPT+l.EmptyPivotTableTitleContainerTopPaddingPx+l.EmptyPivotTableTitleContainerBorderThicknessPx}function S(e,t,n){var r=Math.floor((t.OriginPTWidthAdjustedForDrawing-n)/2);return(0,a.getPivotTableLeftAdjustedForDrawing)(e,t,!1)+r}function R(e,t,n){var r=(t.OriginPTWidth-n)/2+l.EmptyPivotTableTitleContainerBorderThicknessPx;return function(e,t){var n=e.ColumnOffsets;return e.IsRtl?e.BlockWidth-t.DeltaXFromOriginPT-n[t.FirstColIndex]-t.OriginPTWidth:n[t.FirstColIndex]+t.DeltaXFromOriginPT}(e,t)+r}t.drawEmptyPivotTableTitleContainers=function(e,t,n){if((0,r.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableTitleContainers"),(0,r.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableTitleContainers"),(0,r.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableTitleContainers"),t.PivotTables&&0!==t.PivotTables.length){for(var o=Math.max(Math.round(l.EmptyPivotTableTitleContainerBorderThicknessPx*n.scaleFactor),1),d=(0,s.getLinePixelTranslation)(o),u=!1,c=0;c<t.PivotTables.length;c++){var g=t.PivotTables[c];if(g.IsEmptyPivot&&(!(g.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingTitle)&&(0,a.isPivotIntersectsRenderingRegion)(t,g,n.renderingRegion,!1))){u||(e.strokeStyle=n.highContrastScheme?(0,s.rgbToColorHex)(n.highContrastScheme.TextColor):l.EmptyPivotTableTitleContainerBorderColor,e.lineWidth=o,e.setLineDash(i.DefaultDash),e.beginPath(),u=!0);var f=m(t,g,n.scaleFactor);e.rect(d+f.x,d+f.y,f.width,f.height)}}u&&e.stroke()}},t.drawEmptyPivotTableImages=function(e,t,n){if((0,r.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableImages"),(0,r.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableImages"),(0,r.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableImages"),t.PivotTables&&0!==t.PivotTables.length)for(var o=0;o<t.PivotTables.length;o++){var i=t.PivotTables[o];if(i.IsEmptyPivot&&(!(i.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingImage)&&(0,a.isPivotIntersectsRenderingRegion)(t,i,n.renderingRegion,!1))){var s=C(t,i,n.scaleFactor);if(!(s.width<l.EmptyPivotTableMinimalImageWidthPx)){var d=(0,u.getOrLoadStaticImage)(0,n.blockIdentifier);d?e.drawImage(d,s.x,s.y,s.width,s.height):f(e,s,n.highContrastScheme)}}}},t.drawEmptyPivotTableTitleText=function(e,t,n){if((0,r.verifyArgumentNotNull)(t,"model","drawEmptyPivotTableTitleText"),(0,r.verifyArgumentNotNull)(e,"ctx","drawEmptyPivotTableTitleText"),(0,r.verifyArgumentNotNull)(n,"context","drawEmptyPivotTableTitleText"),t.PivotTables&&0!==t.PivotTables.length)for(var i=!1,s=void 0,d=0;d<t.PivotTables.length;d++){var u=t.PivotTables[d];if(u.IsEmptyPivot&&(!(u.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingTitle)&&(0,a.isPivotIntersectsRenderingRegion)(t,u,n.renderingRegion,!1)&&u.PivotTableName)){if(!i){var g=(0,r.getReferencedObjectById)(r.UniqueStyleID.Default,t.Styles);h(e,s=(0,r.getReferencedObjectById)(g.FontID||0,t.Fonts),n.highContrastScheme,t),i=!0}var f=p(t,u),C=f.x+f.width/2,m=(0,c.getTextOffsetYAlphabeticBaseline)(t,f.y+f.height,f.height,s.Size,s.FontName,r.VerticalAlignment.Center);(0,o.applyClipping)(e,f),e.fillText(u.PivotTableName,C,m),(0,o.restoreClipping)(e,f)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawDataBars=void 0;var r=n(1),o=n(6),i=n(2),l=n(192),a=n(3),s=n(0),d=n(7);function u(e,t,n){return function(e,t,n){if(e<0||e>t)throw Error("adjustCellCoordinateIfRtl: coordinate is outside of the data bar bounds.");return n?t-e:e}(Math.round(t*e/100),t,n)}function c(e,t,n,r){if(function(e){return e>0&&e<100}(e))return{X:t+n-(0,s.getLinePixelTranslation)(a.GridLineWidthPx),startY:r.y+a.GridLineWidthPx,endY:r.y+r.height-a.GridLineWidthPx}}function g(e,t,n,r,o){var i=Math.round(t.width*e/100);r&&(i=-i);var a=o&&i<0?l.DataBarAxisWidth:0,s=Math.min(n,n+i),d=t.x+s,u=Math.max(Math.abs(i)-a,0);return{x:d,y:t.y,width:u,height:t.height}}function f(e,t){return t.information.GradientColor?function(e,t){var n=function(e){var t,n=e.bar,r=n.x,o=r+n.width,i=null===(t=e.axis)||void 0===t?void 0:t.X;if((0,d.isNullOrUndefined)(i)?e.isRtl:r<i)return{startX:o,endX:r,Y:n.y};return{startX:r,endX:o,Y:n.y}}(t),r=e.createLinearGradient(n.startX,n.Y,n.endX,n.Y);return r.addColorStop(l.GradientStartingPositing,t.information.Color),r.addColorStop(l.GradientEndingPositing,t.information.GradientColor),r}(e,t):t.information.Color}function h(e,t,n,r){e.lineWidth=t,e.setLineDash(n),e.strokeStyle=r}function C(e,t,n){n!==t&&(e.stroke(),e.beginPath(),e.strokeStyle=t)}function m(e,t){var n=p(l.DataBarHorizontalPadding,t),r=p(l.DataBarTopPadding,t),o=p(l.DataBarBottomPadding,t);return{x:e.x+n+a.GridLineWidthPx,y:e.y+n+a.GridLineWidthPx,width:Math.max(0,e.width-2*n-2*a.GridLineWidthPx),height:Math.max(0,e.height-r-o-2*a.GridLineWidthPx)}}function p(e,t){return Math.max(e,Math.round(e*t))}t.drawDataBars=function(e,t,n){(0,r.verifyArgumentNotNull)(t,"model","drawDataBars"),(0,r.verifyArgumentNotNull)(e,"ctx","drawDataBars"),(0,r.verifyArgumentNotNull)(n,"context","drawDataBars");var a=function(e,t){for(var n,l=e.ClientOnlyCache.CellsToRender,a=[],f=0;f<l.length;f++){var h=l[f];if((0,i.cellIntersectsRenderingRegion)(h,t.renderingRegion)){var C=null===(n=h.CondFormat)||void 0===n?void 0:n.DataBar;if(C&&!(0,s.isCellPreviewTextDefined)(h.PreviewText)&&!h.ShowSkeleton){var p=C.Direction===r.ReadingOrderType.RightToLeft||e.IsRtl&&C.Direction===r.ReadingOrderType.Context,y=(0,o.getCellDimensionsAdjustedForDrawing)(e,h,!1),v=m(y,t.scaleFactor),S=u(C.AxisPostion,v.width,p),R=c(C.AxisPostion,v.x,S,y),F=!(0,d.isNullOrUndefined)(R),w=g(C.Length,v,S,p,F);a.push({information:C,axis:R,bar:w,isRtl:p})}}}return a}(t,n),p=function(e){if((0,d.isNullOrUndefined)(e))return;return"".concat((0,s.rgbToColorHex)(e.TextColor))}(n.highContrastScheme);!function(e,t,n){for(var r,o=!1,a=!(0,d.isNullOrUndefined)(n),s=0;s<t.length;s++){var u=t[s].axis;if(!(0,d.isNullOrUndefined)(u)){if(o||(r=a?n:t[s].information.AxisColor,h(e,l.DataBarAxisWidth,l.DataBarAxisLineDash,r),e.beginPath(),o=!0),!a){var c=t[s].information.AxisColor;C(e,c,r),r=c}(0,i.drawLine)(e,u.X,u.startY,u.X,u.endY)}}o&&e.stroke()}(e,a,p),(0,d.isNullOrUndefined)(p)&&function(e,t){for(var n,r=0;r<t.length;r++){var o=t[r],i=o.bar,l=f(e,o);n!==l&&(e.fillStyle=l,n=l),e.fillRect(i.x,i.y,i.width,i.height)}}(e,a),function(e,t,n){for(var r,o=!1,i=!(0,d.isNullOrUndefined)(n),a=0;a<t.length;a++){var u=t[a].information.BorderColor;if(!(0,d.isNullOrUndefined)(n)||!(0,d.isNullOrUndefined)(u)){var c=(g=t[a].bar,f=void 0,m=void 0,p=void 0,y=void 0,f=g.x+(0,s.getLinePixelTranslation)(l.DataBarBorderWidth),m=g.y+(0,s.getLinePixelTranslation)(l.DataBarBorderWidth),p=Math.max(g.width-l.DataBarBorderWidth,0),y=Math.max(g.height-l.DataBarBorderWidth,0),{x:f,y:m,width:p,height:y});o||(r=i?n:u,h(e,l.DataBarBorderWidth,[],r),e.beginPath(),o=!0),i||(C(e,u,r),r=u),c.width>0&&e.rect(c.x,c.y,c.width,c.height)}}var g,f,m,p,y;o&&e.stroke()}(e,a,p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataBarAxisLineDash=t.GradientEndingPositing=t.GradientStartingPositing=t.DataBarBorderWidth=t.DataBarAxisWidth=t.DataBarBottomPadding=t.DataBarTopPadding=t.DataBarHorizontalPadding=void 0,t.DataBarHorizontalPadding=1,t.DataBarTopPadding=1,t.DataBarBottomPadding=2,t.DataBarAxisWidth=1,t.DataBarBorderWidth=1,t.GradientStartingPositing=0,t.GradientEndingPositing=1,t.DataBarAxisLineDash=[3,1]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawDynamicImages=void 0;var r=n(1),o=n(0),i=n(15),l=n(5),a=n(30),s=n(6),d=n(7),u=n(22),c=n(24),g=n(3),f=n(2),h=n(23),C=n(12),m=n(57);function p(e,t,n,l,d,f,p){var v,S,R,F,w=function(e){switch(e){case a.ImageType.Sparkline:return 0;case a.ImageType.InCellImage:return g.GridLineWidthPx;default:throw Error("marginForImageType: unsupported image type = ".concat(e))}}(p),T=n.scaleFactor,I=T*(null!==(S=null===(v=l.Merge)||void 0===v?void 0:v.OriginDeltaX)&&void 0!==S?S:0),x=T*(null!==(F=null===(R=l.Merge)||void 0===R?void 0:R.OriginDeltaY)&&void 0!==F?F:0),b=0===I?w:0,D=0===x?w:0,A=f.ClusterOffsetX,P=f.ClusterOffsetY,H=function(e,t,n,r,o){var i,l,a=0,d=0;y(o)?(a=null!==(i=o.ClusterImageWidth)&&void 0!==i?i:0,d=null!==(l=o.ClusterImageHeight)&&void 0!==l?l:0):(a=(0,s.getCellWidth)(e,r,!1)-t,d=(0,s.getCellHeight)(e,r,!1)-n);return{imageWidth:a,imageHeight:d}}(t,b,D,l,f),B=function(e,t,n,r,o,i){var l=0,a=0;y(i)?(l=i.Width?i.Width*r-t:0,a=i.Height?i.Height*r-n:0):(l=(0,s.getCellWidthAdjustedForDrawing)(e,o)-t,a=(0,s.getCellHeightAdjustedForDrawing)(e,o)-n);return{imageWidth:l,imageHeight:a}}(t,b,D,T,l,f),M=function(e,t,n,o,l,a,d,u){var c,g,f;if(!y(u))return{left:0,right:0,top:0,bottom:0};var h=!!(null===(c=e.PivotTable)||void 0===c?void 0:c.HasExpandCollapseIndicator),p=h?m.PaddingBetweenExpandCollapseButtonAndTextPx*d:0,v=(0,C.getExpandCollapseButtonWidth)(h)*d,S=(0,s.getCellWidthAdjustedForDrawing)(t,e)-l,R=function(e,t,n,o,i,l,a){var s=0,d=0;if(n<=t+i+o)return{left:s,right:d};var u=n-t-o-i;switch(e){case r.HorizontalAlignment.Right:s=u;break;case r.HorizontalAlignment.Center:s=d=u/2;break;case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:d=n-t-i}l?d+=a?o+i:0:s+=a?o+i:0;return{left:s,right:d}}((0,i.getEffectiveHorizontalAlignment)(t,e),n,S,p,v,t.IsRtl,h),F=(0,s.getCellHeightAdjustedForDrawing)(t,e)-a,w=function(e,t,n){var o=0,i=0;if(t>n)return{top:o,bottom:i};var l=n-t;switch(e){case r.VerticalAlignment.Top:i=l;break;case r.VerticalAlignment.Center:o=i=l/2;break;case r.VerticalAlignment.Bottom:default:o=l}return{top:o,bottom:i}}(null!==(f=null===(g=e.CachedStyle)||void 0===g?void 0:g.VerticalAlignment)&&void 0!==f?f:r.VerticalAlignment.Bottom,o,F);return{left:R.left,right:R.right,top:w.top,bottom:w.bottom}}(l,t,B.imageWidth,B.imageHeight,b,D,T,f),O=(0,s.getCellLeftAdjustedForDrawing)(t,l,!1,!0)-I+M.left,k=(0,s.getCellTopAdjustedForDrawing)(t,l,!0)-x+M.top,L=(0,s.getCellWidthAdjustedForDrawing)(t,l)-b-M.right,N=(0,s.getCellHeightAdjustedForDrawing)(t,l)-D-M.bottom,E={x:O,y:k,width:L,height:N},z=function(e,t,n,r,o,i,l){if(!y(l))return{clusterImageWidth:e,clusterImageHeight:t,imageWidth:n,imageHeight:r};if(o<n){e*=1-(n-o)/n,n=o}if(i<r){t*=1-(r-i)/r,r=i}return{clusterImageWidth:e,clusterImageHeight:t,imageWidth:n,imageHeight:r}}(H.imageWidth,H.imageHeight,B.imageWidth,B.imageHeight,L,N,f);e.drawImage(d,A,P,z.clusterImageWidth,z.clusterImageHeight,O,k,z.imageWidth,z.imageHeight),function(e,t,n,i){if(!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.ShowDynamicImageCardOnHover,e))return;var l=(0,r.getRenderingRegionHitTestCache)(e,(0,o.getRenderingRegionKey)(n.renderingRegion)),a=(0,h.getUnadjustedHitRegionFromRect)(e,n,i,e.IsRtl);(0,u.registerCursorHitRegion)(t,l,a,c.DefaultCursorType,r.RenderFeaturesZIndex.DynamicImage);var s=(0,h.createDynamicImageCallback)(e,t,!0,!0),d=(0,h.createDynamicImageCallback)(e,t,!1,!1);(0,u.registerHitRegion)(t,l,a,r.RenderFeaturesZIndex.DynamicImage,s,"mouseenter"),(0,u.registerHitRegion)(t,l,a,r.RenderFeaturesZIndex.DynamicImage,d,"mouseleave")}(t,l,n,E)}function y(e){return!!(e.ClusterImageWidth&&e.ClusterImageHeight&&e.Width&&e.Height)}t.drawDynamicImages=function(e,t,n,r){(0,l.verifyArgumentNotNull)(e,"ctx","drawDynamicImages"),(0,l.verifyArgumentNotNull)(t,"model","drawDynamicImages"),(0,l.verifyArgumentNotNull)(n,"context","drawDynamicImages");var i=(0,o.getDynamicImages)(t,r);if(!(0,d.isNullOrUndefined)(i)){var s=t.ClientOnlyCache.CellsToRender,u=(0,a.getOrLoadVersionedImage)(r,i.Version,i.ImageUrl,n.blockIdentifier,n.blockIdentifier);if(u)for(var c=0;c<s.length;c++){var g=s[c];if((0,f.cellIntersectsRenderingRegion)(g,n.renderingRegion)){var h=(0,o.getDynamicImageInformationFromCell)(g,r);(0,d.isNullOrUndefined)(h)||n.isFormulaView&&!(0,d.isNullOrUndefined)(g.FormulaInfo)||(0,o.isCellPreviewTextDefined)(g.PreviewText)||g.ShowSkeleton||p(e,t,n,g,u,h,r)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinusPlusLineAdjustment=t.MinusPlusWidthPx=t.MinusPlusPaddingPx=void 0,t.MinusPlusPaddingPx=1,t.MinusPlusWidthPx=1,t.MinusPlusLineAdjustment=.5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSortDownChevronDownIcon=t.drawSortUpChevronDownIcon=t.drawSortUpFilterIcon=t.drawSortDownFilterIcon=t.drawFilterDownChevronIcon=t.drawDownChevronIcon=void 0;var r=n(0),o=n(46);function i(e,t,n){var r=t.left,i=t.bottom-t.height;e.beginPath(),a(e,r,i,n,!0,t),s(e,t,o.MiniChevronPoints),e.stroke()}function l(e,t,n){var r=t.left,i=t.bottom-t.height;e.beginPath(),s(e,t,o.FilterPoints),a(e,r,i,n,!1,t),e.stroke()}function a(e,t,n,i,l,a){var s=a.width,c=l?o.RightArrowPosition:o.LeftArrowPosition,g=(0,r.getLinePixelTranslation)(o.AutoFilterLineWidthPx),f=d(t,c.x,g,s),h=d(n,i?c.y+o.ArrowLengthPx:c.y,g,s),C=u(h,i?-o.ArrowLengthPx:o.ArrowLengthPx,s),m=u(f,-1,s),p=u(f,1,s),y=u(C,i?1:-1,s);e.moveTo(f,h),e.lineTo(f,C),e.moveTo(m,y),e.lineTo(p,y)}function s(e,t,n){if(n&&0!==n.length){var i=t.left,l=t.bottom-t.height,a=n[0],s=(0,r.getLinePixelTranslation)(o.AutoFilterLineWidthPx);e.moveTo(d(i,a.x,s,t.width),d(l,a.y,s,t.width));for(var u=1;u<n.length;u++){var c=n[u];e.lineTo(d(i,c.x,s,t.width),d(l,c.y,s,t.width))}}}function d(e,t,n,r){return Math.round(u(e,t,r))+n}function u(e,t,n){return e+t/o.AutoFilterIconRectPx*n}t.drawDownChevronIcon=function(e,t){e.beginPath(),s(e,t,o.ChevronPoints),e.stroke()},t.drawFilterDownChevronIcon=function(e,t){e.beginPath(),s(e,t,o.MiniChevronPoints),s(e,t,o.FilterPoints),e.stroke()},t.drawSortDownFilterIcon=function(e,t){l(e,t,!1)},t.drawSortUpFilterIcon=function(e,t){l(e,t,!0)},t.drawSortUpChevronDownIcon=function(e,t){i(e,t,!0)},t.drawSortDownChevronDownIcon=function(e,t){i(e,t,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawComments=void 0;var r=n(1),o=n(17),i=n(2),l=n(6),a=n(0),s=n(127),d=n(197),u=n(48),c=n(60),g=n(22),f=n(23),h=n(92),C=n(24);function m(e,t,n,r,o){for(var i=!1,l=t.ClientOnlyCache.CellsToRender,a=0;a<l.length;a++){var u=l[a];if(u.Comment&&u.Comment.IsThreadedComment){if(o&&!!u.Comment.IsResolved!==r)continue;if(!p(u,n.renderingRegion))continue;var c=(0,d.getThreadedCommentNotchSize)(t,u,n.devicePixelRatio,n.zoom);if(c<s.MinCommentIconSizePx)continue;i||(i=!0,e.fillStyle=S(n.highContrastScheme,r),e.beginPath()),y(e,t,u,n,c,v)}}i&&e.fill()}function p(e,t){return!((0,r.isChangeGateEnabled)(r.ChangeGate.HideCommentIndicators)&&e.Comment.IsThreadedComment&&e.Comment.HideCommentIndicator)&&!!(0,i.cellIntersectsRenderingRegion)(e,t)}function y(e,t,n,o,i,u,c){var h=function(e,t,n,r,o){var i=function(e,t,n,r,o){var i=(0,d.shouldAddFilterPaddingToComment)(e,t,n,r,o)?(0,d.getFilterWithCommentPadding)(e,t,r,o):0;return(0,l.getCellRightAdjustedForDrawing)(e,t,e.IsRtl)-(n+i)}(e,t,n,r,o),a=function(e,t,n){return(0,l.getCellTopAdjustedForDrawing)(e,t,!1)+n}(e,t,n);return{left:i,bottom:a,width:n,height:n,outerColor:void 0,innerColor:void 0}}(t,n,i,o.devicePixelRatio,o.zoom);u(e,h,c),function(e,t,n,o){var i=(0,r.getRenderingRegionHitTestCache)(e,(0,a.getRenderingRegionKey)(n.renderingRegion)),u=o.width,c=Math.min((0,l.getCellWidthAdjustedForDrawing)(e,t),(0,l.getCellHeightAdjustedForDrawing)(e,t),u*s.CommentHitRegionProportionConstant),h={x:(0,d.getCommentHitRegionLeft)(e,t,o.left,o.width,c),y:o.bottom-o.height,width:c,height:c},m=(0,f.getUnadjustedHitRegionFromRect)(e,n,h,e.IsRtl),p=(0,f.createCommentsCallback)(e,t,!0,!0),y=(0,f.createCommentsCallback)(e,t,!1,!1);(0,g.registerCursorHitRegion)(t,i,m,C.DefaultCursorType,r.RenderFeaturesZIndex.Comments),(0,g.registerHitRegion)(t,i,m,r.RenderFeaturesZIndex.Comments,p,"mouseenter"),(0,g.registerHitRegion)(t,i,m,r.RenderFeaturesZIndex.Comments,y,"mouseleave")}(t,n,o,h)}function v(e,t){var n=t.left,r=t.bottom,o=t.width,i=t.height,l=function(e,t,n,r){return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+r},{x:e+n/2,y:t+r/2},{x:e,y:t+r/2},{x:e,y:t}]}(n,r-i,o,i);(0,u.createShapePath)(e,l)}function S(e,t){return e?t?(0,a.rgbToColorHex)(e.LinkColor):(0,a.rgbToColorHex)(e.TextColor):t?s.ResolvedThreadedCommentColor:s.ActiveThreadedCommentColor}t.drawComments=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","drawComments"),(0,r.verifyArgumentNotNull)(t,"model","drawComments"),(0,r.verifyArgumentNotNull)(n,"context","drawComments"),function(e,t,n){for(var r=!1,o=t.ClientOnlyCache.CellsToRender,i=0;i<o.length;i++){var l=o[i];if(l.Comment&&!l.Comment.IsThreadedComment){if(!p(l,n.renderingRegion))continue;var u=(0,d.getLegacyCommentNotchSize)(t,l,s.LegacyCommentSizePx,n.devicePixelRatio,n.zoom);if(u<s.MinCommentIconSizePx)continue;r||(r=!0,e.fillStyle=(g=n.highContrastScheme)?(0,a.rgbToColorHex)(g.TextColor):s.LegacyCommentColor,e.beginPath()),y(e,t,l,n,u,c.createTrianglePathOnCellCorner,h.Position.Right)}}var g;r&&e.fill()}(e,t,n);var i=(0,o.getBooleanFeatureGate)("Microsoft.Office.Excel.GreyOutResolvedCommentIndicators",!1);m(e,t,n,!1,i),i&&m(e,t,n,!0,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCommentHitRegionLeft=t.shouldAddFilterPaddingToComment=t.getCommentNotchSizeWithFilter=t.getLegacyCommentNotchSize=t.getThreadedCommentNotchSize=t.getFilterWithCommentPadding=void 0;var r=n(6),o=n(127),i=n(2),l=n(18),a=n(46),s=n(23),d=n(60);function u(e,t,n,r){var i=a.AutoFilterHorizontalPaddingPx+o.CommentWithFilterPaddingPx;return(0,l.getFilterSizeAdjustedForDrawing)(e,t,n,r)+Math.round(i*n*r)}function c(e,t,n,o,l){var a=u(e,t,o,l),s=(0,i.getDefaultBorderLineWidth)(l*o),d=(0,r.getCellWidthAdjustedForDrawing)(e,t)-s-a;return Math.min(n,d)}function g(e,t,n,o,i){var a,s;if(!t.Comment)return!1;var d=(0,r.getCellTopAdjustedForDrawing)(e,t,!1);if(t.AutoFilter&&!(null===(a=t.AutoFilter.RenderingContext)||void 0===a?void 0:a.IsHidden)||(null===(s=t.PivotFilter)||void 0===s?void 0:s.DisplayFilter)){var u=(0,l.getFilterSizeAdjustedForDrawing)(e,t,o,i);if((0,l.getFilterBottomAdjustedForDrawing)(e,t,u,o,i)-u-n<d)return!0}return!1}t.getFilterWithCommentPadding=u,t.getThreadedCommentNotchSize=function(e,t,n,r){var i=(0,s.getInteractiveIconMaxSizeAdjustedForDrawing)(o.ThreadedCommentSizePx,e,t,n,r,!0,!0);return g(e,t,i,n,r)&&(i=c(e,t,i,n,r)),i%2==1?i-1:i},t.getLegacyCommentNotchSize=function(e,t,n,r,o){var i=(0,d.getRightAngledTriangleSize)(e,t,n,r,o);return g(e,t,i,r,o)&&(i=c(e,t,i,r,o)),i},t.getCommentNotchSizeWithFilter=c,t.shouldAddFilterPaddingToComment=g,t.getCommentHitRegionLeft=function(e,t,n,o,i){var l=(0,r.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1),a=(0,r.getCellRightAdjustedForDrawing)(e,t,e.IsRtl),s=n+o-i,d=n+i;return(l>s||d>a)&&l-s>=d-a?n:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRichError=void 0;var r=n(1),o=n(22),i=n(6),l=n(3),a=n(92),s=n(2),d=n(60),u=n(199),c=n(23),g=n(0),f=n(24);function h(e,t,n,l){var a=(0,r.getRenderingRegionHitTestCache)(e,(0,g.getRenderingRegionKey)(n.renderingRegion)),s=Math.min((0,i.getCellWidthAdjustedForDrawing)(e,t),(0,i.getCellHeightAdjustedForDrawing)(e,t),u.RichErrorHitRegionMaxSizePx*n.scaleFactor),d={x:l.left,y:l.bottom-l.height,width:s,height:s},h=(0,c.getUnadjustedHitRegionFromRect)(e,n,d,e.IsRtl),C=(0,c.createRichErrorCallback)(e,t,e.RibbonCommands.CardViewShowTemporaryErrorCard,!0),m=(0,c.createRichErrorCallback)(e,t,e.RibbonCommands.CardViewHideTemporaryCard,!1);(0,o.registerCursorHitRegion)(t,a,h,f.DefaultCursorType,r.RenderFeaturesZIndex.RichError),(0,o.registerHitRegion)(t,a,h,r.RenderFeaturesZIndex.RichError,C,"mouseenter"),(0,o.registerHitRegion)(t,a,h,r.RenderFeaturesZIndex.RichError,m,"mouseleave")}function C(e,t){return!!e.HasIgnorableError&&!!(0,s.cellIntersectsRenderingRegion)(e,t.renderingRegion)}function m(e,t,n){return{left:(0,i.getCellLeftAdjustedForDrawing)(e,t,e.IsRtl,!1),bottom:(0,i.getCellTopAdjustedForDrawing)(e,t,!1)+n,width:n,height:n,outerColor:void 0,innerColor:void 0}}t.drawRichError=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","drawErrorNotch"),(0,r.verifyArgumentNotNull)(t,"model","drawErrorNotch"),(0,r.verifyArgumentNotNull)(n,"context","drawErrorNotch");for(var o=!1,i=!1,s=t.ClientOnlyCache.CellsToRender,c=0;c<s.length;c++){var f=s[c];if(C(f,n)){o||(i=!!t.RibbonCommands,(0,r.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","RowNumbers"),(0,r.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","ColumnNumbers"),e.setLineDash(l.DefaultDash),e.beginPath(),o=!0);var p=m(t,f,(0,d.getRightAngledTriangleSize)(t,f,u.RichErrorTriangleSizePx,n.devicePixelRatio,n.zoom));(0,d.createTrianglePathOnCellCorner)(e,p,a.Position.Left),i&&h(t,f,n,p)}}o&&(e.fillStyle=n.highContrastScheme?(0,g.rgbToColorHex)(n.highContrastScheme.TextColor):u.RichErrorColor,e.fill())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichErrorHitRegionMaxSizePx=t.RichErrorTriangleSizePx=t.RichErrorColor=void 0,t.RichErrorColor="#156712",t.RichErrorTriangleSizePx=8,t.RichErrorHitRegionMaxSizePx=25},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRichValueIcons=void 0;var r=n(1),o=n(11),i=n(59),l=n(0),a=n(10),s=n(24),d=n(22),u=n(6),c=n(91),g=n(30),f=n(2),h=n(23),C=n(66),m=n(46),p=n(48),y=n(3),v=n(47),S=n(94),R=n(18),F=n(12),w=n(57),T=n(9),I=n(15),x=n(125);function b(e,t){return!!e.RichValueIcon&&(!!(0,f.cellIntersectsRenderingRegion)(e,t.renderingRegion)&&(!e.DisplayFormula&&((!(0,r.isChangeGateEnabled)(r.ChangeGate.DontShowRichValueIconForSpilledArrayFormulasInFormulaView)||!(0,f.isArrayFormulaChildInFormulaView)(e,t))&&(!(0,l.isCellPreviewTextDefined)(e.PreviewText)&&!e.ShowSkeleton))))}function D(e,t,n,a,u){n.RichValueIcon.Type===r.RichValueIconType.LinkedEntity?function(e,t,n){if(!t.RichValueIcon.Unicode)throw Error("drawUnicodeIcon: RichValueIconInformation does not have a char code value.");var r=String.fromCharCode(t.RichValueIcon.Unicode);!function(e,t,n){var r=n.x,o=n.y,i=n.height,l=o+i;e.fillText(t,r,l)}(e,r,n)}(e,n,u):function(e,t,n,o){var i=t.RichValueIcon.Type===r.RichValueIconType.Disambiguation?1:2,l=(0,g.getOrLoadStaticImage)(i,n.blockIdentifier);l&&e.drawImage(l,o.x,o.y,o.width,o.height)}(e,n,a,u),function(e,t,n,a){var u,c=a.y+a.height;if((0,p.shouldClipHorizontally)(e,t,a.x,a.width,!1)||(0,p.shouldClipVertically)(e,t,c,a.width)){var g=(0,p.getClippedDrawingContext)(e,t,n,a);u=(0,h.getUnadjustedHitRegionFromRect)(e,n,g,!1)}else u=(0,h.getUnadjustedHitRegionFromRect)(e,n,a,!1);var f=(0,r.getRenderingRegionHitTestCache)(e,(0,l.getRenderingRegionKey)(n.renderingRegion)),C=function(e){var t,n=e.RichValueIcon.Type;n===r.RichValueIconType.Disambiguation?t=i.gridRendererStrings.richValueIconDisambigTooltip:n!==r.RichValueIconType.Sync&&(t=i.gridRendererStrings.richValueIconShowCard);return t}(t),m=function(t){return(0,o.handleRibbonCommand)(t,e.RibbonCommands.CardViewShowDataCardOrDisambiguationPane,""),!0};(0,d.registerCursorHitRegion)(t,f,u,s.PointerCursorType,r.RenderFeaturesZIndex.RichValueIcon),(0,d.registerHitRegion)(t,f,u,r.RenderFeaturesZIndex.RichValueIcon,(function(e){return{handled:!0,stopPropagation:!1}}),"pointerdown"),(0,d.registerHitRegion)(t,f,u,r.RenderFeaturesZIndex.RichValueIcon,m,"click"),(0,d.registerHitRegion)(t,f,u,r.RenderFeaturesZIndex.RichValueIcon,s.TouchCallback,"touchstart"),(0,d.registerHitRegion)(t,f,u,r.RenderFeaturesZIndex.RichValueIcon,s.EmptyFalseCallback,"touchend"),C&&(0,d.registerTooltipHitRegion)(t,f,u,C,r.RenderFeaturesZIndex.RichValueIcon)}(t,n,a,u)}function A(e,t,n,o,i){var l=Math.round(i*o.scaleFactor),s=0;if(function(e,t){if(e.PivotTable)return!0;if(t.PivotTables&&t.PivotTables.length>0)for(var n=0;n<t.PivotTables.length;n++){var r=t.PivotTables[n];if(!r.IsEmptyPivot&&!r.IsOlap&&e.Row>=r.FirstRowIndex&&e.Row<=r.LastRowIndex&&e.Col>=r.FirstColIndex&&e.Col<=r.LastColIndex)return!0}return!1}(n,t))s=function(e,t,n,o,i){var l,s=(0,S.shouldDrawAutoFilter)(n,o),d=t.IsRtl&&s?(0,R.getAutoFilterButtonPadding)(t,n,o.zoom,o.devicePixelRatio):0,c=d+C.RichValueIconLeftHorizontalPadding+(0,u.getCellLeftAdjustedForDrawing)(t,n,!1,!1),g=c,f=(0,I.getEffectiveHorizontalAlignment)(t,n),h=0;(null===(l=n.PivotTable)||void 0===l?void 0:l.HasExpandCollapseIndicator)&&(h=Math.round((0,F.getExpandCollapseButtonPadding)(n)*o.scaleFactor),t.IsRtl||f===r.HorizontalAlignment.Left||(c+=h));var m=n.CachedIndent||w.NoIndent,p=Math.round((0,T.getCellHorizontalIndentationPaddingPx)(n,m)*o.scaleFactor),y=(0,T.getTextHorizontalPosition)(t,n,o)*o.scaleFactor,v=e.font;e.font=(0,a.getFontCssStringFromFont)(n.CachedFont,void 0,t);var b=(0,x.getTextWidthAdjustedForDrawing)(e,t,n,o.scaleFactor);e.font!==v&&(e.font=v);var D=(i+C.RichValueIconRightHorizontalPadding)*o.scaleFactor;switch(f){case r.HorizontalAlignment.Left:g=t.IsRtl?Math.max(Math.floor(y-D),c):Math.floor(d+h+w.PaddingBetweenExpandCollapseButtonAndTextPx*o.scaleFactor+p+(0,u.getCellLeftAdjustedForDrawing)(t,n,!1,!1));break;case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:t.IsRtl,g=Math.max(Math.floor(y-b/2-D),c);break;case r.HorizontalAlignment.Right:g=t.IsRtl?Math.max(Math.floor((0,u.getCellRightAdjustedForDrawing)(t,n,!1)-p-w.PaddingBetweenExpandCollapseButtonAndTextPx*o.scaleFactor-h-b-D),c):Math.max(Math.floor(y-b-D),c);break;default:throw Error("getRichValueIconDrawingContext: unsupported horizontalAlignment: ".concat(f))}return g}(e,t,n,o,i);else{var d=(0,S.shouldDrawAutoFilter)(n,o),g=(0,r.isChangeGateEnabled)(r.ChangeGate.RichIconFilterScale)?o.zoom:o.devicePixelRatio,f=(0,r.isChangeGateEnabled)(r.ChangeGate.RichIconFilterScale)?o.devicePixelRatio:o.zoom,h=(0,r.isChangeGateEnabled)(r.ChangeGate.RichIconFilterScale)?o.scaleFactor:1;s=(t.IsRtl&&d?(0,R.getFilterSizeAdjustedForDrawing)(t,n,f,g)+Math.round((m.AutoFilterTextHorizontalPaddingPx+C.RichValueIconLeftHorizontalPadding)*h):C.RichValueIconLeftHorizontalPadding)+(0,u.getCellLeftAdjustedForDrawing)(t,n,!1,!1)}return{x:s,y:function(e,t,n,o){var i,l=(0,v.getEffectiveVerticalAlignment)((0,c.getVerticalAlignmentForIcons)(e,t),v.AdvVerticalAlignmentFormat.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),a=(0,c.getIconBottomWhenAlignedWithMiddleBaseline)(e,t,n,o,l);if((0,r.isChangeGateEnabled)(r.ChangeGate.CellIconBottomPadding))i=Math.round(o*y.CellIconBottomSizeRatioPadding);else{var s=t.RichValueIcon.Type!==r.RichValueIconType.LinkedEntity;i=s?Math.round(o*y.CellIconBottomSizeRatioPadding):0}switch(l){case r.VerticalAlignment.Bottom:case r.VerticalAlignment.Top:return a-i;case r.VerticalAlignment.Center:return(0,c.isIconOutOfCellVerticalBoundaries)(e,t,a,o)?Math.floor((0,u.getCellCenterYAdjustedForDrawing)(e,t)+o/2):a-i;default:throw Error("getIconVerticalPosition: Vertical alignment ".concat(l," is not supported in RV Icon!"))}}(t,n,o.scaleFactor,l)-l,width:l,height:l}}function P(e,t,n,r){var o,i;if(!n.highContrastScheme){var l=null!==(i=null===(o=t.CachedFont)||void 0===o?void 0:o.Color)&&void 0!==i?i:"";e.fillStyle!==l&&(e.fillStyle=l)}var a,s=(a=r.width,"".concat(a,"px ").concat(y.CellFontUnicodeFontFamily));e.font!==s&&(e.font=s)}t.drawRichValueIcons=function(e,t,n){var o;(0,r.verifyArgumentNotNull)(e,"ctx","drawRichValueIcons"),(0,r.verifyArgumentNotNull)(t,"model","drawRichValueIcons"),(0,r.verifyArgumentNotNull)(n,"context","drawRichValueIcons");var i=t.ClientOnlyCache.CellsToRender;!function(e,t){var n=t.highContrastScheme;e.fillStyle=n?(0,l.rgbToColorHex)(n.TextColor):y.DefaultCellFontColor,e.textAlign="left",e.textBaseline="alphabetic"}(e,n);for(var a=0;a<i.length;a++){var s=i[a];if(b(s,n)){var d=A(e,t,s,n,s.RichValueIcon.Width),u=d.x,c=d.y,g=d.width,h=c+g,C=(0,p.getClipRect)(t,s,u,h,g,!0);(null===(o=s.RichValueIcon)||void 0===o?void 0:o.Type)===r.RichValueIconType.LinkedEntity&&P(e,s,n,d),C&&(0,f.applyClipping)(e,C),D(e,t,s,n,d),C&&(0,f.restoreClipping)(e,C)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCellsGeneralTooltip=void 0;var r=n(1),o=n(59),i=n(0),l=n(22),a=n(6),s=n(12),d=n(2);function u(e,t){return!!(0,d.cellIntersectsRenderingRegion)(e,t.renderingRegion)&&(!(0,i.isCellPreviewTextDefined)(e.PreviewText)&&(!e.ShowSkeleton&&!(!e.HasError&&!(0,s.cellTextReplacedWithHashes)(e))))}function c(e,t,n){var d=(0,r.getRenderingRegionHitTestCache)(e,(0,i.getRenderingRegionKey)(t.renderingRegion)),u=(0,a.getCellWidthAdjustedForDrawing)(e,n),c=(0,a.getCellHeightAdjustedForDrawing)(e,n),g=e.IsRtl,f={x:(0,a.getCellLeftAdjustedForDrawing)(e,n,g,!1),y:(0,a.getCellTopAdjustedForDrawing)(e,n,!1),width:u,height:c},h={isMirrored:g,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:f,isRtl:g,blockWidth:e.BlockWidth};(0,l.registerTooltipHitRegion)(n,d,h,function(e){if((0,r.verifyArgumentNotNull)(o.gridRendererStrings,"gridRendererStrings","getGeneralTooltipStringForCell"),e.HasError)return o.gridRendererStrings.formulaErrorTooltip;if((0,s.cellTextReplacedWithHashes)(e))return e.OriginalText;throw"getGeneralTooltipStringForCell: unexpected tooltip string"}(n),r.RenderFeaturesZIndex.GeneralCellTooltip)}t.registerCellsGeneralTooltip=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","registerCellsTooltip"),(0,r.verifyArgumentNotNull)(t,"model","registerCellsTooltip"),(0,r.verifyArgumentNotNull)(n,"context","registerCellsTooltip");for(var o=t.ClientOnlyCache.CellsToRender,i=0;i<o.length;i++){var l=o[i];u(l,n)&&c(t,n,l)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTableSelectors=void 0;var r=n(1),o=n(0),i=n(11),l=n(22),a=n(6),s=n(2),d=n(23),u=n(27),c=n(95),g=n(203),f=n(24);function h(e,t){return!(!e.TableColHeader&&!e.TableRowHeader)&&!!(0,s.cellIntersectsRenderingRegion)(e,t.renderingRegion)}function C(e,t,n,r){n.TableColHeader&&n.TableRowHeader&&m(e,t,n,r,2),n.TableColHeader&&m(e,t,n,r,0),n.TableRowHeader&&m(e,t,n,r,1)}function m(e,t,n,s,h){var C=function(e,t,n,r){var o=(0,a.getCellLeftAdjustedForDrawing)(e,n,e.IsRtl,!1),i=(0,a.getCellWidthAdjustedForDrawing)(e,n),l=(0,a.getCellTopAdjustedForDrawing)(e,n,!1),s=(0,a.getCellHeightAdjustedForDrawing)(e,n),d=Math.min(g.MaxColumnSelectorHeight,s*g.ColumnSelectorScalingFactor*t.scaleFactor),u=Math.min(g.MaxRowSelectorWidth,i*g.RowSelectorScalingFactor*t.scaleFactor);switch(r){case 0:return{x:o,y:l,width:i,height:d};case 1:return{x:o,y:l,width:u,height:s};case 2:return{x:o,y:l,width:u,height:d};default:throw Error("getTableSelectorRectInfo: unsupported selector type for table selector event: ".concat(r))}}(t,s,n,h);s.debugMode&&function(e,t){var n={outerColor:"#00FF00",innerColor:"",left:t.x,bottom:t.y+t.height,width:t.width,height:t.height};(0,u.drawRectangle)(e,n)}(e,C);var m=(0,d.getUnadjustedHitRegionFromRect)(t,s,C,t.IsRtl),p=(0,r.getRenderingRegionHitTestCache)(t,(0,o.getRenderingRegionKey)(s.renderingRegion)),y=function(e,t){switch(e){case 0:return{cursor:c.gridRendererCustomCursors.columnSelectCursor,zIndex:r.RenderFeaturesZIndex.ColumnOrRowSelector};case 1:return t?{cursor:c.gridRendererCustomCursors.rowSelectRTLCursor,zIndex:r.RenderFeaturesZIndex.ColumnOrRowSelector}:{cursor:c.gridRendererCustomCursors.rowSelectLTRCursor,zIndex:r.RenderFeaturesZIndex.ColumnOrRowSelector};case 2:return t?{cursor:c.gridRendererCustomCursors.tableSelectRTLCursor,zIndex:r.RenderFeaturesZIndex.TableSelector}:{cursor:c.gridRendererCustomCursors.tableSelectLTRCursor,zIndex:r.RenderFeaturesZIndex.TableSelector};default:throw Error("getCursorAndZIndex: unsupported selector type for table selector event: ".concat(e))}}(h,t.IsRtl),v=y.cursor,S=y.zIndex;(0,l.registerCursorHitRegion)(n,p,m,v,S),(0,r.isChangeGateEnabled)(r.ChangeGate.TableSelectionDragSelection)?((0,l.registerHitRegion)(n,p,m,S,(function(e){var r=t.RowNumbers[n.Row],o=t.ColumnNumbers[n.Col];return(0,i.tableSelectorsCallback)(e,r,o,h),2===h}),"pointerdown"),2===h&&(0,l.registerHitRegion)(n,p,m,S,f.EmptyTrueCallback,"pointerup")):((0,l.registerHitRegion)(n,p,m,S,(function(e){var r=t.RowNumbers[n.Row],o=t.ColumnNumbers[n.Col];return(0,i.tableSelectorsCallback)(e,r,o,h),!0}),"click"),(0,l.registerHitRegion)(n,p,m,S,f.EmptyTrueCallback,"pointerdown")),(0,l.registerHitRegion)(n,p,m,S,f.EmptyTrueCallback,"dblclick")}t.registerTableSelectors=function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","registerTableSelectors"),(0,r.verifyArgumentNotNull)(t,"model","registerTableSelectors"),(0,r.verifyArgumentNotNull)(n,"context","registerTableSelectors"),(0,r.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","registerTableSelectors"),(0,r.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","registerTableSelectors");for(var o=t.ClientOnlyCache.CellsToRender,i=0;i<o.length;i++){var l=o[i];h(l,n)&&C(e,t,l,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxRowSelectorWidth=t.MaxColumnSelectorHeight=t.DPI=t.RowSelectorScalingFactor=t.ColumnSelectorScalingFactor=void 0,t.ColumnSelectorScalingFactor=.25,t.RowSelectorScalingFactor=.25,t.DPI=96,t.MaxColumnSelectorHeight=t.DPI*t.ColumnSelectorScalingFactor,t.MaxRowSelectorWidth=t.DPI*t.RowSelectorScalingFactor},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPreviewModeOverlay=void 0;var r=n(1),o=n(0),i=n(2),l=n(205);t.drawPreviewModeOverlay=function(e,t,n){var a,s=(0,o.getPreviewCellsRange)(e);if(n.isCellsPreviewMode&&s){var d=e.RowNumbers[0],u=e.ColumnNumbers[0];if(function(e,t,n,o){if((0,r.verifyArgumentNotNull)(e,"previewRange","isOverlayIntersectsRenderingRegion"),(0,r.verifyArgumentNotNull)(t,"renderingRegion","isOverlayIntersectsRenderingRegion"),e.LastRow<t.startRow+n)return!1;if(e.FirstRow>t.endRow+n)return!1;if(e.FirstColumn<t.startColumn+o)return!1;if(e.LastColumn>t.endColumn+o)return!1;return!0}(s,n.renderingRegion,d,u)){var c=function(e,t){var n=(0,o.getPreviewCellsRange)(e),r=function(e,t){if(t.FirstRow<e.RowNumbers[0])return-100;var n=(0,o.getModelRowIndex)(e,t.FirstRow);n<0&&(n=~n);return e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n]}(e,n),l=function(e,t,n){if(t.LastRow>e.RowNumbers[e.RowNumbers.length-1])return(0,i.getBlockDimensionsAdjustedForDrawing)(e.BlockHeight,n)+100;var r=(0,o.getModelRowIndex)(e,t.LastRow);r<0&&(r=~r-1);var l=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;return l[r]+(0,i.getRowHeightFromOffsets)(r,l)}(e,n,t.scaleFactor),a=function(e,t){if(t.FirstColumn<e.ColumnNumbers[0])return-100;var n=(0,o.getModelColumnIndex)(e,t.FirstColumn);n<0&&(n=~n);return e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[n]}(e,n),s=function(e,t,n){if(t.LastColumn>e.ColumnNumbers[e.ColumnNumbers.length-1])return(0,i.getBlockDimensionsAdjustedForDrawing)(e.BlockWidth,n)+100;var r=(0,o.getModelColumnIndex)(e,t.LastColumn);r<0&&(r=~r-1);var l=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return l[r]+(0,i.getColWidthFromOffsets)(r,l)}(e,n,t.scaleFactor);return{x:a,y:r,width:s-a,height:l-r}}(e,n),g=n.highContrastScheme;g||(t.fillStyle=l.PreviewStyleBackgroundColor,t.globalAlpha=(0,r.isChangeGateEnabled)(r.ChangeGate.PreviewCellsSettings)&&(null===(a=e.ClientOnlyCache.PreviewCellsSettings)||void 0===a?void 0:a.RetainCellTextOnPreview)?l.PreviewBackgroundGlobalAlphaRetainUserContent:l.PreviewBackgroundGlobalAlpha,t.fillRect(c.x,c.y,c.width,c.height),t.globalAlpha=l.PreviewBorderGlobalAlpha,t.shadowColor=l.PreviewBorderShadowColor,t.shadowBlur=l.PreviewBorderShadowBlur,t.shadowOffsetY=l.PreviewBorderShadowOffsetY),t.strokeStyle=g?(0,o.rgbToColorHex)(g.TextColor):l.PreviewBorderColor,t.lineWidth=g?l.PreviewBorderHighContrastWidthPx:l.PreviewBorderWidthPx,t.strokeRect(c.x,c.y,c.width,c.height),t.globalAlpha=1,t.shadowColor="transparent"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewBorderHighContrastWidthPx=t.PreviewBorderWidthPx=t.PreviewBorderShadowOffsetY=t.PreviewBorderShadowBlur=t.PreviewBorderShadowColor=t.PreviewBorderGlobalAlpha=t.PreviewBorderColor=t.PreviewBackgroundGlobalAlphaRetainUserContent=t.PreviewBackgroundGlobalAlpha=t.PreviewStyleBackgroundColor=void 0,t.PreviewStyleBackgroundColor="#edebe9",t.PreviewBackgroundGlobalAlpha=.4,t.PreviewBackgroundGlobalAlphaRetainUserContent=.1,t.PreviewBorderColor="#000000",t.PreviewBorderGlobalAlpha=.35,t.PreviewBorderShadowColor="#000000",t.PreviewBorderShadowBlur=4,t.PreviewBorderShadowOffsetY=4,t.PreviewBorderWidthPx=1,t.PreviewBorderHighContrastWidthPx=3},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPolyFills=void 0;var r=n(207),o=n(208),i=n(209),l=n(210),a=n(211),s=n(212),d=n(213),u=n(214),c=n(215),g=!1;t.loadPolyFills=function(e){g||((0,r.loadStringRepeat)(),(0,o.loadStringTrimRight)(),(0,i.loadStringStartsWith)(),(0,l.loadStringEndsWith)(),(0,d.loadGetLineDash)(e),(0,a.loadSetLineDash)(e),(0,s.loadStringCodeAtPoint)(),(0,u.loadArrayMap)(),(0,c.loadDateNow)(),g=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringRepeat=void 0;var r=n(7);t.loadStringRepeat=function(){String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this,n=0;if((0,r.isNullOrUndefined)(e)&&(n=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(n=Math.floor(e),0===t.length||0===n)return"";if(t.length*n>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var o=t.length*n;for(n=Math.floor(Math.log(n)/Math.log(2));n;)t+=t,n--;return t+=t.substring(0,o-t.length)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringTrimRight=void 0,t.loadStringTrimRight=function(){var e=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(e,"")})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringStartsWith=void 0,t.loadStringStartsWith=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var n=t>0?0|t:0;return this.substring(n,n+e.length)===e}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringEndsWith=void 0,t.loadStringEndsWith=function(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadSetLineDash=void 0;var r=n(1),o=n(0);t.loadSetLineDash=function(e){try{CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}),!!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.UseOffscreenCanvas,e)&&(0,o.isOffscreenCanvasSupported)()&&(OffscreenCanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}))}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringCodeAtPoint=void 0,t.loadStringCodeAtPoint=function(){
/*! https://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||(String.prototype.codePointAt=function(e){if(null==this)throw TypeError();var t=String(this),n=t.length,r=e?Number(e):0;if(!(r<0||r>=n)){var o,i=t.charCodeAt(r);return i>=55296&&i<=56319&&n>r+1&&(o=t.charCodeAt(r+1))>=56320&&o<=57343?1024*(i-55296)+o-56320+65536:i}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadGetLineDash=void 0;var r=n(1),o=n(0);t.loadGetLineDash=function(e){try{if(!CanvasRenderingContext2D.prototype.getLineDash)CanvasRenderingContext2D.prototype.getLineDash=function(){return[]},!!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.UseOffscreenCanvas,e)&&(0,o.isOffscreenCanvasSupported)()&&(OffscreenCanvasRenderingContext2D.prototype.getLineDash||(OffscreenCanvasRenderingContext2D.prototype.getLineDash=function(){return[]}))}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadArrayMap=void 0,t.loadArrayMap=function(){try{Array.prototype.map||(Array.prototype.map=function(e){if(null==this)throw new TypeError("this is null or not defined");var t,n=Object(this),r=n.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");arguments.length>1&&(t=arguments[1]);for(var o=new Array(r),i=0;i<r;){if(i in n){var l=n[i],a=e.call(t,l,i,n);o[i]=a}i++}return o})}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDateNow=void 0,t.loadDateNow=function(){Date.now||(Date.now=function(){return(new Date).getTime()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCellShrinkToFit=void 0;var r=n(9),o=n(6),i=n(2),l=n(10),a=n(12),s=n(40),d=n(14),u=n(7),c=n(18),g=n(13);function f(e,t,n,r,o,i){return e+o<t?n:n*function(e,t,n,r,o){var i=e+r;if(o){return Math.max(t-r,0)/(e+n)}return t/(i+n)}(e,t,r,o,i)}function h(e,t,n){return(0,r.getFontLineHeight)(e,n,t.CachedFont.FontName)*t.CachedDisplayText.length}t.updateCellShrinkToFit=function(e,t,n,C){(0,d.shouldRenderVerticalText)(n)?function(e,t){var n=t.CachedFont.Size,r=h(e,t,n),i=(0,o.getCellHeight)(e,t,!1),l=f(r,i,n,0,0,!1);t.ShrunkSize=l===n?l:function(e,t,n,r){var o=Math.floor(r);if(o<s.MinAllowedFontSize)return s.MinAllowedFontSize;var i=h(e,t,o);for(;i<n&&o<s.MaxAllowedFontSize;)i=h(e,t,o+=1);for(;i>n&&o>s.MinAllowedFontSize;)i=h(e,t,o-=1);return o}(e,t,i,l)}(t,n):function(e,t,n,s){var d,h=s.zoom,C=s.devicePixelRatio,m=(0,l.getFontCssStringFromFont)(n.CachedFont,void 0,t);e.font=m;var p=(0,r.getTextWidthNoCaching)(e,t,n),y=(0,o.getCellWidth)(t,n,!1),v=n.CachedStyle.Indentation||0,S=n.CachedFont.Size,R=(0,c.shouldAddAutoFilterPadding)(t,n)?(0,c.getAutoFilterButtonPadding)(t,n,h,C):0,F=(0,r.getHorizontalPadding)(t,n,S,n.CachedFont.Italic,v||0,!0,R),w=!(0,u.isNullOrUndefined)(null===(d=n.LinkedEntity)||void 0===d?void 0:d.IconWidth)||!!n.RichValueIcon,T=(0,a.getIconSizeAndPadding)(t,n,S,h,C),I=(0,i.getTextDrawingMaxWidth)(y,F,0,0,(0,c.getAutoFilterButtonPaddingForShrinkToFit)(t,n,h,C));n.ShrunkSize=f(p,I,S,F,T,w),n.ShrunkSize<0&&(0,g.setRenderingResultInfo)("\n    ShrinkSize was calculated to be negative: ".concat(n.ShrunkSize,",\n    textWidth: ").concat(p,",\n    cellWidth: ").concat(y,",\n    cellIndentation ").concat(v,",\n    maxTextWidth: ").concat(I,",\n    originalFontSize: ").concat(S,",\n    padding: ").concat(F,"\n    "));if(n.ShrunkSize&&n.ShrunkSize>0){var x=(0,l.getFontCssStringFromFont)(n.CachedFont,n.ShrunkSize,t);e.font=x,(0,r.getTextWidth)(e,t,n)}}(e,t,n,C)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawTableBordersInHighContrast=void 0;var r=n(1),o=n(0),i=n(3),l=n(2),a=n(119);function s(e,t,n,r){!function(e,t){if(e.FirstRow>=t.FirstRow&&e.LastRow<=t.LastRow&&e.FirstColumn>=t.FirstColumn&&e.LastColumn<=t.LastColumn)return!0;return!1}(n,r)?function(e,t,n,r){d(e,t,n.FirstColumn,n.LastColumn,n.FirstRow,r,!0),d(e,t,n.FirstColumn,n.LastColumn,n.LastRow,r,!1),u(e,t,n.FirstRow,n.LastRow,n.FirstColumn,r,!0),u(e,t,n.FirstRow,n.LastRow,n.LastColumn,r,!1)}(e,t,n,r):function(e,t,n){var r=(0,a.getRowTopOffset)(t,(n.FirstRow-1)%i.RowCountInBlock),o=(0,a.getRowBottomOffset)(t,(n.LastRow-1)%i.RowCountInBlock),l=(0,a.getColumnLeftOffset)(t,(n.FirstColumn-1)%i.ColumnCountInBlock),s=(0,a.getColumnRightOffset)(t,(n.LastColumn-1)%i.ColumnCountInBlock);if(void 0===r||void 0===o||void 0===l||void 0===s)return;e.strokeRect(l-i.pixelTranslation,r-i.pixelTranslation,s-l,o-r)}(e,t,n)}function d(e,t,n,r,o,s,d){if(o>=s.FirstRow&&o<=s.LastRow){var u=(0,a.getIntersectionRange)(s.FirstColumn,s.LastColumn,n,r),c=u.start,g=u.end,f=(o-1)%i.RowCountInBlock,h=(c-1)%i.ColumnCountInBlock,C=(g-1)%i.ColumnCountInBlock,m=(0,a.getColumnLeftOffset)(t,h),p=(0,a.getColumnRightOffset)(t,C),y=d?(0,a.getRowTopOffset)(t,f):(0,a.getRowBottomOffset)(t,f);void 0!==m&&void 0!==p&&void 0!==y&&(0,l.drawHorizontalLine)(e,m,p,y-i.pixelTranslation)}}function u(e,t,n,r,o,s,d){if(o>=s.FirstColumn&&o<=s.LastColumn){var u=(0,a.getIntersectionRange)(s.FirstRow,s.LastRow,n,r),c=u.start,g=u.end,f=(o-1)%i.ColumnCountInBlock,h=(c-1)%i.RowCountInBlock,C=(g-1)%i.RowCountInBlock,m=(0,a.getRowTopOffset)(t,h),p=(0,a.getRowBottomOffset)(t,C),y=d?(0,a.getColumnLeftOffset)(t,f):(0,a.getColumnRightOffset)(t,f);void 0!==m&&void 0!==p&&void 0!==y&&(0,l.drawVerticalLine)(e,m,p,y-i.pixelTranslation)}}t.drawTableBordersInHighContrast=function(e,t,n){var l;!function(e,t,n){(0,r.verifyArgumentNotNull)(e,"ctx","drawTableHighlightInHighContrast"),(0,r.verifyArgumentNotNull)(n,"context","drawTableHighlightInHighContrast"),(0,r.verifyArgumentNotNull)(t,"model","drawTableHighlightInHighContrast"),(0,r.verifyArgumentNotNull)(t.RowOffsets,"model.RowOffsets","drawTableHighlightInHighContrast"),(0,r.verifyArgumentNotNull)(t.ColumnOffsets,"model.ColumnOffsets","drawTableHighlightInHighContrast"),(0,r.verifyArgumentNotNull)(t.RowNumbers,"model.RowNumbers","drawTableHighlightInHighContrast"),(0,r.verifyArgumentNotNull)(t.ColumnNumbers,"model.ColumnNumbers","drawTableHighlightInHighContrast")}(e,t,n);var d=null===(l=t.ClientOnlyCache)||void 0===l?void 0:l.TableRangesCache;if(d&&d.length>0&&n.highContrastScheme){var u={FirstRow:t.RowNumbers[i.BlockRowStartIndex],FirstColumn:t.ColumnNumbers[i.BlockColumnStartIndex],LastRow:t.RowNumbers[i.BlockRowEndIndex],LastColumn:t.ColumnNumbers[i.BlockColumnEndIndex]};!function(e,t){e.lineWidth=i.ThickBorderWeight,e.strokeStyle=t.highContrastScheme?(0,o.rgbToColorHex)(t.highContrastScheme.TextColor):"black"}(e,n),e.beginPath();for(var c=0;c<d.length;c++)(0,a.tableIntersectsRenderingRegion)(d[c],u,n.renderingRegion)&&s(e,t,d[c],u);e.stroke()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestableGridBlockModelAccessor=t.GridBlockModelAccessor=void 0;var r=n(4),o=n(0),i=n(10),l=n(5),a=n(1),s=n(73),d=n(7),u=n(6),c=n(109),g=n(30),f=n(2),h=n(9),C=n(12),m=n(89),p=n(11),y=n(131),v=n(74),S=n(130),R=n(18),F=n(70),w=n(3),T=n(14),I=n(8),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.verifyArgumentNotNull=function(e,t,n){(0,l.verifyArgumentNotNull)(e,t,"GridBlockModelAccessor.".concat(n))},t.prototype.getCell=function(e,t){return(0,a.getCell)(e,t,this.model)},t.prototype.shouldCellExistInModel=function(e,t){if(!this.getCell(e,t))try{(0,a.validateCellShouldExistInModelUnsafe)(this.model,e,t)}catch(e){return!1}return!0},t.prototype.getOrCreateCell=function(e,t){return(0,a.getOrCreateCell)(this.model,e,t)},t.prototype.getUniqueId=function(){return this.model.UniqueId},t.prototype.getCellStyle=function(e){return(0,a.getCellStyle)(this.model,e)},t.prototype.getCellFont=function(e){return(0,o.getCellFont)(e,this.model)},t.prototype.hasRichText=function(e){return t.verifyArgumentNotNull(e,"cell","hasRichText"),!(0,d.isNullOrUndefined)(null==e?void 0:e.TextRuns)},t.prototype.cloneCellFont=function(e){var t=(0,o.getCellFont)(e,this.model);return t?(0,o.duplicateFont)(t,t.ID||0,t.RefCount||0):t},t.prototype.getBorderStyle=function(e){return(0,a.getCellBorderStyle)(this.model,e)},t.prototype.removeBorder=function(e){t.verifyArgumentNotNull(e,"cell","removeBorder"),t.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),e.BorderStyleID=e.GlobalBorderStyleID=a.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=(0,a.getBorderStyleByID)(e,this.model)},t.prototype.getNumberOfBlockColumns=function(){return this.model.ColumnNumbers.length},t.prototype.isRtl=function(){return this.model.IsRtl},t.prototype.setIsRtl=function(e){this.model.IsRtl=e,this.setDirty("isRtl",a.DirtyType.ModelCoreChanges)},t.prototype.replaceCellInModel=function(e,n){t.verifyArgumentNotNull(e,"cell","replaceCellInModel"),t.verifyArgumentNotNull(n,"immediateModel","replaceCellInModel"),t.verifyArgumentNotNull(n.Styles,"immediateModel!.Styles","replaceCellInModel");var r=n.Styles[0];t.verifyArgumentNotNull(r,"style","replaceCellInModel"),t.verifyArgumentNotNull(n.Fonts,"immediateModel!.Fonts","replaceCellInModel");var i=this.duplicateAndSetFontsInModel(n.Fonts),l=(0,a.isGlobalFontsAndCellStylesFlightEnabled)(this.model);l&&(0,a.getGlobalFontsMap)().process(this.model.Fonts),e.TextRuns&&(e.TextRuns=(0,o.duplicateTextRuns)(e.TextRuns,i),l&&(0,o.updateGlobalFontIdsOfTextRuns)(e.TextRuns,this.model.Fonts)),r.FontID=i[r.FontID||0],l&&(r.GlobalFontID=(0,a.getGlobalStyleId)(r.FontID||0,this.model.Fonts)),e.CachedFont=(0,a.getFontByID)(r,this.model,(null==e?void 0:e.StyleID)||0);var s=(0,o.getLastNonUniqueStyleID)(this.model)+1;if(r.ID=s,this.model.Styles.splice(s,0,r),l&&(0,a.getGlobalCellStylesMap)().process(this.model.Styles),e.StyleID=s,e.CachedStyle=r,l&&(e.GlobalCellStyleID=(0,a.getGlobalStyleId)(s,this.model.Styles)),!(0,d.isNullOrUndefined)(n.BorderStyles)){var u=n.BorderStyles[0];!(0,d.isNullOrUndefined)(u)&&!(0,d.isNullOrUndefined)(u.Borders)&&u.Borders.length>0&&(u.RefCount=1,(0,a.isGlobalBorderStylesEnabled)(this.model)?this.setBordersNew(e,u,!1):this.setBorders(e,u))}if(this.getCell(e.Row,e.Col)){var c=(0,o.getCellPositionInArray)(e,this.model.Cells);this.model.Cells[c]=e,this.model.ClientOnlyCache.CellLookup[(0,a.getCellLookupKey)(e.Row,e.Col)]=e}else this.attachCellToModel(e);r.RefCount=1},t.prototype.attachCellToModel=function(e){(0,o.attachCellToModel)(e,this.model)},t.prototype.deleteCellFromModel=function(e){t.verifyArgumentNotNull(e,"cell","deleteCellFromModel"),t.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","deleteCellFromModel");var n=(0,a.getCell)(e.Row,e.Col,this.model);if(n&&n.Row===e.Row&&n.Col===e.Col){var r=!!e.Merge,i=0,l=0,s=(0,o.getCellPositionInArray)(e,this.model.Cells);r&&(i=e.Merge.Rows,l=e.Merge.Columns);for(var d=e.Row;d<=e.Row+i;d++)for(var u=e.Col;u<=e.Col+l;u++)delete this.model.ClientOnlyCache.CellLookup[(0,a.getCellLookupKey)(d,u)];this.model.Cells.splice(s,1)}},t.prototype.prepareCellStyleForEdit=function(e){t.verifyArgumentNotNull(e,"cell","prepareCellStyleForEdit");var n,r=(0,a.isGlobalFontsAndCellStylesFlightEnabled)(this.model),i=(null==e?void 0:e.StyleID)||0;if(r)try{n=(0,a.getReferencedObjectById)(i,this.model.Styles)}catch(t){var l=new Error(t).stack||"",s="PrepareCellStyleEdit: Exception while retrieving cell style with message: ".concat(t," and stacktrace: ").concat(l);I.ULS.sendTraceTag(507601601,I.LogCategory.msoulscat_ES_EWAJSGrid,I.TraceLevel.Important,s),n=this.getCellStyle(e)}else n=this.getCellStyle(e);if((0,d.isNullOrUndefined)(e.CachedStyle)&&(e.CachedStyle=n),!r&&!this.isStyleUnique(n.ID||0)&&(n.RefCount||0)<=1)return!0;var u=(0,o.getLastNonUniqueStyleID)(this.model)+1,c=(0,o.duplicateStyle)(this.model,n,u,1);return n.RefCount=Math.max(0,(n.RefCount||0)-1),this.model.Styles.splice(u,0,c),e.CachedStyle=c,e.StyleID=u,!1},t.prototype.updateGlobalCellStyleIDAfterEdit=function(e){t.verifyArgumentNotNull(e,"cell","updateGlobalCellStyleIDAfterEdit");var n=this.getCellStyle(e);if(void 0!==n.GlobalFontID&&null!==n.GlobalFontID){var r=(0,a.getGlobalCellStylesMap)().getOrCreateID(n);e.GlobalCellStyleID=r,e.CachedStyle=(0,a.getCellStyleByID)(e,this.model)}else e.GlobalCellStyleID=void 0},t.prototype.setDefaultHyperlinkStyleOnCell=function(e){t.verifyArgumentNotNull(e,"cell","setDefaultHyperlinkStyleOnCell");var n=(0,a.getReferencedObjectById)(a.UniqueStyleID.Hyperlink,this.model.Styles);e.StyleID=a.UniqueStyleID.Hyperlink,e.CachedStyle=n,n.RefCount=(0,o.incrementNumericVal)(n.RefCount||0)},t.prototype.hideCommentIndicators=function(e){var n;t.verifyArgumentNotNull(e,"isCommentIndicatorHidden","hideCommentIndicators"),t.verifyArgumentNotNull(this.model,"this.model","hideCommentIndicators");var r=!1;if(e&&this.model)for(var o=0,i=this.model.Cells||[];o<i.length;o++){var l=i[o];if(null===(n=null==l?void 0:l.Comment)||void 0===n?void 0:n.IsThreadedComment){var a=e(this.getRowNumber(l.Row),this.getColumnNumber(l.Col));this.getHideCommentIndicator(l)!==a&&(this.setHideCommentIndicator(l,a),this.setCellAndSpannedOverCellsDirty(l),r=!0)}}return r},t.prototype.editCellFontAttributes=function(e,n){if(t.verifyArgumentNotNull(e,"cell","editFont"),t.verifyArgumentNotNull(e,"editFontAction","editFont"),this.attachCellToModel(e),this.prepareFontForEdit(e),e.TextRuns)for(var r=0;r<e.TextRuns.length;r++){var o=e.TextRuns[r];(0,d.isNullOrUndefined)(o.CachedFont)&&(o.CachedFont=(0,a.getReferencedObjectById)(o.FontID||0,this.model.Fonts)),n(o.CachedFont)}n(e.CachedFont)},t.prototype.copyCacheItemsToModel=function(e){(0,l.verifyArgumentNotNull)(e,"sourceModel","copyClientOnlyCacheToNewModel"),(null==e?void 0:e.ClientOnlyCache)&&(this.model.ClientOnlyCache||(this.model.ClientOnlyCache={}),this.model.ClientOnlyCache.RenderingRegionsHitTestCache=e.ClientOnlyCache.RenderingRegionsHitTestCache)},t.prototype.prepareFontForEdit=function(e){if(null==e?void 0:e.TextRuns)for(var t=0;t<e.TextRuns.length;t++){var n=e.TextRuns[t],r=(0,d.isNullOrUndefined)(n.CachedFont)?(0,a.getReferencedObjectById)(n.FontID||0,this.model.Fonts):n.CachedFont;this.prepareTextRunFontForEdit(r,n)}this.prepareCellFontForEdit(e)},t.prototype.prepareBorderStyleForEdit=function(e){return t.verifyArgumentNotNull(e,"cell","prepareBorderStyleForEdit"),(0,o.prepareBorderStyleForEdit)(e,this.model)},t.prototype.addLeftBorderToAdjacentCell=function(e){return t.verifyArgumentNotNull(e,"cell","addLeftBorderToAdjacentCell"),(0,o.addLeftBorderToAdjacentCell)(e,this.model)},t.prototype.cloneBorderStyle=function(e){t.verifyArgumentNotNull(e,"cell","cloneBorderStyle");var n=this.getBorderStyle(e);return(0,o.duplicateBorderStyle)(n,n.ID||0,1)},t.prototype.setBorders=function(e,t){return(0,o.setBordersToBorderStyle)(e,this.model,t)},t.prototype.setBordersNew=function(e,n,r){return t.verifyArgumentNotNull(e,"cell","setBordersNew"),t.verifyArgumentNotNull(e,"newBorderStyle","setBordersNew"),(0,o.setBordersNew)(e,this.model,n,r)},t.prototype.afterBorderStyleEdit=function(e){return t.verifyArgumentNotNull(e,"cell","afterBorderStyleEdit"),(0,o.afterBorderStyleEdit)(e,this.model)},t.prototype.afterFontEdit=function(e){if(t.verifyArgumentNotNull(e,"cell","afterFontEdit"),null==e?void 0:e.TextRuns)for(var n=0;n<e.TextRuns.length;n++){var r=e.TextRuns[n];(0,d.isNullOrUndefined)(r.CachedFont)&&(r.CachedFont=(0,a.getFontByID)(r,this.model,void 0));var o=(0,a.getGlobalFontsMap)().getOrCreateID(r.CachedFont);r.GlobalFontID=o}var i=(0,a.getGlobalFontsMap)().getOrCreateID(null==e?void 0:e.CachedFont);e.CachedFont.GlobalId=i,e.CachedStyle.GlobalFontID=i,e.CachedFont=(0,a.getFontByID)(e.CachedStyle,this.model,(null==e?void 0:e.StyleID)||0),this.updateGlobalCellStyleIDAfterEdit(e)},t.prototype.setInCellControlOptions=function(e,n){t.verifyArgumentNotNull(e,"cell","setInCellControlOptions"),(0,a.isChangeGateEnabled)(a.ChangeGate.FixCopyBlankCellToACellWithCheckbox)?e.InCellControlOptions=n||void 0:(t.verifyArgumentNotNull(n,"controlOptions","setInCellControlOptions"),n&&(e.InCellControlOptions=n))},t.prototype.getInCellControlOptions=function(e){return t.verifyArgumentNotNull(e,"cell","getInCellControlOptions"),(0,a.isChangeGateEnabled)(a.ChangeGate.FixCopyBlankCellToACellWithCheckbox)||e.InCellControlOptions?e.InCellControlOptions:null},t.prototype.setHideCommentIndicator=function(e,n){t.verifyArgumentNotNull(e,"cell","setHideCommentIndicator"),e&&e.Comment&&(e.Comment.HideCommentIndicator=n)},t.prototype.getHideCommentIndicator=function(e){return t.verifyArgumentNotNull(e,"cell","getHideCommentIndicator"),!!(e&&e.Comment&&e.Comment.HideCommentIndicator)&&e.Comment.HideCommentIndicator},t.prototype.getCellCssFont=function(e){return(0,o.verifyCellStyleAndFont)(this.model,e,"getCellCssFont"),(0,i.getFontCssStringFromCell)(e,this.model)},t.prototype.setCellAndSpannedOverCellsDirty=function(e){e&&((0,o.setCellAndSpannedOverCellsDirty)(this.model,e),this.setDirtyInternal(a.DirtyType.ModelCellChanges))},t.prototype.setAdjacentCellsDirty=function(e){if(e){var t=(0,a.isChangeGateEnabled)(a.ChangeGate.AdjacentCellsMergeFix)?(0,a.getAdjacentCellsKeys)(this.model,e):(0,a.getAdjacentCellsKeysOld)(this.model,e.Row,e.Col);this.setCellsDirty(t)}},t.prototype.getCalcBlockModel=function(){var e=new a.CalcBlockModel,t=this.model.RowNumbers.slice(),n=this.model.ColumnNumbers.slice();e.addHeaders(t,n);for(var r=0;r<this.model.Cells.length;r++){var o=this.model.Cells[r],i=e.createCell(o);e.addCell(i)}return e},t.prototype.updateCellSpillInformation=function(e,t,n){var r,i;(0,o.verifyCellStyleAndFont)(this.model,e,"updateCellSpillInformation");var l=t*n;if((0,f.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,f.initializeOffsetsForDrawing)(this.model,l),(0,d.isNullOrUndefined)(null===(r=null==e?void 0:e.CachedDrawingLayout)||void 0===r?void 0:r.CellTextLayout)||(e.CachedDrawingLayout.CellTextLayout={}),!e.Merge&&(null===(i=null==e?void 0:e.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)!==a.HorizontalAlignment.CenterAcrossSelection){this.setCellAndSpannedOverCellsDirty(e),e.Spill=void 0;var u;u=this.getOrCreateCanvasContext(),this.setContextCellFont(u,e),(0,a.isRenderFlagEnabled)(a.RenderFlagsArray.MoveSpillCellBeforeRendering,this.model)?e.TolType=a.TolType.Spill:((0,s.updateCellSpill)(u,this.model,e,t,n),void 0!==e.Spill&&this.removeBordersWithinASpillCell(e),this.setCellAndSpannedOverCellsDirty(e))}},t.prototype.updateTolType=function(e){if((0,o.verifyCellStyleAndFont)(this.model,e,"updateTolType"),(0,a.isRenderFlagEnabled)(a.RenderFlagsArray.TextWidthClientPhase1,this.model)){var t;t=this.getOrCreateCanvasContext(),this.setContextCellFont(t,e);var n=(0,u.getCellWidth)(this.model,e,!0),r=(0,h.measureTextWidth)(t,e.Text,!0,!0);if(e.ValueType===a.CellValueType.Number)r/n*100>(0,p.getServiceSetting)(9,80)&&(e.TolType=a.TolType.Autofit);else if(null==e?void 0:e.Spill){var i=(0,u.getSpillCellWidth)(e,this.model),l=r/(i-this.model.ColumnWidths[(0,u.getSpillCellEndCol)(e,this.model)])*100;r/i*100>(0,p.getServiceSetting)(10,80)&&(e.TolType=a.TolType.Spill),l<(0,p.getServiceSetting)(11,120)&&(e.TolType=a.TolType.Spill)}}},t.prototype.updateClosestNonEmptyCellsSpillInformation=function(e,n,r){t.verifyArgumentNotNull(e,"cell","updateClosestNonEmptyCellsSpillInformation"),(0,o.verifyCellStyleAndFont)(this.model,e,"updateClosestNonEmptyCellsSpillInformation");var i;i=this.getOrCreateCanvasContext(),this.setContextCellFont(i,e),(0,s.updateClosestNonEmptyCellsSpill)(i,e,this.model,n,r)},t.prototype.getUserInput=function(e){return t.verifyArgumentNotNull(e,"cell","getUserInput"),e.UserInput},t.prototype.setUserInput=function(e,n){t.verifyArgumentNotNull(e,"cell","setUserInput"),t.verifyArgumentNotNull(n,"userInput","setUserInput"),e.UserInput=n},t.prototype.clearCellFormat=function(e){var t=(0,a.getReferencedObjectById)(a.UniqueStyleID.Default,this.model.Styles);e.StyleID=a.UniqueStyleID.Default,e.CachedStyle=t,e.CachedFont=(0,a.getFontByID)(t,this.model,a.UniqueStyleID.Default),e.BorderStyleID=e.GlobalBorderStyleID=a.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=(0,a.getBorderStyleByID)(e,this.model)},t.prototype.getCellWidth=function(e,n){return t.verifyArgumentNotNull(e,"cell","getCellWidth"),(0,u.getCellWidth)(this.model,e,n)},t.prototype.getHorizontalPadding=function(e,n,r){t.verifyArgumentNotNull(e,"cell","getHorizontalPadding");var o=n*r;return this.ensureCachedObjectsInitialized(this.model,e,o),(0,h.getCellTextHorizontalPadding)(e,this.model,n,r)},t.prototype.getCellHeight=function(e){return t.verifyArgumentNotNull(e,"cell","getCellHeight"),(0,u.getCellHeight)(this.model,e,!0)},t.prototype.getTextMaxWidth=function(e,n,r){t.verifyArgumentNotNull(e,"cell","getTextDrawingMaxWidth");var o=n*r;return this.ensureCachedObjectsInitialized(this.model,e,o),(0,f.getTextDrawingMaxWidth)(this.getCellWidth(e,!0),(0,h.getCellTextHorizontalPadding)(e,this.model,n,r),(0,h.getDistanceFromCellStartToIconEnd)(this.model,e,n,r),(0,C.getExpandCollapseButtonPadding)(e),0)},t.prototype.getFormattedText=function(e){var n=this;t.verifyArgumentNotNull(e,"cell","getFormattedText"),t.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText");var r=[],i=[],l=(0,a.isGlobalFontsAndCellStylesFlightEnabled)(this.model),s=function(e,t){if(l)d(e,t);else if(!i[e])if(e<n.model.Fonts.length){var r=n.model.Fonts[e];i[e]=(0,o.duplicateFont)(r,r.ID||0,r.RefCount||0)}else y.BlockModelAccessor.throwErrorWrapper("Font ".concat(e," does not exist"),"getFormattedText")},d=function(e,t){if(!i[e]){var r=(0,a.getFontByID)(t,n.model,void 0);i[e]=(0,o.duplicateFont)(r,e||0,r.RefCount||0)}};if(e.TextRuns)e.TextRuns.forEach((function(e){s(e.FontID||0,e),r.push((0,o.duplicateTextRun)(e))}));else{var u=e.CachedStyle?e.CachedStyle:this.getCellStyle(e);(0,a.isChangeGateEnabled)(a.ChangeGate.StyleIdCrashFix)?u=(0,a.getCellStyleByID)(e,this.model):(0,a.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&(u=(0,a.getReferencedObjectById)((null==e?void 0:e.StyleID)||0,this.model.Styles));var c={FontID:u.FontID||0,StartIndex:0};s(u.FontID||0,u),r.push(c)}return{Text:e.Text||"",TextRuns:r,Fonts:i}},t.prototype.getNoControlPhoneticText=function(e,n){return t.verifyArgumentNotNull(e,"phoneticInfo","getNoControlPhoneticText"),t.verifyArgumentNotNull(n,"cellText","getNoControlPhoneticText"),(0,m.getNoControlPhoneticText)(e,n)},t.prototype.prepareTextRunFontForEdit=function(e,t){if(!(0,a.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&(e.RefCount||0)<=1)return;this.duplicateAndSetNewFontOnTextRun(e,t)},t.prototype.prepareCellFontForEdit=function(e){var t,n,r=this.prepareCellStyleForEdit(e),o=(0,a.isGlobalFontsAndCellStylesFlightEnabled)(this.model),i=(null===(t=null==e?void 0:e.CachedStyle)||void 0===t?void 0:t.FontID)||0;if(o)try{n=(0,a.getReferencedObjectById)(i,this.model.Fonts)}catch(t){var l=new Error(t).stack||"",s="PrepareCellFontEdit: Exception while retrieving font with message: ".concat(t," and stacktrace: ").concat(l);I.ULS.sendTraceTag(507601600,I.LogCategory.msoulscat_ES_EWAJSGrid,I.TraceLevel.Important,s),n=this.getCellFont(e)}else n=this.getCellFont(e);(0,d.isNullOrUndefined)(null==e?void 0:e.CachedFont)&&(e.CachedFont=n),r&&(n.RefCount||0)<=1||this.duplicateAndSetNewFontOnCell(n,e)},t.prototype.setFormattedText=function(e,n){t.verifyArgumentNotNull(e,"cell","setFormattedText"),t.verifyArgumentNotNull(n,"formattedText","setFormattedText"),t.verifyArgumentNotNull(n.TextRuns,"formattedText.TextRuns","setFormattedText"),t.verifyArgumentNotNull(n.Fonts,"formattedText.Fonts","setFormattedText"),t.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","setFormattedText"),this.attachCellToModel(e),e.Text=n.Text;var r=this.duplicateAndSetFontsInModel(n.Fonts),i=e.TextRuns=(0,o.duplicateTextRuns)(n.TextRuns,r);(0,a.isGlobalFontsAndCellStylesFlightEnabled)(this.model)&&((0,a.getGlobalFontsMap)().process(n.Fonts),(0,o.updateGlobalFontIdsOfTextRuns)(e.TextRuns,this.model.Fonts));for(var l=0;l<i.length;l++)i[l].CachedFont=(0,a.getFontByID)(i[l],this.model,void 0)},t.prototype.discardFormattedText=function(e){t.verifyArgumentNotNull(e,"cell","discardFormattedText"),e.TextRuns=void 0},t.prototype.serializeCell=function(e){return(0,a.serializeCell)(e,this.model)},t.prototype.getOutlineState=function(e,t){var n=e?this.model.RowOutlinesInformation:this.model.ColumnOutlinesInformation;if(!n)return a.OutlineState.None;for(var r=a.OutlineState.None,o=0;o<n.length;o++)for(var i=n[o],l=0;l<i.Outlines.length;l++){var s=i.Outlines[l];if(t===s.ButtonIndex&&!s.IsExpanded)return a.OutlineState.Collapsed;this.isIndexInOutline(t,s,e)&&(r=a.OutlineState.Expanded)}return r},t.prototype.compareCells=function(e,t,n){return(0,a.areGridCellsEqual)(e,t,n,this.model)},t.prototype.updateNumFmt=function(e){t.verifyArgumentNotNull(e,"cell","updateNumFmt"),(0,a.isAccAndCustomNumFmtApplicable)(e)?(0,c.updateNumFmtFromCell)(e):e.NumFmt=void 0},t.prototype.updateCellText=function(e,n){t.verifyArgumentNotNull(e,"cell","updateCellText"),t.verifyArgumentNotNull(n,"text","updateCellText"),e.TextRuns=void 0,e.DisplayFormula=!1,(0,o.updateCellText)(this.model,e,n)},t.prototype.updateCellValue=function(e,n){t.verifyArgumentNotNull(e,"cell","updateCellValue"),e.Value=null!=n?n:void 0},t.prototype.hasPageLayout=function(){return null!=this.model.PageBreaks||null!=this.model.PrintAreas},t.prototype.hasIntersectingPrintArea=function(e){var n=this.model.PrintAreas;if(t.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","hasIntersectingPrintArea"),t.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","hasIntersectingPrintArea"),n&&e)for(var r=this.model.RowNumbers.length,i=this.model.ColumnNumbers.length,l=0;l<n.length;l++){var a=n[l];if(a.FirstRow!==r&&a.FirstColumn!==i){var s=this.getRowNumber(a.FirstRow),d=a.LastRow>=r?this.getRowNumber(r-1):this.getRowNumber(a.LastRow),u={FirstRow:s,FirstColumn:this.getColumnNumber(a.FirstColumn),LastRow:d,LastColumn:a.LastColumn>=i?this.getColumnNumber(i-1):this.getColumnNumber(a.LastColumn)};if((0,o.doRangesIntersect)(e,u))return!0}}return!1},t.prototype.setPrintArea=function(e){e&&0!==e.length&&(this.model.PrintAreas=e,this.setDirty("setPrintArea",a.DirtyType.ModelCoreChanges))},t.prototype.addToPrintArea=function(e){e&&0!==e.length&&(this.model.PrintAreas=(this.model.PrintAreas||[]).concat(e),this.setDirty("addToPrintArea",a.DirtyType.ModelCoreChanges))},t.prototype.clearPrintArea=function(){this.model.PrintAreas&&(this.model.PrintAreas=void 0,this.setDirty("clearPrintArea",a.DirtyType.ModelCoreChanges))},t.prototype.hasPrintArea=function(){return!!this.model.PrintAreas&&this.model.PrintAreas.length>0},t.prototype.getPrintArea=function(){if(!this.model.PrintAreas)return[];for(var e=[],t=0;t<this.model.PrintAreas.length;t++){var n=this.model.PrintAreas[t];e.push({FirstRow:n.FirstRow,FirstColumn:n.FirstColumn,LastRow:n.LastRow,LastColumn:n.LastColumn})}return e},t.prototype.insertPageBreak=function(e){((null==e?void 0:e.Row)&&0!==e.Row.length||(null==e?void 0:e.Col)&&0!==e.Col.length)&&(this.insertRowBreak(null==e?void 0:e.Row),this.insertColBreak(null==e?void 0:e.Col),this.setDirty("insertPageBreak",a.DirtyType.ModelCoreChanges))},t.prototype.removePageBreak=function(e){var t=this.removeRowBreak(null==e?void 0:e.Row),n=this.removeColBreak(null==e?void 0:e.Col);!this.model.PageBreaks||this.model.PageBreaks.Row||this.model.PageBreaks.Col||(this.model.PageBreaks=void 0),(t||n)&&this.setDirty("removePageBreak",a.DirtyType.ModelCoreChanges)},t.prototype.resetAllPageBreak=function(){this.model.PageBreaks&&(this.model.PageBreaks=void 0,this.setDirty("resetAllPageBreak",a.DirtyType.ModelCoreChanges))},t.prototype.getPivotTableRanges=function(){return this.duplicatePivotTableRangeInformations(this.model.PivotTables)},t.prototype.getSparklineRanges=function(){var e;return this.duplicateSparklineRangeInformations(null===(e=this.model.Sparklines)||void 0===e?void 0:e.Ranges)},t.prototype.getSparklinesUrl=function(){var e,t;return null!==(t=null===(e=this.model.Sparklines)||void 0===e?void 0:e.ImageUrl)&&void 0!==t?t:""},t.prototype.getAllRichValueFields=function(){return this.duplicateRichValueFields(this.model.AllRichValueFields)},t.prototype.disposeBlock=function(e){(0,d.isNullOrUndefined)(e)||""===e||(0,g.clearImageFromCache)(g.ImageType.Sparkline,e)},t.prototype.getAutoFilterButtonTotalSize=function(e,n,r){return t.verifyArgumentNotNull(e,"cell","getAutoFilterButtonTotalSize"),this.getAutoFilterButtonTotalSizeInternal(e,n,r)},t.prototype.getAutoFilterMenuOffsetsFromCellStart=function(e,n,r){return t.verifyArgumentNotNull(e,"cell","getAutoFilterMenuOffsetsFromCellStart"),this.getAutoFilterMenuOffsetsFromCellStartInternal(e,n,r)},t.prototype.setPreviewRange=function(e){var t,n=(0,a.getModelClientCache)(this.model);n.PreviewCellsRange&&this.setPreviewRangeCellsDirty(n.PreviewCellsRange),(null===(t=n.PreviewCellsSettings)||void 0===t?void 0:t.PreviewCellsRange)&&this.setPreviewRangeCellsDirty(n.PreviewCellsSettings.PreviewCellsRange),e&&this.setPreviewRangeCellsDirty(e),n.PreviewCellsRange=e||void 0},t.prototype.setPreviewCellsSettings=function(e){var t,n=(0,a.getModelClientCache)(this.model);n.PreviewCellsRange&&this.setPreviewRangeCellsDirty(n.PreviewCellsRange),(null===(t=n.PreviewCellsSettings)||void 0===t?void 0:t.PreviewCellsRange)&&this.setPreviewRangeCellsDirty(n.PreviewCellsSettings.PreviewCellsRange),(null==e?void 0:e.PreviewCellsRange)&&this.setPreviewRangeCellsDirty(e.PreviewCellsRange),n.PreviewCellsSettings=e||void 0},t.prototype.getPreviewText=function(e){return t.verifyArgumentNotNull(e,"cell","getPreviewText"),e.PreviewText},t.prototype.setPreviewText=function(e,n){t.verifyArgumentNotNull(e,"cell","setPreviewText"),e.PreviewText=n},t.prototype.getPreviewNumFmt=function(e){return(0,o.assertArgumentNotNull)(e,"cell","getPreviewNumFmt"),e.PreviewNumFmt},t.prototype.setPreviewNumFmt=function(e,n){t.verifyArgumentNotNull(e,"cell","setPreviewNumFmt"),e.PreviewNumFmt=n},t.prototype.setRetainTextOnPreview=function(e,n){t.verifyArgumentNotNull(e,"cell","setRetainTextOnPreview"),e.RetainTextOnPreview=n},t.prototype.getPreviewCellStyle=function(e){return(0,o.assertArgumentNotNull)(e,"cell","getPreviewCellStyle"),e.PreviewCellStyle},t.prototype.setPreviewCellStyle=function(e,n){t.verifyArgumentNotNull(e,"cell","setPreviewCellStyle"),e.PreviewCellStyle=n},t.prototype.isSkeletonCell=function(e){return t.verifyArgumentNotNull(e,"cell","isSkeletonCell"),!!e.ShowSkeleton},t.prototype.setShowSkeleton=function(e,n){t.verifyArgumentNotNull(e,"cell","setShowSkeleton"),e.ShowSkeleton=n},t.prototype.hasFilters=function(){for(var e=0;e<this.model.Cells.length;e++){var t=this.model.Cells[e];if(t.AutoFilter||t.PivotFilter)return!0}return!1},t.prototype.updatePivotTablesAfterColWidthProcessing=function(){var e=this.model.PivotTables;if(e&&0!==e.length)for(var t=0;t<e.length;t++)for(var n=e[t],r=n.FirstColumn;r<=n.LastColumn;r++){var o=(0,v.getColMetadata)(r+1);o&&o.SrvDx&&o.CachedColWidth&&(n.OriginPTWidth=n.OriginPTWidth-o.SrvDx+o.CachedColWidth)}},t.prototype.hasRichValueIcon=function(e){return null!=e&&(null!=e.LinkedEntity&&(null!=e.LinkedEntity.IconWidth&&e.LinkedEntity.IconWidth>0))},t.prototype.getCellContentWidth=function(e){var t;if((0,o.assertArgumentNotNull)(e,"cell","getCellContentWidth"),this.hasRichValueIcon(e))throw Error("getCellContentWidth: unsupported rich value icon!");var n=this.getOrCreateCanvasContext(),r={Text:e.Text,CellValueType:e.ValueType,CellStyleId:e.StyleID||0,Autofilter:null!=e.AutoFilter,ExpandColButton:null===(t=e.PivotTable)||void 0===t?void 0:t.ShouldShowExpandCollapseMenu,CondWidthIcon:null!=e.CondFormat&&null!=e.CondFormat.Icon,TextRuns:e.TextRuns};return(0,S.calculateColWidthForMetadata)(n,this.model,r)},t.prototype.isCellWidthFixed=function(e){return(0,o.assertArgumentNotNull)(e,"cell","isCellWidthFixed"),!!this.model.FixedColumns&&this.model.FixedColumns[e.Col]},t.prototype.isCellHeightFixed=function(e){return(0,o.assertArgumentNotNull)(e,"cell","isCellHeightFixed"),!!this.model.IsBitwiseFixedRows&&(0,o.isFixedRows)(this.model.IsBitwiseFixedRows,e.Row)},t.prototype.getRichValueTypes=function(){return this.model.RichValueTypes||[]},t.prototype.getCellHeightWithWrap=function(e,t,n,r){var l;(0,o.assertArgumentNotNull)(e,"cell","getCellHeightWithWrap");var s=(0,a.isChangeGateEnabled)(a.ChangeGate.WrapTextNullFontFix);if(!r||e.ValueType!==a.CellValueType.String||e.Merge||s&&!e.Text||(0,o.isFixedRows)(this.model.IsBitwiseFixedRows||0,e.Row))return this.getRowHeight(e.Row);e.CachedDrawingLayout||(e.CachedDrawingLayout={CellTextLayout:{}});var d={zoom:t,devicePixelRatio:n,debugMode:!1,isFormulaView:!1,isCanvasHitTestDebugHighlight:!1,isCellsPreviewMode:!1,modelFromCache:!1,renderPageLayout:!1,skeletonMode:!1,subPixelRenderingEnabled:!1,scaleFactor:t*n},c=null;c=this.getOrCreateCanvasContext(),s&&(0,o.initializeCellCachedObjects)(this.model,e,!1),c.font=(0,i.getFontCssStringFromCell)(e,this.model);var g=(0,u.getCellWidth)(this.model,e,!0),m=(0,h.getDistanceFromCellStartToIconEnd)(this.model,e,t,devicePixelRatio),p=(0,f.getTextDrawingMaxWidth)(g,(0,h.getCellTextHorizontalPaddingWithoutVisualElements)(this.model,e),m,(0,C.getExpandCollapseButtonWidth)(null===(l=e.PivotTable)||void 0===l?void 0:l.HasExpandCollapseIndicator),(0,R.getAutoFilterPaddingForAdvancedHorizontalAlignment)(this.model,e,t,devicePixelRatio)),y=this.model.RowHeights[e.Row]-w.GridLineWidthPx,v=(0,T.shouldRenderVerticalText)(e)?y:p,S=(0,F.computeMaxTextWidthForWrapText)(e,(0,F.getBreakType)(e),v,this.model,d);if(S<=0)return this.getRowHeight(e.Row);var I=(0,h.getTextWidthNoCaching)(c,this.model,e),x=(0,h.getTextLineHeight)(e,this.model);return Math.ceil(I/S)*x},t.prototype.updateBreakOpForCell=function(e){(0,l.verifyArgumentNotNull)(e,"cell","updateBreakOpForCell");var t=(0,o.getDisplayText)(e,this.model);if(t&&(0,o.doesTextContainThaiCharacter)(t)){var n=(0,o.getBreakOpForThaiText)(t);n&&(e.WrapText||(e.WrapText={}),e.WrapText.BreakOp=n)}},t.prototype.insertRowBreak=function(e){var t;e&&0!==e.length&&((null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Row)&&this.model.PageBreaks.Row.length>0?this.model.PageBreaks.Row=this.model.PageBreaks.Row.concat(e):this.model.PageBreaks?this.model.PageBreaks.Row=e:this.model.PageBreaks={Row:e})},t.prototype.insertColBreak=function(e){var t;e&&0!==e.length&&((null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Col)&&this.model.PageBreaks.Col.length>0?this.model.PageBreaks.Col=this.model.PageBreaks.Col.concat(e):this.model.PageBreaks?this.model.PageBreaks.Col=e:this.model.PageBreaks={Col:e})},t.prototype.removeRowBreak=function(e){var t;if(!e||0===e.length||!(null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Row)||0===this.model.PageBreaks.Row.length)return!1;var n=this.model.PageBreaks.Row.filter((function(t){return e.every((function(e){return e.Index!==t.Index}))})),r=this.model.PageBreaks.Row.length!==n.length;return this.model.PageBreaks.Row=n.length>0?n:void 0,r},t.prototype.removeColBreak=function(e){var t;if(!e||0===e.length||!(null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Col)||0===this.model.PageBreaks.Col.length)return!1;var n=this.model.PageBreaks.Col.filter((function(t){return e.every((function(e){return e.Index!==t.Index}))})),r=this.model.PageBreaks.Col.length!==n.length;return this.model.PageBreaks.Col=n.length>0?n:void 0,r},t.prototype.isStyleUnique=function(e){return e===a.UniqueStyleID.Default||e===a.UniqueStyleID.Hyperlink},t.prototype.removeBordersWithinASpillCell=function(e){for(var t=1;t<=e.Spill.SpanToEnd;t++){var n=this.getCell(e.Row,e.Col+t);if(n){var r=this.getBorderStyle(n);r&&r.Borders&&r.Borders.length>0&&this.removeCellLeftBorder(n,r)}}},t.prototype.removeCellLeftBorder=function(e,t){var n=(0,o.duplicateBorderStyle)(t,t.ID||0,1);if(n&&n.Borders)for(var r=n.Borders.length,i=0;i<r;i++){var l=n.Borders[i];l&&l.BorderPosition===a.BorderPositionType.Left&&(n.Borders.splice(i),(0,a.isGlobalBorderStylesEnabled)(this.model)?this.setBordersNew(e,n,!0):this.setBorders(e,n))}},t.prototype.duplicateAndSetNewFontOnTextRun=function(e,t){var n=this.duplicateAndSetNewFontInModel(e,!1);t.FontID=n.newFontId,t.CachedFont=n.newFont},t.prototype.duplicateAndSetNewFontOnCell=function(e,t){var n=this.duplicateAndSetNewFontInModel(e,!1),r=n.newFontId,o=n.newFont;t.CachedFont=o,t.CachedStyle.FontID=r},t.prototype.duplicateAndSetFontsInModel=function(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++){var o=e[parseInt(n[r],10)||0],i=this.duplicateAndSetNewFontInModel(o,!0).newFontId;t[o.ID||0]=i}return t},t.prototype.duplicatePivotTableRangeInformations=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicatePivotTableRangeInformation(e[n]));return t}},t.prototype.duplicatePivotTableRangeInformation=function(e){return{AltText:e.AltText,AltTextSummary:e.AltTextSummary,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ColGrandTotalOn:e.ColGrandTotalOn,ColumnAreaFields:this.duplicatePivotTableFieldInfos(e.ColumnAreaFields),ColumnHeaderRange:this.duplicateRangeInformation(e.ColumnHeaderRange),ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,ColumnTotalIndexes:e.ColumnTotalIndexes,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,ConnectionName:e.ConnectionName,CurrentStyleName:e.CurrentStyleName,StyleIndex:e.StyleIndex,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DataSource:e.DataSource,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DeltaYFromOriginPT:e.DeltaYFromOriginPT,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,ErrorString:e.ErrorString,ExternalSourceIndex:e.ExternalSourceIndex,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,FirstColIndex:e.FirstColIndex,FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,FirstRowIndex:e.FirstRowIndex,HasActiveFilter:e.HasActiveFilter,HideGridLines:e.HideGridLines,IndentIncrement:e.IndentIncrement,IsActionable:e.IsActionable,IsEmptyPivot:e.IsEmptyPivot,IsOlap:e.IsOlap,IsPageArea:e.IsPageArea,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,LastColIndex:e.LastRowIndex,LastColumn:e.LastColumn,LastRow:e.LastRow,LastRowIndex:e.LastRowIndex,NullString:e.NullString,OriginPTHeight:e.OriginPTHeight,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,OriginPTWidth:e.OriginPTWidth,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,PageAreaFields:this.duplicatePivotTableFieldInfos(e.PageAreaFields),PivotTableName:e.PivotTableName,RangeType:e.RangeType,RefreshOnLoad:e.RefreshOnLoad,RowAreaCaptions:e.RowAreaCaptions,RowAreaFields:this.duplicatePivotTableFieldInfos(e.RowAreaFields),RowHeaderRange:this.duplicateRangeInformation(e.RowHeaderRange),RowLocation:e.RowLocation,RowMemberPropIndexes:e.RowMemberPropIndexes,RowTotalIndexes:e.RowTotalIndexes,RwGrandTotalOn:e.RwGrandTotalOn,SaveSourceDataWithFile:e.SaveSourceDataWithFile,ShowColumnHeaders:e.ShowColumnHeaders,ShowColumnStripes:e.ShowColumnStripes,ShowDrillIndicators:e.ShowDrillIndicators,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowRowHeaders:e.ShowRowHeaders,ShowRowStripes:e.ShowRowStripes,SupportsBIExplore:e.SupportsBIExplore,ValueAreaFields:this.duplicatePivotTableFieldInfos(e.ValueAreaFields),Xluid:e.Xluid,SlicerConnections:e.SlicerConnections,AutoRefresh:e.AutoRefresh,SupportsAutoRefresh:e.SupportsAutoRefresh}},t.prototype.duplicateRangeInformation=function(e){if(e)return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,RangeType:e.RangeType}},t.prototype.duplicatePivotTableFieldInfos=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicatePivotTableFieldInfo(e[n]));return t}},t.prototype.duplicatePivotTableFieldInfo=function(e){return{BaseFieldIndex:e.BaseFieldIndex,Caption:e.Caption,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,Index:e.Index,IsCompactLayout:e.IsCompactLayout,RepeatItemLabels:e.RepeatItemLabels,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotal:e.ShowSubtotal,ShowSubtotalAtTop:e.ShowSubtotalAtTop,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}},t.prototype.duplicateAndSetNewFontInModel=function(e,t){var n=this.model.Fonts.length,r=t?e.RefCount||0:1,i=(0,o.duplicateFont)(e,n,r);return t||(e.RefCount=Math.max(0,(e.RefCount||0)-1)),this.model.Fonts.splice(n,0,i),{newFontId:n,newFont:i}},t.prototype.duplicateSparklineRangeInformations=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicateSparklineRangeInformation(e[n]));return t}},t.prototype.duplicateSparklineRangeInformation=function(e){return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,LocationColumn:e.LocationColumn,LocationRow:e.LocationRow,RangeType:e.RangeType,SparklineType:e.SparklineType}},t.prototype.duplicateRichValueFields=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicateRichValueField(e[n]));return t}},t.prototype.duplicateRichValueField=function(e){return{Index:e.Index,RefersToDotFunction:e.RefersToDotFunction,Value:e.Value}},t.prototype.setContextCellFont=function(e,t){e.font=(0,i.getFontCssStringFromCell)(t,this.model)},t.prototype.setPreviewRangeCellsDirty=function(e){var t={FirstColumn:Math.max(e.FirstColumn-1,0),FirstRow:Math.max(e.FirstRow-1,0),LastColumn:e.LastColumn+1,LastRow:e.LastRow+1};this.setCellsInRangeDirty(t)},t.prototype.setCellsInRangeDirty=function(e){for(var t=0;t<this.model.Cells.length;t++){var n=this.model.Cells[t];(0,a.isModelCellContainedInRange)(this.model,e,n)&&this.setCellAndSpannedOverCellsDirty(n)}},t.prototype.isIndexInOutline=function(e,t,n){var r=n?this.model.RowNumbers.length:this.model.ColumnNumbers.length;if(t.IsNonDefaultDirection){o=-1!==t.ButtonIndex?t.ButtonIndex+1:0,i=-1!==t.StartIndex?t.StartIndex:r-1;if(e>=o&&e<=i)return!0}else{var o=-1!==t.StartIndex?t.StartIndex:0,i=-1!==t.ButtonIndex?t.ButtonIndex-1:r-1;if(e>=o&&e<=i)return!0}return!1},t}(y.BlockModelAccessor);t.GridBlockModelAccessor=x;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.duplicateAndSetFontsInModel=function(t){return e.prototype.duplicateAndSetFontsInModel.call(this,t)},t.prototype.duplicateTextRuns=function(e,t){return(0,o.duplicateTextRuns)(e,t)},t}(x);t.TestableGridBlockModelAccessor=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractableCanvasElement=void 0;var r=n(4),o=n(1),i=n(110),l=n(0),a=n(24),s=n(129),d=n(220),u=n(11),c=n(8),g=n(221),f=n(17),h=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.isHitMapSorted=!0,r.isRegisteredToEvents=!1,r.isListeningToPointerMove=!1,r.lastPointerPosition=a.OutsideCanvasPoint,r.lastPointerDownClickHitRegions=[],r.lastPointerDownTouchEndHitRegions=[],r.lastCursorType=a.UnsetCursorType,r.lastTooltip=a.DefaultTooltip,r.longPressState=(0,s.getDefaultLongPressState)(),r.zoom=1,r.arrayOverflowInvestigationMaxArea=0,r.arrayOverflowInvestigationLogged=!1,r.registeredEventsHitRegions={},r.setDefaultHitMapAxes(r.getWidth(),r.getHeight()),r.pointerDownEventHandler=r.onPointerDown.bind(r),r.pointerUpEventHandler=r.onPointerUp.bind(r),r.pointerMoveEventHandler=r.onPointerMove.bind(r),r.clickEventHandler=r.onClick.bind(r),r.dblClickEventHandler=r.ondblclick.bind(r),r.touchStartEventHandler=r.onTouchStart.bind(r),r.touchEndEventHandler=r.onTouchEnd.bind(r),r.pointerLeaveEventHandler=r.onPointerLeave.bind(r),r}return r.__extends(t,e),t.prototype.addRegionEventListener=function(e){this.cacheRegionAndRegisterEvents(e,e.eventType)},t.prototype.removeAllEventListeners=function(){this.isRegisteredToEvents&&(this.registeredEventsHitRegions.pointerdown&&this.canvas.removeEventListener("pointerdown",this.pointerDownEventHandler),this.registeredEventsHitRegions.pointerup&&this.canvas.removeEventListener("pointerup",this.pointerUpEventHandler),this.registeredEventsHitRegions.click&&(this.canvas.removeEventListener(a.PointerDownEvent,this.pointerDownEventHandler),this.canvas.removeEventListener("click",this.clickEventHandler)),this.registeredEventsHitRegions.touchstart&&this.canvas.removeEventListener("touchstart",this.touchStartEventHandler),this.registeredEventsHitRegions.dblclick&&this.canvas.removeEventListener("dblclick",this.dblClickEventHandler),this.registeredEventsHitRegions.touchend&&this.canvas.removeEventListener("touchend",this.touchEndEventHandler),this.isListeningToPointerMove&&(this.canvas.removeEventListener("pointermove",this.pointerMoveEventHandler),this.canvas.removeEventListener(a.PointerLeaveEvent,this.pointerLeaveEventHandler),this.isListeningToPointerMove=!1),this.registeredEventsHitRegions={},this.isRegisteredToEvents=!1,this.isHitMapSorted=!0)},t.prototype.addCursorRegion=function(e){this.cacheRegionAndRegisterEvents(e,a.CursorEventType)},t.prototype.addTooltipRegion=function(e){this.cacheRegionAndRegisterEvents(e,a.TooltipEventType)},t.prototype.addLongPressRegion=function(e){this.cacheRegionAndRegisterEvents(e,a.LongPressEventType)},t.prototype.dispose=function(){this.removeAllEventListeners(),e.prototype.dispose.call(this)},t.prototype.setHitMapOffsets=function(e,n,r,o,i){if(e.length>a.MaxHitMapOffsetCount||n.length>a.MaxHitMapOffsetCount)throw Error("setHitMapOffsets:: offsets.length exceeds max allowed offsets length. x: ".concat(e.length,", y: ").concat(n.length));var l=i?i.endOffsetX-i.startOffsetX:r,s=t.doOffsetsHaveEqualDistances(e,l),d=t.getFirstOffsetSize(e,r);s&&0===d&&c.ULS.sendTraceTag(522311843,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,"setHitMapOffsets: width:".concat(r," renderingRegion:").concat(JSON.stringify(i)," offsetsX:").concat(JSON.stringify(e),"}")),this.hitMapAxisX={areOffsetsEqual:s,equalOffsetsSize:d,offsets:e};var u=i?i.endOffsetY-i.startOffsetY:o,g=t.doOffsetsHaveEqualDistances(n,u),f=t.getFirstOffsetSize(n,o);g&&0===f&&c.ULS.sendTraceTag(522311872,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,"setHitMapOffsets: height:".concat(o," renderingRegion:").concat(JSON.stringify(i)," offsetsY:").concat(JSON.stringify(n),"}")),this.hitMapAxisY={areOffsetsEqual:g,equalOffsetsSize:f,offsets:n}},t.prototype.optimizeHitMapLookup=function(){this.isHitMapSorted||this.sortHitMap()},t.prototype.setAppZoom=function(e){this.zoom=e},t.prototype.setDimensions=function(t,n,r){e.prototype.setDimensions.call(this,t,n,r),this.setDefaultHitMapAxes(t,n)},t.prototype.cancelLongPressTimer=function(e,t){this.longPressState.callbackScheduled&&!this.longPressState.longPressModeEnabled&&clearTimeout(this.longPressState.callbackId);var n=this.canvas;n&&n.releasePointerCapture&&-1!==this.longPressState.eventPointerId&&n.releasePointerCapture(this.longPressState.eventPointerId),this.longPressState.longPressModeEnabled&&this.handleMouseLongPressEnd(this.longPressState.lastHitRegion),this.longPressState=(0,s.getDefaultLongPressState)();var r=(0,s.getEventCoordinates)(e,t),o=this.getEventCoordinatesInCanvas(r.clientX,r.clientY);this.handlePointerMove(e,o)},t.prototype.getHitMapOffsetsX=function(){return this.hitMapAxisX},t.prototype.getHitMapOffsetsY=function(){return this.hitMapAxisY},t.prototype.getAppZoom=function(){return this.zoom},t.prototype.getIsHitMapSorted=function(){return this.isHitMapSorted},t.prototype.getEventTypeRegisteredEventsHitRegions=function(e){return this.registeredEventsHitRegions[e]},t.prototype.getIntersectingHitMapAreasKeys=function(e){var n=[],r=this.getRenderingRegion();if(!r)return n;var i=0,a=0,s=r.endOffsetX-r.startOffsetX,d=r.endOffsetY-r.startOffsetY;if(!(0,l.intersects1D)(e.x,e.x+e.width,i,i+s)||!(0,l.intersects1D)(e.y,e.y+e.height,a,a+d))return n;var u=t.getOffsetPosition(e.x,this.hitMapAxisX),g=t.getOffsetPosition(e.x+e.width-1,this.hitMapAxisX),f=t.getOffsetPosition(e.y,this.hitMapAxisY),h=t.getOffsetPosition(e.y+e.height-1,this.hitMapAxisY);if((0,o.isChangeGateEnabled)(o.ChangeGate.ArrayOverflowInvestigation)){var C=(g-u)*(h-f);C>32768&&C>this.arrayOverflowInvestigationMaxArea&&(c.ULS.sendTraceTag(508368669,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Important,"InteractableCanvasElement::getIntersectingHitMapAreasKeys: xStartPosition:".concat(u,", xEndPosition:").concat(g,", yStartPosition:").concat(f,", yEndPosition:").concat(h,", area:").concat(C)),this.arrayOverflowInvestigationMaxArea=C,c.ULS.sendTraceTag(508130121,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Important,"InteractableCanvasElement::getIntersectingHitMapAreasKeys: hitMapAxisX:[".concat(this.hitMapAxisX.offsets,"], hitMapAxisY:[").concat(this.hitMapAxisY.offsets,"], region.x:").concat(e.x,", region.width:").concat(e.width,", region.y:").concat(e.y,", region.height:").concat(e.height)))}(u<0||f<0||g>=this.hitMapAxisX.offsets.length||h>=this.hitMapAxisY.offsets.length)&&(this.arrayOverflowInvestigationLogged||(c.ULS.sendTraceTag(508052569,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,"InteractableCanvasElement::getIntersectingHitMapAreasKeys: xStartPosition:".concat(u,", xEndPosition:").concat(g,", yStartPosition:").concat(f,", yEndPosition:").concat(h,", hitMapAxisX:[").concat(this.hitMapAxisX.offsets,"], hitMapAxisY:[").concat(this.hitMapAxisY.offsets,"], region.x:").concat(e.x,", region.width:").concat(e.width,", region.y:").concat(e.y,", region.height:").concat(e.height)),this.arrayOverflowInvestigationLogged=!0),u<0&&(u=0),f<0&&(f=0),g>=this.hitMapAxisX.offsets.length&&(g=this.hitMapAxisX.offsets.length-1),h>=this.hitMapAxisY.offsets.length&&(h=this.hitMapAxisY.offsets.length-1));for(var m=u;m<=g;m++)for(var p=f;p<=h;p++)n.push(t.getHitMapAreaKeyFromOffsetPosition(m,p));return n},t.prototype.getHitMapAreaKeyFromOffset=function(e,n){var r=t.getOffsetPosition(e,this.hitMapAxisX),o=t.getOffsetPosition(n,this.hitMapAxisY);return t.getHitMapAreaKeyFromOffsetPosition(r,o)},t.prototype.isEventStartAndEndInSameRegion=function(e,t,n){if(0===n.length)return!1;var r=(0,s.getEventCoordinates)(e,t),o=r.clientX,i=r.clientY,l=this.getEventCoordinatesInCanvas(o,i),a=this.getIntersectingHitRegions(t,l);return a.length>0&&(0,s.areTwoHitRegionsSame)(n[0],a[0])},t.getHitMapAreaKeyFromOffsetPosition=function(e,t){return(e<<a.HitMapKeyXShift)+t},t.getOffsetPosition=function(e,t){if(t.areOffsetsEqual)return 0===t.equalOffsetsSize&&(0,l.throwError)("areOffsetsEqual cannot be 0","getOffsetPosition"),Math.floor(e/t.equalOffsetsSize);var n=(0,l.binarySearch)(t.offsets,0,t.offsets.length,e,l.numbersComparer);return n<0?~n-1:n},t.doOffsetsHaveEqualDistances=function(e,t){if(e.length<2)return!0;for(var n=e[1],r=2;r<e.length;r++)if(e[r]-e[r-1]!==n)return!1;return t-e[e.length-1]===n},t.prototype.getDefaultHitMapAxis=function(e){for(var t=Math.floor(e/a.DefaultHitMapSectionsCount),n=[],r=0;r<a.DefaultHitMapSectionsCount;r++)n.push(r*t);return 0===t&&c.ULS.sendTraceTag(522311873,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,"InteractableCanvasElement::getDefaultHitMapAxis: totalSize:".concat(e)),{areOffsetsEqual:!0,equalOffsetsSize:t,offsets:n}},t.getFirstOffsetSize=function(e,t){return e.length<2?t:e[1]},t.prototype.onPointerDown=function(e){if(!(0,u.shouldHitTestHandleEvent)())return!1;var t=this.getEventCoordinatesInCanvas(e.clientX,e.clientY);return this.lastPointerDownClickHitRegions=this.getIntersectingHitRegions("click",t),this.handleMouseLongPress(e,"pointerdown"),this.onBasicPointerEvent(e,"pointerdown",this.pointerDownEventHandler)},t.prototype.onPointerUp=function(e){return this.longPressState.callbackScheduled&&this.cancelLongPressTimer(e,"pointerup"),this.onBasicPointerEvent(e,"pointerup",this.pointerUpEventHandler)},t.prototype.onPointerLeave=function(e){return((0,o.isChangeGateEnabled)(o.ChangeGate.FixOnCanvasPointerLeave)||(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.UnhideRowColumnSkittleSlice2",!1))&&this.handleMouseLeaveEventTriggering(e,a.OutsideCanvasPoint),this.lastPointerPosition=a.OutsideCanvasPoint,this.canvas.style.cursor=a.UnsetCursorType,this.lastCursorType=a.UnsetCursorType,!0},t.prototype.onClick=function(e){return!(!(0,u.shouldHitTestHandleEvent)()||!this.isEventStartAndEndInSameRegion(e,"click",this.lastPointerDownClickHitRegions))&&this.onBasicPointerEvent(e,"click",this.clickEventHandler)},t.prototype.ondblclick=function(e){if(!(0,u.shouldHitTestHandleEvent)())return!1;return this.onBasicPointerEvent(e,"dblclick",this.dblClickEventHandler)},t.prototype.onTouchStart=function(e){var t,n,r,o;if(!(0,u.shouldHitTestHandleEvent)())return!1;var i=this.getEventCoordinatesInCanvas(null===(n=null===(t=e.touches)||void 0===t?void 0:t[0])||void 0===n?void 0:n.clientX,null===(o=null===(r=e.touches)||void 0===r?void 0:r[0])||void 0===o?void 0:o.clientY);this.lastPointerDownTouchEndHitRegions=this.getIntersectingHitRegions("touchend",i);return this.onBasicPointerEvent(e,"touchstart",this.touchStartEventHandler)},t.prototype.onTouchEnd=function(e){return!(!(0,u.shouldHitTestHandleEvent)()||!this.isEventStartAndEndInSameRegion(e,"touchend",this.lastPointerDownTouchEndHitRegions))&&this.onBasicPointerEvent(e,"touchend",this.touchEndEventHandler)},t.prototype.onBasicPointerEvent=function(e,t,n){var r=this;return(0,d.trackEventCallbackDuration)((function(){return r.isEventHasRegisteredHandlers(t)?r.handleBasicPointerEvents(t,e):(r.removeUnnecessaryEventListeners(t,n),!0)}),t)},t.prototype.removeUnnecessaryEventListeners=function(e,t){this.isEventHasRegisteredHandlers("longpress")||(e!==a.PointerDownEvent||this.isEventHasRegisteredHandlers("click")?e===a.PointerUpEvent&&this.canvas.removeEventListener(e,t):this.canvas.removeEventListener(e,t))},t.prototype.onPointerMove=function(e){var t=this;if((0,u.shouldHitTestHandleEvent)()){(0,d.trackEventCallbackDuration)((function(){var n=t.getEventCoordinatesInCanvas(e.clientX,e.clientY);t.handlePointerMove(e,n)}),a.PointerMoveEvent)}},t.prototype.handleBasicPointerEvents=function(e,t){var n=(0,s.getEventCoordinates)(t,e),r=this.getEventCoordinatesInCanvas(n.clientX,n.clientY),o=this.getIntersectingHitRegions(e,r);return this.propagateEventToHandlers(t,o,e,(function(){return!0}))},t.prototype.handlePointerMove=function(e,t){this.longPressState.longPressModeEnabled||(this.handleMouseLeaveEventTriggering(e,t),this.handleMouseEnterEventTriggering(e,t),this.handleCursorType(e,t),this.handleTooltipChange(t)),this.lastPointerPosition=t},t.prototype.handleMouseLeaveEventTriggering=function(e,t){if(this.lastPointerPosition!==a.OutsideCanvasPoint){var n=this.getIntersectingHitRegions("mouseleave",this.lastPointerPosition);this.propagateEventToHandlers(e,n,"mouseleave",(function(e){return t===a.OutsideCanvasPoint||!(0,l.isPointInRect)(e.region,t)}))}},t.prototype.handleMouseEnterEventTriggering=function(e,t){var n=this;if(t!==a.OutsideCanvasPoint){var r=this.getIntersectingHitRegions("mouseenter",t);this.propagateEventToHandlers(e,r,"mouseenter",(function(e){return n.lastPointerPosition===a.OutsideCanvasPoint||!(0,l.isPointInRect)(e.region,n.lastPointerPosition)}))}},t.prototype.propagateEventToHandlers=function(e,t,n,r){var o=Number.MAX_SAFE_INTEGER;this.getIsRegionCollisionTelemetryEnabled()&&(0,g.logOverlappingRegions)(n,t);for(var i=0;i<t.length;i++){var l=t[i];if(l.zIndex>o)throw Error("handleEventPropagationToHandlers: expected handlers to be sorted by z-index, highest first. latestZIndex=".concat(o,", currentZIndex=").concat(l.zIndex,", eventType: ").concat(n,", totalHandlersCount=").concat(t.length));if(r(l)){var a=l.callback(e);if("boolean"==typeof a){if(a)return e.stopPropagation(),e.preventDefault(),!1}else if(a.handled)return a.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1}o=l.zIndex}return!0},t.prototype.handleCursorType=function(e,t){var n=a.UnsetCursorType;if(t!==a.OutsideCanvasPoint){var r=this.getIntersectingHitRegions(a.CursorEventType,t);if(r&&r.length>0){this.getIsRegionCollisionTelemetryEnabled()&&(0,g.logOverlappingRegions)("cursor",r);var o=r.find((function(t){return t.shouldChangeCursor(e)}));o&&(n=o.cursorType)}}this.lastCursorType!==n&&(this.lastCursorType=n,this.canvas.style.cursor=n)},t.prototype.handleTooltipChange=function(e){var t=this,n=a.DefaultTooltip,r=void 0;if(e!==a.OutsideCanvasPoint){var o=this.getIntersectingHitRegions(a.TooltipEventType,e);if(o&&o.length>0){this.getIsRegionCollisionTelemetryEnabled()&&(0,g.logOverlappingRegions)("tooltip",o);var i=o[0],l=i.region;n=i.tooltipText,r=this.getHitMapAreaKeyFromOffset(l.x,l.y)}}var s=this.lastTooltipHitRegionKey!==r,d=this.lastTooltip!==n;if(d||s){if(this.lastTooltip=n,this.lastTooltipHitRegionKey=r,s&&!d)return this.canvas.setAttribute("title",a.DefaultTooltip),void setTimeout((function(){t.canvas.setAttribute("title",n)}),0);this.canvas.setAttribute("title",n)}},t.prototype.handleMouseLongPressStart=function(e){e&&e.onStart()},t.prototype.handleMouseLongPressEnd=function(e){e&&e.onEnd()},t.prototype.getLongPressHitRegion=function(e){if(e!==a.OutsideCanvasPoint){var t=this.getIntersectingHitRegions(a.LongPressEventType,e);if(t&&t.length>0)return t[0]}},t.prototype.cacheRegionAndRegisterEvents=function(e,t){this.registeredEventsHitRegions[t]||this.registerHandlersForEvent(t);var n=this.getEventHitAreaMap(t);this.addHitRegion(e,n)},t.prototype.registerHandlersForEvent=function(e){switch(e){case"pointerdown":this.canvas.addEventListener(e,this.pointerDownEventHandler);break;case"pointerup":this.canvas.addEventListener(e,this.pointerUpEventHandler);break;case"click":this.canvas.addEventListener(a.PointerDownEvent,this.pointerDownEventHandler),this.canvas.addEventListener(e,this.clickEventHandler);break;case"dblclick":this.canvas.addEventListener(e,this.dblClickEventHandler);break;case"touchstart":this.canvas.addEventListener(e,this.touchStartEventHandler);break;case"touchend":this.canvas.addEventListener(e,this.touchEndEventHandler);break;case"longpress":this.canvas.addEventListener(a.PointerDownEvent,this.pointerDownEventHandler),this.canvas.addEventListener(a.PointerUpEvent,this.pointerUpEventHandler);break;case"cursor":case"tooltip":case"mouseenter":case"mouseleave":this.isListeningToPointerMove||(this.canvas.addEventListener(a.PointerMoveEvent,this.pointerMoveEventHandler),this.canvas.addEventListener(a.PointerLeaveEvent,this.pointerLeaveEventHandler),this.isListeningToPointerMove=!0)}this.isRegisteredToEvents=!0},t.prototype.getEventHitAreaMap=function(e){return this.registeredEventsHitRegions[e]||(this.registeredEventsHitRegions[e]={}),this.registeredEventsHitRegions[e]},t.prototype.addHitRegion=function(e,t){for(var n=this.getIntersectingHitMapAreasKeys(e.region),r=0;r<n.length;r++){var o=n[r];t[o]||(t[o]=[]),t[o].push(e)}this.isHitMapSorted=!1},t.prototype.setDefaultHitMapAxes=function(e,t){this.hitMapAxisX=this.getDefaultHitMapAxis(e),this.hitMapAxisY=this.getDefaultHitMapAxis(t)},t.prototype.getEventCoordinatesInCanvas=function(e,t){var n=e/this.zoom,r=t/this.zoom,o=this.canvas.getBoundingClientRect();return{x:n-o.left,y:r-o.top}},t.prototype.getIntersectingHitRegions=function(e,t){var n=[];if(this.registeredEventsHitRegions[e]){var r=this.getHitMapAreaKeyFromOffset(t.x,t.y);this.optimizeHitMapLookup();var o=this.registeredEventsHitRegions[e][r];if(o&&o.length>0)for(var i=0;i<o.length;i++){var a=o[i];(0,l.isPointInRect)(a.region,t)&&n.push(a)}}return n},t.prototype.isEventHasRegisteredHandlers=function(e){return!!this.registeredEventsHitRegions&&!!this.registeredEventsHitRegions[e]},t.prototype.sortHitMap=function(){for(var e=Object.keys(this.registeredEventsHitRegions),t=0;t<e.length;t++)for(var n=this.registeredEventsHitRegions[e[t]],r=Object.keys(n),o=0;o<r.length;o++){var i=parseInt(r[o],10);n[i]=n[i].sort(s.hitRegionComparer)}this.isHitMapSorted=!0},t.prototype.handleMouseLongPress=function(e,t){var n=this,r=1===e.button,o="touch"===e.pointerType;if((!this.longPressState.callbackScheduled||e.target&&r)&&!o){var i=(0,s.getEventCoordinates)(e,t),l=this.getEventCoordinatesInCanvas(i.clientX,i.clientY),d=this.getLongPressHitRegion(l);if(d){var u=e.target,c=e.pointerId;u&&u.setPointerCapture&&-1!==c&&u.setPointerCapture(c),this.longPressState.callbackId=window.setTimeout((function(){n.onLongPress()}),a.MinLongPressDurationMs),this.longPressState.callbackScheduled=!0,this.longPressState.eventPointerId=c,this.longPressState.lastHitRegion=d}}},t.prototype.onLongPress=function(){this.canvas.style.cursor=a.UnsetCursorType,this.lastCursorType=a.UnsetCursorType,this.longPressState.longPressModeEnabled=!0,this.handleMouseLongPressStart(this.longPressState.lastHitRegion)},t.prototype.getIsRegionCollisionTelemetryEnabled=function(){var e;return void 0===this.isRegionCollisionTelemetryEnabled&&(this.isRegionCollisionTelemetryEnabled=(0,f.getBooleanFeatureGate)("Microsoft.Office.Excel.RegionCollisionTelemetry",void 0)),null!==(e=this.isRegionCollisionTelemetryEnabled)&&void 0!==e&&e},t}(i.RenderingCanvasElement);t.InteractableCanvasElement=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackEventCallbackDuration=void 0;var r,o,i=n(13),l=n(8),a=n(11);!function(e){e[e.Inactive=0]="Inactive",e[e.Active=1]="Active",e[e.Cooldown=2]="Cooldown"}(r||(r={})),function(e){e[e.Inactive=0]="Inactive",e[e.Cooldown=1]="Cooldown"}(o||(o={}));var s=r.Inactive,d=o.Inactive,u={};function c(){var e=(0,a.getServiceSetting)(1,4e3);s=r.Cooldown,function(){if(d===o.Inactive){d=o.Cooldown;var e=(0,a.getServiceSetting)(2,6e4);setTimeout((function(){var e;e=JSON.stringify(u),l.ULS.sendTraceTag(574648710,l.LogCategory.msoulscat_ES_EWAJSGrid,l.TraceLevel.Info,"HitTest::Telemetry::sendMeasurementResults: ".concat(e)),u={},d=o.Inactive}),e)}}(),setTimeout((function(){s=r.Inactive}),e)}t.trackEventCallbackDuration=function(e,t){return function(){if(s===r.Inactive){var e=(0,a.getServiceSetting)(0,1e3);s=r.Active,setTimeout(c,e)}return s===r.Active}()?function(e,t){var n=i.perf?i.perf.now():-1,r=e();if(i.perf){var o=i.perf.now()-n;u[t]||(u[t]=[]),u[t].push(o.toFixed(4))}return r}(e,t):e()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logOverlappingRegions=void 0;var r=n(8),o=new Map;t.logOverlappingRegions=function(e,t){if(t&&!(t.length<=1)){var n=JSON.stringify(t.map((function(e){return e.zIndex})));o.has(e)||o.set(e,[]),o.get(e).includes(n)||(o.get(e).push(n),r.ULS.sendTraceTag(508403979,r.LogCategory.msoulscat_ES_EWAJSGrid,r.TraceLevel.Info,"logRegionCollision: source:".concat(e,", regions:").concat(n)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderBlockModelAccessor=void 0;var r=n(4),o=n(1),i=n(131),l=n(0),a=n(5),s=n(73),d=n(2),u=n(223),c=n(8),g=n(7),f=n(132),h=function(e){function t(t,n){var r=e.call(this,t)||this;return r.isRow=n,r.processStyles(t),r}return r.__extends(t,e),t.verifyArgumentNotNull=function(e,t,n){(0,a.verifyArgumentNotNull)(e,t,"HeaderBlockModelAccessor.".concat(n))},t.throwErrorWrapper=function(e,t){(0,l.throwError)(e,"HeaderBlockModelAccessor.".concat(t))},t.isCellSnapped=function(e){return t.verifyArgumentNotNull(e,"cell","isCellSnapped"),(0,o.isChangeGateEnabled)(o.ChangeGate.FixHeaderSnappingAutoFilterNone)?!!e.IsCellSnapped:!!e.AutoFilter},t.prototype.setIsCellSnapped=function(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setIsCellSnapped"),this.model.Cells[e].IsCellSnapped=t||void 0},t.prototype.isCellSnapped=function(e){this.verifyRelativeIndexOfRowColNumbers(e,"isCellSnapped");var n=this.model.Cells[e];return t.isCellSnapped(n)},t.prototype.getHeaderBlockModel=function(){return this.model},t.prototype.getIsHeaderSnapped=function(){return!!(0,o.getModelClientCache)(this.model).isHeaderSnapped},t.prototype.setIsHeaderSnapped=function(e){(0,o.getModelClientCache)(this.model).isHeaderSnapped=e},t.prototype.setStyleId=function(e,n){t.verifyArgumentNotNull(n,"styleId","setStyleId");var r=this.getCell(e);if(!r)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");return(r.StyleID||0)!==n&&(r.StyleID=n,(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderHeaderSnappingInCanvas,this.model)&&t.isCellSnapped(r)&&this.updateCellAlignmentFromCenterToLeftRight(r),this.updateGlobalCellStyleID(r),!0)},t.prototype.getStyleId=function(e){var t=this.getCell(e);if(!t)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");return t.StyleID||0},t.prototype.updateStylesForNamedSheetView=function(e){var t=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.FluentStyle,this.model);if(t){var n=(0,o.isIncreasedHeaderSizeEnabled)(this.model)?(0,o.getRowHeaderStylesArray)(o.ViewMode.NamedSheetView,this.model.IsRtl):o.RowHeadersNSVStylesArrayBeforeHeaderDragImprovements;this.model.Styles=e?n:o.ColumnHeadersNSVStylesArray}else this.model.Styles=e?o.RowHeadersNSVStylesArrayBeforeFluent:o.ColumnHeadersNSVStylesArrayBeforeFluent;(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.NewDefaultTemplate,this.model)&&(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,this.model)?this.model.Fonts=t?o.HeadersNSVFonts:o.HeadersNSVFontsBeforeFluent:this.model.Fonts=t?o.OldHeadersNSVFonts:o.OldHeadersNSVFontsBeforeFluent,this.processStyles(this.model)},t.prototype.updateStylesForDefaultViewMode=function(e){var t=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.FluentStyle,this.model);if(t){var n=(0,o.isIncreasedHeaderSizeEnabled)(this.model)?(0,o.getRowHeaderStylesArray)(o.ViewMode.Default,this.model.IsRtl):o.RowHeadersStylesArrayBeforeHeaderDragImprovements;this.model.Styles=e?n:o.ColumnHeadersStylesArray}else this.model.Styles=e?o.RowHeadersStylesArrayBeforeFluent:o.ColumnHeadersStylesArrayBeforeFluent;(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.NewDefaultTemplate,this.model)&&(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.NewThemeFontForHeaderFBarNBox,this.model)?this.model.Fonts=t?o.HeadersFonts:o.HeadersFontsBeforeFluent:this.model.Fonts=t?o.OldHeadersFonts:o.OldHeadersFontsBeforeFluent,this.processStyles(this.model)},t.prototype.updateSpillInformation=function(e,t){var n=this.getOrCreateCanvasContext(),r=e*t;(0,d.isAdjustedForDrawingOffsetsInitialized)(this.model)||(0,d.initializeOffsetsForDrawing)(this.model,r);for(var o=0,i=this.model.Cells;o<i.length;o++){var a=i[o];(0,l.verifyCellStyleAndFont)(this.model,a,"updateSpillInformation"),a.Spill=void 0,(0,s.updateCellSpill)(n,this.model,a,e,t)}},t.prototype.setCellExtent=function(e,n){var r=this.isRow?this.model.RowHeights:this.model.ColumnWidths;t.verifyArgumentNotNull(r,"blockExtents","setCellExtent");var i=this.isRow?this.model.RowOffsets:this.model.ColumnOffsets;t.verifyArgumentNotNull(i,"blockOffsets","setCellExtent"),(e>r.length-1||e<0)&&t.throwErrorWrapper("Cell not in model","setCellExtent"),n<=0&&t.throwErrorWrapper("Cell extent cannot be a non positive value","setCellExtent"),(0,u.setCellExtent)(this.model,e,n,!this.isRow),this.setDirty("setCellExtent",o.DirtyType.ModelCoreChanges)},t.prototype.getCellExtent=function(e){var n=this.isRow?this.model.RowHeights:this.model.ColumnWidths;return t.verifyArgumentNotNull(n,"blockExtents","getCellExtent"),(e>n.length-1||e<0)&&t.throwErrorWrapper("Cell not in model","getCellExtent"),n[e]},t.prototype.getAutoFilterMenuOffsetsFromCellStart=function(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"getAutoFilterMenuOffsetsFromCellStart");var r=this.model.Cells[e];return this.getAutoFilterMenuOffsetsFromCellStartInternal(r,t,n)},t.prototype.getAutoFilterButtonTotalSize=function(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"getAutoFilterButtonTotalSize");var r=this.model.Cells[e];return this.getAutoFilterButtonTotalSizeInternal(r,t,n)},t.prototype.addRowColToModel=function(e,t){(0,u.addRowColToModel)(this.model,this,e,t,this.isRow)},t.prototype.updateCellText=function(e,n){t.verifyArgumentNotNull(n,"text","updateCellText"),this.verifyRelativeIndexOfRowColNumbers(e,"updateCellText");var r=this.model.Cells[e];r.Text=n,r.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0}},t.prototype.setUnsetShowResizePill=function(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetShowResizePill"),this.model.Cells[e].ShowResizePill=t},t.prototype.setUnsetHoveredCell=function(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetHoveredCell"),this.model.Cells[e].IsHovered=t},t.prototype.setInsertButton=function(e,t,n,r){this.verifyRelativeIndexOfRowColNumbers(e,"setInsertButton"),(0,a.verifyArgumentNotNull)(n,"buttonType","setInsertButton");var i=this.model.Cells[e];(0,g.isNullOrUndefined)(i.InsertButtons)&&(i.InsertButtons={Start:void 0,End:void 0});var l={Type:n,Offset:r},s=!1,d=0;return t?this.areInsertButtonsSame(i.InsertButtons.Start,l)||((0,o.isChangeGateEnabled)(o.ChangeGate.FixInsertButtonSpill)&&(d=Math.max((0,f.getInsertButtonSize)(l,!0),(0,f.getInsertButtonSize)(i.InsertButtons.Start,!0))),i.InsertButtons.Start=l,s=!0):this.areInsertButtonsSame(i.InsertButtons.End,l)||((0,o.isChangeGateEnabled)(o.ChangeGate.FixInsertButtonSpill)&&(d=Math.max((0,f.getInsertButtonSize)(i.InsertButtons.End,!1),(0,f.getInsertButtonSize)(l,!1))),i.InsertButtons.End=l,s=!0),(0,o.isChangeGateEnabled)(o.ChangeGate.FixInsertButtonSpill)&&s&&this.setCellsDirtyForInsertButtonSpillOnUpdate(e,t,d),s},t.prototype.removeInsertButton=function(e,t){var n,r,i,l;this.verifyRelativeIndexOfRowColNumbers(e,"removeInsertButton");var a=this.model.Cells[e],s=!1,d=0;return t?(null===(n=a.InsertButtons)||void 0===n?void 0:n.Start)&&((0,o.isChangeGateEnabled)(o.ChangeGate.FixInsertButtonSpill)&&(d=(0,f.getInsertButtonSize)(null===(r=a.InsertButtons)||void 0===r?void 0:r.Start,!0)),a.InsertButtons.Start=void 0,s=!0):(null===(i=a.InsertButtons)||void 0===i?void 0:i.End)&&((0,o.isChangeGateEnabled)(o.ChangeGate.FixInsertButtonSpill)&&(d=(0,f.getInsertButtonSize)(null===(l=a.InsertButtons)||void 0===l?void 0:l.End,!1)),a.InsertButtons.End=void 0,s=!0),(0,o.isChangeGateEnabled)(o.ChangeGate.FixInsertButtonSpill)&&s&&this.setCellsDirtyForInsertButtonSpillOnUpdate(e,t,d),s},t.prototype.updateCellAlignment=function(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"updateCellAlignment");var n=this.model.Cells[e];t?this.updateCellAlignmentFromCenterToLeftRight(n):this.updateCellAlignmentFromLeftRightToCenter(n),this.updateGlobalCellStyleID(n)},t.prototype.activateCellAutoFilter=function(e,t){this.verifyAutoFilterArguments(e,t),this.model.Cells[e].AutoFilter=t},t.prototype.deactivateCellAutoFilter=function(e){this.verifyRelativeIndexOfRowColNumbers(e,"deactivateCellAutoFilter"),this.isRow&&t.throwErrorWrapper("AutoFilter in headerSnapping should be deactivated only for column header, but called for row header","deactivateCellAutoFilter"),this.model.Cells[e].AutoFilter=void 0},t.prototype.getCellAutoFilterCommandData=function(e){this.verifyRelativeIndexOfRowColNumbers(e,"getCellAutoFilterCommandData");var n=this.model.Cells[e].AutoFilter;return n||t.throwErrorWrapper("AutoFilter should be initialized by now but is undefined, cellRelativeIndex=".concat(e),"getCellAutoFilterCommandData"),n.CommandData},t.prototype.removeRowColFromModel=function(e,t){(0,u.removeRowColFromModel)(this.model,this,e,t,this.isRow)},t.prototype.isLastRowColOfPreviousBlockHidden=function(){var e,t;return this.isRow?!!(null===(e=this.model.AdjacentBlocksHiddensInfo)||void 0===e?void 0:e.IsLastRowOfPrevBlockHidden):!!(null===(t=this.model.AdjacentBlocksHiddensInfo)||void 0===t?void 0:t.IsLastColOfPrevBlockHidden)},t.prototype.setCellDirty=function(e){var n,r=this.isRow?this.model.RowHeights:this.model.ColumnWidths;if(t.verifyArgumentNotNull(r,"blockExtents","setCellDirty"),(e>r.length-1||e<0)&&t.throwErrorWrapper("Cell index ".concat(e," not in model, length ").concat(r.length),"setCellDirty"),(0,o.isChangeGateEnabled)(o.ChangeGate.FixInsertButtonSpill))n=this.ensureDirtyCellsKeysInitialized();else{var i=(0,o.getModelClientCache)(this.model);i.DirtyCellsKeys||(i.DirtyCellsKeys=[]),n=i.DirtyCellsKeys}this.addCellToDirtyCellKeys(e,n),this.setAdjacentCellsDirtyIfHidden(e,n),(0,o.isChangeGateEnabled)(o.ChangeGate.FixInsertButtonSpill)&&this.setCellsDirtyForInsertButtonSpillsForCell(e,n),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.DelayRenderToNextAnimationFrame,this.model)?this.setDirtyInternal(o.DirtyType.ModelCellChanges,!0):this.setDirtyInternal(o.DirtyType.ModelCellChanges)},t.prototype.getCell=function(e){return this.model.Cells[e]},t.prototype.updateCellAlignmentFromCenterToLeftRight=function(e){t.verifyArgumentNotNull(e,"cell","updateCellAlignmentLeftRight"),null!==e.StyleID&&void 0!==e.StyleID||(e.StyleID=o.UniqueHeadersStyleID.Default);var n=this.model.IsRtl;switch(e.StyleID){case o.UniqueHeadersStyleID.Default:e.StyleID=n?o.UniqueHeadersStyleID.RightAlignment:o.UniqueHeadersStyleID.LeftAlignment;break;case o.UniqueHeadersStyleID.Hover:e.StyleID=n?o.UniqueHeadersStyleID.HoverRightAlignment:o.UniqueHeadersStyleID.HoverLeftAlignment;break;case o.UniqueHeadersStyleID.PartialRowColSelection:e.StyleID=n?o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment;break;case o.UniqueHeadersStyleID.PartialSelectionAndHover:e.StyleID=n?o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment;break;case o.UniqueHeadersStyleID.WholeSelectionAndHover:e.StyleID=n?o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment;break;case o.UniqueHeadersStyleID.WholeRowColSelection:e.StyleID=n?o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment;break;default:c.ULS.sendTraceTag(509216715,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,"updateCellAlignmentLeftRight: cell's styleId is unexpected, styleId=".concat(e.StyleID,", cell.col=").concat(e.Col))}},t.prototype.updateCellAlignmentFromLeftRightToCenter=function(e){switch(t.verifyArgumentNotNull(e,"cell","updateCellAlignmentCenter"),null!==e.StyleID&&void 0!==e.StyleID||(e.StyleID=o.UniqueHeadersStyleID.LeftAlignment),e.StyleID){case o.UniqueHeadersStyleID.RightAlignment:case o.UniqueHeadersStyleID.LeftAlignment:e.StyleID=o.UniqueHeadersStyleID.Default;break;case o.UniqueHeadersStyleID.HoverRightAlignment:case o.UniqueHeadersStyleID.HoverLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.Hover;break;case o.UniqueHeadersStyleID.PartialRowColSelectionRightAlignment:case o.UniqueHeadersStyleID.PartialRowColSelectionLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.PartialRowColSelection;break;case o.UniqueHeadersStyleID.PartialSelectionAndHoverRightAlignment:case o.UniqueHeadersStyleID.PartialSelectionAndHoverLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.PartialSelectionAndHover;break;case o.UniqueHeadersStyleID.WholeSelectionAndHoverRightAlignment:case o.UniqueHeadersStyleID.WholeSelectionAndHoverLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.WholeSelectionAndHover;break;case o.UniqueHeadersStyleID.WholeRowColSelectionRightAlignment:case o.UniqueHeadersStyleID.WholeRowColSelectionLeftAlignment:e.StyleID=o.UniqueHeadersStyleID.WholeRowColSelection;break;default:c.ULS.sendTraceTag(509216714,c.LogCategory.msoulscat_ES_EWAJSGrid,c.TraceLevel.Info,"updateCellAlignmentCenter: cell's styleId is unexpected, styleId=".concat(e.StyleID,", cell.col=").concat(e.Col))}},t.prototype.verifyRelativeIndexOfRowColNumbers=function(e,n){var r=this.isRow?this.model.RowNumbers.length:this.model.ColumnNumbers.length;(e<0||e>=r)&&t.throwErrorWrapper("Invalid header relative index, received index=".concat(e,", but headerNumbers.length=").concat(r),n)},t.prototype.verifyAutoFilterArguments=function(e,n){this.isRow&&t.throwErrorWrapper("AutoFilter in headerSnapping should be activated only for column header, but called for row header","activateCellAutoFilter"),t.verifyArgumentNotNull(n,"autoFilterData","activateCellAutoFilter"),this.verifyRelativeIndexOfRowColNumbers(e,"activateCellAutoFilter")},t.prototype.setAdjacentCellsDirtyIfHidden=function(e,t){var n=this.isRow?this.model.RowNumbers:this.model.ColumnNumbers;this.isPrevCellHidden(n,e)&&this.addCellToDirtyCellKeys(e-1,t),this.isNextCellHidden(n,e)&&this.addCellToDirtyCellKeys(e+1,t)},t.prototype.setCellsDirtyForInsertButtonSpillOnUpdate=function(e,t,n){var r=this,o=this.ensureDirtyCellsKeysInitialized();(0,f.setCellsDirtyForInsertButtonSpill)(this.model,this,e,t,n,(function(e){return r.addCellToDirtyCellKeys(e,o)}))},t.prototype.setCellsDirtyForInsertButtonSpillsForCell=function(e,t){var n,r,o=this,i=function(e){return o.addCellToDirtyCellKeys(e,t)},l=this.model.Cells[e],a=(0,f.getInsertButtonSize)(null===(n=l.InsertButtons)||void 0===n?void 0:n.Start,!0),s=(0,f.getInsertButtonSize)(null===(r=l.InsertButtons)||void 0===r?void 0:r.End,!1);(0,f.setCellsDirtyForInsertButtonSpill)(this.model,this,e,!0,a,i),(0,f.setCellsDirtyForInsertButtonSpill)(this.model,this,e,!1,s,i)},t.prototype.processStyles=function(e){(0,a.verifyArgumentNotNull)(e,"model","processStyles"),(0,a.verifyArgumentNotNull)(e.Fonts,"model.Fonts","HeaderBlockModelAccessor:processStyles"),(0,a.verifyArgumentNotNull)(e.Styles,"model.Styles","HeaderBlockModelAccessor:processStyles");var t=e.Fonts,n=e.Styles;if((0,o.isGlobalFontsAndCellStylesFlightEnabled)(e)){try{this.processStylesWithGlobalFonts(n,t)}catch(e){(0,o.disableGlobalFonts)("HeaderBlockModelAccessor::ProcessStyle:: Fonts Processing failed with exception ".concat(e))}try{this.processCellsWithGlobalCellStyles(e.Cells,e.Styles)}catch(e){(0,o.disableGlobalCellStyles)("HeaderBlockModelAccessor::ProcessStyle:: Cell Styles Processing failed with exception ".concat(e))}}},t.prototype.processStylesWithGlobalFonts=function(e,t){(0,o.getGlobalFontsMap)().process(t);for(var n=0;n<e.length;n++){var r=e[n];if(r){var i=r.FontID||0,l=(0,o.getGlobalStyleId)(i,t);if(null==l)throw new Error("HeaderBlockModelAccessor::preprocessStylesWithGlobalFonts: Local FontID ".concat(i," not mapped to a Global Font ID"));r.GlobalFontID=l}}},t.prototype.processCellsWithGlobalCellStyles=function(e,t){(0,o.getGlobalCellStylesMap)().process(t);for(var n=0;n<e.length;n++){var r=e[n];this.updateGlobalCellStyleID(r)}},t.prototype.updateGlobalCellStyleID=function(e){if((0,o.isGlobalFontsAndCellStylesFlightEnabled)(this.model)){var t=e.StyleID||0,n=(0,o.getGlobalStyleId)(t,this.model.Styles);if(null==n)throw new Error("HeaderBlockModelAccessor::updateGlobalCellStyleID: Local Cell StyleID ".concat(t," not mapped to a Global Style ID"));e.GlobalCellStyleID=n}},t.prototype.addCellToDirtyCellKeys=function(e,t){var n=this.getHeaderRegularCellsIndex(),r=this.isRow?e:n,i=this.isRow?n:e;t.push((0,o.getCellLookupKey)(r,i))},t.prototype.getHeaderRegularCellsIndex=function(){return(0,d.doesHeaderModelContainOutlines)(this.model,this.isRow)?1:0},t.prototype.areInsertButtonsSame=function(e,t){return(null==e?void 0:e.Type)===(null==t?void 0:t.Type)&&(null==e?void 0:e.Offset)===(null==t?void 0:t.Offset)},t.prototype.isPrevCellHidden=function(e,t){return t>0&&e[t]>e[t-1]+1},t.prototype.isNextCellHidden=function(e,t){return t<e.length-1&&e[t+1]>e[t]+1},t}(i.BlockModelAccessor);t.HeaderBlockModelAccessor=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeRowColFromModel=t.addRowColToModel=t.setCellExtent=void 0;var r=n(1),o=n(0);function i(e,t,n,o){if((0,r.isRenderFlagEnabled)(r.RenderFlagsArray.RenderHeaderOutlinesInCanvas,e)){var i=t?e.RowOutlinesInformation:e.ColumnOutlinesInformation;if(i)for(var l=i.length,a=0;a<l;a++)for(var s=i[a],d=s.Outlines.length,u=0;u<d;u++){var c=s.Outlines[u],g=n===c.ButtonIndex&&!!c.IsButtonHidden;c.ButtonIndex>-1&&n<=c.ButtonIndex&&!g&&(o?c.ButtonIndex++:c.ButtonIndex--);var f=c.IsNonDefaultDirection?n<=c.StartIndex:n<c.StartIndex;c.StartIndex>-1&&f&&(o?c.StartIndex++:c.StartIndex--)}}}function l(e){return e?28:30}function a(e,t,n,i,l,a,s,d){var c=function(e,t,n){return n?t-e:t}(n,i,s),g=(0,r.createHeaderCell)(c,l,t,a,s);(0,o.addNewValueToArray)(e,i,g),u(e,i+1,s?2*n:n,t,d)}function s(e,t,n,r,i){(0,o.removeValueFromArray)(e,t),u(e,t,n,r,i)}function d(e,t,n){for(var r=t;r<e.length;r++)e[r]=e[r]+n}function u(e,t,n,r,o){for(var i=t;i<n;i++){var l=e[i],a=i===o;if(r){var s=a?-1:e[i-1].Row;l.Row=s+1}else{s=a?-1:e[i-1].Col;l.Col=s+1}}}function c(e,t){if(!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.RenderHeaderOutlinesInCanvas,e))return!1;var n=t?e.MaxRowOutlineLevelInSheet:e.MaxColOutlineLevelInSheet;return!!n&&n>0}t.setCellExtent=function(e,t,n,r){var o=r?e.ColumnWidths:e.RowHeights,i=n-o[t];0!==i&&(o[t]=n,d(r?e.ColumnOffsets:e.RowOffsets,t+1,i),r?e.BlockWidth+=i:e.BlockHeight+=i)},t.addRowColToModel=function(e,t,n,s,u){var g,f,h,C=u?e.RowNumbers:e.ColumnNumbers;if(C.indexOf(n)>=0)throw Error("addRowColToModel: Invalid absolute index. ".concat(u?"Row":"Column"," ").concat(n," already exists in model"));if(s<0||s>C.length)throw Error("addRowColToModel: Invalid relative index.");!function(e,t,n,r){var o=(r?e.RowNumbers.length:e.ColumnNumbers.length)+1,i=c(e,r);if(a(e.Cells,r,o,n,t,i,!1,0),i){var s=n+o,d=l(r);a(e.Cells,r,o,s,t,i,!0,d)}}(e,n,s,u),(0,o.addNewValueToArray)(C,s,n),(0,o.addNewValueToArray)(u?e.RowHeights:e.ColumnWidths,s,r.MinimalCellExtent),g=u?e.RowOffsets:e.ColumnOffsets,h=g[f=s],(0,o.addNewValueToArray)(g,f,h),d(g,f+1,r.MinimalCellExtent),u?e.BlockHeight+=r.MinimalCellExtent:e.BlockWidth+=r.MinimalCellExtent,t.resetCellLookup(),i(e,u,s,!0)},t.removeRowColFromModel=function(e,t,n,r,a){var u=a?e.RowNumbers:e.ColumnNumbers;if(u.indexOf(n)<0)throw Error("removeRowColFromModel: Invalid absolute index. ".concat(a?"Row":"Column"," ").concat(n," doesn't exists in model"));if(r<0||r>=u.length)throw Error("removeRowColFromModel: Invalid relative index.");var g,f,h,C=a?e.RowHeights[r]:e.ColumnWidths[r];!function(e,t,n){var r=(n?e.RowNumbers.length:e.ColumnNumbers.length)-1;if(s(e.Cells,t,r,n,0),c(e,n)){var o=t+r,i=l(n);s(e.Cells,o,2*r,n,i)}}(e,r,a),(0,o.removeValueFromArray)(u,r),(0,o.removeValueFromArray)(a?e.RowHeights:e.ColumnWidths,r),g=a?e.RowOffsets:e.ColumnOffsets,h=(f=r)===g.length-1?0:g[f+1]-g[f],(0,o.removeValueFromArray)(g,f),d(g,f,-h),a?e.BlockHeight-=C:e.BlockWidth-=C,t.resetCellLookup(),i(e,a,r,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderCanvasRenderer=void 0;var r=n(4),o=n(1),i=n(56),l=n(225),a=n(13),s=n(112),d=n(226),u=n(122),c=n(0),g=n(96),f=n(128),h=n(2),C=n(227),m=n(228),p=n(111),y=n(126),v=n(94),S=n(229),R=n(17),F=n(230),w=n(231),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.unhideRowColumnUXImprovementsSlice1=void 0,t}return r.__extends(t,e),t.prototype.renderInternal=function(e,t,n){var r,g=this;try{(0,c.validateRenderingRegion)(n.renderingRegion,t,n);var f,R=(0,c.isHighContrastMode)(n);R&&(f=n.highContrastScheme,(0,c.extendHighContrastScheme)(n,f));var T=n.scaleFactor,I=Math.round(t.BlockWidth*T),x=n.renderingRegion,b=-1*x.startOffsetY*T,D=(0,c.getDrawingOffsetXForRenderingRegion)(t,x)*T,A=(0,o.isDifferentialRenderingSupported)(t),P=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.FluentStyle,t),H=(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.HeaderDragImprovements,t),B=(0,o.isIncreasedHeaderSizeEnabled)(t);A&&(this.setTransform(1,!1,D,b,I),(0,y.maskDifferentialRenderingAreas)(t,this.ctx)),this.setTransform(1,!1,0,0,I),this.clearHeaderCanvas(e.getWidth(),e.getHeight(),n,P);var M=(0,h.clipForOutlinesIfNecessary)(this.ctx,t,n);return this.setTransform(1,!1,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawBackgroundFillMs,(function(){return(0,u.drawHeaderCellsBackgroundFill)(g.ctx,t,n,P)})),t.ShowHeaders&&(this.setTransform(1,t.IsRtl,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawGridlinesDurationMs,(function(){return(0,i.drawHeadersGridLines)(g.ctx,t,n,P,B)}))),B&&t.ShowHeaders&&(this.setTransform(1,t.IsRtl,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.ClearColumnHeaderGutterAreaDurationMs,(function(){return(0,F.clearColumnHeaderGutterArea)(g.ctx,t,n,T,R,f)}))),H&&t.ShowHeaders&&(this.setTransform(1,t.IsRtl,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawRowColDragAndDropSixSquaresDurationMs,(function(){return(0,S.drawRowColDragAndDropSixSquares)(g.ctx,t,n)}))),t.ShowHeaders&&(this.setTransform(n.scaleFactor,!1,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawTextDurationMs,(function(){return(0,s.drawText)(g.ctx,t,n)}))),t.ShowHeaders&&(this.setTransform(1,t.IsRtl,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawHiddenRowColDurationMs,(function(){return(0,C.drawHiddenRowCol)(g.ctx,t,n,P,g.isUnhideRowColumnUXImprovementsSlice1Enabled(P),B)}))),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderResizePill,t)&&t.ShowHeaders&&(this.setTransform(1,t.IsRtl,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawResizePillDurationMs,(function(){return(0,l.drawResizePill)(g.ctx,t,n,B)}))),(0,o.isHeaderInsertEnabled)(t)&&t.ShowHeaders&&(this.setTransform(1,t.IsRtl,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawInsertDotAndInsertButton,(function(){return(0,w.drawInsertDotAndInsertButton)(g.ctx,t,n)}))),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderHeaderSnappingInCanvas,t)&&(null===(r=t.ClientOnlyCache)||void 0===r?void 0:r.isHeaderSnapped)&&(this.setTransform(1,!1,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawAutoFiltersForHeaderSnappingMs,(function(){return(0,v.drawAutoFilters)(g.ctx,t,n)}))),M&&(0,h.restoreClipping)(this.ctx,M),(0,o.isRenderFlagEnabled)(o.RenderFlagsArray.RenderHeaderOutlinesInCanvas,t)&&(this.setTransform(1,!1,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.DrawOutlines,(function(){return(0,d.drawOutlines)(g.ctx,t,n,P)}))),this.shouldInitializeCanvasHitTest(t,n.skeletonMode)&&(this.setTransform(1,!1,D,b,I),(0,a.trackDuration)(a.RenderPerformanceMetric.RegisterHeaderHitRegionsToModelMs,(function(){return(0,m.registerHeaderHitRegionsToModelCache)(t,n)}))),A&&this.ctx.restore(),n.debugMode&&(this.setTransform(T,!1,0,0,0),n.isCanvasHitTestDebugHighlight&&(0,p.highlightHitRegions)(t,this.ctx,n.renderingRegion)),(0,a.createRenderResult)(!0,"finished rendering.")}catch(e){return(0,a.createRenderResult)(!1,"exception caught in renderInternal: message: ".concat(e.message," name: ").concat(e.name," stack: ").concat(e.stack," error: ").concat(e))}},t.prototype.preprocessModel=function(e,t,n,r){(0,g.initializeCachedObjects)(e,t,this.shouldInitializeCanvasHitTest(e,r)),(0,h.initializeOffsetsForDrawing)(e,n.scaleFactor)},t.prototype.shouldInitializeCanvasHitTest=function(e,t){return!(0,o.isDifferentialRenderingSupported)(e)},t.prototype.clearHeaderCanvas=function(e,t,n,r){var o=this;(0,a.trackDuration)(a.RenderPerformanceMetric.FillRectDurationMs,(function(){o.ctx.fillStyle=o.getCanvasBackgroundColor(n,r),o.ctx.fillRect(0,0,e,t)}))},t.prototype.getCanvasBackgroundColor=function(e,t){return(0,c.isHighContrastMode)(e)?(0,c.rgbToColorHex)(e.highContrastScheme.BackgroundColor):t?e.viewMode===o.ViewMode.NamedSheetView?o.NSVHeaderBackgroundColor:o.DefaultHeaderBackgroundColor:e.viewMode===o.ViewMode.NamedSheetView?o.NSVHeaderBackgroundColorBeforeFluent:o.DefaultHeaderBackgroundColor},t.prototype.isUnhideRowColumnUXImprovementsSlice1Enabled=function(e){return!!e&&(void 0===this.unhideRowColumnUXImprovementsSlice1&&(this.unhideRowColumnUXImprovementsSlice1=(0,R.getBooleanFeatureGate)("Microsoft.Office.Excel.UnhideRowColumnUXImprovementsSlice1",!1)),this.unhideRowColumnUXImprovementsSlice1)},t}(f.CanvasRenderer);t.HeaderCanvasRenderer=T},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawResizePill=void 0;var r=n(1),o=n(133),i=n(5),l=n(6),a=n(39),s=n(0),d=n(3),u=n(75);function c(e,t,n,r,i,l,a,s,d){var u,c;e.strokeStyle=n,e.fillStyle=r,e.lineWidth=t,e.beginPath(),d?null===(u=e.roundRect)||void 0===u||u.call(e,i,l,a-t,s-t,[o.ResizePillBorderRadius]):null===(c=e.roundRect)||void 0===c||c.call(e,i+e.lineWidth,l+e.lineWidth,a-e.lineWidth,s-e.lineWidth,[o.ResizePillBorderRadius]),e.fill(),e.stroke()}function g(e){return e?(0,s.rgbToColorHex)(e.TextColor):u.HeaderDrawingsGreenColor}function f(e){return e?(0,s.rgbToColorHex)(e.BackgroundColor):u.HeaderDrawingsWhiteColor}function h(e,t,n){return{x:(0,l.getCellRightAdjustedForDrawing)(e,t,e.IsRtl)-o.DefaultRowResizePillWidthPx*n-o.DefaultSpaceFromRowHeaderRightBorderPx*n,y:(0,l.getCellBottomAdjustedForDrawing)(e,t)-o.DefaultRowResizePillHeightPx*n/2}}function C(e,t,n,r,i){var s=(0,l.getCellRightAdjustedForDrawing)(e,t,e.IsRtl)+(r?d.GridLineWidthPx:0)-o.DefaultColResizePillWidthPx*n/2,u=(0,l.getCellTopAdjustedForDrawing)(e,t,!1),c=(0,a.getColumnHeaderGutterOffsetForDrawing)(n,i);return{x:s,y:u+c+((0,l.getCellHeightAdjustedForDrawing)(e,t)-c-o.DefaultColResizePillHeightPx*n)/2}}t.drawResizePill=function(e,t,n,l){(0,i.verifyArgumentNotNull)(e,"ctx","drawResizePill"),(0,i.verifyArgumentNotNull)(t,"model","drawResizePill"),(0,i.verifyArgumentNotNull)(n,"context","drawResizePill");for(var a=!1,s=0,d=t.ClientOnlyCache.CellsToRender;s<d.length;s++){var m=d[s];if(m.ShowResizePill){if(a)throw Error("drawResizePill: Resize pill already drawn on another cell");a=!0;var p=(0,r.isChangeGateEnabled)(r.ChangeGate.ResizePillHighContrastFix),y=(0,r.isChangeGateEnabled)(r.ChangeGate.ResizePillAlignmentFix),v=n.highContrastScheme,S=n.scaleFactor,R=p?g(v):u.HeaderDrawingsGreenColor,F=p?f(v):u.HeaderDrawingsWhiteColor;if(t.IsRow){var w=h(t,m,S),T=o.DefaultRowResizePillWidthPx*S,I=o.DefaultRowResizePillHeightPx*S;c(e,S,R,F,w.x,w.y,T,I,y)}else{var x=C(t,m,S,y,l);T=o.DefaultColResizePillWidthPx*S,I=o.DefaultColResizePillHeightPx*S;c(e,S,R,F,x.x,x.y,T,I,y)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawOutlines=void 0;var r=n(1),o=n(6),i=n(93),l=n(2),a=n(134),s=n(3),d=n(0);function u(e,t,n,r,o){var i={TopPx:o?n.EndPoint.TopPx:r,LeftPx:o?r:n.EndPoint.LeftPx,Cell:t};n.Button={EdgeInformation:i,IsExpand:n.IsExpanded},e.push(n.Button)}function c(e,t,n,r,i,l){var a=!!t.IsNonDefaultDirection;!function(e,t,n,r,o){var i=-1===t.StartIndex,l=o&&i,a=function(e,t,n,r){if(e.IsRow)return r?e.BlockHeight*t:0;return n}(e,r,n,l),s=function(e,t,n,r){if(e.IsRow)return n;if(r)return e.IsRtl?0:e.BlockWidth*t;return e.IsRtl?e.BlockWidth*t:0}(e,r,n,l);t.StartPoint={TopPx:a,LeftPx:s}}(e,t,i,l,a),function(e,t,n,r,i,l){var a=!!t.IsButtonHidden;if(e.IsRow){var d=function(e,t,n,r,i,l){var a=s.pixelTranslation;t?i?a=l?(0,o.getCellBottomAdjustedForDrawing)(e,n)-s.pixelTranslation:(0,o.getCellTopAdjustedForDrawing)(e,n,!1)+s.pixelTranslation:(a+=(0,o.getCellCenterYAdjustedForDrawing)(e,n),a-=p(r)):a+=l?0:e.BlockHeight*r;return Math.floor(a)}(e,r,n,i,a,l);t.EndPoint={TopPx:d,LeftPx:t.StartPoint.LeftPx}}else{var u=function(e,t,n,r,i,l){var a=0,s=e.IsRtl,d=s&&l,u=!s&&l,c=s&&!l;t?i?a+=c||u?(0,o.getCellRightAdjustedForDrawing)(e,n,!1):(0,o.getCellLeftAdjustedForDrawing)(e,n,!1,!1):(a=(0,o.getCellCenterXAdjustedForDrawing)(e,n,!1),a-=p(r)):a=u?0:!s||d?e.BlockWidth*r:0;return Math.floor(a)}(e,r,n,i,a,l);t.EndPoint={TopPx:t.StartPoint.TopPx,LeftPx:u}}}(e,t,n,r,l,a)}function g(e,t,n,r){var i=n.StartIndex;i>-1&&(function(e,t,n,r){var i=y(e,n),l=!!t.IsNonDefaultDirection;if(e.IsRow){var a=function(e,t,n){if(n)return(0,o.getCellBottomAdjustedForDrawing)(e,t);return(0,o.getCellTopAdjustedForDrawing)(e,t,!1)}(e,i,l);t.StartPoint.TopPx=a>0?a-s.pixelTranslation:0}else t.StartPoint.LeftPx=function(e,t,n,r){return e.IsRtl?function(e,t,n,r){if(n)return f(e,t);return h(e,t,r)}(e,t,n,r):function(e,t,n,r){if(n)return h(e,t,r);return f(e,t)}(e,t,n,r)}(e,i,l,r)}(e,n,i,r),function(e,t,n,r){var o=Math.round(a.OutlinesStartSizePx*r),i=e.IsRow,d=t.StartPoint,u=function(e,t,n,r){var o=r?e-t-s.pixelTranslation:e+t+s.pixelTranslation;return n?o:e}(d.LeftPx,o,i,e.IsRtl),c=i?d.TopPx:d.TopPx+o,g=d.LeftPx,f=d.TopPx;(0,l.drawLine)(n,u,c,g,f)}(e,n,t,r))}function f(e,t){var n=(0,o.getCellLeftAdjustedForDrawing)(e,t,!1,!1);return n>0?n-s.pixelTranslation:s.pixelTranslation}function h(e,t,n){var r=(0,o.getCellRightAdjustedForDrawing)(e,t,!1),i=e.BlockWidth*n;return r<i?r+s.pixelTranslation:i-s.pixelTranslation}function C(e,t,n,r){var o=Math.round((a.OutlinesPaddingPx+e*a.OutlinesLevelHeightWidthPx)*t);return n?Math.floor(r*t)-o:o}function m(e,t,n){var r=t?0:s.GridLineWidthPx;return e-p(n)+r}function p(e){return(0,i.getAdjustedButtonSize)(e,a.ExpandCollapseButtonSizePx)/2}function y(e,t){return e.IsRow?(0,r.getCell)(t,0,e):(0,r.getCell)(0,t,e)}function v(e,t,n,r,o,i,a){i&&!t.IsButtonHidden&&u(r,a,t,o,e.IsRow),(0,l.drawLine)(n,t.StartPoint.LeftPx,t.StartPoint.TopPx,t.EndPoint.LeftPx,t.EndPoint.TopPx)}t.drawOutlines=function(e,t,n,o){var l=t.IsRow?t.RowOutlinesInformation:t.ColumnOutlinesInformation;if(l&&0!==l.length){var f=[];!function(e,t){var n=t.highContrastScheme;n?e.strokeStyle=(0,d.rgbToColorHex)(n.LinkColor):t.viewMode===r.ViewMode.NamedSheetView?e.strokeStyle=r.NSVOutlinesColor:e.strokeStyle=r.OutlinesColor}(e,n),e.beginPath();for(var h=t.IsRow,p=h&&t.IsRtl,S=n.scaleFactor,R=0;R<l.length;++R)for(var F=l[R].Outlines,w=C(R,S,p,t.BlockWidth),T=w+s.pixelTranslation,I=m(w,h,S),x=F.length,b=0;b<x;++b){var D=F[b],A=D.ButtonIndex,P=A>-1,H=P?y(t,A):void 0;c(t,D,H,P,T,S),!!D.IsExpanded||!P?(g(t,e,D,S),v(t,D,e,f,I,P,H),e.stroke()):u(f,H,D,I,h)}!function(e,t,n,o,l){for(var s=n.highContrastScheme,u=function(e,t){if(e)return(0,d.rgbToColorHex)(e.LinkColor);if(t===r.ViewMode.NamedSheetView)return r.NSVOutlinesColor;return r.OutlinesColor}(s,n.viewMode),c=function(e,t,n){if(e)return(0,d.rgbToColorHex)(e.BackgroundColor);if(t===r.ViewMode.NamedSheetView)return n?r.NSVHeaderBackgroundColor:r.NSVHeaderBackgroundColorBeforeFluent;return r.DefaultHeaderBackgroundColor}(s,n.viewMode,l),g=0;g<t.length;++g){var f=t[g],h=(0,i.getAdjustedButtonSize)(n.scaleFactor,a.ExpandCollapseButtonSizePx),C={outerColor:u,innerColor:c,left:f.EdgeInformation.LeftPx,bottom:f.EdgeInformation.TopPx+h,height:h,width:h};(0,i.drawExpandCollapseButton)(o,e,f.EdgeInformation.Cell,C,f.IsExpand,!1)}}(t,f,n,e,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areHiddenRowColsExistInAdjacentBlocks=t.drawHiddenRowCol=void 0;var r=n(1),o=n(3),i=n(0),l=n(5),a=n(7),s=n(2),d=n(39);function u(e,t){var n=!1,r=!1;return e.AdjacentBlocksHiddensInfo?(t?(n=!!e.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden,r=!!e.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden):(n=!!e.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden,r=!!e.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden),{isLastRowColOfPrevBlockHidden:n,isFirstRowColOfNextBlockHidden:r}):{isLastRowColOfPrevBlockHidden:!1,isFirstRowColOfNextBlockHidden:!1}}function c(){return r.DefaultHiddenRowColInnerGapPx+o.GridLineWidthPx}function g(e,t){return t?e+o.GridLineWidthPx:e-o.GridLineWidthPx}function f(e,t,n,r,o,i,l,a,s,u,c,g,f,m,p,y,v){var S=function(e,t,n,r,o,i,l){for(var a=[],s=[],u=[],c=function(e,t,n){return{startIndex:e>0?e-1:0,endIndex:t<n?t+1:n}}(r,o,t.length-1),g=c.startIndex,f=c.endIndex,h=t[g],m=(0,d.isCellPartiallySelected)(n[g],i),p=!!l&&(0,d.isCellWhollySelected)(n[g],i),y=g+1;y<=f;y++){var v=t[y],S=(0,d.isCellPartiallySelected)(n[y],i),R=!!l&&(0,d.isCellWhollySelected)(n[y],i);v>h+1&&C(e[y],m&&S?s:p&&R?u:a),m=S,p=R,h=v}return{hiddenFrameStartPositionsPx:a,hiddenFramePartiallySelectedStartPositionsPx:s,hiddenFrameWhollySelectedStartPositionsPx:u}}(o,i,r,c,g,y,v),R=S.hiddenFrameStartPositionsPx,F=S.hiddenFramePartiallySelectedStartPositionsPx,w=S.hiddenFrameWhollySelectedStartPositionsPx;!function(e,t,n,r,o,i,l,a,s){var u=n;if(e){var c=i[0];(0,d.isCellPartiallySelected)(c,a)&&(u=r),s&&(0,d.isCellWhollySelected)(c,a)&&(u=o),C(l[0],u)}if(t){var g=i[i.length-1];u=n,(0,d.isCellPartiallySelected)(g,a)&&(u=r),s&&(0,d.isCellWhollySelected)(g,a)&&(u=o),C(l[l.length-1],u)}}(f,m,R,F,w,r,o,y,v),h(R,e,t,n,l,a,s,u,!1,!1,p,y,v),v&&w.length>0&&h(w,e,t,n,l,a,s,u,!1,!0,p,y,v),h(F,e,t,n,l,a,s,u,!0,!1,p,y,v)}function h(e,t,n,l,s,d,u,c,g,f,h,C,m){if(e.length>0){var p=function(e,t,n,l,s){if(!(0,a.isNullOrUndefined)(e.highContrastScheme))return{frameOutlinesColor:"".concat((0,i.rgbToColorHex)(e.highContrastScheme.TextColor)),fillColor:"".concat((0,i.rgbToColorHex)(e.highContrastScheme.BackgroundColor))};if(e.viewMode===r.ViewMode.NamedSheetView)return s?{frameOutlinesColor:t||n?o.NSVHiddenRowColumnIndicatorWithSelectionLineColor:o.NSVHiddenRowColumnIndicatorLineColor,fillColor:r.NSVHeaderBackgroundColor}:l?t?{frameOutlinesColor:o.NSVSelectedCellsGridLineColor,fillColor:r.NSVHeaderBackgroundColor}:{frameOutlinesColor:o.NSVDefaultGridLineColor,fillColor:r.NSVHeaderBackgroundColor}:{frameOutlinesColor:r.NSVGridinesColor,fillColor:r.NSVHeaderBackgroundColorBeforeFluent};if(s)return t?{frameOutlinesColor:o.PartialRowColSelectionHiddenRowColumnIndicatorLineColor,fillColor:r.PartialRowColSelectionBackgroundColor}:n?{frameOutlinesColor:o.WholeRowColSelectionHiddenRowColumnIndicatorLineColor,fillColor:r.WholeRowColSelectionBackgroundColor}:{frameOutlinesColor:o.HiddenRowColumnIndicatorLineColor,fillColor:o.HiddenRowColumnIndicatorGapColor};if(t)return l?{frameOutlinesColor:o.SelectedCellsGridLineColor,fillColor:r.PartialRowColSelectionBackgroundColor}:{frameOutlinesColor:r.SelectedCellsGridlinesColor,fillColor:r.PartialRowColSelectionBackgroundColorBeforeFluent};if(l)return{frameOutlinesColor:o.DefaultGridLineColor,fillColor:r.DefaultHeaderBackgroundColor};return{frameOutlinesColor:o.DefaultGridLineColorBeforeFluent,fillColor:r.DefaultHeaderBackgroundColor}}(n,g,f,C,m),y=p.frameOutlinesColor,v=p.fillColor;!function(e,t,n,r,l,a,s){e.lineWidth=o.GridLineWidthPx,e.strokeStyle=a,e.beginPath();for(var d=0,u=r;d<u.length;d++){var c=u[d],g=c-(0,i.getLinePixelTranslation)(o.GridLineWidthPx);e.rect(l?s:g,l?g:s,t,n)}e.stroke()}(t,s,d,e,l,y,h),function(e,t,n,r,o,i,l){e.fillStyle=i;for(var a=0,s=r;a<s.length;a++){var d=s[a];e.fillRect(o?l:d,o?d:l,t,n)}}(t,u,c,e,l,v,m?h-o.GridLineWidthPx:h)}}function C(e,t){var n=e-Math.ceil(r.DefaultHiddenRowColInnerGapPx/2);t.push(n)}t.drawHiddenRowCol=function(e,t,n,i,a,h){if(function(e){(0,l.verifyArgumentNotNull)(e.ColumnNumbers,"model.ColumnNumbers","drawHiddenRowCol"),(0,l.verifyArgumentNotNull)(e.RowNumbers,"model.RowNumbers","drawHiddenRowCol")}(t),!(n.scaleFactor<o.MinimalScaleFactorForGridlinesRendering)){var C=t.IsRow,m=u(t,C),p=m.isLastRowColOfPrevBlockHidden,y=m.isFirstRowColOfNextBlockHidden,v=(0,s.doesHeaderModelContainOutlines)(t,C),S=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,R=t.ClientOnlyCache.RowOffsetsAdjustedForDrawing;if(C){var F=v?1:0,w=(0,s.getColWidthFromOffsets)(F,S),T=v?S[1]:0;f(e,n,!0,t.Cells,R,t.RowNumbers,w,c(),g(w,a),r.DefaultHiddenRowColInnerGapPx,n.renderingRegion.startRow,n.renderingRegion.endRow,p,y,T,i,a)}else{var I=(0,d.getColumnHeaderGutterOffsetForDrawing)(n.scaleFactor,h),x=v?1:0,b=(0,s.getRowHeightFromOffsets)(x,R)-I,D=(v?R[1]:0)+I;f(e,n,!1,t.Cells,S,t.ColumnNumbers,c(),b,r.DefaultHiddenRowColInnerGapPx,g(b,a),n.renderingRegion.startColumn,n.renderingRegion.endColumn,p,y,D,i,a)}}},t.areHiddenRowColsExistInAdjacentBlocks=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHeaderHitRegionsToModelCache=void 0;var r=n(1),o=n(24),i=n(0),l=n(22),a=n(6),s=n(23),d=n(75),u=n(95),c=n(3),g=n(39),f=n(11),h=n(2),C=n(93),m=n(134),p=n(8),y=n(135),v=n(17),S=n(133),R=n(132),F=n(97),w=void 0;function T(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r],i=(0,a.getAdjustedCellArea)(e,o,!1);n.push(i)}return n}function I(e,t,n,i,a){var d=(0,s.getUnadjustedHitRegionFromRect)(e,t,i,e.IsRtl);(0,l.registerCursorHitRegion)(n,a,d,o.GrabCursorType,r.RenderFeaturesZIndex.HeaderDragDropSquares,L);var u=function(e,t){var n=e.IsRow,r=n?t.Row:t.Col,o=(0,g.getCellAbsoluteIndex)(e,r,n);return function(e){if(z(e)&&(0,f.isHeaderDragAllowed)()){var t=e;return(0,f.onHeaderDragStartCallback)(n,o,t),!0}return!1}}(e,n);(0,l.registerHitRegion)(n,a,d,r.RenderFeaturesZIndex.HeaderDragDropSquares,u,o.PointerDownEvent)}function x(e,t,n,o,i,l,a){var s,u,f=l&&(0,r.isChangeGateEnabled)(r.ChangeGate.ModernHeaderResizeHitRegion),h=function(e,t,n,r){if(!e)return 0;if(n)return t?e.height>=S.MinRowHeightToAllocateMaxResizeArea*r?S.MaxCellPixelsAllocatedToRowResizeZone*r:e.height>=S.MinRowHeightToAccomadateResizePillAndMinSelectionArea*r?(e.height-S.MinCellPixelsAllocatedForCellSelection*r)/2:e.height>=S.MinRowHeightToAccomadateResizePillAnd1pxSelectionArea*r?S.DefaultRowResizePillHeightPx*r/2:e.height*S.CellPercentageAllocatedToResize:e.width>=S.MinColWidthToAllocateMaxResizeArea*r?S.MaxCellPixelsAllocatedToColumnResizeZone*r:e.width>=S.MinColWidthToAccomadateResizePillAndMinSelectionArea*r?(e.width-S.MinCellPixelsAllocatedForCellSelection*r)/2:e.width>=S.MinColWidthToAccomadateResizePillAnd1pxSelectionArea*r?S.DefaultColResizePillWidthPx*r/2:e.width*S.CellPercentageAllocatedToResize;return Math.max(d.MinCellPixelsAllocatedToResizeZone,Math.min(d.MaxCellPixelsAllocatedToResizeZone,Math.floor((t?e.height:e.width)*d.CellPercentageAllocatedToResizeZone)))}(e,t,f,o),C=(0,g.getColumnHeaderGutterSizeForDrawing)(o,i);if(t){var m=a?d.RowHeaderDragAndInsertHitRegionWidth*o:0,p=n?e.x:e.x+m,y=e.width-m;s={x:p,y:e.y,width:y,height:h},u={x:p,y:e.y+e.height-h-(f?0:Math.min(c.GridLineWidthPx,e.height)),width:y,height:h+(f?0:Math.min(c.GridLineWidthPx,e.height))}}else n?(s={x:e.x+e.width-h,y:e.y+C,width:h,height:e.height-C},u={x:e.x,y:e.y+C,width:h+(f?0:Math.min(c.GridLineWidthPx,e.width)),height:e.height-C}):(s={x:e.x,y:e.y+C,width:h,height:e.height-C},u={x:e.x+e.width-h-(f?0:Math.min(c.GridLineWidthPx,e.width)),y:e.y+C,width:h+(f?0:Math.min(c.GridLineWidthPx,e.width)),height:e.height-C});return{firstResizeZoneHitRegion:s,secondResizeZoneHitRegion:u}}function b(e,t,n,r,o,i,l){var a=function(e,t,n,r){if(!e)return 0;return Math.max(0,Math.min(d.MaxCellPixelsAllocatedToUnhideZone*t,Math.floor((n?e.height:e.width)*(r?d.OverlappingUnhideZonePercentage:1))))}(e,t,n,i);return o?n?{x:e.x,y:e.y,width:e.width,height:a}:r?{x:e.x+e.width-a,y:e.y+l,width:a,height:e.height-l}:{x:e.x,y:e.y+l,width:a,height:e.height-l}:n?{x:e.x,y:e.y+e.height-a-Math.min(c.GridLineWidthPx,e.height),width:e.width,height:a+Math.min(c.GridLineWidthPx,e.height)}:r?{x:e.x,y:e.y+l,width:a+Math.min(c.GridLineWidthPx,e.width),height:e.height-l}:{x:e.x+e.width-a-Math.min(c.GridLineWidthPx,e.width),y:e.y+l,width:a+Math.min(c.GridLineWidthPx,e.width),height:e.height-l}}function D(e,t,n,i,a,s,d,u,c,g){var h=O(a,i,d,u,!1,c),C=O(a,i,d,u,!0,c),m=function(e){return function(t){return(0,f.isResizeAllowed)(e)&&"touch"!==t.pointerType&&"pen"!==t.pointerType}}(d);(0,l.registerCursorHitRegion)(e,t,n,s,r.RenderFeaturesZIndex.HeaderResize,m),(0,l.registerHitRegion)(e,t,n,r.RenderFeaturesZIndex.HeaderResize,h,o.PointerDownEvent),(0,l.registerHitRegion)(e,t,n,r.RenderFeaturesZIndex.HeaderResize,C,o.DoubleClickEventType),g&&((0,l.registerMouseEnterHitRegion)(e,t,n,r.RenderFeaturesZIndex.HeaderResize,M(i,a,d,!0)),(0,l.registerMouseLeaveHitRegion)(e,t,n,r.RenderFeaturesZIndex.HeaderResize,M(i,a,d,!1)))}function A(e,t,n,o,i,a,s){(0,l.registerMouseEnterHitRegion)(e,t,n,r.RenderFeaturesZIndex.UnhideSkittle,k(o,i,a,!0,s)),(0,l.registerMouseLeaveHitRegion)(e,t,n,r.RenderFeaturesZIndex.UnhideSkittle,k(o,i,a,!1,s))}function P(e,t,n,i,a,d,u,c){var g=(0,s.getUnadjustedHitRegionFromRect)(e,t,a,!1);(0,l.registerCursorHitRegion)(n,i,g,o.PointerCursorType,r.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return function(r){return(0,f.isHeaderInsertAllowed)(e,t,n)&&"touch"!==r.pointerType&&"pen"!==r.pointerType}}(d,u,c)),(0,l.registerMouseEnterHitRegion)(n,i,g,r.RenderFeaturesZIndex.HeaderInsert,N(d,u,c,!0)),(0,l.registerMouseLeaveHitRegion)(n,i,g,r.RenderFeaturesZIndex.HeaderInsert,N(d,u,c,!1)),(0,l.registerHitRegion)(n,i,g,r.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return function(r){if(z(r)&&(0,f.isHeaderInsertAllowed)(e,t,n)){var o=r;return(0,f.headerInsertButtonInvokedCallback)(e,t,n,o),!0}return!1}}(d,u,c),o.ClickEventType),(0,l.registerHitRegion)(n,i,g,r.RenderFeaturesZIndex.HeaderInsert,function(e,t,n){return function(r){return!(!z(r)||!(0,f.isHeaderInsertAllowed)(e,t,n))}}(d,u,c),o.PointerDownEvent)}function H(e,t,n){var r=n?1:0;return t?e.filter((function(e){return e.Col===r})):e.filter((function(e){return e.Row===r}))}function B(e,t,n){var r=e.IsRow,o=r?t.Row:t.Col,i=(0,g.getCellAbsoluteIndex)(e,o,r);return function(e){return"touch"!==e.pointerType&&(0,f.setOrRemoveHoveredCellCallback)(i,o,r,n),!0}}function M(e,t,n,r){return function(o){return(0,f.isResizeAllowed)(n)&&"touch"!==o.pointerType&&"pen"!==o.pointerType&&(0,f.setOrRemoveResizeZoneHoveredCallback)(e,t,n,r),!1}}function O(e,t,n,r,o,i){return function(l){if(z(l)&&(0,f.isResizeAllowed)(n)){var a=l;(0,f.onHeaderResizeStartCallback)(a,t,e,n,r,i,o)}return!0}}function k(e,t,n,r,o){return function(i){return"touch"!==i.pointerType&&(0,f.onHeaderUnhideRowColCallback)(e,t,n,r,o),!1}}function L(e){return(0,f.isHeaderDragAllowed)()&&"touch"!==e.pointerType&&"pen"!==e.pointerType}function N(e,t,n,r){return function(o){return"touch"!==o.pointerType&&(0,f.headerInsertHitAreaHoveredCallback)(e,t,n,r),!1}}function E(e,t,n,r){return function(o){return z(o)&&(0,f.expandCollapseOutlines)(e,t,n,r),!0}}function z(e){return!("dblclick"!==e.type&&"click"!==e.type&&"mouse"!==e.pointerType)&&0===e.button}t.registerHeaderHitRegionsToModelCache=function(e,t){var n=e.IsRow,a=(0,h.doesHeaderModelContainOutlines)(e,n);if(e.ShowHeaders||a){var c=(0,r.getRenderingRegionHitTestCache)(e,(0,i.getRenderingRegionKey)(t.renderingRegion)),f=e.ClientOnlyCache.CellsToRender;if(0!==f.length){var S=a?H(f,n,!0):f,M=T(e,S);if(e.ShowHeaders){!function(e,t,n,i,a){var d;u.gridRendererCustomCursors?d=e.IsRow?e.IsRtl?u.gridRendererCustomCursors.rowSelectRTLCursor:u.gridRendererCustomCursors.rowSelectLTRCursor:u.gridRendererCustomCursors.columnSelectCursor:(p.ULS.sendTraceTag(508924443,p.LogCategory.msoulscat_ES_EWAJSGrid,p.TraceLevel.Warning,"headersHitTest: registerHeaderCellsHitRegionsToModelCache:: gridRendererCustomCursors is undefined. Using default cursor."),d=o.DefaultCursorType);for(var c=0;c<n.length;c++){var g=n[c],f=i[c],h=(0,s.getUnadjustedHitRegionFromRect)(e,t,f,!1);if((0,l.registerCursorHitRegion)(g,a,h,d,r.RenderFeaturesZIndex.Headers),(0,l.registerMouseEnterHitRegion)(g,a,h,r.RenderFeaturesZIndex.Headers,B(e,g,!0)),(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.RenderHeaderOutlinesInCanvas,e)&&(0,l.registerMouseLeaveHitRegion)(g,a,h,r.RenderFeaturesZIndex.Headers,B(e,g,!1)),(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.HeaderDragImprovements,e)){var C=(0,y.getHeaderDragSquareHitRegionRectInfo)(e,g,t.scaleFactor);C&&I(e,t,g,C,a)}}}(e,t,S,M,c);(function(e,t,n,o,i,l,a){for(var u,c,f=(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.RenderResizePill,e),h=(0,r.isIncreasedHeaderSizeEnabled)(e),C=(0,r.isHeaderInsertEnabled)(e),m=0;m<n.length;m++){var p=0===m,y=n[m],v=o[m],S=m,R=(0,g.getCellAbsoluteIndex)(e,m,a),F=R-1,w=void 0;if(p)w=a?!!(null===(u=e.AdjacentBlocksHiddensInfo)||void 0===u?void 0:u.IsLastRowOfPrevBlockHidden):!!(null===(c=e.AdjacentBlocksHiddensInfo)||void 0===c?void 0:c.IsLastColOfPrevBlockHidden);else{var T=(0,g.getCellAbsoluteIndex)(e,m-1,a);w=T!==F}var I=w?m:m-1,b=x(v,a,e.IsRtl,t.scaleFactor,h,f,C),A=(0,s.getUnadjustedHitRegionFromRect)(e,t,b.firstResizeZoneHitRegion,!1),P=(0,s.getUnadjustedHitRegionFromRect)(e,t,b.secondResizeZoneHitRegion,!1),H=f&&!(-1===I)&&!w;1!==R&&D(y,i,A,F,I,l,a,w,-1===I,H);var B=a&&R===d.MaxRowValue,M=!a&&R===d.MaxColValue,O=B||M,k=S+1===n.length,L=f&&!k&&!w;O||D(y,i,P,R,S,l,a,!1,!1,L)}})(e,t,S,M,c,(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.ResizeHeaderUXModernization,e)?n?o.RowResizeModerinzeCursorType:o.ColResizeModernizeCursorType:n?o.RowResizeCursorType:o.ColResizeCursorType,n),function(){void 0===w&&(w=(0,v.getBooleanFeatureGate)("Microsoft.Office.Excel.UnhideRowColumnSkittleSlice2",!1));return w}()&&function(e,t,n,o,i,l){for(var a,d,u,c,f=void 0,h=0;h<n.length;h++){var C=0===h,m=h+1===n.length,p=n[h],y=o[h],v=(0,g.getCellAbsoluteIndex)(e,h,l),S=v-1,R=v+1,F=!1,w=!1;if(C)F=l?!!(null===(a=e.AdjacentBlocksHiddensInfo)||void 0===a?void 0:a.IsLastRowOfPrevBlockHidden):!!(null===(d=e.AdjacentBlocksHiddensInfo)||void 0===d?void 0:d.IsLastColOfPrevBlockHidden);else{var T=(0,g.getCellAbsoluteIndex)(e,h-1,l);F=T!==S}if(m)w=l?!!(null===(u=e.AdjacentBlocksHiddensInfo)||void 0===u?void 0:u.IsFirstRowOfNextBlockHidden):!!(null===(c=e.AdjacentBlocksHiddensInfo)||void 0===c?void 0:c.IsFirstColOfNextBlockHidden);else{var I=(0,g.getCellAbsoluteIndex)(e,h+1,l);w=I!==R}var x=F&&w;if(void 0!==f||l||!F&&!w||(f=(0,g.getColumnHeaderGutterSizeForDrawing)(t.scaleFactor,(0,r.isIncreasedHeaderSizeEnabled)(e))),F){var D=b(y,t.scaleFactor,l,e.IsRtl,!0,x,null!=f?f:0),P=(0,s.getUnadjustedHitRegionFromRect)(e,t,D,!1);A(p,i,P,v,l,!0,e.IsRtl)}if(w){D=b(y,t.scaleFactor,l,e.IsRtl,!1,x,null!=f?f:0);var H=(0,s.getUnadjustedHitRegionFromRect)(e,t,D,!1);A(p,i,H,v,l,!1,e.IsRtl)}}}(e,t,S,M,c,n),(0,r.isHeaderInsertEnabled)(e)&&function(e,t,n,r,o,i){for(var l=t.scaleFactor,a=i?d.RowHeaderDragAndInsertHitRegionWidth*l:(0,g.getColumnHeaderGutterSizeForDrawing)(l,!0),s=l*(i?F.RowHeaderTopInsertHitRegionHeight:F.ColumnHeaderStartInsertHitRegionWidth),u=l*(i?F.RowHeaderBottomInsertHitRegionHeight:F.ColumnHeaderEndInsertHitRegionWidth),c=0;c<n.length;c++){var f=n[c],h=(0,g.getCellAbsoluteIndex)(e,c,i),C=(0,R.getHeaderInsertButtonHitRegions)(r[c],i,e.IsRtl,a,s,u),m=C.cellStartHitRegion,p=C.cellEndHitRegion;P(e,t,f,o,m,h,i,!0),P(e,t,f,o,p,h,i,!1)}}(e,t,S,M,c,n)}if(a){var O=H(f,n,!1),k=T(e,O);!function(e,t,n,i){var a=i?e.RowOutlinesInformation:e.ColumnOutlinesInformation;if(!a)return;for(var d=0;d<a.length;d++)for(var u=a[d].Outlines,c=d+1,f=0;f<u.length;f++){var h=u[f],p=h.ButtonIndex,y=(0,g.getCellAbsoluteIndex)(e,p,i)-1;if(-1===p||h.IsButtonHidden)break;var v=h.Button,S=v.EdgeInformation.Cell,R=h.IsNonDefaultDirection?y+1:y-1,F=!h.IsExpanded,w=(0,C.getAdjustedButtonSize)(t.scaleFactor,m.ExpandCollapseButtonSizePx),T=v.EdgeInformation.TopPx,I={x:v.EdgeInformation.LeftPx,y:T,width:w,height:w},x=(0,s.getUnadjustedHitRegionFromRect)(e,t,I,!1),b=h.ECTitle;(0,l.registerTooltipHitRegion)(S,n,x,b,r.RenderFeaturesZIndex.Headers),(0,l.registerCursorHitRegion)(S,n,x,o.PointerCursorType,r.RenderFeaturesZIndex.Headers,(function(e){return!0})),(0,l.registerHitRegion)(S,n,x,r.RenderFeaturesZIndex.Headers,E(i,c,R,null!=F&&F),o.ClickEventType)}}(e,t,c,n),function(e,t,n,i,a){for(var d=0;d<n.length;d++){var u=n[d],c=i[d],g=(0,s.getUnadjustedHitRegionFromRect)(e,t,c,!1);(0,l.registerHitRegion)(u,a,g,r.RenderFeaturesZIndex.Headers,(function(e){return!0}),o.PointerDownEvent)}}(e,t,O,k,c)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRowColDragAndDropSixSquares=void 0;var r=n(1),o=n(6),i=n(5),l=n(136),a=n(39),s=n(0),d=n(135),u=n(11),c=n(2);function g(e,t,n,r){for(var o=[],i=e.x,l=0;l<t;++l){for(var a=e.y,s=0;s<n;++s)o.push({x:i,y:a}),a+=r;i+=r}return o}t.drawRowColDragAndDropSixSquares=function(e,t,n){var f,h;(0,i.verifyArgumentNotNull)(e,"ctx","drawRowColDragAndDropSixSquares"),(0,i.verifyArgumentNotNull)(t,"model","drawRowColDragAndDropSixSquares"),(0,i.verifyArgumentNotNull)(n,"context","drawRowColDragAndDropSixSquares"),(0,i.verifyArgumentNotNull)(t.IsRow,"model.IsRow","drawRowColDragAndDropSixSquares");var C=n.scaleFactor,m=(0,s.isHighContrastMode)(n),p=n.viewMode===r.ViewMode.NamedSheetView&&(0,c.doesHeaderModelContainOutlines)(t,!1),y=n.highContrastScheme;if((0,u.isHeaderDragAllowed)())for(var v=(0,r.isChangeGateEnabled)(r.ChangeGate.CellHoverStateProperty),S=0,R=t.ClientOnlyCache.CellsToRender;S<R.length;S++){var F=R[S],w=F.StyleID||0;if(v?!!F.IsHovered:r.HoverHeadersStylesSet.has(w)){var T=void 0,I=[],x=(0,a.getDimensionAdjustedForDrawing)(l.DragSquareDimension,C),b=(0,a.getDimensionAdjustedForDrawing)(l.DragSquareGap,C),D=(0,d.getHeaderDragSquareRegionRectInfo)(t,F,C,x,b);if(t.IsRow){if((0,o.getCellHeightAdjustedForDrawing)(t,F)<=D.height)continue;T=m?(0,c.getHighContrastTextColor)(F,y,t):(null===(f=(0,s.getCellFont)(F,t))||void 0===f?void 0:f.Color)||r.HoverFontColor,I=g(D,l.DragSquareNumberOfDotsInShortEdge,l.DragSquareNumberOfDotsInLongEdge,x+b)}else{if((0,o.getCellWidthAdjustedForDrawing)(t,F)<=D.width)continue;T=m?(0,s.rgbToColorHex)(y.TextColor):p?(null===(h=(0,s.getCellFont)(F,t))||void 0===h?void 0:h.Color)||r.HoverFontColor:(0,a.isCellWhollySelected)(F,!0)?r.WholeRowColSelectionBackgroundColor:r.HoverFontColor,I=g(D,l.DragSquareNumberOfDotsInLongEdge,l.DragSquareNumberOfDotsInShortEdge,x+b)}e.fillStyle=T;for(var A=0,P=I;A<P.length;A++){var H=P[A];e.fillRect(H.x,H.y,x,x)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearColumnHeaderGutterArea=void 0;var r=n(1),o=n(5),i=n(39),l=n(0),a=n(2);t.clearColumnHeaderGutterArea=function(e,t,n,s,d,u){if((0,o.verifyArgumentNotNull)(e,"ctx","clearColumnHeaderGutterArea"),(0,o.verifyArgumentNotNull)(t,"model","clearColumnHeaderGutterArea"),(0,o.verifyArgumentNotNull)(n,"context","clearColumnHeaderGutterArea"),(0,o.verifyArgumentNotNull)(t.IsRow,"model.IsRow","clearColumnHeaderGutterArea"),!t.IsRow){var c=n.viewMode===r.ViewMode.NamedSheetView&&(0,a.doesHeaderModelContainOutlines)(t,!1);e.fillStyle=d?(0,l.rgbToColorHex)(u.BackgroundColor):c?r.NSVHeaderBackgroundColor:r.DefaultHeaderBackgroundColor,e.fillRect(0,(0,i.getDimensionAdjustedForDrawing)(t.RowOffsets[t.RowOffsets.length-1],s),t.BlockWidth*s,(0,i.getColumnHeaderGutterSizeForDrawing)(s,!0))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawInsertDotAndInsertButton=void 0;var r=n(1),o=n(97),i=n(6),l=n(75),a=n(0);function s(e,t,n,r,i,s,d){for(var c,f,h,C=-2,m=void 0,p=0,y=t.ClientOnlyCache.CellsToRender;p<y.length;p++){var v=y[p],S=null===(c=v.InsertButtons)||void 0===c?void 0:c.Start,R=null===(f=v.InsertButtons)||void 0===f?void 0:f.End,F=void 0;if(d){if(!!s&&0===(t.IsRow?v.Col:v.Row))continue;var w=t.IsRow?v.Row:v.Col,T=C+1===w&&(null==m?void 0:m.Type)===(null==S?void 0:S.Type)&&(null==m?void 0:m.Offset)===(null==S?void 0:S.Offset);C=w,m=R,F=!T&&(null==S?void 0:S.Type)===r}else F=(null==S?void 0:S.Type)===r;var I=(null==R?void 0:R.Type)===r;(F||I)&&(i||(e.lineWidth=n.scaleFactor*o.InsertButtonStrokeWidth,e.strokeStyle=(h=n.highContrastScheme)?(0,a.rgbToColorHex)(h.TextColor):l.HeaderDrawingsGreenColor,e.fillStyle=g(n.highContrastScheme),i=!0),F&&u(v,t,n,S,!0,!!t.IsRow,e),I&&u(v,t,n,R,!1,!!t.IsRow,e))}return i}function d(e,t,n,l,a,s,d){var u=function(e,t,n,i){var l=0,a=0;return t?(e.Type===r.InsertButtonType.InsertDot&&(l=o.InsertDotRadius*i,a=o.InsertDotRowPadding*i),e.Type===r.InsertButtonType.InsertButton&&(l=o.InsertButtonRadius*i,a=o.InsertButtonRowPadding*i)):(e.Type===r.InsertButtonType.InsertDot&&(l=o.InsertDotRadius*i,a=o.InsertDotColumnPadding*i),e.Type===r.InsertButtonType.InsertButton&&(l=o.InsertButtonRadius*i,a=o.InsertButtonColumnPadding*i)),{radius:l,paddingForDrawing:a+l+n/2}}(e,t,l,a),c=u.radius,g=u.paddingForDrawing,f=0,h=0;return t?(f=(0,i.getCellLeftAdjustedForDrawing)(s,d,s.IsRtl,!1),h=n?(0,i.getCellTopAdjustedForDrawing)(s,d,!1):(0,i.getCellBottomAdjustedForDrawing)(s,d)):(h=(0,i.getCellTopAdjustedForDrawing)(s,d,!1),f=n?(0,i.getCellLeftAdjustedForDrawing)(s,d,s.IsRtl,!1):(0,i.getCellLeftAdjustedForDrawing)(s,d,s.IsRtl,!1)+(0,i.getCellWidthAdjustedForDrawing)(s,d)),t?{x:f+g,y:h+e.Offset,radius:c}:{x:f+e.Offset,y:h+g,radius:c}}function u(e,t,n,i,l,a,s){var u=n.scaleFactor,g=d(i,a,l,o.InsertButtonStrokeWidth*u,u,t,e),f=g.x,h=g.y,C=g.radius;i.Type===r.InsertButtonType.InsertDot?c(s,f,h,C):i.Type===r.InsertButtonType.InsertButton&&function(e,t,n,r,o){c(e,t,n,o),function(e,t,n,r){e.beginPath(),e.moveTo(t-r/2,n),e.lineTo(t+r/2,n),e.moveTo(t,n-r/2),e.lineTo(t,n+r/2),e.stroke()}(e,t,n,r)}(s,f,h,o.InsertButtonLineHeight*u,C)}function c(e,t,n,r){e.beginPath(),e.arc(t,n,r,0,o.ThreeSixtyDegreeInRadians),e.fill(),e.stroke()}function g(e){return e?(0,a.rgbToColorHex)(e.BackgroundColor):l.HeaderDrawingsWhiteColor}t.drawInsertDotAndInsertButton=function(e,t,n){var o;(0,r.verifyArgumentNotNull)(e,"ctx","drawInsertDotAndInsertButton"),(0,r.verifyArgumentNotNull)(t,"model","drawInsertDotAndInsertButton"),(0,r.verifyArgumentNotNull)(n,"context","drawInsertDotAndInsertButton");var i=!1,l=(0,r.isChangeGateEnabled)(r.ChangeGate.ReduceDuplicateInsertDrawing),a=!1;if(l){var d=t.IsRow?t.RowOutlinesInformation:t.ColumnOutlinesInformation;a=(null!==(o=null==d?void 0:d.length)&&void 0!==o?o:0)>0}i=s(e,t,n,r.InsertButtonType.InsertDot,i,a,l),s(e,t,n,r.InsertButtonType.InsertButton,i,a,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRendererGlobals=void 0;var r=n(13),o=n(9),i=n(1),l=n(0),a=n(233),s=n(30),d=n(45),u=n(11),c=n(8),g=n(137),f=n(236),h=n(237),C=n(238),m=n(239),p=n(59),y=n(240),v=n(95),S=n(96),R=n(74),F=n(241),w=n(243),T=n(244),I=n(245),x=n(246),b=n(247),D=n(138),A=n(17),P=n(139),H=function(){function e(){}return e.lookupPerfMetricName=function(e){return r.RenderPerformanceMetric[e]},e.measureTextWidth=function(t,n,r,o){var i=e.canvasContext();return e.measureTextWidthWithContext(i,t,n,r,o)},e.measureTextWidthOffscreen=function(t,n,r,o){var i=e.offScreenCanvasContext();return e.measureTextWidthWithContext(i,t,n,r,o)},e.measureTextWidthWithContext=function(e,t,n,r,i){if(!e)throw Error("measureTextWidthWithContext: ctx is undefined");return e.font=n,(0,o.measureTextWidth)(e,t,r,i)},e.compareFormattedTexts=function(e,t){return(0,i.areFormattedTextsEqual)(e,t)},e.compareMergeInformation=function(e,t){return(0,i.areMergeInformationEqual)(e,t)},e.compareInCellControlOptions=function(e,t){return(0,i.areInCellControlOptionsEqual)(e,t)},e.compareNumberFormatInformation=function(e,t){return(0,i.areNumberFormatInformationEqual)(e,t)},e.compareHeaderBlockModels=function(e,t){return(0,i.compareHeaderBlockModels)(e,t)},e.compareGridBlockModels=function(e,t,n){return(0,i.compareGridBlockModels)(e,t,n)},e.comparePartialGridBlockModels=function(e,t,n,r,o,l){return(0,i.comparePartialGridBlockModels)(e,t,n,r,o,l)},e.serializeCell=function(e,t){return(0,i.serializeCell)(e,t)},e.registerActionOnFontLoad=function(e,t,n,r){var o;null===(o=(0,a.registerActionOnFontLoadIfRequired)(e,t,n,r))||void 0===o||o.catch((function(e){throw e}))},e.getFontsLoadStatus=function(e){return(0,d.getFontsLoadStatus)(e)},e.registerExternalCallbacks=function(e){(0,u.registerExternalCallbacks)(e)},e.isExternalCallbacksRegistered=function(){return(0,u.isexternalCallbacksRegistered)()},e.initializeLogger=function(e){e&&(0,c.initializeLogger)(e)},e.initializeChangeGates=function(e){(0,A.setChangeGateDictionaryGetter)((function(){return e}))},e.initializeFeatureGates=function(e){(0,A.setFeatureGateDictionaryGetter)((function(){return e}))},e.initializeGridRendererImageLoader=function(e,t){(0,s.initializeGridRendererImageLoader)(e,t)},e.setStaticImageUrl=function(e,t){(0,s.setStaticImageUrl)(e,t)},e.loadPreviewFont=function(e){(0,a.loadPreviewFont)(e)},e.loadPreviewFontFamily=function(e,t){(0,a.loadPreviewFontFamily)(e,t)},e.isFontLoadApiSupported=function(){return(0,d.fontFaceSetSupported)()},e.initPassiveTestManager=function(){(0,g.initPassiveTelemetryManager)()},e.initGridRendererStrings=function(e){(0,p.initGridRendererStrings)(e)},e.isGridRendererStringsInitialized=function(){return(0,p.isGridRendererStringsInitialized)()},e.initGridRendererCustomCursors=function(e){(0,v.initGridRendererCustomCursors)(e)},e.isGridRendererCustomCursorsInitialized=function(){return(0,v.isGridRendererCustomCursorsInitialized)()},e.registerForCompressedTextTelemetryCollector=function(t){var n=e.canvasContext();n&&(0,f.registerCompressedTextTelemetryCollector)(n,t)},e.registerForSpillCellTelemetryCollector=function(t){var n=e.canvasContext();n&&(0,h.registerSpillCellTelemetryCollector)(n,t)},e.registerForAutoFitWidthTelemetryCollector=function(t){var n=e.canvasContext();n&&(0,C.registerAutoFitWidthTelemetryCollector)(n,t)},e.registerForAutofitHeightTelemetryCollector=function(t){var n=e.canvasContext();n&&(0,m.registerAutoFitHeightTelemetryCollector)(n,t)},e.registerCellHashDisplayCollector=function(e){(0,y.registerCellHashDisplayCollector)(e)},e.registerAppMemoryInfoCollector=function(){(0,w.registerAppMemoryInfoTelemetryCollector)()},e.registerModelCascadeTimeInfoCollector=function(e){(0,I.registerModelCascadeTimeCollector)(e)},e.registerModelStyleSizeInfoCollector=function(e){(0,x.registerModelStyleSizeCollector)(e)},e.registerBlockStatisticsInfoCollector=function(){(0,T.registerBlockStatisticsLogCollector)()},e.preprocessModel=function(t,n,r){return(0,S.preprocessAutofitWidth)(e.canvasContext(),t,n,r)},e.getProcessedColumnWidth=function(e,t){var n=(0,R.getColMetadata)(e);return n&&n.SrvDx===t&&n.CachedColWidth||t},e.resetColWidthCache=function(){(0,R.resetCache)()},e.resetColWidthCacheByCol=function(e){(0,R.resetColWidthCacheByCol)(e)},e.analyzeLowRenderingFidelity=function(e){return(0,F.analyzeModelFidelity)(e)},e.hasRenderingFidelityThresholdExceeded=function(e,t){return(0,F.hasThresholdExceeded)(e,t)},e.getErrorTypeForRenderingFidelityProblem=function(e){return(0,F.getErrorTypeForProblem)(e)},e.getVetoForRenderingFidelityProblem=function(e){return(0,F.getVetoType)(e)},e.renderingRegionContainsDirtyCells=function(e,t){return(0,l.renderingRegionContainsDirtyCells)(e,t)},e.calculateRowHeaderWidth=function(e,t){return(0,i.calculateRowHeaderWidth)(e,t)},e.getCellStyleHashes=function(e){return(0,l.getCellStyleHashesFromModel)(e)},e.canRowColHideOrCascade=function(e,t,n,r){return(0,b.canCellsOfRowColHideOrCascade)(e,t,n,r)},e.canMultipleRowColHideOrCascade=function(e,t,n,r,o){return(0,b.canCellsOfMultipleRowColHideOrCascade)(e,t,n,r,o)},e.performModelCascade=function(e,t,n,r){return(0,b.modelCascade)(e,t,n,r)},e.performModelCascadeForMultipleRowCols=function(e,t,n,r,o){return(0,b.modelCascadeMultipleRowCols)(e,t,n,r,o)},e.performModelCascadeRowColsOperations=function(e,t,n,r,o,i,l){return(0,b.modelCascadeRowColsOperations)(e,t,n,r,o,i,l)},e.hideRowCols=function(e,t,n){return(0,b.hideRowsColumns)(e,t,n)},e.hideMultipleRowCols=function(e,t,n,r){return(0,b.hideMultipleRowsColumns)(e,t,n,r)},e.performModelRowColOperation=function(e,t,n,r,o){return(0,b.modelRowColOperations)(e,t,n,r,o)},e.cloneModel=function(e){return(0,D.duplicateModel)(e)},e.getRenderedFontsTelemetry=function(){return(0,a.getRenderedFontsTelemetry)()},e.preprocessModelStyles=function(e){return(0,i.preprocessModelStyles)(e)},e.preprocessStyles=function(e){return(0,i.processGlobalStyles)(e)},e.isGlobalBorderStylesEnabled=function(e){return(0,i.isGlobalBorderStylesEnabled)(e)},e.isGlobalFontsAndCellStylesEnabled=function(){return(0,i.isGlobalFontsAndCellStylesEnabled)()},e.isGlobalBorderStylesEnabledNew=function(){return(0,i.isGlobalBorderStylesEnabledNew)()},e.getGlobalStylesTelemetry=function(){return(0,i.getGlobalStylesTelemetry)()},e.disableGlobalBorderStyles=function(e){return(0,i.disableGlobalBorderStyles)(e)},e.getFontsToDownload=function(e){return(0,a.getFontsToBeDownloaded)(e)},e.getChangedCells=function(e,t){return(0,l.getChangedCellsFromModel)(e,t)},e.updateReferenceUpdateForModel=function(e,t,n,r){return(0,l.updateReferenceUpdate)(e,t,n,r)},e.removeExtraModelRowCol=function(e){return(0,b.removeExtraModelRowsColumns)(e)},e.updateWithClientRowHeights=function(e,t){return(0,l.updateModelWithRowHeightOverrides)(e,t)},e.getWholeSelectionHeadersStylesSet=function(){return i.WholeSelectionHeadersStylesSet},e.getPartialSelectionHeadersStylesSet=function(){return i.PartiallySelectionHeadersStylesSet},e.getHoverHeadersStylesSet=function(){return i.HoverHeadersStylesSet},e.updatedPageBreaksOfCurrentBlockPair=function(e,t,n,r,o,i){return(0,b.updatePageBreaksOfBlockPair)(e,t,n,r,o,i)},e.updatePrintAreasOfCurrentBlockPair=function(e,t,n,r,o,i){return(0,b.updatePrintAreasOfBlockPair)(e,t,n,r,o,i)},e.canvasInstance=function(){return e.canvas||(e.canvas=document.createElement("canvas")),e.canvas},e.offScreenCanvasInstance=function(){return e.offScreenCanvas||(e.offScreenCanvas=new OffscreenCanvas(1,1)),e.offScreenCanvas},e.canvasContext=function(){return e.canvasInstance().getContext("2d")},e.offScreenCanvasContext=function(){return e.offScreenCanvasInstance().getContext("2d")},e.isMergedCellSpanningAcrossBlocks=function(e){return(0,P.isMergedCellSpanningAcrossBlocksVerticallyAndHorizontally)(e)},e}();t.CanvasRendererGlobals=H},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPreviewFontFamily=t.loadPreviewFont=t.getFontsToBeDownloaded=t.getRenderedFontsTelemetry=t.registerActionOnFontLoadIfRequired=void 0;var r=n(1),o=n(64),i=n(45),l=n(0),a=n(10),s=n(11),d=n(8),u=n(121),c=n(3),g=(0,s.getServiceSetting)(8,7),f=(0,s.getServiceSetting)(6,100),h=(0,s.getServiceSetting)(7,3e3),C=document.createElement("div");function m(e){var t=new Set,n=[],o=(0,r.isChangeGateEnabled)(r.ChangeGate.ReRenderGridAndHeaderOnFontLoad),s=(0,l.isModernFontPickerEnabled)(e)||o;if(e.Fonts)for(var d=0;d<e.Fonts.length;d++){var g=e.Fonts[d];if(g&&(!s||g.FontName)){var f=(0,a.canonizeFontName)(g.FontName);if(!s||!t.has(f)){if((0,l.isPLTRegressionInMFPFixEnabled)(e)){var h=(0,l.isGridRenderPerfFixEnabled)()?(0,a.canonizeFontNameNoLowercase)(g.FontName):(0,a.canonizeFontName)(g.FontName);(0,i.isFontVisited)(h)||((0,i.updateFontLoadStatus)(h,e),(0,i.setFontVisited)(h))}!(0,i.isFontUsedInModel)(e,d)||(0,i.doesFontExist)(f)&&(0,i.getFontLoadStatus)(f)!==i.FontLoadStatus.Pending||(s?t.add(f):n.push(f))}}}return function(e){var t;if(!(0,i.doesFontExist)(c.CellFontUnicodeFontFamily)||(0,i.getFontLoadStatus)(c.CellFontUnicodeFontFamily)===i.FontLoadStatus.Pending){var n=null===(t=e.ClientOnlyCache)||void 0===t?void 0:t.CellsToRender;if(n)for(var o=0;o<n.length;o++){var l=n[o],a=!!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.InCellControls,e)&&(l.InCellControlOptions&&l.InCellControlOptions.Type===r.InCellControlType.Checkbox&&(0,u.isCellDataValidForCheckboxOrBlankCheckbox)(l));if(l.RichValueIcon||a)return!0}}return!1}(e)&&(s?t.add(c.CellFontUnicodeFontFamily):n.push(c.CellFontUnicodeFontFamily)),s?Array.from(t.values()):n}function p(e){return new Promise((function(t){setTimeout((function(){return y(e,g,t)}),f)}))}function y(e,t,n){var r=g-t+1;switch((0,i.getFontFaceLoadStatus)(e)){case"loaded":d.ULS.sendTraceTag(542722120,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,"FontLoader::handleFontIsStillLoading: ".concat((0,a.getFontNameForLogging)(e)," was loaded successfully after ").concat(r," retries.")),n({font:e,isSuccessful:!0});break;case"loading":if(t>1){var o=function(e){var t=1<<g-e+1;return Math.min(t*f,h)}(t);setTimeout(y,o,e,t-1,n)}else d.ULS.sendTraceTag(542722121,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,"FontLoader::handleFontIsStillLoading: ".concat((0,a.getFontNameForLogging)(e)," failed to load after ").concat(r," retries.")),n({font:e,isSuccessful:!1});break;default:n({font:e,isSuccessful:!1})}}function v(e){(0,i.setFontLoadDivWithFontFamily)(C,e),(0,i.setFontLoadStatus)(e,i.FontLoadStatus.Pending)}C.innerText=".",C.style.visibility="hidden",(null===document||void 0===document?void 0:document.body)&&document.body.appendChild(C),t.registerActionOnFontLoadIfRequired=function(e,t,n,r){if((0,i.fontFaceSetSupported)()&&(0,l.isDefined)(t)){var s=m(e);if(s.length>0)return t(0),function(e){for(var t=0;t<e.length;t++)n=e[t],(0,i.doesFontExist)(n)||(0,i.isFontLoaded)(n)||v(e[t]);var n}(s),function(e,t,n){var r=[],s=[];return(0,i.getFontFaceSetReady)().then((function(){return function(e,t,n){for(var r=[],o=0;o<e.length;o++){var l=e[o];(0,i.verifyFontLoadStatus)(l,i.FontLoadStatus.Loaded)?t.push(l):(0,i.verifyFontLoadStatus)(l,i.FontLoadStatus.Failed)?n.push(l):"loading"===(0,i.getFontFaceLoadStatus)(l)&&r.push(p(l))}return Promise.all(r)}(e,r,s)})).then((function(e){if((0,l.isDefined)(t)){var d=function(e){for(var t=[],n=[],r=0;r<e.length;r++){var o=e[r];o.isSuccessful?t.push(o.font):n.push(o.font)}return[t,n]}(e),u=d[0],c=d[1];!function(e){for(var t=0;t<e.length;t++){var n=e[t];(0,i.getFontLoadStatus)(n)!==i.FontLoadStatus.Loaded&&((0,o.recalculateFontMetrics)(n),(0,i.setFontLoadStatus)(n,i.FontLoadStatus.Loaded))}}(r.concat(u)),function(e,t){for(var n=(0,l.isDefined)(t),r=0;r<e.length;r++){var o=e[r];(0,i.setFontLoadStatus)(o,i.FontLoadStatus.Failed),n&&(0,a.isKnownFont)(o)&&t((0,a.sanitizeFontName)(o))}}(s.concat(c),n),(r.length>0||u.length>0)&&t(1),t(2)}})).catch((function(e){!function(e,t){if(!(0,l.isDefined)(e)||!(0,l.isDefined)(t))return;t("API_Failure"),e(2)}(t,n)}))}(s,t,n);r&&t(1)}},t.getRenderedFontsTelemetry=function(){return(0,a.getRenderedFontsCount)()},t.getFontsToBeDownloaded=m,t.loadPreviewFont=function(e){(0,i.setFontLoadDivWithFontFamily)(C,"msofp"),(0,i.getFontFaceSetReady)().then((function(){(0,i.isFontLoadFailed)("msofp")&&e("ERROR")}),(function(){e("API_Failure")}))},t.loadPreviewFontFamily=function(e,t){"loaded"!==(0,i.getFontFaceLoadStatus)(e)&&("unloaded"===(0,i.getFontFaceLoadStatus)(e)&&(0,i.setFontLoadDivWithFontFamily)(C,e),(0,i.getFontFaceSetReady)().then((function(){(0,i.isFontLoadFailed)(e)&&t("ERROR")}),(function(){t("API_Failure")})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdleTracker=void 0;var r=n(4),o=n(76),i=function(e){function t(t,n){var r=e.call(this,t)||this;return r.isScheduled=!1,r.maxTimeAfterIdle=n,r.lastActiveTime=(0,o.getCurrentTimeInMs)(),r}return r.__extends(t,e),t.prototype.startTrackingIfApplicable=function(){this.isScheduled||(this.isScheduled=!0,this.lastActiveTime=(0,o.getCurrentTimeInMs)(),setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec))},t.prototype.stopTracking=function(){this.isScheduled=!1},t.prototype.onTimerTick=function(){e.prototype.onTimerTick.call(this);var t=(0,o.getCurrentTimeInMs)()-this.lastActiveTime;this.isScheduled&&t<this.maxTimeAfterIdle?setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec):this.isScheduled=!1},t.prototype.reportActivity=function(){e.prototype.reportActivity.call(this),this.lastActiveTime=(0,o.getCurrentTimeInMs)()},t}(n(235).Idle);t.IdleTracker=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Idle=void 0;var r=["keypress","keydown","click","contextmenu","dblclick","mousemove","scroll","touchmove","touchstart"],o=function(){function e(e){var t=this;this.userReportedActive=!1,this.userIsActive=!1,this.userMouseIsInFrame=!1,this.attachedFrames=[],this.activityReportMode=1,this.activityReportInSec=5,this.detectFramesInSec=-1,this.onActivity=function(){},this.onEnterFrame=function(){},this.onReportUserIsActive=function(){},this.onReportUserIsIdle=function(){},this.attachListenerToNewFrames=function(){for(var e=Array.prototype.slice.call(window.document.getElementsByTagName("frame")),n=Array.prototype.slice.call(window.document.getElementsByTagName("iframe")),r=0,o=e.concat(n);r<o.length;r++){var i=o[r];t.attachedFrames.indexOf(i)<0&&(i.addEventListener("mouseenter",t.onMouseEntersFrame.bind(t),t,!1),t.attachedFrames.push(i),t.userMouseIsInFrame=!0)}},this.onUserActivity=function(){t.onActivity(),t.userIsActive=!0,2!==t.activityReportMode||t.userReportedActive||t.reportActivity(),t.userMouseIsInFrame=!1},this.overrideDefaultsWithOptions(e),r.forEach((function(e){window.addEventListener(e,t.onUserActivity,!0)})),e.scheduleByDefault&&(setInterval(this.onTimerTick.bind(this),1e3*this.activityReportInSec),this.detectFramesInSec>0&&setInterval(this.attachListenerToNewFrames,1e3*this.detectFramesInSec)),this.reportActivity()}return e.prototype.onMouseEntersFrame=function(){this.onEnterFrame(),this.userMouseIsInFrame=!0},e.prototype.onTimerTick=function(){this.userReportedActive=!1,1===this.activityReportMode&&this.userIsActive||this.userMouseIsInFrame&&this.isPageVisible()?this.reportActivity():this.onReportUserIsIdle()},e.prototype.reportActivity=function(){this.onReportUserIsActive(),this.userReportedActive=!0,this.userIsActive=!1},e.prototype.overrideDefaultsWithOptions=function(e){this.activityReportInSec=e.activityReportInSec||this.activityReportInSec,this.activityReportMode=e.activityReportMode||this.activityReportMode,this.detectFramesInSec=e.detectFramesInSec||this.detectFramesInSec,this.onActivity=e.onActivity||this.onActivity,this.onEnterFrame=e.onEnterFrame||this.onEnterFrame,this.onReportUserIsActive=e.onReportUserIsActive||this.onReportUserIsActive,this.onReportUserIsIdle=e.onReportUserIsIdle||this.onReportUserIsIdle},e.prototype.isPageVisible=function(){return"hidden"!==document.visibilityState},e}();t.Idle=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCompressedTextTelemetryCollector=void 0;var r,o=n(4),i=n(2),l=n(58),a=n(11),s=n(10),d=n(0),u=n(6),c=n(12),g=n(9),f=n(32),h=n(76),C=n(33);t.registerCompressedTextTelemetryCollector=function(e,t){r||(r=new m(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Text&&!(0,h.shouldTextBeClipped)(e,n))return!0}return!1}(t)&&r.register(t)};var m=function(e){function t(t){var n=e.call(this,"CompressedTextCollector")||this;return n.canvasContext=t,n}return o.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:f.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:f.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&!(0,h.shouldTextBeClipped)(e,r)&&t.push(r)}if(t.length<1)return{isValid:!1,value:f.ResultMessageInsufficientData};var o=t[Math.floor(Math.random()*t.length)];o.CachedDisplayText||(o.CachedDisplayText=(0,d.getDisplayText)(o,e));var C=(0,l.getDefaultContextState)(void 0,e.IsRtl);(0,l.updateContextForCurrentCell)(this.canvasContext,C,o,e,void 0);var m=(0,a.getAppZoom)(),p=(0,a.getDevicePixelRatio)(),y=(0,i.getTextDrawingMaxWidth)((0,u.getCellWidth)(e,o,!0),(0,g.getCellTextHorizontalPadding)(o,e,m,p),(0,g.getDistanceFromCellStartToIconEnd)(e,o,m,p),(0,c.getExpandCollapseButtonPadding)(o),0),v=(0,g.getTextWidth)(this.canvasContext,e,o);return{isValid:!0,value:{isCompressed:v>y,textWidth:v,maxWidth:y,len:o.CachedDisplayText.length,font:{name:(0,s.getFontNameForLogging)(o.CachedFont.FontName),size:o.CachedFont.Size,italic:!!o.CachedFont.Italic,bold:!!o.CachedFont.Bold}}}},t}(C.AbstractPassiveTelemetryCollector)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerSpillCellTelemetryCollector=void 0;var r,o=n(4),i=n(1),l=n(11),a=n(10),s=n(73),d=n(32),u=n(33);t.registerSpillCellTelemetryCollector=function(e,t){r||(r=new c(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Spill&&n.Text)return!0}return!1}(t)&&r.register(t)};var c=function(e){function t(t){var n=e.call(this,"SpillCellCollector")||this;return n.canvasContext=t,n}return o.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:d.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:d.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&r.Spill&&t.push(r)}if(t.length<1)return{isValid:!1,value:d.ResultMessageInsufficientData};var o=t[Math.floor(Math.random()*t.length)],u=JSON.parse(JSON.stringify(o));return(0,s.updateCellSpill)(this.canvasContext,e,u,(0,l.getAppZoom)(),(0,l.getDevicePixelRatio)()),{isValid:!0,value:{isEqual:(0,i.areGridCellsEqual)(o,u,e,e).isEqual,font:{name:(0,a.getFontNameForLogging)(o.CachedFont.FontName),italic:!!o.CachedFont.Italic,bold:!!o.CachedFont.Bold}}}},t}(u.AbstractPassiveTelemetryCollector)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAutoFitWidthTelemetryCollector=void 0;var r,o=n(4),i=n(18),l=n(2),a=n(58),s=n(11),d=n(10),u=n(0),c=n(12),g=n(9),f=n(32),h=n(76),C=n(33);t.registerAutoFitWidthTelemetryCollector=function(e,t){r||(r=new m(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Text&&!(0,h.shouldTextBeClipped)(e,n))return!0}return!1}(t)&&r.register(t)};var m=function(e){function t(t){var n=e.call(this,"AutoFitWidthCollector")||this;return n.canvasContext=t,n}return o.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:f.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:f.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&!(0,h.shouldTextBeClipped)(e,r)&&p(r)&&t.push(r)}if(t.length<1)return{isValid:!1,value:f.ResultMessageInsufficientData};var o=t[Math.floor(Math.random()*t.length)];o.CachedDisplayText||(o.CachedDisplayText=(0,u.getDisplayText)(o,e));var C=(0,a.getDefaultContextState)(void 0,e.IsRtl);(0,a.updateContextForCurrentCell)(this.canvasContext,C,o,e,void 0);var m=(0,s.getAppZoom)(),y=(0,s.getDevicePixelRatio)(),v=(0,l.getTextDrawingMaxWidth)(o.SrvDx||0,(0,g.getCellTextHorizontalPaddingWithoutVisualElements)(e,o),(0,g.getDistanceFromCellStartToIconEnd)(e,o,m,y),(0,c.getExpandCollapseButtonPadding)(o),(0,i.getAutoFilterPaddingForAdvancedHorizontalAlignment)(e,o,m,y)),S=(0,g.getTextWidth)(this.canvasContext,e,o);return{isValid:!0,value:{tooWide:S>v,tooNarrow:v>S+this.canvasContext.measureText(" ").width,textWidth:S,maxWidth:v,len:o.CachedDisplayText.length,font:{name:(0,d.getFontNameForLogging)(o.CachedFont.FontName),size:o.CachedFont.Size,italic:!!o.CachedFont.Italic,bold:!!o.CachedFont.Bold}}}},t}(C.AbstractPassiveTelemetryCollector);function p(e){return!!e.SrvDx}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAutoFitHeightTelemetryCollector=void 0;var r,o=n(4),i=n(86),l=n(35),a=n(58),s=n(10),d=n(0),u=n(9),c=n(32),g=n(33);t.registerAutoFitHeightTelemetryCollector=function(e,t){r||(r=new f(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Text&&n.WrapText&&h(n))return!0}return!1}(t)&&r.register(t)};var f=function(e){function t(t){var n=e.call(this,"AutoFitHeightCollector")||this;return n.canvasContext=t,n}return o.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:c.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:c.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&r.WrapText&&h(r)&&t.push(r)}if(t.length<1)return{isValid:!1,value:c.ResultMessageInsufficientData};var o=t[Math.floor(Math.random()*t.length)],g=(0,a.getDefaultContextState)(void 0,e.IsRtl);(0,a.updateContextForCurrentCell)(this.canvasContext,g,o,e,void 0);var f=(0,u.getTextWidth)(this.canvasContext,e,o),C=(0,u.getTextLineHeight)(o,e),m=(0,d.getFormattedText)(o.CachedDisplayText,o,e),p=(0,i.breakTextToLines)(this.canvasContext,o.CachedDisplayText,f,l.BreakType.Wrap,this.canvasContext.measureText(" ").width,e,o,m,o.WrapText),y=p.textLines.length*C,v=o.SrvDy||0;return{isValid:!0,value:{tooLong:y>v,tooShort:v-y>C,textHeight:y,SrvDy:v,numLines:p.textLines.length,isRichText:!!m,font:{name:(0,s.getFontNameForLogging)(o.CachedFont.FontName),size:o.CachedFont.Size,italic:!!o.CachedFont.Italic,bold:!!o.CachedFont.Bold}}}},t}(g.AbstractPassiveTelemetryCollector);function h(e){return!!e.SrvDy}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCellHashDisplayCollector=void 0;var r,o=n(4),i=n(1),l=n(0),a=n(10),s=n(32),d=n(33);t.registerCellHashDisplayCollector=function(e){r||(r=new u),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Text&&g(n))return!0}return!1}(e)&&r.register(e)};var u=function(e){function t(){return e.call(this,"CellHashDisplayCollector")||this}return o.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:s.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:s.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&g(r)&&t.push(r)}if(t.length<1)return{isValid:!1,value:s.ResultMessageInsufficientData};var o,i,d,u,f=0,h={};for(n=0;n<t.length;n++){var C=t[n],m=C.CachedDisplayText||(0,l.getDisplayText)(C,e),p=C.Text,y=c(m);if(y!==c(p)&&y&&(f++,C.CachedFont)){var v=(o=C.CachedFont,i=void 0,d=void 0,u=void 0,i=(0,a.getFontNameForLogging)(o.FontName),d=o.Size,u=(0,a.getCellFontWeightStyle)(o.Bold||!1,o.Italic||!1),"".concat(u," ").concat(i," ").concat(d,"pt"));h[v]||(h[v]=0),h[v]+=1}}return{isValid:!0,value:{updatedCells:f,totalCells:t.length,fontWise:h}}},t}(d.AbstractPassiveTelemetryCollector);function c(e){for(var t=0;t<e.length;t++)if("#"!==e[t])return!1;return!0}function g(e){return e.ValueType===i.CellValueType.Number}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVetoType=t.getErrorTypeForProblem=t.hasThresholdExceeded=t.analyzeModelFidelity=void 0;var r=n(1),o=n(21),i=n(10),l=n(242),a={};function s(e,t){var n=t.CachedBorderStyle;if(n)for(var r=0;r<n.Borders.length;r++){var o=n.Borders[r];2===o.Weight?m(e,l.ProblemType.MediumBorder):3===o.Weight&&m(e,l.ProblemType.ThickBorder)}}function d(e,t,n){var r=n.CachedStyle,i=n.CachedFont;r&&i&&r.Orientation&&((0,o.shouldDrawRotatedText)(t,n.CachedStyle,n.CachedFont)||m(e,l.ProblemType.CellTextOrientation))}function u(e,t,n){if(t.Text){var r=t.CachedDisplayTextRuns;if(r){for(var o=0;o<r.length;o++)if(r[o].CachedFont&&!(0,i.isFontSupportedNew)(r[o].CachedFont.FontName,n)){m(e,l.ProblemType.CustomFont);break}}else t.CachedFont&&!(0,i.isFontSupportedNew)(t.CachedFont.FontName,n)&&m(e,l.ProblemType.CustomFont)}}function c(e,t){var n=t.CachedFont;n&&(n.Underline!==r.FontUnderline.SingleAccounting&&n.Underline!==r.FontUnderline.DoubleAccounting||m(e,l.ProblemType.AccountingUnderline))}function g(e,t,n){var o=t.CachedStyle;o&&o.IsPattern&&!(0,r.isRenderFlagEnabled)(r.RenderFlagsArray.RenderPatternStyle,n)&&m(e,l.ProblemType.PatternStyle)}function f(e,t){var n=t.CachedBorderStyle;n&&n.HasDiagBorder&&m(e,l.ProblemType.DiagonalBorder)}function h(e,t){t.Spill&&t.Spill.IsSpillBlocked&&t.Spill.IsSpillingOutsideOfBlock&&m(e,l.ProblemType.SpillCellAcrossBlocks)}function C(e,t){var n=t.CachedDisplayTextRuns;if(t.WrapText&&n)for(var o=0;o<n.length;o++){var i=n[o].CachedFont;if(i&&(i.VerticalAlign===r.FontVerticalAlignment.Subscript||i.VerticalAlign===r.FontVerticalAlignment.Superscript))return void m(e,l.ProblemType.SubScriptSuperScriptInWrapText)}}function m(e,t){var n=l.ProblemType[t];e[n]?e[n]+=1:e[n]=1}a[l.ProblemType[l.ProblemType.AccountingUnderline]]={value:5,errorType:"MissingFeatureWithFallback",veto:"ContentFallback"},a[l.ProblemType[l.ProblemType.BoldText]]={value:25,errorType:"LowRenderingFeature",veto:"ContentRenderedIncorrectly"},a[l.ProblemType[l.ProblemType.CellHashText]]={value:5,errorType:"MissingFeatureWithFallback",veto:"ContentFallback"},a[l.ProblemType[l.ProblemType.CellTextOrientation]]={value:5,errorType:"MissingFeatureWithFallback",veto:"ContentFallback"},a[l.ProblemType[l.ProblemType.CustomFont]]={value:5,errorType:"MissingFeatureWithFallback",veto:"MissingFont"},a[l.ProblemType[l.ProblemType.DiagonalBorder]]={value:1,errorType:"MissingFeatureWithoutFallback",veto:"ContentRenderFailed"},a[l.ProblemType[l.ProblemType.MediumBorder]]={value:25,errorType:"LowRenderingFeature",veto:"ContentRenderedIncorrectly"},a[l.ProblemType[l.ProblemType.PatternStyle]]={value:1,errorType:"MissingFeatureWithoutFallback",veto:"ContentRenderFailed"},a[l.ProblemType[l.ProblemType.SpillCellAcrossBlocks]]={value:5,errorType:"MissingFeatureWithFallback",veto:"ContentFallback"},a[l.ProblemType[l.ProblemType.SubScriptSuperScriptInWrapText]]={value:25,errorType:"LowRenderingFeature",veto:"ContentRenderedIncorrectly"},a[l.ProblemType[l.ProblemType.ThickBorder]]={value:25,errorType:"LowRenderingFeature",veto:"ContentRenderedIncorrectly"},t.analyzeModelFidelity=function(e){for(var t={},n=0;n<e.Cells.length;n++){var r=e.Cells[n];r&&(u(t,r,e),s(t,r),d(t,e,r),c(t,r),g(t,r,e),C(t,r),f(t,r),h(t,r))}return t},t.hasThresholdExceeded=function(e,t){return t>a[e].value},t.getErrorTypeForProblem=function(e){return a[e].errorType+"_"+e},t.getVetoType=function(e){return a[e].veto}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ProblemType=void 0,function(e){e[e.ThickBorder=0]="ThickBorder",e[e.MediumBorder=1]="MediumBorder",e[e.BoldText=2]="BoldText",e[e.CustomFont=3]="CustomFont",e[e.CellHashText=4]="CellHashText",e[e.CellTextOrientation=5]="CellTextOrientation",e[e.AccountingUnderline=6]="AccountingUnderline",e[e.SubScriptSuperScriptInWrapText=7]="SubScriptSuperScriptInWrapText",e[e.PatternStyle=8]="PatternStyle",e[e.DiagonalBorder=9]="DiagonalBorder",e[e.SpillCellAcrossBlocks=10]="SpillCellAcrossBlocks"}(r||(t.ProblemType=r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAppMemoryInfoTelemetryCollector=void 0;var r,o=n(4),i=n(11),l=n(32),a=n(33);t.registerAppMemoryInfoTelemetryCollector=function(){r||(r=new s),r.register({})};var s=function(e){function t(){return e.call(this,"AppMemoryInfoCollector")||this}return o.__extends(t,e),t.prototype.collect=function(){var e,t,n;if(!this.canCollectorExecute())return{isValid:!1,value:l.ResultMessageCollectorDisabled};for(var r=null===(e=performance.memory)||void 0===e?void 0:e.usedJSHeapSize,o=null===(t=performance.memory)||void 0===t?void 0:t.totalJSHeapSize,a=null===(n=performance.memory)||void 0===n?void 0:n.jsHeapSizeLimit,s=navigator.deviceMemory||-1,d=document.getElementsByTagName("*").length,u=(0,i.blockCacheSizeCallback)(),c=0,g=document.getElementsByTagName(l.CanvasTagName),f=0;f<g.length;f++){var h=g.item(f);h&&(c+=h.clientHeight*h.clientWidth)}return{isValid:!0,value:{usedJSHeapSize:r,totalJSHeapSize:o,jsHeapSizeLimit:a,deviceMemory:s,numOfDomElements:d,numOfCanvas:g.length,numOfGridCanvas:document.getElementsByClassName(l.GridCanvasClassName).length,blockCacheSize:u,computedSizeOfCanvas:c}}},t}(a.AbstractPassiveTelemetryCollector)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerBlockStatisticsLogCollector=void 0;var r,o=n(4),i=n(11),l=n(32),a=n(33);t.registerBlockStatisticsLogCollector=function(){r||(r=new s),r.register({})};var s=function(e){function t(){return e.call(this,"blockStatisticsLogCollector")||this}return o.__extends(t,e),t.prototype.collect=function(){return this.canCollectorExecute()?{isValid:!0,value:(0,i.getBlockStatisticLog)()}:{isValid:!1,value:l.ResultMessageCollectorDisabled}},t}(a.AbstractPassiveTelemetryCollector)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerModelCascadeTimeCollector=void 0;var r,o=n(4),i=n(1),l=n(0),a=n(32),s=n(33);t.registerModelCascadeTimeCollector=function(e){r||(r=new d),function(e){var t;return!!(null===(t=e.Cells)||void 0===t?void 0:t.length)}(e)&&r.register(e)};var d=function(e){function t(){return e.call(this,"ModelCascadeTimeCollector")||this}return o.__extends(t,e),t.prototype.collect=function(){var e;if(!this.canCollectorExecute())return{isValid:!1,value:a.ResultMessageCollectorDisabled};for(var t=this.data.pop(),n=JSON.stringify(t),r=performance.now(),o=JSON.parse(n),i=JSON.parse(n),l=performance.now(),s=o.Cells,d=s[Math.floor(Math.random()*s.length)].Col,h=[],C=new Map,m=[],p=new Map,y=[],v=new Map,S=[],R=i.Styles.length,F=i.BorderStyles.length,w=i.Fonts.length,T=0;T<s.length;T++){var I=s[T];if(I.Col===d){var x=f(I);x.Col=0,h.push(x);var b=x.StyleID||0;if(C.has(b))x.StyleID=C.get(b);else{var D=u(b,o,R,C),A=D.FontID||0;if(v.has(A))D.FontID=v.get(A);else{var P=g(A,o,w,v);P.ID=w+P.Size,S.push(P),D.FontID=P.ID,v.set(A,P.ID)}D.ID=R+C.size,C.set(b,D.ID),m.push(D),x.StyleID=D.ID}var H=x.BorderStyleID||0;if(p.has(H))x.BorderStyleID=p.get(H);else{var B=c(H,o,F,p);B.ID=F+C.size,p.set(b,B.ID),y.push(B),x.BorderStyleID=B.ID}}}var M=performance.now();!function(e,t){e.ColMetadata.unshift(t.ColMetadata.shift()),e.ColumnNumbers.unshift(t.ColumnNumbers.shift()),e.ColumnOffsets.unshift(t.ColumnOffsets.shift()),e.ColumnWidths.unshift(t.ColumnWidths.shift())}(i,o);var O=performance.now();!function(e,t,n,r){var o,i,l;null===(o=e.Styles)||void 0===o||o.push.apply(o,t),null===(i=e.Fonts)||void 0===i||i.push.apply(i,n),null===(l=e.BorderStyles)||void 0===l||l.push.apply(l,r)}(i,m,S,y);var k=performance.now();null===(e=i.Cells)||void 0===e||e.push.apply(e,h);var L=performance.now(),N=(L-r).toFixed(2),E=(l-r).toFixed(2),z=(M-l).toFixed(2),W=(O-M).toFixed(2),G=(k-O).toFixed(2),V=(L-k).toFixed(2),j=(L-l).toFixed(2);return{isValid:!0,value:{numOfCellsCopied:h.length,numOfStylesCopied:m.length,numOfBorderStylesCopied:y.length,numOfFontsCopied:S.length,totalTime:N,totalTimeWithoutPreprocess:j,preparePhaseTime:z,preprocessTime:E,columnShiftTime:W,styleShiftTime:G,cellShiftTime:V}}},t}(s.AbstractPassiveTelemetryCollector);function u(e,t,n,r){var o=(0,i.getReferencedObjectById)(e,t.Styles);return(0,l.duplicateStyle)(t,o,n+r.size,1)}function c(e,t,n,r){var o=(0,i.getReferencedObjectById)(e,t.BorderStyles);return(0,l.duplicateBorderStyle)(o,n+r.size,1)}function g(e,t,n,r){var o=(0,i.getReferencedObjectById)(e,t.Fonts);return(0,l.duplicateFont)(o,n+r.size,1)}function f(e){var t=e.Spill?{SpanToEnd:e.Spill.SpanToEnd,IsSpillBlocked:e.Spill.IsSpillBlocked,IsSpillingOutsideOfBlock:e.Spill.IsSpillingOutsideOfBlock,SpanToStart:e.Spill.SpanToStart}:void 0;return{Col:e.Col,Row:e.Row,Text:e.Text,StyleID:e.StyleID||0,Ifmt:e.Ifmt||0,IfmtStamped:e.IfmtStamped||0,BorderStyleID:e.BorderStyleID||0,HorizontalAlignmentSet:e.HorizontalAlignmentSet,ValueType:e.ValueType,HasIgnorableError:e.HasIgnorableError,TableColHeader:e.TableColHeader,TableRowHeader:e.TableRowHeader,SrvDx:e.SrvDx||0,SrvDy:e.SrvDy||0,TolType:e.TolType||0,Spill:t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerModelStyleSizeCollector=void 0;var r,o=n(4),i=n(32),l=n(33);t.registerModelStyleSizeCollector=function(e){var t;r||(r=new a),(null===(t=e.Cells)||void 0===t?void 0:t.length)&&r.register(e)};var a=function(e){function t(){return e.call(this,"ModelStyleSizeCollector")||this}return o.__extends(t,e),t.prototype.collect=function(){var e,t,n,r;if(!this.canCollectorExecute())return{isValid:!1,value:i.ResultMessageCollectorDisabled};var o=new TextEncoder,l=this.data.pop(),a=o.encode(JSON.stringify(l)).length,s=o.encode(JSON.stringify(l.Cells)).length,d=o.encode(JSON.stringify(l.Styles)).length,u=o.encode(JSON.stringify(l.Fonts)).length,c=o.encode(JSON.stringify(l.BorderStyles)).length,g=d+c+u;return{isValid:!0,value:{sizePercentageForModel:g/a*100,sizePercentageForCell:g/(g+s)*100,modelSize:a,styleSize:d,borderStyleSize:c,fontSize:u,numOfCells:(null===(e=l.Cells)||void 0===e?void 0:e.length)||0,numOfStyles:(null===(t=l.Styles)||void 0===t?void 0:t.length)||0,numOfFonts:(null===(n=l.Fonts)||void 0===n?void 0:n.length)||0,numOfBorderStyles:(null===(r=l.BorderStyles)||void 0===r?void 0:r.length)||0}}},t}(l.AbstractPassiveTelemetryCollector)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updatePrintAreasOfBlockPair=t.updatePageBreaksOfBlockPair=t.removeExtraModelRowsColumns=t.cellHasBorderAtPosition=t.canCellsOfMultipleRowColHideOrCascade=t.canCellsOfRowColHideOrCascade=t.modelReverseCascadeRowCols=t.modelCascadeMultipleRowCols=t.modelCascadeRowCols=t.modelCascadeRowColsOperations=t.modelCascade=t.hideMultipleRowsColumns=t.hideDeleteRowsColumns=t.modelRowColOperations=t.hideRowsColumns=t.GridInstantaneousOperation=t.isHideColumnMergedCellFlightEnabled=void 0;var r,o=n(4),i=n(1),l=n(0),a=n(7),s=n(8),d=n(138),u=n(17),c=n(74),g=n(139),f=0,h=!1,C=void 0,m=void 0,p=(0,i.isChangeGateEnabled)(i.ChangeGate.InsertRowColBorderCascadingBugFix),y=(0,i.isChangeGateEnabled)(i.ChangeGate.EnablingRowColCSEForComplexCellsSlice2),v=(0,i.isChangeGateEnabled)(i.ChangeGate.EnablingHiddenRangesSlice2),S=(0,i.isChangeGateEnabled)(i.ChangeGate.InsertRowHeightMismatchBugFix),R=(0,i.isChangeGateEnabled)(i.ChangeGate.BorderRowColOps),F=(0,i.isChangeGateEnabled)(i.ChangeGate.InsertCSEBorderCopyBugFix),w=(0,i.isChangeGateEnabled)(i.ChangeGate.MaxAllowedRowColLimitBugFix),T=(0,i.isChangeGateEnabled)(i.ChangeGate.BorderRowColOpsV2),I=(0,i.isChangeGateEnabled)(i.ChangeGate.BorderScenarioForCascade),x=(0,i.isChangeGateEnabled)(i.ChangeGate.RemoveCellFromExtraModelBugFix),b=(0,i.isChangeGateEnabled)(i.ChangeGate.EnableEdgeBorderStyleSupportForFreezePanesCSE),D=(0,i.isChangeGateEnabled)(i.ChangeGate.EnableMergeCellSupportForFreezePanesCse),A=(0,i.isChangeGateEnabled)(i.ChangeGate.FixStyleIdIssue),P=new Map,H=new Map;function B(e){return(0,i.isRenderFlagEnabled)(i.RenderFlagsArray.HideColumnMergedCellSlice1,e)&&(0,i.isRenderFlagEnabled)(i.RenderFlagsArray.HideColumnSlice1,e)}function M(e,t,n,o,i){var l,a,s=i===r.Hide||i===r.FreezePane,d=o?e.RowNumbers:e.ColumnNumbers,u=J(d,t),c=me(d,n,u);if(-1===c[0])return!1;if(oe(e.Cells))return le(e,c,o,s),!0;for(var g=[],f=c[c.length-1],h=0;h<e.Cells.length;h++){var C=e.Cells[h];Oe(C,e,o,u,n),Ce(C,c,o)||Y(C,u,n,o)?C.Merge&&(pe(C,u,n,o)||(!s&&Re(C,u,n,o,e)&&(C.Text=void 0),ye(C,u,n,o,s,e),o?C.Row>u&&(C.Row=u):C.Col>u&&(C.Col=u),g.push(C))):(C.Merge&&!s&&(o?(null===(l=C.Merge)||void 0===l?void 0:l.OriginRow)&&0!==C.Merge.OriginRow&&(C.Merge.OriginRow-=n+1):(null===(a=C.Merge)||void 0===a?void 0:a.OriginColumn)&&0!==C.Merge.OriginColumn&&(C.Merge.OriginColumn-=n+1)),o?C.Row>f&&(C.Row-=n+1):C.Col>f&&(C.Col-=n+1),g.push(C))}return Ae()&&b&&i===r.FreezePane&&u>0&&function(e,t,n){var r=n-1,o=e.Cells.filter((function(e){return t?e.Row===r:e.Col===r})),i=e.Cells.filter((function(e){return t?e.Row===n:e.Col===n})),l=0,a=0;for(;l<i.length;){var s=a<o.length?o[a]:null,d=i[l];t?s?s.Col===d.Col?(L(s,d,e,e),a++,l++):s.Col<d.Col?a++:(L(s,d,e,e),l++):(L(s,d,e,e),l++):s?s.Row===d.Row?(N(s,d,e,e),a++,l++):s.Row<d.Row?a++:(N(s,d,e,e),l++):(N(s,d,e,e),l++)}}(e,o,u),le(e,c,o,s),e.Cells=[],Te(e,g),!0}function O(e,t,n,r,o,s,u){var c,f,h={};try{var C=(0,i.isGlobalBorderStylesEnabled)(e),m=(0,i.isGlobalFontsAndCellStylesFlightEnabled)(e),p=performance.now(),y=o?e.RowNumbers:e.ColumnNumbers,v=J(y,n),S=me(y,r,v),R=Ae()&&!!u;if(-1===S[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(R){if(oe(e.Cells)&&!(null==u?void 0:u.performDiagonalCascading))return h.timeTaken=performance.now()-p,Z(e,t,S,s,o),{isSuccess:!0,metric:h}}else if(oe(e.Cells))return h.timeTaken=performance.now()-p,Z(e,t,S,s,o),ke(t,o),{isSuccess:!0,metric:h};var F=[],w=[],T=[],I=new Map,x=[],D=new Map,P=[],H=new Map,B=new Map,M=t.Styles.length,O=t.Fonts.length,k=t.BorderStyles.length,L=r+1,N=o?t.RowOffsets.length:t.ColumnOffsets.length;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;var E=!1,z=!1,V=!1,j=!1;(0,i.preprocessModelStyles)(e),(0,i.preprocessModelStyles)(t);for(var q=0;q<e.Cells.length;q++){var Y=e.Cells[q],X=!1,K=o?Y.Row:Y.Col,Q=o?Y.Col:Y.Row;if(R&&Pe(Y,o,u))w.push(Y);else if(Ce(Y,S,o)){if(Y.Merge)if(pe(Y,v,r,o))Y.Merge.SpansBlocks&&(0,g.cascadeMergeCellSpanningBlocksFully)(e,t,Y,r,w,C,o);else{var $=(0,d.duplicateCell)(Y);$.Merge.SpansBlocks&&g.isHideColMergedCellAcrossBlocksEnabled?((0,g.updateSrcModelMergeCellSpanningBlocks)($,e,t,v,r,o),0!==$.Merge.Columns&&0!==$.Merge.Rows||(j=!0)):Se($,e,v,r,X,o,s),Y.Merge.SpansBlocks||(X=!0),o?$.Row=0:$.Col=0,w.push($)}if(Y.Merge)if(X)Se(Y,e,v,r,X,o,s);else if(Y.Merge.SpansBlocks&&!X)continue;var ee=o?Y.Row:Y.Col;o?Y.Row=N+ee:Y.Col=N+ee,R&&He(Y,t,r,o,u),F.push(Y);var te=Y.StyleID||0,ne=!1,re=!1;if(A&&(ne=!m||(0,a.isNullOrUndefined)(Y.GlobalCellStyleID)),!I.has(te)&&te!==i.UniqueStyleID.Default&&te!==i.UniqueStyleID.Hyperlink){var ie=(0,i.getReferencedObjectById)(te,e.Styles);A||(ne=!m||(0,a.isNullOrUndefined)(Y.GlobalCellStyleID)),re=!m||(0,a.isNullOrUndefined)(ie.GlobalFontID);var le=ie.FontID||0;if(re&&!D.has(le)){var ae=O+D.size;D.set(le,ae);var se=(0,i.getReferencedObjectById)(le,e.Fonts),ue=(0,l.duplicateFont)(se,ae,1);x.push(ue),V=!0}if(ne){var ce=M-l.NumberOfUniqueStyleIDs+T.length;I.set(te,ce);var ge=(0,l.duplicateOnlyStyleWithoutFont)(ie,ce,1);ge.FontID=D.get(le),T.push(ge),z=!0}}var fe=Y.BorderStyleID||0,he=!C||(0,a.isNullOrUndefined)(Y.GlobalBorderStyleID);if(he&&!H.has(fe)&&fe!==i.UniqueStyleID.DefaultBorder){var ye=k+P.length;H.set(fe,ye);var ve=(0,l.duplicateBorderStyle)((0,i.getReferencedObjectById)(fe,e.BorderStyles),ye,1);P.push(ve),E=!0}var Re=Y.BorderStyleID||0;if(ne&&(Y.StyleID=te===i.UniqueStyleID.Default?i.UniqueStyleID.Default:I.get(te)),he&&(Y.BorderStyleID=fe===i.UniqueStyleID.DefaultBorder?i.UniqueStyleID.DefaultBorder:H.get(fe)),R&&b){var Fe=it(Y,e,k,P,he,H,B,S,ee,o,u,Q,K);E=E||Fe}else if(de(ee,S[S.length-1])){var we=!1,Te={},Ie={};if(o?(Te=_(Y,e,ee,o),we=0!==Object.keys(Te).length):(Ie=G(Y,e,ee,o),we=0!==Object.keys(Ie).length),we){var xe=Y.BorderStyleID||0,be=(ye=k+P.length,U(Y,e.Cells,ee,o).BorderStyleID||0);if(he&&H.get(xe)&&B.get(be))Y.BorderStyleID=H.get(xe),C&&(Y.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID((0,i.getReferencedObjectById)(Re,e.BorderStyles)));else{he&&(H.set(xe,ye),B.set(be,k+B.size));ve=(0,l.duplicateBorderStyle)((0,i.getReferencedObjectById)(Re,e.BorderStyles),ye,1);if(o){for(var De=ve.Borders,Be=De.length,Me=0;Me<De.length;Me++)De[Me].BorderPosition<Te.BorderPosition&&(Be=Me+1);ve.Borders.splice(Be,0,Te)}else ve.Borders.push(Ie);P.push(ve),Y.BorderStyleID=ye,C&&(Y.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(ve)),E=!0}}}}else o?Y.Row-=L:Y.Col-=L,w.push(Y)}E&&(c=t.BorderStyles).push.apply(c,P),b||W(t,N,o),(!R||R&&!(null==u?void 0:u.performDiagonalCascading))&&(b&&W(t,N,o),Z(e,t,S,s,o));for(var Oe=0,Le=F;Oe<Le.length;Oe++){Y=Le[Oe];var Ne=(0,l.getCellPositionInArray)(Y,t.Cells);t.Cells.splice(Ne,0,Y)}if(z)for(var Ee=0,ze=T;Ee<ze.length;Ee++){ie=ze[Ee];t.Styles.splice(ie.ID||0,0,ie)}if(V&&(f=t.Fonts).push.apply(f,x),ke(t,o),g.isHideColMergedCellAcrossBlocksEnabled){for(var We=[],Ge=0,Ve=w;Ge<Ve.length;Ge++){Y=Ve[Ge],Ne=(0,l.getCellPositionInArray)(Y,We);We.splice(Ne,0,Y)}e.Cells=We}else e.Cells=w;j&&(0,g.changeBorderForMergedCellSpanningBlocks)(e,w,o),h.countOfStylesMoved=I.size,h.countOfFontsMoved=D.size,h.countOfBorderStylesMoved=H.size,h.timeTaken=performance.now()-p}catch(e){return{isSuccess:!1,exception:e,metric:h}}return{isSuccess:!0,metric:h}}function k(e,t,n,r,o){var a,s,u={};try{var c=performance.now(),f=o?e.RowNumbers:e.ColumnNumbers,h=J(f,n),C=me(f,r,h);if(-1===C[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(oe(e.Cells)&&oe(t.Cells))return u.timeTaken=performance.now()-c,o?$(e,t,C):Q(e,t,C),ke(t,o),{isSuccess:!0,metric:u};var m=[],y=[],v=[],S=e.ColumnNumbers.length,R=e.RowNumbers.length,F=r+1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0,(0,i.preprocessModelStyles)(e),(0,i.preprocessModelStyles)(t);for(var w=0;w<t.Cells.length;w++){var T=t.Cells[w];o?T.Row+=F:T.Col+=F}for(w=0;w<e.Cells.length;w++){T=e.Cells[w];var I=!1,x={};if(Ce(T,C,o)||Y(T,h,r,o)){T.Merge&&(pe(T,h,r,o)||(x=(0,d.duplicateCell)(T),De(T,e,r,I,o),I=!0)),T.Merge&&I&&0!==Object.keys(x).length&&De(x,e,r,I,o),I||m.push(T);var b=o?T.Row:T.Col,D=void 0;if(D=I?x:(0,d.duplicateCell)(T),o?D.Merge&&I?D.Row=0:D.Row=b+F-R:D.Merge&&I?D.Col=0:D.Col=b+F-S,v.push(D),!p&&b===C[0])if(o){var A=j(T,e);if(0!==Object.keys(A).length){var P=(null===(a=t.BorderStyles)||void 0===a?void 0:a.length)||0,H=b-1,B=!0;null==(O=(0,i.getCell)(H,T.Col,e))&&(B=!1,O=(0,i.getOrCreateCell)(e,H,T.Col)),(k=(0,l.duplicateBorderStyle)((0,i.getReferencedObjectById)(O.BorderStyleID||0,e.BorderStyles),P,1)).Borders.push(A),O.BorderStyleID=P,e.BorderStyles.push(k),O.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(k),B||y.push(O)}}else{var M=V(T,e);if(0!==Object.keys(M).length){P=(null===(s=t.BorderStyles)||void 0===s?void 0:s.length)||0;var O,k,E=b-1;B=!0;null==(O=(0,i.getCell)(T.Row,E,e))&&(B=!1,O=(0,i.getOrCreateCell)(e,T.Row,E)),(k=(0,l.duplicateBorderStyle)((0,i.getReferencedObjectById)(O.BorderStyleID||0,e.BorderStyles),P,1)).Borders.push(M),O.BorderStyleID=P,e.BorderStyles.push(k),O.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(k),B||y.push(O)}}}}o?$(e,t,C):Q(e,t,C),Ie(e,m),Te(e,y),Te(t,v),ke(t,o),p&&function(e,t,n,r){(function(e,t,n){for(var r=e.Cells.filter((function(e){return n?e.Row===t:e.Col===t})),o=0;o<r.length;o++){var a=r[o];if(n){if((0,g.getBorderAtPosition)(a,e,i.BorderPositionType.Bottom)){var s=(0,l.duplicateBorderStyle)((0,i.getBorderStyleByID)(a,e),e.BorderStyles.length,1);-1!==(d=s.Borders.findIndex((function(e){return e.BorderPosition===i.BorderPositionType.Bottom})))&&s.Borders.splice(d,1),a.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(s),e.BorderStyles.push(s),a.BorderStyleID=s.ID}}else if((0,g.getBorderAtPosition)(a,e,i.BorderPositionType.Right)){var d;s=(0,l.duplicateBorderStyle)((0,i.getBorderStyleByID)(a,e),e.BorderStyles.length,1);-1!==(d=s.Borders.findIndex((function(e){return e.BorderPosition===i.BorderPositionType.Right})))&&s.Borders.splice(d,1),a.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(s),e.BorderStyles.push(s),a.BorderStyleID=s.ID}}})(t,n,r),function(e,t,n){var r=n?e.RowNumbers.length-1:e.ColumnNumbers.length-1,o=e.Cells.filter((function(e){return n?e.Row===r:e.Col===r})),i=t.Cells.filter((function(e){return n?0===e.Row:0===e.Col})),l=0,a=0;for(;a<i.length;){var s=l<o.length?o[l]:null,d=i[a];n?s?s.Col===d.Col?(L(s,d,e,t),l++,a++):s.Col<d.Col?l++:(L(s,d,e,t),a++):(L(s,d,e,t),a++):s?s.Row===d.Row?(N(s,d,e,t),l++,a++):s.Row<d.Row?l++:(N(s,d,e,t),a++):(N(s,d,e,t),a++)}}(e,t,r)}(e,t,r,o),u.countOfStylesMoved=0,u.countOfFontsMoved=0,u.countOfBorderStylesMoved=0,u.timeTaken=performance.now()-c}catch(e){return{isSuccess:!1,exception:e,metric:u}}return{isSuccess:!0,metric:u}}function L(e,t,n,r,o){var a=(0,g.getBorderAtPosition)(t,r,i.BorderPositionType.Top);if(a){e||Te(n,[e=(0,i.getOrCreateCell)(n,o||n.RowNumbers.length-1,t.Col)]);var s=(0,l.duplicateBorderStyle)((0,i.getBorderStyleByID)(e,n),n.BorderStyles.length,1),d=(0,g.duplicateBorder)(a);d.BorderPosition=i.BorderPositionType.Bottom;for(var u=0,c=0;c<s.Borders.length;c++)if(s.Borders[c].BorderPosition>i.BorderPositionType.Bottom){u=1,s.Borders.splice(c,0,d);break}u||s.Borders.push(d),e.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(s),n.BorderStyles.push(s),e.BorderStyleID=s.ID}}function N(e,t,n,r,o){var a=(0,g.getBorderAtPosition)(t,r,i.BorderPositionType.Left);if(a){e||Te(n,[e=(0,i.getOrCreateCell)(n,t.Row,o||n.ColumnNumbers.length-1)]);var s=(0,l.duplicateBorderStyle)((0,i.getBorderStyleByID)(e,n),n.BorderStyles.length,1),d=(0,g.duplicateBorder)(a);d.BorderPosition=i.BorderPositionType.Right,s.Borders.push(d),e.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(s),n.BorderStyles.push(s),e.BorderStyleID=s.ID}}function E(e,t){for(var n=0,r=e.Borders;n<r.length;n++){if(r[n].BorderPosition===t)return!0}return!1}function z(e,t){return E((0,i.getBorderStyleByID)(e,t),i.BorderPositionType.Left)}function W(e,t,n,r){for(var o=0,a=e.Cells.filter((function(e){return n?e.Row===t-1:e.Col===t-1}));o<a.length;o++){var s=a[o],d=(0,i.isGlobalBorderStylesEnabled)(e),u=e.BorderStyles.length,c=(0,l.duplicateBorderStyle)((0,i.getBorderStyleByID)(s,e),u,1),g=c.Borders.findIndex((function(e){return r?n?e.BorderPosition===i.BorderPositionType.Right:e.BorderPosition===i.BorderPositionType.Bottom:n?e.BorderPosition===i.BorderPositionType.Bottom:e.BorderPosition===i.BorderPositionType.Right}));-1!==g&&(c.Borders.splice(g,1),s.BorderStyleID=u,e.BorderStyles.push(c),d&&(s.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(c)))}}function G(e,t,n,r,o,l){var a={},s=U(e,t.Cells,n,r,o,l);if(!s)return a;for(var d=0,u=(0,i.getBorderStyleByID)(s,t).Borders;d<u.length;d++){var c=u[d];if(c.BorderPosition===i.BorderPositionType.Left)return a.BorderLineStyle=c.BorderLineStyle,a.BorderPosition=i.BorderPositionType.Right,a.Weight=c.Weight,a.Color=c.Color,a}return a}function V(e,t){var n={};if(!e)return n;for(var r=0,o=(0,i.getBorderStyleByID)(e,t).Borders;r<o.length;r++){var l=o[r];if(l.BorderPosition===i.BorderPositionType.Left)return n.BorderLineStyle=l.BorderLineStyle,n.BorderPosition=i.BorderPositionType.Right,n.Weight=l.Weight,n.Color=l.Color,n}return n}function j(e,t){var n={};if(!e)return n;for(var r=0,o=(0,i.getBorderStyleByID)(e,t).Borders;r<o.length;r++){var l=o[r];if(l.BorderPosition===i.BorderPositionType.Top)return n.BorderLineStyle=l.BorderLineStyle,n.BorderPosition=i.BorderPositionType.Bottom,n.Weight=l.Weight,n.Color=l.Color,n}return n}function _(e,t,n,r,o,l){var a={},s=U(e,t.Cells,n,r,o,l);if(!s)return a;for(var d=0,u=(0,i.getBorderStyleByID)(s,t).Borders;d<u.length;d++){var c=u[d];if(c.BorderPosition===i.BorderPositionType.Top)return a.BorderLineStyle=c.BorderLineStyle,a.BorderPosition=i.BorderPositionType.Bottom,a.Weight=c.Weight,a.Color=c.Color,a}return a}function U(e,t,n,r,o,i){for(var l=0,a=t;l<a.length;l++){var s=a[l];if(r){if(s.Col===(o?i:e.Col)&&s.Row===n+1)return s}else if(s.Row===(o?i:e.Row)&&s.Col===n+1)return s}return null}function q(e,t,n){return!!e.Merge&&(n?X(t,e.Row,e.Row+e.Merge.Rows):X(t,e.Col,e.Col+e.Merge.Columns))}function Y(e,t,n,r){return!!e.Merge&&(r?ne(t,n,e.Row,e.Row+e.Merge.Rows):ne(t,n,e.Col,e.Col+e.Merge.Columns))}function X(e,t,n){return t<=e&&n>=e}function J(e,t){for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}function K(e,t,n){var r,o,i,l,a,s,d,u,c,g;Ye(t),Ye(e),null===(r=t.ColumnNumbers)||void 0===r||r.push(e.ColumnNumbers[n]),null===(o=t.ColMetadata)||void 0===o||o.push(e.ColMetadata[n]),null===(i=t.ColumnWidths)||void 0===i||i.push(e.ColumnWidths[n]),null===(l=t.FixedColumns)||void 0===l||l.push(e.FixedColumns[n]),null===(a=t.ColumnOffsets)||void 0===a||a.push(e.ColumnOffsets[n]),null===(s=e.ColumnNumbers)||void 0===s||s.splice(n,1),null===(d=e.ColMetadata)||void 0===d||d.splice(n,1),null===(u=e.ColumnWidths)||void 0===u||u.splice(n,1),null===(c=e.FixedColumns)||void 0===c||c.splice(n,1),null===(g=e.ColumnOffsets)||void 0===g||g.splice(n,1);for(var f=0,h=0;h<e.ColumnWidths.length;h++)e.ColumnOffsets[h]=f,f+=e.ColumnWidths[h];e.BlockWidth=f;var C=0;for(h=0;h<t.ColumnWidths.length;h++)t.ColumnOffsets[h]=C,C+=t.ColumnWidths[h];t.BlockWidth=C}function Z(e,t,n,r,o){var i,l,a,s,d,u,c,g,h,C,m,p,y,v,S,R,F,w;Ye(t),Ye(e);for(var T=n.length,I=0,x=n;I<x.length;I++){var b=x[I];o?(null===(i=t.RowNumbers)||void 0===i||i.push(e.RowNumbers[b]),null===(l=t.RowHeights)||void 0===l||l.push(e.RowHeights[b]),null===(a=t.RowOutlinesInformation)||void 0===a||a.push(e.RowOutlinesInformation[b]),null===(s=t.RowOffsets)||void 0===s||s.push(e.RowOffsets[b])):(null===(d=t.ColumnNumbers)||void 0===d||d.push(e.ColumnNumbers[b]),null===(u=t.ColMetadata)||void 0===u||u.push(e.ColMetadata[b]),null===(c=t.ColumnWidths)||void 0===c||c.push(e.ColumnWidths[b]),null===(g=t.FixedColumns)||void 0===g||g.push(e.FixedColumns[b]),null===(h=t.ColumnOffsets)||void 0===h||h.push(e.ColumnOffsets[b]))}var D=n[0];if(o){null===(C=e.RowNumbers)||void 0===C||C.splice(D,T),null===(m=e.RowHeights)||void 0===m||m.splice(D,T),null===(p=e.RowOutlinesInformation)||void 0===p||p.splice(D,T),null===(y=e.RowOffsets)||void 0===y||y.splice(D,T);for(var A=0,P=0;P<e.RowHeights.length;P++)e.RowOffsets[P]=A,A+=e.RowHeights[P];e.BlockHeight=A;var H=0;for(P=0;P<t.RowHeights.length;P++)t.RowOffsets[P]=H,H+=t.RowHeights[P];t.BlockHeight=H}else{null===(v=e.ColumnNumbers)||void 0===v||v.splice(D,T),null===(S=e.ColMetadata)||void 0===S||S.splice(D,T),null===(R=e.ColumnWidths)||void 0===R||R.splice(D,T),null===(F=e.FixedColumns)||void 0===F||F.splice(D,T),null===(w=e.ColumnOffsets)||void 0===w||w.splice(D,T);var B=0;for(P=0;P<e.ColumnWidths.length;P++)e.ColumnOffsets[P]=B,B+=e.ColumnWidths[P];e.BlockWidth=B;var M=0;for(P=0;P<t.ColumnWidths.length;P++)t.ColumnOffsets[P]=M,M+=t.ColumnWidths[P];t.BlockWidth=M}r||(o?(se(t.RowNumbers,t.RowNumbers.length-T,f),se(e.RowNumbers,0,f)):(se(t.ColumnNumbers,t.ColumnNumbers.length-T,f),se(e.ColumnNumbers,0,f)))}function Q(e,t,n){var r,o,i,l,a,s,d,u,c;Ye(t),Ye(e);for(var g=n.length,f=e.ColumnNumbers.length,h=0,C=n;h<C.length;h++){var m=C[h],p=m+g-f;null===(r=t.ColumnNumbers)||void 0===r||r.splice(p,0,e.ColumnNumbers[m]),null===(o=t.ColumnWidths)||void 0===o||o.splice(p,0,e.ColumnWidths[m]),null===(i=t.ColMetadata)||void 0===i||i.splice(p,0,e.ColMetadata[m]),null===(l=t.FixedColumns)||void 0===l||l.splice(p,0,e.FixedColumns[m])}var y=n[g-1]+g-f;ge(t.ColumnNumbers,y,g),he(t);var v=n[0];null===(a=e.ColumnNumbers)||void 0===a||a.splice(v,g),null===(s=e.ColMetadata)||void 0===s||s.splice(v,g),null===(d=e.ColumnWidths)||void 0===d||d.splice(v,g),null===(u=e.FixedColumns)||void 0===u||u.splice(v,g),null===(c=e.ColumnOffsets)||void 0===c||c.splice(v,g),he(e)}function $(e,t,n){for(var r,o,i,l,a,s,d,u=n.length,c=e.RowNumbers.length,g=0,f=n;g<f.length;g++){var h=f[g],C=h+u-c;null===(r=t.RowNumbers)||void 0===r||r.splice(C,0,e.RowNumbers[h]),null===(o=t.RowHeights)||void 0===o||o.splice(C,0,e.RowHeights[h]),null===(i=t.RowOutlinesInformation)||void 0===i||i.splice(C,0,e.RowOutlinesInformation[h])}var m=n[u-1]+u-c;ge(t.RowNumbers,m,u),fe(t);var p=n[0];null===(l=e.RowNumbers)||void 0===l||l.splice(p,u),null===(a=e.RowHeights)||void 0===a||a.splice(p,u),null===(s=e.RowOffsets)||void 0===s||s.splice(p,u),null===(d=e.RowOutlinesInformation)||void 0===d||d.splice(p,u),fe(e)}function ee(e,t,n){return n?e.Row===t:e.Col===t}function te(e,t,n,r){return r?e.Row<=t+n&&e.Row>=t:e.Col<=t+n&&e.Col>=t}function ne(e,t,n,r){return n<=e+t&&r>=e}function re(e,t,n,o){var l=!!(t.RichValueFieldsIndexes||t.PivotFilter||t.PivotTable||t.InCellImage||t.Sparkline),a=Ae()?n!==r.Hide&&n!==r.FreezePane:n!==r.Hide;return l=y?l||a&&!!t.CondFormat:l||!!t.CondFormat,B(e)&&t.Merge?g.isHideColMergedCellAcrossBlocksEnabled?n!==r.Hide&&(l=l||!!t.Merge.SpansBlocks):l=l||!!t.Merge.SpansBlocks:l=l||!!t.Merge,xe(e)||(l=l||!!t.AutoFilter),be(e)||(l=l||!!t.FormulaInfo),(0,i.isGlobalFontsAndCellStylesFlightEnabled)(e)||(l=l||!!t.TextRuns),l&&function(e,t,n,o){var l,a="",d=[];t.RichValueFieldsIndexes&&d.push("RichValueFieldsIndexes");t.PivotFilter&&d.push("PivotFilter");t.PivotTable&&d.push("PivotTable");t.InCellImage&&d.push("InCellImage");t.Sparkline&&d.push("Sparkline");(null===(l=t.Merge)||void 0===l?void 0:l.SpansBlocks)&&d.push("MergeCellSpansBlocks");!t.CondFormat||y&&n===r.Hide||d.push("CondFormat");t.FormulaInfo&&!be(e)&&d.push("FormulaInfo");t.Merge&&!B(e)&&d.push("MergeCell");t.AutoFilter&&!xe(e)&&d.push("AutoFilter");t.TextRuns&&!(0,i.isGlobalFontsAndCellStylesFlightEnabled)(e)&&d.push("TextRuns");d.length>0&&(a=d.join(","));if(""!==a){var u="";switch(n){case r.Hide:u="Hide";break;case r.Unhide:u="Unhide";break;case r.Insert:u="Insert";break;case r.Delete:u="Delete";break;case r.FreezePane:u="FreezePane"}u=u.concat(o?"Row":"Column"),s.ULS.sendTraceTag(507353300,s.LogCategory.msoulscat_ES_EWAJSGrid,s.TraceLevel.Info,"CSE unattempted due to complex cell  for commandName= ".concat(u,",reason= ").concat(a))}}(e,t,n,o),l}function oe(e){return!e||0===e.length}function ie(e,t){var n,r,o,i,l;null===(n=e.ColumnNumbers)||void 0===n||n.splice(t,1),null===(r=e.ColMetadata)||void 0===r||r.splice(t,1),null===(o=e.ColumnWidths)||void 0===o||o.splice(t,1),null===(i=e.FixedColumns)||void 0===i||i.splice(t,1),null===(l=e.ColumnOffsets)||void 0===l||l.splice(t,1);for(var a=0,s=0;s<e.ColumnWidths.length;s++)e.ColumnOffsets[s]=a,a+=e.ColumnWidths[s];e.BlockWidth=a}function le(e,t,n,r){var o,i,l,a,s,d,u,c,g,h=t[0],C=t.length;if(n){f=ae(e,t,n),null===(o=e.RowNumbers)||void 0===o||o.splice(h,C),null===(i=e.RowHeights)||void 0===i||i.splice(h,C),null===(l=e.RowOffsets)||void 0===l||l.splice(h,C),null===(a=e.RowOutlinesInformation)||void 0===a||a.splice(h,C);for(var m=0,p=0;p<e.RowHeights.length;p++)e.RowOffsets[p]=m,m+=e.RowHeights[p];e.BlockHeight=m,r||se(e.RowNumbers,h,f)}else{f=ae(e,t,n),null===(s=e.ColumnNumbers)||void 0===s||s.splice(h,C),null===(d=e.ColMetadata)||void 0===d||d.splice(h,C),null===(u=e.ColumnWidths)||void 0===u||u.splice(h,C),null===(c=e.FixedColumns)||void 0===c||c.splice(h,C),null===(g=e.ColumnOffsets)||void 0===g||g.splice(h,C);var y=0;for(p=0;p<e.ColumnWidths.length;p++)e.ColumnOffsets[p]=y,y+=e.ColumnWidths[p];e.BlockWidth=y,r||se(e.ColumnNumbers,h,f)}}function ae(e,t,n){var r=t.length;return v?n?e.RowNumbers[t[r-1]]-e.RowNumbers[t[0]]+1:e.ColumnNumbers[t[r-1]]-e.ColumnNumbers[t[0]]+1:r}function se(e,t,n){for(var r=t;r<e.length;r++)e[r]=e[r]-n}function de(e,t){return e===t}function ue(e,t){var n,r,o,i,a,s,d,u=t.length,c=0===t[0],g=t[0]-1;c||S&&!(0,l.isFixedRows)(e.IsBitwiseFixedRows||0,g)?(s=20,d={}):(s=null===(n=e.RowHeights)||void 0===n?void 0:n[g],d=null===(r=e.RowOutlinesInformation)||void 0===r?void 0:r[g]);for(var f=0;f<t.length;f++){var h=t[f],C=0===h?1:e.RowNumbers[h-1]+1;null===(o=e.RowNumbers)||void 0===o||o.splice(h,0,C),null===(i=e.RowHeights)||void 0===i||i.splice(h,0,s),null===(a=e.RowOutlinesInformation)||void 0===a||a.splice(h,0,d)}var m=t[u-1];ge(e.RowNumbers,m,u),fe(e)}function ce(e,t){var n,r,o,i,l,a,s,d,u,c,g=t.length,f=0===t[0],h=t[0]-1;f?(d=64,u={},c=!1):(d=null===(n=e.ColumnWidths)||void 0===n?void 0:n[h],u=null===(r=e.ColMetadata)||void 0===r?void 0:r[h],c=null===(o=e.FixedColumns)||void 0===o?void 0:o[h]);for(var C=0;C<t.length;C++){var m=t[C],p=0===m?1:e.ColumnNumbers[m-1]+1;null===(i=e.ColumnNumbers)||void 0===i||i.splice(m,0,p),null===(l=e.ColumnWidths)||void 0===l||l.splice(m,0,d),null===(a=e.ColMetadata)||void 0===a||a.splice(m,0,u),null===(s=e.FixedColumns)||void 0===s||s.splice(m,0,c)}var y=t[t.length-1];ge(e.ColumnNumbers,y,g),he(e)}function ge(e,t,n){for(var r=t+1;r<e.length;r++)e[r]=e[r]+n}function fe(e){for(var t=0,n=0;n<e.RowHeights.length;n++)e.RowOffsets[n]=t,t+=e.RowHeights[n];e.BlockHeight=t}function he(e){for(var t=0,n=0;n<e.ColumnWidths.length;n++)e.ColumnOffsets[n]=t,t+=e.ColumnWidths[n];e.BlockWidth=t}function Ce(e,t,n){if(n){for(var r=0,o=t;r<o.length;r++){var i=o[r];if(e.Row===i)return!0}return!1}for(var l=0,a=t;l<a.length;l++){i=a[l];if(e.Col===i)return!0}return!1}function me(e,t,n){if(-1===n)return[-1];for(var r=[n],o=1;o<=t;o++){var i=J(e,e[n+o]);if(-1===i)return[-1];r.push(i)}return r}function pe(e,t,n,r){var o,i;return r?e.Row>=t&&e.Row+(null===(o=e.Merge)||void 0===o?void 0:o.Rows)<=t+n:e.Col>=t&&e.Col+(null===(i=e.Merge)||void 0===i?void 0:i.Columns)<=t+n}function ye(e,t,n,r,o,i){var l=e.Merge,a=-1,s=-1;if(function(e,t,n,r,o){var i=Fe(o,t,n,r),l=i[0],a=i[1],s=we(e,o,r),d=s[0],u=s[1];return l>d&&a<u}(e,t,n,r,i))r?l.Rows-=n+1:l.Columns-=n+1,a=t,s=t+n+1;else if(Re(e,t,n,r,i)){if(o&&(ve(e,i,l),l.IsOrigin=!1),r){var d=t-e.Row+n+1;l.Rows-=d,!o&&l.OriginRow&&(l.OriginRow-=n-d+1),a=e.Row}else{d=t-e.Col+n+1;l.Columns-=d,!o&&l.OriginColumn&&(l.OriginColumn-=n-d+1),a=e.Col}s=t+n+1}else if(function(e,t,n,r,o){var i=Fe(o,t,n,r),l=i[0],a=i[1],s=we(e,o,r),d=s[0],u=s[1];return l>d&&a>=u}(e,t,n,r,i)){o&&ve(e,i,l);d=void 0;r?(d=e.Row+e.Merge.Rows-t+1,l.Rows-=d):(d=e.Col+e.Merge.Columns-t+1,l.Columns-=d),a=t,s=t+d}l.SpansBlocks&&(r?(0,g.updateMergedCellHeight)(a,s,l,i):(0,g.updateMergedCellWidth)(a,s,l,i))}function ve(e,t,n){0!==(null==n?void 0:n.OriginRow)&&void 0!==(null==n?void 0:n.OriginRow)||(n.OriginRow=t.RowNumbers[e.Row]-1||0),0!==(null==n?void 0:n.OriginColumn)&&void 0!==(null==n?void 0:n.OriginColumn)||(n.OriginColumn=t.ColumnNumbers[e.Col]-1||0)}function Se(e,t,n,r,o,i,l){var a=e.Merge;a.OriginColumn=t.ColumnNumbers[e.Col]-1,a.OriginRow=t.RowNumbers[e.Row]-1,a.SpansBlocks=!0,a.Width=(0,g.getMergedCellUpdatedWidthOrHeight)(t.ColumnWidths,e.Col,e.Col+a.Columns),a.Height=(0,g.getMergedCellUpdatedWidthOrHeight)(t.RowHeights,e.Row,e.Row+a.Rows),o?(i?(l||(a.OriginRow-=r+1),a.Rows=n+r-e.Row):(l||(a.OriginColumn-=r+1),a.Columns=n+r-e.Col),a.IsOrigin=!0):(i?(l||(a.OriginRow-=r+1),a.Rows-=n+r-e.Row+1,a.OriginDeltaY=(0,g.getMergedCellUpdatedWidthOrHeight)(t.RowHeights,e.Row,n+r)):(l||(a.OriginColumn-=r+1),a.Columns-=n+r-e.Col+1,a.OriginDeltaX=(0,g.getMergedCellUpdatedWidthOrHeight)(t.ColumnWidths,e.Col,n+r)),a.IsOrigin=!1)}function Re(e,t,n,r,o){var i=Fe(o,t,n,r),l=i[0],a=i[1],s=we(e,o,r),d=s[0],u=s[1];return l<=d&&a<u}function Fe(e,t,n,r){return r?[e.RowNumbers[t],e.RowNumbers[t+n]]:[e.ColumnNumbers[t],e.ColumnNumbers[t+n]]}function we(e,t,n){var r,o,i,l;return n?[0===((null===(r=e.Merge)||void 0===r?void 0:r.OriginRow)||0)?t.RowNumbers[e.Row]:((null===(o=e.Merge)||void 0===o?void 0:o.OriginRow)||0)+1,t.RowNumbers[e.Row+e.Merge.Rows]]:[0===((null===(i=e.Merge)||void 0===i?void 0:i.OriginColumn)||0)?t.ColumnNumbers[e.Col]:((null===(l=e.Merge)||void 0===l?void 0:l.OriginColumn)||0)+1,t.ColumnNumbers[e.Col+e.Merge.Columns]]}function Te(e,t){for(var n=0,r=t;n<r.length;n++){var o=r[n],i=(0,l.getCellPositionInArray)(o,e.Cells);e.Cells.splice(i,0,o)}}function Ie(e,t){for(var n=0,r=t;n<r.length;n++){var o=r[n],i=(0,l.getCellPositionInArray)(o,e.Cells);e.Cells.splice(i,1)}}function xe(e){return(0,i.isRenderFlagEnabled)(i.RenderFlagsArray.HideColumnAutoFilterSlice1,e)&&(0,i.isRenderFlagEnabled)(i.RenderFlagsArray.HideColumnSlice1,e)}function be(e){return(0,i.isRenderFlagEnabled)(i.RenderFlagsArray.HideColumnFormulaSlice1,e)&&(0,i.isRenderFlagEnabled)(i.RenderFlagsArray.HideColumnSlice1,e)}function De(e,t,n,r,o){var i=e.Merge;if(i.OriginColumn=t.ColumnNumbers[e.Col]-1,i.OriginRow=t.RowNumbers[e.Row]-1,i.SpansBlocks=!0,i.Width=(0,g.getMergedCellUpdatedWidthOrHeight)(t.ColumnWidths,e.Col,e.Col+i.Columns),i.Height=(0,g.getMergedCellUpdatedWidthOrHeight)(t.RowHeights,e.Row,e.Row+i.Rows),r)o?(i.OriginDeltaY=(0,g.getMergedCellUpdatedWidthOrHeight)(t.RowHeights,e.Row,e.Row+i.Rows-(n+1)+(28+n-(e.Row+e.Merge.Rows))),i.Rows=n-(28+n+1-(e.Row+e.Merge.Rows+1))):(i.OriginDeltaX=(0,g.getMergedCellUpdatedWidthOrHeight)(t.ColumnWidths,e.Col,e.Col+i.Columns-(n+1)+(30+n-(e.Col+e.Merge.Columns))),i.Columns=n-(30+n+1-(e.Col+e.Merge.Columns+1)));else if(o){var l=28+n+1-(e.Row+e.Merge.Rows+1);i.Rows=i.Rows+l-(n+1),i.IsOrigin=!0}else{l=30+n+1-(e.Col+e.Merge.Columns+1);i.Columns=i.Columns+l-(n+1)}}function Ae(){return void 0===C&&(C=(0,u.getBooleanFeatureGate)("Microsoft.Office.Excel.FreezePanesCseSlice1",!1)),!!C}function Pe(e,t,n){var r=t?e.Col:e.Row;return n.skipCascadingBeforeRowColIndex?r<n.rowColIndexToEndRangeCascade:r>=n.rowColIndexToEndRangeCascade}function He(e,t,n,r,o){return!!o&&((null==o?void 0:o.skipCascadingBeforeRowColIndex)&&!r?e.Row-=null==o?void 0:o.rowColIndexToEndRangeCascade:(null==o?void 0:o.performDiagonalCascading)&&!r&&(e.Col-=n+1,e.Row=t.RowNumbers.length-(null==o?void 0:o.rowColIndexToEndRangeCascade)+e.Row),!0)}function Be(e,t){return((e.BitwiseBorderPosition||0)&1<<t)==1<<t}function Me(e,t){var n=e.CachedBorderStyle;if(!n||!n.Borders)return!1;for(var r=0,o=n.Borders;r<o.length;r++){if(o[r].BorderPosition===t)return!0}return!1}function Oe(e,t,n,r,o){var l,a,s;if(R&&!T){var d=Ne(t,n);if((n?e.Row:e.Col)===r){e.CachedBorderStyle||(e.CachedBorderStyle=(0,i.getBorderStyleByID)(e,t));var u=n?i.BorderPositionType.Top:i.BorderPositionType.Left;if(!Be(e,u)&&Me(e,u)){var c=null===(l=e.CachedBorderStyle)||void 0===l?void 0:l.Borders.find((function(e){return e.BorderPosition===u})),g=(0,i.getCellLookupKey)(e.Row,e.Col);d.set(g,c),Ee(t,n,d)}}if(T){var f=ze(t,n),h=n?e.Row:e.Col,C=(n?null===(a=t.RowNumbers)||void 0===a?void 0:a.length:null===(s=t.ColumnNumbers)||void 0===s?void 0:s.length)||0;if(h===r+o&&h<C){e.CachedBorderStyle||(e.CachedBorderStyle=(0,i.getBorderStyleByID)(e,t));var m=n?i.BorderPositionType.Bottom:i.BorderPositionType.Right,p=n?i.BorderPositionType.Top:i.BorderPositionType.Left,y=n?(0,i.getCell)(e.Row+1,e.Col,t):(0,i.getCell)(e.Row,e.Col+1,t);if(!y)return;if(y.CachedBorderStyle||(y.CachedBorderStyle=(0,i.getBorderStyleByID)(y,t)),Be(e,m)&&Me(y,p)&&!Be(y,p)){g=(0,i.getCellLookupKey)(y.Row,y.Col);f.set(g,p),We(t,n,f)}}}}}function ke(e,t){T&&function(e,t){var n=Ne(e,t);(function(e,t,n){for(var r,o,l,a=t?i.BorderPositionType.Top:i.BorderPositionType.Left,s=t?i.BorderPositionType.Bottom:i.BorderPositionType.Right,d=0;d<e.Cells.length;d++){var u=e.Cells[d];if(!u.Merge&&u[t?"Row":"Col"]!==(t?((null===(r=e.RowNumbers)||void 0===r?void 0:r.length)||0)-1:((null===(o=e.ColumnNumbers)||void 0===o?void 0:o.length)||0)-1)){u.CachedBorderStyle||(u.CachedBorderStyle=(0,i.getBorderStyleByID)(u,e));var c=null===(l=u.CachedBorderStyle)||void 0===l?void 0:l.Borders.find((function(e){return e.BorderPosition===a}));if(c&&Be(u,s)){var g=t?(0,i.getCell)(u.Row+1,u.Col,e):(0,i.getCell)(u.Row,u.Col+1,e);if(!g||!Me(g,a)){if(g&&g.Merge)continue;var f=t?(0,i.getCellLookupKey)(u.Row+1,u.Col):(0,i.getCellLookupKey)(u.Row,u.Col+1);n.set(f,c)}}}}})(e,t,n),Ee(e,t,n);var r=ze(e,t);(function(e,t,n,r){for(var o,l,a=t?i.BorderPositionType.Bottom:i.BorderPositionType.Right,s=t?i.BorderPositionType.Top:i.BorderPositionType.Left,d=0;d<e.Cells.length;d++){var u=e.Cells[d];if(!u.Merge&&u[t?"Row":"Col"]!==(t?((null===(o=e.RowNumbers)||void 0===o?void 0:o.length)||0)-1:((null===(l=e.ColumnNumbers)||void 0===l?void 0:l.length)||0)-1)&&(u.CachedBorderStyle||(u.CachedBorderStyle=(0,i.getBorderStyleByID)(u,e)),u.CachedBorderStyle&&u.CachedBorderStyle.Borders&&u.CachedBorderStyle.Borders.length>0&&Be(u,a))){var c=t?(0,i.getCell)(u.Row+1,u.Col,e):(0,i.getCell)(u.Row,u.Col+1,e);if(c&&Me(c,s)&&!Be(c,s)){if(c&&c.Merge)continue;var g=t?(0,i.getCellLookupKey)(u.Row+1,u.Col):(0,i.getCellLookupKey)(u.Row,u.Col+1);if(I&&r.has(g)){var f=r.get(g);if(f&&f.BorderPosition===s)continue}n.set(g,s)}}}})(e,t,r,n),We(e,t,r)}(e,t),R&&function(e,t){if(!R)return;for(var n=Ne(e,t),r=0;r<e.Cells.length;r++){var o=e.Cells[r],a=(0,i.getCellLookupKey)(o.Row,o.Col);if(n.has(a))o.CachedBorderStyle=(0,i.getBorderStyleByID)(o,e),(u=n.get(a))&&(0,l.addBorderToCellIfNotPresent)(o,e,u,u.BorderPosition),n.delete(a)}for(var s=0,d=Array.from(n.keys());s<d.length;s++){a=d[s];var u,c=(0,i.getRowColFromCellKey)(a),g=c.row,f=c.column,h=(0,i.getDefaultCell)(g,f);h.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID({Borders:[],ID:0}),h.CachedBorderStyle=(0,i.getBorderStyleByID)(h,e),(u=n.get(a))&&(0,l.addBorderToCellIfNotPresent)(h,e,u,u.BorderPosition);var C=(0,l.getCellPositionInArray)(h,e.Cells);e.Cells.splice(C,0,h),n.delete(a)}Ee(e,t,n)}(e,t),T&&function(e,t){if(!R)return;var n=ze(e,t);if(0===n.size)return;for(var r=0;r<e.Cells.length;r++){var o=e.Cells[r],a=(0,i.getCellLookupKey)(o.Row,o.Col);if(n.has(a)){o.CachedBorderStyle=(0,i.getBorderStyleByID)(o,e);var s=n.get(a);s&&(0,l.removeBorderFromCell)(o,e,s),n.delete(a)}}We(e,t,n)}(e,t)}function Le(e,t){return t?e.ColumnNumbers[0]:e.RowNumbers[0]}function Ne(e,t){var n=Le(e,t),r=P.get(n);return r||(r=new Map),r}function Ee(e,t,n){var r=Le(e,t);P.set(r,n)}function ze(e,t){var n=Le(e,t),r=H.get(n);return r||(r=new Map),r}function We(e,t,n){var r=Le(e,t);H.set(r,n)}function Ge(e,t,n){return n?t.Index>=e.RowNumbers.length||t.Index<0:t.Index>=e.ColumnNumbers.length||t.Index<0}function Ve(e,t,n,o,i){var l=i?e.RowNumbers[t.Index]:e.ColumnNumbers[t.Index],a=i?n.FirstRow:n.FirstColumn,s=i?n.LastRow:n.LastColumn;return l+1>=a&&l<s&&o===r.Delete}function je(e,t,n,o,i,l){var a=i?e.RowNumbers[t.Index]:e.ColumnNumbers[t.Index],s=i?n.FirstRow:n.FirstColumn,d=i?n.LastRow:n.LastColumn;a>=d?t.Index+=l:a+1>=s&&a<d&&(o===r.Insert||o===r.Unhide?t.Index+=l:o===r.Hide&&(t.Index-=t.Index-J(i?e.RowNumbers:e.ColumnNumbers,s)+1))}function _e(e,t,n){e&&e.PageBreaks&&(0!==t.length?n?e.PageBreaks.Row=t:e.PageBreaks.Col=t:n?e.PageBreaks.Row=void 0:e.PageBreaks.Col=void 0)}function Ue(e){e&&e.PageBreaks&&(e.PageBreaks.Row&&0===e.PageBreaks.Row.length&&(e.PageBreaks.Row=void 0),e.PageBreaks.Col&&0===e.PageBreaks.Col.length&&(e.PageBreaks.Col=void 0),e.PageBreaks.Row||e.PageBreaks.Col||(e.PageBreaks=void 0))}function qe(e){return e===r.Hide||e===r.Delete}function Ye(e){if((0,i.isChangeGateEnabled)(i.ChangeGate.AutofitWidthGlobalStyle)){(0,c.resetCache)();for(var t=[],n=0;n<e.ColumnNumbers.length;n++)t.push(null);e.ColMetadata=t}}function Xe(e,t,n){var r=n?(0,i.getCell)(t.Row+1,t.Col,e):(0,i.getCell)(t.Row,t.Col+1,e);if(r){var l=Ke(e,t,n),a=Ke(e,r,n);if(0!==l.length&&0!==a.length){for(var s=0,d=0,u=[];s<l.length&&d<a.length;){var c=l[s].BorderPosition,g=a[d].BorderPosition;if(c===g){if(Je(t,r,l[s],a[d])){var f=o.__assign({},l[s]);f.BorderPosition===i.BorderPositionType.Bottom?f.BorderPosition=i.BorderPositionType.Top:f.BorderPosition===i.BorderPositionType.Right&&(f.BorderPosition=i.BorderPositionType.Left),u.push(f)}s++,d++}else c<g?s++:d++}return{ID:e.BorderStyles.length,Borders:u,RefCount:0}}}}function Je(e,t,n,r){var o=Be(e,n.BorderPosition),i=Be(t,r.BorderPosition);return(o&&i||!o&&!i)&&function(e,t){if(n=e.Color,r=t.Color,n.Blue===r.Blue&&n.Green===r.Green&&n.Red===r.Red&&e.Weight===t.Weight&&e.BorderLineStyle===t.BorderLineStyle)return!0;var n,r;return!1}(n,r)}function Ke(e,t,n){for(var r,l=[],a=0,s=null===(r=(0,i.getBorderStyleByID)(t,e))||void 0===r?void 0:r.Borders;a<s.length;a++){var d=s[a];(Be(t,d.BorderPosition)||n&&i.BorderPositionType.Left===d.BorderPosition||!n&&i.BorderPositionType.Top===d.BorderPosition)&&l.push(d)}return function(e,t,n,r){if(!(r&&Be(t,i.BorderPositionType.Bottom)||!r&&Be(t,i.BorderPositionType.Right)))return;var l=r?(0,i.getCell)(t.Row+1,t.Col,e):(0,i.getCell)(t.Row,t.Col+1,e);if(!l||r&&Be(t,i.BorderPositionType.Bottom)&&Be(l,i.BorderPositionType.Top)||!r&&Be(t,i.BorderPositionType.Right)&&Be(l,i.BorderPositionType.Left))return;var a=(0,i.getBorderStyleByID)(l,e),s=null==a?void 0:a.Borders;if(0===s.length)return;for(var d=0,u=s;d<u.length;d++){var c=u[d];if(r&&c.BorderPosition===i.BorderPositionType.Top||!r&&c.BorderPosition===i.BorderPositionType.Left){var g=o.__assign({},c);g.BorderPosition=r?i.BorderPositionType.Bottom:i.BorderPositionType.Right,Ze(n,g)}}}(e,t,l,n),l}function Ze(e,t){for(var n=0;n<e.length&&e[n].BorderPosition<t.BorderPosition;)n++;e.splice(n,0,t)}function Qe(e,t,n,i,l,a){if(e&&e.PrintAreas&&t&&t.FirstRow&&t.FirstColumn&&t.LastRow&&t.LastColumn){for(var s=e.PrintAreas.length,d=a.length,u=[],c=0;c<s;c++){var g=e.PrintAreas[c],f=l?t.FirstRow:t.FirstColumn,C=l?t.LastRow:t.LastColumn,m=l?g.FirstRow>e.RowNumbers.length-1?e.RowNumbers[e.RowNumbers.length-1]+1:e.RowNumbers[g.FirstRow]:g.FirstColumn>e.ColumnNumbers.length-1?e.ColumnNumbers[e.ColumnNumbers.length-1]+1:e.ColumnNumbers[g.FirstColumn],p=l?g.LastRow>e.RowNumbers.length-1?e.RowNumbers[e.RowNumbers.length-1]+1:e.RowNumbers[g.LastRow]:g.LastColumn>e.ColumnNumbers.length-1?e.ColumnNumbers[e.ColumnNumbers.length-1]+1:e.ColumnNumbers[g.LastColumn],y=i===r.Hide||i===r.Delete?-n:n;if(f<=m&&C<=m)l?(g.FirstRow+=y,g.LastRow+=y):(g.FirstColumn+=y,g.LastColumn+=y);else if(f<m&&C>m&&C<=p){var v=i===r.Hide||i===r.Delete?-1*(m-f):n;l?(g.FirstRow+=v,g.LastRow+=y):(g.FirstColumn+=v,g.LastColumn+=y)}else if(f>=m&&C<=p)l?g.LastRow+=y:g.LastColumn+=y;else if(f>m&&f<=p&&C>=p){v=i===r.Hide||i===r.Delete?-1*(p-f+1):n;l?g.LastRow+=v:g.LastColumn+=v}else if(f>p);else if(i===r.Delete)h=!0;else{if(i===r.Hide)continue;i===r.Insert&&(l?(g.FirstRow+=n,g.LastRow+=n):(g.FirstColumn+=n,g.LastColumn+=n))}if(tt(e,g,l))u.push(g);else{var S=o.__assign({},g);ot(e,g,i,l)&&u.push(g),a.push(S)}}e.PrintAreas=u;for(c=0;c<d;c++){nt(e,g=a[c],i,l)||e.PrintAreas.push(g)}return!1}e&&a.length>0&&(e.PrintAreas=a)}function $e(e,t,n){return n?t.LastRow>e.RowNumbers.length-1||t.FirstRow<0:t.LastColumn>e.ColumnNumbers.length-1||t.FirstColumn<0}function et(e,t,n,i,l){var a=o.__assign({},n);switch(i){case r.Hide:case r.Delete:l?(a.FirstRow=n.FirstRow+t.RowNumbers.length,n.FirstRow=0,a.LastRow=t.RowNumbers.length):(a.FirstColumn=n.FirstColumn+t.ColumnNumbers.length,n.FirstColumn=0,a.LastColumn=t.ColumnNumbers.length);break;case r.Insert:case r.Unhide:l?(n.LastRow=e.RowNumbers.length,a.FirstRow=0,a.LastRow-=n.LastRow):(n.LastColumn=e.ColumnNumbers.length,a.FirstColumn=0,a.LastColumn-=n.LastColumn)}return a}function tt(e,t,n){return n?!(t.FirstRow<0&&t.LastRow<0||t.FirstRow>e.RowNumbers.length-1&&t.LastRow>e.RowNumbers.length-1):!(t.FirstColumn<0&&t.LastColumn<0||t.FirstColumn>e.ColumnNumbers.length-1&&t.LastColumn>e.ColumnNumbers.length-1)}function nt(e,t,n,o){if(!e.PrintAreas||0===e.PrintAreas.length)return!1;for(var i=0,l=e.PrintAreas;i<l.length;i++){var a=l[i];if(rt(a,t,n,o))return o?n===r.Hide||n===r.Delete?a.LastRow=t.LastRow:a.FirstRow=t.FirstRow:n===r.Hide||n===r.Delete?a.LastColumn=t.LastColumn:a.FirstColumn=t.FirstColumn,!0}return!1}function rt(e,t,n,o){return o?e.FirstColumn===t.FirstColumn&&e.LastColumn===t.LastColumn&&(n===r.Hide||n===r.Delete?e.LastRow===t.FirstRow:e.FirstRow===t.LastRow):e.FirstRow===t.FirstRow&&e.LastRow===t.LastRow&&(n===r.Hide||n===r.Delete?e.LastColumn===t.FirstColumn:e.FirstColumn===t.LastColumn)}function ot(e,t,n,o){var i=!1;return o?n===r.Insert||n===r.Unhide?t.FirstRow===e.RowNumbers.length&&(t.LastRow=e.RowNumbers.length,i=!0):t.LastRow===e.RowNumbers.length&&(t.FirstRow=e.RowNumbers.length,i=!0):n===r.Insert||n===r.Unhide?t.FirstColumn===e.ColumnNumbers.length&&(t.LastColumn=e.ColumnNumbers.length,i=!0):t.LastColumn===e.ColumnNumbers.length&&(t.FirstColumn=e.ColumnNumbers.length,i=!0),i}function it(e,t,n,r,o,a,s,d,u,c,g,f,h){var C,m,p=Ae()&&!!g,y=de(u,d[d.length-1]),v=c?(null===(C=t.ColumnNumbers)||void 0===C?void 0:C.length)-1:(null===(m=t.RowNumbers)||void 0===m?void 0:m.length)-1,S=!!p&&de(f,v),R=c?e.Col:e.Row,F=p&&de(R,function(e,t){if((null==t?void 0:t.performDiagonalCascading)||(null==t?void 0:t.skipCascadingBeforeRowColIndex))return e?29:27;return(null==t?void 0:t.rowColIndexToEndRangeCascade)-1}(c,g));if(!y&&!F&&!S)return!1;(y||S)&&function(e,t,n,r,o){void 0===r&&(r=!1);var a=n?e.Col:e.Row;if(r&&a===o&&(n?29===a:27===a))return;var s=(0,i.isGlobalBorderStylesEnabled)(t),d=t.BorderStyles.length,u=(0,l.duplicateBorderStyle)((0,i.getBorderStyleByID)(e,t),d,1),c=u.Borders.findIndex((function(e){return r?n?e.BorderPosition===i.BorderPositionType.Right:e.BorderPosition===i.BorderPositionType.Bottom:n?e.BorderPosition===i.BorderPositionType.Bottom:e.BorderPosition===i.BorderPositionType.Right}));-1!==c&&(u.Borders.splice(c,1),e.BorderStyleID=d,t.BorderStyles.push(u),s&&(e.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(u)))}(e,t,c,p,f);var w=!1,T=!1,I=!1,x=n+r.length,b=e.BorderStyleID||0,D=(0,l.duplicateBorderStyle)((0,i.getReferencedObjectById)(b,t.BorderStyles),x,1);return y&&(w=function(e,t,n,r,o,i,l,a,s,d,u,c,g,f,h){var C=n?h!==e.Col:h!==e.Row,m=function(e,t,n,r){if(null==n?void 0:n.skipCascadingBeforeRowColIndex)return e?t.Col+n.rowColIndexToEndRangeCascade:t.Row+n.rowColIndexToEndRangeCascade;return r}(n,e,g,h),p=function(e,t,n,r,o,i,l){if(!i)return e?_(t,n,r,e):G(t,n,r,e);if(i)return e?_(t,n,r,e,o,l):G(t,n,r,e,o,l);return{}}(n,e,t,u,c,C,m);if(0!==Object.keys(p).length)return lt(e,t,r,o,i,l,a,p,s,d,!0,u,n,g,h,f);return!1}(e,t,c,n,r,o,a,s,x,D,u,p,g,h,f)),p&&(S&&(T=function(e,t,n,r,o){var l=e.BorderStyleID||0;if(!t.has(l)&&l!==i.UniqueStyleID.DefaultBorder)return t.set(l,r),n.push(o),!0;return!1}(e,a,r,x,D)),F&&(I=function(e,t,n,r,o,i,l,a,s,d,u,c,g){var f=n?e.Col:e.Row,h=function(e,t,n,r,o,i,l,a){return n?G(e,t,r,!n,o,l):_(e,t,(null==i?void 0:i.performDiagonalCascading)?a:r,!n,o,(null==i?void 0:i.skipCascadingBeforeRowColIndex)?n?e.Row+(null==i?void 0:i.rowColIndexToEndRangeCascade):e.Col+(null==i?void 0:i.rowColIndexToEndRangeCascade):l)}(e,t,n,f,!0,u,c,g);if(0!==Object.keys(h).length)return lt(e,t,r,o,i,l,a,h,s,d,!1,u.performDiagonalCascading?g:f,!n,u,g,c);return!1}(e,t,c,n,r,o,a,s,x,D,g,h,f))),w||I||T}function lt(e,t,n,r,o,l,a,s,d,u,c,g,f,h,C,m){var p=!1,y=e.BorderStyleID||0,v=(0,i.isGlobalBorderStylesEnabled)(t),S=e.BorderStyleID||0,R=f?C!==e.Col:C!==e.Row,F=U(e,t.Cells,g,f,!c||!!R,(null==h?void 0:h.skipCascadingBeforeRowColIndex)?f?e.Col+(null==h?void 0:h.rowColIndexToEndRangeCascade):e.Row+(null==h?void 0:h.rowColIndexToEndRangeCascade):c?C:m).BorderStyleID||0;if(o&&l.get(S)&&a.get(F))e.BorderStyleID=l.get(S),v&&(e.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID((0,i.getReferencedObjectById)(y,t.BorderStyles)));else{if(o&&(l.set(S,d),a.set(F,n+a.size)),f){for(var w=u.Borders,T=w.length,I=0;I<w.length;I++)w[I].BorderPosition<s.BorderPosition&&(T=I+1);u.Borders.splice(T,0,s)}else u.Borders.push(s);r.push(u),e.BorderStyleID=d,v&&(e.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(u)),p=!0}return p}function at(e){return e===r.FreezePane&&(void 0===m&&(m=(0,u.getBooleanFeatureGate)("Microsoft.Office.Excel.FreezePanesCseSlice2",!1)),!!m&&Ae())&&D}t.isHideColumnMergedCellFlightEnabled=B,function(e){e.Hide="Hide",e.Unhide="Unhide",e.Insert="Insert",e.Delete="Delete",e.FreezePane="FreezePane"}(r||(t.GridInstantaneousOperation=r={})),t.hideRowsColumns=function(e,t,n){if(n)return!1;var r=J(n?e.RowNumbers:e.ColumnNumbers,t);if(-1===r)return!1;if(oe(e.Cells))return ie(e,r),!0;for(var o=[],i=0;i<e.Cells.length;i++){var l=e.Cells[i];l.Col===r||q(l,r,!1)?l.Merge&&(pe(l,r,0,n)||(ye(l,r,0,!1,!0,e),o.push(l))):(l.Col>r&&(l.Col-=1),o.push(l))}return ie(e,r),e.Cells=o,!0},t.modelRowColOperations=function(e,t,n,o,a){return function(){if(!R)return;if(P=new Map,!T)return;H=new Map}(),o===r.Hide||o===r.FreezePane||o===r.Delete?M(e,t,n,a,o):function(e,t,n,o,a){var s,d,u,c,g=o?e.RowNumbers:e.ColumnNumbers,f=J(g,t),h=me(g,n,f);if(-1===h[0])return!1;if(oe(e.Cells))return o?ue(e,h):ce(e,h),!0;for(var C=[],m=0;m<e.Cells.length;m++){var p=e.Cells[m];Oe(p,e,o,f,n);var y=h[0]-1,v=0,S=0;if(o){if(p.Row>=f){a===r.Insert&&p.Merge&&(null===(s=p.Merge)||void 0===s?void 0:s.OriginRow)&&0!==p.Merge.OriginRow&&(p.Merge.OriginRow+=n+1),p.Row+=n+1,C.push(p);continue}if(p.Merge&&p.Row<f&&p.Row+p.Merge.Rows>=f){p.Merge.Rows+=n+1,C.push(p);continue}}else{if(p.Col>=f){a===r.Insert&&p.Merge&&(null===(d=p.Merge)||void 0===d?void 0:d.OriginColumn)&&0!==p.Merge.OriginColumn&&(p.Merge.OriginColumn+=n+1),p.Col+=n+1,C.push(p);continue}if(p.Merge&&p.Col<f&&p.Col+p.Merge.Columns>=f){p.Merge.Columns+=n+1,C.push(p);continue}}if(-1!==y){o?p.Merge?p.Row+p.Merge.Rows===y&&(v=p.Merge.Columns+1,S=h.length):p.Row===y&&(v=1,S=h.length):p.Merge?p.Col+p.Merge.Columns===y&&(v=h.length,S=p.Merge.Rows+1):p.Col===y&&(v=h.length,S=1);var R=(0,i.getCellStyleByID)(p,e),w=void 0,T=void 0;if(p.HorizontalAlignmentSet)w=(0,i.getGlobalCellStylesMap)().getOrCreateID(R),T=R;else{var I=(0,l.getLastNonUniqueStyleID)(e)+1,x=(0,l.duplicateStyle)(e,(0,i.getCellStyleByID)(p,e),I,1);x.HorizontalAlignment=i.HorizontalAlignment.Automatic,null===(u=e.Styles)||void 0===u||u.splice(I,0,x),w=(0,i.getGlobalCellStylesMap)().getOrCreateID(x),T=x}var b=void 0,D=0,A=0;F&&S>0&&v>0&&((b=Xe(e,p,o))&&(b.RefCount=Math.max(v,S),D=b.ID||0,null===(c=e.BorderStyles)||void 0===c||c.push(b)),A=void 0===b?0:(0,i.getGlobalBorderStyleMap)().getOrCreateID(b));for(var P=0;P<S;P++)for(var H=0;H<v;H++){var B=o?h[0]+P:p.Row+P,M=o?p.Col+H:h[0]+H,O=(0,i.getDefaultCell)(B,M);O.GlobalCellStyleID=w,O.CachedStyle=T,O.StyleID=T.ID||0,O.WrapText=p.WrapText,F&&(O.BorderStyleID=D,O.GlobalBorderStyleID=A),C.push(O)}C.push(p)}else C.push(p)}e.Cells=[],Te(e,C),o?ue(e,h):ce(e,h);return!0}(e,t,n,a,o)},t.hideDeleteRowsColumns=M,t.hideMultipleRowsColumns=function(e,t,n,r){var o=r?e.RowNumbers:e.ColumnNumbers,i=J(o,t),l=me(o,n,i);if(-1===l[0])return!1;if(oe(e.Cells))return le(e,l,r,!0),!0;for(var a=[],s=l[l.length-1],d=0;d<e.Cells.length;d++){var u=e.Cells[d];Ce(u,l,r)||Y(u,i,n,r)?u.Merge&&(pe(u,i,n,r)||(ye(u,i,n,r,!0,e),u.Col>l[0]&&(u.Col-=n),a.push(u))):(r?u.Row>s&&(u.Row-=n+1):u.Col>s&&(u.Col-=n+1),a.push(u))}return le(e,l,r,!0),e.Cells=a,!0},t.modelCascade=function(e,t,n,r){var o,s;if(r)return{isSuccess:!1,exception:"Rows are not supported"};var u={};try{var c=(0,i.isGlobalBorderStylesEnabled)(e),g=(0,i.isGlobalFontsAndCellStylesFlightEnabled)(e),f=performance.now(),h=J(r?e.RowNumbers:e.ColumnNumbers,n);if(-1===h)return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(oe(e.Cells))return u.timeTaken=performance.now()-f,K(e,t,h),{isSuccess:!0,metric:u};var C=[],m=[],p=[],y=new Map,v=[],S=new Map,R=[],F=new Map,w=t.Styles.length,T=t.Fonts.length,I=t.BorderStyles.length,x=t.ColumnNumbers.length,b=!1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;var D=!1,A=!1,P=!1;(0,i.preprocessModelStyles)(e),(0,i.preprocessModelStyles)(t);for(var H=0;H<e.Cells.length;H++){var B=e.Cells[H],M=!1;if(B.Col===h){if(B.Merge&&!pe(B,h,0,r)){var O=(0,d.duplicateCell)(B);Se(O,e,h,0,M,!1,!0),M=!0,O.Col=0,m.push(O)}B.Merge&&M&&Se(B,e,h,0,M,!1,!0);var k=B.Col;B.Col=x,C.push(B);var L=B.StyleID||0,N=!1;if(!y.has(L)&&L!==i.UniqueStyleID.Default&&L!==i.UniqueStyleID.Hyperlink){var E=(se=(0,i.getReferencedObjectById)(L,e.Styles)).FontID||0;if(N=!g||(0,a.isNullOrUndefined)(B.GlobalCellStyleID),(!g||(0,a.isNullOrUndefined)(se.GlobalFontID))&&!S.has(E)){var V=T+S.size;S.set(E,V);var j=(0,i.getReferencedObjectById)(E,e.Fonts),_=(0,l.duplicateFont)(j,V,1);v.push(_),P=!0}if(N){var U=i.UniqueStyleID.Default;U=w-l.NumberOfUniqueStyleIDs+p.length,y.set(L,U);var q=(0,l.duplicateOnlyStyleWithoutFont)(se,U,1);q.FontID=S.get(E),p.push(q),A=!0}}var Y=B.BorderStyleID||0,X=!c||(0,a.isNullOrUndefined)(B.GlobalBorderStyleID);if(X){if(!F.has(Y)&&Y!==i.UniqueStyleID.DefaultBorder){var Z=I+F.size;F.set(Y,Z);var Q=(0,l.duplicateBorderStyle)((0,i.getReferencedObjectById)(Y,e.BorderStyles),Z,1),$=G(B,e,k,r);0!==Object.keys($).length&&Q.Borders.push($),z(B,e)&&(b=!0),R.push(Q),D=!0}}else if(c){$=G(B,e,k,r);var ee=0!==Object.keys($).length,te=z(B,e);if(ee||te){Z=t.BorderStyles.length,Q=(0,l.duplicateBorderStyle)((0,i.getBorderStyleByID)(B,e),Z,1);ee&&(Q.Borders.push($),B.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(Q)),B.BorderStyleID=Z,t.BorderStyles.push(Q),b=te}}N&&(B.StyleID=L===i.UniqueStyleID.Default?i.UniqueStyleID.Default:y.get(L)),X&&(B.BorderStyleID=Y===i.UniqueStyleID.DefaultBorder?i.UniqueStyleID.DefaultBorder:F.get(Y))}else B.Col-=1,m.push(B)}D&&(o=t.BorderStyles).push.apply(o,R),b&&W(t,x,r),K(e,t,h);for(var ne=0,re=C;ne<re.length;ne++){B=re[ne];var ie=(0,l.getCellPositionInArray)(B,t.Cells);t.Cells.splice(ie,0,B)}if(A)for(var le=0,ae=p;le<ae.length;le++){var se=ae[le];t.Styles.splice(se.ID||0,0,se)}P&&(s=t.Fonts).push.apply(s,v),e.Cells=m,u.countOfStylesMoved=y.size,u.countOfFontsMoved=S.size,u.countOfBorderStylesMoved=F.size,u.timeTaken=performance.now()-f}catch(e){return{isSuccess:!1,exception:e,metric:u}}return{isSuccess:!0,metric:u}},t.modelCascadeRowColsOperations=function(e,t,n,o,i,l,a){var s=i===r.Hide||i===r.FreezePane;return s||i===r.Delete?O(e,t,n,o,l,s,a):k(e,t,n,o,l)},t.modelCascadeRowCols=O,t.modelCascadeMultipleRowCols=function(e,t,n,r,o){var s,u;if(o)return{isSuccess:!1,exception:"Rows are not supported"};var c={};try{var g=(0,i.isGlobalBorderStylesEnabled)(e),f=(0,i.isGlobalFontsAndCellStylesFlightEnabled)(e),h=performance.now(),C=o?e.RowNumbers:e.ColumnNumbers,m=J(C,n),p=me(C,r,m);if(-1===p[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(oe(e.Cells))return c.timeTaken=performance.now()-h,Z(e,t,p,!0,o),{isSuccess:!0,metric:c};var y=[],v=[],S=[],R=new Map,F=[],w=new Map,T=[],I=new Map,x=new Map,b=t.Styles.length,D=t.Fonts.length,A=t.BorderStyles.length,P=t.ColumnNumbers.length,H=r+1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;var B=!1,M=!1,O=!1;(0,i.preprocessModelStyles)(e),(0,i.preprocessModelStyles)(t);for(var k=0;k<e.Cells.length;k++){var L=e.Cells[k],N=!1;if(Ce(L,p,o)){if(L.Merge&&!pe(L,m,r,o)){var E=(0,d.duplicateCell)(L);Se(E,e,m,r,N,!1,!0),N=!0,E.Col=0,v.push(E)}L.Merge&&N&&Se(L,e,m,r,N,!1,!0);var z=L.Col;L.Col=P+z,y.push(L);var V=L.StyleID||0,j=!1;if(!R.has(V)&&V!==i.UniqueStyleID.Default&&V!==i.UniqueStyleID.Hyperlink){var _=(he=(0,i.getReferencedObjectById)(V,e.Styles)).FontID||0;if(j=!f||(0,a.isNullOrUndefined)(L.GlobalCellStyleID),(!f||(0,a.isNullOrUndefined)(he.GlobalFontID))&&!w.has(_)){var q=D+w.size;w.set(_,q);var Y=(0,i.getReferencedObjectById)(_,e.Fonts),X=(0,l.duplicateFont)(Y,q,1);F.push(X),O=!0}if(j){var K=b-l.NumberOfUniqueStyleIDs+S.length;R.set(V,K);var Q=(0,l.duplicateOnlyStyleWithoutFont)(he,K,1);Q.FontID=w.get(_),S.push(Q),M=!0}}var $=L.BorderStyleID||0,ee=!g||(0,a.isNullOrUndefined)(L.GlobalBorderStyleID);if(ee&&!I.has($)&&$!==i.UniqueStyleID.DefaultBorder){var te=A+T.length;I.set($,te);var ne=(0,l.duplicateBorderStyle)((0,i.getReferencedObjectById)($,e.BorderStyles),te,1);T.push(ne),B=!0}var re=L.BorderStyleID||0;if(j&&(L.StyleID=V===i.UniqueStyleID.Default?i.UniqueStyleID.Default:R.get(V)),ee&&(L.BorderStyleID=$===i.UniqueStyleID.DefaultBorder?i.UniqueStyleID.DefaultBorder:I.get($)),de(z,p[p.length-1])){var ie=G(L,e,z,o);if(0!==Object.keys(ie).length){var le=L.BorderStyleID||0,ae=(te=A+T.length,U(L,e.Cells,z,o).BorderStyleID||0);if(ee&&I.get(le)&&x.get(ae))L.BorderStyleID=I.get(le),g&&(L.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID((0,i.getReferencedObjectById)(re,e.BorderStyles)));else ee&&(I.set(le,te),x.set(ae,A+x.size)),(ne=(0,l.duplicateBorderStyle)((0,i.getReferencedObjectById)(re,e.BorderStyles),te,1)).Borders.push(ie),T.push(ne),L.BorderStyleID=te,g&&(L.GlobalBorderStyleID=(0,i.getGlobalBorderStyleMap)().getOrCreateID(ne)),B=!0}}}else L.Col-=H,v.push(L)}B&&(s=t.BorderStyles).push.apply(s,T),W(t,P,o),Z(e,t,p,!0,o);for(var se=0,ue=y;se<ue.length;se++){L=ue[se];var ce=(0,l.getCellPositionInArray)(L,t.Cells);t.Cells.splice(ce,0,L)}if(M)for(var ge=0,fe=S;ge<fe.length;ge++){var he=fe[ge];t.Styles.splice(he.ID||0,0,he)}O&&(u=t.Fonts).push.apply(u,F),e.Cells=v,c.countOfStylesMoved=R.size,c.countOfFontsMoved=w.size,c.countOfBorderStylesMoved=I.size,c.timeTaken=performance.now()-h}catch(e){return{isSuccess:!1,exception:e,metric:c}}return{isSuccess:!0,metric:c}},t.modelReverseCascadeRowCols=k,t.canCellsOfRowColHideOrCascade=function(e,t,n,r){if(oe(e.Cells))return!0;var o=J(n?e.RowNumbers:e.ColumnNumbers,t);if(-1===o)return!1;for(var i=e.Cells,l=0;l<i.length;l++){var a=i[l],d=!1;if(a.Merge&&(d=q(a,o,n),s.ULS.sendTraceTag(507353301,s.LogCategory.msoulscat_ES_EWAJSGrid,s.TraceLevel.Info,"ModelCascadeHelper::canCellsOfRowColHideOrCascade called, MergedCellAcrossBlocks: ".concat(!!a.Merge.SpansBlocks,", rowColIndex: ").concat(o,", cell.Col: ").concat(a.Col,", cell.Row: ").concat(a.Row,", isMergedCellIntersectRowCol: ").concat(d))),(ee(a,o,n)||d)&&re(e,a,r,n))return!1}return!0},t.canCellsOfMultipleRowColHideOrCascade=function(e,t,n,r,o){if(oe(e.Cells))return!0;var i=J(r?e.RowNumbers:e.ColumnNumbers,t);if(-1===i)return!1;for(var l=e.Cells,a=0;a<l.length;a++){var s=l[a];if(at(o)&&Y(s,i,n,r))return!1;if((te(s,i,n,r)||Y(s,i,n,r))&&re(e,s,o,r))return!1}return!0},t.cellHasBorderAtPosition=E,t.removeExtraModelRowsColumns=function(e){var t,n,r,o,l,a,s,d,u,c=e.ColumnNumbers.length,g=e.RowNumbers.length,f=w?28:i.MaxAllowedRowColCount,h=w?30:i.MaxAllowedRowColCount,C=[];if(c>h){var m=c-h;if(null===(t=e.ColumnNumbers)||void 0===t||t.splice(h,m),null===(n=e.ColMetadata)||void 0===n||n.splice(h,m),null===(r=e.ColumnWidths)||void 0===r||r.splice(h,m),null===(o=e.FixedColumns)||void 0===o||o.splice(h,m),null===(l=e.ColumnOffsets)||void 0===l||l.splice(h,m),he(e),!oe(e.Cells))for(var p=0,y=e.Cells;p<y.length;p++){var v=y[p];(x&&v.Col>=h||v.Col>h)&&C.push(v)}}if(g>f){var S=g-f;if(null===(a=e.RowNumbers)||void 0===a||a.splice(f,S),null===(s=e.RowHeights)||void 0===s||s.splice(f,S),null===(d=e.RowOutlinesInformation)||void 0===d||d.splice(f,S),null===(u=e.RowOffsets)||void 0===u||u.splice(f,S),fe(e),!oe(e.Cells))for(var R=0,F=e.Cells;R<F.length;R++){v=F[R];(x&&v.Row>=f||v.Row>f)&&C.push(v)}}Ie(e,C)},t.updatePageBreaksOfBlockPair=function(e,t,n,o,i,l){var a,s,d,u,c=i===r.Hide||i===r.Delete?-1*n:n,g=l?null===(a=null==e?void 0:e.PageBreaks)||void 0===a?void 0:a.Row:null===(s=null==e?void 0:e.PageBreaks)||void 0===s?void 0:s.Col,f=l?null===(d=null==t?void 0:t.PageBreaks)||void 0===d?void 0:d.Row:null===(u=null==t?void 0:t.PageBreaks)||void 0===u?void 0:u.Col,h=[],C=[],m=[];if(g){for(var p=0;p<g.length;p++)if(!Ve(e,g[p],o,i,l))if(je(e,g[p],o,i,l,c),Ge(e,g[p],l)){var y=l?e.RowNumbers.length:e.ColumnNumbers.length;g[p].Index+=i===r.Hide||i===r.Delete?y:-1*y,m.push(g[p])}else h.push(g[p]);_e(e,h,l)}if(f){for(p=0;p<f.length;p++)Ve(t,f[p],o,i,l)||(je(t,f[p],o,i,l,c),C.push(f[p]));_e(t,C,l)}!function(e,t,n,r){if(!e||0===t.length)return;e.PageBreaks||(e.PageBreaks={});if(r&&!e.PageBreaks.Row)return void(e.PageBreaks.Row=t);if(!r&&!e.PageBreaks.Col)return void(e.PageBreaks.Col=t);var o=r?e.PageBreaks.Row:e.PageBreaks.Col;if(qe(n))return void o.push.apply(o,t);o.unshift.apply(o,t)}(t,m,i,l),Ue(e),Ue(t)},t.updatePrintAreasOfBlockPair=function(e,t,n,r,o,i){var l=[];if(Qe(e,r,n,o,i,l),h)return h=!1,!0;if(function(e,t,n,r){if(!e||0===t.length)return;for(var o=0,i=t;o<i.length;o++){var l=i[o];r?qe(n)?(l.LastRow+=e.RowNumbers.length,l.FirstRow+=e.RowNumbers.length):(l.LastRow-=e.RowNumbers.length,l.FirstRow-=e.RowNumbers.length):qe(n)?(l.LastColumn+=e.ColumnNumbers.length,l.FirstColumn+=e.ColumnNumbers.length):(l.LastColumn-=e.ColumnNumbers.length,l.FirstColumn-=e.ColumnNumbers.length)}}(t,l,o,i),e&&e.PrintAreas)for(var a=0,s=null==e?void 0:e.PrintAreas;a<s.length;a++){var d=s[a];$e(e,d,i)&&!ot(e,d,o,i)&&l.push(et(e,t,d,o,i))}return Qe(t,r,n,o,i,l),h?(h=!1,!0):(e&&e.PrintAreas&&0===e.PrintAreas.length&&(e.PrintAreas=void 0),t&&t.PrintAreas&&0===t.PrintAreas.length&&(t.PrintAreas=void 0),!1)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){r=e};t.isChangeGateEnabled=function(e){return!r||r.isChangeGateEnabled(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";n.r(t),n.d(t,"rumShepherd",(function(){return r})),n.d(t,"gridRenderer",(function(){return oe}));var r={};n.r(r),n.d(r,"SubComponentInitEventName",(function(){return C})),n.d(r,"SubComponentSetLoadStateEventName",(function(){return m})),n.d(r,"AppLoadMetricReportEventName",(function(){return p})),n.d(r,"dispatchRumShepherdEvent",(function(){return v})),n.d(r,"VISUALLY_READY",(function(){return o})),n.d(r,"FUNCTIONALLY_READY",(function(){return i})),n.d(r,"VISUALLY_PERCEIVED",(function(){return l})),n.d(r,"setupDefaultRumShepherd",(function(){return te})),n.d(r,"RumShepherdFactoryGlobal",(function(){return re}));var o="visually-ready",i="functionally-ready",l="visually-perceived";var a=n(16),s=n(4);function d(){var e=window.performance;return e&&e.timeOrigin?e.timeOrigin:e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:0}function u(){var e=window.performance;return e&&e.now?e.now():(new Date).getDate()-d()}function c(){var e=window.performance;return e&&e.now?d()+e.now():(new Date).getDate()}function g(e){return d()+e}var f=[];function h(e,t,n,r){var o,i=Number(u().toFixed()),l="[rum:".concat(i,"]").concat(t," ").concat(n?JSON.stringify(n):"");f.push({level:e,message:l}),r&&(o={traces:Object(s.__spreadArray)([],Object(s.__read)(f),!1)},f=[],v(y,o))}var C="Wac-SubComponentsInit",m="Wac-SubComponentSetLoadState",p="Wac-AppLoadMetricReport",y="Wac-AppLoadTrace",v=function(e,t){try{var n=new CustomEvent(e,{detail:t});self.dispatchEvent(n)}catch(e){h(a.a.Error,"dispatchRumShepherdEvent failed with exception:",e)}};function S(e){return e===o||e===i||e===l}function R(e,t){var n;for(var r in e)if(!(null===(n=e[r].states[t])||void 0===n?void 0:n.final))return!1;return!0}function F(e,t){return t&&e&&S(t)&&e.states[t]}function w(e){return e?Object(s.__assign)({},e):{}}function T(e){var t=[];for(var n in e){var r=e[n];t.push({id:r.id,rootElementId:r.rootElementId,subComponents:x(r.subComponents)})}return t}function I(e){var t=[];for(var n in e){var r=e[n];t.push({id:r.id,rootElementId:r.rootElementId,subComponents:b(r.subComponents)})}return t}function x(e){var t=[];for(var n in e){var r=e[n];r.nonReporting||t.push({id:r.id,initTime:g(r.initTime),optional:r.optional,unused:r.unused,nonReporting:r.nonReporting,states:D(r.states)})}return t}function b(e){var t=[];for(var n in e){var r=e[n];r.nonReporting&&t.push({id:r.id,initTime:g(r.initTime),optional:r.optional,unused:r.unused,nonReporting:r.nonReporting,states:D(r.states)})}return t}function D(e){var t={};for(var n in e){var r=e[n];(null==r?void 0:r.time)&&(t[n]=g(r.time))}return t}function A(e,t){var n=e.subComponents;for(var r in n){var o=n[r];if(!(o.states[t]||o.unused||o.nonReporting))return!1}return!0}function P(e){var t=Number.POSITIVE_INFINITY;for(var n in e.subComponents){var r=e.subComponents[n];t=Math.min(t,r.initTime)}return t}function H(e,t){if(!e||!t)return!1;var n=e.subComponents;for(var r in n)if(!B(n[r],t))return!1;return!0}function B(e,t){if(!e)return!1;var n=e.states[t];return e.optional||(null==n?void 0:n.time)&&n.promotedFromPreviousState}function M(e,t){return t===o&&F(e,l)}function O(e,t){return{start:e.start,time:null!=t?t:e.time,error:e.error,monitor:e.monitor,measures:w(e.measures),data:w(e.data)}}function k(e,t,n,r){"then"in e?e.then((function(e){r(e)})).catch((function(e){var o="Error in invokeMonitor [".concat(n,"}]");h(a.a.Error,o,e),r({start:t,time:t,monitor:"",error:"".concat(o,": ").concat(e)})})):r(e)}var L=function(){function e(e){this._settings=null!=e?e:{}}return e.prototype.getBooleanSetting=function(e,t){var n=this._settings[e];if(!n)return t;switch(n.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return t}},e.prototype.getStringSetting=function(e,t){var n=this._settings[e];return n||t},e}(),N=function(){function e(e){var t=this;this.timeoutInMs=e,this._reason="",this._cancel=function(e){t._reason||(t._reason=e?"timeout":"cancelled",t._onCancelled&&t._onCancelled())},this.cancel=function(){t._cancel(!1)},e>0&&window.setTimeout((function(){return t._cancel(!0)}),e)}return Object.defineProperty(e.prototype,"timeout",{get:function(){return this.timeoutInMs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this._reason},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCancelled",{set:function(e){this._onCancelled=e},enumerable:!1,configurable:!0}),e}();function E(e){return new N(null!=e?e:0)}var z=function(){function e(e){var t=this;this._metrics={},this._monitoredMetrics={},this._firstTabHiddenTime=0,this._shepherdInit=e,function(e){var t="hidden"===document.visibilityState?0:1/0;e(t),document.addEventListener("visibilitychange",(function(n){t=Math.min(t,n.timeStamp),e(t)}),{once:!0})}((function(e){return t._firstTabHiddenTime=e}))}return Object.defineProperty(e.prototype,"tabHideTime",{get:function(){return this._firstTabHiddenTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metrics",{get:function(){return this._metrics},enumerable:!1,configurable:!0}),e.prototype.startMonitors=function(e,t){var n=this;h(a.a.Verbose,"startMonitors",{appState:e});var r=function(e,r){if(h(a.a.Verbose,"onCompleteWithInputCheck",{metric:e}),r){if(!r.error){var o=n._metrics["first-input"]?n._metrics["first-input"].time:0,i=n._metrics["first-interaction"]?n._metrics["first-interaction"].time:0;o>0&&o<r.time&&(0===i||o<=i)&&(r.error="first-input"),i>0&&i<r.time&&(r.error="first-interaction")}t(e,r)}};e===o&&(this.monitorMetric("first-input",t),this.monitorMetric("first-interaction",t),this.monitorMetric("first-idle",r),this.monitorMetric("stable-interactivity",r,12e4))},e.prototype.cancelMonitors=function(e){var t=this;if(e===o){h(a.a.Info,"cancelAppStateMonitors",e);var n=function(e){var n;null===(n=t._monitoredMetrics[e])||void 0===n||n.cancel(),t._monitoredMetrics[e]=void 0,t._metrics[e]=void 0};n("stable-interactivity"),n("first-idle")}},e.prototype.monitorMetric=function(e,t,n){if(h(a.a.Verbose,"monitorMetric",e),this._monitoredMetrics[e])h(a.a.Verbose,"monitorMetric:already-running",e);else{var r=E(n);this._monitoredMetrics[e]=r;var o=u();k((0,this._shepherdInit.monitors[e])(o,r),o,e,(function(n){h(a.a.Verbose,"monitorMetric:complete",e),t(e,n)}))}},e}();function W(e,t,n,r,o){o&&t.nonReporting||(e.states[n]={result:O(r),monitoring:void 0,final:A(e,n)})}var G=function(){function e(e){var t,n,r=this;this._components={},this._reportedMetrics={},this._canAppStateMetricBeReported=function(e){if(r._reportedMetrics[e])return!1;var t=R(r._components,e);return h(a.a.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:e,isFinal:t}),t},this._canMonitorMetricBeReported=function(e){if("stable-interactivity"===e||"first-idle"===e){var t=r._monitorMetrics.metrics[e],n=R(r._components,o);return h(a.a.Verbose,"canMonitorMetricBeReported:si-error:",{metric:e,error:null==t?void 0:t.error,vrStateFinal:n}),!!t&&"cancelled"!==t.error&&n}return!0},this._reportMonitorMetricIfReady=function(e){var t=r._reportedMetrics[e],n=r._canMonitorMetricBeReported(e);!t&&n?r._reportMetricInternal(e):h(a.a.Info,"reportMonitorMetricIfReady:not-ready",{metric:e,isReported:t,canMetricBeReported:n})},this._reportAppStateIfReady=function(e){r._canAppStateMetricBeReported(e)&&r._reportMetricInternal(e)},this._reportMetricInternal=function(e){try{var t=r._monitorMetrics.metrics[e],n={metric:e,timeOrigin:r._timeOrigin,time:t.time,error:t.error||(r._monitorMetrics.tabHideTime<t.time?"tab-switch":void 0),monitor:t.monitor,measures:w(t.measures),data:w(t.data),auxMetrics:[],componentsData:T(r._components),nonReportingComponentData:I(r._components)},l=n.measures;if(l.tabsSwitch=r._monitorMetrics.tabHideTime<t.time?r._monitorMetrics.tabHideTime:0,l.start=t.start,l.reportedTime=u(),"stable-interactivity"===e){var s=r._monitorMetrics.metrics[o];l[o]=s?s.time:0;var d=r._monitorMetrics.metrics[i];l[i]=d?d.time:0}if(S(e)){for(var c in r._components){var g=r._components[c];if(g){var f=g.states[e].result;if(f){l[c]=f.time,n.error=n.error||f.error;var C={metric:"".concat(e,"-").concat(c),time:f.time,monitor:f.monitor,error:f.error,measures:w(f.measures)};C.measures.start=f.start,C.measures.init=P(g),n.auxMetrics.push(C)}}}var m=r._monitorMetrics.metrics["stable-interactivity"];m&&m.error&&"cancelled"!==m.error&&!n.error&&(n.error="si-error")}r._shepherdInit.appLoadMetricReportCallback&&(r._reportedMetrics[e]=!0,h(a.a.Info,"reportMetric:reporting",e,!0),r._shepherdInit.appLoadMetricReportCallback(n))}catch(e){h(a.a.Error,"reportMetric:error",e)}},this._flushRumShepherdState=function(){var e,t,n=((e={}).time=c(),e.allMetricsReported=!!((t=r._reportedMetrics)[o]&&t[i]&&t["stable-interactivity"]&&t["first-input"]&&t["first-interaction"]&&t["first-idle"]),e.metrics=r._monitorMetrics.metrics,e.components=T(r._components),e.timeOrigin=d(),e);r._shepherdInit.appLoadStateLoggingCallback(n)},this._processSubComponentState=function(e,t,n,o,i){if(F(t,i)){var l=t.states[i];t.states[n]={time:l.time,promotedFromPreviousState:!0}}else t.states[n]={time:o,promotedFromPreviousState:!1};if(h(a.a.Verbose,"processSubComponentState",{component:e.id,subComponent:t.id,state:n}),function(e,t){var n=e.subComponents;for(var r in n){var o=n[r].states[t];if(!((null==o?void 0:o.time)||n[r].optional||M(n[r],t)))return!1}return!0}(e,n)){var s=function(e,t){t&&(h(a.a.Info,"processSubComponentState:complete-monitor-metric",e),r.metrics[e]=O(t),r._reportMonitorMetricIfReady(e))},d=function(e,t){var n=function(e,t){var n,r,o=0;for(var i in e){var l=null===(r=null===(n=e[i].states[t])||void 0===n?void 0:n.result)||void 0===r?void 0:r.time,a=e[i].allSubComponentsUnused;if(!l&&!a)return;l&&(o=Math.max(o,l))}return o}(r._components,e);h(a.a.Verbose,"processSubComponentState:appStateTime",{time:n,state:e}),n&&(!function(e,t,n){t&&(h(a.a.Info,"processSubComponentState:complete-appstate-metric",e),r.metrics[e]=O(t,n),r._reportAppStateIfReady(e))}(e,t,n),r._monitorMetrics.startMonitors(e,s))};r._monitorMetrics.cancelMonitors(n);var c=r._settingsManager.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1),g=F(t,i),f=function(e,t){if(t&&e&&e.states[t]){var n=e.states[t];return(null==n?void 0:n.result)&&(null==n?void 0:n.final)}return!1}(e,i);if(g){var C=e.states[i];return f?H(e,n)?(W(e,t,n,C.result,c),void d(n,C.result)):void 0:void(H(e,n)&&C.monitoring&&(h(a.a.Verbose,"processSubComponentState: detected promotion while previous state is monitoring, marking state to promote later.",{component:e.id,state:n,promotedFromState:i}),C.stateToPromoteWhenFinal=n))}if(e.allSubComponentsUnused){var m={start:0,time:0,monitor:""};return e.states[n]={result:O(m),final:!0},h(a.a.Verbose,"processSubComponentState:setting component's state timings to 0 since all subComponents are unused",{component:e.id,state:n}),void d(n,m)}void 0!==i&&h(a.a.Verbose,"processSubComponentState:starting monitor although we are promoting",{component:e.id,subComponent:t.id,promotedFromState:i,state:n,isPromotingAndPromotedStateExists:g,isPreviousStateHasAFinalResult:f});var p=r._shepherdInit.monitors[n];h(a.a.Verbose,"processSubComponentState:start-monitor",{state:n}),function(e,t,n,r){var o=e.states[t];if(!(null==o?void 0:o.final)){(null==o?void 0:o.monitoring)&&(null==o||o.monitoring.cancel());var i=u(),l=E(5e3);e.states[t]={monitoring:l,final:A(e,t)},k(n(i,l,e),i,t,r)}}(e,n,p,(function(r){h(a.a.Verbose,"processSubComponentState:monitor-complete",{state:n});var o=e.states[n].stateToPromoteWhenFinal;W(e,t,n,r,c),o&&(h(a.a.Verbose,"processSubComponentState: promotion callback detected state to promote.",{component:e.id,state:n,stateToPromote:o}),W(e,t,o,r,c)),d(n,r)}))}else h(a.a.Verbose,"processSubComponentState:component-not-ready",{component:e.id,state:n})},this._processSubComponentUnused=function(e,t){h(a.a.Verbose,"processSubComponentUnused",{subComponent:t.id}),t.unused=!0;var n=e.subComponents,s=!0;for(var d in n){n[d].unused||(s=!1)}s?(e.allSubComponentsUnused=!0,r._processSubComponentState(e,t,l,0),h(a.a.Verbose,"processSubComponentUnused:vp-final",{component:e.id,VISUALLY_PERCEIVED:l}),e.states[l].final=!0,r._reportAppStateIfReady(l),r._processSubComponentState(e,t,o,0),h(a.a.Verbose,"processSubComponentUnused:vr-final",{component:e.id,VISUALLY_READY:o}),e.states[o].final=!0,r._reportAppStateIfReady(o),r._processSubComponentState(e,t,i,0),h(a.a.Verbose,"processSubComponentUnused:fr-final",{component:e.id,FUNCTIONALLY_READY:i}),e.states[i].final=!0,r._reportAppStateIfReady(i)):r.ProcessUnusedComponentFinal(e),r._reportMonitorMetricIfReady("stable-interactivity"),r._reportMonitorMetricIfReady("first-idle")},this._addSubComponent=function(e,t,n,r,o){n?e.ignoredSubComponents[t]=!0:e.subComponents[t]||(e.subComponents[t]={id:t,initTime:u(),optional:r,unused:!1,nonReporting:o,states:{}})},h(a.a.Info,"initialize"),this._timeOrigin=Number(d().toFixed()),this._shepherdInit=Object(s.__assign)({},e),this._monitorMetrics=new z(this._shepherdInit),this._settingsManager=new L(this._shepherdInit.appSettings);try{for(var g=Object(s.__values)(e.components),f=g.next();!f.done;f=g.next()){var C=f.value;this._components[C.id]={id:C.id,rootElementId:C.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}}}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=g.return)&&n.call(g)}finally{if(t)throw t.error}}window.setTimeout((function(){return r._flushRumShepherdState()}),12e4)}return e.prototype.ProcessUnusedComponentFinal=function(e){for(var t in e.states){var n=t,r=e.states[n];!r.final&&A(e,n)&&(h(a.a.Verbose,"processSubComponentUnused:unused-final",{component:e.id,state:n}),r.final=!0,this._reportAppStateIfReady(n))}},e.prototype.addSubComponents=function(e){if(e&&e.component&&e.subComponents){var t=this._components[e.component];if(t){var n=t.ignoreNewSubComponents;if(function(e){for(var t in e.states)if(e.states[t].final)return!1;return!0}(t)||n){h(a.a.Verbose,"addSubComponents",{ignore:n,data:e});try{for(var r=Array.isArray(e.subComponents)?e.subComponents:[e.subComponents],o=0;o<r.length;o+=1)this._addSubComponent(t,r[o],n,!1,!1);if(e.optionalSubComponents)for(o=0;o<e.optionalSubComponents.length;o+=1)this._addSubComponent(t,e.optionalSubComponents[o],n,!0,!1);if(e.nonReportingSubComponents)for(o=0;o<e.nonReportingSubComponents.length;o+=1)this._addSubComponent(t,e.nonReportingSubComponents[o],n,!0,!0)}catch(e){h(a.a.Error,"addSubComponents",e)}}else h(a.a.Error,"Component cannot be modified",e)}else h(a.a.Error,"Invalid component",e)}else h(a.a.Error,"Invalid data",e)},e.prototype.setSubComponentState=function(e){var t,n=u();if(e&&e.subComponent&&e.component&&e.state){var r=this._components[e.component];if(r){if(!r.ignoredSubComponents[e.subComponent]){r.ignoreNewSubComponents=r.ignoreNewSubComponents||!!e.ignoreNewSubComponents;var o=r.subComponents[e.subComponent];if(o)if("unused"!==e.state){var i=e.state;if(S(i))if(null===(t=r.states[i])||void 0===t?void 0:t.final)h(a.a.Error,"Component state final. Can't set",e);else if(o.unused||o.states[i])h(a.a.Error,"SubComponent unused or set",e);else{var l=e.promoteStateFrom;l?this._processSubComponentState(r,o,i,n,l):this._processSubComponentState(r,o,i,n)}else h(a.a.Error,"Unknown state reported",e)}else this._processSubComponentUnused(r,o);else h(a.a.Error,"Unexpected sub-component",e)}}else h(a.a.Error,"Invalid component",e)}else h(a.a.Error,"Invalid data",e)},Object.defineProperty(e.prototype,"components",{get:function(){return this._components},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metrics",{get:function(){return this._monitorMetrics.metrics},enumerable:!1,configurable:!0}),e}();function V(e){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(e)}function j(e,t,n,r){if(V("element")){var o="testimg-"+n,i=function(e){var t=document.createElement("img");if(e){if(!("elementTiming"in t))return;t.elementTiming=e}return t.style.position="absolute",t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t.ariaHidden="true",t}(o);if(i){var l=null!=r?r:document.documentElement;return new Promise((function(n){var r=function(t,r){void 0===t&&(t=0),d&&d.disconnect(),n({start:e,time:t,monitor:"image-paint-api",error:r})},d=new PerformanceObserver((function(e){var t,n,d=e.getEntries();try{for(var u=Object(s.__values)(d),c=u.next();!c.done;c=u.next()){var g=c.value;if(g.identifier===o){try{i.hidden=!0,l.removeChild(i)}catch(e){h(a.a.Error,"measureImagePaintTime",e)}return void r(g.renderTime)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}}));t.onCancelled=function(){return r(0,t.reason)},d.observe({type:"element",buffered:!0}),l.appendChild(i)}))}}}function _(e,t){return window.requestAnimationFrame?new Promise((function(n){var r,o=function(o){void 0===o&&(o=0),cancelAnimationFrame(r),n({start:e,time:o,monitor:"rAF",error:t.reason})};t.onCancelled=o,r=requestAnimationFrame((function(){o(u())}))})):Promise.resolve({start:e,time:0,monitor:"",error:"rAF Unsupported"})}function U(e,t){return new Promise((function(n){var r,o,i=function(i){void 0===i&&(i=0),cancelAnimationFrame(r),clearTimeout(o),n({start:e,time:i,monitor:"rAF-setTimeout",error:t.reason})};t.onCancelled=function(){return i()},r=requestAnimationFrame((function(){o=window.setTimeout((function(){i(u())}),0)}))}))}function q(e,t,n){void 0===n&&(n=1e3);var r=t||E(12e3);if(!V("longtask"))return function(e,t){var n=u();if(!window.requestAnimationFrame)return Promise.resolve({start:n,time:0,monitor:"",error:"rAF unsupported"});var r=u(),o=0,i=r,l=0,a=0,s=r;return new Promise((function(r){var d,u=function(t){void 0===t&&(t=0),cancelAnimationFrame(d);var i={start:n,time:t,monitor:"long-frames",error:e.reason,measures:{longTasksCount:o,longestTaskDuration:a,longTasksDuration:l}};r(i)};e.onCancelled=u;var c=function(e){var n=e-i,r=e-s;if(s=e,r>=50&&(n=0,l+=r,o+=1,i=e,a=Math.max(a,r)),n>=t)return u(i),void Y();d=window.requestAnimationFrame(c)};d=window.requestAnimationFrame(c)}))}(r,n);var o=performance.now(),i=0,l=o,a=0,s=0;return new Promise((function(t){var o,d=function(){clearTimeout(o),c&&c.disconnect();var n=u()-e,d={start:e,time:l,monitor:"longtask-api",error:r.reason,measures:{longTasksDuration:a,longTasksCount:i,longestTaskDuration:s,monitoredTime:n}};t(d)};r.onCancelled=d;var c=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){i+=1,a+=e.duration;var t=e.startTime+e.duration;l=Math.max(t,l),s=Math.max(s,e.duration)}))}));c.observe({entryTypes:["longtask"]});var g=function(){var e=performance.now()-l;if(e>=n)d(),Y();else{var t=n-e;o=window.setTimeout(g,t)}};o=window.setTimeout(g,n)}))}function Y(){try{self.dispatchEvent(new CustomEvent("StableInteractivityDetected"))}catch(e){h(a.a.Error,"".concat("StableInteractivityDetected"," failed with exception: ").concat(e))}}function X(e,t){return V("first-input")?new Promise((function(n){var r,o=function(t,o,i){r&&r.disconnect(),n({start:e,time:t,monitor:"first-input-api",error:i,measures:{fid:o}})};try{t.onCancelled=function(){return o(0,0,t.reason)};(r=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){return function(e){var t=e.processingStart,n=t-e.startTime;o(t,n)}(e)}))}))).observe({type:"first-input",buffered:!0})}catch(e){o(0,0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"FID unsupported"})}function J(e,t){var n=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],r={passive:!0,capture:!0},o=c();return new Promise((function(i){var l=function(n,r,o){s(removeEventListener);var l={start:e,time:n,monitor:"first-interaction",error:t.reason,data:{eventName:r},measures:{delay:o}};i(l)};t.onCancelled=function(){return l(0,"",0)};var a=function(e){if(e.cancelable){var t=c(),n=e.timeStamp>1e12,r=(n?c():performance.now())-e.timeStamp;(r<0||r>t-o)&&(r=0),l(n?e.timeStamp-d():e.timeStamp,e.type,r)}},s=function(e){n.forEach((function(t){e(t,a,r)}))};s(addEventListener)}))}function K(e,t){return window.requestIdleCallback?new Promise((function(n){var r,o=function(t,o){window.cancelIdleCallback(r),n({start:e,time:t,monitor:"first-idle",error:o})};try{r=window.requestIdleCallback((function(e){return o(u(),e.didTimeout?"timeout":"")}),{timeout:t.timeout}),t.onCancelled=function(){return o(0,t.reason)}}catch(e){o(0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"requestIdleCallback unsupported"})}var Z=0,Q=function(e){var t="report ".concat(e.metric,":").concat(e.time,"ms");h(a.a.Info,t,e);var n=new CustomEvent(p,{detail:e});self.dispatchEvent(n)},$=function(e){h(a.a.Info,"reporting the application load state at epoch time: ".concat(e.time,"; with the status of all metrics reported as ").concat(e.allMetricsReported),e);var t=new CustomEvent("Wac-AppLoadStateReport",{detail:e});self.dispatchEvent(t)},ee=function(e,t,n){if(n){var r="vr-".concat(n.id,"-").concat(Z);Z+=1;var o=document.documentElement;return function(e,t,n,r){var o=r?j(e,t,n,r):void 0;return o||(o=_(e,t)),o}(e,t,r,null!=o?o:void 0)}return _(e,t)};function te(e,t){var n=new G({appLoadMetricReportCallback:Q,appLoadStateLoggingCallback:$,appSettings:t,monitors:{"visually-ready":ee,"visually-perceived":ee,"functionally-ready":U,"stable-interactivity":q,"first-input":X,"first-interaction":J,"first-idle":K},components:e});window.addEventListener(C,(function(e){var t=e.detail;n.addSubComponents(t)})),window.addEventListener(m,(function(e){var t=e.detail;n.setSubComponentState(t)}))}var ne=function(e){var t=this;this.rumShepherdDataCollection=[],this.collectRumShepherdAction=function(e){e&&t.rumShepherdDataCollection.push(e)},this.stopRumShepherdDataRetrieverEventListener=function(){window.removeEventListener("Wac-AppLoadMetricReport",t.eventCallback)},this.eventCallback=function(e){var n=e.detail;"visually-ready"===n.metric&&(t.stopRumShepherdDataRetrieverEventListener(),t.getComponentData(n.auxMetrics),t.shouldCollectSubComponentData&&(t.timeOrigin=n.timeOrigin,t.getSubComponentDataForComponents(n.componentsData)))},this.getSubComponentDataForComponents=function(e){e.forEach((function(e){e.subComponents.forEach((function(n){n.unused||n.nonReporting||(t.collectRumShepherdAction({startTime:0,endTime:n.initTime-t.timeOrigin,rumShepherdDataProps:{component:"".concat(e.id),subComponent:"".concat(n.id),state:"VRInit"}}),t.collectRumShepherdAction({startTime:n.initTime-t.timeOrigin,endTime:n.states["visually-ready"]-t.timeOrigin,rumShepherdDataProps:{component:"".concat(e.id),subComponent:"".concat(n.id),state:"VRInitToVR"}}))}))}))},this.getComponentData=function(e){e.forEach((function(e){t.collectRumShepherdAction({startTime:0,endTime:e.measures.init,rumShepherdDataProps:{component:"".concat(e.metric.replace("visually-ready-","")),subComponent:"",state:"VRInit"}}),t.collectRumShepherdAction({startTime:e.measures.init,endTime:e.time,rumShepherdDataProps:{component:"".concat(e.metric.replace("visually-ready-","")),subComponent:"",state:"VRInitToVR"}})}))},this.retrieveRumShepherdEventsBetweenTimeRange=function(e,n){return t.rumShepherdDataCollection.filter((function(t){return e<=t.endTime&&n>=t.startTime}))},this.shouldCollectSubComponentData=e,window.addEventListener("Wac-AppLoadMetricReport",this.eventCallback)},re=new(function(){function e(){}return e.prototype.setupDefault=function(e){if(e)return te(e),null},e.prototype.setupDefaultWithAppSettings=function(e,t){var n,r;if(e){var o={};try{if(t)try{for(var i=Object(s.__values)(t.keys()),l=i.next();!l.done;l=i.next()){var d=l.value;if(d){var u=t.get(d);u&&(o[d]=u)}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}te(e,o)}catch(e){h(a.a.Error,"appSettings: map to dictionary conversion error",e)}return null}},e.prototype.createAndInitRumShepherdDataRetriever=function(e){return new ne(e)},e}()),oe=n(98)}])}));
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/gridRenderer.min.js.map/ea8a6d1e11e107a8d7fc1e00b1568a12/gridRenderer.min.js.map