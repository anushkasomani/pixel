var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=15)}({15:function(e,t,n){"use strict";var i,o,r;n.r(t),n.d(t,"DocRebootSupportMode",(function(){return Dn})),n.d(t,"CommandIds",(function(){return fe})),n.d(t,"EventIds",(function(){return ve})),n.d(t,"createCancellationToken",(function(){return yn})),n.d(t,"Application",(function(){return Vn})),n.d(t,"createApplication",(function(){return Bn})),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=220]="msoulscat_MSOSP_AddInCommands",e[e.A=225]="msoulscat_MSOSP_OTelJS",e[e.P=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.F=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.O=301]="msoulscat_Wac_WordViewer",e[e.R=306]="msoulscat_Wac_BrowserGeneral",e[e.U=320]="msoulscat_Wac_TaskPane",e[e.k=339]="msoulscat_Wac_OneNoteGeneral",e[e.N=340]="msoulscat_Wac_Ribbon",e[e.H=356]="msoulscat_Wac_WacFeedback",e[e.B=379]="msoulscat_Wac_WopiPendingApplication",e[e.J=383]="msoulscat_Wac_Telemetry",e[e.j=391]="msoulscat_Wac_WacCatchUpActivities",e[e.q=394]="msoulscat_Wac_Dictation",e[e.K=395]="msoulscat_Wac_OneNoteSync",e[e.X=700]="msoulscat_Wac_VisioApp",e[e.$=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.Z=800]="msoulscat_Wac_PptAnimation",e[e.Y=833]="msoulscat_Wac_PptLive",e[e.ee=834]="msoulscat_Wac_PptMWeb",e[e.te=835]="msoulscat_Wac_PptGc2General",e[e.ne=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.ie=837]="msoulscat_Wac_PptGc2Operation",e[e.oe=844]="msoulscat_Wac_PptDataSync",e[e.re=848]="msoulscat_Wac_PptFluidRuntime",e[e.se=815]="msoulscat_Wac_PptShape",e[e.ae=817]="msoulscat_Wac_PptSession",e[e.ce=830]="msoulscat_Wac_PptSlideshow",e[e.ue=822]="msoulscat_Wac_PptView",e[e.le=846]="msoulscat_Wac_PptVideos",e[e.fe=1303]="msoulscat_Uci_Insights",e[e.he=2300]="msoulscat_Wac_VersionHistory",e[e.pe=302]="msoulscat_Wac_WordPresence",e[e.ve=3e3]="msoulscat_Wac_OAuth",e[e.me=3005]="msoulscat_Wac_WordVersionHistory",e[e.we=3006]="msoulscat_Wac_LivePersonaCard",e[e.ge=3012]="msoulscat_Wac_CatchUpFlyout",e[e.Se=3016]="msoulscat_Wac_WordDesigner",e[e.Ie=3021]="msoulscat_Wac_ModernFontPicker",e[e.be=3027]="msoulscat_Wac_UnifiedUiHost",e[e._e=3033]="msoulscat_Wac_EquationTools",e[e.ye=1401]="msoulscat_Osf_Latency",e[e.Te=1402]="msoulscat_Osf_Notification",e[e.Ce=1403]="msoulscat_Osf_Runtime",e[e.Ee=3041]="msoulscat_Wac_AiMaker",e[e.Ae=3043]="msoulscat_Wac_AiRewrite",e[e.Pe=3044]="msoulscat_Wac_AiInsert",e[e.Fe=3047]="msoulscat_Wac_AiSummarize",e[e.Oe=3048]="msoulscat_Wac_CopilotCompose",e[e.Re=3049]="msoulscat_Wac_Skittles"}(i||(i={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(r||(r={}));var s=window.navigator,a=s?s.userAgent:void 0;function c(){if(a){if(a.indexOf("Firefox")>-1)return r.Firefox;if(a.indexOf("Opera")>-1||a.indexOf("OPR")>-1)return r.Opera;if(a.indexOf("Trident")>-1)return r.IE;if(a.indexOf("Electron")>-1&&a.indexOf("Teams")>-1)return r.TeamsElectron;if(a.indexOf("Edg")>-1)return r.Edge;if(a.indexOf("Chrome")>-1)return r.Chrome;if(a.indexOf("Safari")>-1)return r.Safari}return r.Unknown}function u(){try{return!!a&&a.indexOf("iPad")>=0||!!a&&a.indexOf("Macintosh")>=0&&p()&&!h()||!!a&&a.indexOf("Android")>=0||p()}catch(e){return!1}}function d(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function l(){return c()===r.IE&&!function(){if(c()!==r.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function f(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function h(){return!!a&&a.indexOf("iPhone")>=0}function p(){return!!s&&s.maxTouchPoints>0}var v=["eurppc"];function m(e){return 8===e.toLowerCase().indexOf("ffc")}function w(e){return 8===e.toLowerCase().indexOf("ppc")}function g(e){var t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function S(e,t){if(!t||-1===v.indexOf(t.toLowerCase()))return e;var n=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return n?"".concat(n[1]).concat(t,"-").concat(n[3]):e}function I(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function b(e,t){var n=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!n)throw new Error("Invalid URL");var i=n[2];if(void 0===t)return i;if(t<0)throw new Error("subDomainParts should be at least 1");return i.split(".").slice(-(t+1)).join(".")}function _(e,t,n){n&&(e[t.toLowerCase()]=n)}function y(e,t){e[t.toLowerCase()]=""}function T(e,t){var n=e.toLowerCase(),i=t.toLowerCase(),o=n.indexOf("&"+i+"=");if(-1===o&&(o=n.indexOf("?"+i+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function C(e,t,n,i){if(!n)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==s&&c){if(i){var u=c.index+1,d=o.indexOf("&",u);o=o.substring(0,u)+a+n+(-1===d?"":o.substring(d))}return o}return o.concat(s,a,n)}function E(e){var t={},n=e.indexOf("?");return-1===n||n===e.length-1||e.substring(n+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var n=e.indexOf("=");-1!==n&&n!==e.length-1&&(t[e.substring(0,n).toLowerCase()]=e.substring(n+1))}})),t}function A(e){if(!e)return"";var t=-1===e.indexOf("#")?e.length:e.indexOf("#"),n=e.lastIndexOf("/",t);if(-1!==n&&n+1===e.indexOf("://")+"://".length)return"";n+=1;var i=e.indexOf("?");if(-1!==(i=i>=t?-1:i)&&n>i)return"";var o=-1===i?t:i;return n>=o?"":e.substring(n,o)}function P(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function F(e,t,n){var i=new RegExp("[?&]"+t+"=("+(n||"1")+")\\b","i"),o=e.match(i);return!!o&&(!n||o[1]===n)}function O(e,t){var n=T(e,t);return n?decodeURI(n):n}function R(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function U(e,t){return{shouldPreload:function(t,n){return e(t,n)},preload:function(e,n,r,s){t(e,n,s).forEach((function(e){!function(e,t,n,r,s){var a=document.createElement("link");if(a.setAttribute("crossorigin","anonymous"),a.rel=W,a.href=e,t){var c=n||A(e);t.ULS.Ue(561059910,i.B,o.Info,"Preloading resource: ".concat(c));a.addEventListener("error",(function(){t.ULS.Ue(561059911,i.B,o.Error,"Resource failed to load: ".concat(c))}))}a.setAttribute("as","script"),r&&a.setAttribute("integrity",r);document.head.appendChild(a),s&&a.addEventListener("load",s,{once:!0})}(e[0],r,void 0,e[1])}))}}}var x,W=(x=c())===r.Firefox||x===r.IE?"prefetch":"preload";var k={en:"1033",cs:"1029",da:"1030",de:"1031",el:"1032",fi:"1035",fr:"1036",hu:"1038",it:"1040",ja:"1041",ko:"1042",nl:"1043",nb:"1044",sk:"1051",sv:"1053",tr:"1055",uk:"1058",sl:"1060",es:"3082",pl:"1045",ro:"1048",ru:"1049"};function M(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}function N(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return D&&(!t||t(e))},preconnect:function(t){return M(e?P(t):t)}}}var H,D=!0;function L(e,t,n){if(t){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(t,e)}catch(e){}!function(e,t,n){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,n),i.send(e))}(e,t,n)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(H||(H={}));var V={BUILD_NUMBER:"###VERSION###"};function B(){try{return"20240403.3"}catch(e){return V.BUILD_NUMBER}}var J,j;function G(e,t,n){!function(e,t,n,i){void 0===i&&(i=!0);var o={type:t.toString(),payloadJson:JSON.stringify(n)};L(JSON.stringify(o),e,i)}(e,J.JSAPI_STATE,{application:t,build:B(),state:n})}function q(e,t,n,i){var o=[],r=e.map((function(e){return function(e,t,n){var i={};if(i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category,e.correlationId){var o=n.findIndex((function(t){return t===e.correlationId}));o<0&&(o=n.push(e.correlationId)-1),i.I=o}var r=1e3*e.type+e.level;return i.D=r,i}(e,i,o)})),s=function(e,t,n,i,o){var r={};r.T=e,r.L=t,r.S=n,r.I=i,o&&o.length>0&&(r.W=o);return r.V=1,r}(i,r,t,n,o);return JSON.stringify(s)}!function(e){e.JSAPI_STATE="JSAPI_STATE",e.H_V2="H_V2"}(J||(J={})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(j||(j={}));var z,K=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function X(){return K?window.performance.now():Date.now()}function $(){if(!z){var e=window.performance;z=K&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return z()}var Z,Q,Y=function(){function e(e){var t=this;this.xe=3e4,this.We=30,this.ke=0,this.Me=[],this.Ne=$(),this.He=[],this.De="",this.Le=0,this.flushOnClose=function(){t.Ve(!1,!1)},this.flush=function(){t.Be()},this.flushAndSetNewEndpoint=function(e,n){var i,o=t.Je(e);o.localeCompare(null!==(i=t.je)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(t.He.push((function(){t.je=o,n&&n()})),t.Ve(!0,!0))},this.Je=function(e){return e+"?usid="+t.De+"&officeserverversion="+B()},this.Be=function(){window.setTimeout((function(){return t.Ve(!0,!0)}),0)},this.Ve=function(e,n){var i=X();if(window.clearTimeout(t.Ge),t.je){if(t.Me.length>0)t.ke+=1,L(q(t.Me.splice(0,e?t.We:t.Me.length),t.De,t.ke,t.Ne),t.je,n),t.Ne=$();0===t.Me.length&&t.He.length>0&&(t.He.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.He=[]),e&&(t.Ge=window.setTimeout((function(){t.Be()}),t.Me.length>t.We||t.He.length>0?1e3:t.xe)),t.Le+=X()-i}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.Le},e.prototype.addLoggingTime=function(e){this.Le+=e},e.prototype.configure=function(e){var t=X();if(e.uploadCadenceInMs&&(this.xe=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.We=e.uploadTriggerSize),e.sessionId&&(this.De=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.je)throw new Error("Remote ULS endpoint is already set");this.je=this.Je(e.remoteUlsEndpoint),this.Ne=$(),this.Be()}this.Le+=X()-t},e.prototype.handleTrace=function(e){var t=X();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.Me.push(e),(this.Me.length>this.We||e.level===o.Error)&&this.Be(),this.Le+=X()-t},e.prototype.getUserSessionId=function(){return this.De},e}(),ee=[];!function(e){e.qe="BootstrapperMaxUlsHeartbeatTime",e.ze="BootstrapperNoCompleteWarning1Time",e.Ke="BootstrapperNoCompleteWarning2Time",e.Xe="RemoteUlsETag",e.$e="RemoteUlsSuppressions",e.Ze="BootstrapperSettingsFetchPeriod",e.Qe="timestamp",e.Ye="BootstrapperUlsHeartbeatIntervalMs",e.et="BootstrapperUlsHeartBeatIsEnabled",e.tt="BootstrapperUlsUploadCadenceMs",e.nt="WordConsumptionViewToEditRedirectIsEnabled",e.ot="RequestedCallThrottlingDefaultToViewMinimumValue",e.rt="BulsEndpointUrl",e.st="EnableCommonHostDiagnosticsParams",e.ct="EnableICNForWord",e.ut="EnableModernEmbedViewForPowerPoint",e.dt="EnableModernEmbedViewInOneUpForPowerPoint",e.lt="EnableModernReadingViewForPowerPoint",e.ft="EnableDefaultToModernForPowerPoint",e.ht="ShouldLogJsApiKpisForWord",e.pt="WordSwitchToViewInTeamsJsapiV1Enabled",e.vt="EnableWordSessionRefreshTelemetry",e.wt="PowerPointUseEssDCHint",e.gt="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",e.St="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",e.It="ModernEmbedViewForPowerPointEnabledPercentage",e.bt="PowerPointESSCookieLookbackThresholdHour",e._t="PowerPointSetESSCookieLookbackExpEnabled"}(Q||(Q={}));function te(e){var t=new Y(e);function n(e,n,i,o){var r=X();if(!function(e){return 1===ee[e]}(e)){var s={timestamp:$(),category:n,tag:e,level:i,type:j.Trace,message:o,correlationId:""};t.addLoggingTime(X()-r),t.handleTrace(s)}}return{ULS:{Ue:function(e,t,i,o){n(e,t,i,o)},shipAssertTag:function(e,t,i,r){i&&n(e,t,o.Error,r)},debugAssertTag:function(e,t,n,i){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var n,i;n=e.yt.getValue(Q.$e,""),i=e.yt.getValue(Q.Xe,""),Z&&i===Z||(ee=[],Z=i,n&&n.split(",").forEach((function(e){var t=parseInt(e,10);t&&(ee[t]=1)}))),t.configure({uploadCadenceInMs:e.yt.getValue(Q.tt,6e4)});var o=e.yt.getValue(Q.rt,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(e,n){t.flushAndSetNewEndpoint(e,n)}}}var ne=function(){return(ne=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ie(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function oe(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function re(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}var se;Object.create;function ae(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function ce(e){if(!e)return"";var t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(Object.getPrototypeOf(e));return JSON.stringify(e,re(re([],t,!0),n,!0))}function ue(e,t){return{isFeatureEnabled:function(n){return function(e,t,n){if(!t)return;try{return t(e)}catch(e){n&&n.ULS.Ue(594883024,i.B,o.Error,"IsFeatureEnabled callback error: "+ce(e))}return}(n,e,t)}}}function de(e,t){var n={};if(Object.keys(se).forEach((function(t){var i=e.isFeatureEnabled(se[t]);void 0!==i&&(n[se[t]]=i?"1":"0")})),t&&t.wdFlights)for(var i=0,o=t.wdFlights.toLowerCase().split(",");i<o.length;i++){var r=o[i];"et-treatment"!==r&&"et-control"!==r||(n[se.Tt]="et-treatment"===r?"1":"0")}return JSON.stringify(n)}!function(e){e.Tt="EnterpriseTemplates",e.Ct="ExcelAdaptiveLayoutDownload",e.Et="ExcelLandingPageOfflineTelemetry",e.At="ExcelLandingPageObserverRetry",e.Pt="H2StaticContent",e.Ft="HashedUrl",e.Ot="ODCShareLinkPreload",e.Rt="OfficeComExcelJsApiV2",e.Ut="OfficeComPptJsApiV2",e.xt="OfficeComUiHost",e.Wt="OfficeComWordJsApiV2",e.kt="OfficeHwaUiHost",e.Mt="OfficeUnifiedUiHostTeams",e.Nt="WordViewToUnifiedRead",e.Ht="PowerPointEarlySessionStart"}(se||(se={}));var le,fe,he,pe,ve,me,we=function(){function e(){this.Dt=[]}return e.prototype.add=function(e){e&&this.Dt.push(e)},e.prototype.remove=function(e){if(e){var t=this.Dt.indexOf(e);t>-1&&this.Dt.splice(t,1)}},e.prototype.removeAll=function(){this.Dt=[]},e.prototype.dispatch=function(e,t){this.Dt.forEach((function(n){try{n(e)}catch(e){t&&t(e)}}))},e}(),ge=function(){function e(e,t){var n=this;this.Lt=0,this.Vt=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(n.Bt);if(!e)return;var t=JSON.parse(e);n.Jt(t)}catch(e){n.jt.ULS.Ue(592836768,i.B,o.Warning,"Failed to get settings from localStorage: "+ce(e))}},this.Jt=function(e){return!!n.Gt(e)&&(n.qt=e,n.zt.dispatch({yt:n},(function(e){n.jt.ULS.Ue(592836769,i.B,o.Error,"Settings listener error: "+ce(e))})),!0)},this.Gt=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(Q.Qe)&&!isNaN(e.timestamp))return!0;n.jt.ULS.Ue(592836770,i.B,o.Error,"Received invalid settings")}return!1},this.Kt=function(){if(n.Xt){var e=new XMLHttpRequest;e.open("GET",n.Xt),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(n.$t(e.response),n.Lt=0):(n.jt.ULS.Ue(592836771,i.B,o.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(n.Lt)),n.Lt+=1),!(n.Lt>7)){var t=n.getValue(Q.Ze,3e5);n.Lt>3&&(t+=(n.Lt-3+1)*(t/2)),n.Zt=window.setTimeout(n.Kt,t)}}}},this.$t=function(e){"requestIdleCallback"in window?(n.Qt&&self.cancelIdleCallback(n.Qt),n.Qt=window.requestIdleCallback((function(){return n.Yt(e)}),{timeout:1e4})):window.setTimeout((function(){return n.Yt(e)}),0)},this.Yt=function(e){if(n.Jt(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(n.Bt,t)}catch(e){n.jt.ULS.Ue(592836800,i.B,o.Warning,"Failed to set localStorage: "+ce(e))}}},this.tn=e,this.Bt="Prod"+e+"Settings",this.jt=t,this.zt=new we,this.Vt()}return e.prototype.updateEnvironment=function(e){this.Bt=(m(e)?"FF":"Prod")+this.tn+"Settings",this.Vt()},e.prototype.initializePeriodicFetch=function(e,t){this.Bt=(m(e)?"FF":"Prod")+this.tn+"Settings",this.Vt(),this.Xt=e+"AppSettingsHandler.ashx?app="+this.tn+"&usid="+t+"&build="+B(),this.Zt||(this.Zt=window.setTimeout(this.Kt,3e4))},e.prototype.getValue=function(e,t){if(this.qt||this.Vt(),!this.qt||!this.qt.hasOwnProperty(e))return t;var n=this.qt[e],i=typeof t;if(typeof n===i)return n;if("string"==typeof n){if("number"===i)return parseInt(n,10);if("boolean"===i)return"true"===n}return t},e.prototype.addSettingsChangeListener=function(e){this.zt.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.zt.remove(e)},e.prototype.dispose=function(){this.Zt&&window.clearTimeout(this.Zt),this.Qt&&self.cancelIdleCallback(this.Qt),this.Zt=void 0,this.Qt=void 0,this.qt=void 0,this.zt.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.postWacToken="postWacToken",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete",e.setWacFlightValue="setWacFlightValue"}(le||(le={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared",e.postWacToken="postWacToken"}(fe||(fe={})),function(e){e.nn="App_AccessibilityLoopComplete",e.in="Wac_ActionComplete",e.on="WacInitialize_Ready",e.rn="Wac_AppFailed",e.sn="Wac_AppBootState",e.an="Wac_AppCompleted",e.cn="BrowserEvent",e.un="UI_Close",e.dn="App_CloseTab",e.ln="UI_Conversation",e.fn="UI_CopyAndEdit",e.hn="App_CreateNewDocument",e.pn="Wac_AppDataSavedStatus",e.vn="UI_Download",e.mn="UI_Edit",e.wn="Error",e.gn="UI_FileEmbed",e.Sn="UI_FileProperties",e.In="File_Rename",e.bn="File_RenameFailed",e._n="UI_FileVersions",e.yn="StateChanged",e.Tn="App_IsFrameTrusted",e.Cn="GetAccessToken",e.En="App_GetAuthToken",e.An="App_GetCustomAuthConfig",e.Pn="App_GetHostKeyValue",e.Fn="App_WopiInfoFromUrl",e.On="App_DavUrlFromIds",e.Rn="App_LoadingStatus",e.Un="App_SwitchMode",e.xn="App_MoveToFolder",e.Wn="UI_OpenInMobileApp",e.kn="UI_OpenInBrowser",e.Mn="UI_OpenInClient",e.Nn="PageChanged",e.Hn="App_PushCommentContext",e.Dn="App_PushState",e.Ln="App_DocReboot",e.Vn="UI_RedeemForCommenting",e.Bn="App_RefreshSessionInfo",e.Jn="UI_ReplyWithChanges",e.jn="UI_ReportAbuse",e.Gn="App_FilePicker",e.qn="UI_SaveStatus",e.zn="WopiSession_Complete_Ack",e.Kn="SetOverlayContent",e.Xn="UI_Sharing",e.$n="UI_ShareForm",e.Zn="UI_SignIn",e.Qn="App_StoreHostKeyValue",e.Yn="App_Unloaded",e.ei="App_UlsLog",e.ti="Wac_UnloadingApp",e.ni="App_UpdateBootComplete",e.ii="PageCount",e.oi="UI_CheckUserAccessAndGrantPermissions",e.ri="User_Activity",e.si="Edit_Notification",e.ai="UI_Workflow",e.ci="ZoomChanged",e.di="CAAEMessage",e.li="Excel_HostFrameCacheSave",e.hi="Excel_HostFrameCacheEvict",e.pi="Excel_RegenerateFileBundle",e.vi="App_SwitchToWacFrame",e.mi="App_SaveSSRData",e.wi="App_PurgeDataInHostCache",e.gi="App_SaveHostRenderingV2Data",e.Si="App_SaveHostUtilsData",e.Ii="AcquireOAuthTokenTeams",e.bi="App_SwitchNotebook",e._i="FailedBoot_CheckFileInfo",e.yi="GetTeamsUsers",e.Ti="SendTeamsUserMention",e.Ci="NavigateBackToHost",e.Ei="App_GetClientUrlComplete",e.Ai="App_GetWebUrlComplete",e.Pi="App_CopyLinkComplete",e.Fi="App_SendConversationId",e.Oi="CloseTeamsConversation",e.Ri="PageLoaded",e.Ui="Visio_BRS",e.xi="Visio_SendLicenseInfo",e.Wi="Visio_Consumption_CLTComplete",e.ki="Visio_SwitchMode_FromViewFrame",e.Mi="Visio_ModeSwitch_ToHost_Ack",e.Ni="Visio_UpdateEditUrl",e.Hi="Visio_PageViewLoaded",e.Di="Visio_ActiveAppFrameLoadFailed",e.Li="Visio_DisposeBkgFrame",e.Vi="Visio_ReadyToReceiveDocData",e.Bi="Visio_DocReboot_HostNav",e.Ji="Visio_SwitchToVisioFrame",e.ji="WacAppPerfMetric",e.Gi="App_ModifyURLState",e.qi="App_WacTokenAck",e.zi="App_InitEnd",e.Ki="App_SplashScreenShown",e.Xi="App_SetWacFlightValue"}(he||(he={})),function(e){e.$i="Ack",e.Zi="WacInitialize_Ready_Ack",e.Qi="Wac_BeforeUnloadApp",e.Yi="Blur_Focus",e.eo="Wac_AppFailed_Ack",e.to="Wac_AppCompleted_Ack",e.no="WopiStartSession_Complete",e.io="WopiPendingSession_Complete",e.oo="Host_AccessibilityLoopComplete",e.Tn="Host_IsFrameTrusted",e.so="Grab_Focus",e.ao="HostCacheDiagnostic",e.co="Host_KeyValue",e.uo="JsApiDiagnostics",e.xn="Host_MoveToFolder",e.do="PageChanged_Ack",e.lo="App_PopState",e.fo="Host_SendChannelId",e.ho="Host_SendConversationId",e.po="GetTeamsUsers_Reply",e.vo="SendTeamsUserMention_Reply",e.mo="Host_BackButtonPressed",e.wo="Host_GetClientUrl",e.So="Host_GetWebUrl",e.Io="OwlFrameDiagnostics",e.bo="File_Rename",e.Gn="Host_FilePicker",e._o="PostAccessToken",e.yo="Host_SetAuthToken",e.To="Host_SetCustomAuthConfig",e.Co="App_PushCommentContext",e.Eo="CanEmbed",e.Ao="Host_RefreshSessionInfo",e.Po="CheckUserAccessAndGrantPermissions_Result",e.Fo="Host_WopiInfoFromUrl",e.Oo="Host_DavUrlFromIds",e.Ro="SetCurrentPage",e.Uo="SetZoomLevel",e.xo="WopiPendingSession_Fail",e.Wo="SetOverlayContent",e.Mo="WopiPendingApplicationComplete_Received",e.No="Host_SwitchMode",e.Ho="Host_Unload",e.Do="PageCount_Ack",e.Lo="ZoomChanged_Ack",e.Vo="Host_ShareUI",e.Bo="Host_Telemetry",e.Jo="Visio_ConsumptionCLTComplete_Ack",e.jo="Visio_SwitchMode_FromHF_Ack",e.Go="Visio_SwitchMode_FromHostFrame",e.qo="Visio_FallbackToLegacySwitch",e.zo="Visio_DocumentData",e.Ko="Host_PostWacToken"}(pe||(pe={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.InitEnd="InitEnd",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.SplashScreenShown="SplashScreenShown",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(ve||(ve={}));var Se=((me={})[fe.boot]={Xo:le.boot},me[fe.createNew]={Xo:le.createNew},me[fe.dispose]={Xo:le.dispose},me[fe.postWacToken]={Xo:le.postWacToken},me[fe.rename]={Xo:le.rename},me[fe.switchMode]={Xo:le.switchMode},me[he.sn]={Xo:le.handleBootState},me[he.dn]={Xo:le.closeTab},me[he.Tn]={Xo:le.frameTrust},me[he.En]={Xo:le.getAuthToken},me[he.Pn]={Xo:le.getHostKeyValue},me[he.Ln]={Xo:le.appReboot},me[he.Xi]={Xo:le.setWacFlightValue},me[he.Kn]={Xo:le.setOverlayContent},me[he.Qn]={Xo:le.storeHostKeyValue},me[he.ni]={Xo:le.updateBootComplete},me[fe.blurFocus]={$o:pe.Yi},me[fe.continueAccessibilityLoop]={$o:pe.oo},me[fe.grabFocus]={$o:pe.so},me[fe.moveToFolder]={$o:pe.xn},me[fe.popState]={$o:pe.lo},me[fe.sendChannelId]={$o:pe.fo},me[fe.sendConvId]={$o:pe.ho},me[fe.teamsUsersReply]={$o:pe.po},me[fe.teamsUserMentionReply]={$o:pe.vo},me[fe.backButtonPressed]={$o:pe.mo},me[fe.getClientUrl]={$o:pe.wo},me[fe.getWebUrl]={$o:pe.So},me[fe.sendAccessToken]={$o:pe._o},me[fe.sendAuthToken]={$o:pe.yo},me[fe.sendHWRTelemetry]={$o:pe.Bo},me[fe.sendCustomAuthConfig]={$o:pe.To},me[fe.sendDavUrl]={$o:pe.Oo},me[fe.sendEmbeddedViewUrl]={$o:pe.Eo},me[fe.sendFrameTrustResult]={$o:pe.Tn},me[fe.sendSessionInfo]={$o:pe.Ao},me[fe.sendUserAccessAndPermissions]={$o:pe.Po},me[fe.sendWopiInfo]={$o:pe.Fo},me[fe.signalShared]={$o:pe.Vo},me[fe.sendOwlFrameDiagnostics]={$o:pe.Io},me[fe.completeSharedFilePicker]={$o:pe.Gn},me[he.nn]={Zo:ve.AccessibilityLoopCompleted},me[he.in]={Zo:ve.ActionCompleted},me[he.cn]={Zo:ve.BrowserEvent},me[he.di]={Zo:ve.CAAEMessage},me[he.un]={Zo:ve.Close},me[he.ln]={Zo:ve.Conversation},me[he.fn]={Zo:ve.CopyAndEdit},me[he.hn]={Zo:ve.CreateNewDocument},me[he.vn]={Zo:ve.Download},me[he.mn]={Zo:ve.Edit},me[he.wn]={Zo:ve.Error},me[he.gn]={Zo:ve.FileEmbed},me[he.Sn]={Zo:ve.FileProperties},me[he.In]={Zo:ve.FileRenamed},me[he._n]={Zo:ve.FileVersions},me[he.Cn]={Zo:ve.GetAccessToken},me[he.On]={Zo:ve.GetDavUrlFromIds},me[he.An]={Zo:ve.GetCustomAuthConfig},me[he.Fn]={Zo:ve.GetWopiInfoFromUrl},me[he.yn]={Zo:ve.FrameStateChanged},me[he.Un]={Zo:ve.ModeSwitched},me[he.xn]={Zo:ve.MoveToFolder},me[he.Wn]={Zo:ve.OpenInMobileApp},me[he.kn]={Zo:ve.OpenInBrowser},me[he.Mn]={Zo:ve.OpenInClient},me[he.Nn]={Zo:ve.PageChanged},me[he.Dn]={Zo:ve.PushState},me[he.Vn]={Zo:ve.RedeemForCommenting},me[he.Bn]={Zo:ve.RefreshSessionInfo},me[he.Jn]={Zo:ve.ReplyWithChanges},me[he.Gn]={Zo:ve.SharedFilePicker},me[he.jn]={Zo:ve.ReportAbuse},me[he.qn]={Zo:ve.SaveStatus},me[he.Xn]={Zo:ve.Share},me[he.$n]={Zo:ve.ShareForm},me[he.Zn]={Zo:ve.SignIn},me[he.oi]={Zo:ve.UserAccessAndPermissions},me[he.ri]={Zo:ve.UserActivity},me[he.si]={Zo:ve.UserEditActivity},me[he.ai]={Zo:ve.Workflow},me[he.ci]={Zo:ve.ZoomChanged},me[he.Ii]={Zo:ve.AcquireOAuthTokenTeams},me[he.Rn]={Zo:ve.LoadingStatus},me[he.bi]={Zo:ve.SwitchNotebook},me[he._i]={Zo:ve.FailedBootCheckFileInfo},me[he.yi]={Zo:ve.GetTeamsUsers},me[he.Ti]={Zo:ve.SendTeamsUserMention},me[he.Ci]={Zo:ve.NavigateBackToHost},me[he.Ei]={Zo:ve.GetClientUrlComplete},me[he.Ai]={Zo:ve.GetWebUrlComplete},me[he.Pi]={Zo:ve.CopyLinkComplete},me[he.Fi]={Zo:ve.SendConversationId},me[he.Oi]={Zo:ve.CloseTeamsConversation},me[he.Ri]={Zo:ve.PageLoaded},me[he.zi]={Zo:ve.InitEnd},me[he.Ki]={Zo:ve.SplashScreenShown},me);function Ie(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},n=window.crypto||window.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(ce(e)))}}t.perfNow=K;for(var i=0;i<e.length;i+=1){try{if(K){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(ce(e)))}e[i]=Math.floor(16*Math.random())}return t}(e),n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=15&e[n];return n+=1,("x"===t?i:3&i|8).toString(16)})),t]}function be(e,t){try{if(void 0===window.performance)return void t.ULS.Ue(595948609,i.B,o.Info,"Performance not supported");var n=window.performance.getEntriesByType("resource");if(void 0===n||n.length<=0)return void t.ULS.Ue(595948610,i.B,o.Info,"No resources under performance");for(var r=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i"),s=n.length-1;s>=0;s-=1){var a=n[s],c=a.name.match(r);if(c){var u=JSON.stringify(a);return u=u.replace(new RegExp(a.name,"g"),c[0]),void t.ULS.Ue(595948616,i.B,o.Info,u)}}t.ULS.Ue(595948484,i.B,o.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.Ue(595948617,i.B,o.Info,"Could not trace the resource timing: ".concat(ce(e)))}}function _e(e){var t,n,i=ne(ne({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete i.siteId,delete i.webId,delete i.uiHostTabId;var o={};if(e.wdParams){var r=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o[e]=r[e])}));var s=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!s.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!s.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}var a=ne({},e.rebootOverride);delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl;var c=e.wopi;return{accessToken:c?{length:c.accessToken.length,expiry:c.expiry}:"N/A",wacToken:c&&c.wacToken?{length:c.wacToken.length}:void 0,bootParams:e.bootParams,build:B(),host:i,intent:e.intent,jsApiVersion:"v2",rebootOverride:a,region:g(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(n=e.meeting)||void 0===n?void 0:n.isPresenter}:void 0,wdParams:o}}function ye(){var e={perfNowSupported:K,browser:r[c()],touchMode:u(),highContrast:d(),windows10x:f()};try{var t=window.navigator,n=t.connection||t.mozConnection||t.webkitConnection;n&&(e.netDownlink=n.downlink,e.netDownlinkMax=n.downlinkMax,e.netEffectiveType=n.effectiveType,e.netRtt=n.rtt,e.netSaveData=n.saveData,e.netType=n.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}var Te;function Ce(e){var t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));var n=window.performance.navigation;if(n&&(void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=n.redirectCount),!e.hostPageNavigationType)){var i="UNKNOWN";switch(n.type){case 0:i="NAVIGATE";break;case 1:i="RELOAD";break;case 2:i="BACK_FORWARD";break;case 255:i="RESERVED"}e.hostPageNavigationType=i}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(Te||(Te={}));var Ee=function(){function e(e,t){this.Qo=function(){return Ae(e,"OnBeforeUnload",t)},this.Yo=function(){return Ae(e,"OnPageHide",t)},this.er=function(){return Ae(e,"VisibilityChange_"+document.visibilityState,t)},this.nr=function(){return Ae(e,"OnUnload",t)},window.addEventListener("beforeunload",this.Qo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Yo,{capture:!0}),window.addEventListener("visibilitychange",this.er,{capture:!0}),window.addEventListener("unload",this.nr,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.Qo,{capture:!0}),window.removeEventListener("pagehide",this.Yo,{capture:!0}),window.removeEventListener("visibilitychange",this.er,{capture:!0}),window.removeEventListener("unload",this.nr,{capture:!0})},e}();function Ae(e,t,n){e.ULS.Ue(595957843,i.B,o.Info,"Page lifecycle: ".concat(t," fired")+(n?", flushing logger":"")),n&&e.ULS.flush()}var Pe=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://officescripting-int.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000"],Fe=function(){function e(e){var t=this;this.ir={},this.or=[],this.rr=function(e){if(e&&e.origin)try{var n=e.data;if("string"==typeof n&&n.includes("AddinTrustedOrigin")){var r=JSON.parse(n),s=r.AddinTrustId;s&&"AddinTrustedOrigin"===r.MessageId&&(t.jt.ULS.Ue(560754784,i.B,o.Info,"didReceiveMessage addinTrustId ".concat(s)),t.ir[s]=e.origin,t.or.forEach((function(t){t(s,e.origin)})))}}catch(e){t.jt.ULS.Ue(560754785,i.B,o.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.jt=e,window.addEventListener("message",this.rr)}return e.prototype.isResourceTrustedForMessage=function(e){return ie(this,void 0,void 0,(function(){var t,n,r,s,a,c,u,d,l=this;return oe(this,(function(f){switch(f.label){case 0:return e&&e.Resource?(t=e.Resource,n=e.AddinTrustId,(r=function(e){if(!e)return!1;for(var t=e.toLowerCase(),n=0,i=Pe;n<i.length;n++){var o=i[n];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!n?[2,r]:this.ir[n]?[2,Oe(t,this.ir[n])]:(a=new Promise((function(e){s=function(i,o){n===i&&e(Oe(t,o))},l.or.push(s)})),c=-1,2e3,u=new Promise((function(e){c=window.setTimeout((function(){l.jt.ULS.Ue(560754786,i.B,o.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(n)),e(!1)}),2e3)})),[4,Promise.race([a,u])])):[2,!1];case 1:return d=f.sent(),this.or=this.or.filter((function(e){return e!==s})),window.clearTimeout(c),[2,d]}}))}))},e.prototype.dispose=function(){this.ir={},this.or=[],window.removeEventListener("message",this.rr)},e}();function Oe(e,t){try{if(!e||!t)return!1;for(var n=/[?&#%\\]/,i=0;i<e.length;i+=1){var o=e.charCodeAt(i);if(o<33||o>126)return!1;var r=e.charAt(i);if(n.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var Re=function(){function e(e,t,n,r,s,a,c){var u,d,l=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.skipFileNameCheck=!1,this.appContext={},this.isLoggerFromOwl=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.sr={},this.onMessage=function(e){var t=e.MessageId,n=e.Values||{},r=l.sr[t];if(r&&r.length>0)l.ar(t,n);else{var s=Se[t];if(s){var a=s.Xo,c=s.Zo;a?(l.logger.ULS.Ue(574654543,i.B,o.Info,"Running flow: ".concat(a)),l.cr[a](t,n,l,l.ur[a]).catch((function(e){l.dr(a,e)}))):c&&(c===ve.Share&&(n.sendTimeAsClickTime=e.SendTime),l.raiseEvent(c,n))}}},this.dr=function(e,t){l.logger.ULS.Ue(596459925,i.B,o.Error,"".concat(e," flow error: ").concat(ce(t))),l.remoteTelemetryUrl&&G(l.remoteTelemetryUrl,l.appInfo.name,"flowException")},this.ar=function(e,t){l.logger.ULS.Ue(574654544,i.B,o.Info,"Dispatching action: ".concat(e));for(var n=l.sr[e].slice().reverse(),r=n.length-1;r>-1;r-=1)try{n[r](e,t)}catch(t){l.logger.ULS.Ue(596444186,i.B,o.Error,"".concat(e," action handler error: ").concat(ce(t)))}return Promise.resolve({completion:"success"})},this.state=H.Unknown;var f=Ie(),h=f[0],p=f[1];this.isLoggerFromOwl=!!n.logger,this.logger=null!==(d=n.logger)&&void 0!==d?d:te(),this.logger.ULS.Ue(593506837,i.B,o.Info,JSON.stringify(p)),this.sessionId=h,this.hostSessionId=n.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=r,this.appInfo=t,this.session=s,this.featureManager=ue(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.yt=new ge(t.name,this.logger),this.preloader=t.preloader,u=a(this.featureManager),this.cr=u[0],this.ur=u[1],this.lr=c,this.clientDiagnostics=ye(),this.pageStateObserver=new Ee(this.logger,!0),this.authTokenTrustValidator=new Fe(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.Ue(574654541,i.B,o.Info,"Raising event: ".concat(e));try{this.lr(e,t)}catch(e){this.logger.ULS.Ue(593506838,i.B,o.Error,"Event handler error: ".concat(ce(e)))}},e.prototype.addActionHandler=function(e,t){this.sr[e]||(this.sr[e]=[]),this.sr[e].push(t)},e.prototype.removeActionHandler=function(e,t){var n=this.sr[e];if(n&&n.length>0){var i=n.indexOf(t);i>-1&&n.splice(i,1)}},e.prototype.run=function(e,t,n){var r=this;if(this.state===H.Disposed&&this.backgroundSession)return this.logger.ULS.Ue(525203609,i.B,o.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,n);var s=[],a=this.sr[e];if(a&&a.length>0)s.push(this.ar(e,t));else{var c=Se[e];if(c){var u=c.Xo,d=c.$o;if(u){this.logger.ULS.Ue(574654542,i.B,o.Info,"Running flow: ".concat(u));var l=this.cr[u](e,t,this,this.ur[u],n).catch((function(e){return r.dr(u,e),{completion:"failure",errorSource:"jsapi",error:e}}));s.push(l)}else d&&(this.container&&this.container.postMessage(d,t),s.push(Promise.resolve({completion:"success"})))}else s.push(Promise.resolve({completion:"failure"})),this.logger.ULS.Ue(593500189,i.B,o.Warning,"Unhandled command: ".concat(e))}return Promise.race(s)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.yt.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.sr={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}();var Ue,xe=function(){function e(e,t,n,i,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(n);this.hr=new Re(e,t,n,i,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.hr.state=H.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.hr.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.hr.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,n){return this.hr.run(e,t,n)},e.prototype.boot=function(e,t){return this.hr.run(fe.boot,e,t)},e.prototype.dispose=function(e){return this.hr.run(fe.dispose,void 0,e)},e}();function We(e){if(!e)return"";var t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=t.match(n);return!i||i.length<2?"":i[1]}function ke(e,t,n,i,o){void 0===i&&(i=Ue.none);var r=e+"="+t,s="",a=new Date;a.setTime(a.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*n),c>a&&(c=a),c&&(s=";expires="+c.toUTCString());var u=r+s+(";SameSite="+Ue[i]);return document.cookie=o?u+"; Secure":u,!(!document.cookie||-1===document.cookie.indexOf(r))||i===Ue.none&&ke(e,t,n,Ue.doNotSet,o)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(Ue||(Ue={}));var Me,Ne=function(){function e(e,t,n,r){var s,a,c=this;this.pr="",this.vr="",this.mr=!1,this.wr=!1,this.gr=!1,this.Sr=!1,this.Ir=function(e){var t,n=!1,r=!0,s="",a=!1;if(c.br&&c.br.contentWindow&&(n=!0,r=e.source===c.br.contentWindow),e.origin&&!(a=(s=b(e.origin,2).toLowerCase())===c.vr)&&c._r&&(s=b(e.origin).toLowerCase(),a=c._r.includes(s)),!c.mr&&(!c.wr||a&&r)||c.jt.ULS.Ue(593232850,i.B,o.Info,"Window: available["+n+"] valid["+r+"]; Origin: valid["+a+"] expected["+c.vr+"] actual["+s+"]"),a&&(!c.gr||r)){var u;try{u=JSON.parse(e.data)}catch(e){return void c.jt.ULS.Ue(593232851,i.B,o.Info,"Failed to parse event data: ".concat(ce(e)))}var d=u.MessageId;if(d){if(c.jt.ULS.Ue(593232854,i.B,o.Info,"Received message: ".concat(d,", correlation: ").concat(u.CorrelationId)),d!==he.an&&d!==he.Rn||c.setTargetOrigin(e.origin),u.Values&&u.Values.ackExpected&&c.postMessage(pe.$i,void 0,u.CorrelationId),c.Sr&&d===he.ji)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[u.Values.name]=u.Values.time);if(c.yr)try{c.yr(u)}catch(e){c.jt.ULS.Ue(594556386,i.B,o.Error,"Message handler error: ".concat(ce(e)))}else c.jt.ULS.Ue(591933923,i.B,o.Error,"No message handler")}else(c.mr||c.wr)&&c.jt.ULS.Ue(593232853,i.B,o.Info,"Missing message id")}},this.jt=t,this.setTargetOrigin(e),this._r=r,n&&this.setMessageHandler(n),this.Sr=!!(null===(a=null===(s=window.location)||void 0===s?void 0:s.search)||void 0===a?void 0:a.match(/wdpa=1/gi))||"1"===We("EnableMetricLogging"),window.addEventListener("message",this.Ir,!1)}return e.prototype.setTargetOrigin=function(e){var t=I(e).toLowerCase();this.pr&&this.pr!==t&&this.jt.ULS.Ue(593232847,i.B,o.Warning,"Updating origin: [".concat(R(this.pr),"]->[").concat(R(t),"]")),this.pr=t,this.vr=b(t,2),this.mr=m(t),this.wr=w(t)},e.prototype.setTargetFrame=function(e,t){this.br=e,this.gr=!!t},e.prototype.setMessageHandler=function(e){this.yr=e},e.prototype.removeMessageHandler=function(){this.yr=void 0},e.prototype.postMessage=function(e,t,n){if(this.br&&this.br.contentWindow){this.jt.ULS.Ue(593232849,i.B,o.Info,"Sending message: "+e);var r={MessageId:e,SendTime:$(),CorrelationId:n,Values:t};this.br.contentWindow.postMessage(JSON.stringify(r),this.pr)}else this.jt.ULS.Ue(593232848,i.B,o.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.Ir,!1),this.yr=void 0},e}();!function(e){e.Tr="access_token",e.Cr="access_token_ttl",e.Er="wac_token",e.Ar="bundleSrc",e.Pr="bundleStaleness",e.Fr="DocID",e.Or="SiteID",e.Rr="WebID",e.Ur="ETag",e.xr="feature_status",e.Wr="fileExtension",e.kr="fileGetUrl",e.Mr="customFontCatalogUrl",e.Nr="fileName",e.Hr="fileSize",e.Dr="forceSLR",e.Lr="frameHeightPx",e.Vr="frameWidthtPx",e.Br="highContrast",e.Jr="highDpi",e.jr="host_diagnostics",e.Gr="hostName",e.qr="huictrls",e.zr="owner_id",e.Kr="sc",e.Xr="softBlockedBrowser",e.$r="templateUrl",e.Zr="touchMode",e.Qr="user_id",e.Yr="hfck",e.ts="hfcv",e.ns="timeZoneId",e.os="darkCssMedia",e.ss="caae",e.as="meetingId",e.us="meetingTitle",e.ds="meetingType",e.ls="scheduledStartTime",e.fs="scheduledEndTime",e.hs="isPresenter",e.ps="meetingOrganizerId",e.vs="meetingJoinUrl",e.ms="isMeetingTeamsRoom",e.ws="jsapibuild",e.gs="owlver",e.Ss="owlro",e.Is="caaemode",e.bs="traceparent",e._s="tracestate"}(Me||(Me={}));function He(e,t){c()===r.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function De(e,t,n){_(t,Me.Lr,String(n?window.outerHeight:e.offsetHeight)),_(t,Me.Vr,String(n?window.outerWidth:e.offsetWidth)),_(t,Me.Zr,String(u())),_(t,Me.Br,String(d())),_(t,Me.Dr,String(f())),_(t,Me.os,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}function Le(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.Ue(591525084,i.B,o.Info,"Trust check error: ".concat(ce(t))),!1}}var Ve=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.ys=e,this.Ts=t,this.Cs=t+"_Form",this.Es=Le()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.ys},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.Cs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.Es},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,n,r){var s=this;this.jt=n,this.As=new Ne(e,n,this.yr,r.additionalReceivingDomainList);var a=r.useAdditionalDiv,c=r.permissionsPolicy;this.Ps&&!a?(this.Ps.setAttribute("allow",c),this.jt.ULS.Ue(588793045,i.B,o.Info,"Wac frame reused")):(this.Ps=function(e,t,n,i,o,r,s,a){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var c=e.ownerDocument,u=c.createElement("iframe");if(u.id=t,u.name=t,u.src="",u.title="Office on the web Frame",u.marginWidth="0",u.marginHeight="0",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.display="block",u.style.position="absolute",u.style.backgroundColor="transparent",u.style.border="none",u.frameBorder="0",u.setAttribute("allowfullscreen","true"),u.setAttribute("allowTransparency","true"),u.setAttribute("allow",n),He(u,s),i&&(e.style.minHeight=i,u.style.minHeight=i),o&&(e.style.minWidth=o,u.style.minWidth=o),a&&u.setAttribute("role","none"),r){var d=c.createElement("div");d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.right="0",d.style.height="100%",d.style.width="100%",d.style.backgroundColor="#393a3d",d.style.backfaceVisibility="hidden",i&&(d.style.minHeight=i),o&&(d.style.minWidth=o),d.appendChild(u),e.appendChild(d)}else e.appendChild(u);return u}(this.ys,this.Ts,c,r.minHeight,r.minWidth,a,r.isInvisible,r.setNoneRole),this.jt.ULS.Ue(588793046,i.B,o.Info,"Wac frame created")),this.As.setTargetFrame(this.Ps,r.enforceSameWindow),a&&(this.Fs=this.Ps.parentElement),r.useFrameFixForTeams&&n.ULS.Ue(509143245,i.B,o.Info,"Frame fix enabled for teams uiHost"),De(this.Ps,t,r.useFrameFixForTeams),this.Os=function(e,t,n,i,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=n,s.name=n,s.action=i,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.ys,this.Ts,this.Cs,e,t);try{this.Os.submit()}catch(e){this.jt.ULS.Ue(507909977,i.B,o.Warning,"WAC frame failed to submit, will retry. Error: ".concat(ce(e))),new Promise((function(e){window.setTimeout(e,10)})).then((function(){s.Os.submit()})).catch((function(e){throw s.jt.ULS.Ue(507909976,i.B,o.Error,"WAC frame failed to submit on retry. Error: ".concat(ce(e))),e}))}},e.prototype.setVisibility=function(e){this.Ps&&He(this.Ps,e)},e.prototype.setMessageHandler=function(e){this.yr=e,this.As&&this.As.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.Rs=e},e.prototype.removeMessageHandler=function(){this.yr=void 0,this.As&&this.As.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.Rs?this.Rs(e,t):this.As&&this.As.postMessage(e,t)},e.prototype.dispose=function(e,t){var n=this;return new Promise((function(i){if(n.Os&&(n.ys.removeChild(n.Os),n.Os=void 0),n.As&&(n.As.dispose(),n.As=void 0,n.yr=void 0),n.Rs&&(n.Rs=void 0),n.jt=void 0,!n.Ps||!n.Fs&&e)i();else{var o=function(){n.Fs?(n.Fs.removeChild(n.Ps),n.ys.removeChild(n.Fs)):n.ys.removeChild(n.Ps),n.Ps=void 0,n.Fs=void 0,i()};t?o():(n.Ps.src="about:blank",window.setTimeout(o,0))}}))},e}();var Be=function(){function e(e,t,n){var i,o=this;this.sessions=[],this.containers=[],this.Us=function(e){o.xs.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var n=e.user;if(!n||null==n.id)throw new TypeError("UserInfo")}(e),this.Ws=e,this.ks=t,this.Ms=n,this.xs=new we,(i=e.host.owlVersion)&&(V.BUILD_NUMBER=i)}return Object.defineProperty(e.prototype,"name",{get:function(){return this.ks.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return B()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.xs.add(e)},e.prototype.removeEventListener=function(e){this.xs.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.ks.name,"_").concat(this.containers.length),n=new Ve(e,t);return this.containers.push(n),n},e.prototype.createSession=function(e){var t=new xe(this.Ws,this.ks,e,this,this.Us,this.Ms);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,n=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(n).then((function(e){return t.xs.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}();var Je,je=!1,Ge=!1;function qe(){je=!1}function ze(e,t,n,r,s,a,c){if(t.ULS.Ue(595714433,i.B,o.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(je,"; unloading:").concat(Ge)),je||Ge&&e)t.ULS.Ue(595714908,i.B,o.Info,"Application is already disposed or unloading");else{var u,d={logger:t,postMessenger:n,innerApplicationFrame:r,onDisposed:s,onFrameRemoved:a,unloadTimeoutInMs:c||1e3,forceAppUnload:!1,disposeStartTime:$(),appUnloadTimedOut:!1};if(e&&r)return Ge=!0,d.forceAppUnload=!0,(u=d).forceAppUnloadStartTime=$(),u.logger.ULS.Ue(595855490,i.B,o.Info,"Sending postmessage to unload app"),u.logger.ULS.flush(),u.postMessenger.registerMessagePayloadHandler(he.Yn,(function(e){return function(e,t){e.forceAppUnloadEndTime=$(),e.appUnloadedMessageValues=t,e.logger.ULS.Ue(595855491,i.B,o.Info,"AppUnloaded received from app"),Ke(e)}(u,e)})),u.postMessenger.sendPostMessage(u.innerApplicationFrame,pe.Ho,{}),void window.setTimeout((function(){return function(e){!Ge&&je||(e.appUnloadTimedOut=!0,e.logger.ULS.Ue(595855492,i.B,o.Info,"ApplicationUnload timed out, forcing dispose"),Ke(e))}(u)}),u.unloadTimeoutInMs);Ke(d)}}function Ke(e){if(!je)try{je=!0,Ge=!1,function(e){if(!e.innerApplicationFrame)return;e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0)}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:$(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime);e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime);if(e.appUnloadedMessageValues){var n=e.appUnloadedMessageValues,r=Number(n.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(r)&&(t.hostToAppPostMessageLatency=r-e.forceAppUnloadStartTime);var s=Number(n.appMessageSent);!isNaN(s)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-s);var a=Number(n.appUnloadStart),c=Number(n.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),n.serverTimings){var u=n.serverTimings;for(var d in u)t["st-"+d.toString()]=u[d]}}e.logger.ULS.Ue(595855436,i.B,o.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.Ue(595714434,i.B,o.Error,"Error disposing: ".concat(ce(t)))}}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Je||(Je={}));function Xe(e,t){var n=t?"?usid="+t:"";return e+"_layouts/RemoteTelemetry.ashx"+n}function $e(e,t){return Xe(Qe(e),t)}function Ze(e,t,n,i,o,r){void 0===r&&(r=!1),e.SessionInformation.IsCore&&(e.SessionInformation.HideViewerToolbar=!0),function(e,t){var n=e.SessionInformation;n.WdParams||(n.WdParams={});if(n.WdParams.wd)return;t.substring(1).split("&").filter((function(e){if(0===e.indexOf("wd")){var t=e.split("=");t[0].length>2&&(n.WdParams[t[0]]=t[1])}}));var i=e.RebootOverrideData;i&&i.previousSessionId&&(n.WdParams.wdprevioussession=i.previousSessionId)}(e,window.location.search);var s=o||new ge("Excel",n),a=Qe(e.ApplicationUrl);return{container:e.Container,sessionInformation:e.SessionInformation,applicationUrl:e.ApplicationUrl,wopiPrecheckInfo:e.WopiPrecheckInfo,applicationCustomSettings:e.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:e.Diagnostics,ClientDiagnostics:ye(),AppInitDiagnostics:{officeSessionId:t,officeBootstrapperVersion:B(),hostName:e.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:e.FnOnInitializeSuccess,fnOnInitializeFailure:e.FnOnInitializeFailure,sessionId:t,applicationBasePath:a,remoteTelemetryUrl:Xe(a,t),wopiInfo:e.WopiInfo,forceSingleStepBoot:r,isCreateNew:e.WopiPrecheckInfo.IsNewFile||F(e.ApplicationUrl,"new"),featureManager:i||ue(e.FnIsFeatureEnabled,n),yt:s,newFileTemplateSource:e.NewFileTemplateSource,rebootOverrideData:e.RebootOverrideData,pageStateObserver:new Ee(n,!0)}}function Qe(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function Ye(e,t){t&&t.Diagnostics&&Object.keys(t.Diagnostics).forEach((function(n){return e[n]=t.Diagnostics[n]}))}function et(e,t,n){t.ULS.Ue(596459999,i.B,n,"SessionTraces: "+JSON.stringify(e))}function tt(e,t){t.stop();var n=t.getVisibilityChangeEvents();null!=n&&n.length>0&&(e.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,e.SessionTraces.tabSwitchDiagnostics=JSON.stringify(n)),t.dispose()}function nt(e,t,n){try{var r=function(e,t){var n=ne({},t);delete n.UserId,delete n.OwnerId,delete n.SiteId,delete n.WebId,delete n.Upn,delete n.TenantId,delete n.UiHostTabId,delete n.OriginalWdParam,delete n.WdParams;var i=n,o=t.WdParams?JSON.parse(JSON.stringify(t.WdParams).toLowerCase()):{};i.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){o[e]&&(i.WdParams[e]=o[e])}));var r=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;return i.WdParams.wdprevioussession&&!r.test(i.WdParams.wdprevioussession)&&delete i.WdParams.wdprevioussession,i.WdParams.wdpreviouscorrelation&&!r.test(i.WdParams.wdpreviouscorrelation)&&delete i.WdParams.wdpreviouscorrelation,i.UiEmbedMode=F(e,"uiembed"),i.UiHostName=T(e,"uih")||"N/A",i.HostDomain=location?location.hostname:"",i}(t.applicationUrl,t.sessionInformation);r.Build=B(),r.Region=g(t.applicationUrl);var s=ne({},t.rebootOverrideData);delete s.ackExpected,delete s["ui-language"],delete s.wdUserSession,delete s.rebootMode,delete s.documentUrl,r.RebootOverride=s;var a=t.diagnostics.HostInitDiagnostics;a&&(e.ULS.Ue(596444238,i.B,o.Info,"HostInitDiagnostics: "+JSON.stringify(t.diagnostics.HostInitDiagnostics)),r.SessionOrigin=a.entryPoint),n&&e.ULS.Ue(595937313,i.B,o.Info,JSON.stringify(n)),e.ULS.Ue(595632928,i.B,o.Info,function(){if(window&&window.navigator){var e=window.navigator,t=e.connection||e.mozConnection||e.webkitConnection;if(t)return"EffectiveType: "+t.effectiveType+", BandwidthMps: "+t.downlink+", ConnectionType: "+t.type}return""}());var c=t.wopiInfo;c&&c.AccessToken&&c.AccessTokenExpiry||e.ULS.Ue(595894553,i.B,o.Warning,"There are some missing parameters"),c&&(c.AccessToken&&(r.AccessTokenLength=c.AccessToken.length),r.AccessTokenExpiry=c.AccessTokenExpiry,c.WacToken&&(r.WacTokenLength=c.WacToken.length)),r.JsApiVersion="v1",e.ULS.Ue(596444237,i.B,o.Info,JSON.stringify({session:r,client:t.diagnostics.ClientDiagnostics}))}catch(t){e.ULS.Ue(558155802,i.B,o.Error,"Failed to log initialization info: ".concat(ce(t)))}}function it(e){return new RegExp("xlviewerinternal.aspx","i").test(e)}function ot(e){return new RegExp("xlembed.aspx","i").test(e)}function rt(e){return new RegExp("xlpreview.aspx","i").test(e)}var st,at,ct,ut,dt,lt,ft,ht,pt,vt;function mt(e,t,n,r){lt=e,ft=t,ht=void 0,pt=n,vt=r,st=!1,at=!1,ct=0,It(),setTimeout((function(){lt.ULS.Ue(593589517,i.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver heartbeat signal called after ms: 3000")}),3e3),setTimeout((function(){!function e(){if(ct>=3)return void lt.ULS.Ue(595350870,i.B,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Max Limit reached for retry attempts3");if(It(),st)setTimeout((function(){(!at||ct>0)&&lt.ULS.Ue(595350872,i.B,o.Info,"ExcelLandingPageObserver: checkSecondFlushArrived Second Flush status: "+at+" after first flush retry attempt: "+ct)}),dt);else{if(ct+=1,lt.ULS.Ue(595350871,i.B,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Retry Request: "+ct),pt&&pt.isFeatureEnabled(se.At)&&1===ct)document.getElementById(ft).submit();setTimeout((function(){e()}),ut)}}()}),ut),pt&&pt.isFeatureEnabled(se.Et)&&(window.localStorage?window.addEventListener("offline",bt):lt.ULS.Ue(593589518,i.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver localstorage not supported by Browser. Skip saving in cache")),lt.ULS.Ue(594622165,i.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver called with OfflineTelemetry: "+"".concat(pt?pt.isFeatureEnabled(se.Et):"False [featureManager undefined]"))}function wt(e){"PageLoadSkeleton Presented"===e?st=!0:"BootstapContext Recieved"===e&&(at=!0)}function gt(){if(pt&&pt.isFeatureEnabled(se.Et))if(window.localStorage)for(var e=0;e<localStorage.length;e+=1)try{var t=localStorage.key(e);if("OfflineMode_"===t.substring(0,"OfflineMode_".length)){var n=localStorage.getItem(t);lt.ULS.Ue(593589520,i.B,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry Message"+n),localStorage.removeItem(t)}}catch(e){lt.ULS.Ue(593589521,i.B,o.Error,"ExcelLandingPageObserver:uploadOfflineModeTelemetry exception during loading from cache. Exception: "+ce(e))}else lt.ULS.Ue(593589519,i.B,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry localstorage not supported by Browser. Skip uploading")}function St(e){return it(e)||ot(e)}function It(){ut=3750,dt=6e3;var e=function(){if(window&&window.navigator){var e=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return e?e.effectiveType:void 0}}();if(void 0!==e)switch(void 0!==ht&&ht!==e&&lt.ULS.Ue(595350873,i.B,o.Info,"ExcelLandingPageObserver: initializeTimeOutIntervals previousConnection: "+ht+" currentConnection: "+e+" First Flush: "+st+" Second Flush:"+at),ht=e,e){case"4g":ut=3750,dt=6e3;break;case"3g":ut=5e3,dt=8e3;break;case"2g":ut=1e4,dt=24e3;break;case"slow-2g":ut=2e4,dt=4e4}}function bt(){try{var e=$(),t="OfflineMode_"+vt+"_"+e,n={"Sessionid:":vt,OfflineTime:e};localStorage.setItem(t,JSON.stringify(n))}catch(e){lt.ULS.Ue(593589522,i.B,o.Error,"ExcelLandingPageObserver:logOfflineModeTelemetry exception during saving into cache exception: "+ce(e))}}var _t,yt;function Tt(e,t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0),_t=e;try{if(window.localStorage)if(n){n.addActionHandler(he.li,(function(e,t){Et(t)}));n.addActionHandler(he.hi,(function(e,t){At(t)}))}else t&&(t.registerMessagePayloadHandler(he.li,(function(e){Et(e)})),t.registerMessagePayloadHandler(he.hi,(function(e){At(e)})));else _t.ULS.Ue(574677217,i.B,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){_t.ULS.Ue(574677218,i.B,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: error while initializing.")}}function Ct(e,t,n){try{_t||(_t=e);var r="".concat(t[Me.Fr],"_").concat(n,"_").concat(t[Me.Gr],"_").concat(t[Me.Qr]);if(r="XlHc_"+function(e){var t=0,n=e.length,i=0;if(n>0)for(;i<n;)t=(t<<5)-t+e.charCodeAt(i)|0,i+=1;return t}(r),t[Me.Yr]=r,window.localStorage){var s=localStorage.getItem(r);null!==s&&(t[Me.ts]=s)}else _t.ULS.Ue(574677219,i.B,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){_t.ULS.Ue(574677248,i.B,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: error while setting host frame cache post data.")}}function Et(e){if(e&&e.hasOwnProperty("cacheItemKey")&&0===e.cacheItemKey.indexOf("XlHc_")&&e.hasOwnProperty("cacheItemValue"))try{window.localStorage.setItem(e.cacheItemKey,e.cacheItemValue),_t.ULS.Ue(574677249,i.B,o.Info,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: setting localstorage HostFrame cache item")}catch(e){_t.ULS.Ue(574677250,i.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: error while saving HostFrame to local storage. error: "+ce(e))}else _t.ULS.Ue(574677251,i.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: HostFrame cache save message does not contain all expected values, skipping HostFrame cache save")}function At(e){if(e&&e.hasOwnProperty("workbookList")&&e.hasOwnProperty("evictAllExceptListed"))try{var t=e.evictAllExceptListed,n=JSON.parse(e.workbookList);_t.ULS.Ue(574677252,i.B,o.Info,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: removing items from cache. workbookList length: "+n.length+", evictAllExceptListed: "+t),!0===t?function(e){for(var t=new Date,n=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()).getTime(),r=0;r<localStorage.length;r+=1){var s=localStorage.key(r),a=!1;if(0===s.indexOf("XlHc_")){if(e.indexOf(s)<0)a=!0;else{var c=localStorage.getItem(s),u=void 0;try{u=JSON.parse(c)}catch(e){_t.ULS.Ue(574677255,i.B,o.Warning,"ExcelHostFrameCacheManager: evictAllItemsExcept: unable to check for stale HostFrame cache, error parsing HostFrame cache item, error: "+ce(e))}if(u)n-u.LastModified>5184e6&&(a=!0);else a=!0}a&&(localStorage.removeItem(s),_t.ULS.Ue(574677256,i.B,o.Verbose,"ExcelHostFrameCacheManager: EvictAllItemsExcept: Removed HostFrame cache item"))}}}(n):function(e){for(var t=0;t<e.length;t+=1)localStorage.removeItem(e[t]),_t.ULS.Ue(574677257,i.B,o.Verbose,"ExcelHostFrameCacheManager: EvictSpecificItems: Removed HostFrame cache item")}(n)}catch(e){_t.ULS.Ue(574677253,i.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: error while evicting HostFrame from local storage. error: "+ce(e))}else _t.ULS.Ue(574677254,i.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: HostFrame cache evict message does not contain all expected values")}function Pt(e,t){var n={isSingleStepBoot:e.forceSingleStepBoot,bootFlowType:e.forceSingleStepBoot?yt.forceSingleStepBoot:yt.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(e.forceSingleStepBoot||(n=function(e,t){var n=e.applicationUrl,r=it(n),s=ot(n),a=rt(n),c={isSingleStepBoot:!0,bootFlowType:yt.forceSingleStepBoot,ignoreWacFramePostMessages:!(r||s)};return r||s||a||t.ULS.Ue(553673219,i.B,o.Warning,"Unknown endpoint: ".concat(A(n))),c}(e,t)),n.isSingleStepBoot){var r={singleStepBootIsRequired:!0,singleStepBootReason:n.bootFlowType,irmEnabled:e.wopiPrecheckInfo.IrmEnabled,readOnly:e.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:n.ignoreWacFramePostMessages};t.ULS.Ue(596444182,i.B,r.irmEnabled?o.Warning:o.Info,JSON.stringify(r))}else t.ULS.Ue(596444183,i.B,o.Info,"Received input valid for two step flow");return n}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(yt||(yt={}));var Ft;function Ot(e,t,n,i,o,r,s){var a=function(e,t,n){var i=e.ownerDocument.createElement("iframe");i.name=n||"WebApplicationFrame",i.id="WebApplicationFrame",i.src="",i.title="Office Online Frame",i.width="100%",i.height="100%",i.marginWidth="0",i.marginHeight="0",i.style.left="0",i.style.top="0",i.style.right="0",i.style.bottom="0",i.style.display="block",i.style.position="absolute",i.style.backgroundColor="transparent",i.style.border="none",i.frameBorder="0",i.setAttribute("allowfullscreen","true"),i.setAttribute("allowTransparency","true");var o=I(t);return i.setAttribute("allow","microphone ".concat(o,"; autoplay ").concat(o,"; camera ").concat(o,"; clipboard-read ").concat(o,"; clipboard-write ").concat(o,"; keyboard-map ").concat(o,"; display-capture ").concat(o)),e.appendChild(i),i}(e,t,s);return St(t)&&mt(o,"office_form",i,r),Ct(o,n,""),function(e,t,n,i){De(e,i);var o=t.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=n,r.target=e.name,r.method="POST",i){var a=o.createElement("input");a.type="hidden",a.name=s,a.value=i[s],r.appendChild(a)}return t.appendChild(r),r.submit(),e}(a,e,t,n)}function Rt(e,t,n){void 0===n&&(n=!1);var i=e.applicationUrl;e.wopiPrecheckInfo.IsNewFile&&i.replace("unified=1","edit=1&new=1");var o={};if("Microsoft Teams"===e.sessionInformation.HostName&&(o.fvo="1",e.yt.getValue(Q.pt,!1)&&(o.readOnly="1")),o.jsApi="1",o.jsapiver="v1",n&&(o.NewSession="1"),o.corrid=e.sessionId,o.usid=e.sessionId,o.sftc="1",(e.applicationCustomSettings&&e.applicationCustomSettings.IsCore||e.sessionInformation.IsCore)&&(o.core="1"),e.sessionInformation.HideViewerToolbar&&(o.hvt="1"),e.sessionInformation.HideEditUpsellDialog&&(o.hdeditdlg="1"),e.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),e.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(e.sessionInformation.HighContrastMode)),e.sessionInformation.SupportsAtMentions&&(o.sams="1"),e.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),e.sessionInformation.SupportsDocReboot){var r=e.sessionInformation.SupportsDocReboot;o.sdr=!0===r?"1":r.toString()}e.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),e.sessionInformation.SupportsAuthToken&&(o.sat="1"),e.sessionInformation.SupportsCustomAuthConfig&&(o.cac="1"),e.sessionInformation.SupportsMoveToFolder&&(o.mtf="1"),e.sessionInformation.SupportsCommonFilePicker&&(o.sfp="1"),e.sessionInformation.OpenLinksInNewWindow&&(o.onw="1"),e.sessionInformation.UseDarkTheme&&(o.udt="1"),e.sessionInformation.SupportsExcelExternalLinks&&(o.xlel="1"),e.sessionInformation.SupportsRefreshAccessToken&&(o.rat="1"),(e.sessionInformation.HideHeader||"DocGen"===e.sessionInformation.ContentAssemblyMode||"Templatization"===e.sessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.sessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.sessionInformation.ContentAssemblyMode)&&(o.hhdr="1"),e.sessionInformation.HideAppLauncherInHeader&&(o.halh="1"),e.sessionInformation.HideChatInHeader&&(o.hch="1"),e.sessionInformation.HideMeInHeader&&(o.hmh="1"),e.sessionInformation.HideSearchInHeader&&(o.hsh="1"),e.sessionInformation.HideWorkflowInHeader&&(o.hwfh="1"),e.sessionInformation.HideSettingsInHeader&&(o.hsth="1"),e.sessionInformation.ShowAppIconInHeader&&(o.sih="1"),e.sessionInformation.UseNeutralColorInHeader&&(o.unh="1"),e.sessionInformation.HideBreadCrumbInViewer&&(o.hbcv="1"),e.sessionInformation.HideTitleInViewer&&(o.htv="1"),e.sessionInformation.HideWACOneDriveFileLocationPicker&&(o.hodflp="1"),e.sessionInformation.NoBrowserModalDialogs&&(o.nbmd="1"),e.applicationCustomSettings&&e.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),e.wopiPrecheckInfo.ReadOnly&&(o.readOnly="1"),"DocGen"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.sessionInformation.ContentAssemblyMode||(o.readOnly="1"),e.sessionInformation.UIEmbed&&(o.uiEmbed="1"),e.sessionInformation.IsSynthetic&&(o.syn="1"),e.sessionInformation.SupportsDirectDownload&&(o.sdd="1"),e.sessionInformation.SupportsDirectPrint&&(o.sdp="1"),e.sessionInformation.UiHostIntegrationType&&(o.uihit=encodeURIComponent(e.sessionInformation.UiHostIntegrationType)),e.sessionInformation.MetaUiHostVersion&&(o.muv=encodeURIComponent(e.sessionInformation.MetaUiHostVersion)),e.applicationCustomSettings&&e.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),t.isSingleStepBoot?(t.bootFlowType===yt.unifiedSingleFlush&&(e.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=t.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(e.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(I(window.location.href)),e.isCreateNew&&(o.new="1",e.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),e.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(e.wopiPrecheckInfo.PreseededSessionKey)),e.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(e.wopiPrecheckInfo.PreseededWacSessionId)),e.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=e.wopiPrecheckInfo.RequestedCallThrottling),e.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=e.wopiPrecheckInfo.ClientThrottlingProtection);var s=e.wopiPrecheckInfo.FileSize;return s&&s>=52428800&&s<=104857600&&(o.ilf="1"),e.applicationCustomSettings&&e.applicationCustomSettings.additionalApplicationParameters&&(o=ne(ne({},e.applicationCustomSettings.additionalApplicationParameters),o)),e.rebootOverrideData&&e.rebootOverrideData.queryOverrides&&(o=ne(ne({},o),e.rebootOverrideData.queryOverrides)),function(e,t,n,i,o){var r=E(e);("teams"===r.uih&&"UnifiedUiHostTeams"!==t.UiHostIntegrationType&&"TeamsModern"!==t.UiHostIntegrationType||"owa"===r.uih)&&(r.hhdr="1");var s=e.indexOf("?"),a=-1===s?e.concat("?"):e.substring(0,s+1);t.UiLocale&&(r.ui=encodeURIComponent(t.UiLocale));t.DataLocale&&(r.rs=encodeURIComponent(t.DataLocale));t.HostSessionId&&(r.hid=encodeURIComponent(t.HostSessionId));t.DisableChat&&(r.dchat="1");t.SessionContext&&(r.sc=encodeURIComponent(t.SessionContext));n&&n.WopiSrc&&(r.wopisrc=encodeURIComponent(n.WopiSrc));t.CookieCompliant&&(r.mscc="1");i&&(i.entryPoint&&(r.wdorigin=encodeURI(i.entryPoint)),i.userClickTime&&(r.wdhostclicktime=i.userClickTime.toString()));r=ne(ne(ne({},r),t.WdParams),o);var c={};for(var u in r)c[u.toLowerCase()]=r[u];var d=[];for(var u in c)c[u]&&d.push(u.concat("=",c[u]));return a.concat(d.join("&"))}(i,e.sessionInformation,e.wopiInfo,e.diagnostics.HostInitDiagnostics,o)}function Ut(e){return e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0"}var xt=((Ft={})[fe.blurFocus]=pe.Yi,Ft[fe.continueAccessibilityLoop]=pe.oo,Ft[fe.grabFocus]=pe.so,Ft[fe.moveToFolder]=pe.xn,Ft[fe.popState]=pe.lo,Ft[fe.rename]=pe.bo,Ft[fe.sendAccessToken]=pe._o,Ft[fe.sendAuthToken]=pe.yo,Ft[fe.sendCustomAuthConfig]=pe.To,Ft[fe.sendEmbeddedViewUrl]=pe.Eo,Ft[fe.sendSessionInfo]=pe.Ao,Ft[fe.sendUserAccessAndPermissions]=pe.Po,Ft[fe.sendWopiInfo]=pe.Fo,Ft[fe.sendDavUrl]=pe.Oo,Ft[fe.completeSharedFilePicker]=pe.Gn,Ft[fe.switchMode]=pe.No,Ft[fe.signalShared]=pe.Vo,Ft),Wt=function(){function e(e,t){var n,r,s=this;if(this.Ns=!1,this.Hs={},this.pr="",this.vr="",this.gr=!1,this.mr=!1,this.wr=!1,this.Sr=!1,this.Ds=[],this.Ls=!0,this.Vs=function(e,t,n){if(e){var r={MessageId:pe.$i,CorrelationId:n,SendTime:$()};s.jt.ULS.Ue(595732176,i.B,o.Info,"Sending Ack back"),e.postMessage(JSON.stringify(r),t)}else s.jt.ULS.Ue(595736136,i.B,o.Info,"Missing target to send Ack back")},this.Bs=function(e){var t,n=!1,r=!0,a="",c=!1;if(s.Js&&s.Js.contentWindow&&(n=!0,r=e.source===s.Js.contentWindow),e.origin&&!(c=(a=b(e.origin,2).toLowerCase())===s.vr)&&s._r&&(a=b(e.origin).toLowerCase(),c=s._r.includes(a)),!s.mr&&(!s.wr||c&&r)||s.jt.ULS.Ue(595730526,i.B,o.Info,"Window is available: ".concat(n,", window is valid: ").concat(r,", origin is valid: ").concat(c,", expected origin: ").concat(s.vr,", actual origin: ").concat(a)),c&&(!s.gr||r)){var u;try{u=JSON.parse(e.data)}catch(e){return void s.jt.ULS.Ue(596464282,i.B,o.Info,"Failed to parse event data: ".concat(ce(e),"."))}var d=u.MessageId;if(d){if(s.jt.ULS.Ue(595714715,i.B,o.Info,"Received messageId: ".concat(d,", correlation: ").concat(u.CorrelationId)),d!==he.an&&d!==he.Rn||s.js(e.origin),s.Sr&&d===he.ji)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[u.Values.name]=u.Values.time);u.Values&&u.Values.ackExpected&&s.Vs(e.source,e.origin,u.CorrelationId);var l=s.Hs[d];if(!l)return s.jt.ULS.Ue(596464289,i.B,o.Info,"No handler found for message id: ".concat(d)),void(s.Ls&&d===he.En&&(s.Ds.push(u),s.jt.ULS.Ue(543207888,i.B,o.Info,"Kept for later process: ".concat(d))));s.jt.ULS.Ue(596464288,i.B,o.Info,"Processing message: ".concat(d)),d===he.Xn&&(u.Values=ne(ne({},u.Values||{}),{sendTimeAsClickTime:u.SendTime}));try{l(u.Values||{})}catch(e){s.jt.ULS.Ue(593773704,i.B,o.Error,"Handler error: ".concat(ce(e)))}s.Ls&&d===he.an&&s.Gs()}else(s.mr||s.wr)&&s.jt.ULS.Ue(595730520,i.B,o.Info,"Could not find message id")}},this.Gs=function(){s.Ls=!1,s.Ds.forEach((function(e){var t=e.MessageId,n=s.Hs[t];if(n){s.jt.ULS.Ue(543207890,i.B,o.Info,"Processing message after boot complete: ".concat(t));try{n(e.Values||{})}catch(e){s.jt.ULS.Ue(543207891,i.B,o.Error,"Handler error: ".concat(ce(e)))}}else s.jt.ULS.Ue(543207889,i.B,o.Info,"No handler found after boot complete: ".concat(t))})),s.Ds=[]},this.qs=function(e,t,n){e.postMessage(t,n)},this.js=function(e){var t=e.toLowerCase();s.pr&&s.pr!==t&&s.jt.ULS.Ue(596128131,i.B,o.Warning,"Updating origin: [".concat(R(s.pr),"]->[").concat(R(t),"]")),s.pr=t,s.vr=b(t,2),s.mr=m(t),s.wr=w(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.mr=m(e),this.wr=w(e),this.jt=t,this.js(e),this.Sr=!!(null===(r=null===(n=window.location)||void 0===n?void 0:n.search)||void 0===r?void 0:r.match(/wdpa=1/gi))||"1"===We("EnableMetricLogging")}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.Hs[e])throw new Error("Duplicate registration!");this.Hs[e]=t},e.prototype.removeMessageHandler=function(e){delete this.Hs[e]},e.prototype.sendPostMessage=function(e,t,n){if(e&&e.contentWindow){this.jt.ULS.Ue(596464334,i.B,o.Info,"Sending message: "+t);var r={MessageId:t,SendTime:$(),Values:n};this.qs(e.contentWindow,JSON.stringify(r),this.pr)}else this.jt.ULS.Ue(595948308,i.B,o.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.Js=e,this.gr=!!t,this.Ns||(window.addEventListener("message",this.Bs,!1),this.Ns=!0)},e.prototype.postMessageForCommand=function(e,t,n){var r=xt[t];r?(this.jt.ULS.Ue(595702598,i.B,o.Info,"Sending message ".concat(r," for command ").concat(t)),this.sendPostMessage(e,r,n)):this.jt.ULS.Ue(595702599,i.B,o.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.Hs={},this.Ns&&(window.removeEventListener("message",this.Bs,!1),this.Ns=!1)},e}();var kt=function(){function e(e,t,n,i,o){this.zs=0,this.Ks=[],this.mr=!1,this.mr=e,this.Xs=t,this.jt=n,this.$s=i,this.Zs=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.Xs.getValue(Q.et,!1);this.zs=X()+(this.Zs?this.Zs:this.Xs.getValue(Q.qe,6e5));var n=this.mr?3e3:5e3;this.Qs=window.setInterval((function(){t&&e.jt.ULS.Ue(595724178,i.B,o.Info,"Boot_HeartBeat"),X()>e.zs&&(e.stop(),Mt(e.jt),e.$s&&e.$s())}),this.Xs.getValue(Q.Ye,n)),this.Ks.push(window.setTimeout(Mt,this.Xs.getValue(Q.ze,6e4),this.jt,1)),this.Ks.push(window.setTimeout(Mt,this.Xs.getValue(Q.Ke,18e4),this.jt,2))},e.prototype.stop=function(){this.zs=0,this.Qs&&(window.clearInterval(this.Qs),this.Qs=void 0),this.Ks.forEach((function(e){window.clearTimeout(e)})),this.Ks=[]},e}();function Mt(e,t){e.ULS.Ue(594901218,i.B,o.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}function Nt(e){localStorage.setItem(e.flightKey,e.flightValue.toString())}var Ht=function(e,t,n,r,s){return e!==he.Xi?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.flightKey,s=t.flightValue;n.logger.ULS.Ue(507343134,i.be,o.Info,"setWacFlightValue ".concat(r,": ").concat(s)),Nt(t),e({completion:"success"})}))};function Dt(e){var t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)return t.virtualKeyboard.overlaysContent=e}var Lt=function(e,t,n,i,o){return e!==he.Kn?Promise.reject("Wrong flow"):new Promise((function(e){Dt(t.overlayContent),n.container&&n.container.postMessage(pe.Wo,void 0),e({completion:"success"})}))};function Vt(e){return We(e.hostKey)}var Bt=function(e,t,n,r,s){return e!==he.Pn?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.hostKey;n.logger.ULS.Ue(574408915,i.B,o.Info,"getHostKeyValue ".concat(r));var s=Vt(t);n.container&&s&&n.container.postMessage(pe.co,{hostKey:r,hostValue:s}),e({completion:"success"})}))};function Jt(e){ke(e.hostKey,e.hostValue,365)}var jt=function(e,t,n,r,s){return e!==he.Qn?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.hostKey,s=t.hostValue;n.logger.ULS.Ue(574408914,i.B,o.Info,"storeHostKeyValue ".concat(r,": ").concat(s)),Jt(t),e({completion:"success"})}))},Gt=function(){function e(e,t,n,r,s,a){var c=this;if(this.Ys=!1,this.ea=function(e,t){c.ta.officeFrameCreateTime=$(),c.na.frameCreateStartTime=c.ta.officeFrameCreateTime;var n=c.ia.applicationCustomSettings&&c.ia.applicationCustomSettings.appFrameName;c.Js=Ot(c.ia.container,e,t,c.ia.featureManager,c.jt,c.ia.sessionId,n),c.oa.activate(c.Js)},this.ra=function(e){c.oa.registerMessagePayloadHandler(he.an,c.sa),c.oa.registerMessagePayloadHandler(he.rn,c.aa),c.Ge=window.setTimeout(c.ca,15e3),c.ua=new kt(e,c.ia.yt,c.jt,(function(){G(c.ia.remoteTelemetryUrl,"Excel","bootTimeout")}))},this.la=function(e){var t=e.flightKey,n=e.flightValue;c.jt.ULS.Ue(507343133,i.be,o.Info,"storeWacFlightKeyValue ".concat(t,": ").concat(n));try{Nt(e)}catch(e){c.jt.ULS.Ue(507340380,i.be,o.Error,"Handler error: ".concat(ce(e)))}},this.fa=function(e){var t=e&&e.state?e.state:"unknown";c.jt.ULS.Ue(595714271,i.B,o.Info,"WAC Boot App state:[".concat(t,"]")),wt(t)},this.ha=function(e){var t=Le(c.jt);c.jt.ULS.Ue(595653903,i.B,o.Info,"Top frame is trusted: ".concat(t)),c.pa(pe.Tn,{isTopFrameTrusted:t})},this.va=function(e){var t=Dt(e&&e.overlayContent);c.jt.ULS.Ue(587487432,i.B,o.Info,"Overlay content: ".concat(t)),c.pa(pe.Wo,void 0)},this.sa=function(e){if(c.jt.ULS.Ue(595986314,i.B,o.Info,"Received wac complete message"),c.jt.ULS.flush(),window.clearTimeout(c.Ge),c.ua&&c.ua.stop(),gt(),c.Ys)c.jt.ULS.Ue(596444234,i.B,o.Info,"Received multiple wac complete or failure messages");else{c.Ys=!0,c.pa(pe.to,{}),Ye(c.ta,e);var t=c.ma();c.wa(t),c.ia.yt.getValue(Q.st,!1)&&(c.ia.diagnostics.HostInitDiagnostics||(c.ia.diagnostics.HostInitDiagnostics={}),Ce(c.ia.diagnostics.HostInitDiagnostics)),c.ga(c.ia.diagnostics)}},this.Sa=function(){c.jt.ULS.Ue(579342464,i.B,o.Info,"Received close tab message");try{window.close()}catch(e){c.jt.ULS.Ue(579213188,i.B,o.Warning,"Failed to close the browser tab")}},this.ma=function(){return{innerApplicationFrame:c.Js}},this.aa=function(e){if(c.jt.ULS.Ue(595986315,i.B,o.Error,"Received wac failed message"),c.jt.ULS.flush(),window.clearTimeout(c.Ge),c.ua&&c.ua.stop(),c.Ys)c.jt.ULS.Ue(596444235,i.B,o.Info,"Received multiple wac complete or failure messages");else{c.Ys=!0,c.pa(pe.eo,{});var t={errorType:Je.WacFailed,errorObject:{}};e&&(t.errorObject=e.Error,c.na.error=t),c.Ia(t)}},this.ba=function(e){var t=e.hostKey;c.jt.ULS.Ue(574433173,i.B,o.Info,"GetHostKeyValue ".concat(t));var n=Vt(e);null!=n&&c.pa(pe.co,{hostKey:t,hostValue:n})},this._a=function(e){var t=e.hostKey,n=e.hostValue;c.jt.ULS.Ue(574433174,i.B,o.Info,"storeHostKeyValue ".concat(t,": ").concat(n)),Jt(e)},this.ca=function(){c.Ys||c.jt.ULS.Ue(596444236,i.B,o.Warning,"Timeout. SessionTraces:"+JSON.stringify(c.na))},this.ga=function(e){c.pa(pe.uo,{HostInitializeDiagnostics:e.HostInitDiagnostics,ClientDiagnostics:e.ClientDiagnostics})},this.pa=function(e,t){c.Js&&c.Js.contentWindow?c.oa.sendPostMessage(c.Js,e,t):c.jt.ULS.Ue(595955718,i.B,o.Info,"Attempted to send postmessage: "+e)},void 0===t)throw new TypeError("bootFlowInfo");if(t.isSingleStepBoot&&void 0===e.wopiInfo)throw new TypeError("wopiInfo");this.ia=e,this.ya=t,this.jt=n,this.oa=r,this.wa=s,this.Ia=a,this.ta=e.diagnostics.AppInitDiagnostics,this.na=e.diagnostics.SessionTraces,this.na.wopiInitializeTime=$()}return e.prototype.Boot=function(){this.jt.ULS.Ue(596444241,i.B,o.Info,"Initializing WAC frame");var e=Rt(this.ia,this.ya,!0),t=function(e,t){var n={};if(e.wopiInfo&&(n[Me.Tr]=e.wopiInfo.AccessToken,n[Me.Cr]=Ut(e.wopiInfo),e.wopiInfo.WacToken&&(n[Me.Er]=e.wopiInfo.WacToken)),e.wopiPrecheckInfo.BundleInfo&&e.wopiPrecheckInfo.BundleInfo.Url&&e.wopiPrecheckInfo.BundleInfo.Url.length>0)if(n[Me.Ar]=e.wopiPrecheckInfo.BundleInfo.Url,null!=e.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==e.wopiPrecheckInfo.BundleInfo.BundleStaleness){var r=e.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();t.ULS.Ue(593503580,i.B,o.Info,"Content bundle staleness - "+r),n[Me.Pr]=r}else t.ULS.Ue(593503581,i.B,o.Info,"Content bundle staleness does not exist");if(e.wopiPrecheckInfo.FileGetUrl&&(n[Me.kr]=e.wopiPrecheckInfo.FileGetUrl),e.wopiPrecheckInfo.CustomFontCatalogUrl&&(n[Me.Mr]=e.wopiPrecheckInfo.CustomFontCatalogUrl),e.wopiPrecheckInfo.FileName){var s=ae(e.wopiPrecheckInfo.FileName);s&&(n[Me.Wr]=s),n[Me.Nr]=e.wopiPrecheckInfo.FileName}e.newFileTemplateSource&&e.newFileTemplateSource.FileSize?n[Me.Hr]=e.newFileTemplateSource.FileSize.toString():e.wopiPrecheckInfo.FileSize&&(n[Me.Hr]=e.wopiPrecheckInfo.FileSize.toString()),e.sessionInformation.UserId&&(n[Me.Qr]=e.sessionInformation.UserId),e.sessionInformation.OwnerId&&(n[Me.zr]=e.sessionInformation.OwnerId),e.sessionInformation.SessionContext&&(n[Me.Kr]=e.sessionInformation.SessionContext),e.diagnostics.HostInitDiagnostics&&(n[Me.jr]=JSON.stringify({HostInitializeDiagnostics:e.diagnostics.HostInitDiagnostics,ClientDiagnostics:e.diagnostics.ClientDiagnostics})),n[Me.xr]=de(e.featureManager,e.sessionInformation.WdParams),e.applicationCustomSettings&&e.applicationCustomSettings.HostUIControls&&(n[Me.qr]=JSON.stringify(e.applicationCustomSettings.HostUIControls)),n[Me.Jr]=String(window.devicePixelRatio>1.24),n[Me.Xr]=String(l()),n[Me.Gr]=e.sessionInformation.HostName;var a=e.newFileTemplateSource;a&&a.FileGetUrl&&(n[Me.$r]=a.FileGetUrl),a&&a.DocUniqueId?n[Me.Fr]=a.DocUniqueId:e.wopiPrecheckInfo.DocUniqueId&&(n[Me.Fr]=e.wopiPrecheckInfo.DocUniqueId),a&&a.ETag?n[Me.Ur]=a.ETag:e.wopiPrecheckInfo.ETag&&(n[Me.Ur]=e.wopiPrecheckInfo.ETag),n[Me.ns]=(new Intl.DateTimeFormat).resolvedOptions().timeZone,"Templatization"!==e.sessionInformation.ContentAssemblyMode&&"DocGen"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.sessionInformation.ContentAssemblyMode||(n[Me.ss]="1"),e.sessionInformation.ContentAssemblyMode&&(n[Me.Is]=e.sessionInformation.ContentAssemblyMode);var c=e.sessionInformation.Meeting;c&&(c.id&&(n[Me.as]=c.id),c.title&&(n[Me.us]=c.title),c.type&&(n[Me.ds]=c.type),c.scheduledStartTime&&(n[Me.fs]=c.scheduledStartTime),c.scheduledEndTime&&(n[Me.fs]=c.scheduledEndTime),c.joinUrl&&(n[Me.vs]=encodeURIComponent(c.joinUrl)),c.organizerId&&(n[Me.ps]=c.organizerId),c.isPresenter&&(n[Me.hs]=c.isPresenter.toString()),c.isMeetingTeamsRoom&&(n[Me.ms]=c.isMeetingTeamsRoom.toString()));var u=e.sessionInformation.OwlVersion;u&&(n[Me.gs]=u);var d=e.sessionInformation.OwlRollout;d&&(n[Me.Ss]=d),n[Me.ws]=B();var f=e.sessionInformation.TraceParent;if(f){n[Me.bs]=f;var h=e.sessionInformation.TraceState;h&&(n[Me._s]=h)}return n}(this.ia,this.jt);if(this.oa.registerMessagePayloadHandler(he.sn,this.fa),this.oa.registerMessagePayloadHandler(he.dn,this.Sa),this.ia.sessionInformation.SupportsFrameTrustCheck||this.oa.registerMessagePayloadHandler(he.Tn,this.ha),this.oa.registerMessagePayloadHandler(he.Kn,this.va),this.oa.registerMessagePayloadHandler(he.Pn,this.ba),this.oa.registerMessagePayloadHandler(he.Qn,this._a),this.oa.registerMessagePayloadHandler(he.Xi,this.la),this.ya.ignoreWacFramePostMessages||this.ra(m(e)),this.ea(e,t),this.ya.ignoreWacFramePostMessages){var n=this.ma();this.wa(n)}return this.jt.ULS.Ue(595661019,i.B,o.Info,"Created Wac Frame"),this.Js},e}();var qt=function(){function e(e,t,n,r,s,a,c){var u=this;this.Ta=!1,this.Ca=!1,this.Ea=!1,this.Aa=null,this.Pa=!0,this.Fa=!1,this.Oa=!1,this.Ra=function(){u.jt.ULS.Ue(596444231,i.B,o.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout(u.Ua,5e3),u.oa.registerMessagePayloadHandler(he.on,u.xa),u.oa.registerMessagePayloadHandler(he.zn,u.Wa);var e=new Gt(u.ia,u.ya,u.jt,u.oa,u.wa,u.Ia);u.Js=e.Boot(),u.ka&&u.ka(u.Js)},this.Ma=function(){var e={ParallelizeStartSession:u.Pa,WacFrameIsLoaded:u.Ta,WacAcceptsStartSessionComplete:u.Fa};u.jt.ULS.Ue(596444232,i.B,o.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(e)),!u.Pa||u.Ta&&!u.Fa?u.Ta&&u.Na():u.Ha()},this.Da=function(){u.jt.ULS.Ue(596444233,i.B,o.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),u.ia.wopiInfo=u.La;var e=new Gt(u.ia,u.ya,u.jt,u.oa,u.wa,u.Ia);u.Js=e.Boot(),u.ka(u.Js)},this.Va=function(e){u.Ta?(u.jt.ULS.Ue(595968481,i.B,o.Warning,"Fail called and wacframe is able to accept postmessages"),u.Ba(e)):(u.jt.ULS.Ue(595968482,i.B,o.Warning,"Fail was called on the session prior to WacReady."),u.Aa=e)},this.Ba=function(e){u.jt.ULS.Ue(596444189,i.B,o.Warning,"Fail called, sending the failure postmessage to IFrame"),u.pa(pe.xo,e)},this.Ja=function(){u.jt.ULS.Ue(596444190,i.B,o.Warning,"Fail called during single step boot, calling host failure callback..."),u.Ia({errorType:Je.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},this.Ua=function(){u.Ta||(u.jt.ULS.Ue(596444191,i.B,o.Warning,"Timeout Wac Ready"),u.Ia({errorType:Je.TimeoutWacReady,errorObject:void 0}))},this.Ga=function(){u.Ea||(u.na.timeoutCompleteOrFail=$(),u.jt.ULS.Ue(596444192,i.B,o.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(u.na)))},this.qa=function(e,t,n){u.Oa||(u.jt.ULS.Ue(596444193,i.B,o.Info,"SessionCompletion timed out with no ack."),u.za(e,t,n+1))},this.xa=function(e){if(u.na.readyMessageReceiveTime=$(),u.pa(pe.Zi,{}),u.Ta)u.jt.ULS.Ue(596444194,i.B,o.Info,"Received multiple ready messages - frame is already loaded.");else{u.Ta=!0,u.Fa=e&&e.CanAcceptStartSessionComplete;var t={AcceptStartSessionComplete:u.Fa,ParallelizeStartSession:u.Pa,StartSessionResponseAvailable:!!u.Ka,WopiInfoAvailable:!!u.La};u.jt.ULS.Ue(596444195,i.B,o.Info,"HandleWacReadyMessage - "+JSON.stringify(t)),u.Ea&&(u.Aa?u.Ba(u.Aa):u.pa(pe.Mo,{})),u.Pa&&u.Fa?u.Ka&&u.Xa():u.La&&u.Na(),Ye(u.ta,e)}},this.Wa=function(e){u.Oa=!0,u.na.sessionCompleteAckReceivedTime=$()},this.pa=function(e,t){u.oa.sendPostMessage(u.Js,e,t)},this.$a=function(e,t){u.za(e,t,1)},this.za=function(e,t,n){if(n>3)u.jt.ULS.Ue(596444224,i.B,o.Error,"Attempted to call complete, but received no ack from the frame. Time: ".concat($()));else{u.jt.ULS.Ue(596444225,i.B,o.Info,"Sending completion message to frame. Attempt number: ".concat(n,", Time: ").concat($()));var r=$();1===n&&(u.Ka&&u.Ka.Diagnostics&&(u.Ka.Diagnostics.completeMessageCreateTime=r),u.na.completeMessageCreateTime=r),t.Diagnostics.completeMessageSendTime=r,u.na.completeMessageSendTime=r,u.pa(e,t),window.setTimeout((function(){return u.qa(e,t,n)}),1e3)}},this.Ha=function(){u.jt.ULS.Ue(596444226,i.B,o.Info,"Making parallelized startSession request.");var e=u.Za(u.La),t={"Content-Type":"application/x-www-form-urlencoded"},n="access_token="+encodeURIComponent(u.La.AccessToken)+"&access_token_ttl="+encodeURIComponent(Ut(u.La));u.na.startSessionStartTime=$(),function(e,t,n,i){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{i&&i(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),n)o.setRequestHeader(r,n[r]);o.send(t)}(e,n,t,u.Qa)},this.Qa=function(e){if(u.na.startSessionCompleteTime=$(),u.na.startSessionResponseStatus=e.status,u.Ka={StartSessionResponse:{RequestStatus:e.status,ResponseText:e.responseText},Diagnostics:{wopiPendingInitializeTime:u.na.wopiPendingInitializeTime,wopiPendingCompleteTime:u.na.wopiPendingCompleteTime,startSessionStartTime:u.na.startSessionStartTime,startSessionCompleteTime:u.na.startSessionCompleteTime,readyMessageReceiveTime:u.na.readyMessageReceiveTime}},u.jt.ULS.Ue(596444227,i.B,o.Info,"StartSession request completed with status code: ".concat(u.Ka.StartSessionResponse.RequestStatus,", Time: ").concat($())),u.Ta&&u.Fa)u.Xa();else{var t={WacFrameIsLoaded:u.Ta,InitializeCompleted:u.Ca};u.jt.ULS.Ue(596444228,i.B,o.Info,"StartSessionCompleted not called - "+JSON.stringify(t))}},this.Na=function(){if(!u.Ca){u.Ca=!0,u.jt.ULS.Ue(596444229,i.B,o.Info,"Sending wopi info to the frame.");var e={WopiDetails:{WopiSrc:u.La.WopiSrc,AccessToken:u.La.AccessToken,AccessTokenTtl:Ut(u.La)},Diagnostics:{wopiPendingInitializeTime:u.na.wopiPendingInitializeTime,wopiPendingCompleteTime:u.na.wopiPendingCompleteTime,readyMessageReceiveTime:u.na.readyMessageReceiveTime}};u.La.WacToken&&(e.WopiDetails.WacToken=u.La.WacToken),u.$a(pe.io,e)}},this.Xa=function(){200===u.Ka.StartSessionResponse.RequestStatus?u.Ca||(u.Ca=!0,u.$a(pe.no,u.Ka)):u.Na()},this.Za=function(e){var t=u.ia.applicationBasePath+"wordeditorstartsession.ashx",n=Rt(u.ia,u.ya,!1);return t=C(t+="?"+n.substring(n.indexOf("?")+1),"WOPISrc",encodeURIComponent(e.WopiSrc)),t=C(t,"build",encodeURIComponent(B())),t=C(t,"WacUserType",encodeURIComponent("WOPI")),u.ia.wopiPrecheckInfo.FileGetUrl&&(t=C(t,"fileGetUrlPresent","1")),t},this.Ya=function(e){if(u.ia.isCreateNew){if(!e||!e.NewFilePath)return void u.jt.ULS.Ue(596444230,i.B,o.Info,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",e.NewFilePath),e.UpdatedPageTitle&&(document.title=e.UpdatedPageTitle)}},this.ia=e,this.ya=t,this.ta=e.diagnostics.AppInitDiagnostics,this.jt=n,this.oa=r,this.wa=a,this.Ia=c,Promise&&(this.ec=new Promise((function(e){return u.ka=e}))),this.na=e.diagnostics.SessionTraces,this.na.wopiPendingInitializeTime=$(),this.tc=s,qe(),window.setTimeout(this.Ga,5e3)}return e.prototype.Complete=function(e,t){if(this.Ea)this.jt.ULS.Ue(596444184,i.B,o.Warning,"Complete called after Complete/Fail already called");else{this.jt.ULS.Ue(596444185,i.B,o.Info,"Complete called."),this.ia.diagnostics.HostInitDiagnostics&&(this.ia.diagnostics.HostInitDiagnostics.hostCompleteCallTime=$()),this.Ea=!0,this.La=e,this.na.wopiPendingCompleteTime=$();try{this.ya.isSingleStepBoot?this.Da():this.Ma(),this.Ta&&this.pa(pe.Mo,{}),this.Ya(t)}catch(e){this.jt.ULS.Ue(596444186,i.B,o.Error,"Unexpected script error: ".concat(ce(e))),G(this.ia.remoteTelemetryUrl,"Excel","bootException")}finally{this.jt.ULS.flush()}}},e.prototype.Fail=function(e){this.Ea?this.jt.ULS.Ue(596444187,i.B,o.Warning,"Fail called after Complete/Fail already called"):(this.jt.ULS.Ue(596444188,i.B,o.Warning,"Fail called. Reason: "+(e?JSON.stringify(e):"N/A")),this.Ea=!0,this.ya.isSingleStepBoot?this.Ja():this.Va(e),this.jt.ULS.flush())},e.prototype.Dispose=function(e,t,n){var i=this;ze(e||!1,this.jt,this.oa,this.Js,(function(){delete i.Js,t&&t(),i.tc(),i.oa.dispose()}),void 0,n)},e.prototype.PostWacToken=function(e,t,n){!function(e,t,n,r,s,a){var c=$();r.ULS.Ue(507774684,i.B,o.Important,"postWacToken flow initiated");var u=function(){a&&a.flush&&a.flush()};s?s.then((function(s){var d=function(){return n.sendPostMessage(s,pe.Ko,{wacToken:e,postWacTokenStart:t})};d();var l=window.setInterval(d,100);n.registerMessagePayloadHandler(he.qi,(function(e){r.ULS.Ue(507597019,i.B,o.Info,"postWacToken flow completed in ".concat($()-c," ms")),window.clearInterval(l),window.clearTimeout(f),a&&(a.PostWacTokenResult="success",a.PostWacTokenEndTime=$(),e&&void 0!==e.TokenAlreadySet&&(a.TokenAlreadySet=e.TokenAlreadySet),u())}));var f=window.setTimeout((function(){r.ULS.Ue(507597018,i.B,o.Warning,"postWacToken flow timed out after ".concat(6e4," ms")),window.clearInterval(l),a&&(a.PostWacTokenResult="timeout",a.PostWacTokenEndTime=$(),u())}),6e4)})).catch((function(e){r.ULS.Ue(507873094,i.B,o.Warning,"This should never reject, error: ".concat(ce(e))),a&&(a.PostWacTokenResult="Unexpected JSAPI V1 error",a.PostWacTokenEndTime=$(),u())})):(r.ULS.Ue(507846862,i.B,o.Warning,"`Promise` does not exist natively for this browser."),a&&(a.PostWacTokenResult="JSAPI V1 error: Promise not supported in browser",a.PostWacTokenEndTime=$(),u()))}(e,t,this.oa,this.jt,this.ec,n)},e.prototype.Boot=function(){this.ya.isSingleStepBoot||this.Ra(),this.jt.ULS.flush()},e}(),zt=function(){function e(){var e=this;if(this.nc=[],this.Hs=[],this.ic=function(){var t={visibility:document.visibilityState,time:$(),initialState:!1};e.nc.push(t);for(var n=0,i=e.Hs;n<i.length;n++){var o=i[n];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:$(),initialState:!0};this.nc.push(t)}document.addEventListener("visibilitychange",this.ic)}return e.prototype.registerEventHandler=function(e){this.Hs.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.Hs.indexOf(e);this.Hs.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.ic)},e.prototype.getVisibilityChangeEvents=function(){return this.nc},e.prototype.dispose=function(){this.stop(),this.Hs=[],this.nc=[]},e}();var Kt="excel-boot".concat(".min",".js"),Xt=[];function $t(e){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",(function(){try{for(var t=0,n=window.performance.getEntriesByType("resource");t<n.length;t++){var r=n[t],s=A(r.name);if("about:blank"!==r.name&&-1===s.indexOf("RemoteUls.ashx")&&-1===s.indexOf("mhtml:file"))if(s===Kt)a=(a=JSON.stringify(r)).replace(new RegExp(r.name,"g"),s),e.ULS.Ue(574662801,i.B,o.Info,a);else if(-1!==Xt.indexOf(s)){var a;a=(a=JSON.stringify(r)).replace(new RegExp(r.name,"g"),s),e.ULS.Ue(595736532,i.B,o.Info,a)}}try{var c=window.performance.getEntriesByType("navigation"),u=void 0;if(c.length>0)u=c[0].type||"UndefinedType";else u="none";e.ULS.Ue(555872898,i.B,o.Info,"Navigation type is: ".concat(u))}catch(t){e.ULS.Ue(556011586,i.B,o.Info,"ExcelPreloader.tryObserveResourceTiming: Exception thrown when trying to read navigation type. Exception: "+JSON.stringify(t))}window.performance.clearResourceTimings()}catch(t){e.ULS.Ue(595732049,i.B,o.Info,"ExcelPreloader.tryObserveResourceTiming: could not trace resource timing, error is: "+JSON.stringify(t))}}),{once:!0})}var Zt;function Qt(e,t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0),Zt=e;try{if(n){n.addActionHandler(he.pi,(function(e,t){Yt(t)}))}else t&&t.registerMessagePayloadHandler(he.pi,(function(e){Yt(e)}))}catch(e){Zt.ULS.Ue(572383452,i.B,o.Warning,"ExcelFileBundleRegenerationRequester.initRegenerateFileBundleMessageHandler: ".concat(ce(e)))}}function Yt(e){if(e&&e.hasOwnProperty("fileUrl")&&e.hasOwnProperty("fileType"))try{var t=function(){var e=new nn,t=new XMLHttpRequest;return t.timeout=3e4,t.withCredentials=!0,t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status?(e.IsSucceeded=!0,e.HostCorrelationId=function(e){var t,n=null;try{var r=(new window.DOMParser).parseFromString(e,"text/xml"),s=new URL(null!==(t=r.documentElement.textContent)&&void 0!==t?t:"");n=s.searchParams.get("correlationId")}catch(e){Zt.ULS.Ue(572383454,i.B,o.Warning,"ExcelFileBundleRegenerationRequester.readSpoCorrelationFromResponse: ".concat(ce(e)))}return n}(t.responseText)):e.FailureReason="XhrHttp".concat(t.status),en(e))},t.onerror=function(t){e.FailureReason="XhrError",en(e)},t}(),n=function(e){var t=new URL(e.fileUrl).origin,n=new URL(t);return n.pathname="_api/SP.Utilities.WOPIHostUtility.GenerateFileBundle",n.searchParams.set("fileUrl",e.fileUrl),n.searchParams.set("fileType",e.fileType),n}(e);t.open("GET",n.toString(),!0),t.send()}catch(e){Zt.ULS.Ue(572381152,i.B,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: ".concat(ce(e)))}else Zt.ULS.Ue(572383453,i.B,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: Message is missing parameter(s). values=null? ".concat(!e,",\n        fileUrl=null? ").concat(e&&!e.hasOwnProperty("fileUrl"),", fileType=null? ").concat(e&&!e.hasOwnProperty("fileType")))}function en(e){Zt.ULS.Ue(572383455,i.B,o.Warning,"ExcelFileBundleRegenerationRequester.logResult: ".concat(JSON.stringify(e)))}var tn,nn=function(){this.IsSucceeded=!1,this.HostCorrelationId=null,this.FailureReason=null};function on(e,t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0),tn=e;var r=function(e){e.forEach((function(e){e?function(e,t,n){if(!Le(tn))return;var r="addqsp"===(null==e?void 0:e.toLowerCase()),s="removeqsp"===(null==e?void 0:e.toLowerCase());if(!t)return void tn.ULS.Ue(508864546,i.B,o.Warning,"handleHostFrameModifyURLState: qspName is null.");if(r)return void rn(!0,!1,t,n);if(s)return void rn(!1,!0,t,n);tn.ULS.Ue(508864545,i.B,o.Error,"Does not contain expected values.")}(e.ops,e.qspName,e.qspValue):tn.ULS.Ue(508864544,i.B,o.Warning,"handleHostFrameModifyURLState: MessageData is null.")}))};try{if(n){n.addActionHandler(he.Gi,(function(e,t){r(t)}))}else t&&t.registerMessagePayloadHandler(he.Gi,(function(e){r(e)}))}catch(e){tn.ULS.Ue(508864547,i.B,o.Error,"ExcelModifyURLStateManager: error while initializing.")}}function rn(e,t,n,r){var s,a,c,u=new URLSearchParams(window.location.search);e&&r?null==u||u.set(n,r):t&&(null==u||u.delete(n));try{window.history.replaceState({},"",(s=window.location.origin,a=window.location.pathname,c=u.toString(),s+a+"?"+c)),tn.ULS.Ue(508864543,i.B,o.Info," ".concat(e?"Added":"Removed"," querystring param from url of hostframe"))}catch(e){tn.ULS.Ue(508864542,i.B,o.Warning,"ExcelModifyURLStateManager: error while changing state of hostframe:\n        ".concat(ce(e)))}}var sn,an=function(){function e(e,t){var n=this;this.oc=function(e,t){return window.setInterval((function(){n.Prefetch({BootstrapperUrl:e}),t.ULS.Ue(595895774,i.B,o.Info,"Prefetching "+A(e))}),36e5)},this.rc=e,this.ac=t}return e.prototype.GetVersion=function(){return B()},e.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},e.prototype.Prefetch=function(e){if(null!=e&&void 0!==e){var t=document.createElement("link");t.rel="prefetch";var n=e.BootstrapperUrl;".js"!==n.toString().slice(-3)&&(n+=".js"),t.href=n;var i=document.getElementsByTagName("head")[0];null!=i&&void 0!==i&&i.appendChild(t)}},e.prototype.InitializeWopiPending=function(e,t,n,r,s,a){var c,u,d,l,f,h=!1;try{n?d=n:(d=(c=Ie())[0],l=c[1]),G($e(e.ApplicationUrl,d),"Excel","init");var p,v=$();!function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var n=e.SessionInformation;if(void 0===n||void 0===n.HostName||void 0===n.HostSessionId||void 0===n.UserId)throw new TypeError("SessionInformation");var i=e.ApplicationUrl;if(void 0===i||"string"!=typeof i)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),e.ApplicationUrl=S(e.ApplicationUrl,T(e.ApplicationUrl,"region")),e.ApplicationUrl=function(e,t){if(!e)return e;var n=e,i=n.indexOf("?"),o=t.toLowerCase()+"=",r=n.toLowerCase().indexOf(o,i);if(r>=0){var s=n.indexOf("&",r);return"&"===(n=n.substring(0,r)+(-1===s?"":n.substring(s+1))).slice(-1)&&(n=n.slice(0,-1)),n}return e}(e.ApplicationUrl,"region"),function(e){var t,n=e.RebootOverrideData;if(n)if(n.queryOverrides||(n.queryOverrides={}),t=n.mode)"view"===(t=t.toLowerCase())?n.queryOverrides.wdforcedmode="View":"edit"===t&&(n.queryOverrides.wdforcedmode="Edit");else{var i=n.reason;i&&"saveas"===(i=i.toLowerCase())&&(n.queryOverrides.wdforcedmode="Edit")}}(e),u=t||te({remoteUlsEndpoint:Qe(e.ApplicationUrl)+"RemoteUls.ashx",sessionId:d}),f=Ze(e,d,u,s,a,this.ac.forceSingleStepBoot),a||(f.yt.addSettingsChangeListener(u.settingsChangeHandler),f.yt.initializePeriodicFetch(f.applicationBasePath,d)),f.diagnostics.HostInitDiagnostics&&(f.diagnostics.HostInitDiagnostics.hostInitializeCallTime=v),nt(u,f,l),h=!0;var m=e.BootstrapperUrl;m&&(p=this.oc(m,u));var w=function(){f.yt.dispose(),f.pageStateObserver.dispose(),window.clearInterval(p)},g=I(e.ApplicationUrl),b=r||new Wt(g,u),_=new zt,y=Pt(f,u),C=function(e,t,n,r,s,a,c){return function(u){var d=e.diagnostics;tt(d,r),et(d.SessionTraces,n,o.Info);var l=un(d);n.ULS.Ue(596448985,i.B,o.Info,JSON.stringify(l)),G(e.remoteTelemetryUrl,"Excel","bootSuccess");var f=c(e.sessionId,n,t,s,u);try{a(f,l)}catch(e){n.ULS.Ue(595719171,i.B,o.Error,"Exception thrown from host's success callback: ".concat(ce(e)))}be("excel",n),cn(n)}}(f,b,u,_,w,e.FnOnInitializeSuccess,this.rc),E=function(e,t,n,r){return function(s){var a=e.diagnostics;tt(a,n),et(a.SessionTraces,t,o.Warning);var c=un(a);void 0!==s&&"Js Boot Failed"!==s.errorObject.errorType&&t.ULS.Ue(575931487,i.B,o.Error,"Core JS failure recieved "+JSON.stringify(s)),t.ULS.Ue(596448986,i.B,o.Error,JSON.stringify({error:s,appInitDiagnostics:c})),G(e.remoteTelemetryUrl,"Excel","bootFailure");try{r(s,c)}catch(e){t.ULS.Ue(595719172,i.B,o.Error,"Exception thrown from host's failure callback: ".concat(ce(e)))}be("excel",t),cn(t)}}(f,u,_,e.FnOnInitializeFailure);e.FnOnAppModeSwitched&&b.registerMessagePayloadHandler(he.Un,e.FnOnAppModeSwitched),Tt(u,b),Qt(u,b),on(u,b),$t(u),e.WopiPrecheckInfo.ReadOnly&&e.FnOnAppModeSwitched;var A=T(f.applicationUrl,"uih");if(m&&this.ac.preconnector&&this.ac.preconnector.shouldPreconnect(A)&&this.ac.preconnector.preconnect(m),m&&this.ac.preloader&&this.ac.preloader.shouldPreload(f.applicationUrl))try{var F=m;f.featureManager.isFeatureEnabled(se.Pt)&&(u.ULS.Ue(595645891,i.B,o.Info,"HTTP2 preload enabled"),F=P(m));var O=f.sessionInformation.UiLocale;O||(O=decodeURIComponent(T(f.applicationUrl,"ui"))),this.ac.preloader.preload(F,O,u,f.featureManager)}catch(e){u.ULS.Ue(595943884,i.B,o.Error,"Error preloading")}var R=new qt(f,y,u,b,w,C,E);return R.Boot(),R}catch(t){return u&&(u.ULS.Ue(596459925,i.B,o.Error,"".concat(Je.AppInitError,": ").concat(ce(t))),h||nt(u,f||Ze(e,d,u,s,a,this.ac.forceSingleStepBoot),l),u.ULS.flushOnClose()),void(e&&(e.ApplicationUrl&&G($e(e.ApplicationUrl,d),"Excel","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:Je.AppInitError,errorObject:t})))}},e}();function cn(e){e.ULS.Ue(590914655,i.B,o.Info,"Time spent logging: ".concat(e.getTimeSpentLogging()))}function un(e){return ne(ne(ne({},e.AppInitDiagnostics),e.HostInitDiagnostics),{SessionTraces:e.SessionTraces})}!function(e){e.BrowserEvent="BrowserEvent",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(sn||(sn={}));var dn=function(){function e(e,t,n,r,s){var a=this;this.Hs={},this.cc=function(){a.oa.registerMessagePayloadHandler(he.Ln,a.uc),a.oa.registerMessagePayloadHandler(he.Fn,a.dc),a.oa.registerMessagePayloadHandler(he.On,a.lc),a.oa.registerMessagePayloadHandler(he.En,a.fc),a.oa.registerMessagePayloadHandler(he.Xn,a.hc),a.oa.registerMessagePayloadHandler(he.An,a.pc),a.oa.registerMessagePayloadHandler(he.xn,a.vc),a.oa.registerMessagePayloadHandler(he.Gn,a.mc)},this.wc=function(e,t){var n=a.Hs[e];if(n)try{n(t||{})}catch(e){a.jt.ULS.Ue(593773706,i.B,o.Error,"Handler error: ".concat(ce(e)))}},this.uc=function(e){e.previousSessionId=a.gc,a.wc(sn.DocumentReboot,e)},this.dc=function(e){a.wc(sn.WopiInfoFromUrl,e)},this.lc=function(e){a.wc(sn.DavUrlFromIds,e)},this.fc=function(e){Promise?a.Sc.isResourceTrustedForMessage(e).then((function(t){t?a.wc(sn.GetAuthToken,e):a.oa.sendPostMessage(a.Js,pe.yo,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){a.oa.sendPostMessage(a.Js,pe.yo,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):a.oa.sendPostMessage(a.Js,pe.yo,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.hc=function(e){a.wc(sn.FileShare,e)},this.pc=function(e){a.wc(sn.GetCustomAuthConfig,e)},this.vc=function(e){a.wc(sn.MoveToFolder,e)},this.mc=function(e){a.wc(sn.SharedFilePicker,e)},this.gc=e,this.jt=t,this.Js=s.innerApplicationFrame,this.oa=n,this.Ic=r,this.Sc=new Fe(t),this.cc(),qe()}return e.prototype.GetApplicationType=function(){return"Excel"},e.prototype.GetVersion=function(){return B()},e.prototype.GetSessionId=function(){return this.gc},e.prototype.RegisterEventHandler=function(e,t){switch(e){case sn.Unloaded:case sn.Disposed:case sn.DocumentReboot:case sn.WopiInfoFromUrl:case sn.DavUrlFromIds:case sn.GetAuthToken:case sn.GetCustomAuthConfig:case sn.MoveToFolder:case sn.SharedFilePicker:case sn.SetOverlayContent:case sn.FileShare:if(this.Hs[e])throw new Error("Duplicate registration");this.Hs[e]=t;break;default:this.oa.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case sn.Unloaded:case sn.Disposed:case sn.DocumentReboot:case sn.FileShare:case sn.WopiInfoFromUrl:case sn.DavUrlFromIds:case sn.GetAuthToken:case sn.GetCustomAuthConfig:case sn.MoveToFolder:case sn.SharedFilePicker:case sn.SetOverlayContent:if(this.Hs[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Hs[e];break;default:this.oa.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.oa.postMessageForCommand(this.Js,e,t)},e.prototype.Dispose=function(e,t){var n=this;ze(e||!1,this.jt,this.oa,this.Js,(function(){delete n.Js,n.Ic(),n.oa.dispose(),n.wc(sn.Unloaded,{})}),(function(){try{n.wc(sn.Disposed,{}),n.Hs={}}catch(e){n.jt.ULS.Ue(589108815,i.B,o.Error,"onFrameRemoved error: ".concat(ce(e)))}}),t)},e}();function ln(e,t){return it(e)&&!fn(t)}var fn=function(e){return[r.Chrome,r.Edge].includes(c())&&(!e||"https://onedrive.live.com"!==e.toLowerCase())};function hn(e,t,n,r,s){var a={};if(s)a=s;else try{a=JSON.parse("###JSAPIHASHES###")}catch(e){r&&r.ULS.Ue(589178847,i.B,o.Info,"GetExcelResources failed to parse hash dictionary")}for(var c=P("".concat(I(e)).concat("/x/","s/")),u=function(e){var t=e?e.toLowerCase().split("-")[0]:"en";return k[t]}(null!=t?t:"en-US"),d=[],l=0,f=function(e){var t=[["App_Scripts/".concat("EwaTS").concat("",".js"),!1],["App_Scripts/gridRenderer".concat(".min",".js"),!1],["App_Scripts/MicrosoftAjaxDS".concat("",".js"),!1],["App_Scripts/".concat("EwaTS").concat("",".bootCommon.js"),!1]];e&&(t=t.concat([["App_Scripts/".concat(e,"/Ewa.Strings.Wac").concat("",".js"),!0],["Resources/".concat(e,"/EwrDefault.css"),!0],["Resources/".concat(e,"/excelframe.css"),!0]]));return t}(u);l<f.length;l++){var h=f[l],p=h[0],v=h[1],m=p.substring(p.lastIndexOf("/")+1);if(Xt.push(m),!v||"1033"===u){var w=m.toLowerCase();if(console.log("lowerCaseFile"),a&&a[w]){var g=a[w].UrlHash,S=a[w].SriHash;if(g&&S){var b=c+g+"__layouts/"+p;d.push([b,"sha256-"+S]),r&&r.ULS.Ue(589178849,i.B,o.Info,"GetExcelResources adding hashed url for ".concat(m))}}}}return d}var pn=function(e,t,n,r,s){return e!==he.Ln?Promise.reject("Wrong flow"):new Promise((function(e){n.pendingReboot=!0;var r=void 0;if(t.queryOverrides)try{r=JSON.parse(t.queryOverrides)}catch(e){n.logger.ULS.Ue(592217694,i.B,o.Error,"Failed to parse queryOverrides: ".concat(r))}n.raiseEvent(ve.Reboot,ne(ne({},t),{previousSessionId:n.sessionId,queryOverrides:r})),e({completion:"success"})}))};function vn(e){return function(e,t){var n={};t&&Object.keys(t).forEach((function(e){n[e.toLowerCase()]=t[e]}));return e.split("&").forEach((function(e){if(/^wd\w+=\w+/i.test(e)){var t=e.split("=");n[t[0].toLowerCase()]=t[1]}})),n}(window.location.search.substring(1),e)}function mn(e,t,n){var i=ne(ne(ne({},E(e.appUrl)),function(e){var t={};_(t,"jsapi","1"),_(t,"jsapiver","v2"),_(t,"corrid",e.sessionId),_(t,"usid",e.sessionId),_(t,"newsession","1"),_(t,"sftc","1"),e.hostSessionId&&_(t,"hid",encodeURIComponent(e.hostSessionId));var n=e.host;n.uiHostName&&_(t,"uih",n.uiHostName),n.uiHostIntegrationType&&_(t,"uihit",encodeURIComponent(n.uiHostIntegrationType)),n.metaUiHostVersion&&_(t,"muv",encodeURIComponent(n.metaUiHostVersion));var i=n.capabilities;i&&(i.accessibilityLoop&&_(t,"accloop","1"),i.rebootDoc&&_(t,"sdr",i.rebootDoc.toString()),i.createNewDoc&&_(t,"scnd","1"),i.authToken&&_(t,"sat","1"),i.customAuthConfig&&_(t,"cac","1"),i.refreshAccessToken&&_(t,"rat","1"),i.atMentions&&_(t,"sams","1"),i.moveToFolder&&_(t,"mtf","1"),i.noBrowserModalDialogs&&_(t,"nbmd","1"),i.commonFilePicker&&_(t,"sfp","1"),i.directDownload&&_(t,"sdd","1"),i.directPrint&&_(t,"sdp","1"));var o=e.ui;o.language&&_(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&_(t,"uiembed","1"),(o.hideHeader||"DocGen"===o.contentAssemblyMode||"Templatization"===o.contentAssemblyMode||"ContentAssemblyEdit"===o.contentAssemblyMode||"ContentAssemblyView"===o.contentAssemblyMode)&&_(t,"hhdr","1"),o.highContrast&&_(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&_(t,"hodflp","1"),o.hideAppLauncherInHeader&&_(t,"halh","1"),o.hideChatInHeader&&_(t,"hch","1"),o.hideMeInHeader&&_(t,"hmh","1"),o.hideSearchInHeader&&_(t,"hsh","1"),o.hideWorkflowInHeader&&_(t,"hwfh","1"),o.hideSettingsInHeader&&_(t,"hsth","1"),o.showAppIconInHeader&&_(t,"sih","1"),o.useNeutralColorInHeader&&_(t,"unh","1"),o.openLinksInNewWindow&&_(t,"onw","1"),o.useDarkTheme&&_(t,"udt","1"),"DocGen"!==o.contentAssemblyMode&&"ContentAssemblyView"!==o.contentAssemblyMode||_(t,"readOnly","1");var r=e.wopi;r&&r.source&&_(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&_(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&_(t,"readonly","1"),s.disableChat&&_(t,"dchat","1"),s.cookieCompliant&&_(t,"mscc","1"),s.isNewFile&&(_(t,"new","1"),s.isFromHostTemplate&&_(t,"wdtpl","fromhost"))),e.user.isLicensed&&_(t,"islicenseduser","1"),e.user.isSynthetic&&_(t,"syn","1"),e.actNavId&&_(t,"actnavid",e.actNavId),e.sessionContext&&_(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)_(t,c,a[c]);var u=e.preseededSession;u&&(u.key&&_(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&_(t,"preseededwacsessionid",encodeURIComponent(u.id)));var d=e.throttling;d&&(d.protection&&_(t,"ctp",d.protection),d.request&&_(t,"rct",d.request));var l=e.hostInitDiagnostics;l&&(l.entryPoint&&_(t,"wdorigin",encodeURI(l.entryPoint)),l.userClickTime&&_(t,"wdhostclicktime",l.userClickTime.toString()));var f=e.rebootOverride;return f&&f.previousSessionId&&_(t,"wdprevioussession",f.previousSessionId),y(t,"region"),t}(e)),n),o=e.rebootOverride;return o&&o.queryOverrides&&(i=ne(ne({},i),o.queryOverrides)),function(e,t,n){var i=[];for(var o in n)n[o]&&i.push(o+"="+n[o]);return e+t+(i.length>0?"?"+i.join("&"):"")}(e.appBasePath,t,i)}function wn(e,t){var n=function(e){var t={};_(t,"highdpi",String(window.devicePixelRatio>1.24)),_(t,"softblockedbrowser",String(l())),_(t,"hostname",e.hostName),_(t,"feature_status",de(e.featureManager,e.wdParams)),_(t,"jsapibuild",B());var n=e.wopi;n&&(_(t,"access_token",n.accessToken),_(t,"access_token_ttl",n.expiry.toString()),n.wacToken&&_(t,"wac_token",n.wacToken));var r=e.customFontCatalogUrl;r&&_(t,"customfontcatalogurl",r);var s=e.contentBundle;if(s&&s.url){_(t,"bundlesrc",s.url);var a=s.staleness,c=null!=a;c&&_(t,Me.Pr,a.toString()),e.logger.ULS.Ue(577783775,i.B,o.Info,"Content bundle staleness: "+(c?a:"N/A"))}var u=e.file,d=u.name;if(d){_(t,"filename",d);var f=ae(d);f&&_(t,"fileextension",f)}u.getUrl&&_(t,"filegeturl",u.getUrl),u.downloadCode&&_(t,"filedownloadcode",u.downloadCode),u.size&&_(t,"filesize",u.size.toString()),u.eTag&&_(t,"etag",u.eTag),u.cTag&&_(t,"revid",u.cTag),u.uniqueId&&_(t,"docid",u.uniqueId),void 0!==u.immutableReason&&_(t,"immutableReason",u.immutableReason.toString());var h=e.newFileTemplate;h&&(h.getUrl&&_(t,"templateurl",h.getUrl),h.size&&_(t,"filesize",h.size.toString()),h.eTag&&_(t,"etag",h.eTag),h.uniqueId&&_(t,"docid",h.uniqueId)),e.user.id&&_(t,"user_id",e.user.id),e.ownerId&&_(t,"owner_id",e.ownerId),e.sessionContext&&_(t,"sc",e.sessionContext);var p=e.ui;p.controls&&_(t,"huictrls",JSON.stringify(p.controls)),"Templatization"!==p.contentAssemblyMode&&"DocGen"!==p.contentAssemblyMode&&"ContentAssemblyEdit"!==p.contentAssemblyMode&&"ContentAssemblyView"!==p.contentAssemblyMode||_(t,"caae","1"),p.contentAssemblyMode&&_(t,"caaemode",p.contentAssemblyMode);var v=e.meeting;v&&(v.id&&_(t,"meetingId",v.id),v.title&&_(t,"meetingTitle",v.title),v.type&&_(t,"meetingType",v.type),v.scheduledStartTime&&_(t,"scheduledStartTime",v.scheduledStartTime),v.scheduledEndTime&&_(t,"scheduledEndTime",v.scheduledEndTime),v.isPresenter&&_(t,"isPresenter",v.isPresenter.toString()),v.organizerId&&_(t,"meetingOrganizerId",v.organizerId),v.joinUrl&&_(t,"meetingJoinUrl",encodeURIComponent(v.joinUrl)),v.isMeetingTeamsRoom&&_(t,"isMeetingTeamsRoom",v.isMeetingTeamsRoom.toString()));var m=e.host;return m.owlVersion&&_(t,"owlver",m.owlVersion),m.owlRollout&&_(t,"owlro",m.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?n[e]=t[e]:delete n[e]})),n}function gn(e){var t,n;if(function(e){return"wdjs"in e||"wd1js"in e}(e))return"true"===window.sessionStorage.getItem("sideLoadingIsEnabled")?(t=!1,void("true"===(n=We("sideLoadingIsEnabled"))||"false"!==n&&t||ke("sideLoadingIsEnabled","true",1))):void ke("sideLoadingIsEnabled","false",0)}var Sn=function(e,t,n,r,s){return e!==fe.boot?Promise.reject("Wrong flow"):new Promise((function(e){var a,c=$();if(n.state=H.Booting,n.pendingReboot=!1,function(e,t,n){if(void 0===n&&(n=!1),!e)throw new TypeError("SessionBootParams");var i=e.appUrl,o=e.appBaseUrl;if(!i&&!o)throw new TypeError("Either appUrl or appBaseUrl should exist");if(i&&"string"!=typeof i)throw new TypeError("AppUrl");if(o&&"string"!=typeof o)throw new TypeError("AppBaseUrl");var r=e.file;if(!r||!n&&!r.name)throw new TypeError("FileInfo");var s,a=e.container;if(!a||!(a instanceof Ve)&&!a.appendChild)throw new TypeError("Container");if(!t&&(!((s=e.wopi)&&s.source&&s.accessToken)||!s.expiry&&0!==s.expiry))throw new TypeError("WopiInfo")}(t,n.skipWopiValidation,n.skipFileNameCheck),n.intent=t.intent,n.file=t.file,n.customFontCatalogUrl=t.customFontCatalogUrl,n.wopi=t.wopi,n.contentBundle=t.contentBundle,n.newFileTemplate=t.newFileTemplate,n.ownerId=t.ownerId,n.sessionContext=t.sessionContext,n.actNavId=t.actNavId,n.preseededSession=t.preseededSession,n.throttling=t.throttling,n.meeting=t.meeting,n.tenantId=t.tenantId,n.wdParams=vn(t.wdParams),n.pinnedTarget=t.pinnedTarget,n.rebootOverride=t.rebootOverride,n.bootParams=t.bootParams||{},n.hostInitDiagnostics=ne(ne({},t.diagnostics),{hostInitializeCallTime:c}),n.yt.getValue(Q.st,!1)&&Ce(n.hostInitDiagnostics),t.appUrl){var u=t.appUrl;n.appUrl=u;var d=n.bootParams;if(F(u,"new")&&(d.isNewFile=!0),!d.dataLanguage)(l=O(u,"rs"))&&(d.dataLanguage=l);var l,f=n.ui;if(F(u,"uiembed")&&(f.uiEmbed=!0),!f.language)(l=O(u,"ui"))&&(f.language=l);if(!n.hostInitDiagnostics.entryPoint){var h=O(u,"wdorigin");h&&(n.hostInitDiagnostics.entryPoint=h)}if(!n.host.uiHostName){var p=O(u,"uih");p&&(n.host.uiHostName=p)}}else n.appUrl="";n.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():I(t.appUrl).toLowerCase(),n.appBaseUrl=S(n.appBaseUrl,T(n.appUrl,"region")),n.yt.updateEnvironment(n.appBaseUrl),r.initializeAppContext(n,e,t),n.appBasePath=r.buildAppBasePath(n);var v=!1,w=n.preseededSession;n.appInfo.usePreseededSessionId&&w&&w.id&&(n.sessionId=w.id,v=!0);var g,b=!1,_=t.hostGeneratedSessionId;if(!v&&_&&(n.sessionId=_,b=!0),t.rebootOverride&&(v||b||(a=Ie(),n.sessionId=a[0],g=a[1]),n.pageStateObserver=new Ee(n.logger,!0),n.authTokenTrustValidator=new Fe(n.logger)),n.logger.ULS.Ue(38580693,i.B,o.Info,"User session id: ".concat(n.sessionId,", is preseeded: ").concat(v,", is host generated: ").concat(b)),n.remoteTelemetryUrl=r.buildRemoteTelemetryUrl(n),G(n.remoteTelemetryUrl,n.appInfo.name,"init"),!n.isLoggerFromOwl){var y=n.yt.getValue(Q.rt,"").toString();y||(y=n.appBasePath+"RemoteUls.ashx"),n.logger.configure({remoteUlsEndpoint:y,sessionId:n.sessionId})}if(n.yt.initializePeriodicFetch(n.appBasePath,n.sessionId),g&&n.logger.ULS.Ue(590966790,i.B,o.Info,JSON.stringify(g)),function(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.Ue(558155803,i.B,o.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.Ue(596444237,i.B,o.Info,JSON.stringify({session:_e(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.Ue(558155804,i.B,o.Error,"Failed to log init info: ".concat(ce(t)))}}(n),n.appInitDiagnostics={officeSessionId:n.sessionId,officeBootstrapperVersion:B(),hostName:n.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){n.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!n.container){var C=t.container;n.container=C instanceof Ve?C:n.application.createContainer(C)}n.container.setMessageHandler(n.onMessage);var E=!!r.ignoreCompletionMessage&&r.ignoreCompletionMessage(n),A=function(e,t){var s,a;n.successTime=$(),E||(n.container.postMessage(pe.to,void 0),s=n.appInitDiagnostics,(a=t.Diagnostics)&&Object.keys(a).forEach((function(e){s[e]=a[e]}))),n.yt.addSettingsChangeListener(n.logger.settingsChangeHandler),r.onSuccess&&r.onSuccess(n,t),n.logger.ULS.Ue(596448985,i.B,o.Info,JSON.stringify(n.diagnostics)),G(n.remoteTelemetryUrl,n.application.name,"bootSuccess"),n.logger.ULS.flush(),n.container.postMessage(pe.uo,{HostInitializeDiagnostics:n.hostInitDiagnostics,ClientDiagnostics:n.clientDiagnostics}),n.state=H.Booted,U({completion:"success"}),be(n.appInfo.name,n.logger)},R=function(e,t){var s;n.failureTime=$(),r.onFailure&&r.onFailure(n,t.Error),n.logger.ULS.Ue(596448986,i.B,o.Error,JSON.stringify({error:t.Error,diagnostics:n.diagnostics})),G(n.remoteTelemetryUrl,n.application.name,"bootFailure"),n.logger.ULS.flush(),n.state=H.Failed;U({completion:"failure",error:t.Error,errorSource:"app",documentLoadedWithTabSwitch:null===(s=n.appInitDiagnostics)||void 0===s?void 0:s.documentLoadedWithTabSwitch}),be(n.appInfo.name,n.logger)},U=function(t){E||(n.bootHeartBeat&&n.bootHeartBeat.stop(),n.removeActionHandler(he.an,A),n.removeActionHandler(he.rn,R)),e(t)};s&&s.subscribe((function(){var e;U({completion:s.reason||"cancelled",documentLoadedWithTabSwitch:null===(e=n.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch})})),E||(n.addActionHandler(he.an,A),n.addActionHandler(he.rn,R)),gn(n.wdParams);var x=r.buildBootRequestParams(n),W=mn(n,x.appPageName,x.queryParamsOverrides),k=wn(n,x.postDataOverrides);if(n.bootstrapperUrl&&n.preconnector&&n.preconnector.shouldPreconnect(n.hostName)&&n.preconnector.preconnect(n.bootstrapperUrl),n.bootstrapperUrl&&n.preloader&&n.preloader.shouldPreload(W,n.host.origin))try{r.beforePreload&&r.beforePreload(n);var M=n.bootstrapperUrl;n.featureManager.isFeatureEnabled(se.Pt)&&(n.logger.ULS.Ue(590966791,i.B,o.Info,"HTTP2 preload enabled"),M=P(M)),n.preloader.preload(M,n.ui.language,n.logger,n.featureManager)}catch(e){n.logger.ULS.Ue(590966792,i.B,o.Error,"Error preloading")}r.beforeContainerBoot&&r.beforeContainerBoot(n,W),n.appInitDiagnostics.officeFrameCreateTime=$(),n.container.boot(W,k,n.logger,r.buildContainerBootParams(n)),E?A(he.an,{Diagnostics:{}}):(n.bootHeartBeat=new kt(m(n.appBaseUrl),n.yt,n.logger,(function(){var e;n.timeoutTime=$(),r.onTimeout&&r.onTimeout(n),G(n.remoteTelemetryUrl,n.application.name,"bootTimeout"),U({completion:"timeout",error:{documentLoadedWithTabSwitch:null===(e=n.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch}}),s&&s.cancel()}),s&&r.overrideBootTimeout?Math.min(s.timeoutInMs,r.overrideBootTimeout(n)):s?s.timeoutInMs:r.overrideBootTimeout?r.overrideBootTimeout(n):void 0),r.beforeBootCompletionMessage&&r.beforeBootCompletionMessage(n))})).catch((function(e){throw n.failureTime=$(),r.onException&&r.onException(n,e),n.remoteTelemetryUrl&&G(n.remoteTelemetryUrl,n.application.name,"bootException"),n.bootHeartBeat&&n.bootHeartBeat.stop(),{error:e.toString(),errorStack:e.stack}}))},In=function(e,t,n,r,s){return e!==he.dn?Promise.reject("Wrong flow"):new Promise((function(e){try{window.top&&window.top.close()}catch(e){n.logger.ULS.Ue(579213189,i.B,o.Warning,"Failed to close the browser tab")}e({completion:"success"})}))},bn=function(e,t,n){return new Promise((function(t){n.logger.ULS.Ue(590111070,i.B,o.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))},_n=function(){function e(e){var t=this;this.bc=!1,this._c="",this.yc=[],this.Tc=function(e){t.bc||(t.bc=!0,t._c=e?"timeout":"cancelled",t.yc.map((function(e){return e()})),t.yc=[])},this.Cc=e,window.setTimeout((function(){return t.Tc(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.bc},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.Cc},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this._c},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.Tc(!1)},e.prototype.subscribe=function(e){this.bc?e():this.yc.push(e)},e}();function yn(e){return new _n(e)}var Tn=function(e,t,n,r,s){return e!==fe.dispose?Promise.reject("Wrong flow"):new Promise((function(e){n.logger.ULS.Ue(595714433,i.B,o.Info,"start disposing the application");var a=n.host.requireExplicitUnload,c={disposeStartTime:$(),forceAppUnload:a};n.state=H.Disposing;var u=function(){n.state=H.Disposed,e({completion:"success"})},d=function(e){r&&r.disposeAppSpecificResources&&r.disposeAppSpecificResources(n,t),n.dispose(),c.disposeEndTime=$(),function(e,t,n){if(n){var r=Number(n.hostMessageReceived);t.appUnloadStartTime&&!isNaN(r)&&(t.hostToAppPostMessageLatency=r-t.appUnloadStartTime);var s=Number(n.appMessageSent);!isNaN(s)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-s);var a=Number(n.appUnloadStart),c=Number(n.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),n.serverTimings){var u=n.serverTimings;for(var d in u)t["st-"+d.toString()]=u[d]}}e.logger.ULS.Ue(592524822,i.B,o.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(n,c,e),n.container?n.container.dispose(n.pendingReboot,a).then(u):u()};if(a){c.appUnloadStartTime=$();n.addActionHandler(he.Yn,(function(e,t){c.appUnloadEndTime=$(),d(t)})),(s||new _n(5e3)).subscribe((function(){n.state===H.Disposing&&(c.appUnloadTimedOut=!0,d())})),n.container&&n.container.postMessage(pe.Ho,void 0)}else d()}))};var Cn=function(e,t,n,r,s){return e!==he.Tn?Promise.reject("Wrong flow"):new Promise((function(e){if(n.host.capabilities&&n.host.capabilities.frameTrustCheck)n.raiseEvent(ve.FrameTrust,t);else{var r=!!n.container&&n.container.isTopFrameTrusted;n.logger.ULS.Ue(592445957,i.B,o.Info,"Top frame is trusted: ".concat(r)),n.container&&n.container.postMessage(pe.Tn,{isTopFrameTrusted:r})}e({completion:"success"})}))},En=function(e,t,n,i,o){return e!==he.En?Promise.reject("Wrong flow"):new Promise((function(e){n.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(i){i?n.raiseEvent(ve.GetAuthToken,t):(n.container.postMessage(pe.yo,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(i){n.container.postMessage(pe.yo,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:i})}))}))},An=function(e,t,n,r,s){return e!==he.sn?Promise.reject("Wrong flow"):new Promise((function(e){var s=t&&t.state?t.state:"Unknown";n.logger.ULS.Ue(592839750,i.B,o.Info,"Boot state: [".concat(s,"]")),r&&r.beforeComplete&&r.beforeComplete(s),e({completion:"success"})}))},Pn=function(e,t,n,r,s){if(e!==fe.postWacToken)return Promise.reject("Wrong flow");var a=X();return n.logger.ULS.Ue(507774685,i.B,o.Important,"postWacToken flow initiated"),new Promise((function(e){var r=function(e,t){n.logger.ULS.Ue(507597017,i.B,o.Info,"postWacToken flow completed in ".concat(X()-a," ms")),window.clearInterval(u),window.clearTimeout(d);var r={completion:"success"};t&&void 0!==t.TokenAlreadySet&&(r.data={TokenAlreadySet:t.TokenAlreadySet}),s(r)},s=function(t){n.removeActionHandler(he.qi,r),e(t)},c=function(){var e;return null===(e=n.container)||void 0===e?void 0:e.postMessage(pe.Ko,t)};n.addActionHandler(he.qi,r),c();var u=window.setInterval(c,100),d=window.setTimeout((function(){window.clearInterval(u),n.logger.ULS.Ue(507844190,i.B,o.Warning,"postWacToken flow timed out after ".concat(6e4," milliseconds")),s({completion:"timeout"})}),6e4)}))},Fn=function(e,t,n,i,o){return e!==fe.rename?Promise.reject("Wrong flow"):new Promise((function(e){var i=function(e,n){var i={completion:n.NewName===t.NewName?"success":"failure"};s(i)},r=function(e,t){s({completion:"failure"})},s=function(t){n.removeActionHandler(he.In,i),n.removeActionHandler(he.bn,r),e(t)};n.addActionHandler(he.In,i),n.addActionHandler(he.bn,r),(o||new _n(5e3)).subscribe((function(){s({completion:"cancelled"})})),n.container&&n.container.postMessage(pe.bo,t)}))},On=function(e,t,n,i,o){return e!==fe.switchMode?Promise.reject("Wrong flow"):new Promise((function(e){var i=function(e,t){r({completion:"success"})},r=function(t){n.removeActionHandler(he.Un,i),e(t)};n.addActionHandler(he.Un,i),(o||new _n(5e3)).subscribe((function(){r({completion:"cancelled"})})),n.container&&n.container.postMessage(pe.No,t)}))};function Rn(e){}function Un(e){$t(e.logger)}function xn(e){return e.appBaseUrl+"/x/"}function Wn(e){return t=e.appBasePath+"_layouts/",n=e.sessionId,t+"RemoteTelemetry.ashx"+(n?"?usid="+n:"");var t,n}function kn(e){var t=e.appUrl,n=it(t),r=ot(t),s=rt(t);return n||r||s||e.logger.ULS.Ue(553673218,i.B,o.Warning,"Unknown endpoint: ".concat(A(t))),!(n||r)}function Mn(e){var t,n,i=e.appUrl,o=it(i),r=ot(i),s=rt(i),a=o?"_layouts/xlviewerinternal.aspx":r?"_layouts/xlembed.aspx":s?"_layouts/xlpreview.aspx":function(e){var t=e.toLowerCase().indexOf("/x/");if(t<0)return"";var n=e.indexOf("?");return n<0?e.substring(t+"/x/".length):n<t?"":e.substring(t+"/x/".length,n)}(i),c={},u={};_(c,"wdredirectionreason","Force_SingleStepBoot");var d=e.host.capabilities;d&&d.excelExternalLinks&&_(c,"xlel","1");var l=e.viewMode;l&&(l.hideToolbar&&_(c,"hvt","1"),l.hideEditUpsellDialog&&_(c,"hdeditdlg","1"));var f=e.bootParams;f&&f.isNewFile?(y(c,"unified"),_(c,"edit","1"),_(c,"new","1")):_(c,"instantedit","1"),_(u,Me.jr,JSON.stringify({HostInitializeDiagnostics:e.hostInitDiagnostics,ClientDiagnostics:e.clientDiagnostics}));var h=((t={})[Me.Gr]=e.hostName,t[Me.Qr]=e.user.id,t[Me.Fr]=(null===(n=e.file)||void 0===n?void 0:n.uniqueId)||"noDocId",t);Ct(e.logger,h,""),_(u,Me.Yr,h[Me.Yr]),h[Me.ts]&&_(u,Me.ts,h[Me.ts]),_(u,Me.ns,(new Intl.DateTimeFormat).resolvedOptions().timeZone);var p=e.rebootOverride;if(p){var v=p.mode;v&&("view"===(v=v.toLowerCase())?_(c,"wdforcedmode","View"):"edit"===v&&_(c,"wdforcedmode","Edit"))}var m=e.file.size;return m&&m>=52428800&&m<=104857600&&_(c,"ilf","1"),{appPageName:a,queryParamsOverrides:c,postDataOverrides:u}}function Nn(e,t){St(t)&&mt(e.logger,e.container.formId,e.featureManager,e.sessionId),Tt(e.logger,void 0,e),Qt(e.logger,void 0,e),on(e.logger,void 0,e)}function Hn(e){var t,n;return{permissionsPolicy:(n=e.appBaseUrl,"microphone ".concat(n,"; autoplay ").concat(n,"; camera ").concat(n,"; clipboard-read ").concat(n,"; clipboard-write ").concat(n,"; keyboard-map ").concat(n,"; display-capture ").concat(n)),useFrameFixForTeams:"teams"===(null===(t=e.host.uiHostName)||void 0===t?void 0:t.toLowerCase())}}var Dn,Ln=function(){var e,t;return[(e={},e[le.appReboot]=pn,e[le.boot]=Sn,e[le.closeTab]=In,e[le.createNew]=bn,e[le.dispose]=Tn,e[le.frameTrust]=Cn,e[le.getAuthToken]=En,e[le.getHostKeyValue]=Bt,e[le.handleBootState]=An,e[le.postWacToken]=Pn,e[le.rename]=Fn,e[le.setWacFlightValue]=Ht,e[le.setOverlayContent]=Lt,e[le.storeHostKeyValue]=jt,e[le.switchMode]=On,e[le.updateBootComplete]=bn,e),(t={},t[le.boot]={initializeAppContext:Rn,beforePreload:Un,buildAppBasePath:xn,buildRemoteTelemetryUrl:Wn,ignoreCompletionMessage:kn,buildBootRequestParams:Mn,beforeContainerBoot:Nn,buildContainerBootParams:Hn,onSuccess:gt},t[le.handleBootState]={beforeComplete:wt},t)]};!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(Dn||(Dn={}));var Vn=new an((function(e,t,n,i,o){return new dn(e,t,n,i,o)}),{forceSingleStepBoot:!1,preloader:U(ln,hn),preconnector:N(!0)}),Bn=function(e){var t={name:"Excel",preloader:U(ln,hn),preconnector:N(!0)};return new Be(e,t,Ln)}}});
//# sourceMappingURL=excel-boot.b658af6fad980fd22e86.js.map