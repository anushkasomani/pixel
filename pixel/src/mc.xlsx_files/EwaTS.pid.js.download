'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[15],{403:function(y,m,a){a.r(m);var c={};a.r(c);a.d(c,"EwaNotificationFocusManager",function(){return G});var b={};a.r(b);a.d(b,"FileOptimizationManager",function(){return Ga});var e={};a.r(e);a.d(e,"FormulaRemediationManager",function(){return ya});var k={};a.r(k);a.d(k,"LineageDiscoverabilityCallout",function(){return Pa});var d={};a.r(d);a.d(d,"OptimizeWorkbookManager",function(){return Qb});var u={};a.r(u);a.d(u,
"ShowCalloutCommandHandler",function(){return td});var n={};a.r(n);a.d(n,"TableIntelligenceDarkActivationManager",function(){return Ad});var v={};a.r(v);a.d(v,"TableIntelligenceManager",function(){return Ge});var f=a(127),w=a(0),r=a(2),t=a(15),l=a(306),x=a(284),A=a(112),z=a(1310),F=a(92),D=a(5);let G=class{constructor(ca){this.iud=this.aJd=null;this.H9c=this.isFocused=!1;this.$=ca}dispose(){}get ij(){return null}get ap(){return this.H9c}get el(){return x.a.M8d}Lp(ca,sb){sb||this.isFocused||!this.aJd||
this.aJd();return!sb}wq(ca){return ca===document.activeElement&&this.isFocused}Rs(){this.isFocused=!0}nu(){this.isFocused&&this.iud&&(this.iud(),this.isFocused=!1)}nWf(){t.ULS.shipAssertTag(537169939,0,A.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");const ca=Object(r.a)(new z.a,{onFirstActionableAppear:()=>{l.a(this.$).Wq(this);this.H9c=!0},onLastActionableDisappear:()=>{l.a(this.$).fI(this);
this.H9c=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(ca).then(sb=>{this.aJd=()=>{sb.focus()};this.iud=()=>{sb.blur()};return null})}};G=Object(f.__decorate)([Object(F.d)(D.Pb),Object(f.__param)(0,Object(D.Ob)())],G);Object(w.a)(G,"EwaNotificationFocusManager",null,[213,2,42]);var Q=a(80),O=a(433),J;(function(ca){ca[ca.Consent=0]="Consent";ca[ca.IndeterminateProgress=1]="IndeterminateProgress";ca[ca.DeterminateProgress=2]="DeterminateProgress";
ca[ca.Error=3]="Error";ca[ca.Completed=4]="Completed"})(J||(J={}));class H extends O.a{constructor(ca,sb){super(ca);sb.initializeCallbacks=this.initializeCallbacks.bind(this);ca=Object.assign({},{[H.Gz]:this.Ji,["hideCloseButton"]:!0},sb);this.Kl=sb.initialDialogState;this.initializeAndShow("",this.GOb,ca);this.z8g()}get Ji(){return"UserConsentBasedProgressDialog"}hide(ca){ca&&super.hide()}dispose(){super.dispose();window.onbeforeunload=null}Scj(ca,sb){this.ltg=ca;this.ktg=sb}zbc(ca){this.Kl=ca.dialogState;
this.G9k(ca);this.z8g()}initializeCallbacks(ca){this.G9k=ca}z8g(){window.onbeforeunload=this.Kl===J.DeterminateProgress||this.Kl===J.IndeterminateProgress?ca=>{ca.preventDefault();return ca.returnValue=!0}:null}GOb(ca){1===ca?(this.Kl===J.Consent&&this.ltg&&this.ltg(),this.Kl===J.Error&&this.hide(!0)):2!==ca&&0!==ca||this.Kl!==J.Consent||(this.hide(!0),this.ktg&&this.ktg(),this.dispose())}}Object(w.a)(H,"UserConsentBasedProgressDialog",O.a,[]);var N=a(12),L=a(190),Z=a(63),ba=a(7),K=a(184),E=a(1459),
U;(function(ca){ca[ca.OptimizationConsent=0]="OptimizationConsent";ca[ca.OptimizationSummary=1]="OptimizationSummary"})(U||(U={}));var X=a(25);class ia{constructor(){this.closeTaskPane=()=>{X.a.xp()?void F.a.resolve(D.lf,{va:0}).then(ca=>{ca.hideTaskPane("WorkbookOptimizationTaskPane")}):void K.a.fo().then(ca=>{ca.hideTaskPane("WorkbookOptimizationTaskPane",2)})};this.fq=!1}xue(ca,sb){X.a.xp()?void F.a.resolve(D.lf,{va:0}).then(Ba=>{this.fq?(Ba.updateTaskPane("WorkbookOptimizationTaskPane",this.Dib(U.OptimizationSummary,
sb,ca)),Ba.focusTabbedTaskPaneArea(2)):Ba.ZH("WorkbookOptimizationTaskPane",this.Dib(U.OptimizationSummary,sb,ca))}):void K.a.fo().then(Ba=>{if(this.fq)Ba.updateTaskPane("WorkbookOptimizationTaskPane",this.Dib(U.OptimizationSummary,sb,ca)),Ba.focusTabbedTaskPaneArea(2);else return Ba.showTaskPane("WorkbookOptimizationTaskPane",this.Dib(U.OptimizationSummary,sb,ca)),null})}oSk(ca){X.a.xp()?void F.a.resolve(D.lf,{va:0}).then(sb=>{sb.ZH("WorkbookOptimizationTaskPane",this.Dib(U.OptimizationConsent,void 0,
ca))}):void K.a.fo().then(sb=>{sb.showTaskPane("WorkbookOptimizationTaskPane",this.Dib(U.OptimizationConsent,void 0,ca));return null})}I7(){this.fq=!0}XC(){this.fq=!1}Dib(ca,sb,Ba){ca={type:"WorkbookOptimizationTaskPaneProps",taskPaneState:ca,summariesList:sb,hostAppCallbacks:Ba};return Object(r.a)(new E.a,{contentProps:ca,onOpen:()=>{this.I7()},onClose:()=>{this.XC()},width:320,title:N.a.instance.ia(2563)})}}Object(w.a)(ia,"WorkbookOptimizationTaskPaneController",null,[927]);var Ma=a(1);class qa extends Q.a{constructor(ca){super();
this.E3j=sb=>{this.$.oi(802602464,Z.a.ph,12,{[ba.a.QM]:"WorkbookOptimizationTaskPane",dpl:sb})};this.c4j=()=>{this.$.oi(-1112508866,Z.a.ph,12,{})};this.onLearnMoreLinkClick=()=>{t.ULS.sendTraceTag(507353219,0,50,"FileOptimizationUIController.onLearnMoreLinkClick: learn more link clicked")};this.$=ca}dispose(){var ca;this.wnd=this.$=null;null===(ca=this.$ja)||void 0===ca?void 0:ca.dispose();this.$ja=null;super.dispose()}Uaj(ca,sb,Ba){switch(ca){case "NotStarted":this.eJi(sb,Ba);break;case "Skipped":this.fJi(sb,
Ba)}}yWg(){this.jQk()}X_c(ca){switch(ca){case "NotStarted":case "Skipped":case "Automatic":this.iQk()}}pSk(ca){this.kQk(ca)}jQk(){this.$ja?this.zbc(J.IndeterminateProgress):this.xWf(!1)}iQk(){var ca,sb;(null===(sb=null===(ca=this.$ja)||void 0===ca?void 0:ca.vh)||void 0===sb?0:sb.zha)&&this.zbc(J.Error)}kQk(ca){this.zbc(J.Completed);const sb=Ma.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.UCBPDialogCompletedStateTimeoutMs",3E3);setTimeout(()=>{this.$ja.hide(!0);this.$ja.dispose();this.$ja=
null;this.xue(ca)},sb)}eJi(ca,sb){this.xWf(!0);this.$ja.Scj(ca,()=>{this.$ja=null;this.IQk(ca,sb)})}fJi(ca,sb){this.ODe.oSk({onOptimizeNowClick:ca,onDontShowAgainClick:()=>{this.ODe.closeTaskPane();sb()},onLearnMoreLinkClick:this.onLearnMoreLinkClick})}xWf(ca){this.$ja||(ca=this.TKi(ca),this.$ja=new H(this.$,ca))}get ODe(){this.wnd||(this.wnd=new ia);return this.wnd}IQk(ca,sb){t.ULS.sendTraceTag(507363655,0,50,"FileOptimizationUIController.showConfirmationDialog: User denied consent in optmization dialog.");
var Ba=N.a.instance.ia(2458),V=N.a.instance.ia(2459),Fa=N.a.instance.ia(2460),sc=N.a.instance.ia(2461);const Kc=new L.a;Kc.Oh=1;Kc.si(1,Fa);Kc.si(0,sc);Kc.So(Ba,V,0,qd=>{1===qd?ca():sb()})}TKi(ca){return ca?{initialDialogState:J.Consent,initialDialogTitle:N.a.instance.ia(2447),initialDialogDescription:N.a.instance.ia(2448),okButtonLabel:N.a.instance.ia(2449),cancelButtonLabel:N.a.instance.ia(2450),knowMoreLinkLabel:N.a.instance.ia(2451)}:{initialDialogState:J.IndeterminateProgress,initialDialogTitle:N.a.instance.ia(2454),
initialDialogDescription:N.a.instance.ia(2455),progressDescription:N.a.instance.ia(2456),knowMoreLinkLabel:N.a.instance.ia(2451)}}zbc(ca){let sb;switch(ca){case J.IndeterminateProgress:sb={dialogState:J.IndeterminateProgress,dialogTitle:N.a.instance.ia(2454),dialogDescription:N.a.instance.ia(2455),progressDescription:N.a.instance.ia(2456)};break;case J.DeterminateProgress:sb={dialogState:J.DeterminateProgress,dialogTitle:N.a.instance.ia(2452),dialogDescription:N.a.instance.ia(2453),progress:void 0,
progressDescription:N.a.instance.ia(2456)};break;case J.Error:sb={dialogState:J.Error,okButtonLabel:N.a.instance.ia(2464),progressDescription:N.a.instance.ia(2465)};break;case J.Completed:sb={dialogState:J.Completed,dialogTitle:N.a.instance.ia(2454),dialogDescription:N.a.instance.ia(2455)}}this.$ja.zbc(sb)}xue(ca){this.ODe.xue({openFeedback:this.E3j,onRevertLinkClick:this.c4j},ca)}}Object(w.a)(qa,"FileOptimizationUIController",Q.a,[]);const Ha={gka:"NotStarted",c7c:["Formulas"]},ha={gka:"Automatic"};
var La=a(128),fa=a(36),ja=a(707),ta=a(677),Ka;(Ka||(Ka={})).Formulas="Formulas";Object(w.b)("RemediationArea",Ka);let Ga=class extends Q.a{constructor(ca){super();this.$=ca;this.o_d=!0;this.B5b=new Map;this.pVj=sb=>{(this.uia=sb.Result)?this.Vel(this.uia.c7c)?(t.ULS.sendTraceTag(507363658,0,50,`FileOptimizationManager.onGetOptimizationMetadataSuccess: OptimizationStage: ${this.uia.gka}.
       RemediationArea: ${this.uia.c7c}.`),this.qzg(this.uia.gka)):"OptimizationNotRequired"!==this.uia.gka&&"Completed"!==this.uia.gka&&this.J4c(this.uia.gka,"Completed"):t.ULS.sendTraceTag(507363660,0,10,"FileOptimizationManager.onGetOptimizationMetadataSuccess: optimizationMetadata is null. Exiting optimization flow.")};this.J4c=(sb,Ba)=>{sb!==Ba&&(ha.gka=Ba,this.j8a(V=>{var Fa;V=null===(Fa=V.Result)||void 0===Fa?void 0:Fa.gka;sb===V?(t.ULS.sendTraceTag(507330767,0,10,"FileOptimizationManager.onUpdateOptimizationStageSuccess: optimizationStage not updated."),
this.pJa.X_c(sb)):(this.uia.gka=V,this.qzg(this.uia.gka))},ha,1E3,V=>{V=(null===V||void 0===V?0:V.data)?La.a.$j(V.data):null;t.ULS.sendTraceTag(507332164,0,10,`FileOptimizationManager.onUpdateOptimizationStageFailure: ${fa.a.fi(V)}`);this.pJa.X_c(sb)},sb))};this.initialize()}dispose(){var ca;this.yJg();null===(ca=this.CDb)||void 0===ca?void 0:ca.dispose();this.$=this.UAi=this.CDb=null;super.dispose()}get pJa(){this.CDb||(this.CDb=new qa(this.$));return this.CDb}initialize(){const ca=!this.$.fa.f0,
sb=this.$.isEditMode;ca||!sb?t.ULS.sendTraceTag(507363661,0,50,`FileOptimizationManager.initialize: Exiting optimization flow. areCoauthorsPresent: ${ca}, isEditMode: ${sb}`):this.XSi()}XSi(){this.j8a(this.pVj,Ha,1E3)}qzg(ca){switch(ca){case "NotStarted":case "Skipped":this.j0i(ca);break;case "Automatic":void this.dfj()}}j0i(ca){this.pJa.Uaj(ca,()=>{t.ULS.sendTraceTag(507363656,0,50,"FileOptimizationManager.OnUserConsentGiven: User provided consent.");this.pJa.yWg();this.J4c(ca,"Automatic")},()=>
{t.ULS.sendTraceTag(507363657,0,50,`FileOptimizationManager.OnUserConsentDenied: User denied consent in the OptimizationStage: ${ca}.`);let sb;switch(ca){case "Skipped":sb="OptimizationNotRequired";break;default:sb="Skipped"}this.J4c(ca,sb)})}dfj(){const ca=this;return xo(function*(){var sb;try{ca.CDb||ca.pJa.yWg();ca.gfh();for(const Ba of ca.uia.c7c){if(2===(null===(sb=ca.B5b.get(Ba))||void 0===sb?void 0:sb.status))continue;const V=yield ca.TVi(Ba);if(V)try{const Fa=yield V.wlk();ca.B5b.set(Ba,Fa)}catch(Fa){t.ULS.sendTraceTag(507332163,
0,10,`FileOptimizationManager.initiateAutomaticOptimization: ${null===Fa||void 0===Fa?void 0:Fa.message}`),ca.B5b.set(Ba,{status:3,Uwe:null})}}if(ca.Zlj()){const Ba=ca.WVi();ca.pJa.pSk(Ba);ca.J4c("Automatic","Completed")}else ca.pJa.X_c("Automatic")}catch(Ba){t.ULS.sendTraceTag(507332162,0,10,`FileOptimizationManager.initiateAutomaticOptimization: ${null===Ba||void 0===Ba?void 0:Ba.message}`),ca.pJa.X_c("Automatic")}finally{ca.yJg()}})}TVi(ca){const sb=this;return xo(function*(){switch(ca){case Ka.Formulas:return Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRemediation",
!1)?yield sb.UAi(0):null;default:return null}})}Vel(ca){if(!ca||0===ca.length)return t.ULS.sendTraceTag(507360341,0,50,"FileOptimizationManager.validateRemediationArea: No remediation area."),!1;for(const sb of ca)if(void 0!==Ka[sb])return!0;return!1}Zlj(){return Array.from(this.B5b.values()).every(ca=>2===(null===ca||void 0===ca?void 0:ca.status)||1===(null===ca||void 0===ca?void 0:ca.status))}WVi(){return Array.from(this.B5b.values()).filter(ca=>null===ca||void 0===ca?void 0:ca.Uwe).map(ca=>null===
ca||void 0===ca?void 0:ca.Uwe)}gfh(){this.o_d=!1;this.qZk();const ca=this.$.fa.workbookContext.CalcMode;0!==ca&&(this.lvd=ca,this.setCalculationMode(0))}yJg(){this.o_d=!0;this.Svk();this.lvd&&(this.setCalculationMode(this.lvd),this.lvd=null)}qZk(){this.zBa=new ja.a(this.$,ta.a.mwi,()=>this.o_d,2)}Svk(){var ca;null===(ca=this.zBa)||void 0===ca?void 0:ca.dispose();this.zBa=null}setCalculationMode(ca){this.$.oi(-988468372,Z.a.ph,8,{[Z.a.Pi]:ca})}j8a(ca,sb,Ba,V,Fa){setTimeout(()=>{const sc={};sc.Result=
null!==sb&&void 0!==sb?sb:Fa;ca?ca(sc):V&&V(null)},Ba)}};Object(f.__decorate)([Object(D.Sc)({WY:!0})],Ga.prototype,"formulaRemediationManagerLazy",void 0);Ga=Object(f.__decorate)([Object(F.d)(D.kc),Object(f.__param)(0,Object(D.Ob)())],Ga);Object(w.a)(Ga,"FileOptimizationManager",Q.a,[]);var Na=a(792),cb=a(64);const jb={Qfh:{SheetId1:3,SheetId2:2}},Sa={CurrentOffSet:0,UniqueFormulas:["=COUNTUNIQUE(A1:A7)","=ISBETWEEN(A1,A2,A3)","=ADD(A1,A7)"]},bb={CurrentOffSet:0,UniqueFormulas:["=AVERAGE.WEIGHTED(A1:A4,A6:A9)",
"=DIVIDE(A8,A11)"]},oa={primaryText:"50 formulas converted",secondaryText:"2300 cells optimized"};var ka=a(659);let ya=class{constructor(ca,sb){this.$=ca;this.pluginScheduler=sb;this.qja={};this.j1h=0;this.Iij=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BrokenFormulasTelemetry",!1);this.X2g=Ma.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.FormulaRemediationTranspilationChunkSize",250);this.wlk=()=>new Promise((Ba,V)=>{const Fa=this;return xo(function*(){try{Ba(yield Fa.efj())}catch(sc){V(Error("FormulaRemediationManager.remediate: "+
(null===sc||void 0===sc?void 0:sc.message)))}})});this.efj=()=>new Promise((Ba,V)=>{const Fa=this;return xo(function*(){try{yield Fa.Ndj();if(!Fa.qja||0===Object.keys(Fa.qja).length){const Kc=yield Fa.ZXi();for(const qd in Kc)Fa.qja[qd]={bpl:Kc[qd],xvb:0}}yield Fa.xlk();const sc=yield Fa.VVi();Ba({status:Fa.UVi(),Uwe:sc})}catch(sc){(null===sc||void 0===sc?0:sc.message)&&t.ULS.sendTraceTag(507332165,0,10,`FormulaRemediationManager.initiateAutomaticRemediation: ${sc.message}`),V(Error("Automatic remediation failed."))}})});
this.xlk=()=>new Promise(Ba=>{for(const V in this.qja)2!==this.qja[V].xvb&&this.ylk(V).then(()=>{this.qja[V].xvb=2;this.hsd()&&Ba()}).catch(Fa=>{t.ULS.sendTraceTag(507314977,0,10,`FormulaRemediationManager.remediateFormulas: ${Fa.message}`);this.qja[V].xvb=3;this.hsd()&&Ba()});this.hsd()&&Ba()});this.ylk=Ba=>new Promise((V,Fa)=>{const sc=this;return xo(function*(){try{const Kc=yield sc.O_i(Ba),qd=yield sc.T3k(Kc);yield sc.u0h(Ba,qd);V()}catch(Kc){Fa(Kc)}})});this.ZXi=()=>new Promise((Ba,V)=>{this.j8a(Fa=>
{var sc;(Fa=null===(sc=Fa.Result)||void 0===sc?void 0:sc.Qfh)||V(Error("onGetSheetsWithIncompatibleFormulasSuccess: data is null."));Ba(Fa)},jb,3E3,Fa=>{Fa=(null===Fa||void 0===Fa?0:Fa.data)?La.a.$j(Fa.data):null;V(Error(`onGetSheetsWithIncompatibleFormulasFailure: ${fa.a.fi(Fa)}`))})});this.O_i=Ba=>new Promise((V,Fa)=>{let sc=Sa;"SheetId2"===Ba&&(sc=bb);this.j8a(Kc=>{var qd;(Kc=null===(qd=Kc.Result)||void 0===qd?void 0:qd.UniqueFormulas)||Fa(Error("onGetUniqueIncompatibleFormulasSuccess: data is null."));
V(null!==Kc&&void 0!==Kc?Kc:[])},sc,1E3,Kc=>{Kc=(null===Kc||void 0===Kc?0:Kc.data)?La.a.$j(Kc.data):null;Fa(Error(`onGetUniqueIncompatibleFormulasFailure: ${fa.a.fi(Kc)}`))})});this.T3k=Ba=>new Promise((V,Fa)=>{let sc=[],Kc=Math.ceil(Ba.length/this.X2g);for(;0<Ba.length;){const qd=Ba.splice(0,this.X2g);this.S3k(qd).then(Eb=>{sc=[...sc,...Eb];1>--Kc&&V(sc)}).catch(Eb=>{Fa(Error(`transpileFormulas: ${null===Eb||void 0===Eb?void 0:Eb.message}`))})}});this.u0h=(Ba,V)=>new Promise((Fa,sc)=>{this.j8a(()=>
{Fa()},{SheetId:Ba,Zkl:V},1E3,Kc=>{Kc=(null===Kc||void 0===Kc?0:Kc.data)?La.a.$j(Kc.data):null;sc(Error(`FormulaRemediationManager.onCommitOptimizedFormulasFailure: ${fa.a.fi(Kc)}`))})});this.VVi=()=>new Promise((Ba,V)=>{this.j8a(()=>xo(function*(){Ba(oa)}),null,1E3,Fa=>{Fa=(null===Fa||void 0===Fa?0:Fa.data)?La.a.$j(Fa.data):null;V(Error(`FormulaRemediationManager.onGetRemediationSummariesFailure: ${fa.a.fi(Fa)}`))})});this.Ndj=()=>new Promise((Ba,V)=>{const Fa=this;return xo(function*(){try{const sc=
{payload:{incompatibilityType:ka.IncompatibilityType.gMove}};yield Fa.pluginScheduler.eventEmitter().FormulaTranspilerInitEvent(sc).then(()=>{Ba()})}catch(sc){V(Error("FormulaRemediationManager.initializeIncompatibilityType: "+(null===sc||void 0===sc?void 0:sc.message)))}})});this.p3j=Ba=>{Ba.Result&&t.ULS.sendTraceTag(507883930,0,50,"FormulaRemediationManager.onbrokenFormulasTelemetrySuccess: broken formula found")};this.Iij&&this.zAj()}dispose(){this.pluginScheduler=this.$=null}UVi(){let ca=!0,
sb=!0;for(const Ba in this.qja)2===this.qja[Ba].xvb?sb=!1:3===this.qja[Ba].xvb&&(ca=!1);return ca?2:sb?3:1}hsd(){return Object.values(this.qja).every(ca=>0!==ca.xvb)}S3k(ca){const sb=this;return xo(function*(){var Ba={formulaBatch:[]};for(const V of ca)Ba.formulaBatch.push({formula:V,refMode:ka.ReferenceMode.R1C1});Ba=yield sb.pluginScheduler.requester().getTranspiledFormulas(Ba,ka.PluginGroup.Excel,(sb.j1h++).toString());if("Done"!==Ba.kind)throw Error("Some Exception occurred at the FormulaTranspilerPlugin");
return Ba.payload.transpiledFormulas})}zAj(){var ca=this.$.oa.ta,sb=this.p3j;const Ba=ca.Za(1,null);cb.h(ca,"BrokenFormulasTelemetry",Ba,sb,null,null,null,4)}j8a(ca,sb,Ba,V,Fa){setTimeout(()=>{const sc={};sc.Result=null!==sb&&void 0!==sb?sb:Fa;ca?ca(sc):V(null)},Ba)}};ya=Object(f.__decorate)([Object(F.d)(D.Sc),Object(f.__param)(0,Object(D.Ob)()),Object(f.__param)(1,Object(Na.f)())],ya);Object(w.a)(ya,"FormulaRemediationManager",null,[851]);var Oa=a(1491),za=a(1131),ea=a(1132),Aa=a(186);class ub{constructor(ca){this.ZP=
null;this.$=ca}show(){const ca=this.ZJa();t.ULS.shipAssertTag(537169938,0,!!ca,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");K.a.IK().then(sb=>{const Ba=sb.callout(ca);this.ZP=sb.addNotification(Ba)},sb=>{t.ULS.sendTraceTag(537169936,0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${sb}`);return null})}dismiss(){this.ZP&&K.a.IK().then(ca=>{ca.removeNotification(this.ZP);return this.ZP=null})}P$a(ca){K.a.IK().then(sb=>{sb.updateNotification(this.ZP,sb.callout(Object.assign(new za.a,
ca)))},sb=>{t.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${sb}`);return null})}}Object(w.a)(ub,"EwaReactCallout",null,[910]);class rb{static ypb(ca){return!!(ca&1)}static XJc(ca){return!!(ca&2)}static o9g(ca){return!!(ca&rb.Oaj)}}rb.Oaj=6;Object(w.a)(rb,"EwaReactCalloutModeUtil",null,[]);class Ja{constructor(){this.dP=0;this.sMa=null;this.W$b=!0}}Object(w.a)(Ja,"EwaReactShowOrDismissCalloutMetadata",null,[]);var Xa=a(61),Y=a(40),Ia=a(134),$a=a(617);
class Ea{constructor(ca,sb,Ba){this.indexedDB=null;this.$=ca;this.JO=sb;this.$Wa=Ba}u3d(){const ca=new Aa.a,sb=new Ja;Y.TaskExtensions.$e(this.PPb(),Ba=>{Ba.result?Y.TaskExtensions.$e(this.indexedDB.rxa(this.JO),V=>{if(V=V.result){V=Xa.a.Vp(V);if(!V){this.Xzf(ca);return}if(rb.ypb(this.$Wa)){const Fa=V.NumberOfDisplays;sb.dP=Fa?Number.parseLocale(Fa):0}rb.XJc(this.$Wa)&&(V=V.LastDisplay,sb.sMa=V?new Date(Number.parseLocale(V)):null)}ca.setResult(sb)},this.$.ya):this.Xzf(ca)},this.$.ya,3);return ca.task}Rne(ca){const sb=
new Aa.a;Y.TaskExtensions.$e(this.PPb(),Ba=>{Ba.result||sb.setResult(!1);Ba={};rb.ypb(this.$Wa)&&(Ba.NumberOfDisplays=ca.dP.toString());rb.XJc(this.$Wa)&&(Ba.LastDisplay=Ia.toTimestamp(ca.sMa).m.toString());Ba=Xa.a.Di(Ba);Y.TaskExtensions.$e(this.indexedDB.BBa(new $a.a(this.JO,Ba)),V=>{sb.setResult(V.result)},this.$.ya,3)},this.$.ya,3)}PPb(){const ca=new Aa.a;this.indexedDB?ca.setResult(!0):void F.a.resolve(D.xd,{va:1}).then(sb=>{sb.zl()?(sb.initialize("Callouts","EwaCallouts"),this.indexedDB=sb,
ca.setResult(!0)):(t.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),ca.setResult(!1))});return ca.task}Xzf(ca){const sb=new Ja;sb.W$b=!1;ca.setResult(sb)}}Object(w.a)(Ea,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[894]);class Lb{constructor(ca,sb,Ba,V,Fa,sc){this.ahb=sb;this.chb=Ba;this.$Wa=V;this.JO=Fa;this.localStorage=sc;this.$=ca}u3d(){const ca=new Aa.a,sb=new Ja;if(rb.ypb(this.$Wa)){let Ba=0;sb.W$b=
(()=>{let V=this.w5k();({ica:Ba}=V);return V})().returnValue&&sb.W$b;sb.dP=Ba}ca.setResult(sb);return ca.task}Rne(ca){const sb=new Aa.a;var Ba=!0;if(rb.ypb(this.$Wa)){const V=this.IFf();V&&(Ba=Number.parseLocale(V),Ba=this.g6k((Ba&~this.chb|ca.dP<<this.ahb).toString()))}sb.setResult(Ba)}w5k(){var ca;return(ca=this.IFf())?(ca=(Number.parseLocale(ca)&this.chb)>>this.ahb,t.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.JO} already appeared. Found the callout in storage.`),
{returnValue:!0,ica:ca}):{returnValue:!1,ica:0}}g6k(ca){try{if(!this.localStorage.zl())return!1;try{return this.localStorage.setItem("CalloutIds",ca),!0}catch(sb){t.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${sb.message||"Unknown"}`)}}catch(sb){t.ULS.sendTraceTag(537169930,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${sb.message}`)}return!1}IFf(){try{if(!this.localStorage.zl())return t.ULS.sendTraceTag(537169929,
0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.JO}.`),null;const ca=this.localStorage.getItem("CalloutIds");return ca?ca:(t.ULS.sendTraceTag(537169928,0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(ca){return t.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${ca.message}`),
null}}}Object(w.a)(Lb,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[894]);var Ib=a(155),Mb=a(201),mc=a(156),jc=a(687);class Fc extends ub{constructor(ca,sb,Ba,V,Fa,sc,Kc,qd,Eb,vc,Kd,Zd,nb,ic,Bc,Qc,pd,Xd,ue){vc=void 0===vc?!1:vc;Kd=void 0===Kd?!1:Kd;Zd=void 0===Zd?!1:Zd;nb=void 0===nb?!1:nb;ic=void 0===ic?!1:ic;Bc=void 0===Bc?!0:Bc;Qc=void 0===Qc?!1:Qc;pd=void 0===pd?null:pd;Xd=void 0===Xd?!1:Xd;ue=void 0===ue?!1:ue;super(ca);this.dP=0;this.fDd=this.Yte=this.X5c=this.Y$g=!1;this.Qpg=
()=>{this.uGc()};this.G9c=sb;this.Ste=Ba;this.Wgi=V;this.kB=Fa;this.iA=sc;this.localStorage=Eb;this.F9c=Kc;this.E9c=qd;this.pyj=vc;this.SSd=Kd;this.Zgi=Zd;this.setInitialFocus=nb;this.useCoachmark=ic;this.LXc=!1;this.EGk=Bc;this.y0b=this.SNd();this.bhb=pd;this.Yte=Xd;this.hasDynamicSizing=Qc;this.fDd=ue}get wfb(){return{}}ZEe(){}gKa(){return 1}lBc(){return 0}get ica(){return 1}get kyg(){return!0}get JO(){return this.G9c}get chb(){return this.F9c}get ahb(){return this.E9c}show(){Y.TaskExtensions.$e(this.dra(),
ca=>{ca.result&&this.eue()},this.$.ya)}N9f(){mc.b(this.$).sj(Ib.a.Nwf,this.xOf("dismiss"),void 0,!0)}V$f(){mc.b(this.$).sj(Ib.a.Nwf,this.xOf("show"),void 0,!0)}ZJa(){var ca=Object(r.a)(new Oa.a,{label:this.Wgi,onExecute:()=>{this.ZEe();this.N9f();this.X5c=!0;this.uGc()}});let sb=null;this.SSd||(sb=Object(r.a)(new Oa.a,{label:this.Ste,onExecute:()=>{this.X5c=!0;this.V$f();const V=Mb.c({["InputMethod"]:Z.a.ph},this.wfb);this.$.Ia.qh(this.ribbonCommandInfo,V);this.uGc()}}));const Ba=this.fDd||this.SSd?
ca:sb;ca=this.SSd?null:this.fDd?sb:ca;return Object(r.a)(new za.a,{target:this.Hxa(),content:this.iA,title:this.kB,primaryButtonProps:Ba,secondaryButtonProps:ca,showCloseIcon:this.Yte,preventLightDismiss:!this.pyj,hasDynamicSizing:this.hasDynamicSizing,calloutProps:Object(r.a)(new ea.a,{onDismiss:()=>{this.uGc()},directionalHint:this.bhb,preventDismissOnScroll:!0,preventDismissOnResize:!this.Zgi,isBeakVisible:this.EGk,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,
useCoachmark:this.useCoachmark})}uGc(){this.Y$g=!0;const ca=F.a.lh(D.cf);ca&&ca.Ypk(this.Qpg);(this.kyg&&this.X5c||this.Yte)&&this.r4g(!0);this.X5c||t.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.JO} was dismissed without user interaction`);this.dismiss()}dra(){const ca=new Aa.a;this.jha()?Y.TaskExtensions.$e(this.y0b.u3d(),sb=>{var Ba=this.gKa();sb=sb.result;if(sb.W$b)if(this.dP=sb.dP,rb.ypb(Ba)&&(this.LXc||sb.dP>=this.ica))t.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.JO} already appeared. Found the callout in storage.`),
this.LXc=!0,ca.setResult(!1);else{if(rb.XJc(Ba)&&sb.sMa&&(Ba=Ia.getElapsedSeconds(sb.sMa,new Date),(sb=this.lBc())||t.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.JO} with mode RestrictedBycooldown`),Ba<sb)){ca.setResult(!1);return}Ba=!this.ZP&&!!this.Hxa()&&!jc.a(this.$);ca.setResult(Ba)}else ca.setResult(!1),t.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.JO}.`)},this.$.ya):
ca.setResult(!1);return ca.task}jha(){return!0}Hxa(){if(document.querySelector(this.gT))return this.gT;if(document.querySelector(this.fT))return this.fT;if(document.querySelector(this.DS))return this.DS;t.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.JO}`);return null}r4g(ca){ca=void 0===ca?!1:ca;this.LXc=!0;const sb=new Ja;sb.dP=ca?this.ica:this.dP+1;sb.sMa=new Date;this.y0b.Rne(sb)}eue(){this.LXc=!0;this.r4g();
t.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.JO} callout, current number of displayes: ${this.dP}`);void F.a.uj(D.cf).then(ca=>{this.Y$g||ca.kFh(this.Qpg)});super.show()}SNd(){const ca=this.gKa();return rb.o9g(ca)?new Ea(this.$,this.JO,ca):new Lb(this.$,this.ahb,this.chb,ca,this.JO,this.localStorage)}xOf(ca){return{["selection"]:ca,["callout"]:this.JO,["Location"]:"floatie",["displayCount"]:this.dP}}}Object(w.a)(Fc,"EwaReactShowOrDismissCallout",ub,[]);var Gc=a(84),
xc=a(267),Uc;let Pa=Uc=class extends Fc{constructor(ca){super(ca,Uc.vyj,N.a.instance.Aa(650),N.a.instance.Aa(652),N.a.instance.Aa(648),N.a.instance.Aa(649),3072,10,new xc.a)}HUg(){return this.dra()}get gT(){return"[data-unique-id=Review]"}get fT(){return"[data-unique-id=pivotOverflowButton]"}get DS(){return'[id="'+this.$.xi+'Ribbon.Review-title"]'}get kyg(){return!1}get ribbonCommandInfo(){return new Gc.a(1834994092,Z.a.ph,this.$.ji,9,null)}get ica(){return 2}gKa(){return 3}lBc(){return 86400}jha(){return this.$.fa.Vqb}};
Pa.vyj="LineageDiscoverabilityCallout";Pa=Uc=Object(f.__decorate)([Object(F.d)(D.Od),Object(f.__param)(0,Object(D.Ob)())],Pa);Object(w.a)(Pa,"LineageDiscoverabilityCallout",Fc,[849]);var Bb=a(224);const Nb=(ca,sb,Ba,V,Fa,sc,Kc)=>{Kc=ca.Za(1,void 0===Kc?null:Kc);Kc.sheetName=sb;return cb.h(ca,"EvaluateSheetOptimizableContent",Kc,Ba,V,Fa,sc,4)};var oc=a(23),aa=a(47),rc=a(154);class yb{constructor(ca,sb){this.sessionID=null;this.yug=Ba=>{if(Ba){let V=aa.d(Ba.data);({Fz:Ba}=V);if(V.returnValue&&(Ba=Object(rc.a)(Object,
Ba))&&"OptimizeWorkbookTaskPane"===Ba.Origin)if(this.sessionID!==Ba.SessionId)t.ULS.sendTraceTag(509748062,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(Ba.Event){case "CoauthorsDetected":this.o4j.FQk();t.ULS.sendTraceTag(508117312,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Coauth error dialog shown.");break;default:t.ULS.sendTraceTag(509748060,
0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};this.o4j=ca;this.sessionID=sb}initialize(){window.addEventListener("message",this.yug,!1)}dispose(){window.removeEventListener("message",this.yug,!1)}}Object(w.a)(yb,"OptimizeWorkbookTaskPaneListener",null,[]);var Fb=a(91);let Qb=class extends Q.a{constructor(ca){super();this.businessBar=null;this.xDb=2;this.PFb=-1;this.MXc=!1;this.i3b=null;this.vEc=!1;this.USj=sb=>{this.$&&((sb=sb.Result)?
sb.HasSignificantOptimizableContent?(t.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.fa.$ea(this.aF),sb.OptimizableRangesOrPercentage&&(this.PFb=sb.OptimizableRangesOrPercentage),0>=this.PFb&&0!==this.xDb&&(t.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),
this.xDb=0),Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&!sb.Completed?t.ULS.sendTraceTag(508170697,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation was marked as not complete"):this.V8a()):t.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):t.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};this.x_j=
(sb,Ba,V)=>{(sb=sb.Result)?sb.HasSignificantOptimizableContent?(t.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),this.MXc=!0,this.kTk(Ba,V)):t.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):t.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.aF=(sb,Ba)=>{sb=1<Ba.n9g;this.vEc||
sb?this.vEc&&sb&&(this.businessBar&&this.businessBar.U6(62)&&(t.ULS.sendTraceTag(508170695,0,50,"OptimizeWorkbookManager.onUserListChanged: Hide the business bar"),this.aha()),this.$.fa.l8(this.aF)):(this.V8a(),this.vEc=!0,t.ULS.sendTraceTag(508170696,0,50,"OptimizeWorkbookManager.onUserListChanged: Show the business bar"))};this.$=ca;this.GWk();this.MXc=!1;this.Mji=Ma.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",2E3);this.i3b=new yb(this,this.$.fa.sessionId)}dispose(){this.aha();
Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.fa.l8(this.aF);this.$=this.businessBar=null;this.Jrf();super.dispose()}Sej(){this.i3b&&this.i3b.initialize()}Jrf(){this.i3b&&this.i3b.dispose()}aha(){this.businessBar&&this.businessBar.U6(62)&&this.businessBar.removeEntry(62)}GWk(){Bb.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ca=>{ca.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",!1).then(sb=>{if(sb){var Ba=
this.$.oa.ta,V=this.xDb,Fa=this.USj;const sc=Ba.Za(1,null);sc.businessBarMessageType=V;cb.h(Ba,"EvaluateOptimizableContentV2",sc,Fa,null,null,null,4)}return sb})})}V8a(){this.vEc=!0;const ca=Object(Fb.d)(F.a.resolve(D.E,{va:1}));Y.TaskExtensions.$e(ca,()=>{const sb=ca.result;sb&&(sb.Rm(62,null,null,this.eHi()),this.businessBar=sb)},this.$.ya,3)}eHi(){switch(this.xDb){default:return N.a.instance.ia(2239);case 1:return String.format(N.a.instance.Aa(720),this.PFb);case 2:return String.format(N.a.instance.Aa(721),
this.PFb)}}Nja(ca,sb,Ba){if(sb&&sb.RequestTelemetryData&&!(sb.RequestTelemetryData.EcsOperationDuration<this.Mji)&&this.businessBar&&this.businessBar.U6(62)&&!this.MXc){var V=Ba?Ba:this.$.la.sheetName;if(6===ca||7===ca||8===ca||9===ca)this.evaluateSheetOptimizableContent(V,ca,sb.RequestTelemetryData.EcsOperationDuration);else{const Fa=()=>{oc.f(this.$).za.Ax(Fa);this.evaluateSheetOptimizableContent(V,ca,sb.RequestTelemetryData.EcsOperationDuration)};oc.f(this.$).za.qy(Fa)}}}evaluateSheetOptimizableContent(ca,
sb,Ba){Nb(this.$.oa.ta,ca,V=>{this.x_j(V,sb,Ba)},null,null,null)}kTk(ca,sb){const Ba=new Gc.a(-847286761,Z.a.ph,this.$.ji,0,null),V={CalloutName:18};V.Target=this.businessBar.jLd(62);V.Operation=ca;V.Duration=sb;this.$.Ia.qh(Ba,V)}FQk(){const ca=new L.a;ca.Oh=0;ca.So(N.a.instance.Aa(874),N.a.instance.Aa(875),0)}};Qb=Object(f.__decorate)([Object(F.d)(D.ve),Object(f.__param)(0,Object(D.Ob)())],Qb);Object(w.a)(Qb,"OptimizeWorkbookManager",Q.a,[850]);var ac=a(10);const Wa='[id="'+ac.a.sZg+'"]';class Gb extends Fc{constructor(ca,
sb,Ba,V,Fa,sc,Kc,qd,Eb,vc){super(ca,sb,null,Ba,V,Fa,sc,Kc,new xc.a,qd,!0,!0,Eb,!1,!1,void 0,vc)}get gT(){return Wa}get fT(){return Wa}get DS(){return Wa}get ribbonCommandInfo(){return new Gc.a(-847286761,Z.a.ph,this.$.ji,0,null)}jha(){return!(this.$.isMobileMode||this.$.fa.Kh.inEmbedView||this.$.fa.Kh.inWebPart)}}Object(w.a)(Gb,"ZoomTeachingCallout",Fc,[]);class Ub extends Gb{constructor(ca){super(ca,"AdjustZoomTeachingCallout",N.a.instance.Aa(694),null,N.a.instance.Aa(693),2,1,!1,!0,2)}}Object(w.a)(Ub,
"AdjustZoomTeachingCallout",Gb,[]);class Ra extends Fc{constructor(ca){super(ca,"ConditionalFormattingManageRulesTeachingCallout",N.a.instance.Aa(643),N.a.instance.Aa(644),N.a.instance.Aa(641),N.a.instance.Aa(642),2,1,new xc.a)}get gT(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get fT(){return'[data-unique-id="RibbonOverflowMenu"]'}get DS(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new Gc.a(-20558303,Z.a.ph,this.$.ji,0,null)}}Object(w.a)(Ra,
"ConditionalFormattingManageRulesTeachingCallout",Fc,[]);var Rb;(function(ca){ca[ca.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";ca[ca.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";ca[ca.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";ca[ca.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";ca[ca.lineageDiscoverability=4]="lineageDiscoverability";ca[ca.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";ca[ca.adjustZoomTeachingCallout=
7]="adjustZoomTeachingCallout";ca[ca.linkedEntityGallery=8]="linkedEntityGallery";ca[ca.fixedFreezePane=9]="fixedFreezePane";ca[ca.phoneticTeachingCallout=10]="phoneticTeachingCallout";ca[ca.powerQueryCallout=11]="powerQueryCallout";ca[ca.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";ca[ca.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";ca[ca.tableInNewWorkbook=14]="tableInNewWorkbook";ca[ca.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";
ca[ca.dataCleansing=16]="dataCleansing";ca[ca.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";ca[ca.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";ca[ca.functionDialog=21]="functionDialog";ca[ca.fullScreen=22]="fullScreen";ca[ca.length=23]="length";ca[ca.gotoCtrlClick=24]="gotoCtrlClick"})(Rb||(Rb={}));Object(w.b)("EwaCalloutName",Rb);var ib=a(42);class la extends Gb{constructor(ca){super(ca,"FixedFreezePaneTeachingCallout",N.a.instance.Aa(647),
N.a.instance.Aa(645),N.a.instance.Aa(646),65536,16,!0,!1,8)}gKa(){return 0}}Object(w.a)(la,"FixedFreezePaneTeachingCallout",Gb,[]);var db=a(108),$b=a(60),Ic=a(28),Tc=a(1156);class Zc extends Tc.a{constructor(ca){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=ca.paragraphs;this.image=ca.image;this.imageWidth=ca.imageWidth;this.imageHeight=ca.imageHeight}}Object(w.a)(Zc,"TextAboveImage",Tc.a,[]);class cc{constructor(ca,sb){this.imageHeight=this.imageWidth=
this.image=this.paragraphs=null;this.paragraphs=ca;this.image=sb}}Object(w.a)(cc,"TextAboveImageCustomProps",null,[]);var Yc=a(1155),Vc=a(363);class wd extends ub{constructor(ca){super(ca);this.POg=0;this.h9a=this.target=null;this.e5c=!1;this.iA=this.kB=null;this.Rtd=0}BY(ca,sb,Ba,V,Fa,sc){if(!this.Vu()){switch(V){case "DataTypes_PBI":this.Rtd=1;break;default:this.Rtd=0}this.target=ca;this.kB=String.format(N.a.instance.Aa(676),sb);this.iA=String.format(N.a.instance.Aa(677),Ba);this.POg=sc;this.GDk(V,
Fa)}}GDk(ca,sb){const Ba=!!this.$.ua&&Ic.a.equals(this.$.ua.UICultureTag,"en-us",!0);this.e5c=sb&&Ba;sb&&!Ba?this.h9a="BlankCell":ca?this.h9a=ca:(t.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),this.h9a="BlankCell")}show(){t.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.iA&&!!this.kB,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Vu()||(t.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}Vu(){return!!this.ZP}ZJa(){const ca=Object(r.a)(new Oa.a,{label:N.a.instance.Aa(682),ariaDescription:N.a.instance.Aa(683),onExecute:()=>{t.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),sb=Object(r.a)(new Oa.a,{label:this.e5c?N.a.instance.Aa(680):N.a.instance.Aa(678),
ariaDescription:this.e5c?N.a.instance.Aa(681):N.a.instance.Aa(679),onExecute:()=>{t.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.e5c?"Try sample data":"Learn more")+'" button');var sc=new Map;sc.set("Domain",this.POg.toString());db.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",Vc.b.FailureBased,"ropari",sc);sc=new Gc.a(-859308420,Z.a.ph,this.$.ji,9,null);this.$.Ia.qh(sc,{[Z.a.hl]:"HelpID="+this.h9a,["InputMethod"]:Z.a.ph,
["ShouldCanvasTakeFocus"]:!0,[Z.a.Pi]:ba.a.NK});this.dismiss()}});var Ba=!!this.$&&!!this.$.frame&&!!this.$.frame.cN&&this.$.frame.cN.JY;switch(this.Rtd){case 1:var V=Ba?128:125;break;default:V=Ba?127:122}V=Object(r.a)(new Yc.a($b.a.current.Tu(V)),{alt:N.a.instance.sh(184)});const Fa=this.iA.split("\n\n");Ba=Object(r.a)(new cc(Fa,V),{imageWidth:280,imageHeight:Ba?142:192});Ba=new Zc(Ba);return Object(r.a)(new za.a,{target:this.target,content:Ba,title:this.kB,primaryButtonProps:sb,secondaryButtonProps:ca,
showCloseIcon:!0,calloutProps:Object(r.a)(new ea.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(w.a)(wd,"LinkedEntityBlankCellConvertTeachingCallout",ub,[]);class wc extends Fc{constructor(ca){super(ca,"LinkedEntityFirstOrganizationDataCallout",N.a.instance.Aa(672),N.a.instance.Aa(674),N.a.instance.Aa(670),N.a.instance.Aa(671),8192,13,new xc.a,
void 0,void 0,!0,!0);this.target=null;this.h9a="DataTypes_PBI"}get gT(){return this.target.toString()}get fT(){return this.target.toString()}get DS(){return'[id="'+this.$.xi+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new Gc.a(-859308420,Z.a.ph,this.$.ji,9,null)}get wfb(){return{[Z.a.hl]:"HelpID="+this.h9a,["ShouldCanvasTakeFocus"]:!0,[Z.a.Pi]:ba.a.NK}}BY(ca){this.Vu()||(this.target=ca,this.h9a="DataTypes_PBI")}Vu(){return!!this.ZP}jha(){t.ULS.shipAssertTag(537169921,0,!!this.target,
"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Vu()}}Object(w.a)(wc,"LinkedEntityFirstOrganizationDataTeachingCallout",Fc,[]);class Ya extends Fc{constructor(ca){super(ca,"LinkedEntityGalleryTeachingCallout","",N.a.instance.Aa(682),N.a.instance.Aa(684),N.a.instance.Aa(685),49152,14,new xc.a,void 0,!0,!0,!0,!0);this.target=null;this.bhb=5}get ica(){return 2}get gT(){return this.target.toString()}get fT(){this.bhb=
7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get DS(){return""}get ribbonCommandInfo(){return new Gc.a(-847286761,Z.a.ph,this.$.ji,0,ba.a.fvb)}show(){t.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Vu()||(t.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),super.show())}BY(ca){this.Vu()||
(this.target=ca)}Vu(){return!!this.ZP}jha(){t.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Vu()}}Object(w.a)(Ya,"LinkedEntityGalleryTeachingCallout",Fc,[]);var ob=a(13);class Cb extends ub{constructor(ca){super(ca);this.iA=this.kB=this.target=null}BY(ca,sb,Ba){this.Vu()||(this.target=ca,this.kB=String.format(N.a.instance.sh(186),
sb),this.iA=String.format(N.a.instance.sh(188),Ba))}show(){t.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.iA&&!!this.kB,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Vu()||(t.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),super.show())}Vu(){return!!this.ZP}ZJa(){const ca=Object(r.a)(new Oa.a,{label:N.a.instance.ia(1806),
ariaDescription:N.a.instance.ia(1807),onExecute:()=>{t.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');db.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",Vc.b.FailureBased,"ropari",null);ob.HelperMethods.Em("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});var sb=Object(r.a)(new Yc.a($b.a.current.Tu(this.$&&this.$.frame&&this.$.frame.cN&&
this.$.frame.cN.JY?129:126)),{alt:N.a.instance.sh(189)});sb=Object(r.a)(new cc([this.iA],sb),{imageWidth:280,imageHeight:142});sb=new Zc(sb);return Object(r.a)(new za.a,{target:this.target,content:sb,title:this.kB,primaryButtonProps:ca,showCloseIcon:!0,calloutProps:Object(r.a)(new ea.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(w.a)(Cb,
"LinkedEntityNoCuratedDataTeachingCallout",ub,[]);var Wb=a(183);class ad extends ub{constructor(ca){super(ca);this.iA=this.kB=null}BY(ca){this.Vu()||(this.target=ca,this.jEk())}show(){t.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.iA&&!!this.kB,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Vu()||(t.ULS.sendTraceTag(526234851,0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),
Wb.a.sendTelemetryEvent({name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"}),super.show())}Vu(){return!!this.ZP}ZJa(){return Object(r.a)(new za.a,{target:this.target,title:this.kB,content:this.iA,showCloseIcon:!0,calloutProps:Object(r.a)(new ea.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}jEk(){let ca=-1,sb=0;const Ba=
F.a.lh(D.ve);Ba&&(ca=Ba.PFb,sb=Ba.xDb);switch(sb){default:this.kB=N.a.instance.Aa(722);this.iA=N.a.instance.Aa(725);break;case 1:this.kB=String.format(N.a.instance.Aa(723),ca);this.iA=N.a.instance.Aa(726);break;case 2:this.kB=String.format(N.a.instance.Aa(724),ca),this.iA=N.a.instance.Aa(726)}}}Object(w.a)(ad,"OptimizeWorkbookBusinessBarCallout",ub,[]);var $c=a(151);class Ld extends Fc{constructor(ca,sb,Ba,V,Fa,sc,Kc,qd,Eb){qd=void 0===qd?!1:qd;super(ca,void 0===Eb?"OverrideBrowserShortcutsTeachingCallout":
Eb,sb,Ba,V,Fa,sc,Kc,new xc.a,qd)}get gT(){return"[data-unique-id=Help]"}get fT(){return"[data-unique-id=pivotOverflowButton]"}get DS(){return'[id="'+this.$.xi+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new Gc.a(-1018439626,Z.a.ph,this.$.ji,0,ba.a.g8)}jha(){return!$c.a.get(ba.a.o9b)}}Object(w.a)(Ld,"OverrideBrowserShortcutsTeachingCallout",Fc,[]);class jd extends Ld{constructor(ca,sb,Ba,V,Fa,sc,Kc,qd){super(ca,sb,Ba,V,Fa,sc,Kc,void 0===qd?!1:qd,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new Gc.a(-901364793,
Z.a.ph,this.$.ji,0,ba.a.g8)}get wfb(){return{[ba.a.Dce]:!1}}}Object(w.a)(jd,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",Ld,[]);var Td=a(59);class re extends Fc{constructor(ca,sb,Ba,V,Fa,sc,Kc,qd,Eb,vc,Kd,Zd,nb,ic,Bc,Qc,pd,Xd,ue){super(ca,sb,Ba,V,Fa,sc,qd,Eb,vc,void 0===Kd?!1:Kd,void 0===Zd?!1:Zd,void 0===nb?!1:nb,void 0===ic?!1:ic,void 0===Bc?!1:Bc,void 0===Qc?!0:Qc,void 0===pd?!1:pd,void 0===Xd?null:Xd,void 0===ue?!1:ue);this.learnMoreUrl=null;this.learnMoreUrl=Kc}U3j(){try{Td.a.kY(this.learnMoreUrl)}catch(ca){}}ZEe(){null!=
this.learnMoreUrl&&this.U3j()}}Object(w.a)(re,"EwaReactShowOrLearnMoreCallout",Fc,[]);const Nd='[id="'+ac.a.sZg+'"]';class uc extends re{constructor(ca){super(ca,"PhoneticTeachingCallout",N.a.instance.Aa(695),N.a.instance.Aa(698),N.a.instance.Aa(697),N.a.instance.Aa(696),"https://go.microsoft.com/fwlink/?linkid=2194045",131072,17,new xc.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get gT(){return Nd}get fT(){return Nd}get DS(){return Nd}get ribbonCommandInfo(){return new Gc.a(1455037301,Z.a.ph,
this.$.ji,0,null)}N9f(){t.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}V$f(){t.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(w.a)(uc,"PhoneticTeachingCallout",re,[]);var pc=a(170);class Hd extends Fc{constructor(ca,sb,Ba,V,Fa,sc){super(ca,sb,N.a.instance.Aa(708),N.a.instance.Aa(707),N.a.instance.Aa(703),Ba,V,Fa,new xc.a,!0,!1,void 0,void 0,void 0,!0,!0);this.bhb=5;this.ZWa=sc}get ica(){return 2}get gT(){return 1===pc.a(this.$).iW?
"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get fT(){return"[data-unique-id=Connections_MLR"}jha(){return this.ZWa}get DS(){return'[id="'+this.$.xi+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new Gc.a(-859308420,Z.a.ph,this.$.ji,9,null)}get wfb(){return{[Z.a.hl]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[Z.a.Pi]:ba.a.NK}}B9b(){return this.dra()}show(){this.Hxa()?super.show():t.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}
Object(w.a)(Hd,"PowerQueryRefreshTeachingCalloutBase",Fc,[]);class wb extends Hd{constructor(ca){super(ca,"PowerQueryRefreshFromTableTeachingCallout",N.a.instance.Aa(705),3145728,20,Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"))}}Object(w.a)(wb,"PowerQueryRefreshFromTableTeachingCallout",Hd,[]);class Xb extends Fc{constructor(ca){super(ca,"QueriesTaskPaneTeachingCallout",N.a.instance.Aa(702),N.a.instance.Aa(701),N.a.instance.Aa(849),N.a.instance.Aa(850),12582912,22,
new xc.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.bhb=5;this.ZWa=Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations")}get ica(){return 2}get gT(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get fT(){return"[data-unique-id=Connections_MLR]"}get DS(){return'[id="'+this.$.xi+'Ribbon.Data.Queries"]'}B9b(){return this.dra()}show(){this.Hxa()?super.show():t.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}jha(){return this.ZWa}get ribbonCommandInfo(){return new Gc.a(1156885807,
Z.a.ph,this.$.ji,0,ba.a.fvb)}}Object(w.a)(Xb,"QueriesTaskPaneTeachingCallout",Fc,[]);var Kb=a(495),Zb=a(216),Oc=a(688),Cd=a(255),Wd=a(265);class ee extends Hd{constructor(ca){super(ca,"PowerQueryAuthenticatedRefreshTeachingCallout",N.a.instance.Aa(706),805306368,28,Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1))}}Object(w.a)(ee,"PowerQueryAuthenticatedRefreshTeachingCallout",Hd,[]);class he extends Fc{constructor(ca){super(ca,"PowerQueryClearAllPermissionsTeachingCallout",
N.a.instance.Aa(708),N.a.instance.Aa(701),N.a.instance.Aa(852),N.a.instance.Aa(853),3,32,new xc.a,!0,!1,void 0,void 0,void 0,!0,!0);this.bhb=5;this.ZWa=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",!1)}get ica(){return 2}get gT(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get fT(){return"[data-unique-id=Connections_MLR]"}get DS(){return'[id="'+this.$.xi+'Ribbon.Data.Queries"]'}B9b(){return this.dra()}show(){this.Hxa()?super.show():t.ULS.sendTraceTag(508687132,
0,10,"PowerQueryClearAllPermissionsTeachingCallout.Show: Target object is null.")}jha(){return this.ZWa}get ribbonCommandInfo(){return new Gc.a(-859308420,Z.a.ph,this.$.ji,9,null)}get wfb(){return{[Z.a.hl]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[Z.a.Pi]:ba.a.NK}}}Object(w.a)(he,"PowerQueryClearAllPermissionsTeachingCallout",Fc,[]);class pe{constructor(ca){this.SRf=this.tSf=!1;this.dra=!0;this.FVj=sb=>{if(sb&&!Cd.a(sb))try{const Ba=sb.Result,V=Ba.QueryGroups;if(0<Ba.Queries.length||
0<V.length)this.tSf=!0,this.SRf=Ba.PowerQueryDataSources?Ba.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||Ba.PowerQueryDataSources.includes("OData.Feed"):!1,void this.HRk()}catch(Ba){t.ULS.sendTraceTag(537168095,0,10,`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${Ba}.`)}};this.WPc=()=>{t.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=ca;this.Uzg=new Xb(ca);this.powerQueryClearAllPermissionsCallout=new he(ca);this.see=
Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new ee(ca):new wb(ca)}show(){this.dra&&this.PBk()}PBk(){this.$.userOperationManager.enqueueOperation(new Zb.a(587,0,(ca,sb,Ba)=>Oc.d(this.$.oa.ta,Wd.c(ca,this.FVj),Wd.b(sb,this.WPc),Ba,null),80,()=>new Kb.a),null)}HRk(){const ca=this;return xo(function*(){(yield Fb.c(ca.Uzg.B9b()))&&ca.tSf?ca.Uzg.show():(yield Fb.c(ca.see.B9b()))&&(ca.see instanceof ee||ca.SRf)?ca.see.show():(yield Fb.c(ca.powerQueryClearAllPermissionsCallout.B9b()))&&
ca.powerQueryClearAllPermissionsCallout.show();ca.dra=!1})}}Object(w.a)(pe,"PowerQueryCallout",null,[910]);class Se extends ub{constructor(ca){super(ca);this.A8d=this.pzd=this.iA=this.kB=this.target=null}BY(ca,sb,Ba){this.Vu()||(this.target=ca,this.pzd=sb,this.A8d=Ba,this.kB=N.a.instance.Aa(710),this.iA=N.a.instance.Aa(711))}show(){t.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.iA&&!!this.kB&&!!this.pzd&&!!this.A8d,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Vu()||(t.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}Vu(){return!!this.ZP}ZJa(){const ca=Object(r.a)(new Oa.a,{label:N.a.instance.Aa(712),ariaDescription:N.a.instance.Aa(714),onExecute:()=>{t.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.pzd();this.dismiss()}}),sb=Object(r.a)(new Oa.a,{label:N.a.instance.Aa(713),ariaDescription:N.a.instance.Aa(715),onExecute:()=>
{t.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.A8d();this.dismiss()}});return Object(r.a)(new za.a,{target:this.target,content:this.iA,title:this.kB,primaryButtonProps:ca,secondaryButtonProps:sb,showCloseIcon:!0,calloutProps:Object(r.a)(new ea.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(w.a)(Se,
"TableAIConvertToTableCallout",ub,[]);var Ta=a(195);class Qa{constructor(ca){this.U3k=ca}show(){Bb.a.instance.Dk("Common.ISystemInitiatedFeedback").execute(ca=>{ca.logActivity(this.U3k,null)})}}Object(w.a)(Qa,"EwaLppCallout",null,[910]);var Ob=a(46);class Jb extends Qa{constructor(ca){super("ExcelTableInNewWorkbook");this.GWd=this.Roa=!1;this.createTable=()=>{const sb=Ob.x(new Ta.a(1,1,8,3,ac.a.Ok,ac.a.Ak),this.$),Ba={};Ba.TableRange=sb;Ba.HasHeader=!1;this.$.oi(71074531,Z.a.ph,9,Ba)};this.onf=()=>
{this.createSampleTable("0")};this.pnf=()=>{this.createSampleTable("2")};this.qnf=()=>{this.createSampleTable("1")};this.$=ca;(this.Roa=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.GWd=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.onf,!0),window.addEventListener("ExcelCreateSampleTableContact",
this.pnf,!0),window.addEventListener("ExcelCreateSampleTableToDo",this.qnf,!0)}dispose(){this.Roa&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.GWd&&(window.removeEventListener("ExcelCreateSampleTableBlank",this.onf,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.pnf,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.qnf,!0))}createSampleTable(ca){const sb={};sb[Z.a.Pi]=ca;this.$.oi(1371713064,Z.a.ph,9,sb)}}Object(w.a)(Jb,"TableInNewWorkbookCallout",
Qa,[]);var Jc=a(1274);class zb extends ub{constructor(ca){super(ca);this.e0c=5E3;this.kB=Jc.a.Title;this.currentState=0}XIa(ca,sb){Jc.c.get(this.currentState).includes(ca)&&(6===ca?window.requestAnimationFrame(()=>this.Dxc(ca,sb)):this.Dxc(ca,sb))}Sbc(ca){this.target=ca}show(){super.dismiss();this.oJg();super.show()}dismiss(){this.XIa(0);window.clearTimeout(this.GEg);super.dismiss()}ZJa(){return Object(r.a)(new za.a,{target:this.target,title:this.kB,content:this.iA,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,
preventDismissOnResize:!0,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.oJg();super.P$a({message:this.iA})}Dxc(ca,sb){const Ba=Jc.b.get(ca);this.V8k(this.Sii(ca)?`${Ba}${sb}`:Ba);this.currentState=ca;0!=this.currentState?(this.update(),this.show()):this.dismiss()}Sii(ca){switch(ca){case 5:case 6:case 8:return!0;default:return!1}}oJg(){window.clearTimeout(this.GEg);this.GEg=window.setTimeout(()=>
this.dismiss(),this.e0c)}V8k(ca){this.iA=ca}}Object(w.a)(zb,"FormulaByExampleCurtainLifterCallout",ub,[]);var tb=a(178),zc=a(1102);class dd extends Fc{constructor(ca){super(ca,"DataCleansingTeachingCallout",tb.a.ia(2477),tb.a.ia(2478),tb.a.ia(2476),tb.a.ia(2479),16777216,24,new xc.a,!0,!1,!1,!1,!0,!0,!0,5,!0,!0);this.zrd="[data-unique-id=Data]";this.W7e="[data-unique-id=Ribbon-DataCleansingTaskPane]";this.$7e="[data-unique-id=pivotOverflowButton]";this.Y7e="[data-unique-id=Ribbon-DataCalculationTools_MLR]"}get gT(){return document.querySelector(this.Y7e)?
this.Y7e:document.querySelector(this.W7e)?this.W7e:document.querySelector(this.zrd)?this.zrd:this.$7e}get fT(){return this.$7e}get DS(){return this.zrd}get wfb(){return zc.a}get ribbonCommandInfo(){return new Gc.a(-859308420,Z.a.ph,this.$.ji,12,null)}}Object(w.a)(dd,"DataCleansingTeachingCallout",Fc,[]);var od=a(130);class gb extends ub{constructor(ca){super(ca);this.iA=this.kB=this.target=null;this.duration=0}BY(ca,sb,Ba){this.Vu()||(this.target=ca,this.kB=this.EHi(sb),this.iA=N.a.instance.Aa(737),
this.operation=sb,this.duration=Ba)}show(){t.ULS.shipAssertTag(512304648,0,!!this.target&&!!this.iA&&!!this.kB,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Vu()||(t.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout."),Wb.a.sendTelemetryEvent({name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",dataFields:od.a.xn({["Operation"]:this.operation,
["Duration"]:this.duration})}),super.show())}Vu(){return!!this.ZP}ZJa(){return Object(r.a)(new za.a,{target:this.target,title:this.kB,content:this.iA,showCloseIcon:!0,calloutProps:Object(r.a)(new ea.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}EHi(ca){switch(ca){case 0:return N.a.instance.Aa(727);case 1:return N.a.instance.Aa(728);case 2:return N.a.instance.Aa(729);
case 3:return N.a.instance.Aa(730);case 4:return N.a.instance.Aa(731);case 5:return N.a.instance.Aa(732);case 6:return N.a.instance.Aa(733);case 7:return N.a.instance.Aa(734);case 8:return N.a.instance.Aa(735);case 9:return N.a.instance.Aa(736);default:return""}}}Object(w.a)(gb,"OptimizeWorkbookSlowOperationsCallout",ub,[]);class gc extends Fc{constructor(ca){super(ca,"FunctionDialogTeachingCallout",void 0,N.a.instance.Aa(763),N.a.instance.Aa(760),N.a.instance.Aa(761),1073741824,30,new xc.a,!0,!0,
!1,!1,!0,!0,!0,5,!0)}BY(ca){this.Ard=`[id=${"CellEdit"===ca?this.$.xi+ba.a.rRb:"InsertFunction"}]`}gKa(){return 1}get gT(){return this.Ard}get fT(){return this.Ard}get DS(){return this.Ard}get ribbonCommandInfo(){return null}}Object(w.a)(gc,"FunctionDialogTeachingCallout",Fc,[]);class Dc extends Qa{constructor(ca){super("ExcelLiveWebEntryPointCallout");this.yoa=!1;this.NYg=()=>{this.$.oi(327119921,Z.a.ph,9,null)};this.$=ca;(this.yoa=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",
!1))&&window.addEventListener("TryCoEditInTeams",this.NYg,!0)}dispose(){this.yoa&&window.removeEventListener("TryCoEditInTeams",this.NYg,!0)}}Object(w.a)(Dc,"ExcelLiveWebEntryPointCallout",Qa,[]);class hd extends ub{constructor(ca){super(ca);this.G9c="FullScreenTeachingCallout";this.F9c=4;this.E9c=34;this.kB=N.a.instance.Aa(1004);this.iA=N.a.instance.Aa(1005);this.ZWa=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1);this.localStorage=new xc.a;this.y0b=this.SNd();
this.dP=0}get JO(){return this.G9c}get chb(){return this.F9c}get ahb(){return this.E9c}get fT(){return"[id=ToggleFullScreenButton]"}get gT(){return"[id=ToggleFullScreenButton]"}get DS(){return"[id=ToggleFullScreenButton]"}gKa(){return 3}lBc(){return 86400}get ica(){return 3}ZJa(){return Object(r.a)(new za.a,{target:this.Hxa(),content:this.iA,title:this.kB,showCloseIcon:!0,preventLightDismiss:!1,hasDynamicSizing:!1,calloutProps:Object(r.a)(new ea.a,{onDismiss:()=>{this.dismiss()},directionalHint:6,
preventDismissOnScroll:!1,preventDismissOnResize:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0,setInitialFocus:!1,gapSpace:0}),useTeachingStyles:!1,hasFocusableControls:!1,useCoachmark:!1})}Vu(){return!!this.ZP}jha(){return this.ZWa&&!this.Vu()}show(){this.Hxa()&&Y.TaskExtensions.$e(this.dra(),ca=>{ca.result&&this.eue()},this.$.ya)}dra(){const ca=new Aa.a;this.jha()?Y.TaskExtensions.$e(this.y0b.u3d(),sb=>{var Ba=this.gKa();sb=sb.result;sb.W$b?(this.dP=sb.dP,rb.ypb(Ba)&&sb.dP>=this.ica?ca.setResult(!1):
rb.XJc(Ba)&&sb.sMa&&Ia.getElapsedSeconds(sb.sMa,new Date)<this.lBc()?ca.setResult(!1):(Ba=!this.ZP&&!!this.Hxa(),ca.setResult(Ba))):ca.setResult(!1)},this.$.ya):ca.setResult(!1);return ca.task}eue(){const ca=new Ja;ca.dP=this.dP+1;ca.sMa=new Date;this.y0b.Rne(ca);super.show()}Hxa(){return document.querySelector(this.gT)?this.gT:document.querySelector(this.fT)?this.fT:document.querySelector(this.DS)?this.DS:null}SNd(){const ca=this.gKa();return rb.o9g(ca)?new Ea(this.$,this.JO,ca):new Lb(this.$,this.ahb,
this.chb,ca,this.JO,this.localStorage)}}Object(w.a)(hd,"FullScreenTeachingCallout",ub,[]);class xd extends Fc{constructor(ca){super(ca,"GotoCtrlClickTeachingCallout",null,"Got it","Consider using Ctrl + Click","Press Ctrl and click on a reference inside the formula to go to that reference",16,36,new xc.a,void 0,!0,void 0,void 0,void 0,void 0,void 0,7,!0)}get gT(){return this.XKd()}get fT(){return this.XKd()}get DS(){return this.XKd()}XKd(){return`[id="${this.$.xi+ba.a.CYa}"]`}get ribbonCommandInfo(){return new Gc.a(1455037301,
Z.a.ph,this.$.ji,0,null)}}Object(w.a)(xd,"GotoCtrlClickTeachingCallout",Fc,[]);class fd{constructor(ca){this.$=ca;this.OF=new ib.a(!1)}ZSi(ca){if(!this.OF.mh(Rb[ca]))switch(ca){case 0:this.g5h(ca);break;case 2:this.OF.add(Rb[ca],new wd(this.$));break;case 3:this.OF.add(Rb[ca],new Cb(this.$));break;case 6:this.OF.add(Rb[ca],new wc(this.$));break;case 1:this.OF.add(Rb[ca],new Ra(this.$));break;case 4:this.OF.add(Rb[ca],new Pa(this.$));break;case 7:this.OF.add(Rb[ca],new Ub(this.$));break;case 8:this.OF.add(Rb[ca],
new Ya(this.$));break;case 9:this.OF.add(Rb[ca],new la(this.$));break;case 13:this.OF.add(Rb[ca],new ad(this.$));break;case 10:this.OF.add(Rb[ca],new uc(this.$));break;case 11:this.OF.add(Rb[ca],new pe(this.$));break;case 12:this.OF.add(Rb[ca],new Se(this.$));break;case 14:this.OF.add(Rb[ca],new Jb(this.$));break;case 15:this.OF.add(Rb[ca],new zb(this.$));break;case 16:this.OF.add(Rb[ca],new dd(this.$));break;case 18:this.OF.add(Rb[ca],new gb(this.$));break;case 20:this.OF.add(Rb[ca],new Dc(this.$));
break;case 21:this.OF.add(Rb[ca],new gc(this.$));break;case 22:this.OF.add(Rb[ca],new hd(this.$));break;case 24:this.OF.add(Rb[ca],new xd(this.$));break;default:return null}return this.OF.getItem(Rb[ca])}g5h(ca){this.OF.add(Rb[ca],new jd(this.$,N.a.instance.Aa(640),N.a.instance.Aa(637),N.a.instance.Aa(638),N.a.instance.Aa(639),16,4,!0))}}Object(w.a)(fd,"EwaCalloutFactory",null,[]);var kd=a(66),Yb=a(68),Cc=a(153);let td=class{constructor(ca){this.$=ca;this.dpi=new fd(this.$)}Ri(){return!1}dj(){return!1}Ei(ca,
sb,Ba){ca=Ba.CalloutName;this.xPk=Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&Object(Cc.c)(this.$)&&!this.Vij(ca);return!!sb&&-847286761===sb.command&&kd.a.Zl.PY&&!this.xPk}Vij(ca){return this.$.RC&&9===ca}executeCommand(ca,sb,Ba){ca=Ba.CalloutName;if(sb=this.dpi.ZSi(ca)){switch(ca){case 2:sb.BY(Ba.Target,Ba.RibbonButtonLabel,Ba.ExampleEntities,Ba.BlankCellResourceId,Ba.HasBlankCellWalkthrough,Ba.ServiceDomain);break;case 3:sb.BY(Ba.Target,Ba.RibbonButtonLabel,
Ba.ExampleEntities);break;case 6:sb.BY(Ba.Target);break;case 8:sb.BY(Ba.Target);break;case 13:sb.BY(Ba.Target);break;case 15:return sb.Sbc(Ba.Target),sb.XIa(Ba.NewState,Ba.Reason),Yb.Task.Ua(!0);case 12:sb.BY(Ba.Target,Ba.ConvertToTableCallback,Ba.NoThanksCallback);break;case 18:sb.BY(Ba.Target,Ba.Operation,Ba.Duration);break;case 21:sb.BY(Ba.Trigger)}sb.show();return Yb.Task.Ua(!0)}return Yb.Task.Ua(!1)}};td=Object(f.__decorate)([Object(F.d)(D.dg),Object(f.__param)(0,Object(D.Ob)())],td);Object(w.a)(td,
"ShowCalloutCommandHandler",null,[36]);let Ad=class{constructor(ca){this.i8e=!1;this.nI=ca;Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",!1)&&void F.a.resolve(D.nf,{va:1});this.nI.Veb("Valid",()=>{this.i8e||(t.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.i8e=!0)})}};Ad=Object(f.__decorate)([Object(F.d)(D.wg),Object(f.__param)(0,Object(D.xg)()),Object(f.__param)(1,Object(D.Ob)())],Ad);Object(w.a)(Ad,"TableIntelligenceDarkActivationManager",
null,[847]);var oe=a(191),qe=a(956),Be=a(932);class Ee extends qe.a{constructor(){super();this.range=null;this.H_=Object.assign(new Be.a,{T_:Ee.getTypeName(),B_:Ee.getBaseTypes()})}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(w.a)(Ee,"ExcelRangeWrapperAnnotation",qe.a,[]);class Ve extends Ee{constructor(){super();this.primaryTable=this.sheetName=this.boundaryConfidence=this.hasMergedcells=this.tableName=this.interpretations=
null;this.H_=Object.assign(new Be.a,{T_:Ve.getTypeName(),B_:Ve.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}}Object(w.a)(Ve,"ExcelRecognizedTableNew",Ee,[]);class Oe extends Ve{constructor(){super();this.requestId=null;this.H_=Object.assign(new Be.a,{T_:Oe.getTypeName(),B_:Oe.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew",
"AugLoop_Core_Annotation"]}}Object(w.a)(Oe,"ExcelRangeMetadata",Ve,[]);var Ye=a(1440);class nf extends Ye.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new Be.a,{T_:nf.getTypeName(),B_:nf.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]}}Object(w.a)(nf,"ExtendedExcelCell",Ye.a,[]);var of=a(1057);class Cf extends of.a{constructor(){super();this.mergeCellAddresses=
this.requestId=this.cells=this.range=null;this.H_=Object.assign(new Be.a,{T_:Cf.getTypeName(),B_:Cf.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(w.a)(Cf,"RangeDataSignal",of.a,[]);var Ff=a(1248),Wf=a(107),Mf=a(41);class ng extends Sys.EventArgs{constructor(ca){super();this.tUc=ca}}Object(w.a)(ng,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var Rf=a(215),$f=a(27),jf=a(396);class Hf{constructor(ca,
sb,Ba,V,Fa){this.analyzedRange=ca;this.interpretations=sb;this.tableName=Ba;this.id=V;this.mSf=Fa}}Object(w.a)(Hf,"RecognizedTable",null,[]);class Uf{constructor(ca,sb,Ba){this.classification=ca;this.aggregations=sb;this.headerReferences=Ba}}Object(w.a)(Uf,"TableField",null,[]);var If=a(1249);const sf=ca=>{var sb=new jf.a(tc(ca.range),ca.range.worksheetId);var Ba=ca.interpretations;var V=new Rf.a;if(Ba&&Ba.length)for(const Qc of Ba){b:switch(Qc.orientation.toLowerCase()){case "columnmajor":Ba=2;break b;
case "rowmajor":Ba=1;break b;default:t.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),Ba=0}const pd=Ba;if(0===pd)t.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{Ba=If.a;var Fa=tc(Qc.location),sc=Qc.confidence,Kc=Qc.headerRowCount,qd=Qc.headerColumnCount;var Eb=Qc.fields;var vc=new Rf.a;if(Eb)for(const Xd of Eb){Eb=vc;var Kd=Eb.add;c:switch(Xd.classification.toLowerCase()){case "dimension":var Zd=1;break c;case "measure":Zd=
2;break c;default:t.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),Zd=0}var nb=Xd.aggregations;var ic=new Rf.a;if(nb)for(const ue of nb)switch(ue.toLowerCase()){case "sum":ic.add(0);break;case "count":ic.add(1);break;case "average":ic.add(2);break;case "min":ic.add(3);break;case "max":ic.add(4);break;case "distinctcount":ic.add(5);break;case "stddev":ic.add(6);break;case "variance":ic.add(7);break;default:t.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}nb=
ic;var Bc=Xd.headerReferences;ic=new Rf.a;if(Bc)for(const ue of Bc)Bc=new $f.Range(ue.top,ue.left,ue.top,ue.left,!1,!1),ic.add(Bc);Kd.call(Eb,new Uf(Zd,nb,ic))}Ba=new Ba(Fa,sc,Kc,qd,pd,vc);V.add(Ba)}}return new Hf(sb,V,ca.tableName,ca.id,ca.hasMergedcells)},tc=ca=>new $f.Range(ca.top,ca.left,ca.bottom,ca.right,!1,!1);var ld=a(1086);class Ed{constructor(ca,sb){this.B5c=0;this.eI=new Map;this.gVd=!1;this.nI=ca;this.$o=sb;Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.Zwc=
new ld.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),this.Zwc.start(),this.j1c=!0);this.nI.Veb("Valid",this.D2j.bind(this));this.nI.Veb("Invalid",this.ZWj.bind(this));Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.$o.xyh(this.HQj.bind(this))}BKa(ca,sb,Ba){if(!this.eI)return t.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[];let V=sb;Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&
void 0!==Ba&&this.B5c>Ba&&(t.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${Ba}, versionChanges: ${this.B5c}`),V=sb^4);return this.eI.has(ca.sheetId)?(sb=this.eI.get(ca.sheetId).filter(Fa=>Fa.table.analyzedRange.range.$i(ca.range)&&(V&Fa.metadataState)==Fa.metadataState),t.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${sb.length}`),sb):[]}D2j(ca,sb){if(this.eI){if(!this.gVd){Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.j1c&&
(this.Zwc.stop(),t.ULS.sendTraceTag(509089223,0,15,"Elapsed time since annotation invalidation: {0}",this.Zwc.Ci),this.j1c=!1);for(const Ba of this.eI){const [V,Fa]=Ba;Fa.every(sc=>4===sc.metadataState)?this.eI.delete(V):this.eI.set(V,Fa.filter(sc=>4!==sc.metadataState))}this.gVd=!0}ca=sb.tUc;this.eI.has(ca.analyzedRange.sheetId)||this.eI.set(ca.analyzedRange.sheetId,[]);this.eI.get(ca.analyzedRange.sheetId).push({table:ca,metadataState:2});this.B5c=0}else t.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}ZWj(ca,
sb){this.gVd=!1;Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.j1c&&(this.Zwc.start(),this.j1c=!0);ca=sb.tUc;if(!this.eI)t.ULS.sendTraceTag(521025314,306,10,"Recognized table is null");else if(this.eI.has(ca.analyzedRange.sheetId))for(const Ba of this.eI.get(ca.analyzedRange.sheetId))Ba.table.id===sb.tUc.id&&(Ba.metadataState=4)}HQj(){this.B5c++}}Object(w.a)(Ed,"TableIntelligenceQueryManager",null,[870]);class ze{}Object(w.a)(ze,"RecognizedTableLog",null,[]);class ge{}
Object(w.a)(ge,"Interpretation",null,[]);class Ne{constructor(ca){this.eI=new Map;this.Eoc=void 0;this.DJb=new Set;this.I1b=void 0;this.nI=ca}Aeh(){this.I1b?t.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.I1b=this.Asb.bind(this),this.nI.Veb("Valid",this.I1b))}KCj(ca){ca=this.sanitize(ca);t.ULS.sendTraceTag(521233111,306,50,`${JSON.stringify(ca)}`)}Asb(ca,sb){ca=sb.tUc;Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1)&&(this.DJb&&this.eI?(this.DJb.has(ca.id)||(this.GBh(ca),this.DJb.add(ca.id)),this.Eoc||(this.Eoc=window.setTimeout(this.xAa.bind(this),2E3))):t.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.DJb}, recognizedTableStore = ${!!this.eI}`))}xAa(){for(const ca of this.eI){const [,sb]=ca;t.ULS.sendTraceTag(521233110,306,50,JSON.stringify(sb))}window.clearTimeout(this.Eoc);this.DJb=this.Eoc=void 0;this.eI.clear();this.eI=void 0;this.nI.Umk(this.I1b);
this.I1b=void 0}GBh(ca){const sb=ca.analyzedRange.sheetId;this.eI.has(sb)||this.eI.set(sb,[]);this.eI.get(sb).push(this.sanitize(ca))}sanitize(ca){const sb=[];for(const Ba of ca.interpretations){let V=0,Fa=0;for(const sc of Ba.fields)1===sc.classification?V++:2===sc.classification&&Fa++;sb.push({confidence:Ba.confidence,headerRowCount:Ba.headerRowCount,headerColumnCount:Ba.headerColumnCount,orientation:Ba.orientation,measureCount:Fa,dimensionCount:V})}return{interpretations:sb,range:{top:ca.analyzedRange.range.top,
bottom:ca.analyzedRange.range.bottom,left:ca.analyzedRange.range.left,right:ca.analyzedRange.range.right},isTable:!!ca.tableName,annotationId:ca.id}}}Object(w.a)(Ne,"RecognizedTableLogger",null,[]);let Ge=class extends Mf.a{constructor(ca,sb){super();this.u_f=this.t_f=!1;this.instantaneousSupportInformationManager=null;this.Ehe=void 0;this.rag=!1;this.Kti=(Ba,V)=>{var Fa;if(1===V.operationType){const Kc=V.annotation;if(Kc){t.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${Kc.requestId}`);
Ba=sf(Kc);Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Fa=this.Ehe)||void 0===Fa?void 0:Fa.KCj(Ba));var sc=null;(()=>{let qd=this.Vue.tj(Kc.requestId);({value:sc}=qd);return qd})().returnValue?(this.Vue.remove(Kc.requestId),sc(Ba)):t.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${Kc.requestId}`)}else t.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")}};
this.$o=ca;this.$=sb;this.Vue=new Wf.a;Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Ehe=new Ne(this));this.$o.register(this.$o.k6().I8("TableIntelligence").H8(()=>{}).build())}Taa(){this.W9a||(this.W9a=new Ed(this,this.$o));return this.W9a}fRi(ca,sb){const Ba=this;return xo(function*(){if(Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<ca.range.zz)return t.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${ca.range.zz} exceeds limit of ${1E4}`),
4;Ba.xxh();if(Ba.Rqj(ca.range))return yield Ba.lVi(ca,sb);t.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2})}aAd(ca){return(sb,Ba)=>{this.Ebk(this.T5d(ca),Ba)}}Veb(ca,sb){var Ba,V;(null===(V=null===(Ba=this.$)||void 0===Ba?void 0:Ba.sa)||void 0===V?0:V.count)&&100<this.$.sa.count?t.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.sa.count}`):
(this.u_f||(this.$o.uqa("TableIntelligence",{EA:!0,annotationType:Ve.getTypeName(),NV:this.aAd("New"),pDa:this.aAd("Valid"),zGc:this.aAd("Invalid")}),this.u_f=!0),this.GAh(ca,sb),this.vej())}Umk(ca){this.removeHandler(this.T5d("Valid"),ca)}GAh(ca,sb){this.addHandler(this.T5d(ca),sb)}Ajk(){this.$o.uqa("TableIntelligence",{annotationType:Oe.getTypeName(),EA:!1,NV:this.Kti})}xxh(){this.t_f||(this.t_f=!0,this.Ajk())}Ebk(ca,sb){1===sb.operationType&&((sb=sb.annotation)?(sb=sf(sb),this.raiseEvent(ca,new ng(sb))):
t.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}T5d(ca){return`${"RecognizedTableUpdate"}_${ca}`}lVi(ca,sb){const Ba=this;return xo(function*(){t.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const V=ca.range,Fa=oc.f(Ba.$).pt("TableIntelligence",V,1),sc=[],Kc=[];let qd=0;const Eb=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1);Ba.instantaneousSupportInformationManager||
(Ba.instantaneousSupportInformationManager=yield F.a.resolve(D.Ed));for(;Fa.$$mn();){const vc=Fa.$$cu();if(!vc)continue;if(0===vc.Qn.type&&Ic.a.Pz(vc.Qn.value))continue;vc.LH&&vc.range&&Kc.push(Object(r.a)(new Ff.a,{worksheetId:ca.sheetId,left:vc.range.left-1,top:vc.range.top-1,right:vc.range.right-1,bottom:vc.range.bottom-1}));const Kd=vc.range.top-1,Zd=vc.range.left-1;let nb=null,ic;({category:ic}=Ba.instantaneousSupportInformationManager.Lra(vc.cell.to,!0));vc.text!=vc.Qn.value&&(nb=vc.text,Eb&&
qd++);sc.push(Object.assign(new nf,{row:Kd,column:Zd,value:vc.Qn.value,type:vc.Qn.type,displayText:nb,Ivl:ic}))}Eb&&t.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${qd}, number of values: ${sc.length}, range size: ${V.height} rows by ${V.width} columns`);if(0<sc.length)return Ba.l$h(sc,ca,Kc,sb),Kc.length?5:0;t.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3})}l$h(ca,sb,Ba,V){var Fa=sb.range;Fa=Object(r.a)(new Ff.a,
{top:Fa.top,left:Fa.left,bottom:Fa.bottom,right:Fa.right,worksheetId:sb.sheetId});sb=oe.a.create().toString();ca=Object(r.a)(new Cf,{cells:ca,range:Fa,mergeCellAddresses:Ba,requestId:sb});this.$o.Qyb(ca,"TableIntelligence");this.Vue.add(sb,V)}Rqj(ca){const sb=oc.f(this.$);if(Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)){const Ba=sb.qY();t.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${Ba.width}, viewportHeight: ${Ba.height}`)}return sb.za.Hba(4,this.$.la)&&
!!sb.yh(ca.topLeft)&&!!sb.yh(ca.bottomLeft)&&!!sb.yh(ca.topRight)&&!!sb.yh(ca.bottomRight)}vej(){var ca;!this.rag&&Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.rag=!0,null===(ca=this.Ehe)||void 0===ca?void 0:ca.Aeh())}};Ge=Object(f.__decorate)([Object(F.d)(D.xg),Object(f.__param)(0,Object(D.r)()),Object(f.__param)(1,Object(D.Ob)())],Ge);Object(w.a)(Ge,"TableIntelligenceManager",Mf.a,[2,846]);String(c);String(b);String(e);String(k);String(d);String(u);
String(n);String(v);window.___1712031311692_closurehack=c;window.___1712031311692_closurehack=b;window.___1712031311692_closurehack=e;window.___1712031311692_closurehack=k;window.___1712031311692_closurehack=d;window.___1712031311692_closurehack=u;window.___1712031311692_closurehack=n;window.___1712031311692_closurehack=v}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pid.js.map/3f156a253aba44d845ec37ebd33bdc75/EwaTS.pid.js.map