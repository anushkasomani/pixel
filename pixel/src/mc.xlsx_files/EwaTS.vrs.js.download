'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1291:function(y,m,a){m=a(492);a=a(1485);a=a.$q?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1485:function(y,m,a){m=a(493)(!1);m.push([y.i,".ewa-svg-icon{height:100%;width:100%}",""]);y.exports=m},1486:function(y,m,a){m=a(492);a=a(1487);a=a.$q?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1487:function(y,m,
a){m=a(493)(!1);m.push([y.i,'.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-invalid-sheetname-container{position:fixed;top:0;right:0;bottom:0;left:0;z-index:-1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media (prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}.ewa-stb-uir .rename-textbox-active{background-color:#e0e0e0!important}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:transparent;border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width .4s cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-uir .tab-active.rename-textbox-active .tab-content-container::before{width:calc(100%)}.ewa-stb-tabs .tab-content-container,.ewa-stb-tabs .tab-text{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px!important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0!important;margin-right:4px!important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar ::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:700;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:700;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px!important;height:13px!important;width:12px!important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0!important;margin-left:4px!important}.ewa-stb-rename-textbox{position:relative;display:none;border:none;outline:0;font-family:inherit;font-size:inherit;background:0 0}.ewa-stb-rename-textbox::selection{color:#fff;background-color:#616161}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover,.ewr-presentMode-on .ewa-stb-uir .tab-hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39!important;border:1px solid #e5e5e5!important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}',
""]);y.exports=m},402:function(y,m,a){a.r(m);var c={};a.r(c);a.d(c,"IndexedDB",function(){return J});var b={};a.r(b);a.d(b,"MoreColorsHelper",function(){return ya});var e={};a.r(e);var k={};a.r(k);a.d(k,"OAuthManagerWrapper",function(){return Aa});var d={};a.r(d);a.d(d,"PopulateDynamicHelper",function(){return yb});var u={};a.r(u);a.d(u,"RibbonControlsManager",function(){return wd});var n={};a.r(n);a.d(n,"SheetDropdownMenuCommandHandler",function(){return Ya});var v={};a.r(v);a.d(v,"SheetTabBarFactory",
function(){return Hf});var f=a(127),w=a(0),r=a(15),t=a(37),l=a(186),x=a(235),A=a(40),z=a(33),F=a(1);class D{constructor(ma){this.keyPath=ma}}Object(w.a)(D,"KeyPathClass",null,[]);var G=a(68),Q=a(92),O=a(5);let J=class extends x.a{constructor(ma){super();this.Pyb=this.RBd=null;this.Mof=1;this.lcb=null;this.ALa=!1;this.$=ma;this.ALa=F.EwaSettings.isChangeGateEnabled("OfficeVSO:8787787_AddPerfTelemetryForIndexedDbOps")}get indexedDBFactory(){this.lcb||(window.indexedDB?this.lcb=window.indexedDB:window.webkitIndexedDB?
this.lcb=window.webkitIndexedDB:window.mozIndexedDB?this.lcb=window.mozIndexedDB:window.msIndexedDB&&(this.lcb=window.msIndexedDB));return this.lcb}get initialized(){return!!this.RBd&&!!this.Pyb}initialize(ma,Ab,ec){this.RBd=ma;this.Pyb=Ab;this.Mof=ec}zl(){try{return F.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&t.a.Ooa||t.a.Cm&&91===t.a.oId?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(ma){return r.ULS.sendTraceTag(537157640,0,15,`IndexedDB.IsSupported() failed. Exception: ${ma.message}`),
!1}}BBa(ma){if(!this.zl()||!this.initialized)return r.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),G.Task.Ua(!1);const Ab=z.a.kh.Xj.m;return A.TaskExtensions.UXa(this.jce(),ec=>{if(void 0===ec.result)return!1;var na=ec.result;this.Stc(na);ec=z.a.kh.Xj.m;this.DPd(na,!1).put(ma);na=z.a.kh.Xj.m;this.ALa?r.ULS.sendTraceTag(507363798,0,50,`IndexedDB.saveToIndexedDB takes ${na-Ab} Millisecond.`):r.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${na-
ec} Millisecond.`);return!0},this.ya)}BCd(ma){if(!this.zl()||!this.initialized)return r.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),G.Task.Ua(!1);const Ab=z.a.kh.Xj.m;return A.TaskExtensions.UXa(this.jce(),ec=>{if(void 0===ec.result&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;var na=ec.result;this.Stc(na);ec=z.a.kh.Xj.m;this.DPd(na,!1)["delete"](ma);na=z.a.kh.Xj.m;this.ALa?r.ULS.sendTraceTag(507363797,
0,50,`IndexedDB.DeleteFromIndexedDB takes ${na-Ab} Millisecond.`):r.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${na-ec} Millisecond.`);return!0},this.ya)}rxa(ma){if(!this.zl()||!this.initialized)return r.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),G.Task.Ua("");const Ab=z.a.kh.Xj.m;return A.TaskExtensions.h3h(this.jce(),ec=>{if(void 0===ec.result&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return G.Task.Ua("");
ec=ec.result;return this.ALa?(ec=this.oIf(ec,ma),r.ULS.sendTraceTag(507363796,0,50,`IndexedDB.getFromIndexedDB takes ${z.a.kh.Xj.m-Ab} Millisecond.`),ec):this.oIf(ec,ma)},this.ya)}deleteDatabase(ma){if(!this.zl())return r.ULS.sendTraceTag(507872215,0,15,"IndexedDB.deleteDatabase: not supported."),G.Task.Ua(!1);const Ab=z.a.kh.Xj.m,ec=new l.a;ma=this.indexedDBFactory.deleteDatabase(ma);ma.onsuccess=()=>{ec.setResult(!0);this.ALa&&r.ULS.sendTraceTag(507363795,0,50,`IndexedDB.deleteDatabase takes ${z.a.kh.Xj.m-
Ab} Millisecond.`)};ma.onerror=()=>{ec.setResult(!1)};return ec.task}Stc(ma){if(!ma.objectStoreNames.contains(this.Pyb)){const Ab=z.a.kh.Xj.m;ma.createObjectStore(this.Pyb,new D("key"));this.ALa&&r.ULS.sendTraceTag(507363794,0,50,`IndexedDB.createDBObjectStore takes ${z.a.kh.Xj.m-Ab} Millisecond.`)}}jce(){const ma=z.a.kh.Xj.m,Ab=new l.a,ec=this.indexedDBFactory.open(this.RBd,this.Mof);ec.onsuccess=()=>{const na=ec.result;r.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${na.name} success`);Ab.setResult(na)};
ec.onupgradeneeded=()=>{const na=ec.result;r.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${na.name} upgrade needed`);try{this.Stc(na),r.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${na.name} upgrade done`),this.ALa&&r.ULS.sendTraceTag(507363793,0,50,`IndexedDB.openIndexedDB takes ${z.a.kh.Xj.m-ma} Millisecond.`)}catch(pb){r.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${pb}`),F.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?Ab.setResult(void 0):Ab.setException(Error.create("Failed to upgrade IndexedDB"))}};
ec.onerror=na=>{r.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${na} failed`);Ab.setResult(void 0)};return Ab.task}DPd(ma,Ab){return ma.transaction([this.Pyb],Ab?"readonly":"readwrite").objectStore(this.Pyb)}oIf(ma,Ab){const ec=z.a.kh.Xj.m,na=new l.a;this.Stc(ma);const pb=z.a.kh.Xj.m,R=this.DPd(ma,!0).get(Ab);R.onsuccess=ua=>{(ua=ua.target.result)?(na.setResult(ua.value),ua=z.a.kh.Xj.m,this.ALa?r.ULS.sendTraceTag(507363792,0,50,`IndexedDB.getFromDB takes ${ua-ec} Millisecond.`):r.ULS.sendTraceTag(537157633,
0,50,`IndexedDB.GetFromIndexedDB takes ${ua-pb} Millisecond.`)):na.setResult("")};R.onerror=()=>{na.setException(Error.create(R.error?R.error.message:"DB error"))};return na.task}};J=Object(f.__decorate)([Object(Q.d)(O.xd,{rk:"transient"}),Object(f.__param)(0,Object(O.Ob)())],J);Object(w.a)(J,"IndexedDB",x.a,[211]);var H=a(34),N=a(372),L=a(373),Z=a(215),ba=a(84),K=a(398),E=a(155),U=a(431),X=a(216),ia=a(230),Ma=a(199),qa=a(36),Ha=a(255),ha=a(265),La=a(156);class fa{constructor(ma,Ab,ec,na){this.red=
ma;this.green=Ab;this.blue=ec;this.alpha=na}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(w.a)(fa,"ColorObject",null,[]);class ja{constructor(ma){this.m$=this.hR=null;this.Lvd=ma}get head(){return this.hR}get xxe(){return this.m$}Ppf(ma){this.head&&(ma.pre?ma.next?(ma.pre.next=ma.next,ma.next.pre=ma.pre):(this.m$=ma.pre,this.xxe.next=null):ma.next?(this.hR=ma.next,this.head.pre=null):this.m$=this.hR=null,ma.next=null,ma.pre=null)}BBh(ma){this.head?
(ma.next=this.head,this.hR=ma,ma.next.pre=this.head):this.m$=this.hR=ma}getItems(){if(!this.head)return null;const ma=new Z.a;let Ab=this.head;for(;Ab;)if(ma.add(Ab.value),Ab=Ab.next,ma.count>this.Lvd){r.ULS.sendTraceTag(537155399,0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return ma}}Object(w.a)(ja,"CustomLinkedList",null,[]);class ta{constructor(ma){this.pre=this.next=null;this.value=ma}}Object(w.a)(ta,"CustomLinkedListNode",null,[]);class Ka{constructor(ma){this.Lvd=
ma;this.mOc={};this.Xqb=new ja(ma);this.count=0}add(ma,Ab){ma&&Ab?(Ab=new ta(Ab),this.contains(ma)?this.Xqb.Ppf(this.mOc[ma]):this.count<this.Lvd?this.count++:(delete this.mOc[this.Xqb.xxe.value.toString()],this.Xqb.Ppf(this.Xqb.xxe)),this.Xqb.BBh(Ab),this.mOc[ma]=Ab):r.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${ma} or Value ${Ab} is null.`)}getItems(){return this.Xqb.getItems()}contains(ma){return ma?ma in this.mOc:!1}}Object(w.a)(Ka,"MRUCache",null,[]);var Ga=a(242),Na=a(12);class cb extends Ga.a{constructor(ma,
Ab,ec,na){na=void 0===na?null:na;super(!1,!1,!0);this.hm=null;this.v_h=(pb,R)=>{this.dif(pb,R)};this.$=ma;this.dbj=Ab;this.wVf=ec;this.eif=na}fn(){const ma=Na.a.instance.ia(1346),Ab={};Ab[cb.geh]=this.dbj;Ab[cb.zbh]=cb.hdc;Ab[cb.ceh]=cb.hdc;Ab[cb.ogh]=cb.hdc;Ab[cb.Lfh]=cb.hdc;Ab[cb.lfh]=Na.a.instance.ia(2105);Ab[cb.Udh]=Na.a.instance.ia(2089);Ab[cb.Vbh]=Na.a.instance.ia(2076);Ab[cb.$dh]=Na.a.instance.ia(1347);Ab[cb.Abh]=Na.a.instance.ia(1348);this.wVf!==cb.Bbh&&(Ab[cb.Cbh]=cb.ALPHA,Ab[cb.ALPHA]=this.wVf);
this.initializeAndShow(ma,this.v_h,{[cb.fdh]:cb.vch,[cb.Wbh]:Ab})}dif(ma,Ab){Ab=Ab[cb.f7c];1===ma&&this.Fgg(Ma.a.Uia(Ab));this.eif&&this.eif(1===ma,1===ma?Ab:null)}Fgg(ma){this.hm||(this.hm=Q.a.lh(O.Vd));ma=ia.a.XM(Ma.a.rP(ma,!1));this.hm.HXc(ma.r,ma.g,ma.b,K.a.gdc)}}cb.geh="initColor";cb.fdh="id";cb.vch="ColorPickerDialog";cb.Wbh="bodyControls";cb.f7c="selectedColorText";cb.ceh="hueAriaLabel";cb.ogh="transparencyAriaLabel";cb.Lfh="svAriaLabel";cb.hdc="Use left & right arrows keys to change values in color picker & hue slider";
cb.ALPHA="alpha";cb.w6c="alphaValue";cb.zbh="alphaAriaLabel";cb.Cbh="alphaSliderType";cb.Bbh=-1;cb.Feh=100;cb.lfh="redLabel";cb.Vbh="blueLabel";cb.Udh="greenLabel";cb.$dh="hexLabel";cb.Abh="alphaLabel";Object(w.a)(cb,"MoreColorsDialog",Ga.a,[]);var jb=a(7),Sa=a(616),bb=a(62);class oa extends cb{constructor(ma,Ab,ec,na,pb){super(ma,na,pb);this.commandName=null;this.cYf=!1;this.command=Ab;this.Nh=ec;this.Waj=pb}fn(){super.fn();this.commandName=bb.b().kp(this.Nh.command);r.ULS.sendTraceTag(545051016,
0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.Nh.jk}`)}dif(ma,Ab){if(1===ma)if(ma=this.$.Eh.wm("UserAction",this.commandName),ma.start(),Sa.a(ma),Ab)if(cb.f7c in Ab){var ec=Ab[cb.f7c];if(ma=Ma.a.Uia(ec)){ec=new ba.a(this.command,this.Nh.method,this.Nh.mode,this.Nh.jk,this.Nh.tabName?this.Nh.tabName:1378078823===this.command||-400966242===this.command?jb.a.ROa:jb.a.eT);var na={};na.Color=ma;na.UILocation=this.Nh.jk;cb.w6c in Ab&&(this.Waj!==
Ab[cb.w6c]&&(this.cYf=!0),na.Alpha=(Ab[cb.w6c]/cb.Feh).toString(),r.ULS.sendTraceTag(508822752,0,50,"Alpha Value selected from the MoreColors Dialog."));this.$.Ia.qh(ec,na);this.$.Fm();this.Fgg(ma);Ab={["Command"]:this.commandName,["Location"]:this.Nh.jk};Ab.AlphaApplied=this.cYf.toString();La.b(this.$).sj(E.a.yIj,Ab,null,!0)}else this.hide(),r.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${ec}, Command: ${this.commandName}`)}else this.hide(),
r.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),r.ULS.sendTraceTag(537155362,0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(w.a)(oa,"MoreColorsRibbonDialog",cb,[]);var ka=a(64);Object(Q.b)(O.Vd,{rk:"singleton"})(ma=>xo(function*(){const Ab=yield Q.a.resolve(O.Ob,ma),ec=(yield Q.a.resolve(O.kf,ma)).C8f();return new ya(Ab,ec)}));class ya{constructor(ma,Ab){this.qXe="00FFFF";this.rXe="0000FF";this.ICg="00FFFF";this.JCg=
"BF7000";this.I6a=null;this.SJf=!1;this.QSe=null;this.PC=F.EwaSettings.Tp("MoreColorsHelper");this.Kxd=()=>{var ec;null===(ec=this.Fnd)||void 0===ec?void 0:ec.abort()};this.sQf=ec=>{ec&&ec.key&&(1===ec.key.length||"Backspace"===ec.key||"Delete"===ec.key||"Enter"===ec.key?(ec.preventDefault(),ec.stopImmediatePropagation()):this.Kxd())};this.iVj=ec=>{if(!Ha.a(ec)){ec=ec.Result;this.I6a=new Ka(10);for(let pb=ec.length-1;0<=pb;pb--){var na=ec[pb];na=new fa(na.Red,na.Green,na.Blue,na.Alpha);this.I6a.add(na.toString(),
na)}this.Kwg();r.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.hVj=()=>{r.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.qG=()=>{this.Oyc()};this.Gp=()=>{this.Oyc()};this.$=ma;this.j_b=Ab;this.PC?this.$.fa.Vm?this.Gp():this.$.fa.rv(this.Gp):this.$.fa.um?this.Oyc():F.EwaSettings.ul()?this.$.fa.lr(this.qG):this.$.fa.mr(this.qG)}get i_b(){return this.QSe}get J6a(){return this.qXe}set J6a(ma){this.qXe=
ma}get jvb(){return this.rXe}set jvb(ma){this.rXe=ma}get rUc(){return this.ICg}set rUc(ma){this.ICg=ma}get sUc(){return this.JCg}set sUc(ma){this.JCg=ma}Oqb(ma,Ab,ec,na){na=void 0===na?-1:na;return this.j_b?A.TaskExtensions.$e(this.j_b,()=>{(new oa(this.$,ma,Ab,ec,na)).fn()},this.$.ya):null}launchEyedropper(ma,Ab,ec){const na=window.EyeDropper,pb=new na;if(!na||!pb||!(null!=ec||ma&&Ab))return G.Task.Ua(!1);let R=null;if(!ec)switch(ma){case 1188510340:R=1650812936;break;case -1828502776:R=1970784898;
break;case -1252156667:R=1378078823;break;case -2063061844:R=-400966242;break;case -260488795:R=-236759591;break;case -605730035:R=467002767;break;case -984702347:R=409031041;break;default:return r.ULS.shipAssertTag(508063765,0,!1,`MoreColorsHelper.launchEyedropper: Invalid eyedropper command ${ma}`),G.Task.Ua(!1)}this.Fnd=new AbortController;const ua=Ab?bb.b().kp(Ab.command):"EyedropperConditionalFormatting";pb.open({signal:this.Fnd.signal}).then(xb=>{var W=this.$.Eh.wm("UserAction",ua);W.start();
Sa.a(W);W=Ma.a.Uia(xb.sRGBHex);if(!W)return r.ULS.shipAssertTag(508065669,0,!1,"MoreColorsHelper.launchEyedropper: Failed to return the color in expected format BBGGRR."),G.Task.Ua(!1);null!=ec&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8572137_Eyedropper_Conditional_Formatting")?(r.ULS.sendTraceTag(507774978,0,50,"MoreColorsHelper.launchEyedropper: Eyedropper is used for Conditional Formatting."),ec(xb.sRGBHex?!0:!1,xb.sRGBHex.substring(1))):(xb=new ba.a(R,Ab.method,Ab.mode,Ab.jk,Ab.tabName),
this.$.Ia.qh(xb,{["Color"]:W,["UILocation"]:Ab.jk}),this.$.Fm());xb=ia.a.XM(Ma.a.rP(W,!1));null!=xb&&this.HXc(xb.r,xb.g,xb.b,K.a.gdc);xb=R?{["Command"]:bb.b().kp(Ab.command),["Location"]:Ab.jk}:{["IsCommand"]:!1,["Location"]:12};La.b(this.$).sj(E.a.ivi,xb,null,!0);return G.Task.Ua(!0)}).catch(xb=>{r.ULS.sendTraceTag(508065668,0,10,"MoreColorsHelper.launchEyedropper: Failed to apply eyedropper color. Exception: {0}",xb.toString());return G.Task.Ua(!1)}).finally(()=>{window.removeEventListener("blur",
this.Kxd);window.removeEventListener("keydown",this.sQf,!0);this.Fnd=null});window.addEventListener("blur",this.Kxd);window.addEventListener("keydown",this.sQf,!0);return G.Task.Ua(!0)}qxj(ma,Ab){var ec=void 0;ec=void 0===ec?-1:ec;Ab=void 0===Ab?null:Ab;this.j_b&&A.TaskExtensions.$e(this.j_b,()=>{(new cb(this.$,ma,ec,Ab)).fn()},this.$.ya)}EVi(ma){let Ab=null;switch(ma){case "QueryRecentFillColor":Ab=this.J6a;break;case "QueryRecentFontColor":Ab=this.jvb;break;case "QueryRecentShapesFillColor":Ab=
this.rUc;break;case "QueryRecentShapesOutlineColor":Ab=this.sUc}return Ab?H.a.umb(Ab):null}dispose(){this.j_b=null;this.$&&(this.PC?this.$.fa.az(this.Gp):F.EwaSettings.ul()||this.$.fa.av(this.qG))}Oyc(){if(this.$.isEditMode)if(this.I6a)this.Kwg();else{this.SJf&&r.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");var ma=this.$.oa.ta;this.$.userOperationManager.enqueueOperation(new X.a(1009,0,(Ab,ec,na)=>
{Ab=ha.c.call(null,Ab,this.iVj);ec=ha.b.call(null,ec,this.hVj);const pb=ma.Za(1,null);return ka.h(ma,"GetMRUColors",pb,Ab,ec,na,null,4)},80),null);this.SJf=!0}}Kwg(){var ma=this.I6a.getItems();if(ma){this.QSe=new Z.a;for(const Ab of ma)ma=Ab,ma=new ia.a(ma.red,ma.green,ma.blue),this.i_b.add(Ma.a.JJ(ma))}}HXc(ma,Ab,ec,na){this.I6a||(this.I6a=new Ka(10));const pb=new fa(ma,Ab,ec,na);this.I6a.add(pb.toString(),pb);this.saveMRUColor(null,ma,Ab,ec,na)}$Aa(ma,Ab,ec){(ma||this.$.isEditMode)&&this.EUg(ma.SqmControlId)&&
(ma=ia.a.XM(Ma.a.rP(Ab,!1)))&&(this.HXc(ma.r,ma.g,ma.b,K.a.gdc),ec={["Command"]:bb.b().kp(ec.command),["Location"]:N.a[ec.jk],["InputMethod"]:L.a[ec.method]},La.b(this.$).sj(E.a.$Aa,ec,null,!0))}EUg(ma){return!!ma&&ma.startsWith("RecentColorPicker")}saveMRUColor(ma,Ab,ec,na,pb){return U.a(this.$.userOperationManager,(R,ua,xb)=>{var W=this.$.oa.ta;R=ha.c(R,ya.O_j());ua=ha.b(ua,ya.N_j());const xa=W.Za(9,null);xa.bRed=Ab;xa.bGreen=ec;xa.bBlue=na;xa.bAlpha=pb;return ka.h(W,"SaveMRUColor",xa,R,ua,xb,null,
0)},R=>new X.a(1008,0,R,F.EwaSettings.isChangeGateEnabled("OfficeVSO:8546775_SaveMRUColor_NonBlockingOperation")?64:null),ma)}static O_j(){return ma=>{qa.a.ll(ma.Errors)?r.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):r.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static N_j(){return()=>{r.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}
Object(w.a)(ya,"MoreColorsHelper",null,[857,2]);var Oa=a(224);Object(Q.b)(O.le)(()=>Oa.a.instance.resolve("Common.App.OAuth.IOAuthManager"));var za=a(2),ea=a(1071);let Aa=class{constructor(ma){this.Epa=ma}nF(ma,Ab){return this.Epa?this.Epa.nF(ma,Ab).then(ec=>{ec.IsSuccess||r.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+ec.ErrorMessage+" Error code: "+ec.ErrorCode+" App name: "+ma);return Object(za.a)(new ea.a,{IsSuccess:ec.IsSuccess,Token:ec.Token,ErrorCode:ec.ErrorCode,
ErrorMessage:ec.ErrorMessage})}):(r.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(za.a)(new ea.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}A$a(ma,Ab,ec){return this.Epa?this.Epa.A$a(ma,Ab,null,ec).then(na=>{na.IsSuccess||r.ULS.sendTraceTag(507347807,0,15,`Error retrieving auth token. Message: ${na.ErrorMessage} Error code: ${na.ErrorCode} App name: ${ma}`);return Object(za.a)(new ea.a,
{IsSuccess:na.IsSuccess,Token:na.Token,ErrorCode:na.ErrorCode,ErrorMessage:na.ErrorMessage})}):(r.ULS.sendTraceTag(507347808,0,10,"Oauth manager is null"),Promise.resolve(Object(za.a)(new ea.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}x1a(){return this.Epa?this.Epa.x1a():null}};Aa=Object(f.__decorate)([Object(Q.d)(O.me),Object(f.__param)(0,Object(O.le)())],Aa);Object(w.a)(Aa,"OAuthManagerWrapper",null,[856]);var ub=
a(496),rb=a(6),Ja=a(436),Xa=a(290),Y=a(732);class Ia{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(w.a)(Ia,"ColorCellProps",null,[]);var $a=a(361),Ea=a(19),Lb=a(60),Ib=a(247),Mb=a(154),mc=a(246),jc=a(341),Fc=a(13),Gc=a(400),xc=a(28),Uc=a(23);class Pa{constructor(ma){this.g9c=null;this.$=ma;this.grid=Uc.f(this.$)}get borderFormatManager(){this.g9c||(this.g9c=this.$.qa.zh(296));return this.g9c}MOi(ma){var Ab=null;switch(ma){case 467002767:Ab={};this.$.Qq(Ab);Ab=Object(Mb.a)(Gc.a,
this.$.sa).ZMf(Ab.SheetName,!0);break;case -236759591:Ab=this.NGi();break;case 1970784898:Ab=this.MMd(0);break;case 1650812936:case 1378078823:Ab=this.MMd(1);break;case -400966242:Ab=this.getShapeOutlineColor();break;case 1597684571:F.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&this.grid.ha.$a&&this.grid.ha.$a.Ih&&(ma=this.grid.ha.$a.Ih.floatingObject,0===ma.type&&ma.Ui&&(Ab=this.MMd(1)));break;case 409031041:F.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&
(Ab=this.ZFf(ma));break;default:r.ULS.sendTraceTag(537154460,0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${ma}'`)}return Ab}NGi(){let ma=null;this.borderFormatManager&&(ma=this.borderFormatManager.Pfa);(ma="black"===ma?"000000":ma)&&(ma=H.a.umb(ma));return ma}getShapeOutlineColor(){let ma=null;if(this.grid.ha.$a&&this.grid.ha.$a.Ih){const Ab=this.grid.ha.$a.Ih.floatingObject;5===Ab.type&&Ab.Ch&&-1!==Ab.Ch.ShapeOutlineColor&&(ma=
Ma.a.j3(Ab.Ch.ShapeOutlineColor),ma=ma.toUpperCase())}return ma}ZFf(ma){let Ab=null;if(this.grid.ha.$a&&this.grid.ha.$a.Ih){const ec=this.grid.ha.$a.Ih,na=ec.floatingObject;0===na.type&&na.Ui&&(Ab=ec.tTb(ma))}return Ab}MMd(ma){let Ab=null;if(this.grid.ha.$a&&this.grid.ha.$a.Ih){var ec=this.grid.ha.$a.Ih.floatingObject;if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&0===ec.type&&ec.Ui){if(0===ma||1===ma)Ab=this.ZFf(0===ma?1970784898:1597684571);return Ab}5===ec.type&&
ec.Ch?1===ma&&-1!==ec.Ch.ShapeFillColor?(Ab=Ma.a.j3(ec.Ch.ShapeFillColor),Ab=Ab.toUpperCase()):r.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):r.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");return Ab}ec=this.grid.Nfa("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ha.pa.selectedRanges,
1,!0);try{for(ec.$$rst();ec.$$mn();){const na=ec.$$cu().cell;if(!na)continue;let pb="#000000";if(0===ma){pb=na.color;if(this.grid.isEditing)return this.vNi();na.hasRichText&&(pb=this.wNi(na))}else if(1===ma){const R=na.backgroundColor;pb=xc.a.compare(R,"transparent",!0)&&R?na.backgroundColor:null}if(!Ab)Ab=pb;else if(Ab!==pb){Ab=null;break}}}finally{ec&&ec.dispose()}return Ab}vNi(){var ma=null,Ab=this.grid.Dh,ec=this.grid.cellTextEditBox.formattedText;if(ec){ma=ec.TextRuns;const na=Ib.a.map(ma,pb=>
pb.StartIndex);ec=ec.Fonts;Ab=Ab.Xa.caretPosition;Ab=Fc.HelperMethods.UAf(new mc.a(na),na.length,Ab,Fc.HelperMethods.SS);ma=ec[ma[Ab].FontID].Color}return ma?ma.toUpperCase():null}wNi(ma){ma=jc.a(ma.formattedText.Fonts);if(jc.e(ma,32))(ma=Ma.a.Uia(Ma.a.j3(ma.FontColor)))&&(ma="#"+ma.toUpperCase());else return null;return ma}}Object(w.a)(Pa,"ColorHighlighterHelper",null,[924]);var Bb=a(229),Nb=a(25),oc=a(675);class aa{constructor(ma,Ab,ec){this.pUc=this.D$b=this.r2c=null;this.TNg="-1";this.Mjj=rb.AFrameworkApplication.ea.ka("IsO365ConsumerHost");
this.$=ma;this.hm=Ab;this.Tw=ec;this.bif=new Pa(ma)}ZJf(ma,Ab,ec,na,pb,R,ua,xb,W,xa,kb){Ab=void 0===Ab?null:Ab;ec=void 0===ec?null:ec;na=void 0===na?null:na;xb=void 0===xb?null:xb;W=void 0===W?null:W;return this.l5(null!=Ab,null!=ec,null!=na,null!=xb,null!=W,!0,void 0===xa?!1:xa,ma,Ab,ec,na,void 0===pb?null:pb,void 0===R?null:R,void 0===ua?null:ua,xb,W,void 0===kb?null:kb)}CYi(ma,Ab,ec,na,pb){return this.l5(ma,Ab,ec,na,pb,!1)}$Jf(ma,Ab,ec,na,pb,R,ua){const xb=[];ma=this.ZJf(ma,void 0===Ab?null:Ab,
void 0===ec?null:ec,void 0===na?null:na,void 0,void 0,void 0,void 0===pb?null:pb,void 0===R?null:R,!1,void 0===ua?null:ua);for(let W=0,xa=ma.length;W<xa;W++)xb.push(Bb.r(ma[W]));return xb}l5(ma,Ab,ec,na,pb,R,ua,xb,W,xa,kb,Pb,T,Za,Db,kc,Wc){ua=void 0===ua?!1:ua;xb=void 0===xb?null:xb;W=void 0===W?null:W;xa=void 0===xa?null:xa;kb=void 0===kb?null:kb;Pb=void 0===Pb?null:Pb;T=void 0===T?null:T;Za=void 0===Za?null:Za;Db=void 0===Db?null:Db;kc=void 0===kc?null:kc;Wc=void 0===Wc?null:Wc;r.ULS.shipAssertTag(537154456,
0,!R||null!=xb,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");const yd=[];let Od=null,me=3,De=null,Le=null,Pe=null;this.yni();if(this.$&&this.$.isEditMode&&!this.G9j(Wc))return r.ULS.sendTraceTag(537154455,0,50,`Theme Info not present at the time of ${Wc} menu opening`),yd;ua&&F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)&&Nb.a.qV()&&Nb.a.QHc()&&(ua=Na.a.instance.ia(2501),yd.push(this.Fxa(aa.Kkf,this.rCi(aa.Kkf,
ua))));ma&&(R&&null==W?r.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):yd.push(this.Fxa(aa.MMh,this.mCi(aa.Haf,W,Za,T))));R&&null!=xb&&this.bif&&(Le=De="-1",Od=this.bif.MOi(xb))&&(r.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${xb} is not null .`),Od=Ma.a.Uia(Od),me=this.OIf(Od),De=this.gPd(Od,me,0,!0),Le=this.gPd(Od,me,1,!1));yd.push(this.Fxa(aa.i0k,this.mKd(aa.p1g,De,this.r2c,
xb,Pb,T),1341));yd.push(this.Fxa(aa.tWk,this.mKd(aa.sWk,Le,this.D$b,xb,Pb,T),1342));this.$&&this.$.isEditMode&&this.hm&&(this.D9j(),R&&(Pe="-1",Od&&(Pe=this.gPd(Od,me,2,!0))),this.hm&&this.hm.i_b&&0<this.hm.i_b.count&&yd.push(this.Fxa(aa.thk,this.mKd(aa.shk,Pe,this.pUc,xb,Pb,T),1349)));Ab&&(R&&null==xa?r.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):yd.push(this.Fxa(aa.zLj,this.nCi(aa.Igf,xa,this.pIi(xa),Za,T))));!ec||F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",
!1)&&this.$.isMobileMode&&this.$.isEditMode||!this.Mjj&&!F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ColorPickerHighlightWhenEnabled",!1)||(R&&!kb?r.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):yd.push(this.Fxa(aa.H9i,this.WCi(aa.MTf,kb))));na&&(R&&null==Db?r.ULS.shipAssertTag(537154451,0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):yd.push(this.Fxa(aa.zIj,
this.vDi(aa.ueg,Db,this.tRi(Db)))));Nb.a.WK()&&pb&&yd.push(this.Fxa(aa.pHd,this.ICi(aa.pHd,kc)));return yd}gPd(ma,Ab,ec,na){3===Ab&&(Ab=this.OIf(ma));return 0===ec&&Ab===ec?this.TNg.toLowerCase():Ab===ec?na?ma.toLowerCase():ma:"-1"}OIf(ma){if(!ma)return 3;const Ab=ma.toLowerCase();return this.r2c&&this.Ltj(Ab,this.r2c)?0:this.D$b&&this.YYf(ma,this.D$b)?1:this.pUc&&this.YYf(Ab,this.pUc)?2:3}Fxa(ma,Ab,ec){ec=void 0===ec?null:ec;ma=Object(za.a)(new Ja.a,{Id:ma,Title:null!=ec?Na.a.instance.ia(ec):"",
ControlList:[],ControlsId:ma+".Controls"});ma.ControlList.push(Ab);return ma}nCi(ma,Ab,ec,na,pb){return this.PDf(ma,Ab,ec,Ea.a.Xwf,"transparent",void 0===na?null:na,void 0===pb?null:pb)}WCi(ma,Ab){return Object(za.a)(new Xa.a,{Command:null!=Ab?Ab.toString():null,LabelText:Na.a.instance.ia(1433),Id:ma,ExternalId:this.Ena(ma,Ab),ExternalImageId:"ConditionalFormatting_20"})}mCi(ma,Ab,ec,na){return this.PDf(ma,Ab,542,Ea.a.Wwf,"000000",void 0===ec?null:ec,void 0===na?null:na)}PDf(ma,Ab,ec,na,pb,R,ua){R=
void 0===R?null:R;ua=void 0===ua?null:ua;return Object(za.a)(new Xa.a,{Command:null!=Ab?Ab.toString():null,CommandPreviewId:null!=R?R.toString():null,CommandRevertId:null!=ua?ua.toString():null,MenuItemsStatefulData:this.$Qi(ma,Ab,pb),LabelText:Na.a.instance.ia(ec),Id:ma,ExternalId:this.Ena(ma,Ab),Image16by16:Lb.a.Gn(1),Image16by16Class:na})}$Qi(ma,Ab,ec){const na={};ma=this.Ena(ma,Ab);na[ma]={};na[ma].iconColor=ec;return na}YYf(ma,Ab){for(let ec=0;ec<Ab.length;ec++)if(ma===Ab[ec].Color)return!0;
return!1}Wrj(ma,Ab){ma=Ma.a.Pu(ma);Ab=Ma.a.Pu(Ab);return 1>=Math.abs(ma.r-Ab.r)&&1>=Math.abs(ma.g-Ab.g)&&1>=Math.abs(ma.b-Ab.b)?!0:!1}Ltj(ma,Ab){for(let ec=0;ec<Ab.length;ec++){const na=Ab[ec].Color;if(this.Wrj(ma,na))return this.TNg=na.toLowerCase(),!0}return!1}mKd(ma,Ab,ec,na,pb,R){pb=void 0===pb?null:pb;R=void 0===R?null:R;return Object(za.a)(new Y.a,{McuLayout:!0,Command:null!=na?na.toString():null,CommandPreviewId:null!=pb?pb.toString():null,CommandRevertId:null!=R?R.toString():null,Width:10,
Id:`${ma}.ColorPicker`,SelectedColorId:Ab,Colors:ec,Stateful:!0,ExternalId:this.Ena(ma,na),McuExternalId:`${this.Ena(ma,na)}.MCU`})}Ena(ma,Ab){return`${ma}.${null!=Ab?Ab.toString():""}`}lKd(...ma){const Ab=[];for(let ec=0,na=ma.length;ec<na;ec+=2)Ab.push(Object(za.a)(new Ia,{Color:ma[ec],DisplayColor:Ma.a.JJ(ia.a.XM(parseInt(String("0x"+ma[ec]),16))),Alt:Object($a.a)(String,ma[ec+1])&&this.$?ma[ec+1]:Na.a.instance.ia(ma[ec+1])}));return Ab}vDi(ma,Ab,ec){const na=Ea.a.lxf;ma=Object(za.a)(new Xa.a,
{Command:null!=Ab?Ab.toString():null,LabelText:Na.a.instance.ia(ec),Id:ma,ExternalId:this.Ena(ma,Ab),Image16by16:Lb.a.Gn(1),Image16by16Class:na});ma.ShouldTakeFocus=!1;return ma}UPh(){const ma=[2502,2503,2504,2505].map(Ab=>{Ab=Na.a.instance.ia(Ab);return Object(za.a)(new Xa.a,{Command:(-1997160483).toString(),LabelText:Ab,Id:Ab,MenuItemId:Ab,ExternalId:this.Ena(Ab,-1997160483)})});return Object(za.a)(new Ja.a,{ControlList:ma})}rPh(){var ma=Na.a.instance.ia(2506);ma=[Object(za.a)(new Xa.a,{Command:(1485761473).toString(),
LabelText:ma,Id:aa.QKh,ExternalId:this.Ena(ma,1485761473),ExternalImageId:"ChatSparkle_20"})];return Object(za.a)(new Ja.a,{ControlList:ma})}rCi(ma,Ab){const ec=Object(za.a)(new ub.a,{MenuSectionList:[],UpdateDynamically:!0});ec.MenuSectionList.push(this.UPh());ec.MenuSectionList.push(this.rPh());return Object(za.a)(new oc.a,{Command:(1485761473).toString(),LabelText:Ab,ImageIsVisible:!0,Id:ma,ExternalId:this.Ena(ma,1485761473),ExternalImageId:"M365Excel_20",Menu:ec})}ICi(ma,Ab){ma=Object(za.a)(new Xa.a,
{Command:null!=Ab?Ab.toString():null,LabelText:Na.a.instance.ia(2401),Id:ma,ExternalId:this.Ena(ma,Ab),Image16by16:Lb.a.Gn(1),ExternalImageId:"EyedropperFillColor_20"});ma.ShouldTakeFocus=!1;return ma}yni(){this.D$b||(this.D$b=this.lKd("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}D9j(){this.hm.Oyc();if(this.hm.i_b){var ma=this.hm.i_b;const Ab=[];for(const ec of ma)ma=Ma.a.Uia(ec.substr(1)),Ab.push(ma,
ec);this.pUc=this.lKd(...Ab)}}G9j(ma){this.Tw.lJa(ma);if(this.Tw.jzb&&this.Tw.q1g&&!this.Tw.K4f){ma=this.Tw.jzb;const Ab=this.Tw.q1g,ec=[];for(let na=0;na<ma.count;na++)ec.push(ma.ma(na),Ab.ma(na));this.r2c=this.lKd(...ec);return!0}return!1}tRi(ma){switch(ma){case -458147525:ma=1344;break;case 1610379174:ma=1345;break;default:ma=1343}return ma}pIi(ma){switch(ma){case 1549407384:ma=541;break;case -1744769642:ma=539;break;default:ma=540}return ma}}aa.zLj="NoColor";aa.MMh="Automatic";aa.i0k="ThemeColors";
aa.tWk="StandardColors";aa.thk="RecentColors";aa.Igf="ClearColor";aa.H9i="HighlightWhen";aa.MTf="HighlightWhen";aa.Haf="AutomaticColor";aa.p1g="ThemeColorPicker";aa.sWk="StandardColorPicker";aa.zIj="MoreColors";aa.ueg="MoreColors";aa.shk="RecentColorPicker";aa.pHd="Eyedropper";aa.Kkf="CopilotSuggestions";aa.QKh="AskCopilot";Object(w.a)(aa,"ColorPickerBuilder",null,[]);class rc{constructor(ma,Ab,ec,na){this.$=ma;this.NB=Ab;this.hm=ec;this.Tw=na}getColorPickerButtonMenuProps(ma){ma=this.NB.nNf(ma.automaticColor,
ma.clearColor,ma.highlightWhen,ma.moreColors,ma.eyedropper);return{sections:this.xVi(ma)}}showMoreColorsDialog(ma,Ab){this.hm.qxj(ma,Ab)}onColorUsed(ma){ma=ia.a.XM(Ma.a.rP(Ma.a.Uia(ma),!1));this.hm.HXc(ma.r,ma.g,ma.b,K.a.gdc)}getThemeColor(ma){const Ab=Ma.a.Uia(ma);let ec,na;return(()=>{let pb=this.Tw.getThemeColor(Ab);({themeIndex:ec,XQa:na}=pb);return pb})().returnValue?{index:ec,row:na}:(r.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null)}launchEyedropper(ma){F.EwaSettings.isChangeGateEnabled("OfficeVSO:8572137_Eyedropper_Conditional_Formatting")&&
this.hm.launchEyedropper(null,null,ma)}xVi(ma){const Ab=[];for(let na=0;na<ma.length;na++){var ec=Object(Mb.a)(Ja.a,ma[na]);const pb={type:0};pb.title=ec.Title;const R=Object(Mb.a)(Y.a,ec.ControlList[0]);R?(pb.type=1,pb.colorSwatchProps=this.DIi(R),Ab.push(pb)):(ec=Object(Mb.a)(Xa.a,ec.ControlList[0]))&&null!=this.oGf(ec.Id)?(pb.type=2,pb.buttonProps={type:this.oGf(ec.Id),label:ec.LabelText},Ab.push(pb)):r.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return Ab}DIi(ma){const Ab=
ma.Colors;ma={colors:Array(ma.Colors.length),notifyOnColorUsed:this.hm.EUg(ma.ExternalId),isThemeColorSection:!!ma.ExternalId&&ma.ExternalId.includes(aa.p1g)};for(let ec=0;ec<Ab.length;ec++)ma.colors[ec]={id:Ab[ec].DisplayColor,color:Ab[ec].DisplayColor,label:Ab[ec].Alt,index:ec};return ma}oGf(ma){switch(ma){case aa.ueg:return 1;case aa.Igf:return 2;case aa.Haf:return 3;case aa.MTf:return 4;case aa.pHd:return 5}return null}}Object(w.a)(rc,"ColorPickerButtonController",null,[]);Object(Q.b)(O.Qe,{rk:"singleton"})(ma=>
xo(function*(){const Ab=yield Q.a.resolve(O.Ob,ma),ec=yield Q.a.resolve(O.Vd,ma),na=yield Q.a.resolve(O.Fg,ma);return new yb(Ab,ec,na)}));class yb{constructor(ma,Ab,ec){this.Ry=this.ir=null;this.$=ma;this.hm=Ab;this.KRh();this.JRh();this.Tw=ec;this.Esc=new aa(ma,Ab,ec)}KRh(){this.ir={};this.ir.style0=1535;this.ir.style1=1536;this.ir.style2=1537;this.ir.style3=1538;this.ir.style4=1539;this.ir.style5=1540;this.ir.style6=1541;this.ir.style7=1542;this.ir.style8=1543;this.ir.style9=1544;this.ir.style10=
1545;this.ir.style11=1546;this.ir.style12=1547;this.ir.style13=1548;this.ir.style14=1549;this.ir.style15=1550;this.ir.style16=1551;this.ir.style17=1552;this.ir.style18=1553;this.ir.style19=1554;this.ir.style20=1555;this.ir.style21=1556;this.ir.style22=1557;this.ir.style23=1558;this.ir.style24=1559;this.ir.style25=1560;this.ir.style26=1561;this.ir.style27=1562;this.ir.style28=1563;this.ir.style29=1564;this.ir.style30=1565;this.ir.style31=1566;this.ir.style32=1567;this.ir.style33=1568;this.ir.style34=
1569;this.ir.style35=1570;this.ir.style36=1571;this.ir.style37=1572;this.ir.style38=1573;this.ir.style39=1574;this.ir.style40=1575;this.ir.style41=1576}JRh(){this.Ry={};this.Ry.style0=1507;this.Ry.style1=1508;this.Ry.style2=1509;this.Ry.style3=1510;this.Ry.style4=1511;this.Ry.style5=1512;this.Ry.style6=1513;this.Ry.style7=1514;this.Ry.style8=1515;this.Ry.style9=1516;this.Ry.style10=1517;this.Ry.style11=1518;this.Ry.style12=1519;this.Ry.style13=1520;this.Ry.style14=1521;this.Ry.style15=1522;this.Ry.style16=
1523;this.Ry.style17=1524;this.Ry.style18=1525;this.Ry.style19=1526;this.Ry.style20=1527;this.Ry.style21=1528;this.Ry.style22=1529;this.Ry.style23=1530;this.Ry.style24=1531;this.Ry.style25=1532;this.Ry.style26=1533;this.Ry.style27=1534}pGf(ma){return Bb.i(this.Esc.$Jf(ma,null,null,null,null,null,null))}aBc(ma,Ab,ec,na,pb,R,ua,xb,W,xa,kb){Ab=void 0===Ab?null:Ab;ec=void 0===ec?null:ec;na=void 0===na?null:na;pb=void 0===pb?null:pb;R=void 0===R?null:R;ua=void 0===ua?null:ua;xb=void 0===xb?null:xb;W=void 0===
W?null:W;xa=void 0===xa?!1:xa;kb=void 0===kb?null:kb;return Object(za.a)(new ub.a,{MenuSectionList:this.Esc.ZJf(ma,Ab,ec,na,pb,R,ua,xb,W,xa,kb),UpdateDynamically:!0})}nNf(ma,Ab,ec,na,pb){return this.Esc.CYi(ma,Ab,ec,na,pb)}EIi(ma,Ab,ec,na,pb,R,ua){return this.Esc.$Jf(ma,void 0===Ab?null:Ab,void 0===ec?null:ec,void 0===na?null:na,void 0===pb?null:pb,void 0===R?null:R,void 0===ua?null:ua)}GPd(ma,Ab){return(void 0===Ab?0:Ab)?this.Ry[ma]:this.ir[ma]}j6h(){return new rc(this.$,this,this.hm,this.Tw)}hV(ma){var Ab;
const ec=null===(Ab=this.$.shortcutKeyManager)||void 0===Ab?void 0:Ab.Nk(ma);return ec?ec.substring(1,ec.length-1):null}}Object(w.a)(yb,"PopulateDynamicHelper",null,[855]);var Fb=a(42),Qb=a(1143);class ac{constructor(ma,Ab,ec,na,pb,R,ua,xb,W,xa){this.H9e=Ab;this.Gaf=void 0===ec?null:ec;this.Hgf=void 0===pb?null:pb;this.LTf=void 0===R?null:R;this.teg=void 0===xb?null:xb;this.NB=ma;this.Rzf=void 0===W?null:W;this.menuId=void 0===xa?null:xa}M$(){let ma="";const Ab=this.NB.EIi(this.H9e,this.Gaf,this.Hgf,
this.LTf,this.teg,this.Rzf,this.menuId);for(const ec of Ab)ma+=ec;return ma}lM(){return this.NB.aBc(this.H9e,this.Gaf,this.Hgf,this.LTf,void 0,void 0,void 0,this.teg,this.Rzf,!1,this.menuId)}}Object(w.a)(ac,"RibbonColorPicker",null,[439]);var Wa=a(684);class Gb{constructor(ma,Ab){this._id=ma;this.cM=void 0===Ab?"":Ab}get id(){return this._id}get text(){return this.cM}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(ma){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");
}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");}M$(){return`<Label id="${this._id}" LabelText="${this.cM}" />`}Y2(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}D8b(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}W2(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");
}Zrc(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}dva(){return Object(za.a)(new Wa.a,{Id:this.id,LabelText:this.text})}}Object(w.a)(Gb,"RibbonLabel",null,[877,438,439]);class Ub{constructor(ma){this.Fqh=[];this.id=ma}get Jh(){return this.Fqh}M$(){return Bb.q(this.lM())}lM(){const ma=Object(za.a)(new ub.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const Ab of this.Jh)Object($a.a)(ac,Ab)?ma.MenuSectionList.push(...Object(Mb.a)(ac,Ab).lM().MenuSectionList):
ma.MenuSectionList.push(Ab.sqc());return ma}}Object(w.a)(Ub,"RibbonMenu",null,[876,439]);class Ra{constructor(){this.title=null;this.D9=[];this.Hz="Menu16";this.V1g=this.mXg=this.nXg=!0}get buttons(){return this.D9}M$(){return Bb.r(this.sqc())}sqc(){const ma=Object(za.a)(new Ja.a,{ControlList:[]});if(1===this.buttons.length&&Object($a.a)(875,this.buttons[0]))ma.ControlList.push(this.buttons[0].rqc());else{let ec="";for(let na=0;na<this.buttons.length;na++){var Ab=Object(Mb.a)(438,this.buttons[na]);
Ab&&(Ab=Ab.dva(),ma.ControlList.push(Ab),ec+=Ab.Id)}ma.ControlsId=ec+".Controls"}ma.Title=this.title;ma.DisplayMode=this.Hz;ma.ShowMenuSectionTitleIcon=this.nXg;ma.ShowMenuSectionTitleBackground=this.mXg;ma.MenuSectionTitleFocusable=this.V1g;return ma}}Object(w.a)(Ra,"RibbonMenuSection",null,[376,439]);class Rb{constructor(ma,Ab,ec,na,pb,R,ua,xb,W,xa,kb,Pb,T){T=void 0===T?null:T;this.id=ma;this.command=ec;this.Pwg=na;this.populateOnlyOnce=pb;this.t6a=R;this.A9j=ua;this.alt=xb;this.voc=W;this.width=
xa;this.YHh=kb;this.autoComplete=Pb;this.hFa=new Ub(Ab);this.D$e=T;na&&ua&&(ma=new Ra,ma.Hz="MenuLoading",Ab=new Gb(Ab+"LoadingLabel"),ma.buttons.push(Ab),this.menu.Jh.push(ma))}M$(){return this.PPh()}get menu(){return this.hFa}PPh(){let ma=Bb.d(this.id,this.command,this.Pwg,this.populateOnlyOnce,this.t6a,this.A9j,this.alt,this.voc,this.width);const Ab=ma.indexOf(" />");ma=ma.substring(0,Ab);ma+=` ${"AllowDefaultContent"}="${this.YHh.toString()}"`;ma+=` ${"AutoComplete"}="${this.autoComplete?"true":
"false"}"`;this.D$e&&(ma+=` ${"ArrowImgId"}="${this.D$e}"`);ma=ma+">"+this.menu.M$();return ma+"</ComboBox>"}}Object(w.a)(Rb,"RibbonComboBox",null,[916,439]);var ib=a(638),la=a(1144);class db extends la.a{constructor(ma,Ab,ec,na,pb,R,ua,xb,W,xa,kb,Pb,T){Pb=void 0===Pb?null:Pb;T=void 0===T?null:T;super(ma,Ab,ec,pb,R,ua,xb,kb,0);this.PDb=null;this.usa=0===W?null:Na.a.instance.ia(W);this.Lgd=xa;this.Zid=na;this.Tuh=Pb;this.lv=T}get description(){return this.usa}get HRb(){return this.PDb}get menuItemId(){return this.Lgd}get t6a(){return this.Zid}get styles(){return this.Tuh}get data(){return this.lv}M$(){return Bb.n(this.dva())}cqe(ma){this.usa=
ma}toString(){this.HRb||(this.PDb=this.M$());return this.HRb}dva(){const ma=new ib.a;this.Zyc(ma);ma.MenuItemId=this.menuItemId;ma.QueryCommand=this.t6a;ma.Description=this.description;ma.Styles=this.styles;ma.Data=this.data;return ma}}Object(w.a)(db,"RibbonComboBoxItem",la.a,[377,438,439]);class $b extends la.a{constructor(ma,Ab,ec,na,pb,R,ua,xb,W){super(ma,ec,na,pb,R,ua,xb,!1,0);this.populateOnlyOnce=!1;this.wZb=this.menuCloseCommand=this.menuOpenCommand=this.$C=null;this.hFa=new Ub(Ab);this.$Uf=
!0;this.Qld=W}get menu(){return this.hFa}M$(){return Bb.o(this.dva())}dva(){const ma=new oc.a;this.Zyc(ma);ma.PopulateOnlyOnce=this.populateOnlyOnce;ma.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();ma.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();ma.PopulateQueryCommand=this.$C;ma.KeyTip=this.wZb;ma.Menu=this.menu.lM();ma.ImageIsVisible=this.$Uf;ma.ExternalImageId=this.Qld;return ma}}Object(w.a)($b,"RibbonFlyoutAnchor",la.a,[378,
438,439]);var Ic=a(1232),Tc=a(683);class Zc{constructor(){this.qlb=[];this.id=null;this.width=0;this.title=this.nwa=null}M$(){return Bb.p(this.rqc())}uD(ma,Ab,ec,na,pb,R,ua,xb,W,xa,kb){na=void 0===na?0:na;pb=void 0===pb?null:pb;R=void 0===R?null:R;ua=void 0===ua?null:ua;xb=void 0===xb?null:xb;W=void 0===W?null:W;xa=void 0===xa?null:xa;kb=(kb=void 0===kb?null:kb)?Na.a.instance.ia(na)+Fc.HelperMethods.Xef+kb:Na.a.instance.ia(na);this.MWf(this.qlb.length,ma,Ab,ec,0===na?W:kb,pb,R,ua,xb,xa)}MWf(ma,Ab,
ec,na,pb,R,ua,xb,W,xa){R=void 0===R?null:R;ua=void 0===ua?null:ua;xb=void 0===xb?null:xb;W=void 0===W?null:W;xa=void 0===xa?null:xa;(ma>this.qlb.length||0>ma)&&Error.argumentOutOfRange("Invalid Index");this.qlb.splice(ma,0,Object(za.a)(new Ic.a,{Id:Ab,Command:ec.toString(),QueryCommand:null!==na&&void 0!==na?na:null,Alt:pb,MenuItemId:R,Icon:ua,Image:xb?Lb.a.Gn(xb):null,ImageClass:W,LabelText:xa}))}rqc(ma){ma=void 0===ma?!1:ma;let Ab=null,ec=null;switch(this.nwa){case "Size120by20":Ab=this.OKb(120,
20,ma);ec=this.MKb(130,30,ma);break;case "Size90by21":Ab=this.OKb(90,21,ma);ec=this.MKb(100,33,ma);break;case "Size24by24With7Options":Ab=this.OKb(24,24,ma);ec=this.MKb(34,34,ma);break;case "Size24by24":Ab=this.OKb(28,28,ma);ec=this.MKb(38,38,ma);break;case "Size112by64":Ab=this.OKb(24,24,ma),ec=this.MKb(112,64,ma)}for(ma=0;ma<this.qlb.length;ma++)this.qlb[ma].FullIconStyle=Ab;return Object(za.a)(new Tc.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.nwa,
GalleryItems:this.qlb,GalleryStyle:ec})}OKb(ma,Ab,ec){const na={},pb={};pb.width=ma;pb.height=Ab;ec&&(pb.alignSelf="center",pb.marginBottom="4px");na.root=pb;return na}MKb(ma,Ab,ec){const na={},pb={},R={};R.width=ma;R.height=Ab;pb.root=R;ec&&(pb.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});na.galleryButtonInExpanded=pb;return na}}Object(w.a)(Zc,"RibbonGallery",null,[875,439]);var cc=a(1292),Yc=a(940),Vc;let wd=Vc=class{constructor(ma){this.NB=void 0===ma?null:ma}get LCc(){return this.NB}tw(ma){return new Ub(void 0===
ma?null:ma)}ii(){return new Ra}jh(ma){var Ab=Fb.a.tj(Vc.Sgb,ma.toString());if(Ab)return Ab;Ab=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8841818_ContextMenuDeleteColumnsAndRows");switch(ma){case 249:return this.ei(ma,"ContextMenu.Show.ChartTaskPane",1221897806,Ea.a.nyf,4,983);case 287:return this.ei(ma,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");
case 141:return this.Qp(ma,"DataLabels.None.BoxWhisker",374300079,Ea.a.Wxf,929,930,1600);case 0:return this.Qp(ma,"DataLabels.None.Column",374300079,Ea.a.Vxf,929,930,1600);case 1:return this.Qp(ma,"DataLabels.None.Line",374300079,Ea.a.Xxf,929,930,1600);case 2:return this.Qp(ma,"DataLabels.None.Pie",374300079,Ea.a.Yxf,929,930,1600);case 3:return this.Qp(ma,"DataLabels.Show.Column",-1809877936,Ea.a.eyc,931,932,1601);case 143:return this.Qp(ma,"DataLabels.Show.Funnel",-1809877936,Ea.a.eyc,931,934,1601);
case 144:return this.Qp(ma,"DataLabels.Show.Treemap",-1809877936,Ea.a.oGd,931,938,1601);case 145:return this.Qp(ma,"DataLabels.Show.Sunburst",-1809877936,Ea.a.nGd,931,934,1601);case 4:return this.Qp(ma,"DataLabels.Center.Column",-1996266048,Ea.a.eyc,933,934,1602);case 5:return this.Qp(ma,"DataLabels.Center.Line",-1996266048,Ea.a.Qxf,933,934,1602);case 6:return this.Qp(ma,"DataLabels.Center.Pie",-1996266048,Ea.a.nGd,933,934,1602);case 7:return this.Qp(ma,"DataLabels.InsideEnd.Column",493396546,Ea.a.Rxf,
935,936,1603);case 8:return this.Qp(ma,"DataLabels.InsideEnd.Pie",493396546,Ea.a.Sxf,935,936,1603);case 9:return this.Qp(ma,"DataLabels.InsideBase.Column",1599247052,Ea.a.oGd,937,938,1604);case 10:return this.Qp(ma,"DataLabels.OutsideEnd.Column",342855531,Ea.a.Zxf,939,940,1605);case 11:return this.Qp(ma,"DataLabels.OutsideEnd.Pie",342855531,Ea.a.$xf,939,940,1605);case 140:return this.Qp(ma,"DataLabels.Left.BoxWhisker",-472675112,Ea.a.Uxf,941,942,1606);case 12:return this.Qp(ma,"DataLabels.Left.Line",
-472675112,Ea.a.Txf,941,942,1606);case 142:return this.Qp(ma,"DataLabels.Right.BoxWhisker",-1774499423,Ea.a.byf,943,944,1607);case 13:return this.Qp(ma,"DataLabels.Right.Line",-1774499423,Ea.a.ayf,943,944,1607);case 138:return this.Qp(ma,"DataLabels.Above.BoxWhisker",-204160914,Ea.a.Mxf,945,946,1608);case 14:return this.Qp(ma,"DataLabels.Above.Line",-204160914,Ea.a.cyf,945,946,1608);case 139:return this.Qp(ma,"DataLabels.Below.BoxWhisker",-87783054,Ea.a.Nxf,947,948,1609);case 15:return this.Qp(ma,
"DataLabels.Below.Line",-87783054,Ea.a.Pxf,947,948,1609);case 16:return this.Qp(ma,"DataLabels.BestFit.Pie",1650379138,Ea.a.Oxf,949,950,1610);case 17:return this.Qp(ma,"Axes.Horizontal.None",895828731,Ea.a.Bxf,929,951,1613);case 18:return this.Qp(ma,"Axes.Horizontal.ShowLTR",683614408,Ea.a.lGd,952,953,1614);case 19:return this.Qp(ma,"Axes.Horizontal.NoLabels",-1612014670,Ea.a.Axf,956,957,1615);case 20:return this.Qp(ma,"Axes.Horizontal.ShowRTL",1259259728,Ea.a.Cxf,958,959,1616);case 21:return this.Qp(ma,
"Axes.Horizontal.Default",683614408,Ea.a.lGd,954,955,1617);case 22:return this.Qp(ma,"Axes.Horizontal.Thousands",-220179662,Ea.a.Dxf,960,961,1618);case 23:return this.Qp(ma,"Axes.Horizontal.Millions",1534680966,Ea.a.zxf,962,963,1619);case 24:return this.Qp(ma,"Axes.Horizontal.Billions",-238895611,Ea.a.xxf,964,965,1620);case 25:return this.Qp(ma,"Axes.Horizontal.LogScale",-892714755,Ea.a.yxf,966,967,1621);case 26:return this.Qp(ma,"Axes.Vertical.None",2006508979,Ea.a.Ixf,929,951,1613);case 27:return this.Qp(ma,
"Axes.Vertical.Default",252405382,Ea.a.Kxf,954,955,1617);case 28:return this.Qp(ma,"Axes.Vertical.Thousands",670842692,Ea.a.Lxf,960,961,1618);case 29:return this.Qp(ma,"Axes.Vertical.Millions",-572426128,Ea.a.Gxf,962,963,1619);case 30:return this.Qp(ma,"Axes.Vertical.Billions",-806496391,Ea.a.Exf,964,965,1620);case 31:return this.Qp(ma,"Axes.Vertical.LogScale",-1700998151,Ea.a.Fxf,966,967,1621);case 32:return this.Qp(ma,"Axes.Vertical.NoLabels",2104548628,Ea.a.Hxf,956,957,1615);case 33:return this.Qp(ma,
"Axes.Vertical.ShowRTL",1717508862,Ea.a.Jxf,958,959,1616);case 34:return this.Qp(ma,"Gridlines.Horizontal.None",80515665,Ea.a.hyf,929,970,1624);case 35:return this.Qp(ma,"Gridlines.Horizontal.Major",-306129902,Ea.a.eyf,972,973,1625);case 36:return this.Qp(ma,"Gridlines.Horizontal.Minor",2147076534,Ea.a.fyf,975,976,1626);case 37:return this.Qp(ma,"Gridlines.Horizontal.MajorMinor",-1253752845,Ea.a.gyf,978,979,1627);case 38:return this.Qp(ma,"Gridlines.Vertical.None",1711257557,Ea.a.myf,929,971,1624);
case 39:return this.Qp(ma,"Gridlines.Vertical.Major",-1772953364,Ea.a.jyf,972,974,1625);case 40:return this.Qp(ma,"Gridlines.Vertical.Minor",680253336,Ea.a.kyf,975,977,1626);case 41:return this.Qp(ma,"Gridlines.Vertical.MajorMinor",-215161981,Ea.a.lyf,978,980,1627);case 135:return this.ei(ma,"ContextMenu.NumberFormating",2105621672,Ea.a.aGd,1,476,135!==ma,null,null,this.NB.hV(406));case 300:return this.ei(ma,"ContextMenu.FormatCells",2055979337,null,1,477,300!==ma,void 0,"PaintBrushandBucket_20",
this.NB.hV(406));case 361:return this.ei(ma,"ContextMenu.FormatCellsNumberFormatTaskPane",-395879625,null,1,477,361!==ma,void 0,"PaintBrushandBucket_20",this.NB.hV(406));case 362:return this.ei(ma,"ContextMenu.FontTaskPane",456320978,null,1,477,362!==ma,void 0,"PaintBrushandBucket_20",this.NB.hV(406));case 136:return this.ei(ma,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,Ea.a.aGd,1,476,136!==ma);case 42:return this.ei(ma,"ContextMenu.Cut",-1985798686,Ea.a.$wf,1,12,!1,null,null,this.NB.hV(172));
case 43:return this.ei(ma,"ContextMenu.Copy",-911352779,Ea.a.Yxc,1,11,!1,null,null,this.NB.hV(174));case 212:return this.ei(ma,"ContextMenu.InsertCopiedCells",-160032004,Ea.a.jyc,3,15);case 213:return this.ei(ma,"ContextMenu.InsertCutCells",-1065525230,Ea.a.jyc,3,21);case 354:return this.ei(ma,"ContextMenu.PasteValues",-185374993,Ea.a.oxf,8,1149,null,null,"PasteValues_20",this.NB.hV(178));case 355:return this.ei(ma,"ContextMenu.PasteFormulas",1766348718,Ea.a.oxf,8,1150,null,null,"PasteFormulas_20");
case 356:return this.ei(ma,"ContextMenu.PasteFormatting",1804571062,Ea.a.sri,3,1152,null,null,"PasteFormatting_20");case 357:return this.ei(ma,"ContextMenu.PasteLink",42074747,Ea.a.wri,3,1153,null,null,"PasteLink_20");case 358:return this.ei(ma,"ContextMenu.PasteWithColumnWidths",264209770,null,3,2299,null,null,"PasteWithColumnWidths_20");case 359:return this.ei(ma,"ContextMenu.PasteTranspose",-958589048,Ea.a.yri,3,1151,null,null,"PasteTranspose_20");case 44:case 57:return this.ei(ma,"ContextMenu.Paste",
237279923,Ea.a.cyc,1,13,44!==ma,"Paste",null,this.NB.hV(176));case 248:return this.ei(ma,"PasteAdvancedOptionsGallery",237279923,Ea.a.cyc,1,13,44!==ma,"Paste");case 45:case 120:return this.ei(ma,"ContextMenu.EditHyperlink",-1583422759,Ea.a.gyc,8,1140,45!==ma,"EditHyperlink");case 46:case 121:return this.ei(ma,"ContextMenu.InsertHyperlink",-1583422759,Ea.a.gyc,8,1141,46!==ma,"InsertHyperlink",null,this.NB.hV(156));case 47:case 122:return this.ei(ma,"ContextMenu.RemoveHyperlink",-1253126584,Ea.a.wGd,
8,1142,47!==ma,"RemoveHyperlink");case 48:case 123:return this.ei(ma,"ContextMenu.RemoveHyperlinks",-1253126584,Ea.a.wGd,8,1143,48!==ma,"RemoveHyperlinks");case 250:return this.Nr(ma,"ContextMenu.ContextMenuSmartLookup",-983891024,1810);case 187:case 188:case 165:case 173:return this.ei(ma,"ContextMenu.InsertCellsShiftRight",1035996630,Ea.a.ixf,1,165===ma||173===ma?F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?18:341:F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?19:342,173===ma||188===ma,"InsertCellsShiftRight");case 166:case 174:return this.ei(ma,"ContextMenu.InsertCellsShiftDown",1035996630,Ea.a.hxf,1,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?20:344,166!==ma,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.ei(ma,"ContextMenu.DeleteCellsShiftLeft",1035996630,Ea.a.dxf,1,167===ma||175===ma?F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?19:342:F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?18:341,175===ma||190===ma,"DeleteCellsShiftLeft");case 168:case 176:return this.ei(ma,"ContextMenu.DeleteCellsShiftUp",1035996630,Ea.a.exf,1,343,168!==ma,"DeleteCellsShiftUp");case 177:case 181:return this.ei(ma,"ContextMenu.InsertRowsSheet",-1113896058,Ea.a.bGd,1,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)||F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?430:429,177!==ma,"InsertRows");case 363:case 364:return this.ei(ma,"ContextMenu.InsertRowsAfterSheet",75170472,null,1,2526,363!==ma,"InsertRowsAfter");case 49:case 116:return this.ei(ma,"ContextMenu.InsertRows",-1113896058,Ea.a.bGd,1,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)||F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2420:346,49!==ma,"InsertRows");case 365:case 366:return this.ei(ma,
"ContextMenu.InsertRowsAfter",75170472,null,1,2531,365!==ma,"InsertRowsAfter");case 161:case 169:return this.ei(ma,"ContextMenu.InsertRowsTable",942362098,Ea.a.kxf,1,421,161!==ma,"InsertRowsTable");case 50:case 117:return this.ei(ma,"ContextMenu.InsertColumns",1415868706,Ea.a.zwa,1,406,50!==ma,"InsertColumns");case 336:case 337:return this.ei(ma,"ContextMenu.InsertColumnsToTheLeft",1415868706,Ea.a.zwa,1,407,336!==ma,"InsertColumns");case 369:case 370:return this.ei(ma,"ContextMenu.InsertColumnsToTheLeft",
-612877076,Ea.a.zwa,1,407,369!==ma,"InsertColumns");case 288:case 289:return this.ei(ma,"ContextMenu.contextMenuInsertColumnsToTheRight",1415868706,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?null:Ea.a.zwa,1,408,288!==ma,"InsertColumns");case 367:case 368:return this.ei(ma,"ContextMenu.contextMenuInsertColumnsAfterToTheRight",-612877076,null,1,408,367!==ma,"InsertColumnsAfter");case 178:case 182:return this.ei(ma,"ContextMenu.InsertColumnsSheet",
1415868706,Ea.a.zwa,1,426,178!==ma,"InsertColumns");case 334:case 335:return this.ei(ma,"ContextMenu.InsertColumnsSheetToTheLeft",1415868706,Ea.a.zwa,1,427,334!==ma,"InsertColumns");case 371:case 372:return this.ei(ma,"ContextMenu.InsertColumnsAfterSheetToTheLeft",-612877076,Ea.a.zwa,1,427,371!==ma,"InsertColumnsAfter");case 290:case 291:return this.ei(ma,"ContextMenu.InsertColumnsSheet",1415868706,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?
null:Ea.a.zwa,1,428,290!==ma,"InsertColumns");case 373:case 374:return this.ei(ma,"ContextMenu.InsertColumnsAfterSheetToTheRight",-612877076,null,1,428,373!==ma,"InsertColumnsAfter");case 191:case 192:case 162:case 170:return this.ei(ma,"ContextMenu.InsertColumnsTable",622604322,Ea.a.jxf,1,162===ma||170===ma?419:420,170===ma||192===ma,"InsertColumnsTable");case 179:case 183:return this.ei(ma,"ContextMenu.DeleteRowsSheet",1554436520,Ea.a.ayc,1,429,179!==ma,"DeleteRows");case 51:case 118:return this.ei(ma,
"ContextMenu.DeleteRows",1554436520,Ea.a.ayc,1,410,51!==ma,"DeleteRows");case 163:case 171:return this.ei(ma,"ContextMenu.DeleteRowsTable",1405456548,Ab?null:Ea.a.ayc,1,418,163!==ma,"DeleteRowsTable",Ab?"DeleteTableRows_20":void 0);case 180:case 184:return this.ei(ma,"ContextMenu.DeleteColumnsSheet",674605324,Ab?null:Ea.a.$xc,1,426,180!==ma,"DeleteColumns",Ab?"DeleteSheetColumns_20":void 0);case 52:case 119:return this.ei(ma,"ContextMenu.DeleteColumns",674605324,Ea.a.$xc,1,411,52!==ma,"DeleteColumns");
case 164:case 172:return this.ei(ma,"ContextMenu.DeleteColumnsTable",284490184,Ea.a.$xc,1,417,164!==ma,"DeleteColumnsTable");case 53:case 124:return this.Nr(ma,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==ma,"OpenHyperlink",this.NB.hV(101));case 263:return this.ei(ma,"SheetOpsContextMenu.ShowChanges",1834994092,Ea.a.yGd,8,443,void 0,jb.a.AQk);case 264:return this.ei(ma,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.ei(ma,"GridContextMenu.ZoomFitToScreenUndo",
-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.ei(ma,"GridContextMenu.ShowChanges",1834994092,Ea.a.yGd,8,443,void 0,jb.a.sVg);case 54:return this.ei(ma,"ContextMenu.InsertSheet",-1935155518,Ea.a.cGd,1,514);case 360:return this.ei(ma,"ContextMenu.AppendSheet",-546331179,Ea.a.cGd,1,514);case 56:case 127:return this.ei(ma,"ContextMenu.DeleteSheet",1880294140,Ea.a.fxf,1,515,56!==ma,"DeleteSheet");case 55:return this.Nr(ma,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.Nr(ma,
"ContextMenu.ReorderSheet",-383100692,517,125!==ma,"ReorderSheet");case 158:return this.Nr(ma,"ContextMenu.DuplicateSheet",-1254662242,441);case 338:case 339:return Ab=338!==ma,this.ei(ma,Ab?"ContextMenu.FullSheetCopyDisabled":"ContextMenu.FullSheetCopy",-207190267,Ea.a.Yxc,1,2431,Ab,null);case 340:case 341:return Ab=340!==ma,this.ei(ma,Ab?"ContextMenu.FullSheetPasteDisabled":"ContextMenu.FullSheetPaste",440556491,Ea.a.cyc,1,2430,Ab,null);case 112:case 114:return this.Nr(ma,"ContextMenu.HideSheet",
1458540255,519,112!==ma,"HideSheet");case 113:case 115:return this.Nr(ma,"ContextMenu.UnhideSheet",1129633328,520,113!==ma,"UnhideSheet");case 277:return this.ei(ma,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.ei(ma,"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.ei(ma,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.Nr(ma,
"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.ei(ma,"ContextMenu.PivotExpand",-1687560254,Ea.a.gGd,9,1168);case 244:return this.ei(ma,"ContextMenu.PivotCollapse",1176256599,Ea.a.fGd,9,1169);case 245:return this.ei(ma,"ContextMenu.PivotExpandEntireField",-1751201991,Ea.a.gGd,9,1170);case 246:return this.ei(ma,"ContextMenu.PivotCollapseEntireField",-232434744,Ea.a.fGd,9,1171);case 247:return this.ei(ma,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");
case 301:return this.ei(ma,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,Yc.a.g8j);case 306:return this.ei(ma,"ContextMenu.ManualUngroup",-1683649734,null,17,2347,void 0,void 0);case 307:return this.ei(ma,"ContextMenu.ManualGroup",660506187,null,17,2346,void 0,void 0);case 59:return this.ei(ma,"ContextMenu.PivotFieldListShow",2140436015,Ea.a.hGd,9,1173);case 58:return this.ei(ma,"ContextMenu.PivotFieldListHide",-1006032470,Ea.a.hGd,9,1174);case 258:return this.ei(ma,"ContextMenu.PivotSettingsPaneShow",
1529441790,Ea.a.kQb,17,636);case 257:return this.ei(ma,"ContextMenu.PivotSettingsPaneHide",1529441790,Ea.a.kQb,17,637);case 259:return this.Nr(ma,"ContextMenu.PivotTableNoSubtotal",-2016405815,638);case 260:return this.Nr(ma,"ContextMenu.PivotTableSubtotalOnTop",671485366,639);case 261:return this.Nr(ma,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return Ab=60!==ma,this.Nr(ma,Ab?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,Ab,null);
case 61:case 65:return Ab=61!==ma,this.Nr(ma,Ab?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,Ab,null);case 62:case 66:return Ab=62!==ma,this.Nr(ma,Ab?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",389774337,1091,Ab,null);case 63:case 67:return Ab=63!==ma,this.Nr(ma,Ab?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",2033235475,1092,Ab,null);case 68:case 72:return Ab=68!==ma,this.ei(ma,Ab?"ContextMenu.FieldWellMoveToReportFilterDisabled":
"ContextMenu.FieldWellMoveToReportFilter",-96230454,Ea.a.Vxc,9,1093,Ab,null);case 69:case 73:return Ab=69!==ma,this.ei(ma,Ab?"ContextMenu.FieldWellMoveToRowLabelsDisabled":"ContextMenu.FieldWellMoveToRowLabels",74086617,Ea.a.pkb,9,1094,Ab,null);case 70:case 74:return Ab=70!==ma,this.ei(ma,Ab?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",1529312473,Ea.a.okb,9,1095,Ab,null);case 71:case 75:return Ab=71!==ma,this.ei(ma,Ab?"ContextMenu.FieldWellMoveToValuesDisabled":
"ContextMenu.FieldWellMoveToValues",563292088,Ea.a.Wxc,9,1098,Ab,null);case 76:return this.ei(ma,"ContextMenu.FieldWellRemoveField",-1092351914,Ea.a.bxf,9,1099);case 77:return this.ei(ma,"ContextMenu.FieldWellValueFieldSettings",-2141589616,Ea.a.wxf,9,1100);case 79:case 83:return this.ei(ma,"ContextMenu.FieldListMoveToReportFilter",359279088,Ea.a.Vxc,9,1082,79!==ma,null);case 80:case 84:return this.ei(ma,"ContextMenu.FieldListMoveToRowLabels",-67292059,Ea.a.pkb,9,1083,80!==ma,null);case 81:case 85:return this.ei(ma,
"ContextMenu.FieldListMoveToColumnsLabels",745182485,Ea.a.okb,9,1084,81!==ma,null);case 82:case 86:return this.ei(ma,"ContextMenu.FieldListMoveToValues",926905850,Ea.a.Wxc,9,1087,82!==ma,null);case 95:case 97:return Ab=95!==ma,this.ei(ma,Ab?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,Ea.a.pkb,9,1096,Ab,null);case 96:case 98:return Ab=96!==ma,this.ei(ma,Ab?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",
1529312473,Ea.a.okb,9,1097,Ab,null);case 78:return this.ei(ma,"ContextMenu.FieldListAddAsSlicer",547535945,Ea.a.YFd,9,1088);case 332:case 333:return this.ei(ma,"ContextMenu.FieldListAddAsTimeline",-2108836646,null,9,2393,333===ma,void 0,"TimeSlicerInsert_20");case 91:case 93:return this.ei(ma,"ContextMenu.FieldListMoveToRowChartLabels",-67292059,Ea.a.pkb,9,1085,91!==ma,null);case 92:case 94:return this.ei(ma,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,Ea.a.okb,9,1086,92!==ma,null);case 99:return this.ei(ma,
"ContextMenu.BIExploreShowCallout",1529658657,Ea.a.Xxc,9,1193);case 100:return this.ei(ma,"ContextMenu.ContextMenuRefresh",2054778433,Ea.a.rxf,9,1181);case 102:return this.ei(ma,"ContextMenu.EditCell",324156914,Ea.a.vGd,8,579);case 101:return this.ei(ma,"Contextenu.DeleteChart",2045211913,Ea.a.fyc,8,578);case 308:return this.ei(ma,"Contextmenu.DeleteChartElement",2045211913,Ea.a.fyc,8,2358);case 321:return this.Nr(ma,"Contextmenu.AddDataLabels",1849330294,2359,!1);case 350:return this.Nr(ma,"Contextmenu.AddErrorBarX",
-873142594,2367,!1);case 351:return this.Nr(ma,"Contextmenu.AddErrorBarY",1855740761,2367,!1);case 352:return this.Nr(ma,"Contextmenu.AddErrorBarHz",-873142594,2438,!1);case 353:return this.Nr(ma,"Contextmenu.AddErrorBarVt",1855740761,2440,!1);case 322:return this.Nr(ma,"Contextmenu.AddTrendline",2117491830,2363,!1);case 323:return this.Nr(ma,"Contextmenu.AddTrendlineTitle",2107851680,2365,!1);case 324:return this.Nr(ma,"Contextmenu.AddAxisTitle",-1986737526,2386,!1);case 325:return this.Nr(ma,"Contextmenu.AddMajorGridlines",
119706583,2370,!1);case 326:return this.Nr(ma,"Contextmenu.AddMinorGridlines",-1741941813,2372,!1);case 342:return this.ei(ma,"Contextmenu.EditTextChartTitle",419803868,null,8,818,void 0,void 0,"Textbox_20");case 343:return this.ei(ma,"Contextmenu.EditTextAxisTitleHorizontal",-2011789595,null,8,818,void 0,void 0,"Textbox_20");case 344:return this.ei(ma,"Contextmenu.EditTextAxisTitleVertical",-1513952223,null,8,818,void 0,void 0,"Textbox_20");case 146:return this.ei(ma,"ContextMenu.AltText",1804967129,
Ea.a.tGd,8,817);case 302:return this.ei(ma,"ContextMenu.CellImageAltText",1516436924,Ea.a.tGd,8,817);case 147:return this.ei(ma,"ContextMenu.EditShapeText",-445658892,Ea.a.vyf,8,818);case 186:return this.ei(ma,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.ei(ma,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",Yc.a.bringForward);case 282:return this.ei(ma,"ContextMenu.BringToFront",-1480025782,null,8,822,!1,"ContextMenu.BringToFront",Yc.a.bringToFront);
case 283:return this.ei(ma,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",Yc.a.sendBackward);case 284:return this.ei(ma,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",Yc.a.sendToBack);case 273:return this.ei(ma,"ContextMenu.OfficeScriptsViewScript",-585097204,Ea.a.Vwf,8,2151);case 160:return this.ei(ma,"ContextMenu.InsertComment",-1667294294,Ea.a.xyf,8,1146,!1,null,null,this.NB.hV(351));case 221:return this.ei(ma,"ContextMenu.DeleteComment",
467845448,Ea.a.uyf,8,1162);case 159:return this.ei(ma,"ContextMenu.InsertReply",-1667294294,Ea.a.yyf,8,1145);case 226:return this.ei(ma,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20",this.NB.hV(348));case 227:return this.ei(ma,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.ei(ma,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.ei(ma,"ContextMenu.ShowOrHideNote",1627476102,
null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.Nr(ma,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.k5(ma,"Form.InsertForm",1305810481,Ea.a.eGd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.k5(ma,"Form.ViewForm",330035228,Ea.a.eGd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.k5(ma,"Form.EditForm",1305810481,Ea.a.gxf,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.k5(ma,"Form.DeleteForm",-509039657,Ea.a.cxf,1,"Image16by16",1270,
0,null,!1,1598);case 106:return this.k5(ma,"Form.ShareForm",1334518759,Ea.a.sxf,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.ei(ma,"ContextMenu.ClearContent",-848953656,Ea.a.dri,1,445,148!==ma,null,"Clear_20"):this.Nr(ma,"ContextMenu.ClearContent",-848953656,445,148!==ma);case 150:case 151:return this.ei(ma,"ContextMenu.RowHeight",2040891415,Ea.a.xGd,8,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?459:434,151===ma);case 152:case 153:return this.ei(ma,"ContextMenu.ColumnWidth",957527587,Ea.a.sGd,8,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?459:433,153===ma);case 377:case 378:return this.ei(ma,"ContextMenu.AutoFitColumnWidth",1391094586,null,3,433,378===ma,null,"AutoFitColumnWidth_20");case 379:case 380:return this.ei(ma,"ContextMenu.AutoFitRowHeight",146338636,null,3,434,380===ma,null,"AutoFitRowHeight_20");case 108:case 154:return this.Nr(ma,
"ContextMenu.HideRows",1051390410,432,154===ma);case 110:case 156:return this.Nr(ma,"ContextMenu.UnhideRows",1542466017,439,156===ma);case 109:case 155:return this.Nr(ma,"ContextMenu.HideColumns",-706918724,438,155===ma);case 111:case 157:return this.Nr(ma,"ContextMenu.UnhideColumns",369708605,440,157===ma);case 216:return this.Nr(ma,"ContextMenu.ShowCard",-843616717,1786,216!==ma);case 217:return this.Nr(ma,"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.ei(ma,"ContextMenu.PlaceInCell",
-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.ei(ma,"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.ei(ma,"ContextMenu.CreateReference",1983877126,null,8,2302,void 0,void 0,"PictureLinked_20");case 215:case 268:return this.Nr(ma,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===ma);case 218:case 269:return this.Nr(ma,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===ma);case 220:case 271:return this.Nr(ma,
"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===ma);case 219:case 270:return this.Nr(ma,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===ma);case 234:return this.ei(ma,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.ei(ma,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.ei(ma,"ContextMenu.FilterByValue",1803952894,null,1,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?2522:222);case 313:return this.ei(ma,"ContextMenu.FilterByCellColor",486423932,null,1,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2523:2375);case 314:return this.ei(ma,"ContextMenu.FilterByCellFontColor",-652157481,null,1,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2524:2376);case 315:return this.ei(ma,"ContextMenu.FilterByCellIcon",-1656122924,null,1,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?2525:2377);case 223:return this.ei(ma,"ContextMenu.SortAscending",-1010737776,Ea.a.uxf,1,228);case 292:return this.Nr(ma,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2518:230);case 293:return this.Nr(ma,"ContextMenu.PutSelectedFontColorOnTop",-764711886,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2519:231);case 294:return this.Nr(ma,"ContextMenu.PutSelectedFormattingIconOnTop",
-2016161444,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2520:232);case 224:return this.ei(ma,"ContextMenu.SortDescending",2123420468,Ea.a.vxf,1,229);case 225:return this.ei(ma,"ContextMenu.SortCustom",-207540907,Ea.a.dyc,1,233);case 232:return this.ei(ma,"ContextMenu.ConvertToRange",323142015,Ea.a.Zwf,1,740);case 272:return this.ei(ma,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,Ea.a.vGd,8,661);case 239:return this.ei(ma,"ContextMenu.IgnoreError",
886009118,Ea.a.uGd,8,2112,239!==ma);case 240:return this.ei(ma,"ContextMenu.IgnoreErrors",886009118,Ea.a.uGd,8,2113,240!==ma);case 241:return this.Nr(ma,"ContextMenu.ShowError",-1779556985,2114,241!==ma);case 251:return this.ei(ma,"ContextMenu.SlicerRefresh",-231711729,Ea.a.qxf,0,2177,251!==ma);case 252:return this.ei(ma,"ContextMenu.SlicerClearFilter",-1909381757,Ea.a.ZFd,0,2178,252!==ma);case 375:return this.ei(ma,"ContextMenu.AutoToggleFilter",368460465,null,1,2538,375!==ma,null,"Filter_20");case 376:return this.ei(ma,
"ContextMenu.RemoveAutoToggleFilter",368460465,null,1,2533,void 0,void 0,"DeleteFilter_20");case 345:return this.ei(ma,"ContextMenu.TimeSlicerClearFilter",-741340954,Ea.a.ZFd,0,2178,345!==ma);case 254:return this.Nr(ma,"ContextMenu.SlicerDelete",2045211913,2181,254!==ma);case 253:return this.ei(ma,"ContextMenu.SlicerMultiSelect",2108047455,Ea.a.dGd,0,2180,253!==ma);case 255:return this.ei(ma,"ContextMenu.SlicerSortAscending",-923375148,Ea.a.hyc,8,2183,255!==ma);case 256:return this.ei(ma,"ContextMenu.SlicerSortDescending",
1164937340,Ea.a.iyc,8,2182,256!==ma);case 267:return this.ei(ma,"ContextMenu.SlicerSettingsPaneShow",522377926,Ea.a.kQb,17,636);case 266:return this.ei(ma,"ContextMenu.SlicerSettingsPaneHide",522377926,Ea.a.kQb,17,637);case 128:return this.PHa(ma,-619033944,1,1438);case 129:return this.PHa(ma,-619033944,2,1440);case 130:return this.PHa(ma,-619033944,3,1442);case 131:return this.PHa(ma,-619033944,4,1443);case 132:return this.Kfa(ma,-1736601456,7,1447);case 133:return this.Kfa(ma,-1736601456,8,1449);
case 134:return this.Kfa(ma,-1736601456,0,1450);case 196:return this.PHa(ma,-2136556471,1,1438);case 198:return this.PHa(ma,-2136556471,2,1440);case 200:return this.PHa(ma,-2136556471,3,1442);case 201:return this.PHa(ma,-2136556471,4,1443);case 204:return this.Kfa(ma,1201641489,0,1447);case 205:return this.Kfa(ma,1201641489,1,1448);case 206:return this.Kfa(ma,1201641489,7,1449);case 207:return this.Kfa(ma,1201641489,2,1450);case 208:return this.Kfa(ma,1201641489,4,1451);case 209:return this.Kfa(ma,
1201641489,3,1452);case 210:return this.Kfa(ma,1201641489,5,1453);case 211:return this.Kfa(ma,1201641489,6,1454);case 274:return this.ei(ma,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,Nb.a.isFluentIconsEnabled()&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 275:return this.ei(ma,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,Nb.a.isFluentIconsEnabled()&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?
"LinkToSection_20":"ShareSectionEntry_20");case 276:return this.ei(ma,"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,Nb.a.isFluentIconsEnabled()&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 317:return this.ei(ma,"ContextMenu.ShareNamedSheetView",-1592351768,null,1,2382,void 0,void 0,Nb.a.isFluentIconsEnabled()&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");
case 319:return this.ei(ma,"ContextMenu.ExitNamedSheetView",1690118309,null,3,2381,void 0,void 0,"ExitSheetView_20");case 299:return this.ei(ma,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,Nb.a.isFluentIconsEnabled()&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 312:return this.ei(ma,"ContextMenu.ShareSheet",783415632,null,1,2374,void 0,void 0,Nb.a.isFluentIconsEnabled()&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?
"LinkToSection_20":"ShareSectionEntry_20");case 309:return this.ei(ma,"ContextMenu.FlyoutShareSheet",783415632,null,1,2355,void 0,void 0);case 310:return this.ei(ma,"ContextMenu.FlyoutShareRange",-1099009678,null,1,2356,void 0,void 0);case 311:return this.ei(ma,"ContextMenu.FlyoutShareTable",192430811,null,1,2357,void 0,void 0);case 285:return this.ei(ma,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.ei(ma,"ContextMenu.TableAltText",-723113214,
null,1,817,void 0,void 0,"ShowTableAltTextDlg_20");case 330:return this.ei(ma,"ContextMenu.CopyHyperlink",-1257360929,Ea.a.Yxc,1,2410,330!==ma);case 331:return this.ei(ma,"ContextMenu.ShowLinkPreview",1915212877,null,1,2411,331!==ma);case 381:return this.ei(ma,"ContextMenu.ObserverChartHelp",1942711205,null,8,2410,void 0,void 0,"OfficeAssistant_20")}return null}k5(ma,Ab,ec,na,pb,R,ua,xb,W,xa,kb,Pb,T){Ab=new Qb.RibbonButtonObject(Ab,ua,ec,null,pb,na,R,ua,xb,W,xa,kb,!0,void 0===Pb?null:Pb,void 0===
T?null:T);return Vc.Sgb[ma.toString()]=Ab}ei(ma,Ab,ec,na,pb,R,ua,xb,W,xa){W=void 0===W?null:W;return this.k5(ma,Ab,ec,W?null:na,pb,"Image16by16",R,0,void 0===xb?null:xb,void 0===ua?!1:ua,0,W,void 0===xa?null:xa)}FNb(ma,Ab,ec,na,pb,R,ua,xb,W,xa){return new db(ma,R,Ab,null,na,ec,pb,R,ua,xb,!1,void 0===W?null:W,void 0===xa?null:xa)}Amf(ma,Ab){return new Gb(ma,void 0===Ab?"":Ab)}k5h(ma,Ab,ec,na){return new cc.RibbonToggleButton(ma,0,Ab,null,8,null,"None",0,0,null,!1,0,ec,na)}cYa(ma,Ab,ec,na,pb,R,ua,xb,
W){xb=void 0===xb?null:xb;W=void 0===W?!1:W;let xa=Fb.a.tj(Vc.Sgb,ma);if(xa)return xa;xa=new Qb.RibbonButtonObject(ma,0,ec,null,3,null,"None",0,0,R,ua,0);xa.W2(Ab);xa.label=Ab;xa.cqe(W?null:Ab);xa.D8b(pb,na,xb);return Vc.Sgb[ma]=xa}cje(ma){this.TVd(ma)&&delete Vc.Sgb[ma]}TVd(ma){return ma in Vc.Sgb}Dz(ma,Ab,ec,na){ma=new $b(ma,Ab,0,na,3,null,"None",0);ma.W2(ec);ma.label=ec;return ma}aaa(ma,Ab,ec,na,pb,R,ua){ma=new $b(ma,Ab,0,na,pb,ua?null:R,"Image16by16",0,ua);ma.W2(ec);ma.label=ec;return ma}lNb(ma,
Ab,ec,na,pb,R){return new ac(this.NB,ma,null,null,void 0===Ab?null:Ab,null,void 0===ec?null:ec,void 0===na?null:na,void 0===pb?null:pb,void 0===R?null:R)}GM(ma,Ab,ec,na){ec=void 0===ec?null:ec;na=void 0===na?null:na;return Object(za.a)(new Zc,{id:ma,width:Ab,nwa:ec,title:na})}Qp(ma,Ab,ec,na,pb,R,ua){return this.k5(ma,Ab,ec,na,4,"Image32by32",pb,R,null,!1,ua)}Nr(ma,Ab,ec,na,pb,R,ua){return this.k5(ma,Ab,ec,null,1,"None",na,0,void 0===R?null:R,void 0===pb?!1:pb,0,null,void 0===ua?null:ua)}llf(ma,Ab,
ec,na,pb,R){return this.k5(ma,Ab,ec,na,4,"Image16by16",pb,0,R.toString(),!1,0)}Kfa(ma,Ab,ec,na){return this.llf(ma,"OutlineDashStylePresent,"+ec,Ab,Ea.a.Zxc,na,ec)}PHa(ma,Ab,ec,na){return this.llf(ma,"OutlineWidthPresent,"+ec,Ab,Ea.a.byc,na,ec)}};wd.Sgb={};wd=Vc=Object(f.__decorate)([Object(Q.d)(O.xf),Object(f.__param)(0,Object(O.Qe)()),Object(f.__param)(1,Object(O.eb)())],wd);Object(w.a)(wd,"RibbonControlsManager",null,[854]);var wc=a(212);let Ya=class{constructor(ma){this.Cji=ma.tLk}Ri(){return!1}executeCommand(ma,
Ab){ma=Ab.command;Ab=null;switch(ma){case 1243860697:this.Cji.j2k();break;default:Ab=wc.a(ma)}return Ab||G.Task.Ua(!0)}Ei(ma,Ab){return 1243860697===Ab.command}dj(){return!1}};Ya=Object(f.__decorate)([Object(Q.d)(O.Uf),Object(f.__param)(0,Object(O.bg)()),Object(f.__param)(1,Object(O.jf)())],Ya);Object(w.a)(Ya,"SheetDropdownMenuCommandHandler",null,[36]);var ob=a(432),Cb=a(88),Wb=a(78),ad=a(330),$c=a(17),Ld=a(409),jd=a(95),Td=a(52),re=a(308),Nd=a(196),uc=a(159),pc=a(59),Hd=a(200);class wb{constructor(){this.drf=
new Fb.a(!0);this.rad=0}get dDd(){return this.rad}get navigationButtonsDisabled(){return!!(this.dDd&1)}get operationButtonsDisabled(){return!!(this.dDd&2)}FJh(ma,Ab){this.drf.add(ma,Ab);this.p3()}p3(){this.rad=0;Fb.a.forEach(this.drf.GB,ma=>{this.rad=this.dDd|ma.value})}}Object(w.a)(wb,"SheetTabBarDisabledStateManager",null,[]);var Xb=a(266),Kb=a(30),Zb=a(995),Oc=a(306),Cd=a(103),Wd=a(284),ee=a(54),he=a(332),pe=a(16),Se=a(70),Ta=a(245),Qa=a(120),Ob=a(177),Jb=a(435),Jc=a(427),zb=a(43),tb=a(291),zc=
a(98);class dd extends Xb.a{constructor(ma,Ab,ec){ec=void 0===ec?!1:ec;super(ma);this.o4b=this.QWa=null;this.$=Ab;this.yRb=this.O9=ec}get disabled(){return this.O9}dispose(){this.o4b=this.QWa=this.$=null;super.dispose()}k3(ma){this.O9=ma;this.domElement.setAttribute(jb.a.nWa,ma.toString());pe.DOMElementExtensions.toggleCssClass(this.domElement,Zb.a.YHa,ma)}J2c(ma){this.yRb=ma}HRa(ma,Ab){return this.disabled?!1:this.yRb&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")?
(zb.a(this.$).xJ(ma,Ab),!1):!0}}Object(w.a)(dd,"SheetBarButton",Xb.a,[]);var od=a(959),gb=a(165),gc=a(149),Dc=a(389);class hd extends dd{constructor(ma,Ab,ec,na){na=void 0===na?!1:na;super(document.createElement("a"),Ab,na);this.rj=pb=>{var R;if(!this.HRa(gc.a.sheetTabBar,gb.a.FLk))return!0;null===(R=Q.a.lh(O.Ug))||void 0===R?void 0:R.Oxa(od.a.insertSheet);this.$.oi(-1935155518,pb.Gh,30,null);return!0};this.Jn=()=>{this.k3(!0)};this.im=()=>{Uc.f(this.$).cellTextEditBox.isEditing||this.k3(!1)};this.QWa=
ec.jh(this.domElement,Na.a.instance.ia(509),0,hd.RWa,Na.a.instance.ia(510),Yc.a.vyd,na);ma.appendChild(this.domElement);this.qj.Ga("contextmenu",pb=>{Se.g(pb)});tb.a.instance.xa($c.a.click,this.domElement,this.rj);this.q3a=uc.a.instance.E2(this.domElement,this.rj,zc.a.Au,zc.a.oDa);Uc.f(this.$).cellTextEditBox.Mv(this.Jn);Uc.f(this.$).cellTextEditBox.zX(this.im)}dispose(){tb.a.instance.Oa($c.a.click,this.domElement,this.rj);uc.a.instance.n3(this.domElement,this.q3a);Uc.f(this.$)&&Uc.f(this.$).cellTextEditBox&&
(Uc.f(this.$).cellTextEditBox.Cv(this.Jn),Uc.f(this.$).cellTextEditBox.J2(this.im));super.dispose()}k3(ma){const Ab=hd.VTg(this.$);super.k3(ma||Ab)}static VTg(ma){return Dc.a.Ise(ma)}}hd.RWa=Ea.a.XFd;Object(w.a)(hd,"InsertSheetButton",dd,[]);class xd extends dd{constructor(ma,Ab,ec){super(document.createElement("a"),Ab);this.rj=na=>{if(!this.HRa(gc.a.sheetTabBar,gb.a.GLk))return!0;this.$.oi(-684145703,na.Gh,0,null);return!0};this.uog=na=>{Fc.HelperMethods.Z1k(this.Mcf,xd.RWa,xd.RWa+jb.a.kUf,("mouseover"===
na.type||"focus"===na.type)&&!Uc.f(this.$).inRangePicker)};this.$=Ab;this.Mcf=ec.jh(this.domElement,Na.a.instance.ia(511),0,xd.RWa,Na.a.instance.ia(512),Yc.a.vyd);ma.appendChild(this.domElement);this.qj.Ga("contextmenu",na=>{Se.g(na)});this.qj.Ga("mouseover",this.uog);this.qj.Ga("mouseout",this.uog);tb.a.instance.xa($c.a.click,this.domElement,this.rj);this.q3a=uc.a.instance.E2(this.domElement,this.rj,zc.a.Au,zc.a.oDa)}dispose(){tb.a.instance.Oa($c.a.click,this.domElement,this.rj);uc.a.instance.n3(this.domElement,
this.q3a);this.Mcf=null;super.dispose()}}xd.RWa=Ea.a.XFd;Object(w.a)(xd,"InsertTemplateButton",dd,[]);class fd{constructor(ma,Ab){this.sheetName=null;this.newSheetIndex=0;this.sheetName=ma;this.newSheetIndex=Ab}getSheetName(){return this.sheetName}}Object(w.a)(fd,"MacroRecorderSheetReorderedPayload",null,[149]);class kd extends Xb.a{constructor(ma,Ab){super(document.createElement("div"));this.o2=()=>{r.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.DHg(!1,"OnSheetsChanged")};
this.xSj=()=>{this.Kp()};this.wSj=()=>{this.xo()};this.$=ma;this.l_k=Ab;this.W5=!1;this.Qac=0}dispose(){this.xo();super.dispose()}j2k(){this.DHg(!0,"TogglerSheetDropdownMenu")}DHg(ma,Ab){r.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${Ab}, toggle: ${ma}, toggleStateId: ${this.Qac}`);ma&&(this.Qac+=1);const ec=this.$.Eh.Oi("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${Ab}, toggle: ${ma}, toggleStateId: ${this.Qac}, sheetCount: ${this.$.sa.count}`);
ma=this.dai();appChrome.renderSheetDropdownMenu(this.domElement,this.l_k,ma,this.Qac,this.xSj,this.wSj,()=>{ec.stop()},Jb.a(this.$))}dai(){const ma=this.$.sa,Ab=[];for(let na=0;na<ma.count;na++){var ec=Object(Mb.a)(Qa.a,ma.getItem(na));0===ec.FJ&&(ec=this.cai(ec),Ab.push(ec))}return Ab}cai(ma){const Ab={};Ab.key=ma.name;Ab.text=ma.name;Ab.onClick=this.eai(ma);ma.active&&(Ab.className=Jb.a(this.$)?"ewa-active-sheet-menu-item-present-mode":"ewa-active-sheet-menu-item");return Ab}eai(ma){return()=>{const Ab=
new ba.a(-1876836819,0,this.$.ji,30,null);this.$.Ia.qh(Ab,{[jb.a.hse]:ma.name})}}Kp(){if(!this.W5){const ma=this.$.sa;ma.vn(this.o2);ma.Epd(this.o2);ma.z4(this.o2);ma.rua(this.o2);ma.sua(this.o2);ma.K5e(this.o2);ma.ffb(this.o2);this.W5=!0}}xo(){if(this.W5){const ma=this.$.sa;ma.Nn(this.o2);ma.Ije(this.o2);ma.Mca(this.o2);ma.iBa(this.o2);ma.jBa(this.o2);ma.BGg(this.o2);ma.c6b(this.o2);this.W5=!1}}}Object(w.a)(kd,"SheetDropdownMenu",Xb.a,[897,2]);class Yb extends dd{constructor(ma,Ab,ec){super(document.createElement("a"),
ma,!F.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled"));this.Lm=()=>{this.k3(!1);F.EwaSettings.ul()||this.$.fa.av(this.Lm)};this.rj=na=>{if(!this.HRa(gc.a.sheetTabBar,gb.a.JLk))return!0;this.l2g(na.Gh);return!0};this.onKeyDown=na=>13===na.La.keyCode||32===na.La.keyCode?(this.l2g(na.Gh),!0):!1;this.QWa=Ab.jh(this.domElement,Na.a.instance.ia(513),0,Ea.a.Eqi,Na.a.instance.ia(513),Yc.a.I2i,this.disabled);this.domElement.classList.add("ewa-stb-dropdown-menu-button");
ec.appendChild(this.domElement);F.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")||this.Oli();this.xjk()}dispose(){this.B7k();super.dispose()}k3(ma){super.k3(ma||!this.$.fa.Gya)}Oli(){const ma=this.$.fa;ma.um?this.k3(!1):F.EwaSettings.ul()?this.$.fa.lr(this.Lm):ma.mr(this.Lm)}l2g(ma){this.disabled||(r.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${L.a[ma]}`),this.$.Ia.qh(new ba.a(1243860697,ma,this.$.ji,30,null)))}xjk(){tb.a.instance.xa($c.a.click,
this.domElement,this.rj);uc.a.instance.xa($c.a.Wi,this.domElement,this.onKeyDown)}B7k(){tb.a.instance.Oa($c.a.click,this.domElement,this.rj);uc.a.instance.Oa($c.a.Wi,this.domElement,this.onKeyDown)}}Object(w.a)(Yb,"SheetDropdownMenuAnchor",dd,[]);var Cc=a(184),td=a(151),Ad=a(66),oe=a(203);class qe{constructor(ma){this.sheet=ma;this.altText=Na.a.instance.ia(1994)}yV(){return this.sheet.active}Sya(){return this.sheet.isLockPausedInSession}vCa(){return this.sheet.Bn?Yc.a.Kzg:Yc.a.n7k}gxe(){return 16}tHa(){return null}uHa(){return"ewa-stb-locked-sheet-svg-16px"}Rye(){return null}UA(){return null}Ord(){return!0}}
Object(w.a)(qe,"LockPausedSheetIconDataSource",null,[903]);class Be{constructor(ma){this.sheet=ma;this.altText=Na.a.instance.ia(1993)}yV(){return this.sheet.active}Sya(){return this.sheet.Bn}vCa(){return Yc.a.Kzg}gxe(){return 16}tHa(){return null}uHa(){return"ewa-stb-locked-sheet-svg-16px"}Rye(){return null}UA(){return null}Ord(){return!0}}Object(w.a)(Be,"LockedSheetIconDataSource",null,[903]);class Ee{constructor(ma,Ab,ec){this.sheet=ma;this.altText=Na.a.instance.ia(1908);this.y2k=Ab;this.RPk=ec}yV(){return this.sheet.active}Sya(){return this.sheet.Zj.px}tHa(){return this.yV()?
"ewa-stb-nsv-active-svg":"ewa-stb-nsv-inactive-svg"}vCa(){return!this.yV()&&this.RPk()?Yc.a.ZLk:Yc.a.YLk}gxe(){return 14}uHa(){return"ewa_nsv_margin"}Rye(){return this.sheet.Zj.gIb}UA(){return this.y2k}Ord(){return!1}}Object(w.a)(Ee,"NamedSeetViewSheetIconDataSource",null,[903]);var Ve=a(160);class Oe{constructor(ma,Ab){this.egd=this.bea=this.NQa=this.wA=null;this.M2f=!1;this.tld=this.vCa=this.uHa=this.tHa=null;this.sZ=()=>{this.dataSource.yV()&&A.TaskExtensions.$e(this.U8f,()=>{dialogControls.renderToolTip(this.dataSource.UA(),
"SheetIconTooltip",this.dataSource.Rye(),this.d3,10,!1,!1,1)},this.$.ya,3)};this.rZ=()=>{this.dataSource.yV()&&this.clearToolTip()};this.$=ma;this.dataSource=Ab}get qj(){return this.bea||(this.bea=Ve.a.instance.Wk(this.d3))}get U8f(){if(this.egd)return this.egd;const ma=new l.a;this.$.q6(Ab=>{A.TaskExtensions.$e(Ab.C8f(),()=>{ma.setResult(!0)},this.$.ya,3)});return this.egd=ma.task}get d3(){return this.tld}i7g(){if(this.d3&&(this.wA||this.NQa)){var ma=this.dataSource.vCa();this.vCa!==ma&&(this.NQa&&
this.NQa.parentNode.removeChild(this.NQa),this.KWf(),this.vCa=ma);ma=this.dataSource.tHa();this.tHa!==ma&&(this.Ork(this.NQa,this.tHa,ma),this.tHa=ma);ma=this.dataSource.uHa();this.uHa!==ma&&(this.Nrk(this.d3,this.uHa,ma),this.uHa=ma);this.dataSource.UA()&&!this.dataSource.yV()&&this.clearToolTip()}}yRk(ma,Ab,ec){this.Kej(ma,Ab,ec);pe.DOMElementExtensions.setVisible(this.d3,this.dataSource.Sya())}clearToolTip(){A.TaskExtensions.$e(this.U8f,()=>{dialogControls.clearToolTip(this.dataSource.UA())},this.$.ya,
3)}Kej(ma,Ab,ec){this.d3&&this.M2f!==ma&&(this.d3.parentNode.removeChild(this.d3),this.uHa=this.tHa=this.vCa=this.tld=null,this.dataSource.UA()&&(this.qj.detach("mouseover",!0),this.qj.detach("mouseout",!0)));this.d3||(this.tld=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.d3,Zb.a.puc),Sys.UI.DomElement.addCssClass(this.d3,Ea.a.d5),ma===this.dataSource.Ord()?Ab.appendChild(this.d3):Ab.insertBefore(this.d3,ec),this.KWf(),this.dataSource.UA()&&(this.qj.Ga("mouseover",this.sZ,!0),
this.qj.Ga("mouseout",this.rZ,!0)),this.M2f=ma)}Ork(ma,Ab,ec){ma&&(Sys.UI.DomElement.removeCssClass(ma,Ab),Sys.UI.DomElement.addCssClass(ma,ec))}Nrk(ma,Ab,ec){Ab&&Sys.UI.DomElement.removeCssClass(ma,Ab);ec&&Sys.UI.DomElement.addCssClass(ma,ec)}dispose(){jd.a.gh(this.bea)}KWf(){const ma=this.$.qa.zh(388);ma?(this.NQa=ma.d0a(this.dataSource.vCa(),this.dataSource.gxe()))?this.d3.appendChild(this.NQa):r.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.vCa()} was not found.`):
r.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to receive SvgIconProvider service.")}}Object(w.a)(Oe,"SheetIcon",null,[2]);var Ye=a(106);class nf extends Ye.a{constructor(ma,Ab){super(ma.domElement);this.onKeyDown=ec=>{121===ec.keyCode&&ec.shiftKey&&!this.zu.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.zu.anchor),Se.g(ec))};this.KNa=ec=>{if(!this.$.isEditMode||this.zu.disabled)return!0;this.rename(!1,ec.Gh);return!0};this.Hp=ec=>{if(this.zu.disabled)return!0;
F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncSheetOpsContextMenu",!1)&&Ob.b(this.$).iz(ec.La.rawEvent,"context_menu_sheet_ops",null,["context-menu"]);return this.showContextMenu(ec.clientPoint,ec.Gh,ec.hi)};this.xZe=ma;this.$=Ab;tb.a.instance.xa($c.a.Ut,ma.domElement,this.KNa);Ld.a.instance.xa(ma.domElement,this.Hp);this.qj.Ga("keydown",this.onKeyDown)}get zu(){return this.xZe}dispose(){this.zu&&(tb.a.instance.Oa($c.a.Ut,this.zu.domElement,this.KNa),Ld.a.instance.Oa(this.zu.domElement,
this.Hp),this.xZe=null);this.$=null;super.dispose()}showContextMenu(ma,Ab,ec){if(!this.zu.HRa(gc.a.sheetTabBar,gb.a.KLk))return!0;this.zu.activate("showContextMenu",Ab,Nb.a.t4f());Ab=new ba.a(-1075099431,Ab,this.$.ji,30,null);let na;return!Hd.a(na=this.$.Ia.qh(Ab,{[jb.a.ise]:ma,[nf.uLk]:this.zu.sheet,[jb.a.jse]:ec}))&&(6!==na.status||na.result)}rename(ma,Ab){this.$.oi(817296323,Ab,ma?19:0,null)}}nf.uLk="Sheet";Object(w.a)(nf,"SheetOpsSheetClickHelper",Ye.a,[]);var of=a(47),Cf=a(123);class Ff extends dd{constructor(ma,
Ab,ec,na,pb){super(document.createElement("li"),ma);this.rLk=100;this.sLk=500;this.kof=Fc.HelperMethods.mse;this.W5=this.fse=!1;this.color=this.fad=this.D$c=this.R0b=this.hmd=null;this.xJc=this.j1f=!1;this.Luc="#BEBBB8";this.u8c=null;this.onKeyDown=R=>13===R.La.keyCode&&this.HRa(gc.a.sheetTabBar,gb.a.QLk)?(this.activateSheet(1),!0):!1;this.ZE=R=>32===R.La.charCode&&this.HRa(gc.a.sheetTabBar,gb.a.RLk)?(this.activateSheet(1),!0):!1;this.sZ=()=>{this.disabled||this.yRb||this.EJ.L1||this.XBa(!0,void 0,
"OnMouseOver")};this.rZ=()=>{this.disabled||this.yRb||this.XBa(!1,void 0,"OnMouseOut")};this.q2b=()=>{if(!this.EJ.L1){this.JWk();const R=this.sheet.sheetProcessedData;this.disabled||this.yRb||Object(Cf.d)(R)||"PartialResult"===(null===R||void 0===R?void 0:R.reason)||Uc.f(this.$).pPa(this.sheet.sheetName,"sheetTabButton.onMouseEnter",!0)}return!1};this.kia=()=>{this.Fuf(!1);return!1};this.rj=R=>{if(!this.HRa(gc.a.sheetTabBar,gb.a.OLk))return!0;const ua=Uc.f(this.$);this.sheet.active||3!==R.Gh||!Nb.a.i3a()&&
!this.eZb||ua.isEditing||ua.kq||ua.OOb();this.activateSheet(R.Gh);return 3!==R.Gh};this.onPointerDown=R=>{if(!this.HRa(gc.a.sheetTabBar,gb.a.PLk))return!0;this.Fuf(!0);Uc.f(this.$).inRangePicker&&r.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var ua=3===R.Gh;if(2===R.Gh||ua&&this.$La)this.XBa(!0,!ua,"OnPointerDown"),ua=G.Task.delay(ua?this.sLk:this.rLk).nB(()=>!0),this.uYb&&(this.xJc=!0,this.EJ.jWc=
A.TaskExtensions.$e(ua,()=>{this.xJc&&this.EJ.M0j(this,R)},this.ya,11));return!1};this.Ho=R=>{if(this.disabled||!this.uYb&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.xJc=!1;this.XBa(2===R.Gh,void 0,"OnPointerUp");this.EJ.jWc&&(A.TaskExtensions.$e(this.EJ.jWc,()=>{this.EJ.L0j()},this.ya,11),this.EJ.jWc=null);return!1};this.wZ=()=>{this.xJc=!1;this.fse||this.XBa(!1,void 0,"OnTouchMove");return!1};this.ehf=new nf(this,ma);this.eZb=Nb.a.eZb();
this.$=ma;this.Fkc=na;this.EJ=pb;this.uYb=pb.E7e();this.qai();this.e5h();this.qTd=ma.Eh.wm("UserAction",this.name);this.cYd=!1;pe.DOMElementExtensions.wL(this.domElement,jb.a.wz,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.GU);this.$Ba=new Z.a;ma=new Be(this.sheet);this.$Ba.add(new Oe(this.$,ma));this.$.fa.j9b&&(ma=new qe(this.sheet),this.$Ba.add(new Oe(this.$,ma)));ma=new Ee(this.sheet,this.EJ.ZZc,()=>this.color?Ff.Jte(this.color):!1);this.R0b=new Oe(this.$,ma);
this.$Ba.add(this.R0b);this.$La=this.EJ.$La;this.uAb();this.Tkk();this.Rbf=new he.a(this.domElement,1);Ab.insertBefore(this.domElement,ec);Jb.a(this.$)&&this.g8g(!0);r.ULS.sendTraceTag(507643663,0,50,`SheetTabButton.ctor: index=${na.index}, navigationButtonsDisabled=${pb.navigationButtonsDisabled}, operationButtonsDisabled=${pb.operationButtonsDisabled}`)}get tCd(){return this.fad||(this.fad=Ma.a.Pu("#F5F5F5"))}get name(){return this.HQ.innerText}set name(ma){this.HQ&&(this.HQ.innerText=ma,this.V3c(),
this.h8g())}get sheet(){return this.Fkc}get anchor(){return this.u8c}get HQ(){return this.hmd}get GU(){return this.D$c}get tabIndex(){return this.anchor.tabIndex}set tabIndex(ma){this.anchor.tabIndex=ma}bIf(){return pe.DOMElementExtensions.ap(this.anchor)?this.anchor:null}dispose(){if(this.W5){re.a.instance.Oa($c.a.Bj,this.domElement,this.onPointerDown);uc.a.instance.Oa($c.a.Wi,this.domElement,this.onKeyDown);uc.a.instance.Oa($c.a.rx,this.domElement,this.ZE);tb.a.instance.Oa($c.a.click,this.domElement,
this.rj);re.a.instance.Oa($c.a.X7,this.domElement,this.q2b);re.a.instance.Oa($c.a.jL,this.domElement,this.kia);if(this.uYb||F.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))re.a.instance.Oa($c.a.jp,this.domElement,this.Ho),this.$La&&(Nd.a.instance.Oa($c.a.pl,this.domElement,this.Ho),Nd.a.instance.Oa($c.a.wo,this.domElement,this.wZ));this.W5=!1;this.Luc="#BEBBB8"}jd.a.gj([this.ehf,this.Rbf]);this.hmd=this.D$c=this.u8c=this.EJ=this.Rbf=this.ehf=null;if(this.$Ba){for(const ma of this.$Ba)ma.dispose();
this.$Ba=null}this.color=this.Fkc=null;super.dispose()}k3(ma){ma&&this.XBa(!1,!1);super.k3(ma)}sWg(ma){Ad.a.Zl.PY&&(this.nrf(),void Q.a.resolve(O.ce,{va:1}).then(Ab=>{Cc.a.IK().then(ec=>{Ab.oHk(ec);Ab.show(ma);return null},ec=>{r.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${ec}`);return null})}))}JAh(){if(this.sheet.active&&this.$.ex){var ma=this.$.ex,Ab=Uc.f(this.$);if(this.sheet.Zj.px){if(!this.R0b){const ec=new Ee(this.sheet,
this.EJ.ZZc,()=>this.color?Ff.Jte(this.color):!1);this.R0b=new Oe(this.$,ec);this.$Ba.add(this.R0b)}Ab.fAb(1);ma.classList.add(Ea.a.Dyf);ma=Ff.pKf(jb.a.nfg);Ab=Ff.pKf(jb.a.J7d);"true"===ma&&"true"===Ab?this.$.fa.vte&&this.$.fa.E9b&&(this.sheet.Zj.oN?(ma=1,td.a.HG(jb.a.J7d,"false",td.a.$ba),this.$.fa.E9b=!1):ma=0,td.a.HG(jb.a.nfg,"false",td.a.$ba),this.$.fa.vte=!1,this.sWg(ma)):this.sheet.Zj.oN&&"true"===Ab&&this.$.fa.E9b&&(td.a.HG(jb.a.J7d,"false",td.a.$ba),this.$.fa.E9b=!1,this.sWg(2))}else this.nrf(),
Ab.fAb(0),ma.classList.remove(Ea.a.Dyf)}}nrf(){const ma=Q.a.lh(O.ce);ma&&ma.dismiss()}uAb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.kpb()?"tab-active":"tab-inactive";F.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.HQ.parentNode.classList.add("leave-size-fixed-on-tab-hover"):this.HQ.parentNode.classList.add("leave-size-fixed-on-tab-hover-old");this.h8g();this.zRk();this.o8g();this.V3c();this.JAh()}K0j(){this.fse=!0;this.XBa(!0,!0,
"OnSheetReorderStarted")}J0j(){this.fse=!1;this.XBa(!1,void 0,"OnSheetReorderEnded")}activate(ma,Ab,ec){Ab=void 0===Ab?0:Ab;ec=void 0===ec?!1:ec;this.Hrc()||(this.sheet.activate({scenario:ma}),ec&&Uc.f(this.$).focus(),ma={["InputMethod"]:L.a[Ab],["AppMode"]:this.$.ji,["Location"]:"canvas"},La.b(this.$).sj(E.a.oLk,ma))}g8g(ma){this.Luc=ma?"#797775":"#BEBBB8";this.kof=ma?-.5:Fc.HelperMethods.mse;this.fad=ma?Ma.a.Pu("#3B3A39"):Ma.a.Pu("#F5F5F5");this.o8g()}NDk(ma){this.uYb=ma}U0h(ma){var Ab;const ec=
[];this.name!==ma.SheetName&&ec.push(`SheetName. CachedSheetName null or empty: ${null==ma.SheetName||""===ma.SheetName}`);if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:8625911_addStbSheetColorSsr")){const na=null!==(Ab=ma.TabColor)&&void 0!==Ab?Ab:Ma.a.JJ(this.tCd);Ma.a.JJ(this.color).toLowerCase()!==na.toLowerCase()&&ec.push("TabColor")}else this.color.ICa()!==this.tCd.ICa()&&ec.push("TabColor");F.EwaSettings.isChangeGateEnabled("OfficeVSO:8654274_addLockedSheetSsr")?this.sheet.ZK(128)!==Fc.HelperMethods.sS(ma.SheetOptions,
128)&&ec.push("Locked"):this.sheet.Bn&&ec.push("Locked");return ec}lWh(ma){ma.Yhb();this.sheet.activate({scenario:"switchSheet"})}Fxh(ma){ma=new ba.a(-1876836819,ma,this.$.ji,30,null);return this.$.Ia.qh(ma,{[jb.a.hse]:this.sheet.name})}h8g(){this.HQ.parentNode.setAttribute("sheet-title",this.HQ.innerText)}V3c(){const ma=this.TFi();this.anchor.setAttribute(jb.a.wD,ma);this.anchor.setAttribute(jb.a.Ula,this.sheet.active.toString())}TFi(){const ma=this.sheet.Zj.px,Ab=this.sheet.Zj.gIb,ec=this.sheet.Bn,
na=this.sheet.isLockPausedInSession;return ma&&ec?String.format(Na.a.instance.sh(20),this.name,Ab):ma&&na?String.format(Na.a.instance.sh(22),this.name,Ab):ma?String.format(Na.a.instance.sh(19),this.name,Ab):ec?String.format(Na.a.instance.sh(18),this.name):na?String.format(Na.a.instance.sh(21),this.name):this.name}activateSheet(ma){ma=void 0===ma?0:ma;var Ab;if(Nb.a.t4f()){if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.Hrc())return G.Task.Ua(!1);oe.a.current.TZ=
"ActivateSheet";null===(Ab=Q.a.lh(O.Ug))||void 0===Ab?void 0:Ab.Oxa(od.a.switchSheet);this.sheet.activate({scenario:"switchSheet"});return G.Task.Ua(!0)}return this.Fxh(ma)}o8g(){const ma=this.sheet.tabColor;this.color=ma?Ma.a.Pu(ma):this.tCd;this.j1f=Ff.Jte(this.color);this.XBa(!1,void 0,"UpdateTabColor")}XBa(ma,Ab,ec){Ab=void 0===Ab?!1:Ab;ec=void 0===ec?null:ec;if(this.sheet){ec=this.sheet.active;var na=this.kpb(),pb=!!this.sheet.tabColor,R=Ma.a.JJ(ec||na?ia.a.SRa:this.color);this.GU.style.background=
"";ec||na?(pb&&(F.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.bya?this.eJk():this.dJk()),this.GU.style.height=Fc.HelperMethods.rTg.toString()+"px"):(this.GU.style.filter="",this.GU.style.backgroundColor=R,this.GU.style.height=Fc.HelperMethods.sTg.toString()+"px");this.HQ.className=ec?"tab-active-text":na?"dark":this.j1f?"light":"dark";for(const ua of this.$Ba)ua.i7g();ma&&!pb&&(this.GU.style.backgroundColor="#E1DFDD");pe.DOMElementExtensions.toggleCssClass(this.domElement,
"tab-hover",ma);Ab?(pb||(this.GU.style.backgroundColor=this.Luc),this.domElement.style.backgroundColor=this.Luc):(pb||(this.GU.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.HQ.style.fontWeight=ec||na?"600":""}else r.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, which means its not rendered. caller: ${ec}`)}dJk(){const ma=this.GU.style,Ab=Ma.a.JJ(Ma.a.sff(this.color,this.kof));ma.background=Ab}eJk(){this.GU.style.background=
"transparent"}e5h(){this.u8c=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className="tab-anchor-text";pe.DOMElementExtensions.wL(this.anchor,jb.a.ZJb,null,null);this.tabIndex=-1}qai(){this.D$c=document.createElement("span");this.GU.className="tab-content-container";this.hmd=document.createElement("span");this.HQ.className="tab-text";this.HQ.dir=this.sheet.rtlName?"rtl":"ltr";this.GU.appendChild(this.HQ)}zRk(){const ma=this.$.uX;for(const Ab of this.$Ba)Ab.yRk(ma,this.GU,
this.HQ)}kpb(){return Uc.f(this.$).kpb(this.sheet)}JWk(){this.qTd.start();this.cYd=!0}Fuf(ma){this.cYd&&(this.qTd.stop(),r.ULS.sendTraceTag(537153686,0,50,of.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.qTd.Ci,["Has been clicked"]:ma})),this.cYd=!1)}Tkk(){re.a.instance.xa($c.a.Bj,this.domElement,this.onPointerDown);uc.a.instance.xa($c.a.Wi,this.domElement,this.onKeyDown);uc.a.instance.xa($c.a.rx,this.domElement,this.ZE);this.qj.Ga("mouseover",this.sZ);
this.qj.Ga("mouseout",this.rZ);re.a.instance.xa($c.a.X7,this.domElement,this.q2b);re.a.instance.xa($c.a.jL,this.domElement,this.kia);if(this.uYb||F.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))re.a.instance.xa($c.a.jp,this.domElement,this.Ho),this.$La&&(Nd.a.instance.xa($c.a.pl,this.domElement,this.Ho),Nd.a.instance.xa($c.a.wo,this.domElement,this.wZ));tb.a.instance.xa($c.a.click,this.domElement,this.rj);this.W5=!0}Hrc(){const ma=Q.a.lh(O.Rb);return ma&&ma.Hya()?
(ma.FXc(),this.lWh(ma),!0):!1}static pKf(ma){let Ab=td.a.get(ma);Ab||(td.a.HG(ma,"true",td.a.$ba),Ab=td.a.get(ma));return Ab}static Jte(ma){return 128>=(222*ma.r+707*ma.g+71*ma.b)/1E3}}Object(w.a)(Ff,"SheetTabButton",dd,[]);class Wf extends dd{constructor(ma,Ab,ec){super(document.createElement("a"),Ab);this.RWa=Ea.a.XFd;ec.jh(this.domElement,Na.a.instance.ia(713),0,this.RWa,Na.a.instance.ia(713),Yc.a.vyd,!0);ma.appendChild(this.domElement);this.qj.Ga("contextmenu",na=>{Se.g(na)})}}Object(w.a)(Wf,
"WorkbookProtectionButton",dd,[]);var Mf=a(44),ng=a(71),Rf=a(661);class $f extends Xb.a{constructor(ma,Ab,ec,na){na=void 0===na?null:na;super(Ab);this.lCa=ec;this.sheetTabActivatePreviousHidden=Na.a.instance.ia(722);this.sheetTabActivateNextHidden=Na.a.instance.ia(724);this.svgIconProvider=null;this.Vo=[];this.dZ=Array(6);this.S7d=Array(6);this.nQa=this.pse=this.ose=this.xt=null;this.sIg=!1;this.L8a=this.RVb=this.y1=null;this.isRtl=!1;this.bpa=this.oP=0;this.Hwc=this.iWc=!1;this.GBa=0;this.oGc=!0;
this.KSc=0;this.$X=this.dga=this.ena=this.Qwc=null;this.LDc=this.$M=0;this.cac=null;this.GZb=-1;this.Sfa=null;this.PRc=0;this.T0c=-1;this.VAa=0;this.wIa=new wb;this.Jed=!1;this.jWc=this.pQa=this.oQa=this.vZe=this.eca=null;this.WQe=!1;this.uZe=null;this.BVf=()=>{this.AVf("onWorkbookOpened");this.$.$r(this.BVf)};this.WH=(pb,R)=>{this.Lrg(R.item)};this.n2=(pb,R)=>{pb=this.$.sa.la.index;for(let ua=0,xb=this.Vo.length;ua<xb;ua++){const W=this.Saa(ua);if(W.name===R.oldName){W.name=R.newName;this.Hca();
ua===pb&&this.Mqa(6);break}}};this.Org=(pb,R)=>{(pb=this.Mkb(R.item))&&pb.uAb()};this.Prg=(pb,R)=>{R.visible?(this.G8a(!1),this.Mrg(R.item)):this.Lrg(R.item)};this.$4a=pb=>{this.L1?(this.Sfa=pb,this.Abc()):(this.Sfa&&(this.KSc+=this.Sfa.clientPoint.x-pb.clientPoint.x),this.Sfa=pb,Math.abs(this.KSc)>=this.uji&&this.Abc());return!0};this.wZ=pb=>{pb.La.preventDefault();return!1};this.uNg=pb=>{this.rNg(pb,!0)};this.tNg=pb=>{this.rNg(pb,!1)};this.a5a=pb=>{if(this.L1){this.Hwc=this.Dlj(pb);let R;pb=(R=
this.Saa(this.$M+1))?R.sheet:null;this.reorderSheets(pb,this.$M+1===this.k9b,!0)}this.R5();return!0};this.Bq=(pb,R)=>{R.OB&&this.QBe(R.OB);this.eZc(!1);this.Hca();R.la&&(this.QBe(R.la),this.Mqa(6),this.fa.cOa())};this.Qhg=(pb,R)=>{this.U4c(R.item)};this.Rhg=(pb,R)=>{this.U4c(R.item)};this.Shg=(pb,R)=>{this.U4c(R.item)};this.j5a=(pb,R)=>{this.U4c(R.item)};this.HNa=()=>{this.mxd()};this.Dj=()=>{this.isVisible=!this.fa.isNamedObjectViewMode;this.mxd();this.QAd();F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",
!1)||!ng.d(this.$)&&!ng.e(this.$)||this.rIg();this.yAd();this.Hca();this.G8a(!0);this.Mqa(6);F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(ng.d(this.$)||ng.e(this.$))&&this.rIg()};this.nq=()=>{this.isVisible&&(this.Hca(),this.Mqa(6))};this.Wl=()=>{Object($a.a)(hd,this.y1)===Cd.l(this.$.wl)&&this.yAd();for(const pb of this.Vo)pb.NDk(!Cd.l(this.$.wl))};this.Nrg=(pb,R)=>{this.Brk(R.item,R.isUserOperation)};this.I2b=(pb,R)=>{this.Mrg(R.item)};this.onKeyDown=
pb=>{switch(pb.keyCode){case 9:var R=this.domElement.querySelectorAll(pe.DOMElementExtensions.cJ);const ua=pe.DOMElementExtensions.KE(R);R=pe.DOMElementExtensions.Paa(R);pe.DOMElementExtensions.x8a(pb,ua,R);break;case 39:case 37:pe.DOMElementExtensions.wQg(pb,this.domElement.querySelectorAll(pe.DOMElementExtensions.cJ),39===pb.keyCode?!this.isRtl:this.isRtl)}r.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${pb.keyCode}`)};this.onScroll=()=>{this.xt.scrollLeft!==this.GBa&&
this.s0k()};this.tZ=pb=>{if(pb.ctrlKey||pb.Hfa)return!1;this.xt.scrollLeft+=Math.floor(30*pb.tDa);if(this.L1){const R=this.tIf("OnMouseWheel");R&&this.ixe(0<pb.tDa,R.x+R.width/2)}return!0};this.Hp=pb=>{if(!Rf.a.Pob)return!1;r.ULS.sendTraceTag(507363731,0,50,"SheetTabBarControl.onContextMenu: Context menu opened from sheet tab bar.");const R=new ba.a(-1075099431,pb.Gh,this.$.ji,30,null);let ua;return!Hd.a(ua=this.$.Ia.qh(R,{[jb.a.ise]:pb.clientPoint,[jb.a.jse]:pb.hi,[jb.a.lTg]:!0}))&&(6!==ua.status||
ua.result)};this.uZ=(pb,R)=>{if(this.wIa)r.ULS.sendTraceTag(507847647,0,50,`SheetTabBarControl.onPartialInteractivityStatusChanged: sender=${!!pb}, activated=${R.sU}, swappedPIType=${R.yra}`),this.gRf("PartialInteractivity",R.sU?3:0);else if(this.R5(!1),this.Eqe(R.sU),F.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")){for(const ua of this.Jpc)ua&&ua.J2c(R.sU);for(const ua of this.Vo)ua&&ua.J2c(R.sU)}else{for(const ua of this.Jpc)ua&&ua.k3(R.sU);for(const ua of this.Vo)ua&&
ua.k3(R.sU)}};this.S1b=(pb,R)=>{pb=0|(R.uod?2:0);pb|=R.uod&&R.vLk?1:0;this.gRf("ComponentRangePicker",pb)};this.$=ma;this.svgIconProvider=na;this.$.sa?this.AVf("ctor"):this.$.nr(this.BVf);ec||r.ULS.sendTraceTag(507536514,0,10,"SheetTabBarControl.ctor: SkeletonManager must always exist.")}AVf(ma){r.ULS.sendTraceTag(507847648,0,50,`SheetTabBarControl.initComponent: caller=${ma}`);this.fa=this.$.fa;this.Xwc=!F.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");
this.zsj=F.EwaSettings.isChangeGateEnabled("OfficeVSO:8749006_EnrichSTBSkeleton");this.$3f=!this.$.RC;this.WQe=!t.a.uV;this.Vnj=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.AKj=this.$.ua.SheetTabNavigateButtonLongKeyPressPeriodMS;this.zKj=this.$.ua.SheetTabNavigateButtonIntervalPeriodMS;this.uji=this.$.ua.SheetTabDragStartPixelThreshold;this.a6a=this.b6a=-1;this.dzd=!1;this.kM=new he.a(this.domElement,3);this.domElement.classList.add("ewa-stb-uir");this.X8h();
this.v6h();this.Y8h();document.getElementById(jb.a.$ga)||this.e$h();this.eZc(!0);this.Dj(null,null);ma=this.$.sa;ma.vn(this.Bq);ma.Epd(this.HNa);ma.z4(this.WH);ma.rua(this.I2b);ma.sua(this.n2);ma.K5e(this.Nrg);ma.ffb(this.Prg);ma.YDh(this.Org);ma.Zpd(this.Qhg);ma.I5e(this.Rhg);ma.$pd(this.Shg);ma.J5e(this.j5a);this.$.nr(this.Dj);this.$.LI(this.nq);Oc.a(this.$).Wq(this);F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)||this.$.qa.Rh(32,this);F.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&
this.$.fa.vz(this.Wl);this.a_c=this.ml.Wk(this.domElement);this.a_c.Ga("keydown",this.onKeyDown);zb.a(this.$).wv()&&this.uZ(null,new Jc.a(!0));zb.a(this.$).Dm.vua(this.uZ);Uc.f(this.$).m5e(this.S1b);this.a_c.Ga("mousedown",Ab=>{Ab.preventDefault()});ad.a.instance.xa($c.a.xN,this.domElement,this.tZ);Ld.a.instance.xa(this.domElement,this.Hp);this.nse=this.ml.Wk(this.xt);this.nse.Ga("scroll",this.onScroll);this.s0k=Ta.b(()=>{this.Hca()},200,this.$.ya,ee.a.DLk,!0);F.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")?
this.lCa.aN(jb.a.m0c):this.$.yP(jb.a.m0c);this.$3f&&(this.uZe=new kd(this.$,this.L8a.domElement))}Fch(){if(!this.zsj)return!1;Mf.a.instance.lI("SheetTabBarPromotion");const ma=this.I0h(this.lCa.UXg);Mf.a.instance.AE("SheetTabBarPromotion");const Ab=0===ma.length;r.ULS.sendTraceTag(507839499,0,15,`SheetTabBar Skeleton Model Comparison ${Ab?"Succeeded":"Failed"}.${Ab?"":` Mismatches: ${ma.join(", ")}.`}`);Ab&&Mf.a.instance.Sm("SheetTabBarTTVRPromoted");return Ab}get ij(){return this.domElement}get ap(){return this.isVisible}get el(){return Wd.a.lse}get L1(){return this.Jed}get k9b(){return this.Vo.length}get ZZc(){return this.vZe}get $La(){return this.WQe}get navigationButtonsDisabled(){return!!this.wIa&&
this.wIa.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.wIa&&this.wIa.operationButtonsDisabled}get LKj(){return this.$.uX?[Ea.a.Rwf,Ea.a.Swf,Ea.a.Twf,Ea.a.Qwf,Ea.a.Uxc,Ea.a.Uxc]:[Ea.a.Qwf,Ea.a.Twf,Ea.a.Swf,Ea.a.Rwf,Ea.a.Uxc,Ea.a.Uxc]}get T7d(){return this.$.uX?[null,Yc.a.Mif,Yc.a.Kif]:[null,Yc.a.Kif,Yc.a.Mif]}get Yxg(){return this.$.uX?[null,Yc.a.Nif,Yc.a.Lif]:[null,Yc.a.Lif,Yc.a.Nif]}get c_b(){if(this.isRtl){if(t.a.kJ)return 0;if(t.a.Cm)return-1*(this.xt.scrollWidth-this.xt.clientWidth);
if(t.a.uV)return this.xt.scrollWidth-this.xt.clientWidth;r.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get i7b(){if(this.isRtl){if(t.a.kJ)return this.xt.scrollWidth-this.xt.clientWidth;if(t.a.Cm||t.a.uV)return 0;r.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.xt.scrollWidth-this.xt.clientWidth}get Jpc(){return this.wIa?[this.y1,this.RVb]:[this.y1,this.RVb,this.L8a]}get l0g(){return this.Vo.concat(this.L8a)}get $ge(){return!this.oP}get ahe(){return this.bpa===
this.Vo.length-1}get tLk(){return this.uZe}jh(ma,Ab,ec,na,pb,R,ua){ua=void 0===ua?!1:ua;ma.removeAttribute("Href");ma.setAttribute(jb.a.fk,jb.a.KF);ma.className="ewa-stb-navbutton";ma.title=Ab;ma.tabIndex=0;R?ec=this.svgIconProvider.loa(R,12,12,ma,24,24):(Ab=document.createElement("span"),Ab.className=Ea.a.mZh,Ab.classList.add(Zb.a.puc),Ab.tabIndex=-1,ma.appendChild(Ab),R=document.createElement("img"),R.src=Lb.a.Gn(ec),R.className=na,R.alt=pb,R.tabIndex=-1,Ab.appendChild(R),ec=R);ua&&ma.classList.add(Zb.a.YHa);
return ec}dispose(){if(this.$){var ma=this.$.sa;ma.Nn(this.Bq);ma.Ije(this.HNa);ma.Mca(this.WH);ma.iBa(this.I2b);ma.jBa(this.n2);ma.BGg(this.Nrg);ma.c6b(this.Prg);ma.Yok(this.Org);ma.$je(this.Qhg);ma.zGg(this.Rhg);ma.ake(this.Shg);ma.AGg(this.j5a);this.$.$r(this.Dj);this.$.mL(this.nq);zb.a(this.$)&&zb.a(this.$).Dm.kBa(this.uZ);this.wIa&&Uc.f(this.$).gGg(this.S1b);ad.a.instance.Oa($c.a.xN,this.domElement,this.tZ);Ld.a.instance.Oa(this.domElement,this.Hp)}jd.a.gj(this.S7d);this.S7d=null;if(this.dZ)for(ma=
0;ma<this.dZ.length;ma++){const Ab=pe.DOMElementExtensions.w_a(this.dZ[ma],this.domElement,!1,"a");Ab&&Td.a.fPa(Ab)}jd.a.gh(this.kM);jd.a.gh(this.a_c);jd.a.gh(this.nse);this.nse=this.a_c=this.RVb=this.y1=this.kM=null;this.$&&this.R5(!1);this.ena=null;this.dqe(null,"Dispose");this.cac=this.$X=this.Qwc=null;this.mxd();this.nQa=this.pse=this.ose=this.xt=this.dZ=this.$=this.fa=null;super.dispose()}I0h(ma){var Ab,ec;const na=[],pb=[];if(null==ma)na.push("WorkbookCacheItem was null, no cached state to compare");
else if(ma.Txb&&0!==ma.Txb.length)if(this.k9b!==ma.Txb.length)na.push(`SheetTab visible sheet number mismatch. Cached: ${ma.Txb.length} Actual: ${this.k9b}`);else{var R=ma.Txb;for(let ua=0;ua<this.Vo.length;ua++){const xb=this.Vo[ua].U0h(R[ua]);0<xb.length&&pb.push(`Button position ${ua}: ${xb.join(", ")}`)}(R=null===(ec=null===(Ab=this.$.sa)||void 0===Ab?void 0:Ab.la)||void 0===ec?void 0:ec.name)&&R===ma.activeSheetName||na.push(`Active sheet mismatch. Cached value is null: ${!(null===ma||void 0===
ma?0:ma.activeSheetName)} Actual value is null: ${!R}`);this.isRtl!==ma.PZf&&na.push(`Rtl: isRtl: ${this.isRtl} cacheDisplayRtl: ${ma.PZf}`);this.G0h(na,ma);this.H0h(ma,na)}else na.push(`No cached sheet tabs, sheetTabs null: ${!ma.Txb}`);0<pb.length&&na.push(`SheetTabButton: [${pb.join(", ")}]`);return na}Lp(ma,Ab){if(!Ab){r.ULS.shipAssertTag(537153760,0,0<this.Vo.length,"There is no sheet tab button.");if(!this.Vo.length)return!1;ma=null;for(const ec of this.Vo)if(ma=ec.bIf())break;if(!ma)return r.ULS.shipAssertTag(537153759,
0,!1,"There is no focusable tab element."),!1;pe.DOMElementExtensions.setFocus(ma)}return!Ab}wq(ma){return pe.DOMElementExtensions.Co(this.ij,ma)}Rs(){}nu(){}reorderSheets(ma,Ab,ec){if(this.eca&&this.eca!==ma){const na=this.eca.index;this.Ark(this.eca,ma,Ab);ma=ma?ma.index-1:Ab?this.$.sa.count-1:0;na!==ma&&(this.QCj(na,ma,ec),this.wmi(this.eca.name,ma))}}T0i(ma){ma=this.Lwa(ma);return-1!==ma&&this.oP<=ma&&ma<=this.bpa?this.Vo[ma].domElement:null}f8g(ma){for(var Ab=0;Ab<this.dZ.length;Ab++){const ec=
this.dZ[Ab];if(ec&&this.svgIconProvider){const na=ec.parentNode;this.LFg(ec);na&&(this.dZ[Ab]=this.svgIconProvider.loa(ma?this.Yxg[Ab]:this.T7d[Ab],12,12,na,24,24))}}for(Ab=0;Ab<this.Vo.length;Ab++)this.Vo[Ab].g8g(ma);this.L8a&&this.L8a.QWa&&this.e8g(Yc.a.J2i,this.L8a,ma);this.y1&&this.y1.QWa&&this.e8g(Yc.a.z0h,this.y1,ma)}e8g(ma,Ab,ec){Ab.o4b||(Ab.o4b=this.svgIconProvider.loa(ma,12,12,Ab.QWa.parentNode,24,24));Ab.o4b&&(pe.DOMElementExtensions.setVisible(Ab.QWa,!ec),pe.DOMElementExtensions.setVisible(Ab.o4b,
ec))}M0j(ma,Ab){var ec=Uc.f(this.$);const na=ec.inRangePicker,pb=Fc.HelperMethods.vA(Ab);if(ec.isEditing&&!na){const R=ec.DA?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let ua;ua=[Object(Ob.a)(ec.cellTextEditBox.Xa.TQa)];Ob.b(this.$).iz(pb.rawEvent,R,ua);ec.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}ec=this.$La&&3===Ab.Gh;!(2===Ab.Gh&&pb.button===Sys.UI.MouseButton.leftButton||ec)||na||this.L1||zb.a(this.$).wv()||(ec&&ma.K0j(),this.GZb=Ab.clientPoint.x,this.Sfa=Ab,this.yNh(ma))}L0j(){this.Hca()}E7e(){return this.$.isEditMode&&
!Cd.l(this.$.wl)}Hca(){const ma=Fc.HelperMethods.vN(()=>{this.c$k();this.IIk();this.Eqe()});r.ULS.sendTraceTag(537153757,0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${ma}`)}IIk(){const ma=this.ahe;pe.DOMElementExtensions.toggleCssClass(this.nQa,this.$.uX?"ewa-stb-right-scrollable":"ewa-stb-left-scrollable",!this.$ge);pe.DOMElementExtensions.toggleCssClass(this.nQa,this.$.uX?"ewa-stb-left-scrollable":"ewa-stb-right-scrollable",!ma)}Eqe(ma){ma=void 0===ma?!1:ma;const Ab=
this.$ge,ec=this.ahe;this.fRg(4,this.sheetTabActivatePreviousHidden,!Ab);this.fRg(5,this.sheetTabActivateNextHidden,!ec);this.uZc(0,Ab||ma);this.uZc(1,Ab||ma);this.uZc(2,ec||ma);this.uZc(3,ec||ma)}fRg(ma,Ab,ec){if(ma=this.dZ[ma]){pe.DOMElementExtensions.setVisible(ma,ec);var na=this.rKf(ma);na.title="img"===ma.nodeName?ma.alt=0<this.Vo.length&&ec?Ab:"":ma.title=0<this.Vo.length&&ec?Ab:"";na.tabIndex=ec?0:-1}}rKf(ma){return ma.parentNode}uZc(ma,Ab){if(ma=this.dZ[ma])ma=this.rKf(ma),void 0!==ma&&null!==
ma&&(!this.Vo.length||Ab?(ma.classList.add(Zb.a.YHa),ma.setAttribute(jb.a.nWa,"true")):(ma.classList.remove(Zb.a.YHa),ma.setAttribute(jb.a.nWa,"false")))}G8a(ma){const Ab=this.$.uX?this.Vo.length-1:0;let ec=this.YMf(this.$.uX?0:this.Vo.length-1);ec&&(ec.borderRightWidth=ma?"1px":"0");this.oP!==this.bpa&&(ec=this.YMf(Ab))&&(ec.borderRightWidth="0")}E4e(ma,Ab){this.Vo||(this.Vo=[]);-1===Ab?this.Vo.push(ma):this.Vo.splice(Ab,0,ma)}huc(ma,Ab){let ec=-1,na=null;Ab||(ec=this.kSi(ma.index),-1!==ec&&(na=
this.b0a(ec)));ma=new Ff(this.$,this.xt,na,ma,this);this.E4e(ma,ec);pe.DOMElementExtensions.setVisible(ma.domElement,!0)}Mqa(ma){const Ab=Fc.HelperMethods.vN(()=>{switch(ma){case 0:this.WXc(0);break;case 1:this.WXc(this.oP-1);break;case 2:this.WXc(this.oP+1);break;case 3:this.scrollIntoView(this.Vo.length-1);break;case 6:this.Xzk()}});this.Xwc&&this.L1&&this.Abc();r.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${ma}, duration = ${Ab}`)}Xxi(ma){if(0===ma.FJ){const Ab=
this.$.sa;let ec=0;for(let na=0,pb=Ab.count;na<pb;na++){const R=Object(Mb.a)(Qa.a,Ab.getItem(na));if(R===ma)return ec;0===R.FJ&&ec++}}return-1}Kxi(ma){const Ab=this.$.sa;for(let ec=ma.index+1,na=Ab.count;ec<na;ec++)if(ma=Object(Mb.a)(Qa.a,Ab.getItem(ec)),0===ma.FJ)return ma;return null}Lwa(ma){for(let Ab=0;Ab<this.Vo.length;Ab++){const ec=this.Saa(Ab);if(!ec)r.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${Ab}] is null even though index is not out of bounds!`);
else if(ec.sheet===ma)return Ab}return-1}Mkb(ma){ma=this.Lwa(ma);return this.Saa(ma)}QCj(ma,Ab,ec){const na={};na.a=this.$.ua.UserSessionId;na.b=ec;na.c=this.Hwc;na.d=ma;na.e=Ab;na.f=this.$.sa.count;bb.b().Ol(2,na,ec)}Ark(ma,Ab,ec){const na=Object(Mb.a)(Gc.a,this.$.sa);Ab?(Ab=Ab.index,Ab=ma.index<Ab?Ab-1:Ab):Ab=ec?na.count-1:0;na.reorderSheet(ma,Ab,!0)}hGk(ma){Uc.f(this.$).ho.RA(ma)}yNh(ma){if(!this.iWc){const Ab=this.domElement.ownerDocument.body;re.a.instance.xa($c.a.Yy,document.documentElement,
this.$4a);this.$La&&(Nd.a.instance.xa($c.a.wo,document.documentElement,this.$4a),Nd.a.instance.xa($c.a.wo,this.domElement,this.wZ));re.a.instance.xa($c.a.jp,document.documentElement,this.a5a);Nd.a.instance.xa($c.a.pl,Ab,this.a5a);this.iWc=!0}this.eca=ma.sheet;this.Hwc=!1;this.$X=null;this.Qwc=ma;this.ena=ma.domElement;this.dqe(pe.DOMElementExtensions.getBoundingClientRect(this.ena),"BeginSheetTabButtonDrag")}R5(ma){ma=void 0===ma?!0:ma;if(this.iWc){this.hGk(jb.a.Yaa);const Ab=this.domElement.ownerDocument.body;
re.a.instance.Oa($c.a.Yy,document.documentElement,this.$4a);this.$La&&(Nd.a.instance.Oa($c.a.wo,document.documentElement,this.$4a),Nd.a.instance.Oa($c.a.wo,this.domElement,this.wZ));re.a.instance.Oa($c.a.jp,document.documentElement,this.a5a);Nd.a.instance.Oa($c.a.pl,Ab,this.a5a);this.Jed=this.iWc=!1}this.KSc=0;this.Hwc=!1;this.eca=null;this.ena&&(this.ena.style.visibility="visible",this.ena=null);this.Qwc=null;this.dqe(null,"EndSheetTabButtonDrag");this.$X&&(this.$X.parentNode&&this.$X.parentNode.removeChild(this.$X),
this.$X=null);this.fuk(ma)}fuk(ma){this.twe(ma);this.$M=this.GZb=-1}wmi(ma,Ab){const ec=this.$.oa,na=ec?ec.ta:null;this.$.userOperationManager.enqueueOperation(new X.a(557,0,(pb,R,ua)=>{const xb=na.Za(9,null);xb.sheetName=ma;xb.newSheetIndex=Ab;return ka.h(na,"ReorderSheets",xb,pb,R,ua,null,0)},64,()=>new fd(ma,Ab)),null)}Saa(ma){return 0<=ma&&ma<this.Vo.length?this.Vo[ma]:null}YXi(ma){return(ma=this.Saa(ma))?ma.sheet:null}b0a(ma){return(ma=this.Saa(ma))?ma.domElement:null}YMf(ma){return(ma=this.b0a(ma))?
ma.style:null}kSi(ma){const Ab=this.$.sa;ma+=1;let ec=-1;const na=this.Vo?this.Vo.length:0;for(;ma<Ab.count;){const pb=Object(Mb.a)(Qa.a,Ab.getItem(ma));if(0===pb.FJ){for(ec=0;ec<na&&this.YXi(ec)!==pb;ec++);break}ma++}return-1===ec||ec===na?-1:ec}Lrg(ma){var Ab=this.Mkb(ma);Ab&&(this.L1&&(r.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),F.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.R5()),this.xt.removeChild(Ab.domElement),Ab=Array.indexOf(this.Vo,Ab),this.Vo.splice(Ab,1),this.Hca(),(!this.isRtl&&Ab===this.Vo.length||this.isRtl&&!Ab)&&this.G8a(!0),this.Xwc&&this.L1?ma===this.eca?(this.R5(),this.Mqa(6)):this.Abc():this.Mqa(6))}Mrg(ma){const Ab=Object(Mb.a)(Qa.a,ma);this.L1&&(r.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),F.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.R5());if(0===Ab.FJ){this.G8a(!1);var ec=this.Lwa(ma);-1===ec&&(r.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.huc(Ab,!1),ec=this.Lwa(ma));this.pRf(ec,!0)}}Brk(ma,Ab){const ec=this.Mkb(ma);ec&&(this.L1&&!Ab&&(r.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),F.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.R5()),ma=this.EZk(ma,ec),!F.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&ma&&Ab&&ma.J0j())}EZk(ma,Ab){var ec=Array.indexOf(this.Vo,Ab);const na=this.Xxi(Object(Mb.a)(Qa.a,ma));if(-1===na||-1===ec)return null;this.G8a(!1);({Cyi:this.oP,Gwj:this.bpa}=$f.xrk(ec,na,this.oP,this.bpa));Ab&&Ab.domElement.parentNode===this.xt&&(this.xt.removeChild(Ab.domElement),this.Vo.splice(ec,1));Ab=this.Kxi(ma);Ab=this.Lwa(Ab);ec=new Ff(this.$,this.xt,this.b0a(Ab),Object(Mb.a)(Qa.a,
ma),this);this.E4e(ec,Ab);Ab=this.Lwa(ma);this.pRf(Ab,!1);return ec}xni(){const ma=this.Vo?this.Vo.length:0,Ab=this.oP,ec=this.bpa;for(let na=0;na<ma;na++){const pb=this.Saa(na),R=na>=Ab;pb&&(pb.tabIndex=R&&na<=ec?0:-1)}}I8k(){const ma=this.Vo?this.Vo.length:0;for(let Ab=0;Ab<ma;Ab++){const ec=this.Saa(Ab);ec&&ec.uAb()}}pRf(ma,Ab){Ab&&ma<=this.oP&&this.oP++;this.xni();this.G8a(!0);this.Hca();this.Xwc&&this.L1&&this.Abc()}eZc(ma){const Ab=this.$.uX;if(ma||this.isRtl!==Ab)this.isRtl=Ab,this.domElement.classList.remove(this.isRtl?
Ea.a.gQb:Ea.a.hQb),this.domElement.classList.add(this.isRtl?Ea.a.hQb:Ea.a.gQb),this.domElement.dir=this.isRtl?"rtl":"ltr",this.I8k();ma||this.G8a(!0);for(ma=0;ma<this.dZ.length;ma++)0!==ma&&3!==ma&&4!==ma&&5!==ma&&this.gRg(ma)}X8h(){const ma=this.ose=document.createElement("div");ma.className="ewa-stb-navarea";ma.classList.add("ewa-stb-navarea-dimensions");this.domElement.appendChild(ma);this.Kmf(ma,1,717,716);this.Kmf(ma,2,719,718);this.$3f&&(this.L8a=new Yb(this.$,this,ma))}Y8h(){const ma=this.pse=
document.createElement("div");ma.className="ewa-stb-navareaextra";this.domElement.appendChild(ma);this.yAd()}e$h(){const ma=document.getElementById(jb.a.pLk),Ab=document.getElementById(jb.a.qLk);ma&&!Ab&&r.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${ma.parentNode.id}. progressBar div has child: ${!!ma.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(jb.a.YZc)}`);const ec=Nb.a.S_d(this.$);
if(ec&&ma&&Ab)this.domElement.appendChild(ma),this.oQa=ma.firstChild,this.pQa=document.getElementById(jb.a.YZc),Ab.style.visibility="visible";else{const na=document.createElement("div"),pb=document.createElement("div");na.className=Ea.a.Mqi;pb.className=Ea.a.Kqi;pb.id=jb.a.dse;pb.style.display="none";const R=document.createElement("div");R.className=Ea.a.Nqi;const ua=document.createElement("div");ua.className=Ea.a.Lqi;const xb=document.createElement("div");xb.className=Ea.a.Jqi;pb.appendChild(R);
pb.appendChild(ua);pb.appendChild(xb);na.appendChild(pb);this.domElement.appendChild(na);this.oQa=pb;this.pQa=ua;r.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",ec,ma,Ab)}}gRg(ma){var Ab=this.dZ[ma];if(Ab){const ec=Ab.parentNode;this.LFg(Ab);Ab=Jb.a(this.$)?this.Yxg[ma]:this.T7d[ma];this.dZ[ma]=this.svgIconProvider.loa(Ab,12,
12,ec,24,24)}}LFg(ma){(null===ma||void 0===ma?0:ma.parentNode)&&ma.parentNode.removeChild(ma)}v6h(){const ma=this.nQa=document.createElement("div");ma.className="ewa-stb-contentarea";this.domElement.appendChild(ma);this.fai(ma)}fai(ma){const Ab=document.createElement("div");Ab.className="ewa-stb-tabarea";Ab.classList.add("ewa-stb-disable-scrollbar");this.$.printingEnabled||Ab.classList.add(Kb.Vb);ma.appendChild(Ab);this.xt=document.createElement("ul");pe.DOMElementExtensions.wL(this.xt,jb.a.Asd,null,
null);this.xt.className=Kb.mb;Ab.appendChild(this.xt);this.P8h();this.vZe=document.createElement("div");this.ZZc.id="SheetIconTooltipContainer";Ab.appendChild(this.ZZc)}P8h(){const ma=document.createElement("div"),Ab=document.createElement("div"),ec=Lb.a.mGf(Ea.a.Gri);Ab.className=Ea.a.qZh;Ab.appendChild(ec);ma.appendChild(Ab);ma.className="ewa-stb-sheettabmoveindicator";pe.DOMElementExtensions.setVisible(ma,!1);this.xt.appendChild(ma)}QAd(){const ma=this.$.sa;for(let Ab=0,ec=ma.count;Ab<ec;Ab++){const na=
Object(Mb.a)(Qa.a,ma.getItem(Ab));0===na.FJ&&(this.huc(na,!0),na.active&&na.activate({scenario:"createSheetTabs"}))}}mxd(){jd.a.gj(this.Vo);this.Vo=[];this.bpa=this.oP=0}Kmf(ma,Ab,ec,na){const pb=document.createElement("a");ma.appendChild(pb);ma=this.T7d[Ab];this.dZ[Ab]=this.jh(pb,Na.a.instance.ia(na),0,this.LKj[Ab],Na.a.instance.ia(ec),ma);if(5===Ab||4===Ab)pe.DOMElementExtensions.w_a(this.dZ[Ab],pb,!1,"span").style.marginTop="10px";this.gRg(Ab);ec=this.S7d[Ab]=this.ml.Wk(pb);re.a.instance.xa($c.a.Bj,
pb,ua=>ua.ctrlKey&&this.ERj(Ab)?!0:this.Nog(Ab));re.a.instance.xa($c.a.jp,pb,()=>this.Oog());Nd.a.instance.xa($c.a.pl,pb,()=>this.Oog());re.a.instance.xa($c.a.MB,pb,()=>this.exd());uc.a.instance.xa($c.a.Wi,pb,ua=>13!==ua.La.keyCode&&32!==ua.La.keyCode||this.dzd?!1:(this.dzd=!0,this.Nog(Ab)));uc.a.instance.xa($c.a.qk,pb,ua=>13===ua.La.keyCode||32===ua.La.keyCode?(this.dzd=!1,this.exd()):!1);const R=this.E7e();na=ua=>{"mouseup"===ua.type&&this.L1||Se.g(ua);!pb.classList.contains(Zb.a.YHa)&&R&&this.nYj(ua,
Ab)};ec.Ga("mouseover",na);ec.Ga("mouseout",na);ec.Ga("focus",na);ec.Ga("blur",na);R&&ec.Ga("mouseup",na)}Dlj(ma){let Ab=!1;const ec=this.$.Dl;ec&&(Ab=pc.a.LY(pe.DOMElementExtensions.getBoundingClientRect(ec),ma.clientPoint));return Ab}Abc(){if(!this.$X){r.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.$X=this.ena.cloneNode(!0);if(!this.NLg(this.$X,this.ena,!0,"UpdateDragAndDropState"))return;this.ena.style.visibility="hidden";
this.$X.classList.add("ewa-stb-tabs-ghost");this.$X.style.borderRightWidth="";this.LDc=this.Sfa.clientPoint.x-this.dga.width/2;this.$X.style.left=this.LDc+"px";this.$M=this.Lwa(this.eca);0>this.$M&&r.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Xwc&&(this.$M=this.Lwa(this.eca));var ma=pe.DOMElementExtensions.getBoundingClientRect(this.xt);const Ab=ma.x;ma=ma.x+ma.width;let ec=this.Sfa.clientPoint.x-this.dga.width/2;ec=Math.min(ec,ma-this.dga.width);
ec=Math.max(ec,Ab);this.$X.style.transform="translateX("+Math.abs(ec-this.LDc)*(this.LDc<ec?1:-1)+"px)";const na=this.Sfa.clientPoint.x>this.GZb;let pb=this.Sfa.clientPoint.x;ec>=ma-this.dga.width?(pb=ma-this.dga.width/2,this.loe()||this.VAa||(r.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.PRc=this.xt.scrollLeft,this.VAa=window.requestAnimationFrame(this.uNg))):ec<=Ab?(pb=Ab+this.dga.width/2,
this.koe()||this.VAa||(r.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.PRc=this.xt.scrollLeft,this.VAa=window.requestAnimationFrame(this.tNg))):this.VAa&&(r.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.twe());this.Sfa.clientPoint.x!==this.GZb&&(this.ixe(na,pb),this.GZb=this.Sfa.clientPoint.x);this.Jed=
!0}ixe(ma,Ab){let ec;for(;(()=>{let na=this.vji(Ab,ma);({mrc:ec}=na);return na})().returnValue;)this.cac=ec,this.uIh(ma)}uIh(ma){if(this.cac){var Ab=(ma?1:-1)*this.dga.width;if(ma&&!this.$.uX||!ma&&this.$.uX){var ec=this.ena;var na=this.$M+1;var pb=!0}else ec=(na=this.Saa(this.$M+1))?na.domElement:null,na=this.$M-1,pb=!1;if(this.NLg(this.cac,ec,pb,"AnimateSheetSwap")){r.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.$M} and other sheet-index ${na}. amount of sheets in the bar: ${this.k9b} isMovingRight: ${ma}`);
0<=this.$M&&this.$M<this.Vo.length&&0<=na&&na<this.Vo.length?(ma=this.Vo[na],this.Vo[na]=this.Vo[this.$M],this.Vo[this.$M]=ma):(r.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.Vo.length}, ghostIndex: ${this.$M}, swappedSheetIndex: ${na}`),this.R5());this.$M=na;var R=this.cac;R.style.transform="translateX("+Ab+"px)";window.requestAnimationFrame(()=>{R.style.transform="translateX(0px)"})}}}NLg(ma,Ab,ec,na){const pb=R=>R?`Node ID: ${R.id} , Node class: ${R.className}, Node name: ${R.nodeName},`:
null;try{return this.xt.insertBefore(ma,Ab),!0}catch(R){return ma=this.Mkb(this.eca),r.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",ma?ma!==this.Qwc?"Changed":"NoChange":"Removed",na,pb(Ab),
pb(Ab.parentNode),pb(this.xt),ec,this.$M,this.k9b,R),this.R5(),!1}}vji(ma,Ab){var ec=this.$.uX===Ab?this.Saa(this.$M-1):this.Saa(this.$M+1);if(!ec)return{returnValue:!1,mrc:null};ec=ec.domElement;const na=pe.DOMElementExtensions.getBoundingClientRect(ec);return this.dga?Ab?{returnValue:ma+this.dga.width/2>=na.x+.5*na.width,mrc:ec}:{returnValue:ma-this.dga.width/2<=na.x+.5*na.width,mrc:ec}:(r.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.R5(),{returnValue:!1,mrc:ec})}rNg(ma,Ab){let ec;ec=Ab?this.uNg:this.tNg;if(-1===this.T0c)this.T0c=ma,this.VAa=window.requestAnimationFrame(ec);else{ma=Math.floor((ma-this.T0c)/1E3*300);var na=this.i7b>this.c_b?1:-1;this.scrollLeft(Math.abs(this.xt.scrollLeft-(Ab?this.PRc+ma*na:this.PRc-ma*na))*(Ab?-1:1));if(ma=this.tIf("ScrollStep"))this.ixe(Ab,ma.x+ma.width/2),Ab&&!this.loe()||!Ab&&!this.koe()?this.VAa=window.requestAnimationFrame(ec):(r.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.twe())}}loe(){const ma=this.i7b>this.c_b;return ma&&this.GBa>=this.i7b||!ma&&this.GBa<=this.i7b}koe(){const ma=this.i7b>this.c_b;return ma&&this.GBa<=this.c_b||!ma&&this.GBa>=this.c_b}twe(ma){ma=void 0===ma?!0:ma;this.xt&&(this.GBa=this.xt.scrollLeft);window.cancelAnimationFrame(this.VAa);this.VAa=0;this.T0c=-1;ma&&this.Hca()}dqe(ma,Ab){ma||r.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${Ab}`);this.dga=ma}ERj(ma){return 2===
ma?(this.Mqa(3),!0):1===ma?(this.Mqa(0),!0):!1}Nog(ma){r.ULS.shipAssertTag(537153732,0,-1===this.b6a&&-1===this.a6a,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.b6a&&(window.clearTimeout(this.b6a),this.b6a=-1);-1!==this.a6a&&(window.clearInterval(this.a6a),this.a6a=-1);this.Mqa(ma);this.b6a=window.setTimeout(()=>{this.ZWk(ma)},this.AKj);return!0}ZWk(ma){this.a6a=window.setInterval(()=>{this.Mqa(ma)},
this.zKj)}Oog(){this.exd();return!this.L1}exd(){window.clearTimeout(this.b6a);window.clearInterval(this.a6a);this.a6a=this.b6a=-1;return!0}nYj(ma,Ab){const ec=this.yXb(Ab),na=5===Ab;"mouseup"!==ma.type||!na&&4!==Ab||(ec||this.reorderSheets(null,na,!1),this.R5())}yXb(ma){return!!pe.DOMElementExtensions.PHf(this.dZ[ma],"a").title}U4c(ma){this.QBe(ma);this.Hca()}QBe(ma){(ma=this.Mkb(ma))&&ma.uAb()}Xzk(){var ma=this.$.sa;if(ma.la&&(!ng.e(this.$)||ma.count))if(ma=this.Lwa(ma.la),-1===ma)r.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var Ab=this.b0a(ma);ma<this.oP?this.WXc(ma):ma>this.oP&&!Dc.a.f3a(Ab,this.nQa)&&this.scrollIntoView(ma)}}c$k(){this.oP=0;this.bpa=this.Vo.length-1;let ma=!1;for(let Ab=0;Ab<this.Vo.length;Ab++){const ec=this.Saa(Ab);if(!ec)break;const na=Dc.a.f3a(ec.domElement,this.nQa);ec.tabIndex=na?0:-1;if(!ma&&na)this.oP=Ab,ma=!0;else if(ma&&!na){this.bpa=Ab-1;break}}}WXc(ma){this.$.sa.count&&(this.Vo.length||this.QAd(),
this.o8a(this.b0a(Math.max(0,Math.min(ma,this.Vo.length-1)))),this.Hca())}scrollIntoView(ma){r.ULS.shipAssertTag(537153697,0,ma>=this.oP,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.sa.count){this.Vo.length||this.QAd();var Ab=this.b0a(Math.max(0,Math.min(ma,this.Vo.length-1))),ec=this.b0a(this.oP);if(!Dc.a.f3a(Ab,this.nQa)){Ab=pe.DOMElementExtensions.getBoundingClientRect(Ab);var na=pe.DOMElementExtensions.getBoundingClientRect(this.nQa);
Ab=this.isRtl?na.x-Ab.x:Ab.x+Ab.width-(na.x+na.width);for(na=0;ec&&na<Ab;){const pb=pe.DOMElementExtensions.getBoundingClientRect(ec);na+=pb.width;ec=ec.nextSibling}ec?this.o8a(ec):r.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.oP}, lastVisibleSheetTabIndex = ${this.bpa}, scroll to index: ${ma}`)}this.Hca()}}o8a(ma){if(F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.stbSsrSupportMultipleSheets",!1))Dc.a.o8a(ma,
this.xt,this.isRtl,this.scrollLeft.bind(this));else{const Ab=pe.DOMElementExtensions.getBoundingClientRect(this.xt);ma=pe.DOMElementExtensions.getBoundingClientRect(ma);this.isRtl?this.scrollLeft(Math.floor(Ab.x+Ab.width-(ma.x+ma.width+.5))):this.scrollLeft(Math.ceil(Ab.x-ma.x-.5))}}scrollLeft(ma){(0>ma&&this.loe()||0<ma&&this.koe())&&r.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const Ab=this.xt.scrollLeft;if(this.isRtl){if(t.a.kJ||
t.a.Cm){this.xt.scrollLeft=this.GBa=Ab-ma;return}if(t.a.IP){this.xt.scrollLeft=this.GBa=Ab+ma;return}r.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.xt.scrollLeft=this.GBa=Ab-ma}t9h(){const ma=this.pse;hd.VTg(this.$)?(jd.a.gh(this.y1),this.y1=new hd(ma,this.$,this,!0),F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(this.oGc=!1)):(jd.a.gh(this.y1),Cd.l(this.$.wl)?this.y1=new Wf(ma,this.$,this):this.y1=new hd(ma,
this.$,this),F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(this.oGc=!0))}Tmf(ma,Ab){var ec=this.$.sa;if(!this.$.isEditMode||!ec.count)jd.a.gh(Ab),Ab=null;else if(!Ab)if(ec=this.ose,Cd.l(this.$.wl))Ab=new Wf(ec,this.$,this);else switch(ma){case 0:Ab=new hd(ec,this.$,this);break;case 1:Ab=new xd(ec,this.$,this);break;default:r.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return Ab}rIg(){this.sIg||
(this.Fch()?Mf.a.instance.Nub(jb.a.Z2,["sheetTabBar"]):(this.lCa.UXg||Mf.a.instance.L2(jb.a.Z2,["sheetTabBar"]),this.lCa.oYh(),Mf.a.instance.MZ(jb.a.Z2,["sheetTabBar"])),Mf.a.instance.Pca(jb.a.Z2,["sheetTabBar"]),this.sIg=!0)}yAd(){this.Vnj?(this.y1=this.Tmf(0,this.y1),this.RVb=this.Tmf(1,this.RVb)):this.t9h()}tIf(ma){const Ab=pe.DOMElementExtensions.getBoundingClientRect(this.$X);Ab||(r.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${ma}: GetBoundingClientRect returned null for the dragged sheet.`),
this.R5());return Ab}gRf(ma,Ab){r.ULS.sendTraceTag(507646810,0,50,`SheetTabBarControl.handleRequestToChangeDisabledState: requestId=${ma}, requestedState=${Ab}`);this.wIa.FJh(ma,Ab);this.R5(!1);this.Eqe(this.navigationButtonsDisabled);if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")){for(const ec of this.l0g)ec&&ec.J2c(this.navigationButtonsDisabled);for(const ec of this.Jpc)ec&&ec.J2c(this.operationButtonsDisabled)}else{for(const ec of this.l0g)ec&&ec.k3(this.navigationButtonsDisabled);
for(const ec of this.Jpc)ec&&ec.k3(this.operationButtonsDisabled)}}G0h(ma,Ab){if(F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetTabCompareButtonsState",!1)){var ec=!this.$ge,na=!this.ahe;ec===Ab.Zee&&na===Ab.u8d||ma.push(`Sheet scroll buttons enabled mismatch. prevNavButtonEnabled: ${ec} nextNavButtonEnabled: ${na}, cached prevNavButtonEnabled: ${Ab.Zee} cached nextNavButtonEnabled: ${Ab.u8d}`);this.oGc!==Ab.nGc&&ma.push(`New sheet button mismatch. insertSheetButtonEnabled: ${this.oGc}, skeletonNewSheetEnabled: ${Ab.nGc}`)}}H0h(ma,
Ab){F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.stbSsrSupportMultipleSheets",!1)&&ma.scrollLeft!==this.xt.scrollLeft&&Ab.push(`Sheet tab bar scroll position mismatch: skeleton left scroll: ${ma.scrollLeft}, sheet tabs left scroll: ${this.xt.scrollLeft}`)}static xrk(ma,Ab,ec,na){ma<ec?(Ab>ec&&ec--,Ab>na&&na--):ma>na?(Ab<ec&&ec++,Ab<na&&na++):Ab<ec&&ec++;return{Cyi:ec,Gwj:na}}}Object(w.a)($f,"SheetTabBarControl",Xb.a,[874,2,42]);var jf=a(91);Object(Q.b)(O.bg,{rk:"singleton"})(ma=>xo(function*(){const Ab=
yield Q.a.resolve(O.Ob,ma);var ec=Ab.xi;if(Cb.a(Ab.ua,1))return Mf.a.instance.s7a(jb.a.Z2,["sheetTabBar"]),null;ec=document.getElementById(ec+jb.a.avc);if(!ec)return Mf.a.instance.s7a(jb.a.Z2,["sheetTabBar"]),null;Mf.a.instance.aDa(jb.a.Z2);const na=Object(jf.e)(Wb.GetServiceTaskFactory.dk(Ab.qa,388,387,null===ma||void 0===ma?void 0:ma.va)),pb=Q.a.resolve(O.fg),[R,ua]=yield Promise.all([na,pb]);return new $f(Ab,ec,ua,R)}));class Hf extends ob.a{constructor(ma){super();this.$=ma;this.sn()}create(){var ma=
this.$.xi;if(Cb.a(this.$.ua,1))Mf.a.instance.s7a(jb.a.Z2,["sheetTabBar"]);else{var Ab=document.getElementById(ma+jb.a.avc);if(Ab){if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:8494154_FixSheetTabBarInitTime")&&(ma=this.$.qa.zh(32))){this.dl(ma);return}Mf.a.instance.aDa(jb.a.Z2);var ec=Wb.GetServiceTaskFactory.dk(this.$.qa,388,387,this.gi),na=Object(jf.d)(Q.a.resolve(O.fg));A.TaskExtensions.$e(A.TaskExtensions.Dq([ec,na],this.$.ya),()=>{this.dl(this.$.qa.zh(32)||new $f(this.$,Ab,na.result,ec.result))},
this.$.ya,3)}else Mf.a.instance.s7a(jb.a.Z2,["sheetTabBar"])}}static Ga(ma){ma.qa.Rh(33,new Hf(ma))}}Object(w.a)(Hf,"SheetTabBarFactory",ob.a,[]);var Uf=a(1141),If=a(1611),sf;(function(ma){ma[ma.unknown=0]="unknown";ma[ma.supported=1]="supported";ma[ma.Uxl=2]="userUnsupportedAnonymous";ma[ma.Vxl=3]="userUnsupportedNoLoginHint";ma[ma.Uol=4]="hostUnsupported";ma[ma.bwl=5]="perfAutomation"})(sf||(sf={}));Object(w.b)("SupportStatus",sf);var tc;(function(ma){ma[ma.external=0]="external";ma[ma.aql=1]="msa";
ma[ma.Gml=2]="aad"})(tc||(tc={}));Object(w.b)("AuthorityType",tc);var ld=a(987);class Ed{constructor(ma){this.Iqh=ma}initialize(){return Promise.resolve(0)}vMc(){return Promise.resolve(0)}nF(){r.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new ld.a,{IsSuccess:!0,Token:this.Iqh}))}l3c(){return Promise.resolve(Object.assign(new ld.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ZEc(){}I1c(){return!1}ATb(){return"MockAuthTokenStrategy"}}
Object(w.a)(Ed,"MockAuthTokenStrategy",null,[902]);var ze=a(1197);class ge{static get(ma,Ab,ec){if(!ec)return ma;let na=0;return Promise.race([ma,new Promise(pb=>{na=window.setTimeout(()=>{pb(Ab)},ec)})]).then(pb=>{window.clearTimeout(na);return Promise.resolve(pb)}).catch(()=>{window.clearTimeout(na);return Promise.resolve(Ab)})}}Object(w.a)(ge,"PromiseWithTimeout",null,[]);var Ne=a(1219),Ge=a(612);class ca{constructor(ma,Ab,ec,na,pb){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=
this.options=null;this.resource=ma;this.scope=Ab;this.silentLogin=ec;this.options=na;this.correlationId=pb}}Object(w.a)(ca,"TokenRequestParameters",null,[309]);class sb{constructor(){this.I1e=null;let ma=rb.AFrameworkApplication.ea.Ya(rb.AFrameworkApplication.o_),Ab=rb.AFrameworkApplication.ea.Ya(rb.AFrameworkApplication.K4g);this.beb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ma&&""!==ma?ma:"Unspecified",Ab&&""!==Ab?Ab:"Unspecified")}initialize(){return new Promise(ma=>
{Object(Ne.a)().execute(Ab=>{this.I1e=Ab;ma(0)})})}er(ma){const Ab=["HTTPS:","API:"];let ec=!1;const na=ma.toLocaleUpperCase();for(const pb of Ab)if(na.startsWith(pb)){ec=!0;break}return ec||this.knj(ma)?ma+"/.default":ma}knj(ma){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ma)}vMc(){return Promise.resolve(0)}nF(ma,Ab,ec,na,pb,R,ua){if(t.a.gMa){pb=Ge.a.mgl;if(!pb)return Ab=Object.assign(new ld.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",
ErrorMessage:"No app list was found."}),Promise.resolve(Ab);if(!Array.contains(pb,ma))return Ab=Object.assign(new ld.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ma}),Promise.resolve(Ab)}ma=this.er(ec);ec=new ca(ec,ma,!na,null,rb.AFrameworkApplication.userSessionId);return this.I1e.getAccessToken(ec,Ab,ua).then(xb=>Object.assign(new ld.a,{IsSuccess:!0,Token:xb.accessToken}),xb=>Object.assign(new ld.a,{IsSuccess:!1,ErrorCode:xb}))}l3c(){return Promise.resolve(Object.assign(new ld.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ZEc(){}I1c(){return!1}ATb(){return this.beb}}Object(w.a)(sb,"ParentFrameTokenStrategy",null,[902]);var Ba=a(1189);class V{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Ezg=this.Lpc=null}}Object(w.a)(V,"PromiseWrapper",null,[]);class Fa{constructor(ma){ma=void 0===ma?0:ma;this.RL=0;this.$Fb=!1;this.mw=new Z.a;this._timeout=
ma}enqueue(ma){return new Promise((Ab,ec)=>{this.mw.add(Object.assign(new V,{Ezg:ma,resolve:Ab,reject:ec}));this.process()})}process(){if(this.$Fb||this.RL===this.mw.count)return!1;const ma=this.mw.ma(this.RL++);try{this.$Fb=!0,ma.Ezg().then(Ab=>{this.$Fb=!1;this.Cyd(ma,Ab,null,!0)}).catch(Ab=>{this.$Fb=!1;this.Cyd(ma,null,Ab,!1)})}catch(Ab){this.$Fb=!1,this.Cyd(ma,null,Ab,!1)}return!0}Cyd(ma,Ab,ec,na){if(na){const pb=()=>{ma.resolve(Ab);this.process()};0<this._timeout?window.setTimeout(()=>{pb()},
this._timeout):pb()}else{const pb=()=>{ma.reject(ec);this.process()};0<this._timeout?window.setTimeout(()=>{pb()},this._timeout):pb()}}}Object(w.a)(Fa,"PromiseQueue",null,[]);class sc{constructor(){this.correlationId=this.resolve=null}}Object(w.a)(sc,"ResolveWithCorrelation",null,[]);var Kc=a(975),qd=a(135),Eb=a(24);class vc extends Ga.a{constructor(ma,Ab,ec,na,pb,R,ua){ua=void 0===ua?!1:ua;super(!1,!1,!0);this.NLe=this.Yda=null;this.F0j=()=>{this.ICf()};this.D7h=()=>this.lC;this.eLk=xb=>{0===xb&&
(this.$vh.reject(Object.assign(new ld.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.GTa(null))};this.V_=ma;this.ksh=ec;this.oE=na;this.$vh=pb;this.GTa=R;this.lC=document.createElement("iframe");this.lC.id="SharedAuthInteractiveFrame";this.lC.setAttribute("name","SharedAuthInteractiveFrame");this.lC.setAttribute("title","SharedAuthInteractiveFrame");this.lC.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.lC.style.border=
"0";this.lC.style.height="48px";this.lC.style.width="190px";$addHandler(this.lC,"error",this.F0j);ma=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.V_,Ab,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",ua?"&msalv3=1":"","&WacUserType=",rb.AFrameworkApplication.userType);this.lC.src=ma;this.Blh=new Promise(xb=>{this.NLe=xb});this.OLe=!1}Rte(){this.Yda={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.ksh,["errorText"]:Object(Eb.a)("InternalError"),
["rtl"]:rb.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.D7h,["resolveDialogStyles"]:this.NLe}};this.Oh=5;this.initializeAndShow(Object(Eb.a)("SignIn"),this.eLk,this.Yda)}P$a(ma,Ab,ec){ma=void 0===ma?!1:ma;Ab=void 0===Ab?!1:Ab;ec=void 0===ec?5:ec;this.Yda&&this.Yda.bodyControls&&(ma!==Object(Mb.a)(Object,this.Yda.bodyControls).frameLoaded&&(Object(Mb.a)(Object,this.Yda.bodyControls).frameLoaded=ma),Ab!==Object(Mb.a)(Object,this.Yda.bodyControls).frameLoadSuccess&&(Object(Mb.a)(Object,
this.Yda.bodyControls).frameLoadSuccess=Ab),ec!==this.Yda.dialogButtonsOption&&(this.Yda.dialogButtonsOption=null,this.Oh=ec),this.update(this.Yda))}hTk(ma,Ab){const ec=new Kc.a(qd.a.jLk);ma={["signInLabel"]:Object(Eb.a)("SignIn"),["cancelLabel"]:Object(Eb.a)("DialogCancel"),["rtl"]:rb.AFrameworkApplication.isRtl,["messageCorrelationId"]:ma,["dialogStyles"]:Ab};ec.Values=ma;this.oE.bda(ec,this.lC.contentWindow,this.V_)}ICf(){this.P$a(!0,!1,6)}get XSg(){return this.lC}get lgi(){return this.Blh.then(ma=>
{this.OLe=!0;return ma})}get mgi(){return this.OLe}}Object(w.a)(vc,"SharedAuthConsentDialog",Ga.a,[911]);var Kd=a(1087),Zd=a(108),nb=a(204),ic=a(191);class Bc{}Bc.Jw="OAuthManager";Object(w.a)(Bc,"OAuthManagerConstants",null,[]);class Qc{constructor(){this.lC=null;this.Ogc=0;this.b4=this.seb=this.$dc=this.GTa=this.qX=this.x0e=null;this.BWj=()=>{const ma=pc.a.Cj()-this.Ogc;r.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ma)};this.bQc=ma=>{const Ab=pc.a.Cj()-
this.Ogc,ec=Object.assign({},{durationMs:Ab});Zd.Health.instance.recordKpiFailure(Bc.Jw,"SharedAuthWACOAuthAspxFrameError",!1,!0,ec);r.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Ab,this.EMe?JSON.stringify(ma):"")};this.Z_j=ma=>{const Ab=this.xea.loadFrame;var ec=pc.a.Cj()-Ab.startTime,na=ma.Values.AuthLibrary.toString();ma=ma.Values.Success.toString();r.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",
ma,na,ec);na&&(this.beb="SharedAuthTokenStrategy "+na);na=Boolean.parse(ma);na||(ma=nb.a.yy(),void 0!==ma&&null!==ma&&(ma.set("AuthLibrary",this.ATb()),ec=Object.assign({},{durationMs:ec,extendedProperties:ma}),Zd.Health.instance.recordKpiFailure(Bc.Jw,"SharedAuthStrategyInitFailed",!1,!0,ec)));Ab.resolve(na?0:1)};this.Y_j=ma=>{if(ma.Values.interactive&&this.seb&&this.seb.Values.messageCorrelationId){const ec=this.seb.Values.messageCorrelationId.toString();if(ma.Values.interactive&&this.qX){this.qX.lgi.then(na=>
{this.oE.bda(this.seb,this.qX.XSg.contentWindow,this.V_);this.qX.hTk(ec,na);this.qX.P$a(!0,!0);this.seb=null});return}}ma=this.xea.initFrame;const Ab=pc.a.Cj()-ma.startTime;r.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ab);ma.resolve(0)};this.cWj=ma=>{if(ma.Values.messageCorrelationId&&ma.Values.messageCorrelationId.toString()){var Ab=ma.Values.messageCorrelationId.toString(),ec=this.xea[Ab];if(ec){var na=pc.a.Cj()-ec.startTime;r.ULS.sendTraceTag(573112906,
3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",na);ma.Values.isSuccess&&ma.Values.isSuccess?ec.resolve(ma.Values.response):ec.reject(ma.Values.response);this.o4g(Ab)}else r.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else r.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.YWj=()=>{if(this.qX.mgi)this.qX.ICf();else if(this.$dc&&
this.qX){const ma=new Kc.a(qd.a.$Sg);ma.Values=this.btd(this.$dc,!0);this.oE.bda(ma,this.qX.XSg.contentWindow,this.V_)}};this.vWj=()=>{this.qX&&this.qX.inb()};this.BQj=ma=>{if(ma.Values.cancelled&&ma.Values.cancelled&&ma.Values.messageCorrelationId){ma=ma.Values.messageCorrelationId.toString();const Ab=this.xea[ma];if(Ab){const ec=new ld.a;ec.ErrorCode="UserCancelled";ec.ErrorMessage="The interactive flow was cancelled by the user";Ab.reject(ec)}this.o4g(ma)}this.qX&&this.qX.hide()};this.NXj=ma=>
{if(ma.Values.messageCorrelationId&&ma.Values.messageCorrelationId.toString()){var Ab=this.xea[ma.Values.messageCorrelationId.toString()];if(Ab){var ec=pc.a.Cj()-Ab.startTime;r.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ec);ma.Values.isSuccess&&ma.Values.isSuccess?Ab.resolve(ma.Values.response):Ab.reject(ma.Values.response)}else r.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else r.ULS.sendTraceTag(555049439,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.oE=new Kd.a(null,null);this.beb="SharedAuthTokenStrategy Unloaded";this.V_=Ge.a.hLk;this.qZe=Ge.a.fLk;Ge.a.Jre&&""!==Ge.a.Jre&&(this.rZe=this.V_+Ge.a.Jre);this.EMe=Ge.a.enableConsoleLogging;this.Zlh=rb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafariMsaPrototypeEnabled",!1);this.Olc=rb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedMsalV3Enabled",
!1);this.mJe=rb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.BundleSharedAuthPostMessages",!1)&&this.Olc;this.xea={};this.xoh=new Fa(1500)}ATb(){return this.beb}initialize(){if("loadFrame"in this.xea)return this.xea.loadFrame.Lpc;if(!this.V_)return Zd.Health.instance.recordKpiFailure(Bc.Jw,"SharedAuthFrameOriginNotSet",!1,!1,null),r.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const ma=this.n1c("loadFrame");
this.Ogc=pc.a.Cj();var Ab=this.V_+this.qZe+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+rb.AFrameworkApplication.userSessionId+"&WacUserType="+rb.AFrameworkApplication.userType;this.Olc&&(Ab+="&msalv3=1");this.lC=document.createElement("iframe");this.lya(this.lC);this.lC.style.cssText="height:0;width:0;display:none;";this.lC.id="SharedAuthFrame";this.lC.setAttribute("name","SharedAuthFrame");this.lC.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.lC.src=Ab;document.body.appendChild(this.lC);Ab=pc.a.Cj()-this.Ogc;r.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}.",Ab,this.lC.src);return ma}vMc(ma){this.$dc=ma;if(this.mJe)return Promise.resolve(0);const Ab=new Kc.a(qd.a.$Sg);Ab.Values=this.btd(ma);ma=this.n1c("initFrame");this.oE.bda(Ab,this.lC.contentWindow,this.V_);r.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");
return ma}nF(ma,Ab,ec,na,pb,R,ua,xb){const W=this.cMf();ua=this.n1c(W);if(this.mJe&&!na){const xa=new Kc.a(qd.a.gLk),kb=this.btd(this.$dc,!1);ma=this.Oze(ma,Ab,ec,na,pb,R,W,xb);Ab={};Ab.initParams=kb;Ab.getTokenParams=ma;xa.Values=Ab;this.oE.bda(xa,this.lC.contentWindow,this.V_)}else{const xa=new Kc.a(qd.a.kLk);xa.Values=this.Oze(ma,Ab,ec,na,pb,R,W,xb);na?(R&&0!=R.length||(R=Object(Eb.a)("WAC_OAuth_CompleteSignIn_Body")),this.xoh.enqueue(()=>new Promise(kb=>{this.F5k(R,xa,kb,W)}))):(this.oE.bda(xa,
this.lC.contentWindow,this.V_),r.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ab))}return ua}F5k(ma,Ab,ec,na){const pb=this.xea[na];pb&&(this.seb=Ab,this.GTa=Object.assign(new sc,{resolve:ec,correlationId:na}),this.qX=new vc(this.V_,this.qZe,ma,this.oE,pb,ec,this.Olc),this.qX.Rte())}cMf(){return ic.a.create().toString()}Oze(ma,Ab,ec,na,pb,R,ua,xb){const W={};W.appName=ma;W.appId=Ab;W.target=ec;W.withPopup=na;W.claims=pb;W.promptMessage=R;
W.forceRefresh=null!==xb&&void 0!==xb?xb:!1;W.messageCorrelationId=ua;return W}lya(ma){$addHandler(ma,"load",this.BWj);$addHandler(ma,"error",this.bQc);this.oE.xX(this.V_);this.oE.kr(qd.a.cTg);this.oE.pq(qd.a.cTg,this.Z_j);this.oE.kr(qd.a.bTg);this.oE.pq(qd.a.bTg,this.Y_j);this.oE.kr(qd.a.YSg);this.oE.pq(qd.a.YSg,this.cWj);this.oE.kr(qd.a.dTg);this.oE.pq(qd.a.dTg,this.NXj);this.oE.kr(qd.a.aTg);this.oE.pq(qd.a.aTg,this.YWj);this.oE.kr(qd.a.ZSg);this.oE.pq(qd.a.ZSg,this.vWj);this.oE.kr(qd.a.WSg);this.oE.pq(qd.a.WSg,
this.BQj)}n1c(ma){const Ab=new V;Ab.startTime=pc.a.Cj();const ec=new Promise((na,pb)=>{Ab.resolve=na;Ab.reject=pb});Ab.Lpc=ec;this.xea[ma]=Ab;return ec}btd(ma,Ab){Ab=void 0===Ab?!1:Ab;const ec={};ec.appIds=this.JFi();ec.upn=ma.loginHint;ec.authority=ma.authority;ec.authorityType=Object(If.a)(tc,ma.authorityType);ec.tenantId=ma.tenantId;ec.correlationId=rb.AFrameworkApplication.userSessionId;ec.enableConsoleLogging=this.EMe;ec.enableSafariMsaPrototype=this.Zlh;ec.interactive=Ab;this.rZe&&(ec.redirectUri=
this.rZe);return ec}JFi(){if(this.Olc)return["243c63a3-247d-41c5-9d83-7788c43f1c43"];const ma=[],Ab=Ge.a.Lrd;for(const na in Ab){var ec=Ab[na];Array.contains(ma,ec)||Array.add(ma,ec)}return ma}l3c(ma,Ab,ec,na,pb,R){const ua=new Kc.a(qd.a.iLk),xb=this.cMf();ua.Values=this.Oze(ma,Ab,ec,na,pb,R,xb);this.x0e=ua;ma=this.n1c(xb);r.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ab);this.qQk(xb);return ma}I1c(){return!0}ZEc(){var ma;this.b4&&(null===(ma=
rb.AFrameworkApplication.ra.businessBar)||void 0===ma?void 0:ma.removeEntry(this.b4))}qQk(ma){if(!this.b4){this.b4=new Ba.a(Object(Eb.a)("WAC_OAuth_CompleteSignIn_Title"),Object(Eb.a)("WAC_OAuth_CompleteSignIn_Body"),null);this.b4.id=16;this.b4.NYd=!1;this.b4.ztd=0;this.b4.closeable=!0;var Ab=!1;this.b4.QX=()=>{if(!Ab){const ec=this.xea[ma];if(ec){const na=new ld.a;na.ErrorCode="UserCancelled";na.ErrorMessage="The interactive flow was cancelled by the user";ec.reject(na)}}};this.b4.addButton(Object(Eb.a)("WAC_OAuth_CompleteSignIn_Button"),
()=>{r.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");Ab=!0;this.oE.bda(this.x0e,this.lC.contentWindow,this.V_);this.b4=void 0},Object(Eb.a)("WAC_OAuth_CompleteSignIn_Button"),!0);if(!rb.AFrameworkApplication.ra.$g.Smc(this.b4)){r.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user.");this.b4=void 0;const ec=this.xea[ma];if(ec){const na=new ld.a;na.ErrorCode="Cookies Disabled";na.ErrorMessage="Interaction Required - Current App Context does not support Business Bar";
ec.reject(na)}}}}o4g(ma){this.GTa&&this.GTa.correlationId===ma&&(this.GTa.resolve(null),this.GTa=null)}}Object(w.a)(Qc,"SharedAuthTokenStrategy",null,[902]);class pd{constructor(ma){this.ljd=ma;this.beb="UnsupportedAuthTokenStrategy Reason="+sf[this.ljd]}initialize(){return Promise.resolve(0)}vMc(){return Promise.resolve(0)}nF(){return Promise.resolve(Object.assign(new ld.a,{IsSuccess:!1,ErrorCode:sf[this.ljd],ErrorMessage:"Unable to get a token. Reason: ["+sf[this.ljd]+"]"}))}l3c(){return Promise.resolve(Object.assign(new ld.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ZEc(){}I1c(){return!1}ATb(){return this.beb}}Object(w.a)(pd,"UnsupportedAuthTokenStrategy",null,[902]);var Xd=a(947),ue=a(363),Ie=a(701);class Je{constructor(ma){ma=void 0===ma?null:ma;this.VQ=0;this.YT=null;this.Ssh=0;this.MQe=Object(Ie.a)();const Ab=pc.a.Cj();var ec=new ld.a;ec.ErrorCode=Je.R6c;this.Bjd=Promise.resolve(ec);const na=new V;
na.startTime=pc.a.Cj();ec=new Promise((pb,R)=>{na.resolve=pb;na.reject=R});na.Lpc=ec;this.xWe=na;this.moh=this.Cfi(ma).then(pb=>pb?this.abj():(r.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.uB(),Math.floor(pc.a.Cj()-Ab)),pb=nb.a.yy(),void 0!==pb&&null!==pb&&(pb.set("AuthLibrary",this.uB()),pb=Object.assign({},{durationMs:Math.floor(pc.a.Cj()-Ab),extendedProperties:pb}),Zd.Health.instance.recordKpiFailure(Bc.Jw,
"StrategyPickFailed",!1,!0,pb)),Promise.resolve(1))).then(pb=>0!==pb?Promise.resolve(pb):this.Ryj())}Dfi(){if(this.MQe)this.VQ=5,this.YT=new pd(this.VQ);else{var ma=Ge.a.mIj;ma&&0<ma.length?(this.VQ=1,this.YT=new Ed(ma)):rb.AFrameworkApplication.ea.ka("IsO365ConsumerHost")||rb.AFrameworkApplication.ea.ka("IsO365CommercialHost")?rb.AFrameworkApplication.ea.ka("IsAnonymousUser")?(this.VQ=2,this.YT=new pd(this.VQ)):(ma=ze.a.getAuthContext().loginHint)&&ma.length?Ge.a.WUb?(this.VQ=1,this.YT=new sb):(this.VQ=
1,this.YT=new Qc):(this.VQ=3,this.YT=new pd(this.VQ)):(this.VQ=4,this.YT=new pd(this.VQ))}}uB(){return this.YT?this.YT.ATb()||"Unknown":"None"}Cfi(ma){ma=void 0===ma?null:ma;r.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ab=pc.a.Cj();return rb.AFrameworkApplication.ea.UMd().then(ec=>{ec?(this.Dfi(),ma&&(this.YT=ma),r.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",Ge.a.clientVersion,
Ge.a.appVersion,Ge.a.Cii,this.uB(),Math.floor(pc.a.Cj()-Ab))):r.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(pc.a.Cj()-Ab));return Promise.resolve(ec)},()=>{r.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(pc.a.Cj()-Ab));return Promise.resolve(!1)})}abj(){r.ULS.sendTraceTag(573390991,
3E3,50,"Initializing {0}",this.uB());const ma=pc.a.Cj();return ge.get(this.YT.initialize(),2,Ge.a.Yfe).then(Ab=>{if(0===Ab)r.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.uB(),Math.floor(pc.a.Cj()-ma));else if(1===Ab){r.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.uB(),Math.floor(pc.a.Cj()-ma));var ec=nb.a.yy();void 0!==ec&&null!==ec&&(ec.set("AuthLibrary",this.uB()),ec=Object.assign({},
{durationMs:Math.floor(pc.a.Cj()-ma),extendedProperties:ec}),Zd.Health.instance.recordKpiFailure(Bc.Jw,"StrategyInitFailed",!1,!0,ec))}else 2===Ab&&(r.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.uB(),Math.floor(pc.a.Cj()-ma)),ec=nb.a.yy(),void 0!==ec&&null!==ec&&(ec.set("AuthLibrary",this.uB()),ec=Object.assign({},{durationMs:Math.floor(pc.a.Cj()-ma),extendedProperties:ec}),Zd.Health.instance.recordKpiFailure(Bc.Jw,
"StrategyInitTimedOut",!1,!0,ec)));return Promise.resolve(Ab)},()=>{r.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.uB(),Math.floor(pc.a.Cj()-ma));return Promise.resolve(1)})}Ryj(){r.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.uB());const ma=pc.a.Cj();return ge.get(this.YT.vMc(ze.a.getAuthContext()),2,Ge.a.Yfe).then(Ab=>{if(0===Ab)r.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.uB(),
Math.floor(pc.a.Cj()-ma));else if(1===Ab){r.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.uB(),Math.floor(pc.a.Cj()-ma));var ec=nb.a.yy();void 0!==ec&&null!==ec&&(ec.set("AuthLibrary",this.uB()),ec=Object.assign({},{durationMs:Math.floor(pc.a.Cj()-ma),extendedProperties:ec}),Zd.Health.instance.recordKpiFailure(Bc.Jw,"StrategyLoadFailed",!1,!0,ec))}else 2===Ab&&(r.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.uB(),Math.floor(pc.a.Cj()-ma)),ec=nb.a.yy(),void 0!==ec&&null!==ec&&(ec.set("AuthLibrary",this.uB()),ec=Object.assign({},{durationMs:Math.floor(pc.a.Cj()-ma),extendedProperties:ec}),Zd.Health.instance.recordKpiFailure(Bc.Jw,"StrategyLoadTimedOut",!1,!0,ec)));return Promise.resolve(Ab)},()=>{r.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.uB(),Math.floor(pc.a.Cj()-ma));return Promise.resolve(1)})}Y5k(ma){return this.ZCa("Core",
ma,!1,void 0,"",null,0,0,!0)}nF(ma,Ab,ec,na){return this.ZCa(ma,Ab,!1,na,"",void 0===ec?null:ec)}A$a(ma,Ab,ec,na,pb){return this.ZCa(ma,Ab,!0,ec,na,void 0===pb?null:pb)}ZCa(ma,Ab,ec,na,pb,R,ua,xb,W){ua=void 0===ua?0:ua;xb=void 0===xb?0:xb;ua+=1;r.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ma,this.V7a(ma,Ab),this.uB(),ua);var xa=nb.a.yy();void 0!==xa&&null!==xa&&(xa.set("AuthLibrary",this.uB()),xa.set("AppName",ma),
xa.set("Target",this.V7a(ma,Ab)),Zd.Health.instance.recordKpiUsage(Bc.Jw,ue.b.FailureBased,"WacOAuthFC",xa));if(!Ge.a.isEnabled||this.MQe){var kb;return this.V3d((kb=new ld.a,kb.IsSuccess=!1,kb.Token=null,kb.ErrorCode="NotEnabled",kb.ErrorMessage="OAuthManager is disabled.",kb),ma)}const Pb=Ge.a.Lrd[ma];if(void 0===Pb||null===Pb){r.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",ma);var T;return this.V3d((T=new ld.a,
T.IsSuccess=!1,T.Token=null,T.ErrorCode="DisallowedApp",T.ErrorMessage="Disallowed appName: "+ma,T),ma)}const Za=pc.a.Cj();let Db=Za;const kc=this;xa=this.moh.then(me=>{Db=pc.a.Cj();return kc.phj(ma,Pb,Ab,1==ua?!1:ec,na,pb,R,me,W)});kb=ec?0:Ge.a.Yfe;let Wc;T=(Wc=new ld.a,Wc.IsSuccess=!1,Wc.Token=null,Wc.ErrorCode="authTokenStrategy_timeout",Wc.ErrorMessage="Auth Strategy timed out after ["+kb+"] ms when fetching token",Wc);const yd=this,Od=this;return ge.get(xa,T,kb).then(me=>{if(ua<=Je.QGj&&(me.ErrorCode===
Je.zGe||me.ErrorCode===Je.oMh))return r.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ua,Math.floor(pc.a.Cj()-Za)),yd.ZCa(ma,Ab,ec,na,pb,R,ua,xb|4);if(me.ErrorCode===Je.q7c||me.ErrorCode===Je.pdc){r.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken failed with ITP error.  Fallback Flow Enabled: [{0}], Popup Requested [{1}]",Je.nuf,ec);if(ec)return yd.ZCa(ma,Ab,!0,na,pb,R,ua,xb|32);if(Je.pgj(Pb))return this.Bjd=this.Bjd.then(De=>{if(De.IsSuccess)return yd.ZCa(ma,
Ab,ec,na,pb,R,ua,xb|8);if(De.ErrorCode===Je.R6c||De.ErrorCode===Je.q7c)return yd.HXf(ma,Pb,Ab,ec,na,pb,R,Za,Db,xb|16).then(Le=>Le.ErrorCode===Je.pdc?yd.ZCa(ma,Ab,!0,na,pb,R,ua,xb|32):Le);if(De.ErrorCode===Je.pdc)return yd.ZCa(ma,Ab,!0,na,pb,R,ua,xb|32);if(De.ErrorCode===Je.DGe)return De}).catch(()=>yd.HXf(ma,Pb,Ab,ec,na,pb,R,Za,Db,xb))}return Promise.resolve(yd.QMc(me,ma,Ab,Pb,Za,Db,xb,ua))}).catch(()=>{let me;const De=(me=new ld.a,me.IsSuccess=!1,me.Token=null,me.ErrorCode="authTokenStrategy_failure",
me.ErrorMessage="Auth Strategy failed with an unknown error",me);return Promise.resolve(Od.QMc(De,ma,Ab,Pb,Za,Db,xb,ua))})}HXf(ma,Ab,ec,na,pb,R,ua,xb,W,xa){const kb=new ld.a;kb.IsSuccess=!1;if(!this.YT.I1c())return kb.ErrorCode="authTokenStrategy_loginNotSupported",kb.ErrorMessage="This Token Strategy does not support login flow, TryLogin could not be completed",Promise.resolve(kb);const Pb=this.YT.l3c(ma,Ab,ec,na,pb,R).then(Za=>Promise.resolve(this.JOc(Za,!0,ma))).catch(Za=>Promise.resolve(this.JOc(Za,
!1,ma))).then(Za=>{xa|=16;return Promise.resolve(this.QMc(Za,ma,ec,Ab,xb,W,xa))}).catch(()=>{kb.ErrorCode="authTokenStrategy_failure";kb.ErrorMessage="LoginPopup failed, GetToken could not be called";xa|=16;return Promise.resolve(this.QMc(kb,ma,ec,Ab,xb,W,xa))}),T=this.xWe.Lpc.then(()=>this.ZCa(ma,ec,na,pb,R,ua,0,xa|8));return Promise.race([T,Pb])}phj(ma,Ab,ec,na,pb,R,ua,xb,W){return 1===xb||2===xb?this.V3d(Object.assign(new ld.a,{IsSuccess:!1,Token:null,ErrorCode:1===xb?"InitFailed":"InitTimedOut",
ErrorMessage:"Auth Strategy Failed to Init or Load"}),ma):this.YT.nF(ma,Ab,ec,na,pb,R,ua,W).then(xa=>{if(na){const kb=new ld.a;kb.IsSuccess=!0;this.YT.ZEc();this.xWe.resolve(kb)}return Promise.resolve(this.JOc(xa,!0,ma))}).catch(xa=>Promise.resolve(this.JOc(xa,!1,ma)))}QMc(ma,Ab,ec,na,pb,R,ua,xb){ua=void 0===ua?0:ua;xb=void 0===xb?0:xb;var W;const xa={},kb=pc.a.Cj()-R;xa.IsSuccess=ma.IsSuccess;xa.ErrorCode=ma.IsSuccess?"Success":ma.ErrorCode||"";xa.ErrorMessage=ma.IsSuccess?"Success":this.V7a(Ab,
ma.ErrorMessage||"");xa.Target=this.V7a(Ab,ec||"");xa.TimeInMS=Math.floor(kb);xa.LoadTimeInMS=Math.floor(R-pb);xa.AuthLibrary=this.uB();xa.AppName=Ab;xa.AuthorityType=Object(If.a)(tc,ze.a.CAc());xa.UserType=this.u0i(ze.a.getAuthContext());xa.IsAuthSupportedInSession=sf[this.VQ];xa.RequestCount=++this.Ssh;xa.AppId=na;xa.RetryCount=xb;ma.IsSuccess&&(ua=(null===(W=ma.Telemetry)||void 0===W?0:W.fromCache)?ua|1:ua|2);xa.Type=ua;r.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(xa));ec=nb.a.yy();ma.IsSuccess?
void 0!==ec&&null!==ec&&(ec.set("AppName",Ab),ec.set("AuthLibrary",this.uB()),ec.set("RetryCount",xb.toString()),ec.set("Type",ua.toString()),Ab=Object.assign({},{durationMs:kb,extendedProperties:ec}),Zd.Health.instance.recordKpiSuccess(Bc.Jw,Ab)):void 0!==ec&&null!==ec&&(ec.set("AppName",Ab),ec.set("AuthLibrary",this.uB()),ec.set("ErrorCode",ma.ErrorCode),ec.set("ErrorMessage",this.V7a(Ab,ma.ErrorMessage)),ec.set("Type",ua.toString()),Ab=Object.assign({},{durationMs:kb,extendedProperties:ec}),Zd.Health.instance.recordKpiFailure(Bc.Jw,
"TryGetTokenFailure",!1,!0,Ab));return ma}V3d(ma,Ab){r.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Ab,this.V7a(Ab,ma.ErrorMessage));const ec=nb.a.yy();void 0!==ec&&null!==ec&&(ec.set("AppName",Ab),ec.set("AuthLibrary",this.uB()),ec.set("ErrorCode",ma.ErrorCode),ec.set("ErrorMessage",this.V7a(Ab,ma.ErrorMessage)),Ab=Object.assign({},{extendedProperties:ec}),Zd.Health.instance.recordKpiFailure(Bc.Jw,"FailureBeforeGetToken",!1,!0,Ab));
return Promise.resolve(ma)}W_f(ma){return ma===Xd.a.lzb}V7a(ma,Ab){return this.W_f(ma)&&Ab?"REDACTED":Ab}u0i(ma){return rb.AFrameworkApplication.ea.ka("IsAnonymousUser")?"anonymous":!ma.loginHint||1>ma.loginHint.length?"empty":-1<ma.loginHint.indexOf("guest#")?"guest":-1<ma.loginHint.indexOf("ext#")?"external":0>ma.upn.indexOf("@")?"no-at":"supported"}x1a(){return 1===this.VQ}JOc(ma,Ab,ec){let na=null,pb=null,R=null,ua=null;ma?ma.ErrorCode||ma.ErrorMessage?(pb=ma.ErrorCode?ma.ErrorCode:Je.F6c,R=ma.ErrorMessage?
ma.ErrorMessage:"No message"):ma.errorCode||ma.errorMessage?(pb=ma.errorCode?ma.errorCode:Je.F6c,R=ma.errorMessage?ma.errorMessage:"No message"):ma.Token?Ab?na=ma.Token:(pb=Je.rfh,R="A rejected promise returned a token."):(pb=Je.F6c,R=JSON.stringify(ma)):(pb=Je.R6c,R="No result came from Auth Token Strategy");ma&&ma.Telemetry&&!this.W_f(ec)&&(ua=ma.Telemetry,r.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(ua)));if(pb===Je.kMh||pb===Je.mMh)pb=Je.zGe,R="Auth Library Timed Out";pb===Je.iMh&&(pb=Je.q7c);
if(pb===Je.lMh||pb===Je.hMh||pb===Je.jMh)pb=Je.pdc;pb===Je.nMh&&(pb=Je.DGe);if(pb||R)na=null;return Object.assign(new ld.a,{IsSuccess:!!na,Token:na,ErrorCode:pb,ErrorMessage:R,Telemetry:ua})}static pgj(ma){return Je.nuf&&"243c63a3-247d-41c5-9d83-7788c43f1c43"===ma}static get nuf(){return rb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}}Je.mMh="token_renewal_error";Je.kMh="monitor_window_timeout";Je.iMh="login_required";Je.lMh="popup_window_error";
Je.hMh="consent_required";Je.jMh="invalid_grant";Je.nMh="user_cancelled";Je.oMh="authTokenStrategy_timeout";Je.zGe="Timeout";Je.q7c="Cookies Disabled";Je.pdc="UserInteractionRequired";Je.F6c="Exception";Je.R6c="NoResult";Je.rfh="RejectToken";Je.DGe="UserCancelled";Je.QGj=2;Object(w.a)(Je,"OAuthManager",null,[872]);var He=a(283),hf=a(79),rf=a(94),qf=a(107),We=a(101),Jf=a(55),tf=a(174),ff=a(497);class xf{u6k(ma){if(ma&&rb.AFrameworkApplication.ea&&rb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacTokenValidation",
!1)){ma=ma.startsWith("Bearer ")?ma:"Bearer "+ma;var Ab=Ge.a.aYa.Endpoint;if(Ab){var ec=pc.a.Cj();ma={["Authorization"]:ma};var na=new qf.a;na.add("IsSpoWacToken","1");Ab=hf.a.j4e(Ab,na);rb.AFrameworkApplication.lj.GVa(Ab,1,null,ma,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(pb=>{var R=Math.floor(pc.a.Cj()-ec),ua=null;pb.so?pb="Canceled":pb.Jm?pb="Faulted":(ua=pb.result,pb=ua.succeeded?"Completed":"Failed");R={["TaskResult"]:pb,["BrowserValidationDurationMS"]:R};ua&&(R.HttpStatus=
ua.Ao.data.httpStatus,ua.succeeded&&(ua=of.a(ua.Ao.data.responseData),R.ServerValidationDurationMS=ua.ElapsedMilliseconds,R.ServerValidationResult=ua.ValidatedToken,R.KMSI=ua.KMSI,R.Scopes=ua.Scopes,R.TokenExpiration=Math.floor(parseInt(ua.Expiration)-(new Date).getTime()/1E3)));r.ULS.sendTraceTag(507639839,3E3,"Completed"===pb?20:15,rf.a.toJSON(R))})}}}cag(ma,Ab){const ec=ff.a.instance.uLd();We.a(ma,!0,ec?Ab-ec:0,[{name:"ClickTime",double:ec},{name:"FrameNavigationStart",double:tf.a.instance.h5(Jf.a.uRb)?
tf.a.instance.MD(Jf.a.uRb):0},{name:"TokenReceivedTime",double:Ab}])}}Object(w.a)(xf,"WacTokenValidator",null,[873]);class Lf{Jik(ma,Ab){let ec=Lf.AFe;Ab&&(ec=Math.max(1E3*Ab-Lf.AFe-Date.now(),0));r.ULS.sendTraceTag(507524500,3E3,50,"Core Token Refresh: Scheduling Refresh in {0} ms",ec);setTimeout(()=>{this.JGf(ma)},ec)}JGf(ma){return ma.Y5k(Lf.XEe).then(Ab=>{var ec,na;const pb=Ab.IsSuccess,R=null===(ec=Ab.Telemetry)||void 0===ec?void 0:ec.expiresOn;ec=!1;if(Ab.IsSuccess){const ua="Bearer "+Ab.Token;
ec=rb.AFrameworkApplication.lj.Kda!==ua;rb.AFrameworkApplication.lj.Kda=ua}r.ULS.sendTraceTag(507524499,3E3,50,"Core Token Fetch: Success={0}, ExpirationTime={1}, FetchedNewToken={2}",pb,R,ec);this.Jik(ma,null===(na=Ab.Telemetry)||void 0===na?void 0:na.expiresOn);return Ab})}get name(){return"Common.App.OAuth.OAuthPackage"}co(ma){ma.register(872,"Common.App.OAuth.IOAuthManager").Ai().Ii(()=>new Je);ma.register(873,"Common.App.OAuth.IWacTokenValidator").Ai().Ii(()=>new xf)}init(){const ma=Object(Uf.a)();
Oa.a.instance.resolve("Common.App.OAuth.IWacTokenValidator");this.r6k(ma);this.q6k(ma)}q6k(ma){if(rb.AFrameworkApplication.ea&&rb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Ab=rb.AFrameworkApplication.ea.Ya("FileSource");if(rb.AFrameworkApplication.ea.ka("IsO365ConsumerHost")||rb.AFrameworkApplication.ea.ka("IsO365CommercialHost")||"WopiTest"===Ab){var ec=Ge.a.aYa;if(ec&&ec.IsEnabled){var na=ec.Application,pb=Ge.a.authority;
if(void 0!==na&&null!==na&&na.length&&void 0!==pb&&null!==pb&&pb.length){var R=sf[ma.VQ],ua=t.a.L$,xb=ma.uB();pb=JSON.stringify({Iml:{["xms_cc"]:{values:["cp1"]}}});rb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedMsalV3Enabled",!1)&&(pb=btoa(pb));var W=pc.a.Cj();ma.nF("CAETest",na,null,pb).then(xa=>{const kb=Math.floor(pc.a.Cj()-W);R=sf[ma.VQ];ua=t.a.L$;xb=ma.uB();r.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
kb,xa.IsSuccess,R,xa.ErrorCode,Ab,ua,xb);if(xa.IsSuccess){xa="Bearer "+xa.Token;var Pb=ec.Endpoint;if(Pb){var T=pc.a.Cj();xa={["Authorization"]:xa};var Za=new qf.a;Za.add("EnforceCAE","1");Za.add("IsCAEToken","1");Pb=hf.a.j4e(Pb,Za);rb.AFrameworkApplication.lj.GVa(Pb,1,null,xa,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Db=>{var kc,Wc=Math.floor(pc.a.Cj()-T),yd=null;Db.so?Db="Canceled":Db.Jm?Db="Faulted":(yd=Db.result,Db=yd.succeeded?"Completed":"Failed");Wc={["TaskResult"]:Db,
["BrowserTokenDurationMS"]:kb,["BrowserValidationDurationMS"]:Wc};yd&&(Wc.HttpStatus=yd.Ao.data.httpStatus,yd.succeeded&&(yd=of.a(yd.Ao.data.responseData),Wc.ServerValidationDurationMS=yd.ElapsedMilliseconds,Wc.ServerValidationResult=yd.ValidatedToken,Wc.KMSI=yd.KMSI,Wc.Scopes=yd.Scopes,Wc.TokenExpirationS=Math.floor(parseInt(yd.Expiration)-(new Date).getTime()/1E3),Wc.ClaimChallenge=null===(kc=yd.ClaimChallenge)||void 0===kc?void 0:kc.length));r.ULS.sendTraceTag(508950354,3E3,"Completed"===Db?50:
15,rf.a.toJSON(Wc))})}}else r.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",xa.ErrorCode,xa.ErrorMessage)}).catch(xa=>{const kb=Math.floor(pc.a.Cj()-W);r.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",xa.toString(),kb)})}}}}}r6k(ma){const Ab=rb.AFrameworkApplication.ea.Ya("FileSource");if(rb.AFrameworkApplication.ea.ka("IsO365ConsumerHost")||rb.AFrameworkApplication.ea.ka("IsO365CommercialHost")||"WopiTest"===Ab){var ec=Ge.a.aYa;
if(ec&&ec.IsEnabled){var na=ec.Application,pb=Ge.a.authority;if(void 0!==na&&null!==na&&na.length&&void 0!==pb&&null!==pb&&pb.length){Lf.XEe=na;var R=sf[ma.VQ],ua=t.a.L$,xb=ma.uB();try{var W=new Map;void 0!==W&&null!==W?(W.set("SupportStatus",R),W.set("Browser",ua),W.set("AuthStrategy",xb)):W=null}catch(kb){W=null}Zd.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",W);var xa=pc.a.Cj();(rb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthCorePFTRefreshEnabled",
!0)?this.JGf(ma):ma.nF("Core",na)).then(kb=>{const Pb=Math.floor(pc.a.Cj()-xa);R=sf[ma.VQ];ua=t.a.L$;xb=ma.uB();r.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Pb,kb.IsSuccess,R,kb.ErrorCode,Ab,ua,xb);W&&(W.set("SupportStatus",R),W.set("Browser",ua),W.set("AuthStrategy",xb));var T=Object.assign({},{durationMs:Pb,extendedProperties:W});if(kb.IsSuccess){if(Zd.Health.instance.recordKpiSuccess("WacCorePFT",
T),kb="Bearer "+kb.Token,rb.AFrameworkApplication.lj.Kda=kb,T=ec.Endpoint){var Za=pc.a.Cj();rb.AFrameworkApplication.lj.GVa(T,1,null,{["Authorization"]:kb},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Db=>{var kc=Math.floor(pc.a.Cj()-Za),Wc=null;Db.so?Db="Canceled":Db.Jm?Db="Faulted":(Wc=Db.result,Db=Wc.succeeded?"Completed":"Failed");kc={["TaskResult"]:Db,["BrowserTokenDurationMS"]:Pb,["BrowserValidationDurationMS"]:kc};Wc&&(kc.HttpStatus=Wc.Ao.data.httpStatus,Wc.succeeded&&
(Wc=of.a(Wc.Ao.data.responseData),kc.ServerValidationDurationMS=Wc.ElapsedMilliseconds,kc.ServerValidationResult=Wc.ValidatedToken,kc.KMSI=Wc.KMSI,kc.Scopes=Wc.Scopes,kc.TokenExpirationS=Math.floor(parseInt(Wc.Expiration)-(new Date).getTime()/1E3)));r.ULS.sendTraceTag(520632322,3E3,"Completed"===Db?50:15,rf.a.toJSON(kc))})}}else Zd.Health.instance.recordKpiFailure("WacCorePFT",kb.ErrorCode,!1,!1,T)}).catch(kb=>{var Pb=Math.floor(pc.a.Cj()-xa);Pb=Object.assign({},{durationMs:Pb,extendedProperties:W});
Zd.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+kb.toString(),!1,!1,Pb)})}}}}dispose(){}static main(){He.a.instance.Jo(new Lf)}}Lf.XEe="";Lf.AFe=3E5;Object(w.a)(Lf,"OAuthPackage",null,[13,14]);var Ig=a(9),vf=a(221),rg=a(250),jg=a(437),sg=a(323),af=a(1291);class Ef{constructor(ma){this.Lm=()=>{this.y8f(Nb.a.tGa("excel-uiSlice20-sprite"));F.EwaSettings.ul()||this.$.fa.av(this.Lm)};this.$=ma;this.$_g={};this.hxe={};const Ab=this.YIf("excelInitialAppSprite");Ab?(this.I4e(Ab),this.$.fa.um?
this.y8f(Nb.a.tGa("excel-uiSlice20-sprite")):F.EwaSettings.ul()?ma.fa.lr(this.Lm):ma.fa.mr(this.Lm),this.$.qa.Rh(388,this)):r.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.hxe=null;F.EwaSettings.ul()||this.$.fa.av(this.Lm)}d0a(ma,Ab,ec,na){ec=void 0===ec?null:ec;na=void 0===na?null:na;let pb;(pb=this.hxe[ma])||(this.hxe[ma]=pb=this.A6j(this.$_g[ma]));if(!pb)return r.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${ma} was not found in loaded SVG sprites.`),
null;const R=pb.cloneNode(!0);if(!R.style){const ua=jg.b(pb),xb=jg.b(R),W={};W.iconId=ma;W.isOriginalNodeStyleNull=void 0===pb.style||null===pb.style;W.isOriginalNodeCurrentStyleNull=void 0===pb.currentStyle||null===pb.currentStyle;W.isClonedNodeCurrentStyleNull=void 0===R.currentStyle||null===R.currentStyle;W.originalNode=ua.substring(0,ua.indexOf(">")+1);W.clonedNode=xb.substring(0,xb.indexOf(">")+1);r.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(W)}`)}R.setAttribute("style",
`height: ${Ab}px; width: ${Ab}px;`);na&&(ma=document.createElement("title"),ma.textContent=na,R.insertBefore(ma,R.childNodes[0]));if(ec)for(const ua of ec)F.EwaSettings.isChangeGateEnabled("OfficeVSO:8719525_RemoveIE11Hacks")?R.classList.add(ua):Sys.UI.DomElement.addCssClass(R,ua);return R}loa(ma,Ab,ec,na,pb,R,ua,xb){pb=void 0===pb?0:pb;R=void 0===R?0:R;ua=void 0===ua?null:ua;xb=void 0===xb?null:xb;pb&&R||(R=pe.DOMElementExtensions.getBoundingClientRect(na),pb=R.height,R=R.width);if(ua=this.d0a(ma,
Ab,ua,xb))na.appendChild(ua),(na=pe.DOMElementExtensions.Gga(ua,"style",null))?ua.setAttribute("style",na+` margin: ${(pb-Ab)/2}px ${(R-ec)/2}px;`):r.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${ma}`);return ua}y8f(ma){void Object(sg.b)(ma,{va:0}).then(()=>this.pBh())}pBh(){const ma=this.YIf("excelUiSlice20Sprite");ma?this.I4e(ma):r.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}I4e(ma){for(const Ab of ma)Ab.type===
rg.a.fxe&&(this.$_g[Ab.id]=Ab)}A6j(ma){if(!ma)return null;const Ab=ma.viewBox;ma=ma.children;const ec=document.createElementNS(vf.a.wCa,rg.a.fxe);F.EwaSettings.isChangeGateEnabled("OfficeVSO:8719525_RemoveIE11Hacks")?ec.classList.add("ewa-svg-icon"):Sys.UI.DomElement.addCssClass(ec,"ewa-svg-icon");ec.setAttribute("focusable","false");ec.setAttribute("viewBox",Ab);this.qBh(ec,ma);return ec}qBh(ma,Ab){for(const na of Ab){const pb=document.createElementNS(vf.a.wCa,na.type);for(const R in na){Ab=R;var ec=
na[R];"className"===Ab?pb.setAttribute("class",ec):pb.setAttribute(Ab,ec)}ma.appendChild(pb)}}YIf(ma){return(ma=window[ma])?ma.icons:null}}Object(w.a)(Ef,"SvgIconProvider",null,[896,2]);String(af);window.___1712031281019_closurehack=af;class be extends ob.a{constructor(ma){super();this.$=ma;this.sn()}create(){const ma=[this.Yyj()];A.TaskExtensions.$e(A.TaskExtensions.Dq(ma,this.$.ya),()=>{window.excelInitialAppSprite?this.dl(this.$.qa.zh(388)||new Ef(this.$)):r.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},
this.ya,3)}Yyj(){let ma=jb.a.IJb;rb.AFrameworkApplication.ea.ka("IsStringExperimentEnabled")&&(ma=jb.a.Koc);ma=Nb.a.tGa(ma);return Object(jf.d)(Object(sg.b)(ma,{va:this.gi}))}static Ga(ma){ma.qa.Rh(387,new be(ma))}}Object(w.a)(be,"SvgIconProviderFactory",ob.a,[]);var h=a(934);class qc extends h.a{constructor(ma){super(ma)}sw(){void Q.a.resolve(O.jf,{va:this.gi}).then(()=>{A.TaskExtensions.$e(F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)?Object(jf.d)(Q.a.resolve(O.bg,
{va:this.gi})):Wb.GetServiceTaskFactory.dk(this.$.qa,32,33,this.gi),ma=>{this.Zt([new Ya(ma.result)])},this.$.ya)})}static Ga(ma){h.a.jB(392,new qc(ma))}}Object(w.a)(qc,"SheetDropdownMenuCommandHandlerFactory",h.a,[]);Type.registerNamespace("Common.App.OAuth");Lf.main();F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1291);Ig.a.hh(be.Ga);(()=>{Ig.a.hh(ma=>{a(1486);F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)||Hf.Ga(ma);
O.Uf.Ma()||qc.Ga(ma)})})();String(c);String(b);String(e);String(k);String(d);String(u);String(n);String(v);window.___1712031311746_closurehack=c;window.___1712031311746_closurehack=b;window.___1712031311746_closurehack=e;window.___1712031311746_closurehack=k;window.___1712031311746_closurehack=d;window.___1712031311746_closurehack=u;window.___1712031311746_closurehack=n;window.___1712031311746_closurehack=v}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrs.js.map/52b9755c846a1db1d1bbcd0fc1a75b6f/EwaTS.vrs.js.map