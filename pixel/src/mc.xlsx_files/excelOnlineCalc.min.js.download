var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=334)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return i})),r.d(t,"__assign",(function(){return a})),r.d(t,"__rest",(function(){return o})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return u})),r.d(t,"__esDecorate",(function(){return l})),r.d(t,"__runInitializers",(function(){return c})),r.d(t,"__propKey",(function(){return d})),r.d(t,"__setFunctionName",(function(){return p})),r.d(t,"__metadata",(function(){return m})),r.d(t,"__awaiter",(function(){return f})),r.d(t,"__generator",(function(){return g})),r.d(t,"__createBinding",(function(){return h})),r.d(t,"__exportStar",(function(){return v})),r.d(t,"__values",(function(){return S})),r.d(t,"__read",(function(){return y})),r.d(t,"__spread",(function(){return F})),r.d(t,"__spreadArrays",(function(){return C})),r.d(t,"__spreadArray",(function(){return R})),r.d(t,"__await",(function(){return b})),r.d(t,"__asyncGenerator",(function(){return E})),r.d(t,"__asyncDelegator",(function(){return P})),r.d(t,"__asyncValues",(function(){return k})),r.d(t,"__makeTemplateObject",(function(){return T})),r.d(t,"__importStar",(function(){return N})),r.d(t,"__importDefault",(function(){return _})),r.d(t,"__classPrivateFieldGet",(function(){return I})),r.d(t,"__classPrivateFieldSet",(function(){return O})),r.d(t,"__classPrivateFieldIn",(function(){return M}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}function u(e,t){return function(r,n){t(r,n,e)}}function l(e,t,r,n,i,a){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,u=n.kind,l="getter"===u?"get":"setter"===u?"set":"value",c=!t&&e?n.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),p=!1,m=r.length-1;m>=0;m--){var f={};for(var g in n)f[g]="access"===g?{}:n[g];for(var g in n.access)f.access[g]=n.access[g];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(e||null))};var h=(0,r[m])("accessor"===u?{get:d.get,set:d.set}:d[l],f);if("accessor"===u){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(s=o(h.get))&&(d.get=s),(s=o(h.set))&&(d.set=s),(s=o(h.init))&&i.push(s)}else(s=o(h))&&("field"===u?i.push(s):d[l]=s)}c&&Object.defineProperty(c,n.name,d),p=!0}function c(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))}function g(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}var h=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function F(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function R(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof b?Promise.resolve(r.value.v).then(u,l):c(a[0][2],r)}catch(e){c(a[0][3],e)}var r}function u(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:!1}:i?i(t):t}:i}}function k(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=S(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function N(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return A(t,e),t}function _(e){return e&&e.__esModule?e:{default:e}}function I(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function O(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revocableSingleton=t.testUtils=t.pledge=t.machine=t.testConfig=t.arrayLogger=t.wrapIntoAsyncModule=t.unicode=t.result=t.mixin=t.promise=t.stopwatch=t.resolvablePromise=t.config=t.codePoint=t.setTimeoutInterfaceModule=t.asyncLoopModule=t.async=t.arrayUtils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.combinations=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0;var n=r(0);t.PackageName="excel-online-calc-common";var i=r(339);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return i.fnv1a}});var a=r(211);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return a.JSF32}});var o=r(340);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return o.findIsomorphicSubtrees}});var s=r(341);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return s.combinations}}),n.__exportStar(r(342),t);var u=n.__importStar(r(147));t.anonymizer=u;var l=n.__importStar(r(148));t.util=l;var c=n.__importStar(r(70));t.assertions=c;var d=n.__importStar(r(150));t.featureConfiguration=d;var p=n.__importStar(r(49));t.core=p;var m=n.__importStar(r(355));t.testUtil=m;var f=n.__importStar(r(356));t.arrayMapTree=f;var g=n.__importStar(r(213));t.binaryHeap=g;var h=n.__importStar(r(214));t.bspSet=h;var v=n.__importStar(r(357));t.deque=v;var S=n.__importStar(r(358));t.dictionary=S;var y=n.__importStar(r(359));t.hashSet=y;var F=n.__importStar(r(360));t.hashTable=F;var C=n.__importStar(r(361));t.histogram=C;var R=n.__importStar(r(216));t.interval=R;var b=n.__importStar(r(362));t.priorityQueue=b;var E=n.__importStar(r(363));t.productSet=E;var P=n.__importStar(r(364));t.rbMapTree=P;var k=n.__importStar(r(217));t.rbTree=k;var T=n.__importStar(r(365));t.ringBuffer=T;var A=n.__importStar(r(366));t.rTree=A;var N=n.__importStar(r(367));t.split=N;var _=n.__importStar(r(100));t.table=_,t.arrayUtils=n.__importStar(r(368)),t.async=n.__importStar(r(369)),t.asyncLoopModule=n.__importStar(r(370)),t.setTimeoutInterfaceModule=n.__importStar(r(218)),t.codePoint=n.__importStar(r(371)),t.config=n.__importStar(r(372)),t.resolvablePromise=n.__importStar(r(123)),t.stopwatch=n.__importStar(r(219)),t.promise=n.__importStar(r(123));var I=r(374);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return I.mixin}}),t.result=n.__importStar(r(153)),t.unicode=n.__importStar(r(375)),t.wrapIntoAsyncModule=n.__importStar(r(376)),t.arrayLogger=n.__importStar(r(377)),t.testConfig=n.__importStar(r(378)),t.machine=n.__importStar(r(220)),t.pledge=n.__importStar(r(379)),t.testUtils=n.__importStar(r(380)),t.revocableSingleton=n.__importStar(r(381))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(1);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styleServiceTypes=t.testUtil=t.printServiceTypes=t.printService=t.mathpackIEEE=t.relabel=t.visitor=t.mathpack=t.signature=t.literalParse=t.resolveServiceTypes=t.resolveService=t.util=t.numfmt=t.formulaModule=t.datepack=t.mathpackXL=t.config=t.cellParse=t.cellFormat=t.annotations=t.adjust=t.worksheetFuncTypesModule=t.location=t.value=t.types=t.PackageName=void 0;var n=r(0);t.PackageName="excel-online-calc-lang",t.types=n.__importStar(r(71)),t.value=n.__importStar(r(87)),t.location=n.__importStar(r(50)),t.worksheetFuncTypesModule=n.__importStar(r(155)),t.adjust=n.__importStar(r(382)),t.annotations=n.__importStar(r(384)),t.cellFormat=n.__importStar(r(124)),t.cellParse=n.__importStar(r(156)),t.config=n.__importStar(r(226)),t.mathpackXL=n.__importStar(r(230)),t.datepack=n.__importStar(r(227)),t.formulaModule=n.__importStar(r(40)),t.numfmt=n.__importStar(r(157)),t.util=n.__importStar(r(61)),t.resolveService=n.__importStar(r(158)),t.resolveServiceTypes=n.__importStar(r(103)),t.literalParse=n.__importStar(r(224)),t.signature=n.__importStar(r(101)),t.mathpack=n.__importStar(r(231)),t.visitor=n.__importStar(r(104)),t.relabel=n.__importStar(r(392)),t.mathpackIEEE=n.__importStar(r(393)),t.printService=n.__importStar(r(394)),t.printServiceTypes=n.__importStar(r(232)),t.testUtil=n.__importStar(r(397)),t.styleServiceTypes=n.__importStar(r(398))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(1);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(1);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);n.__exportStar(r(475),t),n.__exportStar(r(476),t),n.__exportStar(r(477),t),n.__exportStar(r(478),t),n.__exportStar(r(479),t),n.__exportStar(r(480),t),n.__exportStar(r(481),t),n.__exportStar(r(482),t),n.__exportStar(r(483),t),n.__exportStar(r(484),t),n.__exportStar(r(485),t),n.__exportStar(r(486),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getEtaFuncId=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.applyComparison=t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(3);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.getEtaFuncId=n.util.getEtaFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable,t.applyComparison=n.util.applyComparison},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcErrorOper=t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(3);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper,t.calcErrorOper=n.value.calcErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.singleLineComment=t.multiLineComment=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.contextNameNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CommentKind=t.CellRefKind=t.BadType=t.AnnotationKind=t.SyntaxFeature=void 0,t.badSequenceNode=t.badCharsNode=t.varNode=t.identNode=t.missingNode=t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=void 0;var n=r(3);t.SyntaxFeature=n.formulaModule.SyntaxFeature,t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.CommentKind=n.formulaModule.CommentKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.contextNameNode=n.formulaModule.contextNameNode,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.multiLineComment=n.formulaModule.multiLineComment,t.singleLineComment=n.formulaModule.singleLineComment,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound,t.missingNode=n.formulaModule.missingNode,t.identNode=n.formulaModule.identNode,t.varNode=n.formulaModule.varNode,t.badCharsNode=n.formulaModule.badCharsNode,t.badSequenceNode=n.formulaModule.badSequenceNode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(1);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRangeEqual=t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isSheetIndex=void 0;var n=r(3);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.sheetRangeToSheetIndex=n.util.sheetRangeToSheetIndex,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isIdentContinue=t.isIdentStart=t.isNumeral=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(3);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.createIsThousandsPositionCallback=n.config.createIsThousandsPositionCallback,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isNumeral=n.config.isNumeral,t.isIdentStart=n.config.isIdentStart,t.isIdentContinue=n.config.isIdentContinue,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeImpl=t.VolatileMode=t.asyncLazy=t.ResettableLazy=void 0;var n,i=r(4),a=r(5),o=r(20),s=r(129),u=r(23),l=r(11),c=function(){function e(e){this.valueCreationFunc=e,this.value=void 0}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.force=function(){void 0===this.value&&(this.value=this.valueCreationFunc())},e.prototype.reset=function(){this.value=void 0},e}();t.ResettableLazy=c,t.asyncLazy=function(e){return new c(e)},function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(n||(t.VolatileMode=n={}));var d=function(){return new Date};t.getTimeImpl=function(e,t,r,c,p){switch(void 0===c&&(c=n.Estimation),void 0===p&&(p=d),c){case n.PrecisionTest:return(0,a.failure)((0,l.unavailable)([{kind:o.UnavailableKind.GetTimeKind,getTimeKind:r}]));case n.Estimation:switch(r){case u.GetTimeKind.NonVolatile:return(0,a.failure)((0,l.unavailable)([{kind:o.UnavailableKind.GetTimeKind,getTimeKind:r}]));case u.GetTimeKind.ValueCell:case u.GetTimeKind.Volatile:}break;case n.GroundTruth:}var m=e.mathpack,f=e.datepack,g=p(),h=f.utcToLocal(e,(0,s.dateTime)(g.getUTCFullYear(),g.getUTCMonth()+1,g.getUTCDate(),g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCDay()+1,g.getUTCMilliseconds(),s.Rounding.Round1000ths),e.timezone);(0,i.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==h);var v=h.yr,S=h.rounding,y=h.mon,F=h.dom,C=h.hour,R=h.min,b=h.sec,E=h.fracSec;t<s.TimeGranularity.Instant&&(E=0,b=0,R=0,C=0),t<s.TimeGranularity.Day&&(F=1,y=1);var P=(0,s.dateTime)(v,y,F,C,R,b,1,E,S),k=f.toNum(e,P);(0,i.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,l.isErrorOper)(k));var T=m.toNumber(k);if(c===n.GroundTruth)return(0,a.success)(k);var A=f.toNum(e,h);(0,i.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,l.isErrorOper)(A));var N,_=m.toNumber(A);switch(t){case s.TimeGranularity.Instant:N=_;break;case s.TimeGranularity.Day:N=T+1;break;case s.TimeGranularity.Year:var I=(0,s.dateTime)(v+1,y,F,C,R,b,1,E,S),O=f.toNum(e,I);(0,i.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,l.isErrorOper)(O)),N=m.toNumber(O)}return _<T+10/1440||_>N-10/1440?(0,a.failure)((0,l.unavailable)([{kind:o.UnavailableKind.TimeGranularity,granularity:t}])):(0,a.success)(k)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(151),t),n.__exportStar(r(351),t),n.__exportStar(r(152),t),n.__exportStar(r(352),t),n.__exportStar(r(353),t),n.__exportStar(r(354),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceRange=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(3);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.lexicalSourceRange=n.location.lexicalSourceRange,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellEvaluationResultKind=t.ES5IterableStackFrame=t.ES5IterableStackValue=t.stackFrameList=t.stackMapList=t.emptyStackEnv=t.LazyOper=t.evalLocalsSlice=t.evalLocalsFirstOrderFunc=t.evalLocalsLambda=t.evalLocalsName=t.evalLocalsGrid=t.evalUsage=t.bottomEvalPrecedents=t.handleEvaluationError=t.throwEvaluationError=t.EvaluationError=t.unevaluated=t.RuntimeInternalReasonKind=void 0;var n,i=r(0),a=r(44),o=r(7),s=r(19),u=r(10),l=r(8),c=r(28),d=r(18),p=r(26),m=r(116);function f(e){throw new t.EvaluationError(e)}!function(e){e.Unevaluated="Unevaluated"}(n||(t.RuntimeInternalReasonKind=n={})),t.unevaluated=function(e){return 0===e.length&&(0,u.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:n.Unevaluated,anchors:e}},t.EvaluationError=(0,o.createFailureErrorClass)("EvaluationError"),t.throwEvaluationError=f;var g=function(){function e(e){this.machine=e,this.runStatus=!1}return e.prototype.next=function(){return(0,c.callMachineTransition)(this.machine,this)},e.prototype.receiveResult=function(e){if(!(0,p.isSuccess)(e))return e;switch(e.value.kind){case S.ReadFailure:return e.value.failure;case S.WroteFailure:return(0,p.failure)((0,a.previousFailure)(e.value.source.range))}return p.successUndefined},e}();t.handleEvaluationError=function(e,t,r){var i;switch(r.kind){case n.Unevaluated:if(t.map.getCount()+1>(null!==(i=e.globals.limits.maxCellChain)&&void 0!==i?i:1/0))return(0,p.failure)((0,a.limitExceeded)(a.LimitKind.CellChain));var o=r.anchors.map((function(r){return new g(e.createCellEvaluationMachine(e,void 0,t,r))}));return(0,c.callMachineTransition)(new c.AllMachine(o),(0,c.nextOnSuccessReceiver)());default:return(0,p.failure)(r)}},t.bottomEvalPrecedents=function(){return(0,l.precedents)([],[],[],d.SpecialPrecs.None,l.PrecsBound.Lower)},t.evalUsage=function(e,t){return{lambdaCalls:e,lambdaDepth:t}},t.evalLocalsGrid=function(e){var t=(0,o.sheetGridRangeAnchor)(e.range),r=(0,p.success)(t.range),n=(0,p.success)(t.sheet);return(0,a.evalLocals)(e,r,n,e.kind===s.LexicalKind.Range,r,n,e.kind===s.LexicalKind.Cell,!0,!1,(0,p.success)(!1),void 0)},t.evalLocalsName=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=(0,p.success)(n);else{var i=t.originSheet;if(!(0,p.isSuccess)(i))return f(i.reason);r=(0,o.isDocumentLocEqual)(i.value.document,n.document)?i:(0,p.success)(n)}var s=t.originGridCell;return(0,a.evalLocals)(e,s,r,t.calcingArray,s,r,!1,!1,!0,(0,p.success)(!1),void 0)},t.evalLocalsLambda=function(e,t){return(0,a.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,p.success)(!1),void 0)},t.evalLocalsFirstOrderFunc=function(e,t){var r=t.originGridCell,n=t.originSheet,i=t.calcingArray,o=t.reflectionGridCell,s=t.reflectionSheet,u=t.implicitIntersect,l=t.allowUnqualifiedCell,c=t.wrapCellReferences,d=t.followHyperlinks;return(0,a.evalLocals)(e,r,n,i,o,s,u,l,c,d,void 0)},t.evalLocalsSlice=function(e){var t=e.lexicalSource,r=e.originGridCell,n=e.originSheet,i=e.calcingArray,o=e.reflectionGridCell,s=e.reflectionSheet,u=e.implicitIntersect,l=e.allowUnqualifiedCell,c=e.wrapCellReferences,d=e.followHyperlinks,p=e.contextNames;return(0,a.evalLocals)(t,r,n,i,o,s,u,l,c,d,p)};var h=function(){function e(e){this.fallback=e}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?this.fallback():this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueOrUndefined",{get:function(){return this._value},enumerable:!1,configurable:!0}),e}();t.LazyOper=h,t.emptyStackEnv=m.RedBlackMapTree.create((function(e,t){return e-t})),t.stackMapList=function(e,t,r){return{labels:e,numPushed:t,next:r}},t.stackFrameList=function(e,t,r,n,i){var a;return{stackDepth:1+(null!==(a=null==i?void 0:i.stackDepth)&&void 0!==a?a:0),lexicalSource:e,position:t,localValues:new v(r,n),caller:i}};var v=function(){function e(e,t){this.stackEnv=e,this.stackMap=t}return e.prototype.iterator=function(){var e,t,r,n,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:e=this.stackEnv.getCount()-1,t=this.stackMap,i.label=1;case 1:if(void 0===t)return[3,6];r=t.numPushed-1,i.label=2;case 2:return r>=0?(n=t.labels[r],o=this.stackEnv.getValue(e--),void 0===n||void 0===o||void 0===(s=o instanceof h?o.valueOrUndefined:o)?[3,4]:[4,(0,a.stackValue)(n,s)]):[3,5];case 3:i.sent(),i.label=4;case 4:return r--,[3,2];case 5:return t=t.next,[3,1];case 6:return[2]}}))},e}();t.ES5IterableStackValue=v;var S,y=function(){function e(e){this.leafFrame=e}return e.prototype.iterator=function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:e=this.leafFrame,t.label=1;case 1:return void 0===e?[3,4]:[4,e];case 2:t.sent(),t.label=3;case 3:return e=e.caller,[3,1];case 4:return[2]}}))},e}();t.ES5IterableStackFrame=y,function(e){e[e.ReadFailure=0]="ReadFailure",e[e.ReadOper=1]="ReadOper",e[e.WroteFailure=2]="WroteFailure",e[e.WroteOper=3]="WroteOper"}(S||(t.CellEvaluationResultKind=S={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseState=t.ExecutionStopReason=t.FrameExecutionStopReason=t.SchedulerVersionCompatibility=t.SchedulerTimelineQueueMessageKind=t.delay=t.awaitPromise=t.typedRequest=t.makeSyncRequester=t.makeRequester=t.RequestKind=t.recalcNotificationKinds=t.ComputationRequestKind=t.DefaultComputationGroup=void 0;var n,i,a,o,s,u=r(0),l=r(2),c=r(4),d=r(60),p=r(142),m=r(121),f=r(143),g=r(47),h=r(48);t.DefaultComputationGroup="",t.ComputationRequestKind={GetSheetNames:"GetSheetNames",GetRange:"GetRange",Delay:"Delay",GetCell:"GetCell",GetContainingTable:"GetContainingTable",UnsafeGetContainingTableName:"UnsafeGetContainingTableName",GetAvailableTableHeaders:"GetAvailableTableHeaders",GetIntersectingTables:"GetIntersectingTables",UnsafeGetIntersectingTableNames:"UnsafeGetIntersectingTableNames",GetStructRefColumn:"GetStructRefColumn",GetStructRefSpecialRef:"GetStructRefSpecialRef",GetIformat:"GetIformat",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",GetActiveCell:"GetActiveCell",GetActiveCellFormat:"GetActiveCellFormat",GetConfig:"GetConfig",GetCultureTag:"GetCultureTag",AwaitPromise:"AwaitPromise",CreateTask:"CreateTask",PromiseToTask:"PromiseToTask",AwaitTask:"AwaitTask",AwaitBatch:"AwaitBatch",AwaitAll:"AwaitAll",AwaitAny:"AwaitAny",GetFunctionsInfo:"GetFunctionsInfo",GetFunctionInfo:"GetFunctionInfo",GetCorrelationId:"GetCorrelationId",SetActiveCell:"SetActiveCell",ParseActiveCell:"ParseActiveCell",GetRichValueFieldListContext:"GetRichValueFieldListContext",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",ResolveReferences:"ResolveReferences",EvalOnClonedModel:"EvalOnClonedModel",EvalFormula:"EvalFormula",GetCorrespondingSnapshotID:"GetCorrespondingSnapshotID",GetEditFormat:"GetEditFormat",GetFullTableHeadersFromServer:"GetFullTableHeadersFromServer",CreateChatGPTSession:"CreateChatGPTSession",CloseChatGPTSession:"CloseChatGPTSession",SendChatGPTQuery:"SendChatGPTQuery",IsSchedulerFeatureEnabled:"IsSchedulerFeatureEnabled",SendAugLoopSignal:"SendAugLoopSignal",TriggerEvent:"TriggerEvent",AwaitEvent:"AwaitEvent",GetRecognizedRangeTables:"GetRecognizedRangeTables",UpdateSnapshot:"UpdateSnapshot"},(0,l.staticAssertExtends)(),(0,l.staticAssertExtends)(),(0,l.staticAssertExtends)(),(0,l.staticAssertExtends)(),t.recalcNotificationKinds=[d.NotificationKind.setA1ReferenceStyle,d.NotificationKind.setLocale,d.NotificationKind.setWorkbookProps,d.NotificationKind.updateSheetNames,d.NotificationKind.updateNamedObjects],function(e){e.functionSuggestion="functionSuggestion",e.inCellSuggestion="inCellSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.valuePreview="valuePreview",e.gotoCtrlClick="gotoCtrlClick",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runPerCharacterExperiment="runPerCharacterExperiment",e.runTest="runTest",e.formulaRepair="formulaRepair",e.chatGPTQuery="chatGPTQuery",e.columnFormulaSuggestion="columnFormulaSuggestion",e.setCellPrefetch="setCellPrefetch",e.getTranspiledFormulas="getTranspiledFormulas"}(n||(t.RequestKind=n={})),(0,l.staticAssertExtends)(),(0,l.staticAssertExtends)(),t.makeRequester=function(e){var r=function(r){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=n[0],o=n[1],s=n[2];return(0,l.isNone)(a)?Promise.resolve(null):Promise.resolve(e.doRequest(r,a,o,null!=s?s:t.DefaultComputationGroup))}};return{argumentAssistance:r(n.argumentAssistance),chatGPTQuery:r(n.chatGPTQuery),columnFormulaSuggestion:r(n.columnFormulaSuggestion),formulaHighlighting:r(n.formulaHighlighting),formulaRepair:r(n.formulaRepair),functionSuggestion:r(n.functionSuggestion),gotoCtrlClick:r(n.gotoCtrlClick),inCellSuggestion:r(n.inCellSuggestion),runAuthoringExperiment:r(n.runAuthoringExperiment),runExperiment:r(n.runExperiment),runPerCharacterExperiment:r(n.runPerCharacterExperiment),runTest:r(n.runTest),valuePreview:r(n.valuePreview),setCellPrefetch:r(n.setCellPrefetch),getTranspiledFormulas:r(n.getTranspiledFormulas)}},t.makeSyncRequester=function(e){return{formulaHighlighting:function(r,i,a){return(0,l.isNone)(r)?null:e.doSyncRequest(n.formulaHighlighting,r,i,null!=a?a:t.DefaultComputationGroup)}}},t.typedRequest=function(e,t){var r;return u.__generator(this,(function(n){switch(n.label){case 0:return[4,u.__assign({kind:e},t)];case 1:return r=n.sent(),(0,c.assertTrue)("Response kind coincides with request kind",r.kind===e),(0,h.staticTypeHint)(r),[2,r]}}))},t.awaitPromise=function(e){var r;return u.__generator(this,(function(n){switch(n.label){case 0:return[4,{kind:t.ComputationRequestKind.AwaitPromise,promise:e}];case 1:return r=n.sent(),(0,c.assertTrue)("Response kind coincides with request kind",r.kind===t.ComputationRequestKind.AwaitPromise),[2,r.result]}}))},t.delay={kind:t.ComputationRequestKind.Delay},function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepComputation=3]="StepComputation",e[e.StopComputationFrame=4]="StopComputationFrame",e[e.Timeout=5]="Timeout"}(i||(t.SchedulerTimelineQueueMessageKind=i={})),function(e){e.Both="Both",e.SyncOnly="SyncOnly"}(a||(t.SchedulerVersionCompatibility=a={})),(0,l.staticAssertExtends)(),(0,l.staticAssertExtends)(),function(e){e.Superseded="Superseded",e.Timeout="Timeout",e.ConflictResolverEarlyTermination="ConflictResolverEarlyTermination"}(o||(t.FrameExecutionStopReason=o={})),function(e){e.Done="Done",e.Skipped="Skipped",e.Exception="Exception"}(s||(s={}));t.ExecutionStopReason={Unknown:"Unknown",Frame:o,Computation:s};var v=function(){function e(e,t){this.computationType=e,this.computationKind=t,this._attachedComputations=[],this._attachedSyncComputations=[],this._computationFrames=new Map}return e.prototype.computationFrame=function(e){return this._computationFrames.get(e)},Object.defineProperty(e.prototype,"attachedComputations",{get:function(){return u.__spreadArray([],this._attachedComputations,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attachedSyncComputations",{get:function(){return u.__spreadArray([],this._attachedSyncComputations,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numComputations",{get:function(){return this._attachedComputations.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numSyncComputations",{get:function(){return this._attachedSyncComputations.length},enumerable:!1,configurable:!0}),e.prototype.attachComputation=function(e){this._attachedComputations.push(e)},e.prototype.attachSyncComputation=function(e){this._attachedSyncComputations.push(e)},e.prototype.createFrame=function(e,r,n,i,a,o,s,u){var l=new m.ResolvablePromise,c=this.computationKind,d={type:this.computationType,correlationId:e,computationGroup:r,computationInput:i,cache:a,config:o,startTime:s,timeWindow:u,successfulResults:{kind:c,results:[]},resolvable:l,stopReasonRef:new f.Ref(t.ExecutionStopReason.Unknown),numOfComputations:n===p.ExecutionType.Async?this.numComputations:this.numSyncComputations,numFailures:0,numSkippedComputations:0};return this._computationFrames.set(r,d),l},e.prototype.closeFrame=function(e,r,n){var i,a=this.computationFrame(e);if(a){this._computationFrames.delete(e),a.stopReasonRef.value=r,a.resolvable.resolve(r===t.ExecutionStopReason.Frame.Superseded?{kind:"Superseded"}:{kind:"Done",payload:a.successfulResults}),null===(i=a.cache)||void 0===i||i.close();var o=this.computationKind,s=this.numComputations,u=this.numSyncComputations,l=a.correlationId,c=a.startTime,d=a.numSkippedComputations,p=a.successfulResults.results.length,m={correlationId:l,type:this.computationType,computationKind:o,computationGroup:e,numComputations:s,numSyncComputations:u,numSent:p,numSkippedComputations:d,stopReason:r,startTime:c,stopTime:n};g.x10Logger.log({kind:"closeComputationFrame",payload:m})}},e.prototype.stop=function(e,t,r){void 0!==this.computationFrame(e)&&this.closeFrame(e,t,r)},e}();t.ResponseState=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(3);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(3);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOutputFormatUnavailable=t.OutputMessageKind=t.FormulaMode=t.SpecialStyle=t.SpecialFormat=t.SetMessageKind=t.mergeRecalcStatistics=t.RecalcStatisticsMessage=t.emptyRecalcStatistics=t.ComputedCellKind=t.ComputeKind=t.sheetInFilterMode=t.sheetHiddenRows=t.sheetUsedRange=t.createSheetCellSetFromRange=t.sheetCellSet=t.UnavailableKind=void 0;var n,i,a,o,s,u,l,c,d,p=r(0),m=r(30),f=r(4);function g(e,t){return{sheet:e,set:t}}function h(e,t){var r,n;return p.__assign(p.__assign({},e),((r={})[t]=(null!==(n=e[t])&&void 0!==n?n:0)+1,r))}!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.EvalFailure="EvalFailure",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}(n||(t.UnavailableKind=n={})),t.sheetCellSet=g,t.createSheetCellSetFromRange=function(e){return g(e.sheet,(0,m.createCellSetFromRange)(e.range))},t.sheetUsedRange=function(e,t){return{sheet:e,range:t}},t.sheetHiddenRows=function(e,t,r){return{sheet:e,range:t,hidden:r}},t.sheetInFilterMode=function(e,t){return{sheet:e,inFilterMode:t}},function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(i||(t.ComputeKind=i={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(a||(t.ComputedCellKind=a={})),t.emptyRecalcStatistics={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0},function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(o||(t.RecalcStatisticsMessage=o={})),t.mergeRecalcStatistics=function(e,t){switch(t.message){case o.ChangedCell:return p.__assign(p.__assign({},e),{changedCellCount:h(e.changedCellCount,t.cellKind),calculatedCellCount:h(e.calculatedCellCount,t.cellKind)});case o.UnchangedCell:return p.__assign(p.__assign({},e),{calculatedCellCount:h(e.calculatedCellCount,t.cellKind)});case o.ContinueComputation:return p.__assign(p.__assign({},e),{continueCount:e.continueCount+1});case o.StateTimedOut:return p.__assign(p.__assign({},e),{stateTimedOut:!0});case o.EditFinished:return p.__assign(p.__assign({},e),{editFinishedCount:e.editFinishedCount+1});case o.RecalcFinished:return p.__assign(p.__assign({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return(0,f.assertNever)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}},function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(s||(t.SetMessageKind=s={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(u||(t.SpecialFormat=u={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(l||(t.SpecialStyle=l={})),function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"}(c||(t.FormulaMode=c={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.Alert="Alert",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(d||(t.OutputMessageKind=d={})),t.isOutputFormatUnavailable=function(e){return"object"==typeof e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(3);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(1);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(14);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tooWide=t.stringEdit=t.renderedValueToString=t.renderedValue=t.renderInfiniteWidth=t.renderCallback=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.otherEdit=t.numberEdit=t.notValueString=t.notFormatString=t.noFormatPart=t.memoizedRenderCallback=t.isSystemCultureTag=t.isHashesValue=t.isFormatCultureEqual=t.hashesValue=t.fractionOverflow=t.formulaEdit=t.formattedValue=t.formattedUnitString=t.formattedUnitGeneral=t.formattedUnitFlexible=t.formattedUnitBlank=t.evalFormatLocalsGrid=t.dateOverflow=t.createFormatGlobals=t.aggregationError=t.ReasonKind=t.NumberFormatSource=t.NumberFormatInformation=t.IformattedValue=t.HorizontalAlignment=t.CellValueType=t.NamedColor=t.GetTimeKind=t.FormattedUnitKind=t.FormatValueType=t.FormatReasonKind=t.FormatCurrency=t.EditKind=t.CultureTag=t.Clip=t.BidiDate=t.Alignment=void 0;var n=r(38);t.Alignment=n.serviceTypes.Alignment,t.BidiDate=n.serviceTypes.BidiDate,t.Clip=n.serviceTypes.Clip,t.CultureTag=n.serviceTypes.CultureTag,t.EditKind=n.serviceTypes.EditKind,t.FormatCurrency=n.serviceTypes.FormatCurrency,t.FormatReasonKind=n.serviceTypes.FormatReasonKind,t.FormatValueType=n.serviceTypes.FormatValueType,t.FormattedUnitKind=n.serviceTypes.FormattedUnitKind,t.GetTimeKind=n.serviceTypes.GetTimeKind,t.NamedColor=n.serviceTypes.NamedColor,t.CellValueType=n.serviceTypes.CellValueType,t.HorizontalAlignment=n.serviceTypes.HorizontalAlignment,t.IformattedValue=n.serviceTypes.formattedValue,t.NumberFormatInformation=n.serviceTypes.NumberFormatInformation,t.NumberFormatSource=n.serviceTypes.NumberFormatSource,t.ReasonKind=n.serviceTypes.ReasonKind,t.aggregationError=n.serviceTypes.aggregationError,t.createFormatGlobals=n.serviceTypes.createFormatGlobals,t.dateOverflow=n.serviceTypes.dateOverflow,t.evalFormatLocalsGrid=n.serviceTypes.evalFormatLocalsGrid,t.formattedUnitBlank=n.serviceTypes.formattedUnitBlank,t.formattedUnitFlexible=n.serviceTypes.formattedUnitFlexible,t.formattedUnitGeneral=n.serviceTypes.formattedUnitGeneral,t.formattedUnitString=n.serviceTypes.formattedUnitString,t.formattedValue=n.serviceTypes.formattedValue,t.formulaEdit=n.serviceTypes.formulaEdit,t.fractionOverflow=n.serviceTypes.fractionOverflow,t.hashesValue=n.serviceTypes.hashesValue,t.isFormatCultureEqual=n.serviceTypes.isFormatCultureEqual,t.isHashesValue=n.serviceTypes.isHashesValue,t.isSystemCultureTag=n.serviceTypes.isSystemCultureTag,t.memoizedRenderCallback=n.serviceTypes.memoizedRenderCallback,t.noFormatPart=n.serviceTypes.noFormatPart,t.notFormatString=n.serviceTypes.notFormatString,t.notValueString=n.serviceTypes.notValueString,t.numberEdit=n.serviceTypes.numberEdit,t.otherEdit=n.serviceTypes.otherEdit,t.previousFormatFailure=n.serviceTypes.previousFormatFailure,t.FormatLocKind=n.serviceTypes.FormatLocKind,t.formatLocKnownFormat=n.serviceTypes.formatLocKnownFormat,t.formatLocIFormat=n.serviceTypes.formatLocIFormat,t.renderCallback=n.serviceTypes.renderCallback,t.renderInfiniteWidth=n.serviceTypes.renderInfiniteWidth,t.renderedValue=n.serviceTypes.renderedValue,t.renderedValueToString=n.serviceTypes.renderedValueToString,t.stringEdit=n.serviceTypes.stringEdit,t.tooWide=n.serviceTypes.tooWide},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var n=r(343);t.utils=n;var i=r(149);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});var a=r(344);t.browserSupport=a;var o=r(345);t.perfWatch=o;var s=r(346);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});var u=r(347);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return u.TelemetryCollector}});var l=r(348);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return l.getNewGuid}});var c=r(349);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return c.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return c.TextAreaInputMode}});var d=r(350);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return d.replaceChildren}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(1);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(1);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayLift=t.makeStrict=t.gridRangeAnchorHash=t.broadcastWriteOper=t.isEmptyStringOper=t.emptyStringOper=t.traceErrorOper=t.writeOperType=t.singleWriteOperType=void 0;var n=r(45),i=r(8),a=r(7),o=r(19),s=r(25),u=r(28),l=r(18),c=r(10),d=r(118);t.singleWriteOperType=l.OperKind.Number|l.OperKind.String|l.OperKind.Boolean|l.OperKind.Error|l.OperKind.Rich,t.writeOperType=t.singleWriteOperType|l.OperKind.Array,t.traceErrorOper=function(e,t,r){var n="".concat(e,": generated Excel error, type ").concat(t,"; ").concat(r);c.ulsLogger.ULS.traceTag(596120270,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Verbose,n)},t.emptyStringOper=(0,i.stringOper)(""),t.isEmptyStringOper=function(e){return(0,a.isStringOper)(e)&&""===e.value},t.broadcastWriteOper=function(e,t,r){var o=(0,a.isArrayOper)(r)?(0,n.broadcastArray)(r.rows,r.cols,e,t,r.opers,i.naErrorOper):(0,n.constantArray)(e,t,r);return(0,i.arrayOper)(e,t,o)},t.gridRangeAnchorHash=function(e){return o.sheetCols*e.row+e.col},t.makeStrict=function(e){var t=function(e){return e&~(l.OperKind.Array|l.OperKind.Range)};return(0,l.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)},t.arrayLift=function(e,t,r,o){for(var d=0,p=0,m=0;m<o.length;m+=1){var f=o[m];(0,a.isArrayOper)(f)&&0==((0,a.getArgType)(t,m,o.length)&l.OperKind.Array)?(d=(0,s.fastMax)(d,f.rows),p=(0,s.fastMax)(p,f.cols)):(d=(0,s.fastMax)(d,1),p=(0,s.fastMax)(p,1))}var g=o.map((function(r,o,s){return function(e,t,r,a,o){switch(a.kind){case l.OperKind.Missing:case l.OperKind.Blank:return(0,n.constantArray2D)(t,r,e.zero);case l.OperKind.Array:return 0!=(o&l.OperKind.Array)?(0,n.constantArray2D)(t,r,a):(0,n.broadcastArray2D)(t,r,new n.StrictArray2D(a.rows,a.cols,a.opers),i.naErrorOper);case l.OperKind.Range:default:return(0,n.constantArray2D)(t,r,a)}}(e.mathpack,d,p,r,(0,a.getArgType)(t,o,s.length))}));return(0,u.machineCall)(new u.ArrayMachine(e,d,p,(function(e,t){return r(g.map((function(r){return r.get(e,t)})))}),(function(t){var r=e.coerceOper((0,u.refToVal)(e,t,!0),u.readOperType);return(0,c.assertTrue)("calc.runtime.arrayLift",!(0,a.isMissingOper)(r)&&!(0,a.isRangeOper)(r)),(0,a.isArrayOper)(r)?r.opers[0][0]:r})))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refToVal=t.ArrayMachine=t.earlyReturn=t.EarlyReturnKind=t.ThenMachine=t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=void 0;var n,i=r(0),a=r(8),o=r(262),s=r(7),u=r(26),l=r(18);function c(e){return e.kind===n.MachineCall}i.__exportStar(r(262),t),t.singleReadOperType=l.OperKind.Number|l.OperKind.String|l.OperKind.Boolean|l.OperKind.Error|l.OperKind.Blank|l.OperKind.Rich,t.readOperType=t.singleReadOperType|l.OperKind.Array,function(e){e.MachineCall="MachineCall"}(n||(t.MachineCallKind=n={})),t.machineCall=function(e){return{kind:n.MachineCall,machine:e}},t.isMachineCall=c;var d,p=function(){function e(e,t,r){this.context=e,this.f1=t,this.f2=r,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}return e.prototype.next=function(){var e;try{if(void 0===this.oper1){var t=this.f1();if(c(t))return(0,o.callMachineTransition)(t.machine,this);this.oper1=t}if(void 0===this.oper2){var r=this.f2(this.oper1);if(c(r))return(0,o.callMachineTransition)(r.machine,this);this.oper2=r}return(0,u.success)(this.oper2)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:(0,u.failure)((0,u.javaScriptError)(t))}},e.prototype.receiveResult=function(e){return(0,u.isSuccess)(e)?(void 0===this.oper1?this.oper1=e.value:void 0===this.oper2&&(this.oper2=e.value),o.nextTransition):e},e}();t.ThenMachine=p,function(e){e.EarlyReturn="EarlyReturn"}(d||(t.EarlyReturnKind=d={})),t.earlyReturn=function(e){return{kind:d.EarlyReturn,value:e}};var m=function(){function e(e,t,r,n,i){this.context=e,this.rows=t,this.cols=r,this.func=n,this.coercer=i,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.coercer(this.toDeref,this.opers.length,this.row.length);if(t.kind===d.EarlyReturn)return t.value;this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,u.success)((0,a.arrayOper)(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return c(r)?(0,o.callMachineTransition)(r.machine,this):(this.toDeref=r,o.nextTransition)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:(0,u.failure)((0,u.javaScriptError)(t))}},e.prototype.receiveResult=function(e){return(0,u.isSuccess)(e)?(this.toDeref=e.value,o.nextTransition):e},e}();t.ArrayMachine=m,t.refToVal=function(e,t,r){if(!(0,s.isRangeOper)(t))return t;if(!(0,s.isSheetIndex)(t.sheets))return a.valueErrorOper;if(!r)return 1===t.ranges.length&&(0,s.isGridCell)(t.ranges[0])?e.dereferenceOper(t,l.SignatureType.All&~l.OperKind.Range):e.dereferenceOper(t,l.OperKind.Array);var n=e.dereferenceOper(t,l.SignatureType.All&~(l.OperKind.Range|l.OperKind.Array));return(0,s.isArrayOper)(n)?a.naErrorOper:n}},function(e,t,r){"use strict";var n,i,a,o,s,u,l,c;Object.defineProperty(t,"__esModule",{value:!0}),t.ProcessNonFormulaCells=t.getFormulaContent=t.isFormulaRequest=t.pluginGroupMap=t.pluginGroupOptInDefault=t.registerPluginFactory=t.getPluginFactory=t.pluginFactoryKindMap=void 0;var d=r(6),p=r(4),m=r(12),f=r(2),g=r(2),h=r(17),v=r(22),S=r(47),y=r(48);t.pluginFactoryKindMap=((n={})[d.PluginFactoryName.TestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.PythonTestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.AutocompletePlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.AutocompleteRangeSuggestionPlugin]=h.RequestKind.inCellSuggestion,n[d.PluginFactoryName.DragPlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.ConfigTestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.FeatureGateTestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.ChangeGateTestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.ArgumentAssistancePlugin]=h.RequestKind.argumentAssistance,n[d.PluginFactoryName.FormulaRepairShadowEvalPlugin]=h.RequestKind.runAuthoringExperiment,n[d.PluginFactoryName.FormulaCollectionPlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.DNMTraceTagTestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.AutocompleteWrapperPlugin]=h.RequestKind.runPerCharacterExperiment,n[d.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]=h.RequestKind.runAuthoringExperiment,n[d.PluginFactoryName.ParenthesesCouplingPlugin]=h.RequestKind.formulaHighlighting,n[d.PluginFactoryName.ColoredReferencesPlugin]=h.RequestKind.formulaHighlighting,n[d.PluginFactoryName.SlowTestPlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.EvalOnCloneTestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.EvalFormulaTestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.AutocompleteFunctionPlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.AutocompleteEnumPlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.AutocompleteLetPlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.AutocompleteRichValuePlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.AutocompleteNamedObjectsPlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.ParserPerformanceMeasurements]=h.RequestKind.runExperiment,n[d.PluginFactoryName.AutocompleteTableHeadersPlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.PythonAutocompletePlugin]=h.RequestKind.functionSuggestion,n[d.PluginFactoryName.ValuePreviewPlugin]=h.RequestKind.valuePreview,n[d.PluginFactoryName.GotoCtrlClickPlugin]=h.RequestKind.gotoCtrlClick,n[d.PluginFactoryName.SyntaxErrorsPlugin]=h.RequestKind.formulaRepair,n[d.PluginFactoryName.ChatGPTPlugin]=h.RequestKind.chatGPTQuery,n[d.PluginFactoryName.EventsTestPlugin]=h.RequestKind.runTest,n[d.PluginFactoryName.FormulaByExamplePlugin]=h.RequestKind.columnFormulaSuggestion,n[d.PluginFactoryName.SetCellPrefetchPlugin]=h.RequestKind.setCellPrefetch,n[d.PluginFactoryName.FormulaTranspilerPlugin]=h.RequestKind.getTranspiledFormulas,n),(0,g.staticAssertExtends)(),(0,g.staticAssertExtends)(),(0,g.staticAssertExtends)();(i={})[d.PluginFactoryName.ParenthesesCouplingPlugin]=h.SchedulerVersionCompatibility.SyncOnly,i[d.PluginFactoryName.ColoredReferencesPlugin]=h.SchedulerVersionCompatibility.SyncOnly;(0,g.staticAssertExtends)(),(0,f.staticAssertSame)(),(0,g.staticAssertExtends)();var F=(0,g.makeStringMap)();t.getPluginFactory=function(e){var t=F[e];if(!t){var r=S.x10Logger.formatLogMessage("getPluginFactory",{description:"".concat(d.PluginFactoryName[e]," has not been registered")});throw p.ulsLogger.ULS.traceTag(557056858,m.LogCategory.msoulscat_ES_EWAJS,m.TraceLevel.Error,r),new Error(r)}return t},t.registerPluginFactory=function(e){var t=e.factoryName,r=F[t];if(void 0!==r&&r!==e){var n=S.x10Logger.formatLogMessage("registerPluginFactory",{description:"".concat(d.PluginFactoryName[t]," is already registered")});if(p.ulsLogger.ULS.traceTag(557056859,m.LogCategory.msoulscat_ES_EWAJS,m.TraceLevel.Error,n),!(0,v.getTypedFeatureGate)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(n)}F[t]=e,S.x10Logger.log({kind:"registerPluginFactory",payload:{factoryName:t}})},t.pluginGroupOptInDefault=((a={})[d.PluginGroup.Excel]=!0,a[d.PluginGroup.Python]=!1,a),(0,g.staticAssertExtends)(),t.pluginGroupMap=((o={})[d.PluginGroup.Excel]=((s={})[d.PluginFactoryName.PythonTestPlugin]=!1,s[d.PluginFactoryName.PythonAutocompletePlugin]=!1,s),o[d.PluginGroup.Python]=((u={})[d.PluginFactoryName.PythonTestPlugin]=!0,u[d.PluginFactoryName.PythonAutocompletePlugin]=!0,u),o),f.staticAssertSame;var C=((l={})[h.RequestKind.functionSuggestion]="content",l[h.RequestKind.inCellSuggestion]="content",l[h.RequestKind.formulaHighlighting]="content",l[h.RequestKind.argumentAssistance]="content",l[h.RequestKind.valuePreview]="text",l[h.RequestKind.runAuthoringExperiment]="content",l[h.RequestKind.runPerCharacterExperiment]="content",l[h.RequestKind.formulaRepair]="formula",l[h.RequestKind.gotoCtrlClick]="text",l[h.RequestKind.columnFormulaSuggestion]=void 0,l[h.RequestKind.setCellPrefetch]=void 0,l[h.RequestKind.runExperiment]=void 0,l[h.RequestKind.runTest]=void 0,l[h.RequestKind.chatGPTQuery]=void 0,l[h.RequestKind.getTranspiledFormulas]=void 0,l);t.isFormulaRequest=function(e){return void 0!==C[e]},t.getFormulaContent=function(e){var t=C[e[0]];(0,y.staticTypeHint)(t);var r=e[1][t];return(0,y.staticTypeHint)(r),r},t.ProcessNonFormulaCells=((c={})[d.PluginFactoryName.TestPlugin]=!0,c[d.PluginFactoryName.ParserPerformanceMeasurements]=!0,c[d.PluginFactoryName.ConfigTestPlugin]=!0,c[d.PluginFactoryName.FeatureGateTestPlugin]=!0,c[d.PluginFactoryName.DNMTraceTagTestPlugin]=!0,c[d.PluginFactoryName.ChangeGateTestPlugin]=!0,c[d.PluginFactoryName.SlowTestPlugin]=!0,c[d.PluginFactoryName.EvalOnCloneTestPlugin]=!0,c[d.PluginFactoryName.EvalFormulaTestPlugin]=!0,c[d.PluginFactoryName.PythonTestPlugin]=!0,c[d.PluginFactoryName.ChatGPTPlugin]=!0,c[d.PluginFactoryName.EventsTestPlugin]=!0,c[d.PluginFactoryName.FormulaByExamplePlugin]=!0,c[d.PluginFactoryName.SetCellPrefetchPlugin]=!0,c[d.PluginFactoryName.FormulaTranspilerPlugin]=!0,c)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateAvailabilitySet=t.forEachCellInSet=t.forEachRangeInSet=t.forEachCol=t.forEachRow=t.availableAllProduct=t.availableReadProduct=t.availableSetProduct=t.cellSetBounds=t.createCellSetFromRange=t.bspFactory=t.availabilityOperations=t.anyAvailability=t.AvailabilityKind=void 0;var n,i=r(15),a=r(11),o=r(455),s=r(69),u=r(456),l=r(39);!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(n||(t.AvailabilityKind=n={})),t.anyAvailability=[n.AvailableSet,n.AvailableRead+1];var c=[0,i.sheetRows],d=[0,i.sheetCols];t.availabilityOperations=(0,u.boundedParetoSetOperations)(1,t.anyAvailability[0]+1,t.anyAvailability[1],t.anyAvailability,"Availability operations, alpha = 1");var p=(0,u.boundedParetoSetOperations)(.2,c[0]+1,c[1],c,"Row operations, alpha = 0.2"),m=(0,u.boundedParetoSetOperations)(.35,d[0]+1,d[1],d,"Col operations, alpha = 0.35"),f={availability:t.availabilityOperations,row:p,col:m};function g(e,t){return e!==s.dense?(0,s.forEachKey)(e,t):t(f.row.top)}function h(e,t){return e!==s.dense?(0,s.forEachKey)(e,t):t(f.col.top)}function v(e,t){return(0,l.forEachProduct)(e,(function(e){return g(e.row,(function(r){var n=r[0],a=r[1];return h(e.col,(function(e){var r=e[0],o=e[1];return t((0,i.gridRange)(n,r,a-n,o-r))}))}))}),"row","col")}t.bspFactory={availability:(0,s.createFromKey)(f.availability),row:(0,s.createFromKey)(f.row),col:(0,s.createFromKey)(f.col)},t.createCellSetFromRange=function(e){return(0,l.createFromProduct)({row:t.bspFactory.row([e.row,e.row+e.rows]),col:t.bspFactory.col([e.col,e.col+e.cols])})},t.cellSetBounds=function(e){if(e!==s.empty){var t,r,n=e===s.dense?void 0:e.root.bounds.row,a=e===s.dense?void 0:e.root.bounds.col,u=void 0===n?f.row.top:(t=(0,s.fromUntyped)(f.row,n),r=[],g(t,(function(e){return r.push(e),!0})),r.reduce(o.ivlJoin)),l=u[0],c=u[1],d=void 0===a?f.col.top:function(e){var t=[];return h(e,(function(e){return t.push(e),!0})),t.reduce(o.ivlJoin)}((0,s.fromUntyped)(f.col,a)),p=d[0],m=d[1];return(0,i.gridRange)(l,p,c-l,m-p)}},t.availableSetProduct=(0,l.createFromProduct)({availability:t.bspFactory.availability([n.AvailableSet,n.AvailableSet+1])}),t.availableReadProduct=(0,l.createFromProduct)({availability:t.bspFactory.availability([n.AvailableRead,n.AvailableRead+1])}),t.availableAllProduct=(0,l.createFromProduct)({availability:t.bspFactory.availability([n.AvailableSet,n.AvailableRead+1])}),t.forEachRow=g,t.forEachCol=h,t.forEachRangeInSet=v,t.forEachCellInSet=function(e,t){return v(e,(function(e){return(0,a.forEachCellInRange)(e,t)}))},t.translateAvailabilitySet=function(e,r,n){var i=s.empty;return(0,l.forEachProduct)(e,(function(e){var a=s.empty;g(e.row,(function(e){var n=e[0],i=e[1];return a=(0,s.union)(a,t.bspFactory.row([n+r,i+r])),!0}));var o=s.empty;h(e.col,(function(e){var r=e[0],i=e[1];return o=(0,s.union)(o,t.bspFactory.col([r+n,i+n])),!0}));var u=(0,l.createFromProduct)({row:a,col:o,availability:e.availability});return i=(0,l.unionProduct)(i,u),!0}),"row","col","availability"),i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoCompletePluginsThread=t.workerThreadInitialized=t.workerThreadSpread=t.dynamicPluginLoaderCreated=t.schedulerWithTableIntelligenceServiceAttached=t.schedulerWithRecalcServiceAttached=t.scriptLoaderPromise=t.FormulaAuthoringStringsOnMainThread=void 0;var n=r(0),i=r(97),a=r(13),o=r(121),s=r(22),u=r(6);t.FormulaAuthoringStringsOnMainThread=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,t.dynamicPluginLoaderCreated.getValue()];case 1:return[4,e.sent().loadPluginScript("formula-authoring-strings",!0)];case 2:return e.sent(),[2]}}))}))})),t.scriptLoaderPromise=new o.ResolvablePromise,t.schedulerWithRecalcServiceAttached=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(r){switch(r.label){case 0:return e=i.PluginSchedulerSingleton.instance(),l.getValue()?[4,t.FormulaAuthoringStringsOnMainThread.getValue()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,e.recalcServiceAttached()];case 3:return r.sent(),[2,e]}}))}))})),t.schedulerWithTableIntelligenceServiceAttached=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,(e=i.PluginSchedulerSingleton.instance()).tableIntelligenceServiceAttached()];case 1:return t.sent(),[2,e]}}))}))})),t.dynamicPluginLoaderCreated=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,t.scriptLoaderPromise];case 1:return e=r.sent(),[2,(0,i.createDynamicPluginLoader)(e)]}}))}))})),t.workerThreadSpread=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,t.dynamicPluginLoaderCreated.getValue()];case 1:return[2,e.sent().createPluginThread("worker")]}}))}))})),t.workerThreadInitialized=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,t.workerThreadSpread.getValue()];case 1:return e.sent(),[2]}}))}))})),t.autoCompletePluginsThread=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(r){switch(r.label){case 0:return(0,s.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteOnMainThread")?[4,t.dynamicPluginLoaderCreated.getValue()]:[3,2];case 1:return e=r.sent(),[3,4];case 2:return[4,t.workerThreadSpread.getValue()];case 3:e=r.sent(),r.label=4;case 4:return[2,e]}}))}))}));var l=new a.ResettableLazy((function(){var e=i.PluginSchedulerSingleton.instance();return!e.isSchedulerFeatureEnabled(u.SchedulerFeature.SimpleAutoComplete)&&e.isSchedulerFeatureEnabled(u.SchedulerFeature.ArgumentAssistance)}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(1);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=t.SyntaxFeature=void 0,t.badSequenceNode=t.badCharsNode=t.varNode=t.identNode=t.missingNode=t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.contextNameNode=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=t.nameNode=t.missingRef=void 0;var n=r(3);t.SyntaxFeature=n.formulaModule.SyntaxFeature,t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.singleLineComment=n.formulaModule.singleLineComment,t.multiLineComment=n.formulaModule.multiLineComment,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.contextNameNode=n.formulaModule.contextNameNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound,t.missingNode=n.formulaModule.missingNode,t.identNode=n.formulaModule.identNode,t.varNode=n.formulaModule.varNode,t.badCharsNode=n.formulaModule.badCharsNode,t.badSequenceNode=n.formulaModule.badSequenceNode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(3);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(1);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.isVolatileFunc=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(3);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.isVolatileFunc=n.signature.isVolatileFunc,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.tokenizeFormulaModule=t.token=t.parseStructRefModule=t.parserState=t.parserService=t.parseResultHelperModule=t.parseRefModule=t.parser=t.parseQualifierModule=t.parseOperators=t.parseLiteralModule=t.parseFormulaModule=t.parseFieldRefModule=t.parseCommon=t.parseServiceTypes=t.analyzeServiceTypes=t.diagnostics=t.checker=t.autocorrect=t.analyzeService=t.PackageName=void 0;var n=r(0);t.PackageName="excel-online-calc-syntax",t.analyzeService=n.__importStar(r(408)),t.autocorrect=n.__importStar(r(239)),t.checker=n.__importStar(r(237)),t.diagnostics=n.__importStar(r(164)),t.analyzeServiceTypes=n.__importStar(r(242)),t.parseServiceTypes=n.__importStar(r(243)),t.parseCommon=n.__importStar(r(58)),t.parseFieldRefModule=n.__importStar(r(167)),t.parseFormulaModule=n.__importStar(r(244)),t.parseLiteralModule=n.__importStar(r(247)),t.parseOperators=n.__importStar(r(91)),t.parseQualifierModule=n.__importStar(r(246)),t.parser=n.__importStar(r(63)),t.parseRefModule=n.__importStar(r(245)),t.parseResultHelperModule=n.__importStar(r(413)),t.parserService=n.__importStar(r(414)),t.parserState=n.__importStar(r(73)),t.parseStructRefModule=n.__importStar(r(248)),t.token=n.__importStar(r(52)),t.tokenizeFormulaModule=n.__importStar(r(249)),t.util=n.__importStar(r(250))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.unicode=t.testData=t.serviceTypes=t.ribbonFormat=t.render=t.parsedate=t.parseconst=t.parse=t.localeData=t.knownFormat=t.impl=t.formulaBar=t.formatService=t.eval=t.edit=t.PackageName=void 0;var n=r(0);t.PackageName="excel-online-calc-numfmt",t.edit=n.__importStar(r(170)),t.eval=n.__importStar(r(253)),t.formatService=n.__importStar(r(422)),t.formulaBar=n.__importStar(r(257)),t.impl=n.__importStar(r(255)),t.knownFormat=n.__importStar(r(113)),t.localeData=n.__importStar(r(256)),t.parse=n.__importStar(r(259)),t.parseconst=n.__importStar(r(171)),t.parsedate=n.__importStar(r(174)),t.render=n.__importStar(r(176)),t.ribbonFormat=n.__importStar(r(425)),t.serviceTypes=n.__importStar(r(64)),t.testData=n.__importStar(r(426)),t.unicode=n.__importStar(r(134)),t.util=n.__importStar(r(258))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;var n=r(1);t.createFromProduct=n.productSet.createFromProduct,t.project=n.productSet.project,t.unionProduct=n.productSet.unionProduct,t.intersectProduct=n.productSet.intersectProduct,t.exceptProduct=n.productSet.exceptProduct,t.compareProduct=n.productSet.compareProduct,t.meetsProduct=n.productSet.meetsProduct,t.complementProduct=n.productSet.complementProduct,t.symmetricDiffProduct=n.productSet.symmetricDiffProduct,t.getSubspaces=n.productSet.getSubspaces,t.forEachProduct=n.productSet.forEachProduct,t.getSubspaceCount=n.productSet.getSubspaceCount,t.ProductSetSerializer=n.productSet.ProductSetSerializer,t.productSetSerializer=n.productSet.productSetSerializer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.varNode=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaRootAnnotation=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.multiLineComment=t.singleLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.appHeadNameAnnotation=t.AnnotationKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.getDepthUpperBound=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.contextNameNode=t.headNamePart=t.flattenNameParts=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=void 0;var n,i,a,o,s,u,l,c,d,p,m,f,g=r(0),h=r(42),v=r(32),S=r(32);function y(e){return void 0!==e.kind}function F(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r],a=i.arg,o=i.index;(0,h.assertIndex)("calc.lang.flattenNumberedArgs: idx",o,e.length),(0,h.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[o]),t[o]=a}return t}function C(e,t,r){return F((0,S.safeConcat)(g.__spreadArray(g.__spreadArray([],void 0===t?[]:[t],!0),r,!0),e.map((function(e){return[e.name,e.binder]}))))}function R(e,t){return(0,h.assertNatural)("calc.lang.indexedArg: index",t),{arg:e,index:t}}function b(e,t){return{name:e,binder:t}}function E(e,t,r){return void 0===r&&(r=[]),F(g.__spreadArray(g.__spreadArray(g.__spreadArray([],e.map((function(e){return e.name})),!0),void 0===t?[]:[t],!0),r,!0))}function P(e){return{name:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(n||(t.RefStyle=n={})),function(e){e.Comments="Comments",e.Statements="Statements"}(i||(t.SyntaxFeature=i={})),function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"}(a||(t.QualifierKind=a={})),function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"}(o||(t.CellRefKind=o={})),function(e){e.Abs="Abs",e.Rel="Rel"}(s||(t.PosKind=s={})),function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"}(u||(t.CommentKind=u={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(l||(t.AnnotationKind=l={})),t.appHeadNameAnnotation={kind:l.AppHeadName},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Missing="Missing",e.BadChars="BadChars",e.BadSequence="BadSequence",e.Operator="Operator",e.WSF="WSF",e.Var="Var",e.Param="Param",e.ContextName="ContextName",e.Ident="Ident",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"}(c||(t.NodeKind=c={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(d||(t.NamePartKind=d={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(p||(t.SpecialRefId=p={})),function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"}(m||(t.StructRefKind=m={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.StructRef="StructRef",e.FieldRef="FieldRef"}(f||(t.BadType=f={})),t.errorQualifier=function(e){return void 0===e&&(e=0),{kind:a.Error,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.relativeQualifier=function(e){return void 0===e&&(e=0),{kind:a.Relative,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}},t.documentQualifier=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:a.Document,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,document:e,path:t}},t.sheetQualifier=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:a.Sheet,isQuoted:r,isClosed:!0,isTerminated:!0,label:n,sheet:e,document:t}},t.identQualifier=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:a.Ident,isQuoted:t,isClosed:!0,isTerminated:!0,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,n,i){return void 0===n&&(n=!1),void 0===i&&(i=0),{kind:a.SheetRange,isQuoted:n,isClosed:!0,isTerminated:!0,label:i,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t,r,n,i){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=!0),void 0===i&&(i=0),{kind:a.Bad,isQuoted:t,isClosed:r,isTerminated:n,label:i,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e){return void 0===e&&(e=0),{kind:o.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:o.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r){void 0===r&&(r=0);var n=e.isBracketed||t.isBracketed;return{kind:o.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:o.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:o.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:o.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:k(e)}},t.singleLineComment=function(e,t){return void 0===t&&(t=0),{kind:u.SingleLine,label:t,chars:e,isClosed:!0}},t.multiLineComment=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:u.MultiLine,label:r,chars:e,isClosed:t}},t.formulaSpan=function(e,t,r,n,i,a){return(0,h.assertNatural)("calc.lang.formulaSpan",e),(0,h.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,h.assertFalse)("calc.lang.formulaSpan: expected end >= ".concat(e,"; given ").concat(t)),{start:e,end:t,pre:r,post:n,preComments:i,postComments:a}},t.localNameUseAnnotation=function(e,t,r){return{kind:l.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r){return void 0===r&&(r=[]),{kind:l.LocalNameDecl,name:e,whole:t,uses:r}},t.formulaRootAnnotation=function(e,t){return{kind:l.FormulaRoot,contextNames:e,syntaxFeatures:t}},t.literalNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:c.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:c.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.App,label:n,head:e,args:t,isClosed:r}},t.flattenLetArgs=C,t.indexedArg=R,t.varNode=function(e,t){return void 0===t&&(t=0),{kind:c.Var,label:t,name:e,wholeName:e.whole}},t.letVar=b,t.letNode=function(e,t,r,n,i,a){void 0===n&&(n=[]),void 0===i&&(i=!0),void 0===a&&(a=0);var o=t.map((function(e,t){return r=e,Array.isArray(r)?b(R(e[0],2*t),R(e[1],2*t+1)):e;var r})).sort((function(e,t){return e.name.index-t.name.index})),s=void 0!==r&&y(r)?R(r,2*o.length):r,u=C(o,s,n);return{kind:c.Let,label:a,head:e,args:u,isClosed:i,vars:o,body:s,badArgs:n}},t.flattenLambdaArgs=E,t.paramName=function(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.ParamName,label:n,name:e,isBracketed:t,isClosed:r}},t.paramDefault=function(e,t){return void 0===t&&(t=0),{kind:c.ParamDef,label:t,rhs:e}},t.paramNode=function(e,t,r){return void 0===r&&(r=0),{kind:c.Param,label:r,name:e,wholeName:e.name.kind===c.Ident?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}},t.lambdaParam=P,t.lambdaNode=function(e,t,r,n,i,a){void 0===n&&(n=[]),void 0===i&&(i=!0),void 0===a&&(a=0);var o=t.map((function(e,t){return y(e)?P(R(e,t)):e})).sort((function(e,t){return e.name.index-t.name.index})),s=void 0!==r&&y(r)?R(r,o.length):r,u=E(o,s,n);return{kind:c.Lambda,label:a,head:e,args:u,isClosed:i,params:o,body:s,badArgs:n}},t.operatorNode=function(e,t){return void 0===t&&(t=0),{kind:c.Operator,label:t,id:e}},t.wsfNode=function(e,t,r){return void 0===r&&(r=0),{kind:c.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:c.Paren,label:r,node:e,isClosed:t}},t.nameNode=function(e,t,r){return void 0===r&&(r=0),{kind:c.Name,label:r,whole:e.asWhole,parts:e,qualifier:t}},t.identNamePart=function(e,t,r,n){return void 0===t&&(t=!0),void 0===r&&(r=0),void 0===n&&(n=0),{kind:d.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}},t.cellRefNamePart=function(e,t,r,n){return void 0===r&&(r=0),void 0===n&&(n=0),{kind:d.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r,n,i){return void 0===r&&(r=!0),void 0===n&&(n=0),void 0===i&&(i=0),(0,h.assertTrue)("calc.lang.fieldRefNamePart",t.isClosed&&!t.isBracketed),{kind:d.FieldRefNamePart,label:n,qualifiedLabel:i,asWhole:e.asWhole+"."+(t.field.kind===c.Ident?t.field.whole:t.field.chars),canDenoteNamedObject:r,lhs:e,rhs:t}},t.flattenNameParts=function(e){for(var t=[e],r=t[0];r.kind===d.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){for(var t=e;t.kind===d.FieldRefNamePart;)t=t.lhs;return t},t.contextNameNode=function(e,t){return void 0===t&&(t=0),{kind:c.ContextName,label:t,whole:e}},t.cellRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:c.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:c.FieldRef,label:r,lhs:e,rhs:t}},t.fieldRef=function(e,t,r,n,i){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=!1),void 0===i&&(i=0),{kind:c.FieldRefRHS,label:i,field:e,isBracketed:t,isClosed:r,shouldBeBracketed:n}},t.structRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:c.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:m.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:m.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r){return void 0===r&&(r=0),{kind:m.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t){var r;void 0===t&&(t=0);for(var n=((r={})[p.All]=!1,r[p.Data]=!1,r[p.Headers]=!1,r[p.Totals]=!1,r[p.ThisRow]=!1,r),i=[],a=0,o=e;a<o.length;a++){var s=o[a];switch(s.kind){case m.SpecialRef:n[s.id]=!0;break;case m.ColumnRef:case m.RangeOpRef:i.push(s)}}return{kind:m.CommaOpRef,label:t,refs:e,specialRefs:n,columnRefs:i}},t.thisRowOpRef=function(e,t){return void 0===t&&(t=0),{kind:m.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e){return void 0===e&&(e=0),{kind:m.MissingRef,label:e}},t.badRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:m.BadRef,chars:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:c.StructRefRHS,label:r,isClosed:t,innerRef:e}},t.identNode=function(e,t){return void 0===t&&(t=0),{kind:c.Ident,label:t,whole:e}},t.missingNode=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=0),{kind:c.Missing,label:t,chars:e}},t.badCharsNode=function(e,t,r){return void 0===r&&(r=0),{kind:c.BadChars,label:r,type:e,chars:t}},t.badSequenceNode=function(e,t,r){return void 0===r&&(r=0),{kind:c.BadSequence,label:r,type:e,contents:t}};function k(e){return function e(t,r){if(r>50)return 1/0;switch(t.kind){case c.Array:for(var n=0,i=0,a=t.nodes;i<a.length;i++)for(var o=0,s=a[i];o<s.length;o++){var u=s[o];n=(0,v.fastMax)(n,e(u,r+1))}return n+1;case c.Param:return void 0===t.def?1:e(t.def.rhs,r+1)+1;case c.Let:case c.Lambda:case c.App:n=e(t.head,r+1);for(var l=0,d=t.args;l<d.length;l++){var p=d[l];n=(0,v.fastMax)(n,e(p,r+1))}return n+1;case c.Paren:return e(t.node,r+1)+1;case c.FieldRef:return e(t.lhs,r+1)+1;case c.Var:case c.Name:case c.CellRef:case c.StructRef:case c.Literal:case c.Operator:case c.WSF:case c.Missing:case c.BadChars:return 1;case c.BadSequence:n=0;for(var m=0,f=t.contents;m<f.length;m++){var g=f[m];n=(0,v.fastMax)(n,e(g,r+1))}return n+1;default:return(0,h.assertNever)("calc.lang.getDepthUpperBound",t)}}(e,0)}t.getDepthUpperBound=k},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(1);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(1);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(1);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.breaked=t.paused=t.limitExceeded=t.previousNameFailure=t.previousFailure=t.cellCycle=t.nameCycle=t.evalLocals=t.evalGlobals=t.userDefinedFunc=t.stopped=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.illFormedFormula=t.LimitKind=t.StepAction=t.RuntimePositionKind=t.stackValue=t.Interrupt=t.CellKind=t.interval=t.compileLocalsName=t.compileLocalsGrid=t.createCompileGlobals=t.ReasonKind=void 0;var n,i,a,o,s,u,l=r(0),c=r(10),d=r(25),p=r(7),m=r(19),f=r(117),g=r(26),h=r(179);!function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(n||(n={})),t.ReasonKind=l.__assign(l.__assign(l.__assign(l.__assign({},p.ReasonKind),n),f.FormatReasonKind),h.ResolveReasonKind),t.createCompileGlobals=function(e){return{config:e}},t.compileLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,g.success)(t),allowUnqualifiedCell:!0,emitStepInfo:!1}},t.compileLocalsName=function(e,t){return{config:null!=t?t:void 0,lexicalKind:m.LexicalKind.NameManager,originGridCell:(0,g.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}},t.interval=(0,d.typedInstanceCreator)()((function(e,t){return(0,c.assertPositiveInteger)("calc.runtime.interval: end",t),(0,c.assertIndex)("calc.runtime.interval: start",e,t),{start:e,end:t}})),function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(i||(t.CellKind=i={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(a||(t.Interrupt=a={})),t.stackValue=(0,d.typedInstanceCreator)()((function(e,t){return{label:e,value:t}})),function(e){e.LetVar="LetVar",e.LambdaRoot="LambdaRoot",e.LambdaParam="LambdaParam",e.EtaLambdaBody="EtaLambdaBody",e.FormulaRoot="FormulaRoot",e.FirstOrderFunc="FirstOrderFunc"}(o||(t.RuntimePositionKind=o={})),function(e){e.Continue="Continue",e.Break="Break"}(s||(t.StepAction=s={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(u||(t.LimitKind=u={})),t.illFormedFormula=function(e,r,n){return{kind:t.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:n}},t.finalValue=function(e){return{kind:i.FinalValue,oper:e}},t.pendingValue=function(e){return{kind:i.PendingValue,anchor:e}},t.cellWellFormedFormula=function(e,t){return{source:e,formula:t}},t.cellFormula=function(e,t){return{source:e,formula:t}},t.stopped={kind:t.ReasonKind.Stopped},t.userDefinedFunc=function(e,t){return{arity:e,func:t}},t.evalGlobals=function(e,t,r,n,i,o,s,u,l,c,d,m,f,h,v,S,y,F,C,R,b,E,P,k,T,A,N,_,I,O){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:i,getNameLoc:o,getUserDefinedFuncLoc:s,getCellValue:u,getCellValues:l,getWorksheetFunc:c,getUserDefinedFunc:d,getNameFormula:m,getCellFormula:f,getUsedRange:h,interruptToken:[a.Continue],tryGetHiddenRows:v,tryGetHiddenCols:S,isInFilterMode:y,getKnownFormat:F,getIformat:C,getFormatString:R,getRandom:b,getTime:E,schedulerConfig:null!=I?I:{},limits:null!=O?O:{},setCellValue:P,setCellValues:k,setCellFailure:T,getContainingTable:A,getStructRefColumn:N,getStructRefSpecialRef:_,getIntersectingTables:function(){return(0,g.failure)((0,p.notImplemented)(["getIntersectingTables"]))}}},t.evalLocals=(0,d.typedInstanceCreator)()((function(e,t,r,n,i,a,o,s,u,l,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:i,reflectionSheet:a,implicitIntersect:o,allowUnqualifiedCell:s,wrapCellReferences:u,followHyperlinks:l,contextNames:c}})),t.nameCycle=function(e){return{kind:t.ReasonKind.NameCycle,names:e}},t.cellCycle=function(e){return{kind:t.ReasonKind.CellCycle,cells:e}},t.previousFailure=function(e){return{kind:t.ReasonKind.PreviousFailure,range:e}},t.previousNameFailure=function(e){return{kind:t.ReasonKind.PreviousNameFailure,name:e}},t.limitExceeded=function(e){return{kind:t.ReasonKind.LimitExceeded,limit:e}},t.paused=function(e){return{kind:g.ResultKind.Paused,reason:t.ReasonKind.Timeout,resume:e}},t.breaked=function(e){return{kind:g.ResultKind.Breaked,resume:e}},t.runtimePositionLetVal=function(e,t){return{kind:o.LetVar,varNamePosition:e,varBinderPosition:t}},t.runtimePositionLambdaRoot=function(e,t,r){return{kind:o.LambdaRoot,lambdaNodePosition:e,head:t,args:r}},t.runtimePositionLambdaParam=function(e,t,r){return{kind:o.LambdaParam,idx:e,paramNodePosition:t,paramNamePosition:r}},t.runtimePositionEtaLambdaBody=function(e){return{kind:o.EtaLambdaBody,wsfId:e}},t.runtimePositionFormulaRoot={kind:o.FormulaRoot},t.runtimePositionFirstOrderFunc={kind:o.FirstOrderFunc}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transposeSparseArray2D=t.transposeArray2D=t.sparseArray2DTo1D=t.singletonArray2D=t.rowArray2D=t.jaggedArray=t.constantArray2D=t.constantArray=t.colArray2D=t.broadcastArray2D=t.broadcastArray=t.array2DToJaggedArray=t.array2DForall2=t.array2DForall=t.StrictSparseArray2D=t.StrictArray2D=t.NonstrictSparseArray2D=t.NonstrictArray2D=void 0;var n=r(1);t.NonstrictArray2D=n.arrayUtils.NonstrictArray2D,t.NonstrictSparseArray2D=n.arrayUtils.NonstrictSparseArray2D,t.StrictArray2D=n.arrayUtils.StrictArray2D,t.StrictSparseArray2D=n.arrayUtils.StrictSparseArray2D,t.array2DForall=n.arrayUtils.array2DForall,t.array2DForall2=n.arrayUtils.array2DForall2,t.array2DToJaggedArray=n.arrayUtils.array2DToJaggedArray,t.broadcastArray=n.arrayUtils.broadcastArray,t.broadcastArray2D=n.arrayUtils.broadcastArray2D,t.colArray2D=n.arrayUtils.colArray2D,t.constantArray=n.arrayUtils.constantArray,t.constantArray2D=n.arrayUtils.constantArray2D,t.jaggedArray=n.arrayUtils.jaggedArray,t.rowArray2D=n.arrayUtils.rowArray2D,t.singletonArray2D=n.arrayUtils.singletonArray2D,t.sparseArray2DTo1D=n.arrayUtils.sparseArray2DTo1D,t.transposeArray2D=n.arrayUtils.transposeArray2D,t.transposeSparseArray2D=n.arrayUtils.transposeSparseArray2D},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAbsoluteIndex=t.rangeOrArrayToVal=t.makeSlicer=t.ArraySlicer=t.RangeSlicer=t.validateArraySize=t.numInt=t.numMod=t.validDateRange=t.chkNumMultiOper=t.chkDateOper=t.atpm1904to1900Days=t.chkNumOper=t.assertError=t.assertString=t.assertNumber=t.wrap2=t.wrap1=void 0;var n=r(8),i=r(28),a=r(10),o=r(7),s=r(45),u=r(18),l=r(26),c=r(16),d=r(19),p=r(85);t.wrap1=function(e){return function(t,r){return e(t)(r[0])}},t.wrap2=function(e){return function(t,r){return e(t)(r[0],r[1])}};t.assertNumber=function(e){return(0,o.isNumberOper)(e)?e:(0,a.assertFalse)("calc.funcs.assertNumber")};t.assertString=function(e){return(0,o.isStringOper)(e)?e:(0,a.assertFalse)("calc.funcs.assertString")};function m(e,t){var r=(0,i.refToVal)(e,t,!1),s=(0,o.isRichOper)(r)?r.getFallback():r;switch(s.kind){case u.OperKind.Number:return s;case u.OperKind.Boolean:return n.valueErrorOper;case u.OperKind.String:var l=e.coerceOper(s,u.OperKind.Number);return(0,o.isNumberOper)(l)?l:n.valueErrorOper;case u.OperKind.Error:return s;case u.OperKind.Array:return n.valueErrorOper;case u.OperKind.Missing:return n.naErrorOper;case u.OperKind.Blank:return e.mathpack.zero;default:return(0,a.assertNever)("calc.funcs.chkNumOper",s)}}t.assertError=function(e){return(0,o.isErrorOper)(e)?e:(0,a.assertFalse)("calc.funcs.assertError")},t.chkNumOper=m,t.atpm1904to1900Days=1462,t.chkDateOper=function(e,r){var i=m(e,r);if((0,o.isErrorOper)(i))return i;var a=e.mathpack;return a.cond(i)<0?n.numErrorOper:f(e,i=a.floor(i))?(e.config.date1904&&!(0,o.isStringOper)(r)&&(i=a.add(a.fromNumber(t.atpm1904to1900Days),i)),i):n.numErrorOper},t.chkNumMultiOper=function e(t,r){switch(r.kind){case u.OperKind.Number:return(0,l.success)(new s.StrictSparseArray2D(1,1,1,1,[[r]],n.blankOper));case u.OperKind.String:var a=t.coerceOper(r,u.OperKind.Number);return(0,o.isErrorOper)(a)?(0,l.failure)(n.valueErrorOper):(0,l.success)(new s.StrictSparseArray2D(1,1,1,1,[[a]],n.blankOper));case u.OperKind.Blank:return(0,l.success)(new s.StrictSparseArray2D(1,1,1,1,[[t.mathpack.zero]],n.blankOper));case u.OperKind.Missing:return(0,l.failure)(n.naErrorOper);case u.OperKind.Error:return(0,l.failure)(r);case u.OperKind.Range:return e(t,(0,i.refToVal)(t,r,!1));case u.OperKind.Array:return(0,l.success)(new s.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,n.blankOper));default:return(0,l.failure)(n.valueErrorOper)}};function f(e,t){var r,n,i=e.mathpack.lfix(t);return e.config.date1904?(r=0,n=2957003):(r=0,n=2958465),i>=r&&i<=n}t.validDateRange=f,t.numMod=function(e,t,r){var n=e.div(t,r);if((0,o.isErrorOper)(n))return n;var i=e.mul(e.trunc(n),r);if((0,o.isErrorOper)(i))return i;var a=e.sub(t,i);return!(0,o.isErrorOper)(a)&&e.cond(t)<0?e.abs(a):a},t.numInt=function(e,t){var r=e.sub(e.trunc(t),t);return(0,o.isNumberOper)(r)&&0===e.cond(r)},t.validateArraySize=function(e,t){if(e*t>1048576)return(0,c.throwEvaluationError)((0,o.notImplemented)(["Very large array size"]))};var g=function(){function e(e){this.oper=e;var t=e.ranges[0],r=t.rows,n=t.cols;this.rows=r,this.cols=n}return e.prototype.slice=function(e,t,r,i){var a=this.oper.ranges[0],o=a.row,s=a.col;return(0,n.range3DOper)(this.oper.sheets,(0,d.gridRange)(o+e,s+r,t,i))},e}();t.RangeSlicer=g;var h=function(){function e(e){this.oper=e,this.rows=e.opers.length,this.cols=e.opers[0].length}return e.prototype.slice=function(e,t,r,i){return(0,n.arrayOper)(t,i,this.oper.opers.slice(e,e+t).map((function(e){return e.slice(r,r+i)})))},e}();t.ArraySlicer=h,t.makeSlicer=function(e){return(0,o.isArrayOper)(e)?new h(e):new g(e)},t.rangeOrArrayToVal=function(e,t){return(0,o.isRangeOper)(e)?e.ranges.length>1?t:((0,a.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,o.isSheetIndex)(e.sheets)),e):e},t.getAbsoluteIndex=function(e,t){return(0,a.assertTrue)("calc.funcs.getAbsoluteIndex",(0,p.isInteger)(t)&&0!==t&&t<=e&&t>=-e),t>0?t-1:e+t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Logger=t.CombinedLogger=t.ImmediateLogger=t.X10IssueKind=t.LoggerKind=void 0;var n,i,a=r(0),o=r(2),s=r(4),u=r(12),l=r(6),c=r(22),d=r(488),p=r(48),m=(0,c.isTypedChangeGateEnabled)("OfficeVSO:8786821_x10SendLoggerMessagesToMainThread");!function(e){e.Immediate="Immediate",e.Aggregating="Aggregating"}(n||(t.LoggerKind=n={})),function(e){e.RequestProcessorError="RequestProcessorError",e.PluginError="PluginError",e.CustomConflictResolverError="CustomConflictResolverError",e.SchedulerEarlyExitError="SchedulerEarlyExitError"}(i||(t.X10IssueKind=i={}));var f=function(e,t,r){return"x10arch.[".concat(e,"].").concat(t,": ").concat((0,o.isDefined)(r.description)&&r.description.length?"".concat(r.description,". "):"").concat((0,o.isDefined)(r.data)?JSON.stringify(r.data):"")};(0,o.staticAssertSame)();var g={snapshotCreation:function(e,t){return s.ulsLogger.ULS.traceTag(512305240,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,f(e,"snapshotCreation",{data:t}))},beginRequest:function(e,t){return s.ulsLogger.ULS.traceTag(553734792,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,f(e,"beginRequest",{data:t}))},requestSkipped:function(e,t){return s.ulsLogger.ULS.traceTag(553734793,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,f(e,"requestSkipped",{data:t}))},registerPluginFactory:function(e,t){var r=t.factoryName;return s.ulsLogger.ULS.traceTag(571246212,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,f(e,"registerPluginFactory",{description:"registered ".concat(l.PluginFactoryName[r])}))},pluginCompletedInTime:function(e,t){var r=t.pluginName,n=t.logInfo;return s.ulsLogger.ULS.traceTag(553734790,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,f(e,"pluginCompletedInTime",{description:"plugin completed in time. plugin name:".concat(r),data:n}))},computationStoppedExecution:function(e,t){var r=t.computationName,n=t.stopReason,i=t.logInfo;return s.ulsLogger.ULS.traceTag(509109120,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,f(e,"pluginStoppedExecution",{data:a.__assign({computationName:r,stopReason:n},i)}))},closeComputationFrame:function(e,t){return s.ulsLogger.ULS.traceTag(553734789,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,f(e,"closeUIMessageFrame",{data:t}))},nullCheckViolation:function(e,t){return s.ulsLogger.ULS.traceTag(507803776,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Warning,f(e,"nullCheckViolation",{data:t}))},issue:function(e,t){var r=t.issueLevel,n=t.path,i=t.description,a=t.data;return s.ulsLogger.ULS.traceTag(507322970,u.LogCategory.msoulscat_ES_EWAJS,r,f(e,n,{description:i,data:a}))}},h={snapshotCreation:{numSnapshots:0,numFreshSnapshots:0},beginRequest:{},requestSkipped:{},registerPluginFactory:{factories:[]},pluginCompletedInTime:{},computationStoppedExecution:{computationsStopReason:{},requestDurationHistograms:{},schedulerTimeSamples:[],computationTimeSamples:[]},closeComputationFrame:{},nullCheckViolation:{},issue:{}},v={snapshotCreation:function(e,t){return{numSnapshots:e.numSnapshots+1,numFreshSnapshots:e.numFreshSnapshots+(t?1:0)}},beginRequest:function(e,t){var r,n,i=t.computationKind;return a.__assign(a.__assign({},e),((r={})[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1,r))},requestSkipped:function(e,t){var r,n,i=t.computationKind;return a.__assign(a.__assign({},e),((r={})[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1,r))},registerPluginFactory:function(e,t){var r=e.factories,n=t.factoryName;return{factories:a.__spreadArray(a.__spreadArray([],r,!0),[l.PluginFactoryName[n]],!1)}},pluginCompletedInTime:function(e,t){var r,n,i=t.pluginName;return a.__assign(a.__assign({},e),((r={})[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1,r))},computationStoppedExecution:function(e,t){var r,n,i,o,s=e.computationsStopReason,u=e.requestDurationHistograms,l=e.schedulerTimeSamples,c=e.computationTimeSamples,p=t.computationName,m=t.stopReason,f=t.logInfo,g=f.requestTimes,h=f.computationTime,v=f.schedulerTime;return{computationsStopReason:a.__assign(a.__assign({},s),(r={},r[p]=a.__assign(a.__assign({},s[p]),(n={},n[m]=(null!==(o=null===(i=s[p])||void 0===i?void 0:i[m])&&void 0!==o?o:0)+1,n)),r)),requestDurationHistograms:(0,d.updateDurationHistogramsWithRequestTimes)(u,g),schedulerTimeSamples:(0,d.addSampleWithProbability)(l,v,5e-4),computationTimeSamples:(0,d.addSampleWithProbability)(c,h,5e-4)}},closeComputationFrame:function(e,t){var r,n,i,o;return a.__assign(a.__assign({},e),((r={})[t.computationKind]=a.__assign(a.__assign({},e[t.computationKind]),((n={})[t.stopReason]=(null!==(o=null===(i=e[t.computationKind])||void 0===i?void 0:i[t.stopReason])&&void 0!==o?o:0)+1,n)),r))},nullCheckViolation:function(e,t){var r,n,i,o,s=t.requestKind,u=t.violations;return a.__assign(a.__assign({},e),((r={})[s]=a.__assign(a.__assign({},e[s]),((n={})[u.join(";")]=(null!==(o=null===(i=e[s])||void 0===i?void 0:i[u.join(";")])&&void 0!==o?o:0)+1,n)),r))},issue:function(e,t){var r,n,i,o,s=t.issueKind,u=t.issueLevel;return a.__assign(a.__assign({},e),((r={})[s]=a.__assign(a.__assign({},e[s]),((n={})[u]=(null!==(o=null===(i=e[s])||void 0===i?void 0:i[u])&&void 0!==o?o:0)+1,n)),r))}},S=function(){function e(){var e=this;this._threadId="Main",this.formatLogMessage=function(t,r){return f(e.threadId,t,r)}}return e.prototype.log=function(e,t){this.isMessageForAnotherLogger(t)||g[e.kind](this.threadId,e.payload)},e.prototype.flush=function(){},e.prototype.flushBufferedMessages=function(){return[]},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(e){this._threadId=e},enumerable:!1,configurable:!0}),e.prototype.isMessageForAnotherLogger=function(e){return(0,o.isDefined)(e)&&e!==n.Immediate},e}();t.ImmediateLogger=S;var y=function(){function e(){var e=this;this.loggingStates=a.__assign({},h),this._threadId="Main",this.logMessageBuffer=[],this.formatLogMessage=function(t,r){return f(e.threadId,t,r)}}return e.prototype.log=function(e,t){this.isMessageForAnotherLogger(t)||(this.shouldBufferLogMessages()?((0,p.staticTypeHint)(e),this.logMessageBuffer.push([e,n.Aggregating])):this.loggingStates[e.kind]=v[e.kind](this.loggingStates[e.kind],e.payload))},e.prototype.flush=function(){this.shouldBufferLogMessages()||s.ulsLogger.ULS.traceTag(512274703,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Warning,this.formatLogMessage("AgggregationLogger.flush",{description:"summary logs for session",data:this.loggingStates}))},e.prototype.flushBufferedMessages=function(){var e=this.logMessageBuffer;return this.logMessageBuffer=[],e},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(e){this._threadId=e},enumerable:!1,configurable:!0}),e.prototype.shouldBufferLogMessages=function(){return m&&"Main"!==this.threadId},e.prototype.isMessageForAnotherLogger=function(e){return(0,o.isDefined)(e)&&e!==n.Aggregating},e}(),F=function(){function e(){var e=this;this._threadId="Main",this.aggregatingLogger=new y,this.formatLogMessage=function(t,r){return f(e.threadId,t,r)},(0,c.getTypedFeatureGate)("Microsoft.Office.Excel.EnableFullSessionLogging")&&(this.immediateLogger=new S)}return e.prototype.log=function(e,t){var r;null===(r=this.immediateLogger)||void 0===r||r.log(e,t),this.aggregatingLogger.log(e,t)},e.prototype.flush=function(){var e;null===(e=this.immediateLogger)||void 0===e||e.flush(),this.aggregatingLogger.flush()},e.prototype.flushBufferedMessages=function(){var e,t;return a.__spreadArray(a.__spreadArray([],null!==(t=null===(e=this.immediateLogger)||void 0===e?void 0:e.flushBufferedMessages())&&void 0!==t?t:[],!0),this.aggregatingLogger.flushBufferedMessages(),!0)},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(e){this._threadId=e,this.immediateLogger&&(this.immediateLogger.threadId=e),this.aggregatingLogger.threadId=e},enumerable:!1,configurable:!0}),e}();t.CombinedLogger=F,t.x10Logger=new F},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMap=t.functionMapToGenericFunction1stArg=t.mapFromArrayOfDependantPairs=t.asReadonly=t.bindMethodsNullCheck=t.bindMethodsUnbox=t.bindLazyMethods=t.bindMethods=t.functionMapFromDUFunction=t.staticTypeHint=void 0;var n=r(0),i=r(2);function a(e){}t.staticTypeHint=a;i.staticAssertSame,i.staticAssertSame,i.staticAssertSame;i.staticAssertSame,t.functionMapFromDUFunction=function(e,t){for(var r={},i=function(t){r[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return e.apply(void 0,n.__spreadArray([t],r,!1))}},a=0,o=t;a<o.length;a++){i(o[a])}return r},t.bindMethods=function(e,t){for(var r={},n=function(t){r[t]=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e[t].apply(e,r)}},i=0,a=t;i<a.length;i++){n(a[i])}return r},t.bindLazyMethods=function(e,t){for(var r={},n=function(t){r[t]=function(){for(var r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return(r=e.getValue())[t].apply(r,n)}},i=0,a=t;i<a.length;i++){n(a[i])}return r},i.staticAssertSame,i.staticAssertSame,i.staticAssertSame,i.staticAssertSame;var o=function(){function e(){}return e.prototype.unbox=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e(t)}},e.prototype.nullcheck=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=0,a=t;n<a.length;n++){var o=a[n];if((0,i.isNone)(o))return null}return e.apply(void 0,t)}},e}();function s(e){var t=new o,r=t[e].bind(t);return function(e,t){for(var n={},i=0,a=t;i<a.length;i++){var o=a[i],s=e[o].bind(e);n[o]=r(s)}return n}}t.bindMethodsUnbox=s("unbox"),t.bindMethodsNullCheck=s("nullcheck");var u={methodF:function(e){return e+1},methodG:function(e){return e[0]+1}},l=(0,t.bindMethodsUnbox)(u,["methodG"]);i.staticAssertSame;(0,t.bindMethodsNullCheck)(u,["methodG"]);i.staticAssertSame;(0,t.bindMethodsNullCheck)(l,["methodG"]);function c(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})}i.staticAssertSame,t.asReadonly=function(e){return e},t.mapFromArrayOfDependantPairs=c;c([["a",1],["b",2]]);i.staticAssertSame,t.functionMapToGenericFunction1stArg=function(e){return function(t,r){for(var i,a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];return(i=e[t]).call.apply(i,n.__spreadArray([e,r],a,!1))}};var d=function(){function e(e){this.operations=e,this.map=new Map}return e.prototype.get=function(e){var t=this.operations.getKey(e),r=this.map.get(t);if(void 0!==r)return r;var n=this.operations.getDefault();return this.map.set(t,n),n},e.prototype.set=function(e,t){this.map.set(this.operations.getKey(e),t)},e}();t.DefaultMap=d},function(e,t,r){"use strict";function n(){return function(e){return e}}function i(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function a(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function o(e,t){for(var r=0,n=t;r<n.length;r++){var i=n[r];e.push(i)}return e}function s(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0,t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=n,t.staticAssertIsOptional=function(e){return e},t.identity=function(e){return e},t.makeStringMap=i,t.cloneStringMap=function(e){var t=i();for(var r in e)t[r]=e[r];return t},t.numEnumArray=a,t.numEnumMap=function(e,t){for(var r={},n=0,i=a(e);n<i.length;n++){var o=i[n];r[o]=t(o)}return r},t.strEnumArray=function(e){return Object.keys(e).map((function(e){return e})).map((function(t){return e[t]})).sort()},t.safePush=o,t.safeConcat=function(e,t){var r=[];o(r,e);for(var n=0,i=t;n<i.length;n++){o(r,i[n])}return r},t.isDefined=s,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(s)};t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return function(e){return e}},t.now="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:"undefined"!=typeof process&&null!=process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:function(){return Date.now()},t.singleton=function(e){return function(){function t(){}return t.instance=function(){return void 0===t.value&&(t.value=e()),t.value},t.prototype.instance=function(){return t.instance()},t.value=void 0,t}()},t.mapFromArrayOfPairs=function(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;var n,i,a=r(1),o=a.assertions.assertIndex,s=a.assertions.assertPositiveLength,u=a.assertions.assertFalse;function l(e){return{kind:n.Cell,range:e}}function c(e){return{kind:n.Range,range:e}}function d(e,t,r){return{document:e,index:t,index2:r}}function p(e,t){return d(e,t,t)}function m(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function f(e,t){return{sheet:e,range:t}}function g(e){return{document:e,index:void 0}}function h(e){return e.index===e.index2}function v(e){return 1===e.rows&&1===e.cols}function S(e){return v(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(n||(t.LexicalKind=n={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(i||(t.NameSource=i={})),t.lexicalSourceCell=l,t.lexicalSourceRange=c,t.lexicalSourceGrid=function(e,t){switch(e){case n.Cell:return S(t)?l(t):u("calc.lang.lexicalSourceGrid: expected cell");case n.Range:return c(t)}},t.lexicalSourceName=function(e){return{kind:n.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:n.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:n.UDF,udf:e}},t.sheetRows=1<<20,t.sheetCols=16384,t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=d,t.sheetIndex=p,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=m,t.gridRange=function(e,r,n,i){return o("calc.lang.gridRange",e,t.sheetRows),o("calc.lang.gridRange",r,t.sheetCols),s("calc.lang.gridRange",n,t.sheetRows-e),s("calc.lang.gridRange",i,t.sheetCols-r),m(e,r,n,i)},t.gridCell=function(e,r){return o("calc.lang.gridCell",e,t.sheetRows),o("calc.lang.gridCell",r,t.sheetCols),m(e,r,1,1)},t.sheetGridCube=f,t.sheetGridRange=f,t.sheetGridCell=f,t.originCell=f,t.documentScope=g,t.nameScope=function(e,t){return void 0===t?g(e):p(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=h,t.isGridCell=v,t.isSheetGridRange=function(e){return h(e.sheet)},t.isSheetGridCell=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(3);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.operatorToken=t.identOrBooleanToken=t.literalToken=t.cellRefR1C1Token=t.cellRefA1Token=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.multiLineCommentToken=t.singleLineCommentToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.isBadErrorOper=t.badNumberOper=t.isNumberLikeOper=t.isBadNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.appendToken=t.poundOperatorToken=t.atOperatorToken=void 0;var n,i,a,o,s=r(0),u=r(82),l=r(33),c=r(57),d=r(56),p=r(90),m=s.__importStar(r(108)),f=r(132),g=m.codePointAsterisk,h=m.codePointMinusSign,v=m.codePointPlusSign,S=m.codePointSlash,y=m.codePointSpace;function F(e){return e.kind===o.BadNumber||e.kind===d.OperKind.Number}function C(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"}(n||(t.TokenKind=n={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(i||(t.DelimId=i={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(a||(t.SepId=a={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(o||(t.TokenOperKind=o={})),t.isBadNumberOper=function(e){return e.kind===o.BadNumber},t.isNumberLikeOper=F,t.badNumberOper={kind:o.BadNumber},t.isBadErrorOper=function(e){return e.kind===o.BadError},t.badErrorOper={kind:o.BadError};t.endToken=function(e){return C(n.End,e,"",!1)};t.spacesToken=function(e,t){return C(n.Spaces,e,t,!1)};t.unexpectedToken=function(e,t){return C(n.Unexpected,e,t,!1)};t.escapeToken=function(e,t){return C(n.Escape,e,t,!1)};t.singleLineCommentToken=function(e,t){return C(n.SingleLineComment,e,t,!1)};t.multiLineCommentToken=function(e,t,r){return{kind:n.MultiLineComment,start:e,chars:t,isIdentContinue:!1,isClosed:r}};function R(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}t.identToken=function(e,t){return C(n.Ident,e,t,!0)};t.leftParenToken=function(e){return R(n.Left,e,"(",i.Paren)};t.leftBracketToken=function(e,t){return R(n.Left,e,t,i.Bracket)};t.leftBraceToken=function(e,t){return R(n.Left,e,t,i.Brace)};t.leftSQuoteToken=function(e){return R(n.Left,e,"'",i.SQuote)};t.rightParenToken=function(e){return R(n.Right,e,")",i.Paren)};t.rightBracketToken=function(e,t){return R(n.Right,e,t,i.Bracket)};t.rightBraceToken=function(e,t){return R(n.Right,e,t,i.Brace)};t.rightSQuoteToken=function(e){return R(n.Right,e,"'",i.SQuote)};t.listSepToken=function(e,t){return R(n.Sep,e,t,a.List)};t.colSepToken=function(e,t){return R(n.Sep,e,t,a.Col)};t.rowSepToken=function(e,t){return R(n.Sep,e,t,a.Row)};t.qualSepToken=function(e){return R(n.Sep,e,"!",a.Qual)};t.dotSepToken=function(e){return R(n.Sep,e,".",a.Dot)};t.assignSepToken=function(e){return R(n.Sep,e,":=",a.Assign)};function b(e,t,r,i,a,o,s){return{kind:n.CellRef,start:e,chars:t,isIdentContinue:r,row:i,col:a,refStyle:o,isBadLocale:s}}function E(e,t,r,i){void 0===i&&(i=!0);var a=r.kind===d.OperKind.Boolean||F(r)&&function(e){for(var t=0,r=(0,p.codePointIterator)(e);t<r.length;t++){var n=r[t];if(n===v||n===h||n===g||n===y||n===S)return!1}return!0}(t);return{kind:n.Literal,start:e,chars:t,isIdentContinue:a,oper:r,hasRight:i}}function P(e,t,r){return{kind:n.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function k(e){var t=u.operatorStrings[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator ".concat(e));return function(r){return P(r,t,e)}}t.specialRefToken=function(e,t,r){return R(n.SpecialRef,e,t,r)},t.cellRefA1Token=function(e,t,r,n){return b(e,t,(null==r||"object"==typeof r&&r.kind===l.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===l.PosKind.Rel),r,n,l.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,i){return void 0===i&&(i=!1),b(e,t,!(r!==f.SpecialPos.RCNoNum&&null!=r&&r.kind!==l.PosKind.Abs||n!==f.SpecialPos.RCNoNum&&null!=n&&n.kind!==l.PosKind.Abs),r,n,l.RefStyle.R1C1,i)},t.literalToken=E,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?E(r,n,c.falseOper):0===e.stringCompareCI(e.trueName,n)?E(r,n,c.trueOper):(0,t.identToken)(r,n)},t.operatorToken=P,t.addOperatorToken=k(u.OperatorId.Add),t.subOperatorToken=k(u.OperatorId.Sub),t.mulOperatorToken=k(u.OperatorId.Mul),t.divOperatorToken=k(u.OperatorId.Div),t.powOperatorToken=k(u.OperatorId.Pow),t.percentOperatorToken=k(u.OperatorId.Percent),t.concatOperatorToken=k(u.OperatorId.Concat),t.eqOperatorToken=k(u.OperatorId.Eq),t.ltOperatorToken=k(u.OperatorId.Lt),t.gtOperatorToken=k(u.OperatorId.Gt),t.neOperatorToken=k(u.OperatorId.Ne),t.leOperatorToken=k(u.OperatorId.Le),t.geOperatorToken=k(u.OperatorId.Ge),t.rangeOperatorToken=k(u.OperatorId.Range),t.atOperatorToken=k(u.OperatorId.At),t.poundOperatorToken=k(u.OperatorId.Pound),t.appendToken=function(e,t,r){return r.push(t),t.start+e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(1);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFunc=t.stopped=t.previousNameFailure=t.previousFailure=t.pendingValue=t.breaked=t.paused=t.nameCycle=t.limitExceeded=t.interval=t.illFormedFormula=t.finalValue=t.evalLocals=t.evalGlobals=t.createCompileGlobals=t.compileLocalsName=t.compileLocalsGrid=t.cellWellFormedFormula=t.cellFormula=t.cellCycle=t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.RuntimePositionKind=t.StepAction=t.ReasonKind=t.LimitKind=t.Interrupt=t.CellKind=void 0;var n=r(55);t.CellKind=n.serviceTypes.CellKind,t.Interrupt=n.serviceTypes.Interrupt,t.LimitKind=n.serviceTypes.LimitKind,t.ReasonKind=n.serviceTypes.ReasonKind,t.StepAction=n.serviceTypes.StepAction,t.RuntimePositionKind=n.serviceTypes.RuntimePositionKind,t.runtimePositionLetVal=n.serviceTypes.runtimePositionLetVal,t.runtimePositionLambdaRoot=n.serviceTypes.runtimePositionLambdaRoot,t.runtimePositionLambdaParam=n.serviceTypes.runtimePositionLambdaParam,t.runtimePositionEtaLambdaBody=n.serviceTypes.runtimePositionEtaLambdaBody,t.runtimePositionFormulaRoot=n.serviceTypes.runtimePositionFormulaRoot,t.runtimePositionFirstOrderFunc=n.serviceTypes.runtimePositionFirstOrderFunc,t.cellCycle=n.serviceTypes.cellCycle,t.cellFormula=n.serviceTypes.cellFormula,t.cellWellFormedFormula=n.serviceTypes.cellWellFormedFormula,t.compileLocalsGrid=n.serviceTypes.compileLocalsGrid,t.compileLocalsName=n.serviceTypes.compileLocalsName,t.createCompileGlobals=n.serviceTypes.createCompileGlobals,t.evalGlobals=n.serviceTypes.evalGlobals,t.evalLocals=n.serviceTypes.evalLocals,t.finalValue=n.serviceTypes.finalValue,t.illFormedFormula=n.serviceTypes.illFormedFormula,t.interval=n.serviceTypes.interval,t.limitExceeded=n.serviceTypes.limitExceeded,t.nameCycle=n.serviceTypes.nameCycle,t.paused=n.serviceTypes.paused,t.breaked=n.serviceTypes.breaked,t.pendingValue=n.serviceTypes.pendingValue,t.previousFailure=n.serviceTypes.previousFailure,t.previousNameFailure=n.serviceTypes.previousNameFailure,t.stopped=n.serviceTypes.stopped,t.userDefinedFunc=n.serviceTypes.userDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.wildcard=t.webFuncs=t.volatileFuncs=t.funcsUtil=t.funcsTestUtils=t.stringFuncs=t.referenceFuncs=t.reduce=t.recordFuncs=t.rangeFuncs=t.predicateFuncs=t.numfmtFuncs=t.mathFuncs=t.lookupFuncs=t.logicalFuncs=t.lambdaFuncs=t.informationFuncs=t.getWorksheetFuncModule=t.engineeringFuncs=t.dateTimeFuncs=t.criteria=t.aggregationFuncs=t.visitedMap=t.value=t.util=t.testUtils=t.term=t.serviceTypes=t.rtree=t.machine=t.extensionTypes=t.evaluatorService=t.evalTypes=t.evalFormula=t.evalCell=t.evalRuntime=t.evalFunction=t.operatorsModule=t.dereferenceModule=t.compilerService=t.coerce=t.calcChain=t.PackageName=void 0;var n=r(0);t.PackageName="excel-online-calc-runtime",t.calcChain=n.__importStar(r(429)),t.coerce=n.__importStar(r(180)),t.compilerService=n.__importStar(r(181)),t.dereferenceModule=n.__importStar(r(183)),t.operatorsModule=n.__importStar(r(184)),t.evalFunction=n.__importStar(r(264)),t.evalRuntime=n.__importStar(r(185)),t.evalCell=n.__importStar(r(186)),t.evalFormula=n.__importStar(r(187)),t.evalTypes=n.__importStar(r(16)),t.evaluatorService=n.__importStar(r(434)),t.extensionTypes=n.__importStar(r(84)),t.machine=n.__importStar(r(28)),t.rtree=n.__importStar(r(261)),t.serviceTypes=n.__importStar(r(44)),t.term=n.__importStar(r(68)),t.testUtils=n.__importStar(r(436)),t.util=n.__importStar(r(27)),t.value=n.__importStar(r(76)),t.visitedMap=n.__importStar(r(67)),t.aggregationFuncs=n.__importStar(r(271)),t.criteria=n.__importStar(r(272)),t.dateTimeFuncs=n.__importStar(r(274)),t.engineeringFuncs=n.__importStar(r(276)),t.getWorksheetFuncModule=n.__importStar(r(270)),t.informationFuncs=n.__importStar(r(277)),t.lambdaFuncs=n.__importStar(r(278)),t.logicalFuncs=n.__importStar(r(279)),t.lookupFuncs=n.__importStar(r(191)),t.mathFuncs=n.__importStar(r(192)),t.numfmtFuncs=n.__importStar(r(281)),t.predicateFuncs=n.__importStar(r(282)),t.rangeFuncs=n.__importStar(r(283)),t.recordFuncs=n.__importStar(r(284)),t.reduce=n.__importStar(r(273)),t.referenceFuncs=n.__importStar(r(285)),t.stringFuncs=n.__importStar(r(286)),t.funcsTestUtils=n.__importStar(r(446)),t.funcsUtil=n.__importStar(r(46)),t.volatileFuncs=n.__importStar(r(287)),t.webFuncs=n.__importStar(r(288)),t.wildcard=n.__importStar(r(138)),t.nextFuncs=n.__importStar(r(447))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(3);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(3);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpacesOnly=t.parseWhitespace=t.isWhitespaceToken=t.isCommentToken=t.isBracketToken=t.isRightBracketToken=t.isLeftBracketToken=t.isRefErrorToken=t.isAtOpToken=t.isRangeOpToken=t.isListSepToken=t.isDotSepToken=void 0;var n=r(81),i=r(41),a=r(57),o=r(82),s=r(52),u=r(63),l=r(56);function c(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.Dot}function d(e){return e.kind===s.TokenKind.Operator&&e.value===o.OperatorId.Range}function p(e){return e.kind===s.TokenKind.Operator&&e.value===o.OperatorId.At}function m(e){return e.kind===s.TokenKind.Left&&e.value===s.DelimId.Bracket}function f(e){return(e.kind===s.TokenKind.Left||e.kind===s.TokenKind.Right)&&e.value===s.DelimId.Bracket}function g(e){return e.kind===s.TokenKind.Spaces||e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment}t.isDotSepToken=c,t.isListSepToken=function(e){return e.kind===s.TokenKind.Sep&&e.value===s.SepId.List},t.isRangeOpToken=d,t.isAtOpToken=p,t.isRefErrorToken=function(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===l.OperKind.Error&&e.oper.type===a.ErrorType.REF},t.isLeftBracketToken=m,t.isRightBracketToken=function(e){return e.kind===s.TokenKind.Right&&e.value===s.DelimId.Bracket},t.isBracketToken=f,t.isCommentToken=function(e){return e.kind===s.TokenKind.SingleLineComment||e.kind===s.TokenKind.MultiLineComment},t.isWhitespaceToken=g,t.parseWhitespace=(0,u.many)((0,u.take)((function(e,t){return g(t)?t:void 0}))),t.parseSpacesOnly=(0,u.opt)((0,u.take)((function(e,t){return t.kind===s.TokenKind.Spaces?t.chars:void 0})),"");function h(e){return(0,u.take)((function(t,r){return r.kind===s.TokenKind.Sep&&r.value===e?r:void 0}))}function v(e){return(0,u.take)((function(t,r){return r.kind===s.TokenKind.Left&&r.value===e?r:void 0}))}function S(e){return(0,u.take)((function(t,r){return r.kind===s.TokenKind.Right&&r.value===e?r:void 0}))}t.parseCharIndex=function(e,t,r,a,o){var s=e[t];if(null==s){var u="calc.parse.pStart: internal error: expected token at ".concat(t," in ").concat((0,n.anonymize)(e));return(0,i.assertFalse)(u)}return a(s.start,t)},t.parseListSep=h(s.SepId.List),t.parseRowSep=h(s.SepId.Row),t.parseColSep=h(s.SepId.Col),t.parseQualSep=h(s.SepId.Qual),t.parseDotSepToken=h(s.SepId.Dot),t.parseAssignToken=h(s.SepId.Assign),t.parseLeftParen=v(s.DelimId.Paren),t.parseRightParen=S(s.DelimId.Paren),t.parseLeftBrace=v(s.DelimId.Brace),t.parseRightBrace=S(s.DelimId.Brace),t.parseLeftSQuote=v(s.DelimId.SQuote),t.parseRightSQuote=S(s.DelimId.SQuote),t.parseLeftBracket=v(s.DelimId.Bracket),t.parseRightBracket=S(s.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,u.takePeek)((function(e,t,r){return c(t)&&!m(r)?t:void 0})),t.parseRangeOp=(0,u.take)((function(e,t){return d(t)?t:void 0})),t.parseAtOp=(0,u.take)((function(e,t){return p(t)?t:void 0})),t.parseEscape=(0,u.take)((function(e,t){return t.kind===s.TokenKind.Escape?t:void 0})),t.parseEnd=(0,u.take)((function(e,t){return t.kind===s.TokenKind.End?t:void 0})),t.parseIdentContinue=(0,u.apply)((0,u.many1)((0,u.take)((function(e,t){return t.isIdentContinue?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:(0,s.identToken)(r.start,t.map((function(e){return e.chars})).join(""))}));var y=(0,u.take)((function(e,t){return f(t)||t.kind===s.TokenKind.End?void 0:t})),F=(0,u.lazy)((function(){return(0,u.flatten)((0,u.many)((0,u.any)((0,u.many1)(y),(0,u.concat)((0,u.tuple)(t.parseLeftBracket),F,(0,u.opt)((0,u.tuple)(t.parseRightBracket),[])))))}));t.parseBracketedTokens=(0,u.apply)((0,u.tuple)(t.parseLeftBracket,F,t.parseCharIndex,(0,u.opt)(t.parseRightBracket,void 0)),(function(e,t){t[0];var r=t[1],n=t[2],i=t[3];return r.push((0,s.endToken)(n)),[r,void 0!==i]}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRangeEqual=t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.applyComparison=t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=void 0;var n=r(3);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable,t.applyComparison=n.util.applyComparison},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0;var n=r(79);t.NotificationKind=n.notificationKinds.NotificationKind},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanLiteralNode=t.isNumberLiteralNode=t.isMissingLiteralNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.sheetRangeToSheetIndex=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getEtaFuncId=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=t.LangReasonKind=void 0;var i=r(0),a=r(42),o=r(50);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return o.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return o.isSheetGridCell}});var s=r(40),u=r(71),l=r(88),c=r(32),d=r(383),p=r(101),m=r(50);function f(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,s=t.row,u=t.col,l=t.rows,d=t.cols,p=(0,c.fastMin)(r,s),m=(0,c.fastMin)(n,u),f=(0,c.fastMax)(r+i,s+l)-p,g=(0,c.fastMax)(n+a,u+d)-m;return(0,o.unsafeGridRange)(p,m,f,g)}function g(e,t){return e===t||e.name===t.name&&e.path===t.path}function h(e,t){return g(e.document,t.document)&&e.index===t.index}function v(e,t){return e.row===t.row&&e.col===t.col}function S(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function y(e){return(0,o.isGridCell)(e)?e:(0,o.unsafeGridRange)(e.row,e.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return m.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return m.isSheetGridRange}}),t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,o.isGridCell)(e))return t(e,0,0);for(var r=e.row,n=e.rows,i=e.col,a=e.cols,s=0;s<n;s+=1)for(var u=0;u<a;u+=1)if(!t((0,o.gridCell)(r+s,i+u),s,u))return!1;return!0},t.forEachTileInRange=function(e,t,r){var n=e.row,i=e.rows,s=e.col,u=e.cols;(0,a.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,a.assertIndex)("calc.lang.forEachTileInRange",n,o.sheetRows),(0,a.assertIndex)("calc.lang.forEachTileInRange",s,o.sheetCols),(0,a.assertPositiveLength)("calc.lang.forEachTileInRange",i,o.sheetRows-n),(0,a.assertPositiveLength)("calc.lang.forEachTileInRange",u,o.sheetCols-s);for(var l=n;l<n+i;l+=t)for(var d=s;d<s+u;d+=t)if(!r((0,o.unsafeGridRange)(l,d,(0,c.fastMin)(t,i+n-l),(0,c.fastMin)(t,u+s-d))))return!1;return!0},t.gridRangeJoin=f,t.gridRangeJoinOpt=function(e,t){return e?t?f(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,a.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(f)},t.gridRangeIsect=function(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,s=t.row,u=t.col,l=t.rows,d=t.cols,p=(0,c.fastMax)(r,s),m=(0,c.fastMax)(n,u),f=(0,c.fastMin)(r+i,s+l)-p,g=(0,c.fastMin)(n+a,u+d)-m;if(!(f<=0||g<=0))return(0,o.unsafeGridRange)(p,m,f,g)},t.gridRangeIsects=function(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,s=t.col,u=t.rows,l=t.cols;return(0,c.fastMax)(r,o)<(0,c.fastMin)(r+i,o+u)&&(0,c.fastMax)(n,s)<(0,c.fastMin)(n+a,s+l)},t.gridCellImplicitIsect=function(e,t){var r=e.row,n=e.col,i=t.row,a=t.col,s=t.rows,u=t.cols,l=i<=r&&r<i+s,c=a<=n&&n<a+u;return l&&c?(0,o.gridCell)(r,n):l&&1===u?(0,o.gridCell)(r,a):c&&1===s?(0,o.gridCell)(i,n):1===u&&1===s?(0,o.gridCell)(i,a):void 0},t.gridRangeCompare=function(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,s=t.col,u=r+i,l=o+t.rows,c=n+a,d=s+t.cols;return r===o&&u===l&&n===s&&c===d?0:r<=o&&u>=l&&n<=s&&c>=d?1:r>=o&&u<=l&&n>=s&&c<=d?-1:void 0},t.gridRangeExcept=function(e,t){var r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],i=[t.row,t.row+t.rows],a=[t.col,t.col+t.cols],s=(0,d.ivlCompare)(r,i),u=(0,d.ivlCompare)(n,a);if(void 0!==s&&s<=0){var l=(0,d.ivlExcept)(n,a);if(void 0!==l)return(0,o.gridRange)(e.row,l[0],e.rows,l[1]-l[0])}if(void 0!==u&&u<=0){var c=(0,d.ivlExcept)(r,i);if(void 0!==c)return(0,o.gridRange)(c[0],e.col,c[1]-c[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.isDocumentLocEqual=g,t.isSheetIndexEqual=h,t.sheetRangeToSheetIndex=function(e){if(e.index===e.index2)return i.__assign(i.__assign({},e),{__isRange:!1})},t.isNameScopeEqual=function(e,t){return g(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=v,t.isGridRangeEqual=S,t.isSheetGridCellEqual=function(e,t){return h(e.sheet,t.sheet)&&v(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return h(e.sheet,t.sheet)&&S(e.range,t.range)},t.gridRangeAnchor=y,t.sheetGridRangeAnchor=function(e){return(0,o.isSheetGridCell)(e)?e:(0,o.sheetGridCell)(e.sheet,y(e.range))},t.gridCellRange=function(e,t){var r=e.row,n=e.col,i=t.row,a=t.col;return(0,o.unsafeGridRange)((0,c.fastMin)(r,i),(0,c.fastMin)(n,a),Math.abs(i-r)+1,Math.abs(a-n)+1)};var F=[];function C(e){return e.kind===s.NodeKind.Literal&&P(e.oper)}function R(e){return e.kind===s.NodeKind.Literal&&E(e.oper)}function b(e){return e.kind===u.OperKind.Number}function E(e){return e.kind===u.OperKind.Boolean}function P(e){return e.kind===u.OperKind.Missing}t.getArguments=function(e){return 0===function(e){return 1===e.length&&C(e[0])?0:e.length}(e)?F:e},t.isOperatorNode=function(e){return e.kind===s.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===s.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===s.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=function(e){return e.kind===s.NodeKind.Missing},t.isMissingLiteralNode=C,t.isNumberLiteralNode=function(e){return e.kind===s.NodeKind.Literal&&b(e.oper)},t.isBooleanLiteralNode=R,t.getArgType=function(e,t,r){var n=e.maxArgs,i=e.headTypes,o=e.restTypes,s=e.tailTypes;if((0,a.assertPositiveInteger)("calc.runtime.getArgType: n",r),(0,a.assertIndex)("calc.runtime.getArgType: i",t,r),t>=n)return u.SignatureType.None;if(t<i.length)return i[t];if(0===o.length)return u.SignatureType.None;if(t<i.length+o.length)return o[t-i.length];var l=(r-i.length)%o.length;return l>s.length?u.SignatureType.None:t>=r-l?s[t-(r-l)]:o[(t-i.length)%o.length]},t.isValidArgsLength=function(e,t){var r=e.minArgs,n=e.maxArgs,i=e.headTypes,a=e.restTypes,o=e.tailTypes;return!(t<r||t>n)&&(t<=i.length+a.length||0!==a.length&&(t-i.length)%a.length<=o.length)},t.shouldFieldRefBeBracketed=function(e,t,r){if(0===r.length)return!1;if(t.field.kind!==s.NodeKind.Ident)return!1;for(var n=e;n.kind===s.NodeKind.App&&n.head.kind===s.NodeKind.Operator;){var i=n.head.id;if(i!==p.OperatorId.Range&&i!==p.OperatorId.Isect||2!==n.args.length)break;n=n.args[1]}return R(n)||n.kind===s.NodeKind.Name||n.kind===s.NodeKind.CellRef},t.isNumberOper=b,t.isStringOper=function(e){return e.kind===u.OperKind.String},t.isBooleanOper=E,t.isErrorOper=function(e){return e.kind===u.OperKind.Error},t.isRangeOper=function(e){return e.kind===u.OperKind.Range},t.isArrayOper=function(e){return e.kind===u.OperKind.Array},t.isMissingOper=P,t.isBlankOper=function(e){return e.kind===u.OperKind.Blank},t.isRichOper=function(e){return e.kind===u.OperKind.Rich};var k=u.OperKind.Number|u.OperKind.String|u.OperKind.Boolean;t.isPrimitiveOper=function(e){return 0!=(e.kind&k)};var T,A=k|u.OperKind.Error|u.OperKind.Array|u.OperKind.Rich;t.isWriteOper=function(e){return 0!=(e.kind&A)},t.isReadOperEqual=function e(t,r,n,i){if(n.kind!==r.kind)return!1;switch(n.kind){case u.OperKind.Boolean:case u.OperKind.String:return n.value===r.value;case u.OperKind.Number:return 0===t.cond2(n,r);case u.OperKind.Error:return n.type===r.type;case u.OperKind.Rich:return i;case u.OperKind.Array:var o=r;if(n.cols!==o.cols||n.rows!==o.rows)return!1;for(var s=0;s<n.rows;s+=1)for(var l=n.opers[s],c=o.opers[s],d=0;d<n.cols;d+=1)if(!e(t,c[d],l[d],i))return!1;return!0;case u.OperKind.Blank:return!0;default:return(0,a.assertNever)("calc.lang.readOperEq",n)}},function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(T||(t.LangReasonKind=T={})),t.ReasonKind=i.__assign(i.__assign({},l.ReasonKind),T),t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return 0===e.length&&(0,a.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){var t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t};var N="_xlfn.",_="_xlws.";t.getWorksheetFuncId=function(e,t){var r=t;return r.length>N.length&&0===e.stringCompareCI(r.substring(0,N.length),N)&&(r=r.substring(N.length)).length>_.length&&0===e.stringCompareCI(r.substring(0,_.length),_)&&(r=r.substring(_.length)),e.getWorksheetFuncId(r)};t.getUserDefinedFuncName=function(e,t){var r=t;return r.length>"_xludf.".length&&0===e.stringCompareCI(r.substring(0,"_xludf.".length),"_xludf.")&&(r=r.substring("_xludf.".length)),r};t.getEtaFuncId=function(e,t){var r=t;return r.length>"_xleta.".length&&0===e.stringCompareCI(r.substring(0,"_xleta.".length),"_xleta.")&&(r=r.substring("_xleta.".length)),e.getWorksheetFuncId(r)};var I="_xlpm.";function O(e){return e.kind!==s.StructRefKind.SpecialRef&&e.kind!==s.StructRefKind.BadRef||e.isBracketed}function M(e){return e.kind===s.StructRefKind.MissingRef||e.kind===s.StructRefKind.BadRef}function D(e){switch(e.kind){case s.StructRefKind.SpecialRef:case s.StructRefKind.ColumnRef:return e.isClosed;case s.StructRefKind.RangeOpRef:return D(e.lhs)&&D(e.rhs);case s.StructRefKind.MissingRef:return!0;case s.StructRefKind.BadRef:return e.isClosed}}t.getBoundName=function(e,t){var r=t;return r.length>I.length&&0===e.stringCompareCI(r.substring(0,I.length),I)&&(r=r.substring(I.length)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(O)&&function(e){var t=e.specialRefs,r=Object.keys(t).reduce((function(e,r){return e+(t[Number(r)]?1:0)}),0);return 1===r||2===r&&t[s.SpecialRefId.Data]&&(t[s.SpecialRefId.Headers]||t[s.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(D)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(M)},t.isRangeOpClosed=function(e){return D(e.lhs)&&D(e.rhs)},t.isRangeOpNoMissing=function(e){return!M(e.lhs)&&!M(e.rhs)};var w=((n={})[s.SpecialRefId.All]=1,n[s.SpecialRefId.Headers]=2,n[s.SpecialRefId.Data]=3,n[s.SpecialRefId.Totals]=4,n[s.SpecialRefId.ThisRow]=5,n),L=function(e){return e.kind===s.StructRefKind.MissingRef?7:e.kind!==s.StructRefKind.SpecialRef?6:w[e.id]};function x(e,t){return L(e)-L(t)}t.normalizeCommaOpRef=function(e){for(var t={},r=[],n=0,i=e.refs;n<i.length;n++){var a=i[n];a.kind!==s.StructRefKind.SpecialRef?r.push(a):void 0===t[a.id]&&(t[a.id]=!0,r.push(a))}return r.sort(x),r},t.applyComparison=function(e,t){switch(e){case p.OperatorId.Eq:return 0===t;case p.OperatorId.Ne:return 0!==t;case p.OperatorId.Lt:return t<0;case p.OperatorId.Gt:return t>0;case p.OperatorId.Le:return t<=0;case p.OperatorId.Ge:return t>=0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingLiteralNode=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(3);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingLiteralNode=n.util.isMissingLiteralNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.flatten=t.middle=t.right=t.left=t.tuple=t.many1=t.many=t.reduce=t.applyTake=t.takePeek=t.peek=t.take=t.fails=t.succeeds=t.opt=t.any=t.withState=t.apply=t.bind=t.parseFail=t.parseSucceed=t.warnSucceedOrFail=t.setDebugging=t.lazy=t.runParser=void 0;var n=r(41),i=r(81),a=r(43),o=r(107);t.runParser=function(e,t,r,o){var s;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,o,(function(e,t){s=(0,a.success)({output:e,index:t})}),(function(){s=(0,a.failure)(void 0)}))),null==s){var u=(0,i.anonymize)(t),l="calc.parse.runParser: internal error: parser did not call resolve or reject on ".concat(u);return(0,n.assertFalse)(l)}return s},t.lazy=function(e){var t;return function(r,n,i,a,o){var s=null!=t?t:t=e();return function(){return s(r,n,i,a,o)}}};var s=!1;function u(e){return function(t,r,n,i,a){return i(e,r)}}t.setDebugging=function(e){s=e},t.warnSucceedOrFail=function(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,n){return s&&console.warn("".concat(t," succeeded, returning index ").concat(n," (of ").concat(r.length,") with"),e),a(e,n)}),(function(){return s&&console.warn("".concat(t," failed at index ").concat(n," (of ").concat(r.length,")")),o}))}},t.parseSucceed=u;var l=function(e,t,r,n,i){return i};function c(){return l}function d(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,n){return t(i,e)(r,n,i,a,o)}),o)}}function p(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,r){return a(t(i,e),r)}),o)}}function m(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(function(){return t(r,n,i,a,o)}))}}function f(e,t){return function(r,n,i,a,o){var s=r[n];if(null==s)return o;var u=e(i,s);return null==u?o:a(u,n+t)}}function g(e,t,r){return function(a,o,s,u,l){var c=r,d=o;function p(){return e(a,d,s,m,f)}function m(e,r){if(r<=d){var o=(0,i.anonymize)(a),u="calc.parse.reduce: internal error: no progress made at index ".concat(d," on ").concat(o);return(0,n.assertFalse)(u)}return c=t(s,e,c),d=r,p}function f(){return u(c,d)}return p}}function h(e,t){return g(e,(function(e,t,r){return r.push(t),r}),t)}function v(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return u([]);if(1===e.length)return p(e[0],(function(e,t){return[t]}));var r=e.length;return function(t,n,i,a,o){var s=n,u=[];function l(){return e[u.length](t,s,i,c,o)}function c(e,t){return s=t,u.push(e),u.length<r?l:a(u,s)}return l}}function S(e){return p(e,(function(e,t){return(0,o.safeConcat)([],t)}))}t.parseFail=c,t.bind=d,t.apply=p,t.withState=function(e){return function(t,r,n,i,a){return e(n)(t,r,n,i,a)}},t.any=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?c():e.reduce(m)},t.opt=function(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(function(){return a(t,n)}))}},t.succeeds=function(e){return function(t,r,n,i,a){return e(t,r,n,(function(){return i(!0,r)}),a)}},t.fails=function(e){return function(t,r,n,i,a){return e(t,r,n,a,(function(){return i(!0,r)}))}},t.take=function(e){return f(e,1)},t.peek=function(e){return f(e,0)},t.takePeek=function(e){return function(t,r,n,i,a){var o=t[r],s=t[r+1];if(null==o||null==s)return a;var u=e(n,o,s);return null==u?a:i(u,r+1)}},t.applyTake=function(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,r){var n=t(i,e);return null==n?o:a(n,r)}),o)}},t.reduce=g,t.many=function(e,t){return void 0===t?function(t,r,n,i,a){return h(e,[])(t,r,n,i,a)}:function(r,n,i,a,o){return e(r,n,i,(function(e,n){return h(t,[e])(r,n,i,a,o)}),(function(){return a([],n)}))}},t.many1=function(e,t){return void 0===t&&(t=e),d(e,(function(e,r){return h(t,[r])}))},t.tuple=v,t.left=function(e,t){return p(v(e,t),(function(e,t){return t[0]}))},t.right=function(e,t){return p(v(e,t),(function(e,t){return t[1]}))},t.middle=function(e,t,r){return p(v(e,t,r),(function(e,t){return t[1]}))},t.flatten=S,t.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return S(v.apply(void 0,e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberFormatInformation=t.HorizontalAlignment=t.CellValueType=t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.renderedValue=t.formattedValue=t.hashesValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.isFormatCultureEqual=t.isSystemCultureTag=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.aggregationError=t.fractionOverflow=t.dateOverflow=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0;var n,i,a,o,s,u,l,c,d,p,m,f,g,h,v,S=r(0),y=r(59),F=r(112),C=r(53);function R(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function b(e,t,r){return{renderWidth:e,bestFit:r,getTextWidth:t}}!function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.AggregationError="AggregationError",e.PreviousFormatFailure="PreviousFormatFailure"}(n||(t.FormatReasonKind=n={})),t.ReasonKind=S.__assign(S.__assign({},y.LangReasonKind),n),t.notValueString=function(e){return{kind:t.ReasonKind.NotValueString,message:e}},t.notFormatString=function(e){return{kind:t.ReasonKind.NotFormatString,message:e}},t.noFormatPart={kind:t.ReasonKind.NoFormatPart},t.tooWide=function(e){return{kind:t.ReasonKind.TooWide,clip:e}},t.dateOverflow={kind:t.ReasonKind.DateOverflow},t.fractionOverflow={kind:t.ReasonKind.FractionOverflow},t.aggregationError={kind:t.ReasonKind.AggregationError},t.previousFormatFailure=function(e){return{kind:t.ReasonKind.PreviousFormatFailure,format:e}},function(e){e.FormatString="FormatString",e.KnownFormat="KnownFormat",e.IFormat="IFormat"}(i||(t.FormatLocKind=i={})),t.formatLocKnownFormat=function(e,t){return{kind:i.KnownFormat,document:e,knownFormat:t}},t.formatLocIFormat=function(e,t){return{kind:i.IFormat,document:e,iformat:t}},function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(a||(t.FormatValueType=a={})),function(e){e.English="English",e.Lunar="Lunar"}(o||(t.BidiDate=o={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(s||(t.CultureTag=s={})),t.isSystemCultureTag=function(e){return e===s.SysDate||e===s.SysTime},t.isFormatCultureEqual=function(e,t){return e.culture===t.culture&&e.numberShape===t.numberShape&&e.nationalNumberInput===t.nationalNumberInput&&e.calendar===t.calendar&&e.localCalendarInput===t.localCalendarInput&&e.tag===t.tag},function(e){e[e.LocaleInfo=0]="LocaleInfo"}(u||(t.FormatCurrency=u={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(l||(t.NamedColor=l={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(c||(t.Alignment=c={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(d||(t.GetTimeKind=d={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(p||(t.Clip=p={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(m||(t.FormattedUnitKind=m={})),t.formattedUnitGeneral=function(e,t,r,n,i,a){return{kind:m.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:i,builtin:a}},t.formattedUnitString=function(e){return{kind:m.String,str:e}},t.formattedUnitBlank=function(e){return{kind:m.Blank,str:e}},t.formattedUnitFlexible=function(e){return{kind:m.Flexible,str:e}},t.hashesValue=function(e,t){return R(e,t,c.Center,p.All)},t.formattedValue=R,t.renderedValue=R,t.isHashesValue=function(e){return!Array.isArray(e.units)},t.renderCallback=b,t.memoizedRenderCallback=function(e){var t=(0,F.makeStringMap)();return b(e.renderWidth,(function(r){if(null!=t[r])return t[r];var n=e.getTextWidth(r);return t[r]=n,n}),e.bestFit)},t.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:function(e){return e.length}},t.renderedValueToString=function(e){for(var t="",r=0,n=e.units;r<n.length;r++){var i=n[r];switch(i.kind){case m.String:t+=i.str;break;case m.Blank:for(var a=0;a<i.str.length;a+=1)t+=" "}}return t},function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(f||(t.EditKind=f={})),t.formulaEdit=function(e){return{kind:f.Formula,fmla:e}},t.stringEdit=function(e,t){return{kind:f.String,value:e,tick:t}},t.numberEdit=function(e,t){return{kind:f.Number,value:e,format:t}},t.otherEdit=function(e){return{kind:f.Other,value:e}},function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(g||(t.NumberFormatSource=g={})),t.createFormatGlobals=function(e,t){return{config:e,getTime:t}},t.evalFormatLocalsGrid=function(e,t){var r=(0,y.sheetGridRangeAnchor)(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:(0,C.success)(r.range),originSheet:(0,C.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e[e.none=0]="none",e[e.number=1]="number",e[e.string=2]="string",e[e.boolean=3]="boolean",e[e.error=4]="error"}(h||(t.CellValueType=h={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(v||(t.HorizontalAlignment=v={}));var E=function(){this.Start=null,this.End=null,this.Separator=null};t.NumberFormatInformation=E},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;var n=r(3);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(1);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordNameCycle=t.appendVisitedName=t.emptyVisitedNames=t.recordCellCycle=t.appendVisitedCell=t.emptyVisitedCells=void 0;var n=r(116),i=r(44),a=r(10);function o(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function s(e,t){return e<t?-1:e===t?0:1}function u(e,t){return"string"==typeof e?"string"!=typeof t?1:s(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function l(e,t){var r;return 0!==(r=s(e.name,t.name))?r:o(e.path,t.path,s)}function c(e,t){return{current:e,map:t}}function d(e,t){return{current:e,map:t}}t.emptyVisitedCells=c(void 0,n.RedBlackMapTree.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=u(e.sheet.index,t.sheet.index))?r:l(e.sheet.document,t.sheet.document)}))),t.appendVisitedCell=function(e,t){return(0,a.assertTrue)("calc.runtime.appendVisitedCell",t.previous===e.current),c(t,e.map.setValue(t.cell,t))},t.recordCellCycle=function(e,t){for(var r=[],n=(0,i.cellCycle)(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n},t.emptyVisitedNames=d(void 0,n.RedBlackMapTree.create((function(e,t){var r;return 0!==(r=s(e.name,t.name))||0!==(r=o(e.scope.index,t.scope.index,u))?r:l(e.scope.document,t.scope.document)}))),t.appendVisitedName=function(e,t){var r={name:t,previous:e.current};return d(r,e.map.setValue(t,r))},t.recordNameCycle=function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),(0,i.nameCycle)(r)}},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.transformBottomUp=t.isOperTerm=t.postStepTerm=t.callMachineTerm=t.callFirstOrderFuncTerm=t.callLambdaTerm=t.callNameTerm=t.noopTerm=t.conditionalTerm=t.readStackTerm=t.structRefTerm=t.cellRefTerm=t.udfTerm=t.nameTerm=t.appTerm=t.letTerm=t.lambdaTerm=t.arrayTerm=t.isOperatorName=t.worksheetFunctionNameToId=t.worksheetFunctionIdToName=t.operatorNameToId=t.operatorIdToName=t.TermKind=void 0;var a,o=r(0),s=r(25),u=r(10),l=r(137);function c(e,t){return{kind:e,data:void 0,children:void 0,position:t}}function d(e,t,r,n){var i=c(a.Array,n);return i.children=r,i.data={rows:e,cols:t},i}function p(e,t,r,n){(0,u.assertTrue)("calc.runtime.lambdaTerm: defsAndBody",r.length===1+t.reduce((function(e,t){return e+(t.hasDef?1:0)}),0)),(0,u.assertTrue)("calc.runtime.lambdaTerm: params",t.every((function(e,t,r){return!(e.hasDef&&e.isRest||e.isRest&&t!==r.length-1)})));var i=c(a.Lambda,n);return i.children=r,i.data={checkArity:e,params:t},i}function m(e,t,r,n,i){(0,u.assertTrue)("calc.runtime.letTerm",e.length===r.length);var s=c(a.Let,i);return s.children=o.__spreadArray(o.__spreadArray([],e,!0),[n],!1),s.data={rec:t,varLabels:r},s}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.CallFirstOrderFunc=-2147483635]="CallFirstOrderFunc",e[e.CallMachine=-2147483634]="CallMachine",e[e.PostStep=-2147483633]="PostStep"}(a||(t.TermKind=a={})),t.operatorIdToName=(n=(0,s.makeNewtypeIso)(s.identity,s.identity)).wrap,t.operatorNameToId=n.unwrap,t.worksheetFunctionIdToName=(i=(0,s.makeNewtypeIso)((function(e){return-e}),(function(e){return-e}))).wrap,t.worksheetFunctionNameToId=i.unwrap,t.isOperatorName=function(e){return e>0},t.arrayTerm=d,t.lambdaTerm=p,t.letTerm=m;var f=[];function g(e,t,r,n,i,o){void 0===n&&(n=f);var s=c(a.App,o);return s.children=i,s.data={funName:e,funType:t,isFormulaRoot:r,args:n},s}function h(e,t,r,n,i){var o=c(a.Name,i);return o.data={name:e,qualifier:t,source:r},o.children=n,o}function v(e,t,r,n){var i=c(a.Udf,n);return i.data={name:e,qualifier:t},i.children=r,i}function S(e,t,r,n,i,s){var u=c(a.Conditional,s);return u.children=o.__spreadArray([n],i,!0),u.data={funName:e,funType:t,isFormulaRoot:r,args:f},u}function y(e,t){var r=c(a.Noop,t);return r.children=e,r}function F(e){return e.kind>0}t.appTerm=g,t.nameTerm=h,t.udfTerm=v,t.cellRefTerm=function(e,t,r){var n=c(a.CellRef,r);return n.data={ref:e,qualifier:t},n},t.structRefTerm=function(e,t){var r=c(a.StructRef,t);return r.data=e,r},t.readStackTerm=function(e,t){var r=c(a.ReadStack,t);return r.data=e,r},t.conditionalTerm=S,t.noopTerm=y,t.callNameTerm=function(e,t,r){var n=c(a.CallName,r);return n.children=t,n.data={loc:e},n},t.callLambdaTerm=function(e,t,r,n,i){var o=c(a.CallLambda,void 0);return o.children=i,o.data={capturedLocals:e,capturedStackEnv:t,capturedStackMap:r,caller:n},o},t.callFirstOrderFuncTerm=function(e,t,r){var n=c(a.CallFirstOrderFunc,void 0);return n.children=r,n.data={source:e,caller:t},n},t.callMachineTerm=function(e,t){var r=c(a.CallMachine,t);return r.data={machine:e},r},t.postStepTerm=c(a.PostStep,void 0),t.isOperTerm=F,t.transformBottomUp=function(e,t){function r(e){if(F(e))return l.Pledge.resolve(e);switch(e.kind){case a.Let:return l.Pledge.all(e.children.map(n)).bind((function(t){return m(t.slice(0,t.length-1),e.data.rec,e.data.varLabels,t[t.length-1],e.position)}));case a.App:return l.Pledge.all(e.children.map(n)).bind((function(t){return g(e.data.funName,e.data.funType,e.data.isFormulaRoot,e.data.args,t,e.position)}));case a.Conditional:return l.Pledge.all(e.children.map(n)).bind((function(t){var r=t[0],n=t.slice(1);return S(e.data.funName,e.data.funType,e.data.isFormulaRoot,r,n,e.position)}));case a.Lambda:return l.Pledge.all(e.children.map(n)).bind((function(t){return p(e.data.checkArity,e.data.params,t,e.position)}));case a.Array:return l.Pledge.all(e.children.map((function(e){return l.Pledge.all(e.map(n))}))).bind((function(t){return d(e.data.rows,e.data.cols,t,e.position)}));case a.Name:return(void 0===e.children?l.Pledge.resolve(void 0):n(e.children)).bind((function(t){return h(e.data.name,e.data.qualifier,e.data.source,t,e.position)}));case a.Udf:return(void 0===e.children?l.Pledge.resolve(void 0):n(e.children)).bind((function(t){return v(e.data.name,e.data.qualifier,t,e.position)}));case a.CellRef:case a.StructRef:case a.ReadStack:return l.Pledge.resolve(e);case a.Noop:return n(e.children).bind((function(t){return y(t,e.position)}));default:return(0,u.assertNever)("calc.runtime.transformBottomUp",e)}}function n(e){return l.Pledge.resolve(e).bind(r).bind(t)}return l.Pledge.settleOrThrow(n(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;var n=r(1);t.SetKind=n.bspSet.SetKind,t.cacheKeySplitting=n.bspSet.cacheKeySplitting,t.createFromKey=n.bspSet.createFromKey,t.fromUntyped=n.bspSet.fromUntyped,t.union=n.bspSet.union,t.unionUntyped=n.bspSet.unionUntyped,t.intersect=n.bspSet.intersect,t.intersectUntyped=n.bspSet.intersectUntyped,t.meets=n.bspSet.meets,t.meetsUntyped=n.bspSet.meetsUntyped,t.except=n.bspSet.except,t.exceptUntyped=n.bspSet.exceptUntyped,t.compare=n.bspSet.compare,t.combineCmp=n.bspSet.combineCmp,t.compareUntyped=n.bspSet.compareUntyped,t.dense=n.bspSet.dense,t.empty=n.bspSet.empty,t.lazy=n.bspSet.lazy,t.symmetricDiff=n.bspSet.symmetricDiff,t.complement=n.bspSet.complement,t.getNodeCount=n.bspSet.getNodeCount,t.forEachKey=n.bspSet.forEachKey,t.forEachKeyUntyped=n.bspSet.forEachKeyUntyped},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;var n=r(24),i=r(148),a=r(147);function o(e,t){return function(r,n,i,a){if(e(r,n,i,a),!i)throw new Error("".concat(t," ").concat(r," ").concat(n," ").concat(a))}}function s(e){return{shipAssertTag:o(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:o(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function u(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return e.apply(void 0,t)}catch(e){}}}var l=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(e){var t=this;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:e,args:r})}},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var r=this.callBuffer;this.callBuffer=[];var i="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(r.length," calls before initLogger");t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i);for(var a=0,o=r;a<o.length;a++){var s=o[a];(e=t.ulsLogger.noThrowLogger)[s.method].apply(e,s.args)}}},e}(),c=function(){function e(){this.logger=new l,this.ULS=s(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(e){var t=this.logger;this.logger=e,this.ULS=s(e),this.noThrowLogger=function(e){return{shipAssertTag:u(e.shipAssertTag.bind(e)),assertTag:u(e.assertTag.bind(e)),traceTag:u(e.traceTag.bind(e)),debugTraceTag:u(e.debugTraceTag.bind(e)),dnmTraceTag:u(e.dnmTraceTag.bind(e))}}(e),t instanceof l&&t.invokeBufferedCalls()},e}();function d(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new c,t.assertNever=function(e,r){var i=(0,a.anonymize)(r),o="".concat(e,": code should be unreachable because a value has type 'never'; given ").concat(i);return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,o)},t.assertFalse=d,t.assertTrue=function(e,t){t||d("".concat(e,": expected condition to be true"))},t.assertInteger=function(e,t){(0,i.isInteger)(t)||d("".concat(e,": expected integer; given ").concat((0,a.anonymize)(t)))},t.assertNatural=function(e,t){(!(0,i.isInteger)(t)||t<0)&&d("".concat(e,": expected natural number; given ").concat((0,a.anonymize)(t)))},t.assertPositiveInteger=function(e,t){(!(0,i.isInteger)(t)||t<=0)&&d("".concat(e,": expected positive integer; given ").concat((0,a.anonymize)(t)))},t.assertIndex=function(e,t,r){(!(0,i.isInteger)(t)||t<0||t>=r)&&d("".concat(e,": expected natural number less than ").concat((0,a.anonymize)(r),"; given ").concat((0,a.anonymize)(t)))},t.assertPositiveLength=function(e,t,r){(!(0,i.isInteger)(t)||t<=0||t>r)&&d("".concat(e,": expected positive integer at most ").concat((0,a.anonymize)(r),"; given ").concat((0,a.anonymize)(t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;var n,i,a,o,s=r(1),u=s.assertions.assertNatural,l=s.assertions.assertFalse,c=s.assertions.assertIndex;!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(n||(t.OperKind=n={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(i||(t.SignatureType=i={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(a||(t.SpecialPrecs=a={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.Chart=4]="Chart",e[e.OnlyParsedDuringLoad=8]="OnlyParsedDuringLoad",e[e.Internal=16]="Internal",e[e.Allow3dRef=32]="Allow3dRef",e[e.AllowLStrs=64]="AllowLStrs",e[e.HiddenFromUI=128]="HiddenFromUI"}(o||(t.FunctionFlags=o={})),t.functionType=function(e,t,r,n,i,a,o,s){if(u("calc.lang.functionType",t),c("calc.lang.functionType",e,t+1),0===n.length?0!==i.length:i.length>=n.length){var d=JSON.stringify(i);l("calc.lang.functionType: expected tailTypes.length < restTypes.length; given ".concat(d))}if(0===n.length&&r.length+i.length<t){d=JSON.stringify(r);l("calc.lang.functionType: expected headTypes.length + tailTypes.length >= ".concat(t,"; given ").concat(d))}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:i,returnType:a,staticPrecs:o,flags:s}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(3);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.spillErrorOper=n.value.spillErrorOper,t.connectErrorOper=n.value.connectErrorOper,t.blockedErrorOper=n.value.blockedErrorOper,t.unknownErrorOper=n.value.unknownErrorOper,t.fieldErrorOper=n.value.fieldErrorOper,t.calcErrorOper=n.value.calcErrorOper,t.busyErrorOper=n.value.busyErrorOper,t.externalErrorOper=n.value.externalErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRefMustBeCellRefNode=t.withDelim=t.addSpan=t.addWhitespace=t.getSpan=t.getNodeSpan=t.makeState=t.ListSep=void 0;var n,i=r(0),a=r(81),o=r(41),s=r(52),u=r(33),l=r(58);!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(n||(t.ListSep=n={})),t.makeState=function(e,t,r,i,a){var o;return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:i,origin:a,delim:{delimId:void 0,listSep:n.Union,stack:(o={},o[s.DelimId.Paren]=!1,o[s.DelimId.Brace]=!1,o[s.DelimId.Bracket]=!1,o)},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given ".concat((0,a.anonymize)(t));(0,o.assertFalse)(n)}return r},t.getSpan=function(e,t){var r=e.spans[t];return(0,o.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r};var c=[];function d(e,t){var r="string"==typeof t?c:t.filter(l.isCommentToken);return["string"==typeof t?t:t.map((function(e){return e.chars})).join(""),r.length>0?r.map((function(t){return function(e,t){var r=p(e,t.start,t.start+t.chars.length,"","");return t.kind===s.TokenKind.SingleLineComment?(0,u.singleLineComment)(t.chars,r):(0,u.multiLineComment)(t.chars,t.isClosed,r)}(e,t)})):void 0]}function p(e,t,r,n,i){var a=e.label;e.label+=1;var o=d(e,n),s=o[0],l=o[1],c=d(e,i),p=c[0],m=c[1];return e.spans[a]=(0,u.formulaSpan)(t,r,s,p,l,m),a}function m(e,t,r){return function(n,i,a,o,s){var u=e(a);return r(n,i,a,(function(e,r){return t(a,u),o(e,r)}),(function(){return t(a,u),s}))}}t.addWhitespace=d,t.addSpan=p,t.withDelim=function(e,t){var r=e.delimId,n=e.listSep;return m((function(e){var t,a=e.delim;return e.delim={delimId:r,listSep:n,stack:i.__assign(i.__assign({},a.stack),(t={},t[r]=!0,t))},a}),(function(e,t){return e.delim=t}),t)},t.cellRefMustBeCellRefNode=function(e){return m((function(e){var t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),(function(e,t){return e.cellRefMustBeCellRefNode=t}),e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(1);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(14);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(1);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LambdaOper=t.RecordOper=void 0;var n=r(8),i=r(18),a=function(){function e(e,t){void 0===t&&(t=n.valueErrorOper),this._fields=e,this._fallback=t,this.kind=i.OperKind.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}();t.RecordOper=a;var o=function(){function e(e,t,r,n,a,o,s){this.checkArity=e,this.lambdaNodeLabel=t,this.params=r,this.locals=n,this.stackEnv=a,this.stackMap=o,this.defsAndBody=s,this.kind=i.OperKind.Rich}return e.prototype.getFallback=function(){return n.valueErrorOper},e.prototype.getField=function(e){},e}();t.LambdaOper=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedTableData=t.columnData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.RecalcServiceCreateMode=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaData=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;var n=r(2),i=r(136);Object.defineProperty(t,"RibbonFormat",{enumerable:!0,get:function(){return i.RibbonFormat}}),t.worksheetFunctionName=(0,n.typedInstanceCreator)()((function(e,t){return{functionId:e,functionName:t}})),t.errorTypeName=(0,n.typedInstanceCreator)()((function(e,t){return{errorType:e,errorName:t}})),t.localeData=(0,n.typedInstanceCreator)()((function(e,t,r,n,i,a,o,s,u,l,c,d,p,m,f,g,h,v,S,y,F,C,R,b,E,P,k,T,A,N,_,I,O,M,D,w,L,x,K,U,B,W,G,V,j,q,H,z,Q,Y,J){return{worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:Q,trueName:r,falseName:n,rowLetter:i,columnLetter:a,leftBrace:o,rightBrace:s,leftBracket:u,rightBracket:l,decimalSeparator:c,listSeparator:d,columnSeparator:p,rowSeparator:m,thousandsData:f,thousandsSeparator:g,lcid:h,country:v,numberDecimals:S,isExpSepBySpace:y,fractionSeparator:F,isPercentSepBySpace:C,currencyFormat:R,isCurrencySymbolLead:b,isCurrencySepBySpace:E,currencySymbol:P,currencyDecimals:k,dateOrder:T,dateSeparator:A,dateAltSeparator:N,year4Digits:_,month2Digits:I,day2Digits:O,longDateFormat:M,timeSeparator:D,timeAltSeparator:w,hour2Digits:L,clock24Hour:x,isAMPMSepBySpace:K,ampmSymbols:U,dayNameShort:B,dayNameLong:W,monthNameShort:G,monthNameLong:V,pictureSpecial:j,pictureSingle:q,pictureColor:H,pictureDbnum:z,sysDateFormat:Y,sysTimeFormat:J}})),t.numberFormat=(0,n.typedInstanceCreator)()((function(e,t,r){return{iformat:e,formatString:t,builtIn:r}})),t.sheetName=(0,n.typedInstanceCreator)()((function(e,t){return{sheetId:e,sheetName:t}})),t.blankValue={kind:"Blank"},t.errorValue=(0,n.typedInstanceCreator)()((function(e){return{kind:"Error",type:e}})),t.richValue=(0,n.typedInstanceCreator)()((function(e){return{kind:"Rich",fields:e}})),t.getCellValueKind=function(e){return"object"==typeof e?e.kind:typeof e},t.getCellFormatKind=function(e){return"object"==typeof e?e.kind:typeof e},t.cellLocation=(0,n.typedInstanceCreator)()((function(e,t){return{row:e,column:t}})),t.rangeLocation=(0,n.typedInstanceCreator)()((function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}})),t.sheetRangeLocation=(0,n.typedInstanceCreator)()((function(e,t,r,n,i){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:i}})),t.sheetCellLocation=(0,n.typedInstanceCreator)()((function(e,t,r){return{sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}})),t.cellData=(0,n.typedInstanceCreator)()((function(e,t,r,n,i){return{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:i}})),t.cellFormulaCellData=function(e,r,n,i){return(0,t.cellData)(e,r,n,i,"CellFormula")},t.arrayFormulaCellData=function(e,r,n){return(0,t.cellData)(void 0,e,r,n,"ArrayFormula")},t.valueCellData=function(e,r,n,i){return(0,t.cellData)(e,r,n,i,"Value")},t.rangeUpdate=(0,n.typedInstanceCreator)()((function(e,t,r,n,i){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:i}})),t.rangeWrite=(0,n.typedInstanceCreator)()((function(e,r,n,i){return(0,t.rangeUpdate)(e,r,void 0,n,i)})),t.rangePromote=function(e,r,n,i){return(0,t.rangeUpdate)(e,void 0,r,n,i)},t.arrayData=(0,n.typedInstanceCreator)()((function(e,t){return{isSpilled:e,formulaBarText:t}})),t.arrayUpdate=(0,n.typedInstanceCreator)()((function(e,t,r){return{range:e,data:t,fromStateId:r}})),t.arrayWrite=function(e,r){return(0,t.arrayUpdate)(e,r,void 0)},t.arrayPromote=function(e,r){return(0,t.arrayUpdate)(e,void 0,r)},t.unusedCellsUpdate=(0,n.typedInstanceCreator)()((function(e,t){return{sheetId:e,usedRange:t}})),t.namedValueData=(0,n.typedInstanceCreator)()((function(e){return{kind:"NamedValue",value:e}})),t.namedFormulaData=(0,n.typedInstanceCreator)()((function(e){return{kind:"NamedFormula",formulaBarText:e}})),t.namedRangeData=(0,n.typedInstanceCreator)()((function(e){return{kind:"NamedRange",range:e}})),t.columnData=(0,n.typedInstanceCreator)()((function(e,t){return{column:e,name:t}})),t.namedTableData=(0,n.typedInstanceCreator)()((function(e,t,r,n){return{kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}})),t.namedFailureData=(0,n.typedInstanceCreator)()((function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}})),t.namedObject=(0,n.typedInstanceCreator)()((function(e,t){return{name:e,data:t}})),t.namedObjectsUpdate=(0,n.typedInstanceCreator)()((function(e,t,r){return{scope:e,objects:t,fromStateId:r}})),t.namedObjectsWrite=function(e,r){return(0,t.namedObjectsUpdate)(e,r,void 0)},t.undefinedNamesWrite=function(e){return(0,t.namedObjectsUpdate)(e,void 0,void 0)},t.namedObjectsPromote=function(e,r){return(0,t.namedObjectsUpdate)(e,void 0,r)};var a;t.rangeFormulaEdit=function(e,t,r,n,i,a){return void 0===a&&(a="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:i,kind:a}},t.cellFormulaRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,void 0,n,i,"CellFormula")},t.valueRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,n,void 0,i,"Value")},t.inferredRangeFormulaEdit=function(e,r,n,i){return(0,t.rangeFormulaEdit)(e,r,void 0,n,i,"Inferred")},t.formatEditOperation=(0,n.typedInstanceCreator)()((function(e,t,r,n){return{kind:e,format:t,ribbon:r,changeDecimals:n}})),t.formatEditSetFormat=function(e){return(0,t.formatEditOperation)("SetFormat",e,void 0,void 0)},t.formatEditRibbonFormat=function(e){return(0,t.formatEditOperation)("RibbonFormat",void 0,e,void 0)},t.formatEditChangeDecimals=function(e){return(0,t.formatEditOperation)("ChangeDecimals",void 0,void 0,e)},t.rangeFormatEdit=(0,n.typedInstanceCreator)()((function(e,t,r,n){return{range:e,operation:t,origin:r,viewport:n}})),t.arrayFormulaEdit=(0,n.typedInstanceCreator)()((function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}})),t.rangePasteEdit=(0,n.typedInstanceCreator)()((function(e,t,r,n){return{kind:e,target:t,source:r,viewport:n}})),t.copyPasteRangePasteEdit=function(e,r,n){var i=(0,t.sheetCellLocation)(e.sheetId,e.row,e.column);return(0,t.rangePasteEdit)("CopyPaste",i,r,n)},t.inferredFormat=(0,n.typedInstanceCreator)()((function(e,t,r){return{format:e,category:t,decimals:r}})),t.cellDataDelta=(0,n.typedInstanceCreator)()((function(e,t,r,n,i){return{formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:i}})),t.rangeDelta=(0,n.typedInstanceCreator)()((function(e,t){return{range:e,data:t}})),t.arrayDelta=(0,n.typedInstanceCreator)()((function(e,t){return{range:e,data:t}})),t.rangeFailure=(0,n.typedInstanceCreator)()((function(e,t){return{range:e,reason:t}})),t.recalcResults=(0,n.typedInstanceCreator)()((function(e,t,r,n,i,a){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:i,rangeFailures:a}})),t.evalFormulaFormat=(0,n.typedInstanceCreator)()((function(e,t,r){return{kind:e,iformat:t,knownFormat:r}})),t.evalFormulaFormatOrigin=function(){return(0,t.evalFormulaFormat)("Origin")},t.evalFormulaFormatIformat=function(e){return(0,t.evalFormulaFormat)("Iformat",e)},t.evalFormulaFormatKnown=function(e){return(0,t.evalFormulaFormat)("Known",void 0,e)},t.evalFormulaFormatInferred=function(){return(0,t.evalFormulaFormat)("Inferred")},t.evalFormulaFormatAggregate=function(){return(0,t.evalFormulaFormat)("Aggregate")},t.evalFormulaData=function(e,t){return{value:e,formatted:t}},t.updateRequest=(0,n.typedInstanceCreator)()((function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}})),t.runExperiment=(0,n.typedInstanceCreator)()((function(e,t){return{name:e,param:t}})),t.recalcServiceConfig=(0,n.typedInstanceCreator)()((function(e,t,r,n,i,a,o,s,u,l,c,d){return void 0===c&&(c=null==l?void 0:l/(l>=1?1:10)),{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:l,samplePrecisionPrintValueRate:c,sampleRecalcStatisticsRate:s,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:i,sampleRecalcViewportStopwatchRate:a,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:d,runExperiments:u}})),t.workbookProps=(0,n.typedInstanceCreator)()((function(e,t,r){return{date1904:e,dateCompatibility:t,timezone:r}})),function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(a||(t.RecalcServiceCreateMode=a={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookGrid=t.CloningTarget=t.usedRangeIsect=t.usedRangeJoin=t.denseUsedRange=t.emptyUsedRange=t.mergeGridStatistics=t.emptyGridStatistics=t.hiddennessFullyUnavailable=t.isBlankGridValue=t.blankGridValue=t.isClientValueUnknownOper=t.clientValueUnknownOper=t.ClientOperKind=t.blankClientGridFormula=t.isBlankGridFormula=t.blankRangeGridFormula=t.blankCellGridFormula=t.SpecialString=t.SpecialBoolean=t.isBlankCellFormat=t.blankCellFormat=void 0;var n=r(0),i=r(54),a=r(11),o=r(15),s=r(72),u=r(30),l=r(92),c=r(2),d=r(69),p=r(39),m=r(20),f=r(20),g=r(5),h=r(35);function v(e){return Array.isArray(e)}t.blankCellFormat=0;var S,y;t.isBlankCellFormat=function(e){return 0===e},function(e){e.ClientValueUnknown="ClientValueUnknown"}(S||(t.SpecialBoolean=S={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(y||(t.SpecialString=y={})),t.blankCellGridFormula={fmla:"",lexicalKind:o.LexicalKind.Cell,origin:(0,o.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,c.staticAssertExtends)(),t.blankRangeGridFormula={fmla:"",lexicalKind:o.LexicalKind.Range,origin:(0,o.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1},(0,c.staticAssertExtends)();var F;function C(e){return e.kind===F.ClientValueUnknown}function R(e,t){return(0,a.isBlankOper)(e)&&void 0===t}function b(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!(0,a.isGridCellEqual)(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function E(e,r){return e.forEachMeets(r,(function(r,n){if(n.fmla.length>0){var i=n.lexicalKind===o.LexicalKind.Cell?t.blankCellGridFormula:t.blankRangeGridFormula;e=e.setValue(r,i)}return!0})),e}function P(e,r){return e.forEachMeets(r,(function(r,n){return(n.fmla===y.ClientValueUnknown||n.fmla.length>0)&&(e=e.setValue(r,t.blankClientGridFormula)),!0})),e}function k(e,t,r,n){var i=(0,p.intersectProduct)(t,u.availableReadProduct),a=(0,p.project)((0,p.intersectProduct)(r,i),"row","col");return(0,u.forEachCellInSet)((0,p.exceptProduct)(t,a),(function(t){return e=e.setValue(t,n),!0})),e}t.isBlankGridFormula=function(e,t){return""===e&&!t},t.blankClientGridFormula=t.blankCellGridFormula,function(e){e.ClientValueUnknown="ClientValueUnknown"}(F||(t.ClientOperKind=F={})),t.clientValueUnknownOper={kind:F.ClientValueUnknown},t.isClientValueUnknownOper=C,t.blankGridValue={oper:s.blankOper,failure:void 0},(0,c.staticAssertExtends)(),t.isBlankGridValue=R,t.hiddennessFullyUnavailable={hidden:[],available:[]};var T,A={values:(0,l.makeGridRangeTable)(),formats:(0,l.makeGridRangeTable)(),styles:(0,l.makeGridRangeTable)(),formulae:(0,l.makeGridRangeTable)(),dirty:d.empty};function N(e,r){return e===t.emptyUsedRange?r:r===t.emptyUsedRange?e:(0,a.gridRangeJoin)(e,r)}function _(e,r){return e===t.emptyUsedRange||r===t.emptyUsedRange?t.emptyUsedRange:(0,a.gridRangeIsect)(e,r)}t.emptyGridStatistics={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0},t.mergeGridStatistics=function(e,t){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+t.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+t.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+t.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+t.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+t.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+t.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+t.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+t.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+t.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+t.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+t.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+t.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+t.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+t.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+t.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+t.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+t.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+t.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+t.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+t.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+t.hiddenColsNodeCount}},t.emptyUsedRange=void 0,t.denseUsedRange=(0,o.gridRange)(0,0,o.sheetRows,o.sheetCols),t.usedRangeJoin=N,t.usedRangeIsect=_,function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(T||(t.CloningTarget=T={}));var I=function(){function e(e,r,n,i,a,o,s,u,c,p){void 0===e&&(e=A),void 0===r&&(r=d.empty),void 0===n&&(n=t.denseUsedRange),void 0===i&&(i=d.empty),void 0===a&&(a=d.empty),void 0===o&&(o=d.empty),void 0===s&&(s=d.empty),void 0===u&&(u=(0,l.makeGridRangeTable)()),void 0===c&&(c=!1),void 0===p&&(p=!1),this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=e,this.serverAvailability=r,this.serverUsed=n,this.hiddenRows=i,this.hiddenRowsAvailability=a,this.hiddenCols=o,this.hiddenColsAvailability=s,this.mergeCells=u,this.inFilterMode=c,this.filterModeAvailable=p,this.rollBackToServerState(0)}return e.create=function(){return new e},e.prototype.clone=function(t){void 0===t&&(t=T.Server);var r=new e(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return t===T.Client&&(r.editedContents=this.editedContents,r.clientContents=this.clientContents,r.recalcValues=this.recalcValues,r.recalcDirty=this.recalcDirty,r.recalcFailures=this.recalcFailures,r.editedTaint=this.editedTaint,r.recalcTaint=this.recalcTaint,r.editedAvailability=this.editedAvailability),r},e.prototype.advanceState=function(e,r){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=d.empty,this.serverUsed=t.denseUsedRange,this.hiddenRows=this.hiddenRowsAvailability=d.empty,this.hiddenCols=this.hiddenColsAvailability=d.empty,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState(r)},e.prototype.rollBackToServerState=function(e){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=d.empty,this.rollBackToEditedState(e)},e.prototype.rollBackToEditedState=function(e){this.setClientContents(this.editedContents,e),this.recalcValues=this.editedContents.values,this.recalcFailures=d.empty,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=(0,u.createCellSetFromRange)(e),n=(0,p.intersectProduct)(r,u.availableReadProduct),i=(0,p.intersectProduct)(t,n),a=(0,p.project)((0,p.exceptProduct)(n,i),"row","col"),o=(0,p.compareProduct)(i,n);return!!(void 0!==o&&o>=0)||a},e.prototype.forEachRecalcDirty=function(e,t){return(0,u.forEachCellInSet)((0,p.intersectProduct)(this.recalcDirty,(0,u.createCellSetFromRange)(e)),t)},e.prototype.hasRecalcDirty=function(e){return(0,p.meetsProduct)(this.recalcDirty,(0,u.createCellSetFromRange)(e))},e.prototype.hasRecalcFailure=function(e){return(0,p.meetsProduct)(this.recalcFailures,(0,u.createCellSetFromRange)(e))},e.prototype.hasEditedEditTaint=function(e){return(0,p.meetsProduct)(this.editedTaint,(0,u.createCellSetFromRange)(e))},e.prototype.hasRecalcEditTaint=function(e){return(0,p.meetsProduct)(this.recalcTaint,(0,u.createCellSetFromRange)(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r=u.bspFactory.row((0,c.pair)(e,t)),n=(0,d.intersect)(this.hiddenRowsAvailability,r),a=[];(0,u.forEachRow)(n,(function(e){var t=e[0],r=e[1];return a.push((0,i.interval)(t,r)),!0}));var o=[];return(0,u.forEachRow)((0,d.intersect)(this.hiddenRows,n),(function(e){var t=e[0],r=e[1];return o.push((0,i.interval)(t,r)),!0})),{hidden:o,available:a}},e.prototype.tryGetHiddenRows=function(e,t){var r=this.getHiddenRows(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,g.success)(r.hidden):(0,g.failure)({kind:m.UnavailableKind.HiddenRows})},e.prototype.setHiddenRows=function(e,t){var r=u.bspFactory.row((0,c.pair)(e.row,e.row+e.rows));this.hiddenRows=(0,d.union)((0,d.except)(this.hiddenRows,r),(0,d.intersect)(t,r)),this.hiddenRowsAvailability=(0,d.union)(this.hiddenRowsAvailability,r)},e.prototype.getHiddenCols=function(e,t){var r=u.bspFactory.col((0,c.pair)(e,t)),n=(0,d.intersect)(this.hiddenColsAvailability,r),a=[];(0,u.forEachCol)(n,(function(e){var t=e[0],r=e[1];return a.push((0,i.interval)(t,r)),!0}));var o=[];return(0,u.forEachCol)((0,d.intersect)(this.hiddenCols,n),(function(e){var t=e[0],r=e[1];return o.push((0,i.interval)(t,r)),!0})),{hidden:o,available:a}},e.prototype.tryGetHiddenCols=function(e,t){var r=this.getHiddenCols(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?(0,g.success)(r.hidden):(0,g.failure)({kind:m.UnavailableKind.HiddenCols})},e.prototype.setHiddenCols=function(e,t){var r=u.bspFactory.col((0,c.pair)(e.col,e.col+e.cols));this.hiddenCols=(0,d.union)((0,d.except)(this.hiddenCols,r),(0,d.intersect)(t,r)),this.hiddenColsAvailability=(0,d.union)(this.hiddenColsAvailability,r)},e.prototype.setMergeCell=function(e){this.mergeCells=this.mergeCells.setValue(e,!0)},e.prototype.getMergeCell=function(e){var t;return this.mergeCells.forEachGe(e,(function(e){return t=e,!0})),t},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?(0,g.success)(this.inFilterMode):(0,g.failure)({kind:m.UnavailableKind.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(e,r,n,i){var o=(0,p.intersectProduct)(e,u.availableSetProduct);return(0,u.forEachRangeInSet)((0,p.intersectProduct)(n,o),(function(e){return i.formulae.forEachMeets(e,(function(n,i){return!!(0,t.isBlankGridFormula)(i.fmla,void 0!==i.compiledFmla)||(0,a.forEachCellInRange)((0,a.gridRangeIsect)(e,n),r)}))}))},e.prototype.forEachReadableCellInSet=function(e,t,r){var n=(0,p.intersectProduct)(e,u.availableReadProduct);return(0,u.forEachRangeInSet)((0,p.intersectProduct)(r,n),(function(e){return(0,a.forEachCellInRange)(e,t)}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)},e.prototype.promoteServerAvailability=function(e,t){var r=(0,p.intersectProduct)(e,u.availableSetProduct),n=this.oldAvailabilities[t];if(void 0===n)return!1;var i=(0,p.compareProduct)(n,r);return void 0!==i&&i>=0&&(this.unionAvailability(!0,(0,p.intersectProduct)(e,u.availableAllProduct)),this.unionTaint(!0,d.empty),this.unionUsed(!0,(0,u.cellSetBounds)(e)),!0)},e.prototype.extendServerUnused=function(e,r){var n=e===t.emptyUsedRange?d.empty:(0,u.createCellSetFromRange)(e),i=(0,p.complementProduct)(n),a=this.serverContents,o=a.values,s=a.formats,l=a.styles,c=a.formulae,m=a.dirty;(0,u.forEachRangeInSet)(i,(function(e){return o.forEachLe(e,(function(e,r){return R(r.oper,r.failure)||(o=o.setValue(e,t.blankGridValue)),!0})),s.forEachLe(e,(function(e,r){return(0,t.isBlankCellFormat)(r)||(s=s.setValue(e,t.blankCellFormat)),!0})),l.forEachLe(e,(function(e,t){return t!==f.SpecialStyle.Blank&&(l=l.setValue(e,f.SpecialStyle.Blank)),!0})),!0})),(0,u.forEachRangeInSet)(i,(function(e){return c=E(c,e),!0})),m=(0,p.exceptProduct)(m,i),this.setContents(!0,{values:o,formats:s,styles:l,formulae:c,dirty:m},r);var g=(0,p.intersectProduct)(i,u.availableReadProduct);this.serverAvailability=this.editedAvailability=(0,p.unionProduct)(this.serverAvailability,g),this.editedTaint=this.recalcTaint=d.empty;var h=this.serverUsed;h=_(h,e),this.serverUsed=this.editedUsed=h},e.prototype.setRecalcFailure=function(e){this.recalcFailures=(0,p.unionProduct)(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=(0,p.unionProduct)(this.recalcTaint,e)},e.prototype.setRecalcValue=function(e,t){var r=this;(0,a.forEachCellInRange)(e,(function(e,n,i){return r.recalcValues=r.recalcValues.setValue(e,{oper:v(t)?t[n][i]:t,failure:void 0}),!0})),this.recalcDirty=(0,p.exceptProduct)(this.recalcDirty,(0,u.createCellSetFromRange)(e))},e.prototype.setClientContents=function(e,t){this.clientContents=e},e.prototype.setClientValue=function(e,t,r){var i=this.clientContents.values;(0,a.forEachCellInRange)(e,(function(e,r,n){return i=i.setValue(e,{oper:v(t)?t[r][n]:t,failure:void 0}),!0})),this.setClientContents(n.__assign(n.__assign({},this.clientContents),{values:i}),r)},e.prototype.setClientFormula=function(e,t,r,i){var o=this.clientContents.formulae;o=P(o,e),void 0!==t?o=o.setValue(t,r):(0,a.forEachCellInRange)(e,(function(e){return o=o.setValue(e,r),!0})),this.setClientContents(n.__assign(n.__assign({},this.clientContents),{formulae:o}),i)},e.prototype.setClientFormat=function(e,t,r){var i=this.clientContents.formats;(0,a.forEachCellInRange)(e,(function(e){return i=i.setValue(e,t),!0})),this.setClientContents(n.__assign(n.__assign({},this.clientContents),{formats:i}),r)},e.prototype.getRecalcValues=function(e){for(var r=e.row,n=e.col,i=e.rows,a=e.cols,o=new Array(i),s=0;s<i;s+=1)o[s]=(0,h.arrayFill)(new Array(a),t.blankGridValue);return this.recalcValues.forEachLe(e,(function(e,t){return o[e.row-r][e.col-n]=t,!0})),o},e.prototype.forEachRecalcValue=function(e,t){return this.recalcValues.forEachMeets(e,t)},e.prototype.getClientValue=function(e){var r=this.clientContents.values.getValue(e);return null!=r?r:t.blankGridValue},e.prototype.getServerValue=function(e){var r=this.serverContents.values.getValue(e);return null!=r?r:t.blankGridValue},e.prototype.getEditedValue=function(e){var r=this.editedContents.values.getValue(e);return null!=r?r:t.blankGridValue},e.prototype.forEachEditedValue=function(e,t){return this.editedContents.values.forEachMeets(e,t)},e.prototype.getServerFormula=function(e){return this.getFormula(e,this.serverContents.formulae)},e.prototype.getClientFormula=function(e){return this.getFormula(e,this.clientContents.formulae)},e.prototype.setEditedFormat=function(e,t){this.editedContents=n.__assign(n.__assign({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var r=this.editedContents.formats.getValue(e);return null!=r?r:t.blankCellFormat},e.prototype.forEachEditedFormat=function(e,t){return this.editedContents.formats.forEachMeets(e,t)},e.prototype.getServerFormat=function(e){var r=this.serverContents.formats.getValue(e);return null!=r?r:t.blankCellFormat},e.prototype.getEditedStyle=function(e){var t=this.editedContents.styles.getValue(e);return null!=t?t:f.SpecialStyle.Blank},e.prototype.getServerStyle=function(e){var t=this.serverContents.styles.getValue(e);return null!=t?t:f.SpecialStyle.Blank},e.prototype.getClientFormat=function(e){var r=this.clientContents.formats.getValue(e);return null!=r?r:t.blankCellFormat},e.prototype.getEditedFormula=function(e){return this.getFormula(e,this.editedContents.formulae)},e.prototype.forEachEditedFormula=function(e,t){return this.editedContents.formulae.forEachMeets(e,t)},e.prototype.getFormula=function(e,r){var n=void 0;return r.forEachGe(e,(function(e,r){return!!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)||(n=[e,r],!1)})),n},e.prototype.setContents=function(e,t,r){e&&(this.serverContents=t),this.editedContents=t,e&&this.setClientContents(this.editedContents,r),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=d.empty},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=(0,p.unionProduct)(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?d.empty:(0,p.unionProduct)(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r=e?this.serverUsed:this.editedUsed;r=N(r,t),e&&(this.serverUsed=r),this.editedUsed=r},e.prototype.setCellContents=function(e,t,r,n,i,a,o,s,u){this.setCommon(e,t,void 0,r,n,i,a,o,s,u)},e.prototype.setRangeFormula=function(e,t,r,n,i,a,o,s){var l=(0,u.createCellSetFromRange)(t);this.setCommon(e,l,t,r,n,void 0,i,a,o,s)},e.prototype.setCommon=function(e,r,i,a,o,s,l,c,m,g){var h=this,v=e?this.serverContents:this.editedContents,S=v.values,y=v.formats,F=v.styles,C=v.formulae,P=v.dirty,T=void 0===a&&void 0!==o||void 0!==(null==a?void 0:a.compiledFmla),A=a;void 0!==a&&((0,u.forEachRangeInSet)(r,(function(e){return C=E(C,e),!0})),(0,t.isBlankGridFormula)(a.fmla,void 0!==a.compiledFmla)&&(A=void 0));var N=void 0!==A&&void 0===i?a:void 0,_=void 0!==A&&void 0!==i?a:void 0,I=o;void 0!==o&&R(o,s)&&((0,u.forEachRangeInSet)(r,(function(e){return S.forEachLe(e,(function(e,r){return R(r.oper,r.failure)||(S=S.setValue(e,t.blankGridValue)),!0})),!0})),P=T?(0,p.unionProduct)(P,r):(0,p.exceptProduct)(P,r),I=void 0);var O=void 0!==I?{oper:I,failure:s}:void 0,M=l;void 0!==l&&(0,t.isBlankCellFormat)(l)&&((0,u.forEachRangeInSet)(r,(function(e){return y.forEachLe(e,(function(e,r){return(0,t.isBlankCellFormat)(r)||(y=y.setValue(e,t.blankCellFormat)),!0})),!0})),M=void 0);var D=M===f.SpecialFormat.Weak?void 0:M,w=M===f.SpecialFormat.Weak?M:void 0,L=c;void 0!==c&&c===f.SpecialStyle.Blank&&((0,u.forEachRangeInSet)(r,(function(e){return F.forEachLe(e,(function(e,t){return t!==f.SpecialStyle.Blank&&(F=F.setValue(e,f.SpecialStyle.Blank)),!0})),!0})),L=void 0);var x=L===f.SpecialStyle.Weak?void 0:L,K=L===f.SpecialStyle.Weak?L:void 0,U=r;if(!e){var B=(0,p.intersectProduct)(r,u.availableSetProduct),W=(0,p.project)((0,p.intersectProduct)(this.editedAvailability,B),"row","col"),G=(0,p.intersectProduct)(r,void 0!==m?(0,u.createCellSetFromRange)(m):d.empty);U=(0,p.unionProduct)(W,G)}if(void 0===N&&void 0===D&&void 0===x&&void 0===O||((0,u.forEachCellInSet)(U,(function(e){return void 0!==N&&(C=b(C,e,N)),void 0!==D&&(y=y.setValue(e,D)),void 0!==x&&(F=F.setValue(e,x)),void 0!==O&&(S=S.setValue(e,O)),!0})),void 0===N&&void 0===O||(P=T?(0,p.unionProduct)(P,U):(0,p.exceptProduct)(P,U))),void 0!==_){C=b(C,i,_);var V=(0,u.createCellSetFromRange)(i);P=T?(0,p.unionProduct)(P,V):(0,p.exceptProduct)(P,V)}void 0!==w&&(y=k(y,U,e?this.serverAvailability:this.editedAvailability,f.SpecialFormat.Unavailable)),void 0!==K&&(F=function(e,t,r){var n=(0,p.intersectProduct)(t,u.availableReadProduct),i=(0,p.project)((0,p.intersectProduct)(r,n),"row","col");return(0,u.forEachCellInSet)((0,p.exceptProduct)(t,i),(function(t){return e=e.setValue(t,f.SpecialStyle.Unavailable),!0})),e}(F,U,e?this.serverAvailability:this.editedAvailability));var j=void 0===o?d.empty:U,q=void 0===a?d.empty:U,H=void 0===l?d.empty:U,z=void 0===o&&void 0===l?d.empty:U;e||((0,u.forEachRangeInSet)(j,(function(e){return h.setClientValue(e,t.clientValueUnknownOper,g),!0})),void 0!==a&&(void 0!==i?this.setClientFormula(i,i,a,g):(0,u.forEachRangeInSet)(q,(function(e){return h.setClientFormula(e,void 0,a,g),!0}))),l===f.SpecialFormat.Weak?this.setClientContents(n.__assign(n.__assign({},this.clientContents),{formats:k(this.clientContents.formats,H,this.editedAvailability,f.SpecialFormat.ClientValueUnknown)}),g):(0,u.forEachRangeInSet)(H,(function(e){return h.setClientFormat(e,f.SpecialFormat.ClientValueUnknown,g),!0}))),this.setContents(e,{values:S,formats:y,styles:F,formulae:C,dirty:P},g),this.unionAvailability(e,(0,p.intersectProduct)(j,u.availableAllProduct)),e||(this.editedAvailability=(0,p.exceptProduct)(this.editedAvailability,(0,p.exceptProduct)(r,U))),this.unionTaint(e,z),this.unionUsed(e,(0,u.cellSetBounds)(r))},e.prototype.copyRange=function(e){function t(t,r){return t.forEachLe(e,(function(e,t){return r=r.setValue(e,t),!0})),r}var r=A.values,n=A.formats,i=A.styles,o=A.formulae,s=this.editedContents,l=s.values,c=s.formats,d=s.styles,m=s.formulae;r=t(l,r),n=t(c,n),i=t(d,i),m.forEachMeets(e,(function(t,r){return o=o.setValue((0,a.gridRangeIsect)(t,e),r),!0}));var f=(0,a.gridRangeAnchor)(e),g=(0,p.intersectProduct)(this.editedAvailability,(0,u.createCellSetFromRange)(e)),h=_(this.editedUsed,e);return{origin:f,formats:n,styles:i,values:r,formulae:o,availability:g,used:h}},e.prototype.pasteRange=function(e,r,i){var a=(0,u.createCellSetFromRange)(e),s=(0,o.gridRange)(r.origin.row,r.origin.col,e.rows,e.cols),l=this.editedContents,c=l.values,m=l.formats,g=l.styles,h=l.formulae,v=l.dirty,F=this.editedUsed,C=e.row-r.origin.row,R=e.col-r.origin.col;function b(e){return(0,o.gridRange)(e.row+C,e.col+R,e.rows,e.cols)}function E(t,r,n){return r.forEachMeets(e,(function(e,t){return r=r.setValue(e,n),!0})),t.forEachLe(s,(function(e,t){return r=r.setValue(b(e),t),!0})),r}var k=N(F,r.used!==t.emptyUsedRange?b(r.used):t.emptyUsedRange),T=_(k,e);c=E(r.values,c,t.blankGridValue),T!==t.emptyUsedRange&&this.setClientValue(T,t.clientValueUnknownOper,i),m=E(r.formats,m,t.blankCellFormat),g=E(r.styles,g,f.SpecialStyle.Blank),T!==t.emptyUsedRange&&this.setClientFormat(T,f.SpecialFormat.ClientValueUnknown,i),h=E(r.formulae,h,t.blankCellGridFormula),v=(0,p.exceptProduct)(v,a);var A=this.clientContents.formulae;A=P(A,e),h.forEachLe(e,(function(e,t){var r=t.origin,n=t.compiledFmla;return void 0!==n&&(v=(0,p.unionProduct)(v,(0,u.createCellSetFromRange)(e))),A=A.setValue(e,{fmla:y.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:S.ClientValueUnknown}),!0})),this.setClientContents(n.__assign(n.__assign({},this.clientContents),{formulae:A}),i);var I;this.setContents(!1,{values:c,formats:m,styles:g,formulae:h,dirty:v},i),this.editedAvailability=(0,p.exceptProduct)(this.editedAvailability,a),this.unionAvailability(!1,(I=r.availability,(0,u.translateAvailabilitySet)(I,C,R))),this.unionTaint(!1,T===t.emptyUsedRange?d.empty:(0,u.createCellSetFromRange)(T)),this.unionUsed(!1,k)},e.prototype.assumeRecalcFinal=function(e,t){this.recalcDirty=(0,p.exceptProduct)(this.recalcDirty,e)},e.prototype.getDirtyEditedCells=function(){return(0,p.intersectProduct)(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return(0,p.exceptProduct)(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return(0,p.exceptProduct)(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e,r){var n=e?this.serverContents:this.editedContents;this.setContents(e,n,r),this.unionAvailability(e,d.empty),this.unionTaint(e,d.empty),this.unionUsed(e,t.emptyUsedRange)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:(0,p.getSubspaceCount)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:(0,p.getSubspaceCount)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:(0,p.getSubspaceCount)(this.recalcDirty),recalcFailuresSetSubspaceCount:(0,p.getSubspaceCount)(this.recalcFailures),recalcTaintSetSubspaceCount:(0,p.getSubspaceCount)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(0,p.getSubspaceCount)(this.editedAvailability),hiddenRowsNodeCount:(0,d.getNodeCount)(this.hiddenRows)+(0,d.getNodeCount)(this.hiddenRowsAvailability),hiddenColsNodeCount:(0,d.getNodeCount)(this.hiddenCols)+(0,d.getNodeCount)(this.hiddenColsAvailability)}},e.prototype.collectGarbage=function(e,r){var n=d.empty;for(var i in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(i)){var a=Number(i);if(a>=e){n=(0,p.unionProduct)(n,this.oldAvailabilities[a]);continue}delete this.oldAvailabilities[a],this.availabilityHistorySize-=1}function o(e){return(0,p.meetsProduct)((0,p.intersectProduct)((0,u.createCellSetFromRange)(e),u.availableSetProduct),n)}function s(e,r){return!(0,t.isBlankGridFormula)(r.fmla,void 0!==r.compiledFmla)&&o(e)}function l(e,r){return!(0,t.isBlankCellFormat)(r)&&o(e)}function c(e,t){return t!==f.SpecialStyle.Blank&&o(e)}function m(e,t){return!(!C(t.oper)&&R(t.oper,t.failure))&&o(e)}var g=(0,p.project)(n,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(s),formats:this.serverContents.formats.filter(l),styles:this.serverContents.styles.filter(c),values:this.serverContents.values.filter(m),dirty:(0,p.intersectProduct)(this.serverContents.dirty,g)},this.editedContents={formulae:this.editedContents.formulae.filter(s),formats:this.editedContents.formats.filter(l),styles:this.editedContents.styles.filter(c),values:this.editedContents.values.filter(m),dirty:(0,p.intersectProduct)(this.editedContents.dirty,g)},this.setClientContents({formulae:this.clientContents.formulae.filter(s),formats:this.clientContents.formats.filter(l),values:this.clientContents.values.filter(m)},r),this.recalcValues=this.recalcValues.filter(m),this.recalcDirty=(0,p.intersectProduct)(this.recalcDirty,g)},e}();t.PartialWorkbookGrid=I},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gridinterface=t.helpers=t.mockGlobals=t.notificationKinds=t.testUtils=t.mockTimer=t.timelineQueueProcessor=t.repeatedTaskScheduler=t.types=t.PackageName=void 0;var n=r(0);t.PackageName="excel-online-x10-types",t.types=n.__importStar(r(492)),t.repeatedTaskScheduler=n.__importStar(r(305)),t.timelineQueueProcessor=n.__importStar(r(307)),t.mockTimer=n.__importStar(r(493)),t.testUtils=n.__importStar(r(495)),t.notificationKinds=n.__importStar(r(497)),t.mockGlobals=n.__importStar(r(498)),t.helpers=n.__importStar(r(501)),t.gridinterface=n.__importStar(r(502))},function(e,t,r){"use strict";r.r(t),r.d(t,"WorkerError",(function(){return c})),r.d(t,"isThreadingSupported",(function(){return h})),r.d(t,"setConfig",(function(){return v})),r.d(t,"dispatchWorkerError",(function(){return R})),r.d(t,"paramInsideDef",(function(){return P})),r.d(t,"Endpoint",(function(){return K})),r.d(t,"importScriptsWithRetry",(function(){return W})),r.d(t,"isWorkerThread",(function(){return G})),r.d(t,"workerName",(function(){return V})),r.d(t,"createWorker",(function(){return ie}));var n={};r.r(n),r.d(n,"WorkerError",(function(){return c})),r.d(n,"isThreadingSupported",(function(){return h})),r.d(n,"setConfig",(function(){return v})),r.d(n,"dispatchWorkerError",(function(){return R})),r.d(n,"paramInsideDef",(function(){return P})),r.d(n,"Endpoint",(function(){return K})),r.d(n,"importScriptsWithRetry",(function(){return W})),r.d(n,"isWorkerThread",(function(){return G})),r.d(n,"workerName",(function(){return V}));var i=r(0);function a(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function s(e){return o(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:a(e)?e.baseMessage:e.message,stack:e.stack,info:a(e)?(t=e.info,Object(i.__assign)(Object(i.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function l(e){return o(e)?{isError:!0,value:u(e)}:{isError:!1,value:e}}var c=function(e){function t(t,r){var n,a=this.constructor,o=e.call(this,"".concat(t,"; info = ").concat(JSON.stringify(Object(i.__assign)(Object(i.__assign)({},r),{error:null===(n=r.error)||void 0===n?void 0:n.message}))))||this;o.baseMessage=t,o.info=r,o.name="WorkerError";var s=a.prototype;return Object.getPrototypeOf(o)!==s&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(o,s):o.__proto__=s),o}return Object(i.__extends)(t,e),t.isWorkerError=a,t}(Error);var d={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function p(e){var t;if("WorkerError"===e.name)t=new c(e.message,function(e){return Object(i.__assign)(Object(i.__assign)({},e),{error:e.error?p(e.error):void 0})}(e.info));else{var r=d[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function m(e){return e.isError?p(e.value):e.value}var f,g;function h(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function v(e){if(g)throw new TypeError("setConfig has already been called");g=e}function S(){var e=null!=g?g:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(i.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function y(e){setTimeout((function(){throw e}))}function F(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function C(e){var t=F();if(void 0!==t){var r={kind:f.WorkerError,error:l(e)};t.postMessage(r)}else console.warn(e)}function R(e){var t;try{(null!==(t=null==g?void 0:g.onWorkerError)&&void 0!==t?t:C)(e)}catch(t){console.warn(e),y(t)}}function b(e){var t=F();if(void 0!==t){var r={kind:f.CreateWorker,stats:e};t.postMessage(r)}}function E(e){var t;try{(null!==(t=null==g?void 0:g.onCreateWorker)&&void 0!==t?t:b)(e)}catch(e){y(e)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(f||(f={}));var P=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return P.transfer.apply(P,Object(i.__spreadArray)([e,void 0],t,!1))};P.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var k=r(14),T=Object(k.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(k.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});function A(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}var N,_;function I(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function O(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function M(){return null!=N?N:N=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}()}function D(e,t){var r=O(),n=T("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(t,r){var n;return"then"===r?void 0:null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)}:function(t,r){var n;return null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function w(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(_||(_={}));var L=-1,x=function(){function e(e,t){var r,n,i=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=O();var a=function(){var e;return null===(e=i.onClose)||void 0===e?void 0:e.call(i)},o=((r={})[_.Invoke]=this.onInvoke.bind(this),r[_.Result]=this.onResult.bind(this),r[_.Names]=function(e){var t,r=e.funcNames;null===(t=i.onImports)||void 0===t||t.call(i,D(i.createPostProxy.bind(i),r),D(i.createCallProxy.bind(i),r))},r[_.Close]=a,r),s=((n={})[_.Invoke]=this.onSendInvokeFailed.bind(this),n[_.Result]=this.onSendResultFailed.bind(this),n[_.Names]=a,n[_.Close]=a,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return s[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t=M()?void 0:function(e){for(var t=O();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var i=n[r];try{"function"==typeof e[i]&&(t[i]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e),r={kind:_.Names,funcNames:t};this.port.postMessage(r)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;var e={kind:_.Close};for(var t in this.port.postMessage(e),this.port.close(),this.unresolvedCalls){var r=this.unresolvedCalls[t],n=r.reject,i=r.funcName,a={cause:"Connection",idInfo:this.idInfo,funcName:i};n(new c("Importing Endpoint closed while waiting for ".concat(i," result"),a))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,i=e.args,a=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,i);var a=r>=0?"call":"post",o={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new c("Exporting Endpoint received a ".concat(a," to unknown function ").concat(n),o)}));r>=0?a.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):a.catch((function(e){var i=s(e),a={cause:"UnhandledError",idInfo:t.idInfo,error:i,callId:r,funcName:n};R(new c("Exporting Endpoint's ".concat(n," implementation threw or rejected"),a))}))},e.prototype.sendResult=function(e,t,r,n){var i=l(n),a={kind:_.Result,callId:e,funcName:t,isFulfilled:r,resultValue:i};try{this.port.postMessage(a,void 0)}catch(e){this.onSendResultFailed(a,s(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,i=e.resultValue,a=t?"Exporting Endpoint failed to send ".concat(n," result"):"Importing Endpoint failed to deserialize ".concat(n," result"),o={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},s=new c(a,o);i.isError?R(s):this.sendResult(r,n,!1,s)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var i=this;if(r>1<<30)return n;return I(r,(function(){var n=i.takeCallbacks(e);if(n){var a={cause:"Timeout",idInfo:i.idInfo,timeout:r,callId:e,funcName:t};n.reject(new c("Importing Endpoint's call to ".concat(t," timed out"),a))}}),n)},e.prototype.sendCall=function(e,t,r,n){var a=this;return new Promise((function(o,u){var l=L+=1,d={kind:_.Invoke,callId:l,funcName:e,args:t};a.unresolvedCalls[l]=Object(i.__assign)(Object(i.__assign)({},a.setCallTimeout(l,e,r,{resolve:o,reject:u})),{funcName:e});try{a.port.postMessage(d,n)}catch(t){var p=a.takeCallbacks(l);if(p){var m=s(t),f={cause:"MessageError",idInfo:a.idInfo,error:m,callId:l,funcName:e};p.reject(new c("Importing Endpoint failed to send call to ".concat(e),f))}}}))},e.prototype.sendPost=function(e,t,r,n){var i={kind:_.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(i,n)}catch(t){var a=s(t),o={cause:"MessageError",idInfo:this.idInfo,error:a,callId:-1,funcName:e};r(new c("Importing Endpoint failed to post to ".concat(e),o))}},e.prototype.onSendInvokeFailed=function(e){var t,r=e.callId,n=e.funcName,i=r>=0?"call":"post",a={cause:"MessageError",idInfo:this.idInfo,callId:r,funcName:n},o=new c("Exporting Endpoint failed to deserialize ".concat(i," to ").concat(n),a),s=r>=0?this.takeCallbacks(r):void 0;(null!==(t=null==s?void 0:s.reject)&&void 0!==t?t:R)(o)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,i=e.resultValue;if(t>=0){var a=this.takeCallbacks(t);if(a)(n?a.resolve:a.reject)(m(i))}else{var o={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:r};R(new c("Exporting Endpoint sent a result for a post to ".concat(r),o))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(i.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,a,o,s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];if(!t.isClosed){var l=null!==(o=null!==(i=r.onPostMessageError)&&void 0!==i?i:null===(a=t.getOnPostMessageError)||void 0===a?void 0:a.call(t))&&void 0!==o?o:w;t.sendPost(e,s,l,n)}},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(i.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,a,o,s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];if(t.isClosed){var l={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new c("".concat(t.idInfo.side," Endpoint's call.").concat(e," called after close"),l))}var d=null!==(o=null!==(i=r.callTimeout)&&void 0!==i?i:null===(a=t.getCallTimeout)||void 0===a?void 0:a.call(t))&&void 0!==o?o:1/0;return t.sendCall(e,s,d,n)},r.callTimeout=void 0,r},e}();var K=function(){function e(e,t,r){this.callTimeout=1/0,this.onPostMessageError=w,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new c("".concat(e.side," Endpoint's ").concat(t," referenced before the ").concat(r," Endpoint started"),n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var i,a,o=r.port,s=r.options,u=r.createMode,l={type:"Endpoint",side:t,id:null==s?void 0:s.id};try{i=new x(l,o),a=new e(l,i,u)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var o;i.getCallTimeout=function(){return a.callTimeout},i.getOnPostMessageError=function(){return a.onPostMessageError},i.onImports=function(e,t){Object.defineProperties(a,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),p.resolve()},i.onClose=function(){return a.close("Force")};var u,d=function(e){var t,r;return null!==(r=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==g?void 0:g.createTimeout)&&void 0!==r?r:3e5}(s),p=I(d,(function(){var e="Outside"===t?"inside":"outside",r={cause:"Timeout",idInfo:l,timeout:d},n=new c("".concat(t," Endpoint timed out waiting for the ").concat(e," to start"),r);p.reject(n)}),{resolve:e,reject:r});a._closedDuringCreate=function(){p.resolve()};try{u=n(a)}catch(e){return p.reject(e)}null===(o=a._state)||void 0===o||o.setExports(u)})).then((function(){return a._closedDuringCreate=void 0,a}),(function(e){return a._closedDuringCreate=void 0,a.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new c("".concat(this._idInfo.side," Endpoint's close called during creation"),n)}this._closedDuringCreate()}var i=this._state;this._state=void 0;try{i.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:s(e)};R(new c("".concat(this._idInfo.side," Endpoint's close threw an error"),n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r)},e}();function U(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var i=e.slice(0,n+1),a=e.slice(n+1).split("&"),o=0;o<a.length&&("="!==a[o][t.length]||a[o].slice(0,t.length)!==t);o+=1);return a[o]="".concat(t,"=").concat(r),i+a.join("&")}function B(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?U(e,"retries",String(n)):e)}catch(e){r=e}throw r}function W(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){B(n[r],t)}else importScripts.apply(void 0,e)}function G(){return"undefined"!=typeof WorkerGlobalScope}function V(){return self.name}var j='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return f})),r.d(t,"__runInitializers",(function(){return l})),r.d(t,"__propKey",(function(){return s})),r.d(t,"__setFunctionName",(function(){return d})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return y})),r.d(t,"__generator",(function(){return v})),r.d(t,"__createBinding",(function(){return _})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return b})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return w})),r.d(t,"__spreadArray",(function(){return O})),r.d(t,"__await",(function(){return j})),r.d(t,"__asyncGenerator",(function(){return G})),r.d(t,"__asyncDelegator",(function(){return S})),r.d(t,"__asyncValues",(function(){return P})),r.d(t,"__makeTemplateObject",(function(){return T})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return F})),r.d(t,"__classPrivateFieldGet",(function(){return k})),r.d(t,"__classPrivateFieldSet",(function(){return C})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var u,c=n.kind,f="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,s=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var v in n)y[v]="access"===v?{}:n[v];for(var v in n.access)y.access[v]=n.access[v];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var _=(0,r[p])("accessor"===c?{get:s.get,set:s.set}:s[f],y);if("accessor"===c){if(void 0===_)continue;if(null===_||"object"!=typeof _)throw new TypeError("Object expected");(u=a(_.get))&&(s.get=u),(u=a(_.set))&&(s.set=u),(u=a(_.init))&&o.push(u)}else(u=a(_))&&("field"===c?o.push(u):s[f]=u)}l&&Object.defineProperty(l,n.name,s),d=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var _=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||_(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function j(e){return this instanceof j?(this.v=e,this):new j(e)}function G(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function S(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:j(e[n](t)),done:!1}:o?o(t):t}:o}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&_(t,e,r);return x(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function C(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n={};function o(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";function n(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){var t;return null===(t=n()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(4),t),n.__exportStar(r(2),t),n.__exportStar(r(5),t),n.__exportStar(r(6),t),n.__exportStar(r(7),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){return i(e)?{isError:!0,value:u(e)}:{isError:!1,value:e}}function f(e){throw new ReferenceError("".concat(e," is not defined"))}function l(e,t,r){void 0===r&&(r=f);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var s=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return s.transfer.apply(s,Object(n.__spreadArray)([e,void 0],t,!1))};s.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var d;!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(d||(d={}));var p="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function y(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:p()))}function v(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function _(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?v(e,"retries",String(n)):e)}catch(e){r=e}throw r}function g(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){_(n[r],t)}else importScripts.apply(void 0,e)}var b=r(3);self.onmessage=function(e){var t,r,i=e.data,u=i.config,f=i.port,s=i.options,v=i.script,_=i.args,h=i.featureGateDictionary,m=i.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(b.setFeatureGateDictionaryGetter)((function(){return h})),Object(b.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=s.importScriptsMaxRetries)&&void 0!==t?t:u.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===u.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return g([u.typedWorkersUrl],O),(w=l(self,null!==(e=u.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(u),w}var G={status:"Pending",start:p()};function S(e,t){var r=e?void 0:c(a(t)),n={kind:d.InitResult,error:r,stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw y(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=y(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return g(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==s?void 0:s.importScriptUrls)&&void 0!==e?e:u.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==v.scriptUrl?[v.scriptUrl]:[],!0),O),l(self,v.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:u,importTypedWorkers:j,connection:{port:f,options:s,createMode:"Thread"}}],_,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);',q=-1;var H=function(){function e(e,t){var r,n;try{var i;r=function(e){var t="def"in e?e:P(e),r=t.def,n=t.args,i=t.transferables;if("function"!=typeof r)return[r,n,i,void 0];var a="__generatedInsideInit".concat(q+=1);return[{scriptUrl:void 0,insideInitName:a},n,i,"var ".concat(a," = ").concat(r.toString(),";")]}(t),this.script=r[0],this.args=r[1],this.transferables=r[2];var a=void 0===(i=r[3])?[j]:[i,"\n\n",j];this.blobUrl=URL.createObjectURL(new Blob(a,{type:"application/javascript"}));var o={};null!=e.id&&(o.name=e.id),this.worker=new Worker(this.blobUrl,o)}catch(e){throw null===(n=this.worker)||void 0===n||n.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,n=e.port,s=e.options,u={type:"Thread",side:"Outside",id:s.id},l=this.worker;return A(new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var p={config:S(),port:n,options:s,script:r.script,args:r.args,featureGateDictionary:Object(k.getFeatureGateDictionary)(),changeGateDictionary:Object(k.getChangeGateDictionary)()};l.postMessage(p,Object(i.__spreadArray)([n],r.transferables,!0)),l.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(o(r.error)){if(a(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new c("".concat(t," received an unhandled error"),n)}if(null==r.message){var i={cause:"UnhandledError",idInfo:e};return new c("".concat(t," received a non-error (worker script fetch probably failed)"),i)}var s={cause:"UnhandledError",idInfo:e},u="".concat(r.message," at ").concat(r.filename,":").concat(r.lineno,":").concat(r.colno);return new c("".concat(t," received an unhandled error: ").concat(u),s)}(u,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):R(t)},l.onmessage=function(e){var n,i,a=e.data;switch(a.kind){case f.InitResult:return t.insideInit=a.stopwatch,void 0===a.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(i=r.createCallbacks)||void 0===i?void 0:i.reject(m(a.error));case f.WorkerError:return R(m(a.error));case f.CreateWorker:return E(a.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),z="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function Q(){return{status:"Pending",start:z()}}function Y(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:z()))}function J(e,t){function r(t){throw Y(e,a(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=Y(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}}function $(e){return Math.round(1e3*e)/1e3}function X(e,t,r){return e<t?t:e>r?r:e}function Z(e,t,r){var n,i,a,o=X(null!==(n=null==e?void 0:e.start)&&void 0!==n?n:1/0,t,r),s=X(null!==(i=null==e?void 0:e.end)&&void 0!==i?i:1/0,t,r);return{status:null!==(a=null==e?void 0:e.status)&&void 0!==a?a:"Pending",start:$(o-t),end:$(s-t),duration:$(s-o)}}var ee=Object(i.__assign)(Object(i.__assign)({},n),{createWorker:ie});function te(e,t,r,n,i){var a,o=new MessageChannel,s=o.port1,u=o.port2;return Promise.all([n({port:s,options:e,createMode:t}),J(r.createOutside=Q(),(function(){return K.createOutside({port:u,options:e,createMode:t},(function(e){return i(a=e)}))}))]).then((function(){return a}),(function(e){return a?a.close("Force"):u.close(),Promise.reject(e)}))}function re(e,t,r,n){return te(e,"Local",t,(function(e){return function(e,t,r){var n="def"in r?r:P(r),a=n.def,o=n.args;if("function"!=typeof a){var s={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new c("Loading an InsideScript to create a local worker is unimplemented",s))}return Promise.resolve().then((function(){return J(t.insideInit=Q(),(function(){return a.apply(void 0,Object(i.__spreadArray)([{config:S(),importTypedWorkers:function(){return ee},connection:e}],o,!1)).then((function(){}))}))}))}(e,t,r)}),n)}function ne(e,t,r,n){var i;t.createThread=Q();try{i=new H(e,r)}catch(e){return Y(t.createThread,"Error"),Promise.reject(e)}return Y(t.createThread,"Success"),te(e,"Thread",t,(function(e){return i.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?i.terminate():e._onClose=i.terminate.bind(i),e}),(function(e){return i.terminate(),Promise.reject(e)}))}function ie(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n=null!==(r=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==g?void 0:g.createMode)&&void 0!==r?r:"Thread";return"ThreadOrLocal"===n?h()?"Thread":"Local":n}(e),i="local"in t?"Local"===n?t.local:t.thread:t,a="Local"===n?re:ne,o={id:e.id,createMode:n,createWorker:Q()};return A(J(o.createWorker,(function(){return a(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}(e),o,i,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,i=e.insideInit,a=e.createOutside,o=e.createThread,s=n.status,u=n.start,l=n.end;if("Pending"!==s&&void 0!==l)return{id:t,createMode:r,createWorker:{status:s,absStart:u,duration:$(l-u)},createThread:"Thread"===r?Z(o,u,l):void 0,createOutside:Z(a,u,l),insideInit:Z(i,u,l)}}(o);e&&E(e)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(1);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(3);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.CaretInsideArrayNodeIdentityVisitor=t.ExtractLetVisitor=void 0;var n=r(37);t.ExtractLetVisitor=n.parseResultHelperModule.ExtractLetVisitor,t.CaretInsideArrayNodeIdentityVisitor=n.parseResultHelperModule.CaretInsideArrayNodeIdentityVisitor,t.parseResultHelper=n.parseResultHelperModule.parseResultHelper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRangeValues=t.rangeValues=t.DerefOperKind=t.machine=void 0;var n,i=r(0).__importStar(r(28));t.machine=i,function(e){e.RangeValues="RangeValues"}(n||(t.DerefOperKind=n={})),t.rangeValues=function(e){return{kind:n.RangeValues,arrays:e}},t.isRangeValues=function(e){return e.kind===n.RangeValues}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(1);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCompletedFunctionSuffix=t.getStructRefCompletionItemRank=t.endOf=t.verifyTextAndRange=t.filterSuggestionsAccordingToPrefix=void 0;var n=r(24),i=r(4),a=r(2),o=r(6);t.filterSuggestionsAccordingToPrefix=function(e,t,r,n){void 0===n&&(n=!1);var i=[],o=[],s=e.toLocaleLowerCase();return""===e?{prefixedSuggestions:t,notPrefixedSuggestions:o}:(t.forEach((function(e){var t=r?r(e).toLocaleLowerCase():"string"==typeof e?e.toLocaleLowerCase():void 0;if(void 0!==t)if(!t.startsWith(s)||n&&t===s)if(n){var u=t.split(" ");(0,a.isDefined)(u.find((function(e){return e.startsWith(s)})))&&o.push(e)}else s.length>2&&t.includes(s)&&o.push(e);else i.push(e)})),{prefixedSuggestions:i,notPrefixedSuggestions:o})};t.verifyTextAndRange=function(e,t,r,n,i){var a,o,s,u,l,c,d;expect(null==e?void 0:e.label).toEqual(t),expect(null===(a=null==e?void 0:e.textEdit)||void 0===a?void 0:a.newText).toEqual(null!=i?i:t),expect(null===(u=null===(s=null===(o=null==e?void 0:e.textEdit)||void 0===o?void 0:o.range)||void 0===s?void 0:s.start)||void 0===u?void 0:u.character).toEqual(r),expect(null===(d=null===(c=null===(l=null==e?void 0:e.textEdit)||void 0===l?void 0:l.range)||void 0===c?void 0:c.end)||void 0===d?void 0:d.character).toEqual(n)};t.endOf=function(e){return e.length};t.getStructRefCompletionItemRank=function(e){var t,r,s,u,l=e.kind===o.CompletionItemKind.TableHeader?1:null!==(r=null===(t=e.label)||void 0===t?void 0:t.startsWith("#"))&&void 0!==r&&r?0:null!==(u=null===(s=e.label)||void 0===s?void 0:s.startsWith("@"))&&void 0!==u&&u?2:void 0;return(0,a.isNone)(l)?(i.ulsLogger.ULS.traceTag(526411872,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ".concat(JSON.stringify(e))),0):l},t.getCompletedFunctionSuffix=function(e,t){return"("===(null==e?void 0:e.charAt(t))?"":"("}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;var i,a,o=r(1),s=o.assertions.assertNatural,u=o.assertions.assertPositiveInteger,l=o.assertions.assertFalse,c=o.util.partialArray,d=r(71);function p(e){return{kind:d.OperKind.Error,type:e}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(i||(t.PrecsBound=i={})),t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL"}(a||(t.ErrorType=a={})),t.precedents=function(e,t,r,n,i){return{cells:e,names:t,udfs:r,special:n,bound:i}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:d.OperKind.String,value:e}},t.errorOper=function(e){var t=m[e];return void 0!==t?t:p(e)},t.nullErrorOper=p(a.NULL),t.div0ErrorOper=p(a.DIV0),t.valueErrorOper=p(a.VALUE),t.refErrorOper=p(a.REF),t.nameErrorOper=p(a.NAME),t.numErrorOper=p(a.NUM),t.naErrorOper=p(a.NA),t.gettingDataErrorOper=p(a.GETTING_DATA),t.spillErrorOper=p(a.SPILL),t.connectErrorOper=p(a.CONNECT),t.blockedErrorOper=p(a.BLOCKED),t.unknownErrorOper=p(a.UNKNOWN),t.fieldErrorOper=p(a.FIELD),t.calcErrorOper=p(a.CALC),t.busyErrorOper=p(a.BUSY),t.externalErrorOper=p(a.EXTERNAL);var m=c(((n={})[a.NULL]=t.nullErrorOper,n[a.DIV0]=t.div0ErrorOper,n[a.VALUE]=t.valueErrorOper,n[a.REF]=t.refErrorOper,n[a.NAME]=t.nameErrorOper,n[a.NUM]=t.numErrorOper,n[a.NA]=t.naErrorOper,n[a.GETTING_DATA]=t.gettingDataErrorOper,n[a.SPILL]=t.spillErrorOper,n[a.CONNECT]=t.connectErrorOper,n[a.BLOCKED]=t.blockedErrorOper,n[a.UNKNOWN]=t.unknownErrorOper,n[a.FIELD]=t.fieldErrorOper,n[a.CALC]=t.calcErrorOper,n[a.BUSY]=t.busyErrorOper,n[a.EXTERNAL]=t.externalErrorOper,n));t.arrayOper=function(e,t,r){return s("calc.lang.arrayOper",e),s("calc.lang.arrayOper",t),r.length!==e?l("calc.lang.arrayOper: Inconsistent row number"):{kind:d.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return u("calc.lang.rangeSeqOper",t.length),{kind:d.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:d.OperKind.Range,sheets:e,ranges:[t]}},t.missingOper={kind:d.OperKind.Missing},t.blankOper={kind:d.OperKind.Blank},t.trueOper={kind:d.OperKind.Boolean,value:!0},t.falseOper={kind:d.OperKind.Boolean,value:!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(1);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(1);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.countCodePoints=t.codePointIterator=void 0;var n=r(1);t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.runOperatorPrecedenceParser=t.isWSFNode=t.maybeWSFTerm=t.structRefTerm=t.fieldRefTerm=t.argsTerm=t.lambdaArgsTerm=t.TermKind=void 0;var i,a=r(0),o=r(81),s=r(41),u=r(33),l=r(82),c=r(52),d=r(63),p=r(73),m=r(62),f=r(58),g=r(43),h=r(131),v=r(56);function S(e,t,r,n){return{kind:i.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function y(e){return e.kind!==c.TokenKind.Operator&&e.kind!==c.TokenKind.Sep&&e.kind!==c.TokenKind.End&&e.kind!==c.TokenKind.Spaces&&e.kind!==c.TokenKind.SingleLineComment&&e.kind!==c.TokenKind.MultiLineComment&&!(e.kind in i)}function F(e){return e.kind===c.TokenKind.Spaces||e.kind===c.TokenKind.SingleLineComment||e.kind===c.TokenKind.MultiLineComment}function C(e,t){return y(t=t.kind===i.MaybeWSFTerm?t.node:t)?(0,p.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(i||(t.TermKind=i={})),t.lambdaArgsTerm=function(e,t,r,n){return{kind:i.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:i.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=S,t.structRefTerm=function(e,t,r){return{kind:i.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:i.MaybeWSFTerm,node:e,whole:t}};var R=(0,d.many)((0,d.take)((function(e,t){return F(t)?t:void 0}))),b=(0,d.many1)((0,d.take)((function(e,t){return F(t)?t:void 0}))),E=(0,d.peek)((function(e,t){return t})),P=function(e,t,r,n,i){var a=e[t];if(null==a){var u="calc.parse.pStart: internal error: expected term at ".concat(t," in ").concat((0,o.anonymize)(e));return(0,s.assertFalse)(u)}return n(C(r,a),t)};function k(e){return(0,d.apply)((0,d.tuple)(R,P,(0,d.take)(e),P,R),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4];return(0,u.operatorNode)(i,(0,p.addSpan)(e,n,a,r,o))}))}function T(e){return(0,d.apply)((0,d.tuple)(R,P,(0,d.take)(e),P),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,u.operatorNode)(i,(0,p.addSpan)(e,n,a,r,""))}))}function A(e){return(0,d.apply)((0,d.tuple)(P,(0,d.take)(e),P,R),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,u.operatorNode)(n,(0,p.addSpan)(e,r,i,"",a))}))}var N=k((function(e,t){return t.kind!==c.TokenKind.Operator||t.value!==l.OperatorId.Add&&t.value!==l.OperatorId.Sub?void 0:t.value})),_=A((function(e,t){if(t.kind===c.TokenKind.Operator){if(t.value===l.OperatorId.Add)return l.OperatorId.Pos;if(t.value===l.OperatorId.Sub)return l.OperatorId.Neg}})),I=A((function(e,t){return t.kind===c.TokenKind.Operator&&t.value===l.OperatorId.At?t.value:void 0})),O=T((function(e,t){return t.kind===c.TokenKind.Operator&&t.value===l.OperatorId.Pound?t.value:void 0})),M=(0,d.take)((function(e,t){return t.kind===i.StructRefTerm?t:void 0})),D=k((function(e,t){return t.kind!==c.TokenKind.Operator||t.value!==l.OperatorId.Mul&&t.value!==l.OperatorId.Div?void 0:t.value})),w=k((function(e,t){return t.kind===c.TokenKind.Operator&&t.value===l.OperatorId.Pow?t.value:void 0})),L=T((function(e,t){return t.kind===c.TokenKind.Operator&&t.value===l.OperatorId.Percent?t.value:void 0})),x=k((function(e,t){return t.kind===c.TokenKind.Operator&&t.value===l.OperatorId.Concat?t.value:void 0})),K=k((function(e,t){return t.kind===c.TokenKind.Operator&&t.value>=l.OperatorId.Eq&&t.value<=l.OperatorId.Ge?t.value:void 0})),U=k((function(e,t){return t.kind===c.TokenKind.Operator&&t.value===l.OperatorId.Range?t.value:void 0})),B=k((function(e,t){return t.kind===c.TokenKind.Operator&&t.value===l.OperatorId.Union?t.value:void 0})),W=(0,d.applyTake)((0,d.tuple)(b,E),(function(e,t){var r=t[0],n=t[1];if(!(n.kind===c.TokenKind.End||n.kind===c.TokenKind.Operator&&n.value!==l.OperatorId.At||n.kind===c.TokenKind.Sep&&(0,f.isDotSepToken)(n))){if(1!==r.length||r[0].kind!==c.TokenKind.Spaces)return r;var i=C(e,n),a=(0,p.addSpan)(e,i,i,r[0].chars,"");return(0,u.operatorNode)(l.OperatorId.Isect,a)}})),G=(0,d.take)((function(e,t){return t.kind===c.TokenKind.Sep&&(0,f.isDotSepToken)(t)?t:void 0})),V=(0,d.take)((function(e,t){return t.kind===i.ArgsTerm?t:void 0})),j=(0,d.take)((function(e,t){return t.kind===i.LambdaArgsTerm?t:void 0})),q=(0,d.take)((function(e,t){return t.kind===i.ArgsTerm||t.kind===i.FieldRefTerm?t:void 0})),H=((n={})[l.WorksheetFuncId.LETREC]=h.FeatureName.CalcLetRecFunction,n);function z(e,t){if(t.kind===i.MaybeWSFTerm&&void 0!==t.whole){var r=(0,m.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;if((0,s.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==l.WorksheetFuncId._UDF),0!=((0,l.getWorksheetFuncType)(r).flags&v.FunctionFlags.Internal))return;var n=H[r];if(void 0!==n&&!(0,h.isFeatureEnabled)(n))return;return(0,u.wsfNode)(r,t.whole,t.node.label)}}t.isWSFNode=z;var Q=(0,d.take)((function(e,t){return z(e.localeInfo,t)})),Y=(0,d.take)((function(e,t){var r=z(e.localeInfo,t);return(null==r?void 0:r.id)===l.WorksheetFuncId.LAMBDA?r:void 0}));var J=(0,d.apply)((0,d.tuple)(Y,j),(function(e,t){for(var r,n=t[0],i=t[1],a=(0,p.getNodeSpan)(e,n).start,o=i.nodes,s=(n.id,[]),l=[],c=0;c<o.length;c+=1){var d=o[c];d.kind===u.NodeKind.Param?s.push((0,u.lambdaParam)((0,u.indexedArg)(d,c))):c===o.length-1?r=(0,u.indexedArg)(d,c):l.push((0,u.indexedArg)(d,c))}var m=(0,p.addSpan)(e,a,i.end,"","");return(0,u.lambdaNode)(n,s,r,l,i.isClosed,m)})),$=(0,d.apply)((0,d.tuple)(Q,V),(function(e,t){var r,n,i=t[0],a=t[1],o=(0,p.getNodeSpan)(e,i).start,c=a.nodes;switch(i.id){case l.WorksheetFuncId.LET:case l.WorksheetFuncId.LETREC:i.id;for(var d=[],f=[],g=void 0,h=0;h<c.length;h+=1){var v=c[h];h!==c.length-1?!(h+1<c.length&&(0,m.isUnqualifiedNameNode)(v))||h+3<c.length&&(r=e.refStyle,n=c[h+2],!((0,m.isUnqualifiedNameNode)(n)||r===u.RefStyle.A1&&n.kind===u.NodeKind.CellRef&&void 0===n.qualifier&&n.ref.kind===u.CellRefKind.Single&&n.ref.col.kind===u.PosKind.Rel&&n.ref.row.kind===u.PosKind.Rel))&&(0,m.isUnqualifiedNameNode)(c[h+1])?f.push((0,u.indexedArg)(v,h)):(d.push((0,u.letVar)((0,u.indexedArg)((0,u.varNode)((0,u.identNode)(v.whole,v.parts.label),v.label),h),(0,u.indexedArg)(c[h+1],h+1))),h+=1):g=(0,u.indexedArg)(v,h)}var S=(0,p.addSpan)(e,o,a.end,"","");return(0,u.letNode)(i,d,g,f,a.isClosed,S);case l.WorksheetFuncId.LAMBDA:return(0,s.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}return te(e,i,c,a.isClosed,o,a.end)}));function X(e,t,r){return(0,d.apply)((0,d.tuple)((0,d.many)(e),t),(function(e,t){var n=t[0],i=t[1];return n.reduceRight(r(e),i)}))}function Z(e,t,r){return(0,d.apply)((0,d.tuple)(e,(0,d.many)(t)),(function(e,t){var n=t[0];return t[1].reduce(r(e),n)}))}function ee(e){return function(t,r){var n,i,a=r[0],o=r[1];if(i=a,Array.isArray(i)){var l=(0,p.getNodeSpan)(e,t);(0,s.assertTrue)("calc.parse.makeAppNodeInfix",0===l.post.length),n=(0,p.addWhitespace)(e,a),l.post=n[0],l.postComments=n[1];var c=(0,p.getNodeSpan)(e,o),d=(0,p.addSpan)(e,l.start,c.end,"","");return(0,u.badSequenceNode)(u.BadType.Unexpected,[t,o],d)}var m=(0,p.getNodeSpan)(e,t).start,f=(0,p.getNodeSpan)(e,o).end,g=(0,p.addSpan)(e,m,f,"","");return(0,u.appNode)(a,[t,o],!0,g)}}function te(e,t,r,n,i,a){var o=(0,p.addSpan)(e,i,a,"","");return(0,u.appNode)(t,r,n,o)}function re(e){return function(t,r){var n=(0,p.getNodeSpan)(e,t).start;switch(r.kind){case i.ArgsTerm:return te(e,t,r.nodes,r.isClosed,n,r.end);case i.FieldRefTerm:var a=(0,p.addSpan)(e,n,r.end,"",""),o=(0,p.getNodeSpan)(e,r.rhs),s=o.start,l=o.end,c=o.pre;if((0,m.isNumberLiteralNode)(t)){var d=(0,p.addSpan)(e,s,s,"",""),f=(0,u.missingNode)("",d),g=r.rhs.label,h=(0,p.addSpan)(e,s,l,"",""),v=(0,u.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,!1,h);return(0,u.badSequenceNode)(u.BadType.FieldRef,[t,(0,u.fieldRefNode)(f,v,g)],a)}var S=!r.rhs.isBracketed&&(0,m.shouldFieldRefBeBracketed)(t,r.rhs,c),y=(0,u.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,S,r.rhs.label);return(0,u.fieldRefNode)(t,y,a);case i.StructRefTerm:a=(0,p.addSpan)(e,n,r.end,"","");switch(t.kind){case u.NodeKind.Name:return(0,u.structRefNode)(t,r.rhs,a);case u.NodeKind.Missing:return(0,u.structRefNode)(void 0,r.rhs,a)}return(0,u.badSequenceNode)(u.BadType.StructRef,[t,(0,u.structRefNode)(void 0,r.rhs,(0,p.addSpan)(e,r.start,r.end,"",""))],a);case u.NodeKind.Operator:return te(e,r,[t],!0,n,(0,p.getNodeSpan)(e,r).end)}}}function ne(e){var t=!0;return function(r,n){var i=(0,p.getNodeSpan)(e,n).start,a=(0,p.getNodeSpan)(e,r).end,o=(0,p.addSpan)(e,i,a,"","");if((n.id===l.OperatorId.Pos||n.id===l.OperatorId.Neg)&&t&&(t=!1,(0,m.isNumberLiteralNode)(r)&&""===(0,p.getNodeSpan)(e,n).post)){var s=n.id===l.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,u.literalNode)(s,!0,o)}return(0,u.appNode)(n,[r],!0,o)}}var ie=(0,d.take)((function(e,t){return t.kind===i.MaybeWSFTerm?t.node:y(t)?t:void 0})),ae=(0,d.apply)((0,d.tuple)(R,G,P,R),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,u.badCharsNode)(u.BadType.Unexpected,n.chars,(0,p.addSpan)(e,n.start,i,r,a))})),oe=(0,d.apply)((0,d.tuple)(P,R,G,P),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=(0,p.addSpan)(e,a,a,"",""),s=(0,p.addSpan)(e,i.start,a,n,""),l=(0,u.fieldRef)((0,u.missingNode)("",o),!1,!0,!1,s);return S(n.length>0,l,r,a)})),se=(0,d.lazy)((function(){return(0,d.apply)((0,d.tuple)(P,(0,d.many)((0,d.any)(J,$,ie,ae),(0,d.any)(J,$,ie,(0,d.right)((0,d.succeeds)(I),pe))),P),(function(e,t){var r=t[0],n=t[1],i=t[2];if(1===n.length)return n[0];var a=(0,p.addSpan)(e,r,i,"","");return 0===n.length?(0,u.missingNode)("",a):(0,u.badSequenceNode)(u.BadType.Unexpected,n,a)}))})),ue=Z((0,d.lazy)((function(){return(0,d.any)((0,d.right)((0,d.succeeds)(I),pe),(0,d.right)((0,d.succeeds)(_),fe),se)})),(0,d.any)(O,M),re),le=Z(ue,(0,d.tuple)(U,ue),ee),ce=Z(le,(0,d.tuple)(W,le),ee),de=Z(ce,(0,d.any)(q,oe),re),pe=X(I,de,ne),me=Z(pe,(0,d.tuple)(B,pe),ee),fe=X(_,me,ne),ge=Z(fe,L,re),he=Z(ge,(0,d.tuple)(w,ge),ee),ve=Z(he,(0,d.tuple)(D,he),ee),Se=Z(ve,(0,d.tuple)(N,ve),ee),ye=Z(Se,(0,d.tuple)(x,Se),ee),Fe=Z(ye,(0,d.tuple)(K,ye),ee);t.runOperatorPrecedenceParser=function(e,t){var r=t.length-1;if(r<1){var n="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,s.assertFalse)(n)}if(t[r].kind!==c.TokenKind.End){n="calc.parse.runTermParser: internal error: array[n].kind !== End in ".concat((0,o.anonymize)(t));return(0,s.assertFalse)(n)}if(1===r&&y(t[0]))return t[0];if(F(t[0])){n="calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in ".concat((0,o.anonymize)(t));return(0,s.assertFalse)(n)}if(F(t[r-1])){n="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in ".concat((0,o.anonymize)(t));return(0,s.assertFalse)(n)}for(;;){var i=(0,d.runParser)(Fe,t,0,e);if((0,g.isSuccess)(i)&&i.value.index>=r)return i.value.output;if(!(0,g.isSuccess)(i)||0===i.value.index||1===i.value.index&&y(t[0])){var u=(0,g.isSuccess)(i)?i.value.index:0;n="calc.parse.runTermParser: internal error: consumed ".concat(u," out of ").concat(r," in ").concat((0,o.anonymize)(t));return(0,s.assertFalse)(n)}r=(t=a.__spreadArray([i.value.output],t.slice(i.value.index),!0)).length-1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=t.gridRangeDistance=void 0;var n=r(55);t.gridRangeDistance=n.rtree.gridRangeDistance,t.makeGridRangeTable=n.rtree.makeGridRangeTable},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.chNamedRangeData=t.chNamedFormulaData=t.chNamedValueData=t.chNamedValue=t.chUnusedCellsUpdate=t.chArrayUpdate=t.chArrayData=t.chRangeUpdate=t.chCellData=t.chCellFormat=t.chCellValue=t.chError=t.chBlank=t.chSheetCellLocation=t.chSheetRangeLocation=t.chRangeLocation=t.chCellLocation=t.chCol=t.chRow=t.chSheetName=t.chSheetId=t.chNumberFormat=t.chErrorTypeName=t.chWorksheetFunctionName=t.chFormulaText=t.isFormulaText=t.oneOfChecker=t.eqChecker=t.chArray=t.chBoolean=t.chNonemptyString=t.chString=t.chNatural=t.chInteger=t.chFiniteNumber=t.chPossiblyInfiniteNumber=t.chNever=t.intChecker=t.typeofChecker=t.taggedUnionChecker=t.arrayChecker=t.depAllChecker=t.allChecker=t.objectChecker=t.fromChecker=t.optChecker=t.filterCheck=t.check=t.checker=t.incrementStat=void 0,t.chReadOper=t.chEvalFormulaFormat=t.chWorkbookProps=t.chLocaleData=t.chPasteEdit=t.chArrayFormulaEdit=t.chRangeFormatEdit=t.chRangeFormulaEdit=t.chNamedObjectsUpdate=t.chNamedObject=t.chNamedObjectData=t.chNamedFailureData=t.chNamedTableScope=t.chNamedTableData=t.chColumnData=void 0;var i=r(2),a=r(2),o=r(51),s=r(15),u=r(115),l=r(12),c=r(9),d=r(35),p=r(136);function m(e,t){var r;e[t]=(null!==(r=e[t])&&void 0!==r?r:0)+1}function f(e,t,r){return e.push("".concat(t.join("."),": expected ").concat(r)),!1}function g(e,t){return function(r,n,i){return(0,a.isDefined)(r)&&e(r)||f(n,i,t)}}function h(e,t,r,n){for(var i=[],a=t(e,i,[n]),o=0,s=i;o<s.length;o++){m(r,s[o])}return a}function v(e){return function(t,r,n){return!!(0,a.isNone)(t)||e(t,r,n)}}function S(e){return function(t,r,n){if((0,a.isNone)(t))return f(r,n,"non-null object");var i=n.length;try{var o=!0;for(var s in e)n[i]=s,o=o&&e[s](t[s],r,n);return o}finally{n.length=i}}}function y(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,i){return e&&i(t,r,n)}),!0)}}function F(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,i){return t.reduce((function(e,t){return e&&t(r)(r,n,i)}),e(r,n,i))}}function C(e){return function(t,r,n){if(!Array.isArray(t))return f(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,i){return t&&e(i,r,n)}),!0)}finally{n.pop()}}}function R(e){var t="one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(r,n,i){if((0,a.isNone)(r))return f(n,i,"non-null object");var o=i.length;try{var s="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return(0,a.isNone)(s)?(i.push("kind"),f(n,i,t)):s(r,n,i)}finally{i.length=o}}}function b(e){var t="typeof one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(r,n,i){var o=e[typeof r];return(0,a.isNone)(o)?f(n,i,t):o(r,n,i)}}function E(e){return"number"==typeof e&&e>-1/0&&e<1/0}function P(e){return(0|e)===e||Math.floor(e)===e}function k(e,t,r){return void 0===r&&(r=0!==e?"integer >= ".concat(e," and < ").concat(t):"natural < ".concat(t)),g((function(r){return"number"==typeof r&&r>=e&&r<t&&P(r)}),r)}function T(e){return g((function(t){return t===e}),JSON.stringify(e))}function A(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=Object.create(null),n=Object.create(null),i=0,a=e;i<a.length;i++){var o=a[i];"number"==typeof o?n[o]=!0:r[o]=!0}var s="one of ".concat(JSON.stringify(e.slice().sort()));return g((function(e){switch(typeof e){case"string":case"symbol":return!0===r[e];case"number":return!0===n[e]}return!1}),s)}function N(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}t.incrementStat=m,t.checker=g,t.check=h,t.filterCheck=function(e,r,n,i){if(!h(e,t.chArray,n,i))return[];var a="".concat(i,".<index>");return e.filter((function(e){return h(e,r,n,a)}))},t.optChecker=v,t.fromChecker=function(e){return function(t,r,n){return e(t,r,n)}},t.objectChecker=S,t.allChecker=y,t.depAllChecker=F,t.arrayChecker=C,t.taggedUnionChecker=R,t.typeofChecker=b,t.intChecker=k,t.chNever=g((function(e){return!1}),"never"),t.chPossiblyInfiniteNumber=g((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),t.chFiniteNumber=g(E,"finite number"),t.chInteger=g((function(e){return E(e)&&P(e)}),"integer"),t.chNatural=k(0,1/0,"natural"),t.chString=g((function(e){return"string"==typeof e}),"string"),t.chNonemptyString=g((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),t.chBoolean=g((function(e){return"boolean"==typeof e}),"boolean"),t.chArray=g((function(e){return Array.isArray(e)}),"Array"),t.eqChecker=T,t.oneOfChecker=A,t.isFormulaText=N,t.chFormulaText=g((function(e){return"string"==typeof e&&N(e)}),"formula text"),t.chWorksheetFunctionName=S({functionId:t.chNatural,functionName:t.chNonemptyString});var _=g((function(e){return"string"==typeof e&&e.length>1&&(0,d.stringStartsWith)(e,"#")}),"error name");t.chErrorTypeName=S({errorType:t.chNatural,errorName:_}),t.chNumberFormat=S({iformat:t.chNatural,formatString:t.chString,builtIn:t.chBoolean}),t.chSheetId=g((function(e){return"string"==typeof e||E(e)}),"string or finite number"),t.chSheetName=S({sheetId:t.chSheetId,sheetName:t.chString}),t.chRow=k(0,s.sheetRows),t.chCol=k(0,s.sheetCols),t.chCellLocation=S({row:t.chRow,column:t.chCol});var I=g((function(e){return null==e.lastRow||e.lastRow>=e.row}),"lastRow >= row"),O=g((function(e){return null==e.lastColumn||e.lastColumn>=e.column}),"lastColumn >= column"),M=y(t.chCellLocation,S({lastRow:v(t.chRow),lastColumn:v(t.chCol)}));t.chRangeLocation=F(M,(function(e){return I}),(function(e){return O})),t.chSheetRangeLocation=y(t.chRangeLocation,S({sheetId:t.chSheetId})),t.chSheetCellLocation=y(t.chSheetRangeLocation,S({lastRow:v(t.chNever),lastColumn:v(t.chNever)})),t.chBlank=S({kind:T("Blank")}),t.chError=S({kind:T("Error"),type:t.chNatural}),t.chCellValue=b({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:R({Blank:t.chBlank,Error:t.chError})}),t.chCellFormat=b({number:t.chNatural,string:t.chString}),t.chCellData=y(S({value:t.chCellValue,iformat:t.chNatural,failureReason:v(t.chString)}),R({CellFormula:S({formulaBarText:t.chFormulaText}),ArrayFormula:S({formulaBarText:v(t.chNever)}),Value:S({formulaBarText:t.chString})})),t.chRangeUpdate=S({range:t.chSheetRangeLocation,excludeRows:v(C(t.chRow)),excludeColumns:v(C(t.chCol)),data:v(t.chCellData),fromStateId:v(t.chInteger)}),t.chArrayData=S({isSpilled:t.chBoolean,formulaBarText:t.chFormulaText}),t.chArrayUpdate=S({range:t.chSheetRangeLocation,data:v(t.chArrayData),fromStateId:v(t.chInteger)}),t.chUnusedCellsUpdate=S({sheetId:t.chSheetId,usedRange:v(t.chRangeLocation)}),t.chNamedValue=b({number:t.chFiniteNumber,string:t.chString,boolean:t.chBoolean,object:R({Error:t.chError})}),t.chNamedValueData=S({kind:T("NamedValue"),value:t.chNamedValue}),t.chNamedFormulaData=S({kind:T("NamedFormula"),formulaBarText:t.chFormulaText}),t.chNamedRangeData=S({kind:T("NamedRange"),range:t.chSheetRangeLocation}),t.chColumnData=S({column:t.chNatural,name:t.chNonemptyString});var D=function(e){var t;return(null!==(t=e.lastRow)&&void 0!==t?t:e.row)-e.row+1},w=function(e){var t;return(null!==(t=e.lastColumn)&&void 0!==t?t:e.column)-e.column+1},L=g((function(e){return(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+D(e.range)<s.sheetRows)}),"enough rows for headers and totals"),x=g((function(e){var t=e.range.column,r=e.range.column+w(e.range);return e.columns.every((function(e){return e.column>=t&&e.column<r}))}),"column names in range");t.chNamedTableData=F(S({kind:T("NamedTable"),range:t.chSheetRangeLocation,hasHeadersRow:t.chBoolean,hasTotalsRow:t.chBoolean,columns:C(t.chColumnData)}),(function(e){return L}),(function(e){return x}));t.chNamedTableScope=function(e){return g((function(t){var r;return"NamedTable"!==(null===(r=t.data)||void 0===r?void 0:r.kind)||null==e}),"NamedTable at global scope")},t.chNamedFailureData=S({kind:T("NamedFailure"),failureReason:t.chString,objectKind:v(A("NamedValue","NamedFormula","NamedRange","NamedTable"))}),t.chNamedObjectData=R({NamedValue:t.chNamedValueData,NamedFormula:t.chNamedFormulaData,NamedRange:t.chNamedRangeData,NamedTable:t.chNamedTableData,NamedFailure:t.chNamedFailureData});var K=S({name:t.chString,data:v(t.chNamedObjectData)});t.chNamedObject=function(e){return F(K,(function(r){return(0,t.chNamedTableScope)(e)}))},t.chNamedObjectsUpdate=S({scope:v(t.chSheetId),objects:v(t.chArray),fromStateId:v(t.chInteger)});var U=g((function(e){return e.length>0}),"a non-empty array"),B=g((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),W=F(C(t.chSheetRangeLocation),(function(e){return U}),(function(e){return B}));t.chRangeFormulaEdit=y(S({range:W,origin:v(t.chCellLocation),viewport:v(t.chSheetRangeLocation)}),R({CellFormula:S({formulaBarText:t.chFormulaText,value:v(t.chNever)}),Value:S({formulaBarText:t.chString,value:t.chCellValue}),Inferred:S({formulaBarText:t.chString,value:v(t.chNever)})}));var G=R({SetFormat:S({format:t.chCellFormat}),RibbonFormat:S({ribbon:A.apply(void 0,(0,a.strEnumArray)(p.RibbonFormat))}),ChangeDecimals:S({changeDecimals:k(-20,20)})});t.chRangeFormatEdit=S({range:W,operation:G,origin:v(t.chCellLocation),viewport:v(t.chSheetRangeLocation)}),t.chArrayFormulaEdit=S({range:t.chSheetRangeLocation,formulaBarText:g((function(e){return"string"==typeof e&&(0===e.length||N(e))}),"empty string or text denoting formula"),origin:v(t.chCellLocation),viewport:v(t.chSheetRangeLocation)});var V=g((function(e){var t=w(e.source),r=D(e.source);return e.target.column+t<=s.sheetCols&&e.target.row+r<=s.sheetRows}),"(target,source) in range");t.chPasteEdit=F(S({kind:A("CopyPaste"),target:t.chSheetCellLocation,source:t.chSheetRangeLocation,viewport:v(t.chSheetRangeLocation)}),(function(e){return V}));var j=g((function(e){return 2===e.length}),"2 AM/PM symbols"),q=g((function(e){return 7===e.length}),"7 day symbols"),H=g((function(e){return 12===e.length}),"12 month symbols");function z(e){var t=(0,a.numEnumMap)(e,a.identity);return g((function(e){return e.every((function(e,r){return null==e||r in t}))}),"indexes in enum")}var Q=z(c.SpecialRefId),Y=z(l.PictureSpecial),J=z(l.PictureSingle),$=z(l.PictureColor),X=z(l.PictureDbnum);t.chLocaleData=S({worksheetFunctionNames:t.chArray,thousandsData:C(t.chNatural),errorTypeNames:t.chArray,specialRefNames:F(C(v(t.chNonemptyString)),(function(e){return Q})),trueName:t.chNonemptyString,falseName:t.chNonemptyString,rowLetter:t.chNonemptyString,columnLetter:t.chNonemptyString,leftBrace:t.chNonemptyString,rightBrace:t.chNonemptyString,leftBracket:t.chNonemptyString,rightBracket:t.chNonemptyString,decimalSeparator:t.chNonemptyString,listSeparator:t.chNonemptyString,columnSeparator:t.chNonemptyString,rowSeparator:t.chNonemptyString,thousandsSeparator:t.chString,lcid:t.chNatural,country:t.chNatural,numberDecimals:t.chNatural,isExpSepBySpace:t.chBoolean,fractionSeparator:t.chNonemptyString,isPercentSepBySpace:t.chBoolean,currencyFormat:A(u.CurrencyFormat.Paren,u.CurrencyFormat.Lead,u.CurrencyFormat.Intern,u.CurrencyFormat.Trail),isCurrencySymbolLead:t.chBoolean,isCurrencySepBySpace:t.chBoolean,currencySymbol:t.chString,currencyDecimals:t.chNatural,dateOrder:A(u.DateOrder.MDY,u.DateOrder.DMY,u.DateOrder.YMD,u.DateOrder.MYD,u.DateOrder.DYM,u.DateOrder.YDM),dateSeparator:t.chString,dateAltSeparator:t.chString,year4Digits:t.chBoolean,month2Digits:t.chBoolean,day2Digits:t.chBoolean,longDateFormat:t.chBoolean,timeSeparator:t.chString,timeAltSeparator:v(t.chString),hour2Digits:t.chBoolean,clock24Hour:t.chBoolean,isAMPMSepBySpace:t.chBoolean,ampmSymbols:F(C(t.chString),(function(e){return j})),dayNameShort:F(C(t.chString),(function(e){return q})),dayNameLong:F(C(t.chString),(function(e){return q})),monthNameShort:F(C(t.chString),(function(e){return H})),monthNameLong:F(C(t.chString),(function(e){return H})),pictureSpecial:F(C(v(t.chNonemptyString)),(function(e){return Y})),pictureSingle:F(C(v(t.chNonemptyString)),(function(e){return J})),pictureColor:F(C(v(t.chNonemptyString)),(function(e){return $})),pictureDbnum:F(C(v(t.chNonemptyString)),(function(e){return X})),sysDateFormat:t.chString,sysTimeFormat:t.chString});var Z=S({yr:t.chInteger,mon:k(1,13),dom:k(1,6),wdy:k(1,8),hour:k(0,24),min:k(0,60),sec:k(0,60),fracSec:T(0),rounding:k(0,4)}),ee=F(S({bias:t.chFiniteNumber,standardDate:v(Z),standardBias:t.chFiniteNumber,daylightDate:v(Z),daylightBias:t.chFiniteNumber}),(function(e){return g((function(e){return(0,a.isNone)(e.standardDate)===(0,a.isNone)(e.daylightDate)}),"standardDate iff daylightDate")}));t.chWorkbookProps=S({date1904:v(t.chBoolean),dateCompatibility:v(t.chBoolean),timezone:v(ee)}),t.chEvalFormulaFormat=v(R({Origin:S({iformat:v(t.chNever),knownFormat:v(t.chNever)}),Iformat:S({iformat:t.chNatural,knownFormat:v(t.chNever)}),Known:S({iformat:v(t.chNever),knownFormat:A.apply(void 0,(0,i.numEnumArray)(u.KnownFormat))}),Inferred:S({iformat:v(t.chNever),knownFormat:v(t.chNever)}),Aggregate:S({iformat:v(t.chNever),knownFormat:v(t.chNever)})}));var te=((n={})[o.OperKind.Number]=!0,n[o.OperKind.String]=!0,n[o.OperKind.Boolean]=!0,n[o.OperKind.Error]=!0,n[o.OperKind.Array]=!1,n[o.OperKind.Blank]=!0,n[o.OperKind.Rich]=!1,n);t.chReadOper=g((function(e){return te[e.kind]}),"supported ReadOper")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.incrementFailure=t.RecalcServiceDataTransformer=t.initialRecalcServiceConfig=void 0;var n=r(0),i=r(15),a=r(2),o=r(12),s=r(93),u=r(93),l=r(120),c=r(9),d=r(163),p=r(129),m=r(20),f=r(106),g=r(23),h=r(54),v=r(4);t.initialRecalcServiceConfig={localeInfo:(0,o.getEnglishLocaleInfo)(),mathpack:d.xlMathpack,refStyle:c.RefStyle.A1,timezone:p.tzUTC,date1904:!1,dateCompatibility:!0,datepack:p.xlDatepack};var S=function(){function e(){this.document=(0,i.documentLoc)(void 0,""),this.langConfig=t.initialRecalcServiceConfig}return e.prototype.getLangConfig=function(){return this.langConfig},e.prototype.setA1ReferenceStyle=function(e,t,r){this.langConfig=n.__assign(n.__assign({},this.langConfig),{refStyle:r?c.RefStyle.A1:c.RefStyle.R1C1}),e.setLangConfig(t,this.langConfig)},e.prototype.setLocaleInfo=function(e,t,r,i){(0,u.check)(r,u.chLocaleData,i,"localeData")&&(this.langConfig=n.__assign(n.__assign({},this.langConfig),{localeInfo:(0,l.createLocaleInfo)(r,i)}),e.setLangConfig(t,this.langConfig))},e.prototype.setWorkbookProps=function(e,r,i,a){var o,s,l;(0,u.check)(i,u.chWorkbookProps,a,"workbookProps")&&(this.langConfig=n.__assign(n.__assign({},this.langConfig),{date1904:null!==(o=i.date1904)&&void 0!==o?o:t.initialRecalcServiceConfig.date1904,dateCompatibility:null!==(s=i.dateCompatibility)&&void 0!==s?s:t.initialRecalcServiceConfig.dateCompatibility,timezone:null!==(l=i.timezone)&&void 0!==l?l:t.initialRecalcServiceConfig.timezone}),e.setLangConfig(r,this.langConfig))},e.prototype.updateSheetNames=function(e,t,r,n){e.setSheetNames(this.document,(0,u.filterCheck)(r,u.chSheetName,n,"sheetNames"),t)},e.prototype.updateNamedObjects=function(e,t,r,n){for(var o=0,s=(0,u.filterCheck)(r,u.chNamedObjectsUpdate,n,"namedObjectsUpdates");o<s.length;o++){var c=s[o],d=c.scope,p=c.objects,m=c.fromStateId,f=(0,i.nameScope)(this.document,(0,a.isDefined)(d)?d:void 0);if((0,a.isDefined)(p))for(var g=0,h=(0,u.filterCheck)(p,(0,u.chNamedObject)(d),n,"namedObjectsUpdates.<index>.objects");g<h.length;g++){var v=h[g],S=v.name,y=v.data;e.writeNamedObject(t,f,S,(0,l.namedObjectDataToNamedObject)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,y))}else(0,a.isDefined)(m)?e.promoteNamedObjects(t,f,m):e.writeUndefinedNames(t,f)}},e}();t.RecalcServiceDataTransformer=S,t.incrementFailure=function(e,t){var r,n;switch(t.kind){case h.ReasonKind.NotImplemented:for(var i=0,a=t.features;i<a.length;i++){var o=a[i];(0,s.incrementStat)(e,"".concat(h.ReasonKind.NotImplemented," ").concat(o))}break;case h.ReasonKind.IllFormedFormula:(0,s.incrementStat)(e,"".concat(h.ReasonKind.IllFormedFormula," ").concat(null!==(r=t.mode)&&void 0!==r?r:""," ").concat(JSON.stringify({diagnostics:null!==(n=t.diagnostics)&&void 0!==n?n:{},message:t.mode===m.FormulaMode.ServerCellFormula||t.mode===m.FormulaMode.ServerNamedFormula?t.message:void 0})));break;case h.ReasonKind.Unavailable:for(var u=0,l=t.objects;u<l.length;u++){var c=l[u],d=[h.ReasonKind.Unavailable];if("string"==typeof c.kind&&c.kind in m.UnavailableKind){var S=c;switch(d.push(S.kind),S.kind){case m.UnavailableKind.SheetId:d.push(S.sheetId);break;case m.UnavailableKind.NameLoc:d.push(S.source),d.push(void 0===S.name.scope.index?"global":"sheet");break;case m.UnavailableKind.ClientFailure:d.push(S.reason);break;case m.UnavailableKind.CellFormula:case m.UnavailableKind.EvalFailure:d.push(S.reason.kind);break;case m.UnavailableKind.VolatileFunction:d.push(S.name);break;case m.UnavailableKind.TimeGranularity:d.push(p.TimeGranularity[S.granularity]);break;case m.UnavailableKind.GetTimeKind:d.push(S.getTimeKind)}}else d.push(JSON.stringify(c));(0,s.incrementStat)(e,d.join(" "))}break;case h.ReasonKind.LimitExceeded:(0,s.incrementStat)(e,"".concat(t.kind," ").concat(h.LimitKind[t.limit]));break;case g.FormatReasonKind.NotFormatString:case g.FormatReasonKind.NotValueString:(0,s.incrementStat)(e,"".concat(t.kind," ").concat(t.message));break;case h.ReasonKind.InvalidQualifier:case h.ReasonKind.InvalidCellRef:case h.ReasonKind.InvalidStructRef:(0,s.incrementStat)(e,"".concat(t.kind," ").concat(t.reason));break;case h.ReasonKind.Internal:(0,s.incrementStat)(e,"".concat(t.kind," ").concat(t.message));break;case h.ReasonKind.JavaScriptError:case f.ReasonKind.NotFormulaString:case h.ReasonKind.CellCycle:case h.ReasonKind.NameCycle:case h.ReasonKind.Stopped:case h.ReasonKind.PreviousFailure:case h.ReasonKind.PreviousNameFailure:case g.FormatReasonKind.PreviousFormatFailure:(0,s.incrementStat)(e,t.kind);break;default:(0,v.assertNever)("calc.calc.incrementFailure",t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseLoop=t.promiseFinally=t.newPromise=t.isThenable=t.collapseThenable=t.bindMaybeThenable=t.MaybeThenable=void 0;var n=r(1);t.MaybeThenable=n.promise.MaybeThenable,t.bindMaybeThenable=n.promise.bindMaybeThenable,t.collapseThenable=n.promise.collapseThenable,t.isThenable=n.promise.isThenable,t.newPromise=n.promise.newPromise,t.promiseFinally=n.promise.promiseFinally,t.promiseLoop=n.promise.promiseLoop},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoResumeRecalc=t.emptyRangeValue=t.emptyRangeFormula=t.emptyRangeFormat=t.FormulaKind=void 0;var n=r(79);t.FormulaKind=n.gridinterface.FormulaKind,t.emptyRangeFormat=n.gridinterface.emptyRangeFormat,t.emptyRangeFormula=n.gridinterface.emptyRangeFormula,t.emptyRangeValue=n.gridinterface.emptyRangeValue,t.wrapIntoResumeRecalc=n.gridinterface.wrapIntoResumeRecalc},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getSchedulerFactories=t.dynamicPluginLoaderInsideInit=t.createDynamicPluginLoader=t.PluginSchedulerSingleton=t.GridImportManagerSingleton=void 0;var i=r(0),a=r(22),o=r(2),s=r(309),u=r(204),l=r(520),c=r(521),d=r(207),p=r(208),m=(0,o.singleton)((function(){var e=S().createGridProvider((function(){return t.PluginSchedulerSingleton.instance().registerAsyncGrid()}));return t.GridImportManagerSingleton.instance().onGridImporterCreated(e,"Main-IGrid"),e}));t.GridImportManagerSingleton=(0,o.singleton)((function(){return S().createGridImportManager()})),t.PluginSchedulerSingleton=(0,o.singleton)((function(){return S().createFormulaBarScheduler(m.instance())})),(0,o.staticAssertExtends)(),t.createDynamicPluginLoader=function(e){return S().createDynamicPluginLoader(t.GridImportManagerSingleton.instance(),t.PluginSchedulerSingleton.instance(),e)};var f=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(u.FormulaBarScheduler.bind.apply(u.FormulaBarScheduler,i.__spreadArray([void 0,(0,c.timelineQueueProcessorFactory)(t[1]),(0,c.createPrefetchingCacheFactory)(e)],t,!1)))},g=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(c.DynamicPluginLoader.bind.apply(c.DynamicPluginLoader,i.__spreadArray([void 0,e],t,!1)))};t.dynamicPluginLoaderInsideInit=(0,c.dynamicPluginLoaderInsideInit)(c.timelineQueueProcessorFactory,c.createPrefetchingCacheFactory);var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"ComputationFinalizerHandlers",{get:function(){return this.computationFinalizerHandlers},set:function(e){this.computationFinalizerHandlers=e},enumerable:!1,configurable:!0}),t}(u.FormulaBarScheduler),v={Win32:{createFormulaBarScheduler:f,createExperimentFormulaBarScheduler:function(){throw new Error("Cannot use Experiment Formula Bar Scheduler in win32 context")},createTestableFormulaBarScheduler:function(){throw new Error("Cannot use Testable Formula Bar Scheduler in win32 context")},createDynamicPluginLoader:function(){throw new Error("Cannot use Dynamic Plugin Loader in win32 context")},createGridImportManager:function(){return{onGridExporterCreated:function(){},onGridImporterCreated:function(){}}},createGridProvider:function(){var e=(0,d.createMockAsyncGrid)();return{getGrid:function(){return e},createIGridImportEndpoint:function(){throw new Error("Cannot use createIGridImportEndpoint in win32 context")},onGridExporterClosed:function(){throw new Error("Cannot use onGridExporterClosed in win32 context")}}}},Web:{createFormulaBarScheduler:f,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g.apply(void 0,i.__spreadArray(["excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit"],e,!1))},createGridImportManager:function(e){return new s.GridImportManager(e)},createGridProvider:function(e){return new s.GridProvider(e)},createExperimentFormulaBarScheduler:function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=function(e){return t=new l.ExperimentQueueProcessor(e)},o=new(u.FormulaBarScheduler.bind.apply(u.FormulaBarScheduler,i.__spreadArray([void 0,a,(0,c.createPrefetchingCacheFactory)(e)],r,!1)));if(void 0===t)throw"not initialized";return[o,t]},createTestableFormulaBarScheduler:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(h.bind.apply(h,i.__spreadArray([void 0,(0,c.timelineQueueProcessorFactory)(t[1]),(0,c.createPrefetchingCacheFactory)(e)],t,!1)))}}};function S(){return v[p.platform]}if(t.getSchedulerFactories=S,(0,a.getTypedFeatureGate)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(n=self.__retries)&&void 0!==n?n:-1)+1,0===self.__retries))throw""},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventCallbacksManager=t.makeALAnnotationNotifier=t.makeEventEmitter=t.isALAnnotationEventKind=t.ALAnnotationKinds=t.ExternallyHandledEventKinds=t.ExternallyTriggeredEventKinds=t.ALAnnotationKind=t.EventKind=void 0;var n,i,a=r(0),o=r(2),s=r(48);!function(e){e.InternalTestEvent="InternalTestEvent",e.TestEvent="TestEvent",e.FBECacheUpdateEvent="FBECacheUpdateEvent",e.FBESendSignal="FBESendSignal",e.FBEOutcomeUpdate="FBEOutcomeUpdate",e.FBECacheUpdateEventDeprecated="FBECacheUpdateEventDeprecated",e.FormulaTranspilerInitEvent="FormulaTranspilerInitEvent"}(n||(t.EventKind=n={})),function(e){e.FormulaByExample="FormulaByExample"}(i||(t.ALAnnotationKind=i={})),t.ExternallyTriggeredEventKinds=[n.TestEvent,n.FBEOutcomeUpdate,n.FormulaTranspilerInitEvent],t.ExternallyHandledEventKinds=[n.TestEvent],t.ALAnnotationKinds=(0,o.strEnumArray)(i);t.isALAnnotationEventKind=function(e){return t.ALAnnotationKinds.findIndex((function(t){return e===t}))>=0},(0,o.staticAssertSame)(),(0,o.staticAssertSame)(),(0,o.staticAssertSame)(),(0,o.staticAssertSame)(),(0,o.staticAssertSame)(),(0,o.staticAssertSame)(),t.makeEventEmitter=function(e){return(0,s.mapFromArrayOfDependantPairs)(t.ExternallyTriggeredEventKinds.map((function(t){return[t,function(r){return e.triggerEvent(t,r).then((function(){}))}]})))},t.makeALAnnotationNotifier=function(e){var r=function(t){return function(r){return(0,o.isNone)(r)?Promise.resolve(null):Promise.resolve(e.triggerEvent(t,r))}};(0,o.staticAssertExtends)();for(var n={},i=0,a=t.ALAnnotationKinds;i<a.length;i++){var s=a[i];n[s]=r(s)}return n},t.makeEventCallbacksManager=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,r;return a.__generator(this,(function(n){return e=(0,s.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((function(e){return[e,[]]}))),r=function(t){return function(r){for(var n=0,i=e[t];n<i.length;n++){(0,i[n])(r)}}},[2,a.__assign({registerEventCallback:function(t,r){return e[t].push(r)}},(0,s.mapFromArrayOfDependantPairs)(t.ExternallyHandledEventKinds.map((function(e){return[e,r(e)]}))))]}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findFieldRefSourceLhs=t.caretInSpanScope=t.sheetIndexToSheetName=t.getAbsolutePosition=t.getNamePartIfExists=t.createNameToDefinedNameInfoMapping=t.getRangeFromCellRef=t.getSheetNameFromQualifier=t.getSheetIndexFromQualifier=t.getSheetIndexFromSheetName=t.isValidCellRef=void 0;var n=r(9),i=r(9),a=r(9),o=r(9),s=r(2),u=r(14),l=r(6),c=r(11),d=function(){function e(){}return e.MaxRow=1048575,e.MaxColumn=16383,e}();function p(e,t){var r=t.nameToIndex.getValue(e);if((0,s.isDefined)(r))return t.sheets[r].sheetIndex}function m(e,t){return e.kind===i.QualifierKind.Sheet?e.sheet:e.kind===i.QualifierKind.Ident?e.name:((0,s.isDefined)(t)&&t("getSheetNameFromQualifier unexpected qualifier kind: ".concat(e.kind)),"")}function f(e,t){return e.index+(e.kind===o.PosKind.Rel?t:0)}t.isValidCellRef=function(e){return!(0,u.isChangeGateEnabled)("OfficeVSO:7898117_addValidityCheckBeforeConstructingRange")||e.kind!==a.CellRefKind.Bad&&e.kind!==a.CellRefKind.Error},t.getSheetIndexFromSheetName=p,t.getSheetIndexFromQualifier=function(e,t,r){return p(m(e,r),t)},t.getSheetNameFromQualifier=m,t.getRangeFromCellRef=function(e,t,r){switch(e.kind){case a.CellRefKind.Single:var n=f(e.row,t.row),i=f(e.col,t.col);return{firstRow:n,firstColumn:i,lastRow:n,lastColumn:i};case a.CellRefKind.Range:return{firstRow:f(e.ref1.row,t.row),firstColumn:f(e.ref1.col,t.col),lastRow:f(e.ref2.row,t.row),lastColumn:f(e.ref2.col,t.col)};case a.CellRefKind.Col:return{firstRow:0,firstColumn:f(e.col1,t.col),lastRow:d.MaxRow,lastColumn:f(e.col2,t.col)};case a.CellRefKind.Row:return{firstRow:f(e.row1,t.row),firstColumn:0,lastRow:f(e.row2,t.row),lastColumn:d.MaxColumn};default:(0,s.isDefined)(r)&&r("getRangeFromCellRef unexpected CellRefKind: ".concat(e.kind))}},t.createNameToDefinedNameInfoMapping=function(e){var t=new Map;return e.forEach((function(e){(0,s.isDefined)(e.name)&&t.set(e.name.toLocaleLowerCase(),e)})),t},t.getNamePartIfExists=function(e,t){var r=t.get(e.asWhole.toLocaleLowerCase());if(void 0!==r&&r.type!==l.DefinedNameInfoType.Invalid)return r},t.getAbsolutePosition=f,t.sheetIndexToSheetName=function(e,t){var r=t.sheets.findIndex((function(t){return(0,c.isSheetIndexEqual)(t.sheetIndex,e)}));if(-1!==r)return t.sheets[r].sheetName},t.caretInSpanScope=function(e,t){return(0,s.isDefined)(t)&&e>=t.start&&e<=t.end},t.findFieldRefSourceLhs=function e(t){switch(t.kind){case n.NamePartKind.CellRefNamePart:case n.NamePartKind.IdentNamePart:return t;case n.NamePartKind.FieldRefNamePart:return e(t.lhs)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};t.makeEmptyTable=function(){return n},t.entry=function(e,t){return{key:e,value:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVolatileFunc=t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;var n=r(71),i=r(155);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return i.WorksheetFuncId}});var a,o=r(223);t.unknownFunctionType=(0,n.functionType)(0,254,[],[n.SignatureType.All],[],n.SignatureType.All,n.SpecialPrecs.All,n.FunctionFlags.AllowLStrs),t.higherOrderFunctionType=function(){var e=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|((0,o.isFeatureEnabled)(o.FeatureName.CalcLambdaCellValues)?0:n.OperKind.Range)|((0,o.isFeatureEnabled)(o.FeatureName.CalcLambdaArrayLifting)?0:n.OperKind.Array),t=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|n.OperKind.Missing|n.OperKind.Array|n.OperKind.Range;return(0,n.functionType)(1,255,[e],[t],[],n.SignatureType.All,n.SpecialPrecs.None,n.FunctionFlags.Allow3dRef|n.FunctionFlags.AllowLStrs)},function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(a||(t.OperatorId=a={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];var s=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,u=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,l=(0,n.functionType)(2,2,[n.OperKind.Number,n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),c=(0,n.functionType)(1,1,[n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),d=(0,n.functionType)(1,1,[s],[],[],s,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),p=(0,n.functionType)(2,2,[n.OperKind.String,n.OperKind.String],[],[],n.OperKind.String,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),m=(0,n.functionType)(2,2,[u,u],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.AllowLStrs),f=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.AllCells,n.FunctionFlags.None),g=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.None,n.FunctionFlags.None),h=(0,n.functionType)(2,2,[n.OperKind.Boolean,n.OperKind.Boolean],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),v=[];function S(e){var r=i.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType}function y(e,t){var r=i.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}v[a.Add]=l,v[a.Sub]=l,v[a.Mul]=l,v[a.Div]=l,v[a.Pow]=l,v[a.Percent]=c,v[a.Neg]=c,v[a.At]=i.worksheetFuncTypes[i.WorksheetFuncId.SINGLE],v[a.Pound]=i.worksheetFuncTypes[i.WorksheetFuncId.ANCHORARRAY],v[a.Pos]=d,v[a.Concat]=p,v[a.Eq]=m,v[a.Ne]=m,v[a.Lt]=m,v[a.Le]=m,v[a.Gt]=m,v[a.Ge]=m,v[a.Range]=f,v[a.Isect]=g,v[a.Union]=g,v[a.And]=h,v[a.Or]=h,v[a.Xor]=h,v[a.Min]=l,v[a.Max]=l,t.getOperatorType=function(e){var r=v[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=S,t.getWorksheetFuncEnglishName=function(e){return i.worksheetFuncEnglishNames[e]},t.isVolatileFunc=function(e){return 0!=(S(e).staticPrecs&(n.SpecialPrecs.Time|n.SpecialPrecs.Calc))},y(i.WorksheetFuncId.ROW,n.SpecialPrecs.OwnRow),y(i.WorksheetFuncId.COLUMN,n.SpecialPrecs.OwnCol),y(i.WorksheetFuncId.SHEET,n.SpecialPrecs.OwnDocSheets),y(i.WorksheetFuncId.SHEETS,n.SpecialPrecs.OwnDocSheets),y(i.WorksheetFuncId.OFFSET,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.INDIRECT,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.SUMIF,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.AVERAGEIF,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.LOOKUP,n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.ADDRESS,n.SpecialPrecs.RefStyle),y(i.WorksheetFuncId.FORMULATEXT,n.SpecialPrecs.RefStyle),y(i.WorksheetFuncId.NOW,n.SpecialPrecs.Time),y(i.WorksheetFuncId.TODAY,n.SpecialPrecs.Time),y(i.WorksheetFuncId.RAND,n.SpecialPrecs.Calc),y(i.WorksheetFuncId.RANDBETWEEN,n.SpecialPrecs.Calc),y(i.WorksheetFuncId.RANDARRAY,n.SpecialPrecs.Calc),y(i.WorksheetFuncId.SUBTOTAL,n.SpecialPrecs.CellProps),y(i.WorksheetFuncId.CELL,n.SpecialPrecs.CellProps|n.SpecialPrecs.AllCells),y(i.WorksheetFuncId.INFO,n.SpecialPrecs.None)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeIsInClass=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=void 0;var n=r(1);t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeIsInClass=n.unicode.makeIsInClass,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedWorksheetFunc=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;var n,i,a,o,s,u=r(88),l=r(32);t.resolveLocalsGrid=function(e){return{originGridCell:(0,u.success)(e.range),originSheet:(0,u.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(n||(t.ResolveReasonKind=n={})),t.noOriginSheet=function(e){return{kind:n.NoOriginSheet,origin:e}},function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"}(i||(t.InvalidQualifierReason=i={})),t.invalidQualifier=function(e){return{kind:n.InvalidQualifier,reason:e}},function(e){e.BadCellRef="BadCellRef"}(a||(t.InvalidCellRefReason=a={})),t.invalidCellRef=function(e){return{kind:n.InvalidCellRef,reason:e}},function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(o||(t.InvalidStructRefReason=o={})),t.invalidStructRef=function(e){return{kind:n.InvalidStructRef,reason:e}},t.emptyIntersection={kind:n.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedWorksheetFunc="ResolvedWorksheetFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(s||(t.ResolvedKind=s={})),t.resolvedName=(0,l.typedInstanceCreator)()((function(e,t,r,n){return{kind:s.ResolvedName,node:e,resolution:t,qualifierResolution:r,precedents:n}})),t.resolvedCellRef=(0,l.typedInstanceCreator)()((function(e,t){return{kind:s.ResolvedCellRef,node:e,resolution:t}})),t.resolvedUserDefinedFunc=(0,l.typedInstanceCreator)()((function(e,t,r,n){return{kind:s.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n}})),t.resolvedWorksheetFunc=(0,l.typedInstanceCreator)()((function(e,t){return{kind:s.ResolvedWorksheetFunc,node:e,resolution:t}})),t.resolvedLocalName=(0,l.typedInstanceCreator)()((function(e,t){return{kind:s.ResolvedLocalName,node:e,resolution:t}})),t.resolvedStructRef=(0,l.typedInstanceCreator)()((function(e,t,r,n){return{kind:s.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n}})),t.resolvedNever=(0,l.typedInstanceCreator)()((function(e){return{kind:s.ResolvedNever,node:e,resolution:u.successUndefined}})),t.resolvedDottedName=(0,l.typedInstanceCreator)()((function(e,t,r,n){return{kind:s.ResolvedDottedName,node:e,headResolved:t,fieldsResolved:r,precedents:n}}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;var n=r(0),i=r(42),a=r(32),o=r(225),s=r(40),u=r(40);function l(e,t){switch(t.kind){case u.NodeKind.Literal:var r=t.oper,n=t.isClosed,a=t.label;return e.literalNode(r,n,a);case u.NodeKind.Array:var o=t.nodes;n=t.isClosed,a=t.label;return e.arrayNode(o,n,a);case u.NodeKind.App:var s=t.head,l=t.args;n=t.isClosed,a=t.label;return e.appNode(s,l,n,a);case u.NodeKind.Let:s=t.head;var c=t.vars,d=t.body,p=t.badArgs;n=t.isClosed,a=t.label;return e.letNode(s,c,d,p,n,a);case u.NodeKind.Lambda:s=t.head;var m=t.params;d=t.body,p=t.badArgs,n=t.isClosed,a=t.label;return e.lambdaNode(s,m,d,p,n,a);case u.NodeKind.Paren:var f=t.node;n=t.isClosed,a=t.label;return e.parenNode(f,n,a);case u.NodeKind.Name:var g=t.parts,h=t.qualifier;a=t.label;return e.nameNode(g,h,a);case u.NodeKind.CellRef:var v=t.ref;h=t.qualifier,a=t.label;return e.cellRefNode(v,h,a);case u.NodeKind.FieldRef:var S=t.lhs,y=t.rhs;a=t.label;return e.fieldRefNode(S,y,a);case u.NodeKind.StructRef:S=t.lhs,y=t.rhs,a=t.label;return e.structRefNode(S,y,a);case u.NodeKind.Missing:var F=t.chars;a=t.label;return e.missingNode(F,a);case u.NodeKind.BadChars:var C=t.type;F=t.chars,a=t.label;return e.badCharsNode(C,F,a);case u.NodeKind.BadSequence:C=t.type;var R=t.contents;a=t.label;return e.badSequenceNode(C,R,a);default:return(0,i.assertNever)("calc.lang.visitFormulaNode",t)}}function c(e,t){var r=t.id,n=t.label;return e.operatorNode(r,n)}function d(e,t){var r=t.id,n=t.whole,i=t.label;return e.wsfNode(r,n,i)}function p(e,t){switch(t.kind){case u.NodeKind.Operator:return c(e,t);case u.NodeKind.WSF:return d(e,t);default:return l(e,t)}}function m(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),missingNode:e.missingNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badCharsNode:e.badCharsNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}t.visitFormulaNode=l,t.visitOperatorNode=c,t.visitWSFNode=d,t.visitAppHeadNode=p,t.visitQualifier=function(e,t){switch(t.kind){case u.QualifierKind.Error:var r=t.label;return e.errorQualifier(r);case u.QualifierKind.Relative:r=t.label;return e.relativeQualifier(r);case u.QualifierKind.Document:var n=t.document,a=t.path,o=t.isQuoted;r=t.label;return e.documentQualifier(n,a,o,r);case u.QualifierKind.Sheet:var s=t.sheet,l=t.document;o=t.isQuoted,r=t.label;return e.sheetQualifier(s,l,o,r);case u.QualifierKind.Ident:var c=t.name;o=t.isQuoted,r=t.label;return e.identQualifier(c,o,r);case u.QualifierKind.SheetRange:var d=t.sheet1,p=t.sheet2,m=t.document;o=t.isQuoted,r=t.label;return e.sheetRangeQualifier(d,p,m,o,r);case u.QualifierKind.Bad:var f=t.chars,g=(o=t.isQuoted,t.isClosed),h=t.isTerminated;r=t.label;return e.badQualifier(f,o,g,h,r);default:return(0,i.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case u.CellRefKind.Error:var r=t.label;return e.cellRefError(r);case u.CellRefKind.Single:var n=t.row,a=t.col,o=t.isBracketed;r=t.label;return e.cellRefSingle(n,a,o,r);case u.CellRefKind.Range:var s=t.ref1,l=t.ref2;r=t.label;return e.cellRefRange(s,l,r);case u.CellRefKind.Row:var c=t.row1,d=t.row2;o=t.isBracketed,r=t.label;return e.cellRefRow(c,d,o,r);case u.CellRefKind.Col:var p=t.col1,m=t.col2;o=t.isBracketed,r=t.label;return e.cellRefCol(p,m,o,r);case u.CellRefKind.Bad:var f=t.chars;o=t.isBracketed,r=t.label;return e.cellRefBad(f,o,r);default:return(0,i.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=m;var f=function(){function e(){}return e.prototype.literalNode=function(e,t,r){return(0,u.literalNode)(e,t,r)},e.prototype.arrayNode=function(e,t,r){return(0,u.arrayNode)(e,t,r)},e.prototype.appNode=function(e,t,r,n){return(0,u.appNode)(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,a){return(0,u.letNode)(e,t,r,n,i,a)},e.prototype.lambdaNode=function(e,t,r,n,i,a){return(0,u.lambdaNode)(e,t,r,n,i,a)},e.prototype.parenNode=function(e,t,r){return(0,u.parenNode)(e,t,r)},e.prototype.nameNode=function(e,t,r){return(0,u.nameNode)(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return(0,u.cellRefNode)(e,t,r)},e.prototype.fieldRefNode=function(e,t,r){return(0,u.fieldRefNode)(e,t,r)},e.prototype.structRefNode=function(e,t,r){return(0,u.structRefNode)(e,t,r)},e.prototype.missingNode=function(e,t){return(0,u.missingNode)(e,t)},e.prototype.badSequenceNode=function(e,t,r){return(0,s.badSequenceNode)(e,t,r)},e.prototype.badCharsNode=function(e,t,r){return(0,s.badCharsNode)(e,t,r)},e.prototype.operatorNode=function(e,t){return(0,u.operatorNode)(e,t)},e.prototype.wsfNode=function(e,t,r){return(0,u.wsfNode)(e,t,r)},e}();t.IdentityVisitor=f,t.identityVisitor=m(new f);var g=function(){function e(e){this.value=e}return e.prototype.literalNode=function(e,t,r){return this.value},e.prototype.arrayNode=function(e,t,r){return this.value},e.prototype.appNode=function(e,t,r,n){return this.value},e.prototype.letNode=function(e,t,r,n,i,a){return this.value},e.prototype.lambdaNode=function(e,t,r,n,i,a){return this.value},e.prototype.parenNode=function(e,t,r){return this.value},e.prototype.nameNode=function(e,t,r){return this.value},e.prototype.cellRefNode=function(e,t,r){return this.value},e.prototype.fieldRefNode=function(e,t,r){return this.value},e.prototype.structRefNode=function(e,t,r){return this.value},e.prototype.missingNode=function(e,t){return this.value},e.prototype.badSequenceNode=function(e,t,r){return this.value},e.prototype.badCharsNode=function(e,t,r){return this.value},e.prototype.operatorNode=function(e,t){return this.value},e.prototype.wsfNode=function(e,t,r){return this.value},e}();function h(e){return m(new g(e))}t.ConstVisitor=g,t.constVisitor=h,t.voidVisitor=h(void 0);var v=function(){function e(e){this.visitor=e}return e.prototype.literalNode=function(e,t,r){return this.visitor.literalNode(e,t,r)},e.prototype.arrayNode=function(e,t,r){return this.visitor.arrayNode(e,t,r)},e.prototype.appNode=function(e,t,r,n){return this.visitor.appNode(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,a){return this.visitor.letNode(e,t,r,n,i,a)},e.prototype.lambdaNode=function(e,t,r,n,i,a){return this.visitor.lambdaNode(e,t,r,n,i,a)},e.prototype.parenNode=function(e,t,r){return this.visitor.parenNode(e,t,r)},e.prototype.nameNode=function(e,t,r){return this.visitor.nameNode(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return this.visitor.cellRefNode(e,t,r)},e.prototype.fieldRefNode=function(e,t,r){return this.visitor.fieldRefNode(e,t,r)},e.prototype.structRefNode=function(e,t,r){return this.visitor.structRefNode(e,t,r)},e.prototype.missingNode=function(e,t){return this.visitor.missingNode(e,t)},e.prototype.badSequenceNode=function(e,t,r){return this.visitor.badSequenceNode(e,t,r)},e.prototype.badCharsNode=function(e,t,r){return this.visitor.badCharsNode(e,t,r)},e.prototype.operatorNode=function(e,t){return this.visitor.operatorNode(e,t)},e.prototype.wsfNode=function(e,t,r){return this.visitor.wsfNode(e,t,r)},e}();t.DelegatingVisitor=v;var S=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reducer=function(e,t){return r(e,t)},n}return n.__extends(t,e),t.prototype.arrayNode=function(e,t,r){var n=this;return(0,i.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((function(e){return e.reduce(n.reducer)})).reduce(this.reducer)},t.prototype.appNode=function(e,t,r,n){return t.reduce(this.reducer,e)},t.prototype.letNode=function(e,t,r,i,a,o){return n.__spreadArray(n.__spreadArray(n.__spreadArray([],t.map((function(e){return e.binder.arg})),!0),void 0===r?[]:[r.arg],!0),i.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.lambdaNode=function(e,t,r,i,o,s){return n.__spreadArray(n.__spreadArray(n.__spreadArray([],t.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})).filter(a.isDefined),!0),void 0===r?[]:[r.arg],!0),i.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.parenNode=function(e,t,r){return e},t.prototype.fieldRefNode=function(e,t,r){return e},t.prototype.badSequenceNode=function(e,t,r){return(0,i.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)},t}(v);function y(e,t){return m(new S(e,t))}t.BinaryVisitor=S,t.binaryVisitor=y;var F=function(){function e(e,t){this.a=e,this.b=t}return e.prototype.literalNode=function(e,t,r){return this.b(this.a.literalNode(e,t,r))},e.prototype.arrayNode=function(e,t,r){return this.b(this.a.arrayNode(e,t,r))},e.prototype.appNode=function(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))},e.prototype.letNode=function(e,t,r,n,i,a){return this.b(this.a.letNode(e,t,r,n,i,a))},e.prototype.lambdaNode=function(e,t,r,n,i,a){return this.b(this.a.lambdaNode(e,t,r,n,i,a))},e.prototype.parenNode=function(e,t,r){return this.b(this.a.parenNode(e,t,r))},e.prototype.nameNode=function(e,t,r){return this.b(this.a.nameNode(e,t,r))},e.prototype.cellRefNode=function(e,t,r){return this.b(this.a.cellRefNode(e,t,r))},e.prototype.fieldRefNode=function(e,t,r){return this.b(this.a.fieldRefNode(e,t,r))},e.prototype.structRefNode=function(e,t,r){return this.b(this.a.structRefNode(e,t,r))},e.prototype.missingNode=function(e,t){return this.b(this.a.missingNode(e,t))},e.prototype.badSequenceNode=function(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))},e.prototype.badCharsNode=function(e,t,r){return this.b(this.a.badCharsNode(e,t,r))},e.prototype.operatorNode=function(e,t){return this.b(this.a.operatorNode(e,t))},e.prototype.wsfNode=function(e,t,r){return this.b(this.a.wsfNode(e,t,r))},e}();function C(e,t){return m(new F(e,t))}t.ComposeVisitor=F,t.composeVisitor=C,t.depthVisitor=C(y(h(0),a.fastMax),(function(e){return e+1}));var R=function(){function e(e){this.visitors=e,this.keys=Object.keys(e)}return e.prototype.literalNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].literalNode(e,t,r)}return n},e.prototype.arrayNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].arrayNode(e,t,r)}return n},e.prototype.appNode=function(e,t,r,n){for(var i={},a=0,o=this.keys;a<o.length;a++){var s=o[a];i[s]=this.visitors[s].appNode(e,t,r,n)}return i},e.prototype.letNode=function(e,t,r,n,i,a){for(var o={},s=0,u=this.keys;s<u.length;s++){var l=u[s];o[l]=this.visitors[l].letNode(e,t,r,n,i,a)}return o},e.prototype.lambdaNode=function(e,t,r,n,i,a){for(var o={},s=0,u=this.keys;s<u.length;s++){var l=u[s];o[l]=this.visitors[l].lambdaNode(e,t,r,n,i,a)}return o},e.prototype.parenNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].parenNode(e,t,r)}return n},e.prototype.nameNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].nameNode(e,t,r)}return n},e.prototype.cellRefNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].cellRefNode(e,t,r)}return n},e.prototype.fieldRefNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].fieldRefNode(e,t,r)}return n},e.prototype.structRefNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].structRefNode(e,t,r)}return n},e.prototype.missingNode=function(e,t){for(var r={},n=0,i=this.keys;n<i.length;n++){var a=i[n];r[a]=this.visitors[a].missingNode(e,t)}return r},e.prototype.badSequenceNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].badSequenceNode(e,t,r)}return n},e.prototype.badCharsNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].badCharsNode(e,t,r)}return n},e.prototype.operatorNode=function(e,t){for(var r={},n=0,i=this.keys;n<i.length;n++){var a=i[n];r[a]=this.visitors[a].operatorNode(e,t)}return r},e.prototype.wsfNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].wsfNode(e,t,r)}return n},e}();function b(e,t){var r=function(t){switch(t.kind){case u.NodeKind.Literal:var n=t.oper,a=t.isClosed,o=t.label;return e.literalNode(n,a,o);case u.NodeKind.Array:var s=t.nodes;a=t.isClosed,o=t.label;return e.arrayNode(s.map((function(e){return e.map(r)})),a,o);case u.NodeKind.App:var l=t.head,p=t.args;a=t.isClosed,o=t.label;return e.appNode(function(t){switch(t.kind){case u.NodeKind.Operator:return c(e,t);case u.NodeKind.WSF:return d(e,t);default:return r(t)}}(l),p.map(r),a,o);case u.NodeKind.Let:l=t.head;var m=t.vars,f=t.body,g=t.badArgs;a=t.isClosed,o=t.label;return e.letNode(d(e,l),m.map((function(e){var t=e.name,n=e.binder;return(0,u.letVar)(t,(0,u.indexedArg)(r(n.arg),n.index))})),void 0===f?void 0:(0,u.indexedArg)(r(f.arg),f.index),g.map((function(e){return(0,u.indexedArg)(r(e.arg),e.index)})),a,o);case u.NodeKind.Lambda:l=t.head;var h=t.params;f=t.body,g=t.badArgs,a=t.isClosed,o=t.label;return e.lambdaNode(d(e,l),h.map((function(e){var t=e.name;return void 0===t.arg.def?(0,u.lambdaParam)(t):(0,u.lambdaParam)((0,u.indexedArg)((0,u.paramNode)(t.arg.name,(0,u.paramDefault)(r(t.arg.def.rhs),t.arg.def.label),t.arg.label),t.index))})),void 0===f?void 0:(0,u.indexedArg)(r(f.arg),f.index),g.map((function(e){return(0,u.indexedArg)(r(e.arg),e.index)})),a,o);case u.NodeKind.Paren:var v=t.node;a=t.isClosed,o=t.label;return e.parenNode(r(v),a,o);case u.NodeKind.Name:var S=t.parts,y=t.qualifier;o=t.label;return e.nameNode(S,y,o);case u.NodeKind.CellRef:var F=t.ref;y=t.qualifier,o=t.label;return e.cellRefNode(F,y,o);case u.NodeKind.FieldRef:var C=t.lhs,R=t.rhs;o=t.label;return e.fieldRefNode(r(C),R,o);case u.NodeKind.StructRef:C=t.lhs,R=t.rhs,o=t.label;return e.structRefNode(C,R,o);case u.NodeKind.Missing:var b=t.chars;o=t.label;return e.missingNode(b,o);case u.NodeKind.BadChars:var E=t.type;b=t.chars,o=t.label;return e.badCharsNode(E,b,o);case u.NodeKind.BadSequence:E=t.type;var P=t.contents;o=t.label;return e.badSequenceNode(E,P.map(r),o);default:return(0,i.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function E(e,t,r,n){var i=[],a=function(e){return i.push(e),o},o=function(){return i.length<t.length?r(e,t[i.length],a):n(i)};return o}function P(e,t,r){return E(e,t,I,r)}function k(e,t,r,n){return function(){return void 0!==t?r(e,t,n):n(void 0)}}function T(e,t,r){var n=t.id,i=t.whole,a=t.label;return function(){return r(e.wsfNode(n,i,a))}}function A(e,t,r){var n=t.name,i=t.binder;return I(e,i.arg,(function(e){return r((0,u.letVar)(n,(0,u.indexedArg)(e,i.index)))}))}function N(e,t,r){var n=t.name,i=n.arg;return void 0===i.def?function(){return r((0,u.lambdaParam)(n))}:I(e,i.def.rhs,(function(e){return r((0,u.lambdaParam)((0,u.indexedArg)((0,u.paramNode)(i.name,(0,u.paramDefault)(e,i.def.label),i.label),n.index)))}))}function _(e,t,r){var n=t.arg,i=t.index;return I(e,n,(function(e){return r((0,u.indexedArg)(e,i))}))}function I(e,t,r){switch(t.kind){case u.NodeKind.Literal:var n=t.oper,a=t.isClosed,o=t.label;return function(){return r(e.literalNode(n,a,o))};case u.NodeKind.Array:var s=t.nodes,l=t.isClosed,c=t.label;return E(e,s,P,(function(t){return r(e.arrayNode(t,l,c))}));case u.NodeKind.App:var d=t.head,p=t.args,m=t.isClosed,f=t.label;return function(){return function(e,t,r){switch(t.kind){case u.NodeKind.Operator:var n=t.id,i=t.label;return function(){return r(e.operatorNode(n,i))};case u.NodeKind.WSF:return T(e,t,r);default:return I(e,t,r)}}(e,d,(function(t){return P(e,p,(function(n){return r(e.appNode(t,n,m,f))}))}))};case u.NodeKind.Let:var g=t.head,h=t.vars,v=t.body,S=t.badArgs,y=t.isClosed,F=t.label;return function(){return T(e,g,(function(t){return E(e,h,A,(function(n){return k(e,v,_,(function(i){return E(e,S,_,(function(a){return r(e.letNode(t,n,i,a,y,F))}))}))}))}))};case u.NodeKind.Lambda:var C=t.head,R=t.params,b=t.body,O=t.badArgs,M=t.isClosed,D=t.label;return function(){return T(e,C,(function(t){return function(){return E(e,R,N,(function(n){return k(e,b,_,(function(i){return E(e,O,_,(function(a){return r(e.lambdaNode(t,n,i,a,M,D))}))}))}))}}))};case u.NodeKind.Paren:var w=t.node,L=t.isClosed,x=t.label;return function(){return I(e,w,(function(t){return function(){return r(e.parenNode(t,L,x))}}))};case u.NodeKind.Name:var K=t.parts,U=t.qualifier,B=t.label;return function(){return r(e.nameNode(K,U,B))};case u.NodeKind.CellRef:var W=t.ref,G=t.qualifier,V=t.label;return function(){return r(e.cellRefNode(W,G,V))};case u.NodeKind.FieldRef:var j=t.lhs,q=t.rhs,H=t.label;return function(){return I(e,j,(function(t){return function(){return r(e.fieldRefNode(t,q,H))}}))};case u.NodeKind.StructRef:var z=t.lhs,Q=t.rhs,Y=t.label;return function(){return r(e.structRefNode(z,Q,Y))};case u.NodeKind.Missing:var J=t.chars,$=t.label;return function(){return r(e.missingNode(J,$))};case u.NodeKind.BadChars:var X=t.type,Z=t.chars,ee=t.label;return function(){return r(e.badCharsNode(X,Z,ee))};case u.NodeKind.BadSequence:var te=t.type,re=t.contents,ne=t.label;return P(e,re,(function(t){return r(e.badSequenceNode(te,t,ne))}));default:return(0,i.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function O(e,t){var r;return function(e){for(var t=e;null!=t;)t=t()}(I(e,t,(function(e){r=e}))),r}t.ZipVisitor=R,t.zipVisitor=function(e){return m(new R(e))},t.reduceBottomUp_Recursive=b,t.reduceBottomUp_CPS=O;var M=function(){function e(e){var t=this;this.visitor=e,this.visitFormulaNode=function(e){return l(t,e)},this.lazyVisitFormulaNode=function(e){return o.Pledge.resolve(e).bind(t.visitFormulaNode)},this.visitAppHeadNode=function(e){return p(t,e)},this.lazyVisitAppHeadNode=function(e){return o.Pledge.resolve(e).bind(t.visitAppHeadNode)},this.visitWSFNode=function(e){return d(t,e)},this.lazyVisitWSFNode=function(e){return o.Pledge.resolve(e).bind(t.visitWSFNode)},this.lazyVisitVar=function(e){var r=e.name,n=e.binder;return t.lazyVisitFormulaNode(n.arg).bind((function(e){return(0,u.letVar)(r,(0,u.indexedArg)(e,n.index))}))},this.lazyVisitParam=function(e){var r=e.name,n=r.arg;return void 0===n.def?o.Pledge.resolve((0,u.lambdaParam)(r)):t.lazyVisitFormulaNode(n.def.rhs).bind((function(e){return(0,u.lambdaParam)((0,u.indexedArg)((0,u.paramNode)(n.name,(0,u.paramDefault)(e,n.def.label),n.label),r.index))}))},this.lazyVisitIndexedArg=function(e){var r=e.arg,n=e.index;return t.lazyVisitFormulaNode(r).bind((function(e){return(0,u.indexedArg)(e,n)}))}}return e.prototype.literalNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.literalNode(e,t,r)}))},e.prototype.arrayNode=function(e,t,r){var n=this;return o.Pledge.all(e.map((function(e){return o.Pledge.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.visitor.arrayNode(e,t,r)}))},e.prototype.appNode=function(e,t,r,n){var i=this;return this.lazyVisitAppHeadNode(e).bind((function(e){return o.Pledge.all(t.map(i.lazyVisitFormulaNode)).bind((function(t){return i.visitor.appNode(e,t,r,n)}))}))},e.prototype.letNode=function(e,t,r,n,i,a){var s=this;return this.lazyVisitWSFNode(e).bind((function(e){return o.Pledge.all(t.map(s.lazyVisitVar)).bind((function(t){return(void 0===r?o.Pledge.resolve(void 0):s.lazyVisitIndexedArg(r)).bind((function(r){return o.Pledge.all(n.map(s.lazyVisitIndexedArg)).bind((function(n){return s.visitor.letNode(e,t,r,n,i,a)}))}))}))}))},e.prototype.lambdaNode=function(e,t,r,n,i,a){var s=this;return this.lazyVisitWSFNode(e).bind((function(e){return o.Pledge.all(t.map(s.lazyVisitParam)).bind((function(t){return(void 0===r?o.Pledge.resolve(void 0):s.lazyVisitIndexedArg(r)).bind((function(r){return o.Pledge.all(n.map(s.lazyVisitIndexedArg)).bind((function(n){return s.visitor.lambdaNode(e,t,r,n,i,a)}))}))}))}))},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.visitor.parenNode(e,t,r)}))},e.prototype.nameNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.nameNode(e,t,r)}))},e.prototype.cellRefNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.cellRefNode(e,t,r)}))},e.prototype.fieldRefNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.visitor.fieldRefNode(e,t,r)}))},e.prototype.structRefNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.structRefNode(e,t,r)}))},e.prototype.missingNode=function(e,t){var r=this;return o.Pledge.try((function(){return r.visitor.missingNode(e,t)}))},e.prototype.badSequenceNode=function(e,t,r){var n=this;return o.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return n.visitor.badSequenceNode(e,t,r)}))},e.prototype.badCharsNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.badCharsNode(e,t,r)}))},e.prototype.operatorNode=function(e,t){var r=this;return o.Pledge.try((function(){return r.visitor.operatorNode(e,t)}))},e.prototype.wsfNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.wsfNode(e,t,r)}))},e}();t.PledgeReducer=M,t.reduceBottomUp_Pledge=function(e,t){return w(new M(e),t)};function D(e,t,r){return r<=50?b(e,t):O(e,t)}function w(e,t){return o.Pledge.settleOrThrow(o.Pledge.resolve(l(e,t)))}t.reduceBottomUp_MaxDepth=D,t.reduceBottomUp=function(e,t){return D(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=w,t.reducePledge=function(e,t){return w(e,t.node)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedWorksheetFunc=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(3);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedWorksheetFunc=n.resolveServiceTypes.resolvedWorksheetFunc,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLocals=t.notFormulaString=t.createParseGlobals=t.ReasonKind=void 0;var n=r(37);t.ReasonKind=n.parseServiceTypes.ReasonKind,t.createParseGlobals=n.parseServiceTypes.createParseGlobals,t.notFormulaString=n.parseServiceTypes.notFormulaString,t.parseLocals=n.parseServiceTypes.parseLocals},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(1);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(1);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore,t.codePointLeftSingleQuotationMark=n.codePoint.codePointLeftSingleQuotationMark,t.codePointRightSingleQuotationMark=n.codePoint.codePointRightSingleQuotationMark},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=t.createAnalyzeGlobals=t.analyzeLocalsName=t.analyzeLocalsGrid=void 0;var n=r(37);t.analyzeLocalsGrid=n.analyzeServiceTypes.analyzeLocalsGrid,t.analyzeLocalsName=n.analyzeServiceTypes.analyzeLocalsName,t.createAnalyzeGlobals=n.analyzeServiceTypes.createAnalyzeGlobals,t.diagnostics=n.analyzeServiceTypes.diagnostics,t.summarizeFormulaDiagnostics=n.analyzeServiceTypes.summarizeFormulaDiagnostics,t.staticPrecedents=n.analyzeServiceTypes.staticPrecedents},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;var n=r(37);t.createAnalyzer=n.analyzeService.createAnalyzer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(1);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(1);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.buildMMDDYYFormat=t.buildSingle=t.buildCurrencyFormat=t.buildFractionFormat=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.getColor=t.getSingle=t.getSpecial=void 0;var i,a,o=r(0),s=r(65),u=r(114),l=r(134),c=r(66),d=r(111);function p(e,t){var r,n=null!==(r=e.pictureSpecial[t])&&void 0!==r?r:u.englishPictureSpecial[t];return(0,c.assertTrue)("calc.numfmt.knownFormat: getSpecial",void 0!==n),n}function m(e,t){var r,n=null!==(r=e.pictureSingle[t])&&void 0!==r?r:u.englishPictureSingle[t];return(0,c.assertTrue)("calc.numfmt.knownFormat: getSingle",void 0!==n),n}function f(e,t){var r,n=null!==(r=e.pictureColor[t])&&void 0!==r?r:u.englishPictureColor[t];return(0,c.assertTrue)("calc.numfmt.knownFormat: getColor",void 0!==n),n}function g(e,t,r,n){var i="";if(r>1){var a=(0,d.repeat)(m(e,u.PictureSingle.Hash),r-1);i+=t?(0,l.insertCommas)({isThousandsPosition:function(e){return e>0&&e%3==0},thousandsSeparator:m(e,u.PictureSingle.Comma)},a,1):a}return i+="0",n>0&&(i+=m(e,u.PictureSingle.Decimal),i+=(0,d.repeat)("0",n)),i}function h(e,t){var r="";return r+="0",t>0&&(r+=m(e,u.PictureSingle.Decimal),r+=(0,d.repeat)("0",t)),e.isPercentSepBySpace&&(r+=m(e,u.PictureSingle.Space)),r+=m(e,u.PictureSingle.Percent)}function v(e,t,r,n){var i="";return i+=g(e,!1,t,r),e.isExpSepBySpace&&(i+=m(e,u.PictureSingle.Space)),i+=m(e,u.PictureSingle.E),i+="+",i+=(0,d.repeat)("0",n)}function S(e,t){var r=m(e,u.PictureSingle.Quote);return r+t+r}function y(e,t){var r="";r+=m(e,u.PictureSingle.Hash);var n=e.fractionSeparator;return n===m(e,u.PictureSingle.Comma)?r+=S(e,n):r+=" "===n?m(e,u.PictureSingle.Space):S(e,n),r+=(0,d.repeat)(m(e,u.PictureSingle.Question),t),r+=m(e,u.PictureSingle.Slash),r+=(0,d.repeat)(m(e,u.PictureSingle.Question),t)}function F(e,t,r,n,a,o,l){void 0===l&&(l=!1);for(var c=e.isCurrencySymbolLead,h=e.currencyFormat,v=e.isCurrencySepBySpace,y=l?i.Pos:a?i.Text:i.Neg,F=g(e,!0,4,r),R="",b=function(l){l!==i.Pos&&(R+=m(e,u.PictureSingle.Sep)),l===i.Neg&&t&&(R+=m(e,u.PictureSingle.ColorStart)+f(e,u.PictureColor.Red)+m(e,u.PictureSingle.ColorEnd));var g=function(){return l===i.Zero?function(e,t){var r="";return r+=S(e,"-"),t>0&&(r+=(0,d.repeat)(m(e,u.PictureSingle.Question),t)),r}(e,r):l===i.Text?m(e,u.PictureSingle.Text):F},y=function(){return l!==i.Text?C(e,u.PictureSingle.Star,u.PictureSingle.Space):""},b=function(){return l===i.Neg?m(e,u.PictureSingle.OpenParen):""},E=function(){return l!==i.Text||c?l===i.Neg?m(e,u.PictureSingle.CloseParen):C(e,u.PictureSingle.Underscore,u.PictureSingle.CloseParen):""},P=function(){var t="";if(l!==i.Neg)switch(h){case s.CurrencyFormat.Intern:c||l===i.Text||(t+=C(e,u.PictureSingle.Underscore,u.PictureSingle.Minus));break;case s.CurrencyFormat.Lead:case s.CurrencyFormat.Trail:if(h===s.CurrencyFormat.Lead&&!a)break;t+=C(e,u.PictureSingle.Underscore,u.PictureSingle.Minus)}else t+=m(e,u.PictureSingle.Minus);return a&&!c&&h===s.CurrencyFormat.Lead&&(t+=y()),t},k=function(){var t="";return n&&!c&&v&&(t+=m(e,u.PictureSingle.Space)),n&&(t+=null!=o?o:p(e,u.PictureSpecial.Currency)),c&&v&&(t+=m(e,u.PictureSingle.Space)),t},T=function(){var e="";return l!==i.Text&&(c?(n&&(e+=k()),a&&(e+=y())):e+=k()),e};if(a&&(R+=function(){var t="";if(c)switch(h){case s.CurrencyFormat.Paren:t+=C(e,u.PictureSingle.Underscore,u.PictureSingle.OpenParen);break;case s.CurrencyFormat.Trail:t+=C(e,u.PictureSingle.Underscore,u.PictureSingle.Minus);break;case s.CurrencyFormat.Intern:t+=C(e,u.PictureSingle.Underscore,u.PictureSingle.Space)}else{switch(h){case s.CurrencyFormat.Trail:t+=C(e,u.PictureSingle.Underscore,u.PictureSingle.Minus);break;case s.CurrencyFormat.Paren:case s.CurrencyFormat.Intern:t+=C(e,u.PictureSingle.Underscore,u.PictureSingle.Space)}h!==s.CurrencyFormat.Lead&&(t+=y())}return t}()),c)switch(h){case s.CurrencyFormat.Paren:a||(R+=b()),R+=T(),a&&(R+=b()),R+=g(),R+=E();break;case s.CurrencyFormat.Lead:R+=P(),R+=T(),R+=g();break;case s.CurrencyFormat.Intern:R+=T(),R+=P(),R+=g();break;case s.CurrencyFormat.Trail:R+=T(),R+=g(),R+=P()}else switch(h){case s.CurrencyFormat.Paren:R+=b(),R+=g(),a&&(R+=E()),R+=T(),a||(R+=E());break;case s.CurrencyFormat.Lead:R+=P(),R+=g(),R+=T();break;case s.CurrencyFormat.Intern:R+=g(),R+=P(),R+=T();break;case s.CurrencyFormat.Trail:R+=g(),R+=T(),R+=P()}a&&(R+=function(){if(c)switch(h){case s.CurrencyFormat.Lead:return C(e,u.PictureSingle.Underscore,u.PictureSingle.Minus);case s.CurrencyFormat.Intern:return C(e,u.PictureSingle.Underscore,u.PictureSingle.Space)}else switch(h){case s.CurrencyFormat.Lead:return C(e,u.PictureSingle.Underscore,u.PictureSingle.Minus);case s.CurrencyFormat.Paren:case s.CurrencyFormat.Intern:return C(e,u.PictureSingle.Underscore,u.PictureSingle.Space)}return""}())},E=i.Pos;E<=y;E+=1)b(E);return R}function C(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map((function(t){return"string"==typeof t?t:m(e,t)})).join("")}t.getSpecial=p,t.getSingle=m,t.getColor=f,t.buildNumberFormat=g,t.buildPercentFormat=h,t.buildScientificFormat=v,t.buildFractionFormat=y,function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(i||(i={})),t.buildCurrencyFormat=F,t.buildSingle=C,function(e){e[e.Day=0]="Day",e[e.Month=1]="Month",e[e.Year=2]="Year"}(a||(a={}));var R=((n={})[s.DateOrder.MDY]=[a.Month,a.Day,a.Year],n[s.DateOrder.DMY]=[a.Day,a.Month,a.Year],n[s.DateOrder.YMD]=[a.Year,a.Month,a.Day],n[s.DateOrder.MYD]=[a.Month,a.Year,a.Day],n[s.DateOrder.DYM]=[a.Day,a.Year,a.Month],n[s.DateOrder.YDM]=[a.Year,a.Day,a.Month],n);function b(e,t){return C(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?u.PictureSingle.Hour:"",u.PictureSingle.Hour,u.PictureSingle.Colon,u.PictureSingle.Minute,u.PictureSingle.Minute)}function E(e,t){return b(e,t)+C(e,u.PictureSingle.Colon,u.PictureSingle.Second,u.PictureSingle.Second)}function P(e){var t="";return e.isAMPMSepBySpace&&(t+=m(e,u.PictureSingle.Space)),t+=p(e,u.PictureSpecial.AP1)}function k(e,t){void 0===t&&(t=!1);for(var r=e.month2Digits,n=e.day2Digits,i=t||e.year4Digits,a=C(e,i?u.PictureSingle.Year:"",i?u.PictureSingle.Year:"",u.PictureSingle.Year,u.PictureSingle.Year),o=C(e,r?u.PictureSingle.Month:"",u.PictureSingle.Month),s=[C(e,n?u.PictureSingle.Day:"",u.PictureSingle.Day),o,a],l=R[e.dateOrder],c="",d=0;d<3;d+=1)c+=s[l[d]],d<2&&(c+=m(e,u.PictureSingle.DateSep));return c}function T(e,t,r){var n=e.day2Digits,i=e.country===u.Country.GER,a="/"===e.dateSeparator&&" "!==e.dateAltSeparator,o="";return t&&(o+=C(e,n?u.PictureSingle.Day:"",u.PictureSingle.Day),a?o+=e.dateAltSeparator:(o+=m(e,u.PictureSingle.DateSep),i&&(o+=m(e,u.PictureSingle.Space)))),o+=C(e,u.PictureSingle.Month,u.PictureSingle.Month,u.PictureSingle.Month),r&&(o+=a?e.dateAltSeparator:m(e,i?u.PictureSingle.Space:u.PictureSingle.DateSep),o+=C(e,u.PictureSingle.Year,u.PictureSingle.Year)),o}t.buildMMDDYYFormat=k,t.getKnownFormat=function(e,t){switch(t){case s.KnownFormat.General:return p(e,u.PictureSpecial.General);case s.KnownFormat.NoComFixed0:return g(e,!1,1,0);case s.KnownFormat.NoComFixed:return g(e,!1,1,2);case s.KnownFormat.Fixed0:return g(e,!0,4,0);case s.KnownFormat.Fixed:return g(e,!0,4,2);case s.KnownFormat.Currency:return F(e,!1,0,!0,!1);case s.KnownFormat.CoCurrency:return F(e,!0,0,!0,!1);case s.KnownFormat.CurrencyDec:return F(e,!1,2,!0,!1);case s.KnownFormat.CoCurrencyDec:return F(e,!0,2,!0,!1);case s.KnownFormat.Pct0:return h(e,0);case s.KnownFormat.Pct:return h(e,2);case s.KnownFormat.Exp:return v(e,1,2,2);case s.KnownFormat.Fract:return y(e,1);case s.KnownFormat.FractBond:return y(e,2);case s.KnownFormat.MMDDYY:return k(e);case s.KnownFormat.DDMMMYY:return T(e,!0,!0);case s.KnownFormat.DDMMM:return T(e,!0,!1);case s.KnownFormat.MMMYY:return T(e,!1,!0);case s.KnownFormat.HHMMAP:return b(e,!0)+P(e);case s.KnownFormat.HHMMSSAP:return E(e,!0)+P(e);case s.KnownFormat.HHMM:return b(e,!1);case s.KnownFormat.HHMMSS:return E(e,!1);case s.KnownFormat.MDYHMS:return C(e,k(e),u.PictureSingle.Space,b(e,!1));case s.KnownFormat.USCoCurrency:case s.KnownFormat.USCoCurrencyDec:return F(o.__assign(o.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:s.CurrencyFormat.Paren}),!0,t===s.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?S(e,"US$"):"$");case s.KnownFormat.Currency2:return F(e,!1,0,!1,!1);case s.KnownFormat.CoCurrency2:return F(e,!0,0,!1,!1);case s.KnownFormat.CurrencyDec2:return F(e,!1,2,!1,!1);case s.KnownFormat.CoCurrencyDec2:return F(e,!0,2,!1,!1);case s.KnownFormat.Acct:return F(e,!1,0,!1,!0);case s.KnownFormat.AcctDec:return F(e,!1,2,!1,!0);case s.KnownFormat.AcctCur:return F(e,!1,0,!0,!0);case s.KnownFormat.AcctDecCur:return F(e,!1,2,!0,!0);case s.KnownFormat.MMSS:return C(e,u.PictureSingle.Minute,u.PictureSingle.Minute,u.PictureSingle.Colon,u.PictureSingle.Second,u.PictureSingle.Second);case s.KnownFormat.AbsHMMSS:return C(e,u.PictureSingle.ColorStart,u.PictureSingle.Hour,u.PictureSingle.ColorEnd,u.PictureSingle.Colon,u.PictureSingle.Minute,u.PictureSingle.Minute,u.PictureSingle.Colon,u.PictureSingle.Second,u.PictureSingle.Second);case s.KnownFormat.SS0:return C(e,u.PictureSingle.Minute,u.PictureSingle.Minute,u.PictureSingle.Colon,u.PictureSingle.Second,u.PictureSingle.Second,u.PictureSingle.Decimal,"0");case s.KnownFormat.Eng:return v(e,3,1,1);case s.KnownFormat.Text:return m(e,u.PictureSingle.Text)}},t.isKnownFormatDefined=function(e,t){switch(e){case s.KnownFormat.USCoCurrency:case s.KnownFormat.USCoCurrencyDec:return t.isEastAsia;default:return!0}},t.englishXLSXKnownFormat={0:s.KnownFormat.General,1:s.KnownFormat.NoComFixed0,2:s.KnownFormat.NoComFixed,3:s.KnownFormat.Fixed0,4:s.KnownFormat.Fixed,5:s.KnownFormat.Currency,6:s.KnownFormat.CoCurrency,7:s.KnownFormat.CurrencyDec,8:s.KnownFormat.CoCurrencyDec,9:s.KnownFormat.Pct0,10:s.KnownFormat.Pct,11:s.KnownFormat.Exp,12:s.KnownFormat.Fract,13:s.KnownFormat.FractBond,14:s.KnownFormat.MMDDYY,15:s.KnownFormat.DDMMMYY,16:s.KnownFormat.DDMMM,17:s.KnownFormat.MMMYY,18:s.KnownFormat.HHMMAP,19:s.KnownFormat.HHMMSSAP,20:s.KnownFormat.HHMM,21:s.KnownFormat.HHMMSS,22:s.KnownFormat.MDYHMS,37:s.KnownFormat.Currency2,38:s.KnownFormat.CoCurrency2,39:s.KnownFormat.CurrencyDec2,40:s.KnownFormat.CoCurrencyDec2,41:s.KnownFormat.Acct,42:s.KnownFormat.AcctCur,43:s.KnownFormat.AcctDec,44:s.KnownFormat.AcctDecCur,45:s.KnownFormat.MMSS,46:s.KnownFormat.AbsHMMSS,47:s.KnownFormat.SS0,48:s.KnownFormat.Eng,49:s.KnownFormat.Text}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(3);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;var n=r(3);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(1);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tooWide=t.stringEdit=t.renderedValueToString=t.renderedValue=t.renderInfiniteWidth=t.renderCallback=t.previousFormatFailure=t.otherEdit=t.numberEdit=t.notValueString=t.notFormatString=t.noFormatPart=t.memoizedRenderCallback=t.isSystemCultureTag=t.isHashesValue=t.isFormatCultureEqual=t.hashesValue=t.fractionOverflow=t.formulaEdit=t.formattedValue=t.formattedUnitString=t.formattedUnitGeneral=t.formattedUnitFlexible=t.formattedUnitBlank=t.evalFormatLocalsGrid=t.dateOverflow=t.createFormatGlobals=t.aggregationError=t.ReasonKind=t.NumberFormatSource=t.NamedColor=t.GetTimeKind=t.FormattedUnitKind=t.FormatValueType=t.FormatReasonKind=t.FormatCurrency=t.EditKind=t.CultureTag=t.Clip=t.BidiDate=t.Alignment=void 0;var n=r(38);t.Alignment=n.serviceTypes.Alignment,t.BidiDate=n.serviceTypes.BidiDate,t.Clip=n.serviceTypes.Clip,t.CultureTag=n.serviceTypes.CultureTag,t.EditKind=n.serviceTypes.EditKind,t.FormatCurrency=n.serviceTypes.FormatCurrency,t.FormatReasonKind=n.serviceTypes.FormatReasonKind,t.FormatValueType=n.serviceTypes.FormatValueType,t.FormattedUnitKind=n.serviceTypes.FormattedUnitKind,t.GetTimeKind=n.serviceTypes.GetTimeKind,t.NamedColor=n.serviceTypes.NamedColor,t.NumberFormatSource=n.serviceTypes.NumberFormatSource,t.ReasonKind=n.serviceTypes.ReasonKind,t.aggregationError=n.serviceTypes.aggregationError,t.createFormatGlobals=n.serviceTypes.createFormatGlobals,t.dateOverflow=n.serviceTypes.dateOverflow,t.evalFormatLocalsGrid=n.serviceTypes.evalFormatLocalsGrid,t.formattedUnitBlank=n.serviceTypes.formattedUnitBlank,t.formattedUnitFlexible=n.serviceTypes.formattedUnitFlexible,t.formattedUnitGeneral=n.serviceTypes.formattedUnitGeneral,t.formattedUnitString=n.serviceTypes.formattedUnitString,t.formattedValue=n.serviceTypes.formattedValue,t.formulaEdit=n.serviceTypes.formulaEdit,t.fractionOverflow=n.serviceTypes.fractionOverflow,t.hashesValue=n.serviceTypes.hashesValue,t.isFormatCultureEqual=n.serviceTypes.isFormatCultureEqual,t.isHashesValue=n.serviceTypes.isHashesValue,t.isSystemCultureTag=n.serviceTypes.isSystemCultureTag,t.memoizedRenderCallback=n.serviceTypes.memoizedRenderCallback,t.noFormatPart=n.serviceTypes.noFormatPart,t.notFormatString=n.serviceTypes.notFormatString,t.notValueString=n.serviceTypes.notValueString,t.numberEdit=n.serviceTypes.numberEdit,t.otherEdit=n.serviceTypes.otherEdit,t.previousFormatFailure=n.serviceTypes.previousFormatFailure,t.renderCallback=n.serviceTypes.renderCallback,t.renderInfiniteWidth=n.serviceTypes.renderInfiniteWidth,t.renderedValue=n.serviceTypes.renderedValue,t.renderedValueToString=n.serviceTypes.renderedValueToString,t.stringEdit=n.serviceTypes.stringEdit,t.tooWide=n.serviceTypes.tooWide},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(3);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.missingNode=t.identNode=t.varNode=t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=void 0;var n=r(3);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound,t.varNode=n.formulaModule.varNode,t.identNode=n.formulaModule.identNode,t.missingNode=n.formulaModule.missingNode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormulaFormatToUnion=t.cellFormatToInferredFormat=t.namedObjectToNamedObjectData=t.namedObjectDataToNamedObject=t.readOperToCellValue=t.cellValueToReadOper=t.createExcludeCellSet=t.gridCellToCellLocation=t.sheetGridRangeToLocation=t.sheetGridRangeToHiddenCols=t.sheetGridRangeToHiddenRows=t.sheetGridRangeToCellSet=t.unusedCellsUpdateToUsedRange=t.sheetCellLocationToGridCell=t.sheetRangeLocationToGridRange=t.localeInfoFromData=t.createLocaleInfo=void 0;var n=r(0),i=r(2),a=r(12),o=r(15),s=r(77),u=r(30),l=r(78),c=r(20),d=r(72),p=r(11),m=r(69),f=r(39),g=r(4),h=r(93),v=r(139),S=r(51),y=r(9);function F(e,t){var r,o=(0,i.makeStringCompareCI)("en-US"),s=function(e,t,r){var n=(0,a.getEnglishWorksheetFuncIdToName)().slice();return(0,h.filterCheck)(t,h.chWorksheetFunctionName,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),(0,a.createWorksheetFuncNameCallbacks)(e,n)}(o,e.worksheetFunctionNames,t),u=s.getWorksheetFuncId,l=s.getWorksheetFuncName,c=(r=e.thousandsData,(0,i.isNone)(r)?function(e){return e>0&&e%3==0}:(0,a.createIsThousandsPositionCallback)(r)),d=function(e,t){var r=a.englishErrorNames.slice();return(0,h.filterCheck)(e,h.chErrorTypeName,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t),p=e.lcid,m=p===a.LCID.Thailand,f=p===a.LCID.Korea,g=p===a.LCID.Japan,v=p===a.LCID.ChinaT||p===a.LCID.HongKong,S=p===a.LCID.China,y=f||g||S||v,F=p===a.LCID.Hindi||p===a.LCID.Tamil,C=p===a.LCID.Thailand||p===a.LCID.Vietnam||F,R=(p&a.LCID.LANG)==(a.LCID.Hebrew&a.LCID.LANG)||(p&a.LCID.LANG)==(a.LCID.Arabic&a.LCID.LANG)||p===a.LCID.Syriac||C,b=";"===e.listSeparator||";"===e.decimalSeparator?";;":";";return n.__assign(n.__assign({},e),{leftBracket:"[",rightBracket:"]",rcLeftBracket:e.leftBracket,rcRightBracket:e.rightBracket,getWorksheetFuncId:u,getWorksheetFuncName:l,isNumeral:a.isNumeral,getOrdinal:a.getOrdinal,getNumberShape:a.getNumberShape,isThousandsPosition:c,isIdentStart:a.isIdentStart,isIdentContinue:a.isIdentContinue,stringCompareCI:o,errorNames:d,statementSeparator:b,isThai:m,isEastAsia:y,isKorea:f,isJapan:g,isChinaT:v,isChinaS:S,isComplexScript:R})}function C(e,t){return(0,i.isNone)(t)?{index:e,length:1}:{index:e,length:(0,i.fastAbs)(t-e)+1}}function R(e,t){var r=C(t.row,t.lastRow),n=r.index,i=r.length,a=C(t.column,t.lastColumn),s=a.index,u=a.length;return(0,o.sheetGridRange)((0,o.sheetIndex)(e,t.sheetId),(0,o.gridRange)(n,s,i,u))}function b(e){return(0,p.isSheetGridCell)(e)?(0,s.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col):(0,s.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}t.createLocaleInfo=F,t.localeInfoFromData=function(e){return F(e,{})},t.sheetRangeLocationToGridRange=R,t.sheetCellLocationToGridCell=function(e,t){var r=t.row,n=t.column;return(0,o.sheetGridCell)((0,o.sheetIndex)(e,t.sheetId),(0,o.gridCell)(r,n))},t.unusedCellsUpdateToUsedRange=function(e,t){var r=t.sheetId,a=t.usedRange;return(0,i.isDefined)(a)?R(e,n.__assign({sheetId:r},a)):(0,c.sheetUsedRange)((0,o.sheetIndex)(e,r),l.emptyUsedRange)},t.sheetGridRangeToCellSet=function(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=(0,f.createFromProduct)({row:t}),i=(0,f.createFromProduct)({col:r}),a=(0,f.unionProduct)(n,i);return(0,f.exceptProduct)((0,u.createCellSetFromRange)(e),a)}(e.range,t,r)}},t.sheetGridRangeToHiddenRows=function(e,t){return{sheet:e.sheet,range:e.range,hidden:t}},t.sheetGridRangeToHiddenCols=function(e,t){return{sheet:e.sheet,range:e.range,hidden:t}},t.sheetGridRangeToLocation=b,t.gridCellToCellLocation=function(e){return{row:e.row,column:e.col}},t.createExcludeCellSet=function(e,t,r,n){var a=m.empty;if((0,i.isNone)(n))return a;for(var o=0;o<n.length;o+=1){var s=n[o];if(e<=s&&s<e+t){for(var u=1;o+u<n.length&&n[o+u]===s+u;)u+=1;o+=u-1,a=(0,m.union)(a,r((0,i.pair)(s,s+u)))}}return a},t.cellValueToReadOper=function(e,t){switch(typeof t){case"string":return(0,d.stringOper)(t);case"boolean":return(0,d.booleanOper)(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return d.blankOper;case"Error":return(0,d.errorOper)(t.type);default:return}},t.readOperToCellValue=function(e,t){switch(t.kind){case S.OperKind.String:case S.OperKind.Boolean:return t.value;case S.OperKind.Number:return e.toNumber(t);case S.OperKind.Error:return(0,s.errorValue)(t.type);case S.OperKind.Blank:return s.blankValue;default:return}},t.namedObjectDataToNamedObject=function(e,t,r,n){if(!(0,i.isNone)(n))switch(n.kind){case"NamedValue":switch(typeof n.value){case"string":return(0,v.namedValue)((0,d.stringOper)(n.value));case"boolean":return(0,v.namedValue)((0,d.booleanOper)(n.value));case"number":return(0,v.namedValue)(e.fromNumber(n.value))}return"Error"===n.value.kind?(0,v.namedValue)((0,d.errorOper)(n.value.type)):(0,g.assertNever)("calc.calc.namedObjectDataToNamedObject: NamedValue",n.value.kind);case"NamedFormula":return(0,v.namedFormula)(n.formulaBarText);case"NamedRange":var a=R(r,n.range);return(0,v.namedRange)((0,d.range3DOper)(a.sheet,a.range));case"NamedTable":var o=R(r,n.range);return(0,v.namedTable)(o,n.hasHeadersRow,n.hasTotalsRow,n.columns,t);case"NamedFailure":return(0,v.namedFailure)(n.failureReason,(0,i.isNone)(n.objectKind)?void 0:n.objectKind);default:return(0,g.assertNever)("calc.calc.namedObjectDataToNamedObject: kind",n)}},t.namedObjectToNamedObjectData=function(e,t,r){if(r)switch(r.kind){case"NamedValue":switch(r.value.kind){case S.OperKind.Number:return(0,s.namedValueData)(e.toNumber(r.value));case S.OperKind.String:case S.OperKind.Boolean:return(0,s.namedValueData)(r.value.value);case S.OperKind.Error:return(0,s.namedValueData)(r.value.type);default:return}case"NamedFormula":return(0,s.namedFormulaData)(r.fmla);case"NamedRange":var n=(0,o.sheetGridRange)((0,o.sheetIndex)(t,r.value.sheets.index),r.value.ranges[0]);return(0,s.namedRangeData)(b(n));case"NamedTable":var i=r.specialRefRanges[y.SpecialRefId.Data],a=[];return r.columnIndexes.forEach((function(e,t){return a.push((0,s.columnData)(e,t)),!0})),(0,s.namedTableData)(b(i),r.hasHeadersRow,r.hasTotalsRow,a);case"NamedFailure":return r;default:return(0,g.assertNever)("calc.calc.namedObjectToNamedObjectData: kind",r)}},t.cellFormatToInferredFormat=function(e){if(void 0!==e)return(0,c.isOutputFormatUnavailable)(e.format)?(0,s.inferredFormat)({kind:e.format.kind},e.valueType,e.decimals):(0,s.inferredFormat)(e.format,e.valueType,e.decimals)},t.evalFormulaFormatToUnion=function(e){if(null!=e)switch(e.kind){case"Origin":return{kind:c.SpecialFormat.Origin};case"Iformat":return(0,g.assertTrue)("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Known":return(0,g.assertTrue)("calc.calc.evalFormulaFormatToUnion: knownFormat","number"==typeof e.knownFormat),{kind:c.SpecialFormat.Known,knownFormat:e.knownFormat};case"Inferred":return{kind:c.SpecialFormat.Inferred};case"Aggregate":return{kind:c.SpecialFormat.Aggregate};default:return(0,g.assertNever)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvablePromiseWithSyncValue=t.ResolvablePromiseWithTimeout=t.ResolvablePromise=void 0;var n=r(1);t.ResolvablePromise=n.resolvablePromise.ResolvablePromise,t.ResolvablePromiseWithTimeout=n.resolvablePromise.ResolvablePromiseWithTimeout,t.ResolvablePromiseWithSyncValue=n.resolvablePromise.ResolvablePromiseWithSyncValue},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTimerInterface=t.TimelineQueueProcessor=void 0;var n=r(79);t.TimelineQueueProcessor=n.timelineQueueProcessor.TimelineQueueProcessor,t.defaultTimerInterface=n.timelineQueueProcessor.defaultTimerInterface},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaybeThenable=t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=t.ResolvablePromiseWithTimeout=t.ResolvablePromiseWithSyncValue=t.ResolvablePromise=void 0;var n=r(0),i=r(49),a=function(){function e(){var e=this;this.promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(e){return this._resolve(e),u(e)?this.promise.then():void 0},e.prototype.reject=function(e){return this._reject(e),u(e)?this.promise.then():void 0},e}();t.ResolvablePromise=a;var o=function(e){function t(){var t=e.call(this)||this;return t.value=void 0,t.isUninitialized=!0,t.then((function(e){return t.value=e})),t}return n.__extends(t,e),t.prototype.getCurrentValue=function(){return this.value},t.prototype.resolve=function(t){return u(t)||this.isUninitialized&&(this.value=t,this.isUninitialized=!1),e.prototype.resolve.call(this,t)},t}(a);t.ResolvablePromiseWithSyncValue=o;var s=function(e){function t(t,r){var n=e.call(this)||this;return r.setTimeout((function(){var e=new Error("Promise timeout");e.name="TimeoutError",n.reject(e)}),t),n}return n.__extends(t,e),t}(a);function u(e){return(0,i.isDefined)(e)&&"function"==typeof e.then}t.ResolvablePromiseWithTimeout=s,t.promiseFinally=function(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))},t.newPromise=function(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]},t.promiseLoop=function(e,t){var r;return new Promise((function(n,i){Promise.resolve(t).then((function t(a){if(void 0!==a){r=a;try{Promise.resolve(e(r)).then(t,i)}catch(e){i(e)}}else n(r)}),i)}))},t.isThenable=u,t.bindMaybeThenable=function(e,t,r){return u(e)?e.then(t,r):t(e)},t.collapseThenable=function(e){return e},t.MaybeThenable={all:function(e){var t=new Array(e.length),r=new a,n=0;return e.forEach((function(i,a){u(i)?i.then((function(i){t[a]=i,++n===e.length&&r.resolve(t)}),(function(e){r.reject(e)})):t[a]=i})),r},any:function(e){var t=new a;return e.forEach((function(e,r){if(!u(e))return t.resolve({result:e,resolvedIndex:r});e.then((function(e){t.resolve({result:e,resolvedIndex:r})}),(function(e){t.reject(e)}))})),t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatName=t.formatGridRange=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;var n=r(0),i=r(50),a=r(40),o=r(156),s=r(42),u=n.__importStar(r(125)),l=r(102),c=r(89),d=(0,a.pos)(a.PosKind.Abs,0),p=(0,a.pos)(a.PosKind.Abs,i.sheetRows-1),m=u.codePointCapitalA,f=u.codePointFullStop;function g(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(m+n)+r,t=Math.floor((t-n)/26)}return r}function h(e,t,r,n){if(t.kind===a.PosKind.Abs)return t.index;if(n)return(0,o.wrapPosition)(e,t.index,r);var i=e+t.index;return 0<=i&&i<r?i:void 0}function v(e,t,r,n,i,o){var s=h(r,n,i,o);if(void 0!==s){if(n.kind===a.PosKind.Abs)return t+(s+1).toFixed();var u=s-r;return 0===u?t:t+e.rcLeftBracket+u.toFixed()+e.rcRightBracket}}function S(e,t,r,n,o){return t===a.RefStyle.A1?function(e,t,r){var n=h(e,t,i.sheetRows,r);if(void 0!==n){var o=(n+1).toFixed();return t.kind===a.PosKind.Abs?"$"+o:o}}(r,n,o):v(e,e.rowLetter,r,n,i.sheetRows,o)}function y(e,t,r,n,o){return t===a.RefStyle.A1?function(e,t,r){var n=h(e,t,i.sheetCols,r);if(void 0!==n){var o=g(n);return t.kind===a.PosKind.Abs?"$"+o:o}}(r,n,o):v(e,e.columnLetter,r,n,i.sheetCols,o)}function F(e,t,r,n){if(r.kind===a.PosKind.Abs)return r;var i=h(t,r,e,n);if(void 0!==i){var o=i-t;return o===r.index?r:(0,a.pos)(a.PosKind.Rel,o)}}function C(e,t,r,n,i){var a=h(e,t,n,i),o=h(e,r,n,i);if(void 0!==a&&void 0!==o)return a<=o?[t,r,a,o]:[r,t,o,a]}function R(e,t,r,n,i,o,s,u,l){var c=C(o,s,u,r,l);if(void 0!==c){var d=c[0],p=c[1],m=c[2],f=c[3];if(void 0!==t&&0===m&&f===r-1&&s.kind===u.kind)return t(n,i,l);var g=e(n,i,o,d,l);if(void 0!==g){if(i===a.RefStyle.R1C1&&d.kind===p.kind&&d.index===p.index)return g;var h=e(n,i,o,p,l);if(void 0!==h)return g+":"+h}}}function b(e,t,r,n,i,a){var o=C(r,n,i,t,a);if(void 0!==o){var s=o[0],u=o[1],l=o[2],c=o[3];if(void 0!==e&&0===l&&c===t-1&&n.kind===i.kind)return e;var d=F(t,r,s,a),p=F(t,r,u,a);if(void 0!==d&&void 0!==p)return[!1,d,p]}}function E(e,t,r,n,i,o){var s=S(e,t,r.row,n,o),u=y(e,t,r.col,i,o);if(void 0!==s&&void 0!==u)return t===a.RefStyle.A1?u+s:s+u}function P(e,r,n,a,o,s,u,l){var c=C(n.row,a,s,i.sheetRows,l),d=C(n.col,o,u,i.sheetCols,l);if(void 0!==c&&void 0!==d){var p=c[0],m=c[1],f=c[2],g=c[3],h=d[0],v=d[1],S=d[2],y=d[3];if(0===S&&y===i.sheetCols-1&&o.kind===u.kind)return(0,t.formatRowRange)(e,r,n.row,p,m,l);if(0===f&&g===i.sheetRows-1&&a.kind===s.kind)return(0,t.formatColRange)(e,r,n.col,h,v,l);var F=E(e,r,n,p,h,l),R=E(e,r,n,m,v,l);if(void 0!==F&&void 0!==R)return F+":"+R}}function k(e,t){return t===f||e.isIdentContinue(t)}t.columnName=g,t.canonicaliseBrackets=function(e,t){return e===a.RefStyle.R1C1&&t.kind===a.PosKind.Rel&&0!==t.index},t.resolvePosition=h,t.formatRow=S,t.formatCol=y,t.canonicaliseRow=F.bind(void 0,i.sheetRows),t.canonicaliseCol=F.bind(void 0,i.sheetCols),t.formatRowRange=R.bind(void 0,S,void 0,i.sheetRows),t.formatColRange=R.bind(void 0,y,(function(e,r,n){return(0,t.formatRowRange)(e,r,0,d,p,n)}),i.sheetCols),t.canonicaliseRowRange=b.bind(void 0,void 0,i.sheetRows),t.canonicaliseColRange=b.bind(void 0,[!0,d,p],i.sheetCols),t.formatCellPos=E,t.canonicaliseCellPos=function(e,r,n,i){var a=(0,t.canonicaliseRow)(e.row,r,i),o=(0,t.canonicaliseCol)(e.col,n,i);if(void 0!==a&&void 0!==o)return{row:a,col:o}},t.formatRangePos=P,t.canonicaliseRangePos=function(e,r,n,a,o,s){var u=C(e.row,r,a,i.sheetRows,s),l=C(e.col,n,o,i.sheetCols,s);if(void 0!==u&&void 0!==l){var c=u[0],d=u[1],p=u[2],m=u[3],f=l[0],g=l[1],h=l[2],v=l[3],S=(0,t.canonicaliseRow)(e.row,c,s),y=(0,t.canonicaliseCol)(e.col,f,s),F=(0,t.canonicaliseRow)(e.row,d,s),R=(0,t.canonicaliseCol)(e.col,g,s);if(void 0!==S&&void 0!==y&&void 0!==F&&void 0!==R)return 0===h&&v===i.sheetCols-1&&n.kind===o.kind?{row1:S,row2:F,col1:void 0,col2:void 0}:0===p&&m===i.sheetRows-1&&r.kind===a.kind?{col1:y,col2:R,row1:void 0,row2:void 0}:{row1:S,col1:y,row2:F,col2:R}}};var T=/'/g;function A(e,t){if(0===t.length)return!1;var r=0,n=(0,l.stringCodePointAt)(t,r);if(!e.isIdentStart(n))return!1;r+=(0,l.numCodeUnits)(n);for(var i=0,a=(0,l.codePointIterator)(t,r);i<a.length;i++){if(!k(e,a[i]))return!1}return!0}var N=(0,i.gridCell)(0,0);function _(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=(0,o.parseCellRef)(e,t,N,r,0);if(void 0!==n)if(n.refStyle===a.RefStyle.A1){var i=n.i;if(i>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,i)))return!0}else if(!(0,o.isR1C1IdentStart)(n.row,n.col))return!0;return!A(e,r)&&(!function(e,t){var r=0;if(!(0,c.stringStartsWith)(t,e.leftBracket,r))return!1;if((r+=e.leftBracket.length)===t.length)return!1;var n=(0,l.stringCodePointAt)(t,r);if(!k(e,n))return!1;for(r+=(0,l.numCodeUnits)(n);;){if((0,c.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;var i=(0,l.stringCodePointAt)(t,r);if(!k(e,i))return!1;r+=(0,l.numCodeUnits)(i)}var a=t.indexOf(":",r);return a<0?A(e,t.substring(r)):A(e,t.substring(r,a))&&A(e,t.substring(a+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&A(e,t.substring(r,t.length-n))))}(e,r))}function I(e,t,r){return _(e,t,r)?O(r):r}function O(e){return"'".concat(e.replace(T,"''"),"'")}t.shouldQuoteQualifier=_,t.formatQualifier=I,t.quoteQualifier=O,t.formatGridRange=function(e,t,r,n,o){void 0===r&&(r=a.RefStyle.A1);var u=1===t.cols&&1===t.rows?E(e,r,(0,i.gridCell)(0,0),(0,a.pos)(a.PosKind.Rel,t.row),(0,a.pos)(a.PosKind.Rel,t.col),!1):P(e,r,(0,i.gridCell)(0,0),(0,a.pos)(a.PosKind.Rel,t.row),(0,a.pos)(a.PosKind.Rel,t.col),(0,a.pos)(a.PosKind.Rel,t.row+t.rows-1),(0,a.pos)(a.PosKind.Rel,t.col+t.cols-1),!1);if((0,s.assertTrue)("calc.lang.formatGridRange",void 0!==u),void 0===n&&void 0===o)return u;if(void 0===n||void 0===o)return I(e,r,null!=n?n:o)+"!"+u;var l=n+":"+o;return(_(e,r,n)||_(e,r,o)?O(l):l)+"!"+u},t.formatName=function(e,t,r,n){return void 0===r&&(r=a.RefStyle.A1),void 0===n?t:I(e,r,n)+"!"+t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(1);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Mod=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(388),i=r(389),a=r(390),o=new ArrayBuffer(8),s=new Int32Array(o),u=(new Float32Array(o),new Float64Array(o));function l(e){return s[e]}function c(e,t){s[e]=t}function d(){return u[0]}function p(e){u[0]=e}var m,f=new ArrayBuffer(65536),g=(m=new Uint8Array(f),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)m[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)m[e+n]=r[n]});g(1024,"yAwAAAEAAAACAAAAAwAAAAAAAAAE"),g(1056,"AQAAAAsAAAANAAAABwAAAAkAAAADAAAABQAAAA8AAAAAAAEAMAACADkAMQAcAAMAPQA6ADIAKgAmAB0AEQAEAD4ANwA7ACQANQAzACsAFgAtACcAIQAeABgAEgAMAAUAPwAvADgAGwA8ACkAJQAQADYAIwA0ABUALAAgABcACwAuABoAKAAPACIAFAAfAAoAGQAOABMACQANAAgABwAGAJAMAACYDAAAoAwAAKgMAAAfHR8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHR8eHx4fHx4fHh8="),g(1312,"WAwAAHAMAABoDAAAeAw="),g(1359,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),g(1759,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),g(2135,"oAQ="),g(2151,"yAc="),g(2167,"+go="),g(2182,"QJwO"),g(2198,"UMMR"),g(2214,"JPQU"),g(2229,"gJaYGA=="),g(2245,"ILy+Gw=="),g(2261,"KGvuHg=="),g(2277,"+QKVIg=="),g(2292,"QLdDuiU="),g(2308,"EKXU6Cg="),g(2324,"KueEkSw="),g(2339,"gPQg5rUv"),g(2355,"oDGpX+My"),g(2371,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//w=="),g(3126,"kEEYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),g(3182,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQAAsOlNYnBCBAQAABAE"),g(3904,"4E8=");var h=function(e,t,r){var n=new e.Int8Array(r),i=new e.Int16Array(r),a=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),m=new e.Uint32Array(r),f=(new e.Float32Array(r),new e.Float64Array(r)),g=e.Math.imul,h=(e.Math.fround,e.Math.abs),v=e.Math.clz32,S=e.Math.min,y=(e.Math.max,e.Math.floor),F=e.Math.ceil,C=e.Math.sqrt,R=t.abort,b=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),E=t.Base_LocaleGetOrdinal,P=t.Base_LocaleDecimalSeparator,k=t.Math_log10,T=t.Math_log,A=(C=t.Math_sqrt,t.Math_sin),N=t.Math_cos,_=t.Math_tan,I=t.Math_atan,O=t.Math_exp,M=t.proc_exit,D=t.getTempRet0,w=20288,L=0;function x(){}function K(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function U(e,t){var r,s,c=0,d=0,m=0,g=0;if(d=3856,w=r=w-48|0,a[r+40>>2]=0,i[r+30>>1]=0,i[r+32>>1]=0,f[482]=e,s=z(e),f[482]=s,Fe(s,r+40|0,r,15),u[r+42>>1]){c=(0|(c=pe(t)<<16))<0?100:c>>16,p(+t),m=0|l(1),l(0),(g=-65536&m)&&(2146435072!=(2146435072&m)?c=(0|g)<1?0-c|0:c:a[966]=1);e:{if(!((0|(c=i[r+40>>1]+c|0))>=i[r+42>>1])){if((0|c)<1){d=3168;break e}(255&c)>>>0>=o[r+30|0]||(n[r+30|0]=c)}ye(3276,3856,r)}e=f[d>>3]}return w=r+48|0,e}function B(e,t){var r,n=0,i=0,o=0;if(f[482]=e,p(+e),i=0|l(1),l(0),o=i,i=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?i=(0|n)<1:(a[966]=1,i=0)),a[965]=2147483647&o,re(f[395]),n=-65536&(o=a[965]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return Q(8),0}else a[966]=1;r=ne(f[395],e),be(f[393],r),ie(r),ge();e:{t:{if((n=a[965])>>>0>=65536){if(2146435072!=(2146435072&n))break t;a[966]=1}if(t){if(a[964]=0,a[965]=0,!i)break e;return t=a[783],a[964]=a[782],a[965]=t,f[482]}if(n=a[789],a[964]=a[788],a[965]=n,t=n,1^i|n>>>0<65536)break e;return a[965]=-2147483648^t,f[482]}ke(e),he(),t&&(f[482]=ne(f[394],f[482]))}return f[482]}function W(e,t,r,n){var s,l=0,c=0,d=0,p=0,m=0,f=0,h=0;if(l=a[e+4>>2],m=-2146827284,!((0|(s=(c=u[e>>1])+(e=(0|(d=i[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|s)||((d=d+g(e,-12)<<16>>16)+-1&65535)>>>0>11|(!l|1900==(0|s)&2==(0|d)&29==(0|l)?!r:0))){if(f=(0|(e=(p=(0|(c=s+1e4|0))/4|0)<<2))%100|0,h=(0|e)%400|0,l=(((p=g(p,1461)+l|0)+((0|(l=e+-1|0))/-100|0)|0)+((0|l)/400|0)|0)-1|0,c=(g(c-e|0,12)+d|0)-1|0)for(c=c+(e=h?f?0:12:0)|0;l=o[e+1232|0]+l|0,(0|c)!=(0|(e=e+1|0)););e:if(r||t){if(e=l+-4346385|0,!((0|s)>1900|(0|d)>=3))break e;e=l+-4346384|0}else e=l+-4346384|0;e>>>0>2958465||(a[n>>2]=e,m=0)}return m}function G(e,t,r){var n,s,u,l=0,c=0,d=0;c=d=Ie(e,t,711573504,201),a[r+28>>2]=(c+1>>>0)%7,l=c+g(n=(c>>>0)/146097|0,-146097)|0,s=(g(l,100)+75>>>0)/3652425|0,l=((u=g(s,-36524)+l|0)>>>0)/1461|0,c=(((c+(((l=((g(s,100)+g(n,400)|0)+(l<<2)|0)+((g(u+g(l,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(l>>>2)|0)-((l>>>0)/400|0)|0)+g(l,-365)|0,d=_e(d,L,-864e5,-1),e=Ie(e,t,1e4,0)+d|0,d=!(((t=l+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?2096+((t=o[c+1728|0])<<1)|0:1696+((t=o[c+1328|0])<<1)|0,a[r+12>>2]=(e>>>0)/36e5,a[r+4>>2]=t+1,a[r>>2]=l+1601,t=(e>>>0)/1e3|0,a[r+20>>2]=(t>>>0)%60,a[r+16>>2]=((e>>>0)/6e4>>>0)%60,a[r+24>>2]=e-g(t,1e3),a[r+8>>2]=1+(c-i[d>>1]|0)}function V(e,t){var r=0,n=0,o=0,s=0,u=0,l=0,c=0,d=0,p=0,m=0,f=0,h=0;return(0|(s=a[e+4>>2]))<1||(d=s+-1|0)>>>0>11||(n=(r=a[e>>2])+-1601|0)>>>0>29226||(0|(u=a[e+8>>2]))<1||(o=1696,((l=65535&r)>>>0)%400&&(o=3&r?2096:(l>>>0)%100|0?1696:2096),(p=a[e+24>>2])>>>0>999||(l=a[e+20>>2])>>>0>59||(m=a[e+16>>2])>>>0>59||(f=a[e+12>>2])>>>0>23||(u=u+-1|0)>>>0>=i[o+(s<<1)>>1]-i[o+(d<<1)>>1]>>>0||(o=n>>>2,s=g(n,365),n=((e=65535&n)>>>0)/400|0,h=(e>>>0)/100|0,((c=65535&(r=r+-1600|0))>>>0)%400&&(e=2096,!((c>>>0)%100)|3&r)||(e=1696),c=1,r=(r=g(g(g(f,60)+m|0,60)+l|0,1e3)+p|0)+(n=_e(e=i[(d<<1)+e>>1]+(n+((u+(s+o|0)|0)-h|0)|0)|0,e>>31,864e5,0))|0,e=L,a[t>>2]=_e(r,r>>>0<n>>>0?e+1|0:e,1e4,0),a[t+4>>2]=L)),c}function j(e,t,r,n){var i,o=0,s=0,u=0,l=0;w=i=w-112|0,G(r,n,i+80|0);e:{if(a[e>>2]){if(!V(e,t))break e}else{if((0|(s=a[e+8>>2]))>5|!s)break e;if(r=a[e+4>>2],n=a[e+28>>2],o=a[i+80>>2],a[i+56>>2]=1,a[i+52>>2]=r,a[i+48>>2]=o,a[i+60>>2]=a[e+12>>2],a[i+64>>2]=a[e+16>>2],a[i+68>>2]=a[e+20>>2],e=a[e+24>>2],a[i+76>>2]=0,a[i+72>>2]=e,!V(i+48|0,i+8|0)){o=0;break e}e=n+8|0,r=n+1|0,u=(0|s)<2,G(a[i+8>>2],a[i+12>>2],i+16|0),l=i;t:{if((0|n)<(0|(o=a[i+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}a[l+56>>2]=e}t:if(!u&&(r=e+7|0,a[i+56>>2]=r,o=1,V(i+48|0,i+8|0)))for(;;){if(G(a[i+8>>2],a[i+12>>2],i+16|0),e=a[i+24>>2],(0|s)==(0|(o=o+1|0)))break t;if(r=r+7|0,a[i+56>>2]=r,!V(i+48|0,i+8|0))break}if(a[i+56>>2]=e,!V(i+48|0,i+8|0)){o=0;break e}e=a[i+12>>2],a[t>>2]=a[i+8>>2],a[t+4>>2]=e}o=1}return w=i+112|0,o}function q(e,t,r){var n,o=0,s=0,l=0,c=0,d=0;if(w=n=w-16|0,r&&(l=r>>31,l^=l+r))for(r=(0|r)>0?2112:2608;(o=15&l)&&(s=i[(o=(o<<4)+r|0)+8>>1],d=H(f[e>>3],f[o>>3],n),t=t+s|0,i[n+14>>1]<=0?(o=u[n+6>>1],s=u[n+8>>1]):(s=a[n+4>>2],o=u[n+6>>1]<<1,i[n+6>>1]=o,c=a[n+8>>2],a[n+12>>2]=a[n+12>>2]<<1|c>>>31,s=c<<1|s>>>31,a[n+8>>2]=s,t=t+-1|0),(65535&o|1&s|0!=(0|d))>>>0<32769||(s=(o=a[n+8>>2])+1|0,a[n+8>>2]=s,s>>>0>=o>>>0||(s=(o=a[n+12>>2])+1|0,a[n+12>>2]=s,s>>>0>=o>>>0||(a[n+12>>2]=-2147483648,t=t+1|0))),o=a[n+12>>2],a[e>>2]=a[n+8>>2],a[e+4>>2]=o),r=r+240|0,l>>=4;);return w=n+16|0,t}function H(e,t,r){var n,a,o,s=0,u=0,c=0,d=0,m=0,f=0,h=0,v=0,S=0,y=0,F=0,C=0;return p(+t),d=0|l(1),m=65535&(u=0|l(0)),p(+e),y=0|l(1),s=0|l(0),c=y,a=g(v=65535&s,m),i[r>>1]=a,o=((65535&(F=g(S=s>>>16,m)))+(a>>>16)|0)+(65535&(h=g(u>>>=16,v)))|0,i[r+2>>1]=o,F=(((f=((65535&(s=g(n=65535&c,m)))+(F>>>16)|0)+(h>>>16)|0)+(65535&(h=g(u,S)))|0)+(65535&(C=g(y=65535&d,v)))|0)+(o>>>16)|0,i[r+4>>1]=F,h=(((((((65535&(f=g(d>>>=16,v)))+(s>>>16)|0)+(65535&(c=g(s=c>>>16,m)))|0)+(h>>>16)|0)+(C>>>16)|0)+(65535&(m=g(y,S)))|0)+(65535&(v=g(u,n)))|0)+(F>>>16)|0,i[r+6>>1]=h,S=((((((C=(c>>>16)+(f>>>16)|0)+(65535&(c=g(d,S)))|0)+(m>>>16)|0)+(v>>>16)|0)+(65535&(f=g(s,u)))|0)+(65535&(u=g(y,n)))|0)+(h>>>16)|0,i[r+8>>1]=S,f=((u=(((65535&(m=g(d,n)))+(c>>>16)|0)+(f>>>16)|0)+(u>>>16)|0)+(65535&(c=g(s,y)))|0)+(S>>>16)|0,i[r+10>>1]=f,s=(((65535&(d=g(s,d)))+(m>>>16)|0)+(c>>>16)|0)+(f>>>16)|0,i[r+12>>1]=s,i[r+14>>1]=(s>>>16)+(d>>>16),65535&(a|o|F)}function z(e){var t,r,n=0,i=0,o=0,s=0,u=0,c=0;return w=t=w-16|0,f[t+8>>3]=e,p(+e),n=0|l(1),i=0|l(0),r=n,(n&=2146435072)&&(a[t+8>>2]=i<<11,a[t+12>>2]=r<<11|i>>>21|-2147483648,s=(n=g(i=(n>>>20)-1022|0,39457)>>17)+-14|0,o=q(t+8|0,i,14-n|0),i=a[t+8>>2],(0|o)>=(0|(m[t+12>>2]<(i>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=q(t+8|0,o,1),i=a[t+8>>2],s=n+-15|0),n=s,s=(s=i)+(i=-2147483648>>>(31&o))|0,a[t+8>>2]=s,s>>>0>=i>>>0||(c=(u=a[t+12>>2])+1|0,a[t+12>>2]=c,c>>>0>=u>>>0||(a[t+12>>2]=-2147483648,o=o+1|0)),a[t+8>>2]=s&0-(i<<1),o=q(t+8|0,o,n),3071&(n=a[t+8>>2])?(i=n+1024|0,a[t+8>>2]=i,n>>>0<4294966272||(s=(n=a[t+12>>2])+1|0,a[t+12>>2]=s,o=(s>>>0<n>>>0)+o|0)):i=n,(0|o)<=-1023?(a[t+8>>2]=0,a[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=a[t+12>>2],a[t+8>>2]=o<<21|i>>>11,a[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=f[t+8>>3]),w=t+16|0,e}function Q(e){var t;return t=a[966],a[966]=e,t}function Y(){var e,t,r;return e=a[964],t=a[965],ee(1048576),ee(2146435072),i[1931]<0?(a[964]=e,a[965]=t,-2147483648):(r=de(),a[964]=e,a[965]=t,-2147483648^r)}function J(e){var t,r=0,n=0,i=0,a=0;if(p(+e),r=0|l(1),t=0|l(0),a=r,i=0,!((r=2047&(n=r>>>20))>>>0<1023||(i=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return c(0,n&t),c(1,0|a),+d();a&=n,c(0,0),c(1,0|a),i=+d()}return i}function $(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return a[964]=0,a[965]=-2147483648,n=q(3856,1,e),r=a[964],e=a[965],3071&r&&(t=a[965],(e=a[964]+1024|0)>>>0<1024&&(t=t+1|0),a[964]=e,a[965]=t,r=e,e=t),a[964]=e<<21|r>>>11,void(a[965]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(a[966]=1),a[964]=0,a[965]=0}function X(e,t,r,n){var o=0,s=0,l=0;e:{t:{r:{n:{if(!n){if(u[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return a[t>>2]=1,void(a[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break e;for(;;){if(l=u[(s=((o=n+-1|0)<<1)+e|0)>>1]+1|0,i[s>>1]=l,58!=(65535&l))break e;if(!(n=o))break}}return i[e>>1]=49,a[t>>2]=a[t>>2]+1,void(a[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);a[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=a[964],t=-65536&(e=a[965])){if(2146435072==(2146435072&e))return a[966]=1,void ve();if((0|t)<1)break e}return void ve()}ve(),(0|r)==a[964]&&a[965]==(0|e)||re(1)}function ee(e){f[482]=te(f[482],e)}function te(e,t){var r;return p(+(e+=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(a[966]=1,e=f[396]),e}function re(e){f[482]=ne(f[482],e)}function ne(e,t){var r;return p(+(e-=t)),r=0|l(1),l(0),2146435072==(2146435072&r)&&(a[966]=1,e=f[396]),e}function ie(e){f[482]=ae(f[482],e)}function ae(e,t){var r,n=0,i=0,o=0;return p(+e*t),n=0|l(1),r=0|l(0),0|2146435072!=(0|(i=2146435072&n))?(o=(i=!(i|o))?a[792]:r,n=i?a[793]:n,c(0,0|o),c(1,0|n),+d()):(a[966]=1,n=a[793],c(0,a[792]),c(1,0|n),+d())}function oe(e){f[482]=se(f[482],e)}function se(e,t){var r=0,n=0,i=0,o=0;if(p(+t),r=0|l(1),l(0),2146435072&r){if(n=1,p(+e/t),r=0|l(1),i=0|l(0),!(!0&2146435072==(0|(o=2146435072&r))))return i=(n=!(0|o))?a[792]:i,r=n?a[793]:r,c(0,0|i),c(1,0|r),+d()}else n=4;return a[966]=n,r=a[793],c(0,a[792]),c(1,0|r),+d()}function ue(e){f[482]=e>>>0}function le(e){f[482]=0|e}function ce(){var e,t;e=+T(+f[482]),f[482]=e,p(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=8)}function de(){return pe(f[482])}function pe(e){var t,r=0,n=0,i=0,a=0;return p(+e),a=1106247680==(0|(i=2146435072&(r=0|l(1))))&a>>>0<0|i>>>0<1106247680,t=r&=2147483647,c(0,0|(n=0|l(0))),c(1,0|r),(e=+d())<0x10000000000000000&e>=0?(i=h(e)>=1?e>0?~~S(y(e/4294967296),4294967295)>>>0:~~F((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(i=0,r=0),n=a?r:n,!(r=a?i:t)&n>>>0<4294967295|r>>>0<0?n:-1}function me(){return fe(f[482])}function fe(e){var t=0,r=0;return p(+e),t=0|l(1),l(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=h(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function ge(){var e,t;e=+C(+f[482]),f[482]=e,p(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=8)}function he(){var e,t;e=+I(+f[482]),f[482]=e,p(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=8)}function ve(){f[482]=J(f[482])}function Se(){var e,t;e=+O(+f[482]),f[482]=e,p(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=1)}function ye(e,t,r){return function(e,t,r){var n=0,s=0,c=0,d=0;if(n=o[r+30|0]){for(s=r;d=10*d+ +(0|De[a[a[e>>2]+4>>2]](e,u[s>>1])),s=s+2|0,c=(0|n)>1,n=n+-1|0,c;);if(p(+d),n=0|l(1),e=0|l(0),a[t>>2]=e<<11,a[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=q(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(s=a[t>>2])?(e=s+1024|0,a[t>>2]=e,s>>>0<4294966272||(c=(s=a[t+4>>2])+1|0,a[t+4>>2]=c,n=(c>>>0<s>>>0)+n|0)):e=s,!((0|n)<=-1022))return(0|(s=1071644672+(n<<20)|0))<0?1:(n=a[t+4>>2],a[t>>2]=n<<21|e>>>11,a[t+4>>2]=-2147483648&i[r+32>>1]|s|n>>>11&1048575,0)}return a[t>>2]=0,a[t+4>>2]=0,0}(e,t,r)}function Fe(e,t,r,o){!function(e,t,r,o){var s,c,d=0,m=0,h=0,v=0,S=0,y=0,F=0,C=0,R=0,b=0;w=s=w-16|0,f[s+8>>3]=e,c=t,p(+e),m=0|l(1),h=0|l(0),v=d=m;e:if(m=2146435072&d){if(m=g(S=(m>>>20)-1022|0,39457)>>17,i[r+32>>1]=m+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+m|0)|0))<=-1){n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(a[s+8>>2]=h<<11,a[s+12>>2]=v<<11|h>>>21|-2147483648,(0|(d=q(s+8|0,S,-1^m)))>=1)for(h=r+32|0;m=u[h>>1],i[h>>1]=m+1&32767|32768&m,(0|(d=q(s+8|0,d,-1)))>0;);if(d?(m=(h=a[s+12>>2])>>>(v=0-d|0),a[s+12>>2]=m,d=h<<d+32|a[s+8>>2]>>>v,a[s+8>>2]=d):(d=a[s+8>>2],m=a[s+12>>2]),d=(h=m>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,a[s+8>>2]=d,d>>>0<h>>>0&&(m=m+1|0,a[s+12>>2]=m),(0|o)<1)h=r;else{for(y=d>>>16,F=u[s+14>>1],C=r+32|0,b=15==(0|o),h=r,v=1;;){S=o;t:{r:{for(;;){if(o=g(y,10)+(g(65535&d,10)>>>16)>>>16,R=g(F,10)+(o+g(65535&m,10)>>>16)>>>16|48,i[h>>1]=R,F=(m=o+g(m,10)|0)>>>16,y=(d=g(d,10))>>>16,1&(-1^v|48!=(0|R)))break r;if(o=u[C>>1],i[C>>1]=o+-1&32767|32768&o,!b)break}v=1;break t}h=h+2|0,v=0}if(o=S+-1|0,!((0|S)>1))break}a[s+12>>2]=m,a[s+8>>2]=d}d=(o=h-r|0)>>1;t:{if((0|o)<=29){if((0|m)<=-1){i[h>>1]=57,m=d+1|0;break t}i[h>>1]=48}for(;;){if(m=d,(0|d)<1)break t;if(d=m+-1|0,48!=u[(h=h+-2|0)>>1])break}}n[r+30|0]=m,i[t+2>>1]=m,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;i[c>>1]=t,w=s+16|0}(e,t,r,o)}function Ce(e,t,r,n){var i,o=0,s=0,u=0,l=0,c=0,d=0,p=0;c=a[t+4>>2],i=a[t>>2],l=u,u=a[e>>2],e=_e(i,l,o=a[e+4>>2],t=0),s=L,o=_e(l=c,c=0,o,t),t=L+d|0,t=(s=s+o|0)>>>0<o>>>0?t+1|0:t,o=s,d=t,t=_e(l,c,s=u,0),l=(u=o)+(o=L)|0,u=d,u=l>>>0<o>>>0?u+1|0:u,o=0,d=_e(i,p,s,c),e=(s=(p=L)+e|0)>>>0<p>>>0?o+1|0:o,c=t,s=t+s|0,t=e,e=l,l=t=s>>>0<c>>>0?t+1|0:t,(t=e+t|0)>>>0<l>>>0&&(u=u+1|0),a[r>>2]=t,a[r+4>>2]=u,a[n>>2]=d,a[n+4>>2]=s}function Re(e){return ne(f[482],e)}function be(e,t){f[482]=ne(e,t)}function Ee(e){return ae(f[482],e)}function Pe(e){return se(f[482],e)}function ke(e){f[482]=se(e,f[482])}function Te(e,t){f[482]=se(e,t)}function R(){M(1),R()}function Ae(e,t){var r,n;r=0|e,n=0|t,s[0]=r,s[1]=n}function Ne(e,t,r,n){var i=0,a=0,o=0,s=0,u=0,l=0,c=0,d=0,p=0,m=0;e:{t:{r:{n:{i:{a:{o:{s:{u:{l:{if(o=t){if(!(i=r))break l;if(!(a=n))break u;if((i=v(a)-v(o)|0)>>>0<=31)break s;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Ae(e-g(t=(e>>>0)/(r>>>0)|0,r)|0,0),L=0,t}if(i=n,!e)break o;if(!i)break a;if((a=i+-1|0)&i)break a;return Ae(e,o&a),e=o>>>(31&Me(i)),L=0,e}if(!((a=i+-1|0)&i))break i;l=0-(u=(v(i)+33|0)-v(o)|0)|0;break r}u=i+1|0,l=63-i|0;break r}return Ae(0,o-g(e=(o>>>0)/(i>>>0)|0,i)|0),L=0,e}if((i=v(i)-v(o)|0)>>>0<31)break n;break t}if(Ae(e&a,0),1==(0|i))break e;return n=e,e=31&(r=Me(i)),32<=(63&r)>>>0?(i=0,e=t>>>e):(i=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),L=i,e}u=i+1|0,l=63-i|0}if(a=t,p=e,o=31&(i=63&u),32<=(63&i)>>>0?(i=0,s=a>>>o):(i=a>>>o,s=((1<<o)-1&a)<<32-o|p>>>o),a=i,o=e,e=31&(i=63&l),32<=(63&i)>>>0?(i=o<<e,e=0):(i=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=i,u)for(i=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(i=i+1|0),l=i;i=a<<1|s>>>31,a=s<<1,p=i,i=(s=l-((o>>>0<(a|=t>>>31)>>>0)+i|0)|0)>>31,s=(d=a)-(a=r&(c=s>>31))|0,a=p-((n&i)+(d>>>0<a>>>0)|0)|0,i=t<<1|e>>>31,e=m|e<<1,t=0|i,d=0,m=c&=1,u=u+-1|0;);return Ae(s,a),L=(i=t<<1|e>>>31)|d,e=c|e<<1}Ae(e,t),e=0,t=0}return L=t,e}function _e(e,t,r,n){return e=function(e,t,r,n){var i,a,o,s,u=0,l=0;return s=g(u=r>>>16,l=e>>>16),u=(65535&(l=((o=g(i=65535&r,a=65535&e))>>>16)+g(l,i)|0))+g(u,a)|0,e=(((g(t,r)+s|0)+g(e,n)|0)+(l>>>16)|0)+(u>>>16)|0,L=e,t=65535&o|u<<16}(e,t,r,n)}function Ie(e,t,r,n){return e=function(e,t,r,n){var i=0,a=0;return r=Ne((e^=i=t>>31)-i|0,a=((a=t>>31)^t)-((e>>>0<i>>>0)+a|0)|0,(r^=e=n>>31)-e|0,((i=n>>31)^n)-((r>>>0<e>>>0)+i|0)|0),L=((e=(t^=n)>>31)^L)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,n=r-t|0}(e,t,r,n)}function Oe(e,t,r,n){return Ne(e,t,r,n),t=0|("function"==typeof setTempRet0&&setTempRet0(s[1]),s[0]),e=0|D(),L=e,t|=0}function Me(e){return e?31-v(e+-1^e)|0:32}var De=[null,function(e,t){return 0,0!=(0|b(0|(t|=0)))|0},function(e,t){return 0,0|E(0|(t|=0))},function(e){return 0,0|P()},function(e,t){return 0,(t|=0)+-48|0},x];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3280},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1232+(((g(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,s){return e=+e,t|=0,n|=0,s|=0,r=g(r|=0,20)+3792|0,i[r>>1]=0,t=function(e,t,r,n,s){var m=0,h=0,v=0,S=0,y=0,F=0,C=0,R=0,b=0;e:if(!u[e>>1]){if(f[482]=t,p(+t),m=0|l(1),v=0|l(0),F=m,b=-65536&m)if(2146435072!=(2146435072&m)){if(!((0|b)>=1))return-2147467259}else a[966]=1;y=a[812],C=a[813],S=-1;t:{if(!((0|m)<(0|(h=C))||(S=1,(0|m)>(0|h)))){if((0|y)==(0|(h=v)))break t;S=h>>>0<y>>>0?-1:1}if(h=-2147467259,1==(0|((F&C)>-1?S:0-S|0)))break e}t:{if(y=a[814],h=a[815],C=h,S=-1,!((0|m)<(0|h)||(S=1,(0|m)>(0|C)))){if((0|v)==(0|y))break t;S=v>>>0<y>>>0?-1:1}if(y=S,-1==(0|((h&F)>-1?y:0-y|0)))return-2147467259}t:{r:{if(!(s|!b))if(2146435072!=(2146435072&m)){if((0|b)<1)break r}else a[966]=1;ee(f[a[1216+(r<<2)>>2]>>3]),R=f[482];break t}Z(),re(t),F=a[965],v=F,c(0,0|(m=a[964])),c(1,0|v),R=+d(),a[792]==(0|m)&&a[793]==(0|v)||(h=a[965])>>>0<65536||(a[965]=-2147483648^h,p(+(R=f[482])),v=0|l(1),m=0|l(0)),F=v,y=v,v=a[1216+(r<<2)>>2],C=a[v+4>>2],h=a[v>>2],S=-1;r:{if(!((0|y)<(0|(v=C))||(S=1,(0|y)>(0|v)))){if((0|m)==(0|h)){f[482]=t;break r}S=m>>>0<h>>>0?-1:1}if(y=S,f[482]=t,-1==(0|((F&C)>-1?y:0-y|0)))break t}re(f[395])}if(i[e+18>>1]=r,m=me(),h=-2147467259,!Q(0)){if(n){if((0|m)>2957003)break e;m=m+1462|0}else if(m+4346018>>>0>7304483)break e;if(i[e+14>>1]=1+((m+6|0)%7|0),!s|m)if(m){if((0|m)<=-1?(v=-4-((n=(-1^m)/1461|0)<<2)|0,h=1461+(g(n,1461)+m|0)|0):(v=(n=(m+-1|0)/1461|0)<<2,h=g(n,-1461)+m|0),!(s&&(0|v)<=199))if((0|(h=(((0|(n=v+-101|0))/100|0)-((0|n)/400|0)|0)+h|0))>=1462){m=3&(n=v+1900|0);t:if(s){if(m|(0|v)<200)break t;m=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else m||(m=!((0|n)%100)&0!=((0|n)%400|0));v=v+4|0,h=(12==(0|g(m,12))?-1460:-1461)+h|0}else(0|h)>0||(v=v+-4|0,h=h+1461|0);m=3&(n=v+1900|0);t:if(s){if(m|(0|v)<200)break t;m=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else m||(m=!((0|n)%100)&0!=((0|n)%400|0));for(F=g(m,12),m=F;s=m,m=m+1|0,(0|(h=(n=h)-o[s+1232|0]|0))>0;);s=((h=s)-((0|F)<(0|(s=s+-11|0))?F:s)>>>0)/12|0,i[e>>1]=1900+(s+v|0),i[e+2>>1]=(g(s,-12)+m|0)-F}else a[e>>2]=788331,n=30;else a[e>>2]=67436;if(a[e+4>>2]=n,f[482]=R,ve(),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(R),ie(f[400]),t=f[482],n=de(),i[e+8>>1]=n,ue(n<<16>>16),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(t),ie(f[401]),t=f[482],n=de(),i[e+10>>1]=n,ue(n<<16>>16),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(t),ie(f[401]),!r)return r=de(),i[e+16>>1]=0,i[e+12>>1]=r,0;t=f[482],n=de(),i[e+12>>1]=n,ue(n<<16>>16),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(t),ie(f[a[1312+(r<<2)>>2]>>3]),f[482]=z(f[482]),i[e+16>>1]=de(),h=0}}return h}(r,e,t,0!=(0|n),0!=(0|s)),a[966]=0,0|t},Dtr_Yr:function(e){return i[g(e|=0,20)+3792>>1]},Dtr_Mon:function(e){return i[g(e|=0,20)+3794>>1]},Dtr_DOM:function(e){return a[g(e|=0,20)+3796>>2]},Dtr_Hour:function(e){return i[g(e|=0,20)+3800>>1]},Dtr_Min:function(e){return i[g(e|=0,20)+3802>>1]},Dtr_Sec:function(e){return i[g(e|=0,20)+3804>>1]},Dtr_Wdy:function(e){return i[g(e|=0,20)+3806>>1]},Dtr_FracSec:function(e){return i[g(e|=0,20)+3808>>1]},Dtr_Rounding:function(e){return i[g(e|=0,20)+3810>>1]},Dtr_Write:function(e,t,r,n,o,s,u,l,c,d){e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,u|=0,l|=0,c|=0,d=g(d|=0,20),i[d+3810>>1]=c,i[d+3808>>1]=l,i[d+3806>>1]=u,i[d+3804>>1]=s,i[d+3802>>1]=o,i[d+3800>>1]=n,a[d+3796>>2]=r,i[d+3794>>1]=t,i[d+3792>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,a[964]=0,a[965]=0,function(e,t,r){var n,o=0;w=n=w-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){if(i[e+18>>1]>=1?(le(i[e+16>>1]),o=Pe(f[a[1312+(i[e+18>>1]<<2)>>2]>>3]),le(i[e+12>>1]),ee(o)):le(i[e+12>>1]),o=Pe(f[401]),le(i[e+10>>1]),ee(o),o=Pe(f[401]),le(i[e+8>>1]),ee(o),o=Pe(f[400]),!((0|W(e,t,r,n+12|0))<0)){if(e=a[n+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(e=a[965],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){a[966]=1;break t}if((0|t)>=1)break t}}a[964]=0,a[965]=0}a[964]=0,a[965]=0,Q(8);break e}ue(e)}ee(o)}w=n+16|0}(g(e,20)+3792|0,0!=(0|t),0!=(0|r)),+f[482]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,a[964]=0,a[965]=0,function(e,t,r,n,o){var s,l=0;w=s=w-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){n:if(i[e+18>>1]>=1){if(le(i[e+16>>1]),oe(f[a[1312+(i[e+18>>1]<<2)>>2]>>3]),l=f[482],2==(0|o)){f[482]=n,ee(l);break n}le(i[e+12>>1]),ee(l)}else 2!=(0|o)?le(i[e+12>>1]):f[482]=n;if(oe(f[401]),l=f[482],1!=(0|o)?le(i[e+10>>1]):f[482]=n,ee(l),oe(f[401]),l=f[482],o?le(i[e+8>>1]):f[482]=n,ee(l),oe(f[400]),n=f[482],!((0|W(e,t,r,s+12|0))<0)){if(e=a[s+12>>2],!t)break r;if(le(e+-1462|0),!((0|e)<1462)){if(e=a[965],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){a[966]=1;break t}if((0|t)>=1)break t}}a[964]=0,a[965]=0}a[964]=0,a[965]=0,Q(8);break e}ue(e)}ee(n)}w=s+16|0}(g(e,20)+3792|0,0!=(0|t),0!=(0|r),+(0|o),n),+f[482]},Dtr_Days:function(){return a[963]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|W(g(e|=0,20)+3792|0,0!=(0|t),0!=(0|r),3852)},Dtr_ToTime:function(e,t,r){return function(e,t,r){f[482]=e,ee(f[a[1216+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ie(f[401]);ie(f[401])}ie(f[400]),ve()}(e=+e,t|=0,r|=0),+f[482]},Dtr_UtcToLocal:function(e,t,r,n,o,s,l,c){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,l|=0,c|=0,w=d=w-32|0,a[d+24>>2]=s,a[d+16>>2]=n,a[d+8>>2]=t,a[d+20>>2]=(0|o)>-1?g(o,20)+3792|0:0,a[d+12>>2]=(0|r)>-1?g(r,20)+3792|0:0,e=function(e,t,r,n){var o,s=0;w=o=w-32|0,function(e,t,r){var n,o=0,s=0,l=0,c=0,d=0,p=0,m=0,f=0,h=0,v=0,S=0,y=0;if(w=n=w-96|0,a[n+64>>2]=i[t>>1],a[n+68>>2]=i[t+2>>1],a[n+72>>2]=a[t+4>>2],a[n+76>>2]=i[t+8>>1],a[n+80>>2]=i[t+10>>1],a[n+84>>2]=i[t+12>>1],a[n+92>>2]=i[t+14>>1]+-1,(o=i[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=g(i[t+16>>1],100);break e;case 1:o=g(i[t+16>>1],10);break e;case 2:break t;default:break e}o=i[t+16>>1]}a[n+88>>2]=o}t=0;e:if(V(n- -64|0,n+40|0)){if(l=_e(l=g(a[e>>2],60),l>>31,1e7,0),d=L,(s=a[e+4>>2])&&(c=a[e+12>>2])){if(a[n+64>>2]=i[s>>1],a[n+68>>2]=i[s+2>>1],a[n+72>>2]=a[s+4>>2],a[n+76>>2]=i[s+8>>1],a[n+80>>2]=i[s+10>>1],a[n+84>>2]=i[s+12>>1],a[n+92>>2]=i[s+14>>1]+-1,(o=i[s+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=g(i[s+16>>1],100);break t;case 1:o=g(i[s+16>>1],10);break t;case 2:break r;default:break t}o=i[s+16>>1]}a[n+88>>2]=o}if(a[n+8>>2]=i[c>>1],a[n+12>>2]=i[c+2>>1],a[n+16>>2]=a[c+4>>2],a[n+20>>2]=i[c+8>>1],a[n+24>>2]=i[c+10>>1],a[n+28>>2]=i[c+12>>1],a[n+36>>2]=i[c+14>>1]+-1,(o=i[c+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=g(i[c+16>>1],100);break t;case 1:o=g(i[c+16>>1],10);break t;case 2:break r;default:break t}o=i[c+16>>1]}a[n+32>>2]=o}if(s=a[n+44>>2],c=s,o=a[n+40>>2],!j(n- -64|0,n+56|0,o,s))break e;if(!j(n+8|0,n+48|0,o,c))break e;h=a[n+40>>2],m=a[n+44>>2],v=l,S=e+16|0,y=e+8|0,f=(c=d)+a[n+52>>2]|0,(p=(o=l)+a[n+48>>2]|0)>>>0<o>>>0&&(f=f+1|0),s=p,o=g(a[e+8>>2],60),p=_e(o,o>>31,1e7,0),o=L+f|0,f=s=s+p|0,p=o=s>>>0<p>>>0?o+1|0:o,s=d+a[n+60>>2]|0,(d=l+a[n+56>>2]|0)>>>0<l>>>0&&(s=s+1|0),e=g(a[e+16>>2],60),l=_e(e,e>>31,1e7,0),e=L+s|0,e=(d=l+d|0)>>>0<l>>>0?e+1|0:e,l=d,e=_e(e=g(a[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(f>>>0>=l>>>0)?((0|m)<(0|e)?1:(0|m)<=(0|e)?h>>>0>=l>>>0?0:1:0)&((0|m)>(0|p)?1:(0|m)>=(0|p)?h>>>0<f>>>0?0:1:0):((0|m)<(0|e)?1:(0|m)<=(0|e)?h>>>0>=l>>>0?0:1:0)|((0|m)>(0|p)?1:(0|m)>=(0|p)?h>>>0<f>>>0?0:1:0))?S:y)>>2],60),e>>31,1e7,0),o=L+c|0,d=o=(l=v+e|0)>>>0<e>>>0?o+1|0:o}e=a[n+40>>2],o=a[n+44>>2]-(d+(e>>>0<l>>>0)|0)|0,l=e-l|0,(0|(e=o))<0||(0|e)<=0&&!(l>>>0>=0)||(G(l,e,n- -64|0),i[r>>1]=a[n+64>>2],i[r+2>>1]=a[n+68>>2],a[r+4>>2]=a[n+72>>2],t=1,i[r+14>>1]=u[n+92>>1]+1,i[r+8>>1]=a[n+76>>2],i[r+10>>1]=a[n+80>>2],i[r+12>>1]=a[n+84>>2],e=a[n+88>>2],i[r+18>>1]=3,i[r+16>>1]=e)}return w=n+96|0,t}(n,e,o+8|0)&&(n=a[o+12>>2],a[e>>2]=a[o+8>>2],a[e+4>>2]=n,a[e+16>>2]=a[o+24>>2],n=a[o+20>>2],a[e+8>>2]=a[o+16>>2],a[e+12>>2]=n,n=e,(0|W(e,t,r,o+28|0))>=0?e=1+((a[o+28>>2]+6|0)%7|0)|0:(a[o+28>>2]=-1,e=6),i[n+14>>1]=e,s=1);return w=o+32|0,s}(g(e,20)+3792|0,0!=(0|l),0!=(0|c),d+8|0),w=d+32|0,0|e},Mathpack_Zero:function(){return+f[396]},Mathpack_One:function(){return+f[395]},Mathpack_Pi:function(){return+f[391]},Mathpack_Div:function(e,t){return+se(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ae(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+ne(e=+e,t=+t)},Mathpack_Add:function(e,t){return+te(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,s=0;f[482]=t,p(+t),r=0|l(1),l(0),o=r,a[965]=2147483647&r,t=f[482];e:{if(p(+Re(f[392])),r=0|l(1),n=0|l(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)f[482]=e,ge();else if(ve(),p(+Re(t)),r=0|l(1),n=0|l(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=de()))){if(f[482]=e,p(+e),n=0|l(1),l(0),(0|(n=(r=n)>>>16<<16))>=1)ce(),ie(t),Se();else if(!((0|n)>-1)){if(Te(f[395],t),s=z(f[482]),f[482]=s,ve(),p(+Re(s)),65535==(0|(n=0|l(1)))&l(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=me()))|!(1&n))break e;f[482]=e,a[965]=2147483647&r,ce(),ie(t),Se(),(r=a[965])>>>0<65536||(a[965]=-2147483648^r)}}else f[482]=e,function(e){var t,r=0;if(!((t=i[1931])|e))return void(a[966]=4&a[966]?4:64);if(!((0|t)<1)&&10==(0|de())){if(r=f[482],ve(),re(r),!u[1931])return void $(e);f[482]=r}r=1;for(;1&e&&(r=Ee(r)),e>>>=1;)ie(f[482]);f[482]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=a[966]))return a[964]=0,a[965]=0,a[966]=-2&o,f[482];ke(f[395])}return f[482]}return a[966]=8,f[482]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return p(+(e=+e)),t=0|l(1),l(0),(r=-65536&t)?2146435072==(2146435072&t)?(a[966]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,i,a,o=0,s=0,u=0;p(+(e=+e)),o=0|l(1),r=0|l(0),n=o,a=o,p(+t),i=0|l(1),o=0|l(0),u=-1;e:{if(!((0|n)<(0|(s=i))||(u=1,(0|a)>(0|s)))){if(s=0,(0|o)==(0|r))break e;u=r>>>0<o>>>0?-1:1}o=u,s=(i&n)>-1?o:0-o|0}return 0|s},Mathpack_TakeMathError:function(){var e;return e=a[966],a[966]=0,0|e},Mathpack_Trunc:function(e){return+J(e=+e)},Mathpack_Ceil:function(e){return e=+e,f[482]=e,function(){var e=0,t=0,r=0;e:{if(r=a[964],e=a[965],t=-65536&e){if(2146435072==(2146435072&e))return a[966]=1,void ve();if((0|t)>0)break e}return void ve()}ve(),(0|r)==a[964]&&a[965]==(0|e)||ee(1)}(),+f[482]},Mathpack_Floor:function(e){return e=+e,f[482]=e,Z(),+f[482]},Mathpack_Abs:function(e){var t=0;return p(+(e=+e)),t=0|l(1),t&=2147483647,c(0,0|(0|l(0))),c(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,i;return p(+(e=+e)),n=-2147483648^(t=0|l(1)),c(0,0|(r=0|l(0))),c(1,0|n),i=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?i:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|pe(e=+e)},Mathpack_LFix:function(e){return 0|fe(e=+e)},Mathpack_SFix:function(e){return e=+e,f[482]=e,0|Y()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,s=0,c=0,d=0;w=r=w+-64|0,a[r+56>>2]=0,i[r+46>>1]=0,i[r+48>>1]=0,f[482]=e,p(+e),o=0|l(1),l(0);e:if(s=-65536&o)if(2146435072!=(2146435072&o)){(0|s)>0||(d=32768,o>>>0<65536||(a[965]=-2147483648^o,e=f[482])),Fe(e,r+56|0,r+16|0,15),u[r+58>>1]||(i[r+56>>1]=1),f[482]=t,o=(0|(o=Y()))<0?100:o;t:{if(s=a[965],c=-65536&s)if(2146435072!=(2146435072&s)){if(!((0|c)>0)){if((o=a[965])>>>0>=65536&&(a[965]=-2147483648^o),(0|(o=Y()))<=-1)break t;o=0-o|0}}else a[966]=1;s=i[r+56>>1],c=o+s|0,o=i[r+58>>1],(0|c)<(0|o)&&(a[r+12>>2]=o,a[r+8>>2]=s,X(r+16|0,r+8|0,r+12|0,c),o=a[r+12>>2],i[r+58>>1]=o,s=a[r+8>>2],i[r+56>>1]=s),n[r+46|0]=o,i[r+48>>1]=s+16384&32767|d,ye(3276,3856,r+16|0),e=f[482];break e}e=f[396]}else a[966]=1;return w=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,i=0,o=0,s=0;p(+e),r=0|l(1),l(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?s=(0|n)<1?-1:1:a[966]=1);if(i=U(e,t),f[482]=e,f[482]=z(e),re(i),(r=a[965])>>>0>=65536){if(2146435072==(2146435072&r))return a[966]=1,i;if(r=(0|(r=pe(t)<<16))<0?309:r>>16,p(+t),n=0|l(1),l(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:a[966]=1),(0|r)<=-309)return Q(8),0;$(0-r|0),(0|s)>-1||(r=a[965])>>>0<65536||(a[965]=-2147483648^r),ee(i),i=f[482]}return i}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return p(+(e=U(e=+e,t=+t))),r=0|l(1),l(0),2146435072==(2146435072&r)&&(a[966]=1,e=-1),+e},Mathpack_TenTo:function(e){return $(e|=0),+f[482]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,i=0,o=0,s=0,u=0;w=r=w-16|0,f[r+8>>3]=e,f[r>>3]=t,p(+e),n=0|l(1),i=0|l(0),o=n,p(+t),n=0|l(1),s=0|l(0),u=n;e:{if((0|i)!=(0|s)||(0|o)!=(0|n)){if((u+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=z(e),f[r+8>>3]=e,p(+e),n=0|l(1),l(0),o=n,e=z(t),f[r>>3]=e,p(+e),n=0|l(1),l(0),u=n),n=1,o=a[(s=(i=(u&o)>-1)?r+8|0:r)+4>>2],u=a[(i=i?r:r+8|0)+4>>2],(0|o)>(0|u))break e;if((0|o)<(0|u)){n=-1;break e}if(s=a[s>>2],i=a[i>>2],s>>>0>i>>>0)break e;if(n=-1,s>>>0<i>>>0)break e}n=0}return w=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return p(+(e=+e)),t=0|l(1),l(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,i=0;return p(+(e=+e)),i=0|l(1),r=0|l(0),p(+t),n=0|l(1),0|(i=(0|r)==(0|l(0))?(0|i)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return p(+(e=+e)),t=0|l(1),l(0),2146435072==(2146435072&t)?(a[966]=1,-1):+z(e)},Mathpack_Sqrt:function(e){return e=+e,f[482]=e,ge(),+f[482]},Mathpack_Exp:function(e){return e=+e,f[482]=e,Se(),+f[482]},Mathpack_Ln:function(e){return e=+e,f[482]=e,ce(),+f[482]},Mathpack_Log:function(e){return e=+e,f[482]=e,function(){var e,t;e=+k(+f[482]),f[482]=e,p(+e),t=0|l(1),l(0),2146435072==(2146435072&t)&&(a[966]=8)}(),+f[482]},Mathpack_Sin:function(e){return e=+e,f[482]=e,function(){var e=0,t=0;p(+(t=f[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+A(+t),f[482]=t,p(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(a[966]=8)}(),+f[482]},Mathpack_Cos:function(e){return e=+e,f[482]=e,function(){var e=0,t=0;p(+(t=f[482])),e=0|l(1),l(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+N(+t),f[482]=t,p(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(a[966]=8)}(),+f[482]},Mathpack_Tan:function(e){return e=+e,f[482]=e,function(){var e=0,t=0,r=0;r=8,p(+(t=f[482])),e=0|l(1),l(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+_(+t),f[482]=t,r=4,p(+t),e=0|l(1),l(0),2146435072!=(2146435072&e))||(a[966]=r)}(),+f[482]},Mathpack_Asin:function(e){return+B(e=+e,0)},Mathpack_Acos:function(e){return+B(e=+e,1)},Mathpack_Atan:function(e){return e=+e,f[482]=e,he(),+f[482]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,i=0,o=0,s=0,u=0;f[482]=e;e:{if(p(+e),r=0|l(1),l(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;a[966]=1}f[482]=t;t:{if(p(+t),r=0|l(1),l(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;a[966]=1}return Q(4),0}return le((0|n)<1?-1:1),ie(f[391]),oe(f[393]),f[482]}e:if((0|r)<=-1){p(+t),r=0|l(1),l(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else a[966]=1;i=f[391];break e}p(+(i=f[391])),r=0|l(1),n=0|l(0),o=-2147483648^r,c(0,0|n),c(1,0|o),s=+d(),u=i,i=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?s:u}else i=f[396];return Te(t,e),he(),ee(i),f[482]}(e=+e,t=+t)},Mathpack_Mod:function(e,t){return+function(e,t){var r,n=0,i=0,o=0,s=0,m=0,h=0,v=0,S=0,y=0,F=0,C=0,R=0,b=0,E=0,P=0,k=0,T=0,A=0,N=0,_=0,I=0,O=0,M=0,D=0,x=0,K=0,U=0,B=0;w=r=w+-64|0,f[482]=e,p(+e),n=0|l(1),l(0);(E=-65536&n)&&(2146435072!=(2146435072&n)?U=(0|E)<1?-1:1:a[966]=1);a[965]=2147483647&n,p(+t),n=0|l(1),E=0|l(0),o=n;e:{t:{if(_=-65536&n){if(2146435072!=(2146435072&n))break t;a[966]=1}Q(4),e=0;break e}m=n=2147483647&o,c(0,0|E),c(1,0|n),e=+d(),p(+(t=f[482])),n=0|l(1),i=0|l(0),C=n;t:{r:{h=n,M=m;n:if(!((0|n)<(0|m))){i:{if((0|h)<=(0|M)){if((0|(n=i))==(0|(h=E)))break i;if(n>>>0<h>>>0)break n}if(be(I=J(Pe(e)),f[390]),n=a[965],(h=-65536&n)&&(2146435072!=(2146435072&n)?s=(0|h)<1:a[966]=1),a[966]){Q(0);break r}if(!s)break r;if(n=2147483647&o,c(0,-134217728&E),c(1,0|n),D=+d(),be(e,D),(n=a[965])|a[964]&&!(2146435072&n))break r;B=Ee(I),f[482]=ae(I,D),(n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(t),re(B);break n}a[964]=0,a[965]=0}if(n=a[964],o=a[792],s=a[965],S=s,h=a[793],i=-1,!((0|s)<(0|(m=h))||(i=1,(0|S)>(0|m)))){if((0|n)==(0|o))break t;i=n>>>0<o>>>0?-1:1}if(-1!=(0|((s&h)>-1?i:0-i|0)))break t;ee(e);break t}Te(t,e),a[965]=2147483647&a[965];r:{if(n=a[964],h=a[816],F=a[965],k=F,S=a[817],y=S,s=-1,!((0|F)<(0|S)||(s=1,(0|k)>(0|y)))){if((0|n)==(0|h))break r;s=n>>>0<h>>>0?-1:1}if(-1==(0|((S&F)>-1?s:0-s|0))){if(h=0,s=0,F=n=E,_e(0-n&n,0-((0<n>>>0)+(o=S=1048575&o|1048576)|0)&o,-1261761911,66559345),k=u[1088+(L>>>26<<1)>>1],S=31&(n=k),32<=(63&n)>>>0?(n=0,S=o>>>S):(n=o>>>S,S=((1<<S)-1&o)<<32-S|F>>>S),F=n,o=i,n=1048575&C|1048576,(0|(T=k-(R=(C>>>20&2047)-(x=m>>>20)|0)|0))>=1&&(y=31&(i=64-T|0),C=o,32<=(63&i)>>>0?(i=0,y=-1>>>y):(i=-1>>>y,y=(1<<y)-1<<32-y|-1>>>y),o=(P=o)-(y=A=y&o)|0,n=(m=n)-((O=n&i)+(C>>>0<y>>>0)|0)|0),m=(m=a[1056+((i=S)<<1&28)>>2])-g(m,g(i,m)+-1&240)&255,C=r,P=r,i=m|0-g(m,g(i,m)+-1&65280)&65280,m=i,y=_e(S,F,i,0),v=L+-1|0,(y=y+-1|0)>>>0<4294967295&&(v=v+1|0),m=_e(-65536&y,v,i=0-i|0,i>>31)|m,v=_e(m,y=L,S,F),i=L+-1|0,i=_e(0,v+-1>>>0<4294967295?i+1|0:i,m,y),N=i-m|0,a[P+56>>2]=N,y=L-((i>>>0<m>>>0)+y|0)|0,a[C+60>>2]=y,a[r+48>>2]=S,a[r+52>>2]=F,Ce(r+56|0,r+48|0,r+8|0,r+40|0),v=a[r+12>>2],(m=a[r+8>>2]+1|0)>>>0<1&&(v=v+1|0),a[r+8>>2]=m,a[r+12>>2]=v,m=Oe(0-(i=S)|0,0-((0<i>>>0)+F|0)|0,i,F),C=L,v=31&(i=(0|(R=(R-k|0)- -64|0))%64|0),32<=(63&i)>>>0?(i=1<<v,P=0):(i=(1<<v)-1&1>>>32-v,P=1<<v),v=i,a[r+32>>2]=o,a[r+36>>2]=n,n|o)for(;a[r+56>>2]=o,a[r+60>>2]=n,a[r+48>>2]=m,a[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),o=a[r+32>>2],n=a[r+36>>2],b=a[r+44>>2],i=s+b|0,K=a[r+40>>2],(s=h+K|0)>>>0<h>>>0&&(i=i+1|0),h=s,s=i,(0|b)==(0|i)&h>>>0<K>>>0|i>>>0<b>>>0&&((o=o+1|0)>>>0<1&&(n=n+1|0),a[r+32>>2]=o,a[r+36>>2]=n),o|n;);if(a[r+56>>2]=Oe(h,s,S,F),a[r+60>>2]=L,a[r+48>>2]=P,a[r+52>>2]=v,Ce(r+56|0,r+48|0,r+16|0,r+40|0),o=a[r+44>>2],i=a[r+40>>2],a[r+56>>2]=i,a[r+60>>2]=o,a[r+48>>2]=N,a[r+52>>2]=y,Ce(r+56|0,r+48|0,r+24|0,r+40|0),n=a[r+44>>2],a[r+56>>2]=a[r+40>>2],a[r+60>>2]=n,a[r+48>>2]=S,a[r+52>>2]=F,h=0,s=0,Ce(r+56|0,r+48|0,r+32|0,r+40|0),b=a[r+36>>2],v=a[r+20>>2],(i=(o=0!=(0|i)|0!=(0|o))+a[r+16>>2]|0)>>>0<o>>>0&&(v=v+1|0),P=i,o=i+a[r+32>>2]|0,i=v+b|0,a[r>>2]=o,a[r+4>>2]=o>>>0<P>>>0?i+1|0:i,a[r+32>>2]=m,a[r+36>>2]=C,m|C)for(o=m,n=C;a[r+56>>2]=o,a[r+60>>2]=n,a[r+48>>2]=m,a[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),o=a[r+32>>2],n=a[r+36>>2],v=a[r+44>>2],i=s+v|0,b=a[r+40>>2],(s=h+b|0)>>>0<h>>>0&&(i=i+1|0),h=s,s=i,(0|v)==(0|i)&h>>>0<b>>>0|i>>>0<v>>>0&&((o=o+1|0)>>>0<1&&(n=n+1|0),a[r+32>>2]=o,a[r+36>>2]=n),o|n;);if((0|R)>=64)for(o=Oe(h,s,S,F),n=L,s=R>>>6;1&s&&(i=a[r+4>>2],a[r+56>>2]=a[r>>2],a[r+60>>2]=i,a[r+48>>2]=o,a[r+52>>2]=n,Ce(r+56|0,r+48|0,r+16|0,r+40|0),i=a[r+44>>2],v=i,R=a[r+40>>2],a[r+56>>2]=R,a[r+60>>2]=i,a[r+48>>2]=N,a[r+52>>2]=y,Ce(r+56|0,r+48|0,r+24|0,r+40|0),i=a[r+44>>2],a[r+56>>2]=a[r+40>>2],a[r+60>>2]=i,a[r+48>>2]=S,a[r+52>>2]=F,Ce(r+56|0,r+48|0,r+32|0,r+40|0),b=a[r+36>>2],i=a[r+20>>2],(R=(v=0!=(0|R)|0!=(0|v))+a[r+16>>2]|0)>>>0<v>>>0&&(i=i+1|0),v=R+a[r+32>>2]|0,i=i+b|0,a[r>>2]=v,a[r+4>>2]=v>>>0<R>>>0?i+1|0:i),a[r+56>>2]=o,a[r+60>>2]=n,a[r+48>>2]=o,a[r+52>>2]=n,Ce(r+56|0,r+48|0,r+16|0,r+40|0),o=a[r+44>>2],i=a[r+40>>2],a[r+56>>2]=i,a[r+60>>2]=o,a[r+48>>2]=N,a[r+52>>2]=y,Ce(r+56|0,r+48|0,r+24|0,r+40|0),n=a[r+44>>2],a[r+56>>2]=a[r+40>>2],a[r+60>>2]=n,a[r+48>>2]=S,a[r+52>>2]=F,Ce(r+56|0,r+48|0,r+32|0,r+40|0),h=a[r+36>>2],n=a[r+20>>2],(i=(o=0!=(0|i)|0!=(0|o))+a[r+16>>2]|0)>>>0<o>>>0&&(n=n+1|0),o=i+a[r+32>>2]|0,n=n+h|0,n=o>>>0<i>>>0?n+1|0:n,s>>>=1;);if(n=a[r+8>>2],o=a[r+12>>2],i=a[r+4>>2],a[r+56>>2]=a[r>>2],a[r+60>>2]=i,a[r+48>>2]=n,a[r+52>>2]=o,Ce(r+56|0,r+48|0,r,r+40|0),h=a[r+40>>2],s=a[r+44>>2],n=a[r+4>>2],o=a[r>>2],a[r+32>>2]=o,a[r+36>>2]=n,n|o)for(;a[r+56>>2]=o,a[r+60>>2]=n,a[r+48>>2]=m,a[r+52>>2]=C,Ce(r+56|0,r+48|0,r+32|0,r+40|0),o=a[r+32>>2],n=a[r+36>>2],y=a[r+44>>2],i=s+y|0,v=a[r+40>>2],(s=h+v|0)>>>0<h>>>0&&(i=i+1|0),h=s,s=i,(0|y)==(0|i)&h>>>0<v>>>0|i>>>0<y>>>0&&(i=n,(n=o+1|0)>>>0<1&&(i=i+1|0),o=n,a[r+32>>2]=n,n=i,a[r+36>>2]=n),o|n;);if(o=Oe(h,s,S,F),n=i=L,a[r>>2]=o,a[r+4>>2]=n,s=(k+x|0)-52|0,A|O&&(m=o,S=31&(o=T),32<=(63&o)>>>0?(i=m<<S,n=0):(i=(1<<S)-1&m>>>32-S|n<<S,n=m<<S),i=i+O|0,o=n=n+A|0,a[r>>2]=n,n=n>>>0<A>>>0?i+1|0:i,a[r+4>>2]=n,s=s-T|0),!(n|o)){a[964]=0,a[965]=0;break t}if((0|n)>=1?(ue(n),n=a[964],h=a[965],ue(o),i=h+33554432|0,i=2146435072&(n>>>0<0?i+1|0:i)|-2146435073&h,c(0,n|(o=0)),c(1,0|i),ee(+d())):ue(o),n=a[965],o=n,i=a[964],(0|(n=(n>>>20&2047)+s|0))<=1023){a[964]=0,a[965]=0,a[966]=2;break t}a[964]=i,a[965]=-2146435073&o|(n+1025&2047)<<20;break t}}Q(2),e=0;break e}(((0|_)<1?-2147483648:1)^U)>-1||((n=a[965])>>>0>=65536&&(a[965]=-2147483648^n),ee(e),a[965]!=(0|M)|(0|E)!=a[964]||(a[964]=0,a[965]=0)),(0|_)>=1?s=a[965]:(s=a[965])>>>0<65536||(s^=-2147483648,a[965]=s),!(a[964]|s)|2146435072&s||(a[966]=2),e=f[482]}return w=r- -64|0,e}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,s=0,c=0;return p(+(e=+e)),r=0|l(1),o=0|l(0),2146435072==(2146435072&r)?(a[966]=1,-1):(f[482]=e,s=3280,(n=-65536&(c=r))&&(2146435072!=(2146435072&c)?(s=3280,(0|n)>0||(c>>>0>=65536&&(a[965]=-2147483648^c),s=3280,!o&-2147483648==(0|r)||(i[1640]=45,s=3282))):(a[966]=1,s=3280)),c=s,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;w=o=w-16|0,e=0|De[a[a[e>>2]+8>>2]](e),a[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;i[t>>1]=0}else Fe(f[482],o+8|0,t,15),t=function(e,t,r,n,o,s){var l,c,d,p=0,m=0,f=0,h=0,v=0;w=c=w-16|0,l=(t<<1)+e|0,d=c+12|0;t:{r:{n:{i:if(!(f=(0|r)<5&(m=o?n:1)+3>>>0<8)){a:if(!((0|m)>(0|r))){if((0|(n=r+m|0))>=3){if((0|r)<5|(0|m)>-4)break i;if((n+-2|0)<(0|o))break a;break i}if((0|r)<5)break i}if(h=1,n=1,(0|r)<7)break n;n=r-(m+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,m))&&(n=r-((0|m)<(0|r)?(0|m)<1?2-m|0:1:0)|0)}n:{if((0|n)<(0|o)){p=1,o=0;i:if(!((0|t)<1)){a:{o:{if(!n){if(u[e>>1]>52)break o;break i}if((0|n)<1|(0|n)>=(0|t))break i;if(u[(n<<1)+e>>1]<=52)break a;for(;;){if(v=u[(p=((o=n+-1|0)<<1)+e|0)>>1]+1|0,i[p>>1]=v,58!=(65535&v))break a;if(n=o,!o)break}}i[e>>1]=49,o=1,p=m+1|0;break i}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);p=m}if((-1^f)&(0|p)>(0|r)|h)break n;break r}if(p=m,!h)break r}if(a[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=l>>>0?n=r:(o=o+-1|0,a[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&R(),K(e,r,o<<1),i[r>>1]=s),n>>>0<l>>>0&&(i[n>>1]=69,n=n+2|0),n>>>0>=l>>>0?o=n:(o=n+2|0,(0|p)<=0?(i[n>>1]=45,p=1-p|0):(i[n>>1]=43,p=p+-1|0)),(0|p)<100|o>>>0>=l>>>0||(e=(p>>>0)/100|0,i[o>>1]=e+48,p=p-g(e,100)|0,o=o+2|0),o>>>0<l>>>0&&(i[o>>1]=48+((0|p)/10|0),o=o+2|0),o>>>0>=l>>>0)break t;i[o>>1]=48+((0|p)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|p))if(r=o-p|0,a[d>>2]=r,(0|p)>=1){if(!((r=(n=((f=(r=(m=(0|p)>(0|t)?t:p)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=l>>>0))for(;i[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=f>>>0;);(0|p)<(0|t)&&(i[f>>1]=s),o=f+(((0|(e=l-f>>1))>(0|(t=o-m|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(p<<1)|0)+(o<<1)|0)|0)>>>0>=l>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;i[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(i[e>>1]=48,e=e+2|0),e>>>0<l>>>0&&(i[e>>1]=s,e=e+2|0),n=l-e>>1,p&&(t=(0|n)<(0|(t=0-p|0))?n:t))for(o=0;i[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|p)>(0|t)?t:p)-o|0)for(t=(o<<1)+e|0,o=0;i[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return w=c+16|0,o}(t,r,n,i[o+8>>1],i[o+10>>1],e);return w=o+16|0,t}(a[256],c,3790-c>>1,(0|t)>0?t:0),a[964]=0,a[965]=0,t-3280>>1)},Mathpack_FormatGetExponent:function(){return a[968]},Mathpack_FormatGetSign:function(){return a[969]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,s=0;return w=n=w+-64|0,p(+(e=+e)),o=0|l(1),l(0),2146435072!=(2146435072&o)?(a[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,Fe(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),s=i[n+56>>1],o=i[n+58>>1],a[n+8>>2]=o,t=t+s|0,a[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&(X(n+16|0,n+12|0,n+8|0,t),o=a[n+8>>2]),o?((0|(r=r+(t=a[n+12>>2])|0))<(0|o)&&(a[n+8>>2]=r,o=r),(0|o)>-1||(a[966]=1)):(o=0,a[n+12>>2]=0,t=0),a[968]=t,a[969]=u[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(R(),r=a[n+8>>2]),K(3280,n+16|0,o<<1)):(a[966]=1,r=-1),w=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,s=0,c=0;if(w=n=w+-64|0,p(+(e=+e)),s=0|l(1),l(0),2146435072!=(2146435072&s)){if(a[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,Fe(e,n+56|0,n+16|0,15),c=i[n+56>>1],a[n+12>>2]=c,s=i[n+58>>1],a[n+8>>2]=s,(0|(o=t))>=2&&(o=(0|c)%(0|t)|0,o=((0|c)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|s))){for(X(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(s=a[n+8>>2]))?o:s;s=o,(0|o)>=1&&48==u[(n+16|0)+((o=s+-1|0)<<1)>>1];);a[n+8>>2]=s,(0|t)<2||(0|(o=a[n+12>>2]))!=(0|c)&&((((c=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|s)||(R(),s=a[n+8>>2]))}(0|s)<=-1&&(a[966]=1),a[968]=a[n+12>>2],a[969]=u[n+48>>1]>>>15^1,(o=s)>>>0>=256&&(R(),o=a[n+8>>2]),K(3280,n+16|0,s<<1)}else a[966]=1,o=-1;return w=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,w=o=w-48|0,n[o+39|0]=0,K(o+8|0,3280,(r=(0|r)<15?r:15)<<1),i[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,a[o>>2]=0,a[o+4>>2]=0,ye(a[256],o,o+8|0)&&(a[966]=1),w=o+48|0,+f[o>>3]},_start:x,__errno_location:function(){return 3888},setThrew:function(e,t){e|=0,t|=0,a[970]||(a[971]=t,a[970]=e)},stackSave:function(){return 0|w},stackAlloc:function(e){return w=e=w-(e|=0)&-16,0|e},stackRestore:function(e){w=e|=0},__growWasmMemory:function(e){return 0,0|R()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:i.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:i.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:i.Base_LocaleDecimalSeparator,Math_log10:i.Math_log10,Math_log:i.Math_log,Math_sqrt:i.Math_sqrt,Math_sin:i.Math_sin,Math_cos:i.Math_cos,Math_tan:i.Math_tan,Math_atan:i.Math_atan,Math_exp:i.Math_exp,proc_exit:a.proc_exit,getTempRet0:i.getTempRet0},f),v=h.memory;t.memory=v;var S=h.Base_StrBuf;t.Base_StrBuf=S;var y=h.Base_StrBufSize;t.Base_StrBufSize=y;var F=h.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=F;var C=h.Dtr_FromNum;t.Dtr_FromNum=C;var R=h.Dtr_Yr;t.Dtr_Yr=R;var b=h.Dtr_Mon;t.Dtr_Mon=b;var E=h.Dtr_DOM;t.Dtr_DOM=E;var P=h.Dtr_Hour;t.Dtr_Hour=P;var k=h.Dtr_Min;t.Dtr_Min=k;var T=h.Dtr_Sec;t.Dtr_Sec=T;var A=h.Dtr_Wdy;t.Dtr_Wdy=A;var N=h.Dtr_FracSec;t.Dtr_FracSec=N;var _=h.Dtr_Rounding;t.Dtr_Rounding=_;var I=h.Dtr_Write;t.Dtr_Write=I;var O=h.Dtr_ToNum;t.Dtr_ToNum=O;var M=h.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=M;var D=h.Dtr_Days;t.Dtr_Days=D;var w=h.Dtr_ToDays;t.Dtr_ToDays=w;var L=h.Dtr_ToTime;t.Dtr_ToTime=L;var x=h.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var K=h.Mathpack_Zero;t.Mathpack_Zero=K;var U=h.Mathpack_One;t.Mathpack_One=U;var B=h.Mathpack_Pi;t.Mathpack_Pi=B;var W=h.Mathpack_Div;t.Mathpack_Div=W;var G=h.Mathpack_Mul;t.Mathpack_Mul=G;var V=h.Mathpack_Sub;t.Mathpack_Sub=V;var j=h.Mathpack_Add;t.Mathpack_Add=j;var q=h.Mathpack_Power;t.Mathpack_Power=q;var H=h.Mathpack_Cond;t.Mathpack_Cond=H;var z=h.Mathpack_Cond2;t.Mathpack_Cond2=z;var Q=h.Mathpack_TakeMathError;t.Mathpack_TakeMathError=Q;var Y=h.Mathpack_Trunc;t.Mathpack_Trunc=Y;var J=h.Mathpack_Ceil;t.Mathpack_Ceil=J;var $=h.Mathpack_Floor;t.Mathpack_Floor=$;var X=h.Mathpack_Abs;t.Mathpack_Abs=X;var Z=h.Mathpack_Neg;t.Mathpack_Neg=Z;var ee=h.Mathpack_Float;t.Mathpack_Float=ee;var te=h.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=h.Mathpack_Fix;t.Mathpack_Fix=re;var ne=h.Mathpack_LFix;t.Mathpack_LFix=ne;var ie=h.Mathpack_SFix;t.Mathpack_SFix=ie;var ae=h.Mathpack_Round;t.Mathpack_Round=ae;var oe=h.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var se=h.Mathpack_RoundDown;t.Mathpack_RoundDown=se;var ue=h.Mathpack_TenTo;t.Mathpack_TenTo=ue;var le=h.Mathpack_Compare;t.Mathpack_Compare=le;var ce=h.Mathpack_GetExp32;t.Mathpack_GetExp32=ce;var de=h.Mathpack_Equal;t.Mathpack_Equal=de;var pe=h.Mathpack_ViewRound;t.Mathpack_ViewRound=pe;var me=h.Mathpack_Sqrt;t.Mathpack_Sqrt=me;var fe=h.Mathpack_Exp;t.Mathpack_Exp=fe;var ge=h.Mathpack_Ln;t.Mathpack_Ln=ge;var he=h.Mathpack_Log;t.Mathpack_Log=he;var ve=h.Mathpack_Sin;t.Mathpack_Sin=ve;var Se=h.Mathpack_Cos;t.Mathpack_Cos=Se;var ye=h.Mathpack_Tan;t.Mathpack_Tan=ye;var Fe=h.Mathpack_Asin;t.Mathpack_Asin=Fe;var Ce=h.Mathpack_Acos;t.Mathpack_Acos=Ce;var Re=h.Mathpack_Atan;t.Mathpack_Atan=Re;var be=h.Mathpack_Atan2;t.Mathpack_Atan2=be;var Ee=h.Mathpack_Mod;t.Mathpack_Mod=Ee;var Pe=h.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Pe;var ke=h.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=ke;var Te=h.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Te;var Ae=h.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Ae;var Ne=h.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Ne;var _e=h.Mathpack_Pack;t.Mathpack_Pack=_e;var Ie=h._start;t._start=Ie;var Oe=h.__errno_location;t.__errno_location=Oe;var Me=h.setThrew;t.setThrew=Me;var De=h.stackSave;t.stackSave=De;var we=h.stackAlloc;t.stackAlloc=we;var Le=h.stackRestore;t.stackRestore=Le;var xe=h.__growWasmMemory;t.__growWasmMemory=xe},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureName=t.getCalcAbsUrl=t.isCalcInit=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.initCalc=t.calcConfig=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.Country=t.LCID=t.localeInfo=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;var n=r(0),i=n.__importStar(r(12)),a=n.__importStar(r(128)),o=n.__importStar(r(22));t.LogCategory=i.LogCategory,t.TraceLevel=i.TraceLevel,t.NulLogger=i.NulLogger,t.ulsLogger=i.ulsLogger,t.localeInfo=i.localeInfo,t.LCID=i.LCID,t.Country=i.Country,t.PictureSpecial=i.PictureSpecial,t.PictureSingle=i.PictureSingle,t.PictureColor=i.PictureColor,t.PictureDbnum=i.PictureDbnum,t.calcConfig=i.calcConfig,t.initCalc=a.initCalc,t.getEnglishLocaleInfo=i.getEnglishLocaleInfo,t.englishWorksheetFuncIdToName=i.englishWorksheetFuncIdToName,t.englishErrorTypeToName=i.englishErrorTypeToName,t.englishOperatorIdToName=i.englishOperatorIdToName,t.operatorIdToName=i.operatorIdToName,t.createWorksheetFuncNameCallbacks=i.createWorksheetFuncNameCallbacks,t.createIsThousandsPositionCallback=i.createIsThousandsPositionCallback,t.isCalcInit=a.isCalcInit,t.getCalcAbsUrl=a.getCalcAbsUrl,t.FeatureName=o.FeatureName},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxRetriesForLoadingScript=t.isCalcInit=t.initCalcThread=t.initCalcInThread=t.initCalcCalled=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=void 0;var n=r(1);t.getCalcAbsUrl=n.config.getCalcAbsUrl,t.getCalcAbsUrlOrThrow=n.config.getCalcAbsUrlOrThrow,t.initCalc=n.config.initCalc,t.initCalcCalled=n.config.initCalcCalled,t.initCalcInThread=n.config.initCalcInThread,t.initCalcThread=n.config.initCalcThread,t.isCalcInit=n.config.isCalcInit,t.maxRetriesForLoadingScript=n.config.maxRetriesForLoadingScript},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;var n=r(3);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(3);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(1);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(14);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var n=r(3);t.SpecialPos=n.cellParse.SpecialPos,t.isR1C1IdentStart=n.cellParse.isR1C1IdentStart,t.parseCellRef=n.cellParse.parseCellRef,t.parseGridCellA1=n.cellParse.parseGridCellA1,t.parseGridRangeA1=n.cellParse.parseGridRangeA1,t.wrapPosition=n.cellParse.wrapPosition},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;var n=r(37);t.createParser=n.parserService.createParser},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.insertCommas=t.convertNumberShape=t.convertDigitsShape=void 0;var a=r(0),o=r(59),s=r(66),u=r(173),l=a.__importStar(r(135)),c=r(65),d=r(53),p=l.codePointDigitZero,m=l.codePointDigitNine,f=l.codePointDigitOne,g=((n={})[c.NumberShape.ArabicIndic]={zero:1632,one:1633},n[c.NumberShape.ExtendedArabicIndic]={zero:1776,one:1777},n[c.NumberShape.Devanagari]={zero:2406,one:2407},n[c.NumberShape.Bengali]={zero:2534,one:2535},n[c.NumberShape.Gurmukhi]={zero:2662,one:2663},n[c.NumberShape.Gujarati]={zero:2790,one:2791},n[c.NumberShape.Oriya]={zero:2918,one:2919},n[c.NumberShape.Tamil]={zero:48,one:3047},n[c.NumberShape.Telugu]={zero:3174,one:3175},n[c.NumberShape.Kannada]={zero:3302,one:3303},n[c.NumberShape.Malayalam]={zero:3430,one:3431},n[c.NumberShape.Thai]={zero:3664,one:3665},n[c.NumberShape.Lao]={zero:3792,one:3793},n[c.NumberShape.Tibetan]={zero:3872,one:3873},n[c.NumberShape.Myanmar]={zero:4160,one:4161},n[c.NumberShape.Ethiopic]={zero:48,one:4969},n[c.NumberShape.Khmer]={zero:6112,one:6113},n[c.NumberShape.Mongolian]={zero:6160,one:6161},n),h=((i={})[c.NumberShape.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[c.NumberShape.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},i[c.NumberShape.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[c.NumberShape.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[c.NumberShape.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},i[c.NumberShape.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[c.NumberShape.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312},i[c.NumberShape.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},i[c.NumberShape.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806},i[c.NumberShape.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},i[c.NumberShape.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},i[c.NumberShape.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806},i[c.NumberShape.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},i);function v(e,t){if(t===c.NumberShape.ASCII)return e;switch(t){case c.NumberShape.ArabicIndic:case c.NumberShape.ExtendedArabicIndic:case c.NumberShape.Devanagari:case c.NumberShape.Bengali:case c.NumberShape.Gurmukhi:case c.NumberShape.Gujarati:case c.NumberShape.Oriya:case c.NumberShape.Tamil:case c.NumberShape.Telugu:case c.NumberShape.Kannada:case c.NumberShape.Malayalam:case c.NumberShape.Thai:case c.NumberShape.Lao:case c.NumberShape.Tibetan:case c.NumberShape.Myanmar:case c.NumberShape.Ethiopic:case c.NumberShape.Khmer:case c.NumberShape.Mongolian:for(var r="",n=g[t],i=0;i<e.length;i+=1){var a=e.charCodeAt(i);(0,s.assertTrue)("calc.numfmt.convertDigitsShape",p<=a&&a<=m),r+=a===p?(0,u.stringFromCodePoint)(n.zero):(0,u.stringFromCodePoint)(n.one+(a-f))}return r;case c.NumberShape.ChineseTrad1:case c.NumberShape.ChineseTrad2:case c.NumberShape.ChineseTrad3:case c.NumberShape.ChineseSimp1:case c.NumberShape.ChineseSimp2:case c.NumberShape.ChineseSimp3:case c.NumberShape.Japanese1:case c.NumberShape.Japanese2:case c.NumberShape.Japanese3:case c.NumberShape.Korean1:case c.NumberShape.Korean2:case c.NumberShape.Korean3:case c.NumberShape.Korean4:for(r="",n=h[t],i=0;i<e.length;i+=1){a=e.charCodeAt(i);(0,s.assertTrue)("calc.numfmt.convertDigitsShape",p<=a&&a<=m),r+=(0,u.stringFromCodePoint)(n.digits[a-p])}return r}}t.convertDigitsShape=v,t.convertNumberShape=function(e,t,r){var n=e.decimalSeparator;if(r===c.NumberShape.ASCII)return(0,d.success)(t);switch(r){case c.NumberShape.ArabicIndic:case c.NumberShape.ExtendedArabicIndic:case c.NumberShape.Devanagari:case c.NumberShape.Bengali:case c.NumberShape.Gurmukhi:case c.NumberShape.Gujarati:case c.NumberShape.Oriya:case c.NumberShape.Tamil:case c.NumberShape.Telugu:case c.NumberShape.Kannada:case c.NumberShape.Malayalam:case c.NumberShape.Thai:case c.NumberShape.Lao:case c.NumberShape.Tibetan:case c.NumberShape.Myanmar:case c.NumberShape.Ethiopic:case c.NumberShape.Khmer:case c.NumberShape.Mongolian:var i=t.indexOf(n),a=v(t.substring(0,i<0?void 0:i),r),u=i<0?"":n,l=i<0?"":v(t.substring(i+n.length),r);return(0,d.success)(a+u+l);case c.NumberShape.ChineseTrad1:case c.NumberShape.ChineseTrad2:case c.NumberShape.ChineseTrad3:case c.NumberShape.ChineseSimp1:case c.NumberShape.ChineseSimp2:case c.NumberShape.ChineseSimp3:case c.NumberShape.Japanese1:case c.NumberShape.Japanese2:case c.NumberShape.Japanese3:case c.NumberShape.Korean1:case c.NumberShape.Korean2:case c.NumberShape.Korean3:case c.NumberShape.Korean4:return(0,d.failure)((0,o.notImplemented)(["convertNumberShape: ideographic shape ".concat(String(r))]));default:return(0,s.assertNever)("calc.numfmt.convertNumberShape",r)}},t.insertCommas=function(e,t,r){if(""===t)return"";for(var n=(0,u.countCodePoints)(t,0,t.length),i="",a=0,o=0;a<t.length;){var s=(0,u.stringCodePointAt)(t,a),l=(0,u.numCodeUnits)(s);i+=t.substring(a,a+l),a+=l,o+=1,e.isThousandsPosition(r+(n-o))&&(i+=e.thousandsSeparator)}return i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(1);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonFormat=t.RibbonFormat=void 0;var n=r(38);t.RibbonFormat=n.ribbonFormat.RibbonFormat,t.getRibbonFormat=n.ribbonFormat.getRibbonFormat},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(1);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WildExp=void 0;var n,i=r(0).__importStar(r(189)),a=r(190);!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(n||(n={}));var o=i.codePointTilde,s=i.codePointQuestionMark,u=i.codePointAsterisk,l=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];for(var n="",i=0;i<t.length;i+=1){var l=t.charCodeAt(i);if(l===o&&i+1<t.length){var c=(0,a.stringCodePointAt)(t,i+1);n+=(0,a.stringFromCodePoint)(c),i+=(0,a.numCodeUnits)(c)}else l!==o&&(l!==s&&l!==u?n+=t.charAt(i):(this.pushBlock(n),n="",this.pushMeta(l)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(u)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(n.OP_DOT)}},e.prototype.pushMeta=function(e){e===s?this.bytecode.push(n.OP_DOT):this.bytecode.push(n.OP_DOTSTAR)},e.prototype.test=function(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var i=Object.keys(t);if(t=Object.create(null),0===i.length)return!1;for(var a=0;a<i.length;a+=1){var o=Number(i[a]);if(o!==this.bytecode.length){var s=this.bytecode[o];switch(s){case n.OP_DOT:this.addState(t,o+1);break;case n.OP_DOTSTAR:this.addState(t,o);break;default:var u=this.blocks[s];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,o+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;for(var r=this.bytecode,i=t;i<r.length&&r[i]===n.OP_DOTSTAR;i+=1)e[i+1]=!0},e.prototype.testSimple=function(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))},e}();t.WildExp=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNames=t.isNamedTableRangeEqual=t.mergeNameStatistics=t.emptyNameStatistics=t.namedFailure=t.namedFormula=t.mergeNamedTables=t.namedTable=t.namedRange=t.namedValue=void 0;var n=r(0),i=r(294),a=r(15),o=r(2),s=r(13),u=r(196),l=r(5),c=r(9),d=r(11),p=r(4),m=r(92),f=r(20);t.namedValue=(0,o.typedInstanceCreator)()((function(e){return{kind:"NamedValue",value:e}})),t.namedRange=(0,o.typedInstanceCreator)()((function(e){return{kind:"NamedRange",value:e}}));var g=u.RedBlackMapTree.create((function(e,t){return e-t}));t.namedTable=function(e,t,r,n,i){var o,s=e.sheet,l=e.range,m=t?(0,a.gridRange)(l.row-1,l.col,1,l.cols):void 0,f=r?(0,a.gridRange)(l.row+l.rows,l.col,1,l.cols):void 0,h=(0,d.gridRangeJoinOpt)((0,d.gridRangeJoinOpt)(m,e.range),f),v=n.reduce((function(t,r){return(0,p.assertTrue)("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name)}),g),S=u.RedBlackMapTree.create(i);v.forEach((function(e,t){return S=S.setValue(t,e),!0}));var y=v.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:(o={},o[c.SpecialRefId.Data]=e,o[c.SpecialRefId.Headers]=m?(0,a.sheetGridRange)(s,m):void 0,o[c.SpecialRefId.Totals]=f?(0,a.sheetGridRange)(s,f):void 0,o[c.SpecialRefId.All]=(0,a.sheetGridRange)(s,h),o),columnNames:S,columnIndexes:v,allColumnNamesAvailable:y,hasHeadersRow:t,hasTotalsRow:r}},t.mergeNamedTables=function(e,t){var r=e.columnNames,i=e.columnIndexes;t.columnIndexes.forEach((function(t,n){var i=e.columnIndexes.getValue(t);return void 0!==i&&(r=r.remove(i)),!0})),t.columnIndexes.forEach((function(e,t){return r=r.setValue(t,e),i=i.setValue(e,t),!0}));var a=i.getCount()===t.specialRefRanges[c.SpecialRefId.All].range.cols;return n.__assign(n.__assign({},t),{columnNames:r,columnIndexes:i,allColumnNamesAvailable:a})},t.namedFormula=(0,o.typedInstanceCreator)()((function(e){return{kind:"NamedFormula",fmla:e}})),t.namedFailure=(0,o.typedInstanceCreator)()((function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}}));var h=(0,m.makeGridRangeTable)(),v=(0,m.makeGridRangeTable)();t.emptyNameStatistics={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0},t.mergeNameStatistics=function(e,t){return{namesCount:e.namesCount+t.namesCount,tablesCount:e.tablesCount+t.tablesCount,rangesCount:e.rangesCount+t.rangesCount,recalcFailuresCount:e.recalcFailuresCount+t.recalcFailuresCount,scopes:e.scopes+t.scopes,allAvailableScopes:e.allAvailableScopes+t.allAvailableScopes}},t.isNamedTableRangeEqual=function(e,t){return(0,d.isSheetGridRangeEqual)(e.specialRefRanges[c.SpecialRefId.Data],t.specialRefRanges[c.SpecialRefId.Data])&&e.hasHeadersRow===t.hasHeadersRow&&e.hasTotalsRow===t.hasTotalsRow};var S=function(){function e(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}return e.create=function(t){return new e(u.RedBlackMapTree.create(t),!1,h,v)},e.prototype.update=function(t,r,n,i){return t!==this.names||r!==this.allAvailable||n!==this.tables||i!==this.ranges?new e(t,r,n,i):this},e.prototype.getEntry=function(e,t,r){var n=this.names.getEntry(t);return void 0===n?this.allAvailable?(0,l.success)(void 0):(0,l.failure)((0,d.unavailable)([{kind:f.UnavailableKind.NameLoc,name:(0,a.nameLoc)(e,t),source:r}])):(0,l.success)(!1!==n.value?n:void 0)},e.prototype.getEntryIfDefined=function(e){var t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)},e.prototype.getContainingTable=function(e){var t;return this.tables.forEachGe(e,(function(e,r){return t=r,!1})),t},e.prototype.getIntersectingTables=function(e){var t=[];return this.tables.forEachMeets(e,(function(e,r){return t.push(r),!0})),t},e.prototype.getNamedRanges=function(e){var t;return null!==(t=this.ranges.getValue(e))&&void 0!==t?t:[]},e.prototype.getAvailableNames=function(e){var t=[];return this.names.forEach((function(r,n){return!1!==n&&t.push((0,a.nameLoc)(e,r)),!0})),t},e.prototype.forEachAvailableName=function(e){return this.names.forEach((function(t,r){return e(t,!1===r?void 0:r)}))},e.prototype.setUndefined=function(){return this.update(this.names,!0,this.tables,this.ranges)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.update(this.allAvailable?this.names.filter((function(e,t){return!1!==t})):this.names,this.allAvailable,this.tables,this.ranges)},e.prototype.resetLazyData=function(){this.names.forEach((function(e,t){return!1!==t&&t.lazyData.reset(),!0}))},e.prototype.onWriteNamedTable=function(e,t,r){var n=t.specialRefRanges[c.SpecialRefId.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)},e.prototype.onWriteNamedRange=function(e,t,r){var i,a=t.value.ranges[0],o=null!==(i=this.ranges.getValue(a))&&void 0!==i?i:[],s="remove"===r?o.filter((function(t){return(0,d.isNameScopeEqual)(e.scope,t.scope)&&e.name===t.name})):n.__spreadArray(n.__spreadArray([],o,!0),[e],!1);return this.update(this.names,this.allAvailable,this.tables,0===s.length?this.ranges.remove(a):this.ranges.setValue(a,s))},e}(),y=function(){function e(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=S.create(e),this.emptyRecalcFailures=this.recalcFailures=i.ArrayMapTree.create(e)}return e.prototype.clone=function(){var t=new e(this.stringCompareCI,this.scope);return t.contents=this.contents,t},e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return(0,l.isSuccess)(r)?(0,l.success)(void 0!==r.value?(0,a.nameLoc)(this.scope,r.value.key):void 0):r},e.prototype.getNameFormula=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return(0,l.isSuccess)(r)?(0,l.success)(void 0!==r.value?r.value.value:void 0):r},e.prototype.getContainingTable=function(e){return this.contents.getContainingTable(e)},e.prototype.getIntersectingTables=function(e){return this.contents.getIntersectingTables(e)},e.prototype.getNamedRanges=function(e){return this.contents.getNamedRanges(e)},e.prototype.allAvailable=function(){return this.contents.allAvailable},e.prototype.getAvailableNames=function(e){return this.contents.getAvailableNames(e)},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.resetLazyData=function(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()},e.prototype.setNamedObject=function(e,t,r,n,i){var o,u=this.contents.getEntryIfDefined(t.name);if(void 0!==u&&(o=i((0,a.nameLoc)(this.scope,u.key),u.value.obj,"remove")).kind===l.ResultKind.Failure)return o;if((this.contents=void 0===r?this.contents.remove(t.name):this.contents.setValue(t.name,{obj:r,lazyData:new s.ResettableLazy((function(){return n(e,t,r)}))}),this.isCurrent=this.isChanged=!0,void 0!==r)&&(o=i(t,r,"add")).kind===l.ResultKind.Failure)return o;return l.successUndefined},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e,t){var r=this;if(this.isChanged||e!==this.oldStateId)return(0,l.success)(!1);this.contents=this.oldContents,this.isCurrent=!0;var n=(0,l.success)(!0);return this.contents.forEachAvailableName((function(e,i){if(void 0===i)return!0;var o=t((0,a.nameLoc)(r.scope,e),i.obj,"add");return o.kind===l.ResultKind.Success||(n=o,!1)})),n},e.prototype.onWriteNamedTable=function(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)},e.prototype.onWriteNamedRange=function(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)},e.prototype.forEachAvailableName=function(e){return this.contents.forEachAvailableName(e)},e}();t.PartialWorkbookNames=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerExperimentFactory=t.getExperimentFactories=t.ExperimentKind=void 0;var n,i=r(24),a=r(4),o=r(2),s=r(466),u=r(300),l=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given ".concat(t);a.ulsLogger.ULS.traceTag(591974878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=(0,o.now)();(0,o.now)()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}();!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(n||(t.ExperimentKind=n={}));var c={TestExperiment:function(e){return{experimentName:"TestExperiment",kind:n.OneShot,create:function(){return l.create(e)}}},ExceLintExperiment:function(){return{experimentName:"ExceLintExperiment",kind:n.OneShot,create:function(){return new s.ExceLintExperiment}}},UnitExperiment:function(){return{experimentName:"UnitExperiment",kind:n.OneShot,create:function(){return new u.UnitExperiment},stepBudget:80}}};t.getExperimentFactories=function(e){return e.map((function(e){var t,r=e.name,n=e.param;return null===(t=c[r])||void 0===t?void 0:t.call(c,n)})).filter((function(e){return void 0!==e}))},t.registerExperimentFactory=function(e,t){c[e]=t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(1);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutionType=void 0,function(e){e.Sync="Sync",e.Async="Async"}(n||(t.ExecutionType=n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TaskInternal=t.Ref=t.InitializingSubject=t.Subject=void 0;var n=r(0),i=r(24),a=r(4),o=r(47),s=function(){function e(){this.subscribers=[],this.currentSubscription=0}return e.prototype.next=function(e){for(var t=0,r=this.subscribers;t<r.length;t++){var n=r[t];n[0];(0,n[1])(e)}},e.prototype.subscribe=function(e){return this.subscribers.push([++this.currentSubscription,e]),this.currentSubscription},e.prototype.unsubscribe=function(e){this.subscribers=this.subscribers.filter((function(t){var r=t[0];t[1];return r!==e}))},e}();t.Subject=s;var u=function(e){function t(t){var r=e.call(this)||this;return r.initializeSubscriber=t,r}return n.__extends(t,e),t.prototype.subscribe=function(t){var r=e.prototype.subscribe.call(this,t);return this.initializeSubscriber().map(t),r},t}(s);t.InitializingSubject=u;var l=function(e){this.value=e};t.Ref=l;var c=function(){function e(e,t){this.maybeThenable=e,this.token=t}return e.createToken=function(){return"Do not use outside of x10 scheduler. Resovle by yielding with an 'AwaitTask' / 'AwaitAll' request"},e.prototype.resolve=function(e){return a.ulsLogger.ULS.assertTag(508179168,i.LogCategory.msoulscat_ES_EWAJS,e===this.token,o.x10Logger.formatLogMessage("X10TaskInternal.resolve",{description:"Task is resolving with an invalid token"})),this.maybeThenable},e}();t.X10TaskInternal=c},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationKinds=t.ComputationType=void 0;var i,a=r(0),o=r(2),s=r(17),u=r(98);!function(e){e.UIMessage="UIMessage",e.Event="Event"}(i||(t.ComputationType=i={})),t.ComputationKinds=((n={})[i.UIMessage]=s.RequestKind,n[i.Event]=a.__assign(a.__assign({},u.EventKind),u.ALAnnotationKind),n),(0,o.staticAssertSame)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)(),(0,o.staticAssertExtends)()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniteIntersectingRangeObjects=t.uniteIntersectingGridRanges=t.gridRangesIntersects=t.rangesIntersects=t.getSheetGridCellFromRangeObject=t.rangeToGridRange=t.toSharedSheetRange=t.getSheetRangeFromResolvedRef=t.sheetRangeFromCellRef=t.getSheetRangeFromDefinedNameInfo=t.getRangeFromDefinedName=void 0;var n=r(0),i=r(2),a=r(99),o=r(5),s=r(6),u=r(209),l=r(15);function c(e){var t=e.namedRange;if(null!=t&&e.type!==s.DefinedNameInfoType.Invalid){var r=e.type===s.DefinedNameInfoType.Table?1:0;return t.bottom&&t.top&&t.right&&t.left?{firstRow:t.top+r-1,firstColumn:t.left-1,lastRow:t.bottom-1,lastColumn:t.right-1}:void 0}}function d(e,t){return(0,i.fastMin)(e.lastColumn,t.lastColumn)>=(0,i.fastMax)(e.firstColumn,t.firstColumn)&&(0,i.fastMin)(e.lastRow,t.lastRow)>=(0,i.fastMax)(e.firstRow,t.firstRow)}function p(e,t){return(0,i.fastMin)(e.col+e.cols-1,t.col+t.cols-1)>=(0,i.fastMax)(e.col,t.col)&&(0,i.fastMin)(e.row+e.rows-1,t.row+t.rows-1)>=(0,i.fastMax)(e.row,t.row)}t.getRangeFromDefinedName=c,t.getSheetRangeFromDefinedNameInfo=function(e,t){var r=c(e);if((0,i.isDefined)(r)){var o=(0,i.isDefined)(e.sheetName)?e.sheetName:t?(0,a.getSheetNameFromQualifier)(t):"";return n.__assign(n.__assign({},r),{sheetName:o,namedObjectName:(0,i.isDefined)(e.name)?e.name:""})}},t.sheetRangeFromCellRef=function(e,t,r,o){var s=(0,a.getRangeFromCellRef)(e,r,o);if((0,i.isDefined)(s))return n.__assign(n.__assign({},s),{sheetName:t?(0,a.getSheetNameFromQualifier)(t):"",namedObjectName:""})},t.getSheetRangeFromResolvedRef=function(e,t,r){var i;if((0,o.isSuccess)(t.resolution)){if(void 0!==t.resolution.value){var s=t.resolution.value,l=null!==(i=(0,a.sheetIndexToSheetName)(s.sheet,e))&&void 0!==i?i:"";return n.__assign(n.__assign({},(0,u.gridRangeToRange)(s.range)),{sheetName:l,namedObjectName:t.node.lhs?t.node.lhs.whole:""})}null==r||r("failed to resolve StructRef, resolution value undefined")}else null==r||r("failed to resolve StructRef, reason: ".concat(t.resolution.reason))},t.toSharedSheetRange=function(e){return{FirstColumn:e.firstColumn,FirstRow:e.firstRow,LastColumn:e.lastColumn,LastRow:e.lastRow,NamedObjectName:e.namedObjectName,SheetName:e.sheetName}},t.rangeToGridRange=function(e){var t=e.firstRow,r=e.firstColumn;return(0,l.gridRange)(t,r,e.lastRow-t+1,e.lastColumn-r+1)},t.getSheetGridCellFromRangeObject=function(e,t){return(0,l.sheetGridCell)(t,{row:e.firstRow,col:e.firstColumn,rows:1,cols:1})},t.rangesIntersects=d,t.gridRangesIntersects=p,t.uniteIntersectingGridRanges=function(e,t){return p(e,t)?(0,l.gridRange)((0,i.fastMin)(e.row,t.row),(0,i.fastMin)(e.col,t.col),(0,i.fastMax)(e.row+e.rows,t.row+t.rows)-(0,i.fastMin)(e.row,t.row),(0,i.fastMax)(e.col+e.cols,t.col+t.cols)-(0,i.fastMin)(e.col,t.col)):null},t.uniteIntersectingRangeObjects=function(e,t){return d(e,t)?{firstRow:(0,i.fastMin)(e.firstRow,t.firstRow),firstColumn:(0,i.fastMin)(e.firstColumn,t.firstColumn),lastRow:(0,i.fastMax)(e.lastRow,t.lastRow),lastColumn:(0,i.fastMax)(e.lastColumn,t.lastColumn)}:null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ds=t.ResultKind=t.arrayFill=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.messageFromError=t.assertIndex=t.assertPositiveInteger=t.assertPositiveLength=t.assertFalse=t.assertTrue=t.assertNatural=t.assertNever=t.Pledge=t.JSF32=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.now=t.makeStringMap=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.numEnumMap=t.numEnumArray=t.identity=t.fastAbs=t.fastMax=t.fastMin=void 0;var n=r(0),i=n.__importStar(r(2)),a=n.__importStar(r(4)),o=n.__importStar(r(35)),s=n.__importStar(r(221)),u=n.__importStar(r(1)),l=n.__importStar(r(154));t.fastMin=i.fastMin,t.fastMax=i.fastMax,t.fastAbs=i.fastAbs,t.identity=i.identity,t.numEnumArray=i.numEnumArray,t.numEnumMap=i.numEnumMap,t.safePush=i.safePush,t.safeConcat=i.safeConcat,t.isDefined=i.isDefined,t.isNone=i.isNone,t.makeStringMap=i.makeStringMap,t.now=i.now,t.staticAssertExtends=i.staticAssertExtends,t.staticAssertSame=i.staticAssertSame,t.staticAssertIs=i.staticAssertIs,t.staticAssertIsOptional=i.staticAssertIsOptional,t.JSF32=u.JSF32,t.Pledge=l.Pledge,t.assertNever=a.assertNever,t.assertNatural=a.assertNatural,t.assertTrue=a.assertTrue,t.assertFalse=a.assertFalse,t.assertPositiveLength=a.assertPositiveLength,t.assertPositiveInteger=a.assertPositiveInteger,t.assertIndex=a.assertIndex,t.messageFromError=o.messageFromError,t.isInteger=o.isInteger,t.stringStartsWith=o.stringStartsWith,t.stringEndsWith=o.stringEndsWith,t.arrayFill=o.arrayFill,t.ResultKind=u.result.ResultKind,t.ds=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;var n=r(212);function i(e){return e}function a(e,r){if("string"==typeof r&&null!=o[r])return e;var n=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),i=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===i&&(i=s[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==i?i(e,r):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(a(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: ".concat(String(JSON.stringify(e)),">");var t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?"<error ".concat(r,">"):"<error ".concat(t,": ").concat(r,">")}};var o={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},s={boolean:i,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol ".concat(String(e),">")},undefined:i,null:i,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function ".concat(t,">"):"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=a(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(a):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))};var u=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),l=/[0-9]/g,c=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(c,"w").replace(l,"d").replace(u,"w")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;var n=r(147),i=r(212);function a(e){try{return e()}catch(e){return!1}}Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return i.mathLog2}}),t.isInteger="function"==typeof Number.isInteger&&a((function(){return Number.isInteger(1)&&!Number.isInteger(1.1)}))?function(e){return Number.isInteger(e)}:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.stringStartsWith="function"==typeof"".startsWith&&a((function(){return"ab".startsWith("a")&&!"ab".startsWith("b")&&"abc".startsWith("b",1)&&!"abc".startsWith("a",1)}))?function(e,t,r){return void 0===r&&(r=0),e.startsWith(t,r)}:function(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t},t.stringEndsWith="function"==typeof"".endsWith&&a((function(){return"ab".endsWith("b")&&!"ab".endsWith("a")}))?function(e,t){return e.endsWith(t)}:function(e,t){return t.length<=e.length&&e.substring(e.length-t.length,e.length)===t},t.repeat="function"==typeof"".repeat&&a((function(){return"aaa"==="a".repeat(3)}))?function(e,t){return e.repeat(t)}:function(e,t){return Array(t+1).join(e)},t.arrayFill=function(e,t){for(var r=0;r<e.length;r+=1)e[r]=t;return e},t.partialArray=function(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);var t=e,r=String(t.name),i=String(t.message);if(null!=t.stack){var a=String(t.stack);return a.indexOf(i)>=0&&a.indexOf(r)>=0?a:"".concat(r,": ").concat(i,"\n").concat(a)}return i.indexOf(r)>=0?i:"".concat(r,": ").concat(i)},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;var r=e;return r.message="".concat(t," ").concat(String(r.message)),r},t.values=function(e){var t=[];for(var r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t}},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(n||(t.TraceLevel=n={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(i||(t.LogCategory=i={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,i){return t.traceTag(e,r,n,i)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,i){return t.debugTraceTag(e,r,n,i)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,i){return t.assertTag(e,r,n,i)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,i){return t.shipAssertTag(e,r,n,i)},dnmTrace:function(e,r,n){return t.dnmTraceTag(0,e,r,n)},dnmTraceTag:function(e,r,n,i){return t.dnmTraceTag(e,r,n,i)}}}}};var a=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=a;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n,i=r(70),a=r(24),o=r(14);!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"}(n||(t.FeatureName=n={}));var s=function(e){var t="calc.common.isFeatureEnabledCallback: called with ".concat(e," before initCalc");return i.ulsLogger.ULS.traceTag(526989323,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t),!1},u={};function l(e){return void 0===u[e]&&(u[e]=s(e)),u[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(s=e)},t.isFeatureEnabled=l,t.getFeatures=function(){var e={};for(var t in n){var r=n[t];null!=r&&(e[r]=l(r))}return e};t.getTypedFeatureGate=(0,o.makeGetTypedFeatureGate)({"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!0,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1,"Microsoft.Office.Excel.FormulaRepairSuggestionsLimit":1,"Microsoft.Office.Excel.FormulaByExamplePluginEnabled":!1,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled":!1,"Microsoft.Office.Excel.FormulaRemediation":!1,"Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension":0,"Microsoft.Office.Excel.FormulaByExamplePluginSignalGenEnabled":!1,"Microsoft.Office.Excel.FormulaByExamplePluginCacheEnabled":!1,"Microsoft.Office.Excel.FormulaByExamplePluginEvaluationEnabled":!1,"Microsoft.Office.Excel.FormulaByExampleConditionals":!1,"Microsoft.Office.Excel.FormulaByExampleReferenceRowFormula":!1,"Microsoft.Office.Excel.CalcTsDec2023Funcs":!1,"Microsoft.Office.Excel.GotoCtrlClick":!1,"Microsoft.Office.Excel.CalcEtaLambda":!1,"Microsoft.Office.Excel.EtaReducedLambdas":!1,"Microsoft.Office.Excel.DesktopX10VPEnabled":!1});var c=r(14);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return c.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return c.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,o.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","OfficeVSO:6476056_OnlySendNestedDotNotationPath","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures","OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces","Microsoft.Office.Excel.X10IntelligentPythonWP5","OfficeVSO:8501373_CalcTsFuncsFirstSlice","OfficeVSO_8554430_CalcTsColRowSumProdFuncs","OfficeVSO:8557722_x10GetNumOfComputationsFromFrame","OfficeVSO:8564688_SkipFormulaPluginsForNonFormulaCells","OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin","OfficeVSO:8575821_x10MapGetRichValueFieldListContext","OfficeVSO:8620448_x10SchedulerThrowsFailures","OfficeVSO:8786821_x10SendLoggerMessagesToMainThread","Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions","Microsoft.Office.Excel.CalcTsLstr","Microsoft.Office.Excel.CalcTsInvalidChartMacro","OfficeVSO:8762152_x10PluginRegistryEnabled"])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n={};function i(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var i=parseFloat(n);return isNaN(i)?t:i},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var i=parseInt(n,10);return isNaN(i)?t:i},t.setFeatureGateDictionaryGetter=function(e){var t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";function n(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){var t;return null===(t=n()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";var n,i;function a(e){return{kind:n.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(n||(t.ResultKind=n={})),t.success=a,t.successUndefined=a(void 0),t.failure=function(e){return{kind:n.Failure,reason:e}},t.isSuccess=function(e){return e.kind===n.Success},function(e){e.JavaScriptError="JavaScriptError"}(i||(t.ReasonKind=i={})),t.javaScriptError=function(e){return{kind:i.JavaScriptError,error:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(1);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;var n,i=r(71);!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.PERCENTOF=646]="PERCENTOF",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.UNIT=665]="UNIT",e[e.GROUPBY=666]="GROUPBY",e[e.PIVOTBY=667]="PIVOTBY",e[e.PQSOURCE=668]="PQSOURCE",e[e.PYTHON_STR=669]="PYTHON_STR",e[e.PYTHON_TYPE=670]="PYTHON_TYPE",e[e.PYTHON_TYPENAME=671]="PYTHON_TYPENAME",e[e._FF=672]="_FF",e[e.FIELDFUNCTION=673]="FIELDFUNCTION",e[e.TRANSLATE=674]="TRANSLATE",e[e.DETECTLANGUAGE=675]="DETECTLANGUAGE",e[e.SUPPORTEDLANGUAGES=676]="SUPPORTEDLANGUAGES",e[e.REGEXTEST=677]="REGEXTEST",e[e.REGEXREPLACE=678]="REGEXREPLACE",e[e.REGEXEXTRACT=679]="REGEXEXTRACT",e[e.TESTFUNCTIONBEGIN=680]="TESTFUNCTIONBEGIN",e[e.GRF=681]="GRF",e[e.RICHERROR=682]="RICHERROR",e[e.COUNTER=683]="COUNTER",e[e.BROKENRECORD=684]="BROKENRECORD",e[e.STREAM=685]="STREAM",e[e.GETRICHERRORS=686]="GETRICHERRORS",e[e.DBGSTAT=687]="DBGSTAT",e[e.RICHNUMBER=688]="RICHNUMBER",e[e.RICHERNUMBER=689]="RICHERNUMBER",e[e.DBGWRITE=690]="DBGWRITE",e[e.TEST=691]="TEST",e[e.AAC=692]="AAC",e[e.AWC=693]="AWC",e[e.PARSEDEXPRESSION=694]="PARSEDEXPRESSION",e[e.AGE_CONTACTTEST=695]="AGE_CONTACTTEST",e[e.FIRSTNAME_CONTACTTEST=696]="FIRSTNAME_CONTACTTEST",e[e.FULLNAME_CONTACTTEST=697]="FULLNAME_CONTACTTEST",e[e.LASTNAME_CONTACTTEST=698]="LASTNAME_CONTACTTEST",e[e.TRANSLATENAME_CONTACTTEST=699]="TRANSLATENAME_CONTACTTEST",e[e.ARRAYVALUE=700]="ARRAYVALUE",e[e.RECORD=701]="RECORD",e[e.DISPLAYSTRING_GENERALTEST=702]="DISPLAYSTRING_GENERALTEST",e[e.LAMBDADOC=703]="LAMBDADOC",e[e.REFIDENTITY=704]="REFIDENTITY",e[e.GROUPBY2=705]="GROUPBY2",e[e.PIVOTBY2=706]="PIVOTBY2",e[e.PQEVALUATE=707]="PQEVALUATE",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"}(n||(t.WorksheetFuncId=n={})),t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[669,"PYTHON_STR"],[670,"PYTHON_TYPE"],[671,"PYTHON_TYPENAME"],[672,"_FF"],[695,"AGE_CONTACTTEST"],[696,"FIRSTNAME_CONTACTTEST"],[697,"FULLNAME_CONTACTTEST"],[698,"LASTNAME_CONTACTTEST"],[699,"TRANSLATENAME_CONTACTTEST"],[702,"DISPLAYSTRING_GENERALTEST"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]);var a=[];t.worksheetFuncTypes=[[1,255,a,[57],a,1,0,32],[1,3,[36,831,831],a,a,823,0,64],[1,1,[271],a,a,4,0,64],[1,1,[271],a,a,4,0,64],[1,255,a,[305],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[0,1,[16],a,a,33,0,0],[0,1,[16],a,a,33,0,0],[0,0,a,a,a,3,0,32],[2,255,[1],[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,2,[1,1],a,a,2,0,64],[1,3,[1,65,4],a,a,2,0,64],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[0,0,a,a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,3,[263,48,48],a,a,263,0,0],[2,4,[48,1,1,1],a,a,311,0,0],[2,2,[2,1],a,a,2,0,64],[3,3,[2,1,1],a,a,2,0,64],[1,1,[2],a,a,1,0,64],[1,1,[7],a,a,1,0,64],[0,0,a,a,a,4,0,32],[0,0,a,a,a,4,0,32],[1,255,a,[52],a,4,0,32],[1,255,a,[52],a,4,0,32],[1,1,[4],a,a,4,0,32],[2,2,[1,1],a,a,1,0,0],[3,3,[16,83,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[1,255,a,[49],a,1,0,32],[3,3,[16,19,18],a,a,1,0,0],[2,2,[263,2],a,a,2,0,64],[1,4,[48,112,84,84],a,a,32,0,0],[1,4,[48,112,112,84],a,a,32,0,0],[1,4,[48,112,84,84],a,a,32,0,0],[1,4,[48,112,112,84],a,a,32,0,0],[1,1,[16],a,a,512,0,2],[0,1,[4],a,a,512,0,2],[0,1,[575],a,a,512,0,2],[3,5,[1,1,1,1,1],a,a,1,0,0],[3,5,[1,1,1,1,1],a,a,1,0,0],[3,5,[1,1,1,1,1],a,a,1,0,0],[3,5,[1,1,1,1,1],a,a,1,0,0],[3,6,[1,1,1,1,1,1],a,a,1,0,0],[3,3,[48,1,1],a,a,1,0,32],[1,2,[48,1],a,a,1,0,0],[0,0,a,a,a,1,16383,0],[2,3,[263,305,17],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,2,[1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[0,0,a,a,a,1,16383,0],[1,1,[16],a,a,1,0,0],[1,1,[48],a,a,1,0,0],[1,1,[48],a,a,1,0,0],[3,5,[16,65,65,65,65],a,a,16,16383,0],[2,2,[2,16],a,a,16,0,2],[2,2,[16,16],a,a,2,0,2],[0,3,[66,81,16],a,a,4,0,2],[2,3,[2,2,1],a,a,1,0,64],[1,1,[39],a,a,32,0,0],[0,2,[1,24],a,a,4,0,2],[0,0,a,a,a,4,0,2],[1,1,[303],a,a,1,0,0],[0,1,[4],a,a,4,0,2],[1,2,[2,63],a,a,4,0,2],[0,0,a,a,a,50,0,2],[1,1,[16],a,a,47,0,2],[0,2,[65,66],a,a,32,0,2],[4,5,[87,117,117,1,117],a,a,4,0,4],[0,2,[1,66],a,a,32,0,2],[0,0,a,a,a,16,0,2],[0,0,a,a,a,16,0,2],[0,1,[1],a,a,4,0,2],[2,2,[1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,255,[33],[831],a,823,0,0],[3,4,[263,49,49,4],a,a,295,0,0],[3,4,[263,49,49,4],a,a,295,0,0],[0,2,[66,65],a,a,32,0,2],[1,7,[2,65,66,67,65,65,2],a,a,575,0,2],[1,1,[63],a,a,4,0,64],[1,1,[18],a,a,2,0,2],[1,2,[2,4],a,a,6,0,2],[2,2,[16,47],a,a,4,0,2],[1,2,[1,1],a,a,1,0,0],[1,4,[2,1,4,4],a,a,7,0,2],[1,1,[1],a,a,2,0,64],[1,1,[2],a,a,2,0,64],[1,1,[2],a,a,2,0,64],[1,1,[2],a,a,2,0,64],[1,2,[2,9],a,a,2,0,64],[1,2,[2,9],a,a,2,0,64],[2,2,[258,258],a,a,4,0,64],[1,1,[2],a,a,2,0,64],[4,4,[2,1,1,2],a,a,2,0,64],[3,4,[2,2,2,2],a,a,2,0,64],[1,1,[2],a,a,1,0,0],[0,3,[66,65,66],a,a,32,0,2],[0,1,[2],a,a,2,0,2],[2,3,[2,2,1],a,a,1,0,64],[1,2,[2,16],a,a,303,16383,0],[1,1,[271],a,a,4,0,64],[1,1,[399],a,a,4,0,64],[1,1,[399],a,a,4,0,64],[1,1,[399],a,a,4,0,64],[1,1,[23],a,a,2,0,0],[1,1,[23],a,a,1,0,0],[1,2,[2,1],a,a,1,0,2],[1,1,[1],a,a,1,0,2],[1,1,[1],a,a,1,0,2],[1,1,[1],a,a,2,0,2],[2,2,[1,1],a,a,2,0,2],[2,2,[1,2],a,a,1,0,2],[2,2,[1,2],a,a,1,0,2],[1,2,[1,1],a,a,1,0,2],[1,1,[3],a,a,1,0,64],[1,1,[3],a,a,1,0,64],[3,3,[1,1,1],a,a,1,0,0],[4,4,[1,1,1,1],a,a,1,0,0],[4,5,[1,1,1,1,1],a,a,1,0,0],[1,3,[2,66,65],a,a,2,0,2],[1,2,[16,4],a,a,2,0,2],[1,2,[2,4],a,a,16,0,2],[1,2,[2,4],a,a,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],a,3,0,2],[1,255,[3],[127],a,575,0,2],[0,1,[3],a,a,1,0,2],[2,4,[3,115,83,3],a,a,1,0,2],[3,5,[3,83,115,83,3],a,a,1,0,2],[4,5,[3,3,3,4,3],a,a,4,0,2],[4,5,[3,3,3,4,3],a,a,4,0,2],[4,5,[3,3,3,3,3],a,a,4,0,2],[0,1,[3],a,a,4,0,2],[2,3,[3,3,3],a,a,4,0,2],[3,4,[3,3,3,3],a,a,4,0,2],[1,3,[1,67,66],a,a,1,0,2],[1,1,[52],a,a,36,0,2],[1,1,[2],a,a,2,0,64],[1,1,[32],a,a,1,0,0],[1,1,[32],a,a,32,0,0],[2,2,[32,32],a,a,32,0,0],[0,2,[2,2],a,a,32,0,2],[4,6,[1,1,1,1,1,1],a,a,1,0,0],[4,6,[1,1,1,1,1,1],a,a,1,0,0],[1,255,a,[121],a,1,0,32],[0,2,[1,16],a,a,4,0,2],[3,4,[2,1,1,1],a,a,512,0,2],[1,1,[4],a,a,512,0,2],[0,0,a,a,a,512,0,2],[0,0,a,a,a,512,0,2],[2,2,[2,2],a,a,1,0,2],[2,2,[1,2],a,a,32,0,2],[3,3,[1,18,18],a,a,4,0,2],[2,2,[1,2],a,a,4,0,2],[1,1,[1],a,a,4,0,2],[0,1,[1],a,a,512,0,2],[0,1,[2],a,a,4,0,2],[0,4,[3,3,3,3],a,a,3,0,2],[1,255,a,[113],a,1,0,32],[1,1,[1],a,a,1,0,0],[1,2,[1,16],a,a,47,0,2],[1,1,[1],a,a,47,0,2],[1,2,[1,2],a,a,47,0,2],[1,2,[1,2],a,a,63,0,2],[3,3,[16,19,18],a,a,1,0,0],[1,1,[143],a,a,4,0,64],[0,3,[82,65,65],a,a,2,0,2],[0,4,[66,82,17,17],a,a,1,0,2],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[3,3,[16,19,18],a,a,1,0,0],[3,3,[16,19,18],a,a,1,0,0],[1,2,[1,1],a,a,1,0,0],[1,1,[143],a,a,4,0,64],[3,3,[16,83,18],a,a,1,0,0],[1,1,[3],a,a,4,0,2],[1,1,[3],a,a,4,0,2],void 0,void 0,[1,2,[1,1],a,a,2,0,192],[2,3,[2,2,1],a,a,1,0,192],[2,3,[2,2,1],a,a,1,0,192],[4,4,[2,1,1,2],a,a,2,0,192],[1,2,[2,9],a,a,2,0,192],[1,2,[2,9],a,a,2,0,192],[3,3,[2,1,1],a,a,2,0,192],[1,1,[2],a,a,1,0,192],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[1,1,[2],a,a,2,0,192],[1,1,[2],a,a,2,0,192],[2,3,[1,16,4],a,a,1,0,32],void 0,void 0,[2,5,[1,65,65,68,66],a,a,2,0,0],[2,3,[1,1,4],a,a,1,0,0],[0,0,a,a,a,1,16383,0],[5,7,[1,1,1,1,1,1,4],a,a,1,0,0],[0,0,a,a,a,512,0,2],[1,1,[12],a,a,512,0,2],[0,0,a,a,a,512,0,2],[1,3,[2,82,84],a,a,512,0,2],[1,255,a,[49],a,1,0,32],[1,255,a,[32],a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[16,19,18],a,a,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],a,a,2,0,2],[0,1,[4],a,a,4,0,2],[0,0,a,a,a,16,0,2],[0,2,[2,2],a,a,4,0,2],[0,3,[2,2,2],a,a,4,0,2],[2,5,[2,23,23,23,23],a,a,2,0,66],[2,4,[2,1,1,2],a,a,1,0,2],[1,4,[2,66,65,65],a,a,1,0,2],[1,1,[2],a,a,3,16383,0],[0,0,a,a,a,2,0,2],[1,5,[1,2,1,1,1],a,a,47,0,2],[4,5,[1,1,1,1,1],a,a,1,0,0],[0,1,[4],a,a,512,0,2],void 0,void 0,[0,1,[1],a,a,512,0,2],[2,2,[48,48],a,a,32,0,32],[0,2,[66,96],a,a,2,0,2],[1,1,[2],a,a,4,0,2],[1,255,[17],[127],a,575,0,192],[1,1,[3],a,a,4,0,2],[1,1,[2],a,a,63,0,2],[1,2,[1,3],a,a,47,0,2],[1,3,[1,3,1],a,a,47,0,2],[1,3,[2,66,4],a,a,4,0,2],[1,1,[15],a,a,1,0,0],[0,1,[2],a,a,4,0,2],[0,1,[2],a,a,4,0,2],[0,2,[99,66],a,a,4,0,2],[3,3,[3,1,4],a,a,4,0,2],[3,3,[3,1,4],a,a,4,0,2],[2,3,[2,3,66],a,a,1,0,2],[1,2,[1,2],a,a,35,0,2],[1,255,a,[49],a,1,0,32],[3,5,[1,1,1,65,65],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,5,[1,1,1,65,65],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[4,4,[1,1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[3,3,[1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[3,3,[1,32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[4,4,[32,32,1,1],a,a,1,0,0],[3,4,[32,32,1,65],a,a,1,0,0],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[2,3,[49,1,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,3,[49,1,65],a,a,1,0,32],[1,255,a,[32],a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,2,[1,1],a,a,1,0,0],void 0,[3,4,[2,1,1,1],a,a,1,0,130],[2,3,[2,1,1],a,a,1,0,130],[1,255,a,[2],a,2,0,64],[2,2,[1,1],a,a,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],a,a,2,0,2],[1,2,[1,2],a,a,35,0,2],[1,3,[1,66,2],a,a,35,0,2],[1,4,[1,66,66,2],a,a,7,0,2],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[2,255,[1],[16],a,1,0,0],[2,3,[16,15,16],a,a,1,0,64],[2,2,[16,15],a,a,1,0,64],[1,1,[16],a,a,1,0,0],[1,2,[1,2],a,a,19,0,2],[1,1,[33],a,a,33,0,2],[4,4,[1,1,1,1],a,a,1,0,0],[3,3,[1,1,2],a,a,1,0,128],[1,1,[1],a,a,2,0,192],[2,2,[1,1],a,a,2,0,192],[1,2,[1,5],a,a,2,0,0],[0,4,[66,66,66,65],a,a,6,0,2],[0,5,[66,66,66,66,65],a,a,6,0,2],[1,2,[1,2],a,a,19,0,2],[2,255,[18,18],[2,79],a,15,0,0],[1,2,[2,39],a,a,39,0,0],[1,1,[16],a,a,2,0,128],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,255,a,[49],a,1,0,32],[1,1,[1],a,a,2,0,64],[1,1,[1],a,a,2,0,192],[1,1,[3],a,a,2,0,192],[1,1,[1],a,a,2,0,192],[1,1,[1],a,a,2,0,192],[1,1,[1],a,a,2,0,192],[1,1,[2],a,a,1,0,192],[1,1,[2],a,a,4,0,192],[1,1,[1],a,a,1,0,192],[1,1,[1],a,a,1,0,192],[1,1,[1],a,a,1,0,192],[3,255,a,[2],a,2,0,0],[1,255,[2],[50],a,15,0,0],[2,3,[2,50,2],a,a,10,0,0],[3,3,[2,2,2],a,a,15,0,0],[3,4,[2,2,1,2],a,a,10,0,0],[1,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,3,[95,95,95],a,a,9,0,0],[1,255,a,[127],a,9,0,0],[1,255,a,[127],a,9,0,0],[4,4,[95,95,95,127],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[1,2,[95,95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,3,[127,127,95],a,a,9,0,0],[3,3,[95,127,127],a,a,9,0,0],[5,6,[95,95,95,95,95,95],a,a,9,0,0],[5,6,[95,95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[3,3,[95,95,95],a,a,9,0,0],[3,3,[95,95,95],a,a,9,0,0],[3,3,[95,95,95],a,a,9,0,0],[6,7,[95,95,95,95,95,95,95],a,a,9,0,0],[6,7,[95,95,95,95,95,95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[6,6,[95,95,95,95,95,95],a,a,9,0,0],[6,6,[95,95,95,95,95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,0,0],[2,3,[95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[3,4,[95,95,95,95],a,a,9,0,0],[5,6,[95,95,95,95,95,95],a,a,9,0,0],[5,6,[95,95,95,95,95,95],a,a,9,0,0],[7,8,[95,95,95,95,95,95,95,95],a,a,9,0,0],[7,8,[95,95,95,95,95,95,95,95],a,a,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],a,a,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],a,a,9,0,0],[2,2,[95,95],a,a,9,16383,0],[1,2,[95,95],a,a,9,0,0],[6,7,[95,95,95,95,95,95,95],a,a,9,0,128],[6,7,[95,95,95,95,95,95,95],a,a,9,0,0],[3,3,[95,95,95],a,a,9,0,0],[6,8,[95,95,95,95,95,95,95,95],a,a,9,0,0],[4,5,[95,95,95,95,95],a,a,9,0,0],[2,3,[95,95,127],a,a,9,0,0],[2,3,[95,95,127],a,a,9,0,0],[1,255,a,[127],a,9,0,0],[1,255,a,[127],a,9,0,0],[1,255,a,[127],a,9,0,0],[2,2,[95,127],a,a,9,0,0],[3,4,[2,2,1,2],a,a,10,0,0],[2,5,[2,50,2,1,2],a,a,10,0,64],[1,1,[2],a,a,9,0,0],[2,2,[47,575],a,a,303,0,0],[2,255,a,[16,15],a,1,0,64],[3,255,[16],[16,15],a,1,0,64],[2,3,[16,15,16],a,a,1,0,64],[3,255,[16],[16,15],a,1,0,64],[3,254,[1,1,48,17],[16],a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[2,2,[32,32],a,a,1,0,0],[3,3,[1,1,4],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,254,a,[32],a,32,0,32],[1,254,a,[32],a,1,0,32],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,3,[49,1,65],a,a,1,0,32],[2,3,[49,1,65],a,a,1,0,32],[3,3,[1,1,4],a,a,1,0,0],[2,2,[49,1],a,a,1,0,32],[2,2,[49,1],a,a,1,0,32],[2,3,[1,16,4],a,a,1,0,32],[2,3,[1,16,4],a,a,1,0,32],[1,254,a,[49],a,1,0,32],[1,254,a,[49],a,1,0,32],[3,3,[1,1,4],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[1,254,a,[49],a,1,0,32],[1,254,a,[49],a,1,0,32],[4,4,[1,1,1,4],a,a,1,0,0],[2,4,[95,95,75,127],a,a,9,0,0],[2,4,[95,95,75,127],a,a,9,0,0],[2,2,[1,1],a,a,1,0,128],[1,2,[1,65],a,a,1,0,128],void 0,[4,6,[1,1,1,4,65,65],a,a,1,0,0],[3,5,[1,1,1,65,65],a,a,1,0,0],[3,3,[1,1,4],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[5,5,[1,1,1,1,4],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[4,4,[1,1,1,4],a,a,1,0,0],[2,2,[1,4],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[4,4,[32,32,1,1],a,a,1,0,0],[2,3,[49,1,1],a,a,1,0,32],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[1],a,a,1,0,0],[1,2,[1,65],a,a,1,0,128],[1,2,[1,65],a,a,1,0,128],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[2,2,[1,1],a,a,1,0,0],[1,254,a,[52],a,4,0,32],[3,3,[1,1,1],a,a,1,0,0],[2,3,[1,1,65],a,a,2,0,0],[2,2,[2,1],a,a,1,0,0],[2,2,[3,3],a,a,1,0,64],[3,4,[1,1,1,65],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,254,a,[49],a,1,0,32],[1,1,[1],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[3,3,[1,1,1],a,a,1,0,0],[1,1,[1],a,a,2,0,0],[1,1,[2],a,a,1,0,0],[1,1,[1],a,a,32,0,0],[1,1,[2],a,a,1,0,0],[1,1,[1],a,a,1,0,0],[1,3,[2,66,66],a,a,1,0,0],[0,1,[50],a,a,1,16383,32],[0,1,[48],a,a,1,16383,32],[1,1,[16],a,a,2,16383,0],[1,1,[16],a,a,4,0,0],[2,2,[47,575],a,a,303,0,0],[1,3,[1,65,65],a,a,1,0,0],[1,3,[1,65,65],a,a,1,0,0],[1,1,[95],a,a,9,0,0],[1,1,[95],a,a,9,0,0],[2,2,[2,2],a,a,47,0,64],[1,1,[2],a,a,10,0,64],[1,1,[2],a,a,10,0,64],[3,6,[1,48,48,65,65,65],a,a,1,0,0],[3,7,[1,48,48,65,65,65,65],a,a,1,0,0],[2,4,[48,48,65,65],a,a,1,0,0],[3,3,[1,32,32],a,a,1,0,0],[3,6,[48,48,1,65,65,65],a,a,1,0,0],[3,254,[16],[16,15],a,1,0,64],[3,254,[16],[16,15],a,1,0,64],[3,254,[114,68],[114],a,2,0,96],[1,254,a,[114],a,2,0,96],[2,254,a,[44,575],a,831,0,64],[3,254,[47],[575,575],[575],831,0,64],[1,1,[1527],a,a,1503,0,233],[2,254,a,[113,113],a,1,0,33],[1,1,[16],a,a,48,0,41],[2,3,[271,2,4],a,a,303,0,105],[2,2,[271,2],a,a,303,0,97],[2,3,[48,48,111],a,a,303,0,65],[1,4,[160,96,96,4],a,a,32,0,65],[1,3,[160,4,4],a,a,32,0,65],[2,2,[2,256],a,a,1,0,80],[3,3,[2,49,1],a,a,1,0,48],[3,3,[2,49,1],a,a,1,0,48],[2,254,[2],[49],a,1,0,48],[2,7,[34,2,65,65,65,74,68],a,a,1,0,65],[1,3,[2,65,65],a,a,2,0,65],[2,6,[2,34,65,65,65,74],a,a,2,0,65],[2,6,[2,34,65,65,65,74],a,a,2,0,65],[2,6,[2,98,98,68,65,495],a,a,32,0,65],[1,4,[32,96,96,4],a,a,32,0,81],[2,2,[4,16],a,a,32,0,49],[2,4,[391,48,65,65],a,a,1,0,65],[3,6,[391,48,48,511,65,65],a,a,319,0,65],[2,254,[160],[160,65],a,32,0,65],[0,5,[65,65,65,65,68],a,a,32,16383,1],[1,4,[65,65,65,65],a,a,32,0,1],[2,254,[258,1,65,65,65],[65],a,32,0,97],[2,3,[32,1,463],a,a,32,0,65],[1,254,a,[48],a,32,0,33],[1,254,a,[48],a,32,0,33],[2,254,[48],[33],a,32,0,1],[2,254,[48],[33],a,32,0,1],[3,254,a,[319,319],[319],319,0,1],[1,254,a,[319],a,319,0,1],[3,3,[65,65,319],a,a,32,0,1],[1,254,a,[319],a,319,0,1],[1,1,[271],a,a,4,0,1],[1,1,[271],a,a,9,0,1],[0,0,a,a,a,319,0,1],[2,2,[49,49],a,a,9,0,1],[1,2,[399,1],a,a,2,0,65],[1,2,[32,1],a,a,2,0,65],[2,2,[15,2],a,a,256,0,97],[1,3,[48,65,68],a,a,32,0,97],[1,3,[48,65,68],a,a,32,0,97],[2,3,[32,1,463],a,a,32,0,65],[2,254,[48],[319],a,32,0,65],[3,3,[511,48,271],a,a,319,0,65],[3,3,[511,48,271],a,a,32,0,65],[1,2,[48,271],a,a,32,0,65],[1,2,[48,271],a,a,32,0,65],[1,1,[1535],a,a,4,0,65],[2,4,[32,65,65,495],a,a,32,0,65],[2,3,[48,65,65],a,a,48,0,65],[2,3,[48,65,65],a,a,48,0,65],[2,254,[1,1],[447],a,303,0,97],void 0,[1,5,[2,66,65,65,65],a,a,264,0,65],[2,2,[15,2],a,a,271,0,97],[3,7,[112,96,96,65,65,96,96],a,a,32,0,65],[4,10,[112,112,96,96,65,65,96,65,96,96],a,a,32,0,65],[1,1,[2],a,a,264,0,9],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[3,254,[256,2,4],[47],a,303,0,105],[2,254,[256,2],[47],a,303,0,97],[2,3,[2,2,2],a,a,2,0,65],[2,2,[2,1],a,a,2,0,65],[2,2,[2,1],a,a,32,0,65],[2,3,[2,2,4],a,a,4,0,65],[3,5,[2,2,2,1,4],a,a,2,0,65],[2,4,[2,2,1,4],a,a,32,0,65],[0,0,a,a,a,1,0,1],[1,2,[287,2],a,a,288,0,97],[1,2,[1,1],a,a,10,0,97],[0,0,a,a,a,1,0,1],[3,254,[47],[2,47],a,47,0,97],[0,1,[1],a,a,1,0,1],[0,1,[1],a,a,32,0,1],[1,2,[2,1],a,a,47,0,1],[1,1,[1],a,a,264,0,97],[1,1,[1],a,a,264,0,97],[2,2,[2,47],a,a,47,0,1],[1,254,[2],[1151],a,1087,0,96],[1,254,[1],[1151],a,1087,0,0],[1,254,[1],[1151],a,1087,0,0],[1,1,[16],a,a,32,0,1],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[1,1,[256],a,a,2,0,97],[2,2,[256,2],a,a,2,0,97],[1,1,[32],a,a,256,0,97],[3,254,[15],[2,47],a,303,0,97],[1,1,[256],a,a,2,0,97],[4,254,[256,66,66,66],[66,96],a,319,0,1],[1,1,[48],a,a,16,0,97],[3,8,[112,96,96,65,65,96,96,68],a,a,32,0,65],[4,11,[112,112,96,96,65,65,96,65,96,96,65],a,a,32,0,65],[2,2,[2,2],a,a,2,0,65],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,a,[319,319],[319],319,0,1],[3,254,[15],[2,303],a,303,0,97]].map((function(e){return void 0===e?void 0:i.functionType.apply(void 0,e)}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var n=r(0),i=r(50),a=r(32),o=r(40),s=r(224),u=n.__importStar(r(125)),l=r(89),c=r(102),d=i.sheetRows,p=d.toString(10).length,m=i.sheetCols,f=m.toString(26).length,g=m.toString(10).length,h=u.codePointCapitalA,v=u.codePointCapitalZ,S=u.codePointSmallA,y=u.codePointSmallZ,F=u.codePointPlusSign,C=u.codePointMinusSign,R=u.codePointColon;function b(e){return e>=S&&e<=y||e>=h&&e<=v}function E(e){return 1+(e>=S?e-S:e-h)}function P(e,t,r,n){return function(i,a,s,u,d){var p=function(e,t){return(0,l.stringStartsWith)(e,"$",t)?[o.PosKind.Abs,t+1]:[o.PosKind.Rel,t]}(s,u),m=p[0],f=p[1],g=e(i,r,s,f),h=g[0],v=g[1];if(v>f){if(h<1||h>t)return m===o.PosKind.Abs||(!0===n?"object"==typeof d&&d.kind===o.PosKind.Abs||d===N.A1BadDollar:(0,l.stringStartsWith)(s,"$",v))?[N.A1BadDollar,!0,v]:void 0;var S=m===o.PosKind.Rel?h-a:h;return[(0,o.pos)(m,S-1),m===o.PosKind.Abs,v]}return m!==o.PosKind.Abs||!0!==n&&v!==s.length&&i.isNumeral((0,c.stringCodePointAt)(s,v))?[void 0,!1,u]:[N.A1BadDollar,!0,v]}}function k(e,t,r){return x(e,t,r)-e}function T(e,t,r,n){return function(i,a,u,c){var d=t?e?"R":i.rowLetter:e?"C":i.columnLetter;if(c>=u.length||0!==i.stringCompareCI(d,u[c]))return[void 0,!1,c];var p=c+d.length,m=(0,s.parseUint)(i,n,u,p),f=m[0],g=m[1];if(g>p&&f>=1&&f<=r)return[(0,o.pos)(o.PosKind.Abs,f-1),!1,g];if((0,l.stringStartsWith)(u,i.rcLeftBracket,p)){if(p+=i.rcLeftBracket.length,(0,l.stringStartsWith)(u,i.rcRightBracket,p))return[(0,o.pos)(o.PosKind.Rel,k(a,0,r)),!0,p+i.rcRightBracket.length];var h=1,v=u.charCodeAt(p);v===F?p+=1:v===C&&(h=-1,p+=1);var S=(0,s.parseUint)(i,n,u,p),y=S[0],R=S[1];if(R>p&&y<r&&(0,l.stringStartsWith)(u,i.rcRightBracket,R))return[(0,o.pos)(o.PosKind.Rel,k(a,y*h,r)),!0,R+i.rcRightBracket.length]}return[N.RCNoNum,!1,c+d.length]}}function A(e,t,r,n,i,a,o){var s=n(e,t,a,o,void 0);if(null==s)return[void 0,void 0,o];var u=s[0],l=s[1],c=s[2];if(c>o){var d=i(e,r,a,c,u);if(null==d)return l?[u,void 0,c]:[void 0,void 0,o];var p=d[0],m=d[2];return m>c?[u,p,m]:[u,void 0,c]}var f=i(e,r,a,o,u);if(null==f)return[void 0,void 0,o];var g=f[0],h=f[2];return h>o?[void 0,g,h]:[void 0,void 0,o]}var N,_=P(s.parseUint,d,p,!0),I=P((function(e,t,r,n){return function(e,t,r){for(var n=0,i=r,o=(0,a.fastMin)(t.length,r+e);i<o;i+=1){var s=t.charCodeAt(i);if(!b(s))break;n=26*n+E(s)}return i===o&&i<t.length&&b(t.charCodeAt(i))?[0,r]:[n,i]}(t,r,n)}),m,f,!1),O=T(!1,!0,d,p),M=T(!1,!1,m,g),D=T(!0,!0,d,p),w=T(!0,!1,m,g);function L(e,t){return"object"!=typeof e&&"object"!=typeof t}function x(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(N||(t.SpecialPos=N={})),t.isR1C1IdentStart=L,t.parseCellRef=function(e,t,r,n,i){var a=function(e,t,r,n,i){var a=A(e,r.col,r.row,I,_,n,i),s=a[0],u=a[1],l=a[2],d="object"==typeof u&&u.kind===o.PosKind.Abs||u===N.A1BadDollar||"object"==typeof s&&s.kind===o.PosKind.Abs||s===N.A1BadDollar;if(null!=u&&null!=s||d||(null!=u||null!=s)&&(i-1>=0&&n.charCodeAt(i-1)===R||l<n.length&&n.charCodeAt(l)===R)){if(l<n.length&&e.isIdentContinue((0,c.stringCodePointAt)(n,l)))return;if(t!==o.RefStyle.A1&&!d)return;return{refStyle:o.RefStyle.A1,row:u,col:s,i:l}}}(e,t,r,n,i);return void 0!==a?a:function(e,t,r,n,i){var a,s=r.col,u=r.row,l=!1,d=A(e,u,s,O,M,n,i),p=d[0],m=d[1],f=d[2];if(null!=p||null!=m||"R"===e.rowLetter&&"C"===e.columnLetter||(l=!0,p=(a=A(e,u,s,D,w,n,i))[0],m=a[1],f=a[2]),(null!=p||null!=m)&&(f>=n.length||!L(p,m)||!e.isIdentContinue((0,c.stringCodePointAt)(n,f))))return{refStyle:o.RefStyle.R1C1,row:p,col:m,i:f,enLocale:l}}(e,0,r,n,i)},t.parseGridCellA1=function(e,t){var r=A(e,0,0,I,_,t,0),n=r[0],a=r[1],o=r[2];return"object"==typeof n&&"object"==typeof a&&o===t.length?(0,i.gridCell)(a.index,n.index):void 0},t.parseGridRangeA1=function(e,t){var r=A(e,0,0,I,_,t,0),n=r[0],o=r[1],s=r[2];if("object"==typeof n&&"object"==typeof o){if(s===t.length)return(0,i.gridCell)(o.index,n.index);if(t.charCodeAt(s)===R){var u=A(e,0,0,I,_,t,s+1),l=u[0],c=u[1],d=u[2];if("object"==typeof l&&"object"==typeof c&&d===t.length){var p=(0,a.fastMin)(o.index,c.index),m=(0,a.fastMin)(n.index,l.index);return(0,i.gridRange)(p,m,(0,a.fastMax)(o.index,c.index)+1-p,(0,a.fastMax)(n.index,l.index)+1-m)}}}},t.parseQualifier=function(e){var t=e.lastIndexOf("!");if(!(t<0||0===t||t===e.length-1)){var r=e.substring(0,t),n=e.substring(t+1);if(r.indexOf("'")<0)return{qualifier:r,unqualified:n};if((0,l.stringStartsWith)(r,"'")&&(0,l.stringEndsWith)(r,"'")){for(var i=[],a=1;a<r.length-1;++a){var o=r.charAt(a);if("'"===o){if(a+1>=r.length-1||"'"!==r.charAt(a+1))return;i.push(o),++a}else i.push(o)}return{qualifier:i.join(""),unqualified:n}}}},t.wrapPosition=x},function(e,t,r){"use strict";var n,i,a,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0,function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(n||(t.CurrencyFormat=n={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(i||(t.DateOrder=i={})),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(a||(t.NumberShape=a={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"}(o||(t.Calendar=o={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.USCoCurrency=-37]="USCoCurrency",e[e.USCoCurrencyDec=-39]="USCoCurrencyDec",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text"}(s||(t.KnownFormat=s={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=void 0;var n=r(32),i=r(32),a=r(42),o=r(124),s=r(40),u=r(61),l=r(61),c=r(50),d=r(50),p=r(88),m=r(103),f=r(103),g=r(223);function h(e){return(0,p.isSuccess)(e)&&(0,i.isNone)(e.value)?p.successUndefined:e}function v(e){return!(0,p.isSuccess)(e)||void 0===e.value}var S=function(e){return e.rhs.field.kind===s.NodeKind.Ident},y=function(e){return e.rhs.field.whole},F=function(e,t){return(0,s.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel)};function C(e,t){var r=t[0],n=t.slice(1);return r.kind===s.NamePartKind.IdentNamePart&&null==e&&n.every(S)}function R(e,t,r){return r.canDenoteNamedObject&&e&&(void 0===t||t.kind===s.QualifierKind.Document||t.kind===s.QualifierKind.Ident)}function b(e,t,r){var n=r[0],i=r.slice(1);return n.kind===s.NamePartKind.CellRefNamePart&&(null==t&&e.allowUnqualifiedCell||null!=t&&t.kind!==s.QualifierKind.Document)&&i.every(S)}function E(e,t,r,n,i){return r.kind===s.PosKind.Abs?(0,p.success)(r.index):(0,p.isSuccess)(e)?(0,p.success)((0,o.resolvePosition)(t(e.value),r,n,i)):e}t.canDenoteLocalName=C,t.canDenoteUserDefinedFunc=R,t.canDenoteCellRef=b;var P=function(e){return e.row},k=function(e){return e.col};function T(e,t,r){var n=E(e,P,t.row,d.sheetRows,r),i=E(e,k,t.col,d.sheetCols,r);return(0,p.isSuccess)(n)?(0,p.isSuccess)(i)?void 0===n.value||void 0===i.value?p.successUndefined:(0,p.success)((0,d.gridCell)(n.value,i.value)):i:n}function A(e,t){if(t.kind===s.CellRefKind.Error)return p.successUndefined;var r=e.originGridCell,n=e.wrapCellReferences;switch(t.kind){case s.CellRefKind.Single:return T(r,t,n);case s.CellRefKind.Range:var i=T(r,t.ref1,n),o=T(r,t.ref2,n);return(0,p.isSuccess)(i)?(0,p.isSuccess)(o)?void 0===i.value||void 0===o.value?p.successUndefined:(0,p.success)((0,l.gridCellRange)(i.value,o.value)):o:i;case s.CellRefKind.Row:var u=E(r,P,t.row1,d.sheetRows,n),c=E(r,P,t.row2,d.sheetRows,n);return(0,p.isSuccess)(u)?(0,p.isSuccess)(c)?void 0===u.value||void 0===c.value?p.successUndefined:(0,p.success)((0,l.gridCellRange)((0,d.gridCell)(u.value,0),(0,d.gridCell)(c.value,d.sheetCols-1))):c:u;case s.CellRefKind.Col:var m=E(r,k,t.col1,d.sheetCols,n),g=E(r,k,t.col2,d.sheetCols,n);return(0,p.isSuccess)(m)?(0,p.isSuccess)(g)?void 0===m.value||void 0===g.value?p.successUndefined:(0,p.success)((0,l.gridCellRange)((0,d.gridCell)(0,m.value),(0,d.gridCell)(d.sheetRows-1,g.value))):g:m;case s.CellRefKind.Bad:return(0,p.failure)((0,f.invalidCellRef)(f.InvalidCellRefReason.BadCellRef));default:return(0,a.assertNever)("calc.lang.Resolver.resolveGridRef",t)}}t.resolveGridRef=A,t.createResolver=function(e){function t(t,r){if(void 0===r){var n=t.originSheet;return(0,p.isSuccess)(n)?[r,(0,p.success)(n.value.document)]:[r,n]}var a=e.getDocumentLoc(r.path,r.document);if(!(0,p.isSuccess)(a))return[r,a];if((0,i.isNone)(a.value))return[r,(0,p.failure)((0,f.invalidQualifier)(f.InvalidQualifierReason.UndefinedDocument))];var o=null==r.path?void 0:a.value.path,u=a.value.name;return[(0,s.documentQualifier)(u,o,r.isQuoted,r.label),(0,p.success)(a.value)]}function r(t,r){if(v(r))return[t,r];var n=h(e.getSheetIndex(r.value,t));if(!(0,p.isSuccess)(n))return[t,n];if((0,i.isNone)(n.value))return[t,(0,p.failure)((0,f.invalidQualifier)(f.InvalidQualifierReason.UndefinedSheetName))];var a=e.getSheetName(r.value,n.value);return(0,p.isSuccess)(a)?[a.value,(0,p.success)((0,d.sheetIndex)(r.value,n.value))]:[t,a]}function o(e,n){var i=t(e,n.document),a=i[0],o=i[1],u=r(n.sheet,o),l=u[0],c=u[1];return[(0,s.sheetQualifier)(l,a,n.isQuoted,n.label),c]}function S(n,i){switch(i.kind){case s.QualifierKind.Error:return[i,p.successUndefined];case s.QualifierKind.Sheet:return o(n,i);case s.QualifierKind.SheetRange:return function(n,i){var a,o=t(n,i.document),u=o[0],c=o[1],m=r(i.sheet1,c),f=m[0],g=m[1],h=r(i.sheet2,c),S=h[0],y=h[1],F=f,C=S;if(v(c))a=c;else if(v(g))a=g;else if(v(y))a=y;else{if((0,l.isSheetIndexEqual)(g.value,y.value))return[(0,s.sheetQualifier)(F,u,i.isQuoted,i.label),(0,p.success)((0,d.sheetIndex)(c.value,g.value.index))];var R=e.getSheetRangeIndexes(g.value),b=e.getSheetRangeIndexes(y.value);(0,p.isSuccess)(R)?(0,p.isSuccess)(b)?b.value.position<R.value.position&&(F=S,C=f):a=b:a=R,a=(0,p.success)((0,d.sheetRange)(c.value,g.value.index,y.value.index))}return[(0,s.sheetRangeQualifier)(F,C,u,i.isQuoted,i.label),a]}(n,i);case s.QualifierKind.Document:return[i,(0,p.failure)((0,f.invalidQualifier)(f.InvalidQualifierReason.SheetRangeName))];case s.QualifierKind.Bad:return[i,(0,p.failure)((0,f.invalidQualifier)(f.InvalidQualifierReason.BadQualifier))];default:return(0,a.assertNever)("calc.lang.Resolver.resolveCellRefQualifier",i)}}function E(e,t){var r,n,i,a,o=t.qualifier,u=t.ref,l=A(e,u);if(void 0===o||o.kind===s.QualifierKind.Relative){n=o;var c=e.originSheet;if((0,p.isSuccess)(c)){var m=c.value;i=void 0===m.index?(0,p.failure)((0,f.noOriginSheet)(m)):(0,p.success)(m)}else i=c}else n=(r=S(e,o))[0],i=r[1];return a=v(l)?l:v(i)?i:(0,p.success)((0,d.sheetGridCube)(i.value,l.value)),(0,f.resolvedCellRef)((0,s.cellRefNode)(u,n,t.label),a)}function P(r,n,i){var u,l,m,g,S,y,F=n.qualifier,C=n.parts,R=[];if(void 0===F||F.kind===s.QualifierKind.Relative){var b=r.originSheet;if(!(0,p.isSuccess)(b))return(0,f.resolvedName)(n,b,null===(l=n.qualifier)||void 0===l?void 0:l.kind,R);var E=b.value;if(i!==d.NameSource.StructRef&&void 0===E.index)return(0,f.resolvedName)(n,(0,p.failure)((0,f.noOriginSheet)(E)),null===(m=n.qualifier)||void 0===m?void 0:m.kind,R);g=F,y=null==F?void 0:F.kind,S=(0,p.success)(E)}else g=(u=function(e,r){switch(r.kind){case s.QualifierKind.Document:var n=t(e,r),i=n[0],u=n[1];return[i,i.kind,v(u)?u:(0,p.success)((0,d.documentScope)(u.value))];case s.QualifierKind.Sheet:var l=o(e,r),c=l[0],m=l[1];return[c,c.kind,m];case s.QualifierKind.SheetRange:return[r,r.kind,(0,p.failure)((0,f.invalidQualifier)(f.InvalidQualifierReason.SheetRangeName))];case s.QualifierKind.Ident:var g=o(e,(0,s.sheetQualifier)(r.name,void 0,r.isQuoted,r.label));c=g[0],m=g[1];if(!(0,p.isSuccess)(m)&&m.reason.kind!==f.ResolveReasonKind.InvalidQualifier)return[r,r.kind,m];if((0,p.isSuccess)(m)&&void 0!==m.value)return[(0,s.identQualifier)(c.sheet,c.isQuoted,c.label),c.kind,m];var h=t(e,(0,s.documentQualifier)(r.name,void 0,r.isQuoted,r.label));i=h[0];return v(u=h[1])?[r,r.kind,u]:[(0,s.identQualifier)(i.document,i.isQuoted,i.label),i.kind,(0,p.success)((0,d.documentScope)(u.value))];case s.QualifierKind.Bad:return[r,r.kind,(0,p.failure)((0,f.invalidQualifier)(f.InvalidQualifierReason.BadQualifier))];default:return(0,a.assertNever)("calc.lang.Resolver.resolveNameQualifier",r)}}(r,F))[0],y=u[1],S=u[2];i===d.NameSource.StructRef&&(0,p.isSuccess)(S)&&void 0!==S.value.index&&(S=(0,p.success)((0,d.documentScope)(S.value.document)));var P,k=C;return v(S)?P=S:(R.push((0,c.nameLoc)(S.value,C.asWhole)),P=h(e.getNameLoc(S.value,C.asWhole,i)),(0,p.isSuccess)(P)&&void 0===P.value&&void 0!==S.value.index&&(S=(0,p.success)((0,d.documentScope)(S.value.document)),R.push((0,c.nameLoc)(S.value,C.asWhole)),P=h(e.getNameLoc(S.value,C.asWhole,i))),v(P)||(k=(0,s.identNamePart)(P.value.name,C.canDenoteNamedObject,C.label,C.qualifiedLabel))),(0,f.resolvedName)((0,s.nameNode)(k,g,n.label),P,y,R)}function k(t,r,n){void 0===n&&(n=!1);var a=e.getStructRefColumn(t,r.name);if(!(0,p.isSuccess)(a))return{kind:s.StructRefKind.ColumnRef,innerRef:r,resolution:a};var o=a.value;if((0,i.isNone)(o))return{kind:s.StructRefKind.ColumnRef,innerRef:r,resolution:(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.UndefinedColumnName))};var u=o.range.range;return n&&(u=(0,d.gridRange)(u.row-(o.hasHeadersRow?1:0),u.col,u.rows+(o.hasHeadersRow?1:0)+(o.hasTotalsRow?1:0),u.cols)),{kind:s.StructRefKind.ColumnRef,innerRef:(0,s.columnRef)(o.name,r.isBracketed,r.isClosed,r.label),resolution:(0,p.success)((0,d.sheetGridRange)(o.range.sheet,u))}}function T(t,r,n){if(n===s.SpecialRefId.ThisRow){if(!(0,p.isSuccess)(t.originGridCell))return t.originGridCell;var i=T(t,r,s.SpecialRefId.Data);if(v(i))return i;var a=i.value.range,o=t.originGridCell.value.row;return o<a.row||o>=a.row+a.rows?(0,p.failure)(f.emptyIntersection):(0,p.success)((0,d.sheetGridRange)(i.value.sheet,(0,d.gridRange)(o,a.col,1,a.cols)))}return h(e.getStructRefSpecialRef(r,n))}function N(e,t,r){switch(t.kind){case s.StructRefKind.ColumnRef:return k(e,t,r);case s.StructRefKind.MissingRef:return{kind:s.StructRefKind.MissingRef,innerRef:t,resolution:p.successUndefined}}}function _(e,t,r){var n;void 0===r&&(r=!1);var i,a,o=N(e,t.lhs,r),u=o.innerRef,c=o.resolution,m=N(e,t.rhs,r),g=m.innerRef,h=m.resolution,v=(0,s.rangeOpRef)(u,g,t.label);if(!(0,p.isSuccess)(c)&&c.reason.kind!==f.ResolveReasonKind.InvalidStructRef)return{kind:s.StructRefKind.RangeOpRef,innerRef:v,resolution:c};if(!(0,p.isSuccess)(h)&&h.reason.kind!==f.ResolveReasonKind.InvalidStructRef)return{kind:s.StructRefKind.RangeOpRef,innerRef:v,resolution:h};if(!(0,p.isSuccess)(c))return{kind:s.StructRefKind.RangeOpRef,innerRef:v,resolution:c};if(!(0,p.isSuccess)(h))return{kind:s.StructRefKind.RangeOpRef,innerRef:v,resolution:h};if(void 0!==c.value)i=c.value.sheet,a=(0,l.gridRangeJoinOpt)(c.value.range,null===(n=h.value)||void 0===n?void 0:n.range);else{if(void 0===h.value)return{kind:s.StructRefKind.RangeOpRef,innerRef:v,resolution:(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.InvalidOp))};i=h.value.sheet,a=h.value.range}return{kind:s.StructRefKind.RangeOpRef,innerRef:v,resolution:(0,p.success)((0,d.sheetGridRange)(i,a))}}function I(r,n){var i,o,l,d,m,g,h,S=n.qualifier,y=n.parts,F=null!==(l=null===(o=r.config)||void 0===o?void 0:o.localeInfo)&&void 0!==l?l:e.config.localeInfo;if(void 0===S){var C=r.originSheet;if(!(0,p.isSuccess)(C))return(0,f.resolvedUserDefinedFunc)(n,C,[],y.asWhole);d=S,m=(0,p.success)(C.value.document)}else d=(i=function(e,r){switch(r.kind){case s.QualifierKind.Document:return t(e,r);case s.QualifierKind.Ident:var n=t(e,(0,s.documentQualifier)(r.name,void 0,r.isQuoted,r.label)),i=n[0],o=n[1];return[(0,s.identQualifier)(i.document,i.isQuoted,i.label),o];default:return(0,a.assertNever)("calc.lang.Resolver.resolveUserDefinedFuncQualifier",r)}}(r,S))[0],m=i[1];var R=y.asWhole;if(v(m))h=m,g=[];else{R=(0,u.getUserDefinedFuncName)(F,y.asWhole);var b=e.getUserDefinedFuncLoc(m.value,R);g=[(0,c.userDefinedFuncLoc)(m.value,R)],h=(0,p.isSuccess)(b)?0!==b.value.length?b:p.successUndefined:b}return(0,f.resolvedUserDefinedFunc)((0,s.nameNode)((0,s.identNamePart)(R,y.canDenoteNamedObject,y.label,y.qualifiedLabel),d,n.label),h,g,R)}return{resolveGridRef:A,resolveCellRef:E,resolveName:P,resolveStructRef:function(t,r){var n,a,o=r.lhs,u=r.rhs,c=o;if(void 0!==o){var m=P(t,o,d.NameSource.StructRef),g=m.node,h=m.resolution,S=m.precedents,y=h;if(!(0,p.isSuccess)(y))return(0,f.resolvedStructRef)(r,void 0,y,S);if((0,i.isNone)(y.value))return(0,f.resolvedStructRef)(r,void 0,(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.UndefinedTableName)),S);c=g,n=y.value,a=S}else{var F=t.originGridCell,C=t.originSheet;if(!(0,p.isSuccess)(F))return(0,f.resolvedStructRef)(r,void 0,F,[]);if(!(0,p.isSuccess)(C))return(0,f.resolvedStructRef)(r,void 0,C,[]);if(void 0===C.value.index)return(0,f.resolvedStructRef)(r,void 0,(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.InvalidOriginSheet)),[]);y=e.getContainingTable((0,d.sheetGridCell)(C.value,F.value));if(!(0,p.isSuccess)(y))return(0,f.resolvedStructRef)(r,void 0,y,[]);if((0,i.isNone)(y.value))return(0,f.resolvedStructRef)(r,void 0,(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.MissingTableName)),[]);a=[n=y.value]}var R=function(e,t,r){var n;switch(null===(n=r.innerRef)||void 0===n?void 0:n.kind){case s.StructRefKind.ColumnRef:var i=k(t,r.innerRef),a=i.innerRef,o=i.resolution;return{structRef:(0,s.structRef)(a,r.isClosed,r.label),resolution:o};case s.StructRefKind.RangeOpRef:var u=_(t,r.innerRef);a=u.innerRef,o=u.resolution;return{structRef:(0,s.structRef)(a,r.isClosed,r.label),resolution:o};case void 0:o=T(e,t,s.SpecialRefId.Data);return{structRef:r,resolution:o};case s.StructRefKind.SpecialRef:o=T(e,t,r.innerRef.id);return{structRef:r,resolution:o};case s.StructRefKind.CommaOpRef:var c=function(e,t,r){for(var n,i,a=r.refs.map((function(r){return function(e,t,r){switch(r.kind){case s.StructRefKind.ColumnRef:return k(t,r,!0);case s.StructRefKind.SpecialRef:return{kind:s.StructRefKind.SpecialRef,innerRef:r,resolution:T(e,t,r.id)};case s.StructRefKind.RangeOpRef:return _(t,r,!0);case s.StructRefKind.MissingRef:return{kind:s.StructRefKind.MissingRef,innerRef:r,resolution:p.successUndefined};case s.StructRefKind.BadRef:return{kind:s.StructRefKind.BadRef,innerRef:r,resolution:(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.InvalidOp))}}}(e,t,r)})),o=(0,s.commaOpRef)(a.map((function(e){return e.innerRef})),r.label),u=0,c=a;u<c.length;u++){var m=c[u].resolution;if(!(0,p.isSuccess)(m)&&m.reason.kind!==f.ResolveReasonKind.InvalidStructRef)return{commaOpRef:o,resolution:m}}for(var g,h,v=[],S=0,y=a;S<y.length;S++){var F=y[S];if(!(0,p.isSuccess)(F.resolution)||F.kind===s.StructRefKind.BadRef)return{commaOpRef:o,resolution:F.resolution};v.push((F.kind===s.StructRefKind.SpecialRef||(F.kind,s.StructRefKind.MissingRef),{kind:F.kind,resolution:F.resolution}))}if(!(0,l.isCommaOpRefWellFormed)(r))return{commaOpRef:o,resolution:(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.InvalidOp))};for(var C=0,R=v;C<R.length;C++){(F=R[C]).kind===s.StructRefKind.SpecialRef&&(g=(0,l.gridRangeJoinOpt)(g,null===(n=F.resolution.value)||void 0===n?void 0:n.range),void 0===h&&(h=null===(i=F.resolution.value)||void 0===i?void 0:i.sheet))}if(void 0===g||void 0===h)return{commaOpRef:o,resolution:p.successUndefined};for(var b=0,E=v;b<E.length;b++){if((F=E[b]).kind!==s.StructRefKind.SpecialRef&&(F.kind!==s.StructRefKind.MissingRef&&void 0===(g=(0,l.gridRangeIsect)(g,F.resolution.value.range))))return{commaOpRef:o,resolution:(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.InvalidOp))}}return{commaOpRef:o,resolution:(0,p.success)((0,d.sheetGridRange)(h,g))}}(e,t,r.innerRef);a=c.commaOpRef,o=c.resolution;return{structRef:(0,s.structRef)(a,r.isClosed,r.label),resolution:o};case s.StructRefKind.ThisRowOpRef:var m=T(e,t,s.SpecialRefId.ThisRow);if(v(m)||void 0===r.innerRef.ref)return{structRef:r,resolution:m};var g=r.innerRef.ref.kind===s.StructRefKind.ColumnRef?k(t,r.innerRef.ref):_(t,r.innerRef.ref),h=(a=g.innerRef,g.resolution),S=(0,s.thisRowOpRef)(a,a.label);if(v(h))return{structRef:(0,s.structRef)(S,r.isClosed,r.label),resolution:h};var y=(0,l.gridRangeIsect)(m.value.range,h.value.range);return y?{structRef:(0,s.structRef)(S,r.isClosed,r.label),resolution:(0,p.success)((0,d.sheetGridRange)(m.value.sheet,y))}:{structRef:r,resolution:(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.InvalidOp))};case s.StructRefKind.BadRef:return{structRef:r,resolution:(0,p.failure)((0,f.invalidStructRef)(f.InvalidStructRefReason.InvalidOp))}}}(t,n,u),b=R.structRef,E=R.resolution;return(0,f.resolvedStructRef)(E.kind===p.ResultKind.Failure&&E.reason.kind!==f.ResolveReasonKind.EmptyIntersection?r:(0,s.structRefNode)(c,b,r.label),n,E,a)},resolveUserDefinedFunc:I,resolveDottedName:function(t,r,i){var o,l=r.parts,c=r.qualifier,h={names:new Array,udfs:new Array},v=i[r.label],S=(null==v?void 0:v.kind)===s.AnnotationKind.AppHeadName,k=(0,s.flattenNameParts)(l).parts,T=(0,s.nameNode)((0,s.identNamePart)(l.asWhole,l.canDenoteNamedObject,l.label,l.qualifiedLabel),c,r.label);if(C(c,k)){var A=k[0],N=k.slice(1),_=function(e,t){var r,n=t[e.label],i=(null==n?void 0:n.kind)===s.AnnotationKind.LocalNameUse?n:void 0;return(0,f.resolvedLocalName)((0,s.nameNode)((0,s.identNamePart)(null!==(r=null==i?void 0:i.name)&&void 0!==r?r:e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,p.success)(i))}(A,i);if(void 0!==_.resolution.value)return(0,f.resolvedDottedName)((0,s.nameNode)(N.reduce(F,_.node.parts),c,r.label),_,N.map(y),h)}var O=function(){if(!o)return!1;var e=o.headResolved.resolution;return e.kind!==p.ResultKind.Success&&e.reason.kind!==f.ResolveReasonKind.InvalidQualifier||e.kind===p.ResultKind.Success&&void 0!==e.value};if(l.canDenoteNamedObject){var M=P(t,T,S?d.NameSource.AppHead:d.NameSource.Plain);if((0,n.safePush)(h.names,M.precedents),o=(0,f.resolvedDottedName)(M.node,M,[],h),O())return o}if(R(S,c,l)){var D=I(t,T);if((0,n.safePush)(h.udfs,D.precedents),o=(0,f.resolvedDottedName)(D.node,D,[],h),O())return o}if(b(t,c,k)){A=k[0],N=k.slice(1);var w=null!=c&&c.kind===s.QualifierKind.Ident?(0,s.sheetQualifier)(c.name,void 0,c.isQuoted,c.label):c,L=E(t,(0,s.cellRefNode)(A.ref,w,A.qualifiedLabel)),x=L.node.qualifier;return(0,a.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't generate ErrorQualifier",(null==x?void 0:x.kind)!==s.QualifierKind.Error),(0,a.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't touch ref",L.node.ref===A.ref),o=(0,f.resolvedDottedName)((0,s.nameNode)(l,x,r.label),L,N.map(y),h)}if((0,u.isUnqualifiedNameNode)(r)&&(0,g.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,g.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){var K=function(t,r){var n,i,a=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,o=(0,u.getEtaFuncId)(a,r.whole),l=r.parts;return(0,m.resolvedWorksheetFunc)((0,s.nameNode)((0,s.identNamePart)(void 0!==o?a.getWorksheetFuncName(o):l.asWhole,l.canDenoteNamedObject,l.label,l.qualifiedLabel),void 0,l.qualifiedLabel),(0,p.success)(o))}(t,r);if(void 0!==K.resolution.value)return(0,f.resolvedDottedName)(K.node,K,[],h)}return void 0!==o?o:(0,f.resolvedDottedName)(r,(0,f.resolvedNever)(T),[],h)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0;var n=void 0;t.setLocale=function(e){n=e};t.Base_LocaleIsNumeral=function(e){return n.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return n.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=n.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.isSupported=function(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=t.resolveGridRef=t.createResolver=void 0;var n=r(3);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef,t.canDenoteLocalName=n.resolveService.canDenoteLocalName,t.canDenoteUserDefinedFunc=n.resolveService.canDenoteUserDefinedFunc,t.canDenoteCellRef=n.resolveService.canDenoteCellRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var n=r(3);t.createSimplePrintGlobals=n.printServiceTypes.createSimplePrintGlobals,t.printLocalsGrid=n.printServiceTypes.printLocalsGrid,t.printLocalsName=n.printServiceTypes.printLocalsName},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var n=r(3);t.anonymizeFormula=n.printService.anonymizeFormula,t.createPrinter=n.printService.createPrinter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;var n=r(3);t.xlMathpack=n.mathpackXL.xlMathpack},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.convertDiagnosticToNLMessage=t.baseNLErrors=t.formatDiagnostic=t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0;var a,o,s,u=r(238),l=r(81);!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Missing_struct_ref_table_name="Missing_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(a||(t.SyntaxError=a={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(o||(t.TypeError=o={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(s||(t.TypeSourceKind=s={})),t.baseErrors=((n={})[a.Unclosed_application]={kind:a.Unclosed_application},n[a.Unclosed_paren]={kind:a.Unclosed_paren},n[a.Unclosed_bracket]={kind:a.Unclosed_bracket},n[a.Unclosed_array]={kind:a.Unclosed_array},n[a.Unclosed_literal]={kind:a.Unclosed_literal},n[a.Unclosed_comment]={kind:a.Unclosed_comment},n[a.Invalid_number_literal]={kind:a.Invalid_number_literal},n[a.Invalid_string_literal]={kind:a.Invalid_string_literal},n[a.Invalid_error_literal]={kind:a.Invalid_error_literal},n[a.Invalid_function_name]={kind:a.Invalid_function_name},n[a.Invalid_name]={kind:a.Invalid_name},n[a.Illegal_array_literal_element]={kind:a.Illegal_array_literal_element},n[a.Empty_array_literal]={kind:a.Empty_array_literal},n[a.Irregular_array_shape]={kind:a.Irregular_array_shape},n[a.Empty_parenthesis]={kind:a.Empty_parenthesis},n[a.Bad_node]={kind:a.Bad_node},n[a.Invalid_qualifier]={kind:a.Invalid_qualifier},n[a.Invalid_cell_ref]={kind:a.Invalid_cell_ref},n[a.Invalid_binder]={kind:a.Invalid_binder},n[a.Missing_binder]={kind:a.Missing_binder},n[a.Duplicate_binder]={kind:a.Duplicate_binder},n[a.Invalid_body]={kind:a.Invalid_body},n[a.Mandatory_binder_after_optional]={kind:a.Mandatory_binder_after_optional},n[a.Missing_default_expression]={kind:a.Missing_default_expression},n[a.Binder_requires_brackets]={kind:a.Binder_requires_brackets},n[a.Invalid_field_name]={kind:a.Invalid_field_name},n[a.Missing_field_name]={kind:a.Missing_field_name},n[a.Empty_formula]={kind:a.Empty_formula},n[a.Invalid_rel_sheet_qualifier_in_cell]={kind:a.Invalid_rel_sheet_qualifier_in_cell},n[a.Invalid_rel_sheet_qualifier_in_name]={kind:a.Invalid_rel_sheet_qualifier_in_name},n[a.Invalid_unqualified_cell]={kind:a.Invalid_unqualified_cell},n[a.Unexpected_closing_paren]={kind:a.Unexpected_closing_paren},n[a.Unexpected_closing_brace]={kind:a.Unexpected_closing_brace},n[a.Unexpected_closing_bracket]={kind:a.Unexpected_closing_bracket},n[a.Unexpected_field_ref]={kind:a.Unexpected_field_ref},n[a.Unexpected_dot]={kind:a.Unexpected_dot},n[a.Invalid_struct_ref_table_name]={kind:a.Invalid_struct_ref_table_name},n[a.Missing_struct_ref_table_name]={kind:a.Missing_struct_ref_table_name},n[a.Invalid_struct_ref_comma_parts]={kind:a.Invalid_struct_ref_comma_parts},n[a.Invalid_struct_ref_missing_part]={kind:a.Invalid_struct_ref_missing_part},n[a.Invalid_struct_ref_bad_part]={kind:a.Invalid_struct_ref_bad_part},n[o.Unexpected_application_head]={kind:o.Unexpected_application_head},n[o.Unexpected_application_head_with_fix]={kind:o.Unexpected_application_head_with_fix},n),t.formatDiagnostic=function(e){switch(e.kind){case o.Insufficient_function_arguments:case o.Excess_function_arguments:return"".concat(e.kind,": ").concat((0,u.englishWorksheetFuncIdToName)(e.funcId));case a.Missing_operation_argument:case o.Incorrect_number_of_operator_arguments:return"".concat(e.kind,": ").concat((0,u.englishOperatorIdToName)(e.opId));case a.Unexpected_character:return"".concat(e.kind,": ").concat((0,l.anonymizeFormulaString)(e.text));case o.Types_not_related:return"".concat(e.kind,": ").concat(function(e){var t=e.kind,r=e.argIndex;switch(e.kind){case s.WSFArgument:return JSON.stringify({kind:t,funcId:(0,u.englishWorksheetFuncIdToName)(e.funcId),argIndex:r});case s.OperatorArgument:return JSON.stringify({kind:t,opId:(0,u.englishOperatorIdToName)(e.opId),argIndex:r})}}(e.typeSource));default:return e.kind}};var c="The formulas has an error";t.baseNLErrors=((i={})[a.Unclosed_application]="The formula is missing a parenthesis",i[a.Unclosed_paren]="The formula is missing a parenthesis",i[a.Unclosed_bracket]="The formula is missing a bracket",i[a.Unclosed_array]="The formula is missing a brace",i[a.Unclosed_literal]="The formula is missing a quote",i[a.Unclosed_comment]="The formula comment is missing an end",i[a.Invalid_number_literal]="The formula has an invalid number",i[a.Invalid_string_literal]="The formula has an invalid string",i[a.Invalid_error_literal]="The formula has an invalid value",i[a.Invalid_function_name]="The formula has an invalid function name",i[a.Invalid_name]="The formula has an invalid name",i[a.Illegal_array_literal_element]="The formula has an invalid value",i[a.Empty_array_literal]="The formula has an empty array",i[a.Irregular_array_shape]="The formula has an incorrectly shaped array",i[a.Empty_parenthesis]="The formula is missing values between parentheses",i[a.Missing_operation_argument]="The formula has an extra operator",i[a.Bad_node]=c,i[a.Invalid_qualifier]="The formula has an invalid sheet reference",i[a.Invalid_cell_ref]="The formula has an invalid cell reference",i[a.Invalid_binder]=c,i[a.Missing_binder]=c,i[a.Duplicate_binder]=c,i[a.Invalid_body]=c,i[a.Mandatory_binder_after_optional]=c,i[a.Missing_default_expression]=c,i[a.Binder_requires_brackets]=c,i[a.Invalid_field_name]="The formula has an invalid field name",i[a.Missing_field_name]="The formula is missing a field name",i[a.Empty_formula]="The formula is empty",i[a.Invalid_rel_sheet_qualifier_in_cell]="The formula has an incorrect reference",i[a.Invalid_rel_sheet_qualifier_in_name]="The formula has an incorrect reference",i[a.Invalid_unqualified_cell]="The formula has an incorrect reference",i[a.Unexpected_closing_paren]="The formula has an extra parenthesis",i[a.Unexpected_closing_brace]="The formula has an extra brace",i[a.Unexpected_closing_bracket]="The formula has an extra bracket",i[a.Unexpected_character]="The formula has some extra characters",i[a.Unexpected_field_ref]="The formula has an extra field",i[a.Unexpected_dot]="The formula has an extra dot",i[a.Invalid_struct_ref_table_name]="The formula has a malformed table name in a structured reference",i[a.Missing_struct_ref_table_name]="The formula is missing the table name in a structured reference",i[a.Invalid_struct_ref_comma_parts]="The formula has a structured reference with commas that has issues between its brackets",i[a.Invalid_struct_ref_missing_part]="The formula has a structured reference with missing references between its brackets",i[a.Invalid_struct_ref_bad_part]="The formula has a bad reference in a structured reference",i[a.Excess_higher_order_function_arguments]="The formula has a function call with too many arguments",i[o.Types_not_related]="The formula has an operation using data that cannot be mixed together",i[o.Unexpected_application_head]="The formula has a malformed function call",i[o.Unexpected_application_head_with_fix]="The formula has a malformed function call",i[o.Incorrect_number_of_operator_arguments]="The formula has an operation with the wrong number of arguments",i[o.Excess_function_arguments]="The formula has a function call with too many arguments",i[o.Insufficient_function_arguments]="The formula has a function call with missing arguments",i),t.convertDiagnosticToNLMessage=function(e){return t.baseNLErrors[e.kind]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=t.resolveGridRef=t.createResolver=void 0;var n=r(3);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef,t.canDenoteLocalName=n.resolveService.canDenoteLocalName,t.canDenoteUserDefinedFunc=n.resolveService.canDenoteUserDefinedFunc,t.canDenoteCellRef=n.resolveService.canDenoteCellRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(3);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;var n=r(0),i=r(33),a=r(52),o=r(63),s=r(91),u=r(73),l=r(58),c=r(43),d=r(90),p=n.__importStar(r(108)),m=p.codePointQuestionMark,f=p.codePointBackslash,g=p.codePointUnderscore;function h(e,t){if(0===t.length)return!1;var r,n=(0,d.stringCodePointAt)(t,0);return!((r=n)===g||r===f||!e.isIdentStart(r)&&!e.isNumeral(r))&&(0,d.codePointIterator)(t,(0,d.numCodeUnits)(n)).every((function(t){return t!==m&&t!==f&&e.isIdentContinue(t)}))}t.isUnbracketedField=h;var v=(0,o.take)((function(e,t){return(0,l.isBracketToken)(t)||t.kind===a.TokenKind.Escape||t.kind===a.TokenKind.End?void 0:t.chars})),S=(0,o.take)((function(e,t){return t.kind!==a.TokenKind.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars})),y=(0,o.any)(v,(0,o.right)(l.parseEscape,S)),F=(0,o.apply)((0,o.tuple)((0,o.many)(y),l.parseEnd),(function(e,t){var r=t[0];t[1];return r.join("")})),C=(0,o.applyTake)(l.parseBracketedTokens,(function(e,t){var r=t[0],n=t[1],a=(0,o.runParser)(F,r,0,e);if((0,c.isSuccess)(a)){var s=r[0].start,l=r[r.length-1].start,d=a.value.output;if(d.length>255){var p=r.map((function(e){return e.chars})).join("");return[(0,i.badCharsNode)(i.BadType.FieldName,p,(0,u.addSpan)(e,s,l,"","")),!1,!0]}return[(0,i.identNode)(d,(0,u.addSpan)(e,s,l,"","")),!0,n]}})),R=(0,o.apply)(l.parseIdentContinue,(function(e,t){var r=t.start,n=t.start+t.chars.length;return!h(e.localeInfo,t.chars)||t.chars.length>255?[(0,i.badCharsNode)(i.BadType.FieldName,t.chars,(0,u.addSpan)(e,r,n,"","")),!1,!0]:[(0,i.identNode)(t.chars,(0,u.addSpan)(e,r,n,"","")),!1,!0]}));t.parseFieldRef=(0,o.apply)((0,o.tuple)(l.parseCharIndex,l.parseWhitespace,l.parseDotSepToken,(0,o.any)(R,C),l.parseCharIndex),(function(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],l=o[0],c=o[1],d=o[2],p=t[4],m=(0,u.addSpan)(e,a.start,p,n,""),f=(0,i.fieldRef)(l,c,d,!1,m);return(0,s.fieldRefTerm)(n.length>0,f,r,p)}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(1);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.DateOrder=t.CurrencyFormat=t.KnownFormat=t.NumberFormatInformation=t.IformattedValue=t.HorizontalAlignment=t.CellValueType=t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.hashesValue=t.renderedValue=t.formattedValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.CultureTag=t.BidiDate=t.FormatValueType=t.formatLocIFormat=t.formatLocKnownFormat=t.FormatLocKind=t.previousFormatFailure=t.fractionOverflow=t.dateOverflow=t.aggregationError=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0,t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.createNumberFormatter=t.shouldInstallFormat=t.getRibbonFormat=t.RibbonFormat=t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.Calendar=void 0;var n=r(0),i=n.__importStar(r(23)),a=n.__importStar(r(115)),o=n.__importStar(r(177)),s=n.__importStar(r(136)),u=n.__importStar(r(260)),l=n.__importStar(r(178)),c=n.__importStar(r(427));t.FormatReasonKind=i.FormatReasonKind,t.ReasonKind=i.ReasonKind,t.notValueString=i.notValueString,t.notFormatString=i.notFormatString,t.noFormatPart=i.noFormatPart,t.tooWide=i.tooWide,t.aggregationError=i.aggregationError,t.dateOverflow=i.dateOverflow,t.fractionOverflow=i.fractionOverflow,t.previousFormatFailure=i.previousFormatFailure,t.FormatLocKind=i.FormatLocKind,t.formatLocKnownFormat=i.formatLocKnownFormat,t.formatLocIFormat=i.formatLocIFormat,t.FormatValueType=i.FormatValueType,t.BidiDate=i.BidiDate,t.CultureTag=i.CultureTag,t.FormatCurrency=i.FormatCurrency,t.NamedColor=i.NamedColor,t.Alignment=i.Alignment,t.GetTimeKind=i.GetTimeKind,t.Clip=i.Clip,t.FormattedUnitKind=i.FormattedUnitKind,t.formattedUnitGeneral=i.formattedUnitGeneral,t.formattedUnitString=i.formattedUnitString,t.formattedUnitBlank=i.formattedUnitBlank,t.formattedUnitFlexible=i.formattedUnitFlexible,t.formattedValue=i.formattedValue,t.renderedValue=i.renderedValue,t.hashesValue=i.hashesValue,t.isHashesValue=i.isHashesValue,t.renderCallback=i.renderCallback,t.memoizedRenderCallback=i.memoizedRenderCallback,t.renderInfiniteWidth=i.renderInfiniteWidth,t.renderedValueToString=i.renderedValueToString,t.EditKind=i.EditKind,t.formulaEdit=i.formulaEdit,t.stringEdit=i.stringEdit,t.numberEdit=i.numberEdit,t.otherEdit=i.otherEdit,t.NumberFormatSource=i.NumberFormatSource,t.createFormatGlobals=i.createFormatGlobals,t.evalFormatLocalsGrid=i.evalFormatLocalsGrid,t.CellValueType=i.CellValueType,t.HorizontalAlignment=i.HorizontalAlignment,t.IformattedValue=i.IformattedValue,t.NumberFormatInformation=i.NumberFormatInformation,t.KnownFormat=a.KnownFormat,t.CurrencyFormat=a.CurrencyFormat,t.DateOrder=a.DateOrder,t.NumberShape=a.NumberShape,t.Calendar=a.Calendar,t.getKnownFormat=o.getKnownFormat,t.isKnownFormatDefined=o.isKnownFormatDefined,t.englishXLSXKnownFormat=o.englishXLSXKnownFormat,t.RibbonFormat=s.RibbonFormat,t.getRibbonFormat=s.getRibbonFormat,t.shouldInstallFormat=u.shouldInstallFormat,t.createNumberFormatter=l.createNumberFormatter,t.getValueEditOperKind=c.getValueEditOperKind,t.applyValueEdit=c.applyValueEdit,t.toXLNumber=c.toXLNumber},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInstallFormat=t.parseEdit=void 0;var n=r(111),i=r(251),a=r(64),o=r(171),s=r(174),u=r(53);function l(e){var t=(0,n.stringStartsWith)(e,"'"),r=t?e.substring(1):e;return r.length>i.cellStringLimit?(0,u.failure)((0,a.notValueString)("cell text too long")):(0,u.success)((0,a.stringEdit)((0,i.stringOper)(r),t))}function c(e,t,r){return(0,s.parseDateInternal)((0,s.initParseDateGlobals)(e),t,r,a.GetTimeKind.ValueCell)}function d(e,t,r){var n=e.config,i=n.localeInfo,s=n.mathpack,u=i.isEastAsia&&r.valueType===a.FormatValueType.Percentage&&!0,l=!1;switch(r.valueType){case a.FormatValueType.Number:case a.FormatValueType.Currency:case a.FormatValueType.Percentage:case a.FormatValueType.Fraction:case a.FormatValueType.Scientific:case a.FormatValueType.Accounting:l=!0}return(0,o.parseConstInternal)(i,s,t,u,!0,l)}function p(e,t,r){var n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return i.trueOper;if(0===e.stringCompareCI(t,e.falseName))return i.falseOper;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return(0,i.errorOper)(r)}}(e.config.localeInfo,t);if(void 0!==n)return(0,u.success)((0,a.otherEdit)(n));for(var o=0,s=r.valueType===a.FormatValueType.Date||r.valueType===a.FormatValueType.Time?[c,d]:[d,c];o<s.length;o++){var l=(0,s[o])(e,t,r);if(!(0,u.isSuccess)(l))return l;if(void 0!==l.value){var p=l.value,m=p.value,f=p.format;return(0,u.success)((0,a.numberEdit)(m,f))}}return(0,u.success)(void 0)}t.parseEdit=function(e,t,r){try{if(r.valueType===a.FormatValueType.Text)return l(t);if(""===t)return(0,u.success)((0,a.otherEdit)(i.blankOper));if(t.length>1&&(0,n.stringStartsWith)(t,"="))return(0,u.success)((0,a.formulaEdit)(t));if(!(0,n.stringStartsWith)(t,"'")){var o=p(e,t,r);if(!(0,u.isSuccess)(o))return o;if(void 0!==o.value)return(0,u.success)(o.value)}return t.length>1&&("="===(s=t.charAt(0))||"+"===s||"-"===s||"@"===s)?(0,u.success)((0,a.formulaEdit)(t)):l(t)}catch(e){return(0,u.failure)((0,u.javaScriptError)(e))}var s},t.shouldInstallFormat=function(e,t){return e!==t&&(t.source===a.NumberFormatSource.Builtin&&(t.valueType===a.FormatValueType.General||function(e,t){return(null==e?void 0:e.valueType)!==a.FormatValueType.Number&&t.valueType!==a.FormatValueType.Number&&(null==e?void 0:e.valueType)!==t.valueType}(e,t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConstInternal=void 0;var n,i,a=r(0),o=r(172),s=r(59),u=r(65),l=r(113),c=a.__importStar(r(135)),d=r(53),p=c.codePointDollarSign,m=c.codePointBackslash,f=c.codePointPercentSign,g=c.codePointSpace,h=c.codePointLeftParen,v=c.codePointMinusSign,S=c.codePointPlusSign,y=c.codePointRightParen;function F(e,t,r,i){if(" "!==t&&""!==t){var a="$"===t;if(e.isEastAsia){if(i<r.length&&r.charCodeAt(i)===p&&!a)return{currency:n.DollarUS,i:i+1};if(i+2<r.length&&0===e.stringCompareCI(r.substring(i,i+3),"US$"))return{currency:e.isChinaT?n.DollarUS:n.DollarExtra,i:i+3};if((""===t&&e.isJapan||""===t&&e.isKorea)&&i<r.length&&r.charCodeAt(i)===m)return{currency:n.Default,i:i+1};if(e.isChinaT&&i+2<r.length&&0===e.stringCompareCI(r.substring(i,i+3),"NT$"))return{currency:n.DollarExtra,i:i+3}}return i+t.length<=r.length&&0===e.stringCompareCI(r.substring(i,i+t.length),t)?{currency:n.Default,i:i+t.length}:void 0}}function C(e,t,r,c,p,m){var C,R=0,b=!1,E=!1,P=!1,k=e.isCurrencySymbolLead,T=e.currencySymbol;p!==i.None&&(k=p===i.Lead,T="");for(var A=0;A<r.length;){if(void 0===C&&k)if(void 0!==(O=F(e,T,r,A))){C=O.currency,A=O.i;continue}switch(M=r.charCodeAt(A)){case f:A+=1,R+=1;continue;case g:A+=1;continue;case h:case v:case S:if(A+=1,E)return(0,d.success)(void 0);E=!0,M===h&&(b=!0),P=M!==S;continue}break}var N=(0,o.parseNumberLiteral)(e,t,r,A,!0,R>0||c,m);if(void 0===N||void 0===N.value)return(0,d.success)(void 0);A=N.i;for(var _,I=P?t.neg(N.value):N.value;A<r.length;){var O,M;if(void 0===C&&!k)if(void 0!==(O=F(e,T,r,A))){C=O.currency,A=O.i;continue}switch(M=r.charCodeAt(A)){case f:A+=1,R+=1;continue;case g:A+=1;continue;case y:if(A+=1,!b)return(0,d.success)(void 0);b=!1;continue}break}if(A!==r.length||b||R>1||void 0!==C&&R>0)return(0,d.success)(void 0);if(void 0!==N.format)_=N.format;else if(C===n.DollarUS)_=N.consumedDecimal?u.KnownFormat.USCoCurrencyDec:u.KnownFormat.USCoCurrency;else if(C===n.DollarExtra){_=e.isChinaT?N.consumedDecimal?'"NT$"#,##0.00_);("NT$"#,##0.00)':'"NT$"#,##0_);("NT$"#,##0)':N.consumedDecimal?'"US$"#,##0.00_);("US$"#,##0.00)':'"US$"#,##0_);("US$"#,##0)'}else{if(N.numShape!==u.NumberShape.ASCII)return(0,d.failure)((0,s.notImplemented)(["parseConstInternal ifmt for non-ASCII"]));if(void 0!==C)switch(p){case i.None:_=N.consumedDecimal?u.KnownFormat.CoCurrencyDec:u.KnownFormat.CoCurrency;break;case i.Lead:_=(0,l.buildCurrencyFormat)(a.__assign(a.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0}),!0,N.consumedDecimal?2:0,!0,!1,"[$-x-euro2]");break;case i.Trail:_=(0,l.buildCurrencyFormat)(a.__assign(a.__assign({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0}),!0,N.consumedDecimal?2:0,!0,!1,"[$-x-euro1]")}else _=R>0?N.consumedDecimal?u.KnownFormat.Pct:u.KnownFormat.Pct0:N.consumedThousands?N.consumedDecimal?u.KnownFormat.Fixed:u.KnownFormat.Fixed0:u.KnownFormat.General}return(0,d.success)({value:I,format:_})}!function(e){e[e.Default=0]="Default",e[e.DollarUS=1]="DollarUS",e[e.DollarExtra=2]="DollarExtra"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Lead=1]="Lead",e[e.Trail=2]="Trail"}(i||(i={})),t.parseConstInternal=function(e,t,r,n,a,o){if(!a)return C(e,t,r,n,i.None,o);for(var s=i.None;s<=i.Trail;s+=1){var u=C(e,t,r,n,s,o);if(!(0,d.isSuccess)(u))return u;if(void 0!==u.value)return u;if(s===i.None&&r.indexOf("")<0)break}return(0,d.success)(void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isSpace=void 0;var n=r(3);t.isSpace=n.literalParse.isSpace,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.countCodePoints=t.codePointIterator=void 0;var n=r(1);t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateInternal=t.initParseDateGlobals=void 0;var i,a=r(0),o=r(114),s=r(64),u=r(112),l=r(59),c=r(173),d=a.__importStar(r(135)),p=r(172),m=r(66),f=r(65),g=r(252),h=r(111),v=r(53),S=d.codePointSlash,y=d.codePointSpace,F=d.codePointMinusSign,C=d.codePointColon,R={getTime:function(){return(0,m.assertFalse)("calc.numfmt.parseDateInternal: default getTime")}};function b(e,t){return(0,m.assertTrue)("calc.numfmt.monthToken",W(e,1,12)),{kind:i.Month,value:e,bidiDate:t}}t.initParseDateGlobals=function(e){var t,r;return{config:e.config,getTime:null!==(r=null===(t=e.getTime)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:R.getTime}},function(e){e[e.Month=0]="Month",e[e.AMPM=1]="AMPM",e[e.Number=2]="Number"}(i||(i={}));var E,P=a.__spreadArray([],new Array(12),!0).map((function(e,t){return b(t+1)})),k=function(e){return P[e]},T=function(e){return b(e+1,s.BidiDate.English)},A=function(e){return b(e+1,s.BidiDate.Lunar)},N=[!0,!1].map((function(e){return{kind:i.AMPM,am:e}})),_=N[0],I=N[1],O=function(e){return 0===e?_:I};function M(e,t,r){return(0,m.assertTrue)("calc.numfmt.numberToken",(0,h.isInteger)(e)&&W(e,-9999,9999)&&W(t,1,4)),{kind:i.Number,value:e,digits:t,numShape:r}}!function(e){e[e.Nil=0]="Nil",e[e.Space=1]="Space",e[e.Date=2]="Date",e[e.Time=3]="Time",e[e.TimeAlt=4]="TimeAlt",e[e.FracSec=5]="FracSec",e[e.Intl1St3=6]="Intl1St3"}(E||(E={}));var D=function(e){return e===E.Time||e===E.TimeAlt},w=function(e,t){return e.lcid===o.LCID.Hungarian&&t===E.Date},L=function(e){return e<=E.Space},x=function(e){return e<=E.Date},K=["",""],U=((n={})[o.Country.FRN]=[["Jun",b(6)],["Jul",b(7)]],n[o.Country.DUT]=[["Mrt",b(3)]],n[o.Country.GER]=[["Mrz",b(3)]],n),B=["",""," "," "," "," ","","","",""," "," "];function W(e,t,r){return e>=t&&e<=r}function G(e,t){var r=e.getTime(g.TimeGranularity.Year,t);if(!(0,v.isSuccess)(r))return r;var n=e.config,i=n.datepack.fromNum(n,r.value,g.Rounding.RoundSec);return(0,m.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",!1!==i),(0,v.success)(i.yr)}function V(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function j(e,t,r,n,i,a){for(var o=t.indexOf(" ",r),s=0;s<n.length;s+=1){var l=n[s],c=(0,u.fastMin)(i,l.length);if(o>=0&&l.indexOf(" ")<0&&o-r>=c&&o-r<=l.length)if(V(e,m=l.substring(0,o-r),t,r))return[a(s),r+m.length];for(var d=void 0,p=c;p<=l.length;p+=1){var m;if(!V(e,m=l.substring(0,p),t,r))break;d=r+m.length}if(void 0!==d)return[a(s),d]}}function q(e,t,r,n,i){for(var a=0;a<n.length;a+=1){var o=n[a];if(V(e,o,t,r))return[i(a),r+o.length]}}function H(e,t,r){var n,i=U[e.country];if(void 0!==i)for(var a=0,s=i;a<s.length;a++){var u=s[a],l=u[0],c=u[1];if(V(e,l,t,r))return[c,r+l.length]}if(e.isEastAsia){if(void 0!==(n=j(e,t,r,(0,o.getEnglishLocaleInfo)().monthNameLong,3,k)))return n}else if(e.isComplexScript){if(void 0!==(n=q(e,t,r,e.monthNameLong,k)))return n;if(void 0!==(n=q(e,t,r,e.monthNameShort,k)))return n;if(void 0!==(n=q(e,t,r,(0,o.getEnglishLocaleInfo)().monthNameLong,T)))return n;if(void 0!==(n=q(e,t,r,(0,o.getEnglishLocaleInfo)().monthNameShort,T)))return n}else if(void 0!==(n=j(e,t,r,e.monthNameLong,3,k)))return n;return(e.lcid&o.LCID.LANG)==(o.LCID.Arabic&o.LCID.LANG)&&void 0!==(n=q(e,t,r,B,A))||void 0!==(n=j(e,t,r,e.ampmSymbols,1,O))||void 0!==(n=j(e,t,r,(0,o.getEnglishLocaleInfo)().ampmSymbols,1,O))||(e.isChinaS||e.isChinaT)&&void 0!==(n=j(e,t,r,K,1,O))?n:[void 0,r]}function z(e,t,r,n){var i,a,o,s,u,l=r,d=t.charCodeAt(l)===F;if(d&&(l+=1),n===E.FracSec){if(o=(i=(0,p.parseUint)(e,4,l+4<t.length?t.substring(0,l+4):t,l))[0],u=(s=i[1])-l,(0,m.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",W(u,1,4)),4===u){for(var g=void 0;s<t.length&&e.isNumeral(g=(0,c.stringCodePointAt)(t,s));)s+=(0,c.numCodeUnits)(g);o=Math.round(o/10),u=3}}else if(o=(a=(0,p.parseUint)(e,4,t,l))[0],(u=(s=a[1])-l)>4||u>2&&o<100)return[void 0,r];if(0===u)return[void 0,r];var h=function(e,t){for(var r=f.NumberShape.ASCII,n=0,i=(0,c.codePointIterator)(t);n<i.length;n++){var a=i[n],o=e.getNumberShape(a);o!==f.NumberShape.ASCII&&(r=o)}return r}(e,t.substring(l,s));return l=s,[M(d?-o:o,u,h),l]}function Q(e,t,r,n){var i=E.Nil,a=r;if(t.charCodeAt(a)===y)for(i=E.Space;t.charCodeAt(a)===y;)a+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&n===E.Time&&(0,h.stringStartsWith)(t,e.timeAltSeparator,a)?(i=E.TimeAlt,a+=e.timeAltSeparator.length):(0,h.stringStartsWith)(t,e.dateSeparator,a)?(i=E.Date,a+=e.dateSeparator.length):(0,h.stringStartsWith)(t,e.timeSeparator,a)?(i=E.Time,a+=e.timeSeparator.length):(0,h.stringStartsWith)(t,e.decimalSeparator,a)&&n===E.Time?(i=E.FracSec,a+=e.decimalSeparator.length):t.charCodeAt(a)===S||t.charCodeAt(a)===F?(i=E.Date,a+=1):t.charCodeAt(a)===C?(i=E.Time,a+=1):(0,h.stringStartsWith)(t,", ",a)&&(i=E.Intl1St3,a+=2),i===E.Space&&(" "===e.dateSeparator?i=E.Date:" "===e.timeSeparator?i=E.Time:" "===e.decimalSeparator&&n===E.Time&&(i=E.FracSec)),[i,a]}function Y(e,t,r,n){var a,o,s,u=e.config,c=u.localeInfo,d=u.dateCompatibility,p=u.datepack,g=!1;if(void 0!==n){var h=n.end-n.start;if(h<2||h>3)return(0,v.success)(void 0);var S=r[n.start],y=S.tok,F=S.sep,C=r[n.start+1],R=C.tok,b=C.sep,P=r[n.end-1],k=P.tok,T=P.sep;if((0,m.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",y.kind!==i.AMPM&&R.kind!==i.AMPM&&k.kind!==i.AMPM),!L(T)&&!w(c,T))return(0,v.success)(void 0);var A=void 0!==function(e,t){for(var r=t.start;r<t.end;r+=1)if(e[r].tok.kind===i.Month)return r}(r,n);if(g=A,A)if(x(F)&&x(b))if(y.kind===i.Month){if(h>2)return(0,v.success)(void 0);o=y,(0,m.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",k.kind!==i.Month),a=k}else{if(R.kind!==i.Month)return(0,v.success)(void 0);s=y,o=R,3===h&&((0,m.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",k.kind!==i.Month),a=k)}else{if(3!==h)return(0,v.success)(void 0);if(L(b))return(0,v.success)(void 0);var N=c.longDateFormat?y:R,_=c.longDateFormat?R:y;if(N.kind!==i.Month)return(0,v.success)(void 0);(0,m.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",_.kind!==i.Month&&k.kind!==i.Month),s=_,o=N,a=k}else if((0,m.assertTrue)("calc.numfmt.parseDateInternal: all not Month",y.kind!==i.Month&&R.kind!==i.Month&&k.kind!==i.Month),2===h&&F===E.Date)switch(g=!0,c.dateOrder){case f.DateOrder.MDY:o=y,a=k;break;case f.DateOrder.YMD:W(y.value,1,12)?(o=y,s=k):(a=y,o=k);break;case f.DateOrder.DMY:W(k.value,1,12)?(s=y,o=k):(o=y,a=k);break;default:return(0,v.failure)((0,l.notImplemented)(["date parse date order"]))}else{if(h<3||F!==E.Date||b!==E.Date)return(0,v.success)(void 0);switch(y.value>999||!d&&y.value>99?f.DateOrder.YMD:c.dateOrder){case f.DateOrder.MDY:o=y,s=R,a=k;break;case f.DateOrder.YMD:a=y,o=R,s=k;break;case f.DateOrder.DMY:s=y,o=R,a=k;break;default:return(0,v.failure)((0,l.notImplemented)(["date parse date order"]))}}}var I=!1;if(c.dateOrder!==f.DateOrder.DMY&&void 0===s&&void 0!==o&&W(o.value,1,12)&&void 0!==a&&W(a.value,1,31)){var O=G(e,t);if(!(0,v.isSuccess)(O))return O;a.value<=p.daysPerMonth(o.value,O.value,d)&&(s=a,a=M(O.value,4,f.NumberShape.ASCII),I=!0)}return(0,v.success)({yr:a,mon:o,dom:s,useMonthName:g,usingCurrentYear:I})}t.parseDateInternal=function(e,t,r,n){var a=e.config,o=a.localeInfo;if(!o.isEastAsia&&!function(e,t){for(var r=0,n=(0,c.codePointIterator)(t);r<n.length;r++){var i=n[r];if(e.isNumeral(i))return!0}return!1}(o,t))return(0,v.success)(void 0);if(o.isEastAsia)return(0,v.failure)((0,l.notImplemented)(["parse East Asia date"]));if(o.isThai){var u=t.indexOf("b");if(u<0&&(u=t.indexOf("B")),u>=0&&u+1<t.length&&o.isNumeral((0,c.stringCodePointAt)(t,u+1)))return(0,v.failure)((0,l.notImplemented)(["parse Thai Buddhist date"]))}var d=function(e,t,r){for(var n,a=e.localeInfo,o=e.dateCompatibility,s=[],u=null==r?void 0:r.bidiDate,d=f.NumberShape.ASCII,p=null==r?void 0:r.culture,g=!1,h=!1,S=0;S<t.length;){if(s.length>=9)return(0,v.success)(void 0);var C=void 0;if(a.isNumeral((0,c.stringCodePointAt)(t,S))||!o&&S+1<t.length&&t.charCodeAt(S)===F&&a.isNumeral((0,c.stringCodePointAt)(t,S+1))){var R=z(a,t,S,n),b=R[0],P=R[1];if(void 0===b)return(0,v.success)(void 0);S=P,b.numShape!==f.NumberShape.ASCII&&(d=b.numShape),C=b}else{if(t.charCodeAt(S)===y)return(0,v.failure)((0,l.notImplemented)(["absurd date/time string with leading space"]));var k=H(a,t,S),T=k[0],A=k[1];if(void 0===T)return(0,v.success)(void 0);if(S=A,T.kind===i.Month){if(g)return(0,v.success)(void 0);g=!0,void 0!==T.bidiDate&&(u=T.bidiDate)}if(T.kind===i.AMPM){if(h)return(0,v.success)(void 0);if(h=!0,0===s.length||s[s.length-1].sep!==E.Space)return(0,v.success)(void 0);n=s[s.length-1].sep=E.Time}C=T}var N=Q(a,t,S,n),_=N[0];for(S=N[1];S<t.length&&t.charCodeAt(S)===y;)S+=1;s.push({tok:C,sep:_}),n=_}return(0,m.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",0!==s.length),(0,v.success)({tokens:s,bidiDate:u,numShape:d,culture:p})}(a,t,r);if(!(0,v.isSuccess)(d)||void 0===d.value)return d;var p=d.value,h=p.tokens,S=p.bidiDate,C=p.numShape,R=p.culture;if(S===s.BidiDate.Lunar)return(0,v.failure)((0,l.notImplemented)(["Lunar calendar"]));if(void 0!==R&&(R.localCalendarInput||R.tag===s.CultureTag.Gannen))return(0,v.failure)((0,l.notImplemented)(["parse date: possible local calendar"]));var b=function(e,t){for(var r,n,a,o,s,u,c,d=e.localeInfo,p=0;p<t.length;p+=1)if(D(t[p].sep)){r={start:p,end:p+1};break}if(void 0!==r){if(0!==r.start&&t[r.start-1].sep!==E.Space&&!w(d,t[r.start-1].sep))return(0,v.success)(void 0);for(;r.end<t.length&&D(t[r.end-1].sep);)r.end+=1;if(r.end<t.length&&t[r.end-1].sep===E.FracSec){r.end+=1;var f=t[r.end-1];if(f.tok.kind!==i.Number)return(0,v.success)(void 0);f.tok;if(u=f,r.end<t.length&&D(t[r.end-1].sep)){if(r.end+=1,(g=t[r.end-1]).tok.kind!==i.AMPM)return(0,v.failure)((0,l.notImplemented)(["non-AM/PM after FracSec"]));g.tok;c=g}}else{var g;if((g=t[r.end-1]).tok.kind===i.AMPM){g.tok;c=g}}var h=r.end-r.start-(void 0!==u?1:0)-(void 0!==c?1:0);for(p=0;p<h;p+=1)if(t[r.start+p].tok.kind!==i.Number)return(0,v.failure)((0,l.notImplemented)(["non-number in H/M/S component"]));switch(h){case 0:return(0,m.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,m.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===u),a=t[r.start];break;case 2:void 0===u?(a=t[r.start],o=t[r.start+1]):(o=t[r.start],s=t[r.start+1]);break;case 3:a=t[r.start],o=t[r.start+1],s=t[r.start+2];break;default:return(0,v.success)(void 0)}for(p=r.end;p<t.length;p+=1)if(D(t[p].sep))return(0,v.success)(void 0);if(r.end===t.length){var S=t[r.end-1].sep;if(!(L(S)||void 0!==c&&S===E.FracSec))return(0,v.failure)((0,l.notImplemented)(["trailing sep after time"]))}else{var y=t[r.end-1].sep;if(!L(y)&&y!==E.Intl1St3)return(0,v.failure)((0,l.notImplemented)(["unexpected sep between time and date"]))}if(0===r.start)r.end!==t.length&&(n={start:r.end,end:t.length});else{if(r.end!==t.length)return(0,v.failure)((0,l.notImplemented)(["date part split around time part"]));n={start:0,end:r.start}}}else n={start:0,end:t.length};return(0,v.success)({time:r,date:n,hour:a,min:o,sec:s,fracSec:u,ampm:c})}(a,h);if(!(0,v.isSuccess)(b)||void 0===b.value)return b;var P=b.value,k=P.time,T=P.date,A=P.hour,N=P.min,_=P.sec,I=P.fracSec,O=P.ampm,M=Y(e,n,h,T);if(!(0,v.isSuccess)(M)||void 0===M.value)return M;var x=M.value,K=x.yr,U=x.mon,B=x.dom,V=x.useMonthName,j=x.usingCurrentYear,q=function(e,t,r,n,i,a,o,s,u,c){var d,p,f,h,S=e.config,y=S.mathpack,F=S.datepack,C=S.dateCompatibility;if(void 0!==n||void 0!==i||void 0!==r){if((0,m.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",void 0!==i||void 0!==r),(0,m.assertTrue)("calc.numfmt.parseDateInternal: mon",void 0!==n),!W(f=n.value,1,12))return(0,v.success)(void 0);if(void 0===r){var R=G(e,t);if(!(0,v.isSuccess)(R))return R;p=R.value}else p=W(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!W(p,1900,9999))return(0,v.success)(void 0);if(!W(h=null!==(d=null==i?void 0:i.value)&&void 0!==d?d:1,1,F.daysPerMonth(f,p,C)))return(0,v.success)(void 0)}else{var b=F.fromNum(S,y.zero,g.Rounding.RoundSec);(0,m.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==b),p=b.yr,f=b.mon,h=b.dom}var E,P=0,k=0,T=0,A=0,N=g.Rounding.RoundSec,_=0;if(void 0!==a){if(a.value<0)return(0,v.failure)((0,l.notImplemented)(["negative hour"]));if(a.value>23){if(void 0!==E)return(0,v.success)(void 0);_=a.value,E=g.TimeDivision.Hour}else P=a.value}if(void 0!==o){if(o.value<0)return(0,v.failure)((0,l.notImplemented)(["negative minute"]));if(o.value>59){if(void 0!==E)return(0,v.success)(void 0);_=o.value,E=g.TimeDivision.Minute}else k=o.value}if(void 0!==s){if(s.value<0)return(0,v.failure)((0,l.notImplemented)(["negative second"]));if(s.value>59){if(void 0!==E)return(0,v.success)(void 0);_=s.value,E=g.TimeDivision.Second}else T=s.value}if(void 0!==u){if(u.value<0)return(0,v.failure)((0,l.notImplemented)(["negative fractional second"]));(0,m.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",u.digits>=1&&u.digits<=3),N=u.digits,(0,m.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",u.value<(3===N?1001:2===N?100:10)),A=u.value}if(void 0!==c){if(void 0!==E||P>12)return(0,v.success)(void 0);c.am?12===P&&(P=0):P<12&&(P+=12)}var I=(0,g.dateTime)(p,f,h,P,k,T,1,A,N),O=void 0!==E?F.toNumWithDuration(S,I,E,_):F.toNum(S,I);return(0,l.isErrorOper)(O)?(0,v.success)(void 0):(0,v.success)({value:O,duration:E})}(e,n,K,U,B,null==A?void 0:A.tok,null==N?void 0:N.tok,null==_?void 0:_.tok,null==I?void 0:I.tok,null==O?void 0:O.tok);if(!(0,v.isSuccess)(q)||void 0===q.value)return q;var J=q.value,$=J.value,X=function(e,t,r,n,i,a,o,s,u,c,d,p){if(e!==f.NumberShape.ASCII)return(0,v.failure)((0,l.notImplemented)(["parseDateInternal ifmt for non-ASCII"]));if(o)return(null==s?void 0:s.sep)===E.TimeAlt?(0,v.failure)((0,l.notImplemented)(["parseDateInternal ifmt for alternate time separator"])):void 0!==c?(0,v.success)(f.KnownFormat.SS0):void 0!==p?p!==g.TimeDivision.Hour||void 0!==d||t?(0,v.success)(f.KnownFormat.General):(0,v.success)(f.KnownFormat.AbsHMMSS):t?(0,v.success)(f.KnownFormat.MDYHMS):void 0!==d?(0,v.success)(void 0!==u?f.KnownFormat.HHMMSSAP:f.KnownFormat.HHMMAP):(0,v.success)(void 0!==u?f.KnownFormat.HHMMSS:f.KnownFormat.HHMM);if((0,m.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",t),!i)return(0,v.success)(f.KnownFormat.MMDDYY);var h=void 0!==r&&!a;return(0,v.success)(void 0===n?f.KnownFormat.MMMYY:h?f.KnownFormat.DDMMMYY:f.KnownFormat.DDMMM)}(C,void 0!==T,K,B,V,j,void 0!==k,N,_,I,O,J.duration);return(0,v.isSuccess)(X)?(0,v.success)({value:$,format:X.value}):X}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(3);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderHashesValue=t.renderValue=t.renderGeneral=void 0;var n=r(64),i=r(59),a=r(66),o=r(112),s=r(134),u=r(111),l=r(53),c=function(e){return e.kind!==n.FormattedUnitKind.General},d=function(e){return e.kind!==n.FormattedUnitKind.Flexible};function p(e,t,r){return 0!=(t&n.Clip.MaxChars)&&r.length>255?n.Clip.MaxChars:0!=(t&n.Clip.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?n.Clip.CellWidth:void 0}function m(e,t,r,n,i,s,u){var l=(0,o.fastMax)(0,255-r.length-n.length),c=0===i.length?l:Math.floor(l/i.length);if(e.renderWidth!==1/0){var d=e.getTextWidth(i);d>0&&(c=(0,o.fastMin)(c,(0,o.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(r+n))/d),0)))}var m,f=u(c);if(e.bestFit&&s&&(!1===f||f.indexOf("E")>=0)){for(var g=1,v=f;(!1===v||v.indexOf("E")>=0)&&c+g<=h;)v=u(c+g),g++;if(!1!==v)return v}if(!1===f||void 0===(m=p(e,t,r+f+n))){for(var S=f,y=c+1;y<c+50;y+=1){if(!1!==(C=u(y))){if(C===S)break;if(void 0!==(R=p(e,t,r+C+n))){!1===S&&(S=R);break}S=C}}return(0,a.assertTrue)("calc.numfmt.renderValue: false after upwards search",!1!==S),S}var F=m;for(y=c-1;y>=0;y-=1){var C,R;if(!1===(C=u(y)))break;if(void 0===(R=p(e,t,r+C+n)))return C;F=R}return F}var f=(0,i.createFailureErrorClass)("RenderHashesError"),g=(0,i.createFailureErrorClass)("RenderError"),h=11;function v(e,t,r){var n=e.fromNumber(t.num),i=t.includeSign&&e.cond(n)<0?"-":"",o=i+e.formatGeneral(t,e.abs(n),r-i.length);if("-0"===o&&(o="0"),o.length>r)return(0,l.success)(!1);var u=o.indexOf("E");if(u>=0){var c=(0,s.convertNumberShape)(t,o.substring(0,u),t.expNumberShape);if(!(0,l.isSuccess)(c))return c;var d=o.substring(u,u+2),p=(0,s.convertDigitsShape)(o.substring(u+2),t.expNumberShape);return(0,a.assertTrue)("calc.numfmt.render: formatGeneral ePart","E-"===d||"E+"===d),(0,l.success)(c.value+d+p)}var m=(0,s.convertNumberShape)(t,o,t.numberShape);return(0,l.isSuccess)(m)?(0,l.success)(m.value):m}t.renderGeneral=v,t.renderValue=function(e,t,r){try{return(0,n.isHashesValue)(t)?(0,l.success)((0,n.hashesValue)(t.units,t.color)):(0,l.success)(function(e,t,r){var i,s,S=t.units,y=t.color,F=t.alignment,C=t.clip,R=(0,n.memoizedRenderCallback)(r);if(S.every(c))i=S;else if(R.renderWidth===1/0)i=S.map((function(t){if(t.kind!==n.FormattedUnitKind.General)return t;var r=v(e,t,h);if(!(0,l.isSuccess)(r))throw new g(r.reason);return(0,a.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r.value),(0,n.formattedUnitString)(r.value)}));else{for(var b="",E="",P=void 0,k=void 0,T=0;T<S.length;T+=1){var A=S[T];switch(A.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==P?E+=A.str:b+=A.str;break;case n.FormattedUnitKind.General:(0,a.assertTrue)("calc.numfmt.renderValue: expected a single General unit",void 0===P),P=T,k=A;break;case n.FormattedUnitKind.Flexible:}}(0,a.assertTrue)("calc.numfmt.renderValue: genUnit",void 0!==P&&void 0!==k);var N=k,_=m(R,C,b,E,"0",N.builtin,(function(t){var r=v(e,N,(0,o.fastMin)(t,h));if(!(0,l.isSuccess)(r))throw new g(r.reason);return r.value}));if("number"==typeof _)throw new f((0,n.tooWide)(_));i=S.map((function(e){return e.kind===n.FormattedUnitKind.General?(0,n.formattedUnitString)(_):e}))}if(i.every(d))s=i;else if(R.renderWidth===1/0||R.bestFit)s=i.filter(d);else{b="",E="";var I,O=void 0;for(T=0;T<i.length;T+=1){var M=i[T];switch(M.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==I?E+=M.str:b+=M.str;break;case n.FormattedUnitKind.Flexible:I=T,O=M}}(0,a.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",void 0!==I&&void 0!==O);var D=O,w=m(R,n.Clip.All,b,E,O.str,!1,(function(e){return(0,u.repeat)(D.str,e)}));if("number"==typeof w){if(0!=(w&C))throw new f((0,n.tooWide)(w));w=""}var L=w.length/D.str.length;L=(0,o.fastMax)(L-1,0);var x=(0,u.repeat)(D.str,L);s=i.map((function(e,t){return e.kind!==n.FormattedUnitKind.Flexible?e:(0,n.formattedUnitString)(t===I?x:"")}))}if(C!==n.Clip.None){var K="";for(T=0;T<s.length;T+=1)K+=s[T].str;var U=p(R,C,K);if(R.bestFit&&U===n.Clip.CellWidth)return(0,n.renderedValue)(s,y,F,C);if(void 0!==U)throw new f((0,n.tooWide)(U))}return(0,n.renderedValue)(s,y,F,C)}(e,t,r))}catch(e){return e instanceof f?(0,l.success)((0,n.hashesValue)(e.reason,t.color)):e instanceof g?(0,l.failure)(e.reason):(0,l.failure)((0,l.javaScriptError)(e))}},t.renderHashesValue=function(e,t){try{var r=m((0,n.memoizedRenderCallback)(t),e.clip,"","","#",!1,(function(e){return(0,u.repeat)("#",e)}));if("number"==typeof r)switch(r){case n.Clip.MaxChars:r=(0,u.repeat)("#",255);break;case n.Clip.CellWidth:r="";break;default:return(0,a.assertNever)("calc.numFmt.renderHashesValue",r)}var i=(0,n.formattedUnitString)(r);return(0,l.success)((0,n.renderedValue)([i],e.color,e.alignment,e.clip))}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKnownFormatDefined=t.getSpecial=t.getSingle=t.getKnownFormat=t.getColor=t.englishXLSXKnownFormat=t.buildSingle=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.buildMMDDYYFormat=t.buildFractionFormat=t.buildCurrencyFormat=void 0;var n=r(38);t.buildCurrencyFormat=n.knownFormat.buildCurrencyFormat,t.buildFractionFormat=n.knownFormat.buildFractionFormat,t.buildMMDDYYFormat=n.knownFormat.buildMMDDYYFormat,t.buildNumberFormat=n.knownFormat.buildNumberFormat,t.buildPercentFormat=n.knownFormat.buildPercentFormat,t.buildScientificFormat=n.knownFormat.buildScientificFormat,t.buildSingle=n.knownFormat.buildSingle,t.englishXLSXKnownFormat=n.knownFormat.englishXLSXKnownFormat,t.getColor=n.knownFormat.getColor,t.getKnownFormat=n.knownFormat.getKnownFormat,t.getSingle=n.knownFormat.getSingle,t.getSpecial=n.knownFormat.getSpecial,t.isKnownFormatDefined=n.knownFormat.isKnownFormatDefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;var n=r(38);t.createNumberFormatter=n.formatService.createNumberFormatter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(3);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coerceOper=void 0;var n=r(27),i=r(16),a=r(18),o=r(8),s=r(117),u=r(7),l=r(26),c=r(27),d=r(10),p=r(74);function m(e,t){return 0!=(t&a.OperKind.Number)?e.zero:0!=(t&a.OperKind.String)?c.emptyStringOper:0!=(t&a.OperKind.Boolean)?o.falseOper:o.valueErrorOper}t.coerceOper=function(e,t,r){var c=function e(t,r,n){var c=t.globals.config,f=c.localeInfo,g=c.mathpack;if(0!=(n&r.kind))return r;if((0,u.isNumberOper)(r)){if(0!=(n&a.OperKind.String)){return(0,o.stringOper)(g.formatGeneral(f,r,20))}return 0!=(n&a.OperKind.Boolean)?(0,o.booleanOper)(0!==g.cond(r)):0!=(n&a.OperKind.Array)?(0,o.arrayOper)(1,1,[[r]]):o.valueErrorOper}if((0,u.isStringOper)(r)){if(0!=(n&a.OperKind.Number)){if(0===r.value.length)return o.valueErrorOper;if(r.value.length>255)return o.valueErrorOper;var h=t.numberFormatter.parseGeneral(r.value,!1,!0,s.GetTimeKind.NonVolatile);return(0,l.isSuccess)(h)||(0,i.throwEvaluationError)(h.reason),void 0!==h.value?h.value.value:o.valueErrorOper}if(0!=(n&a.OperKind.Boolean)){if(0===f.stringCompareCI(r.value,f.trueName))return o.trueOper;if(0===f.stringCompareCI(r.value,f.falseName))return o.falseOper}return 0!=(n&a.OperKind.Array)?(0,o.arrayOper)(1,1,[[r]]):o.valueErrorOper}if((0,u.isBooleanOper)(r))return 0!=(n&a.OperKind.Number)?r.value?g.one:g.zero:0!=(n&a.OperKind.String)?(0,o.stringOper)(r.value?f.trueName:f.falseName):0!=(n&a.OperKind.Array)?(0,o.arrayOper)(1,1,[[r]]):o.valueErrorOper;switch(r.kind){case a.OperKind.Error:return r;case a.OperKind.Missing:return 0!=(n&a.OperKind.Blank)?o.blankOper:m(g,n);case a.OperKind.Blank:return m(g,n);case a.OperKind.Rich:return(0,p.getTypedFeatureGate)("Microsoft.Office.Excel.CalcTsDec2023Funcs")&&0!=(n&a.OperKind.Array)?(0,o.arrayOper)(1,1,[[r]]):e(t,r.getFallback(),n);case a.OperKind.Range:case a.OperKind.Array:return o.valueErrorOper;default:return(0,d.assertNever)("calc.runtime.coerceOper",r)}}(e,t,r);return(0,u.isErrorOper)(c)&&!(0,u.isErrorOper)(t)&&(0,n.traceErrorOper)("calc.runtime.coerceOper",c.type,"kind = ".concat(t.kind)),c}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.createCompiler=t.compiledFormulaTerm=t.compiledFormula=void 0;var i=r(0),a=r(75),o=r(10),s=r(68),u=r(44),l=r(27),c=r(119),d=r(7),p=r(34),m=r(116),f=r(8),g=r(26),h=r(263),v=r(25),S=r(137),y=r(19),F=r(74),C=r(182),R=(0,d.createFailureErrorClass)("CompileError"),b=(0,l.makeStrict)((0,p.getWorksheetFuncType)(p.WorksheetFuncId.IF)),E=(0,l.makeStrict)((0,p.getWorksheetFuncType)(p.WorksheetFuncId.CHOOSE));function P(e){return(0,s.isOperTerm)(e)&&(0,d.isWriteOper)(e)}var k=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return(0,h.visitFormulaNode)(t,e)},this.lazyVisitFormulaNode=function(e){return S.Pledge.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e,t,r){return S.Pledge.resolve(this.noopTerm(e,r))},e.prototype.arrayNode=function(e,t,r){var n=this;return S.Pledge.all(e.map((function(e){return S.Pledge.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.toArrayTerm(e,r)}))},e.prototype.toArrayTerm=function(e,t){var r=e.length,n=void 0===e[0]?0:e[0].length,i=e.map((function(e){return e.map((function(e){return e.kind===s.TermKind.Noop?e.children:e}))}));return i.every((function(e){return e.every(P)}))?this.noopTerm((0,f.arrayOper)(r,n,i),t):(0,s.arrayTerm)(r,n,e,t)},e.prototype.appNode=function(t,r,n,a){var u,l=this,m=(null===(u=this.context.annotations[a])||void 0===u?void 0:u.kind)===c.AnnotationKind.FormulaRoot;if((0,d.isOperatorNode)(t)){var f=(0,p.getOperatorType)(t.id);return S.Pledge.all(r.map(this.lazyVisitFormulaNode)).bind((function(e){return(0,s.appTerm)((0,s.operatorIdToName)(t.id),f,m,void 0,e,a)}))}var g=(0,d.getArguments)(r);if((0,d.isWSFNode)(t)){var v=t.id;switch(v){case p.WorksheetFuncId.IFERROR:case p.WorksheetFuncId.IFNA:(0,o.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",2===g.length);var y=g[0],F=g[1],C=new e(i.__assign(i.__assign({},this.context),{numNames:this.context.numNames+1}));return S.Pledge.all([this.lazyVisitFormulaNode(y),S.Pledge.try((function(){return(0,h.visitFormulaNode)(C,F)}))]).bind((function(e){var t=e[0],r=e[1];return l.toIfPredicateTerm(v===p.WorksheetFuncId.IFERROR?p.WorksheetFuncId.ISERROR:p.WorksheetFuncId.ISNA,t,r,a)}));case p.WorksheetFuncId._UDF:return(0,o.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return S.Pledge.all(g.map(this.lazyVisitFormulaNode)).bind((function(e){switch(v){case p.WorksheetFuncId.IF:return l.toIfTerm(e,a);case p.WorksheetFuncId.CHOOSE:return l.toChooseTerm(e,a)}var t=(0,p.getWorksheetFuncType)(v);return(0,s.appTerm)((0,s.worksheetFunctionIdToName)(v),t,!1,void 0,e,a)}))}return this.lazyVisitFormulaNode(t).bind((function(e){return S.Pledge.all(g.map(l.lazyVisitFormulaNode)).bind((function(t){return l.toAppTerm(e,t,a)}))}))},e.prototype.toIfPredicateTerm=function(e,t,r,n){var i=(0,s.readStackTerm)(0,void 0),a=(0,s.conditionalTerm)((0,s.worksheetFunctionIdToName)(p.WorksheetFuncId.IF),b,!1,(0,s.appTerm)((0,s.worksheetFunctionIdToName)(e),(0,p.getWorksheetFuncType)(e),!1,void 0,[i],void 0),[r,i],void 0);return(0,s.letTerm)([t],!1,[void 0],a,n)},e.prototype.toIfTerm=function(e,t){switch(e.length){case 3:return(0,s.conditionalTerm)((0,s.worksheetFunctionIdToName)(p.WorksheetFuncId.IF),b,!1,e[0],[e[1],e[2]],t);case 2:return(0,s.conditionalTerm)((0,s.worksheetFunctionIdToName)(p.WorksheetFuncId.IF),b,!1,e[0],[e[1],f.falseOper],t);case 1:throw new R((0,d.notImplemented)(["single-argument IF"]));default:return(0,o.assertFalse)("calc.runtime.toIfTerm: expected wff")}},e.prototype.toChooseTerm=function(e,t){return(0,o.assertTrue)("calc.runtime.toChooseTerm: expected wff",e.length>=1),(0,s.conditionalTerm)((0,s.worksheetFunctionIdToName)(p.WorksheetFuncId.CHOOSE),E,!1,e[0],e.slice(1),t)},e.prototype.toAppTerm=function(e,t,r){return(0,s.appTerm)((0,s.worksheetFunctionIdToName)(p.WorksheetFuncId._UDF),(0,p.higherOrderFunctionType)(),!1,void 0,i.__spreadArray([e],t,!0),r)},e.prototype.letNode=function(e,t,r,n,i,a){var l=this,c=e.id===p.WorksheetFuncId.LETREC||e.id!==p.WorksheetFuncId.LET&&(0,o.assertFalse)("calc.runtime.compile");(0,o.assertTrue)("calc.runtime.letNode: expected wff",void 0!==r);var d=this.bindNames(t),m=d[t.length],f=t.map((function(e){return e.name.arg.label}));return(c?S.Pledge.all(t.map((function(e){var t=e.binder;return S.Pledge.try((function(){return(0,h.visitFormulaNode)(m,t.arg)}))}))):S.Pledge.all(t.map((function(e,t){var r=e.binder,n=d[t];return S.Pledge.try((function(){return(0,h.visitFormulaNode)(n,r.arg)}))})))).bind((function(e){return(0,h.visitFormulaNode)(m,r.arg).bind((function(r){return(0,s.letTerm)(e.map((function(e,r){return l.noopTerm(e,(0,u.runtimePositionLetVal)(t[r].name.arg.label,t[r].binder.arg.label))})),c,f,r,a)}))}))},e.prototype.lambdaNode=function(e,t,r,n,a,u){(0,o.assertTrue)("calc.runtime.lambdaNode: expected wff",void 0!==r);var l=this.bindNames(t),c=l[t.length],d=t.reduce((function(e,t,r){var n=t.name;return(0,v.fastMax)(e,n.arg.isOptional?0:r+1)}),0),p=t.length;return S.Pledge.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return S.Pledge.resolve(void 0);var n=l[t],i=r.arg.def.rhs;return S.Pledge.try((function(){return(0,h.visitFormulaNode)(n,i)}))}))).bind((function(e){return(0,h.visitFormulaNode)(c,r.arg).bind((function(r){var n=e.map((function(e,t){return[e,t]})).filter((function(e){return void 0!==e[0]})),a=i.__spreadArray(i.__spreadArray([],n.map((function(e){return e[0]})),!0),[r],!1);return(0,s.lambdaTerm)((function(e){return e>=d&&e<=p}),t.map((function(e){var t=e.name;return{paramNodeLabel:t.arg.label,paramNameLabel:t.arg.name.name.label,hasDef:void 0!==t.arg.def,isRest:!1}})),a,u)}))}))},e.prototype.bindNames=function(t){var r=this,n=this.context.numNames,a=[this];return t.reduce((function(t,s,u){var l=s.name;(0,o.assertTrue)("calc.runtime.bindNames: expected wff",void 0!==l.arg.wholeName);var c=t.setValue((0,d.getBoundName)(r.context.localeInfo,l.arg.wholeName),n+u);return a.push(new e(i.__assign(i.__assign({},r.context),{names:c,numNames:n+u+1}))),c}),this.context.names),a},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.noopTerm(e,r)}))},e.prototype.nameNode=function(e,t,r){var n,i=(null===(n=this.context.annotations[r])||void 0===n?void 0:n.kind)===c.AnnotationKind.AppHeadName;return S.Pledge.resolve(this.toNameTerm(e,t,i))},e.prototype.toNameTerm=function(e,t,r){var n=this,a=this.context,l=a.locals,m=a.names,f=a.numNames,g=(0,c.flattenNameParts)(e).parts;if((0,C.canDenoteLocalName)(t,g)){var h=g[0],R=g.slice(1),b=m.getEntry((0,d.getBoundName)(this.context.localeInfo,h.asWhole));if(void 0!==b){var E=b.value,P=(0,s.readStackTerm)(f-E-1,h.qualifiedLabel);return S.Pledge.resolve(R.reduce((function(e,t){return n.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)}),P))}}var k=void 0;if(null==t&&(0,F.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,F.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){var T=(0,d.getEtaFuncId)(this.context.localeInfo,e.asWhole);if(void 0!==T){var A=i.__assign({},(0,p.getWorksheetFuncType)(T));A.maxArgs=(0,v.fastMin)(254,A.maxArgs),k=(0,s.lambdaTerm)((function(e){return(0,d.isValidArgsLength)(A,e)}),[{paramNodeLabel:void 0,paramNameLabel:void 0,hasDef:!1,isRest:!0}],[(0,s.appTerm)((0,s.worksheetFunctionIdToName)(T),A,!1,[{isSpread:!0}],[(0,s.readStackTerm)(0,void 0)],(0,u.runtimePositionEtaLambdaBody)(T))],e.qualifiedLabel)}}if((0,C.canDenoteCellRef)(l,t,g)){h=g[0],R=g.slice(1);var N=null!=t&&t.kind===c.QualifierKind.Ident?(0,c.sheetQualifier)(t.name,void 0,t.isQuoted,t.label):t;P=(0,s.cellRefTerm)(h.ref,N,h.qualifiedLabel);k=R.reduce((function(e,t){return n.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)}),P)}return(0,C.canDenoteUserDefinedFunc)(r,t,e)&&(k=(0,s.udfTerm)(e.asWhole,t,k,e.qualifiedLabel)),e.canDenoteNamedObject&&(k=(0,s.nameTerm)(e.asWhole,t,r?y.NameSource.AppHead:y.NameSource.Plain,k,e.qualifiedLabel)),(0,o.assertTrue)("calc.runtime.compile: expected wff NameNode",void 0!==k),S.Pledge.resolve(k)},e.prototype.cellRefNode=function(e,t,r){return S.Pledge.resolve((0,s.cellRefTerm)(e,t,r))},e.prototype.fieldRefNode=function(e,t,r){var n=this;(0,o.assertTrue)("calc.runtime.compile: expected wff FieldRef",t.field.kind===c.NodeKind.Ident);var i=t.field.whole;return this.lazyVisitFormulaNode(e).bind((function(e){return n.toFieldRefTerm(e,i,r)}))},e.prototype.toFieldRefTerm=function(e,t,r){var n=p.WorksheetFuncId.FIELDVALUE;return(0,s.appTerm)((0,s.worksheetFunctionIdToName)(n),(0,p.getWorksheetFuncType)(n),!1,void 0,[e,(0,f.stringOper)(t)],r)},e.prototype.noopTerm=function(e,t){return this.context.locals.emitStepInfo?(0,s.noopTerm)(e,t):e},e.prototype.structRefNode=function(e,t,r){return S.Pledge.resolve((0,s.structRefTerm)((0,c.structRefNode)(e,t,r),r))},e.prototype.missingNode=function(e,t){return(0,o.assertFalse)("calc.runtime.compile: unexpected missing node")},e.prototype.badSequenceNode=function(e,t,r){return(0,o.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.badCharsNode=function(e,t,r){return(0,o.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.operatorNode=function(e,t){return S.Pledge.resolve((0,c.operatorNode)(e,t))},e.prototype.wsfNode=function(e,t,r){return S.Pledge.resolve((0,c.wsfNode)(e,t,r))},e}(),T=((n={})[p.OperatorId.At]=p.WorksheetFuncId.SINGLE,n[p.OperatorId.Pound]=p.WorksheetFuncId.ANCHORARRAY,n);var A=[function(e){if(!(0,s.isOperTerm)(e)&&e.kind===s.TermKind.App&&(0,s.isOperatorName)(e.data.funName)){var t=T[(0,s.operatorNameToId)(e.data.funName)];if(void 0!==t)return(0,s.appTerm)((0,s.worksheetFunctionIdToName)(t),(0,p.getWorksheetFuncType)(t),e.data.isFormulaRoot,e.data.args,e.children,e.position)}return e}],N=function(e,t){return t(e)},_=function(e){return A.reduce(N,e)};function I(e,t){return i.__assign(i.__assign({},e),{term:t})}function O(e,t,r){var n,i,a;try{var o=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,u=function(e,t){var r=t.annotations[t.node.label],n=m.RedBlackMapTree.create(e.stringCompareCI);if((null==r?void 0:r.kind)===c.AnnotationKind.FormulaRoot){var i=r.contextNames,a=void 0===i?[]:i;return{names:a.reduce((function(t,r,n){return t.setValue((0,d.getBoundName)(e,r.whole),n)}),n),numNames:a.length}}return{names:n,numNames:0}}(o,r),l=u.names,p=u.numNames,f={globals:e,locals:t,localeInfo:o,annotations:r.annotations,names:l,numNames:p},v=(0,h.reducePledge)(new k(f),r),S=(a=v,(0,s.transformBottomUp)(a,_));return(0,g.success)(I(r,S))}catch(e){return e instanceof R?(0,g.failure)(e.reason):(0,g.failure)((0,g.javaScriptError)(e))}}t.compiledFormula=I,t.compiledFormulaTerm=function(e,t){return"object"!=typeof t.term?(0,o.assertFalse)("".concat(e,": expected known compiled formula type; given ").concat((0,a.anonymize)(t))):t.term},t.createCompiler=function(e){return{compileFormula:function(t,r){return O(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDenoteCellRef=t.canDenoteUserDefinedFunc=t.canDenoteLocalName=t.resolveGridRef=t.createResolver=void 0;var n=r(3);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef,t.canDenoteLocalName=n.resolveService.canDenoteLocalName,t.canDenoteUserDefinedFunc=n.resolveService.canDenoteUserDefinedFunc,t.canDenoteCellRef=n.resolveService.canDenoteCellRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dereferenceOpers=t.dereferenceOper=t.dereference=t.getCellValuesAsArray=void 0;var n=r(10),i=r(74),a=r(45),o=r(75),s=r(44),u=r(16),l=r(28),c=r(27),d=r(24),p=r(8),m=r(25),f=r(7),g=r(19),h=r(67),v=r(18),S=r(26);function y(e,t){var r=t.map.getValue(e);if(void 0!==r){var n=(0,h.recordCellCycle)(r,t.current);return(0,u.throwEvaluationError)(n)}}function F(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===S.ResultKind.Failure)return(0,u.throwEvaluationError)(n.reason);var i=n.value;if(i.kind===s.CellKind.FinalValue)return i.oper;y(i.anchor,e.visitedCells),r.push(i.anchor)}function C(e,t,r,i){var o;if(e.precedents.cells.push(t),!i||(0,f.gridRangeSize)(t.range)<=16)o=t;else{var l=e.globals.getUsedRange(t.sheet),c=void 0;(0,S.isSuccess)(l)?c=null==l.value?void 0:l.value.range:(0,u.throwEvaluationError)(l.reason);var d=void 0===c?void 0:(0,f.gridRangeIsect)(t.range,(0,g.gridRange)(0,0,c.row+c.rows,c.col+c.cols));if(void 0===d)return new a.StrictSparseArray2D(t.range.rows,t.range.cols,0,0,[],p.blankOper);o=(0,g.sheetGridRange)(t.sheet,d)}var h=e.globals.getCellValues(o);if(h.kind===S.ResultKind.Failure)return(0,u.throwEvaluationError)(h.reason);var v=r.length,F=function(e,t,r,i,o){var u=[],l=i.length,c=0;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",l===r.rows);for(var d=0;d<l;d+=1){u.push([]);var g=i[d].length;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",g===r.cols),c=0===d?g:(0,m.fastMin)(g,c);for(var h=0;h<g;h+=1){var v=i[d][h];s.CellKind.FinalValue===v.kind?u[d][h]=v.oper:(y(v.anchor,e.visitedCells),(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,f.isSheetIndexEqual)(v.anchor.sheet,t.sheet)),o.push(v.anchor),u[d][h]=p.refErrorOper)}}return new a.StrictSparseArray2D(t.range.rows,t.range.cols,l,c,u,p.blankOper)}(e,t,o.range,h.value,r);return v===r.length?F:void 0}function R(e,t,r){var n=C(e,t,r,!1);if(null!=n)return(0,p.arrayOper)(n.rows,n.cols,n.rows===n.denseRows&&n.cols===n.denseCols?n.denseElements:(0,a.array2DToJaggedArray)(n))}function b(e,t,r,n){if(0!=(r&v.OperKind.Range))return t;if(!(0,f.isRangeOper)(t))return t;var a=t.sheets;if(!(0,f.isSheetIndex)(a))return(0,c.traceErrorOper)("calc.runtime.dereference",p.ErrorType.REF,"3D range, oper = ".concat((0,o.anonymize)(t))),p.refErrorOper;if(1!==t.ranges.length)return(0,c.traceErrorOper)("calc.runtime.dereference",p.ErrorType.VALUE,"union range, oper = ".concat((0,o.anonymize)(t))),p.valueErrorOper;var s=t.ranges[0];if(0!=(r&l.singleReadOperType)){if((0,f.isGridCell)(s))return F(e,(0,g.sheetGridCell)(a,s),n);if(e.locals.implicitIntersect&&(0,i.isFeatureEnabled)(i.FeatureName.CalcLegacyImplicitIntersection)&&!(0,i.isFeatureEnabled)(i.FeatureName.CalcPreventSpillingHack)){var d=e.locals.originGridCell;if(!(0,S.isSuccess)(d))return(0,u.throwEvaluationError)(d.reason);var m=(0,f.gridCellImplicitIsect)(d.value,s);return null==m?((0,c.traceErrorOper)("calc.runtime.dereference",p.ErrorType.VALUE,"empty intersection, oper = ".concat((0,o.anonymize)(t))),p.valueErrorOper):F(e,(0,g.sheetGridCell)(a,m),n)}return R(e,(0,g.sheetGridRange)(a,s),n)}return 0!=(r&v.OperKind.Array)?R(e,(0,g.sheetGridRange)(a,s),n):((0,c.traceErrorOper)("calc.runtime.dereference",p.ErrorType.VALUE,"bad target type ".concat(r)),p.valueErrorOper)}t.getCellValuesAsArray=C,t.dereference=b,t.dereferenceOper=function(e,t,r){var i=[],a=b(e,t,r,i);if(null==a){if(i.length>0)return(0,u.throwEvaluationError)((0,u.unevaluated)(i));var s=(0,o.anonymize)(t),l="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ".concat(s);return n.ulsLogger.ULS.assertTag(595980819,d.LogCategory.msoulscat_ES_EWAJS,!1,l)}return a},t.dereferenceOpers=function(e,t,r){for(var n=[],i=0;i<t.length;i+=1){var a=b(e,t[i],(0,f.getArgType)(r,i,t.length),n);null!=a&&(t[i]=a)}if(n.length>0)return(0,u.throwEvaluationError)((0,u.unevaluated)(n))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyOperator=t.cmpNum=t.cmpStr=t.cmpBool=t.cmpInt=void 0;var n=r(75),i=r(27),a=r(118),o=r(8),s=r(10),u=r(34),l=r(18),c=r(19),d=r(7),p=r(27);function m(e,r,n){return(0,t.cmpInt)(e,r.value-n.value)}function f(e,r,n,i){return(0,t.cmpInt)(r,e.stringCompareCI(n.value,i.value))}function g(e,r,n,i){return(0,t.cmpInt)(r,e.compare(n,i))}function h(e,t,r){if((0,d.isSheetIndex)(t.sheets))if((0,d.isSheetIndex)(r.sheets))if((0,d.isDocumentLocEqual)(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return(0,c.sheetIndex)(t.sheets.document,t.sheets.index);a="different sheet, range1 = ".concat((0,n.anonymize)(t),", range2 = ").concat((0,n.anonymize)(r));(0,i.traceErrorOper)(e,o.ErrorType.VALUE,a)}else{var a="different document, range1 = ".concat((0,n.anonymize)(t),", range2 = ").concat((0,n.anonymize)(r));(0,i.traceErrorOper)(e,o.ErrorType.VALUE,a)}else(0,i.traceErrorOper)(e,o.ErrorType.VALUE,"3D reference, range2 = ".concat((0,n.anonymize)(r)));else(0,i.traceErrorOper)(e,o.ErrorType.VALUE,"3D reference, range1 = ".concat((0,n.anonymize)(t)))}t.cmpInt=d.applyComparison,t.cmpBool=m,t.cmpStr=f,t.cmpNum=g,t.applyOperator=function(e,r,c,v){void 0===v&&(v=!1);var S,y,F,C=e.config.mathpack;if(1===c.length){var R=c[0];switch(r){case u.OperatorId.Percent:return C.percent(R);case u.OperatorId.Neg:return C.neg(R);case u.OperatorId.Pos:return R;default:var b="bad application of ".concat(r," to 1 argument"),E="calc.runtime.applyOperator: ".concat(b);return s.ulsLogger.ULS.assertTag(593372496,a.LogCategory.msoulscat_ES_EWAJS,!1,E)}}if(2===c.length){R=c[0];var P=c[1];switch(r){case u.OperatorId.Add:var k=C.add(R,P);return v&&(0,d.isNumberOper)(k)?C.checkAlmostCancellation(R,k):k;case u.OperatorId.Sub:k=C.sub(R,P);return v&&(0,d.isNumberOper)(k)?C.checkAlmostCancellation(R,k):k;case u.OperatorId.Mul:return C.mul(R,P);case u.OperatorId.Div:return C.div(R,P);case u.OperatorId.Pow:return C.power(R,P);case u.OperatorId.Concat:return(0,o.stringOper)((R.value+P.value).substring(0,o.cellStringLimit));case u.OperatorId.Eq:case u.OperatorId.Ne:case u.OperatorId.Lt:case u.OperatorId.Le:case u.OperatorId.Gt:case u.OperatorId.Ge:return(0,o.booleanOper)(function(e,r,n,i){var a=e.config,s=a.localeInfo,u=a.mathpack;if(n.kind!==i.kind){if((0,d.isBlankOper)(n))switch(i.kind){case l.OperKind.Number:return g(u,r,u.zero,i);case l.OperKind.String:return f(s,r,p.emptyStringOper,i);case l.OperKind.Boolean:return m(r,o.falseOper,i)}if((0,d.isBlankOper)(i))switch(n.kind){case l.OperKind.Number:return g(u,r,n,u.zero);case l.OperKind.String:return f(s,r,n,p.emptyStringOper);case l.OperKind.Boolean:return m(r,n,o.falseOper)}return(0,t.cmpInt)(r,n.kind-i.kind)}switch(n.kind){case l.OperKind.Number:return g(u,r,n,i);case l.OperKind.String:return f(s,r,n,i);case l.OperKind.Boolean:return m(r,n,i);case l.OperKind.Blank:return(0,t.cmpInt)(r,0);default:return!1}}(e,r,R,P));case u.OperatorId.Range:return function(e,t){var r=h("calc.runtime.applyRangeOp",e,t);if(null==r)return o.valueErrorOper;var n=(0,d.gridRangesJoin)(e.ranges),i=(0,d.gridRangesJoin)(t.ranges),a=[(0,d.gridRangeJoin)(n,i)];return(0,o.rangeSeqOper)(r,a)}(R,P);case u.OperatorId.Isect:return function(e,t){var r=h("calc.runtime.applyIsectOp",e,t);if(null==r)return o.valueErrorOper;for(var a=[],s=0;s<e.ranges.length;s+=1)for(var u=0;u<t.ranges.length;u+=1){var l=(0,d.gridRangeIsect)(e.ranges[s],t.ranges[u]);null!=l&&a.push(l)}if(0===a.length){var c="empty intersection, range1 = ".concat((0,n.anonymize)(e),", range2 = ").concat((0,n.anonymize)(t));return(0,i.traceErrorOper)("calc.runtime.applyIsectOp",o.ErrorType.NULL,c),o.nullErrorOper}return(0,o.rangeSeqOper)(r,a)}(R,P);case u.OperatorId.Union:return null==(F=h("calc.runtime.applyUnionOp",S=R,y=P))?o.valueErrorOper:(0,o.rangeSeqOper)(F,S.ranges.concat(y.ranges));case u.OperatorId.And:return(0,o.booleanOper)(R.value&&P.value);case u.OperatorId.Or:return(0,o.booleanOper)(R.value||P.value);case u.OperatorId.Xor:return(0,o.booleanOper)(R.value!==P.value);case u.OperatorId.Min:return C.cond2(R,P)<=0?R:P;case u.OperatorId.Max:return C.cond2(R,P)>=0?R:P;default:var T="bad application of ".concat(r," to 2 arguments"),A="calc.runtime.applyOperator: ".concat(T);return s.ulsLogger.ULS.assertTag(593372497,a.LogCategory.msoulscat_ES_EWAJS,!1,A)}}var N="bad application of ".concat(r," to ").concat(c.length," arguments"),_="calc.runtime.applyOperator: ".concat(N);return s.ulsLogger.ULS.assertTag(593372498,a.LogCategory.msoulscat_ES_EWAJS,!1,_)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluationRuntime=t.runtimeTimer=t.calculateNextDeadline=t.createSchedule=void 0;var n=r(10),i=r(44),a=r(25),o=r(28),s=r(85),u=r(26);function l(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=(0,a.now)()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:(0,a.fastMin)(e.endTimeMs,t)}}t.createSchedule=function(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:(0,a.now)()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}},t.calculateNextDeadline=l,t.runtimeTimer=function(){return{doTimeout:function(e){return void 0!==e&&(0,a.now)()>=e}}};var c={kind:i.ReasonKind.Timeout},d={kind:i.ReasonKind.Breakpoint},p=function(){function e(e,t){(0,n.assertPositiveInteger)("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new o.MachineRuntime(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===i.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(l(e));return Array.isArray(r)?Promise.resolve(r):((0,n.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",r.kind===i.ReasonKind.Timeout),new Promise((function(r,n){return e.scheduleFunction((function(){try{r(t.evaluateAsync(e))}catch(e){n(e)}}))})))}catch(e){return Promise.reject(e)}},e.prototype.evaluateSync=function(e){var t=this,r=function(a){if(t.context.globals.interruptToken[0]===i.Interrupt.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var o=t.evaluate(a);if(Array.isArray(o))return o;switch(o.kind){case i.ReasonKind.Timeout:return(0,i.paused)((function(t){return r(null!=t?t:l(e))}));case i.ReasonKind.Breakpoint:return(0,i.breaked)((function(){return r(l(e))}));default:return(0,n.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",o)}};return r(l(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var i=this.machineRuntimes[this.results.length].run(r);if(i.kind===o.TransitionKind.Next)return c;if(i.kind===o.TransitionKind.Break)return d;this.pushResult(i)}return this.results}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error ".concat((0,s.messageFromError)(e));return(0,n.assertFalse)(a)}},e.prototype.pushResult=function(e){return this.results.push(e),o.nextTransition},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,u.failure)(i.stopped))},e}();t.EvaluationRuntime=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCellEvaluationMachine=void 0;var n=r(10),i=r(44),a=r(16),o=r(16),s=r(28),u=r(26),l=r(67),c=r(67),d=r(19),p=r(137),m=r(8),f=r(75),g=r(7),h=r(27),v=r(76),S=r(74),y=function(){function e(e,t,r,n){this.context=e,this.stepConfig=t,this.visitedCells=r,this.cell=n}return e.prototype.evalCell=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===u.ResultKind.Failure)return{kind:a.CellEvaluationResultKind.ReadFailure,failure:e};var t=e.value;if(t.kind===i.CellKind.FinalValue)return{kind:a.CellEvaluationResultKind.ReadOper};var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===u.ResultKind.Failure){var d="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return(0,n.assertFalse)(d)}var m=r.value;if(null==m){var g="client error: expected getCellFormula(".concat((0,f.anonymize)(t.anchor),") != null");d="calc.runtime.CellEvaluationMachine.next: ".concat(g);return(0,n.assertFalse)(d)}var h=this.visitAnchor(m),v=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,o.evalLocalsGrid)(h.source),h.precedents,(0,c.appendVisitedCell)(this.visitedCells,h),l.emptyVisitedNames,s.readOperType,m.formula);return p.Pledge.fromMachine(v).bind(this.receiveSuccess(h)).catch(this.receiveFailure(h))},e.prototype.visitAnchor=function(e){var t=(0,g.sheetGridRangeAnchor)(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){var i="unexpected visitValue at ".concat((0,f.anonymize)(t),"; given ").concat((0,f.anonymize)(r)),a="calc.runtime.CellEvaluationMachine.visitAnchor: ".concat(i);return(0,n.assertFalse)(a)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:(0,o.bottomEvalPrecedents)()}},e.prototype.receiveSuccess=function(e){var t=this;return function(r){if((0,g.isRangeOper)(r)||(0,g.isMissingOper)(r)){var i="expected ReadOper; given ".concat((0,f.anonymize)(r)),a="calc.runtime.CellEvaluationMachine.receiveSuccess: ".concat(i);return(0,n.assertFalse)(a)}return t.writeSuccess(e.source,r,e.precedents)}},e.prototype.receiveFailure=function(e){var t=this;return function(r){var n=r.kind===i.ReasonKind.PreviousFailure&&void 0!==e.cycle?e.cycle:r;return t.writeFailure(e.source,n,e.precedents)}},e.prototype.writeSuccess=function(e,t,r){return this.setCellValue(e,t,r),{kind:a.CellEvaluationResultKind.WroteOper,source:e}},e.prototype.writeFailure=function(e,t,r){return this.context.globals.setCellFailure(e.range,t,r),{kind:a.CellEvaluationResultKind.WroteFailure,source:e}},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,i=(0,g.isBlankOper)(t)?n:t;if(e.kind===d.LexicalKind.Cell){if((0,g.isArrayOper)(i)){var a=void 0===i.opers[0]?m.naErrorOper:i.opers[0][0],o=(0,g.isBlankOper)(a)?n:a;if(!this.isLambdaEnabled(e,o,r))return;return this.context.globals.setCellValue(e.range,o,r)}if(!this.isLambdaEnabled(e,i,r))return;return this.context.globals.setCellValue(e.range,i,r)}var s=e.range.range,u=(0,h.broadcastWriteOper)(s.rows,s.cols,i).opers,l=function(e){return(0,g.isBlankOper)(e)?n:e},c=u.map((function(e){return e.map(l)}));if(this.isLambdaEnabled(e,c,r))return this.context.globals.setCellValues(e.range,c,r)},e.prototype.isLambdaEnabled=function(e,t,r){return!((Array.isArray(t)?t.some((function(e){return e.some((function(e){return e instanceof v.LambdaOper}))})):t instanceof v.LambdaOper)&&!(0,S.isFeatureEnabled)(S.FeatureName.CalcLambdaCellValues))||(this.context.globals.setCellFailure(e.range,(0,g.notImplemented)(["LAMBDA cell values"]),r),!1)},e}();t.createCellEvaluationMachine=function(e,t,r,n){return p.Pledge.try((function(){return new y(e,t,r,n).evalCell()}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCallTermEvaluationMachine=t.createFormulaEvaluationMachine=void 0;var n=r(10),i=r(44),a=r(16),o=r(16),s=r(16),u=r(16),l=r(16),c=r(16),d=r(25),p=r(28),m=r(26),f=r(67),g=r(19),h=r(19),v=r(8),S=r(75),y=r(7),F=r(27),C=r(76),R=r(74),b=r(68),E=r(264),P=r(183),k=r(18),T=r(180),A=r(181),N=r(27),_=r(179),I=r(119),O=r(34),M=function(){return(0,c.throwEvaluationError)((0,y.notImplemented)(["LETREC cycle"]))};function D(e,t){return{context:e,holeIndex:0,locals:t}}var w=function(){function e(e,t,r,i,a,o,s,u,c,d,p){this.context=e,this.stepConfig=t,this.locals=r,this.precedents=i,this.visitedCells=a,this.visitedNames=o,this.usage=s,this.target=u,this.isNested=c,this.runStatus=!1,this.stackEnv=l.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.continuation=[],d.kind!==b.TermKind.CallLambda&&d.kind!==b.TermKind.CallFirstOrderFunc?(this.term=null!=t?(0,b.noopTerm)(d,void 0):d,this.caller=void 0):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.constructor: no preStep for CallTerm",void 0===d.position),this.term=d,this.caller=d.data.caller.caller),this.initialLambdaDepth=s.lambdaDepth,p.length>0&&(this.stackEnv=p.reduce((function(e,t){var r=t.value;return e.setValue(e.getCount(),r)}),this.stackEnv),this.stackMapLabels=p.map((function(e){return e.label})),this.stackMapNumPushed=p.length)}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof c.EvaluationError)return(0,c.handleEvaluationError)(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return(0,m.isSuccess)(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if((0,b.isOperTerm)(this.term)){var e=this.continuation;if(0===e.length){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);var t=(0,P.dereferenceOper)(this,this.term,this.target),r=(0,T.coerceOper)(this,t,this.target);return this.precedents.bound=v.PrecsBound.Exact,!(0,R.isFeatureEnabled)(R.FeatureName.CalcPreventSpillingHack)||this.isNested||this.locals.lexicalSource.kind!==h.LexicalKind.Cell||!(0,y.isArrayOper)(r)||1===r.rows&&1===r.cols?(0,m.success)(r):(0,m.failure)((0,y.notImplemented)(["spilling"]))}var i=e[e.length-1];return this.applyContinuation(this.term,i)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r,i,a=t.context;switch(a.kind){case b.TermKind.App:var o=t.holeIndex,s=a.children.length;(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",o<=s);var u=t.locals;return o===s?((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,y.isMissingOper)(e)),this.dispatchFunction(u,a.data,a.position)):(!0===(null===(r=a.data.args[o])||void 0===r?void 0:r.isSpread)?((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",e instanceof E.RestArgsOper),(0,d.safePush)(u,e.opers)):((0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",!(e instanceof E.RestArgsOper)),u.push(e)),o+1<s?this.nextHoleTransition(t,a.children[o+1]):this.nextHoleTransition(t,v.missingOper));case b.TermKind.Conditional:if(0===(C=t.holeIndex)){var l=(0,b.worksheetFunctionNameToId)(a.data.funName),c=l===O.WorksheetFuncId.IF?k.OperKind.Boolean:k.OperKind.Number,p=(0,P.dereferenceOper)(this,e,c);if((0,y.isArrayOper)(p))return t.locals=[p],this.nextHoleTransition(t,a.children[C+1]);if((0,y.isRichOper)(p))return(0,m.failure)((0,y.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(p=(0,T.coerceOper)(this,p,c),l===O.WorksheetFuncId.IF&&(0,y.isBooleanOper)(p))return this.popContextTransition(a.children[p.value?1:2]);if(l===O.WorksheetFuncId.CHOOSE&&(0,y.isNumberOper)(p)){var f=this.context.globals.config.mathpack.fix(p);if(f<1||f>a.children.length-1){var g="CHOOSE; out of bounds option = ".concat((0,S.anonymize)(f));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",v.ErrorType.VALUE,g),this.popContextTransition(v.valueErrorOper)}return this.popContextTransition(a.children[f])}return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,y.isErrorOper)(p)),this.popContextTransition(p)}return(u=t.locals)[C]=e,C+1<a.children.length?this.nextHoleTransition(t,a.children[C+1]):this.dispatchFunction(u,a.data,a.position);case b.TermKind.CallName:var h=t.locals;return this.locals=h.locals,this.caller=h.caller,this.restoreStack(h),this.visitedNames=h.visitedNames,this.popContextTransition(e);case b.TermKind.Let:var C=t.holeIndex,R=a.children.length-1;if(C>=R){h=t.locals;return this.restoreStack(h),this.popContextTransition(e)}if(a.data.rec){var A=this.stackEnv.getCount()-R+C;this.stackEnv.getValue(A).value=e,this.stackEnv=this.stackEnv.setValue(A,e)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),e),this.stackMapNumPushed+=1;return C+1>=R&&this.isLetTcoPossible()?this.popContextTransition(a.children[C+1]):this.nextHoleTransition(t,a.children[C+1]);case b.TermKind.Array:var _=(0,P.dereferenceOper)(this,e,F.writeOperType),I=a.data,M=I.rows,D=I.cols,w=t.holeIndex,L=w%D,x=D===L+1,K=(w-L)/D,U=t.locals;if(U[K][L]=(0,T.coerceOper)(this,_,F.writeOperType),M===K+1&&x)return this.popContextTransition((0,v.arrayOper)(M,D,U));var B=x?K+1:K,W=x?0:L+1;return this.nextHoleTransition(t,a.children[B][W]);case b.TermKind.CallLambda:h=t.locals;return this.locals=h.locals,this.caller=h.caller,this.restoreStack(h),this.usage.lambdaDepth-=1,this.popContextTransition(e);case b.TermKind.CallFirstOrderFunc:h=t.locals;return this.locals=h.locals,this.caller=h.caller,this.restoreStack(h),this.popContextTransition(e);case b.TermKind.PostStep:var G=t.locals;return null===(i=this.stepConfig)||void 0===i||i.postStep(G,e),this.popContextTransition(e);default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",a)}},e.prototype.reduceFormula=function(e){var t,r,o;switch(e.kind){case b.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case b.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case b.TermKind.App:var s=e.data.funName;if(!(0,b.isOperatorName)(s)){var u=(0,b.worksheetFunctionNameToId)(s);if(u!==O.WorksheetFuncId._UDF){var d=this.globals.getWorksheetFunc(u);if(d.kind===m.ResultKind.Failure)return(0,c.throwEvaluationError)(d.reason)}}if(0===e.children.length){var f=new E.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(e.position),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(s,e.data.funType,e.data.isFormulaRoot,[]);return this.updateTermTransition(f)}return this.pushContextTransition(e,e.children[0],[]);case b.TermKind.CallLambda:var h=this.isCallLambdaTcoPossible();if(this.usage.lambdaCalls[0]+1>(null!==(t=this.globals.limits.maxLambdaCalls)&&void 0!==t?t:1/0))return(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.LambdaCalls));if(!h&&this.usage.lambdaDepth+1>(null!==(r=this.globals.limits.maxLambdaDepth)&&void 0!==r?r:1/0))return(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.LambdaDepth));h||(this.usage.lambdaDepth+=1),this.usage.lambdaCalls[0]+=1;var v=this.stackEnv;this.stackEnv=e.data.capturedStackEnv;var S=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=e.data.capturedStackMap;var y=this.locals;this.locals=(0,c.evalLocalsLambda)(e.data.capturedLocals,this.locals);var F=this.caller;return this.switchCaller(e.data.caller,h),h?this.updateTermTransition(e.children):this.pushContextTransition(e,e.children,{locals:y,caller:F,stackEnv:v,stackMap:S});case b.TermKind.CallFirstOrderFunc:y=this.locals;this.locals=(0,a.evalLocalsFirstOrderFunc)(e.data.source,this.locals);F=this.caller;this.switchCaller(e.data.caller,!1);v=this.stackEnv;this.stackEnv=l.emptyStackEnv;S=this.stackMapList();return this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.pushContextTransition(e,e.children,{locals:y,caller:F,stackEnv:v,stackMap:S});case b.TermKind.CallMachine:return(0,p.callMachineTransition)(e.data.machine,this);case b.TermKind.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case b.TermKind.Let:var R=e.children.length-1;if(0===R)return this.updateTermTransition(e.children[0]);v=this.stackEnv,S=this.stackMapList();if(this.stackMapLabels=e.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=S,e.data.rec){for(var P=0;P<R;P+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new l.LazyOper(M));this.stackMapNumPushed+=R}return this.pushContextTransition(e,e.children[0],{stackEnv:v,stackMap:S});case b.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(e));case b.TermKind.CallName:var k=e.data.loc,T=this.checkForNameCycle(k),A=this.stackFrameList(e.position);y=this.locals;this.locals=(0,c.evalLocalsName)((0,g.lexicalSourceName)(k),y);F=this.caller;this.switchCaller(A,!1);v=this.stackEnv;this.stackEnv=l.emptyStackEnv;S=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;var N=this.visitedNames;return this.visitedNames=T,this.pushContextTransition(e,e.children,{locals:y,caller:F,stackEnv:v,stackMap:S,visitedNames:N});case b.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case b.TermKind.ReadStack:var _=this.stackEnv.getValue(this.stackEnv.getCount()-1-e.data);return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",void 0!==_),this.updateTermTransition(_ instanceof l.LazyOper?_.value:_);case b.TermKind.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case b.TermKind.Lambda:return this.updateTermTransition(new C.LambdaOper(e.data.checkArity,e.position,null!==(o=e.data.params)&&void 0!==o?o:[],this.locals,this.stackEnv,this.stackMapList(),e.children));case b.TermKind.Noop:return this.updateTermTransition(e.children);default:return(0,n.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=t.funName,i=t.funType,a=t.isFormulaRoot;(0,P.dereferenceOpers)(this,e,i);var o=new E.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(r),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,i,a,e);return this.popContextTransition(o)},e.prototype.stackFrameList=function(e){return(0,s.stackFrameList)(this.locals.lexicalSource,e,this.stackEnv,this.stackMapList(),this.caller)},e.prototype.stackMapList=function(){return void 0!==this.stackMapLabels&&0!==this.stackMapNumPushed?(0,o.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext},e.prototype.noopTerm=function(e,t){return null!=this.stepConfig?(0,b.noopTerm)(e,t):e},e.prototype.pushContextTransition=function(e,t,r){var n=D(e,r);return this.continuation.push(n),this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){if(this.term=e,null!=this.stepConfig&&!(0,b.isOperTerm)(e)&&void 0!==e.position&&e.kind!==b.TermKind.Name&&e.kind!==b.TermKind.Udf){var t=(r=this.locals.lexicalSource,n=e.position,a=this.stackEnv,o=this.stackMapList(),l=this.caller,c=(0,s.stackFrameList)(r,n,a,o,l),{stack:new u.ES5IterableStackFrame(c)});if(this.continuation.push(D(b.postStepTerm,t)),this.stepConfig.preStep(t)===i.StepAction.Break)return p.breakTransition}var r,n,a,o,l,c;return p.nextTransition},e.prototype.switchCaller=function(e,t){(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.switchCaller: correct nesting",e.caller===this.caller),t||(this.caller=e)},e.prototype.restoreStack=function(e){var t,r=e.stackEnv,n=e.stackMap;this.stackEnv=r,this.stackMapLabels=null==n?void 0:n.labels,this.stackMapNumPushed=null!==(t=null==n?void 0:n.numPushed)&&void 0!==t?t:0,this.stackMapNext=null==n?void 0:n.next},e.prototype.isLetTcoPossible=function(){var e=this.continuation[this.continuation.length-2];if(void 0===e)return!1;var t=e.context;return t.kind===b.TermKind.Let?e.holeIndex>=t.children.length-1:t.kind===b.TermKind.CallLambda||t.kind===b.TermKind.CallName},e.prototype.isCallLambdaTcoPossible=function(){var e=this.continuation[this.continuation.length-1];return void 0!==e&&e.context.kind===b.TermKind.CallLambda},e.prototype.getNameFormulaAsTerm=function(e,t){var r=this.globals.getNameFormula(e,t);if(r.kind===m.ResultKind.Failure)return(0,c.throwEvaluationError)(r.reason);var n=r.value;return null!=n?(0,A.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);if(void 0!==n){var a=(0,f.recordNameCycle)(n,r.current);return(0,c.throwEvaluationError)(a)}return this.visitedNames.map.getCount()+1>(null!==(t=this.globals.limits.maxNameChain)&&void 0!==t?t:1/0)?(0,c.throwEvaluationError)((0,i.limitExceeded)(i.LimitKind.NameChain)):(0,f.appendVisitedName)(this.visitedNames,e)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,(0,I.nameNode)((0,I.identNamePart)(e.data.name,!0),e.data.qualifier),e.data.source),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.names,n),!(0,m.isSuccess)(r)){if(r.reason.kind===_.ResolveReasonKind.NoOriginSheet){var a="error ref, no sheet, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",v.ErrorType.REF,a),this.noopTerm(v.refErrorOper,e.position)}var o=e.children;return r.reason.kind===_.ResolveReasonKind.InvalidQualifier&&void 0!==o?o:(0,c.throwEvaluationError)(r.reason)}var s,u=r.value;if(void 0===u||void 0===(s=this.getNameFormulaAsTerm(u,e.data.source))){if(void 0===(o=e.children)){a="error ref, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",v.ErrorType.NAME,a),this.noopTerm(v.nameErrorOper,e.position)}return o}return(0,b.callNameTerm)(u,this.noopTerm(s,i.runtimePositionFormulaRoot),e.position)},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,(0,I.cellRefNode)(e.data.ref,e.data.qualifier)).resolution;if(!(0,m.isSuccess)(t)){if(t.reason.kind===_.ResolveReasonKind.NoOriginSheet){var r="error ref, no sheet, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",v.ErrorType.REF,r),v.refErrorOper}return(0,c.throwEvaluationError)(t.reason)}var n=t.value;if(!n){r="error ref, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",v.ErrorType.REF,r),v.refErrorOper}return(0,v.range3DOper)(n.sheet,n.range)},e.prototype.evalStructRefTerm=function(e){var t=this.context.resolver.resolveStructRef(this.locals,e.data),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.names,n),!(0,m.isSuccess)(r)){if(r.reason.kind===_.ResolveReasonKind.NoOriginSheet){var i="error ref, no sheet, struct ref = ".concat((0,S.anonymize)(e.data));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",v.ErrorType.REF,i),v.refErrorOper}if(r.reason.kind===_.ResolveReasonKind.EmptyIntersection){i="error ref, empty intersection, struct ref = ".concat((0,S.anonymize)(e.data));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",v.ErrorType.VALUE,i),v.valueErrorOper}return(0,c.throwEvaluationError)(r.reason)}var a=r.value;if(!a){i="error ref, struct ref = ".concat((0,S.anonymize)(e.data));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",v.ErrorType.REF,i),v.refErrorOper}return(0,v.range3DOper)(a.sheet,a.range)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,I.nameNode)((0,I.identNamePart)(e.data.name,!0),e.data.qualifier)),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.udfs,n),!(0,m.isSuccess)(r)){var i=e.children;if(r.reason.kind===_.ResolveReasonKind.InvalidQualifier&&void 0!==i)return i;(0,c.throwEvaluationError)(r.reason)}var a=r.value;if(!a){if(void 0===(i=e.children)){var o="UDF resolution, qualifier = ".concat((0,S.anonymize)(e.data.qualifier));return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",v.ErrorType.NAME,o),this.noopTerm(v.nameErrorOper,e.position)}return i}if(a.length>1){o="UDF resolution, ambiguous name";return(0,N.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",v.ErrorType.NAME,o),this.noopTerm(v.nameErrorOper,e.position)}var s=a[0],u=this.globals.getUserDefinedFunc(s);return(0,m.isSuccess)(u)||(0,c.throwEvaluationError)(u.reason),new E.UdfOper(s,u.value)},e}();t.createFormulaEvaluationMachine=function(e,t,r,a,o,s,u,l){var d,p=r.contextNames,m=void 0===p?[]:p,f=l.annotations[l.node.label],g=null!==(d=(null==f?void 0:f.kind)===I.AnnotationKind.FormulaRoot?f.contextNames:void 0)&&void 0!==d?d:[];return(0,n.assertTrue)("calc.runtime.FormulaEvaluationMachine.createFormulaEvaluationMachine: contextNames",g.length===m.length&&m.every((function(e,t){return e.label===g[t].label}))),new w(e,t,r,a,o,s,(0,c.evalUsage)([0],0),u,!1,(0,b.noopTerm)((0,A.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",l),i.runtimePositionFormulaRoot),m)},t.createCallTermEvaluationMachine=function(e,t,r,n,i,a,o,s){return new w(e,t,r,n,i,a,(0,c.evalUsage)(o.lambdaCalls,o.lambdaDepth),k.SignatureType.All,!0,s,[])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;var n=r(38);t.createNumberFormatter=n.formatService.createNumberFormatter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(1);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.countCodePoints=t.codePointIterator=void 0;var n=r(1);t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xmatch=t.xlookup=t.makeWildcardComparer=t.vlookup=t.hlookup=t.lookup=t.match=t.linearSearch=t.binarySearch=t.makeLookupComparer=t.index=void 0;var n=r(34),i=r(8),a=r(84),o=r(7),s=r(10),u=r(16),l=r(138),c=r(19),d=r(45),p=r(25),m=r(18),f=r(280);function g(e,t){var r=t[0],n=t[1],a=t[2],u=t[3],l=e.mathpack,d=l.sfix(n);if(d<0)return i.valueErrorOper;var f=void 0===a?void 0:l.sfix(a);if(void 0!==f&&f<0)return i.valueErrorOper;var g,h,v=void 0===u?0:l.sfix(u)-1;if(v<0)return i.valueErrorOper;switch(r.kind){case m.OperKind.Range:if(!(0,o.isSheetIndex)(r.sheets))return i.valueErrorOper;if(v>=r.ranges.length)return i.refErrorOper;var S=r.ranges[v];if(void 0===f)if(1===S.rows)g=0,h=d-1;else{if(1!==S.cols)return i.refErrorOper;g=d-1,h=-1}else g=d-1,h=f-1;if(g>=S.rows||h>=S.cols)return i.refErrorOper;var y=(0,c.gridRange)(S.row+(0,p.fastMax)(g,0),S.col+(0,p.fastMax)(h,0),-1===g?S.rows:1,-1===h?S.cols:1);return(0,i.rangeSeqOper)(r.sheets,[y]);case m.OperKind.Array:return v>0?i.refErrorOper:(void 0===f?1===r.rows?(g=0,h=d-1):(g=d-1,h=-1):(g=d-1,h=f-1),g>=r.rows||h>=r.cols?i.refErrorOper:-1===g&&-1===h?r:-1===g?(0,i.arrayOper)(r.rows,1,r.opers.map((function(e){return[e[h]]}))):-1===h?(0,i.arrayOper)(1,r.cols,[r.opers[g]]):r.opers[g][h]);default:return(0,s.assertNever)("calc.funcs.lookupFuncs: INDEX",r)}}t.index=g;var h,v,S=function(e){return e<0?n.OperatorId.Lt:e>0?n.OperatorId.Gt:n.OperatorId.Eq};function y(e,t,r){void 0===r&&(r=!1);var i,a=e.config,c=a.localeInfo,d=a.mathpack;switch(t.kind){case m.OperKind.Number:i=function(e){return{correctType:!0,sgnT:(r=d,n=e,i=t,S(r.cond2(n,i)))};var r,n,i};break;case m.OperKind.String:if(r){var p=new l.WildExp(c,t.value);i=function(e){return{correctType:!0,sgnT:p.test(e.value)?n.OperatorId.Eq:n.OperatorId.Ne}}}else i=function(e){return{correctType:!0,sgnT:S(c.stringCompareCI(e.value,t.value))}};break;case m.OperKind.Boolean:i=function(e){return{correctType:!0,sgnT:(r=e.value,n=t.value,S(r-n))};var r,n};break;case m.OperKind.Rich:return(0,u.throwEvaluationError)((0,o.notImplemented)(["lookup with rich value condition"]));case m.OperKind.Blank:i=function(){return{correctType:!0,sgnT:n.OperatorId.Eq}};break;default:return(0,s.assertNever)("calc.funcs.makeLookupComparer",t)}return function(e){var r=(0,o.isRichOper)(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:n.OperatorId.Ne}:i(r)}}function F(e,t,r){for(var i=!1,a=r.length-1,o=Math.floor((0+a)/2),s=0,u=a,l=y(e,t);;){var c=l(r.get(o)).sgnT;if(c===n.OperatorId.Ne){if(o<u)for(var d=o+1;d<=u;d+=1)if((c=l(r.get(d)).sgnT)!==n.OperatorId.Ne){o=d;break}c===n.OperatorId.Ne&&(o=Math.floor((s+u)/2),c=n.OperatorId.Gt)}if(c===n.OperatorId.Eq){if(o<a){i=!0,s=o+=1,u=o;continue}return o}if(c===n.OperatorId.Lt?s=o+1:u=o-1,!(s<=u)){if(i)o-=1;else if(c===n.OperatorId.Gt&&(o-=1)>=0){s=o,u=o;continue}return o}o=Math.floor((s+u)/2)}}function C(e,t,r,i){for(var a=-1,o=y(e,t,i===n.OperatorId.Eq),s=0;s<r.length;s+=1){var u=o(r.get(s)),l=u.correctType,c=u.sgnT;if(l){if(c===n.OperatorId.Eq)return s;if(c!==n.OperatorId.Ne&&c===i)return a;a=s}s===r.denseLength&&(s=(0,p.fastMax)(s,r.length-2))}return i!==n.OperatorId.Eq?a:r.length}function R(e){switch(e.kind){case m.OperKind.Number:return i.naErrorOper;case m.OperKind.Range:return(0,o.isSheetIndex)(e.sheets)?e.ranges.length>1?i.naErrorOper:e:i.valueErrorOper;case m.OperKind.Array:return e}}function b(e,t){var r;switch(t.kind){case m.OperKind.Number:return t;case a.DerefOperKind.RangeValues:r=t.arrays[0].get(0,0);break;case m.OperKind.Array:r=t.opers[0][0];break;default:return(0,s.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",t)}return r=e.coerceOper(r,m.OperKind.Number),(0,o.isErrorOper)(r)?i.refErrorOper:r}function E(e){switch(e.kind){case m.OperKind.Number:case m.OperKind.Rich:return i.naErrorOper;case m.OperKind.Range:if(!(0,o.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.naErrorOper;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?i.naErrorOper:e;case m.OperKind.Array:return 1!==e.rows&&1!==e.cols?i.naErrorOper:e}}function P(e){switch(e.kind){case a.DerefOperKind.RangeValues:return e.arrays[0];case m.OperKind.Array:return new d.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,i.blankOper)}}function k(e,t){switch(t.kind){case m.OperKind.Range:var r=t.sheets,n=t.ranges[0];return new d.NonstrictSparseArray2D(n.rows,n.cols,n.rows,n.cols,(function(t,a){var o=(0,c.gridCell)(n.row+t,n.col+a);return e.dereferenceAllOpers([(0,i.rangeSeqOper)(r,[o])])[0].arrays[0].get(0,0)}),(function(){return(0,s.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case m.OperKind.Array:return new d.StrictSparseArray2D(t.rows,t.cols,t.rows,t.cols,t.opers,i.blankOper)}}function T(e){if((0,o.isRangeOper)(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function A(e,t,r){var a=t[0],s=t[1],l=t[2],c=t[3],p=void 0===c?i.trueOper:c,f=R(s);if((0,o.isErrorOper)(f))return f;var g=N(f,r),h=e.dereferenceAllOpers([g])[0],v=(0,d.sparseArray2DTo1D)(P(h),r),S=!p.value?C(e,a,v,n.OperatorId.Eq):F(e,a,v);if(S<0||S>=v.length)return i.naErrorOper;var y=function(e,t){switch(t.kind){case m.OperKind.Number:return t;case m.OperKind.Range:if(!(0,o.isSheetIndex)(t.sheets))return i.valueErrorOper;if(t.ranges.length>1)return i.refErrorOper;var r=t.ranges;return e.calcingArray?(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case m.OperKind.Array:return(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,l);if((0,o.isErrorOper)(y))return y;var E=e.dereferenceAllOpers([y])[0],T=b(e,E);if((0,o.isErrorOper)(T))return T;var A=e.mathpack.sfix(T)-1,_=k(e,f);return A<0?i.valueErrorOper:A>=(r?_.rows:_.cols)?i.refErrorOper:r?_.get(A,S):_.get(S,A)}function N(e,t){if((0,o.isRangeOper)(e)){var r=e.ranges[0],n=(0,c.gridRange)(r.row,r.col,t?1:r.rows,t?r.cols:1);return(0,i.rangeSeqOper)(e.sheets,[n])}return e}function _(e){return e===v.DescendingBinary||e===v.AscendingBinary}function I(e,t,r,n){void 0===r&&(r=i.missingOper),void 0===n&&(n=i.missingOper);var a=(0,o.isMissingOper)(r)?h.Exact:e.mathpack.sfix(r);if(a<h.Lower||a>h.Wildcard)return i.valueErrorOper;var s=(0,o.isMissingOper)(n)?v.Linear:e.mathpack.sfix(n);if(s<v.DescendingBinary||s>v.AscendingBinary||0===s)return i.valueErrorOper;if(a===h.Wildcard&&_(s))return i.valueErrorOper;var u=R(t);if((0,o.isErrorOper)(u))return u;var l,c=P(e.dereferenceAllOpers([u])[0]),p=c.rows,m=c.cols;if(1===p)l=!0;else{if(1!==m)return i.valueErrorOper;l=!1}return{kind:void 0,lookupArray:(0,d.sparseArray2DTo1D)(c,l),matchMode:a,searchMode:s,isHorizontal:l}}function O(e,t,r,i,a){return r===n.OperatorId.Gt?t===h.Higher&&(void 0===a||S((0,f.sortOpers)(e,i,a,1,!1))===n.OperatorId.Lt):t===h.Lower&&(void 0===a||S((0,f.sortOpers)(e,i,a,1,!1))===n.OperatorId.Gt)}function M(e,t){var r=new l.WildExp(e.config.localeInfo,t.value);return function(e){return(0,o.isStringOper)(e)&&r.test(e.value)?n.OperatorId.Eq:n.OperatorId.Ne}}function D(e,t,r){return _(t.searchMode)?function(e,t,r){var i,a=t.lookupArray,o=t.matchMode,u=t.searchMode,l=e.config,c=u===v.DescendingBinary,d=0,p=a.length-1;(0,s.assertTrue)("calc.funcs.xBinarySearch",o!==h.Wildcard);for(var m=function(e){return S((0,f.sortOpers)(l,e,r,1,!1))},g=!1;p>=d;){var y=Math.floor((p+d)/2),F=m(a.get(y));if(F===n.OperatorId.Eq)g=!0,i=y;else if(!g){var C=o===h.Higher&&F===n.OperatorId.Gt,R=o===h.Lower&&F===n.OperatorId.Lt;(C||R)&&(i=y)}c!==(F===n.OperatorId.Lt)?d=y+1:p=y-1}return i}(e,t,r):function(e,t,r){for(var i,a=t.lookupArray,u=t.matchMode,l=t.searchMode,c=e.config,d=u===h.Lower||u===h.Higher,m=u===h.Wildcard&&(0,o.isStringOper)(r)?M(e,r):function(e){return S((0,f.sortOpers)(c,e,r,1,!1))},g=l===v.ReverseLinear?a.length-1:0,y=l===v.ReverseLinear?-1:1,F=g;F>=0&&F<a.length;F+=y){var C=a.get(F),R=m(C);if(R===n.OperatorId.Eq){i=F;break}if(d&&((0,s.assertTrue)("calc.funcs.xLinearSearch",R!==n.OperatorId.Ne),O(c,u,R,C,void 0===i?void 0:a.get(i))&&(i=F)),F>=a.denseLength){var b=a.denseLength,E=a.length-1;F=y>0?(0,p.fastMax)(F,E-1):(0,p.fastMin)(F,b+1)}}return i}(e,t,r)}t.makeLookupComparer=y,t.binarySearch=F,t.linearSearch=C,t.match=function(e,t){var r=t[0],a=t[1],s=t[2],u=void 0===s?e.mathpack.one:s,l=e.mathpack,c=function(e){switch(e.kind){case m.OperKind.Number:return e;case m.OperKind.Range:if(!(0,o.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.refErrorOper;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?i.refErrorOper:e}}(u);if((0,o.isErrorOper)(c))return c;var p=e.dereferenceAllOpers([c])[0],f=b(e,p);if((0,o.isErrorOper)(f))return f;var g=E(a);if((0,o.isErrorOper)(g))return g;var h=P(e.dereferenceAllOpers([g])[0]),v=1===h.rows,S=(0,d.sparseArray2DTo1D)(h,v),y=-1;return(y=l.cond(f)>0?F(e,r,S):0===l.cond(f)?C(e,r,S,n.OperatorId.Eq):C(e,r,S,n.OperatorId.Lt))<0||y>=S.length?i.naErrorOper:e.mathpack.fromNumber(y+1)},t.lookup=function(e,t){var r=t[0],n=t[1],a=t[2],s=R(n);if((0,o.isErrorOper)(s))return s;var u=T(s),l=N(s,u),m=e.dereferenceAllOpers([l])[0],f=(0,d.sparseArray2DTo1D)(P(m),u),g=F(e,r,f);if(g<0)return i.naErrorOper;if(void 0!==a){var h=E(a);if((0,o.isErrorOper)(h))return h;var v=T(h),S=function(e,t,r){if((0,o.isRangeOper)(r)){var n=r.ranges[0],a=(0,c.gridRange)(n.row,n.col,(0,p.fastMin)(t?1:e,c.sheetRows-n.row),(0,p.fastMin)(t?e:1,c.sheetCols-n.col));return(0,i.range3DOper)(r.sheets,a)}return r}(f.length,v,h),y=(0,d.sparseArray2DTo1D)(k(e,S),v);return g>=y.length?(0,o.isArrayOper)(h)?i.naErrorOper:i.blankOper:y.get(g)}var C=k(e,s);return u?C.get(C.rows-1,g):C.get(g,C.cols-1)},t.hlookup=function(e,t){return A(e,t,!0)},t.vlookup=function(e,t){return A(e,t,!1)},function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Higher=1]="Higher",e[e.Wildcard=2]="Wildcard"}(h||(h={})),function(e){e[e.DescendingBinary=-2]="DescendingBinary",e[e.ReverseLinear=-1]="ReverseLinear",e[e.Linear=1]="Linear",e[e.AscendingBinary=2]="AscendingBinary"}(v||(v={})),t.makeWildcardComparer=M,t.xlookup=function(e,t){var r=t[0],n=t[1],a=t[2],u=t[3],l=void 0===u?i.missingOper:u,c=I(e,n,t[4],t[5]);if(void 0!==c.kind)return c;var d=function(e){switch(e.kind){case m.OperKind.Range:return(0,s.assertTrue)("calc.funcs.xlookup",(0,o.isSheetIndex)(e.sheets)),e.ranges.length>1?i.naErrorOper:[e.ranges[0].rows,e.ranges[0].cols];case m.OperKind.Array:return[e.rows,e.cols]}}(a);if(!Array.isArray(d))return d;var p=d[0],f=d[1],h=c.lookupArray.length,v=h===p&&(1===p||!c.isHorizontal),S=h===f&&(1===f||c.isHorizontal);if(!v&&!S)return i.valueErrorOper;var y=D(e,c,r);if(void 0===y)return(0,o.isMissingOper)(l)?i.naErrorOper:l;var F=e.mathpack;return g(e,v?[a,F.fromNumber(y+1),1===f?F.one:F.zero]:[a,1===p?F.one:F.zero,F.fromNumber(y+1)])},t.xmatch=function(e,t){var r=t[0],n=I(e,t[1],t[2],t[3]);if(void 0!==n.kind)return n;var a=D(e,n,r);return void 0===a?i.naErrorOper:e.mathpack.fromNumber(a+1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sqrtpi=t.factdouble=t.fact=t.quotient=t.mod=t.radians=t.degrees=t.sign=t.abs=t.odd=t.even=t.floor_precise=t.floor_math=t.floor=t.ceiling_precise=t.ceiling_math=t.ceiling=t.mround=t.rounddown=t.roundup=t.trunc=t.round=t.int=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.log10=t.ln=t.power=t.exp=t.sqrt=t.pi=void 0;var n=r(46),i=r(8),a=r(7);function o(e,t,r){var n=e.cond(t),o=e.cond(r);if(n>0&&o<0)return i.numErrorOper;if(0===n||0===o)return e.zero;var s=e.div(t,r);return(0,a.isErrorOper)(s)?s:e.mul(e.ceil(e.viewRound(s)),r)}function s(e,t,r){var n=e.cond(t),o=e.cond(r);if(n>0&&o<0)return i.numErrorOper;if(0===n&&0===o)return t;var s=e.div(t,r);return(0,a.isErrorOper)(s)?s:e.mul(e.floor(e.viewRound(s)),r)}function u(e,t,r){var i=r[0],a=t.mathpack;if(a.cond(i)>=0){var o=a.ceil(i);return 0===a.cond2((0,n.assertNumber)((0,n.numMod)(a,o,a.fromNumber(2))),a.one)===e?a.add(o,a.one):o}var s=a.floor(i);return 0===a.cond2((0,n.assertNumber)((0,n.numMod)(a,s,a.fromNumber(2))),a.one)===e?a.sub(s,a.one):s}t.pi=function(e,t){return e.mathpack.pi},t.sqrt=(0,n.wrap1)((function(e){return e.mathpack.sqrt})),t.exp=(0,n.wrap1)((function(e){return e.mathpack.exp})),t.power=(0,n.wrap2)((function(e){return e.mathpack.power})),t.ln=(0,n.wrap1)((function(e){return e.mathpack.ln})),t.log10=(0,n.wrap1)((function(e){return e.mathpack.log})),t.log=function(e,t){var r=t[0],n=t[1],i=e.mathpack;if(void 0===n)return i.log(r);var o=i.ln(r);if((0,a.isErrorOper)(o))return o;var s=i.ln(n);return(0,a.isErrorOper)(s)?s:i.div(o,s)},t.sin=(0,n.wrap1)((function(e){return e.mathpack.sin})),t.cos=(0,n.wrap1)((function(e){return e.mathpack.cos})),t.tan=(0,n.wrap1)((function(e){return e.mathpack.tan})),t.asin=(0,n.wrap1)((function(e){return e.mathpack.asin})),t.acos=(0,n.wrap1)((function(e){return e.mathpack.acos})),t.atan=(0,n.wrap1)((function(e){return e.mathpack.atan})),t.atan2=(0,n.wrap2)((function(e){return e.mathpack.atan2})),t.int=function(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},t.round=(0,n.wrap2)((function(e){return e.mathpack.round})),t.trunc=function(e,t){var r=t[0],n=t[1],i=void 0===n?e.mathpack.zero:n;return e.mathpack.roundDown(r,i)},t.roundup=(0,n.wrap2)((function(e){return e.mathpack.roundUp})),t.rounddown=(0,n.wrap2)((function(e){return e.mathpack.roundDown})),t.mround=function(e,t){var r=t[0],o=t[1],s=(0,n.chkNumOper)(e,r);if((0,a.isErrorOper)(s))return s;var u=(0,n.chkNumOper)(e,o);if((0,a.isErrorOper)(u))return u;var l=e.mathpack;if(0===l.cond(u))return l.zero;if(0!==l.cond(s)&&l.cond(s)<0!=l.cond(u)<0)return i.numErrorOper;var c=l.div(s,u);if((0,a.isErrorOper)(c))return i.numErrorOper;var d=l.floor(c),p=(0,n.assertNumber)(l.sub(c,d)),m=l.fromNumber(.5-5e-15);if(l.cond2(p,m)<0)return l.mul(d,u);var f=l.add(d,l.one);return(0,a.isErrorOper)(f)?f:l.mul(f,u)},t.ceiling=function(e,t){var r=t[0],n=t[1];return o(e.mathpack,r,n)},t.ceiling_math=function(e,t){var r=t[0],n=t[1],i=t[2],s=e.mathpack,u=void 0===n||(0,a.isMissingOper)(n)?s.one:s.abs(n),l=void 0===i||(0,a.isMissingOper)(i)?s.zero:i;return 0!==s.cond(l)&&s.cond(r)<0&&(u=s.neg(u)),0===s.cond(u)?s.zero:o(s,r,u)},t.ceiling_precise=function(e,t){var r=t[0],n=t[1],i=e.mathpack,s=void 0===n||(0,a.isMissingOper)(n)?i.one:i.abs(n);return 0===i.cond(s)?i.zero:o(i,r,s)},t.floor=function(e,t){var r=t[0],n=t[1];return s(e.mathpack,r,n)},t.floor_math=function(e,t){var r=t[0],n=t[1],i=t[2],o=e.mathpack,u=void 0===n||(0,a.isMissingOper)(n)?o.one:o.abs(n),l=void 0===i||(0,a.isMissingOper)(i)?o.zero:i;return 0!==o.cond(l)&&o.cond(r)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:s(o,r,u)},t.floor_precise=function(e,t){var r=t[0],n=t[1],i=e.mathpack,o=void 0===n||(0,a.isMissingOper)(n)?i.one:i.abs(n);return 0===i.cond(o)?i.zero:s(i,r,o)},t.even=u.bind(void 0,!0),t.odd=u.bind(void 0,!1),t.abs=(0,n.wrap1)((function(e){return e.mathpack.abs})),t.sign=function(e,t){var r=t[0],n=e.mathpack;return n.fromNumber(n.cond(r))},t.degrees=function(e,t){var r=t[0],i=e.mathpack,a=(0,n.assertNumber)(i.div(i.fromNumber(180),i.pi));return i.mul(r,a)},t.radians=function(e,t){var r=t[0],i=e.mathpack,a=(0,n.assertNumber)(i.div(i.pi,i.fromNumber(180)));return i.mul(r,a)},t.mod=(0,n.wrap2)((function(e){return e.mathpack.mod})),t.quotient=function(e,t){var r=t[0],o=t[1],s=(0,n.chkNumOper)(e,r);if((0,a.isErrorOper)(s))return s;var u=(0,n.chkNumOper)(e,o);if((0,a.isErrorOper)(u))return u;var l=e.mathpack;if(0===l.cond(u))return i.div0ErrorOper;var c=l.div(s,u);return(0,a.isErrorOper)(c)?i.numErrorOper:l.cond(c)>0?l.floor(c):l.ceil(c)},t.fact=function(e,t){var r=t[0],n=e.mathpack,o=n.sfix(r);if(n.cond(r)<0||o>170)return i.numErrorOper;for(var s=n.one,u=o;u>0;u-=1){if((0,a.isErrorOper)(s))return s;s=n.mul(n.fromNumber(u),s)}return s},t.factdouble=function(e,t){var r=t[0],o=(0,n.chkNumOper)(e,r);if((0,a.isErrorOper)(o))return o;var s=e.mathpack,u=s.floor(o);if(s.cond2(u,s.fromNumber(-1))<0||s.cond2(u,s.fromNumber(300))>0)return i.numErrorOper;for(var l=s.one,c=s.toNumber(u);c>1;c-=2){if((0,a.isErrorOper)(l))return l;l=s.mul(s.fromNumber(c),l)}return l},t.sqrtpi=function(e,t){var r=t[0],o=(0,n.chkNumOper)(e,r);if((0,a.isErrorOper)(o))return o;var s=e.mathpack;if(s.cond(o)<0)return i.numErrorOper;var u=s.mul(s.pi,o);return(0,a.isErrorOper)(u)?u:s.sqrt(u)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAbsoluteIndexNoClamp=t.getAbsoluteIndex=t.ni=void 0;var n=r(7),i=r(16);t.ni=function(e){throw new i.EvaluationError((0,n.notImplemented)([e]))},t.getAbsoluteIndex=function(e,t){return t>=0?t:Math.max(e+t,0)},t.getAbsoluteIndexNoClamp=function(e,t){return t>=0?t:e+t}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.recalcServiceInsideInit=t.RecalcServiceImpl=void 0;var i=r(0),a=i.__importStar(r(80)),o=r(24),s=r(2),u=r(128),l=r(15),c=r(77),d=r(30),p=r(195),m=r(78),f=r(20),g=r(72),h=r(11),v=r(69),S=r(39),y=r(4),F=r(54),C=r(303),R=r(93),b=r(95),E=r(35),P=r(140),k=r(490),T=r(5),A=r(22),N=r(491),_=r(304),I=r(120),O=r(94),M=r(13),D=r(202),w=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==f.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e,t){(0,s.safePush)(e!==f.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)},e.prototype.pushRangeFailure=function(e,t){(e!==f.ComputedCellKind.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.recalcFinished=this.recalcFinished||e},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest((0,c.updateRequest)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults((0,c.recalcResults)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r,n){for(var i=0;i<(0,s.fastMax)((0,s.fastMax)(t.length,r.length),n.length);i+=10)this.onRecalcResults((0,c.recalcResults)(this.currentOutputStateId,e,!1,t.slice(i,i+10),r.slice(i,i+10),n.slice(i,i+10)))},e}();function L(e){return{kind:e.kind}}var x=function(){function e(e,t,r,n,a,o,s){void 0===o&&(o={}),void 0===s&&(s="Local");var l=this;this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.onAlert=n,this.asyncLoopFactory=a,this.twConfig=o,this.dataTransformer=new O.RecalcServiceDataTransformer,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=f.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=function(e,t,r){return i.__awaiter(l,void 0,void 0,(function(){return i.__generator(this,(function(n){return[2,(0,u.initCalcInThread)(e,t,r,this.twConfig)]}))}))},this.setConfig({}),this.dataModel=new p.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mathpack",{get:function(){return this.dataTransformer.getLangConfig().mathpack},enumerable:!1,configurable:!0}),e.prototype.ping=function(){},e.prototype.setInputStateId=function(e,t){var r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=this.asyncLoopFactory((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});var t=this.recalcLoop;return(0,b.promiseFinally)(this.recalcLoop.promise,(function(){e.recalcLoop===t&&(e.recalcLoop=void 0)}))},e.prototype.testResumeRecalc=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(r){switch(r.label){case 0:return[4,this.resumeRecalc()];case 1:return r.sent(),void 0!==e&&(t="calc.calc.RecalcService: resumeRecalc finished; resumeId = ".concat(e),y.ulsLogger.ULS.traceTag(574128980,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,t)),[2]}}))}))},e.prototype.processRecalcResults=function(e){for(var t=new w(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),r=0,n=e;r<n.length;r++){var i=n[r];if(i.kind!==f.OutputMessageKind.GarbageCollected)if(i.kind!==f.OutputMessageKind.Alert)if(i.kind!==f.OutputMessageKind.ExperimentRunResult){if(this.setOutputStateId(i.stateId))switch(t.setOutputStateId(i.stateId),i.kind){case f.OutputMessageKind.CellWrite:var a=i.cell,o=i.value,u=i.format,l=i.cellKind,c=i.formulaBarText,d=i.formatted,p=i.hasHyperlink,m=a.sheet,g=a.range,h=this.cellWriteToRangeDelta(m.index,g.row,g.col,o,u,c,d,p,"messages.<index>.value");(0,s.isDefined)(h)&&t.pushCellWrite(l,h);break;case f.OutputMessageKind.RangeWrite:var v=i.range,S=i.values,F=(l=i.cellKind,c=i.formulaBarText,d=i.formatted,i.formats);m=v.sheet,g=v.range;t.pushRangeWrite(l,this.rangeWriteToRangeDeltas(m.index,g,S,F,c,d,"messages.<index>.values"));break;case f.OutputMessageKind.NameFailure:this.nameFailures.push(i);break;case f.OutputMessageKind.RangeFailure:v=i.range,l=i.cellKind;var C=i.reason;t.pushRangeFailure(l,this.rangeFailure(v,C)),this.rangeFailures.push(i);break;case f.OutputMessageKind.NumberFormatFailure:this.numberFormatFailures.push(i);break;case f.OutputMessageKind.PrintFormulaFailure:this.printFormulaFailures.push(i);break;case f.OutputMessageKind.InferFormatFailure:this.inferFormatFailures.push(i);break;case f.OutputMessageKind.FormatValueFailure:v=i.range,l=i.cellKind,C=i.reason;t.pushRangeFailure(l,this.rangeFailure(v,C)),this.formatValueFailures.push(i);break;case f.OutputMessageKind.UnhandledFailure:this.unhandledFailures.push(i);break;case f.OutputMessageKind.UpdateRequest:t.pushUpdateRequest((0,I.sheetGridRangeToLocation)(i.range));break;case f.OutputMessageKind.UpdateNamesRequest:t.pushUpdateNameRequest(i.scope);break;case f.OutputMessageKind.RecalcStatistics:t.pushRecalcFinished(i.message===f.RecalcStatisticsMessage.RecalcFinished),this.recalcStatistics=(0,f.mergeRecalcStatistics)(this.recalcStatistics,i);break;case f.OutputMessageKind.WorkbookStatistics:this.logWorkbookStats(i.stateId,i.stats,i.p);break;case f.OutputMessageKind.StateAdvanced:break;default:return(0,y.assertNever)("calc.calc.RecalcServiceImpl.processRecalcResults",i)}}else this.logExperimentRunResult(i.experimentName,JSON.stringify({message:i.logMessage,timeoutReason:i.timeoutReason}));else this.onAlert(i.message);else this.onGC(i.minStateIdKept)}t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()},e.prototype.logExperimentRunResult=function(e,t){y.ulsLogger.ULS.traceTag(594409422,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"calc.calc.RecalcService: ".concat(e," done; ").concat(t)),"UnitExperiment"===e&&y.ulsLogger.ULS.traceTag(538567681,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"calc.calc.RecalcService: UnitExperiment done: ".concat(t))},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.numberFormatFailures;this.numberFormatFailures=[];var n=this.printFormulaFailures;this.printFormulaFailures=[];var i=this.inferFormatFailures;this.inferFormatFailures=[];var a=this.formatValueFailures;this.formatValueFailures=[];var s=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",o.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",o.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",o.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",o.TraceLevel.Info),this.logGenFailureStats(i,590484947,"infer-format",o.TraceLevel.Info),this.logCellFailureStats(a,590484948,"format-value",o.TraceLevel.Info),this.logGenFailureStats(s,595194338,"unhandled",o.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var i={},a=0,s=e;a<s.length;a++){var u=s[a].reason;(0,O.incrementFailure)(i,u)}var l="calc.calc.RecalcService: recalc ".concat(r," failures; stateId = ").concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(i));y.ulsLogger.ULS.traceTag(t,o.LogCategory.msoulscat_ES_EWAJS,n,l),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var i,a=this;if(0!==e.length){for(var s={},u=0,l=e;u<l.length;u++){var c=l[u],d=c.reason,p=c.cellKind,m=null!==(i=s[p])&&void 0!==i?i:s[p]={};(0,O.incrementFailure)(m,d)}Object.getOwnPropertyNames(s).sort().forEach((function(e){var i=s[e],u="calc.calc.RecalcService: recalc ".concat(r," failures; stateId = ").concat(a.currentOutputStateId,", cell kind = ").concat(e,", stats = ").concat(JSON.stringify(i));y.ulsLogger.ULS.traceTag(t,o.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r].reason;if(i.kind===F.ReasonKind.JavaScriptError){var a=(0,E.messageFromError)(i.error),s="calc.calc.RecalcService: recalc ".concat(t," JavaScript error: ").concat(a);y.ulsLogger.ULS.traceTag(595658721,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,s)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var i="stateId = ".concat(t,", stats = ").concat(JSON.stringify(n)),a="calc.calc.RecalcService: ignored ".concat(r," data; ").concat(i);y.ulsLogger.ULS.traceTag(e,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,a)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0&&(this.lastRecalcStatsStateId!==this.currentOutputStateId||this.recalcStatistics!==f.emptyRecalcStatistics)){var e=this.recalcStatistics;this.recalcStatistics=f.emptyRecalcStatistics,this.lastRecalcStatsStateId=this.currentOutputStateId;var t=this.config.sampleRecalcStatisticsRate;if(this.dataModel.shouldSample(t)){var r="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(e),", p = ").concat(JSON.stringify(t)),n="calc.calc.RecalcService: recalc statistics; ".concat(r);y.ulsLogger.ULS.traceTag(595654593,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,n)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-1/0&&0!==this.rangeFailures.length){var e=(0,k.computeUnavailableCellsStats)(this.rangeFailures);if(0!==e.numOfUnavailableCellsInTheSameSheet||0!==e.numOfUnavailableCellsInDifferentSheet||0!==e.totalNumOfUnavailableCells){var t="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(e)),r="calc.calc.RecalcService: unavailable cells statistics; ".concat(t);y.ulsLogger.ULS.traceTag(589632004,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,r)}}},e.prototype.logWorkbookStats=function(e,t,r){var n="stateId = ".concat(e,", stats = ").concat(JSON.stringify(t),", p = ").concat(JSON.stringify(r)),i="calc.calc.RecalcService: workbook statistics; ".concat(n);y.ulsLogger.ULS.traceTag(595359882,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,i)},e.prototype.logInputStateIdDecrease=function(e){(0,R.incrementStat)(this.ignoredInputStats,"".concat(e,": input stateId went backwards"))},e.prototype.logOutputStateIdDecrease=function(){(0,R.incrementStat)(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,i,a,o,u,l){if((0,R.check)(n,R.chReadOper,this.ignoredOutputStats,l)){var d=(0,I.readOperToCellValue)(this.mathpack,n),p=(0,I.cellFormatToInferredFormat)(i);return(0,s.isDefined)(a)||(0,s.isDefined)(d)||(0,s.isDefined)(p)||(0,s.isDefined)(o)||(0,s.isDefined)(u)?(0,c.rangeDelta)((0,c.sheetRangeLocation)(e,t,r),(0,c.cellDataDelta)(a,d,p,o,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,i,a,o){for(var u="".concat(o,".<index>.<index>"),l=t.row,c=t.col,d=t.rows,p=t.cols,m=[],f=0;f<d;f+=1)for(var g=0;g<p;g+=1){var h=this.cellWriteToRangeDelta(e,l+f,c+g,r[f][g],n[f][g],0===f&&0===g?i:void 0,a[f][g],void 0,u);(0,s.isDefined)(h)&&m.push(h)}return m},e.prototype.rangeFailure=function(e,t){return(0,c.rangeFailure)((0,I.sheetGridRangeToLocation)(e),L(t))},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,e)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)},e.prototype.setWorkbookProps=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,(0,R.filterCheck)(e,R.chNumberFormat,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,e,t,this.ignoredInputStats))},e.prototype.updateNamedObjects=function(e,t){this.setInputStateId(e,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,e,t,this.ignoredInputStats))},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=(0,R.filterCheck)(t,R.chUnusedCellsUpdate,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var i=n[r];this.dataModel.extendUnusedRange((0,I.unusedCellsUpdateToUsedRange)(this.document,i),e)}}},e.prototype.updateRanges=function(e,t){this.setInputStateId(e,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(e,t))},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=(0,R.filterCheck)(t,R.chArrayUpdate,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var i=n[r],a=i.range,o=i.data,u=i.fromStateId,l=(0,I.sheetRangeLocationToGridRange)(this.document,a);if((0,s.isDefined)(o)){var c=o.formulaBarText,d=o.isSpilled,p=(0,h.gridRangeAnchor)(l.range);this.dataModel.writeArrayFormula(e,l,c,p,d)}else(0,s.isDefined)(u)}}},e.prototype.editRangeFormulas=function(e,t){this.setInputStateId(e,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,e))},e.prototype.evalOnClonedModel=function(e,t,r){return this.evalOnClonedModelOnSnapshot(e,t,void 0,r)},e.prototype.evalOnClonedModelOnSnapshot=function(e,t,r,n){void 0===r&&(r=void 0),(0,y.assertPositiveInteger)("edits array should not be empty",t.length);var i=void 0===r?new p.EvalOnClonePropsFromPartialWB(this.dataModel,n):new p.EvalOnClonePropsFromPartialWBDocumentCollection(r,n);return this.applyRangeUpdates(-1,e,i),this.applyRangeFormulaEdits(t,-1,i),i.resultsPromise.toPromise()},e.prototype.applyRangeUpdates=function(e,t,r){for(var n,i,a=0,o=(0,R.filterCheck)(t,R.chRangeUpdate,this.ignoredInputStats,"rangeUpdates");a<o.length;a++){var u=o[a],l=u.range,c=u.excludeRows,p=u.excludeColumns,v=u.data,S=u.fromStateId,F=(0,I.sheetRangeLocationToGridRange)(this.document,l),C=F.range,b=(0,I.createExcludeCellSet)(C.row,C.rows,d.bspFactory.row,c),E=(0,I.createExcludeCellSet)(C.col,C.cols,d.bspFactory.col,p),P=(0,I.sheetGridRangeToCellSet)(F,b,E),k=(0,s.isDefined)(v)?(0,I.cellValueToReadOper)(this.mathpack,v.value):g.blankOper;(0,y.assertTrue)("calc.calc.RecalcService: updateRanges oper",null!=k);var T=(0,h.gridRangeAnchor)(C);if((0,s.isDefined)(v)){var A=v.iformat,N="ArrayFormula"===v.kind?void 0:null!==(n=v.formulaBarText)&&void 0!==n?n:void 0,_=null!==(i=v.failureReason)&&void 0!==i?i:void 0,O="CellFormula"===v.kind;this.dataModel.writeCellContents(e,P,N,O,T,k,A,f.SpecialStyle.Blank,_,r)}else if((0,s.isNone)(S))this.dataModel.writeCellContents(e,P,"",!1,T,g.blankOper,m.blankCellFormat,void 0,void 0,r);else{if(r)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(e,F,P,S)}r||(this.dataModel.writeHiddenRows(e,(0,I.sheetGridRangeToHiddenRows)(F,b)),this.dataModel.writeHiddenCols(e,(0,I.sheetGridRangeToHiddenCols)(F,E)))}},e.prototype.localizeEnglishFormula=function(e,t){var r=this.dataModel.translateEnglishFormula(e,(0,I.sheetCellLocationToGridCell)(this.document,t));return Promise.resolve(r)},e.prototype.applyRangeFormulaEdits=function(e,t,r){for(var n=this,i=(0,R.filterCheck)(e,R.chRangeFormulaEdit,this.ignoredInputStats,"rangeFormulaEdits"),a=function(e){var i=e.kind,a=e.range,u=e.formulaBarText,c=e.value,p=e.origin,m=e.viewport,g=v.empty;a.forEach((function(e){g=(0,S.unionProduct)(g,(0,d.createCellSetFromRange)((0,I.sheetRangeLocationToGridRange)(n.document,e).range))}));var F=(0,I.sheetRangeLocationToGridRange)(o.document,a[0]),C=(0,s.isDefined)(p)?(0,l.gridCell)(p.row,p.column):(0,h.gridRangeAnchor)(F.range),R=(0,s.isDefined)(m)?(0,I.sheetRangeLocationToGridRange)(o.document,m):void 0,b=void 0;(0,s.isDefined)(c)?(b=(0,I.cellValueToReadOper)(o.mathpack,c),(0,y.assertTrue)("calc.calc.RecalcService: editRangeFormulas oper",null!=b)):b=void 0;var E="CellFormula"===i||"Value"!==i&&void 0;r?o.dataModel.editCellContentsOnClone((0,f.sheetCellSet)(F.sheet,g),u,E,C,r):o.dataModel.editCellContents(t,(0,f.sheetCellSet)(F.sheet,g),u,E,C,b,R)},o=this,u=0,c=i;u<c.length;u++){a(c[u])}},e.prototype.editRangeFormats=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var n=(0,R.filterCheck)(t,R.chRangeFormatEdit,this.ignoredInputStats,"rangeFormatEdits"),i=function(t){var n=t.range,i=t.operation,o=t.origin,u=t.viewport,c="SetFormat"!==i.kind||(0,s.isNone)(i.format)?"RibbonFormat"!==i.kind||(0,s.isNone)(i.ribbon)?"ChangeDecimals"!==i.kind||(0,s.isNone)(i.changeDecimals)?void 0:{kind:i.kind,changeDecimals:i.changeDecimals}:{kind:i.kind,ribbon:i.ribbon}:{kind:i.kind,format:i.format};(0,y.assertTrue)("calc.calc.RecalcService: editRangeFormats operation",null!=c);var p=v.empty;n.forEach((function(e){p=(0,S.unionProduct)(p,(0,d.createCellSetFromRange)((0,I.sheetRangeLocationToGridRange)(r.document,e).range))}));var m=(0,I.sheetRangeLocationToGridRange)(a.document,n[0]),g=null!=o?(0,l.gridCell)(o.row,o.column):(0,h.gridRangeAnchor)(m.range),F=(0,s.isDefined)(u)?(0,I.sheetRangeLocationToGridRange)(a.document,u):void 0;a.dataModel.editCellFormats(e,(0,f.sheetCellSet)(m.sheet,p),c,g,F)},a=this,o=0,u=n;o<u.length;o++){i(u[o])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var r=0,n=(0,R.filterCheck)(t,R.chArrayFormulaEdit,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var i=n[r],a=i.range,o=i.formulaBarText,u=i.origin,c=i.viewport,d=(0,I.sheetRangeLocationToGridRange)(this.document,a),p=(0,s.isDefined)(u)?(0,l.gridCell)(u.row,u.column):(0,l.gridCell)(a.row,a.column),m=(0,s.isDefined)(c)?(0,I.sheetRangeLocationToGridRange)(this.document,c):void 0;this.dataModel.editArrayFormula(e,d,o,p,m)}}},e.prototype.editRangePaste=function(e,t){if(this.setInputStateId(e,"editRangePaste")){this.clearAsyncResumeRecalc();for(var r=0,n=(0,R.filterCheck)(t,R.chPasteEdit,this.ignoredInputStats,"pasteEdits");r<n.length;r++){var i=n[r],a=i.kind,o=i.source,u=i.target,l=i.viewport,c=(0,I.sheetRangeLocationToGridRange)(this.document,o),d=(0,I.sheetCellLocationToGridCell)(this.document,u),p=(0,s.isDefined)(l)?(0,I.sheetRangeLocationToGridRange)(this.document,l):void 0;this.dataModel.editPaste(e,a,d,c,p)}}},e.prototype.setConfig=function(e){var t,r,n,i,a,o,s,u,c,d,p,m,f=Array.isArray(e.runExperiments)?{stepBudget:null!==(t=e.experimentStepBudget)&&void 0!==t?t:10,totalBudget:null!==(r=e.experimentTotalBudget)&&void 0!==r?r:1e4,factories:(0,P.getExperimentFactories)(e.runExperiments)}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:null!==(n=e.totalEvalTimeMs)&&void 0!==n?n:1e4,maxCellChain:2*l.sheetCols,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:null!==(i=e.samplePrecisionEvalRate)&&void 0!==i?i:.02,samplePrecisionPrintFormulaRate:null!==(a=e.samplePrecisionPrintFormulaRate)&&void 0!==a?a:.001,samplePrecisionPrintValueRate:null!==(o=e.samplePrecisionPrintValueRate)&&void 0!==o?o:1e-4,sampleRecalcStatisticsRate:null!==(s=e.sampleRecalcStatisticsRate)&&void 0!==s?s:.2,sampleWorkbookStatisticsRate:null!==(u=e.sampleWorkbookStatisticsRate)&&void 0!==u?u:.1,sampleCellEvalStopwatchRate:null!==(c=e.sampleCellEvalStopwatchRate)&&void 0!==c?c:.003,sampleRecalcEditedStopwatchRate:null!==(d=e.sampleRecalcEditedStopwatchRate)&&void 0!==d?d:1,sampleRecalcViewportStopwatchRate:null!==(p=e.sampleRecalcViewportStopwatchRate)&&void 0!==p?p:1,rngSeed:null!==(m=e.rngSeed)&&void 0!==m?m:1e3*Date.now(),volatileMode:null!=e.volatileMode?M.VolatileMode[e.volatileMode]:M.VolatileMode.Estimation,experimentFactories:f}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new p.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=f.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0},e.prototype.evalFormula=function(e,t,r,n){var i=this;return(0,R.check)(r,R.chSheetCellLocation,this.ignoredInputStats,"origin")?(0,R.check)(n,R.chEvalFormulaFormat,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,(0,I.sheetCellLocationToGridCell)(this.document,r),(0,I.evalFormulaFormatToUnion)(n)).then((function(e){var t,r,n=e.value,a=e.formatted;if((0,T.isSuccess)(n)){if(!(0,R.check)(n.value,R.chReadOper,i.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var o=(0,I.readOperToCellValue)(i.mathpack,n.value);(0,y.assertTrue)("calc.calc.RecalcService.evalFormula",void 0!==o),t=(0,T.success)(o)}else t=(0,T.failure)(L(n.reason));return r=void 0===a?void 0:(0,T.isSuccess)(a)?a:(0,T.failure)(L(a.reason)),(0,c.evalFormulaData)(t,r)})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.evalFormulaOnSnapshotImpl=function(e,t,r,n){return this.dataModel.evalFormula(-1,e,t,r,n)},e.prototype.testAdvanceState=function(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.getMissingJSFeatures=function(){return(0,_.getMissingJSFeatures)()},e}();t.RecalcServiceImpl=x;var K=(0,N.mixin)(x,(function(e){return new D.RecalcSideGrid(e)}),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalFormulaOnSnapshot","evalClonedModelOnSnapshot","getCorrespondingSnapshotID"]);if((0,A.getTypedFeatureGate)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(n=self.__retries)&&void 0!==n?n:-1)+1,0===self.__retries))throw"";t.recalcServiceInsideInit=function(e){var t=e.config,r=e.connection;return a.Endpoint.createInside(r,(function(e){return new K((function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onRecalcResults.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onUpdateRequest.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onGC.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onAlert.apply(t,r)}),C.asyncLoop,t,r.createMode)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbook=t.EvalOnClonePropsFromPartialWBDocumentCollection=t.EvalOnClonePropsFromPartialWB=t.MaxStateIdDifferenceForGC=void 0;var n=r(0),i=r(54),a=r(54),o=r(54),s=r(11),u=r(11),l=r(15),c=r(72),d=r(36),p=r(20),m=r(4),f=r(30),g=r(78),h=r(93),v=r(2),S=r(292),y=r(1),F=r(39),C=r(461),R=r(24),b=r(462),E=r(23),P=r(115),k=r(5),T=r(5),A=r(21),N=r(463),_=r(140),I=r(121),O=r(13),M=r(94),D=r(35),w=r(47),L=r(92),x=r(133),K=r(106),U=r(110),B=r(109),W=2*l.sheetCols;t.MaxStateIdDifferenceForGC=17;var G=(0,l.gridRange)(0,0,l.sheetRows,l.sheetCols);function V(e,t){var r;return t.kind===a.ReasonKind.Unavailable&&t.objects.length>0&&"kind"in t.objects[0]&&(r=t.objects[0].kind),(0,T.failure)({cell:e,kind:t.kind,innerKind:r})}var j,q=(0,A.binaryVisitor)(n.__assign(n.__assign({},(0,A.constVisitor)(!1)),{wsfNode:function(e){return e===d.WorksheetFuncId.HYPERLINK}}),(function(e,t){return e||t}));!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"}(j||(j={}));var H=function(e,t){this.formatResults=t,this.resultsPromise=new I.ResolvablePromise,this.stateId=-1,this.cloneLazy=new O.ResettableLazy((function(){return e.createSnapshotSync()}))};t.EvalOnClonePropsFromPartialWB=H;var z,Q=function(e,t){this.formatResults=t,this.resultsPromise=new I.ResolvablePromise,this.stateId=-1,this.cloneLazy=new O.ResettableLazy((function(){return e.clone(S.voidCallback,g.CloningTarget.Client)}))};t.EvalOnClonePropsFromPartialWBDocumentCollection=Q,function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(z||(z={}));var Y=function(){function e(e,t){void 0===t&&(t={});var r,n,i=this;this.scheduler=new b.PriorityScheduler,this.englishParser=(0,x.createParser)((0,K.createParseGlobals)(M.initialRecalcServiceConfig)),this.englishAnalyzer=(0,U.createAnalyzer)((0,B.createAnalyzeGlobals)(M.initialRecalcServiceConfig)),this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.latestSnapshotID=-1,this.numPrecisionFailures=0,this.printFormulaProperties=function(e){var t=(0,u.sheetGridRangeAnchor)(e),r=i.getAvailableFormula(t);if((0,T.isSuccess)(r)){var n=r.value,a=n[0],o=n[1],s=o.compiledFmla.getValue(),l=(0,T.isSuccess)(s)?i.docs.printFormulaBarText(a,t.range,s.value):s;return{formulaBarText:l.kind===T.ResultKind.Success?l.value:void i.outputMessageLog.push({kind:p.OutputMessageKind.PrintFormulaFailure,stateId:i.stateId,range:e,reason:l.reason}),hasHyperlink:i.formulaHasHyperlink(o),isFormula:!0}}i.onUnavailableObject(r.reason)},this.printValueProperties=function(e,t){var r,n,a=i.docs.getEditedFormula(e);if((0,T.isSuccess)(a)){var o=null!==(n=null===(r=a.value)||void 0===r?void 0:r[1].fmla)&&void 0!==n?n:"",s=i.docs.renderValueBarText(e,t,o);return{formulaBarText:(0,T.isSuccess)(s)?s.value:void i.outputMessageLog.push({kind:p.OutputMessageKind.PrintFormulaFailure,stateId:i.stateId,range:e,reason:s.reason}),hasHyperlink:!1,isFormula:!1}}i.onUnavailableObject(a.reason)},this.scheduleAvailableFormulas=function(e,t){var r=i.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(r){var n=(0,l.sheetGridCell)(e.sheet,r),a=i.docs.getEditedFormula(n);return a.kind===T.ResultKind.Failure?(i.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla&&i.enqueueComputeCellValue(n,t),!0)}));(0,T.isSuccess)(r)||i.onUnavailableObject(r.reason)},this.scheduleAvailableValues=function(e,t){var r=i.docs.forEachEditedCellInSet(e.sheet,e.set,(function(r){var n=(0,l.sheetGridCell)(e.sheet,r),a=i.docs.getEditedFormula(n);return a.kind===T.ResultKind.Failure?(i.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla||i.enqueueReturnCellValue(n,t),!0)}));(0,T.isSuccess)(r)||i.onUnavailableObject(r.reason)},this.docs=new S.PartialWorkbookDocumentCollection(e,this,t,t,null!==(r=t.maxDereferenceCells)&&void 0!==r?r:W,null!==(n=t.isServerWorkbookLoad)&&void 0!==n&&n),this.reconfigure(t)}return e.prototype.reconfigure=function(e){var t,r;this.config=e,this.rng=new y.JSF32(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!==(t=e.maxDereferenceCells)&&void 0!==t?t:W,null!==(r=e.isServerWorkbookLoad)&&void 0!==r&&r)},e.prototype.getDocs=function(){return this.docs},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==p.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:p.OutputMessageKind.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,i){i.computeKind!==p.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:p.OutputMessageKind.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})},e.prototype.onNumberFormatFailure=function(e){this.outputMessageLog.push({kind:p.OutputMessageKind.NumberFormatFailure,stateId:this.stateId,reason:e})},e.prototype.onInferFormatFailure=function(e,t){this.outputMessageLog.push({kind:p.OutputMessageKind.InferFormatFailure,stateId:this.stateId,range:e,reason:t})},e.prototype.onUnavailableObject=function(e){var t=(0,u.unavailable)([e]);this.onUnavailable(t)},e.prototype.onUnavailable=function(e){this.outputMessageLog.push({kind:p.OutputMessageKind.UnhandledFailure,stateId:this.stateId,reason:e})},e.prototype.onSetCellValue=function(e,t,r,i,a){if(a.computeKind!==p.ComputeKind.EvalFormula){var o=this.outputCell(e,t,i,this.printFormulaProperties);void 0!==o?(this.outputMessageLog.push({kind:p.OutputMessageKind.RecalcStatistics,message:p.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:i}),i!==p.ComputedCellKind.EditedCell&&i!==p.ComputedCellKind.DependentCell||this.outputMessageLog.push(n.__assign(n.__assign({kind:p.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:i,cell:e},o),{formatted:this.formatValue(i,e,t)}))):this.outputMessageLog.push({kind:p.OutputMessageKind.RecalcStatistics,message:p.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:i})}},e.prototype.onSetCellValues=function(e,t,r,i,a){var o=this;if(a.computeKind!==p.ComputeKind.EvalFormula){var s=this.outputRange(e,t,i);void 0!==s&&(i!==p.ComputedCellKind.EditedCell&&i!==p.ComputedCellKind.DependentCell||this.outputMessageLog.push(n.__assign(n.__assign({kind:p.OutputMessageKind.RangeWrite,stateId:this.stateId,cellKind:i,range:e},s),{formatted:t.map((function(t,r){return t.map((function(t,n){return o.formatValue(i,(0,l.sheetGridCell)(e.sheet,(0,l.gridCell)(e.range.row+r,e.range.col+n)),t)}))}))})))}},e.prototype.onReturnCellValue=function(e,t,r){var i=this,a=this.outputCell(e,t,r,(function(){return i.printValueProperties(e,t)}));void 0!==a?(this.outputMessageLog.push({kind:p.OutputMessageKind.RecalcStatistics,message:p.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:p.ComputedCellKind.EditedCell}),r===p.ComputedCellKind.EditedCell&&this.outputMessageLog.push(n.__assign(n.__assign({kind:p.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:p.ComputedCellKind.EditedCell,cell:e},a),{formatted:this.formatValue(r,e,t)}))):this.outputMessageLog.push({kind:p.OutputMessageKind.RecalcStatistics,message:p.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:p.ComputedCellKind.EditedCell})},e.prototype.createSnapshot=function(e,t){var r=this;return void 0===t&&(t=g.CloningTarget.Client),new Promise((function(n){r.scheduler.addTask(z.CompleteDataQuery,b.QueuePos.Back,{onRun:function(){var i=!1,a=r.docs.clone(S.voidCallback,t);void 0!==r.latestSnapshot&&-1!==r.latestSnapshotID&&r.latestSnapshot.compareVersion(a)||(i=!0,r.latestSnapshot=a,r.latestSnapshotID=e),w.x10Logger.log({kind:"snapshotCreation",payload:i}),n({snapshot:r.latestSnapshot,correspondingId:r.latestSnapshotID})},onDeleted:function(){n(void 0)}})}))},e.prototype.createSnapshotSync=function(e){return void 0===e&&(e=g.CloningTarget.Client),this.docs.clone(S.voidCallback,e)},e.prototype.outputCell=function(e,t,r,n){var i;if(r===p.ComputedCellKind.EditedCell||r===p.ComputedCellKind.DependentCell){var a=this.docs.testAndSetClientValue(e,t);i=(0,T.isSuccess)(a)?a.value?t:void 0:void this.onUnavailableObject(a.reason)}var o=this.outputFormat(e,r),s=this.outputFormulaProperties(e,r,n);return void 0!==i||void 0!==o||void 0!==s?{value:t,format:o,formulaBarText:null==s?void 0:s.formulaBarText,hasHyperlink:null==s?void 0:s.hasHyperlink}:void 0},e.prototype.outputRange=function(e,t,r){var n=this;if(r===p.ComputedCellKind.EditedCell||r===p.ComputedCellKind.DependentCell){var i=this.docs.setClientValue(e,t);(0,T.isSuccess)(i)||this.onUnavailableObject(i.reason)}var a=t.map((function(t,i){return t.map((function(t,a){return n.outputFormat((0,l.sheetGridCell)(e.sheet,(0,l.gridCell)(e.range.row+i,e.range.col+a)),r)}))})),o=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:a,formulaBarText:null==o?void 0:o.formulaBarText}},e.prototype.outputFormat=function(e,t){if(t===p.ComputedCellKind.EditedCell){var r=this.docs.getEditedFormat(e);if((0,T.isSuccess)(r)){var n=this.docs.testAndSetClientFormat(e,r.value);if((0,T.isSuccess)(n)){if(n.value){var i=r.value;if(i===p.SpecialFormat.Unavailable)return{format:(0,u.unavailable)([{kind:p.UnavailableKind.CellFormat}]),valueType:E.FormatValueType.Custom,decimals:0};var a=this.docs.resolveCellFormat(e.sheet.document,i);return(0,T.isSuccess)(a)?{format:"number"==typeof i?i:i.formatString,valueType:a.value.valueType,decimals:a.value.decimals}:void 0}}else this.onUnavailableObject(n.reason)}else this.onUnavailableObject(r.reason)}},e.prototype.outputFormulaProperties=function(e,t,r){if(t===p.ComputedCellKind.EditedCell){var n=r(e);if(void 0!==n){var i=n.formulaBarText,a=n.hasHyperlink,o=n.isFormula,s=this.docs.testAndSetClientFormula(e,i,a);if((0,T.isSuccess)(s)){var u=s.value,l=u.hasFmlaChanged,c=u.hasHyperlinkChanged;return l||c?{formulaBarText:l?i:void 0,hasHyperlink:c?a:void 0,isFormula:o}:void 0}this.onUnavailableObject(s.reason)}}},e.prototype.formatValue=function(e,t,r,n){var i=null!=n?n:this.docs,a=i.formatValueCell(t,r);if((0,T.isSuccess)(a))return a.value;i===this.docs&&this.outputMessageLog.push({kind:p.OutputMessageKind.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:a.reason})},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(!(0,T.isSuccess)(t))return t;if(void 0===t.value)return(0,T.failure)({kind:p.UnavailableKind.CellMissingFormula});var r=t.value,n=r[0],i=r[1];if(void 0===i.compiledFmla)return(0,T.failure)({kind:p.UnavailableKind.CellEvaluatingValue});var a=(0,l.lexicalSourceGrid)(i.lexicalKind,(0,l.sheetGridRange)(e.sheet,n));return(0,T.success)([a,i])},e.prototype.formulaHasHyperlink=function(e){if(e.lexicalKind!==l.LexicalKind.Cell)return!1;var t=null==e?void 0:e.compiledFmla.getValue();return(0,T.isSuccess)(t)?(0,A.reduceBottomUp)(q,t.value):void 0},e.prototype.handleSetCellContents=function(e,t,r,n,i,a,o,s,c,d,f){var g,h,v,S,y=void 0!==c?(0,u.unavailable)([{kind:p.UnavailableKind.ClientFailure,reason:c}]):void 0,F=o;void 0!==n?(h=n,(0,m.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==i),v=i):void 0===r?((0,m.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===i&&void 0!==o&&void 0===y),h=!1,v=void 0):((0,m.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===y&&F===p.SpecialFormat.Weak),h=(g=this.parseInferredEdit(t,r,a,y,F,f)).isFormula,v=g.oper,y=g.cellFailure,F=g.cellFormat,S=g.inferredFormat);var C=void 0!==f?f.cloneLazy.getValue():this.docs,R=C.setCellContents(e,t,r,h,a,v,y,F,s,d);if(R.kind===T.ResultKind.Failure)return this.onUnavailableObject(R.reason);if(C.onCellModified(e),!e){var b=(0,l.sheetGridCell)(t.sheet,a),E=void 0===r?(0,T.success)(void 0):h?C.inferFormulaFormat(b):void 0!==S&&S!==P.KnownFormat.General?C.resolveValueFormat(t.sheet.document,S):(0,T.success)(void 0);E.kind!==T.ResultKind.Success&&(this.onInferFormatFailure(b,E.reason),E=(0,T.success)(p.SpecialFormat.Unavailable)),void 0!==E.value&&C.fillInferredFormat(t,E.value),void 0!==f?(f.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,C,f)):this.enqueueBeforeCompute(d)}},e.prototype.parseInferredEdit=function(e,t,r,n,i,a){var o=a?a.cloneLazy.getValue().parseInferredEdit((0,l.sheetGridCell)(e.sheet,r),t,this.getVolatileMode()):this.docs.parseInferredEdit((0,l.sheetGridCell)(e.sheet,r),t,this.getVolatileMode());if(!(0,T.isSuccess)(o))return{isFormula:!1,oper:c.blankOper,cellFailure:o.reason,cellFormat:p.SpecialFormat.Unavailable};var s=t.length>0?t.charAt(0):"";switch("="!==s&&"+"!==s&&"-"!==s||o.value.kind!==E.EditKind.Formula&&o.value.kind!==E.EditKind.Number||m.ulsLogger.ULS.dnmTraceTag(541189698,R.LogCategory.msoulscat_ES_EWAJS,R.TraceLevel.Info,JSON.stringify({startChar:s,editKind:String(o.value.kind)})),o.value.kind){case E.EditKind.Formula:return{isFormula:!0,oper:c.blankOper,cellFailure:n,cellFormat:i};case E.EditKind.String:case E.EditKind.Other:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:i};case E.EditKind.Number:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:i,inferredFormat:o.value.format}}},e.prototype.handleSetRangeFormula=function(e,t,r,n,i){var a=(0,h.isFormulaText)(r);(0,m.assertTrue)("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||a);var o=e?void 0:c.blankOper,s=e?void 0:p.SpecialFormat.Weak,u=e?void 0:p.SpecialStyle.Weak,l=this.docs.setRangeFormula(e,t,r,n,o,s,u,i);if(l.kind===T.ResultKind.Failure)return this.onUnavailableObject(l.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(i)},e.prototype.handleEditPaste=function(e,t,r,n){var i=(0,l.sheetGridRange)(t.sheet,(0,l.gridRange)(t.range.row,t.range.col,r.range.rows,r.range.cols)),a=this.docs.copyRange(r);if(a.kind===T.ResultKind.Failure)return this.onUnavailableObject(a.reason);var o=this.docs.pasteRange(i,a.value);if(o.kind===T.ResultKind.Failure)return this.onUnavailableObject(o.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(n)},e.prototype.handleAssumeRecalcFinal=function(e){var t=this;this.scheduler.getCount(z.BeforeCompute)<0||this.scheduler.addTask(z.ComputeCellValue,b.QueuePos.Front,(function(){var r=t.docs.assumeRecalcFinal(e);if(r.kind===T.ResultKind.Failure)return t.onUnavailableObject(r.reason)}))},e.prototype.evalFormula=function(e,t,r,n,i){var a=this;return new Promise((function(s){var u=function(){return s({value:(0,T.failure)(o.stopped)})};a.scheduler.deleteTasks(z.EvalFormula,void 0),a.scheduler.addTask(z.EvalFormula,b.QueuePos.Back,{onRun:function(){if(!i&&!a.trySetStateId(z.EvalFormula,e))return u();a.enqueueComputeEvalFormula(t,r,n,i,s)},onDeleted:u}),a.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks(z.BeforeCompute,void 0),this.scheduler.addTask(z.BeforeCompute,b.QueuePos.Back,(function(){t.enqueueAfterCompute(),t.restrictToViewport(t.docs.getNonDirtyEditedCells(),e,p.ComputeKind.EditedCell,t.scheduleAvailableValues),t.restrictToViewport(t.docs.getDirtyEditedCells(),e,p.ComputeKind.EditedCell,t.scheduleAvailableFormulas),t.restrictToViewport(t.docs.getDirtyDependentCells(),e,p.ComputeKind.DependentCell,t.scheduleAvailableFormulas)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=(0,v.now)();try{r=e()}finally{this.stateEvalTime+=(0,v.fastMax)(1,(0,v.now)()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(j.EvalTimedOut),this.outputMessageLog.push({kind:p.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:p.RecalcStatisticsMessage.StateTimedOut}),r=[])}return r},e.prototype.enqueueEvalFormulaComputeCellValuesOnDocs=function(e,t,r){var n=this,c=[];(0,f.forEachCellInSet)(e.set,(function(t){return c.push((0,l.sheetGridCell)(e.sheet,t)),!0}));var d=(0,L.makeGridRangeTable)(),g=function(t,r,n){(0,u.isSheetIndexEqual)(t.sheet,e.sheet)&&(0,F.meetsProduct)(e.set,(0,f.createCellSetFromRange)(t.range))&&(0,s.forEachCellInRange)(t.range,(function(e){return d=d.setValue(e,r),!0}))},h=function(){return t.evaluate(p.ComputeKind.EvalFormula,c,n.getVolatileMode(),g)},S={onRun:function(){var e=n.withEvalTiming(h);if(Array.isArray(e)){var o=e.map((function(e,o){var s,l=c[o].range;if(!(0,T.isSuccess)(e)){if(e.reason.kind===a.ReasonKind.Stopped)return V(l,e.reason);var f=(0,u.unavailable)([{kind:p.UnavailableKind.EvalFailure,reason:e.reason}]);return n.onUnavailable(f),V(l,f)}var g=t.getCellValue(c[o]);if(!(0,T.isSuccess)(g))return V(l,null!==(s=d.getValue(l))&&void 0!==s?s:g.reason);try{(0,m.assertTrue)("calc.calc.PartialWorkbook: FinalValue after evalCell",g.value.kind===i.CellKind.FinalValue)}catch(e){f=(0,u.unavailable)([{kind:p.UnavailableKind.EvalFailure,reason:(0,k.javaScriptError)(e)}]);return n.onUnavailable(f),V(l,f)}var h=g.value.oper;if(!0===r.formatResults){var S=n.formatValue(p.ComputedCellKind.EditedCell,c[o],h,t);return(0,T.success)({cell:l,value:h,formatted:S})}return!1===r.formatResults?(0,T.success)({cell:l,value:h,formatted:void 0}):(0,T.success)((0,v.pair)(c[o].range,h))}));r.resultsPromise.resolve({stateId:r.stateId,results:o})}else h=e.resume,n.scheduler.addTask(z.ComputeEvalOnClone,b.QueuePos.Front,S)},onDeleted:function(){return r.resultsPromise.resolve({stateId:r.stateId,results:(0,D.arrayFill)(new Array(c.length),(0,T.failure)(o.stopped))})}};this.scheduler.addTask(z.ComputeEvalOnClone,b.QueuePos.Front,S)},e.prototype.enqueueComputeCellValue=function(e,t){var r,n=this,i=t===p.ComputeKind.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?(0,C.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc edited"):void 0,o=!0,s=function(){return n.docs.evaluate(t,[e],n.getVolatileMode())},u=function(){if(o){o=!1,r=n.shouldSample(n.config.sampleCellEvalStopwatchRate)?(0,C.ulsStopwatchFactory)("calc.calc.PartialWorkbook: cell eval"):void 0;var t=n.docs.getEditedFormula(e);if(!(0,T.isSuccess)(t))return n.onUnavailableObject(t.reason);if(void 0===t.value)return}else n.outputMessageLog.push({kind:p.OutputMessageKind.RecalcStatistics,stateId:n.stateId,message:p.RecalcStatisticsMessage.ContinueComputation});var l=n.withEvalTiming(s);if(Array.isArray(l)){null==r||r.stop(),null==i||i.stop();for(var c=0,d=l;c<d.length;c++){var m=d[c];(0,T.isSuccess)(m)||m.reason.kind===a.ReasonKind.Stopped||n.onUnavailableObject({kind:p.UnavailableKind.EvalFailure,reason:m.reason})}}else s=l.resume,n.scheduler.addTask(z.ComputeCellValue,b.QueuePos.Front,u)};this.scheduler.addTask(z.ComputeCellValue,b.QueuePos.Back,u)},e.prototype.enqueueComputeEvalFormula=function(e,t,r,n,i){var a=this;void 0===n&&(n=this.docs);var s=this.getVolatileMode(),u=function(){return n.evalFormula(e,t,r,s)},l={onRun:function(){var e=u();e.kind===T.ResultKind.Paused||e.kind===T.ResultKind.Breaked?(u=e.resume,a.scheduler.addTask(z.ComputeEvalFormula,b.QueuePos.Front,l)):i(e.value)},onDeleted:function(){return i({value:(0,T.failure)(o.stopped)})}};this.scheduler.addTask(z.ComputeEvalFormula,b.QueuePos.Back,l)},e.prototype.enqueueReturnCellValue=function(e,t){var r=this,n=this.getVolatileMode();this.scheduler.addTask(z.ComputeCellValue,b.QueuePos.Back,(function(){r.docs.evalValue(e,t,n)}))},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks(z.AfterCompute,j.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?(0,C.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(z.AfterCompute,b.QueuePos.Back,{onRun:function(){null==t||t.stop(j.EvalFinished),e.outputMessageLog.push({kind:p.OutputMessageKind.RecalcStatistics,message:p.RecalcStatisticsMessage.EditFinished,stateId:e.stateId})},onDeleted:function(e){null==t||t.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks(z.RecalcFinished,void 0),this.scheduler.addTask(z.RecalcFinished,b.QueuePos.Back,(function(){e.outputMessageLog.push({kind:p.OutputMessageKind.RecalcStatistics,message:p.RecalcStatisticsMessage.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,n){var i=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(i.trySetStateId(z.ServerUpdate,e)){var a=i.docs.promoteServerAvailability(r,n);if(a.kind===T.ResultKind.Failure)return i.onUnavailableObject(a.reason);i.docs.onCellModified(!0),a.value||i.outputMessageLog.push({kind:p.OutputMessageKind.UpdateRequest,stateId:i.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,n,i,a,o,s,u,l){var c=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){(l||c.trySetStateId(z.ServerUpdate,e))&&c.handleSetCellContents(!0,t,r,n,a,i,o,s,u,void 0,l)}))},e.prototype.editCellContents=function(e,t,r,n,i,a,o,s){var u=this;void 0===a&&(a=c.blankOper),void 0===o&&(o=(0,l.sheetGridRange)(t.sheet,G)),this.lastViewport=o,this.scheduler.addTask(z.ClientEdit,b.QueuePos.Back,(function(){u.trySetStateId(z.ClientEdit,e)&&u.handleSetCellContents(!1,t,r,n,a,i,p.SpecialFormat.Weak,p.SpecialStyle.Weak,void 0,o,s)})),this.enqueueRecalcFinished()},e.prototype.editCellContentsOnClone=function(e,t,r,n,i){this.editCellContents(this.stateId,e,t,r,n,void 0,void 0,i)},e.prototype.editCellFormats=function(e,t,r,n,i){var a=this;void 0===i&&(i=(0,l.sheetGridRange)(t.sheet,G)),this.lastViewport=i,this.scheduler.addTask(z.ClientEdit,b.QueuePos.Back,(function(){if(a.trySetStateId(z.ClientEdit,e)){var o="SetFormat"===r.kind?a.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?a.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,(0,l.sheetGridCell)(t.sheet,n)):"ChangeDecimals"===r.kind?a.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,(0,l.sheetGridCell)(t.sheet,n)):(0,m.assertNever)("calc.calc.PartialWorkbook: editCellFormats",r);(0,T.isSuccess)(o)||(0,f.forEachRangeInSet)(t.set,(function(e){return a.onInferFormatFailure((0,l.sheetGridRange)(t.sheet,e),o.reason),!0})),(0,T.isSuccess)(o)&&void 0===o.value||a.handleSetCellContents(!1,t,void 0,void 0,void 0,(0,l.gridCell)(0,0),(0,T.isSuccess)(o)?o.value:p.SpecialFormat.Unavailable,void 0,void 0,i)}})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,n,i){var a=this;void 0===n&&(n=(0,u.gridRangeAnchor)(t.range)),void 0===i&&(i=!1),this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){a.trySetStateId(z.ServerUpdate,e)&&a.handleSetRangeFormula(!0,t,r,n,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,n,i){var a=this;void 0===n&&(n=(0,u.gridRangeAnchor)(t.range)),void 0===i&&(i=(0,l.sheetGridRange)(t.sheet,G)),this.lastViewport=i,this.scheduler.addTask(z.ClientEdit,b.QueuePos.Back,(function(){a.trySetStateId(z.ClientEdit,e)&&a.handleSetRangeFormula(!1,t,r,n,i)})),this.enqueueRecalcFinished()},e.prototype.editPaste=function(e,t,r,n,i){var a=this;void 0===i&&(i=(0,l.sheetGridRange)(r.sheet,G)),this.scheduler.addTask(z.ClientEdit,b.QueuePos.Back,(function(){a.trySetStateId(z.ClientEdit,e)&&a.handleEditPaste(t,r,n,i)})),this.enqueueRecalcFinished()},e.prototype.assumeRecalcFinal=function(e,t){var r=this;this.scheduler.addTask(z.ClientEdit,b.QueuePos.Back,(function(){r.stateId===e&&r.handleAssumeRecalcFinal(t)}))},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask(z.TestAdvanceState,b.QueuePos.Back,(function(){t.trySetStateId(z.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(t,r){var n,i,a,o,s,u=this;if(r<this.stateId)return!1;if(t===z.ClientEdit&&(this.deleteComputeTasks(j.EditReceived),this.stateEvalTime=0),r>this.stateId){if(this.stateId!==-1/0){var l=this.config.sampleWorkbookStatisticsRate;void 0!==l&&this.shouldSample(l)&&this.outputMessageLog.push({kind:p.OutputMessageKind.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:l})}1===this.stateChanges&&this.enqueueRunExperiments(_.ExperimentKind.OneShot),this.stateChanges>=1&&0===this.scheduler.getCount(z.RunExperiment)&&this.enqueueRunExperiments(_.ExperimentKind.Recurring);var c=null!==(n=this.config.samplePrecisionEvalRate)&&void 0!==n?n:0,d=null!==(i=this.config.samplePrecisionPrintFormulaRate)&&void 0!==i?i:0,m=null!==(a=this.config.samplePrecisionPrintValueRate)&&void 0!==a?a:0;if(this.stateChanges>=1&&(c>0||d>0||m>0)&&this.numPrecisionFailures<e.maxPrecisionFailures&&0===this.scheduler.getCount(z.RunExperiment)){var f=this.config.experimentFactories,g=null!==(o=null==f?void 0:f.stepBudget)&&void 0!==o?o:10,h=null!==(s=null==f?void 0:f.totalBudget)&&void 0!==s?s:1e4,v=new N.PrecisionExperiment({samplePrecisionEvalRate:c,samplePrecisionPrintFormulaRate:d,samplePrecisionPrintValueRate:m}),S={stateId:this.stateId,documents:this.docs.clone(v),stepBudget:g,totalBudget:h,viewport:this.lastViewport};v.setContext(S),this.enqueueRunExperiment("PrecisionExperiment",g,h,_.ExperimentKind.Precision,v,(function(){return u.numPrecisionFailures=0}),(function(){return u.numPrecisionFailures+=1}))}this.deleteComputeTasks(j.StateIdAdvanced),this.lastViewport=void 0;var y=this.stateId;this.stateId=r,this.docs.advanceState(y),this.outputMessageLog.push({kind:p.OutputMessageKind.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks(z.BeforeCompute,void 0),this.scheduler.deleteTasks(z.ComputeCellValue,void 0),this.scheduler.deleteTasks(z.AfterCompute,e),e!==j.EvalTimedOut&&this.scheduler.deleteTasks(z.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t,r,n,i,a,o){var s=this,u=0,l=0,c=function(t,r,a,o){var u=i.failedLogMessage;void 0!==u&&s.outputMessageLog.push({experimentName:e,kind:p.OutputMessageKind.ExperimentRunResult,experimentKind:n,logMessage:u,timeoutReason:{budgetType:t,budget:r,elapsedTime:a,stepsCount:o}})},d=function(){if(i.done){var m=i.resultLogMessage;return void 0!==m&&s.outputMessageLog.push({experimentName:e,kind:p.OutputMessageKind.ExperimentRunResult,experimentKind:n,logMessage:m}),void a()}for(var f=(0,v.now)(),g=f,h=0;h<1e3&&g===f;h+=1){i.step(),l+=1;var S=(0,v.now)(),y=S-g;if(y>=t&&!i.done)return c("stepBudget",t,y,l),void o();g=S}if((u+=g>f?g-f:1)>=r&&!i.done)return c("totalBudget",r,u,l),void o();s.scheduler.addTask(z.RunExperiment,b.QueuePos.Front,d)};this.scheduler.addTask(z.RunExperiment,b.QueuePos.Back,d)},e.prototype.enqueueRunExperiments=function(e){var t;if(this.config.experimentFactories){var r=this.config.experimentFactories,n=r.stepBudget,i=r.totalBudget,a=r.factories.filter((function(t){var r,n;return t.kind===e&&(null!==(r=t.numFailures)&&void 0!==r?r:0)<(null!==(n=t.maxFailures)&&void 0!==n?n:3)}));if(0!==a.length)for(var o={stateId:this.stateId,documents:this.docs.clone(S.voidCallback,e===_.ExperimentKind.OneShot?g.CloningTarget.Server:g.CloningTarget.Client),stepBudget:n,totalBudget:i,viewport:this.lastViewport},s=function(r){var a=r.create();if(!a)return"continue";a.setContext(o),u.enqueueRunExperiment(r.experimentName,null!==(t=r.stepBudget)&&void 0!==t?t:n,i,e,a,(function(){return r.numFailures=0}),(function(){var e;return r.numFailures=(null!==(e=r.numFailures)&&void 0!==e?e:0)+1}))},u=this,l=0,c=a;l<c.length;l++){s(c[l])}}},e.prototype.setSheetNames=function(e,t,r){var n=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(n.trySetStateId(z.ServerUpdate,r)){var i=n.docs.setSheetNames(e,t);i.kind===T.ResultKind.Failure&&n.onUnavailableObject(i.reason),n.deleteComputeTasks(j.SetSheetNames)}}))},e.prototype.setLangConfig=function(e,t){var r=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(r.trySetStateId(z.ServerUpdate,e)){var n=r.docs.config.localeInfo!==t.localeInfo,i=r.docs.config.refStyle!==t.refStyle;r.docs.setConfig(t),n&&r.docs.clearCompiledNumberFormats(),(n||i)&&(r.docs.clearCompiledFormulas(),r.deleteComputeTasks(j.SetLangConfig))}}))},e.prototype.setNumberFormats=function(e,t,r,n){var i=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(i.trySetStateId(z.ServerUpdate,n)){var a=i.docs.setNumberFormats(e,t,r);return a.kind===T.ResultKind.Failure?i.onUnavailable(a.reason):void 0}}))},e.prototype.writeNamedObject=function(e,t,r,n){var i=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(i.trySetStateId(z.ServerUpdate,e)){var a=i.docs.setNamedObject(!0,(0,l.nameLoc)(t,r),n);return a.kind===T.ResultKind.Failure?i.onUnavailable(a.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(r.trySetStateId(z.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===T.ResultKind.Failure?r.onUnavailable(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var n=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(n.trySetStateId(z.ServerUpdate,e)){var i=n.docs.promoteNamedObjects(t,r);if(i.kind===T.ResultKind.Failure)return n.onUnavailable(i.reason);i.value||n.outputMessageLog.push({kind:p.OutputMessageKind.UpdateNamesRequest,stateId:n.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(r.trySetStateId(z.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===T.ResultKind.Failure)return r.onUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(r.trySetStateId(z.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===T.ResultKind.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeHiddenCols=function(e,t){var r=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(r.trySetStateId(z.ServerUpdate,e)){var n=r.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return n.kind===T.ResultKind.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask(z.ServerUpdate,b.QueuePos.Back,(function(){if(r.trySetStateId(z.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===T.ResultKind.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks(z.MaybeCollectGarbage,void 0),this.scheduler.addTask(z.MaybeCollectGarbage,b.QueuePos.Back,(function(){if(!(e.stateChangesSinceLastGC<t.MaxStateIdDifferenceForGC)){var r=e.stateId-t.MaxStateIdDifferenceForGC;e.docs.collectGarbage(r),e.outputMessageLog.push({kind:p.OutputMessageKind.GarbageCollected,minStateIdKept:r}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.translateEnglishFormula=function(e,t){var r=this.englishParser.parseFormula((0,K.parseLocals)(l.LexicalKind.Cell,t.range),e);if(!(0,T.isSuccess)(r))return r;var n=this.englishAnalyzer.checkFormula((0,B.analyzeLocalsGrid)(l.LexicalKind.Cell,(0,l.sheetGridCell)(t.sheet,t.range)),r.value);if(!(0,T.isSuccess)(n))return n;if(!(0,s.isWellFormed)(n.value))return(0,T.failure)((0,i.illFormedFormula)("ill-formed formula"));var a=this.docs.printFormulaBarText((0,l.lexicalSourceGrid)(l.LexicalKind.Cell,t),t.range,n.value);return(0,T.isSuccess)(a)?(0,T.success)(a.value):a},e.prototype.restrictToViewport=function(e,t,r,n){if(void 0!==t)for(var i=t.sheet,a=t.range,o=(0,f.createCellSetFromRange)(a),s=0,l=e;s<l.length;s++){var c=l[s];(0,u.isSheetIndexEqual)(i,c.sheet)&&n((0,p.sheetCellSet)(i,(0,F.intersectProduct)(c.set,o)),r)}else for(var d=0,m=e;d<m.length;d++){n(c=m[d],r)}},e.prototype.getVolatileMode=function(){var e;return null!==(e=this.config.volatileMode)&&void 0!==e?e:O.VolatileMode.Estimation},e.maxPrecisionFailures=3,e}();t.PartialWorkbook=Y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(1);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(1);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchdog=void 0;var n,i,a=(0,r(199).createPerf)();t.watchdog=(n=1/0,(i=function(e){if(void 0===e&&(e=""),a.now()>n)throw new Error("Time limit exceeded with message: ".concat(e))}).arm=function(e){n=a.now()+e},i)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.createPerf=void 0;function n(){return"undefined"!=typeof process?{now:function(){var e=process.hrtime();return(1e9*e[0]+e[1])/1e6}}:"undefined"!=typeof performance?performance:Date}t.createPerf=n;var i=function(){function e(e){this.perf=n(),this.name=e,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(e){var t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(e){return Math.round(100*e)/100},e}();t.Timer=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unify=t.compose=t.createPoisonApplication=t.UnificationResultKind=t.substituteVariable=t.serialiseMeasure=t.toUnitConstraint=t.shuffleNormalForms=t.pow=t.inv=t.prod=t.areSignaturesEqual=t.isSimpleUnit=t.fromVar=t.fromConstants=t.makeSignature=t.someVar=t.everyVar=t.someConst=t.everyConst=void 0;var n=r(4),i=r(201);function a(e,t){for(var r in e)if(!t(r,e[r]))return!1;return!0}var o=function(e,t){return!a(e,(function(e,r){return!t(e,r)}))};t.everyConst=function(e,t){return a(e.consts,t)};t.someConst=function(e,t){return o(e.consts,t)};t.everyVar=function(e,t){return a(e.vars,t)};function s(e,t){var r=0;!function(e,t){for(var r in e)t(r,e[r])}(t.vars,(function(){return r+=1})),(0,n.assertTrue)(e,void 0===t.name||1===t.varCount),(0,n.assertTrue)(e,t.varCount===r)}function u(e,t,r){var n={varCount:e,vars:t,consts:r,name:void 0};return s(i.Messages.Root,n),n}function l(){}function c(){return new l}t.someVar=function(e,t){return o(e.vars,t)},t.makeSignature=u;var d=c();function p(){return u(0,{},c())}function m(e){return u(0,{},e)}t.fromConstants=m,t.fromVar=function(e){var t,r=u(1,((t={})[e]=1,t),d);return r.name=e,r};var f,g=function(){return!1};function h(e,r){return(0,t.everyVar)(e,(function(e,t){return r.vars[e]===t}))&&(0,t.everyConst)(e,(function(e,t){return r.consts[e]===t}))}function v(e,t){var r,n,a=p(),o=e.vars,u=e.consts,l=t.vars,c=t.consts;for(var d in o){0!==(m=o[d]-(null!==(r=l[d])&&void 0!==r?r:0))&&(a.vars[d]=m,a.varCount+=1)}for(var d in u){var m;0!==(m=u[d]-(null!==(n=c[d])&&void 0!==n?n:0))&&(a.consts[d]=m)}for(var d in l)void 0===o[d]&&(a.vars[d]=-l[d],a.varCount+=1);for(var d in c)void 0===u[d]&&(a.consts[d]=-c[d]);return s(i.Messages.Root,a),a}function S(e,t,r,n){return r?1===t?e:"".concat(e,"^").concat(t):-1===t?e:"".concat(e,"^").concat(t*n)}function y(e,t,r){var n=t.vars,i=t.consts,a=n[e];if(void 0===a)return t;var o=0,s=p(),l=s.vars,c=s.consts;for(var d in n){var m=r.vars[d],f=void 0===m?0:m;0!==(g=(d===e?0:n[d])+f*a)&&(o+=1,l[d]=g)}for(var d in r.vars){void 0===n[d]&&(o+=1,l[d]=a*r.vars[d])}for(var d in i){var g,h=r.consts[d];0!==(g=i[d]+a*(void 0===h?0:h))&&(c[d]=g)}for(var d in r.consts){void 0===i[d]&&(c[d]=a*r.consts[d])}return u(o,l,c)}t.isSimpleUnit=function(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===d||(0,t.everyConst)(e,g))){var r=function(e,t){for(var r in e.vars)return t===e.vars[r]?r:void 0}(e,1);return void 0!==r&&(e.name=r,!0)}return!1},t.areSignaturesEqual=function(e,t){return h(e,t)&&h(t,e)},t.prod=function(e,t){var r,n,a=p(),o=e.vars,u=e.consts,l=t.vars,c=t.consts;for(var d in o){0!==(m=o[d]+(null!==(r=l[d])&&void 0!==r?r:0))&&(a.vars[d]=m,a.varCount+=1)}for(var d in u){var m;0!==(m=u[d]+(null!==(n=c[d])&&void 0!==n?n:0))&&(a.consts[d]=m)}for(var d in l)void 0===o[d]&&(a.vars[d]=l[d],a.varCount+=1);for(var d in c)void 0===u[d]&&(a.consts[d]=c[d]);return s(i.Messages.Root,a),a},t.inv=function(e){var t=p(),r=e.vars,n=e.consts;for(var a in r)t.vars[a]=-r[a];for(var a in n)t.consts[a]=-n[a];return t.varCount=e.varCount,s(i.Messages.Root,t),t},t.pow=function(e,t,r){if(0===t)return r;var n=p(),a=e.vars,o=e.consts;for(var u in a)n.vars[u]=a[u]*t;for(var u in o)n.consts[u]=o[u]*t;return n.varCount=e.varCount,s(i.Messages.Root,n),n},t.shuffleNormalForms=function(e,r){var a,o,u=p(),l=p(),c=u.vars,d=l.consts;for(var m in e.vars){0!==(f=e.vars[m]-(null!==(a=r.vars[m])&&void 0!==a?a:0))&&(c[m]=f,u.varCount+=1)}for(var m in r.vars)void 0===e.vars[m]&&(c[m]=-r.vars[m],u.varCount+=1);for(var m in r.consts){var f;0!==(f=r.consts[m]-(null!==(o=e.consts[m])&&void 0!==o?o:0))&&(d[m]=f)}for(var m in e.consts)void 0===r.consts[m]&&(d[m]=-e.consts[m]);return s(i.Messages.Root,u),s(i.Messages.Root,l),(0,n.assertTrue)(i.Messages.Root,(0,t.everyConst)(u,g)),{vars:u,consts:l}},t.toUnitConstraint=v,t.serialiseMeasure=function(e){var t=[],r=[];for(var n in e.vars){(a=e.vars[n])>0?t.push([n,a]):r.push([n,a])}for(var i in e.consts){var a;(a=e.consts[i])>0?t.push([i,a]):r.push([i,a])}if(0===r.length)return 0===t.length?"1":t.map((function(e){return S(e[0],e[1],!0,1)})).join("*");var o=r.map((function(e){return S(e[0],e[1],!1,-1)})).join("*");if(r.length>1&&(o="("+o+")"),0===t.length)return"1/".concat(o);var s=t.map((function(e){return S(e[0],e[1],!0,1)})).join("*");return"".concat(s,"/").concat(o)},t.substituteVariable=y,function(e){e[e.Fail=0]="Fail",e[e.Subst=1]="Subst"}(f||(t.UnificationResultKind=f={}));var F=function(){},C={kind:f.Subst,substitution:F},R=function(e){return{kind:f.Subst,substitution:e}},b={kind:f.Fail},E=function(e){return e<0?-e:e};function P(e,t,r){var n={};return r===F?t:t===F?r:function(i){var a=n[i];if(void 0!==a)return a;var o=r(i);return n[i]=void 0===o?t(i):e(t,o)}}function k(e,t){return function(r){return e===r?t:void 0}}t.createPoisonApplication=function(e){return function(t,r){if(0===r.varCount||t===F)return r;var n=r;for(var i in r.vars){var a=t(i);if(a===e)return e;void 0!==a&&(n=y(i,n,a))}return n}},t.compose=P;t.unify=function(e,r,a){return function e(r,a,o){if(r>=100)return(0,n.assertFalse)(i.Messages.UnifyBound);if(0===o.varCount)return(0,t.everyConst)(o,g)?C:b;if(1===o.varCount){var s;for(var l in o.vars){s=l;break}(0,n.assertTrue)(i.Messages.Root,void 0!==s);var c=o.vars[s],d={};for(var p in o.consts){if((N=o.consts[p])%c!=0)return b;d[p]=-N/c}return R(k(s,m(d)))}var h,v=0,S=void 0,F=o.vars,T=o.consts,A=o.varCount;for(var p in F){var N=F[p],_=E(N);(void 0===S||_<S)&&(v=N,S=_,h=p)}(0,n.assertTrue)(i.Messages.Root,void 0!==h),(0,n.assertTrue)(i.Messages.Root,0!==v);var I={},O={};for(var p in F)if(p===h)I[p]=1;else{N=F[p];I[p]=-Math.floor(N/v)}for(var p in T){N=T[p];O[p]=-Math.floor(N/v)}var M=u(A,I,O),D=e(r+1,a,y(h,o,M));return D.kind===f.Fail?D:R(P(a,D.substitution,k(h,M)))}(0,e,v(r,a))}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=void 0,function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(n||(t.Messages=n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=t.convertX10UpdatesToCalcUpdates=t.RecalcSideGrid=void 0;var n=r(0),i=r(2),a=r(5),o=r(15),s=r(11),u=r(11),l=r(96),c=r(78),d=n.__importStar(r(80)),p=r(77),m=r(120),f=r(20),g=r(30),h=r(39),v=r(9);(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)(),(0,i.staticAssertSame)();var S=function(){function e(e){this.calcGrid=e,this.snapshotPromises=[]}return e.prototype.createIGridExportEndpoint=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t=this;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,d.Endpoint.createInside(e,(function(){return t}))];case 1:return r.sent(),[2]}}))}))},e.prototype.discardSnapshot=function(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)},e.prototype.evalClonedModelOnSnapshot=function(e,t,r,i){var o;return n.__awaiter(this,void 0,void 0,(function(){var s,l,c,d,p;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(s=(null!==(o=n.sent())&&void 0!==o?o:{snapshot:void 0}).snapshot)?[2,(0,a.failure)((0,u.unavailable)(["evalOnClonedModel"]))]:(l=y(t,s.config.mathpack),c=F(r,s.config.mathpack),d=this.calcGrid.evalOnClonedModelOnSnapshot(l,c,s,i),this.calcGrid.resumeRecalc(),p=a.success,[4,d]);case 2:return[2,p.apply(void 0,[n.sent()])]}}))}))},e.prototype.evalFormulaOnSnapshot=function(e,t,r,i){var o;return void 0===i&&(i={kind:f.SpecialFormat.Origin}),n.__awaiter(this,void 0,void 0,(function(){var s,l,c,d;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(s=(null!==(o=n.sent())&&void 0!==o?o:{snapshot:void 0}).snapshot)?[2,(0,a.failure)((0,u.unavailable)(["evalFormula"]))]:(l=this.calcGrid.evalFormulaOnSnapshotImpl(t,r,i,s),this.calcGrid.resumeRecalc(),d=C,[4,l]);case 2:return c=d.apply(void 0,[n.sent()]),[2,(0,a.success)(c)]}}))}))},e.prototype.getSheetNames=function(e){var t;return n.__awaiter(this,void 0,void 0,(function(){var r,i,s,l,c,d,p;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(r=(null!==(t=n.sent())&&void 0!==t?t:{snapshot:void 0}).snapshot))return[2,(0,a.failure)((0,u.unavailable)(["getSheetNames"]))];if(i={document:this.calcGrid.document,sheets:new Array},s=r.getSheetRangeIndexes((0,o.allSheetsRange)(this.calcGrid.document)),!(0,a.isSuccess)(s))return[2,s];for(l=0,c=s.value.sheets;l<c.length;l++){if(d=c[l],p=r.getSheetName(this.calcGrid.document,d),!(0,a.isSuccess)(p))return[2,p];i.sheets.push({sheetIndex:(0,o.sheetIndex)(this.calcGrid.document,d),sheetName:p.value})}return[2,(0,a.success)(i)]}}))}))},e.prototype.getCorrespondingSnapshotID=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(t=r.sent())?[2,-1]:[2,t.correspondingId]}}))}))},e.prototype.getOrCreateSnapshot=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){return void 0===this.snapshotPromises[e]&&(this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot(e),this.calcGrid.resumeRecalc().catch((function(e){setTimeout((function(){throw e}))}))),[2,this.snapshotPromises[e]]}))}))},e.prototype.getRangeFormats=function(e,t){return this.getRangeData(e,t,"formats")},e.prototype.getRangeValues=function(e,t){return this.getRangeData(e,t,"values")},e.prototype.getRangeFormulae=function(e,t){return this.getRangeData(e,t,"formulae")},e.prototype.getRangeData=function(e,t,r){var i;return n.__awaiter(this,void 0,void 0,(function(){var s,d,p,m,v,S,y;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(s=(null!==(i=n.sent())&&void 0!==i?i:{snapshot:void 0}).snapshot)?[2,(0,a.failure)((0,u.unavailable)(["getRangeData/getOrCreateSnapshot"]))]:(d=s.allEditedAvailable(t)).kind!==a.ResultKind.Success?[2,(0,a.failure)((0,u.unavailable)(["getRangeData/allEditedAvailable"]))]:(p=(0,g.createCellSetFromRange)(t.range),!0!==d.value&&(p=(0,h.exceptProduct)(p,d.value)),m=function(e){var r=[];return(0,g.forEachRangeInSet)(p,(function(n){var i=e((0,o.sheetGridRange)(t.sheet,n),(function(e){p=(0,h.exceptProduct)(p,(0,g.createCellSetFromRange)(e))}),(function(e,t){r.push([[e.row,e.col],t])}));return i.kind===a.ResultKind.Success&&i.value}))?(0,a.success)(r):(0,a.failure)((0,u.unavailable)(["getRangeData/extractData"]))},v={formulae:function(){return m((function(e,t,r){return s.forEachEditedFormula(e,(function(e,n){var i=n.lexicalKind,a=n.compiledFmla,s=n.fmla,d=n.origin;return i!==o.LexicalKind.Range&&(0,u.isGridCell)(e)?(0,c.isBlankGridFormula)(s,void 0!==a)||r(e,{kind:void 0!==a?l.FormulaKind.CellFormula:l.FormulaKind.Value,formulaBarText:s,origin:(0,u.isGridCellEqual)(d,e)?void 0:d}):t(e),!0}))}))},formats:function(){return m((function(e,t,r){return s.forEachEditedFormat(e,(function(e,n){return n===f.SpecialFormat.Unavailable?t(e):(0,c.isBlankCellFormat)(n)||r(e,"number"==typeof n?n:n.formatString),!0}))}))},values:function(){return m((function(e,t,r){return s.forEachRecalcValue(e,(function(e,n){return void 0!==n.failure?t(e):(0,c.isBlankGridValue)(n.oper,n.failure)||r(e,n.oper),!0}))}))}}[r](),(S=v).kind!==a.ResultKind.Success?[2,S]:(y=[],(0,g.forEachRangeInSet)(p,(function(e){return y.push(e),!0})),[2,(0,a.success)({nonEmptyCells:S.value,availableRanges:y})]))}}))}))},e.prototype.getIntersectingTables=function(e,t){var r,i;return n.__awaiter(this,void 0,void 0,(function(){var s,l,c,d,p,m,f,S,y,F,C,R;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(s=(null!==(r=n.sent())&&void 0!==r?r:{snapshot:void 0}).snapshot))return[2,(0,a.failure)((0,u.unavailable)(["getIntersectingTables/getOrCreateSnapshot"]))];if((l=s.allServerAvailable(t)).kind!==a.ResultKind.Success)return[2,(0,a.failure)((0,u.unavailable)(["getIntersectingTables/allServerAvailable"]))];if(c=s.getIntersectingTables(t),!(0,a.isSuccess)(c))return[2,(0,a.failure)((0,u.unavailable)(["getIntersectingTables/getIntersectingTables"]))];for(d=[],p=function(e){var t=s.getNamedObject(e,o.NameSource.Plain);if(t.kind!==a.ResultKind.Success)return{value:t};if("NamedTable"!==(null===(i=t.value)||void 0===i?void 0:i.kind))return"continue";var r=[];t.value.columnIndexes.forEach((function(e,t){return r.push({column:e,name:t}),!0})),d.push({name:e.name,dataRange:t.value.specialRefRanges[v.SpecialRefId.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:r})},m=0,f=c.value;m<f.length;m++)if(S=f[m],"object"==typeof(y=p(S)))return[2,y.value];return F=(0,g.createCellSetFromRange)(t.range),C=!0===l.value?F:(0,h.exceptProduct)(F,l.value),R=[],(0,g.forEachRangeInSet)(C,(function(e){return R.push(e),!0})),[2,(0,a.success)({tables:d,availableRanges:R})]}}))}))},e.prototype.getIformats=function(e,t,r,i){var o;return n.__awaiter(this,void 0,void 0,(function(){var s,l;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(s=(null!==(o=n.sent())&&void 0!==o?o:{snapshot:void 0}).snapshot)?[2,(0,a.failure)((0,u.unavailable)(["getIformats/getOrCreateSnapshot"]))]:(l=s.getIformats(t,r,i),(0,a.isSuccess)(l)?[2,(0,a.success)({availableFormats:l.value})]:[2,(0,a.failure)((0,u.unavailable)(["getIformats/getIntersectingTables"]))])}}))}))},e.prototype.getHiddenRows=function(e,t,r,i){var a;return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=(null!==(a=n.sent())&&void 0!==a?a:{snapshot:void 0}).snapshot)?[2,c.hiddennessFullyUnavailable]:[2,o.getHiddenRows(t,r,i)]}}))}))},e.prototype.getHiddenCols=function(e,t,r,i){var a;return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=(null!==(a=n.sent())&&void 0!==a?a:{snapshot:void 0}).snapshot)?[2,c.hiddennessFullyUnavailable]:[2,o.getHiddenCols(t,r,i)]}}))}))},e}();function y(e,t){return e.map((function(e){if(!(0,i.isDefined)(e.data))return{data:void 0,range:(0,m.sheetGridRangeToLocation)(e.range)};var r=(0,m.readOperToCellValue)(t,e.data.value);return{data:{kind:e.data.kind,formulaBarText:e.data.formulaBarText,value:null!=r?r:p.blankValue,iformat:e.data.iformat,failureReason:void 0===r?"unsupported Oper serialization":void 0},range:(0,m.sheetGridRangeToLocation)(e.range)}}))}function F(e,t){return e.map((function(e){var r=e.range,a=r[0],o=r.slice(1),s=n.__spreadArray([(0,m.sheetGridRangeToLocation)(a)],o.map((function(e){return(0,m.sheetGridRangeToLocation)(e)})),!0);return{kind:e.kind,range:s,formulaBarText:e.formulaBarText,value:(0,i.isDefined)(e.value)?(0,m.readOperToCellValue)(t,e.value):void 0,origin:(0,i.isDefined)(e.origin)?(0,m.gridCellToCellLocation)(e.origin):void 0}}))}function C(e){if(e.value.kind===a.ResultKind.Failure&&e.value.reason.kind===s.ReasonKind.Unavailable)for(var t=e.value.reason.objects,r=0;r<t.length;r++){var i=t[r];i.kind===f.UnavailableKind.GridRange&&(t[r]=n.__assign(n.__assign({},i),{unavailableCells:!0}))}return e}t.RecalcSideGrid=S,t.convertX10UpdatesToCalcUpdates=y,t.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=F},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;var n=r(1);t.setImmediateUnified=n.setTimeoutInterfaceModule.setImmediateUnified,t.clearTimerUnified=n.setTimeoutInterfaceModule.clearTimerUnified,t.defaultSetTimeoutInterface=n.setTimeoutInterfaceModule.defaultSetTimeoutInterface},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.shouldRunComputation=t.FormulaBarScheduler=t.parentMethodsPost=t.parentMethodsCall=void 0;var a=r(0),o=r(15),s=r(6),u=r(2),l=r(2),c=r(2),d=r(4),p=r(12),m=r(17),f=r(17),g=r(505),h=r(60),v=r(29),S=r(5),y=r(122),F=r(95),C=r(507),R=r(121),b=r(508),E=r(311),P=r(312),k=r(313),T=r(35),A=r(509),N=r(510),_=r(314),I=r(13),O=r(512),M=r(22),D=r(513),w=r(47),L=r(514),x=r(143),K=r(515),U=r(48),B=r(142),W=r(144),G=r(205),V=r(205),j=r(98),q=r(98),H=r(98),z=r(517),Q=r(519),Y=function(){function e(){this.current=0}return e.prototype.create=function(){return this.current+=1},e}(),J=(0,U.mapFromArrayOfDependantPairs)((0,u.numEnumArray)(s.PluginFactoryName).map((function(e){return[e,s.PluginFactoryName[e]]})));t.parentMethodsCall=["createChatGPTSession","closeChatGPTSession","sendChatGPTQuery","sendAugLoopSignal","registerALAnnotation","getRecognizedTablesInfo"],t.parentMethodsCall,t.parentMethodsPost=["addResult","addToComputationCount","triggerEventImmediate"],(0,l.staticAssertSame)();var $={kind:"RequestFailure"},X={kind:A.InternalSchedulerResponseKind.FirstStep},Z=((n={})[h.NotificationKind.setActiveCell]=!0,n[h.NotificationKind.setActiveCellFormat]=!0,n[h.NotificationKind.doNothing]=!0,n),ee=(0,M.getTypedFeatureGate)("Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension"),te=(0,M.isTypedChangeGateEnabled)("OfficeVSO:8620448_x10SchedulerThrowsFailures"),re=function(){function e(e,t,r,n,i){var s,u,l,m,v,S;void 0===r&&(r=a.__assign({},P.defaultPluginResponseWindows)),void 0===n&&(n=y.defaultTimerInterface);var F=this;this.createPrefetchingCache=t,this.pluginResultWindows=r,this.timer=n,this.parent=i,this.responseStates=(0,U.mapFromArrayOfDependantPairs)((0,c.strEnumArray)(W.ComputationType).map((function(e){return[e,(0,U.mapFromArrayOfDependantPairs)((0,c.strEnumArray)(W.ComputationKinds[e]).map((function(t){return[t,new f.ResponseState(e,t)]})))]}))),this.uiMessages=(0,U.mapFromArrayOfDependantPairs)((0,c.strEnumArray)(W.ComputationKinds[W.ComputationType.UIMessage]).map((function(e){return[e,new x.Subject]}))),this.syncUIMessages=(0,U.mapFromArrayOfDependantPairs)((0,c.strEnumArray)(W.ComputationKinds[W.ComputationType.UIMessage]).map((function(e){return[e,new x.Subject]}))),this.eventHandlers=(0,U.mapFromArrayOfDependantPairs)((0,c.strEnumArray)(W.ComputationKinds[W.ComputationType.Event]).map((function(e){return[e,new x.Subject]}))),this.conflictResolvers=((s={})[W.ComputationType.UIMessage]=C.conflictResolver,s[W.ComputationType.Event]=(0,c.mapFromArrayOfPairs)((0,c.strEnumArray)(W.ComputationKinds[W.ComputationType.Event]).map((function(e){return[e,function(){}]}))),s),this.computationSubjects=((u={})[W.ComputationType.UIMessage]=((l={})[B.ExecutionType.Async]=this.uiMessages,l[B.ExecutionType.Sync]=this.syncUIMessages,l),u[W.ComputationType.Event]=((m={})[B.ExecutionType.Async]=this.eventHandlers,m),u),this.syncMessageQueue=new _.PriorityQueue((function(){return 0})),this.doNotifyStatelessSubject=new x.Subject,this.doNotifyStatefulSubject=new x.InitializingSubject((function(){return F.syncDataModel.getStateAsNotifications()})),this.requestWithCorrelationIdSubject=new x.Subject,this.syncDataModel=new O.SyncDataModel,this.idFactory=new Y,this.eventComputationGroupFactory=new Y,this.state={scheduler:this},this.notificationProcessorMap=((v={})[h.NotificationKind.setActiveCell]=this.setActiveCellImpl.bind(this),v[h.NotificationKind.setActiveCellFormat]=this.setActiveCellFormatImpl.bind(this),v[h.NotificationKind.setA1ReferenceStyle]=this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),v[h.NotificationKind.setLocale]=this.syncDataModel.setLocale.bind(this.syncDataModel),v[h.NotificationKind.setWorkbookProps]=this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),v[h.NotificationKind.updateSheetNames]=this.syncDataModel.updateSheetNames.bind(this.syncDataModel),v[h.NotificationKind.updateNamedObjects]=this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),v[h.NotificationKind.doNothing]=function(){},v[h.NotificationKind.setFunctionsInfo]=this.setFunctionInfo.bind(this),v[h.NotificationKind.conflictResolverEarlyTermination]=function(e,t,r){return F.stopComputationFrame(e,t,W.ComputationType.UIMessage,r,f.ExecutionStopReason.Frame.ConflictResolverEarlyTermination)},v[h.NotificationKind.setDefinedNamesInfo]=this.setDefinedNamesInfo.bind(this),v[h.NotificationKind.notifyWorkbookClosing]=this.onWorkbookClosing.bind(this),v[h.NotificationKind.setSchedulerFeatures]=this.syncDataModel.setSchedulerFeatures.bind(this.syncDataModel),v),this.notifierObject=(0,g.makeNotifier)(this),this.eventEmitterObject=(0,H.makeEventEmitter)(this),this.alAnnotationNotifierObject=(0,q.makeALAnnotationNotifier)(this),this.requesterObject=(0,f.makeRequester)(this),this.syncRequesterObject=(0,f.makeSyncRequester)(this),this.batchRequesterObject=(0,E.makeBatchRequester)(this),this.notificationQueue=[],this.isEnabledProcessNotificationsAfterShouldRunPlugin=(0,M.isTypedChangeGateEnabled)("OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin"),this.x10GetNumOfComputationsFromFrameEnabled=(0,M.isTypedChangeGateEnabled)("OfficeVSO:8557722_x10GetNumOfComputationsFromFrame"),this.eventResultWindows=(0,c.mapFromArrayOfPairs)((0,c.strEnumArray)(W.ComputationKinds[W.ComputationType.Event]).map((function(e){return[e,{startDelta:0,stopDelta:1/0}]}))),this.computationResultWindows=((S={})[W.ComputationType.UIMessage]=this.pluginResultWindows,S[W.ComputationType.Event]=this.eventResultWindows,S),this.recalcServiceAttachedPromise=new R.ResolvablePromise,this.chatGPTProviderAttachedPromise=new R.ResolvablePromise,this.alManagerAttachedPromise=new R.ResolvablePromiseWithTimeout(3e5,this.timer),this.tableIntelligenceServiceAttachedPromise=new R.ResolvablePromiseWithSyncValue,this.eventCallbackManagerAttachedPromise=new R.ResolvablePromiseWithSyncValue,this.eventCallbackManagerCreated=(0,I.asyncLazy)(j.makeEventCallbacksManager),this.computationFinalizerHandlers=[ae],this.warmupParse=(0,I.asyncLazy)((function(){return a.__awaiter(F,void 0,void 0,(function(){var e,t,r;return a.__generator(this,(function(n){return(e=this.createPrefetchingCache(this.syncDataModel,-1))&&(t=(0,o.documentLoc)(void 0,""),r=(0,o.sheetGridCell)((0,o.sheetIndex)(t,0),(0,o.gridCell)(1,1)),e.parseEditSync(r,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})),[2]}))}))})),d.ulsLogger.ULS.traceTag(537796811,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("excelOnlineCalcPackages",{description:"".concat((0,D.getExcelOnlineCalcNewPackagesNames)())})),this.processor=e(this.consumeMessage.bind(this)),this.alManagerAttachedPromise.toPromise().catch((function(){}))}return e.prototype.setFunctionInfo=function(e){if((0,c.isNone)(e))d.ulsLogger.ULS.traceTag(512274762,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("setFunctionInfo",{description:"functionsInfo was none"}));else{for(var t={},r=0,n=e;r<n.length;r++){var i=n[r];(0,c.isDefined)(i)&&(t[i.NameDataStrings]=i)}this.state=a.__assign(a.__assign({},this.state),{functionsInfoMap:t}),d.ulsLogger.ULS.traceTag(512274761,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("setFunctionInfo",{description:"set functionsInfoMap"}))}},e.prototype.setDefinedNamesInfo=function(e){if((0,c.isNone)(e))d.ulsLogger.ULS.traceTag(512274760,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"definedNamesInfo was none"}));else{for(var t={},r=0,n=e;r<n.length;r++){var i=n[r];(0,c.isDefined)(i)&&(0,c.isDefined)(i.name)&&(t[i.name.toUpperCase()]=i)}this.state=a.__assign(a.__assign({},this.state),{definedNamesInfoMap:t}),d.ulsLogger.ULS.traceTag(512274759,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"set definedNamesInfoMap"}))}},e.prototype.onWorkbookClosing=function(){w.x10Logger.flush()},e.prototype.getPluginResponseWindows=function(){return this.pluginResultWindows},e.prototype.setPluginResponseWindow=function(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}},e.prototype.consumeMessage=function(e){var t=this;switch(e.kind){case f.SchedulerTimelineQueueMessageKind.StepComputation:this.stepComputation(e.computation,e.payload);break;case f.SchedulerTimelineQueueMessageKind.NoOpRequest:case f.SchedulerTimelineQueueMessageKind.SyncRequest:case f.SchedulerTimelineQueueMessageKind.AsyncRequest:var r=this.timer.now();this.processRequest(e.computation,e.request,{onFulfilled:function(r){return r.kind===S.ResultKind.Success?(t.enqueueMessage({kind:f.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:A.InternalSchedulerResponseKind.NormalResponse,response:r.value}}),r.value):(t.enqueueMessage({kind:f.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:A.InternalSchedulerResponseKind.RequestFailure}}),{kind:"RequestFailure"})},onRejected:function(r){return t.enqueueMessage({kind:f.SchedulerTimelineQueueMessageKind.StepComputation,computation:e.computation,payload:{kind:A.InternalSchedulerResponseKind.AsyncException,error:r}}),{kind:"RequestFailure"}}}),e.computation.info.schedulerTime+=this.timer.now()-r;break;case f.SchedulerTimelineQueueMessageKind.StopComputationFrame:this.stopComputationFrame(e.correlationId,e.computationGroup,e.type,e.computationKind,f.ExecutionStopReason.Frame.Timeout);break;case f.SchedulerTimelineQueueMessageKind.Timeout:e.callback();break;default:(0,d.assertNever)("unknown message: ".concat(e),e)}},e.prototype.enqueueMessage=function(t,r){var n=e.abstractStepCosts[t.kind];this.processor.enqueue(t,n,r)},e.prototype.stepComputation=function(e,t){var r=this.responseStates[e.info.type][e.info.computationKind].computationFrame(e.info.computationGroup);if(e.info.correlationId===(null==r?void 0:r.correlationId))try{var n=this.timer.now(),i=ne(e.generator,t);if(e.info.computationTime+=this.timer.now()-n,!0!==i.done){var a=i.value;this.enqueueMessage((0,A.wrapRequest)(a,e))}else this.addResultAndFinalizeComputationFrame(e,{kind:"Successful",message:i.value},f.ExecutionStopReason.Computation.Done)}catch(t){this.addResultAndFinalizeComputationFrame(e,{kind:"Exception"},f.ExecutionStopReason.Computation.Exception),d.ulsLogger.ULS.traceTag(553734791,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,w.x10Logger.formatLogMessage("stepPlugin",{description:"plugin threw exception: ".concat(t," during computation"),data:e.info})),w.x10Logger.log({kind:"issue",payload:{issueKind:w.X10IssueKind.PluginError,issueLevel:p.TraceLevel.Warning,path:"stepPlugin",description:"".concat(w.X10IssueKind.PluginError,": plugin threw exception: ").concat(t," during computation"),data:e.info}})}else e.finalizer.finalize(e,e.stopReasonRef.value)},e.prototype.addResultAndFinalizeComputationFrame=function(e,t,r){return e.finalizer.finalize(e,r),this.addResult(e.info,t)},e.prototype.addResult=function(e,t,r){var n=this.responseStates[e.type][e.computationKind].computationFrame(e.computationGroup);if(this.parent||null==r||r.forEach((function(e){return w.x10Logger.log.apply(w.x10Logger,e)})),!(void 0===n||n.correlationId>e.correlationId)){if(d.ulsLogger.ULS.assertTag(523360267,p.LogCategory.msoulscat_ES_EWAJS,n.correlationId===e.correlationId,w.x10Logger.formatLogMessage("addResult",{description:"main scheduler corelationID (".concat(n.correlationId,") is less than the child one (").concat(e.correlationId,")"),data:e.computationIdentifier})),this.parent){var i=a.__spreadArray(a.__spreadArray([],null!=r?r:[],!0),w.x10Logger.flushBufferedMessages(),!0);this.parent.addResult(e,t,i)}switch(t.kind){case"Successful":n.successfulResults.results.push([e.computationIdentifier,t.message]);break;case"Exception":n.numFailures+=1;break;case"Skipped":n.numSkippedComputations+=1;break;default:(0,d.assertNever)("unknown result",t)}var o=this.x10GetNumOfComputationsFromFrameEnabled?function(e){switch(!0){case e.numFailures+e.numSkippedComputations+e.successfulResults.results.length!==e.numOfComputations:return;case e.numFailures===e.numOfComputations:return f.ExecutionStopReason.Computation.Exception;case e.numSkippedComputations===e.numOfComputations:return f.ExecutionStopReason.Computation.Skipped;default:return f.ExecutionStopReason.Computation.Done}}(n):function(e){return e.numFailures+e.numSkippedComputations+e.successfulResults.results.length}(n)===this.responseStates[e.type][e.computationKind].numComputations?f.ExecutionStopReason.Computation.Done:void 0;void 0!==o&&this.stopComputationFrame(n.correlationId,e.computationGroup,e.type,e.computationKind,o)}},e.prototype.processRequest=function(e,t,r){var n,i,o=this,s=r.onFulfilled,u=r.onRejected,l=this.responseStates[e.info.type][e.info.computationKind],c=l.computationFrame(e.info.computationGroup);if(e.info.correlationId!==(null==c?void 0:c.correlationId))return e.finalizer.finalize(e,e.stopReasonRef.value),u({kind:"RequestFailure"});var m=this.timer.now(),f=(0,N.processRequest)(N.requestProcessorMap,t,e,null===(n=l.computationFrame(e.info.computationGroup))||void 0===n?void 0:n.cache,null===(i=l.computationFrame(e.info.computationGroup))||void 0===i?void 0:i.config);return(0,F.bindMaybeThenable)(f,(function(r){return o.addProcessingTime(e,t.kind,m),r.kind!==S.ResultKind.Success&&d.ulsLogger.ULS.traceTag(538788238,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,w.x10Logger.formatLogMessage("processRequest",{description:"request returned a scheduler-side failure",data:a.__assign(a.__assign({},e.info),{failedRequest:t.kind})})),s(r)}),(function(r){return o.addProcessingTime(e,t.kind,m),d.ulsLogger.ULS.traceTag(540611209,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,w.x10Logger.formatLogMessage("processRequest",{description:"request processor threw",data:a.__assign(a.__assign({},e.info),{failedRequest:t.kind,error:(0,T.messageFromError)(r)})})),w.x10Logger.log({kind:"issue",payload:{issueKind:w.X10IssueKind.RequestProcessorError,issueLevel:p.TraceLevel.Warning,path:"processRequest",description:"".concat(w.X10IssueKind.RequestProcessorError,": request processor threw"),data:a.__assign(a.__assign({},e.info),{failedRequest:t.kind,error:(0,T.messageFromError)(r)})}}),u(r)}))},e.prototype.addProcessingTime=function(e,t,r){var n=this.timer.now(),i=e.info.requestTimes[t];return i?(i.requestDuration=i.requestDuration+n-r,i.numberOfRequests+=1,i.timeSinceLastRequest=n-e.lastTimestamp):e.info.requestTimes[t]={requestDuration:n-r,numberOfRequests:1,timeSinceLastRequest:n-e.lastTimestamp},e.lastTimestamp=n,n},e.prototype.stopComputationFrame=function(e,t,r,n,i){var a,o=this.responseStates[r][n];e===(null===(a=o.computationFrame(t))||void 0===a?void 0:a.correlationId)&&o.stop(t,i,this.timer.now())},e.prototype.recalcServiceAttached=function(){return this.recalcServiceAttachedPromise.toPromise()},e.prototype.chatGPTProviderAttached=function(){return this.chatGPTProviderAttachedPromise.toPromise()},e.prototype.tableIntelligenceServiceAttached=function(){return this.tableIntelligenceServiceAttachedPromise.toPromise()},e.prototype.getFunctionsShortDescriptions=function(){return k.functionShortDescriptions.getValue()},e.prototype.getSchedulerFeatures=function(){return(0,U.asReadonly)(this.syncDataModel.schedulerFeatures)},e.prototype.isSchedulerFeatureEnabled=function(e){return-1!==this.getSchedulerFeatures().indexOf(e)},e.prototype.doNotify=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];d.ulsLogger.ULS.traceTag(512274758,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("FormulaBarScheduler.doNotify",{description:"received notification of kind:\n       ".concat(e[0],"\n      ")})),this.enqueueNotification(e),e[0]!==h.NotificationKind.setSchedulerFeatures&&e[0]!==h.NotificationKind.notifyWorkbookClosing||this.processNotifications()},e.prototype.enqueueNotification=function(e){var t=this.notificationQueue.length-1,r=this.notificationQueue[t];if(void 0===r)this.notificationQueue.push(e),d.ulsLogger.ULS.traceTag(512274757,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"queue empty, notification of kind:\n         ".concat(e[0]," pushed to queue\n        ")}));else{var n=r[0];n===e[0]&&!0===Z[n]?(this.notificationQueue[t]=e,d.ulsLogger.ULS.traceTag(512274756,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"notification of kind:\n           ".concat(e[0]," overrode previous notification\n          ")}))):(this.notificationQueue.push(e),d.ulsLogger.ULS.traceTag(512274755,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"couldn't coalesce, notification of kind:\n           ".concat(e[0]," pushed to queue\n          ")})))}},e.prototype.processNotifications=function(){for(var e=0,t=this.notificationQueue;e<t.length;e++){var r=t[e];d.ulsLogger.ULS.traceTag(512274754,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("FormulaBarScheduler.processNotifications",{description:"processing notification of kind:\n         ".concat(r[0],"\n        ")})),this.processNotification(r)}this.notificationQueue.length=0},e.prototype.processNotification=function(e){var t,r=e[0],n=e[1];switch((t=this.notificationProcessorMap)[r].apply(t,n),r){case h.NotificationKind.setA1ReferenceStyle:case h.NotificationKind.setLocale:case h.NotificationKind.setWorkbookProps:case h.NotificationKind.updateSheetNames:case h.NotificationKind.updateNamedObjects:case h.NotificationKind.setSchedulerFeatures:this.doNotifyStatefulSubject.next(e);break;default:this.doNotifyStatelessSubject.next(e)}},e.prototype.requestWithCorrelationId=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=this.timer.now(),c=this.responseStates[r][n];c.closeFrame(u,f.ExecutionStopReason.Frame.Superseded,l);var p=this.createPrefetchingCache(this.syncDataModel,o),m=this.computationResultWindows[r][n],g=c.createFrame(o,u,B.ExecutionType.Async,a,p,this.syncDataModel.config,l,m);0===this.responseStates[r][n].numComputations?(w.x10Logger.log({kind:"requestSkipped",payload:{computationKind:n,computationGroup:u}}),g.resolve({kind:"Done",payload:{kind:n,results:[]}})):w.x10Logger.log({kind:"beginRequest",payload:{correlationId:o,computationKind:n,computationGroup:u}});var h=c.computationFrame(u);return(0,d.assertTrue)("`frame` should be always defined at this point",void 0!==h),this.computationSubjects[r][i][n].next([h,s]),m.stopDelta<1/0&&this.enqueueMessage({kind:f.SchedulerTimelineQueueMessageKind.StopComputationFrame,correlationId:o,computationGroup:u,type:r,computationKind:n},l+m.stopDelta+ee),this.requestWithCorrelationIdSubject.next([r,n,i,a,o,s,u]),g},e.prototype.syncRequestWithCorrelationId=function(e,t,r,n,i,a,o){var s=this.timer.now(),u=this.responseStates[e][t];u.closeFrame(o,f.ExecutionStopReason.Frame.Superseded,s);var l=this.createPrefetchingCache(this.syncDataModel,i),c=this.computationResultWindows[e][t],p=u.createFrame(i,o,B.ExecutionType.Sync,n,l,this.syncDataModel.config,s,c);w.x10Logger.log({kind:"beginRequest",payload:{correlationId:i,computationKind:t,computationGroup:o}});var m=u.computationFrame(o);(0,d.assertTrue)("`frame` should be always defined at this point",void 0!==m),this.computationSubjects[e][r][t].next([m,a]);var g=s+c.stopDelta+ee,h=this.runToCompletion(l,this.syncDataModel.config,g),v=h[0],S=h[1];return u.closeFrame(o,v,this.timer.now()),p.resolve({kind:"Done",payload:{kind:t,results:[]}}),{kind:t,results:S}},e.prototype.runToCompletion=function(e,t,r){for(var n=[],i=this.timer.now(),o=this.syncMessageQueue.pop();void 0!==o;o=this.syncMessageQueue.pop(),i=this.timer.now()){if(i>=r){o.computation.finalizer.finalize(o.computation,f.ExecutionStopReason.Frame.Timeout);break}var s=void 0;switch(o.kind){case f.SchedulerTimelineQueueMessageKind.StepComputation:var u=o.computation,l=o.payload;try{var m=ne(u.generator,l);if(u.info.computationTime+=this.timer.now()-i,!0!==m.done){var g=m.value;this.syncMessageQueue.enqueue((0,A.wrapSyncRequest)(g,u))}else this.addResult(u.info,{kind:"Successful",message:m.value}),u.finalizer.finalize(u,f.ExecutionStopReason.Computation.Done),n.push([u.info.computationIdentifier,m.value])}catch(e){d.ulsLogger.ULS.traceTag(538581056,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,w.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"plugin threw exception during computation",data:u.info})),u.finalizer.finalize(u,f.ExecutionStopReason.Computation.Exception)}break;case f.SchedulerTimelineQueueMessageKind.NoOpRequest:case f.SchedulerTimelineQueueMessageKind.SyncRequest:var h=(0,N.processSyncRequest)(N.requestProcessorMap,o.request,o.computation,e,t);s=this.addProcessingTime(o.computation,o.request.kind,i),o.computation.info.schedulerTime+=s-i,h.kind===S.ResultKind.Success?this.syncMessageQueue.enqueue({kind:f.SchedulerTimelineQueueMessageKind.StepComputation,computation:o.computation,payload:{kind:A.InternalSchedulerResponseKind.NormalResponse,response:h.value}}):(d.ulsLogger.ULS.traceTag(538469328,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,w.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"request returned a scheduler-side failure",data:a.__assign(a.__assign({},o.computation.info),{failedRequest:o.request.kind})})),this.syncMessageQueue.enqueue({kind:f.SchedulerTimelineQueueMessageKind.StepComputation,computation:o.computation,payload:{kind:A.InternalSchedulerResponseKind.RequestFailure}}));break;default:(0,d.assertNever)("unknown message: ".concat(o),o)}}return this.syncMessageQueue.clear(),[!(0,c.isDefined)(r)||i<r?f.ExecutionStopReason.Computation.Done:f.ExecutionStopReason.Frame.Timeout,n]},e.prototype.triggerEventImmediate=function(e,t){if(this.parent)return this.parent.triggerEventImmediate(e,t);this.triggerEvent(e,t)},e.prototype.triggerEvent=function(e,t){return this.processNotifications(),this.doRequestUntyped(W.ComputationType.Event,e,t,void 0,this.eventComputationGroupFactory.create().toString())},e.prototype.doRequest=function(e,t,r,n){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(W.ComputationType.UIMessage,e,t,r,B.ExecutionType.Async)?this.wrapResults(W.ComputationType.UIMessage,this.skippedRequest(e,n)):(this.processNotifications(),this.doRequestUntyped(W.ComputationType.UIMessage,e,t,r,n))},e.prototype.skippedRequest=function(e,t){w.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}});var r=new R.ResolvablePromise;return r.resolve({kind:"Done",payload:{kind:e,results:[]}}),r},e.prototype.wrapResults=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var r;return a.__generator(this,(function(n){switch(n.label){case 0:return[4,this.resolveConflicts(e,t)];case 1:return"Superseded"===(r=n.sent()).kind?[2,r]:[2,a.__assign(a.__assign({},r),{payload:r.payload.result})]}}))}))},e.prototype.doRequestUntyped=function(e,t,r,n,i){return a.__awaiter(this,void 0,void 0,(function(){var o;return a.__generator(this,(function(a){return o=this.requestWithCorrelationId(e,t,B.ExecutionType.Async,r,this.idFactory.create(),n,i),[2,this.wrapResults(e,o)]}))}))},e.prototype.doSyncRequest=function(e,t,r,n){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(W.ComputationType.UIMessage,e,t,r,B.ExecutionType.Sync)?this.wrapSyncResponse(W.ComputationType.UIMessage,this.skippedSyncRequest(e,n)):(this.processNotifications(),this.doSyncRequestUntyped(W.ComputationType.UIMessage,e,t,r,n))},e.prototype.skippedSyncRequest=function(e,t){return w.x10Logger.log({kind:"requestSkipped",payload:{computationKind:e,computationGroup:t}}),{kind:e,results:[]}},e.prototype.wrapSyncResponse=function(e,t){return this.syncResolveConflicts(e,t).result},e.prototype.doSyncRequestUntyped=function(e,t,r,n,i){var a;if(0===this.responseStates[e][t].numSyncComputations)a=this.skippedSyncRequest(t,i);else{var o=this.idFactory.create();a=this.syncRequestWithCorrelationId(e,t,B.ExecutionType.Sync,r,o,n,i)}return this.wrapSyncResponse(e,a)},e.prototype.resolveConflicts=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var r;return a.__generator(this,(function(n){switch(n.label){case 0:return[4,t];case 1:return"Superseded"===(r=n.sent()).kind?[2,r]:[2,{kind:"Done",payload:this.syncResolveConflicts(e,r.payload)}]}}))}))},e.prototype.syncResolveConflicts=function(e,t){var r=t.results.filter((function(e){var t=e[1];return(0,c.isDefined)(t)}));return{kind:t.kind,result:this.conflictResolvers[e][t.kind](r)}},e.prototype.doBatchRequest=function(e,t,r){return a.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,l,c,f,g,v,S;return a.__generator(this,(function(a){switch(a.label){case 0:for(this.isEnabledProcessNotificationsAfterShouldRunPlugin||this.processNotifications(),n=this.idFactory.create(),i=E.customConflictResolverPluginKinds[e.strategy],o=b.customConflictResolverFactories[e.strategy].create(),s=i.map((function(){return!0})),u=new R.ResolvablePromise,l=function(a){var l=i[a],f=e[l],g=void 0;c.isEnabledProcessNotificationsAfterShouldRunPlugin&&!c.shouldRunRequest(W.ComputationType.UIMessage,l,f,t,B.ExecutionType.Async)?g=c.skippedRequest(l,null!=r?r:m.DefaultComputationGroup):(c.processNotifications(),g=c.requestWithCorrelationId(W.ComputationType.UIMessage,l,B.ExecutionType.Async,f,n,t,null!=r?r:m.DefaultComputationGroup)),c.resolveConflicts(W.ComputationType.UIMessage,g).then((function(e){if(s[a]=!1,"Superseded"===e.kind)u.resolve({kind:"Superseded"});else{var t=e.payload;o.consumeResult(t)}}),(function(){d.ulsLogger.ULS.traceTag(553734794,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Error,w.x10Logger.formatLogMessage("doBatchRequest",{description:'Custom conflict resolver "'.concat(e.strategy,'" got an exception for plugin kind "').concat(l,'". Skipping kind')})),w.x10Logger.log({kind:"issue",payload:{issueKind:w.X10IssueKind.CustomConflictResolverError,issueLevel:p.TraceLevel.Error,path:"doBatchRequest",description:"".concat(w.X10IssueKind.CustomConflictResolverError,': Custom conflict resolver "').concat(e.strategy,'" got an exception for plugin kind "').concat(l,'". Skipping kind')}}),s[a]=!1,o.consumeResult({kind:l,result:null})}))},c=this,v=0;v<i.length;v+=1)l(v);return f=(0,F.bindMaybeThenable)(o.promise,(function(e){return{kind:"Done",payload:e}})),[4,Promise.race([u,f])];case 1:for(g=a.sent(),v=0;v<i.length;v+=1)S=i[v],s[v]&&(this.doNotify(h.NotificationKind.conflictResolverEarlyTermination,[n,null!=r?r:m.DefaultComputationGroup,S]),this.processNotifications());return[2,g]}}))}))},e.prototype.updatePrefetchingCache=function(e){var t;return a.__awaiter(this,void 0,void 0,(function(){var r,n,i;return a.__generator(this,(function(a){switch(a.label){case 0:return r=this.createPrefetchingCache(this.syncDataModel,this.idFactory.create()),[4,null===(t=e.cache)||void 0===t?void 0:t.getCorrespondingSnapshotID()];case 1:return n=a.sent(),[4,null==r?void 0:r.getCorrespondingSnapshotID()];case 2:return(i=a.sent())!==n?(e.cache=r,[2,i]):[2,n]}}))}))},e.prototype.notifier=function(){return this.notifierObject},e.prototype.eventEmitter=function(){return this.eventEmitterObject},e.prototype.alAnnotationNotifier=function(){return this.alAnnotationNotifierObject},e.prototype.requester=function(){return this.requesterObject},e.prototype.syncRequester=function(){return this.syncRequesterObject},e.prototype.batchRequester=function(){return this.batchRequesterObject},e.prototype.setServerDataProvider=function(e){(0,c.isNone)(e)||(this.state=a.__assign(a.__assign({},this.state),{serverDataProvider:e}))},e.prototype.setActiveCellImpl=function(e){if((0,c.isNone)(e.docName)||(0,c.isNone)(e.sheetIndex))return d.ulsLogger.ULS.traceTag(553734796,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,w.x10Logger.formatLogMessage("setActiveCellImpl",{description:"early exit, some of the arguments is None"})),void w.x10Logger.log({kind:"issue",payload:{issueKind:w.X10IssueKind.SchedulerEarlyExitError,issueLevel:p.TraceLevel.Warning,path:"setActiveCellImpl",description:"".concat(w.X10IssueKind.SchedulerEarlyExitError,": early exit, some of the arguments is None")}});var t=(0,o.documentLoc)(void 0,""),r=(0,o.unsafeGridRange)(e.rowIndex,e.colIndex,1,1),n=(0,o.sheetGridCell)((0,o.sheetIndex)(t,e.sheetIndex),r),i=oe(e);this.state=a.__assign(a.__assign({},this.state),{activeCell:n,activeCellFormat:i}),d.ulsLogger.ULS.traceTag(512274752,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,w.x10Logger.formatLogMessage("setActiveCellImpl",{description:"updated activeCell to col: ".concat(n.range.col,", row: ").concat(n.range.row)}))},e.prototype.setActiveCellFormatImpl=function(e){var t=oe(e);this.state=a.__assign(a.__assign({},this.state),{activeCellFormat:t})},e.prototype.getConfig=function(){return this.syncDataModel.config},e.prototype.startComputation=function(e,t,r,n,i,o){switch(r){case B.ExecutionType.Async:this.enqueueMessage({kind:f.SchedulerTimelineQueueMessageKind.StepComputation,computation:a.__assign(a.__assign({},this.generateNewComputationInfo(e,t,n,o)),{generator:i}),payload:X},o.startTime+o.timeWindow.startDelta);break;case B.ExecutionType.Sync:this.syncMessageQueue.enqueue({kind:f.SchedulerTimelineQueueMessageKind.StepComputation,computation:a.__assign(a.__assign({},this.generateNewComputationInfo(e,t,n,o)),{generator:i}),payload:X});break;default:(0,d.assertNever)("".concat(r),r)}},e.prototype.generateNewComputationInfo=function(e,t,r,n){return{info:{correlationId:n.correlationId,computationGroup:n.computationGroup,type:e,computationKind:t,computationIdentifier:r,pluginFactoryNameString:J[r.factoryName],computationTime:0,schedulerTime:0,requestTimes:{}},cache:n.cache,finalizer:new(K.ComputationFinalizer.bind.apply(K.ComputationFinalizer,a.__spreadArray([void 0],this.computationFinalizerHandlers,!1))),stopReasonRef:n.stopReasonRef,schedulerState:this.state,lastTimestamp:this.timer.now()}},e.prototype.getPluginComputations=function(e,t,r){var n,i,o,u=v.pluginFactoryKindMap[t.factoryName],l={factoryName:t.factoryName,pluginName:null!==(n=t.pluginName)&&void 0!==n?n:s.PluginFactoryName[t.factoryName]},c=a.__assign(a.__assign({},l),{computationName:"run"}),d=v.pluginGroupMap[s.PluginGroup.Python][t.factoryName]?s.PluginGroup.Python:s.PluginGroup.Excel,p=!0!==(null===(i=t.registryInitialized)||void 0===i?void 0:i.call(t))?[(0,V.wrapRegistration)(W.ComputationType.UIMessage,u,r,d,c,{},e.run.bind(e),(function(e,t){return ie(W.ComputationType.UIMessage,u,c,t,e)}))]:[],m=!0===(null===(o=t.registryInitialized)||void 0===o?void 0:o.call(t))?G.computationRegistry.UIMessage.getRegistrationsByPluginIdentifier(l):[],f=G.computationRegistry.Event.getRegistrationsByPluginIdentifier(l);return a.__spreadArray(a.__spreadArray(a.__spreadArray([],p,!0),m,!0),f,!0)},e.prototype.createAndAttachPlugin=function(e,t){this.parent&&this.warmupParse.force();for(var r=e.create(t),n=function(e){switch(e.type){case W.ComputationType.UIMessage:i.computationSubjects[e.type][e.execution][e.kind].subscribe(e.registrationMethod(i,r)),i.addToComputationCount(e);break;case W.ComputationType.Event:(0,j.isALAnnotationEventKind)(e.kind)&&i.registerALAnnotation(e.kind).catch((function(t){d.ulsLogger.ULS.traceTag(507802141,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Error,"x10arch.FormulaBarScheduler.createAndAttachPlugin: Failed to register on ".concat(e.kind," AL annotation: ").concat(t))})),i.computationSubjects[e.type][e.execution][e.kind].subscribe(e.registrationMethod(i,r)),i.addToComputationCount(e);break;default:(0,d.assertNever)("".concat(e),e)}},i=this,a=0,o=this.getPluginComputations(r,e,B.ExecutionType.Async);a<o.length;a++){n(o[a])}d.ulsLogger.ULS.traceTag(545378970,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,"x10arch.FormulaBarScheduler.createAndAttachPlugin: ".concat(s.PluginFactoryName[e.factoryName]," was attached."))},e.prototype.createAndAttachSyncPlugin=function(e,t){for(var r=e.create(t),n=function(e){switch(e.type){case W.ComputationType.UIMessage:i.computationSubjects[e.type][e.execution][e.kind].subscribe(e.registrationMethod(i,r)),i.responseStates[e.type][e.kind].attachSyncComputation(e.computationIdentifier);break;case W.ComputationType.Event:(0,j.isALAnnotationEventKind)(e.kind)&&i.registerALAnnotation(e.kind).catch((function(t){d.ulsLogger.ULS.traceTag(507802140,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Error,"x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: Failed to register on ".concat(e.kind," AL annotation: ").concat(t))})),i.computationSubjects[e.type][e.execution][e.kind].subscribe(e.registrationMethod(i,r)),i.responseStates[e.type][e.kind].attachSyncComputation(e.computationIdentifier);break;default:(0,d.assertNever)("".concat(e),e)}},i=this,a=0,o=this.getPluginComputations(r,e,B.ExecutionType.Sync);a<o.length;a++){n(o[a])}d.ulsLogger.ULS.traceTag(538581058,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,"x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: ".concat(s.PluginFactoryName[e.factoryName]," was attached."))},e.prototype.addToComputationCount=function(e){switch(this.parent&&this.parent.addToComputationCount({type:e.type,kind:e.kind,execution:e.execution,computationIdentifier:e.computationIdentifier}),e.execution){case B.ExecutionType.Async:this.responseStates[e.type][e.kind].attachComputation(e.computationIdentifier);break;case B.ExecutionType.Sync:this.responseStates[e.type][e.kind].attachSyncComputation(e.computationIdentifier)}},e.prototype.attachEventCallbacksManager=function(e){for(var t=function(t){(0,c.isDefined)(e[t])&&r.computationSubjects[W.ComputationType.Event][B.ExecutionType.Async][t].subscribe((function(r){var n=r[0];r[1];try{e[t](n.computationInput)}catch(e){d.ulsLogger.ULS.traceTag(507777378,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Error,"x10arch.FormulaBarScheduler: Failed to call eventCallbacksManager.".concat(t,": ").concat(e))}}))},r=this,n=0,i=j.ExternallyHandledEventKinds;n<i.length;n++){t(i[n])}},e.prototype.registerEventCallback=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var r;return a.__generator(this,(function(n){switch(n.label){case 0:return[4,this.eventCallbackManagerCreated.getValue()];case 1:return r=n.sent(),(0,c.isDefined)(this.eventCallbackManagerAttachedPromise.getCurrentValue())||(this.eventCallbackManagerAttachedPromise.resolve(r),this.attachEventCallbacksManager(r)),r.registerEventCallback(e,t),[2]}}))}))},e.prototype.catchEvent=function(e){var t=this;return new Promise((function(r,n){var i=t.computationSubjects[W.ComputationType.Event][B.ExecutionType.Async][e.eventKind].subscribe((function(n){var a=n[0];n[1];(0,c.isDefined)(e.predicate)&&!e.predicate(a.computationInput)||(t.computationSubjects[W.ComputationType.Event][B.ExecutionType.Async][e.eventKind].unsubscribe(i),r((0,S.success)(a.computationInput)))}));t.enqueueMessage({kind:f.SchedulerTimelineQueueMessageKind.Timeout,type:W.ComputationType.Event,callback:function(){t.computationSubjects[W.ComputationType.Event][B.ExecutionType.Async][e.eventKind].unsubscribe(i),r((0,S.failure)("Timeout"))}},t.timer.now()+e.timeout)}))},e.prototype.registerAsyncGrid=function(){this.recalcServiceAttachedPromise.resolve(void 0)},e.prototype.registerChatGPTProvider=function(e){var t=new L.ChatGPTService(e);return this.chatGPTProviderAttachedPromise.resolve(t)},e.prototype.registerALProvider=function(e){var t=new z.AugLoopService(e);return this.alManagerAttachedPromise.resolve(t)},e.prototype.registerALAnnotation=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,r;return a.__generator(this,(function(n){switch(n.label){case 0:if(void 0!==this.parent)return[2,this.parent.registerALAnnotation(e)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.alManagerAttachedPromise];case 2:return t=n.sent(),[3,4];case 3:return r=n.sent(),d.ulsLogger.ULS.traceTag(508630016,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,"x10arch.FormulaBarScheduler.registerALAnnotation: Error getting AugLoopService: ".concat(r)),[2,(0,S.failure)(r)];case 4:return[2,t.registerALAnnotation(e)]}}))}))},e.prototype.registerTableIntelligenceProvider=function(e){this.tableIntelligenceServiceAttachedPromise.resolve(new Q.X10TableIntelligenceService(e))},e.prototype.getRecognizedTablesInfo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.__awaiter(this,void 0,void 0,(function(){var t,r;return a.__generator(this,(function(n){return(0,c.isDefined)(this.parent)?[2,(r=this.parent).getRecognizedTablesInfo.apply(r,e)]:(t=this.tableIntelligenceServiceAttachedPromise.getCurrentValue(),(0,c.isDefined)(t)?[2,t.getRecognizedRangeTablesInfo.apply(t,e)]:(d.ulsLogger.ULS.traceTag(508045019,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,"x10arch.FormulaBarScheduler.getRecognizedTablesInfo: tableIntelligenceService is not attached yet."),[2,(0,S.failure)(void 0)]))}))}))},e.prototype.sendAugLoopSignal=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var r,n;return a.__generator(this,(function(i){switch(i.label){case 0:if(void 0!==this.parent)return[3,5];r=void 0,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.alManagerAttachedPromise.toPromise()];case 2:return r=i.sent(),[3,4];case 3:return n=i.sent(),d.ulsLogger.ULS.traceTag(507802139,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,"x10arch.FormulaBarScheduler.sendAugLoopSignal: Error getting AugLoopService: ".concat(n)),[2,(0,S.failure)(n)];case 4:return[2,r.sendSignal(e,t)];case 5:return[2,this.parent.sendAugLoopSignal(e,t)]}}))}))},e.prototype.augloopCloseCallback=function(){d.ulsLogger.ULS.traceTag(508629987,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,"x10arch.FormulaBarScheduler.augloopCloseCallback: Got close callback from AugLoop Manager")},e.prototype.createChatGPTSession=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return void 0!==this.parent?[3,2]:[4,this.chatGPTProviderAttached()];case 1:return[2,t.sent().createSession(e)];case 2:return[2,this.parent.createChatGPTSession(e)]}}))}))},e.prototype.closeChatGPTSession=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return void 0!==this.parent?[3,2]:[4,this.chatGPTProviderAttached()];case 1:return[2,t.sent().closeSession(e)];case 2:return[2,this.parent.closeChatGPTSession(e)]}}))}))},e.prototype.sendChatGPTQuery=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var r;return a.__generator(this,(function(n){switch(n.label){case 0:return void 0!==this.parent?[3,3]:[4,this.chatGPTProviderAttached()];case 1:return[4,n.sent().request(e,t)];case 2:return(r=n.sent()).kind!==S.ResultKind.Success||(0,c.isDefined)(r.value)?((0,U.staticTypeHint)(r),[2,r]):[2,(0,S.failure)(void 0)];case 3:return[2,this.parent.sendChatGPTQuery(e,t)]}}))}))},e.prototype.shouldRunRequest=function(e,t,r,n,i){for(var a=this.responseStates[e][t],o=0,s=i===B.ExecutionType.Async?a.attachedComputations:a.attachedSyncComputations;o<s.length;o++){var u=s[o];if(e!==W.ComputationType.UIMessage||ie(e,t,u,n,r))return!0}return!1},e.abstractStepCosts=((i={})[f.SchedulerTimelineQueueMessageKind.NoOpRequest]=.01,i[f.SchedulerTimelineQueueMessageKind.AsyncRequest]=.1,i[f.SchedulerTimelineQueueMessageKind.SyncRequest]=.5,i[f.SchedulerTimelineQueueMessageKind.StepComputation]=1,i[f.SchedulerTimelineQueueMessageKind.StopComputationFrame]=.01,i[f.SchedulerTimelineQueueMessageKind.Timeout]=.01,i),e}();function ne(e,t){switch(t.kind){case A.InternalSchedulerResponseKind.FirstStep:return e.next();case A.InternalSchedulerResponseKind.NormalResponse:return e.next(t.response);case A.InternalSchedulerResponseKind.AsyncException:case A.InternalSchedulerResponseKind.RequestFailure:return te?e.throw($):e.next($);default:(0,d.assertNever)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",t)}}function ie(e,t,r,n,i){var a;if(!(0,M.isTypedChangeGateEnabled)("OfficeVSO:8762152_x10PluginRegistryEnabled")&&e===W.ComputationType.UIMessage)return(0,U.staticTypeHint)(t),function(e,t,r,n){var i,a=(0,M.isTypedChangeGateEnabled)("OfficeVSO:8564688_SkipFormulaPluginsForNonFormulaCells"),o=void 0===t||(null!==(i=v.pluginGroupMap[t][e])&&void 0!==i?i:v.pluginGroupOptInDefault[t]),s=e in v.ProcessNonFormulaCells;if(!o)return!1;if(!a)return o;if(s)return!0;var u=[n,r];if((0,U.staticTypeHint)(u[0]),(0,v.isFormulaRequest)(u[0])){(0,U.staticTypeHint)(u);var l=(0,v.getFormulaContent)(u);return(0,U.staticTypeHint)(l),!(0,c.isDefined)(l)||-1!==["=","+","-"].indexOf(l[0])}return!0}(r.factoryName,n,i,t);var o=null!==(a=G.computationRegistry[e].getRegistrationsByComputationIdentifier(r))&&void 0!==a?a:{type:e,kind:t,modifiers:{},pluginGroup:n&&!0===v.pluginGroupMap[n][r.factoryName]?n:s.PluginGroup.Excel};return(0,G.getShouldRunComputationPredicate)(o)(i,n)}function ae(e){w.x10Logger.log({kind:"computationStoppedExecution",payload:{computationName:"".concat(e.computationInfo.pluginFactoryNameString,".").concat(e.computationInfo.computationIdentifier.computationName),stopReason:e.stopReason,logInfo:e.computationInfo}}),e.stopReason===f.ExecutionStopReason.Computation.Done&&w.x10Logger.log({kind:"pluginCompletedInTime",payload:{pluginName:e.computationInfo.pluginFactoryNameString,logInfo:e.computationInfo}})}function oe(e){var t=null;return(0,c.isNone)(e.formatString)||(0,c.isNone)(e.builtIn)||(t={formatString:e.formatString,builtIn:e.builtIn}),t}t.FormulaBarScheduler=re,t.shouldRunComputation=ie},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShouldRunComputationPredicate=t.computationRegistry=t.registerComputation=t.wrapRegistration=void 0;var n=r(2),i=r(144),a=r(48),o=r(29),s=r(127),u=r(22),l=function(){function e(){this.registeredComputations=new a.DefaultMap({getKey:function(e){return"".concat(e.computationIdentifier.factoryName,".").concat(e.computationIdentifier.pluginName,".").concat(e.computationIdentifier.computationName)},getDefault:function(){return!1}}),this.byFactoryName=new a.DefaultMap({getKey:function(e){return"".concat(e.factoryName,".").concat(e.pluginName)},getDefault:function(){return[]}})}return e.prototype.push=function(e,t){this.registeredComputations.get(t)?s.ulsLogger.ULS.traceTag(507330770,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,"Computation '".concat(t.computationIdentifier,"' already registered")):(this.byFactoryName.get(e).push(t),this.registeredComputations.set(t,!0))},e.prototype.getRegistrationsByPluginIdentifier=function(e){return this.byFactoryName.get(e)},e.prototype.getRegistrationsByComputationIdentifier=function(e){return this.getRegistrationsByPluginIdentifier(e).find((function(t){return t.computationIdentifier.computationName===e.computationName}))},e}(),c=(0,a.mapFromArrayOfDependantPairs)((0,n.strEnumArray)(i.ComputationType).map((function(e){return[e,new l]})));t.wrapRegistration=function(e,t,r,n,i,a,o,s){var u=d({type:e,kind:t,pluginGroup:n,modifiers:a},s);return{type:e,kind:t,execution:r,pluginGroup:n,computationIdentifier:i,modifiers:a,registrationMethod:function(n,a){return function(s){var l=s[0],c=s[1];if(u(l.computationInput,c)){var d=o.bind(a);n.startComputation(e,t,r,i,d(l.computationInput),l)}else n.addResult({type:e,computationKind:t,computationIdentifier:i,computationGroup:l.computationGroup,correlationId:l.correlationId},{kind:"Skipped"})}}}};function d(e,t){return function(r,n){for(var i=0,a=(0,u.isTypedChangeGateEnabled)("OfficeVSO:8762152_x10PluginRegistryEnabled")?p:[];i<a.length;i++){if(!(0,a[i])({registration:e,input:r,pluginGroup:n}))return!1}return void 0===t||t(r,n)}}t.registerComputation=function(e,r,n,i,a,o,s,u){var l=(0,t.wrapRegistration)(e,r,n,i,a,o,s,u);c[e].push(a,l)},t.computationRegistry=c,t.getShouldRunComputationPredicate=d;var p=[function(e){var t=e.registration,r=e.pluginGroup;return void 0===r||r===t.pluginGroup},function(e){var t=e.registration,r=e.input;if(t.type!==i.ComputationType.UIMessage||t.modifiers.runOnNonFormula)return!0;if((0,a.staticTypeHint)(t.kind),!(0,o.isFormulaRequest)(t.kind))return!0;var n=[t.kind,r];(0,a.staticTypeHint)(n);var s=(0,o.getFormulaContent)(n);return-1!==["=","+","-"].indexOf(s[0])}]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ALAnnotationKind=t.EventKind=void 0;var n=r(98);Object.defineProperty(t,"EventKind",{enumerable:!0,get:function(){return n.EventKind}}),Object.defineProperty(t,"ALAnnotationKind",{enumerable:!0,get:function(){return n.ALAnnotationKind}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMockGridSheetAndNotify=t.createMockGridExporter=t.createMockGridProvider=t.createConstGridProvider=t.createMockAsyncGrid=t.MockAsyncGrid=void 0;var n=r(0),i=r(524),a=n.__importStar(r(15)),o=r(316),s=r(77),u=r(96),l=r(12),c=n.__importStar(r(80)),d=r(4),p=r(60),m=r(202),f=r(317),g=r(169);function h(e){if("object"==typeof e)switch(e.kind){case"Blank":return"";case"Error":return(0,l.getEnglishLocaleInfo)().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}var v=function(e){function t(){var t=this,r=(0,i.makeCalcGrid)();r.dataModel.setNumberFormats(r.document,f.knownFormatData,!1,-1/0);var n=new m.RecalcSideGrid(r);return(t=e.call(this,n)||this).sheetNames=[],t.calcGrid=r,t.document=r.document,t}return n.__extends(t,e),Object.defineProperty(t.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),t.prototype.reconfigure=function(e){return this.calcGrid.reconfigure(e)},t.prototype.setRange=function(e,t,r,i,o){for(var u,l,c,d,p=a.documentLoc(void 0,""),m=a.sheetIndex(p,e),f=[],v=0;v<r.length;v+=1){var S=r[v];if(void 0!==S)for(var y=0;y<S.length;y+=1){var F=S[y];if(void 0!==F){var C=(0,s.sheetRangeLocation)(m.index,t.firstRow+v,t.firstColumn+y),R=null!==(l=null===(u=null==o?void 0:o[v])||void 0===u?void 0:u[y])&&void 0!==l?l:h(F),b=null!==(d=null===(c=null==i?void 0:i[v])||void 0===c?void 0:c[y])&&void 0!==d?d:g.KnownFormat.General;R.startsWith("=")?f.push((0,s.rangeWrite)(C,(0,s.cellFormulaCellData)(R,F,b))):f.push((0,s.rangeWrite)(C,(0,s.valueCellData)(R,F,b)))}}}this.calcGrid.updateRanges(0,n.__spreadArray([(0,s.rangeWrite)((0,s.sheetRangeLocation)(m.index,t.firstRow,t.firstColumn,t.lastRow,t.lastColumn))],f,!0)),this.runTasks()},t.prototype.setSheet=function(e,t,r,n){var i=a.documentLoc(void 0,""),o=a.sheetIndex(i,e);(0,d.assertTrue)("Sheet having sheetId ".concat(e," is already in the mock workbook"),!this.sheetNames.some((function(t){return t.sheetId===e}))),this.sheetNames.push((0,s.sheetName)(o.index,t)),this.calcGrid.updateSheetNames(0,this.sheetNames),this.setRange(e,{firstRow:0,firstColumn:0,lastRow:0,lastColumn:0},r,n)},t.prototype.setNamedObjects=function(e){this.calcGrid.updateNamedObjects(0,e),this.runTasks()},t.prototype.runTasks=function(){for(;;){if(this.calcGrid.dataModel.step().queueEmpty)break}},t}((0,o.wrapIntoAsyncClass)()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIntersectingTables","getIformats","discardSnapshot","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot","getCorrespondingSnapshotID"]));function S(e){return{getGrid:function(){return e}}}t.MockAsyncGrid=v,t.createMockAsyncGrid=function(){var e=new v;return n.__assign(n.__assign({},(0,u.wrapIntoResumeRecalc)(e,(function(){return e.calcGrid.resumeRecalc()}))),{setSheet:e.setSheet.bind(e),setRange:e.setRange.bind(e),setNamedObjects:e.setNamedObjects.bind(e),document:e.document,reconfigure:e.reconfigure.bind(e),calcConfig:e.calcConfig})},t.createConstGridProvider=S,t.createMockGridProvider=S,t.createMockGridExporter=function(e){return{createIGridExportEndpoint:function(t){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(r){switch(r.label){case 0:return[4,c.Endpoint.createInside(t,(function(){return e}))];case 1:return r.sent(),[2]}}))}))}}},t.setMockGridSheetAndNotify=function(e,t,r,n,i,a){void 0===a&&(a=0),r.setSheet(e,t,n);var o={sheetId:e,sheetName:t};i.doNotify(p.NotificationKind.updateSheetNames,[a,[o]])}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.platform=void 0;if(t.platform=null!==(n=globalThis.__x10_target_platform)&&void 0!==n?n:"Web",["Web","Win32"].indexOf(t.platform)<0)throw new Error("Wrong platform id ".concat(t.platform));globalThis.__x10_target_platform=t.platform},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPositionKindInfoFromCellRef=t.spanCompare=t.gridRangeToRange=void 0;var n=r(9),i=r(6),a={Abs:i.PositionKind.Absolute,Rel:i.PositionKind.Relative};t.gridRangeToRange=function(e){var t=e.row,r=e.col;return{firstRow:t,firstColumn:r,lastRow:t+e.rows-1,lastColumn:r+e.cols-1}},t.spanCompare=function(e,t){var r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0},t.getPositionKindInfoFromCellRef=function(e){switch(e.kind){case n.CellRefKind.Col:return function(e){return{firstRow:i.PositionKind.Relative,firstColumn:a[e.col1.kind],secondRow:i.PositionKind.Relative,secondColumn:a[e.col2.kind]}}(e);case n.CellRefKind.Row:return function(e){return{firstRow:a[e.row1.kind],firstColumn:i.PositionKind.Relative,secondRow:a[e.row2.kind],secondColumn:i.PositionKind.Relative}}(e);case n.CellRefKind.Single:return function(e){var t,r;return{firstRow:t=a[e.row.kind],firstColumn:r=a[e.col.kind],secondRow:t,secondColumn:r}}(e);case n.CellRefKind.Range:return function(e){return{firstRow:a[e.ref1.row.kind],firstColumn:a[e.ref1.col.kind],secondRow:a[e.ref2.row.kind],secondColumn:a[e.ref2.col.kind]}}(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsistentAnonymizer=void 0;var n=r(0),i=r(549),a=r(550),o=r(9),s=r(51),u=r(4),l=function(){function e(){this.nonLiteralStore=new Map,this.literalStore=new Map}return e.prototype.get=function(e,t,r){var n,i;if(e===a.TokenKind.Literal){if(void 0===r)throw new Error("Expected subkind");return null===(n=this.literalStore.get(r))||void 0===n?void 0:n.get(t)}return null===(i=this.nonLiteralStore.get(e))||void 0===i?void 0:i.get(t)},e.prototype.set=function(e,t,r,n){var i,o;if(e===a.TokenKind.Literal){if(void 0===n)throw new Error("Expected subkind");(s=null!==(i=this.literalStore.get(n))&&void 0!==i?i:new Map).set(t,r),this.literalStore.set(n,s)}else{var s;(s=null!==(o=this.nonLiteralStore.get(e))&&void 0!==o?o:new Map).set(t,r),this.nonLiteralStore.set(e,s)}},e}();var c=function(){function e(){this.store=new l,this.counter=1}return e.prototype.getAnonymization=function(e,t,r,n){var i=this.store.get(e,r,t);if(void 0!==i)return i;var a=n(this.counter);return this.counter+=1,this.store.set(e,r,a,t),a},e.prototype.anonymizeIdent=function(e,t,r,n){var i=null!=t?t:e.start;if(void 0!==(null==r?void 0:r.localeInfo.getWorksheetFuncId(e.chars))&&function(e){return void 0!==e&&(e.kind===a.TokenKind.Left&&e.value===a.DelimId.Paren)}(n))return(0,a.identToken)(i,e.chars);var o=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"ident".concat(e)}));return(0,a.identToken)(i,o)},e.prototype.anonymizeA1CellRef=function(e,t){if(e.refStyle!==o.RefStyle.A1)throw new Error("Expected RefStyle.A1");var r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"A".concat(e)}));return(0,a.cellRefA1Token)(r,n,void 0,void 0)},e.prototype.anonymizeR1C1CellRef=function(e,t){if(e.refStyle!==o.RefStyle.R1C1)throw new Error("Expected RefStyle.R1C1");var r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"R".concat(e,"C").concat(e)}));return(0,a.cellRefR1C1Token)(r,n,void 0,void 0)},e.prototype.anonymizeCellRef=function(e,t){return e.refStyle===o.RefStyle.A1?this.anonymizeA1CellRef(e,t):this.anonymizeR1C1CellRef(e,t)},e.prototype.anonymizeLiteral=function(e,t){var r=null!=t?t:e.start,n=void 0;switch(e.oper.kind){case s.OperKind.Number:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return"".concat(e)}));break;case s.OperKind.String:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return'"s'.concat(e,'"')}));break;case a.TokenOperKind.BadNumber:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return"1e".concat(e,"000")}));break;case a.TokenOperKind.BadError:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){for(var t=["a"],r="a".charCodeAt(0),n=e;n>0;){var i=e%10,a=String.fromCharCode(r+i);t.push(a),n=Math.floor(n/10)}var o=t.join("");return"#".concat(o)}));break;case s.OperKind.Boolean:case s.OperKind.Error:n=e.chars;break;default:(0,u.assertNever)("error",e.oper)}var i=e.oper,o=e.hasRight;return(0,a.literalToken)(r,n,i,o)},e.prototype.anonymizeToken=function(e,t,r,i){switch(e.kind){case a.TokenKind.Ident:return this.anonymizeIdent(e,t,r,i);case a.TokenKind.CellRef:return this.anonymizeCellRef(e,t);case a.TokenKind.Literal:return this.anonymizeLiteral(e,t);case a.TokenKind.Unexpected:return function(e,t){var r=null!=t?t:e.start;return"\t"===e.chars||";"===e.chars?(0,a.unexpectedToken)(r,e.chars):(0,a.unexpectedToken)(r,"\t")}(e,t);case a.TokenKind.SingleLineComment:return(0,a.singleLineCommentToken)(t,"redacted");case a.TokenKind.MultiLineComment:return(0,a.multiLineCommentToken)(t,"redacted",e.isClosed);case a.TokenKind.End:case a.TokenKind.Left:case a.TokenKind.Right:case a.TokenKind.Sep:case a.TokenKind.Operator:case a.TokenKind.Spaces:case a.TokenKind.SpecialRef:case a.TokenKind.Escape:return n.__assign(n.__assign({},e),{start:t});default:return(0,u.assertNever)("ConsistentAnonymizer.anonymizeToken",e)}},e.prototype.anonymize=function(e,t,r){for(var n=(0,i.tokenizeFormula)(t.localeInfo,t.mathpack,t.refStyle,r,e,0,{}),a=[],o=0,s=0;s<n.length;s+=1){var u=n[s],l=s+1<n.length?n[s+1]:void 0,c=this.anonymizeToken(u,o,t,l);o+=c.chars.length,a.push(c)}return a.map((function(e){return e.chars})).join("")},e}();t.ConsistentAnonymizer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var n=function(e,t){return(e<<t|e>>>32-t)>>>0},i=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-n(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^n(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();t.JSF32=i},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=null!==(n=Math.log2)&&void 0!==n?n:function(e){return Math.log(e)*Math.LOG2E}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0;var n=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var i=n,a=1+(n<<1),o=2+(n<<1);if(a<=r&&this.cmp(this.items[a],t)<0&&(i=a),o<=r&&this.cmp(this.items[o],i===a?this.items[i]:t)<0&&(i=o),n===i)break;this.items[n]=this.items[i],n=i}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.clear=function(){this.items.length=0},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++){if(!e(r[t]))return}},e}();t.BinaryHeap=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;var n,i=r(0),a=r(0).__assign;function o(e,t,r){return void 0===r&&(r=10),function(n){if(void 0!==n.split)return n.split;var i=e(n),a=n===t?0:n.depth;return void 0!==a&&a<r&&(n.split=i,i[0][0].depth=a+1,i[1][0].depth=a+1),i}}function s(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function u(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:s(e.setOperations,l(e.setOperations,e.setOperations.top,e.root,r.root))}function l(e,r,n,i){if(i===t.empty)return n;if(i===t.dense)return i;if(n===t.empty)return i;if(n===t.dense)return n;if(n.isExact&&i.isExact){var a=function(e,r,n,i){var a=n.key,o=i.key,s=e.compare(a,o);if(void 0!==s)return s<0?i:n;var u=e.union(a,o);if(void 0!==u){var l=e.compare(u,r);return void 0!==l&&0===l?t.dense:y(e,r,u,!0)}return}(e,r,n,i);if(void 0!==a)return a}var o=F(e,r,n),s=F(e,r,i),u=e.split(r),c=u[0][0],d=u[1][0];return h(e,c,d,l(e,c,o.left,s.left),l(e,d,o.right,s.right))}function c(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return i;if(n===t.dense)return i;if(i===t.dense)return n;if(n.isExact&&i.isExact){var a=function(e,r,n,i){var a=n.key,o=i.key;if(!e.meets(a,o))return t.empty;var s=e.compare(a,o);if(void 0!==s)return s<0?n:i;var u=e.intersect(a,o);if(void 0!==u)return y(e,r,u,!0);return}(e,r,n,i);if(void 0!==a)return a}var o=F(e,r,n),s=F(e,r,i),u=e.split(r),l=u[0][0],d=u[1][0];return h(e,l,d,c(e,l,o.left,s.left),c(e,d,o.right,s.right))}function d(e,r,n,i){if(n===t.empty||i===t.empty)return!1;if(n===t.dense||i===t.dense)return!0;if(n.isExact&&i.isExact)return e.meets(n.key,i.key);var a=F(e,r,n),o=F(e,r,i),s=e.split(r),u=s[0][0],l=s[1][0];return d(e,u,a.left,o.left)||d(e,l,a.right,o.right)}function p(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?s(r.setOperations,m(r.setOperations,r.setOperations.top,e,r.root)):s(e.setOperations,m(e.setOperations,e.setOperations.top,e.root,r.root))}function m(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return n;if(i===t.dense)return t.empty;if(n===t.dense){var a=F(e,r,i),o=e.split(r),s=o[0][0],u=o[1][0];return h(e,s,u,m(e,s,t.dense,a.left),m(e,u,t.dense,a.right))}if(n.isExact&&i.isExact){var l=function(e,t,r,n){var i=r.key,a=n.key;if(!e.meets(i,a))return r;var o=e.except(i,a);if(void 0!==o)return y(e,t,o,!0);return}(e,r,n,i);if(void 0!==l)return l}var c=F(e,r,n),d=F(e,r,i),p=e.split(r),f=p[0][0],g=p[1][0];return h(e,f,g,m(e,f,c.left,d.left),m(e,g,c.right,d.right))}function f(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function g(e,r,n,i){if(n===i)return 0;if(n===t.empty)return-1;if(i===t.empty)return 1;if(n===t.dense)return i===t.dense?0:1;if(i===t.dense)return-1;if(n.isExact&&i.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,i);var a=F(e,r,n),o=F(e,r,i),s=e.split(r),u=s[0][0],l=s[1][0],c=g(e,u,a.left,o.left);if(void 0!==c){var d=g(e,l,a.right,o.right);if(void 0!==d)return f(c,d)}}function h(e,r,n,i,a){return i===t.empty?a===t.empty?t.empty:a===t.dense?v(i,a,void 0,!1,e.infimum(n,n),e.supremum(n,n)):v(i,a,void 0,!1,a.infimum,a.supremum):a===t.empty?i===t.dense?v(i,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):v(i,a,void 0,!1,i.infimum,i.supremum):i===t.dense?a===t.dense?t.dense:v(i,a,void 0,!1,e.combineInfima(e.infimum(r,r),a.infimum),e.combineSuprema(e.supremum(r,r),a.supremum)):a===t.dense?v(i,a,void 0,!1,e.combineInfima(i.infimum,e.infimum(n,n)),e.combineSuprema(i.supremum,e.supremum(n,n))):v(i,a,void 0,!1,e.combineInfima(i.infimum,a.infimum),e.combineSuprema(i.supremum,a.supremum))}function v(e,t,r,n,i,a){return{key:r,left:e,right:t,isExact:n,infimum:i,supremum:a}}function S(e,r,n){if(!e.meets(r,n))return t.empty;var i=e.compare(r,n);if(void 0!==i)return i<=0?t.dense:y(e,r,n,!0);var a=e.intersect(r,n);return void 0!==a?y(e,r,a,!0):y(e,r,n,!1)}function y(e,t,r,n){return v(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function F(e,r,n){if(void 0!==n.left)return n;var i=e.split(r),o=i[0][0],s=i[1][0],u=h(e,o,s,S(e,o,n.key),S(e,s,n.key));if(u===t.empty||u===t.dense)throw new Error("incorrect set operations implementation");var l=u;return a(n,{left:l.left,right:l.right})}function C(e,r,n){return function r(i,a){if(a===t.empty)return!0;if(a===t.dense)return n(i);if(a.isExact)return n(a.key);var o=F(e,i,a),s=e.split(i),u=s[0][0],l=s[1][0];return r(u,o.left)&&r(l,o.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(n||(t.SetKind=n={})),t.cacheKeySplitting=o,t.createFromKey=function(e){var t=i.__assign(i.__assign({},e),{split:o(e.split,e.top)});return function(e){return s(t,S(t,t.top,e))}},t.fromUntyped=s,t.union=u,t.unionUntyped=l,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:s(e.setOperations,c(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=c,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||d(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=d,t.except=p,t.exceptUntyped=m,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:g(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=f,t.compareUntyped=g,t.dense=n.Dense,t.empty=n.Empty,t.lazy=S,t.symmetricDiff=function(e,t){return u(p(e,t),p(t,e))},t.complement=function(e){return p(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:function e(r){if(void 0===r||r===t.empty||r===t.dense)return 0;return e(r.left)+e(r.right)+1}(e.root)},t.forEachKey=function(e,r){return e===t.empty||C(e.setOperations,e.root,r)},t.forEachKeyUntyped=C},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=void 0;var n=r(24),i=r(70),a={},o=0;t.logCollisionKey=function(e){!function(e){var t=a[e];a[e]=(void 0===t?0:t)+1,(o+=1)%100==0&&(i.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(a),".")),a={})}(function(e){return"object"==typeof e?null===e?"null":"Object {".concat(Object.keys(e),"}"):typeof e}(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(49);t.ivlJoin=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return[(0,n.fastMin)(r,a),(0,n.fastMax)(i,o)]},t.ivlMeet=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return[(0,n.fastMax)(r,a),(0,n.fastMin)(i,o)]},t.ivlDistance=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return.5*(0,n.fastAbs)(r+i-(a+o))},t.ivlMeets=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return(0,n.fastMax)(r,a)<(0,n.fastMin)(i,o)},t.ivlMeetsOrTouches=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return(0,n.fastMax)(r,a)<=(0,n.fastMin)(i,o)},t.ivlExcept=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return r<i&&a>=n?[r,i]:r>=i&&a<n?[a,n]:void 0},t.ivlCompare=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return r===i&&n===a?0:r>=i&&n<=a?-1:r<=i&&n>=a?1:void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;var n,i,a=r(70);!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(n||(t.Color=n={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(i||(i={}));var o=n.Red,s=n.Black,u=i.DoubleBlack,l={c:s,l:void 0,r:void 0},c={c:u,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function p(e){return void 0===e.l}function m(e){return e.c===o}function f(e){return e.c===s&&void 0!==e.l}function g(e){return e.c===s&&void 0===e.l}function h(e,t,r,n,i){return{c:e,l:t,key:r,value:n,r:i}}function v(e,t){return h(e,t.l,t.key,t.value,t.r)}function S(e){return p(e)?l:v(s,e)}function y(e,t,r){if(!p(r)){var n=e.keyCompare(t,r.key);return n<0?y(e,t,r.l):n>0?y(e,t,r.r):r}}function F(e,t){return!!p(t)||!!F(e,t.l)&&(!!e(t.key,t.value)&&F(e,t.r))}function C(e,t,r,n,i){if(e===s){if(m(t)&&m(t.l))return h(o,v(s,t.l),t.key,t.value,h(s,t.r,r,n,i));if(m(i)&&m(i.r))return h(o,h(s,t,r,n,i.l),i.key,i.value,v(s,i.r));if(m(t)&&m(t.r))return h(o,h(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,h(s,t.r.r,r,n,i));if(m(i)&&m(i.l))return h(o,h(s,t,r,n,i.l.l),i.l.key,i.l.value,h(s,i.l.r,i.key,i.value,i.r))}if(e===u){if(m(i)&&m(i.l))return h(s,h(s,t,r,n,i.l.l),i.l.key,i.l.value,h(s,i.l.r,i.key,i.value,i.r));if(m(t)&&m(t.r))return h(s,h(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,h(s,t.r.r,r,n,i))}return h(e,t,r,n,i)}function R(e,t,r,n,i){return e===o&&t.c===u&&f(i)?C(s,h(o,S(t),r,n,i.l),i.key,i.value,i.r):e===o&&f(t)&&i.c===u?C(s,t.l,t.key,t.value,h(o,t.r,r,n,S(i))):e===s&&t.c===u&&f(i)?C(u,h(o,S(t),r,n,i.l),i.key,i.value,i.r):e===s&&f(t)&&i.c===u?C(u,t.l,t.key,t.value,h(o,t.r,r,n,S(i))):e===s&&t.c===u&&m(i)&&f(i.l)?h(s,C(s,h(o,S(t),r,n,i.l.l),i.l.key,i.l.value,i.l.r),i.key,i.value,i.r):e===s&&m(t)&&f(t.r)&&i.c===u?h(s,t.l,t.key,t.value,C(s,t.r.l,t.r.key,t.r.value,h(o,t.r.r,r,n,S(i)))):((0,a.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==u&&i.c!==u),h(e,t,r,n,i))}function b(e,t,r,n){return function(e){return!m(e)||e.l.c!==o&&e.r.c!==o?e:v(s,e)}(function e(t,r,n,i){if(p(i))return h(o,l,r,n,l);var a=t.keyCompare(r,i.key);return a<0?C(i.c,e(t,r,n,i.l),i.key,i.value,i.r):a>0?C(i.c,i.l,i.key,i.value,e(t,r,n,i.r)):h(i.c,i.l,r,n,i.r)}(e,t,r,n))}function E(e,t,r){if(p(r))return r;if(r.c===o&&g(r.l)&&g(r.r))return 0===e.keyCompare(t,r.key)?l:r;if(r.c===s&&g(r.l)&&g(r.r))return 0===e.keyCompare(t,r.key)?c:r;if(r.c===s&&m(r.l)&&g(r.l.l)&&g(r.l.r)&&g(r.r)){var n=e.keyCompare(t,r.key);return n<0?h(s,E(e,t,r.l),r.key,r.value,l):n>0?r:h(s,l,r.l.key,r.l.value,l)}var i=e.keyCompare(t,r.key);if(i<0)return R(r.c,E(e,t,r.l),r.key,r.value,r.r);if(i>0)return R(r.c,r.l,r.key,r.value,E(e,t,r.r));(0,a.assertTrue)("calc.common.rbTree.rem: expected node",!p(r.r));var u=function e(t){if(t.c===o&&g(t.l)&&g(t.r))return[t.key,t.value,l];if(t.c===s&&g(t.l)&&g(t.r))return[t.key,t.value,c];if(t.c===s&&g(t.l)&&m(t.r))return[t.key,t.value,v(s,t.r)];(0,a.assertTrue)("calc.common.rbTree.remMin: expected node",!p(t.l));var r=e(t.l),n=r[0],i=r[1],u=r[2];return[n,i,R(t.c,u,t.key,t.value,t.r)]}(r.r),d=u[0],f=u[1],S=u[2];return R(r.c,r.l,d,f,S)}function P(e,t,r){var n=E(e,t,function(e){return f(e)&&e.l.c===s&&e.r.c===s?v(o,e):e}(r));return(0,a.assertTrue)("calc.common.rbTree.remove: expected R|B",n.c===o||n.c===s),n}t.fromUntyped=d,t.isLeaf=p,t.emptyUntyped=l,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=y,t.find=function(e,t){return y(t.ops,e,t.root)},t.forEachUntyped=F,t.forEach=function(e,t){return F(e,t.root)},t.insertUntyped=b,t.insert=function(e,t,r){return d(r.ops,b(r.ops,e,t,r.root))},t.removeUntyped=P,t.remove=function(e,t){return d(t.ops,P(t.ops,e,t.root))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;var n=r(0),i=r(70);function a(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return{kind:"Immediate",timer:setImmediate.apply(void 0,n.__spreadArray([e],t,!1))}}function o(e){switch(e.kind){case"Immediate":clearImmediate(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,i.assertNever)("unknown timer.kind",e)}}t.setImmediateUnified=a,t.clearTimerUnified=o,t.defaultSetTimeoutInterface={setImmediate:a,setTimeout:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return{kind:"Timeout",timer:setTimeout.apply(void 0,n.__spreadArray([e,t],r,!1))}},clearImmediate:o,clearTimeout:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;var n=r(24),i={ULS:new n.NulLogger};t.ulsStopwatchFactory=(0,n.initStopwatchFactory)((function(e){return i.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)})),t.initStopwatch=function(e){i.ULS=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoidMachine=t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;var n,i=r(0),a=r(153);function o(e,t,r){return{kind:e,machine:t,receiver:r}}function s(e,t){return o(n.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(n||(t.TransitionKind=n={})),t.nextTransition=o(n.Next,void 0,void 0),t.breakTransition=o(n.Break,void 0,void 0),t.callMachineTransition=s;var u={receiveResult:function(e){return(0,a.isSuccess)(e)?t.nextTransition:e}};t.nextOnSuccessReceiver=function(){return u};var l=function(e){function t(t,r){var n=this.constructor,i=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;i.machine=t,i.stackDepth=r;var a=n.prototype;return Object.getPrototypeOf(i)!==a&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(i,a):i.__proto__=a),i}return i.__extends(t,e),t}(Error);t.MachineCycle=l;var c=function(){function e(e){this.numSteps=0,this.stack=[];try{this.pushFrame(s(e,{receiveResult:function(e){return e}})),this.transition=t.nextTransition}catch(e){this.transition=(0,a.failure)((0,a.javaScriptError)(e))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(!0===n.runStatus)throw e.numCycles+=1,new l(n,r);!1===n.runStatus&&(n.runStatus=!0),this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.advanceTopFrame=function(){var e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case n.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case n.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case n.Break:return this.transition=t.nextTransition,e;default:var r=this.stack.pop();return r?(r.machine.runStatus=e,this.transition=r.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,a.failure)((0,a.javaScriptError)(e)),t.nextTransition}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r.kind===n.Break)return r;if(r.kind!==n.Next)return this.result=r;if(t())return e.numPauses+=1,r}}catch(e){return this.result=(0,a.failure)((0,a.javaScriptError)(e))}},e.prototype.runToResult=function(){for(;;){var e=this.run();if(e.kind!==n.Break)return e}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}();t.MachineRuntime=c;var d=function(){function e(e){this.machines=e,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?s(this.machines[this.values.length],this):(0,a.success)(this.values)},e.prototype.receiveResult=function(e){return(0,a.isSuccess)(e)?(this.values.push(e.value),this.next()):e},e}();t.AllMachine=d;var p=function(){function e(e){this.machine=e,this.runStatus=!1}return e.prototype.next=function(){return s(this.machine,this)},e.prototype.receiveResult=function(e){return(0,a.isSuccess)(e)?a.successUndefined:e},e}();t.VoidMachine=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;var n=r(1);t.Deque=n.deque.Deque},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.nameScope=t.nameLoc=t.documentScope=t.originCell=t.sheetGridCube=t.sheetGridRange=t.sheetGridCell=t.sheetRangeIndexes=t.allSheetsRange=t.gridRange=t.gridCell=t.sheetRange=t.sheetIndex=t.structRefColumnLoc=t.documentLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.sheetCols=t.sheetRows=t.NameSource=t.LexicalKind=void 0;var n=r(0).__importStar(r(15));t.LexicalKind=n.LexicalKind,t.NameSource=n.NameSource,t.sheetRows=n.sheetRows,t.sheetCols=n.sheetCols,t.lexicalSourceCell=n.lexicalSourceCell,t.lexicalSourceRange=n.lexicalSourceRange,t.lexicalSourceGrid=n.lexicalSourceGrid,t.lexicalSourceName=n.lexicalSourceName,t.lexicalSourceWSF=n.lexicalSourceWSF,t.lexicalSourceUDF=n.lexicalSourceUDF,t.documentLoc=n.documentLoc,t.structRefColumnLoc=n.structRefColumnLoc,t.sheetIndex=n.sheetIndex,t.sheetRange=n.sheetRange,t.gridCell=n.gridCell,t.gridRange=n.gridRange,t.allSheetsRange=n.allSheetsRange,t.sheetRangeIndexes=n.sheetRangeIndexes,t.sheetGridCell=n.sheetGridCell,t.sheetGridRange=n.sheetGridRange,t.sheetGridCube=n.sheetGridCube,t.originCell=n.originCell,t.documentScope=n.documentScope,t.nameLoc=n.nameLoc,t.nameScope=n.nameScope,t.userDefinedFuncLoc=n.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(1);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(14);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isLineBreak=t.isSpace=void 0;var n=r(0),i=r(32),a=r(42),o=r(89),s=r(102),u=r(157),l=n.__importStar(r(125)),c=r(61),d=l.codePointSpace,p=l.codePointLF,m=l.codePointMinusSign,f=l.codePointPlusSign,g=l.codePointSlash;function h(e){return e===d||e===p}function v(e,t,r,n){(0,a.assertIndex)("calc.parse.parseUint",t,16);for(var o=0,u=n,l=r.length;u<l;){var c=(0,s.stringCodePointAt)(r,u);if(!e.isNumeral(c))break;var d=e.getOrdinal(c);0===o&&0!==d&&(l=(0,i.fastMin)(l,u+t)),o=10*o+d,u+=(0,s.numCodeUnits)(c)}return u===l&&u<r.length&&e.isNumeral((0,s.stringCodePointAt)(r,u))?[0,n]:[o,u]}function S(e,t,r,n){var i=n,o=v(e,5,r,i),s=o[0],u=o[1];if(u===i)return!1;if(s>32767)return!1;if(!((i=u)<r.length&&r.charCodeAt(i)===g))return!1;var l=v(e,5,r,i+=1),d=l[0],p=l[1];if(p===i)return!1;if(d>32767)return!1;if(i=p,0===d)return[!1,0,i];var m=t.div(t.fromNumber(s),t.fromNumber(d));return(0,a.assertTrue)("calc.lang.tryTokenizeFrac",(0,c.isNumberOper)(m)),[m,d,i]}function y(e,t,r,n,l,d,p){var g,y,F,C=n,R=0,b="",E=!1,P=!1,k=u.NumberShape.ASCII;if((0,o.stringStartsWith)(r,e.decimalSeparator,n)||n<r.length&&e.isNumeral((0,s.stringCodePointAt)(r,n))){for(var T=function(){if((d||l&&r.indexOf("%",C)>=0)&&(R-=2,void 0!==g)){var n=t.div(g,t.fromNumber(100));(0,a.assertTrue)("calc.lang.parseNumberLiteral",(0,c.isNumberOper)(n)),g=n,F=u.KnownFormat.Pct}if((0,i.fastAbs)(R)>=309)return{value:void 0,i:C,consumedThousands:E,consumedDecimal:P,numShape:k,format:F};var o=t.parse(e,!0,R,b);if(void 0!==g){var s=t.add(o,g);(0,a.assertTrue)("calc.lang.parseNumberLiteral",(0,c.isNumberOper)(s)),o=s}return{value:o,i:C,consumedThousands:E,consumedDecimal:P,numShape:k,format:F}};C<r.length;){var A=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(A))break;if(0!==e.getOrdinal(A))break;(y=e.getNumberShape(A))!==u.NumberShape.ASCII&&(k=y),C+=(0,s.numCodeUnits)(A)}if(p)if(!1!==(O=S(e,t,r,C))){var N=O[0],_=O[1],I=O[2];return C=I,!1===N?{value:void 0,i:C,consumedThousands:E,consumedDecimal:P,numShape:k,format:F}:(F=_>=10?u.KnownFormat.FractBond:u.KnownFormat.Fract,g=N,T())}for(var O,M=C;C<r.length;){A=(0,s.stringCodePointAt)(r,C);if(e.isNumeral(A))R+=1,(y=e.getNumberShape(A))!==u.NumberShape.ASCII&&(k=y),C+=(0,s.numCodeUnits)(A);else{if(!(l&&R>0&&(0,o.stringStartsWith)(r,e.thousandsSeparator,C)))break;E=!0,C+=e.thousandsSeparator.length}}if(b+=r.substring(M,C),E){var D=function(e,t,r){for(var n=r,i="",a=0;a<t.length;){var o=(0,s.stringCodePointAt)(t,a);if(e.isNumeral(o)){var u=(0,s.numCodeUnits)(o);i+=t.substring(a,a+u),a+=u,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;a+=e.thousandsSeparator.length}}return i}(e,b,R);if(void 0===D)return;b=D}if(n<C&&C<r.length&&h(r.charCodeAt(C)))if(!1!==(O=S(e,t,r,C+1))){N=O[0],_=O[1],I=O[2];return C=I,!1===N?{value:void 0,i:C,consumedThousands:E,consumedDecimal:P,numShape:k,format:F}:(F=_>=10?u.KnownFormat.FractBond:u.KnownFormat.Fract,g=N,T())}var w=!1;if((0,o.stringStartsWith)(r,e.decimalSeparator,C)&&(w=C===n,P=!0,C+=e.decimalSeparator.length),0===R)for(;C<r.length;){A=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(A))break;if(0!==e.getOrdinal(A))break;R-=1,(y=e.getNumberShape(A))!==u.NumberShape.ASCII&&(k=y),C+=(0,s.numCodeUnits)(A)}for(M=C;C<r.length;){A=(0,s.stringCodePointAt)(r,C);if(!e.isNumeral(A))break;(y=e.getNumberShape(A))!==u.NumberShape.ASCII&&(k=y),C+=(0,s.numCodeUnits)(A)}if(b+=r.substring(M,C),!(w&&C<=n+e.decimalSeparator.length)){var L=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(0,o.stringStartsWith)(t,"**",n))return[0,r];n+=2}var i=!1;if(n<t.length){var a=(0,s.stringCodePointAt)(t,n);((i=a===m)||a===f)&&(n+=(0,s.numCodeUnits)(a))}if(n>=t.length||!e.isNumeral((0,s.stringCodePointAt)(t,n)))return!1;var u=v(e,10,t,n),l=u[0],c=u[1];return c!==n&&(!(l>2147483647)&&[i?-l:l,c])}(e,r,C);if(!1!==L){var x=L[0];I=L[1];R+=x,I!==C&&(F=u.KnownFormat.Exp),C=I}return!1===L?{value:void 0,i:C,consumedThousands:E,consumedDecimal:P,numShape:k,format:F}:T()}}}t.isSpace=h,t.isLineBreak=function(e){return e===p},t.parseUint=v,t.parseNumberLiteral=y,t.parseSignedLiteral=function(e,t,r,n,i){var a=n,o=!1;if(a<r.length){var s=r.charCodeAt(a);if((s===f||s===m)&&(o=s===m,a+=1,i))for(;a<r.length&&h(r.charCodeAt(a));)a+=1}var u=y(e,t,r,a,!1,!1,!1);return void 0===(null==u?void 0:u.value)?[t.zero,n]:(a=u.i,[o?t.neg(u.value):u.value,a])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(1);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";var n,i,a,o,s,u;Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createIsThousandsPositionCallback=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getNumberShape=t.getOrdinal=t.isNumeral=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;var l=r(24);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return l.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return l.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return l.NulLogger}});var c=r(32),d=r(42);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return d.ulsLogger}});var p,m,f,g,h,v,S=r(101),y=r(89),F=r(386),C=r(387),R=r(87),b=r(40),E=r(157),P=r(227),k=r(230);function T(e,t,r,n,i,a,o,s,u,l,c,d,p,m,f,g,h,v,S,y,F,C,R,b,E,P,k,T,A,N,_,I,O,M,D,w,L,x,K,U,B,W,G,V,j,q,H,z,Q,Y,J,$,X,Z,ee,te,re,ne,ie,ae,oe,se,ue,le,ce,de,pe,me){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:i,isThousandsPosition:a,isIdentStart:o,isIdentContinue:s,stringCompareCI:u,errorNames:l,specialRefNames:c,trueName:d,falseName:p,rowLetter:m,columnLetter:f,leftBrace:g,rightBrace:h,leftBracket:v,rightBracket:S,rcLeftBracket:y,rcRightBracket:F,decimalSeparator:C,listSeparator:R,columnSeparator:b,rowSeparator:E,thousandsSeparator:P,statementSeparator:k,lcid:T,country:A,isThai:N,isEastAsia:_,isKorea:I,isJapan:O,isChinaT:M,isChinaS:D,isComplexScript:w,numberDecimals:L,isExpSepBySpace:x,fractionSeparator:K,isPercentSepBySpace:U,currencyFormat:B,isCurrencySymbolLead:W,isCurrencySepBySpace:G,currencySymbol:V,currencyDecimals:j,dateOrder:q,dateSeparator:H,dateAltSeparator:z,year4Digits:Q,month2Digits:Y,day2Digits:J,longDateFormat:$,timeSeparator:X,timeAltSeparator:Z,hour2Digits:ee,clock24Hour:te,isAMPMSepBySpace:re,ampmSymbols:ne,dayNameShort:ie,dayNameLong:ae,monthNameShort:oe,monthNameLong:se,pictureSpecial:ue,pictureSingle:le,pictureColor:ce,pictureDbnum:de,sysDateFormat:pe,sysTimeFormat:me}}function A(e){var t=0|e;if(t<128)return t>=48&&t<58;var r=15&t;switch(2147483632&t){case 1632:case 1776:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 3664:case 3792:case 3872:case 4160:return r<=9;case 4960:return r>=9;case 4976:return r<=1;case 6112:case 6160:return r<=9;default:return!1}}function N(e){var t=0|e;if(t<128)return(t<48||t>=58)&&(0,d.assertFalse)("calc.config.getOrdinal"),15&t;var r,n=15&t;switch(2147483632&t){case 1632:case 1776:r=n;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:r=n-6;break;case 3664:case 3792:case 3872:case 4160:r=n;break;case 4960:r=n-8;break;case 4976:r=n+8;break;case 6112:case 6160:r=n;break;default:return(0,d.assertFalse)("calc.config.getOrdinal")}return(r<0||r>9||4968===t)&&(0,d.assertFalse)("calc.config.getOrdinal"),r}function _(e){var t=0|e;if(t<128)return(t<48||t>=58)&&(0,d.assertFalse)("calc.config.getNumberShape"),E.NumberShape.ASCII;switch(A(t)||(0,d.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return E.NumberShape.ArabicIndic;case 1776:return E.NumberShape.ExtendedArabicIndic;case 2400:return E.NumberShape.Devanagari;case 2528:return E.NumberShape.Bengali;case 2656:return E.NumberShape.Gurmukhi;case 2784:return E.NumberShape.Gujarati;case 2912:return E.NumberShape.Oriya;case 3040:return E.NumberShape.Tamil;case 3168:return E.NumberShape.Telugu;case 3296:return E.NumberShape.Kannada;case 3424:return E.NumberShape.Malayalam;case 3664:return E.NumberShape.Thai;case 3792:return E.NumberShape.Lao;case 3872:return E.NumberShape.Tibetan;case 4160:return E.NumberShape.Myanmar;case 4960:case 4976:return E.NumberShape.Ethiopic;case 6112:return E.NumberShape.Khmer;case 6160:return E.NumberShape.Mongolian;default:return(0,d.assertFalse)("calc.config.getNumberShape")}}t.calcConfig=function(e,t,r,n,i,a,o){return void 0===t&&(t=b.RefStyle.A1),void 0===r&&(r=k.xlMathpack),void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===a&&(a=P.tzUTC),void 0===o&&(o=P.xlDatepack),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:i,timezone:a,datepack:o}},t.localeInfo=T,function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(p||(t.Country=p={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(m||(t.LCID=m={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(f||(t.PictureSpecial=f={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(g||(t.PictureSingle=g={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(h||(t.PictureColor=h={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(v||(t.PictureDbnum=v={})),t.isNumeral=A,t.getOrdinal=N,t.getNumberShape=_;var I=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,0,0,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0]);function O(e){var t=0|e;return t>=0&&t<128?I[t]>=2:(0,F.isIdentStart)(t)}function M(e){var t=0|e;return t>=0&&t<128?I[t]>=1:(0,F.isIdentContinue)(t)}t.isIdentStart=O,t.isIdentContinue=M,t.englishErrorNames=(0,y.partialArray)(((n={})[R.ErrorType.NULL]="#NULL!",n[R.ErrorType.DIV0]="#DIV/0!",n[R.ErrorType.VALUE]="#VALUE!",n[R.ErrorType.REF]="#REF!",n[R.ErrorType.NAME]="#NAME?",n[R.ErrorType.NUM]="#NUM!",n[R.ErrorType.NA]="#N/A",n[R.ErrorType.GETTING_DATA]="#GETTING_DATA",n[R.ErrorType.SPILL]="#SPILL!",n[R.ErrorType.CONNECT]="#CONNECT!",n[R.ErrorType.BLOCKED]="#BLOCKED!",n[R.ErrorType.UNKNOWN]="#UNKNOWN!",n[R.ErrorType.FIELD]="#FIELD!",n[R.ErrorType.CALC]="#CALC!",n[R.ErrorType.BUSY]="#BUSY!",n[R.ErrorType.EXTERNAL]="#EXTERNAL!",n)),t.englishSpecialRefNames=(0,y.partialArray)(((i={})[b.SpecialRefId.All]="#All",i[b.SpecialRefId.Data]="#Data",i[b.SpecialRefId.Headers]="#Headers",i[b.SpecialRefId.Totals]="#Totals",i[b.SpecialRefId.ThisRow]="#This Row",i)),t.englishPictureSpecial=(0,y.partialArray)(((a={})[f.AP1]="AM/PM",a[f.AP2]="A/P",a[f.AP3]="/",a[f.General]="General",a[f.Currency]="$",a)),t.englishPictureSingle=(0,y.partialArray)(((o={})[g.Sep]=";",o[g.Hash]="#",o[g.Zero]="0",o[g.Decimal]=".",o[g.Percent]="%",o[g.Comma]=",",o[g.Colon]=":",o[g.DateSep]="/",o[g.Slash]="/",o[g.Space]=" ",o[g.Minus]="-",o[g.Plus]="+",o[g.OpenParen]="(",o[g.CloseParen]=")",o[g.Backslash]="\\",o[g.Star]="*",o[g.Year]="y",o[g.Month]="m",o[g.Day]="d",o[g.Hour]="h",o[g.Minute]="m",o[g.Second]="s",o[g.E]="E",o[g.APDelim]="/",o[g.Quote]='"',o[g.ColorStart]="[",o[g.ColorEnd]="]",o[g.Text]="@",o[g.Question]="?",o[g.Underscore]="_",o[g.Reign]="r",o[g.LocDay]="a",o[g.Era]="g",o[g.EraYear]="e",o[g.BidiDate]="B",o[g.BidiNum]="N",o[g.DayTh]="",o[g.MonthTh]="",o[g.YearTh]="",o[g.EngYearTh]="b",o[g.ThYear]="",o[g.HourTh]="",o[g.MinuteTh]="",o[g.SecondTh]="",o[g.ZeroTh]="",o)),t.englishPictureColor=(0,y.partialArray)(((s={})[h.Black]="Black",s[h.White]="White",s[h.Red]="Red",s[h.Green]="Green",s[h.Blue]="Blue",s[h.Yellow]="Yellow",s[h.Magenta]="Magenta",s[h.Cyan]="Cyan",s[h.Color]="Color",s)),t.englishPictureDbnum=(0,y.partialArray)(((u={})[v.DBNUM1]="DBNum1",u[v.DBNUM2]="DBNum2",u[v.DBNUM3]="DBNum3",u[v.DBNUM4]="DBNum4",u)),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM";var D=void 0;t.englishWorksheetFuncIdToName=function(e){var t=L()[e];return void 0===t?"wsf:".concat(e):t},t.englishErrorTypeToName=function(e){var r=t.englishErrorNames[e];return void 0===r?"error.type:".concat(e):r},t.englishOperatorIdToName=function(e){if(e===S.OperatorId.Isect)return" ";if(e===S.OperatorId.Union)return",";var t=S.operatorStrings[e];return void 0===t?"op:".concat(e):t},t.operatorIdToName=function(e,t,r){return t===S.OperatorId.Isect?r:t===S.OperatorId.Union?e.listSeparator:S.operatorStrings[t]};var w=/_/g;function L(){if(null==D){D=[];for(var e=0,t=(0,c.numEnumArray)(S.WorksheetFuncId);e<t.length;e++){var r=t[e],n=(0,S.getWorksheetFuncEnglishName)(r),i=null!=n?n:S.WorksheetFuncId[r].replace(w,".");D[r]=i}}return D}function x(e,t){var r=function(e,t){var r=[];return t.forEach((function(e,t){null!=e&&r.push([e,t])})),C.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?(0,d.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID ".concat(e)):r}}}t.getEnglishWorksheetFuncIdToName=L,t.createWorksheetFuncNameCallbacks=x,t.createIsThousandsPositionCallback=function(e){if(0===e.length||0===e[0])return function(){return!1};if(2===e.length&&0===e[1]){var t=e[0];return function(e){return e>0&&e%t==0}}var r=0===e[e.length-1]&&e.length>=2;return function(t){if(t<=0)return!1;for(var n=t,i=0;i<e.length&&!((n-=e[i])<=0);i+=1);return n>0&&r?n%e[e.length-2]==0:0===n}};var K=void 0;t.getEnglishLocaleInfo=function(){return null==K&&(K=function(){var e=L(),r=(0,c.makeStringCompareCI)("en-US"),n=x(r,e),i=n.getWorksheetFuncId,a=n.getWorksheetFuncName;return T(i,a,A,N,_,(function(e){return e>0&&e%3==0}),O,M,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",m.USA,p.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,E.CurrencyFormat.Paren,!0,!1,"$",2,E.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),K}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;var n,i=r(228),a=r(87),o=r(32);t.tzData=(0,o.typedInstanceCreator)()((function(e,t,r,n,i){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:i}})),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=i.dtr.Rounding,t.dateTime=i.dtr.dtr,t.TimeDivision=i.dtr.TimeDivision,function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(n||(t.TimeGranularity=n={})),t.xlDatepack={fromNum:function(e,t,r){return i.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=i.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):a.numErrorOper},toNumWithDuration:function(e,t,r,n){var o=i.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,n);return"number"==typeof o?e.mathpack.fromNumber(o):a.numErrorOper},daysPerMonth:i.dtr.daysPerMonth,toDays:function(e,t){return i.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,n){return i.dtr.toTime(e.mathpack.toNumber(t),r,n)},utcToLocal:function(e,t,r){return i.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;var n=r(229);t.mathpack=n;var i=r(391);t.dtr=i;var a=r(159);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return a.isSupported}}),(0,r(126)._start)()},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.mod=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;var i,a=r(126),o=r(159),s=r(126);function u(e,t){for(var r=new Uint16Array(s.memory.buffer),n="",i=0;i<t;i+=1)n+=String.fromCharCode(r[e+(i<<1)>>1]);return n}function l(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(i||(t.MathErrorNum=i={}));var c=((n={})[i.Over]=l(i.Over),n[i.Under]=l(i.Under),n[i.DivBy0]=l(i.DivBy0),n[i.Trans]=l(i.Trans),n);function d(e){var t;return null!==(t=c[e])&&void 0!==t?t:l(e)}function p(e){return function(t){var r=e(t),n=(0,a.Mathpack_TakeMathError)();return n===i.None?r:d(n)}}function m(e){return function(t,r){var n=e(t,r),o=(0,a.Mathpack_TakeMathError)();return o===i.None?n:d(o)}}t.mathError=d,t.zero=a.Mathpack_Zero,t.one=a.Mathpack_One,t.pi=a.Mathpack_Pi,t.exp32=a.Mathpack_GetExp32,t.equal=function(e,t){return 0!==(0,a.Mathpack_Equal)(e,t)},t.trunc=a.Mathpack_Trunc,t.ceil=p(a.Mathpack_Ceil),t.floor=p(a.Mathpack_Floor),t.abs=a.Mathpack_Abs,t.neg=a.Mathpack_Neg,t.float=function(e){return e<0?(0,a.Mathpack_SFloat)(e):(0,a.Mathpack_Float)(e)},t.fix=function(e){return(0,a.Mathpack_Fix)(e)>>>0},t.lfix=a.Mathpack_LFix,t.sfix=p(a.Mathpack_SFix),t.round=m(a.Mathpack_Round),t.roundUp=m(a.Mathpack_RoundUp),t.roundDown=m(a.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return d(i.Over);if(!isFinite(e))return d(i.Over);var t=(0,a.Mathpack_TenTo)(e),r=(0,a.Mathpack_TakeMathError)();return r===i.None?t:d(r)},t.compare=a.Mathpack_Compare,t.div=m(a.Mathpack_Div),t.mul=m(a.Mathpack_Mul),t.sub=m(a.Mathpack_Sub),t.add=m(a.Mathpack_Add),t.power=m(a.Mathpack_Power),t.cond=function(e){var t=(0,a.Mathpack_Cond)(e),r=(0,a.Mathpack_TakeMathError)();return r===i.None?t:d(r)},t.cond2=a.Mathpack_Cond2,t.viewRound=p(a.Mathpack_ViewRound),t.sqrt=p(a.Mathpack_Sqrt),t.exp=p(a.Mathpack_Exp),t.ln=p(a.Mathpack_Ln),t.log=p(a.Mathpack_Log),t.sin=p(a.Mathpack_Sin),t.cos=p(a.Mathpack_Cos),t.tan=p(a.Mathpack_Tan),t.asin=p(a.Mathpack_Asin),t.acos=p(a.Mathpack_Acos),t.atan=p(a.Mathpack_Atan),t.atan2=m(a.Mathpack_Atan2),t.mod=m(a.Mathpack_Mod),t.formatGeneral=function(e,t,r){try{(0,o.setLocale)(e);var n=(0,a.Mathpack_FormatGeneral)(t,r);return n<0?d((0,a.Mathpack_TakeMathError)()):u((0,a.Base_StrBuf)(),n)}finally{(0,o.setLocale)(void 0)}},t.formatFixed=function(e,t,r){var n=(0,a.Mathpack_FormatFixed)(e,t,r);if(n<0)return(0,a.Mathpack_TakeMathError)();var i=u((0,a.Base_StrBuf)(),n),o=(0,a.Mathpack_FormatGetExponent)();return{sign:0!==(0,a.Mathpack_FormatGetSign)(),mantissa:i,exponent:o}},t.formatScientific=function(e,t,r){var n=(0,a.Mathpack_FormatScientific)(e,t,r);if(n<0)return(0,a.Mathpack_TakeMathError)();var i=u((0,a.Base_StrBuf)(),n),o=(0,a.Mathpack_FormatGetExponent)();return{sign:0!==(0,a.Mathpack_FormatGetSign)(),mantissa:i,exponent:o}},t.pack=function(e,t,r,n){try{(0,o.setLocale)(e);var u=(0,o.fastMin)(n.length,(0,a.Base_StrBufSize)());!function(e,t){for(var r=new Uint16Array(s.memory.buffer),n=0;n<t.length;n+=1)r[e+(n<<1)>>1]=t.charCodeAt(n)}((0,a.Base_StrBuf)(),n.substring(0,u));var l=(0,a.Mathpack_Pack)(!!t,r,u),c=(0,a.Mathpack_TakeMathError)();return c!==i.None?d(c):isNaN(l)?d(i.Over):l}finally{(0,o.setLocale)(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;var n=r(228),i=r(87),a=r(42),o=r(71),s=r(32);function u(e){return{kind:o.OperKind.Number,_valueXL:e}}var l=u(n.mathpack.zero()),c=u(n.mathpack.one()),d=u(n.mathpack.pi());function p(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?i.div0ErrorOper:i.numErrorOper}function m(e){return function(t){return(0,a.assertFalse)("calc.lang.".concat(e,": error ").concat(JSON.stringify(t)))}}function f(e,t,r){return function(n){var i=e(n._valueXL);return"number"==typeof i?t(i):r(i)}}function g(e,t,r){return function(n,i){var a=e(n._valueXL,i._valueXL);return"number"==typeof a?t(a):r(a)}}var h=g((function(e,t){return n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t)}),u,p),v=f((function(e){return n.mathpack.div(e,100)}),u,m("xlPercent"));var S=f(n.mathpack.ceil,u,m("xlCeil")),y=f(n.mathpack.floor,u,m("xlFloor")),F=f(n.mathpack.cond,s.identity,m("xlCond, isSupported = ".concat((0,n.isSupported)()))),C=g(n.mathpack.cond2,s.identity,m("xlCond2"));var R=f(n.mathpack.sfix,s.identity,m("xlSfix")),b=f(n.mathpack.viewRound,u,m("xlViewRound"));t.xlMathpack={zero:l,one:c,pi:d,add:g(n.mathpack.add,u,p),sub:g(n.mathpack.sub,u,p),mul:g(n.mathpack.mul,u,p),div:g(n.mathpack.div,u,p),power:h,percent:v,neg:function(e){return 0!==F(e)?u(n.mathpack.neg(e._valueXL)):e},compare:function(e,t){return n.mathpack.compare(e._valueXL,t._valueXL)},formatGeneral:function(e,t,r){var i=t._valueXL,o=n.mathpack.formatGeneral(e,i,r);return"string"!=typeof o?(0,a.assertFalse)("calc.lang.xlFormatGeneral: error ".concat(JSON.stringify(o))):o},formatFixed:function(e,t,r){var i=e._valueXL,o=n.mathpack.formatFixed(i,t,r);return"object"!=typeof o?(0,a.assertFalse)("calc.lang.xlFormatFixed: error ".concat(JSON.stringify(o))):o},formatScientific:function(e,t,r){var i=e._valueXL,o=n.mathpack.formatScientific(i,t,r);return"object"!=typeof o?(0,a.assertFalse)("calc.lang.xlFormatScientific: error ".concat(JSON.stringify(o))):o},parse:function(e,t,r,i){var o=n.mathpack.pack(e,t,r,i);return"number"!=typeof o?(0,a.assertFalse)("calc.lang.xlParse: error ".concat(JSON.stringify(o))):u(o)},trunc:function(e){return u(n.mathpack.trunc(e._valueXL))},ceil:S,floor:y,abs:function(e){return u(n.mathpack.abs(e._valueXL))},cond:F,cond2:C,fromNumber:function(e){return(0,a.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),u(e)},toNumber:function(e){var t=e._valueXL;return(0,a.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:f(n.mathpack.sqrt,u,p),exp:f(n.mathpack.exp,u,p),ln:f(n.mathpack.ln,u,p),log:f(n.mathpack.log,u,p),sin:f(n.mathpack.sin,u,p),cos:f(n.mathpack.cos,u,p),tan:f(n.mathpack.tan,u,p),asin:f(n.mathpack.asin,u,p),acos:f(n.mathpack.acos,u,p),atan:f(n.mathpack.atan,u,p),atan2:g(n.mathpack.atan2,u,p),mod:g(n.mathpack.mod,u,p),round:g(n.mathpack.round,u,p),roundUp:g(n.mathpack.roundUp,u,p),roundDown:g(n.mathpack.roundDown,u,p),tenTo:function(e){(0,a.assertInteger)("calc.lang.xlTenTo",e);var t=n.mathpack.tenTo(e);return"number"==typeof t?u(t):p(t)},checkAlmostCancellation:function(e,t){var r=e._valueXL,i=t._valueXL;return n.mathpack.exp32(r)-n.mathpack.exp32(i)>=52428800?l:t},fix:function(e){return n.mathpack.fix(e._valueXL)},lfix:function(e){return n.mathpack.lfix(e._valueXL)},sfix:R,viewRound:b}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.numberComponents=void 0;var n=r(32);t.numberComponents=(0,n.typedInstanceCreator)()((function(e,t,r){return{sign:e,mantissa:t,exponent:r}})),t.formatScientificLeft=function(e,t){if(t<=1)return t;var r=e%t;return 0===r?t:r<0?r+t:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var n=r(50),i=r(88),a=r(61),o=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return(0,i.success)((0,n.documentLoc)(e,t))},e.prototype.getSheetIndex=function(e,t){return(0,i.success)(t)},e.prototype.getSheetName=function(e,t){return(0,i.success)(t)},e.prototype.getNameLoc=function(e,t){return(0,i.success)(t.indexOf(".")>=0?void 0:(0,n.nameLoc)(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return(0,i.success)([])},e.prototype.getSheetRangeIndexes=function(e){if(void 0===e.index)return(0,i.failure)((0,a.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));var t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,i.success)((0,n.sheetRangeIndexes)(t,0))},e.prototype.getContainingTable=function(e){return i.successUndefined},e.prototype.getStructRefColumn=function(e,t){return i.successUndefined},e.prototype.getStructRefSpecialRef=function(e,t){return i.successUndefined},e.prototype.getNamedRanges=function(e){return(0,i.success)([])},e}();t.createSimplePrintGlobals=function(e){return new o(e)},t.printLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1,printAbsoluteReferences:!1}},t.printLocalsName=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0,printAbsoluteReferences:!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contextNameNode=t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.formulaSpan=t.singleLineComment=t.multiLineComment=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.CommentKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.SyntaxFeature=t.RefStyle=void 0,t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaRootAnnotation=t.appHeadNameAnnotation=t.AnnotationKind=t.headNamePart=t.flattenNameParts=t.badSequenceNode=t.badCharsNode=t.missingNode=t.identNode=t.varNode=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=void 0;var n=r(0).__importStar(r(9));t.RefStyle=n.RefStyle,t.SyntaxFeature=n.SyntaxFeature,t.QualifierKind=n.QualifierKind,t.CellRefKind=n.CellRefKind,t.PosKind=n.PosKind,t.CommentKind=n.CommentKind,t.NodeKind=n.NodeKind,t.NamePartKind=n.NamePartKind,t.SpecialRefId=n.SpecialRefId,t.StructRefKind=n.StructRefKind,t.BadType=n.BadType,t.errorQualifier=n.errorQualifier,t.relativeQualifier=n.relativeQualifier,t.documentQualifier=n.documentQualifier,t.sheetQualifier=n.sheetQualifier,t.identQualifier=n.identQualifier,t.sheetRangeQualifier=n.sheetRangeQualifier,t.badQualifier=n.badQualifier,t.pos=n.pos,t.cellRefError=n.cellRefError,t.cellRefSingle=n.cellRefSingle,t.cellRefRange=n.cellRefRange,t.cellRefRow=n.cellRefRow,t.cellRefCol=n.cellRefCol,t.cellRefBad=n.cellRefBad,t.formula=n.formula,t.multiLineComment=n.multiLineComment,t.singleLineComment=n.singleLineComment,t.formulaSpan=n.formulaSpan,t.literalNode=n.literalNode,t.arrayNode=n.arrayNode,t.appNode=n.appNode,t.flattenLetArgs=n.flattenLetArgs,t.indexedArg=n.indexedArg,t.letVar=n.letVar,t.letNode=n.letNode,t.flattenLambdaArgs=n.flattenLambdaArgs,t.paramName=n.paramName,t.paramDefault=n.paramDefault,t.paramNode=n.paramNode,t.lambdaParam=n.lambdaParam,t.lambdaNode=n.lambdaNode,t.operatorNode=n.operatorNode,t.wsfNode=n.wsfNode,t.parenNode=n.parenNode,t.nameNode=n.nameNode,t.identNamePart=n.identNamePart,t.cellRefNamePart=n.cellRefNamePart,t.fieldRefNamePart=n.fieldRefNamePart,t.contextNameNode=n.contextNameNode,t.cellRefNode=n.cellRefNode,t.fieldRefNode=n.fieldRefNode,t.fieldRef=n.fieldRef,t.structRefNode=n.structRefNode,t.structRef=n.structRef,t.specialRef=n.specialRef,t.columnRef=n.columnRef,t.rangeOpRef=n.rangeOpRef,t.commaOpRef=n.commaOpRef,t.thisRowOpRef=n.thisRowOpRef,t.missingRef=n.missingRef,t.badRef=n.badRef,t.varNode=n.varNode,t.identNode=n.identNode,t.missingNode=n.missingNode,t.badCharsNode=n.badCharsNode,t.badSequenceNode=n.badSequenceNode,t.flattenNameParts=n.flattenNameParts,t.headNamePart=n.headNamePart,t.AnnotationKind=n.AnnotationKind,t.appHeadNameAnnotation=n.appHeadNameAnnotation,t.formulaRootAnnotation=n.formulaRootAnnotation,t.localNameUseAnnotation=n.localNameUseAnnotation,t.localNameDeclAnnotation=n.localNameDeclAnnotation},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatName=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;var n=r(3);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatName=n.cellFormat.formatName,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.xlMathpack=t.ieeeMathpack=t.numberComponents=void 0;var n=r(0),i=n.__importStar(r(405)),a=n.__importStar(r(406)),o=n.__importStar(r(163));t.numberComponents=i.numberComponents,t.ieeeMathpack=a.ieeeMathpack,t.xlMathpack=o.xlMathpack,t.formatScientificLeft=i.formatScientificLeft},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.createParser=t.notFormulaString=t.parseLocals=t.ReasonKind=t.createParseGlobals=void 0;var n=r(0),i=n.__importStar(r(106)),a=n.__importStar(r(133)),o=n.__importStar(r(83));t.createParseGlobals=i.createParseGlobals,t.ReasonKind=i.ReasonKind,t.parseLocals=i.parseLocals,t.notFormulaString=i.notFormulaString,t.createParser=a.createParser,t.parseResultHelper=o.parseResultHelper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormula=t.checkFormulaWithDiagnostics=void 0;var n=r(0),i=r(41),a=r(107),o=r(164),s=r(409),u=r(62),l=r(56),c=r(33),d=r(57),p=r(82),m=r(43),f=r(130),g=r(410),h=r(165),v=r(131),S={};function y(e,t){return{context:e,result:t}}var F,C=l.OperKind.String|l.OperKind.Boolean|l.OperKind.Error,R=(F=function(e){return 0!=(e.kind&C)},function(e){return e.kind===c.NodeKind.Literal&&F(e.oper)});function b(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function E(e,t){return t!==l.OperKind.Range||0!=(e&l.OperKind.Range)}function P(e,t){if(t.kind===c.NodeKind.Literal)switch(b(e,t,o.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case l.OperKind.Number:case l.OperKind.Boolean:case l.OperKind.String:case l.OperKind.Error:return;case l.OperKind.Missing:break;default:return(0,i.assertNever)("calc.analyze.checker.checkArrayElement: literal kind",t.oper)}b(e,t,o.baseErrors.Illegal_array_literal_element)}function k(e,t,r,n,a){return g.Pledge.try((function(){if(e.earlyExit&&!e.isOk())throw S;return I(e,t,a)})).bind((function(a){return E(a.result,r)||((0,i.assertTrue)("calc.analyze.checker.check: typeSource passed",void 0!==n),b(e,t,{kind:o.TypeError.Types_not_related,typeGiven:a.result,typeExpected:r,typeSource:n})),a.result=r,a}))}function T(e,t,r){if(r.kind===c.NodeKind.Ident){var n=(0,u.getBoundName)(e.localeInfo,r.whole);return b(e,r,o.baseErrors.Invalid_binder,n.indexOf(".")<0),b(e,r,o.baseErrors.Duplicate_binder,!t.contains(n)),t.setValue(n,!0)}return b(e,r,r.kind===c.NodeKind.Missing?o.baseErrors.Missing_binder:o.baseErrors.Invalid_binder),t}var A=function(e){return 0===e.args.length?e:e.args[e.args.length-1]};function N(e,t){return g.Pledge.try((function(){var r,d=t.head.id,m=(0,p.getWorksheetFuncType)(d),h=m.minArgs,S=m.maxArgs,F=m.headTypes,C=m.restTypes,R=m.tailTypes,E=m.flags,P=t.args,N=P.length,_=(0,u.getArguments)(t.args).length;if(b(e,t.head,o.baseErrors.Invalid_function_name,0==(E&l.FunctionFlags.OnlyParsedDuringLoad)||e.locals.workbookLoad),(0,v.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsInvalidChartMacro")&&b(e,t.head,o.baseErrors.Invalid_function_name,0==(E&l.FunctionFlags.Chart)&&(0==(E&l.FunctionFlags.Macro)||e.locals.lexicalKind===f.LexicalKind.NameManager)),_<h)switch(d){case p.WorksheetFuncId.IF:case p.WorksheetFuncId.LET:case p.WorksheetFuncId.LETREC:case p.WorksheetFuncId.LAMBDA:break;default:var O=P[N-1];b(e,void 0===O?t:O,{kind:o.TypeError.Insufficient_function_arguments,funcId:d,numArgsGiven:_,numArgsExpected:h})}if(_>S){var M=P[N-1];b(e,void 0===M?t:M,{kind:o.TypeError.Excess_function_arguments,funcId:d,numArgsGiven:_,numArgsExpected:S})}else if(C.length>1&&_>F.length+C.length){var D=(_-F.length)%C.length;D>R.length&&b(e,A(t),{kind:o.TypeError.Insufficient_function_arguments,funcId:d,numArgsGiven:_,numArgsExpected:_+(C.length-D)})}if(t.kind===c.NodeKind.App)r=(0,u.getArguments)(t.args).map((function(t,r){return k(e,t,(0,u.getArgType)(m,r,_),{kind:o.TypeSourceKind.WSFArgument,funcId:d,argIndex:r,numArgsGiven:_})}));else if(t.kind===c.NodeKind.Let){var w=t.vars.map((function(e){return e.binder.arg})),L=t.body?[t.body.arg]:[];r=n.__spreadArray(n.__spreadArray([],w,!0),L,!0).map((function(t){return I(e,t)}))}else{var x=t.params.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})).filter(a.isDefined);L=t.body?[t.body.arg]:[];r=n.__spreadArray(n.__spreadArray([],x.map((function(t){return I(e,t,o.baseErrors.Missing_default_expression)})),!0),L.map((function(t){return I(e,t)})),!0)}return g.Pledge.all(r).bind((function(r){return function(e,t){var r=t.head.id,n=(0,u.getArguments)(t.args).length;switch(r){case p.WorksheetFuncId.IF:var l=e.locals.lexicalKind===f.LexicalKind.NameManager?1:2;return void(n<l&&b(e,A(t),{kind:o.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:n,numArgsExpected:l}));case p.WorksheetFuncId._UDF:return b(e,t,o.baseErrors.Unexpected_application_head);case p.WorksheetFuncId.LET:case p.WorksheetFuncId.LETREC:(0,i.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===c.NodeKind.Let);for(var d=s.RedBlackMapTree.create(e.localeInfo.stringCompareCI),m=0,g=t.vars;m<g.length;m++){d=T(e,d,g[m].name.arg.name)}for(var h=0,v=t.badArgs;h<v.length;h++){b(e,v[h].arg,o.baseErrors.Invalid_binder)}b(e,A(t),{kind:o.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:n,numArgsExpected:(0,a.fastMax)(3,n+1+n%2)},n>=3&&void 0!==t.body);break;case p.WorksheetFuncId.LAMBDA:(0,i.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",t.kind===c.NodeKind.Lambda);d=s.RedBlackMapTree.create(e.localeInfo.stringCompareCI);for(var S=!1,y=0,F=t.params;y<F.length;y++){var C=F[y].name;b(e,C.arg.name,o.baseErrors.Unclosed_bracket,C.arg.name.isClosed),void 0!==C.arg.def&&b(e,C.arg.name,o.baseErrors.Binder_requires_brackets,C.arg.name.isBracketed),C.arg.isOptional?S=!0:b(e,C.arg,o.baseErrors.Mandatory_binder_after_optional,!S),d=T(e,d,C.arg.name.name)}for(var R=0,E=t.badArgs;R<E.length;R++){b(e,E[R].arg,o.baseErrors.Invalid_binder)}n>=1&&void 0!==t.body?void 0!==t.body&&(0,u.isMissingLiteralNode)(t.body.arg)&&b(e,t.body.arg,o.baseErrors.Invalid_body):b(e,A(t),{kind:o.TypeError.Insufficient_function_arguments,funcId:r,numArgsGiven:n,numArgsExpected:n+1})}}(e,t),y(e,m.returnType)}))}))}function _(e,t){return g.Pledge.try((function(){return b(e,t,o.baseErrors.Unclosed_application,t.isClosed),(0,u.isWSFNode)(t.head)?N(e,t):(0,u.isOperatorNode)(t.head)?function(e,t){return g.Pledge.try((function(){var r=t.head,n=t.args,i=r.id,a=(0,p.getOperatorType)(i),s=n.length,c=s===a.minArgs;return b(e,r,{kind:o.TypeError.Incorrect_number_of_operator_arguments,opId:i},c),g.Pledge.all(n.map((function(t,r){return g.Pledge.try((function(){return k(e,t,(0,u.getArgType)(a,r,s),{kind:o.TypeSourceKind.OperatorArgument,opId:i,argIndex:r,numArgsGiven:s},{kind:o.SyntaxError.Missing_operation_argument,opId:i})}))}))).bind((function(t){return c&&!n.some(u.isMissingNode)?y(e,a.returnType):y(e,l.SignatureType.All)}))}))}(e,t):function(e,t){return g.Pledge.try((function(){var r=t.head,n=t.args,i=n.length,a=(0,u.getArguments)(n).length,s=n[i-1],d=(0,p.higherOrderFunctionType)().maxArgs-1;return a>d&&b(e,void 0===s?t:s,{kind:o.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:a,numArgsExpected:d}),g.Pledge.all(n.map((function(t){return k(e,t,l.SignatureType.All,void 0)}))).bind((function(t){return I(e,r).bind((function(t){return E(t.result,l.OperKind.Range)||0!=(t.result&(l.OperKind.Array|l.OperKind.Rich))||b(e,r,R(r)||r.kind===c.NodeKind.Array?o.baseErrors.Unexpected_application_head:o.baseErrors.Unexpected_application_head_with_fix),y(e,l.SignatureType.All)}))}))}))}(e,t)}))}function I(e,t,r,n){return void 0===n&&(n=!1),g.Pledge.try((function(){var a,s,p,m;if(e.earlyExit&&!e.isOk())throw S;switch(t.kind){case c.NodeKind.App:case c.NodeKind.Let:case c.NodeKind.Lambda:return _(e,t);case c.NodeKind.Array:return function(e,t){return g.Pledge.try((function(){b(e,t,o.baseErrors.Unclosed_array,t.isClosed);var r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&(0,u.isMissingNode)(t.nodes[0][0]));if(b(e,t,o.baseErrors.Empty_array_literal,r),!r)return y(e,l.OperKind.Array);for(var n=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var a=t.nodes[i],s=a.length;b(e,t,o.baseErrors.Irregular_array_shape,s===n);for(var c=0;c<s;c+=1)P(e,a[c])}return y(e,l.OperKind.Array)}))}(e,t);case c.NodeKind.BadChars:case c.NodeKind.BadSequence:return function(e,t){return g.Pledge.try((function(){var r;if(t.kind===c.NodeKind.BadSequence){switch(t.type){case c.BadType.Unexpected:b(e,t,o.baseErrors.Bad_node,t.contents.some((function(e){return e.kind===c.NodeKind.BadChars||e.kind===c.NodeKind.BadSequence})));break;case c.BadType.StructRef:b(e,null!==(r=t.contents[0])&&void 0!==r?r:t,o.baseErrors.Invalid_struct_ref_table_name);break;case c.BadType.FieldRef:return void b(e,t,o.baseErrors.Unexpected_field_ref)}return g.Pledge.all(t.contents.map((function(t){return I(e,t)})))}switch(t.type){case c.BadType.Unexpected:switch(t.chars){case")":return b(e,t,o.baseErrors.Unexpected_closing_paren);case e.localeInfo.rightBrace:return b(e,t,o.baseErrors.Unexpected_closing_brace);case e.localeInfo.rightBracket:return b(e,t,o.baseErrors.Unexpected_closing_bracket);case".":return b(e,t,o.baseErrors.Unexpected_dot);default:return b(e,t,{kind:o.SyntaxError.Unexpected_character,text:t.chars})}case c.BadType.NumberLiteral:return b(e,t,o.baseErrors.Invalid_number_literal);case c.BadType.StringLiteral:return b(e,t,o.baseErrors.Invalid_string_literal);case c.BadType.ErrorLiteral:return b(e,t,o.baseErrors.Invalid_error_literal);case c.BadType.FieldName:case c.BadType.ParamName:return b(e,t,o.baseErrors.Bad_node);case c.BadType.Qualifier:return b(e,t,o.baseErrors.Invalid_qualifier);default:(0,i.assertNever)("calc.analyze.diagnoseBadNode",t)}}))}(e,t).bind((function(){return y(e,l.SignatureType.All)}));case c.NodeKind.Missing:return!1!==r&&b(e,t,null!=r?r:o.baseErrors.Bad_node),y(e,l.SignatureType.All);case c.NodeKind.CellRef:return e.locals.allowRelativeQualifier||(null===(a=t.qualifier)||void 0===a?void 0:a.kind)!==c.QualifierKind.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?(null===(s=t.qualifier)||void 0===s?void 0:s.kind)===c.QualifierKind.Document||(null===(p=t.qualifier)||void 0===p?void 0:p.kind)===c.QualifierKind.Bad?(b(e,t,o.baseErrors.Invalid_qualifier),y(e,l.SignatureType.All)):t.ref.kind===c.CellRefKind.Bad?(b(e,t,o.baseErrors.Invalid_cell_ref),y(e,l.SignatureType.All)):y(e,l.OperKind.Range):(b(e,t,o.baseErrors.Invalid_unqualified_cell),y(e,l.SignatureType.All)):(b(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_cell),y(e,l.SignatureType.All));case c.NodeKind.Literal:return b(e,t,o.baseErrors.Unclosed_literal,t.isClosed),(0,u.isErrorOper)(t.oper)&&b(e,t,o.baseErrors.Invalid_error_literal,!((m=t.oper.type)>d.ErrorType.GETTING_DATA&&m!==d.ErrorType.BUSY&&m!==d.ErrorType.EXTERNAL)),y(e,t.oper.kind|((0,u.isErrorOper)(t.oper)&&t.oper.type===d.ErrorType.REF?l.OperKind.Range:0));case c.NodeKind.Name:var f=t.qualifier;if((n||!e.locals.allowRelativeQualifier)&&(null==f?void 0:f.kind)===c.QualifierKind.Relative)return b(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_name),y(e,l.SignatureType.All);if(!e.locals.workbookLoad&&(null==f?void 0:f.kind)===c.QualifierKind.Document&&!f.isQuoted)return b(e,t,o.baseErrors.Invalid_qualifier),y(e,l.SignatureType.All);if((null==f?void 0:f.kind)===c.QualifierKind.SheetRange||(null==f?void 0:f.kind)===c.QualifierKind.Bad)return b(e,t,o.baseErrors.Invalid_qualifier),y(e,l.SignatureType.All);var v=(0,c.flattenNameParts)(t.parts).parts,F=e.annotations[v[0].label],C=e.annotations[t.label],R=(null==C?void 0:C.kind)===c.AnnotationKind.AppHeadName;return(null==F?void 0:F.kind)===c.AnnotationKind.LocalNameUse?b(e,t,o.baseErrors.Invalid_name,(0,h.canDenoteLocalName)(f,v)):b(e,t,n?o.baseErrors.Invalid_struct_ref_table_name:o.baseErrors.Invalid_name,t.parts.canDenoteNamedObject||(0,h.canDenoteUserDefinedFunc)(R,f,t.parts)||(0,h.canDenoteCellRef)(e.locals,f,v)),y(e,l.SignatureType.All);case c.NodeKind.Paren:return b(e,t,o.baseErrors.Unclosed_paren,t.isClosed),b(e,t,o.baseErrors.Empty_parenthesis,!(0,u.isMissingNode)(t.node)),I(e,t.node,!1);case c.NodeKind.FieldRef:return b(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),b(e,t,o.baseErrors.Unexpected_field_ref,!(0,u.isMissingNode)(t.lhs)&&!(0,u.isNumberLiteralNode)(t.lhs)),t.rhs.field.kind!==c.NodeKind.Ident&&b(e,t.rhs.field,t.rhs.field.kind===c.NodeKind.Missing?o.baseErrors.Missing_field_name:o.baseErrors.Invalid_field_name),I(e,t.lhs,!1).bind((function(t){return y(e,l.SignatureType.All)}));case c.NodeKind.StructRef:if(b(e,t,o.baseErrors.Missing_struct_ref_table_name,void 0!==t.lhs||e.locals.allowImplicitTable),void 0===t.rhs.innerRef);else{var E=function(t){switch(null==t?void 0:t.kind){case void 0:break;case c.StructRefKind.RangeOpRef:E(t.lhs),E(t.rhs);break;case c.StructRefKind.CommaOpRef:b(e,t,o.baseErrors.Invalid_struct_ref_comma_parts,(0,u.isCommaOpRefWellFormed)(t)),t.refs.forEach(E);break;case c.StructRefKind.SpecialRef:case c.StructRefKind.ColumnRef:b(e,t,o.baseErrors.Unclosed_bracket,t.isClosed);break;case c.StructRefKind.ThisRowOpRef:E(t.ref);break;case c.StructRefKind.MissingRef:b(e,t,o.baseErrors.Invalid_struct_ref_missing_part);break;case c.StructRefKind.BadRef:b(e,t,o.baseErrors.Unclosed_bracket,t.isClosed),b(e,t,o.baseErrors.Invalid_struct_ref_bad_part)}};E(t.rhs.innerRef)}return b(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?g.Pledge.resolve(void 0):I(e,t.lhs,void 0,!0)).bind((function(t){return y(e,l.SignatureType.All)}));default:return(0,i.assertNever)("calc.analyze.checker.infer: unhandled formula case",t)}}))}var O={ok:!0,isOk:a.identity,collect:function(e,t,r){return!1}};function M(e,t,r,n,i){var a,o,s=r.annotations;void 0===i&&(i=!0);var u={globals:e,locals:t,localeInfo:null!==(o=null===(a=t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==o?o:e.config.localeInfo,annotations:s,reportError:n.collect,isOk:function(){return n.isOk(u.errorData)},earlyExit:i,errorData:n.ok};return u}function D(e,t){try{var r=g.Pledge.settleOrThrow(k(e,t.node,l.SignatureType.All,void 0,o.baseErrors.Empty_formula));return function(e,t){var r=t.annotations[t.node.label];function n(t){for(var r=0,n=t;r<n.length;r++){var i=n[r];b(e,i,o.baseErrors.Unclosed_comment,i.isClosed)}}function s(e){var r=t.spans[e];null!=r&&(r.preComments&&n(r.preComments),r.postComments&&n(r.postComments))}(null==r?void 0:r.kind)===c.AnnotationKind.FormulaRoot&&void 0!==r.syntaxFeatures&&r.syntaxFeatures[c.SyntaxFeature.Comments]&&g.Pledge.settleOrThrow(function e(t){return g.Pledge.try((function(){switch(s(t.label),t.kind){case c.NodeKind.Literal:case c.NodeKind.Missing:case c.NodeKind.BadChars:break;case c.NodeKind.App:case c.NodeKind.Let:case c.NodeKind.Lambda:return t.head.kind===c.NodeKind.Operator&&s(t.head.label),g.Pledge.all(t.args.map(e));case c.NodeKind.Array:return g.Pledge.all((0,a.safeConcat)([],t.nodes.map((function(t){return t.map(e)}))));case c.NodeKind.BadSequence:return g.Pledge.all(t.contents.map(e));case c.NodeKind.CellRef:case c.NodeKind.Name:t.qualifier&&s(t.qualifier.label);break;case c.NodeKind.Paren:return e(t.node);case c.NodeKind.FieldRef:return s(t.rhs.label),s(t.rhs.field.label),e(t.lhs);case c.NodeKind.StructRef:return t.lhs?e(t.lhs):void 0;case c.NodeKind.Var:s(t.name.label);break;case c.NodeKind.Param:if(s(t.name.label),s(t.name.name.label),t.def)return s(t.def.label),e(t.def.rhs);break;default:return(0,i.assertNever)("calc.analyze.checker.comments",t)}}))}(t.node))}(e,t),r}catch(t){if(t===S)return y(e,l.SignatureType.All);throw t}}t.checkFormulaWithDiagnostics=function(e,t,r){try{var i=D(M(e,t,r,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,i=null!=r?r:[];return(null!==(n=i[e.label])&&void 0!==n?n:i[e.label]=[]).push(t),i}},!1),r).context.errorData;return(0,m.success)([n.__assign(n.__assign({},r),{isWellFormed:void 0===i}),i])}catch(e){return(0,m.failure)((0,m.javaScriptError)(e))}},t.checkFormula=function(e,t,r){try{var i=D(M(e,t,r,O),r).context.errorData;return(0,m.success)(n.__assign(n.__assign({},r),{isWellFormed:i}))}catch(e){return(0,m.failure)((0,m.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeral=t.getOrdinal=t.getNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(3);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getNumberShape=n.config.getNumberShape,t.getOrdinal=n.config.getOrdinal,t.isNumeral=n.config.isNumeral,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=void 0;var n=r(0),i=r(33),a=r(62),o=r(41),s=r(43),u=r(166),l=r(240),c=r(165),d=r(130),p=r(241),m=r(56),f=r(57),g={getDocumentLoc:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}};var h=(0,a.createFailureErrorClass)("AutocorrectError"),v=n.__assign(n.__assign({},(0,u.binaryVisitor)((0,u.constVisitor)(!1),(function(e,t){return e||t}))),{badSequenceNode:function(e,t,r){return!0},badCharsNode:function(e,t,r){return!0}}),S=function(e){function t(t,r,n){var i,a,o,s,u=e.call(this)||this;u.f=n,u.seenUnclosed=!1,u.seenParen=!1,u.seenMissingOperand=!1;var l=function(e){var t,r,n,i,a,o,s,u,l,c,d,p,m,f,h,v,S,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:g.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:g.getSheetIndex,getSheetName:null!==(o=null===(a=e.getSheetName)||void 0===a?void 0:a.bind(e))&&void 0!==o?o:g.getSheetName,getNameLoc:null!==(u=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==u?u:g.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(l=e.getUserDefinedFuncLoc)||void 0===l?void 0:l.bind(e))&&void 0!==c?c:g.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(p=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==p?p:g.getSheetRangeIndexes,getContainingTable:null!==(f=null===(m=e.getContainingTable)||void 0===m?void 0:m.bind(e))&&void 0!==f?f:g.getContainingTable,getStructRefColumn:null!==(v=null===(h=e.getStructRefColumn)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:g.getStructRefColumn,getStructRefSpecialRef:null!==(y=null===(S=e.getStructRefSpecialRef)||void 0===S?void 0:S.bind(e))&&void 0!==y?y:g.getStructRefSpecialRef}}(t);return u.globals=l,u.locals=r,u.resolver=(0,c.createResolver)(l),u.localeInfo=null!==(a=null===(i=r.config)||void 0===i?void 0:i.localeInfo)&&void 0!==a?a:t.config.localeInfo,u.refStyle=null!==(s=null===(o=r.config)||void 0===o?void 0:o.refStyle)&&void 0!==s?s:t.config.refStyle,u}return n.__extends(t,e),t.prototype.autocorrect=function(){return(0,u.reduceBottomUp)(v,this.f)?this.f.node:(0,u.reduceBottomUp)(this,this.f)},t.prototype.literalNode=function(e,t,r){if((t||(this.seenUnclosed=!0),!this.locals.allowUnqualifiedCell&&e.kind===m.OperKind.Error&&e.type===f.ErrorType.REF)&&this.qualifyCellRef())return(0,i.cellRefNode)((0,i.cellRefError)(),this.qualifyCellRef(),r);return(0,i.literalNode)(e,t,r)},t.prototype.nameNode=function(e,t,r){var a=(0,i.nameNode)(e,t,r),u=(0,i.flattenNameParts)(e).parts,d=n.__assign(n.__assign({},this.locals),{allowUnqualifiedCell:!0}),p=this.resolver.resolveDottedName(d,a,this.f.annotations),m=p.headResolved,f=p.fieldsResolved;if((0,c.canDenoteCellRef)(d,t,u)){var g=u[0],h=u[1],v=u.slice(2);if(m.kind===l.ResolvedKind.ResolvedCellRef){var S=m.node,y=S.ref,F=S.qualifier,C=S.label,R=this.cellRefNode(y,F,C),b=R.ref,E=R.qualifier;(0,o.assertTrue)("calc.analyze.autocorrectFormula: resolved CellRefKind correct",y.kind===g.ref.kind),(0,o.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't change CellRefKind",b.kind===y.kind),(0,o.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't generate ErrorQualifier",(null==E?void 0:E.kind)!==i.QualifierKind.Error),(0,o.assertTrue)("calc.analyze.autocorrectFormula: all flattened field parts resolved",u.length===1+f.length);var P=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,a=t.label,o=t.qualifiedLabel;return(0,i.fieldRefNamePart)(e,r,n,a,o)};return(0,i.nameNode)(v.reduce(P,P((0,i.cellRefNamePart)(b,g.asWhole,g.label,g.qualifiedLabel),h)),E,C)}this.throwIfResolutionUnknown(m.resolution)}if(this.locals.allowRelativeQualifier&&void 0===t){if(m.kind===l.ResolvedKind.ResolvedName&&(0,s.isSuccess)(m.resolution)&&m.resolution.value&&void 0!==m.resolution.value.scope.index)return(0,i.nameNode)(e,this.qualifySheetName(m.resolution.value.scope),r);this.throwIfResolutionUnknown(m.resolution)}if(t&&(t.kind===i.QualifierKind.Sheet||t.kind===i.QualifierKind.Ident)){if(m.kind===l.ResolvedKind.ResolvedName&&(0,s.isSuccess)(m.resolution)&&m.resolution.value&&void 0===m.resolution.value.scope.index&&m.qualifierResolution===i.QualifierKind.Sheet)return(0,i.nameNode)(e,this.qualifyBookName(m.resolution.value.scope),r);this.throwIfResolutionUnknown(m.resolution)}return a},t.prototype.arrayNode=function(e,t,r){return t||(this.seenUnclosed=!0),(0,i.arrayNode)(e,t,r)},t.prototype.appNode=function(e,t,r,n){var o=this.appNodeBase(e,r,n);return r||(this.seenUnclosed=!0),(0,a.isOperatorNode)(e)||(this.seenParen=!0),(0,a.isOperatorNode)(e)&&t.some(a.isMissingNode)&&(this.seenMissingOperand=!0),(0,i.appNode)(e,t,o,n)},t.prototype.letNode=function(e,t,r,n,a,o){var s=this.appNodeBase(e,a,o);return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.letNode)(e,t,r,n,s,o)},t.prototype.lambdaNode=function(e,t,r,n,a,o){var s=this.appNodeBase(e,a,o);return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.lambdaNode)(e,t,r,n,s,o)},t.prototype.parenNode=function(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.parenNode)(e,t,r)},t.prototype.cellRefNode=function(e,t,r){return e.isBracketed&&"("===this.localeInfo.rcLeftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?(0,i.cellRefNode)(e,t,r):(0,i.cellRefNode)(e,this.qualifyCellRef(),r)},t.prototype.fieldRefNode=function(e,t,r){return t.isClosed||(this.seenUnclosed=!0),(0,i.fieldRefNode)(e,t,r)},t.prototype.structRefNode=function(e,t,r){if(t.isClosed||(this.seenUnclosed=!0),void 0!==e&&e.qualifier){var n=this.resolver.resolveName(this.locals,e,d.NameSource.StructRef),a=n.resolution,o=n.qualifierResolution;if((0,s.isSuccess)(a)&&a.value&&o===i.QualifierKind.Sheet)return(0,i.structRefNode)((0,i.nameNode)(e.parts,void 0,e.label),t,r);this.throwIfResolutionUnknown(a)}return(0,i.structRefNode)(e,t,r)},t.prototype.qualifyCellRef=function(){var e=this.locals.originSheet;if(!(0,s.isSuccess)(e))throw new h(e.reason);if(void 0!==e.value.index){var t=this.globals.getSheetName(e.value.document,e.value.index);if(!(0,s.isSuccess)(t))throw new h(t.reason);return(0,i.sheetQualifier)(t.value,void 0,(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))}},t.prototype.qualifySheetName=function(e){var t=this.globals.getSheetName(e.document,e.index);if(!(0,s.isSuccess)(t))throw new h(t.reason);return(0,i.sheetQualifier)(t.value,void 0,(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.value))},t.prototype.qualifyBookName=function(e){var t=e.document;return(0,i.identQualifier)(t.name,(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,t.name))},t.prototype.appNodeBase=function(e,t,r){return t||!(0,a.isOperatorNode)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand},t.prototype.isFormulaRoot=function(e){var t;return(null===(t=this.f.annotations[e])||void 0===t?void 0:t.kind)===i.AnnotationKind.FormulaRoot},t.prototype.throwIfResolutionUnknown=function(e){if(!(0,s.isSuccess)(e)&&e.reason.kind!==l.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==l.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==l.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==l.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==l.ResolveReasonKind.EmptyIntersection)throw new h(e.reason)},t}(u.IdentityVisitor);t.autocorrectFormula=function(e,t,r){try{var n=r.spans,a=r.annotations,o=r.depthUpperBound,u=new S(e,t,r).autocorrect();return(0,s.success)((0,i.formula)(u,n,a,o))}catch(e){return e instanceof h?(0,s.failure)(e.reason):(0,s.failure)((0,s.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(3);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;var n=r(3);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=void 0;var n=r(0),i=r(130),a=n.__importStar(r(164));t.diagnostics=a;var o=r(43);t.summarizeFormulaDiagnostics=function(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=a.formatDiagnostic(e);t[n]=(null!==(r=t[n])&&void 0!==r?r:0)+1}))})),t}},t.staticPrecedents=function(e,t,r,n,i,a,o){return{cells:e,names:t,udfs:r,special:n,ownSpecial:i,bound:a,resolutions:o}},t.createAnalyzeGlobals=function(e,t){return{config:e,getSheetName:t}},t.analyzeLocalsGrid=function(e,t,r,n){return void 0===n&&(n=!1),{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,o.success)(t.range),originSheet:(0,o.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}},t.analyzeLocalsName=function(e,t,r){return void 0===r&&(r=!1),{config:null!=t?t:void 0,lexicalKind:i.LexicalKind.NameManager,originGridCell:(0,o.success)(e.range),originSheet:(0,o.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notFormulaString=t.ReasonKind=t.parseLocals=t.createParseGlobals=void 0;var n,i=r(0),a=r(62),o=r(43);t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r,n,i){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,o.success)(t),contextNames:n,syntaxFeatures:i}},function(e){e.NotFormulaString="NotFormulaString"}(n||(n={})),t.ReasonKind=i.__assign(i.__assign({},a.ReasonKind),n),t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.runFormulaParser=t.parseFormula=void 0;var n=r(81),i=r(41),a=r(33),o=r(33),s=r(82),u=r(52),l=r(63),c=r(91),d=r(73),p=r(58),m=r(245),f=r(247),g=r(167),h=r(248),v=r(43),S=r(412),y=r(90),F=r(1),C=r(132),R=r(131),b=r(62),E=r(57),P=(0,l.apply)((0,l.tuple)(p.parseWhitespace,(0,l.lazy)((function(){return t.parseFormula})),p.parseWhitespace),(function(e,t){var r,n,a=t[0],o=t[1],s=t[2],u=(0,d.getNodeSpan)(e,o);return(0,i.assertTrue)("calc.parse.parseSpFormula",!(u.pre.length>0&&a.length>0)),(0,i.assertTrue)("calc.parse.parseSpFormula",!(u.post.length>0&&s.length>0)),a.length>0&&(r=(0,d.addWhitespace)(e,a),u.pre=r[0],u.preComments=r[1]),s.length>0&&(n=(0,d.addWhitespace)(e,s),u.post=n[0],u.postComments=n[1]),o})),k=(0,l.apply)((0,l.tuple)(p.parseLeftParen,(0,d.withDelim)({delimId:u.DelimId.Paren,listSep:d.ListSep.Union},P),(0,l.opt)(p.parseRightParen,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3];return(0,a.parenNode)(n,void 0!==i,(0,d.addSpan)(e,r.start,o,"",""))})),T=(0,l.many1)(P,(0,l.right)(p.parseColSep,P)),A=(0,l.many1)(T,(0,l.right)(p.parseRowSep,T)),N=(0,l.apply)((0,l.tuple)(p.parseLeftBrace,(0,d.withDelim)({delimId:u.DelimId.Brace,listSep:d.ListSep.Union},A),(0,l.opt)(p.parseRightBrace,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3];return(0,a.arrayNode)(n,void 0!==i,(0,d.addSpan)(e,r.start,o,"",""))}));function _(e){return(0,l.takePeek)((function(t,r,n){return e(r)?(0,a.badCharsNode)(a.BadType.Unexpected,r.chars,(0,d.addSpan)(t,r.start,n.start,"","")):void 0}))}var I=(0,l.apply)((0,l.tuple)(p.parseCharIndex,_(p.isLeftBracketToken),(0,d.withDelim)({delimId:u.DelimId.Bracket,listSep:d.ListSep.Union},P),(0,l.opt)(_(p.isRightBracketToken),void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],u=[n,i];return null!=o&&u.push(o),(0,a.badSequenceNode)(a.BadType.Unexpected,u,(0,d.addSpan)(e,r,s,"",""))})),O=(0,l.takePeek)((function(e,t,r){switch(t.kind){case u.TokenKind.End:case u.TokenKind.Operator:case u.TokenKind.Spaces:case u.TokenKind.SingleLineComment:case u.TokenKind.MultiLineComment:return;case u.TokenKind.Sep:if(t.value===u.SepId.Dot)return;if(t.value===u.SepId.Qual||t.value===u.SepId.Assign)break;if(e.delim.delimId===u.DelimId.Brace||t.value!==u.SepId.Col&&t.value!==u.SepId.Row)return;break;case u.TokenKind.Right:if(t.value!==u.DelimId.SQuote&&e.delim.stack[t.value])return}return(0,a.badCharsNode)(a.BadType.Unexpected,t.chars,(0,d.addSpan)(e,t.start,r.start,"",""))})),M=(0,l.any)(m.parseRef,f.parseLiteral,k,N,g.parseFieldRef,h.parseStructRef,I,m.parseUnqualBadRef,O);function D(e){return(0,l.tuple)(p.parseLeftParen,(0,d.withDelim)({delimId:u.DelimId.Paren,listSep:d.ListSep.Arg},(0,l.apply)((0,l.many1)(e,(0,l.right)(p.parseListSep,e)),(function(e,t){return t.map((function(e){return e.kind===a.NodeKind.Missing?(0,a.literalNode)(E.missingOper,!0,e.label):e}))}))),(0,l.opt)(p.parseRightParen,void 0),p.parseCharIndex)}var w=(0,l.apply)(D(P),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,c.argsTerm)(n,void 0!==i,r.start,a)})),L=(0,l.apply)(D((0,l.any)((0,l.lazy)((function(){return t.parseSpParam})),P)),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,c.lambdaArgsTerm)(n,void 0!==i,r.start,a)})),x=(0,l.take)((function(e,t){return t.kind!==u.TokenKind.Operator||t.value!==s.OperatorId.Percent&&t.value!==s.OperatorId.Pound?void 0:t}));var K=(0,l.take)((function(e,t){return t.kind===u.TokenKind.Operator||(0,p.isDotSepToken)(t)?t:function(e,t){return t.kind===u.TokenKind.Sep&&t.value===u.SepId.List&&e.delim.listSep===d.ListSep.Union?(0,u.operatorToken)(t.start,e.localeInfo.listSeparator,s.OperatorId.Union):void 0}(e,t)})),U=(0,l.many)((0,l.take)((function(e,t){return(0,p.isWhitespaceToken)(t)?t:void 0}))),B=(0,l.any)((0,l.concat)((0,l.bind)((0,l.any)(M,x),(function(e,t){var r=(0,c.isWSFNode)(e.localeInfo,t);return(null==r?void 0:r.id)===s.WorksheetFuncId.LAMBDA?(0,l.concat)((0,l.parseSucceed)([t]),(0,l.opt)((0,l.tuple)(L),[])):(0,l.parseSucceed)([t])})),(0,l.many)((0,l.any)(w,g.parseFieldRef,h.parseStructRef))),(0,l.tuple)(K)),W=(0,l.flatten)((0,l.many1)(B,(0,l.concat)(U,B)));t.parseFormula=(0,l.apply)((0,l.tuple)((0,l.opt)(W,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1];if(null==r){var i=(0,d.addSpan)(e,n,n,"","");return(0,a.missingNode)("",i)}var o=r;return o.push((0,u.endToken)(n)),(0,c.runOperatorPrecedenceParser)(e,o)})),t.runFormulaParser=function(e,t,r,s,c,p,m,f){var g,h=f.length-1;if(h<0){var y="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,i.assertFalse)(y)}if(f[h].kind!==u.TokenKind.End){y="calc.parse.runTokenParser: internal error: array[n] !== End in ".concat((0,n.anonymize)(f));return(0,i.assertFalse)(y)}var F=(0,d.makeState)(e,t,r,s,c),C=(0,l.runParser)(P,f,0,F);if(!(0,v.isSuccess)(C)||C.value.index<h){var R=(0,v.isSuccess)(C)?C.value.index:0;y="calc.parse.runTokenParser: internal error: consumed ".concat(R," out of ").concat(h," in ").concat((0,n.anonymize)(f));return(0,i.assertFalse)(y)}var b=C.value.output,E=F.spans,k=(0,S.buildAnnotations)(e,b,p,void 0===m?void 0:((g={})[o.SyntaxFeature.Comments]=!0===m[o.SyntaxFeature.Comments],g[o.SyntaxFeature.Statements]=!0===m[o.SyntaxFeature.Statements],g));return(0,a.formula)(b,E,k)};var G=F.codePoint.codePointFullStop;var V=(0,l.apply)((0,l.many1)((0,l.take)((function(e,t){return t.isIdentContinue||(0,p.isDotSepToken)(t)?t:void 0}))),(function(e,t){var r=t[0].start,n=t.map((function(e){return e.chars})).join(""),i=(0,d.addSpan)(e,r,r+n.length,"","");return function(e,t){if(!e.localeInfo.isIdentStart((0,y.stringCodePointAt)(t,0)))return!1;if(!(0,y.codePointIterator)(t).every((function(t){return t===G||e.localeInfo.isIdentContinue(t)})))return!1;var r=(0,C.parseCellRef)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){var n=r.refStyle===a.RefStyle.A1?(0,u.cellRefA1Token)(0,t,r.row,r.col):(0,u.cellRefR1C1Token)(0,t,r.row,r.col,r.enLocale);if((0,m.isCompleteCellRefToken)(e,n))return!1}return!0}(e,n)?(0,a.identNode)(n,i):(0,a.badCharsNode)(a.BadType.ParamName,n,i)})),j=(0,l.applyTake)((0,l.tuple)(p.parseCharIndex,p.parseLeftBracket,p.parseCharIndex,p.parseSpacesOnly,(0,l.opt)(V,void 0),p.parseSpacesOnly,p.parseCharIndex,(0,l.opt)(p.parseRightBracket,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8];if(void 0!==o){var p=(0,d.getNodeSpan)(e,o);p.pre=i,p.post=s}var m=null!=o?o:(0,a.missingNode)(i+s,(0,d.addSpan)(e,n,u,"",""));return(0,a.paramName)(m,!0,void 0!==l,(0,d.addSpan)(e,r,c,"",""))})),q=(0,l.applyTake)((0,l.tuple)(p.parseCharIndex,m.parseRef,p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],o=n.kind===c.TermKind.MaybeWSFTerm?n.node:n;if((0,b.isUnqualifiedNameNode)(o))return(0,a.paramName)((0,a.identNode)(o.whole,o.label),!1,!0,(0,d.addSpan)(e,r,i,"",""))})),H=(0,l.apply)((0,l.tuple)(p.parseWhitespace,p.parseCharIndex,p.parseAssignToken,p.parseWhitespace,(0,l.lazy)((function(){return t.parseFormula})),p.parseCharIndex),(function(e,t){var r,n=t[0],i=t[1],o=(t[2],t[3]),s=t[4],u=t[5],l=(0,d.getNodeSpan)(e,s);return r=(0,d.addWhitespace)(e,o),l.pre=r[0],l.preComments=r[1],(0,a.paramDefault)(s,(0,d.addSpan)(e,i,u,n,""))})),z=(0,l.lazy)((function(){return(0,R.isFeatureEnabled)(R.FeatureName.CalcLambdaDefaultParameters)?H:(0,l.parseFail)()}));t.parseSpParam=(0,l.applyTake)((0,l.tuple)(p.parseWhitespace,p.parseCharIndex,(0,l.bind)((0,l.any)(q,j),(function(e,t){return t.isClosed?(0,l.apply)((0,l.opt)(z,void 0),(function(e,r){return[t,r]})):(0,l.parseSucceed)([t,void 0])})),p.parseCharIndex,p.parseWhitespace,(0,l.peek)((function(e,t){return t}))),(function(e,t){var r=t[0],n=t[1],i=t[2],o=i[0],s=i[1],l=t[3],c=t[4],m=t[5];if(void 0!==s||m.kind===u.TokenKind.End&&o.isBracketed||(0,p.isListSepToken)(m)&&o.isClosed)return(0,a.paramNode)(o,s,(0,d.addSpan)(e,n,l,r,c))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=t.isCompleteCellRefToken=void 0;var n=r(0),i=r(81),a=r(41),o=r(33),s=r(57),u=r(132),l=r(52),c=r(63),d=r(91),p=r(73),m=r(62),f=r(58),g=r(246),h=r(56),v=r(90),S=r(167);function y(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==u.SpecialPos.A1BadDollar&&t.col!==u.SpecialPos.A1BadDollar}function F(e){return e.refStyle===o.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function C(e,t){return t.kind===l.TokenKind.CellRef&&y(e,t)&&F(t)}t.isCompleteCellRefToken=C;var R=(0,o.pos)(o.PosKind.Rel,0);function b(e){return e===u.SpecialPos.RCNoNum?R:e}function E(e,t){if(e.row!==u.SpecialPos.A1BadDollar&&e.col!==u.SpecialPos.A1BadDollar){var r=e.refStyle===o.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,o.cellRefSingle)(b(e.row),b(e.col),r,t);if(null!=e.row){var n=b(e.row);return(0,o.cellRefRow)(n,n,r,t)}if(null!=e.col){var s=b(e.col);return(0,o.cellRefCol)(s,s,r,t)}}var l="calc.parse.cellRefToken2cellRef: bad token ".concat((0,i.anonymize)(e));return(0,a.assertFalse)(l)}function P(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,v.stringCodePointAt)(t.chars,0))}var k=(0,c.take)((function(e,t){return C(e,t)&&!P(e,t)||(0,f.isRefErrorToken)(t)?t:void 0})),T=(0,c.take)((function(e,t){return C(e,t)&&P(e,t)?t:void 0})),A=(0,c.apply)((0,c.tuple)((0,c.any)(k,(0,c.withState)((function(e){return e.cellRefMustBeCellRefNode?T:(0,c.left)(T,(0,c.fails)((0,c.any)(f.parseIdentContinue,f.parseDotSepTokenNotFollowedByLeftBracket)))}))),f.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=r.kind===l.TokenKind.CellRef?E(r,(0,p.addSpan)(e,r.start,n,"","")):(0,o.cellRefError)((0,p.addSpan)(e,r.start,n,"","")),a=r.kind===l.TokenKind.CellRef?r.chars:void 0;return(0,d.maybeWSFTerm)((0,o.cellRefNode)(i,void 0,(0,p.addSpan)(e,r.start,n,"","")),a)}));var N=(0,c.takePeek)((function(e,t,r){return t.kind!==l.TokenKind.CellRef||!y(e,t)||function(e,t,r){return r.kind===l.TokenKind.Left&&r.value===l.DelimId.Paren&&t.isIdentContinue&&null!=(0,m.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start]})),_=(0,c.bind)((0,c.tuple)(N,f.parseSpacesOnly,f.parseRangeOp,f.parseSpacesOnly,N),(function(e,t){var r=t[0],n=r[0],i=r[1],a=t[1],s=(t[2],t[3]),u=t[4],m=u[0],f=u[1],g=(0,p.addSpan)(e,n.start,i,"",a),h=(0,p.addSpan)(e,m.start,f,s,""),v=E(n,g),S=E(m,h),y=void 0;if(v.kind===o.CellRefKind.Single&&S.kind===o.CellRefKind.Single){var F=(0,p.addSpan)(e,n.start,f,"","");y=(0,o.cellRefRange)(v,S,F)}else if(0===a.length&&0===s.length)if(v.kind===o.CellRefKind.Row&&S.kind===o.CellRefKind.Row){var C=v.isBracketed||S.isBracketed;F=(0,p.addSpan)(e,n.start,f,"","");y=(0,o.cellRefRow)(v.row1,S.row1,C,F)}else if(v.kind===o.CellRefKind.Col&&S.kind===o.CellRefKind.Col){C=v.isBracketed||S.isBracketed,F=(0,p.addSpan)(e,n.start,f,"","");y=(0,o.cellRefCol)(v.col1,S.col1,C,F)}if(null==y)return(0,c.parseFail)();var R=(0,d.maybeWSFTerm)((0,o.cellRefNode)(y,void 0,(0,p.addSpan)(e,n.start,f,"","")),void 0);return n.isIdentContinue&&m.isIdentContinue?(0,c.peek)((function(e,t){return t.kind===l.TokenKind.Sep&&t.value===l.SepId.Qual?void 0:R})):(0,c.parseSucceed)(R)})),I=(0,c.any)(_,A);t.parseUnqualBadRef=(0,c.apply)((0,c.take)((function(e,t){return t.kind===l.TokenKind.CellRef?t:void 0})),(function(e,t){var r=t.start+t.chars.length,n=t.refStyle===o.RefStyle.R1C1&&!t.isIdentContinue;return(0,d.maybeWSFTerm)((0,o.cellRefNode)((0,o.cellRefBad)(t.chars,n,(0,p.addSpan)(e,t.start,r,"","")),void 0,(0,p.addSpan)(e,t.start,r,"","")),t.chars)}));var O=(0,c.take)((function(e,t){return t.kind===l.TokenKind.Ident&&e.localeInfo.isIdentStart((0,v.stringCodePointAt)(t.chars,0))||t.kind===l.TokenKind.CellRef&&P(e,t)?t:void 0})),M=(0,c.take)((function(e,t){return t.kind===l.TokenKind.Literal&&t.oper.kind===h.OperKind.Boolean?t:void 0})),D=(0,c.any)(O,(0,c.left)(M,(0,c.succeeds)(f.parseDotSepTokenNotFollowedByLeftBracket))),w=(0,c.peek)((function(e,t){return(0,f.isLeftBracketToken)(t)})),L=(0,c.tuple)((0,c.many1)(D,f.parseIdentContinue),(0,c.many)((0,c.any)(f.parseIdentContinue,f.parseDotSepTokenNotFollowedByLeftBracket)),w,f.parseCharIndex),x=(0,c.apply)(L,(function(e,t){var r,i,s,c,m,f,g,h,v,C,R=t[0],b=t[1],P=t[2],k=t[3],T=R[0],A=1===R.length&&(null===(r=b[0])||void 0===r?void 0:r.kind)===l.TokenKind.Sep,N=T.kind!==l.TokenKind.CellRef||(C=T).refStyle===o.RefStyle.A1&&null==C.row&&"object"==typeof C.col&&C.col.kind===o.PosKind.Rel||function(e,t){return t.refStyle===o.RefStyle.A1&&e.refStyle===o.RefStyle.A1&&t.isIdentContinue||t.refStyle===o.RefStyle.R1C1&&(0,u.isR1C1IdentStart)(t.row,t.col)}(e,T)&&A;if(P||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===l.TokenKind.Literal||r.some((function(t,r){return r%2==0?t.kind!==l.TokenKind.Sep:t.kind===l.TokenKind.Sep||!(0,S.isUnbracketedField)(e.localeInfo,t.chars)}))}(e,R,b)){var _=n.__spreadArray(n.__spreadArray([],R,!0),b,!0).map((function(e){return e.chars})).join(""),I=(0,p.addSpan)(e,T.start,k,"",""),O=(0,p.addSpan)(e,T.start,k,"",""),M=(0,o.identNamePart)(_,N,I,O),D=(0,o.nameNode)(M,void 0,(0,p.addSpan)(e,T.start,k,"",""));return(0,d.maybeWSFTerm)(D,D.whole)}var w,L=N,x=0,K=null!==(s=null===(i=b[x])||void 0===i?void 0:i.start)&&void 0!==s?s:k,U=(0,p.addSpan)(e,T.start,K,"",""),B=(0,p.addSpan)(e,T.start,K,"","");if(1===R.length&&T.kind===l.TokenKind.CellRef)if(y(e,T))if(F(T)){var W=E(T,(0,p.addSpan)(e,T.start,K,"",""));w=(0,o.cellRefNamePart)(W,T.chars,U,B)}else w=(0,o.identNamePart)(T.chars,L,U,B);else L=!1,w=(0,o.identNamePart)(T.chars,L,U,B);else{var G=R.map((function(e){return e.chars})).join("");(0===e.localeInfo.stringCompareCI(G,"_xlpm")||0===e.localeInfo.stringCompareCI(G,"_xleta"))&&x+1<b.length&&(G+="."+b[x+1].chars,K=null!==(m=null===(c=b[x+=2])||void 0===c?void 0:c.start)&&void 0!==m?m:k,U=(0,p.addSpan)(e,T.start,K,"",""),B=(0,p.addSpan)(e,T.start,K,"","")),w=(0,o.identNamePart)(G,L,U,B)}for(var V=w;x+1<b.length;x+=2){var j=b[x],q=b[x+1],H=null!==(g=null===(f=b[x+2])||void 0===f?void 0:f.start)&&void 0!==g?g:k;V=(0,o.fieldRefNamePart)(V,(0,o.fieldRef)((0,o.identNode)(q.chars,(0,p.addSpan)(e,q.start,H,"","")),!1,!0,!1,(0,p.addSpan)(e,j.start,H,"","")),x+2>=b.length?N:L,(0,p.addSpan)(e,T.start,H,"",""),(0,p.addSpan)(e,T.start,H,"",""))}if(x<b.length){j=b[x],H=null!==(v=null===(h=b[x+1])||void 0===h?void 0:h.start)&&void 0!==v?v:k;var z=(0,o.fieldRef)((0,o.missingNode)("",(0,p.addSpan)(e,H,H,"","")),!1,!0,!1,(0,p.addSpan)(e,j.start,H,"",""));V=(0,o.fieldRefNamePart)(V,z,N,(0,p.addSpan)(e,T.start,H,"",""),(0,p.addSpan)(e,T.start,H,"","")),x+=1}(0,a.assertTrue)("calc.parse.pUnqualName: i == tailTokens",x===b.length),V.kind===o.NamePartKind.CellRefNamePart&&(0,a.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var Q=(0,o.nameNode)(V,void 0,(0,p.addSpan)(e,T.start,k,"",""));return(0,d.maybeWSFTerm)(Q,Q.whole)})),K=(0,c.opt)((0,c.any)(I,x,t.parseUnqualBadRef),{node:void 0}),U=(0,c.any)(I,(0,c.right)((0,c.fails)(x),t.parseUnqualBadRef));var B=(0,c.bind)(g.parseQualifier,(function(e,t){var r=t[0],n=t[1];return(0,c.apply)(r.kind===o.QualifierKind.SheetRange?(0,p.cellRefMustBeCellRefNode)(r.isQuoted?K:U):r.kind===o.QualifierKind.Error?(0,p.cellRefMustBeCellRefNode)(K):K,(function(e,t){var i=t.node;if(null==i)return r.kind===o.QualifierKind.Error?(0,o.literalNode)(s.refErrorOper,!0,r.label):(0,o.badCharsNode)(o.BadType.Qualifier,n,r.label);var u=(0,p.getNodeSpan)(e,r).start,l=(0,p.getNodeSpan)(e,i).end;if(i.kind===o.NodeKind.Name){var c=(0,p.addSpan)(e,u,l,"","");if(r.kind===o.QualifierKind.Error){var d=(0,o.literalNode)(s.refErrorOper,!0,r.label);return(0,o.badSequenceNode)(o.BadType.Unexpected,[d,i],c)}return(0,a.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",r.kind!==o.QualifierKind.SheetRange||r.isQuoted),r.kind===o.QualifierKind.SheetRange&&void 0===r.document&&(r=(0,o.identQualifier)("".concat(r.sheet1,":").concat(r.sheet2),r.isQuoted,r.label)),(0,o.nameNode)(function(e,t,r){for(var n=t;;){if((0,p.getSpan)(e,n.qualifiedLabel).start=r,n.kind!==o.NamePartKind.FieldRefNamePart)break;n=n.lhs}return t}(e,i.parts,u),r,c)}var m=(0,p.addSpan)(e,u,l,"","");return r.kind===o.QualifierKind.Ident&&(r=(0,o.sheetQualifier)(r.name,void 0,r.isQuoted,r.label)),(0,o.cellRefNode)(i.ref,r,m)}))})),W=(0,c.apply)((0,c.any)(I,x),(function(e,t){return t.node.kind===o.NodeKind.CellRef&&t.node.ref.kind===o.CellRefKind.Error?(0,o.literalNode)(s.refErrorOper,!0,t.node.label):t}));t.parseRef=(0,c.any)(B,W)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;var n=r(0),i=r(33),a=r(63),o=r(73),s=r(58),u=r(52),l=n.__importStar(r(108)),c=r(56),d=r(241),p=r(41);function m(e){return e.kind===u.TokenKind.Literal&&e.oper.kind===c.OperKind.Boolean}var f=l.codePointFullStop,g=(0,a.opt)((0,a.takePeek)((function(e,t,r){return t.kind!==u.TokenKind.Spaces||(0,s.isWhitespaceToken)(r)?void 0:t.chars})),""),h=(0,a.take)((function(e,t){return t.isIdentContinue&&!m(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==f?t.chars:void 0})),v=(0,a.take)((function(e,t){return t.isIdentContinue||(0,s.isDotSepToken)(t)?t.chars:void 0})),S=(0,a.apply)((0,a.many1)(h,v),(function(e,t){return t.join("")})),y=(0,a.take)((function(e,t){return t.kind===u.TokenKind.Ident?t.chars:void 0})),F=function(e,t){var r;return(null!==(r=t.path)&&void 0!==r?r:"")+e.leftBracket+t.document+e.rightBracket};function C(e,t,r,n,a,o){var s,u;if(null==t)null==n?(s=(0,i.identQualifier)(r,a,o),u=r):(s=(0,i.sheetRangeQualifier)(r,n,void 0,a,o),u="".concat(r,":").concat(n));else{var l=F(e.localeInfo,t);null==n?(s=(0,i.sheetQualifier)(r,t,a,o),u="".concat(l).concat(r)):(s=(0,i.sheetRangeQualifier)(r,n,t,a,o),u="".concat(l).concat(r,":").concat(n))}return[s,a?(0,d.quoteQualifier)(u):u]}var R=(0,a.take)((function(e,t){return t.kind===u.TokenKind.Ident||(0,s.isRangeOpToken)(t)?t.chars:void 0})),b=(0,a.apply)((0,a.tuple)(s.parseCharIndex,(0,a.many)(R),s.parseLeftBracket,(0,a.many1)(R),s.parseRightBracket,s.parseCharIndex),(function(e,t){var r=t[0],n=t[1],a=(t[2],t[3]),s=(t[4],t[5]),u=n.join(""),l=a.join("");return(0,i.documentQualifier)(l,""!==u?u:void 0,!0,(0,o.addSpan)(e,r,s,"",""))})),E=(0,a.apply)((0,a.tuple)(s.parseCharIndex,s.parseLeftBracket,(0,a.many1)(v),s.parseRightBracket,s.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),a=(t[3],t[4]),s=n.join("");return(0,i.documentQualifier)(s,void 0,!1,(0,o.addSpan)(e,r,a,"",""))})),P=(0,a.apply)((0,a.tuple)(s.parseCharIndex,(0,a.opt)(E,void 0),S,(0,a.opt)((0,a.right)(s.parseRangeOp,S),void 0),s.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4];return C(e,n,i,a,!1,(0,o.addSpan)(e,r,s,"",""))})),k=(0,a.apply)((0,a.tuple)(s.parseLeftSQuote,(0,a.opt)(b,void 0),y,(0,a.opt)((0,a.right)(s.parseRangeOp,y),void 0),s.parseRightSQuote,s.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=(t[4],t[5]);return C(e,n,i,a,!0,(0,o.addSpan)(e,r.start,s,"",""))})),T=(0,a.apply)(E,(function(e,t){return[t,F(e.localeInfo,t)]})),A=(0,a.apply)((0,a.tuple)(s.parseLeftSQuote,b,s.parseRightSQuote,s.parseCharIndex),(function(e,t){var r=t[0],n=t[1],a=(t[2],t[3]);return[(0,i.documentQualifier)(n.document,n.path,!0,(0,o.addSpan)(e,r.start,a,"","")),(0,d.quoteQualifier)(F(e.localeInfo,n))]})),N=(0,a.take)((function(e,t){return t.kind===u.TokenKind.End||t.kind===u.TokenKind.Right&&t.value===u.DelimId.SQuote?void 0:t.chars})),_=(0,a.apply)((0,a.tuple)(s.parseLeftSQuote,(0,a.many)(N),(0,a.opt)((0,a.tuple)(s.parseRightSQuote,(0,a.opt)((0,a.tuple)(s.parseQualSep,g),[void 0,""])),[void 0,[void 0,""]]),s.parseCharIndex),(function(e,t){var r=t[0],n=t[1],a=t[2],s=a[0],u=a[1],l=u[0],c=u[1],d=t[3],p=void 0!==s,m=void 0!==l,f="'".concat(n.join("")).concat(p?"'":"").concat(m?"!":""),g=(0,o.addSpan)(e,r.start,d-c.length,"",c);return[(0,i.badQualifier)(f,!0,p,m,g),f]})),I=(0,a.takePeek)((function(e,t,r){if((0,s.isRefErrorToken)(t)){var n=(0,o.addSpan)(e,t.start,r.start,"","");return[(0,i.errorQualifier)(n),t.chars]}})),O=(0,a.peek)((function(e,t){var r=(0,o.addSpan)(e,t.start,t.start,"","");return[(0,i.relativeQualifier)(r),""]})),M=(0,a.apply)((0,a.tuple)((0,a.any)(P,k,T,A,O),s.parseQualSep,g),(function(e,t){var r=t[0],n=r[0],i=r[1],a=t[1],s=t[2],u=(0,o.getNodeSpan)(e,n);return u.end+=1,(0,p.assertTrue)("calc.parse.parseGoodQualifier",u.end===a.start+a.chars.length),(0,p.assertTrue)("calc.parse.parseGoodQualifier",0===u.post.length),u.post=s,[n,"".concat(i,"!")]})),D=(0,a.take)((function(e,t){return t.isIdentContinue||(0,s.isDotSepToken)(t)||m(t)||function(e){return e.kind===u.TokenKind.Literal&&(0,u.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0})),w=(0,a.apply)((0,a.tuple)(s.parseCharIndex,(0,a.many)(D),s.parseQualSep,s.parseCharIndex,g),(function(e,t){var r=t[0],n=t[1],a=(t[2],t[3]),s=t[4],u="".concat(n.join(""),"!"),l=(0,o.addSpan)(e,r,a,"",s);return[(0,i.badQualifier)(u,!1,!0,!0,l),u]}));t.parseQualifier=(0,a.any)(I,M,w,_)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;var n=r(33),i=r(52),a=r(63),o=r(91),s=r(73),u=r(58),l=r(57),c=r(62),d=r(56);var p=(0,a.take)((function(e,t){return t.kind===i.TokenKind.Literal&&t.oper.kind!==d.OperKind.Boolean?t:t.kind===i.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===n.PosKind.Rel}(t)?(0,i.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0})),m=(0,a.take)((function(e,t){return t.kind===i.TokenKind.Literal&&t.oper.kind===d.OperKind.Boolean?t:void 0}));t.parseLiteral=(0,a.apply)((0,a.tuple)((0,a.any)(p,(0,a.left)(m,(0,a.fails)(u.parseDotSepTokenNotFollowedByLeftBracket))),u.parseCharIndex),(function(e,t){var r=t[0],a=t[1],u=(0,s.addSpan)(e,r.start,a,"","");if((0,i.isBadNumberOper)(r.oper))return(0,n.badCharsNode)(n.BadType.NumberLiteral,r.chars,u);if((0,i.isBadErrorOper)(r.oper))return(0,n.badCharsNode)(n.BadType.ErrorLiteral,r.chars,u);if((0,c.isStringOper)(r.oper)&&r.oper.value.length>l.cellStringLimit)return(0,n.badCharsNode)(n.BadType.StringLiteral,r.chars,u);var d=(0,n.literalNode)(r.oper,r.hasRight,u);return(0,c.isBooleanOper)(r.oper)?(0,o.maybeWSFTerm)(d,r.chars):d}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;var n=r(0),i=r(63),a=r(91),o=r(58),s=r(33),u=r(73),l=r(52),c=r(43),d=(0,i.take)((function(e,t){return t.isIdentContinue||t.kind===l.TokenKind.Spaces?t:void 0})),p=(0,i.apply)((0,i.many1)(d),(function(e,t){var r=t[0];return 1===t.length?r:(0,l.identToken)(r.start,t.map((function(e){return e.kind===l.TokenKind.Escape?"":e.chars})).join(""))})),m=(0,i.take)((function(e,t){return t.isIdentContinue||t.kind===l.TokenKind.Spaces||t.kind===l.TokenKind.Escape||(0,o.isListSepToken)(t)||(0,o.isRangeOpToken)(t)?t:void 0})),f=(0,i.apply)((0,i.many1)(m),(function(e,t){var r=t[0];return 1===t.length?r:(0,l.identToken)(r.start,t.map((function(e){return e.kind===l.TokenKind.Escape?"":e.chars})).join(""))})),g=(0,i.take)((function(e,t){return t.kind===l.TokenKind.SpecialRef?t:void 0})),h=(0,i.apply)((0,i.tuple)(o.parseCharIndex,g,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.specialRef)(n.value,!1,!0,(0,u.addSpan)(e,r,i,"",""))})),v=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseLeftBracket,g,(0,i.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],a=t[4];return(0,s.specialRef)(n.value,!0,void 0!==i,(0,u.addSpan)(e,r,a,"",""))})),S=(0,i.any)(h,v),y=(0,i.apply)((0,i.tuple)(o.parseCharIndex,p,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.columnRef)(n.chars,!1,!0,(0,u.addSpan)(e,r,i,"",""))})),F=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseLeftBracket,(0,i.opt)(f,void 0),(0,i.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(function(e,t){var r,n=t[0],i=(t[1],t[2]),a=t[3],o=t[4];return(0,s.columnRef)(null!==(r=null==i?void 0:i.chars)&&void 0!==r?r:"",!0,void 0!==a,(0,u.addSpan)(e,n,o,"",""))})),C=(0,i.apply)((0,i.tuple)(o.parseCharIndex,f,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.columnRef)(n.chars,!1,!0,(0,u.addSpan)(e,r,i,"",""))})),R=(0,i.any)(y,F),b=(0,i.apply)(o.parseCharIndex,(function(e,t){return(0,s.missingRef)((0,u.addSpan)(e,t,t,"",""))})),E=(0,i.any)(R,b),P=(0,i.take)((function(e,t){return"#"===t.chars?t:void 0})),k=(0,i.apply)((0,i.many1)(P,d),(function(e,t){return(0,l.unexpectedToken)(t[0].start,t.map((function(e){return e.chars})).join(""))})),T=(0,i.apply)((0,i.many1)(P,m),(function(e,t){return(0,l.unexpectedToken)(t[0].start,t.map((function(e){return e.chars})).join(""))})),A=(0,i.apply)((0,i.tuple)(o.parseCharIndex,k,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.badRef)(n.chars,!1,!0,(0,u.addSpan)(e,r,i,"",""))})),N=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseLeftBracket,T,(0,i.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],a=t[4];return(0,s.badRef)(n.chars,!0,void 0!==i,(0,u.addSpan)(e,r,a,"",""))})),_=(0,i.any)(A,N),I=(0,i.apply)((0,i.tuple)(o.parseCharIndex,E,o.parseRangeOp,E,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=(t[2],t[3]),a=t[4];return(0,s.rangeOpRef)(n,i,(0,u.addSpan)(e,r,a,"",""))})),O=(0,i.any)(I,R),M=(0,i.any)(S,_,I,R,b),D=(0,i.apply)((0,i.tuple)(o.parseCharIndex,M,(0,i.many1)((0,i.tuple)(o.parseListSep,M)),o.parseCharIndex),(function(e,t){var r=t[0],i=t[1],a=t[2],o=t[3];return(0,s.commaOpRef)(n.__spreadArray([i],a.map((function(e){e[0];return e[1]})),!0),(0,u.addSpan)(e,r,o,"",""))})),w=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseAtOp,(0,i.opt)(O,void 0),o.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3];return(0,s.thisRowOpRef)(n,(0,u.addSpan)(e,r,i,"",""))})),L=(0,i.apply)(o.parseSpacesOnly,(function(){})),x=(0,i.any)((0,i.left)(L,o.parseEnd),(0,i.left)(C,o.parseEnd),(0,i.left)(D,o.parseEnd),(0,i.left)(w,o.parseEnd),(0,i.left)(I,o.parseEnd),(0,i.left)(S,o.parseEnd),(0,i.left)(_,o.parseEnd),(0,i.left)(F,o.parseEnd));t.parseStructRef=(0,i.applyTake)((0,i.tuple)(o.parseCharIndex,o.parseBracketedTokens,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],o=n[0],l=n[1],d=t[2],p=(0,i.runParser)(x,o,0,e);return(0,c.isSuccess)(p)?(0,a.structRefTerm)((0,s.structRef)(p.value.output,l,(0,u.addSpan)(e,r,d,"","")),r,d):void 0}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;var n,i=r(0),a=r(41),o=r(52),s=r(57),u=r(132),l=r(415),c=r(107),d=r(33),p=r(250),m=r(90),f=i.__importStar(r(108)),g=r(168),h=r(131),v=r(58),S=f.codePointAsterisk,y=f.codePointAtSign,F=f.codePointColon,C=f.codePointDoubleQuote,R=f.codePointExclamationMark,b=f.codePointHash,E=f.codePointLeftParen,P=f.codePointQuestionMark,k=f.codePointRightParen,T=f.codePointSingleQuote,A=f.codePointFullStop,N=f.codePointDigitZero,_=f.codePointSlash,I=f.codePointMinusSign,O=f.codePointSpace,M=f.codePointInvertedExclamationMark,D=f.codePointInvertedQuestionMark,w=f.codePointLeftSingleQuotationMark,L=f.codePointRightSingleQuotationMark;function x(e){if(!n){n=(0,c.makeStringMap)();for(var t=0,r=Object.getOwnPropertyNames(K);t<r.length;t++){var i=r[t];n[i.charCodeAt(0)]=!0}for(var a=0,o=Object.getOwnPropertyNames(U);a<o.length;a++){var s=o[a];n[s.charCodeAt(0)]=!0}}return!0===n[e]}var K={"+":o.addOperatorToken,"-":o.subOperatorToken,"*":o.mulOperatorToken,"/":o.divOperatorToken,"^":o.powOperatorToken,"%":o.percentOperatorToken,"&":o.concatOperatorToken,"=":o.eqOperatorToken,"<":o.ltOperatorToken,">":o.gtOperatorToken,":":o.rangeOperatorToken,".":o.dotSepToken,"@":o.atOperatorToken,"#":o.poundOperatorToken},U={"<>":o.neOperatorToken,"<=":o.leOperatorToken,">=":o.geOperatorToken};function B(e,t,r){if(t<e.length-1){var n=U[e.substring(t,t+2)];if(null!=n)return(0,o.appendToken)(2,n(t),r)}var i=K[e.charAt(t)];if(null!=i)return(0,o.appendToken)(1,i(t),r);return(0,a.assertFalse)("calc.parse.tokenizeOperator: internal error: expected operator")}function W(e,t,r,n,i){var a=(0,l.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0!==a){var s=a.value,u=a.i,c=r.substring(n,u);return(0,o.appendToken)(u-n,(0,o.literalToken)(n,c,null!=s?s:o.badNumberOper,!0),i),u}}var G=function(e,t){return e.charCodeAt(t)!==C},V=function(e,t){return e.charCodeAt(t)===C};function j(e,t,r){var n=(0,p.scanEscapedWhile)(e,t+1,G,'"',V),i=n[0],a=n[1],u=e.substring(t,a+1);return a<e.length?(0,o.appendToken)(a+1-t,(0,o.literalToken)(t,u,(0,s.stringOper)(i),!0),r):(0,o.appendToken)(a-t,(0,o.literalToken)(t,u,(0,s.stringOper)(i),!1),r)}function q(e,t,r,n){for(var i=1;i<e.errorNames.length;i+=1){var a=e.errorNames[i];if(null!=a){var u=t.substring(r,r+a.length);if(0===e.stringCompareCI(a,u))return(0,o.appendToken)(a.length,(0,o.literalToken)(r,u,(0,s.errorOper)(i)),n)}}for(var l=r+1,c=!1;l<t.length;){var d=(0,m.stringCodePointAt)(t,l);if(l!==r+1||d!==M&&d!==D)if(!(l>r+1)||d!==_&&d!==I&&d!==O||c)if(l>r+1&&d===A)l+=1;else{if(l>r+1&&d===N){(l+=1)<t.length&&t.charCodeAt(l)===R&&(l+=1);break}if(d===R||d===P){l!==r+1&&(l+=1);break}if(!e.isIdentContinue(d)||e.isNumeral(d)){if(d!==w&&d!==L)break;l+=1}else l+=(0,m.numCodeUnits)(d)}else c=!0,l+=1;else l+=1}for(;l>r+1&&t.charCodeAt(l-1)===O;)--l;if(l>r+1){u=t.substring(r,l);return(0,o.appendToken)(l-r,(0,o.literalToken)(r,u,o.badErrorOper),n)}}function H(e,t,r,n){for(var i=1;i<e.specialRefNames.length;i+=1){var a=e.specialRefNames[i];if(null!=a){var s=t.substring(r,r+a.length);if(0===e.stringCompareCI(a,s))return(0,o.appendToken)(a.length,(0,o.specialRefToken)(r,s,i),n)}}}function z(e,t,r){var n=t.charCodeAt(r);return!((0,l.isSpace)(n)||n===T||n===b||n===F||n===y||(0,g.stringStartsWith)(t,e.listSeparator,r)||(0,g.stringStartsWith)(t,e.leftBracket,r)||(0,g.stringStartsWith)(t,e.rightBracket,r))}var Q=function(e,t){return(0,l.isSpace)((0,m.stringCodePointAt)(e,t))},Y=function(e,t){return!(0,l.isLineBreak)((0,m.stringCodePointAt)(e,t))},J=function(e,t){return!(t+1<e.length&&e.charCodeAt(t)===S&&e.charCodeAt(t+1)===_)};function $(e,t,r,n){for(var i=r,a=0,s=function(t,r){return z(e,t,r)},u=function(t,r){return!z(e,t,r)},c=(0,p.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",i);i<t.length;){c(i);var d=(0,m.stringCodePointAt)(t,i);if(n.length>0&&n[n.length-1].kind===o.TokenKind.Escape&&u(t,i))i=(0,o.appendToken)((0,m.numCodeUnits)(d),(0,o.identToken)(i,(0,m.stringFromCodePoint)(d)),n);else if(d!==y){if(d===b)if(null!=(v=H(e,t,i,n))){i=v;continue}if(d!==T)if((0,g.stringStartsWith)(t,e.rightBracket,i)){if(i=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(i,e.rightBracket),n),0===(a-=1))return i}else if(s(t,i)){var f=(0,p.scanWhile)(t,i,s),h=f[0],v=f[1];i=(0,o.appendToken)(v-i,(0,o.identToken)(i,h),n)}else if((0,l.isSpace)(d)){var S=(0,p.scanWhile)(t,i,Q);h=S[0],v=S[1];i=(0,o.appendToken)(v-i,(0,o.spacesToken)(i,h),n)}else d!==F?(0,g.stringStartsWith)(t,e.listSeparator,i)?i=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(i,e.listSeparator),n):(0,g.stringStartsWith)(t,e.leftBracket,i)&&a<2?(i=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(i,e.leftBracket),n),a+=1):i=(0,o.appendToken)((0,m.numCodeUnits)(d),(0,o.unexpectedToken)(i,(0,m.stringFromCodePoint)(d)),n):i=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(i),n);else i=(0,o.appendToken)(1,(0,o.escapeToken)(i,"'"),n)}else i=(0,o.appendToken)(1,(0,o.atOperatorToken)(i),n)}return i}function X(e,t,r,n){for(var i=(0,o.appendToken)(1,(0,o.leftSQuoteToken)(r),n),a=function(t,r){return function(e,t,r){var n=t.charCodeAt(r);return n!==T&&n!==F&&n!==S&&n!==P&&!(0,g.stringStartsWith)(t,e.leftBracket,r)&&!(0,g.stringStartsWith)(t,e.rightBracket,r)}(e,t,r)},s=function(e,t){return e.charCodeAt(t)===T},u=(0,p.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){u(i);var l=(0,m.stringCodePointAt)(t,i);if(l===T&&!(i+1<t.length&&t.charCodeAt(i+1)===T))return(0,o.appendToken)(1,(0,o.rightSQuoteToken)(i),n);if(l!==F)if((0,g.stringStartsWith)(t,e.leftBracket,i))i=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(i,e.leftBracket),n);else if((0,g.stringStartsWith)(t,e.rightBracket,i))i=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(i,e.rightBracket),n);else if((0,p.getEscapedSkip)(t,i,a,"'",s)>0){var c=(0,p.scanEscapedWhile)(t,i,a,"'",s),d=c[0],f=c[1];i=(0,o.appendToken)(f-i,(0,o.identToken)(i,d),n)}else i=(0,o.appendToken)((0,m.numCodeUnits)(l),(0,o.unexpectedToken)(i,(0,m.stringFromCodePoint)(l)),n);else i=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(i),n)}return i}function Z(e,t,r,n,i,a){var s=(0,u.parseCellRef)(e,t,r,n,i);if(null!=s){var l=s.i,c=n.substring(l,i),p=s.refStyle===d.RefStyle.A1?(0,o.cellRefA1Token)(i,c,s.row,s.col):(0,o.cellRefR1C1Token)(i,c,s.row,s.col,s.enLocale);return(0,o.appendToken)(l-i,p,a)}}function ee(e,t,r,n){var i=n.length-1,a=n[i];if(null==a)return!0;if(a.kind===o.TokenKind.Sep&&a.value===o.SepId.Dot)return!1;if((0,g.stringStartsWith)(t,e.decimalSeparator,r)){for(;null!=a&&(0,v.isWhitespaceToken)(a);)a=n[--i];return null==a||a.kind!==o.TokenKind.Ident&&a.kind!==o.TokenKind.CellRef&&a.kind!==o.TokenKind.Right&&(a.kind!==o.TokenKind.Literal||(0,o.isNumberLikeOper)(a.oper))}return e.isNumeral((0,m.stringCodePointAt)(t,r))}function te(e,t,r,n){for(var i=e[t],a=t+1;a<e.length;a+=1){var o=e[a];if(o.kind!==r)break;i=n(i,o)}return[i,a]}t.tokenizeFormula=function(e,t,r,n,i,s,u){for(var c=function(e,t,r,n,i,s,u){for(var c=[],f=[],v=s,y=!0===(null==u?void 0:u[d.SyntaxFeature.Comments]),F=!0===(null==u?void 0:u[d.SyntaxFeature.Statements]),P=!(0,g.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,g.stringStartsWith)(e.statementSeparator,e.rowSeparator),A=!(0,g.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,g.stringStartsWith)(e.statementSeparator,e.decimalSeparator),N=(0,p.makeProgressAsserter)("calc.parse.tokenize",v);v<i.length;){N(v);var I=Z(e,r,n,i,v,c);if(null==I){var O=(0,m.stringCodePointAt)(i,v),M=f.length>0&&f[f.length-1].delim===o.DelimId.Brace;if(ee(e,i,v,c)){var D=W(e,t,i,v,c);if(null!=D){v=D;continue}}if(O!==C)if(!e.isIdentContinue(O)||(0,g.stringStartsWith)(i,e.listSeparator,v)||M&&(0,g.stringStartsWith)(i,e.columnSeparator,v)||M&&(0,g.stringStartsWith)(i,e.rowSeparator,v))if(O!==b)if((0,l.isSpace)(O)){var w=(0,p.scanWhile)(i,v,Q),L=(ae=w[0],w[1]);v=(0,o.appendToken)(L-v,(0,o.spacesToken)(v,ae),c)}else if(O!==E)if(O!==k)if((0,g.stringStartsWith)(i,e.leftBrace,v))f.push({delim:o.DelimId.Brace,lastParen:f.length>0?f[f.length-1].lastParen:void 0,lastBrace:f.length}),v=(0,o.appendToken)(e.leftBrace.length,(0,o.leftBraceToken)(v,e.leftBrace),c);else if((0,g.stringStartsWith)(i,e.rightBrace,v)){var K=f.length>0?f[f.length-1].lastBrace:void 0;void 0!==K&&(f.length=K),v=(0,o.appendToken)(e.rightBrace.length,(0,o.rightBraceToken)(v,e.rightBrace),c)}else if((0,g.stringStartsWith)(i,e.leftBracket,v))v=$(e,i,v,c);else if((0,g.stringStartsWith)(i,e.rightBracket,v))v=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(v,e.rightBracket),c);else{if(M){if(F&&P&&(0,g.stringStartsWith)(i,e.statementSeparator,v))break;if((0,g.stringStartsWith)(i,e.columnSeparator,v)){v=(0,o.appendToken)(e.columnSeparator.length,(0,o.colSepToken)(v,e.columnSeparator),c);continue}if((0,g.stringStartsWith)(i,e.rowSeparator,v)){v=(0,o.appendToken)(e.rowSeparator.length,(0,o.rowSepToken)(v,e.rowSeparator),c);continue}}if(F&&(0,g.stringStartsWith)(i,e.statementSeparator,v)&&(A||0===f.length))break;if((0,g.stringStartsWith)(i,e.listSeparator,v))v=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(v,e.listSeparator),c);else if(O!==R)if(O!==T){if(O===_&&v+1<i.length&&y){var U=i.charCodeAt(v+1);if(U===_){var G=(0,p.scanWhile)(i,v,Y),V=(ae=G[0],G[1]);v=(0,o.appendToken)(V-v,(0,o.singleLineCommentToken)(v,ae),c);continue}if(U===S){var H=(0,p.scanWhile)(i,v+2,J),z=(ae=H[0],H[1]),te=(0,g.stringStartsWith)(i,"*/",z);(0,a.assertTrue)("calc.parse.tokenize: /**/",te||z===i.length),z+=te?2:0,ae="/*"+ae+(te?"*/":""),v=(0,o.appendToken)(z-v,(0,o.multiLineCommentToken)(v,ae,te),c);continue}}if(x(O)){if((0,g.stringStartsWith)(i,":=",v)&&(0,h.isFeatureEnabled)(h.FeatureName.CalcLambdaDefaultParameters)){v=(0,o.appendToken)(2,(0,o.assignSepToken)(v),c);continue}v=B(i,v,c)}else v=(0,o.appendToken)((0,m.numCodeUnits)(O),(0,o.unexpectedToken)(v,(0,m.stringFromCodePoint)(O)),c)}else v=X(e,i,v,c);else v=(0,o.appendToken)(1,(0,o.qualSepToken)(v),c)}else{var re=f.length>0?f[f.length-1].lastParen:void 0;void 0!==re&&(f.length=re),v=(0,o.appendToken)(1,(0,o.rightParenToken)(v),c)}else f.push({delim:o.DelimId.Paren,lastParen:f.length,lastBrace:f.length>0?f[f.length-1].lastBrace:void 0}),v=(0,o.appendToken)(1,(0,o.leftParenToken)(v),c);else{var ne=q(e,i,v,c);if(null!=ne){v=ne;continue}v=B(i,v,c)}else{var ie=(0,p.scanWhile)(i,v,(function(t,r){return e.isIdentContinue((0,m.stringCodePointAt)(t,r))})),ae=ie[0],oe=ie[1];v=(0,o.appendToken)(oe-v,(0,o.identOrBooleanToken)(e,v,ae),c)}else v=j(i,v,c)}else v=I}return[c,v]}(e,t,r,n,i,s,u),f=c[0],v=c[1],y=[],F=0;F<f.length;){var P=f[F];if(P.kind!==o.TokenKind.Unexpected)y.push(P),F+=1;else{var A=te(f,F,o.TokenKind.Unexpected,(function(e,t){var r=e,n=t;return(0,o.unexpectedToken)(r.start,r.chars+n.chars)})),N=A[0],I=A[1];y.push(N),F=I}}return y.push((0,o.endToken)(v)),y}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanEscapedWhile=t.getEscapedSkip=t.scanWhile=t.makeProgressAsserter=void 0;var n=r(41),i=r(90),a=r(168);function o(e,t,r,n,i){return r(e,t)?1:(0,a.stringStartsWith)(e,n,t)&&t+n.length<e.length&&i(e,t+n.length)?2:0}t.makeProgressAsserter=function(e,t){var r=t-1;return function(t){if(t<=r){var i="".concat(e,": internal error: no progress made at index ").concat(t);return(0,n.assertFalse)(i)}r=t}},t.scanWhile=function(e,t,r){for(var n=t;n<e.length&&r(e,n);)n+=(0,i.numCodeUnits)((0,i.stringCodePointAt)(e,n));return[e.substring(t,n),n]},t.getEscapedSkip=o,t.scanEscapedWhile=function(e,t,r,n,a){for(var s=[],u=t,l=t;l<e.length;){var c=o(e,l,r,n,a);if(0===c)break;2===c&&(u!==l&&s.push(e.substring(u,l)),u=l+n.length,l+=n.length),l+=(0,i.numCodeUnits)((0,i.stringCodePointAt)(e,l))}return u!==l&&s.push(e.substring(u,l)),[s.join(""),l]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.spillErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(3);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.spillErrorOper=n.value.spillErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;var n=r(3);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormat=t.evalFormatImpl=void 0;var a=r(0),o=r(66),s=r(59),u=r(417),l=r(64),c=r(418),d=r(419),p=r(254),m=r(175),f=r(112),g=r(65),h=r(53),v=r(420),S=r(421),y=(0,f.typedInstanceCreator)()((function(e,t,r,n){return{strong:e,format:t,valueType:r,decimals:n}})),F={},C=(0,s.createFailureErrorClass)("InferenceError"),R={getDocumentLoc:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex")},getSheetName:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getSheetName")},getNameLoc:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes")},getCellFormat:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getCellFormat")},getKnownFormat:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat")},getIformat:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getIformat")},getFormatString:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getFormatString")},getContainingTable:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getContainingTable")},getStructRefColumn:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")}};function b(e,t){var r,n,i=function(e){var t,r,n,i,a,o,s,u,l,c,d,p,m,f,g,h,v,S,y,F,C,b,E,P,k,T;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:R.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:R.getSheetIndex,getSheetName:null!==(o=null===(a=e.getSheetName)||void 0===a?void 0:a.bind(e))&&void 0!==o?o:R.getSheetName,getNameLoc:null!==(u=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==u?u:R.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(l=e.getUserDefinedFuncLoc)||void 0===l?void 0:l.bind(e))&&void 0!==c?c:R.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(p=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==p?p:R.getSheetRangeIndexes,getCellFormat:null!==(f=null===(m=e.getCellFormat)||void 0===m?void 0:m.bind(e))&&void 0!==f?f:R.getCellFormat,getKnownFormat:null!==(h=null===(g=e.getKnownFormat)||void 0===g?void 0:g.bind(e))&&void 0!==h?h:R.getKnownFormat,getIformat:null!==(S=null===(v=e.getIformat)||void 0===v?void 0:v.bind(e))&&void 0!==S?S:R.getIformat,getFormatString:null!==(F=null===(y=e.getFormatString)||void 0===y?void 0:y.bind(e))&&void 0!==F?F:R.getFormatString,getContainingTable:null!==(b=null===(C=e.getContainingTable)||void 0===C?void 0:C.bind(e))&&void 0!==b?b:R.getContainingTable,getStructRefColumn:null!==(P=null===(E=e.getStructRefColumn)||void 0===E?void 0:E.bind(e))&&void 0!==P?P:R.getStructRefColumn,getStructRefSpecialRef:null!==(T=null===(k=e.getStructRefSpecialRef)||void 0===k?void 0:k.bind(e))&&void 0!==T?T:R.getStructRefSpecialRef}}(e);return{globals:i,locals:t,config:e.config,localeInfo:null!==(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo)&&void 0!==n?n:e.config.localeInfo,mathpack:e.config.mathpack,get document(){var e=t.originSheet;if(!(0,h.isSuccess)(e))throw new C(e);return e.value.document},get defaultFormat(){var e=_(this,g.KnownFormat.General);return y(!1,e,e.valueType,e.decimals)},get unitlessFormat(){var e=_(this,g.KnownFormat.General);return y(!0,e,e.valueType,e.decimals)},resolver:(0,d.createResolver)(i),multOrDivTainted:!1}}var E,P=((n={})[l.FormatValueType.General]=0,n[l.FormatValueType.Number]=1,n[l.FormatValueType.Currency]=2,n[l.FormatValueType.Accounting]=2,n[l.FormatValueType.Percentage]=3,n[l.FormatValueType.Date]=4,n[l.FormatValueType.Time]=5,n[l.FormatValueType.Fraction]=6,n[l.FormatValueType.Scientific]=7,n[l.FormatValueType.Text]=8,n[l.FormatValueType.Custom]=9,n);!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(E||(E={}));var k=((i={})[p.WorksheetFuncId.INT]=E.Propagate,i[p.WorksheetFuncId.MOD]=E.Propagate,i[p.WorksheetFuncId.ROUND]=E.Propagate,i[p.WorksheetFuncId.SUM]=E.Propagate,i[p.WorksheetFuncId.TRUNC]=E.Propagate,i[p.WorksheetFuncId.AVERAGE]=E.Propagate,i[p.WorksheetFuncId.MAX]=E.Propagate,i[p.WorksheetFuncId.MEDIAN]=E.Propagate,i[p.WorksheetFuncId.MIN]=E.Propagate,i[p.WorksheetFuncId.ROUNDUP]=E.Propagate,i[p.WorksheetFuncId.ROUNDDOWN]=E.Propagate,i[p.WorksheetFuncId.NPV]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.PV]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.FV]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.PMT]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.RATE]=g.KnownFormat.Pct0,i[p.WorksheetFuncId.MIRR]=g.KnownFormat.Pct0,i[p.WorksheetFuncId.IRR]=g.KnownFormat.Pct0,i[p.WorksheetFuncId.DATE]=g.KnownFormat.MMDDYY,i[p.WorksheetFuncId.TIME]=g.KnownFormat.HHMMAP,i[p.WorksheetFuncId.NOW]=g.KnownFormat.MDYHMS,i[p.WorksheetFuncId.SLN]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.SYD]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.DDB]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.IPMT]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.PPMT]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.TODAY]=g.KnownFormat.MMDDYY,i[p.WorksheetFuncId.VDB]=g.KnownFormat.CoCurrencyDec,i[p.WorksheetFuncId.DB]=g.KnownFormat.CoCurrencyDec,i);var T=[[l.FormatValueType.General,l.FormatValueType.Number,l.FormatValueType.Currency,l.FormatValueType.Percentage,l.FormatValueType.Date,l.FormatValueType.Time,l.FormatValueType.Fraction,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.Number,l.FormatValueType.Currency,l.FormatValueType.Percentage,l.FormatValueType.Date,l.FormatValueType.Time,l.FormatValueType.Number,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Currency,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Currency,l.FormatValueType.Currency,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Percentage,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Percentage,l.FormatValueType.Percentage,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Date,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Time,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Fraction,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Custom]],A=[[l.FormatValueType.General,l.FormatValueType.Number,l.FormatValueType.Currency,l.FormatValueType.General,l.FormatValueType.Date,l.FormatValueType.Time,l.FormatValueType.Fraction,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.Number,l.FormatValueType.Currency,l.FormatValueType.Number,l.FormatValueType.Date,l.FormatValueType.Time,l.FormatValueType.Fraction,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Currency,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Currency,l.FormatValueType.Currency,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Percentage,l.FormatValueType.Date,l.FormatValueType.Time,l.FormatValueType.Percentage,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Date,l.FormatValueType.Date,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Time,l.FormatValueType.Time,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Fraction,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Scientific,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Text,l.FormatValueType.Custom],[l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.General,l.FormatValueType.Custom]];function N(e,t){if("number"!=typeof t)return t;var r=e.globals.getIformat(e.document,t);if(!(0,h.isSuccess)(r))throw new C(r.reason);return r.value}function _(e,t){var r=e.globals.getKnownFormat(e.document,t);if(!(0,h.isSuccess)(r))throw new C(r.reason);return r.value}function I(e,t){if("number"==typeof t)return t;var r=e.globals.getFormatString(e.document,t.formatString);if(!(0,h.isSuccess)(r))throw new C(r.reason);return void 0!==r.value?r.value:t}function O(e,t,r){return(0,o.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",2===t.length),r(e,t[0],t[1])}function M(e,t,r,n){var i=r[0],a=n[0],o=P[i.valueType],s=P[a.valueType],u=o<=s?t[o][s]:t[s][o],l=P[u],c=a.decimals>i.decimals?a.decimals:i.decimals;switch(l){case o:return y(!0,i.format,i.valueType,c);case s:return y(!0,a.format,a.valueType,c);default:return e.unitlessFormat}}function D(e,t,r){return M(e,A,t,r)}function w(e,t,r){var n=t[0],i=r[0];if(n.format===i.format&&n.valueType===i.valueType&&n.valueType===l.FormatValueType.Time)return y(!0,n.format,n.valueType,n.decimals);if(n.valueType===l.FormatValueType.Date&&i.valueType===l.FormatValueType.Time||n.valueType===l.FormatValueType.Time&&i.valueType===l.FormatValueType.Date){var a=_(e,g.KnownFormat.MDYHMS),o=a.valueType,s=a.decimals;return y(!0,a,o,s)}return M(e,T,t,r)}var L=function(e){return e.unitlessFormat};function x(e,t,r){var n=t[0],i=r[0];return n.format===i.format?y(!0,n.format,n.valueType,n.decimals):e.unitlessFormat}function K(e){return P[e]===P[l.FormatValueType.General]}var U=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return(0,v.visitFormulaNode)(t,e)},this.lazyVisitFormulaNode=function(e){return S.Pledge.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){switch(e.kind){case m.OperKind.String:case m.OperKind.Boolean:case m.OperKind.Error:case m.OperKind.Missing:return S.Pledge.resolve(this.context.defaultFormat);case m.OperKind.Number:var t=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),21),r=t.indexOf(this.context.localeInfo.decimalSeparator),n=r>=0?t.length-r-1:0,i=_(this.context,g.KnownFormat.General);return S.Pledge.resolve(y(!1,i,i.valueType,n));default:return(0,o.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",e)}},e.prototype.arrayNode=function(e){return S.Pledge.resolve(this.context.defaultFormat)},e.prototype.appNode=function(e,t){var r=this;if((0,s.isOperatorNode)(e))return S.Pledge.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return function(e,t,r){switch(t){case p.OperatorId.Mul:case p.OperatorId.Div:return e.multOrDivTainted=!0,O(e,r,D);case p.OperatorId.Pow:return O(e,r,D);case p.OperatorId.Add:case p.OperatorId.Sub:return O(e,r,w);case p.OperatorId.Percent:(0,o.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);var n=r[0],i=n[0],a=n[1];if(!(0,s.isNumberLiteralNode)(a))return e.defaultFormat;var u=i.strong,l=i.decimals,c=_(e,g.KnownFormat.Pct);return y(u,c,c.valueType,l);case p.OperatorId.Pound:case p.OperatorId.At:return e.defaultFormat;case p.OperatorId.Neg:case p.OperatorId.Pos:return(0,o.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length),i=r[0][0];case p.OperatorId.Lt:case p.OperatorId.Le:case p.OperatorId.Eq:case p.OperatorId.Ge:case p.OperatorId.Gt:case p.OperatorId.Ne:return O(e,r,L);case p.OperatorId.Isect:case p.OperatorId.Union:case p.OperatorId.Range:case p.OperatorId.Concat:return O(e,r,x);case p.OperatorId.And:case p.OperatorId.Or:case p.OperatorId.Xor:case p.OperatorId.Min:case p.OperatorId.Max:throw new C((0,s.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,o.assertNever)("calc.numfmt.evalFormat: unexpected operator id",t)}}(r.context,e.id,t)}));if((0,s.isWSFNode)(e)){var n=e.id,i=function(e){var t;return null!==(t=k[e])&&void 0!==t?t:E.Ignore}(n),a=(0,p.getWorksheetFuncType)(n),u=(0,s.getArguments)(t);if((0,o.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,s.isValidArgsLength)(a,u.length)),i===E.Ignore)return S.Pledge.resolve(this.context.defaultFormat);if(i===E.Propagate)return 0===u.length?S.Pledge.resolve(this.context.defaultFormat):S.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((function(e){var t=e[0],n=t.format,i=t.valueType,a=t.decimals,o=!K(i);if(!t.strong&&o)return r.context.unitlessFormat;for(var s=o,u=1;u<e.length;u+=1){var l=e[u],c=!K(l.valueType);if(!l.strong&&c)return r.context.unitlessFormat;s||(n=l.format,i=l.valueType,a=l.decimals,s=c)}return y(!0,n,i,a)}));var l=_(this.context,i),c=l.valueType,d=l.decimals;return S.Pledge.resolve(y(!0,l,c,d))}return this.lazyVisitFormulaNode(e)},e.prototype.letNode=function(e,t,r,n){return S.Pledge.resolve(this.context.defaultFormat)},e.prototype.lambdaNode=function(e,t,r,n){return S.Pledge.resolve(this.context.defaultFormat)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return S.Pledge.resolve(this.context.defaultFormat)},e.prototype.cellRefNode=function(e,t){var r=this.context.resolver.resolveCellRef(this.context.locals,(0,u.cellRefNode)(e,t)).resolution;if(!(0,h.isSuccess)(r))throw(0,o.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==c.ResolveReasonKind.NoOriginSheet),new C(r.reason);var n=r.value;if(void 0===n)throw F;return(0,s.isSheetGridRange)(n)?S.Pledge.resolve(W(this.context,n)):S.Pledge.resolve(this.context.unitlessFormat)},e.prototype.fieldRefNode=function(e,t){var r=this;return this.lazyVisitFormulaNode(e).bind((function(e){return r.context.defaultFormat}))},e.prototype.structRefNode=function(e,t){var r=(0,u.structRefNode)(e,t),n=this.context.resolver.resolveStructRef(this.context.locals,r).resolution;if(!(0,h.isSuccess)(n)){if((0,o.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",n.reason.kind!==c.ResolveReasonKind.NoOriginSheet),n.reason.kind===c.ResolveReasonKind.EmptyIntersection)throw F;throw new C(n.reason)}var i=n.value;if(void 0===i)throw F;return S.Pledge.resolve(W(this.context,i))},e.prototype.missingNode=function(e){return(0,o.assertFalse)("calc.numfmt.evalFormat: unexpected missing node")},e.prototype.badSequenceNode=function(e,t){return(0,o.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.badCharsNode=function(e,t){return(0,o.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.operatorNode=function(e,t){return S.Pledge.resolve((0,u.operatorNode)(e,t))},e.prototype.wsfNode=function(e,t,r){return S.Pledge.resolve((0,u.wsfNode)(e,t,r))},e}();function B(e,t){return(0,v.reducePledge)(new U(e),t)}function W(e,t){var r=(0,s.sheetGridRangeAnchor)(t),n=e.globals.getCellFormat(r);if(!(0,h.isSuccess)(n))throw new C(n.reason);var i=n.value,a=N(e,i);if(!(0,s.isDocumentLocEqual)(r.sheet.document,e.document)&&("number"!=typeof i||a.source!==l.NumberFormatSource.Builtin))return e.defaultFormat;var o=a.valueType,u=a.decimals;return y(!0,i,o,u)}t.evalFormatImpl=function(e,t,r){try{var n=b(e,t),i=B(n,r);return(0,h.success)(a.__assign(a.__assign({},i),{format:I(n,i.format),mulOrDivTainted:n.multOrDivTainted}))}catch(e){return e instanceof C?(0,h.failure)(e.reason):e===F?h.successUndefined:(0,h.failure)((0,h.javaScriptError)(e))}},t.evalFormat=function(e,t,r){try{var n=b(e,t),i=B(n,r);return(0,h.success)(function(e,t){var r=t.strong,n=t.format,i=t.valueType,a=t.decimals;if(i!==l.FormatValueType.Number||!e.multOrDivTainted){if(a>0&&r&&(i===l.FormatValueType.Number||i===l.FormatValueType.Currency||i===l.FormatValueType.Accounting||i===l.FormatValueType.Percentage)){var o=N(e,n);a!==o.decimals&&(n=o.synthesizeDecimals(a))}if(i!==l.FormatValueType.General&&r)return n=I(e,n)}}(n,i))}catch(e){return e instanceof C?(0,h.failure)(e.reason):e===F?h.successUndefined:(0,h.failure)((0,h.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(3);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";var n,i,a,o,s,u,l,c,d,p;Object.defineProperty(t,"__esModule",{value:!0}),t.changeFormatDecimals=t.applyFormat=t.createFormat=t.NumberFormatImpl=void 0;var m,f=r(0),g=r(114),h=r(66),v=r(59),S=r(64),y=r(173),F=r(251),C=r(254),R=r(172),b=r(111),E=r(423),P=r(112),k=r(59),T=r(134),A=f.__importStar(r(135)),N=r(65),_=r(252),I=r(176),O=r(175),M=r(53),D=r(424),w=r(256),L=A.codePointMinusSign,x=A.codePointPlusSign,K=A.codePointDigitZero,U=A.codePointHash,B=A.codePointFullStop,W=A.codePointDigitOne,G=A.codePointDigitTwo,V=A.codePointLeftParen,j=A.codePointRightParen,q=A.codePointSmallT,H=A.codePointBackslash;!function(e){e[e.WantPic=0]="WantPic",e[e.WantClose=1]="WantClose",e[e.Done=2]="Done"}(m||(m={}));var z={decimalSeparator:"NOTUSED"};function Q(e,t,r,n){var i=e.formatFixed(t,0,0),a=i.mantissa,o=i.exponent;(0,h.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",a.length<=o),(0,h.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",0!==a.length||0===o);var s=(0,T.convertDigitsShape)(o<r?(0,b.repeat)("0",r-o):"",n),u=(0,T.convertNumberShape)(z,a+(0,b.repeat)("0",o-a.length),n);if(!(0,M.isSuccess)(u))throw new Ue(u.reason);return s+u.value}function Y(e,t,r,n,i){var a=e.formatFixed(t,0,0),o=a.mantissa,s=a.exponent;(0,h.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",o.length<=s),(0,h.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==o.length||0===s);var u=((s<r?(0,b.repeat)("0",r-s):"")+o+(0,b.repeat)("0",s-o.length)).substring(0,n);return(0,T.convertDigitsShape)(u,i)}function J(e,t){var r=e.formatFixed(t,0,0),n=r.mantissa,i=r.exponent;return(0,h.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",n.length<=i),(0,h.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",0!==n.length||0===i),""===n?"0":n.length<i?n+(0,b.repeat)("0",i-n.length):n}function $(e){for(var t=[],r=0;r<e.length;r+=1){var n=e[r];switch(n.kind){case S.FormattedUnitKind.Blank:case S.FormattedUnitKind.String:for(var i=n.str;r+1<e.length;){var a=e[r+1];if(a.kind!==n.kind)break;i+=a.str,r+=1}t.push({kind:n.kind,str:i});break;case S.FormattedUnitKind.Flexible:case S.FormattedUnitKind.General:t.push(n)}}return t}var X=function(e){return e.kind===S.FormattedUnitKind.Flexible};var Z,ee=((n={})[1]=N.NumberShape.ChineseTrad1,n[2]=N.NumberShape.ChineseTrad2,n[3]=N.NumberShape.ChineseTrad3,n),te=((i={})[1]=N.NumberShape.ChineseSimp1,i[2]=N.NumberShape.ChineseSimp2,i[3]=N.NumberShape.ChineseSimp3,i),re=((a={})[1]=N.NumberShape.Japanese1,a[2]=N.NumberShape.Japanese2,a[3]=N.NumberShape.Japanese3,a),ne=((o={})[1]=N.NumberShape.Korean1,o[2]=N.NumberShape.Korean2,o[3]=N.NumberShape.Korean3,o[4]=N.NumberShape.Korean4,o);function ie(e){return e+1}!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}(Z||(Z={}));var ae,oe=(0,b.partialArray)(((s={})[Z.Ne]="<>",s[Z.Le]="<=",s[Z.Ge]=">=",s[Z.Eq]="=",s[Z.Lt]="<",s[Z.Gt]=">",s)),se=((u={})[Z.Ne]=C.OperatorId.Ne,u[Z.Le]=C.OperatorId.Le,u[Z.Ge]=C.OperatorId.Ge,u[Z.Eq]=C.OperatorId.Eq,u[Z.Lt]=C.OperatorId.Lt,u[Z.Gt]=C.OperatorId.Gt,u),ue=((l={})[C.OperatorId.Ne]=Z.Ne,l[C.OperatorId.Le]=Z.Le,l[C.OperatorId.Ge]=Z.Ge,l[C.OperatorId.Eq]=Z.Eq,l[C.OperatorId.Lt]=Z.Lt,l[C.OperatorId.Gt]=Z.Gt,l);function le(e,t,r,n){for(var i=0;i<t.length;i+=1){var a=t[i];if(null!=a&&!(n+a.length>r.length)){var o=r.substring(n,n+a.length);if(0===e.stringCompareCI(a,o))return Number(i)}}}function ce(e,t,r,n){for(var i=0;i<t.length;i+=1){var a=t[i];if(null!=a&&(0,b.stringStartsWith)(r,a,n))return Number(i)}return le(e,t,r,n)}function de(e,t){var r;return null!==(r=e[t])&&void 0!==r?r:""}function pe(e,t){var r=t.indexOf(de(e.pictureSingle,g.PictureSingle.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(ae||(ae={}));var me=/^[0-9A-F]{1,8}$/i,fe=/^(?:([a-z]{2,}(?:-[A-Z0-9](?:[A-Z0-9]+|(?=,)|$)(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i,ge=(0,b.partialArray)(((c={})[1]=N.NumberShape.ASCII,c[2]=N.NumberShape.ArabicIndic,c[3]=N.NumberShape.ExtendedArabicIndic,c[4]=N.NumberShape.Devanagari,c[5]=N.NumberShape.Bengali,c[6]=N.NumberShape.Gurmukhi,c[7]=N.NumberShape.Gujarati,c[8]=N.NumberShape.Oriya,c[9]=N.NumberShape.Tamil,c[10]=N.NumberShape.Telugu,c[11]=N.NumberShape.Kannada,c[12]=N.NumberShape.Malayalam,c[13]=N.NumberShape.Thai,c[14]=N.NumberShape.Lao,c[15]=N.NumberShape.Tibetan,c[16]=N.NumberShape.Myanmar,c[17]=N.NumberShape.Ethiopic,c[18]=N.NumberShape.Khmer,c[19]=N.NumberShape.Mongolian,c[27]=N.NumberShape.Japanese1,c[28]=N.NumberShape.Japanese2,c[29]=N.NumberShape.Japanese3,c[30]=N.NumberShape.ChineseSimp1,c[31]=N.NumberShape.ChineseSimp2,c[32]=N.NumberShape.ChineseSimp3,c[33]=N.NumberShape.ChineseTrad1,c[34]=N.NumberShape.ChineseTrad2,c[35]=N.NumberShape.ChineseTrad3,c[36]=N.NumberShape.Korean1,c[37]=N.NumberShape.Korean2,c[38]=N.NumberShape.Korean3,c[39]=N.NumberShape.Korean4,c)),he=(0,b.partialArray)(((d={})[1]=N.Calendar.Gregorian,d[2]=N.Calendar.GregorianUS,d[3]=N.Calendar.Japan,d[4]=N.Calendar.Taiwan,d[5]=N.Calendar.Korea,d[6]=N.Calendar.Hijri,d[7]=N.Calendar.Thai,d[8]=N.Calendar.Hebrew,d[9]=N.Calendar.GregorianMEFrench,d[10]=N.Calendar.GregorianArabic,d[11]=N.Calendar.GregorianXlitEnglish,d[12]=N.Calendar.GregorianXlitFrench,d[22]=N.Calendar.Persian,d[23]=N.Calendar.UmAlQura,d)),ve=Object.keys(S.CultureTag).reduce((function(e,t){var r=S.CultureTag[t];return e[String(r)]=r,e}),Object.create(null));function Se(e){return e.toString(16).toUpperCase()}function ye(e){return Number("0x"+e)}var Fe,Ce={culture:"en-US",tag:void 0},Re={culture:"fr-FR",tag:void 0},be={culture:"ar-IQ",tag:void 0},Ee={culture:"ar-SA",tag:void 0},Pe={culture:"ar-DZ",tag:void 0},ke={culture:"th-TH",tag:void 0},Te=((p={})[g.PictureSingle.Hour]=_.TimeDivision.Hour,p[g.PictureSingle.HourTh]=_.TimeDivision.Hour,p[g.PictureSingle.Minute]=_.TimeDivision.Minute,p[g.PictureSingle.MinuteTh]=_.TimeDivision.Minute,p[g.PictureSingle.Second]=_.TimeDivision.Second,p[g.PictureSingle.SecondTh]=_.TimeDivision.Second,p);function Ae(e){return e.kind===Fe.Char?e.formattedStr:void 0}!function(e){e[e.Char=400]="Char",e[e.Fraction=401]="Fraction",e[e.Exp=402]="Exp",e[e.Num=403]="Num",e[e.FracSeconds=404]="FracSeconds",e[e.DateSep=405]="DateSep",e[e.TimeSep=406]="TimeSep",e[e.SysFormat=407]="SysFormat"}(Fe||(Fe={}));var Ne,_e,Ie,Oe={kind:ae.General};function Me(e){return 1===e.length&&e[0].kind===ae.General}!function(e){e[e.Num=0]="Num",e[e.Date=1]="Date",e[e.Fraction=2]="Fraction",e[e.Percent=3]="Percent",e[e.Exp=4]="Exp",e[e.Text=5]="Text",e[e.General=6]="General",e[e.Other=7]="Other"}(Ne||(Ne={})),function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"}(_e||(_e={})),function(e){e[e.Unknown=0]="Unknown",e[e.Either=1]="Either",e[e.Number=2]="Number",e[e.Text=3]="Text"}(Ie||(Ie={}));var De={code:[Oe],color:void 0,dbnum:void 0,dtrRounding:_.Rounding.RoundSec};function we(e){return void 0===e.color&&void 0===e.dbnum&&Me(e.code)}function Le(e){return void 0===e.color&&void 0===e.dbnum&&(1===(t=e.code).length&&t[0].kind===g.PictureSingle.Text);var t}var xe={},Ke=(0,v.createFailureErrorClass)("ApplyHashesError"),Ue=(0,v.createFailureErrorClass)("ApplyError"),Be=(0,v.createFailureErrorClass)("InitError"),We=function(){function e(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],this.hasTokenCurrCode=!1,void 0===t.old?(this.logFormatString=(0,D.anonymizeFormulaString)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.hasTokenCurrCode=t.old.hasTokenCurrCode,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=S.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInputDependent",{get:function(){return this.isInputDependentFormat()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culture",{get:function(){return this.thisCurrCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currencySymbol",{get:function(){return this.thisCurrencySymbol},enumerable:!1,configurable:!0}),e.prototype.apply=function(e,t,r,n){try{return(0,M.success)(this.applyImpl(e,t,r,n))}catch(e){return e instanceof Ue?(0,M.failure)(e.reason):(0,M.failure)((0,M.javaScriptError)((0,b.prependErrorMessage)(e,"(while applying format ".concat(this.logFormatString,")"))))}},e.prototype.isInputDependentFormat=function(){for(var e=0,t=this.parts;e<t.length;e++)for(var r=0,n=t[e].code;r<n.length;r++){switch(n[r].kind){case ae.General:case ae.AMPM:case ae.AMPMFE:case g.PictureSingle.Hash:case g.PictureSingle.Zero:case g.PictureSingle.Text:case g.PictureSingle.Year:case g.PictureSingle.YearTh:case g.PictureSingle.EngYearTh:case g.PictureSingle.ThYear:case g.PictureSingle.Month:case g.PictureSingle.MonthTh:case g.PictureSingle.Day:case g.PictureSingle.DayTh:case g.PictureSingle.LocDay:case g.PictureSingle.Hour:case g.PictureSingle.HourTh:case g.PictureSingle.Minute:case g.PictureSingle.MinuteTh:case g.PictureSingle.Second:case g.PictureSingle.SecondTh:case g.PictureSingle.Era:case g.PictureSingle.EraYear:case Fe.Fraction:case Fe.Exp:case Fe.Num:case Fe.SysFormat:case Fe.FracSeconds:case g.PictureSingle.Question:return!0;case Fe.DateSep:case Fe.TimeSep:case Fe.Char:case ae.LatinDate:case g.PictureSingle.Decimal:case g.PictureSingle.Percent:case ae.BidiDate:case ae.Currency:case ae.CurrCode:case ae.StrLit:case ae.Numeral:case ae.PrefixDigTh:case ae.Exp:case g.PictureSingle.Slash:case g.PictureSingle.Star:case g.PictureSingle.Underscore:}}return!1},e.prototype.applyImpl=function(e,t,r,n){var i,a=this.config,o=a.mathpack,s=a.localeInfo;if(this.valueType===S.FormatValueType.General){var u=void 0;if((0,v.isStringOper)(e))return(0,S.formattedValue)([(0,S.formattedUnitString)(e.value)],u,t,r);if(!n&&0===o.cond(e))return(0,S.formattedValue)([],u,t,r);var l=(0,S.formattedUnitGeneral)(o.toNumber(e),s.decimalSeparator,!0,N.NumberShape.ASCII,N.NumberShape.ASCII,!0);return(0,S.formattedValue)([l],u,t,r)}for(var c=!1;;){var d=void 0;try{var p=void 0,m=!1,f=[];if((0,v.isStringOper)(e))p=_e.Text;else{var g=o.cond(e);void 0!==this.condPos||void 0!==this.condNeg?(p=(i=this.getPart(e)).partKind,m=i.forceNeg):p=g<0?_e.Neg:g>0?_e.Pos:_e.Zero,g<0&&(this.onlyOneNumberPart||m)&&f.push((0,S.formattedUnitString)("-"))}u=(d=this.parts[p]).color;var y=d.dbnum,F=d.code,C=d.dtrRounding;if(!n&&p===_e.Zero&&d===this.parts[_e.Pos]&&!c)return(0,S.formattedValue)([],u,t,r);var R=this.getNumShape(y);this.applyPart({dtrRounding:C,dbnum:y,forceNeg:m,units:f,numShape:R,bidiDate:void 0},F,e,void 0);var b=r|(p!==_e.Text||we(d)||Le(d)?S.Clip.None:S.Clip.MaxChars),E=f.some(X)?S.Alignment.Left:t;return(0,S.formattedValue)($(f),u,E,b)}catch(t){if(t===xe){(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,v.isStringOper)(e)&&0!==o.cond(e)),e=o.zero,c=!0;continue}if(t instanceof Ke)return(0,S.hashesValue)(t.reason,null==d?void 0:d.color);throw t}}},e.prototype.applyPart=function(e,t,r,n){for(var i,a,o,s,u,l=this,c=this.config,d=c.mathpack,p=c.datepack,m=c.localeInfo,f=null!==(s=null===(o=this.applyCurrCode)||void 0===o?void 0:o.calendar)&&void 0!==s?s:N.Calendar.Gregorian,F=function(){if(void 0!==u)return u;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,v.isStringOper)(r));var t=l.config,n=t.date1904,i=t.dateCompatibility;if(!i&&d.cond(r)<0)throw new Ke(S.dateOverflow);if(i&&d.cond(r)<0){if(n)throw new Ue((0,v.notImplemented)(["negative date 1904"]));throw new Ke(S.dateOverflow)}var a=p.fromNum(l.config,d.abs(r),e.dtrRounding);if(!1===a)throw new Ke(S.dateOverflow);switch(f){case N.Calendar.Gregorian:case N.Calendar.GregorianUS:case N.Calendar.GregorianMEFrench:case N.Calendar.GregorianArabic:case N.Calendar.GregorianXlitEnglish:case N.Calendar.GregorianXlitFrench:break;case N.Calendar.Thai:a.yr+=543;break;default:throw new Ue((0,v.notImplemented)(["calendar: "+f]))}return(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",a.yr>=0&&a.mon>=1&&a.mon<=12&&a.dom>=0&&a.dom<=31&&a.hour>=0&&a.hour<=23&&a.min>=0&&a.min<=59&&a.sec>=0&&a.sec<=59&&a.fracSec>=0&&a.wdy>=1&&a.wdy<=7),u=a},C=function(){if(void 0!==u)throw new Ue((0,v.notImplemented)(["use of value after date component"]));return r},R=!1,k=e.numShape,A=e.units,_=0;_<t.length;_+=1){var O=t[_];switch(O.kind){case ae.General:R=!0;var D=C();if((0,v.isStringOper)(D))A.push((0,S.formattedUnitString)(D.value));else{var w=d.abs(D);if(d.cond(D)<0&&"0"===d.formatGeneral(m,w,1))throw new Ue((0,v.notImplemented)(["potential LRestart in interval (-0.5,0)"]));var L=(0,S.formattedUnitGeneral)(d.toNumber(w),m.decimalSeparator,!1,k,this.getNumShape(void 0),this.valueType===S.FormatValueType.General);if(void 0!==e.dbnum){var x=(0,I.renderGeneral)(d,L,255);if(!(0,M.isSuccess)(x))throw new Ue(x.reason);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==x.value),A.push((0,S.formattedUnitString)(x.value));break}A.push(L)}break;case g.PictureSingle.Text:var K=C();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,v.isStringOper)(K)),A.push((0,S.formattedUnitString)(K.value));break;case ae.Exp:case g.PictureSingle.Slash:case Fe.Char:A.push((0,S.formattedUnitString)(O.formattedStr));break;case g.PictureSingle.Star:A.push((0,S.formattedUnitFlexible)(O.escaped));break;case g.PictureSingle.Underscore:A.push((0,S.formattedUnitBlank)(O.escaped));break;case ae.StrLit:A.push((0,S.formattedUnitString)(O.escaped));break;case g.PictureSingle.Percent:case ae.Numeral:A.push((0,S.formattedUnitString)(O.formattedStr));break;case ae.Currency:A.push((0,S.formattedUnitString)(m.currencySymbol));break;case ae.CurrCode:var U=O.currencySymbol,B=O.currCode;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,S.isSystemCultureTag)(null==B?void 0:B.tag)),void 0!==U&&A.push((0,S.formattedUnitString)(U));break;case Fe.DateSep:A.push((0,S.formattedUnitString)(m.dateSeparator));break;case Fe.TimeSep:O.printAsTimeSep?A.push((0,S.formattedUnitString)(m.timeSeparator)):A.push((0,S.formattedUnitString)(O.formattedStr));break;case Fe.Num:var W=C();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,v.isStringOper)(W)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===n);var G=O.numDigLeft,V=O.numDigDec,j=2*(se=O.numPercent)-3*(ue=O.numThousands),q=d.formatFixed(W,j,V),H=q.mantissa,z=q.exponent;if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==H.length||0===z),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",H.length<=z+V),d.cond(W)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===H.length)throw xe;this.applyPart(e,O.codeBefore,d.zero,void 0),this.applyPart(e,O.code,d.zero,{comma:O.comma,fractionDenom:!1,decimal:!1,digits:H,digitsExp:z,numDigLeft:G});break;case Fe.Exp:var $=C();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,v.isStringOper)($)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===n);var X=O.numMantDigLeft,Z=O.numMantDigDec,ee=0===X&&0===Z,te=d.formatScientific($,X,Z);H=te.mantissa,z=te.exponent;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==H.length||0===z||ee);var re=(0,E.formatScientificLeft)(z,X);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",H.length<=re+Z),this.applyPart(e,O.codeMant,d.zero,{comma:O.commaMant,fractionDenom:!1,decimal:!1,digits:H,digitsExp:re,numDigLeft:O.numMantDigLeft}),this.applyPart(e,O.codeBetween,d.zero,void 0);var ne=""!==H||ee?z-re:0;ne<0?A.push((0,S.formattedUnitString)("-")):O.isNeg||A.push((0,S.formattedUnitString)("+"));var ie=J(d,d.fromNumber(ne));this.applyPart(e,O.codeExp,d.zero,{comma:O.commaMant,fractionDenom:!1,decimal:!1,digits:ie,digitsExp:ie.length,numDigLeft:O.numExpDigLeft});break;case Fe.Fraction:var oe=C();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,v.isStringOper)(oe)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===n);var se=O.numPercent,ue=O.numThousands,le=O.numIntDigLeft,ce=O.numNumerDig,de=O.numDenomDig,me=O.commaInt,fe=O.denomValue,ge=(j=2*se-3*ue,d.tenTo(j)),he=(0,v.isErrorOper)(ge)?ge:d.mul(d.abs(oe),ge);if((0,v.isErrorOper)(he))throw new Ue((0,v.notImplemented)(["overflow on fraction exp adjust"]));var ve=function(e){for(var t=e;t<A.length;t+=1){var r=A[t];r.kind===S.FormattedUnitKind.String&&(A[t]=(0,S.formattedUnitBlank)(r.str))}},Se=O.anyZeroNumer,ye=void 0,Ce=void 0,Re=void 0;if(void 0!==O.codeInt){var be=d.trunc(he),Ee=d.sub(he,be);if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,v.isNumberOper)(Ee)),ye=(i=this.formFraction(Ee,fe,de)).numer,Ce=i.denom,(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",d.cond2(ye,Ce)<=0),0===d.cond2(ye,Ce)){ye=d.zero;var Pe=d.add(be,d.one);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,v.isNumberOper)(Pe)),be=Pe}0!==d.cond(ye)&&(Se=!0);var Ae=J(d,be),Ne={comma:me,fractionDenom:!1,decimal:!1,digits:Ae,digitsExp:Ae.length,numDigLeft:le},_e=A.length;this.applyPart(e,O.codeInt,d.zero,Ne),Re=A.length,(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==O.lastDigInt),0!==d.cond(be)||!Se||O.lastDigInt===g.PictureSingle.Zero?this.applyPart(e,O.codeBetween1,d.zero,void 0):(O.lastDigInt!==g.PictureSingle.Question&&(A.length=_e),this.applyPart(e,O.codeBetween1,d.zero,void 0),ve(_e),O.firstDigNumer!==g.PictureSingle.Question&&(A.length=_e))}else{if(ye=(a=this.formFraction(he,fe,de)).numer,Ce=a.denom,d.cond(oe)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===d.cond(ye))throw xe;Se=!0,Re=A.length}var Ie=J(d,ye),Oe={comma:!1,fractionDenom:!1,decimal:!1,digits:Ie,digitsExp:Ie.length,numDigLeft:ce};this.applyPart(e,O.codeNumer,d.zero,Oe),this.applyPart(e,O.codeBetween2,d.zero,void 0);var Me=J(d,Ce),De={comma:!1,fractionDenom:!0,decimal:Oe.decimal,digits:Me,digitsExp:Me.length,numDigLeft:de};this.applyPart(e,O.codeDenom,d.zero,De),Se||(O.anyQuestionNumer||O.firstDigDenom===g.PictureSingle.Question?ve(Re):A.length=Re);break;case g.PictureSingle.Decimal:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==n),n.digitsExp>0&&(n.numDigLeft=n.digitsExp,this.dumpDigLeft(e,n,n.digitsExp)),n.decimal=!0,A.push((0,S.formattedUnitString)(m.decimalSeparator));break;case g.PictureSingle.Hash:case g.PictureSingle.Zero:case g.PictureSingle.Question:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==n);var we=O.count;if(n.decimal||n.fractionDenom&&O.kind===g.PictureSingle.Question){if(n.fractionDenom&&_!==t.length-1)throw new Ue((0,v.notImplemented)(["left-align bug in denominator"]));if(n.digitsExp<0){var Le=(0,P.fastMin)(we,-n.digitsExp),Be=(0,T.convertDigitsShape)((0,b.repeat)("0",Le),k);A.push((0,S.formattedUnitString)(Be)),n.digitsExp+=Le,we-=Le}var We=(0,P.fastMin)(we,n.digits.length);Be=(0,T.convertDigitsShape)(n.digits.substring(0,We),k);if(A.push((0,S.formattedUnitString)(Be)),n.digits=n.digits.substring(We),we-=We,O.kind!==g.PictureSingle.Hash&&we>0){Be=(0,T.convertDigitsShape)((0,b.repeat)("0",we),k);A.push(O.kind===g.PictureSingle.Question?(0,S.formattedUnitBlank)(Be):(0,S.formattedUnitString)(Be))}break}if(n.numDigLeft>n.digitsExp){Le=(0,P.fastMin)(we,n.numDigLeft-n.digitsExp);if(O.kind!==g.PictureSingle.Hash){Be=(0,T.convertDigitsShape)((0,b.repeat)("0",Le),k);n.comma&&(Be=(0,T.insertCommas)(m,Be,n.numDigLeft-Le)),A.push(O.kind===g.PictureSingle.Question?(0,S.formattedUnitBlank)(Be):(0,S.formattedUnitString)(Be))}we-=Le,n.numDigLeft-=Le}else we+=n.digitsExp-n.numDigLeft,n.numDigLeft=n.digitsExp;this.dumpDigLeft(e,n,we);break;case ae.PrefixDigTh:m.isThai&&(k=e.numShape=N.NumberShape.Thai);break;case ae.LatinDate:this.hasTokenCurrCode||(e.bidiDate=S.BidiDate.English);break;case ae.BidiDate:throw new Ue((0,v.notImplemented)(["TokenKind.BidiDate"]));case g.PictureSingle.HourTh:case g.PictureSingle.MinuteTh:case g.PictureSingle.SecondTh:case g.PictureSingle.Hour:case g.PictureSingle.Minute:case g.PictureSingle.Second:var Ge=(nt=O.kind===g.PictureSingle.HourTh||O.kind===g.PictureSingle.MinuteTh||O.kind===g.PictureSingle.SecondTh)&&!this.hasTokenCurrCode?N.NumberShape.Thai:k;if(O.isAbs){var Ve=C();if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,v.isStringOper)(Ve)),nt&&this.hasTokenCurrCode)throw new Ue((0,v.notImplemented)(["fcAbsHourTh && fIntlNum bug"]));var je=p.toTime(this.config,d.abs(Ve),Te[O.kind],e.dtrRounding);if(!1===je)throw new Ue((0,v.notImplemented)(["absolute time overflow"]));A.push((0,S.formattedUnitString)(Q(d,d.fromNumber(je),O.count,Ge)))}else{var qe=F(),He=void 0;if(O.kind===g.PictureSingle.Minute||O.kind===g.PictureSingle.MinuteTh)He=qe.min;else if(O.kind===g.PictureSingle.Second||O.kind===g.PictureSingle.SecondTh)He=qe.sec;else if(He=qe.hour,O.isAMPM){if(O.kind===g.PictureSingle.HourTh)throw new Ue((0,v.notImplemented)(["fc12HourTh/fc12Hour2Th forgotten"]));He>12&&(He-=12),0===He&&(He=12)}A.push((0,S.formattedUnitString)(Q(d,d.fromNumber(He),O.count,Ge)))}break;case ae.AMPM:case ae.AMPMFE:var ze=void 0;if(ze=!!(0,v.isStringOper)(r)||F().hour<12,(!this.hasTokenCurrCode||O.kind===ae.AMPMFE)&&(O.kind===ae.AMPMFE||m.isEastAsia||O.pictureKind===g.PictureSpecial.AP2)){var Qe=pe(m,O.tokenStr);A.push((0,S.formattedUnitString)(Qe[ze?0:1]));break}var Ye=this.getBundledLocaleInfo("localised AM/PM string",N.Calendar.Gregorian,this.applyCurrCode);A.push((0,S.formattedUnitString)(Ye.ampmSymbols[ze?0:1]));break;case Fe.FracSeconds:var Je=F();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",Je.rounding>=O.rounding);var $e=Y(d,d.fromNumber(Je.fracSec),Je.rounding,O.rounding,k);A.push((0,S.formattedUnitString)(m.decimalSeparator+$e));break;case g.PictureSingle.Era:throw new Ue((0,v.notImplemented)(["PictureSingle.Era"]));case g.PictureSingle.EraYear:throw new Ue((0,v.notImplemented)(["PictureSingle.EraYear"]));case g.PictureSingle.YearTh:case g.PictureSingle.EngYearTh:case g.PictureSingle.ThYear:case g.PictureSingle.Year:Ge=O.kind!==g.PictureSingle.YearTh&&O.kind!==g.PictureSingle.ThYear||this.hasTokenCurrCode?k:N.NumberShape.Thai;var Xe=(O.kind===g.PictureSingle.YearTh||O.kind===g.PictureSingle.EngYearTh)&&!this.hasTokenCurrCode,Ze=F().yr+(Xe?543:0);He=O.count>2?Ze:Ze%100;A.push((0,S.formattedUnitString)(Q(d,d.fromNumber(He),O.count,Ge)));break;case g.PictureSingle.Month:case g.PictureSingle.MonthTh:var et=F().mon;switch(O.count){case 1:case 2:Ge=O.kind!==g.PictureSingle.MonthTh||this.hasTokenCurrCode?k:N.NumberShape.Thai;A.push((0,S.formattedUnitString)(Q(d,d.fromNumber(et),O.count,Ge)));break;case 3:case 4:case 5:var tt=void 0;if(tt=e.bidiDate===S.BidiDate.English?(0,g.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised month string",f,O.kind!==g.PictureSingle.MonthTh||this.hasTokenCurrCode?this.applyCurrCode:ke),3===O.count)A.push((0,S.formattedUnitString)(tt.monthNameShort[et-1]));else if(4===O.count||e.bidiDate===S.BidiDate.English)A.push((0,S.formattedUnitString)(tt.monthNameLong[et-1]));else{var rt=tt.monthNameLong[et-1];A.push((0,S.formattedUnitString)(rt.substring(0,(0,y.numCodeUnits)((0,y.stringCodePointAt)(rt,0)))))}}break;case g.PictureSingle.Day:case g.PictureSingle.DayTh:case g.PictureSingle.LocDay:var nt=O.kind===g.PictureSingle.DayTh;if(O.count<3){Ge=nt&&!this.hasTokenCurrCode?N.NumberShape.Thai:k;var it=F().dom;A.push((0,S.formattedUnitString)(Q(d,d.fromNumber(it),O.count,Ge)))}else{var at=F().wdy;tt=void 0;if(tt=e.bidiDate===S.BidiDate.English||!this.hasTokenCurrCode&&m.isEastAsia&&O.kind===g.PictureSingle.Day?(0,g.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised day string",f,nt&&!this.hasTokenCurrCode?ke:this.applyCurrCode),nt&&this.hasTokenCurrCode&&3===O.count)throw new Ue((0,v.notImplemented)(["fcDay3Th && fIntlNum bug"]));Be=3===O.count?tt.dayNameShort[at-1]:tt.dayNameLong[at-1];A.push((0,S.formattedUnitString)(Be))}break;case Fe.SysFormat:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===n),this.applyPart(e,O.codeSysFormat,r,n);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",O)}}R&&C()},e.prototype.dumpDigLeft=function(e,t,r){var n=this.config.localeInfo,i=e.units,a=e.numShape,o=r,s=(0,P.fastMin)(o,t.digits.length),u=(0,T.convertDigitsShape)(t.digits.substring(0,s),a);if(t.comma&&(u=(0,T.insertCommas)(n,u,t.numDigLeft-s)),i.push((0,S.formattedUnitString)(u)),t.digits=t.digits.substring(s),o-=s,t.digitsExp-=s,t.numDigLeft-=s,o>0){u=(0,T.convertDigitsShape)((0,b.repeat)("0",o),a);t.comma&&(u=(0,T.insertCommas)(n,u,t.numDigLeft-o)),i.push((0,S.formattedUnitString)(u)),t.digitsExp-=o,t.numDigLeft-=o}},e.prototype.getPart=function(e){for(var t=this.config.mathpack,r=_e.Pos;r<_e.Zero;r+=1){var n=r,i=void 0;if(r===_e.Pos){if(void 0===(i=this.condPos)&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[_e.Pos])throw new Ke(S.noFormatPart);if(0===this.parts[_e.Pos].code.length)throw new Ue((0,v.notImplemented)(['emulation of ";[COND]foo" bug']));if(void 0===(i=this.condNeg)){if(this.parts[_e.Zero]===this.parts[_e.Pos])return(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===C.OperatorId.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0!==i){var a=i.operator,o=i.operand,s=t.sub(e,o);if((0,v.isErrorOper)(s))throw new Ue((0,v.notImplemented)(["overflow in condition check"]));if((0,k.applyComparison)(a,t.cond2(e,o)))switch(a){case C.OperatorId.Eq:return{partKind:n,forceNeg:!1};case C.OperatorId.Ne:case C.OperatorId.Gt:case C.OperatorId.Ge:return{partKind:n,forceNeg:!0};case C.OperatorId.Lt:return{partKind:n,forceNeg:t.cond(o)>0};case C.OperatorId.Le:return{partKind:n,forceNeg:t.cond(o)>=0}}}}var u=_e.Zero;if(this.parts[u]===this.parts[_e.Pos])throw new Ke(S.noFormatPart);return{partKind:u,forceNeg:!0}},e.prototype.getNumShape=function(e){var t=this.applyCurrCode,r=null==t?void 0:t.numberShape;if(void 0!==r)return r;if(void 0===e)return N.NumberShape.ASCII;var n=this.getBundledLocaleInfo("localised DBNUM culture",N.Calendar.Gregorian,t);return n.isEastAsia&&(n.isKorea?r=ne[e]:n.isJapan?r=re[e]:n.isChinaT?r=ee[e]:n.isChinaS&&(r=te[e])),null!=r?r:N.NumberShape.ASCII},e.prototype.formFraction=function(e,t,r){var n,i,a,o=this.config.mathpack;if(void 0!==t){var s=o.fromNumber(137438953472);if((0,v.isErrorOper)(o.sub(e,s)))throw new Ue((0,v.notImplemented)(["overflow in fraction threshold check"]));if(o.cond2(e,s)<0){var u=o.mul(e,o.fromNumber(1.0000000000000002));(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,v.isNumberOper)(u)),e=u}var l=t,c=o.toNumber(l)<<1,d=o.mul(e,o.fromNumber(c));if(!(0,v.isNumberOper)(d))throw new Ue((0,v.notImplemented)(["overflow in fraction denom mul"]));var p=o.lfix(d);if(p<0||p>=65535)throw new Ke(S.fractionOverflow);return{numer:o.fromNumber(p+1>>1),denom:l}}switch(r){case 1:a=10;break;case 2:a=100;break;case 3:a=1e3;break;case 4:a=1e4;break;case 5:a=1e5;break;case 6:a=1e6;break;default:a=1e7}var m=o.fix(e);if(m>=2147483647)throw new Ke(S.fractionOverflow);for(var f=e,g=1,y=1,F=0,C=0;;){var R=g*m;C+=R;var b=F*m;if(y+=b,R>2147483647||b>2147483647||y>=a){1===F&&2===m&&0===o.cond2(f,o.trunc(f))&&(g+=1);break}g=(n=[C,g])[0],C=n[1],F=(i=[y,F])[0],y=i[1];var E=o.sub(f,o.trunc(f));if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,v.isNumberOper)(E)),0===o.cond(E))break;var P=o.div(o.one,E);if((0,v.isErrorOper)(P))throw new Ue((0,v.notImplemented)(["overflow in fraction inversion"]));if(f=P,(m=o.fix(f))>2147483647)break}return 0===F&&(F=g=1),{numer:o.fromNumber(g),denom:o.fromNumber(F)}},e.prototype.synthesizeDecimals=function(t){for(var r=this,n=(0,P.fastMax)(0,(0,P.fastMin)(t,127)),i=[],a=function(e){var t=o.parts[e];if((e===_e.Neg||e===_e.Zero)&&t===o.parts[_e.Pos])return i.push(i[_e.Pos]),"continue";if(e===_e.Text)return i.push(t===o.parts[_e.Pos]?i[_e.Pos]:t),"continue";var a=t.code,s=t.color,u=t.dbnum,l=t.dtrRounding,c={code:a.map((function(t){if(t.kind===Fe.Num){var i=t.numDigLeft,a=t.numPercent,o=t.numThousands,s=t.comma,u=t.codeBefore;return{kind:Fe.Num,numDigLeft:i,numDigDec:n,numPercent:a,numThousands:o,comma:s,code:r.adjustDecimals(e,t.numDigDec,t.code,n),codeBefore:u}}if(t.kind===Fe.Exp){var l=t.isNeg,c=t.numMantDigLeft,d=t.numExpDigLeft,p=t.commaMant,m=t.codeBetween,f=t.codeExp;return{kind:Fe.Exp,isNeg:l,numMantDigLeft:c,numMantDigDec:n,numExpDigLeft:d,commaMant:p,codeMant:r.adjustDecimals(e,t.numMantDigDec,t.codeMant,n),codeBetween:m,codeExp:f}}return t})),color:s,dbnum:u,dtrRounding:l};i.push(c)},o=this,s=_e.Pos;s<=_e.Text;s+=1)a(s);try{var u=new e(this.config,{old:this,logFormatString:"synthesizeDecimals(dec=".concat(n," on ").concat(this.logFormatString,")"),synth:i});if(u.formatString.length>255)throw new Be(this.notFormatString("format string too long: max length"));return u}catch(e){if(e instanceof Be)return this;throw e}},e.prototype.adjustDecimals=function(e,t,r,n){var i;if(n===t)return r;for(var a=!1,o=void 0,s=void 0,u=void 0,l=0;l<r.length;l+=1){switch((C=r[l]).kind){case g.PictureSingle.Decimal:void 0===u&&(u=l);break;case g.PictureSingle.Hash:case g.PictureSingle.Question:case g.PictureSingle.Zero:void 0!==u?s=l:(o=l,C.kind===g.PictureSingle.Question&&(a=!0))}}var c=function(e){return e===g.PictureSingle.Percent||e===ae.Currency||e===ae.CurrCode||e===g.PictureSingle.Star};if(0===n){if(void 0===u)return r;var d=0,p=0;void 0===o?void 0!==s&&(d=u+1,p=s+1):(d=u,p=(null!=s?s:u)+1);var m=r.slice(0,d);for(l=d;l<p;l+=1)c(r[l].kind)&&m.push(r[l]);return(0,P.safePush)(m,r.slice(p)),m}if(t>n){(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==u);var v=void 0;!function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(v||(v={}));var S=v.AfterDigs,y=[],F=t-n;for(l=r.length-1;l>=0;l-=1){l<=u&&(S=v.Keeping);var C=r[l];if(S===v.AfterDigs&&(C.kind!==g.PictureSingle.Hash&&C.kind!==g.PictureSingle.Question&&C.kind!==g.PictureSingle.Zero||(S=v.Dropping)),S===v.Keeping||S===v.AfterDigs||c(C.kind))y.push(C);else if(C.kind===g.PictureSingle.Hash||C.kind===g.PictureSingle.Question||C.kind===g.PictureSingle.Zero){var R=(0,P.fastMin)(F,C.count);R<C.count&&y.push({kind:C.kind,count:C.count-R}),0===(F-=R)&&(S=v.Keeping)}}return y.reverse(),y}if(e===_e.Zero&&a&&void 0===s)return r;var b=n-t;if(void 0!==s){var E=r.slice();C=E[s];return E[s]={kind:C.kind,count:C.count+b},E}var k=r.slice(),T=null!==(i=null!=u?u:o)&&void 0!==i?i:k.length-1,A=[];return void 0===u&&A.push({kind:g.PictureSingle.Decimal}),A.push({kind:g.PictureSingle.Zero,count:b}),k.splice.apply(k,f.__spreadArray([T+1,0],A,!1)),k},e.prototype.parseString=function(e){if(this.source!==S.NumberFormatSource.CustomBytecode&&e.length>255)throw new Be(this.notFormatString("format string too long: max length"));for(var t,r,n=!1,i=!1,a=0,o=!1,s=_e.Pos;s<=_e.Text&&!o;s+=1){var u=this.tokenize(e.substring(a)),l=u.cond,c=u.currencySymbol,d=u.hasTokenCurrCode,p=this.convertTokToSun(u),m=p.currCode,f=p.hasPercent,g=p.hasDate,y=p.hasTime,F=this.classifySunPartKind(p,s===_e.Text?Ie.Text:Ie.Unknown),C=this.convertSunToCode(p),R=C.part,b=C.applyCurrCode;if(a+=u.consumed,o=u.eos,f&&(this.hasPercent=!0),g&&(this.hasDate=!0),y&&(this.hasTime=!0),d){if(!(s===_e.Pos||this.hasTokenCurrCode&&(t=this.thisCurrCode,r=m,t===r||void 0!==t&&void 0!==r&&(0,S.isFormatCultureEqual)(t,r))))throw new Be((0,v.notImplemented)(["inconsistent CurrCode in number parts"]));this.hasTokenCurrCode||(this.hasTokenCurrCode=!0,this.thisCurrCode=m)}if(void 0!==b&&void 0===this.applyCurrCode&&(this.applyCurrCode=b),void 0!==c&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=c),this.source===S.NumberFormatSource.System&&((0,h.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",s===_e.Pos),!o||F===Ie.Text))throw new Be(this.notFormatString("system format with more than one part"));if((F===Ie.Text||s===_e.Pos&&F===Ie.Either)&&(n=!0,this.parts[_e.Text]=R,F===Ie.Text)){if(void 0!==l)throw new Be(this.notFormatString("condition in text part"));if(void 0!==m)throw new Be((0,v.notImplemented)(["CurrCode in text part"]));break}if(i=!0,this.parts[s]=R,this.onlyOneNumberPart=s===_e.Pos,s===_e.Pos)this.parts[_e.Neg]=R,this.parts[_e.Zero]=R,this.condPos=l;else if(s===_e.Neg)this.condNeg=l;else if(void 0!==l)throw new Be(this.notFormatString("condition in zero part"))}if(!o)throw new Be(this.notFormatString("too many parts"));i||(this.parts[_e.Pos]=De,this.parts[_e.Neg]=De,this.parts[_e.Zero]=De,this.posBeforeText=!1),n||(this.parts[_e.Text]=De),i&&!n&&this.onlyOneNumberPart&&void 0!==this.condPos&&!Me(this.parts[_e.Pos].code)&&(this.parts[_e.Neg]=De,this.onlyOneNumberPart=!1),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((function(e){return void 0!==e}))),this.checkBytecode()},e.prototype.tokenize=function(e){for(var t,r,n,i=this.config.localeInfo,a={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,hasTokenCurrCode:!1,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};a.consumed<e.length&&a.eos;){var o=this.readToken(a,e,a.consumed),s=t;switch(t=o,a.consumed+=o.tokenStr.length,o.kind){case g.PictureSingle.Sep:a.eos=!1;continue;case ae.Color:if(void 0!==a.color)throw new Be(this.notFormatString("more than one color"));if(0!==a.tokens.length)throw new Be((0,v.notImplemented)(["colour in middle of format"]));a.color=o.color;continue;case ae.Dbnum:if(void 0!==a.dbnum)throw new Be(this.notFormatString("more than one DBNUM"));if(a.dbnumForbidden)throw new Be(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(0!==a.tokens.length)throw new Be((0,v.notImplemented)(["DBNUM in middle of format"]));a.dbnum=o.dbnum;continue;case ae.Cond:if(void 0!==a.cond)throw new Be(this.notFormatString("more than one condition"));if(0!==a.tokens.length)throw new Be((0,v.notImplemented)(["condition in middle of format"]));a.cond=o.cond;continue;case ae.CurrCode:if(void 0!==r)throw new Be(this.notFormatString("more than one currency code in section"));r=o;break;case ae.Currency:n=o;break;case ae.AMPM:case ae.AMPMFE:case g.PictureSingle.Colon:case g.PictureSingle.DateSep:case ae.LatinDate:case ae.BidiDate:case g.PictureSingle.Year:case g.PictureSingle.Month:case g.PictureSingle.Day:case g.PictureSingle.Hour:case g.PictureSingle.Minute:case g.PictureSingle.Second:case g.PictureSingle.Reign:case g.PictureSingle.LocDay:case g.PictureSingle.Era:case g.PictureSingle.EraYear:case g.PictureSingle.EngYearTh:case g.PictureSingle.DayTh:case g.PictureSingle.MonthTh:case g.PictureSingle.YearTh:case g.PictureSingle.ThYear:case g.PictureSingle.HourTh:case g.PictureSingle.MinuteTh:case g.PictureSingle.SecondTh:if((null==s?void 0:s.kind)===o.kind){s.count+=o.count;continue}}a.tokens.push(o)}return void 0!==r?(a.hasTokenCurrCode=!0,a.currCode=r.currCode,a.currencySymbol=r.currencySymbol):void 0!==n&&void 0===a.currencySymbol&&(a.currencySymbol=S.FormatCurrency.LocaleInfo),4!==a.dbnum||i.isKorea||void 0===a.currCode&&!i.isThai||(a.dbnum=void 0),a},e.prototype.readToken=function(e,t,r){var n=this.config,i=n.mathpack,a=n.localeInfo,o=le(a,a.pictureSpecial,t,r);if(void 0!==o){var s=o,u=de(a.pictureSpecial,s);a.isJapan&&s===g.PictureSpecial.GeneralOldMAC&&(s=g.PictureSpecial.General);var l=t.substring(r,r+u.length);switch(s){case g.PictureSpecial.AP1:case g.PictureSpecial.AP2:return{kind:ae.AMPM,tokenStr:l,count:1,pictureKind:s};case g.PictureSpecial.AP3:return{kind:ae.AMPMFE,tokenStr:l,count:1};case g.PictureSpecial.General:return{kind:ae.General,tokenStr:l};case g.PictureSpecial.Currency:return{kind:ae.Currency,tokenStr:l}}}var c,d=(0,y.stringCodePointAt)(t,r),p=(0,y.numCodeUnits)(d),m=t.substring(r,r+p),S=ce(a,a.pictureSingle,t,r);if(void 0!==S){s=S;if((a.isJapan||a.isChinaT)&&(s===g.PictureSingle.E||s===g.PictureSingle.EraYear)){var F=void 0,C=void 0;s=!(r+p+1<t.length)||(F=t.charCodeAt(r+p))!==L&&F!==x||(C=t.charCodeAt(r+p+1))!==K&&C!==U&&C!==B?g.PictureSingle.EraYear:g.PictureSingle.E}if(s===g.PictureSingle.BidiDate||s===g.PictureSingle.EngYearTh){F=void 0;if(r+p<t.length&&((F=t.charCodeAt(r+p))===W||F===G))return{kind:F===W?ae.LatinDate:ae.BidiDate,tokenStr:t.substring(r,r+p+1),count:1};s=g.PictureSingle.EngYearTh}if(s===g.PictureSingle.BidiNum)throw new Be(this.notFormatString("bidi num not allowed"));switch(s){case g.PictureSingle.Star:case g.PictureSingle.Underscore:if(r+p>=t.length)throw new Be(this.notFormatString("unterminated "+m));F=(0,y.stringCodePointAt)(t,r+p);var E=(0,y.numCodeUnits)(F),P=(0,y.stringFromCodePoint)(F);return{kind:s,tokenStr:l=t.substring(r,r+p+E),escaped:P};case g.PictureSingle.Backslash:return this.readToken_Backslash(t,r,p);case g.PictureSingle.Quote:var k=t.indexOf(m,r+p);if(k<0)throw new Be(this.notFormatString("unterminated quoted string"));var T=t.substring(r+p,k),A=(l=t.substring(r,k+p),le(a,a.pictureSpecial,T,0));return void 0!==A&&A===g.PictureSpecial.Currency&&de(a.pictureSpecial,A).length===T.length?{kind:ae.Currency,tokenStr:l}:{kind:ae.StrLit,tokenStr:l,escaped:T};case g.PictureSingle.E:if(a.isEastAsia){if(void 0!==e.dbnum)throw new Be(this.notFormatString("invalid DBNUM with exp"));if(e.dbnumForbidden)throw new Be((0,v.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}if(r+p>=t.length)throw new Be(this.notFormatString("unterminated exp"));if((F=t.charCodeAt(r+p))!==x&&F!==L)throw new Be(this.notFormatString("exp not followed by sign"));l=t.substring(r,r+p+1);return{kind:ae.Exp,tokenStr:l,eStr:m,isNeg:F===L};case g.PictureSingle.Hash:case g.PictureSingle.Year:case g.PictureSingle.Month:case g.PictureSingle.Day:case g.PictureSingle.Hour:case g.PictureSingle.Minute:case g.PictureSingle.Second:case g.PictureSingle.YearTh:case g.PictureSingle.MonthTh:case g.PictureSingle.DayTh:case g.PictureSingle.HourTh:case g.PictureSingle.MinuteTh:case g.PictureSingle.SecondTh:case g.PictureSingle.EngYearTh:case g.PictureSingle.ThYear:case g.PictureSingle.Question:case g.PictureSingle.Comma:case g.PictureSingle.Reign:case g.PictureSingle.LocDay:case g.PictureSingle.Era:case g.PictureSingle.EraYear:if(s===g.PictureSingle.Reign&&!a.isJapan&&!a.isChinaT)break;for(var _=p,I=1;(0,b.stringStartsWith)(t,m,r+_)&&void 0===le(a,a.pictureSpecial,t,r+_);)_+=p,I+=1;if(s===g.PictureSingle.LocDay&&I<3)break;return{kind:s,tokenStr:l=t.substring(r,r+_),count:I};case g.PictureSingle.Sep:case g.PictureSingle.Text:case g.PictureSingle.Decimal:case g.PictureSingle.Slash:case g.PictureSingle.Minus:case g.PictureSingle.Plus:return{kind:s,tokenStr:m};case g.PictureSingle.Space:return{kind:ae.Char,tokenStr:m,escaped:m};case g.PictureSingle.Colon:return{kind:s,tokenStr:m,count:1};case g.PictureSingle.Percent:if(a.isEastAsia){if(void 0!==e.dbnum)throw new Be(this.notFormatString("invalid DBNUM with pct"));if(e.dbnumForbidden)throw new Be((0,v.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}return{kind:g.PictureSingle.Percent,tokenStr:m};case g.PictureSingle.DateSep:return m===de(a.pictureSingle,g.PictureSingle.Slash)?{kind:g.PictureSingle.Slash,tokenStr:m}:m===de(a.pictureSingle,g.PictureSingle.Minus)?{kind:g.PictureSingle.Minus,tokenStr:m}:{kind:g.PictureSingle.DateSep,tokenStr:m,count:1};case g.PictureSingle.ColorStart:var O=de(a.pictureSingle,g.PictureSingle.ColorEnd),M=t.indexOf(O,r+p);if(M<0)throw new Be(this.notFormatString("unterminated ["));var D=t.substring(r+p,M),w=(l=t.substring(r,M+O.length),le(a,oe,D,0));if(void 0!==w){for(var z=de(oe,w).length;z<D.length&&(0,R.isSpace)(D.charCodeAt(z));)z+=1;var Q=(0,R.parseSignedLiteral)(a,i,D,z,!1);if(Q[1]===z)throw new Be((0,v.notImplemented)(["invalid number in condition"]));if(Q[1]!==D.length)throw new Be((0,v.notImplemented)(["trailing junk after condition"]));return{kind:ae.Cond,tokenStr:l,cond:{operator:se[w],operand:Q[0]}}}var Y=le(a,a.pictureColor,D,0);if(void 0!==Y){var J=de(a.pictureColor,Y);if(Y!==g.PictureColor.Color){if(J.length!==D.length)throw new Be((0,v.notImplemented)(["trailing junk after named color"]));return{kind:ae.Color,tokenStr:l,color:(c=Y,g.PictureColor[c])}}if(Y===g.PictureColor.Color){for(var $=J.length;$<D.length&&(0,R.isSpace)(D.charCodeAt($));)$+=1;var X=(0,R.parseUint)(a,4,D,$),Z=X[0],ee=X[1];if(ee===$)throw new Be(this.notFormatString("missing number for numbered color"));if(ee!==D.length)throw new Be((0,v.notImplemented)(["trailing junk after numbered color"]));if(Z<1||Z>56)throw new Be(this.notFormatString("out-of-range numbered color"));return{kind:ae.Color,tokenStr:l,color:Z+8}}}var te=le(a,a.pictureDbnum,D,0);if(void 0!==te){if(de(a.pictureDbnum,te).length!==D.length)throw new Be((0,v.notImplemented)(["trailing junk after DBNUM"]));return{kind:ae.Dbnum,tokenStr:l,dbnum:ie(te)}}return(0,b.stringStartsWith)(D,"$")?f.__assign({kind:ae.CurrCode,tokenStr:l},this.parseCurrCode(D.substring("$".length))):{kind:s,tokenStr:m};case g.PictureSingle.ColorEnd:return{kind:s,tokenStr:m};case g.PictureSingle.OpenParen:case g.PictureSingle.CloseParen:return{kind:s,tokenStr:m,escaped:m};case g.PictureSingle.Extra:case g.PictureSingle.APDelim:case g.PictureSingle.Nen1:case g.PictureSingle.Gatsu1:case g.PictureSingle.Nichi1:case g.PictureSingle.Nen2:case g.PictureSingle.Gatsu2:case g.PictureSingle.Nichi2:break;case g.PictureSingle.Zero:case g.PictureSingle.ZeroTh:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",s)}}if(a.isNumeral(d)){if(a.getNumberShape(d)!==N.NumberShape.ASCII)throw new Be((0,v.notImplemented)(["non-ASCII digits"]));var re=a.getOrdinal(d);if(0===re){var ne=p;for(I=1;(0,b.stringStartsWith)(t,m,r+ne);)ne+=p,I+=1;l=t.substring(r,r+ne);return{kind:g.PictureSingle.Zero,tokenStr:l,count:I}}return{kind:ae.Numeral,tokenStr:m,ordinal:re}}switch(d){case V:return{kind:g.PictureSingle.OpenParen,tokenStr:m,escaped:m};case j:return{kind:g.PictureSingle.CloseParen,tokenStr:m,escaped:m};case H:return this.readToken_Backslash(t,r,p);case q:if(a.isThai)return{kind:ae.PrefixDigTh,tokenStr:m}}return{kind:ae.Char,tokenStr:m,escaped:m}},e.prototype.readToken_Backslash=function(e,t,r){if(t+r>=e.length)throw new Be(this.notFormatString("unterminated backslash"));var n=(0,y.stringCodePointAt)(e,t+r),i=(0,y.numCodeUnits)(n),a=(0,y.stringFromCodePoint)(n),o=e.substring(t,t+r+i);return n===V||n===j?{kind:n===V?g.PictureSingle.OpenParen:g.PictureSingle.CloseParen,tokenStr:o,escaped:a}:{kind:ae.Char,tokenStr:o,escaped:a}},e.prototype.convertTokToSun=function(e){var t,r,n,i,a,o,s,u=this,l=e.color,c=e.dbnum,d=e.cond,p=e.currCode,f=e.tokens,S=this.config.localeInfo,y={suns:[],dtrRounding:_.Rounding.RoundSec,color:l,dbnum:c,currCode:p,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===d&&void 0===l&&void 0===c&&void 0===p}},F=0===S.stringCompareCI(de(S.pictureSingle,g.PictureSingle.Month),de(S.pictureSingle,g.PictureSingle.Minute)),C=!1,R=0,b=0,E=!1,k=!1,T=!1,A=!1,N=0,I=function(e,t){var n=Te[e];if(t){if(k)throw new Be(u.notFormatString("more than one absolute time"));if(void 0!==r&&n>=r)throw new Be(u.notFormatString("absolute time must be largest division"));k=!0}else if(k&&n<=r)throw new Be((0,v.notImplemented)(["larger time division after absolute time"]));(void 0===r||n<r)&&(r=n)};function O(e,t,n){var i=r;if(I(e,t),e===g.PictureSingle.Hour||e===g.PictureSingle.HourTh)T=!0,a=n,o=void 0;else if(e===g.PictureSingle.Second||e===g.PictureSingle.SecondTh)if(void 0===o||k)void 0===i&&(T=!0);else{var s=o.code[0];(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",s.kind===g.PictureSingle.Month);var u=g.PictureSingle.Minute,l=s.count;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===l||2===l);I(u,!1),R-=1,b+=1,o.code=[{kind:u,count:l,isAbs:!1}],o=void 0}else T=!1}function M(e){var t=de(S.pictureSingle,e.kind);return{kind:Fe.TimeSep,printAsTimeSep:R>0||b>0,formattedStr:t}}function D(e){var t=de(S.pictureSingle,e.kind);return t===de(S.pictureSingle,g.PictureSingle.DateSep)?{kind:Fe.DateSep}:t===de(S.pictureSingle,g.PictureSingle.Colon)?M(e):{kind:Fe.Char,formattedStr:t}}for(var w=0;w<f.length;w+=1){var L=f[w];switch(L.kind){case ae.AMPM:case ae.AMPMFE:case g.PictureSingle.Colon:case g.PictureSingle.DateSep:case g.PictureSingle.Year:case g.PictureSingle.Month:case g.PictureSingle.Day:case g.PictureSingle.Hour:case g.PictureSingle.Minute:case g.PictureSingle.Second:case g.PictureSingle.Reign:case g.PictureSingle.LocDay:case g.PictureSingle.Era:case g.PictureSingle.EraYear:case g.PictureSingle.EngYearTh:case ae.LatinDate:case ae.BidiDate:case g.PictureSingle.DayTh:case g.PictureSingle.MonthTh:case g.PictureSingle.YearTh:case g.PictureSingle.ThYear:case g.PictureSingle.HourTh:case g.PictureSingle.MinuteTh:case g.PictureSingle.SecondTh:var x={kind:Ne.Date,code:[]};switch(y.suns.push(x),E=!0,L.kind){case ae.LatinDate:case ae.BidiDate:if(0!==w&&(1!==w||f[0].kind!==ae.CurrCode))throw new Be(this.notFormatString("bidi date must be first"));x.code.push(L);break;case g.PictureSingle.DateSep:x.code.push({kind:Fe.DateSep});break;case g.PictureSingle.Colon:x.code.push(M(L));break;case g.PictureSingle.Reign:R+=1,S.isJapan&&L.count>=2&&x.code.push({kind:g.PictureSingle.Era,count:3}),x.code.push({kind:g.PictureSingle.EraYear,count:S.isChinaT?1:2});break;case g.PictureSingle.Era:R+=1,x.code.push({kind:g.PictureSingle.Era,count:(0,P.fastMin)(3,L.count)});break;case g.PictureSingle.EraYear:R+=1,x.code.push({kind:g.PictureSingle.EraYear,count:(0,P.fastMin)(2,L.count)});break;case g.PictureSingle.Year:case g.PictureSingle.YearTh:case g.PictureSingle.EngYearTh:case g.PictureSingle.ThYear:o=void 0,R+=1,x.code.push({kind:L.kind,count:L.count<=2?2:4});break;case g.PictureSingle.Month:if(F&&L.count<=2){if(T){O(ee=g.PictureSingle.Minute,K=!1,x),b+=1,x.code.push({kind:ee,count:L.count,isAbs:K}),T=!1;break}o=x}else o=void 0;R+=1,x.code.push({kind:L.kind,count:(0,P.fastMin)(5,L.count)});break;case g.PictureSingle.MonthTh:R+=1,x.code.push({kind:L.kind,count:(0,P.fastMin)(4,L.count)});break;case g.PictureSingle.Day:case g.PictureSingle.DayTh:o=void 0,R+=1,x.code.push({kind:L.kind,count:(0,P.fastMin)(4,L.count)});break;case g.PictureSingle.LocDay:o=void 0,R+=1,x.code.push({kind:g.PictureSingle.LocDay,count:3===L.count?3:4});break;case g.PictureSingle.Hour:case g.PictureSingle.HourTh:case g.PictureSingle.Minute:case g.PictureSingle.MinuteTh:case g.PictureSingle.Second:case g.PictureSingle.SecondTh:var K=!1;O(L.kind,K,x),b+=1;var U=(0,P.fastMin)(2,L.count);L.kind===g.PictureSingle.Hour||L.kind===g.PictureSingle.HourTh?x.code.push({kind:L.kind,count:U,isAbs:K,isAMPM:!1}):x.code.push({kind:L.kind,count:U,isAbs:K});break;case ae.AMPM:case ae.AMPMFE:if(k)throw new Be(this.notFormatString("AM/PM after absolute time"));if(L.count>1)throw new Be((0,v.notImplemented)(["multiple AM/PM symbols"]));if(void 0!==a)(Q=a.code[0]).isAMPM=!0,a=void 0;A=!0,x.code.push(L);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",L)}break;case g.PictureSingle.Decimal:case ae.Numeral:case g.PictureSingle.Hash:case g.PictureSingle.Zero:case g.PictureSingle.Question:case g.PictureSingle.Comma:if(E){if(L.kind!==g.PictureSingle.Decimal&&L.kind!==g.PictureSingle.Comma)throw new Be(this.notFormatString("number picture in date/time format"));var B={kind:Ne.Date,code:[]};y.suns.push(B);var W=f[w+1];if(L.kind===g.PictureSingle.Decimal&&(null==W?void 0:W.kind)===g.PictureSingle.Zero){var G=W.count;if(G>3)throw new Be(this.notFormatString("invalid number of fractional seconds"));w+=1,O(g.PictureSingle.Second,!1,B),b+=1,B.code.push({kind:Fe.FracSeconds,rounding:G}),y.dtrRounding=(0,P.fastMax)(y.dtrRounding,G)}else B.code.push(D(L));break}if(L.kind===g.PictureSingle.Comma){var V=de(S.pictureSingle,L.kind),j={kind:Ne.Other,code:[{kind:Fe.Char,formattedStr:V}]};y.suns.push(j);break}x={kind:Ne.Num,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};y.suns.push(x),void 0===n&&(n=x),i=x;var q=void 0;for(w-=1;w+1<f.length;w+=1){var H=f[w+1],z=!0;switch(H.kind){case g.PictureSingle.Decimal:C=x.decimal=!0,x.code.push(H),q=void 0;break;case ae.Numeral:x.code.push({kind:H.kind,formattedStr:H.tokenStr,ordinal:H.ordinal}),x.numVal=x.nonZero=!0,q=void 0;break;case g.PictureSingle.Hash:case g.PictureSingle.Zero:case g.PictureSingle.Question:if(x.decimal?x.numDigDec+=H.count:x.numDigLeft+=H.count,void 0===x.firstDig&&(x.firstDig=H.kind),x.lastDig=H.kind,H.kind===g.PictureSingle.Hash?x.anyHash=!0:H.kind===g.PictureSingle.Question?x.anyQuestion=!0:(x.anyZero=!0,x.numVal=!0),void 0!==q&&q.kind===H.kind)q.count+=H.count;else{var Q={kind:H.kind,count:H.count};x.code.push(Q),q=Q}break;case g.PictureSingle.Comma:W=null===(t=f[w+2])||void 0===t?void 0:t.kind;if((s=W)!==ae.Numeral&&s!==g.PictureSingle.Hash&&s!==g.PictureSingle.Zero&&s!==g.PictureSingle.Question){U=H.count;var Y=de(S.pictureSingle,g.PictureSingle.Space);Y===de(S.pictureSingle,g.PictureSingle.Comma)&&(!S.isCurrencySymbolLead&&S.isCurrencySepBySpace&&W===ae.Currency||S.isPercentSepBySpace&&W===g.PictureSingle.Percent)&&(x.code.push({kind:Fe.Char,formattedStr:Y}),U-=1),U>0&&(x.numThousands+=U)}else C||(x.comma=!0);break;default:z=!1}if(!z)break}break;case g.PictureSingle.Percent:N+=1;x={kind:Ne.Percent,code:[{kind:g.PictureSingle.Percent,formattedStr:L.tokenStr}]};y.suns.push(x),y.hasPercent=!0;break;case ae.Exp:x={kind:Ne.Exp,code:[{kind:ae.Exp,formattedStr:L.eStr,isNeg:L.isNeg}],isNeg:L.isNeg};y.suns.push(x);break;case ae.General:x={kind:Ne.General,code:[L]};y.suns.push(x);break;case g.PictureSingle.Text:x={kind:Ne.Text,code:[L]};y.suns.push(x);break;case g.PictureSingle.Slash:if(E){var J={kind:Ne.Date,code:[D(L)]};y.suns.push(J);break}x={kind:Ne.Fraction,code:[{kind:g.PictureSingle.Slash,formattedStr:L.tokenStr}]};y.suns.push(x);break;case g.PictureSingle.Star:case ae.PrefixDigTh:case g.PictureSingle.Underscore:case ae.Currency:case ae.CurrCode:case ae.StrLit:x={kind:Ne.Other,code:[L]};y.suns.push(x);break;case g.PictureSingle.ColorEnd:case g.PictureSingle.Plus:x={kind:Ne.Other,code:[{kind:Fe.Char,formattedStr:L.tokenStr}]};y.suns.push(x);break;case g.PictureSingle.OpenParen:case g.PictureSingle.CloseParen:case ae.Char:x={kind:Ne.Other,code:[{kind:Fe.Char,formattedStr:L.escaped}]};y.suns.push(x);break;case g.PictureSingle.Minus:if(E){var $={kind:Ne.Date,code:[D(L)]};y.suns.push($);break}V=de(S.pictureSingle,L.kind),x={kind:Ne.Other,code:[{kind:Fe.Char,formattedStr:V}]};y.suns.push(x);break;case g.PictureSingle.ColorStart:var X=m.WantPic;for(x={kind:Ne.Date,code:[]};w+1<f.length&&X!==m.Done;w+=1){var Z=f[w+1];switch(Z.kind){case g.PictureSingle.ColorEnd:if(X!==m.WantClose)throw new Be(this.notFormatString("unexpected closing ]"));X=m.Done;continue;case g.PictureSingle.Hour:case g.PictureSingle.HourTh:case g.PictureSingle.Month:case g.PictureSingle.Minute:case g.PictureSingle.Second:if(Z.kind===g.PictureSingle.Month&&!F)break;var ee;O(ee=Z.kind===g.PictureSingle.Month?g.PictureSingle.Minute:Z.kind,K=!0,x),b+=1;U=(0,P.fastMin)(2,Z.count);ee===g.PictureSingle.Hour||ee===g.PictureSingle.HourTh?x.code.push({kind:ee,count:U,isAbs:K,isAMPM:!1}):x.code.push({kind:ee,count:U,isAbs:K}),E=!0,X=m.WantClose;continue;case ae.Char:if(Z.tokenStr===de(S.pictureSingle,g.PictureSingle.Space))continue}throw new Be(this.notFormatString("unexpected token after ["))}if(X!==m.Done)throw new Be((0,v.notImplemented)(["semicolon inside [ ]"]));y.suns.push(x);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",L)}if(y.suns.length>=2){var te=y.suns[y.suns.length-2],re=y.suns[y.suns.length-1];if(te.kind===Ne.Other&&re.kind===Ne.Other){var ne=te.code;(0,P.safePush)(ne,re.code),y.suns.pop()}}}(void 0!==n&&(n.numThousands=i.numThousands,n.numPercent=N),A&&void 0!==a)&&((Q=a.code[0]).isAMPM=!0);if(k)for(var ie=0,oe=y.suns;ie<oe.length;ie++){if((x=oe[ie]).kind===Ne.Date)for(var se=0,ue=x.code;se<ue.length;se++){switch((Q=ue[se]).kind){case g.PictureSingle.Hour:case g.PictureSingle.HourTh:case g.PictureSingle.Minute:case g.PictureSingle.MinuteTh:case g.PictureSingle.Second:case g.PictureSingle.SecondTh:Q.isAbs=Te[Q.kind]===r}}}if(y.suns.length>32)throw new Be(this.notFormatString("format string too long: SUNs limit"));return y.hasDate=R>0,y.hasTime=b>0,y},e.prototype.classifySunPartKind=function(e,t){for(var r=e.suns,n=e.isEmpty,i=e.hasDate,a=e.hasTime,o=t===Ie.Number,s=t===Ie.Text,u=!o&&!s,l=0,c=r;l<c.length;l++){var d=c[l];switch(d.kind){case Ne.Num:case Ne.Fraction:case Ne.Percent:case Ne.Exp:o=!0;break;case Ne.Text:s=!0;break;case Ne.General:continue;case Ne.Other:case Ne.Date:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",d)}u=!1}if((o?1:0)+(i||a?1:0)+(s?1:0)>1)throw new Be(this.notFormatString("cannot mix number/date/text"));return o||i||a?Ie.Number:s?Ie.Text:u&&!n?Ie.Either:t},e.prototype.convertSunToCode=function(t){var r,n=t.suns,i=t.isEmpty,a=t.dtrRounding,o=t.color,s=t.dbnum,u=t.currCode,l=this.config.localeInfo,c=[];function d(e){for(var t=e-1;t>=0;t-=1){var r=n[t];if(r.kind===Ne.Num)return[t,r]}}function p(e){for(var t=e+1;t<n.length;t+=1){var r=n[t];if(r.kind===Ne.Num)return[t,r]}}for(var m=!1,g=0,v=0;v<n.length;v+=1){var y=n[v];switch(y.kind){case Ne.Text:if(r===Ne.Text)break;if(void 0!==r)throw new Be(this.notFormatString("@ after other control"));r=Ne.Text;break;case Ne.General:if(void 0!==r)throw new Be(this.notFormatString("General after other control"));if(m)throw new Be(this.notFormatString("General after number"));r=Ne.General;break;case Ne.Num:if(m=!0,r===Ne.General)throw new Be(this.notFormatString("number after General"));break;case Ne.Fraction:if(void 0!==r)throw new Be(this.notFormatString("/ after other control"));if(l.isEastAsia&&void 0!==s)throw new Be(this.notFormatString("/ not allowed with DBNUM"));r=Ne.Fraction;var F=d(v);if(void 0===F)throw new Be(this.notFormatString("no number before /"));var C=this.mergeNumSuns(n,g,F[0]),R=C[0],b=C[1],E=C[2],k=p(v);if(void 0===k)throw new Be(this.notFormatString("no number after /"));var T=n.slice(F[0]+1,k[0]),A=void 0!==p(k[0]);(0,P.safePush)(c,this.flattenSuns(R)),(0,P.safePush)(c,this.buildFractCode(b,E,F[1],T,k[1],A)),g=k[0]+1;break;case Ne.Exp:if(void 0!==r)throw new Be(this.notFormatString("E after other control"));r=Ne.Exp;var N=this.mergeNumSuns(n,g,v),_=N[0],I=N[1],O=N[2];if(void 0===I)throw new Be(this.notFormatString("no number before E"));var M=this.mergeNumSuns(n,v+1,n.length),D=M[0],w=M[1],L=M[2];if(void 0===w)throw new Be(this.notFormatString("no number after E"));(0,P.safePush)(c,this.flattenSuns(_)),(0,P.safePush)(c,this.buildExpCode(y.isNeg,I,f.__spreadArray(f.__spreadArray(f.__spreadArray([],O,!0),[n[v]],!1),D,!0),w)),(0,P.safePush)(c,this.flattenSuns(L)),g=n.length;break;case Ne.Percent:case Ne.Other:case Ne.Date:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",y)}}if(void 0===r){var x=this.mergeNumSuns(n,g,n.length),K=(R=x[0],x[1]),U=x[2];void 0!==K?(0,P.safePush)(c,this.buildNumberCode(R,K)):(0,P.safePush)(c,this.flattenSuns(R)),(0,P.safePush)(c,this.flattenSuns(U)),g=n.length}(0,P.safePush)(c,this.flattenSuns(n.slice(g))),0!==n.length||i||c.push(Oe);var B=null==u?void 0:u.tag;if((0,S.isSystemCultureTag)(B)){var W=B===S.CultureTag.SysDate?l.sysDateFormat:l.sysTimeFormat,G=new e(this.config,{old:void 0,formatString:W,source:S.NumberFormatSource.System}),V=G.parts[_e.Pos];return{part:{code:[{kind:Fe.SysFormat,codeSysFormat:V.code,codeThisFormat:c}],color:V.color,dbnum:V.dbnum,dtrRounding:V.dtrRounding},applyCurrCode:G.thisCurrCode}}return{part:{code:c,color:o,dbnum:s,dtrRounding:a},applyCurrCode:u}},e.prototype.flattenSuns=function(e){return(0,P.safeConcat)([],e.map((function(e){return e.code})))},e.prototype.buildExpCode=function(e,t,r,n){if(n.comma)throw new Be(this.notFormatString("comma following E"));var i=t.numDigDec;if(i>127)throw new Be(this.notFormatString("too many decimal digits"));var a=this.bumpDigitsForComma(t),o=a.code,s=a.comma,u=a.numDigLeft;return[{kind:Fe.Exp,isNeg:e,numMantDigLeft:u,numMantDigDec:i,numExpDigLeft:n.numDigLeft,commaMant:s,codeMant:o,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]},e.prototype.buildNumberCode=function(e,t){var r=t.numDigDec;if(r>127)throw new Be(this.notFormatString("too many decimal digits"));var n=this.bumpDigitsForComma(t),i=n.code,a=n.comma,o=n.numDigLeft;return[{kind:Fe.Num,numDigLeft:o,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:a,codeBefore:this.flattenSuns(e),code:i}]},e.prototype.buildFractCode=function(e,t,r,n,i,a){var o,s,u,l,c=this.config.mathpack;if(r.comma)throw new Be(this.notFormatString("comma in numerator"));if(r.decimal)throw new Be((0,v.notImplemented)(["decimals in numerator"]));if(i.comma)throw new Be(this.notFormatString("comma in denominator"));if(i.decimal)throw new Be(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new Be(this.notFormatString("decimals in numerator"));if((l=i).numVal&&l.nonZero&&l.digitTokens)throw new Be(this.notFormatString("literal and placeholder digits mixed in denominator"));if(a)throw new Be((0,v.notImplemented)(["fraction number formats with trailing numbers"]));var d,p=!1,m=0;if(void 0!==e){if(!e.reallyNum)throw new Be((0,v.notImplemented)(["fixed numerals in fraction integer part"]));if(e.decimal)throw new Be((0,v.notImplemented)(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new Be(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new Be((0,v.notImplemented)(["numerals in fraction integer part"]));d=(o=this.bumpDigitsForComma(e)).code,p=o.comma,m=o.numDigLeft}var f=null!==(s=null==e?void 0:e.numPercent)&&void 0!==s?s:r.numPercent,S=null!==(u=null==e?void 0:e.numThousands)&&void 0!==u?u:r.numThousands;if(S>0)throw new Be((0,v.notImplemented)(["fraction number formats with thousands"]));var y,F=i.code,C=i.numDigLeft,R=i.firstDig;if(i.numVal&&i.nonZero){if(a)throw new Be((0,v.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(i.code.length>5)throw new Be((0,v.notImplemented)(["too many digits in denominator"]));for(var b=0,E=0;E<i.code.length;E+=1){var P=i.code[E];switch(P.kind){case ae.Numeral:b=10*b+P.ordinal;break;case g.PictureSingle.Zero:if(0===E)throw new Be((0,v.notImplemented)(["leading zero in denominator"]));b*=10;break;default:return(0,h.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(b>32767)throw new Be((0,v.notImplemented)(["overflow in denominator not emulated"]));F=[{kind:g.PictureSingle.Hash,count:1}],C=1,R=void 0,y=c.fromNumber(b)}return[{kind:Fe.Fraction,numIntDigLeft:m,numPercent:f,numThousands:S,numNumerDig:r.numDigLeft,numDenomDig:C,commaInt:p,codeInt:d,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:F,denomValue:y,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:R,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]},e.prototype.mergeNumSuns=function(e,t,r){for(var n,i=[],a=[],o=t;o<e.length&&o<r;o+=1){var s=e[o];void 0!==n?s.kind===Ne.Num?(n.decimal?n.numDigDec+=s.numDigLeft+s.numDigDec:(n.numDigLeft+=s.numDigLeft,n.numDigDec+=s.numDigDec),n.comma=n.comma||s.comma,n.decimal=n.decimal||s.decimal,n.numVal=n.numVal||s.numVal,n.nonZero=n.nonZero||s.nonZero,void 0!==s.lastDig&&(n.lastDig=s.lastDig),void 0===n.firstDig&&(n.firstDig=s.firstDig),n.anyHash=n.anyHash||s.anyHash,n.anyQuestion=n.anyQuestion||s.anyQuestion,n.anyZero=n.anyZero||s.anyZero,(0,P.safePush)(n.code,this.flattenSuns(a)),a.length=0,(0,P.safePush)(n.code,s.code)):a.push(s):s.kind===Ne.Num?n=s:i.push(s)}return[i,n,a]},e.prototype.bumpDigitsForComma=function(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;for(var t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1,n=0;n<e.code.length;n+=1){var i=e.code[n];switch(i.kind){case g.PictureSingle.Hash:return(a=e.code.slice())[n]=f.__assign(f.__assign({},i),{count:i.count+(r-e.numDigLeft)}),{code:a,comma:!0,numDigLeft:r};case g.PictureSingle.Zero:case g.PictureSingle.Question:case g.PictureSingle.Decimal:var a;return(a=e.code.slice()).splice(n,0,{kind:g.PictureSingle.Hash,count:r-e.numDigLeft}),{code:a,comma:!0,numDigLeft:r}}}throw new Be((0,v.notImplemented)(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(e){if(e.numDigLeft<4)return!1;for(var t=function(e){var t=null==e?void 0:e.kind;return t===g.PictureSingle.Hash||t===g.PictureSingle.Zero||t===g.PictureSingle.Question},r=e.numDigLeft,n=0;n<e.code.length;n+=1){var i=e.code[n];if(i.kind===g.PictureSingle.Decimal)return!1;if(t(i))for(var a=0;a<i.count;a+=1)if((r-=1)>0&&r%3==0&&(a+1<i.count||t(e.code[n+1])))return!0}return!1},e.prototype.parseCurrCode=function(e){var t,r,n,i=this.config.localeInfo,a=e.indexOf("-");if(0!==e.length&&0!==a){if((t=a<0?e:e.substring(0,a)).length>61)throw new Be(this.notFormatString("currencySymbol too long"));for(var o=0,s=(0,y.codePointIterator)(t);o<s.length;o++){var u=s[o];if(i.isNumeral(u)&&i.getNumberShape(u)!==N.NumberShape.ASCII)throw new Be((0,v.notImplemented)(["non-ASCII digits in currencySymbol"]))}}if(a>=0&&(n=e.substring(a+"-".length)),void 0!==n&&void 0===(r=this.parseFormatCulture(n)))throw new Be((0,v.notImplemented)(["unhandled CurrCode: "+(0,D.anonymizeFormulaString)(e)]));if((0,S.isSystemCultureTag)(null==r?void 0:r.tag)){if(void 0!==t)throw new Be(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===S.NumberFormatSource.System)throw new Be(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:t,currCode:r}},e.prototype.parseFormatCulture=function(e){var t,r,n={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},i=e.match(fe);if(null!=i){n.culture=null!==(t=i[1])&&void 0!==t?t:"";var a=null!==(r=i[2])&&void 0!==r?r:i[3];if(null!=a){if(n.tag=ve[a.toLowerCase()],void 0===n.tag)throw new Be((0,v.notImplemented)(["unknown CurrCode tag: "+(0,D.anonymizeFormulaString)(e)]));switch(n.tag){case S.CultureTag.SysDate:case S.CultureTag.SysTime:case S.CultureTag.Euro1:case S.CultureTag.Euro2:case S.CultureTag.Bitcoin1:case S.CultureTag.Bitcoin2:if(""!==n.culture)throw new Be(this.notFormatString("CultureTag ".concat(String(n.tag)," cannot have culture")));break;case S.CultureTag.GenLower:case S.CultureTag.GenUpper:case S.CultureTag.NomLower:case S.CultureTag.Gannen:if(""===n.culture)throw new Be(this.notFormatString("CultureTag ".concat(String(n.tag)," must have culture")))}}var o=i[4];if(null!=o){var s=ye(o),u=(32512&s)>>8;if(0!==u&&(n.numberShape=ge[u],void 0===n.numberShape))throw new Be((0,v.notImplemented)(["unknown number shape ".concat(u," in culture: ").concat((0,D.anonymizeFormulaString)(e))]));n.nationalNumberInput=0!=(32768&s);var l=127&s;if(0!==l&&(n.calendar=he[l],void 0===n.calendar))throw new Be((0,v.notImplemented)(["unknown calendar ".concat(l," in culture: ").concat((0,D.anonymizeFormulaString)(e))]));n.localCalendarInput=0!=(128&s)}return n}if(me.test(e)){var c=ye(e);switch(c){case g.LCID.SystemLongDate:n.tag=S.CultureTag.SysDate;break;case g.LCID.SystemTime:n.tag=S.CultureTag.SysTime;break;case g.LCID.EuroTrailing:n.tag=S.CultureTag.Euro1;break;case g.LCID.EuroLeading:n.tag=S.CultureTag.Euro2;break;default:64512==(64512&c)&&(n.tag=S.CultureTag.GenLower),63488==(64512&c)&&(n.tag=S.CultureTag.GenUpper),62464==(64512&c)&&(n.tag=S.CultureTag.NomLower),void 0!==n.tag&&(c&=-63489),n.culture=(0,w.convertKnownLCID)(c)}return n}},e.prototype.determineValueType=function(){for(var e=this.config.localeInfo,t={accountFill:!1,fvt:void 0},r=0,n=this.parts;r<n.length;r++){var i=n[r];t.accountFill=!1;var a=this.determineValueTypeCodes(t,i.code);if(void 0!==a)return a;if(t.accountFill&&(t.fvt===S.FormatValueType.Number||t.fvt===S.FormatValueType.Currency))return S.FormatValueType.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===de(e.pictureSpecial,g.PictureSpecial.General)?S.FormatValueType.General:S.FormatValueType.Custom},e.prototype.determineValueTypeCodes=function(e,t){for(var r=this.config.localeInfo,n=0;n<t.length;n+=1){var i=t[n];switch(i.kind){case ae.General:break;case g.PictureSingle.Text:return S.FormatValueType.Text;case g.PictureSingle.Star:e.accountFill=!0;break;case Fe.Char:case ae.Exp:case g.PictureSingle.Slash:case ae.StrLit:case g.PictureSingle.Percent:case g.PictureSingle.Underscore:case ae.Numeral:case Fe.DateSep:case Fe.TimeSep:break;case ae.Currency:e.fvt=S.FormatValueType.Currency;break;case ae.CurrCode:void 0!==i.currencySymbol&&(e.fvt=S.FormatValueType.Currency);break;case Fe.Num:e.fvt=1===i.numPercent&&0===i.numThousands?S.FormatValueType.Percentage:S.FormatValueType.Number;var a=i.codeBefore,o=0;if(r.isEastAsia){if(o<a.length&&"("===Ae(a[o])&&(o+=1),o<a.length&&"US$"===Ae(a[o]))return S.FormatValueType.Currency;if(r.isChinaT){if(o<a.length&&"NT$"===Ae(a[o]))return S.FormatValueType.Currency}else if(o<a.length&&"$"===Ae(a[o]))return S.FormatValueType.Currency}var s=void 0;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBefore.slice(o))))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.code)))return s;break;case Fe.Exp:e.fvt=S.FormatValueType.Scientific;s=void 0;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeMant)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeExp)))return s;break;case Fe.Fraction:e.fvt=S.FormatValueType.Fraction;s=void 0;if(void 0!==i.codeInt&&void 0!==(s=this.determineValueTypeCodes(e,i.codeInt)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween1)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeNumer)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween2)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeDenom)))return s;break;case g.PictureSingle.Decimal:case g.PictureSingle.Hash:case g.PictureSingle.Zero:case g.PictureSingle.Question:break;case ae.PrefixDigTh:case ae.LatinDate:case ae.BidiDate:break;case g.PictureSingle.HourTh:case g.PictureSingle.MinuteTh:case g.PictureSingle.SecondTh:case g.PictureSingle.Hour:case g.PictureSingle.Minute:case g.PictureSingle.Second:case Fe.FracSeconds:return S.FormatValueType.Time;case ae.AMPM:case ae.AMPMFE:break;case g.PictureSingle.Era:case g.PictureSingle.EraYear:case g.PictureSingle.YearTh:case g.PictureSingle.EngYearTh:case g.PictureSingle.ThYear:case g.PictureSingle.MonthTh:case g.PictureSingle.DayTh:case g.PictureSingle.Year:case g.PictureSingle.Month:case g.PictureSingle.Day:case g.PictureSingle.LocDay:return S.FormatValueType.Date;case Fe.SysFormat:return this.determineValueTypeCodes(e,i.codeThisFormat);default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",i)}}},e.prototype.determineDecimals=function(){for(var e=0,t=this.parts[_e.Pos].code;e<t.length;e++){var r=t[e];switch(r.kind){case Fe.Num:return r.numDigDec;case Fe.Exp:return r.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var e=de(this.config.localeInfo.pictureSingle,g.PictureSingle.BidiDate);return(0,b.stringStartsWith)(this.formatString,e+"1")?S.BidiDate.English:(0,b.stringStartsWith)(this.formatString,e+"2")?S.BidiDate.Lunar:void 0},e.prototype.printFormatString=function(){var e=this.config.localeInfo,t=this.parts,r=t[0],n=t[1],i=t[2],a=t[3],o=!(we(a)||a===r),s=this.posBeforeText||!o,u="";return s&&(u+=this.printPart(r,this.condPos),n!==r&&(u+=de(e.pictureSingle,g.PictureSingle.Sep),u+=this.printPart(n,this.condNeg),i!==r&&(u+=de(e.pictureSingle,g.PictureSingle.Sep),u+=this.printPart(i,void 0)))),o&&(s&&(u+=de(e.pictureSingle,g.PictureSingle.Sep)),u+=this.printPart(a,void 0)),u},e.prototype.printPart=function(e,t){var r,n=this.config,i=n.mathpack,a=n.localeInfo,o="";if(void 0!==e.color&&(o+=de(a.pictureSingle,g.PictureSingle.ColorStart)+("number"==typeof e.color?de(a.pictureColor,g.PictureColor.Color)+String(e.color-8):de(a.pictureColor,(r=e.color,g.PictureColor[r])))+de(a.pictureSingle,g.PictureSingle.ColorEnd)),void 0!==t){o+=de(a.pictureSingle,g.PictureSingle.ColorStart)+de(oe,ue[t.operator])+i.formatGeneral(a,t.operand,21)+de(a.pictureSingle,g.PictureSingle.ColorEnd)}return void 0!==e.dbnum&&(o+=de(a.pictureSingle,g.PictureSingle.ColorStart)+de(a.pictureDbnum,e.dbnum-1)+de(a.pictureSingle,g.PictureSingle.ColorEnd)),o+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0)},e.prototype.printCodes=function(e,t,r){var n,i=this.config,a=i.mathpack,o=i.localeInfo,s="";if(void 0!==r&&r.numThousands>0){for(var u=0;u<t.length;u+=1){var l=t[u].kind;l!==g.PictureSingle.Zero&&l!==g.PictureSingle.Hash&&l!==g.PictureSingle.Question&&l!==g.PictureSingle.Decimal&&l!==ae.Numeral||(n=u)}(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==n)}var c=function(i){var u=t[i],l=e.wasPrevDig;switch(e.wasPrevDig=!1,u.kind){case ae.General:s+=de(o.pictureSpecial,g.PictureSpecial.General);break;case g.PictureSingle.Decimal:void 0!==r&&(r.decimal=!0),e.wasPrevDig=!0,s+=de(o.pictureSingle,g.PictureSingle.Decimal);break;case g.PictureSingle.Hash:case g.PictureSingle.Zero:case g.PictureSingle.Question:e.seenDig=!0,e.wasPrevDig=!0;var c=u.kind===g.PictureSingle.Zero?"0":de(o.pictureSingle,u.kind),p=(0,b.repeat)(c,u.count);if(void 0===r||r.decimal){s+=p;break}if(r.comma){var m=r.numDigLeft-u.count;s+=(0,T.insertCommas)({isThousandsPosition:function(e){var r,n;return e>0&&e%3==0&&(e>m||((n=null===(r=t[i+1])||void 0===r?void 0:r.kind)===g.PictureSingle.Hash||n===g.PictureSingle.Zero||n===g.PictureSingle.Question))},thousandsSeparator:de(o.pictureSingle,g.PictureSingle.Comma)},p,m)}else s+=p;r.numDigLeft-=u.count;break;case ae.Numeral:e.wasPrevDig=!0,s+=u.formattedStr;break;case Fe.Exp:s+=d.printCodes(e,u.codeMant,{comma:u.commaMant,numThousands:0,decimal:!1,numDigLeft:u.numMantDigLeft})+d.printCodes(e,u.codeBetween,void 0)+d.printCodes(e,u.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:u.numExpDigLeft});break;case Fe.Num:s+=d.printCodes(e,u.codeBefore,void 0)+d.printCodes(e,u.code,{comma:u.comma,numThousands:u.numThousands,decimal:!1,numDigLeft:u.numDigLeft});break;case Fe.Fraction:var f=void 0===u.codeInt?"":d.printCodes(e,u.codeInt,{comma:u.commaInt,numThousands:0,decimal:!1,numDigLeft:u.numIntDigLeft}),v=d.printCodes(e,u.codeBetween1,void 0),F=d.printCodes(e,u.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:u.numNumerDig}),C=d.printCodes(e,u.codeBetween2,void 0),R=d.printCodes(e,u.codeDenom,{comma:!1,numThousands:u.numThousands,decimal:!1,numDigLeft:u.numDenomDig});s+=f+v+F+C+(void 0!==u.denomValue?J(a,u.denomValue):R);break;case Fe.Char:var E=de(o.pictureSingle,g.PictureSingle.Backslash),P=ce(o,o.pictureSingle,u.formattedStr,0),k=function(e,t,r,n){for(var i=r.substring(n,n+(0,y.numCodeUnits)((0,y.stringCodePointAt)(r,n))),a=0;a<t.length;a+=1){var o=t[a];if(null!=o&&0!==o.length){var s=o.substring(0,(0,y.numCodeUnits)((0,y.stringCodePointAt)(o,0)));if(0===e.stringCompareCI(i,s))return!0}}return!1}(o,o.pictureSpecial,u.formattedStr,0);if(void 0!==P&&P!==g.PictureSingle.Extra&&P!==g.PictureSingle.Zero)switch(P){case g.PictureSingle.Comma:var A=t[i+1];if(l){var N=de(o.pictureSingle,g.PictureSingle.Space);if(u.formattedStr!==N||void 0===A||(o.isCurrencySymbolLead||!o.isCurrencySepBySpace||A.kind!==ae.Currency)&&(!o.isPercentSepBySpace||A.kind!==g.PictureSingle.Percent)){s+=E;break}}if((null==A?void 0:A.kind)===Fe.Char&&(null==A?void 0:A.formattedStr)===u.formattedStr){s+=E;break}break;case g.PictureSingle.Decimal:s+=E;break;case g.PictureSingle.Slash:e.seenDig&&(s+=E);break;case g.PictureSingle.Space:case g.PictureSingle.Minus:case g.PictureSingle.Plus:case g.PictureSingle.OpenParen:case g.PictureSingle.CloseParen:break;case g.PictureSingle.DateSep:de(o.pictureSingle,g.PictureSingle.DateSep)!==de(o.pictureSingle,g.PictureSingle.Minus)&&(s+=E);break;default:s+=E}else(k||o.isNumeral((0,y.stringCodePointAt)(u.formattedStr,0)))&&(s+=E);s+=u.formattedStr;break;case ae.Exp:s+=u.formattedStr+(u.isNeg?"-":"+");break;case ae.StrLit:E=de(o.pictureSingle,g.PictureSingle.Quote);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",u.escaped.indexOf(E)<0),s+=E+u.escaped+E;break;case g.PictureSingle.Slash:s+=de(o.pictureSingle,g.PictureSingle.Slash);break;case g.PictureSingle.Percent:s+=de(o.pictureSingle,g.PictureSingle.Percent);break;case g.PictureSingle.Star:s+=de(o.pictureSingle,g.PictureSingle.Star)+u.escaped;break;case g.PictureSingle.Underscore:s+=de(o.pictureSingle,g.PictureSingle.Underscore)+u.escaped;break;case ae.PrefixDigTh:s+="t";break;case ae.Currency:s+=de(o.pictureSpecial,g.PictureSpecial.Currency);break;case ae.CurrCode:if(s+=de(o.pictureSingle,g.PictureSingle.ColorStart),s+="$",void 0!==u.currencySymbol&&(s+=u.currencySymbol),void 0!==u.currCode){var _=u.currCode,I=_.culture,O=_.numberShape,M=_.nationalNumberInput,D=_.calendar,w=_.localCalendarInput,L=_.tag;switch(s+="-",typeof I){case"number":var x=I;switch((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes lcid",void 0===O&&!M&&void 0===D&&!w),L){case void 0:break;case S.CultureTag.GenLower:x|=64512;break;case S.CultureTag.GenUpper:x|=63488;break;case S.CultureTag.NomLower:x|=62464;break;default:(0,h.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}var K=Se(x);/^[a-f]{1,7}$/i.test(K)&&(K="0"+K),s+=K;break;case"string":s+=I,void 0!==L&&(""!==I&&(s+="-"),s+="x-",s+=String(L));var U=0;void 0!==O&&(U|=ge.indexOf(O)<<8),M&&(U|=32768),void 0!==D&&(U|=he.indexOf(D)),w&&(U|=128),0!==U&&(s+=",",s+=Se(U))}}s+=de(o.pictureSingle,g.PictureSingle.ColorEnd);break;case g.PictureSingle.Text:s+=de(o.pictureSingle,g.PictureSingle.Text);break;case ae.LatinDate:s+=de(o.pictureSingle,g.PictureSingle.BidiDate)+"1";break;case ae.BidiDate:s+=de(o.pictureSingle,g.PictureSingle.BidiDate)+"2";break;case Fe.FracSeconds:s+=de(o.pictureSingle,g.PictureSingle.Decimal)+(0,b.repeat)("0",u.rounding);break;case Fe.DateSep:s+=de(o.pictureSingle,g.PictureSingle.DateSep);break;case Fe.TimeSep:s+=de(o.pictureSingle,g.PictureSingle.Colon);break;case g.PictureSingle.Era:case g.PictureSingle.EraYear:case g.PictureSingle.Year:case g.PictureSingle.YearTh:case g.PictureSingle.EngYearTh:case g.PictureSingle.ThYear:case g.PictureSingle.Month:case g.PictureSingle.MonthTh:case g.PictureSingle.Day:case g.PictureSingle.DayTh:case g.PictureSingle.LocDay:s+=(0,b.repeat)(de(o.pictureSingle,u.kind),u.count);break;case g.PictureSingle.Hour:case g.PictureSingle.HourTh:case g.PictureSingle.Minute:case g.PictureSingle.MinuteTh:case g.PictureSingle.Second:case g.PictureSingle.SecondTh:if(u.isAbs){s+=de(o.pictureSingle,g.PictureSingle.ColorStart)+(0,b.repeat)(de(o.pictureSingle,u.kind),u.count)+de(o.pictureSingle,g.PictureSingle.ColorEnd);break}s+=(0,b.repeat)(de(o.pictureSingle,u.kind),u.count);break;case ae.AMPM:case ae.AMPMFE:u.kind===ae.AMPMFE||o.isEastAsia||u.pictureKind===g.PictureSpecial.AP2?s+=u.tokenStr:s+=de(o.pictureSpecial,u.pictureKind);break;case Fe.SysFormat:s+=d.printCodes(e,u.codeThisFormat,void 0);break;default:return{value:(0,h.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",u)}}i===n&&(s+=(0,b.repeat)(de(o.pictureSingle,g.PictureSingle.Comma),r.numThousands))},d=this;for(u=0;u<t.length;u+=1){var p=c(u);if("object"==typeof p)return p.value}return s},e.prototype.countBytecodeBuffer=function(e){for(var t,r,n=this.config,i=n.mathpack,a=n.localeInfo,o=0,s=0;s<e.length;s+=1){var u=e[s],l=1;switch(u.kind){case g.PictureSingle.Percent:case ae.Numeral:case Fe.Char:case g.PictureSingle.Star:case g.PictureSingle.Underscore:l+=2;break;case ae.StrLit:l+=1+2*u.escaped.length;break;case Fe.FracSeconds:case g.PictureSingle.Hash:case g.PictureSingle.Zero:case g.PictureSingle.Question:case ae.Exp:l+=1;break;case g.PictureSingle.Hour:case g.PictureSingle.HourTh:case g.PictureSingle.Minute:case g.PictureSingle.MinuteTh:case g.PictureSingle.Second:case g.PictureSingle.SecondTh:u.isAbs&&(l+=1);break;case Fe.Fraction:if(l+=5,void 0!==u.codeInt&&(l+=this.countBytecodeBuffer(u.codeInt)),l+=this.countBytecodeBuffer(u.codeBetween1),l+=this.countBytecodeBuffer(u.codeNumer),l+=this.countBytecodeBuffer(u.codeBetween2),l+=this.countBytecodeBuffer(u.codeDenom),void 0!==u.denomValue)l-=2,l+=2+2*J(i,u.denomValue).length;u.commaInt&&(l+=1);break;case Fe.Exp:l+=3,l+=this.countBytecodeBuffer(u.codeMant),l+=this.countBytecodeBuffer(u.codeBetween),l+=this.countBytecodeBuffer(u.codeExp),u.commaMant&&(l+=1);break;case Fe.Num:l+=3,l+=this.countBytecodeBuffer(u.codeBefore),l+=this.countBytecodeBuffer(u.code),u.comma&&(l+=1);break;case Fe.SysFormat:l=0,l+=this.countBytecodeBuffer(u.codeThisFormat);break;case ae.CurrCode:l+=2*((null!==(r=null===(t=u.currencySymbol)||void 0===t?void 0:t.length)&&void 0!==r?r:0)+1),l+=8;break;case ae.AMPM:var c=a.isEastAsia||u.pictureKind===g.PictureSpecial.AP2?pe(a,u.tokenStr):a.ampmSymbols;l+=2+2*(c[0].length+c[1].length);break;case ae.AMPMFE:break;case ae.General:case g.PictureSingle.Decimal:case g.PictureSingle.Slash:case ae.PrefixDigTh:case ae.Currency:case g.PictureSingle.Text:case ae.LatinDate:case ae.BidiDate:case Fe.DateSep:case Fe.TimeSep:case g.PictureSingle.Era:case g.PictureSingle.EraYear:case g.PictureSingle.Year:case g.PictureSingle.YearTh:case g.PictureSingle.EngYearTh:case g.PictureSingle.ThYear:case g.PictureSingle.Month:case g.PictureSingle.MonthTh:case g.PictureSingle.Day:case g.PictureSingle.DayTh:case g.PictureSingle.LocDay:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",u)}o+=l}return o},e.prototype.countBytecodePart=function(e){var t=e.code,r=0;return void 0!==e.color&&(r+=2),void 0!==e.dbnum&&(r+=2),0!==e.dtrRounding&&(r+=2),r+=this.countBytecodeBuffer(t)},e.prototype.countBytecode=function(){for(var e=0,t=_e.Pos;t<=_e.Text;t+=1){(t===_e.Pos&&void 0!==this.condPos||t===_e.Neg&&void 0!==this.condNeg)&&(e+=10);for(var r=this.parts[t],n=!1,i=_e.Pos;i<t;i+=1)if(this.parts[i]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e},e.prototype.checkBytecode=function(){if(this.countBytecode()>255)throw new Be(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new Be((0,v.notImplemented)(["format string too long: close to bytecode limit"]))},e.prototype.getBundledLocaleInfo=function(e,t,r){var n=r;switch(t){case N.Calendar.GregorianUS:n=Ce;break;case N.Calendar.GregorianMEFrench:n=Re;break;case N.Calendar.GregorianArabic:n=be;break;case N.Calendar.GregorianXlitEnglish:n=Ee;break;case N.Calendar.GregorianXlitFrench:n=Pe;break;case N.Calendar.UmAlQura:case N.Calendar.Hijri:break;case N.Calendar.Thai:n=ke}if(void 0!==(null==n?void 0:n.culture)&&""!==n.culture){var i=(0,w.getBundledLocaleInfo)(n);if(void 0===i)throw new Ue(this.notImplementedCulture(e,n.culture));return i}return this.config.localeInfo},e.prototype.notFormatString=function(e){return(0,S.notFormatString)("".concat(e," (source=").concat(String(this.source),"): ").concat(this.logFormatString))},e.prototype.notImplementedCulture=function(e,t){var r="number"==typeof t?"lcid:".concat(Se(t)):"lang:".concat(t);return(0,v.notImplemented)(["".concat(e,": culture = ").concat(r)])},e}();t.NumberFormatImpl=We,t.createFormat=function(e,t,r){try{return(0,M.success)(new We(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return e instanceof Be?(0,M.failure)(e.reason):(0,M.failure)((0,M.javaScriptError)(e))}},t.applyFormat=function(e,t,r,n){try{var i=void 0,a=void 0,o=void 0,s=e.config.localeInfo;switch(r.kind){case O.OperKind.String:i=function(e){if(0===e.length)return!1;var t=(0,y.stringCodePointAt)(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?S.Alignment.Right:S.Alignment.Left,a=S.Clip.None,o=r;break;case O.OperKind.Number:i=t.isTextOnly?S.Alignment.Left:S.Alignment.Right,a=S.Clip.All,o=r;break;case O.OperKind.Boolean:i=S.Alignment.Center,a=S.Clip.All,o=(0,F.stringOper)(r.value?s.trueName:s.falseName);break;case O.OperKind.Blank:return(0,M.success)((0,S.formattedValue)([],void 0,S.Alignment.Left,S.Clip.All));case O.OperKind.Error:var u=s.errorNames[r.type];return null==u?(0,M.failure)((0,v.internal)("No locale data for error type ".concat(r.type))):(0,M.success)((0,S.formattedValue)([(0,S.formattedUnitString)(u)],void 0,S.Alignment.Center,S.Clip.All));case O.OperKind.Array:return(0,M.failure)((0,v.notImplemented)(["Array applyFormat"]));case O.OperKind.Rich:return(0,M.failure)((0,v.notImplemented)(["Rich applyFormat"]))}return t.apply(o,i,a,n)}catch(e){return(0,M.failure)((0,M.javaScriptError)(e))}},t.changeFormatDecimals=function(e,t){try{switch(e.valueType){case S.FormatValueType.General:return(0,M.failure)((0,v.notImplemented)(["changeDecimals General"]));case S.FormatValueType.Number:case S.FormatValueType.Currency:case S.FormatValueType.Accounting:case S.FormatValueType.Percentage:case S.FormatValueType.Scientific:if(0===e.decimals&&t<0)return M.successUndefined;var r=(0,P.fastMax)(0,e.decimals+t),n=e.synthesizeDecimals(r);return n.formatString===e.formatString?M.successUndefined:(0,M.success)(n);default:return M.successUndefined}}catch(e){return(0,M.failure)((0,M.javaScriptError)(e))}}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.convertKnownLCID=t.getBundledLocaleInfo=void 0;var i,a=r(114),o=r(66),s={ar:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","s."],["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],["a. m.","p. m."],"z"],fr:[["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ou","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["sijeanj","veljaa","oujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","et","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","etvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sn","mn","tis","ons","tor","fre","lr"],["sndag","mndag","tisdag","onsdag","torsdag","fredag","lrdag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","luned","marted","mercoled","gioved","venerd","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sm."],["duminic","luni","mari","miercuri","joi","vineri","smbt"],["a.m.","p.m."],"z"],ru:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","et","pet","sub"],["nedelja","ponedeljak","utorak","sreda","etvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","'",""],"en","z"],bg:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","nor","bezen","duben","kvten","erven","ervenec","srpen","z","jen","listopad","prosinec"],["ne","po","t","st","t","p","so"],["nedle","pondl","ter","steda","tvrtek","ptek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["s","ma","ti","on","to","fr","l"],["sndag","mandag","tirsdag","onsdag","torsdag","fredag","lrdag"],"sv","z"],el:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],et:[["jaan","veebr","mrts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","mrts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["phapev","esmaspev","teisipev","kolmapev","neljapev","reede","laupev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kes","hein","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","keskuu","heinkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],hu:[["jan.","febr.","mrc.","pr.","mj.","jn.","jl.","aug.","szept.","okt.","nov.","dec."],["janur","februr","mrcius","prilis","mjus","jnius","jlius","augusztus","szeptember","oktber","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasrnap","htf","kedd","szerda","cstrtk","pntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","",""],["","","","","","",""],["",""],"j"],ko:["ja",["1","2","3","4","5","6","7","8","9","10","11","12"],["","","","","","",""],["","","","","","",""],["",""],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","bir.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegu","birelis","liepa","rugpjtis","rugsjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","t"],["sekmadienis","pirmadienis","antradienis","treiadienis","ketvirtadienis","penktadienis","etadienis"],["priepiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jn.","jl.","aug.","sept.","okt.","nov.","dec."],["janvris","februris","marts","aprlis","maijs","jnijs","jlijs","augusts","septembris","oktobris","novembris","decembris"],["svtd.","pirmd.","otrd.","tred.","ceturtd.","piektd.","sestd."],["svtdiena","pirmdiena","otrdiena","trediena","ceturtdiena","piektdiena","sestdiena"],["priekp.","pcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["sn","man","tir","ons","tor","fre","lr"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"],["niedz.","pon.","wt.","r.","czw.","pt.","sob."],["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sb"],["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"],"en","z"],sk:["ja",["janur","februr","marec","aprl","mj","jn","jl","august","september","oktber","november","december"],["ne","po","ut","st","t","pi","so"],["nedea","pondelok","utorok","streda","tvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","et.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","etrtek","petek","sobota"],["dop.","pop."],"z"],th:[["..","..","..","..","..","..","..","..","..","..","..",".."],["","","","","","","","","","","",""],[".",".",".",".",".",".","."],["","","","","","",""],"en","z"],tr:[["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],["Paz","Pzt","Sal","ar","Per","Cum","Cmt"],["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"],["","S"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Thang Ging","Thang Hai","Thang Ba","Thang T","Thang Nm","Thang Sau","Thang Bay","Thang Tam","Thang Chin","Thang Mi","Thang Mi Mt","Thang Mi Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chu Nht","Th Hai","Th Ba","Th T","Th Nm","Th Sau","Th Bay"],["SA","CH"],"z"],ta:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],syr:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],[".","."],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],"en","z"],dv:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],["","","","","","",""],["","","","","","",""],["",""],"z"],hi:[["","","","","","","","","","","",""],["","","","","","","","","","","",""],[".",".",".",".",".",".","."],["","","","","","",""],["",""],"z"],fil:[["Ene","Peb","Mar","Abr","May","Hun","Hul","Ago","Set","Okt","Nob","Dis"],["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],["Lin","Lun","Mar","Miy","Huw","Biy","Sab"],["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"en","z"],ms:[["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],["Ahd","Isn","Sel","Rab","Kha","Jum","Sab"],["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],["PG","PTG"],"z"],"ar-SA":"ar","ar-IQ":[["","","","","","","","","","","",""],["","","","","","","","","","","",""],"ar","ar","ar","z"],"ar-DZ":"ar","ar-EG":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","en-AS":"en","en-KE":"en","en-KW":"en","en-NL":"en","en-CH":"en","en-001":"en","en-VU":"en","en-MX":"en","en-IO":"en","en-IL":"en","en-PK":"en","en-NG":"en","en-UK":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mi.","jue.","vie.","sb."],"es",["a.m.","p.m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mi","jue","vie","sb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"es-CU":["es-ES","es","es-AR","es","ro","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fv.","mar.","avr.","mai","jui.","juil.","aot","sept.","oct.","nov.","dc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["","","","","","",""],"zh","zh","s"],"zh-SG":[["","","","","","","","","","","",""],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jn","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jnner","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ou","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","S"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[[".",".","",".","","","",".",".",".",".","."],["","","","","","","","","","","",""],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","et.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["","","","","","","","","","","",""],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["","","","","","","","","","","",""],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi","fil-PH":"fil","ms-MY":"ms"};t.getBundledLocaleInfo=function(e){var t=e.culture,r=e.tag;if("number"!=typeof t){var n=t;return void 0!==r&&(""!==t&&(n+="-"),n+="x-"+String(r)),void 0===i&&(i=function(){for(var e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"],r=0,n=Object.keys(s);r<n.length;r++){var i=n[r],a=s[i];if("string"!=typeof a){var u=a.slice(0,5).map((function(r,n){if("string"==typeof r){var i=e[r];return(0,o.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==i),i[t[n]]}return r})),l=u[0],c=u[1],d=u[2],p=u[3],m=u[4],f=a[5],g="k"===f,h="j"===f,v="t"===f,S="s"===f,y=g||h||v||S;e[i]={monthNameShort:l,monthNameLong:c,dayNameShort:d,dayNameLong:p,ampmSymbols:m,isEastAsia:y,isKorea:g,isJapan:h,isChinaT:v,isChinaS:S}}else{var F=e[a];(0,o.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==F),e[i]=F}}return e}()),i[n]}};var u=((n={})[a.LCID.USA]="en-US",n[a.LCID.Greek]="el-GR",n[a.LCID.Hungarian]="hu-HU",n[a.LCID.Turkish]="tr-TR",n[a.LCID.Thailand]="th-TH",n[a.LCID.Vietnam]="vi-VN",n[a.LCID.Arabic]="ar-SA",n[a.LCID.Hebrew]="he-IL",n[a.LCID.Tamil]="ta-IN",n[a.LCID.Syriac]="syr-SY",n[a.LCID.Iraq]="ar-IQ",n[a.LCID.Algerian]="ar-DZ",n[a.LCID.Basque]="eu-ES",n[a.LCID.PortBrazil]="pt-BR",n[a.LCID.Croatian]="hr-HR",n[a.LCID.Czech]="cs-CZ",n[a.LCID.Danish]="da-DK",n[a.LCID.Dutch]="nl-NL",n[a.LCID.Australian]="en-AU",n[a.LCID.CanadianEnglish]="en-CA",n[a.LCID.British]="en-GB",n[a.LCID.Finnish]="fi-FI",n[a.LCID.French]="fr-FR",n[a.LCID.FrenchCanadian]="fr-CA",n[a.LCID.Italian]="it-IT",n[a.LCID.NorskBokmal]="nb-NO",n[a.LCID.NorskNynorsk]="nn-NO",n[a.LCID.Polish]="pl-PL",n[a.LCID.PortIberian]="pt-PT",n[a.LCID.Romanian]="ro-RO",n[a.LCID.Russian]="ru-RU",n[a.LCID.Ukrainian]="uk-UA",n[a.LCID.Belarusian]="be-BY",n[a.LCID.SerbianCyrillic]="sr-Cyrl-CS",n[a.LCID.SerbianLatin]="sr-Latn-CS",n[a.LCID.Slovak]="sk-SK",n[a.LCID.Slovenian]="sl-SI",n[a.LCID.SpanishModern]="es-ES",n[a.LCID.Swedish]="sv-SE",n[a.LCID.HongKong]="zh-HK",n[a.LCID.ChinaT]="zh-TW",n[a.LCID.Korea]="ko-KR",n[a.LCID.Japan]="ja-JP",n[a.LCID.China]="zh-CN",n[a.LCID.Devihi]="dv-MV",n[a.LCID.Hindi]="hi-IN",n[a.LCID.German]="de-DE",n[a.LCID.Swiss]="fr-CH",n);t.convertKnownLCID=function(e){var t;return"string"==typeof e?e:null!==(t=u[e])&&void 0!==t?t:e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderFormulaBar=void 0;var n=r(64),i=r(59),a=r(113),o=r(66),s=r(258),u=r(65),l=r(175),c=r(53);function d(e,t,r,l,d){if(d.isDate||d.isTime){var p=function(e,t,r,l,d){var p=t.config,m=p.mathpack,f=p.localeInfo;if(m.cond(l)<0)return(0,c.success)(void 0);var g="",h=0!==m.fix(l)||d.isDate,v=l;if(h){var S=m.trunc(l),y=(0,s.getFormatString)(e,t,r,(0,a.buildMMDDYYFormat)(f,!0),n.NumberFormatSource.CustomString);if(!(0,c.isSuccess)(y))return y;var F=(0,s.renderFormat)(e,y.value,S);if(!(0,c.isSuccess)(F))return F;if("string"!=typeof F.value)return(0,c.success)(void 0);g+=F.value;var C=m.sub(l,S);(0,o.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,i.isErrorOper)(C)),v=C}if(m.cond(v)>0||d.isTime){h&&(g+="  ");var R=t.getKnownFormat(r,f.clock24Hour?u.KnownFormat.HHMMSS:u.KnownFormat.HHMMSSAP);if(!(0,c.isSuccess)(R))return R;F=(0,s.renderFormat)(e,R.value,v);if(!(0,c.isSuccess)(F))return F;if("string"!=typeof F.value)return(0,c.success)(void 0);g+=F.value}return(0,c.success)(g)}(e,(0,s.initUtilGlobals)(t),r,l,d);if(!(0,c.isSuccess)(p))return p;if(void 0!==p.value){p.value;return p}}var m=t.config,f=m.mathpack,g=m.localeInfo;if(d.isPercent){var h=f.mul(l,f.fromNumber(100));return(0,i.isErrorOper)(h)?(0,c.failure)((0,i.notImplemented)(["renderFormulaBar % overflow"])):(0,c.success)(f.formatGeneral(g,h,21)+"%")}return(0,c.success)(f.formatGeneral(g,l,21))}t.renderFormulaBar=function(e,t,r,n,a,s){try{var u=t.config.localeInfo;switch(n.kind){case l.OperKind.Number:return d(e,t,r,n,a);case l.OperKind.String:return(0,c.success)(s?"'"+n.value:n.value);case l.OperKind.Boolean:return(0,c.success)(n.value?u.trueName:u.falseName);case l.OperKind.Error:var p=u.errorNames[n.type];return null==p?(0,c.failure)((0,i.internal)("No locale data for error type ".concat(n.type))):(0,c.success)(p);case l.OperKind.Array:return(0,c.failure)((0,i.notImplemented)(["Array renderFormulaBar"]));case l.OperKind.Rich:return(0,c.failure)((0,i.notImplemented)(["Rich renderFormulaBar"]));case l.OperKind.Blank:return(0,c.success)("");default:return(0,o.assertNever)("calc.numfmt.renderFormulaBar: never value",n)}}catch(e){return(0,c.failure)((0,c.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.renderFormat=t.getFormatString=t.initUtilGlobals=void 0;var n=r(59),i=r(64),a=r(65),o=r(53),s=r(66),u=r(170),l=r(113),c={getKnownFormat:function(){return(0,s.assertFalse)("calc.numfmt: default getKnownFormat")},getIformat:function(){return(0,s.assertFalse)("calc.numfmt: default getIformat")},getFormatString:function(){return(0,s.assertFalse)("calc.numfmt: default getFormatString")}};t.initUtilGlobals=function(e){var t,r,n,i,a,o;return{config:e.config,getKnownFormat:null!==(r=null===(t=e.getKnownFormat)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:c.getKnownFormat,getIformat:null!==(i=null===(n=e.getIformat)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:c.getIformat,getFormatString:null!==(o=null===(a=e.getFormatString)||void 0===a?void 0:a.bind(e))&&void 0!==o?o:c.getFormatString}},t.getFormatString=function(e,t,r,n,i){var a=t.getFormatString(r,n);return(0,o.isSuccess)(a)?void 0!==a.value?t.getIformat(r,a.value):e.createFormat(n,i):a},t.renderFormat=function(e,t,r){var a=(0,n.isStringOper)(r)?i.Clip.None:i.Clip.All,s=t.apply(r,i.Alignment.Right,a,!0);if(!(0,o.isSuccess)(s))return s;var u=e.renderValue(s.value,i.renderInfiniteWidth);return(0,o.isSuccess)(u)?(0,i.isHashesValue)(u.value)?(0,o.success)(u.value.units):(0,o.success)((0,i.renderedValueToString)(u.value)):u},t.getValueEditOperKind=function(e){return e.value.kind},t.applyValueEdit=function(e,t,r,n){var s=r;if(n.kind===i.EditKind.Number&&n.format!==a.KnownFormat.General){var c=n.format,d="string"==typeof c?c:(0,l.getKnownFormat)(t,c),p="string"!=typeof c,m=e.createFormat(d,p);if(!(0,o.isSuccess)(m))return m;var f=m.value;(0,u.shouldInstallFormat)(f,r)&&(s=f)}return e.applyFormat(s,n.value,!0)},t.toXLNumber=function(e,t,r){var n=t.parseGeneral(r,!1,!0,i.GetTimeKind.NonVolatile);return(0,o.isSuccess)(n)?null==n.value?(0,o.failure)(null):(0,o.success)(e.toNumber(n.value.value)):n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDate=t.parseGeneral=void 0;var n=r(171),i=r(174),a=r(53);t.parseGeneral=function(e,t,r,o,s){try{var u=e.config,l=u.localeInfo,c=u.mathpack,d=(0,n.parseConstInternal)(l,c,t,r,o,!1);return(0,a.isSuccess)(d)?void 0!==d.value?d:(0,i.parseDateInternal)((0,i.initParseDateGlobals)(e),t,void 0,s):d}catch(e){return(0,a.failure)((0,a.javaScriptError)(e))}},t.parseDate=function(e,t,r){try{return(0,i.parseDateInternal)((0,i.initParseDateGlobals)(e),t,void 0,r)}catch(e){return(0,a.failure)((0,a.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInstallFormat=t.parseEdit=void 0;var n=r(38);t.parseEdit=n.edit.parseEdit,t.shouldInstallFormat=n.edit.shouldInstallFormat},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=t.gridRangeDistance=void 0;var n=r(430),i=r(25),a=r(7);function o(e,t){var r=e.row,n=e.col,a=e.rows,o=e.cols,s=t.row,u=t.col,l=t.rows,c=t.cols;return(0,i.fastAbs)(r-s+.5*(a-l))+(0,i.fastAbs)(n-u+.5*(o-c))}t.gridRangeDistance=o,t.makeGridRangeTable=function(){return n.RTree.create(a.gridRangeJoin,a.gridRangeIsects,a.gridRangeCompare,o)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakTransition=t.nextTransition=t.nextOnSuccessReceiver=t.callMachineTransition=t.TransitionKind=t.MachineRuntime=t.MachineCycle=t.VoidMachine=t.AllMachine=void 0;var n=r(1);t.AllMachine=n.machine.AllMachine,t.VoidMachine=n.machine.VoidMachine,t.MachineCycle=n.machine.MachineCycle,t.MachineRuntime=n.machine.MachineRuntime,t.TransitionKind=n.machine.TransitionKind,t.callMachineTransition=n.machine.callMachineTransition,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(3);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDispatcher=t.RestArgsOper=t.UdfOper=void 0;var n=r(75),i=r(10),a=r(45),o=r(44),s=r(44),u=r(16),l=r(84),c=r(184),d=r(68),p=r(68),m=r(68),f=r(68),g=r(68),h=r(68),v=r(27),S=r(27),y=r(25),F=r(118),C=r(19),R=r(19),b=r(7),E=r(119),P=r(179),k=r(265),T=r(8),A=r(8),N=r(266),_=r(431),I=r(76),O=r(34),M=r(28),D=r(117),w=r(432),L=r(18),x=r(183),K=r(180),U=r(26),B=r(85),W=r(433),G=r(74),V=function(){function e(e,t){this.kind=L.OperKind.Rich,this.loc=e,this.arity=t.arity,this.func=t.func}return e.prototype.getFallback=function(){return(0,i.assertFalse)("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return(0,i.assertFalse)("calc.runtime.UdfOper.getField")},e}();t.UdfOper=V;var j=function(){function e(e){this.opers=e,this.kind=L.OperKind.Rich}return e.prototype.getFallback=function(){return(0,i.assertFalse)("calc.runtime.RestArgsOper.getFallback")},e.prototype.getField=function(e){return(0,i.assertFalse)("calc.runtime.RestArgsOper.getField")},e}();function q(e,t,r,n){(0,i.assertTrue)("calc.runtime.compileCallLambda",e.checkArity(t.length));for(var a=[],s=0,u=0,l=0,c=e.params;l<c.length;l++){var d=c[l];if(d.isRest)a.push(new j(t.slice(u))),u=t.length;else{var m=u>=t.length?T.missingOper:t[u++];d.hasDef&&((0,b.isMissingOper)(m)&&(m=e.defsAndBody[s]),++s),a.push(m)}}(0,i.assertTrue)("calc.runtime.compileCallLambda",u===t.length&&s===e.defsAndBody.length-1);var f=n?a.map((function(t,r){var n=e.params[r];return void 0===n.paramNameLabel&&void 0===n.paramNameLabel?t:(0,p.noopTerm)(t,(0,o.runtimePositionLambdaParam)(r,n.paramNodeLabel,n.paramNameLabel))})):a,g=a.map((function(t,r){return e.params[r].paramNodeLabel})),h=e.defsAndBody[e.defsAndBody.length-1],v=(0,p.letTerm)(f,!1,g,h,(0,o.runtimePositionLambdaRoot)(e.lambdaNodeLabel,e,t));return(0,p.callLambdaTerm)(e.locals,e.stackEnv,e.stackMap,r,v)}t.RestArgsOper=j;var H=function(){function e(e,t,r,n,i,a,o,s){this.context=e,this.stepConfig=t,this.locals=r,this.caller=n,this.precedents=i,this.visitedCells=a,this.visitedNames=o,this.usage=s,this.internalSource=void 0;var u=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return i.special|=L.SpecialPrecs.RefStyle,u},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalCaller",{get:function(){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.internalCaller",void 0!==this.internalSource),(0,u.stackFrameList)(this.internalSource,e.internalPosition,u.emptyStackEnv,void 0,this.caller)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalContext",{get:function(){var e=this.internalCaller;return{stack:new u.ES5IterableStackFrame(e)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return(0,U.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return(0,U.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return(0,U.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return(0,U.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return(0,U.isSuccess)(e)?e.value:(0,u.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),e.prototype.makeChildDispatcher=function(t){return new e(this.context,this.stepConfig,this.locals,t,this.precedents,this.visitedCells,this.visitedNames,this.usage)},e.prototype.useAsFuncContext=function(e){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext: caller shouldn't be set",void 0===this.internalSource),void 0!==e&&(this.internalSource=e),this},e.prototype.applyFunction=function(e,t){var r=this.makeChildDispatcher(this.internalCaller),n=(0,O.getWorksheetFuncType)(e),i=t.some(b.isRangeOper)?t.slice(0):t;return(0,x.dereferenceOpers)(r,i,n),r.termToFuncResult(r.dispatchFunction((0,h.worksheetFunctionIdToName)(e),n,!1,i))},e.prototype.applyLambda=function(e,t){return this.termToFuncResult(q(e,t,this.internalCaller,null!=this.stepConfig))},e.prototype.handleEvaluationError=function(e){if(e instanceof u.EvaluationError)return(0,u.handleEvaluationError)(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if((0,h.isOperatorName)(e))return(0,c.applyOperator)(this.globals,(0,h.operatorNameToId)(e),t,r);var n=(0,h.worksheetFunctionNameToId)(e);if(n===O.WorksheetFuncId._UDF){if(t[0]instanceof I.LambdaOper){var a=t[0],o=t.slice(1);return a.checkArity(o.length)?((0,i.assertTrue)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: caller shouldn't be set",void 0===this.internalSource),q(a,o,this.caller,null!=this.stepConfig)):A.valueErrorOper}if(t[0]instanceof V){var s=t[0];if(t.length-1!==s.arity)return A.valueErrorOper;if((m=s.func(this.useAsFuncContext((0,C.lexicalSourceUDF)(s.loc)),t.slice(1))).kind===L.OperKind.Error){var l="UDF function return value";(0,S.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",m.type,l)}return this.funcContextResultToTerm(m)}switch(t[0].kind){case L.OperKind.Error:return t[0];case L.OperKind.Number:return A.valueErrorOper;case L.OperKind.Rich:return(0,u.throwEvaluationError)((0,b.notImplemented)(["Rich UDF head"]));case L.OperKind.String:case L.OperKind.Boolean:case L.OperKind.Blank:case L.OperKind.Missing:return A.refErrorOper;case L.OperKind.Array:return(0,G.isFeatureEnabled)(G.FeatureName.CalcLambdaArrayLifting)?(0,i.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,u.throwEvaluationError)((0,b.notImplemented)(["Array UDF head"]));case L.OperKind.Range:return(0,G.isFeatureEnabled)(G.FeatureName.CalcLambdaCellValues)?(0,i.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,u.throwEvaluationError)((0,b.notImplemented)(["Range UDF head"]));default:return(0,i.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}var d=this.globals.getWorksheetFunc(n);if(d.kind===U.ResultKind.Failure)return(0,u.throwEvaluationError)(d.reason);var p=d.value;if(null==p){l="nonexistent worksheet function ".concat(n);return(0,S.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",A.ErrorType.NAME,l),A.nameErrorOper}try{var m;if((m=p(this.useAsFuncContext((0,C.lexicalSourceWSF)(n)),t)).kind===L.OperKind.Error){l="worksheet function ".concat(n," return value");(0,S.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",m.type,l)}return this.funcContextResultToTerm(m)}catch(e){throw(0,B.prependErrorMessage)(e,"(in WSF ".concat((0,F.englishWorksheetFuncIdToName)(n),")"))}},e.prototype.termToFuncResult=function(e){switch(e.kind){case g.TermKind.CallLambda:case g.TermKind.CallFirstOrderFunc:return(0,M.machineCall)(this.context.createCallTermEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e));case g.TermKind.CallMachine:return(0,M.machineCall)(e.data.machine)}return e},e.prototype.funcContextResultToTerm=function(t){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",void 0!==this.internalSource),(0,M.isMachineCall)(t)?(0,d.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,f.callMachineTerm)(t.machine,e.internalPosition)):t},e.prototype.dispatchFunction=function(e,t,r,a){var o=this;if(!(0,b.isValidArgsLength)(t,a.length)){var s=JSON.stringify(t),u="bad application of ".concat(JSON.stringify(e)," to ").concat(a.length," arguments, ftype = ").concat(s),l="calc.runtime.FunctionDispatcher.dispatchFunction: ".concat(u);return(0,i.assertFalse)(l)}for(var c=a.length,d=L.SignatureType.None,p=0;p<c;p+=1){var m=a[p],g=m.kind;0==(g&(C=(0,b.getArgType)(t,p,c)))&&(d|=g),(0,b.isRangeOper)(m)&&0==(t.flags&L.FunctionFlags.Allow3dRef)&&0==(C&L.SignatureType.Ref3D)&&!(0,b.isSheetIndex)(m.sheets)&&(d|=g),(0,b.isStringOper)(m)&&0==(t.flags&L.FunctionFlags.AllowLStrs)&&m.value.length>255&&(0,G.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsLstr")&&(d|=g)}if(d===L.SignatureType.None)return this.applyOperatorOrFunction(e,a,r);if(0!=(d&L.OperKind.Array)){var h=(0,v.arrayLift)(this.useAsFuncContext(void 0),t,(function(r){var n=o.makeChildDispatcher(o.caller);return n.termToFuncResult(n.dispatchFunction(e,t,!1,r))}),a).machine;return(0,f.callMachineTerm)(h,void 0)}d&=~L.OperKind.Array;var y=[];for(p=0;p<c;p+=1){var F=a[p];if(0!=(d&F.kind)){var C=(0,b.getArgType)(t,p,c);if(F=this.coerceOper(F,C),(0,b.isErrorOper)(F)&&0==(C&L.OperKind.Error))return F;if((0,b.isRangeOper)(F)&&0==(t.flags&L.FunctionFlags.Allow3dRef)&&0==(C&L.SignatureType.Ref3D)&&!(0,b.isSheetIndex)(F.sheets)){u="3D reference, oper = ".concat((0,n.anonymize)(F));return(0,S.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",A.ErrorType.VALUE,u),A.valueErrorOper}if((0,b.isStringOper)(F)&&0==(t.flags&L.FunctionFlags.AllowLStrs)&&F.value.length>255&&(0,G.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsLstr")){u="LStr, oper = ".concat((0,n.anonymize)(F));return(0,S.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",A.ErrorType.VALUE,u),A.valueErrorOper}}y[p]=F}return this.applyOperatorOrFunction(e,y,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return(0,U.isSuccess)(t)?(0,y.isNone)(t.value)?void 0:t.value:(0,u.throwEvaluationError)(t.reason)},e.prototype.getNameFormula=function(e,t,r){var n=this.context.resolver.resolveName(this.locals,(0,E.nameNode)((0,E.identNamePart)(t,!0),e),r),i=n.resolution,a=n.precedents;if((0,y.safePush)(this.precedents.names,a),!(0,U.isSuccess)(i))switch(i.reason.kind){case P.ResolveReasonKind.NoOriginSheet:case P.ResolveReasonKind.InvalidQualifier:return;default:return(0,u.throwEvaluationError)(i.reason)}var o=i.value;if(o){var s=this.globals.getNameFormula(o,r);(0,U.isSuccess)(s)||(0,u.throwEvaluationError)(s.reason);var l=s.value;if(!(0,y.isNone)(l))return[o,l.node]}},e.prototype.getCellRef=function(e,t,r,n){var i={originGridCell:(0,U.success)(r.range),originSheet:(0,U.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},a=this.context.resolver.resolveCellRef(i,(0,E.cellRefNode)(t,e)).resolution;if(!(0,U.isSuccess)(a))switch(a.reason.kind){case P.ResolveReasonKind.NoOriginSheet:case P.ResolveReasonKind.InvalidQualifier:return;default:return(0,u.throwEvaluationError)(a.reason)}var o=a.value;if(o)return(0,A.range3DOper)(o.sheet,o.range)},e.prototype.getStructRef=function(e,t,r){var n={originGridCell:(0,U.success)(r.range),originSheet:(0,U.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},i=this.context.resolver.resolveStructRef(n,(0,E.structRefNode)(e,t)),a=i.resolution,o=i.precedents;if((0,y.safePush)(this.precedents.names,o),!(0,U.isSuccess)(a))switch(a.reason.kind){case P.ResolveReasonKind.NoOriginSheet:case P.ResolveReasonKind.InvalidQualifier:case P.ResolveReasonKind.InvalidStructRef:case P.ResolveReasonKind.EmptyIntersection:return;default:return(0,u.throwEvaluationError)(a.reason)}var s=a.value;if(s)return(0,A.range3DOper)(s.sheet,s.range)},e.prototype.dereferenceOper=function(e,t){return(0,x.dereferenceOper)(this,e,t)},e.prototype.dereferenceOpers=function(e,t){(0,x.dereferenceOpers)(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return(0,U.isSuccess)(t)?this.getAvailableFormula(e):(0,u.throwEvaluationError)(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return(0,U.isSuccess)(r)?(this.precedents.special|=L.SpecialPrecs.OwnDocSheets,null==r.value?void 0:(0,R.sheetIndex)(e,r.value)):(0,u.throwEvaluationError)(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=L.SpecialPrecs.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return(0,U.isSuccess)(t)?t.value.position:(0,u.throwEvaluationError)(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=L.SpecialPrecs.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return(0,U.isSuccess)(t)?t.value.sheets:(0,u.throwEvaluationError)(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var a=[],o=[],s=function(s){var d=e[s];if(!(0,b.isRangeOper)(d))return o.push(d),"continue";for(var p=[],m=function(e){var r=(0,x.getCellValuesAsArray)(n,e,a,!0);void 0!==r&&p.push(t(r,e))},f=c.getSheetRangeIndexes(d.sheets),g=function(e){for(var t=(0,R.sheetIndex)(d.sheets.document,f[e]),n=function(e){var n=d.ranges[e];if(!r)return m((0,R.sheetGridRange)(t,n)),"continue";var a=c.globals.tryGetHiddenRows(t,n.row,n.row+n.rows);if(!(0,U.isSuccess)(a))return{value:(0,u.throwEvaluationError)(a.reason)};var o=a.value;if(0===o.length)return m((0,R.sheetGridRange)(t,n)),"continue";for(var s=function(e,r){var i=(0,R.gridRange)(e,n.col,r-e,n.cols);m((0,R.sheetGridRange)(t,i))},l=0;l<o.length;l+=1){var p=o[l],f=p.start,g=p.end,h=0===l?n.row:o[l-1].end;(0,i.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",h<=f&&f<g&&g<=n.row+n.rows),h!==f&&s(h,f);var v=(0,R.gridRange)(f,n.col,g-f,n.cols);c.precedents.cells.push((0,R.sheetGridRange)(t,v))}var S=o[o.length-1].end;S!==n.row+n.rows&&s(S,n.row+n.rows)},a=0;a<d.ranges.length;a+=1){var o=n(a);if("object"==typeof o)return o}},h=0;h<f.length;h+=1){var v=g(h);if("object"==typeof v)return v}o.push({kind:l.DerefOperKind.RangeValues,arrays:p})},c=this,d=0;d<e.length;d+=1){var p=s(d);if("object"==typeof p)return p.value}return a.length>0?(0,u.throwEvaluationError)((0,u.unevaluated)(a)):o},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,y.identity,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new a.NonstrictSparseArray2D(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,i){var a=e.get(n,i),o=(0,R.sheetGridCell)(t.sheet,(0,R.gridCell)(t.range.row+n,t.range.col+i));return[a,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var i=this.context.parser.parseFormula((0,k.parseLocals)(r.lexicalKind,t,{refStyle:e}),n);if(!(0,U.isSuccess)(i))return i;var a=this.context.analyzer.checkFormula(r,i.value);if(!(0,U.isSuccess)(a))return a;if(!(0,b.isWellFormed)(a.value))return(0,U.failure)((0,s.illFormedFormula)("ill-formed indirect formula","indirect"));a.value;return a},e.prototype.getRandom=function(){this.precedents.special|=L.SpecialPrecs.Calc;var e=this.internalContext,t=this.globals.getRandom(e);return(0,U.isSuccess)(t)||(0,u.throwEvaluationError)(t.reason),t.value},e.prototype.getTime=function(e){this.precedents.special|=L.SpecialPrecs.Time;var t=this.globals.getTime(e,D.GetTimeKind.Volatile);return(0,U.isSuccess)(t)||(0,u.throwEvaluationError)(t.reason),t.value},e.prototype.coerceOper=function(e,t){return(0,K.coerceOper)(this,e,t)},e.prototype.parseGeneral=function(e,t){var r,n=this.numberFormatter.parseGeneral(e,!1,t,D.GetTimeKind.NonVolatile);return(0,U.isSuccess)(n)||(0,u.throwEvaluationError)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.numberFormatter.parseDate(e,D.GetTimeKind.NonVolatile);return(0,U.isSuccess)(r)||(0,u.throwEvaluationError)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getBinaryOperator=function(e){var t=this,r=(0,O.getOperatorType)(e),n=[A.falseOper,A.falseOper];return function(a,o){n[0]=a,n[1]=o,(0,x.dereferenceOpers)(t,n,r);var s=t.dispatchFunction((0,h.operatorIdToName)(e),r,!1,n);return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",(0,m.isOperTerm)(s)),s}},e.prototype.getUnaryOperator=function(e){var t=this,r=(0,O.getOperatorType)(e),n=[A.falseOper];return function(a){n[0]=a,(0,x.dereferenceOpers)(t,n,r);var o=t.dispatchFunction((0,h.operatorIdToName)(e),r,!1,n);return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",(0,m.isOperTerm)(o)),o}},e.prototype.isInFilterMode=function(e){this.precedents.special|=L.SpecialPrecs.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if((0,b.isRangeOper)(n))for(var i=0,a=this.getSheetRangeIndexes(n.sheets);i<a.length;i++){var o=a[i],s=this.globals.isInFilterMode((0,R.sheetIndex)(n.sheets.document,o));if(!(0,U.isSuccess)(s))return(0,u.throwEvaluationError)(s.reason);if(s.value)return!0}}return!1},e.prototype.printFormula=function(e,t){var r=(0,R.sheetGridCell)(e.source.range.sheet,t),n=(0,_.adjustFormulaOrigin)(this.globals,(0,N.analyzeLocalsGrid)(R.LexicalKind.Cell,(0,b.sheetGridRangeAnchor)(e.source.range)),t,e.formula);if(!(0,U.isSuccess)(n))return(0,u.throwEvaluationError)(n.reason);var i=this.context.printer.printFormula((0,W.printLocalsGrid)(e.source,r,{refStyle:this.config.refStyle}),n.value);return(0,U.isSuccess)(i)?i.value:(0,u.throwEvaluationError)(i.reason)},e.prototype.applyFormat=function(e,t,r,n){var i;if("number"==typeof t){var a=this.globals.getKnownFormat(e,t);if(!(0,U.isSuccess)(a))return(0,u.throwEvaluationError)(a.reason);i=a.value}else{var o=(0,w.getFormatString)(this.context.numberFormatter,this.globals,e,t,n);if(!(0,U.isSuccess)(o))switch(o.reason.kind){case D.FormatReasonKind.PreviousFormatFailure:case D.FormatReasonKind.NotFormatString:return;default:return(0,u.throwEvaluationError)(o.reason)}i=o.value}var s=(0,w.renderFormat)(this.context.numberFormatter,i,r);return(0,U.isSuccess)(s)?"string"==typeof s.value?s.value:void 0:(0,u.throwEvaluationError)(s.reason)},e.internalPosition=o.runtimePositionFirstOrderFunc,e}();t.FunctionDispatcher=H},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLocals=t.notFormulaString=t.createParseGlobals=t.ReasonKind=void 0;var n=r(37);t.ReasonKind=n.parseServiceTypes.ReasonKind,t.createParseGlobals=n.parseServiceTypes.createParseGlobals,t.notFormulaString=n.parseServiceTypes.notFormulaString,t.parseLocals=n.parseServiceTypes.parseLocals},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.summarizeFormulaDiagnostics=t.diagnostics=t.createAnalyzeGlobals=t.analyzeLocalsName=t.analyzeLocalsGrid=void 0;var n=r(37);t.analyzeLocalsGrid=n.analyzeServiceTypes.analyzeLocalsGrid,t.analyzeLocalsName=n.analyzeServiceTypes.analyzeLocalsName,t.createAnalyzeGlobals=n.analyzeServiceTypes.createAnalyzeGlobals,t.diagnostics=n.analyzeServiceTypes.diagnostics,t.summarizeFormulaDiagnostics=n.analyzeServiceTypes.summarizeFormulaDiagnostics},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;var n=r(37);t.createAnalyzer=n.analyzeService.createAnalyzer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var n=r(3);t.anonymizeFormula=n.printService.anonymizeFormula,t.createPrinter=n.printService.createPrinter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;var n=r(37);t.createParser=n.parserService.createParser},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=void 0;var n=r(0),i=n.__importStar(r(271)),a=n.__importStar(r(274)),o=n.__importStar(r(276)),s=n.__importStar(r(277)),u=n.__importStar(r(278)),l=n.__importStar(r(279)),c=n.__importStar(r(191)),d=n.__importStar(r(192)),p=n.__importStar(r(281)),m=n.__importStar(r(282)),f=n.__importStar(r(283)),g=n.__importStar(r(284)),h=n.__importStar(r(285)),v=n.__importStar(r(286)),S=n.__importStar(r(287)),y=n.__importStar(r(288)),F=n.__importStar(r(442)),C=r(74),R=r(34),b={};b[R.WorksheetFuncId.SUM]=i.sum,b[R.WorksheetFuncId.PRODUCT]=i.product,b[R.WorksheetFuncId.AVERAGE]=i.average,b[R.WorksheetFuncId.COUNTBLANK]=i.countblank,b[R.WorksheetFuncId.MAX]=i.max,b[R.WorksheetFuncId.MIN]=i.min,b[R.WorksheetFuncId.AND]=i.and,b[R.WorksheetFuncId.COUNTA]=i.counta,b[R.WorksheetFuncId.OR]=i.or,b[R.WorksheetFuncId.CONCAT]=i.concat,b[R.WorksheetFuncId.AVERAGEIF]=i.averageif,b[R.WorksheetFuncId.AVERAGEIFS]=i.averageifs,b[R.WorksheetFuncId.COUNT]=i.count,b[R.WorksheetFuncId.COUNTIF]=i.countif,b[R.WorksheetFuncId.COUNTIFS]=i.countifs,b[R.WorksheetFuncId.MEDIAN]=i.median,b[R.WorksheetFuncId.SUMSQ]=i.sumsq,b[R.WorksheetFuncId.SUMIF]=i.sumif,b[R.WorksheetFuncId.SUMIFS]=i.sumifs,b[R.WorksheetFuncId.LARGE]=i.large,b[R.WorksheetFuncId.SMALL]=i.small,b[R.WorksheetFuncId.RANK]=i.rank,b[R.WorksheetFuncId.RANK_EQ]=i.rank,b[R.WorksheetFuncId.RANK_AVG]=i.rank_avg,b[R.WorksheetFuncId.PERCENTILE]=i.percentile,b[R.WorksheetFuncId.PERCENTILE_INC]=i.percentile,b[R.WorksheetFuncId.PERCENTILE_EXC]=i.percentile_exc,b[R.WorksheetFuncId.QUARTILE]=i.quartile,b[R.WorksheetFuncId.QUARTILE_INC]=i.quartile,b[R.WorksheetFuncId.QUARTILE_EXC]=i.quartile_exc,b[R.WorksheetFuncId.TRIMMEAN]=i.trimmean,b[R.WorksheetFuncId.AVERAGEA]=i.averagea,b[R.WorksheetFuncId.MAXA]=i.maxa,b[R.WorksheetFuncId.MINA]=i.mina,b[R.WorksheetFuncId.MAXIFS]=i.maxifs,b[R.WorksheetFuncId.MINIFS]=i.minifs,b[R.WorksheetFuncId.XOR]=i.xor,b[R.WorksheetFuncId.AGGREGATE]=i.aggregate,b[R.WorksheetFuncId.SUBTOTAL]=i.subtotal,b[R.WorksheetFuncId.VAR]=i.var_,b[R.WorksheetFuncId.VAR_S]=i.var_,b[R.WorksheetFuncId.VARP]=i.varp,b[R.WorksheetFuncId.VAR_P]=i.varp,b[R.WorksheetFuncId.STDEV]=i.stdev,b[R.WorksheetFuncId.STDEV_S]=i.stdev,b[R.WorksheetFuncId.STDEVP]=i.stdevp,b[R.WorksheetFuncId.STDEV_P]=i.stdevp,b[R.WorksheetFuncId.VARA]=i.vara,b[R.WorksheetFuncId.VARPA]=i.varpa,b[R.WorksheetFuncId.STDEVA]=i.stdeva,b[R.WorksheetFuncId.STDEVPA]=i.stdevpa,b[R.WorksheetFuncId.AVEDEV]=i.avedev,b[R.WorksheetFuncId.DEVSQ]=i.devsq,b[R.WorksheetFuncId.MODE]=i.mode,b[R.WorksheetFuncId.MODE_SNGL]=i.mode,b[R.WorksheetFuncId.MODE_MULT]=i.mode_mult,b[R.WorksheetFuncId.TEXTJOIN]=i.textjoin,b[R.WorksheetFuncId.YEAR]=a.year,b[R.WorksheetFuncId.MONTH]=a.month,b[R.WorksheetFuncId.DAY]=a.day,b[R.WorksheetFuncId.HOUR]=a.hour,b[R.WorksheetFuncId.MINUTE]=a.minute,b[R.WorksheetFuncId.SECOND]=a.second,b[R.WorksheetFuncId.WEEKNUM]=a.weeknum,b[R.WorksheetFuncId.ISOWEEKNUM]=a.isoweeknum,b[R.WorksheetFuncId.WEEKDAY]=a.weekday,b[R.WorksheetFuncId.DATE]=a.date,b[R.WorksheetFuncId.TIME]=a.time,b[R.WorksheetFuncId.DAYS360]=a.days360,b[R.WorksheetFuncId.DAYS]=a.days,b[R.WorksheetFuncId.DATEDIF]=a.datedif,b[R.WorksheetFuncId.WORKDAY]=a.workday,b[R.WorksheetFuncId.WORKDAY_INTL]=a.workday_intl,b[R.WorksheetFuncId.EDATE]=a.edate,b[R.WorksheetFuncId.EOMONTH]=a.eomonth,b[R.WorksheetFuncId.NETWORKDAYS]=a.networkdays,b[R.WorksheetFuncId.NETWORKDAYS_INTL]=a.networkdays_intl,b[R.WorksheetFuncId.YEARFRAC]=a.yearFrac,b[R.WorksheetFuncId.DELTA]=o.delta,b[R.WorksheetFuncId.GESTEP]=o.gestep,b[R.WorksheetFuncId.NA]=s.na,b[R.WorksheetFuncId.T]=s.t_,b[R.WorksheetFuncId.N]=s.n_,b[R.WorksheetFuncId.TYPE]=s.type,b[R.WorksheetFuncId.ERROR_TYPE]=s.error_type,b[R.WorksheetFuncId.INFO]=s.info,b[R.WorksheetFuncId.IF]=l.if_,b[R.WorksheetFuncId.IFS]=l.ifs,b[R.WorksheetFuncId.SWITCH]=l.switch_,b[R.WorksheetFuncId.TRUE]=l.true_,b[R.WorksheetFuncId.FALSE]=l.false_,b[R.WorksheetFuncId.NOT]=l.not,b[R.WorksheetFuncId.CHOOSE]=l.choose,b[R.WorksheetFuncId.INDEX]=c.index,b[R.WorksheetFuncId.MATCH]=c.match,b[R.WorksheetFuncId.LOOKUP]=c.lookup,b[R.WorksheetFuncId.HLOOKUP]=c.hlookup,b[R.WorksheetFuncId.VLOOKUP]=c.vlookup,b[R.WorksheetFuncId.ABS]=d.abs,b[R.WorksheetFuncId.CEILING]=d.ceiling,b[R.WorksheetFuncId.ECMA_CEILING]=d.ceiling,b[R.WorksheetFuncId.DEGREES]=d.degrees,b[R.WorksheetFuncId.FLOOR]=d.floor,b[R.WorksheetFuncId.RADIANS]=d.radians,b[R.WorksheetFuncId.ROUND]=d.round,b[R.WorksheetFuncId.ROUNDUP]=d.roundup,b[R.WorksheetFuncId.ROUNDDOWN]=d.rounddown,b[R.WorksheetFuncId.EVEN]=d.even,b[R.WorksheetFuncId.SIGN]=d.sign,b[R.WorksheetFuncId.PI]=d.pi,b[R.WorksheetFuncId.SQRT]=d.sqrt,b[R.WorksheetFuncId.EXP]=d.exp,b[R.WorksheetFuncId.POWER]=d.power,b[R.WorksheetFuncId.LN]=d.ln,b[R.WorksheetFuncId.LOG10]=d.log10,b[R.WorksheetFuncId.LOG]=d.log,b[R.WorksheetFuncId.SIN]=d.sin,b[R.WorksheetFuncId.COS]=d.cos,b[R.WorksheetFuncId.TAN]=d.tan,b[R.WorksheetFuncId.ASIN]=d.asin,b[R.WorksheetFuncId.ACOS]=d.acos,b[R.WorksheetFuncId.ATAN]=d.atan,b[R.WorksheetFuncId.ATAN2]=d.atan2,b[R.WorksheetFuncId.FACT]=d.fact,b[R.WorksheetFuncId.SQRTPI]=d.sqrtpi,b[R.WorksheetFuncId.FACTDOUBLE]=d.factdouble,b[R.WorksheetFuncId.INT]=d.int,b[R.WorksheetFuncId.TRUNC]=d.trunc,b[R.WorksheetFuncId.ODD]=d.odd,b[R.WorksheetFuncId.MROUND]=d.mround,b[R.WorksheetFuncId.QUOTIENT]=d.quotient,b[R.WorksheetFuncId.FLOOR_MATH]=d.floor_math,b[R.WorksheetFuncId.FLOOR_PRECISE]=d.floor_precise,b[R.WorksheetFuncId.CEILING_MATH]=d.ceiling_math,b[R.WorksheetFuncId.CEILING_PRECISE]=d.ceiling_precise,b[R.WorksheetFuncId.ISO_CEILING]=d.ceiling_precise,b[R.WorksheetFuncId.TEXT]=p.text,b[R.WorksheetFuncId.FIXED]=p.fixed,b[R.WorksheetFuncId.DOLLAR]=p.dollar,b[R.WorksheetFuncId.VALUE]=p.value,b[R.WorksheetFuncId.DATEVALUE]=p.datevalue,b[R.WorksheetFuncId.TIMEVALUE]=p.timevalue,b[R.WorksheetFuncId.ISERROR]=m.iserror,b[R.WorksheetFuncId.ISERR]=m.iserr,b[R.WorksheetFuncId.ISBLANK]=m.isblank,b[R.WorksheetFuncId.ISLOGICAL]=m.islogical,b[R.WorksheetFuncId.ISNA]=m.isna,b[R.WorksheetFuncId.ISNONTEXT]=m.isnontext,b[R.WorksheetFuncId.ISTEXT]=m.istext,b[R.WorksheetFuncId.ISNUMBER]=m.isnumber,b[R.WorksheetFuncId.ISREF]=m.isref,b[R.WorksheetFuncId.ISEVEN]=m.iseven,b[R.WorksheetFuncId.ISODD]=m.isodd,b[R.WorksheetFuncId.ISFORMULA]=m.isformula,b[R.WorksheetFuncId.FORMULATEXT]=m.formulatext,b[R.WorksheetFuncId.ROWS]=f.rows,b[R.WorksheetFuncId.COLUMNS]=f.columns,b[R.WorksheetFuncId.AREAS]=f.areas,b[R.WorksheetFuncId.SHEETS]=f.sheets,b[R.WorksheetFuncId.ROW]=f.row,b[R.WorksheetFuncId.COLUMN]=f.column,b[R.WorksheetFuncId.SHEET]=f.sheet,b[R.WorksheetFuncId.OFFSET]=f.offset,b[R.WorksheetFuncId.TRANSPOSE]=f.transpose,b[R.WorksheetFuncId.SINGLE]=f.single,b[R.WorksheetFuncId.ADDRESS]=h.address,b[R.WorksheetFuncId.INDIRECT]=h.indirect,b[R.WorksheetFuncId.LEFT]=v.left,b[R.WorksheetFuncId.RIGHT]=v.right,b[R.WorksheetFuncId.MID]=v.mid,b[R.WorksheetFuncId.LEN]=v.len,b[R.WorksheetFuncId.CONCATENATE]=v.concatenate,b[R.WorksheetFuncId.EXACT]=v.exact,b[R.WorksheetFuncId.REPT]=v.rept,b[R.WorksheetFuncId.TRIM]=v.trim,b[R.WorksheetFuncId.CLEAN]=v.clean,b[R.WorksheetFuncId.CHAR]=v.char,b[R.WorksheetFuncId.UNICHAR]=v.unichar,b[R.WorksheetFuncId.CODE]=v.code,b[R.WorksheetFuncId.UNICODE]=v.unicode,b[R.WorksheetFuncId.LOWER]=v.lower,b[R.WorksheetFuncId.UPPER]=v.upper,b[R.WorksheetFuncId.PROPER]=v.proper,b[R.WorksheetFuncId.FIND]=v.find,b[R.WorksheetFuncId.REPLACE]=v.replace,b[R.WorksheetFuncId.SEARCH]=v.search,b[R.WorksheetFuncId.SUBSTITUTE]=v.substitute,b[R.WorksheetFuncId.RAND]=S.rand,b[R.WorksheetFuncId.RANDBETWEEN]=S.randbetween,b[R.WorksheetFuncId.NOW]=S.now,b[R.WorksheetFuncId.TODAY]=S.today,b[R.WorksheetFuncId.HYPERLINK]=y.hyperlink,b[R.WorksheetFuncId.FIELDVALUE]=g.fieldvalue,b[R.WorksheetFuncId._FV]=g.fieldvalue,b[R.WorksheetFuncId.MAKEARRAY]=u.makearray,b[R.WorksheetFuncId.ISOMITTED]=m.isomitted;var E=!1;t.getWorksheetFunc=function(e){return E||(E=!0,(0,C.isFeatureEnabled)(C.FeatureName.CalcRecordFunctions)&&(b[R.WorksheetFuncId.RECORD]=g.record),(0,C.isFeatureEnabled)(C.FeatureName.CalcNestedRecordFunction)&&(b[R.WorksheetFuncId.NESTEDRECORD]=g.record),(0,C.isFeatureEnabled)(C.FeatureName.CalcLambdaBasicFunctions)&&(b[R.WorksheetFuncId.APPLY]=u.apply,b[R.WorksheetFuncId.ISLAMBDA]=m.islambda),(0,C.isTypedChangeGateEnabled)("OfficeVSO:8501373_CalcTsFuncsFirstSlice")&&(b[R.WorksheetFuncId.TAKE]=h.take,b[R.WorksheetFuncId.DROP]=h.drop,b[R.WorksheetFuncId.SEQUENCE]=h.sequence,b[R.WorksheetFuncId.TEXTBEFORE]=v.textBefore,b[R.WorksheetFuncId.TEXTAFTER]=v.textAfter,b[R.WorksheetFuncId.TEXTSPLIT]=v.textSplit,b[R.WorksheetFuncId.HSTACK]=h.hstack,b[R.WorksheetFuncId.VSTACK]=h.vstack),(0,C.isTypedChangeGateEnabled)("OfficeVSO_8554430_CalcTsColRowSumProdFuncs")&&(b[R.WorksheetFuncId.CHOOSECOLS]=h.choosecols,b[R.WorksheetFuncId.CHOOSEROWS]=h.chooserows,b[R.WorksheetFuncId.TOCOL]=h.tocol,b[R.WorksheetFuncId.TOROW]=h.torow,b[R.WorksheetFuncId.SUMPRODUCT]=i.sumproduct),(0,C.getTypedFeatureGate)("Microsoft.Office.Excel.CalcTsDec2023Funcs")&&(b[R.WorksheetFuncId.GEOMEAN]=i.geomean,b[R.WorksheetFuncId.HARMEAN]=i.harmean,b[R.WorksheetFuncId.FILTER]=F.filter,b[R.WorksheetFuncId.SORT]=F.sort,b[R.WorksheetFuncId.SORTBY]=F.sortby,b[R.WorksheetFuncId.UNIQUE]=F.unique,b[R.WorksheetFuncId.MAP]=u.map,b[R.WorksheetFuncId.BYROW]=u.byrow,b[R.WorksheetFuncId.BYCOL]=u.bycol,b[R.WorksheetFuncId.REDUCE]=u.reduce,b[R.WorksheetFuncId.SCAN]=u.scan,b[R.WorksheetFuncId.XLOOKUP]=c.xlookup,b[R.WorksheetFuncId.XMATCH]=c.xmatch,b[R.WorksheetFuncId.MOD]=d.mod,b[R.WorksheetFuncId.NUMBERVALUE]=p.numbervalue,b[R.WorksheetFuncId.ARRAYTOTEXT]=p.arraytotext,b[R.WorksheetFuncId.VALUETOTEXT]=p.valuetotext,b[R.WorksheetFuncId.EXPAND]=h.expand,b[R.WorksheetFuncId.WRAPCOLS]=h.wrapcols,b[R.WorksheetFuncId.WRAPROWS]=h.wraprows,b[R.WorksheetFuncId.RANDARRAY]=S.randarray)),b[e]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geomean=t.devsq=t.avedev=t.rank_avg=t.rank=t.aggregate=t.subtotal=t.mode_mult=t.mode=t.varpa=t.vara=t.varp=t.var_=t.stdevpa=t.stdeva=t.stdevp=t.stdev=t.trimmean=t.median=t.quartile_exc=t.quartile=t.percentile_exc=t.percentile=t.small=t.large=t.xor=t.or=t.and=t.minifs=t.maxifs=t.mina=t.maxa=t.min=t.max=t.countifs=t.countif=t.counta=t.countblank=t.count=t.textjoin=t.concat=t.averagea=t.averageifs=t.averageif=t.average=t.product=t.sumifs=t.sumif=t.sumsq=t.sum=void 0,t.sumproduct=t.harmean=void 0;var n=r(0),i=r(10),a=r(8),o=r(7),s=r(84),u=r(19),l=r(272),c=r(25),d=r(34),p=r(273),m=r(46),f=r(27),g=r(18),h=r(26),v=r(263),S=r(16);function y(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case g.OperKind.Number:return r;case g.OperKind.Boolean:case g.OperKind.String:return;case g.OperKind.Error:return r;case g.OperKind.Missing:case g.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.arithmeticOperationCoerce",r)}}function F(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case g.OperKind.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case g.OperKind.Number:return r;case g.OperKind.String:return e.mathpack.zero;case g.OperKind.Error:return r;case g.OperKind.Missing:case g.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.arithmeticAOperationCoerce",r)}}function C(e){return function(t,r,n){if(void 0!==t&&(0,o.isErrorOper)(t))return t;if((0,i.assertTrue)("calc.funcs.numberReducer",void 0===t||(0,o.isNumberOper)(t)),(0,o.isErrorOper)(r))return r;var a,s;(0,i.assertTrue)("calc.funcs.numberReducer",(0,o.isNumberOper)(r)),void 0===t?(a=r,s=n-1):(a=t,s=n);for(var u=0;u<s;u+=1){var l=e(a,r);if((0,o.isErrorOper)(l))return l;a=l}return a}}function R(e){return function(t,r,n){return e.count+=n,r}}function b(e,t,r){if(!(0,o.isNumberOper)(r))return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if(void 0!==r&&(0,s.isRangeValues)(r))for(var n=r.arrays.length-1;n>=0;n-=1){var i=r.arrays[n];if(i.rows>i.denseRows||i.cols>i.denseCols)if((null==(u=i.getSparse())?void 0:u.kind)===g.OperKind.Number)return u;for(var a=i.denseRows-1;a>=0;a-=1)for(var o=i.denseCols-1;o>=0;o-=1){var u;if((null==(u=i.get(a,o))?void 0:u.kind)===g.OperKind.Number)return u}}}}(t);return(null==n?void 0:n.kind)!==g.OperKind.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function E(e,t,r){var n=(0,p.reduceDerefOpers)(t,C(t.mathpack.add),y,r);return null==n?t.mathpack.zero:(e&&(n=b(t,r,n)),n)}var P=E.bind(void 0,!1),k=E.bind(void 0,!0);function T(e){return(0,o.isRangeOper)(e)&&1!==e.ranges.length}function A(e,t,r){if(T(t))return(0,h.failure)(a.valueErrorOper);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return(0,h.success)({values:n,valuesToFilter:n})}if(T(r))return(0,h.failure)(a.valueErrorOper);var i=function(e,t){var r=e.ranges[0],n=t.ranges[0],i=(0,c.fastMin)(r.cols,u.sheetCols-n.col),o=(0,c.fastMin)(r.rows,u.sheetRows-n.row),s=(0,u.gridRange)(r.row,r.col,o,i),l=(0,a.range3DOper)(e.sheets,s),d=(0,u.gridRange)(n.row,n.col,o,i),p=(0,a.range3DOper)(t.sheets,d);return{actualEvalRange:l,actualFilterRange:p}}(t,r),o=i.actualEvalRange,s=i.actualFilterRange,l=o.ranges[0],d=s.ranges[0],p=e.dereferenceAllOpers([o])[0];if(l.col===d.col&&l.row===d.row)return(0,h.success)({values:p,valuesToFilter:p});var m=e.dereferenceAllOpers([s])[0];return(0,h.success)({values:p,valuesToFilter:m})}function N(e,t){var r=t[0],n=t[1],i=A(e,r,t[2]);if(!(0,h.isSuccess)(i))return i.reason;var a=i.value,o=a.values,u=a.valuesToFilter,c=[(0,s.rangeValues)([(0,l.applyCriteria)(e,o.arrays[0],n,u.arrays[0])])];return P(e,c)}function _(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var i,o,u=t[0];if(T(u))return(0,h.failure)(a.valueErrorOper);if(r){var c=t[1],d=e.dereferenceAllOpers([u])[0];i=(0,l.applyCriteria)(e,d.arrays[0],c),o=2}else{i=e.dereferenceAllOpers([u])[0].arrays[0],o=1}for(var p=o;p<t.length;p+=2){var m=t[p],f=t[p+1];if(T(m))return(0,h.failure)(a.valueErrorOper);if(m.ranges[0].cols!==u.ranges[0].cols||m.ranges[0].rows!==u.ranges[0].rows)return(0,h.failure)(a.valueErrorOper);d=e.dereferenceAllOpers([m])[0];i=(0,l.applyCriteria)(e,d.arrays[0],f,i)}return n&&(i=i.strict()),(0,h.success)((0,s.rangeValues)([i]))}function I(e,t){var r=(0,p.reduceDerefOpers)(e,C(e.mathpack.mul),y,t);return null==r?e.mathpack.zero:r}function O(e,t,r,n,a,s){var u=(0,p.reduceDerefOpers)(a,C(a.mathpack.add),e,s,t);if(null==u)return n;if(r&&(u=b(a,s,u)),(0,o.isErrorOper)(u))return u;var l={count:0},c=(0,p.reduceDerefOpers)(a,R(l),e,s,t);(0,i.assertTrue)("calc.funcs.averageCoerceInner",(0,o.isNumberOper)(u)&&(null==c?void 0:c.kind)===g.OperKind.Number&&l.count>0);var d=a.mathpack.div(u,a.mathpack.fromNumber(l.count));return(0,o.isErrorOper)(d)?d:[d,l.count]}function M(e,t,r,n,i){var o=O(e,t,r,a.div0ErrorOper,n,i);return Array.isArray(o)?o[0]:o}t.sum=function(e,t){var r=e.dereferenceAllOpers(t);return k(e,r)},t.sumsq=function(e,t){var r=e.dereferenceAllOpers(t),n=fe(y),i=(0,p.reduceDerefOpers)(e,C(e.mathpack.add),n,r);return null==i?e.mathpack.zero:i},t.sumif=N,t.sumifs=function(e,t){if(3===t.length)return N(e,[t[1],t[2],t[0]]);var r=_(e,t);return(0,h.isSuccess)(r)?P(e,[r.value]):r.reason},t.product=function(e,t){var r=e.dereferenceAllOpers(t);return I(e,r)};var D=M.bind(void 0,y,void 0,!1),w=M.bind(void 0,y,void 0,!0),L=M.bind(void 0,F,(function(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isStringOper)(r)?e.mathpack.zero:y(0,r)}),!0);function x(e,t){var r=t[0],n=t[1],i=A(e,r,t[2]);if(!(0,h.isSuccess)(i))return i.reason;var a=i.value,o=a.values,u=a.valuesToFilter,c=[(0,s.rangeValues)([(0,l.applyCriteria)(e,o.arrays[0],n,u.arrays[0]).strict()])];return D(e,c)}function K(e,t,r,n,s){for(var u=void 0,l=0,c="",d=function(e,t){return e.coerceOper(t,g.OperKind.String)},m=function(e,n,s){if(void 0!==e&&(0,o.isErrorOper)(e))return e;for(var d=0;d<s;d+=1){if(void 0!==u&&t.length>0&&(!r||u.value.length>0)){var p=t[l];if(l=(l+1)%t.length,c.length+p.value.length>a.cellStringLimit)return a.valueErrorOper;c+=p.value}if((0,o.isErrorOper)(n))return n;if((0,i.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,o.isStringOper)(n)),c.length+n.value.length>a.cellStringLimit)return a.valueErrorOper;if(c+=n.value,u=n,""===n.value&&(0===t.length||r))break}return n},f=0;f<s.length;f+=1){var h=n[f];if((0,o.isRangeOper)(h)&&h.ranges.length>1)return a.valueErrorOper;var v=(0,p.reduceDerefOpers)(e,m,d,s.slice(f,f+1));if(void 0!==v&&(0,o.isErrorOper)(v))return v;(0,i.assertTrue)("calc.funcs.concatInner: expected string from reduce",void 0!==v&&(0,o.isStringOper)(v))}if(r&&void 0!==u&&""===u.value&&t.length>0&&c.length>0){var S=t[(l+t.length-1)%t.length];c=c.substring(0,c.length-S.value.length)}return(0,a.stringOper)(c)}function U(e,t,r){var n={count:0};return(0,p.reduceDerefOpers)(t,R(n),e,r),t.mathpack.fromNumber(n.count)}t.average=function(e,t){var r=e.dereferenceAllOpers(t);return w(e,r)},t.averageif=x,t.averageifs=function(e,t){if(3===t.length)return x(e,[t[1],t[2],t[0]]);var r=_(e,t,void 0,!0);return(0,h.isSuccess)(r)?D(e,[r.value]):r.reason},t.averagea=function(e,t){var r=e.dereferenceAllOpers(t);return L(e,r)},t.concat=function(e,t){var r=e.dereferenceAllOpers(t);return K(e,[],!0,t,r)},t.textjoin=function(e,t){var r=t[0],n=t[1],s=t.slice(2),u=[];if(!(0,o.isMissingOper)(r)){if((0,o.isRangeOper)(r)&&r.ranges.length>1)return a.valueErrorOper;var l=(0,p.reduceDerefOpers)(e,ne(u,m.assertString),(function(e,t){return e.coerceOper(t,g.OperKind.String)}),e.dereferenceAllOpers([r]));if(void 0!==l&&(0,o.isErrorOper)(l))return l;(0,i.assertTrue)("calc.funcs.textjoin: expected string from reduce",void 0!==l&&(0,o.isStringOper)(l))}return K(e,u,(0,o.isMissingOper)(n)||n.value,s,e.dereferenceAllOpers(s))};var B=U.bind(void 0,(function(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isNumberOper)(r)?r:void 0}));t.count=function(e,t){var r=e.dereferenceAllOpers(t);return B(e,r)};var W=U.bind(void 0,(function(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isBlankOper)(r)||(0,f.isEmptyStringOper)(r)?r:void 0}));t.countblank=function(e,t){var r=t[0];if(!(0,o.isSheetIndex)(r.sheets)||1!==r.ranges.length)return a.valueErrorOper;var n=e.dereferenceAllOpers(t);return W(e,n)};var G=U.bind(void 0,(function(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isPrimitiveOper)(r)||(0,o.isErrorOper)(r)?r:void 0}));t.counta=function(e,t){var r=e.dereferenceAllOpers(t);return G(e,r)};var V=U.bind(void 0,(function(e,t){return t}));function j(e,t){var r=t[0],n=t[1];if(T(r))return a.valueErrorOper;var i=e.dereferenceAllOpers([r])[0],o=[(0,s.rangeValues)([(0,l.applyCriteria)(e,i.arrays[0],n)])];return V(e,o)}t.countif=j,t.countifs=function(e,t){if(2===t.length)return j(e,t);var r=_(e,t,!0);return(0,h.isSuccess)(r)?V(e,[r.value]):r.reason};var q=function(e,t,r){return e.mathpack.cond2(t,r)>0},H=function(e,t,r){return e.mathpack.cond2(t,r)<0};function z(e,t,r,n,a){var s=(0,p.reduceDerefOpers)(n,(function(t,r,a){return void 0===t?r:(0,o.isErrorOper)(t)?t:((0,i.assertTrue)("calc.funcs.minMaxCoerceInner",(0,o.isNumberOper)(t)),(0,o.isErrorOper)(r)?r:((0,i.assertTrue)("calc.funcs.minMaxCoerceInner",(0,o.isNumberOper)(r)),e(n,t,r)?t:r))}),t,a,r);return null==s?n.mathpack.zero:s}var Q=z.bind(void 0,q,y,void 0),Y=z.bind(void 0,H,y,void 0),J=z.bind(void 0,q,F,y),$=z.bind(void 0,H,F,y);function X(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case g.OperKind.Boolean:return r;case g.OperKind.Number:return(0,a.booleanOper)(0!==e.mathpack.cond(r));case g.OperKind.String:return;case g.OperKind.Error:return r;case g.OperKind.Missing:case g.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function Z(e,t,r){var n=(0,p.reduceDerefOpers)(t,(function(t,r,n){return void 0!==t&&(0,o.isErrorOper)(t)?t:(0,o.isErrorOper)(r)?r:((0,i.assertTrue)("calc.funcs.booleanInner",(void 0===t||(0,o.isBooleanOper)(t))&&(0,o.isBooleanOper)(r)),(0,a.booleanOper)(e(null==t?void 0:t.value,r.value,n)))}),X,r);return null==n?a.valueErrorOper:n}t.max=function(e,t){var r=e.dereferenceAllOpers(t);return Q(e,r)},t.min=function(e,t){var r=e.dereferenceAllOpers(t);return Y(e,r)},t.maxa=function(e,t){var r=e.dereferenceAllOpers(t);return J(e,r)},t.mina=function(e,t){var r=e.dereferenceAllOpers(t);return $(e,r)},t.maxifs=function(e,t){var r=_(e,t);return(0,h.isSuccess)(r)?Q(e,[r.value]):r.reason},t.minifs=function(e,t){var r=_(e,t);return(0,h.isSuccess)(r)?Y(e,[r.value]):r.reason};var ee=Z.bind(void 0,(function(e,t){return!1!==e&&t})),te=Z.bind(void 0,(function(e,t){return!0===e||t})),re=Z.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function ne(e,t){return function(r,n,i){if(void 0!==r&&(0,o.isErrorOper)(r))return r;if(!(0,o.isErrorOper)(n))for(var a=t(n),s=0;s<i;s+=1)e.push(a);return n}}function ie(e,t,r,n){var i=[],s=(0,p.reduceDerefOpers)(t,ne(i,m.assertNumber),y,[r]);if(null==s)return a.numErrorOper;if((0,o.isErrorOper)(s))return s;var u=t.mathpack;if(u.cond2(n,u.one)<0)return a.numErrorOper;if(u.cond2(n,u.fromNumber(i.length))>0)return a.numErrorOper;var l=i.sort(u.cond2);if(e){var c=(0,m.assertNumber)(u.add((0,m.assertNumber)(u.sub(u.fromNumber(i.length),n)),u.one));return l[u.lfix(c)-1]}return l[u.lfix(n)-1]}t.and=function(e,t){var r=e.dereferenceAllOpers(t);return ee(e,r)},t.or=function(e,t){var r=e.dereferenceAllOpers(t);return te(e,r)},t.xor=function(e,t){var r=e.dereferenceAllOpers(t);return re(e,r)};var ae=ie.bind(void 0,!0),oe=ie.bind(void 0,!1);function se(e,t,r,n){var i=e.mathpack,s=[],u=(0,p.reduceDerefOpers)(e,ne(s,m.assertNumber),y,t);if(null==u)return a.numErrorOper;if((0,o.isErrorOper)(u))return u;if((0,o.isErrorOper)(r))return r;if(i.cond(r)<0)return a.numErrorOper;if(i.cond2(r,i.one)>0)return a.numErrorOper;var l=s.sort(i.cond2),c=(0,m.assertNumber)(i.sub(i.fromNumber(l.length),i.one)),d=(0,m.assertNumber)(i.add(i.fromNumber(l.length),i.one)),f=n?(0,m.assertNumber)(i.mul(c,r)):(0,m.assertNumber)(i.sub((0,m.assertNumber)(i.mul(d,r)),i.one));if(i.cond(f)<0||i.cond2(f,c)>0)return a.numErrorOper;var g=i.lfix(f),h=(0,m.assertNumber)(i.sub(f,i.fromNumber(g)));if(0===i.cond(h))return l[g];var v=i.sub(l[g+1],l[g]);return(0,o.isErrorOper)(v)?v:i.add(l[g],(0,m.assertNumber)(i.mul(v,h)))}t.large=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return ae(e,n,i)},t.small=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return oe(e,n,i)};var ue=function(e,t,r){return se(e,[t],r,!0)};t.percentile=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return ue(e,n,i)};var le=function(e,t,r){return se(e,[t],r,!1)};function ce(e,t){var r=e.mathpack;if(r.cond(t)<0)return a.numErrorOper;if(r.cond2(t,r.fromNumber(5))>=0)return a.numErrorOper;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}t.percentile_exc=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return le(e,n,i)};var de=function(e,t,r){return se(e,[t],ce(e,r),!0)};t.quartile=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return de(e,n,i)};var pe=function(e,t,r){return se(e,[t],ce(e,r),!1)};function me(e,t){return se(e,t,e.mathpack.fromNumber(.5),!0)}function fe(e){return function(t,r){var n=e(t,r);return void 0!==n&&(0,o.isNumberOper)(n)?t.mathpack.mul(n,n):n}}function ge(e,t){return function(r,n){var i=e(r,n);if((null==i?void 0:i.kind)!==g.OperKind.Number)return i;var a=r.mathpack,s=a.sub(i,t);return(0,o.isErrorOper)(s)?s:a.mul(s,s)}}function he(e,t,r,n){var s={count:0};if(null==(0,p.reduceDerefOpers)(r,R(s),e,n,t))return a.div0ErrorOper;(0,i.assertTrue)("calc.funcs.varFirstPass: unexpected count type",s.count>=1);var u=C(r.mathpack.add),l=(0,p.reduceDerefOpers)(r,u,e,n,t),c=(0,p.reduceDerefOpers)(r,u,fe(e),n,void 0===t?void 0:fe(t));if((0,i.assertTrue)("calc.funcs.varFirstPass: expected sum",null!=l),(0,i.assertTrue)("calc.funcs.varFirstPass: expected sumSq",null!=c),(0,o.isErrorOper)(l))return l;if((0,o.isErrorOper)(c))return c;(0,i.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,o.isNumberOper)(l)&&(0,o.isNumberOper)(c));var d=r.mathpack,m=d.div(l,d.fromNumber(s.count));return(0,o.isErrorOper)(m)?m:[s.count,l,c,m]}function ve(e,t,r,n,a){var o=C(r.mathpack.add),s=(0,p.reduceDerefOpers)(r,o,ge(e,a),n,void 0===t?void 0:ge(t,a));return(0,i.assertTrue)("calc.funcs.varSecondPass: unexpected error",(null==s?void 0:s.kind)===g.OperKind.Number),s}function Se(e,t,r,n){var i=he(e,t,r,n);if(!Array.isArray(i))return i;var s=r.mathpack,u=i[0],l=i[1],c=i[2],d=i[3];if(u<2)return a.div0ErrorOper;var p=s.mul(l,l);if((0,o.isErrorOper)(p))return p;var f=(0,m.assertNumber)(s.div(p,s.fromNumber(u))),g=(0,m.assertNumber)(s.sub(c,f));if(0===s.cond(d))return s.cond(g)<0?s.zero:s.div(g,s.fromNumber(u-1));if(s.cond(g)>=0){var h=(0,m.assertNumber)(s.div(g,s.fromNumber(u-1)));if(s.cond2(h,s.fromNumber(21219957905e-324))>0){var v=s.div(f,c),S=(0,o.isErrorOper)(v)?v:s.sub(v,s.one);if(!(0,o.isErrorOper)(S)&&s.cond2(s.abs(S),s.fromNumber(.01))>0){var y=s.div(d,h),F=(0,o.isErrorOper)(y)?y:s.sub(s.abs(y),s.fromNumber(1e3));if(!(0,o.isErrorOper)(F)&&s.cond(F)<0)return h}}}var C=ve(e,t,r,n,d);return s.cond(C)<0?s.zero:s.div(C,s.fromNumber(u-1))}function ye(e,t,r,n){var i=he(e,t,r,n);if(!Array.isArray(i))return i;var s=r.mathpack,u=i[0],l=i[1],c=i[2],d=i[3];if(u<1)return a.div0ErrorOper;var p=s.mul(l,l);if((0,o.isErrorOper)(p))return p;var f=s.mul(c,s.fromNumber(u));if((0,o.isErrorOper)(f))return f;var g=(0,m.assertNumber)(s.sub(f,p));if(0===s.cond(d))return s.cond(g)<0?s.zero:s.div(g,s.fromNumber(u*u));if(s.cond(g)>=0){var h=(0,m.assertNumber)(s.div(g,s.fromNumber(u*u)));if(s.cond2(h,s.fromNumber(21219957905e-324))>0){var v=s.div((0,m.assertNumber)(s.div(p,s.fromNumber(u))),c),S=(0,o.isErrorOper)(v)?v:s.sub(v,s.one);if(!(0,o.isErrorOper)(S)&&s.cond2(s.abs(S),s.fromNumber(.01))>0){var y=s.div(d,h),F=(0,o.isErrorOper)(y)?y:s.sub(s.abs(y),s.fromNumber(1e3));if(!(0,o.isErrorOper)(F)&&s.cond(F)<0)return h}}}var C=ve(e,t,r,n,d);return s.cond(C)<0?s.zero:s.div(C,s.fromNumber(u))}t.quartile_exc=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return pe(e,n,i)},t.median=function(e,t){var r=e.dereferenceAllOpers(t);return me(e,r)},t.trimmean=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],s=r[1],u=[],l=(0,p.reduceDerefOpers)(e,ne(u,m.assertNumber),y,[n]);if(null==l)return a.numErrorOper;if((0,o.isErrorOper)(l))return l;var c=e.mathpack;if(c.cond(s)<0)return a.numErrorOper;if(c.cond2(s,c.one)>=0)return a.numErrorOper;u=u.sort(c.cond2);var d=c.lfix((0,m.assertNumber)(c.div((0,m.assertNumber)(c.mul(c.fromNumber(u.length),s)),c.fromNumber(2))));(0,i.assertTrue)("calc.funcs.trimmean",d+d<u.length);var f=u[d],g=u[u.length-1-d],h=0,v=0,S=(0,p.reduceDerefOpers)(e,C(e.mathpack.add),(function(e,t){var r=y(0,t);if(void 0===r)return r;(0,i.assertTrue)("calc.funcs.trimmean: unexpected error",(0,o.isNumberOper)(r));var n=e.mathpack;if(n.cond2(r,f)<0)h+=1;else{if(!(n.cond2(r,g)>0))return r;v+=1}}),[n]);(0,i.assertTrue)("calc.funcs.trimmean: found no elements",void 0!==S&&(0,o.isNumberOper)(S)),(0,i.assertTrue)("calc.funcs.trimmean: trimmed too many",h<=d&&v<=d);for(var F=S;h<d;h+=1){var R=c.sub(F,f);if((0,o.isErrorOper)(R))return R;F=R}for(;v<d;v+=1){R=c.sub(F,g);if((0,o.isErrorOper)(R))return R;F=R}return c.div(F,c.fromNumber(u.length-d-d))};var Fe=Se.bind(void 0,y,void 0),Ce=ye.bind(void 0,y,void 0),Re=Se.bind(void 0,F,y),be=ye.bind(void 0,F,y);function Ee(e){return function(t,r){var n=e(t,r);return(0,o.isNumberOper)(n)?t.mathpack.sqrt(n):n}}var Pe=Ee(Fe),ke=Ee(Ce),Te=Ee(Re),Ae=Ee(be);t.stdev=function(e,t){var r=e.dereferenceAllOpers(t);return Pe(e,r)},t.stdevp=function(e,t){var r=e.dereferenceAllOpers(t);return ke(e,r)},t.stdeva=function(e,t){var r=e.dereferenceAllOpers(t);return Te(e,r)},t.stdevpa=function(e,t){var r=e.dereferenceAllOpers(t);return Ae(e,r)},t.var_=function(e,t){var r=e.dereferenceAllOpers(t);return Fe(e,r)},t.varp=function(e,t){var r=e.dereferenceAllOpers(t);return Ce(e,r)},t.vara=function(e,t){var r=e.dereferenceAllOpers(t);return Re(e,r)},t.varpa=function(e,t){var r=e.dereferenceAllOpers(t);return be(e,r)};var Ne=[w,B,G,Q,Y,I,Pe,ke,k,Fe,Ce];function _e(e,t){var r,n=[],s=(0,p.reduceDerefOpers)(e,(r=n,function(e,t,n){if(void 0!==e&&(0,o.isErrorOper)(e))return e;if((0,o.isNumberOper)(t))for(var i=0;i<n;i+=1)r.push({value:t,index:r.length});return t}),y,t);if(null==s)return a.naErrorOper;if((0,o.isErrorOper)(s))return s;var u=e.mathpack,l=n.sort((function(e,t){return u.cond2(e.value,t.value)})),c=1,d=0,m=1/0,f=[];function g(e){c=1,m=e.index}var h,v,S,F=function(e){var t=e.value;c>d?(d=c,f.length=0,f.push({value:t,index:m})):c===d&&f.push({value:t,index:m})};g(l[0]);for(var C=1;C<l.length;C+=1)v=l[C-1],S=l[C],0===u.cond2(v.value,S.value)?((h=l[C]).index<m&&(m=h.index),c+=1):(F(l[C-1]),g(l[C]));return F(l[l.length-1]),d<2?a.naErrorOper:((0,i.assertTrue)("calc.funcs.modeInner: unexpected error",0!==f.length),f.sort((function(e,t){return e.index-t.index})))}function Ie(e,t){var r=_e(e,t);return Array.isArray(r)?r[0].value:r}t.mode=function(e,t){return Ie(e,t)},t.mode_mult=function(e,t){var r=_e(e,t);return Array.isArray(r)?(0,a.arrayOper)(r.length,1,r.map((function(e){return[e.value]}))):r};var Oe=(0,v.binaryVisitor)(n.__assign(n.__assign({},(0,v.constVisitor)(!1)),{wsfNode:function(e){return e===d.WorksheetFuncId.SUBTOTAL||e===d.WorksheetFuncId.AGGREGATE}}),(function(e,t){return e||t}));function Me(e){if(!(0,s.isRangeValues)(e))return e;var t=e.arrays.map((function(e){return e.map((function(e){var t,r=e[0],n=e[1];return void 0!==n&&(t=n.formula,(0,v.reduceBottomUp)(Oe,t))?void 0:r}))}));return(0,s.rangeValues)(t)}t.subtotal=function(e,t){var r=t[0],n=t.slice(1),i=e.mathpack.sfix(r),o=Ne.length;if(!(i>=1&&i<=o||i>=101&&i<=o+100))return a.valueErrorOper;var s=i>100||e.isInFilterMode(n),u=e.dereferenceAllOpersAndFormulae(n,s).map(Me);return(0,Ne[i%100-1])(e,u)};var De=n.__spreadArray(n.__spreadArray([],Ne,!0),[me,Ie],!1),we=[ae,oe,ue,de,le,pe];function Le(e,t,r){var n=t[0],i=t[1],s=t[2],u=(void 0===s?a.falseOper:s).value?1:-1,l=0,c=0,d=e.mathpack,f=(0,p.reduceDerefOpers)(e,(function(e,t,r){if(void 0!==e)return e;if((0,o.isErrorOper)(t))return t;var i=d.cond2(n,(0,m.assertNumber)(t));0===i?l+=r:i===u&&(c+=r)}),y,e.dereferenceAllOpers([i]));if(void 0!==f)return f;if(0===l)return a.naErrorOper;var g=d.fromNumber(c+1);if(r){var h=d.div(d.fromNumber(l-1),d.fromNumber(2));return d.add(g,(0,m.assertNumber)(h))}return g}function xe(e){return function(t,r){var n=e(t,r);return(null==n?void 0:n.kind)===g.OperKind.Number?t.mathpack.abs(n):n}}function Ke(e,t,r){var n=O(y,void 0,!0,a.numErrorOper,t,r);if(!Array.isArray(n))return n;var s=n[0],u=n[1],l=(0,p.reduceDerefOpers)(t,C(t.mathpack.add),e(function(e,t){return function(r,n){var i=e(r,n);return(null==i?void 0:i.kind)===g.OperKind.Number?r.mathpack.sub(i,t):i}}(y,s)),r);return(0,i.assertTrue)("calc.funcs.sumDevAndCount",void 0!==l),(0,o.isErrorOper)(l)?l:[(0,m.assertNumber)(l),u]}t.aggregate=function(e,t){var r=t[0],n=t[1],l=t[2],c=t[3],d=t.slice(4),m=e.mathpack,f=m.sfix(r),h=m.sfix(n);if(!(f>=1&&f<=De.length+we.length&&h>=0&&h<=7))return a.valueErrorOper;var v=1==(1&h),y=2==(2&h),F=!(4==(4&h));function C(t){var r=F?e.dereferenceAllOpersAndFormulae(t,v).map(Me):e.dereferenceAllOpers(t,v);return y&&(r=r.map((function(e){if((0,p.isPrimitiveCoercedOper)(e))return e;if((0,s.isRangeValues)(e)){var t=e.arrays.map((function(e){return e.map((function(e){return void 0===e||(0,o.isErrorOper)(e)?void 0:e}))}));return(0,s.rangeValues)(t)}if((0,p.isCoercedArrayOper)(e)){var r=e.opers.map((function(e){return e.map((function(e){return void 0===e||(0,o.isErrorOper)(e)?void 0:e}))}));return(0,p.coercedArrayOper)(e.rows,e.cols,r)}return e}))),r}if(f>De.length){if(void 0===c||d.length>0)return a.valueErrorOper;var R=g.OperKind.Number;!(0,o.isRangeOper)(c)||(0,o.isSheetIndex)(c.sheets)&&1===c.ranges.length&&(0,u.isGridCell)(c.ranges[0])||(0,S.throwEvaluationError)((0,o.notImplemented)(["AGGREGATE multi-cell array param"]));var b=e.coerceOper(e.dereferenceOper(c,R),R);if((0,o.isErrorOper)(b))return a.valueErrorOper;if((0,o.isRangeOper)(l)&&!(0,o.isSheetIndex)(l.sheets))return a.valueErrorOper;var E=C([l])[0],P=De.length;return(0,we[f-P-1])(e,E,b)}for(var k=2;k<t.length;k+=1){var T=t[k];if(!T||!(0,o.isRangeOper)(T)||!(0,o.isSheetIndex)(T.sheets))return a.valueErrorOper}var A=C(t.slice(2));return(0,i.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",f>=1&&f<=De.length),(0,De[f-1])(e,A)},t.rank=function(e,t){return Le(e,t,!1)},t.rank_avg=function(e,t){return Le(e,t,!0)},t.avedev=function(e,t){var r=e.dereferenceAllOpers(t),n=Ke(xe,e,r);if(!Array.isArray(n))return n;var i=n[0],a=n[1];return e.mathpack.div(i,e.mathpack.fromNumber(a))},t.devsq=function(e,t){var r=e.dereferenceAllOpers(t),n=Ke(fe,e,r);return Array.isArray(n)?n[0]:n};var Ue=new Float64Array(1),Be=new Int32Array(Ue.buffer);function We(e,t){Ue[0]=e.toNumber(t);var r=((2146435072&Be[1])>>>20)-1023;return Be[1]=-2146435073&Be[1]|1072693248,[e.fromNumber(Ue[0]),r]}function Ge(e,t,r){Ue[0]=e.toNumber(t);var n=((2146435072&Be[1])>>>20)-1023;return Be[1]=-2146435073&Be[1]|n+r+1023<<20&2146435072,e.fromNumber(Ue[0])}t.geomean=function(e,t){var r=e.mathpack,n=e.dereferenceAllOpers(t),s={count:0,prodExp:0},u=(0,p.reduceDerefOpers)(e,function(e,t){var r=e.mathpack;return function(e,n,s){if(void 0!==e&&(0,o.isErrorOper)(e))return e;if((0,i.assertTrue)("calc.funcs.geometricReducer",void 0===e||(0,o.isNumberOper)(e)),(0,o.isErrorOper)(n))return n;if((0,i.assertTrue)("calc.funcs.geometricReducer",(0,o.isNumberOper)(n)),r.cond(n)<=0)return a.numErrorOper;for(var u=We(r,n),l=u[0],c=u[1],d=null!=e?e:r.one,p=0;p<s;p+=1){if(t.count%512==511){var m=We(r,d),f=m[0],g=m[1];if(t.prodExp+=g,d=f,t.prodExp>2130706431||t.prodExp<-2130706431)return a.numErrorOper}t.count+=1,t.prodExp+=c,d=r.mul(d,l),(0,i.assertTrue)("calc.funcs.geometricReducer",!(0,o.isErrorOper)(d))}return d}}(e,s),y,n);if(null==u)return a.numErrorOper;if((0,o.isErrorOper)(u))return u;if((0,i.assertTrue)("calc.funcs.geomean",s.count>0&&(0,o.isNumberOper)(u)),1===s.count)return Ge(r,u,s.prodExp);var l=We(r,u),c=l[0],d=l[1];s.prodExp+=d,u=c;var m=s.prodExp/s.count|0,f=s.prodExp%s.count,g=r.div(r.one,r.fromNumber(s.count));if((0,i.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(g)),f<=1e3){var h=Ge(r,u,f),v=r.power(h,g);return(0,i.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(v)),Ge(r,v,m)}var S=f-1e3,F=Ge(r,u,f-S),C=r.power(F,g);(0,i.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(C));var R=Ge(r,C,m),b=r.mul(r.fromNumber(s.count),r.fromNumber(1.4426950408889636));(0,i.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(b));var E=r.div(r.fromNumber(S),b);(0,i.assertTrue)("calc.funcs.geomean",!(0,o.isErrorOper)(E));var P=r.exp(E);return(0,o.isErrorOper)(P)?P:r.mul(R,P)},t.harmean=function(e,t){var r,n=e.dereferenceAllOpers(t),s=(r=y,function(e,t){var n=r(e,t);if(void 0===n||!(0,o.isNumberOper)(n))return n;var i=e.mathpack;return i.cond(n)<=0?a.numErrorOper:i.div(i.one,n)}),u=(0,p.reduceDerefOpers)(e,C(e.mathpack.add),s,n);if(null==u)return a.naErrorOper;if((0,o.isErrorOper)(u))return u;var l={count:0},c=(0,p.reduceDerefOpers)(e,R(l),s,n);(0,i.assertTrue)("calc.funcs.harmean",(0,o.isNumberOper)(u)&&(null==c?void 0:c.kind)===g.OperKind.Number&&l.count>0);var d=e.mathpack.div(u,e.mathpack.fromNumber(l.count));return(0,o.isErrorOper)(d)?d:e.mathpack.div(e.mathpack.one,d)};var Ve=function(e){return(0,o.isRichOper)(e)?e.getFallback():e};t.sumproduct=function(e,t){for(var r=t.map((function(e){return(0,a.arrayOper)(e.rows,e.cols,e.opers.map((function(e){return e.map(Ve)})))})),n=e.mathpack,i=0,s=r;i<s.length;i++)for(var u=0,l=s[i].opers;u<l.length;u++)for(var c=0,d=l[u];c<d.length;c++){var p=d[c];if((0,o.isErrorOper)(p))return p}var m=r[0].rows,f=r[0].cols;if(!r.every((function(e){return e.rows===m&&e.cols===f})))return a.valueErrorOper;for(var g=n.zero,h=0;h<m;++h)e:for(var v=0;v<f;++v){var S=r[0].opers[h][v];if((0,o.isNumberOper)(S)){for(var y=S,F=1;F<r.length;++F){var C=r[F].opers[h][v];if(!(0,o.isNumberOper)(C))continue e;if(y=n.mul(y,C),(0,o.isErrorOper)(y))return y}if(g=n.add(y,g),(0,o.isErrorOper)(g))return g}}return g}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyCriteria=t.compileCriteria=t.parseCriteria=void 0;var n=r(8),i=r(34),a=r(45),o=r(25),s=r(184),u=r(7),l=r(10),c=r(138),d=r(27),p=r(18),m={"=":i.OperatorId.Eq,"<":i.OperatorId.Lt,">":i.OperatorId.Gt},f={"<>":i.OperatorId.Ne,"<=":i.OperatorId.Le,">=":i.OperatorId.Ge};function g(e,t){if(!(0,u.isStringOper)(t))return t;var r,i,a=(r=t.value).length>=2&&void 0!==(i=f[r.substring(0,2)])?[i,r.substring(2)]:r.length>=1&&void 0!==(i=m[r.substring(0,1)])?[i,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){var r=e.config.localeInfo;if(0===r.stringCompareCI(t,r.trueName))return n.trueOper;if(0===r.stringCompareCI(t,r.falseName))return n.falseOper;for(var i=1;i<r.errorNames.length;i+=1){var a=r.errorNames[i];if(null!=a&&0===r.stringCompareCI(a,t))return(0,n.errorOper)(i)}var o=e.parseGeneral(t,!1);return void 0!==o?o:(0,n.stringOper)(t)}(e,a[1])}}function h(e,t){var r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:i.OperatorId.Eq,operand:t},n=e.config,a=n.mathpack,o=n.localeInfo;if(r.operator===i.OperatorId.Ne&&(0,d.isEmptyStringOper)(r.operand))return function(e){return!(0,u.isBlankOper)(e)};if(r.operator===i.OperatorId.Eq&&(0,d.isEmptyStringOper)(r.operand))return u.isBlankOper;if(void 0!==r.operator&&(0,d.isEmptyStringOper)(r.operand))return function(e){return!1};if(void 0===r.operator&&(0,d.isEmptyStringOper)(r.operand))return function(e){return(0,u.isBlankOper)(e)||(0,d.isEmptyStringOper)(e)};var m,f,g=void 0===r.operator?i.OperatorId.Eq:r.operator;switch(r.operand.kind){case p.OperKind.Number:return m=g,f=r.operand,function(t){var r=(0,u.isRichOper)(t)?t.getFallback():t;if((0,u.isNumberOper)(r))return(0,s.cmpNum)(a,m,r,f);if((0,u.isStringOper)(r)&&m===i.OperatorId.Eq){var n=e.parseGeneral(r.value,!1);return void 0!==n&&(0,s.cmpNum)(a,m,n,f)}return m===i.OperatorId.Ne};case p.OperKind.Boolean:return function(e,t){return function(r){var n=(0,u.isRichOper)(r)?r.getFallback():r;return(0,u.isBooleanOper)(n)?(0,s.cmpBool)(e,n,t):e===i.OperatorId.Ne}}(g,r.operand);case p.OperKind.String:return function(e,t){switch(e){case i.OperatorId.Eq:case i.OperatorId.Ne:var r=new c.WildExp(o,t.value);return function(t){var n=(0,u.isRichOper)(t)?t.getFallback():t;return(0,u.isStringOper)(n)?r.test(n.value)===(e===i.OperatorId.Eq):e===i.OperatorId.Ne};case i.OperatorId.Lt:case i.OperatorId.Gt:case i.OperatorId.Le:case i.OperatorId.Ge:return function(r){var n=(0,u.isRichOper)(r)?r.getFallback():r;return!!(0,u.isStringOper)(n)&&(0,s.cmpStr)(o,e,n,t)}}}(g,r.operand);case p.OperKind.Error:return function(e,t){return function(r){var n=(0,u.isRichOper)(r)?r.getFallback():r;return(0,u.isErrorOper)(n)?(0,s.cmpInt)(e,n.type-t.type):e===i.OperatorId.Ne}}(g,r.operand);default:return(0,l.assertNever)("calc.funcs.criteria.compileCriteria",r.operand)}}t.parseCriteria=g,t.compileCriteria=h,t.applyCriteria=function(e,t,r,n){var i=h(e,g(e,r)),s=t,u=void 0===n?s:n;return new a.NonstrictSparseArray2D(u.rows,u.cols,(0,o.fastMax)(s.denseRows,u.denseRows),(0,o.fastMax)(s.denseCols,u.denseCols),(function(e,t){var r=s.get(e,t);return i(r)?u.get(e,t):void 0}),(function(){var e=s.getSparse();return i(e)?u.getSparse():void 0}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduceDerefOpers=t.isPrimitiveCoercedOper=t.isCoercedArrayOper=t.coercedArrayOper=void 0;var n=r(84),i=r(45),a=r(10),o=r(18);t.coercedArrayOper=function(e,t,r){return(0,a.assertNatural)("calc.runtime.coercedArrayOper",e),(0,a.assertNatural)("calc.runtime.coercedArrayOper",t),r.length!==e?(0,a.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:o.OperKind.Array,rows:e,cols:t,opers:r}},t.isCoercedArrayOper=function(e){return e.kind===o.OperKind.Array};var s=o.OperKind.Number|o.OperKind.String|o.OperKind.Boolean;t.isPrimitiveCoercedOper=function(e){var t=e.kind;return"number"==typeof t&&0!=(t&s)},t.reduceDerefOpers=function(e,t,r,a,s){var u=function(n,a,u,c){if((null==a?void 0:a.kind)===o.OperKind.Array){for(var d=new i.StrictArray2D(a.rows,a.cols,a.opers),p=n,m=0;m<u;m+=1)p=l(p,d);return p}var f=(c&&void 0!==s?s:r)(e,a);return null==f?n:t(n,f,u)};function l(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var i=0;i<t.cols;i+=1){var a=t.get(n,i);void 0!==a&&(r=u(r,a,1,!0))}return r}function c(e,t){for(var r=e,n=t.getSparse(),i=t.cols-t.denseCols,a=0;a<t.denseRows;a+=1){for(var o=0;o<t.denseCols;o+=1){var s=t.get(a,o);void 0!==s&&(r=u(r,s,1,!1))}i>0&&void 0!==n&&(r=u(r,n,i,!1))}var l=(t.rows-t.denseRows)*t.cols;return l>0&&void 0!==n&&(r=u(r,n,l,!1)),r}return a.reduce((function(e,t){return(0,n.isRangeValues)(t)?t.arrays.reduce(c,e):u(e,t,1,!1)}),void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yearFrac=t.networkdays=t.networkdays_intl=t.eomonth=t.edate=t.workday=t.workday_intl=t.days=t.datedif=t.days360=t.time=t.date=t.weeknum=t.isoweeknum=t.weekday=t.second=t.minute=t.hour=t.day=t.month=t.year=void 0;var n=r(0),i=r(8),a=r(275),o=r(46),s=r(7),u=r(26),l=r(18),c=r(10);function d(e,t,r){var n=r[0],o=t.datepack,s=t.config,u=o.fromNum(s,n,a.Rounding.RoundSec);return!1===u?i.numErrorOper:t.mathpack.fromNumber(e(u))}function p(e,t,r){var o=t[0],s=t[1];void 0===r&&(r=!1);var u,l=e.config,c=e.mathpack,d=e.datepack.fromNum(n.__assign(n.__assign({},l),{date1904:l.date1904&&!r}),o,a.Rounding.RoundSec);if(!1===d)return i.numErrorOper;switch(void 0!==s?c.sfix(s):1){case 1:case 17:u=d.wdy;break;case 2:case 11:u=1===d.wdy?7:d.wdy-1;break;case 3:u=1===d.wdy?6:d.wdy-2;break;case 12:u=(d.wdy+4)%7+1;break;case 13:u=(d.wdy+3)%7+1;break;case 14:u=(d.wdy+2)%7+1;break;case 15:u=(d.wdy+1)%7+1;break;case 16:u=d.wdy%7+1;break;default:return i.numErrorOper}return c.fromNumber(u)}function m(e,t,r){if(!t){var n=e.lfix(r);if(0===n||1===n)return e.fromNumber(52)}return i.numErrorOper}function f(e,t,r){var u=r[0],l=r[1],d=(0,o.chkDateOper)(t,u);if((0,s.isErrorOper)(d))return d;var f=function(e,t,r){if(void 0===t||(0,s.isMissingOper)(t))return[r?2:1,r];var n=(0,o.chkNumOper)(e,t);if(!(0,s.isErrorOper)(n)){var i=e.mathpack.sfix(n);if(r){if(1===i||2===i)return[i,r]}else{if(1===i||2===i)return[i,r];if(i>=11&&i<=16)return[i-9,r];if(17===i)return[1,r];if(21===i)return[2,!0]}}return[void 0,r]}(t,l,e),g=f[0],h=f[1];if(void 0===g)return i.numErrorOper;var v=t.mathpack,S=t.datepack,y=t.config,F=n.__assign(n.__assign({},y),{date1904:!1}),C=S.fromNum(F,d,a.Rounding.RoundSec);if(!1===C)return m(v,F.dateCompatibility,d);var R=(0,a.dateTime)(C.yr,1,1,0,0,0,0,0,a.Rounding.RoundSec),b=S.toNum(F,R);if((0,s.isErrorOper)(b))return m(v,F.dateCompatibility,d);var E=p(t,[b],!0);if((0,s.isErrorOper)(E))return E;var P=(0,o.assertNumber)(v.add((0,o.assertNumber)(v.sub(E,v.fromNumber(g))),v.fromNumber(7))),k=(0,o.assertNumber)((0,o.numMod)(v,P,v.fromNumber(7))),T=(0,o.assertNumber)(v.add(v.floor((0,o.assertNumber)(v.div((0,o.assertNumber)(v.add((0,o.assertNumber)(v.sub(d,b)),k)),v.fromNumber(7)))),v.one));return h?function(e,t,r,i){var a=e.mathpack,s=e.datepack,u=e.config,l=n.__assign({},i),d=(t+6-l.wdy)%7;if(12===l.mon&&l.dom+d>=35)return a.one;l.dom=4,l.mon=1;var p=s.toDays(u,l);if((0,c.assertTrue)("calc.funcs.weeknumISOAmendments",!1!==p),((p=(p-1)%7+1)-t+7)%7<3){var m=(0,o.assertNumber)(a.sub(r,a.one));if(0===a.cond(m)){var f=l.yr-1;return t===p||f%4==0&&(f%100!=0||f%400==0)&&(t-p+7)%7==6?a.fromNumber(53):a.fromNumber(52)}return m}return r}(t,g,T,C):T}t.year=d.bind(void 0,(function(e){return e.yr})),t.month=d.bind(void 0,(function(e){return e.mon})),t.day=d.bind(void 0,(function(e){return e.dom})),t.hour=d.bind(void 0,(function(e){return e.hour})),t.minute=d.bind(void 0,(function(e){return e.min})),t.second=d.bind(void 0,(function(e){return e.sec})),t.weekday=function(e,t){return p(e,t)},t.isoweeknum=f.bind(void 0,!0),t.weeknum=f.bind(void 0,!1);t.date=function(e,t){var r=t[0],n=t[1],o=t[2],s=e.mathpack,u=e.datepack,l=e.config,c=s.sfix(r);if(c>9999)return i.numErrorOper;var d=s.sfix(n);if(d>32767||d<-32768)return i.numErrorOper;var p=s.sfix(o);(p>32767||p<-32768)&&(p=32767),l.dateCompatibility?c<1900&&(c+=1900):c<1900&&!(1899===c&&12===d&&p>=30)&&(c+=1900);var m=(0,a.dateTime)(c,d,p,0,0,0,0,0,a.Rounding.RoundSec);return u.toNum(l,m)};var g;function h(e,t){var r;if((0,s.isStringOper)(t)){var n=t.value.replace(/^\s+/,"");if(r=e.coerceOper((0,i.stringOper)(n),l.OperKind.Number),(0,s.isErrorOper)(r))return r}else r=t;return(0,o.chkDateOper)(e,r)}function v(e,t,r){return r?(0,o.assertNumber)(e.sub(t,e.fromNumber(o.atpm1904to1900Days))):t}function S(e,t){return 0!=(e>>t%7&1)}function y(e){switch(e){case 1:return g.Saturday|g.Sunday;case 2:return g.Sunday|g.Monday;case 3:return g.Monday|g.Tuesday;case 4:return g.Tuesday|g.Wednesday;case 5:return g.Wednesday|g.Thursday;case 6:return g.Thursday|g.Friday;case 7:return g.Friday|g.Saturday;case 11:return g.Sunday;case 12:return g.Monday;case 13:return g.Tuesday;case 14:return g.Wednesday;case 15:return g.Thursday;case 16:return g.Friday;case 17:return g.Saturday;default:return!1}}function F(e){if(7!==e.length)return!1;for(var t=g.None,r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function C(e,t){var r=t[0],n=t[1],a=t[2],c=t[3],d=g.Saturday|g.Sunday,p=(0,o.chkDateOper)(e,r);if((0,s.isErrorOper)(p))return p;var m=(0,o.chkNumOper)(e,n);if((0,s.isErrorOper)(m))return m;var f=e.mathpack,h=e.config;m=f.floor(m);var C=f.cond(m)>0?f.one:f.fromNumber(-1),R=f.abs(m),b=(0,o.assertNumber)(f.add(p,m));if(!(0,o.validDateRange)(e,b))return i.numErrorOper;if(0===f.cond(R))return v(f,p,h.date1904);var E=null,P=[];if(a){if(!(0,s.isMissingOper)(a)){if((0,s.isNumberOper)(a)){var k=y(f.lfix(a));if(!1===k)return i.numErrorOper;d=k}else{if(!(0,s.isStringOper)(a))return i.numErrorOper;var T=F(a.value);if(!1===T)return i.valueErrorOper;d=T}if(127===d)return i.valueErrorOper}if(c&&!(0,s.isMissingOper)(c)){var A=(0,o.chkNumMultiOper)(e,c);if(!(0,u.isSuccess)(A))return A.reason;E=A.value}}for(var N=null==E?[]:function(e){for(var t=[],r=e.getSparse(),n=e.cols-e.denseCols,i=0;i<e.denseRows;i+=1){for(var a=0;a<e.denseCols;a+=1){var o=e.get(i,a);void 0!==o&&t.push(o)}if(n>0&&void 0!==r)for(var s=0;s<n;s+=1)t.push(r)}var u=(e.rows-e.denseRows)*e.cols;if(u>0&&void 0!==r)for(i=0;i<u;i+=1)t.push(r);return t}(E),_=N.length-1;_>=0;_-=1){var I=N[_];switch(I.kind){case l.OperKind.Number:case l.OperKind.String:case l.OperKind.Blank:var O=(0,o.chkDateOper)(e,I);if((0,s.isErrorOper)(O))return O;P[_]=O;break;case l.OperKind.Error:return I;default:return i.valueErrorOper}}for(;f.cond(R)>0;){if(p=(0,o.assertNumber)(f.add(p,C)),!S(d,f.lfix(p))){var M=!0;for(_=0;_<N.length;_+=1)if(0===f.cond2(P[_],p)){M=!1;break}M&&(R=(0,o.assertNumber)(f.sub(R,f.one)))}}return p=v(f,p,h.date1904),(0,o.validDateRange)(e,p)?p:i.numErrorOper}t.time=function(e,t){var r=t[0],n=t[1],o=t[2],u=e.mathpack,l=e.datepack,c=e.config,d=u.sfix(r);if(d>32767)return i.numErrorOper;var p=u.sfix(n);if(p>32767)return i.numErrorOper;var m,f,g,h=u.sfix(o);if(h>32767)return i.numErrorOper;c.dateCompatibility?(m=c.date1904?1904:1900,f=1,g=c.date1904?1:0):(m=1899,f=12,g=30);var v=(0,a.dateTime)(m,f,g,d,p,h,0,0,a.Rounding.RoundSec),S=l.toNum(c,v);return(0,s.isErrorOper)(S)?S:u.cond(S)<0?i.numErrorOper:u.sub(S,u.trunc(S))},t.days360=function(e,t){var r,n=t[0],o=t[1],s=t[2],u=e.mathpack,l=e.datepack,c=e.config,d=null!==(r=null==s?void 0:s.value)&&void 0!==r&&r,p=l.fromNum(c,n,a.Rounding.RoundSec);if(!1===p)return i.naErrorOper;var m=31===p.dom||!d&&2===p.mon&&p.dom===l.daysPerMonth(2,p.yr,c.dateCompatibility)?30:p.dom,f=u.fromNumber(360*(p.yr-1900)+30*p.mon+m),g=l.fromNum(c,o,a.Rounding.RoundSec);if(!1===g)return i.naErrorOper;var h=31!==g.dom||!d&&30!==p.dom?g.dom:30,v=u.fromNumber(360*(g.yr-1900)+30*g.mon+h);return u.sub(v,f)},t.datedif=function(e,t){var r=t[0],n=t[1],o=t[2].value;if(o.length>2||0===o.length)return i.numErrorOper;var s=e.mathpack,u=e.datepack,l=e.config,c=s.lfix(r),d=u.fromNum(l,r,a.Rounding.RoundSec);if(!1===d)return i.numErrorOper;var p=e.mathpack.lfix(n),m=u.fromNum(l,n,a.Rounding.RoundSec);if(!1===m)return i.numErrorOper;if(c>p)return i.numErrorOper;var f=m.dom,g=m.mon,h=m.yr;d.dom>f&&(0===(g-=1)&&(g=12,h-=1),f+=u.daysPerMonth(g,h,l.dateCompatibility)),d.mon>g&&(g+=12,h-=1);var v=function(e,t){return 0===l.localeInfo.stringCompareCI(e,t)};if(v(o,"Y"))return s.fromNumber(h-d.yr);if(v(o,"M"))return s.fromNumber(12*(h-d.yr)+(g-d.mon));if(v(o,"D"))return s.fromNumber(p-c);if(v(o,"MD"))return s.fromNumber(f-d.dom);if(v(o,"YM"))return s.fromNumber(g-d.mon);if(v(o,"YD")){for(var S=0,y=d.mon;y<g;y+=1)S+=u.daysPerMonth(y,d.yr,l.dateCompatibility);return s.fromNumber(S+(f-d.dom))}return i.numErrorOper},t.days=function(e,t){var r=t[0],n=t[1];if((0,s.isStringOper)(r)&&r.value.length>255||(0,s.isStringOper)(n)&&n.value.length>255)return i.valueErrorOper;var a=h(e,r);if((0,s.isErrorOper)(a))return a;var o=h(e,n);return(0,s.isErrorOper)(o)?o:e.mathpack.sub(a,o)},function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(g||(g={})),t.workday_intl=C,t.workday=function(e,t){var r=t[0],n=t[1],a=t[2];return C(e,a?[r,n,i.missingOper,a]:[r,n])};var R;function b(e,t,r,i){var u=e.mathpack,l=e.datepack,c=e.config,d=n.__assign(n.__assign({},c),{date1904:!1}),p=l.fromNum(d,t,a.Rounding.RoundSec);if(!1===p)return p;var m=u.fromNumber(p.dom),f=u.fromNumber(p.mon),g=u.fromNumber(12),h=u.fromNumber(p.yr);if(u.cond(r)>=0){h=(0,o.assertNumber)(u.add(u.floor((0,o.assertNumber)(u.div(r,g))),h));var v=(0,o.assertNumber)((0,o.numMod)(u,r,g)),S=(0,o.assertNumber)(u.add(v,f));1===u.cond2(S,g)&&(h=(0,o.assertNumber)(u.add(h,u.one))),f=(0,o.assertNumber)((0,o.numMod)(u,S,g))}else{var y=u.neg(r),F=u.floor((0,o.assertNumber)(u.div(y,g)));h=(0,o.assertNumber)(u.sub(h,F));v=(0,o.assertNumber)((0,o.numMod)(u,y,g));if(u.cond2(v,f)>=0)h=(0,o.assertNumber)(u.sub(h,u.one)),f=(0,o.assertNumber)(u.add((0,o.assertNumber)(u.sub(f,v)),g));else{var C=(0,o.assertNumber)(u.sub(f,v));f=(0,o.assertNumber)((0,o.numMod)(u,C,g))}}0===u.cond(f)&&(f=g);var R=u.lfix(f);switch(R){case 4:case 6:case 9:case 11:var b=u.fromNumber(30);u.cond2(m,b)>0&&(m=b);break;case 2:u.cond2(m,u.fromNumber(28))>0&&(m=u.fromNumber(l.daysPerMonth(2,u.toNumber(h),!1)))}if(i&&(m=u.fromNumber(l.daysPerMonth(R,u.toNumber(h),!1))),u.lfix(h)<(d.dateCompatibility?1900:-9999))return!1;var E=function(e,t,r,n,i,o){var s=e.lfix(n),u=e.lfix(i),l=e.lfix(o);return t.toNum(r,(0,a.dateTime)(l,u,s,0,0,0,0,0,a.Rounding.RoundSec))}(u,l,d,m,f,h);return!(0,s.isErrorOper)(E)&&E}function E(e,t,r){var n=r[0],a=r[1],u=(0,o.chkDateOper)(t,n);if((0,s.isErrorOper)(u))return u;var l=(0,o.chkNumOper)(t,a);if((0,s.isErrorOper)(l))return l;var c=t.mathpack,d=t.config,p=b(t,u,l=c.cond(l)>0?c.floor(l):c.ceil(l),!e);return!1===p?i.numErrorOper:v(c,p,d.date1904)}function P(e,t){var r,n=t[0],a=t[1],u=t[2],c=t[3],d=e.mathpack,p=g.Saturday|g.Sunday,m=5;function f(e){m=7;for(var t=p=e;0!==t;)1==(1&t)&&(m-=1),t>>=1}if(void 0!==u&&!(0,s.isMissingOper)(u))if((0,s.isStringOper)(u)){var h=F(u.value);if(!1===h)return i.valueErrorOper;f(h)}else{var v=(0,o.chkNumOper)(e,u);if((0,s.isErrorOper)(v))return i.valueErrorOper;var C=y(d.lfix(v));if(!1===C)return i.numErrorOper;f(C)}var R=null!=c?c:i.missingOper,b=(0,o.chkDateOper)(e,n);if((0,s.isErrorOper)(b))return b;var E=(0,o.chkDateOper)(e,a);if((0,s.isErrorOper)(E))return E;var P,k=d.lfix(b),T=d.lfix(E);k>T?(P=k,k=T,T=P,r=-1):r=1,P=k%7,P=T%7;for(var A=0,N=k<T?k:T,_=k<T?T:k;N%7!=0&&N!==_;)S(p,N)||(A+=1),N+=1;for(;_%7!=6&&N!==_;)S(p,_)||(A+=1),_-=1;if(_===N&&1!=(p>>N%7&1)&&(A+=1),k>T){var I=N;N=_,_=I}var O=d.fromNumber(m*Math.floor((_+1-N)/7)+A);switch(R.kind){case l.OperKind.Number:case l.OperKind.String:var M=(0,o.chkDateOper)(e,R);if((0,s.isErrorOper)(M))return M;(P=d.lfix(M))>=k&&P<=T&&P%7>=2&&(O=(0,o.assertNumber)(d.sub(O,d.one)));break;case l.OperKind.Range:case l.OperKind.Array:var D=function(e,t,r,n,a,u){var c,d=e.mathpack;if(void 0===u||(0,s.isMissingOper)(u))c=g.Saturday|g.Sunday;else if((0,s.isStringOper)(u)){var p=F(u.value);if(!1===p)return i.valueErrorOper;c=p}else{var m=(0,o.chkNumOper)(e,u);if((0,s.isErrorOper)(m))return i.valueErrorOper;var f=y(d.lfix(m));if(!1===f)return i.numErrorOper;c=f}var h=d.fromNumber(r),v=d.fromNumber(n),C=e.dereferenceOper(a,l.OperKind.Array);if(!(0,s.isArrayOper)(C))return i.valueErrorOper;var R=[];function b(e){if(d.cond2(e,h)>=0&&d.cond2(e,v)<=0){var t=d.lfix(e);S(c,t)||R.push(e)}}for(var E=0;E<C.rows;E+=1)for(var P=0;P<C.cols;P+=1){var k=C.opers[E][P];switch(k.kind){case l.OperKind.Number:case l.OperKind.String:var T=(0,o.chkDateOper)(e,k);if((0,s.isErrorOper)(T))return T;b(T);break;case l.OperKind.Blank:break;case l.OperKind.Error:return k;default:return i.valueErrorOper}}var A=t;if(0!==R.length){var N=R.sort((function(e,t){return d.cond2(e,t)})),_=N[0];A=(0,o.assertNumber)(d.sub(A,d.one));for(E=0;E<N.length;E+=1){var I=N[E];0!==d.cond2(I,_)&&(_=I,A=(0,o.assertNumber)(d.sub(A,d.one)))}}return A}(e,O,k,T,R,u);if((0,s.isErrorOper)(D))return D;O=D;break;case l.OperKind.Error:return R;case l.OperKind.Missing:break;default:return i.valueErrorOper}return d.mul(d.fromNumber(r),O)}function k(e,t,r,n,i,a,o){var s=360*(r-t),u=30*(i-n);return e.mathpack.fromNumber(o-a+u+s)}function T(e,t,r,n){var i=e.datepack,a=e.config;return t===i.daysPerMonth(r,n,a.dateCompatibility)}function A(e,t,r,n,i){var s=e.mathpack;switch(s.cond2(t,r)){case 1:break;case 0:return s.zero;case-1:switch(n){case R.Basis30360:return function(e,t,r,n,i){var o=e.datepack,s=e.config,u=o.fromNum(s,t,a.Rounding.RoundSec);if(!1===u)return!1;var l=u.dom,c=u.mon,d=u.yr,p=o.fromNum(s,r,a.Rounding.RoundSec);if(!1===p)return!1;var m=p.dom,f=p.mon,g=p.yr;return 2===m&&T(e,m,f,g)&&(2===l&&T(e,l,c,d)||3===n)&&(m=30),31===m&&(l>=30||3===n)&&(m=30),31===l&&(l=30),i&&2===c&&T(e,l,c,d)&&(l=30),k(e,d,g,c,f,l,m)}(e,t,r,i,!0);case R.BasisActual360:case R.BasisActual365:case R.BasisActual:return(0,o.assertNumber)(s.sub(r,t));case R.BasisE30360:return function(e,t,r){var n=e.datepack,i=e.config,o=n.fromNum(i,t,a.Rounding.RoundSec);if(!1===o)return!1;var s=o.dom,u=o.mon,l=o.yr,c=n.fromNum(i,r,a.Rounding.RoundSec);if(!1===c)return!1;var d=c.dom,p=c.mon;return 31===s&&(s=30),31===d&&(d=30),k(e,l,c.yr,u,p,s,d)}(e,t,r)}}return!1}t.edate=E.bind(void 0,!0),t.eomonth=E.bind(void 0,!1),t.networkdays_intl=P,t.networkdays=function(e,t){var r=t[0],n=t[1],a=t[2];return P(e,a?[r,n,i.missingOper,a]:[r,n])},function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(R||(R={})),t.yearFrac=function(e,t){var r=t[0],n=t[1],u=t[2],l=R.DefaultBasis;if(void 0!==u){var c=function(e,t){var r=R.DefaultBasis;if(void 0===t||(0,s.isMissingOper)(t))return r;var n=(0,o.chkNumOper)(e,t);if((0,s.isErrorOper)(n))return n;var a=e.mathpack;switch(r=a.lfix(a.floor(n))){case R.Basis30360:case R.BasisActual:case R.BasisActual360:case R.BasisActual365:case R.BasisE30360:return r;default:return i.numErrorOper}}(e,u);if("number"!=typeof c)return c;l=c}var d=(0,o.chkDateOper)(e,r);if((0,s.isErrorOper)(d))return d;var p=(0,o.chkDateOper)(e,n);if((0,s.isErrorOper)(p))return p;var m=e.mathpack;if(m.cond2(d,p)>0){var f=d;d=p,p=f}var g=A(e,d,p,l,0);if(!1===g)return i.numErrorOper;var h=function(e,t,r,n){var i=e.mathpack,u=e.datepack,l=e.config,c=i.fromNumber(360),d=i.fromNumber(365),p=i.fromNumber(366);switch(t){case R.BasisActual:var m=u.fromNum(l,r,a.Rounding.RoundSec);if(!1===m)return!1;var f=m.dom,g=m.mon,h=m.yr,v=u.fromNum(l,n,a.Rounding.RoundSec);if(!1===v)return!1;var S=v.dom,y=v.mon,F=v.yr,C=F-1;if(h===F)return 29===u.daysPerMonth(2,h,l.dateCompatibility)?p:d;if(C===h&&(g>y||g===y&&f>=S)){if(29===u.daysPerMonth(2,h,l.dateCompatibility)){var b=u.toNum(l,(0,a.dateTime)(h,2,29,0,0,0,0,0,a.Rounding.RoundSec));return!(0,s.isErrorOper)(b)&&(i.cond2(b,r)>=0?p:d)}if(29===u.daysPerMonth(2,F,l.dateCompatibility)){b=u.toNum(l,(0,a.dateTime)(h,2,29,0,0,0,0,0,a.Rounding.RoundSec));return!(0,s.isErrorOper)(b)&&(i.cond2(b,n)<=0?p:d)}return d}for(var E=0,P=h;P<=F;P+=1)29===u.daysPerMonth(2,P,l.dateCompatibility)?E+=366:E+=365;var k=i.fromNumber(F-h+1);return(0,o.assertNumber)(i.div(i.fromNumber(E),k));case R.Basis30360:case R.BasisActual360:case R.BasisE30360:return c;case R.BasisActual365:return d;default:return c}}(e,l,d,p);return!1===h?i.numErrorOper:m.div(g,h)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;var n=r(3);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gestep=t.delta=void 0;var n=r(46),i=r(7);function a(e,t){var r=t[0],a=t[1],o=void 0===a||(0,i.isMissingOper)(a)?e.mathpack.zero:(0,n.chkNumOper)(e,a);if((0,i.isErrorOper)(o))return o;var s=(0,n.chkNumOper)(e,r);return(0,i.isErrorOper)(s)?s:[s,o]}t.delta=function(e,t){var r=a(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],o=e.mathpack;return 0===o.cond2(n,i)?o.one:o.zero},t.gestep=function(e,t){var r=a(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],o=e.mathpack;return o.cond2(n,i)>=0?o.one:o.zero}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.error_type=t.type=t.n_=t.t_=t.na=void 0;var n=r(8),i=r(28),a=r(7),o=r(10),s=r(18),u=r(27),l=r(16);function c(e,t){if((0,a.isRangeOper)(t)){if((0,a.isSheetIndex)(t.sheets)){var r=(0,n.rangeSeqOper)(t.sheets,[(0,a.gridRangeAnchor)(t.ranges[0])]);return e.dereferenceOper(r,i.readOperType)}return n.valueErrorOper}return t}t.na=function(e,t){return n.naErrorOper},t.t_=function(e,t){var r=c(e,t[0]);return(0,a.isStringOper)(r)||(0,a.isErrorOper)(r)?r:u.emptyStringOper},t.n_=function(e,t){var r=c(e,t[0]);if((0,a.isNumberOper)(r)||(0,a.isErrorOper)(r))return r;var n=e.mathpack;return(0,a.isBooleanOper)(r)&&r.value?n.one:n.zero},t.type=function(e,t){var r=t[0],n=e.mathpack;switch(r.kind){case s.OperKind.Number:return n.fromNumber(1);case s.OperKind.String:return n.fromNumber(2);case s.OperKind.Boolean:return n.fromNumber(4);case s.OperKind.Error:return n.fromNumber(16);case s.OperKind.Array:return n.fromNumber(64);case s.OperKind.Rich:return n.fromNumber(128);default:return(0,o.assertNever)("calc.funcs.type",r)}},t.error_type=function(e,t){var r=t[0];return(0,a.isErrorOper)(r)?(r.type>n.ErrorType.CALC&&(0,l.throwEvaluationError)((0,a.notImplemented)(["ERROR.TYPE for "+String(r.type)])),e.mathpack.fromNumber(r.type)):n.naErrorOper},t.info=function(e,t){return n.valueErrorOper}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scan=t.reduce=t.bycol=t.byrow=t.map=t.makearray=t.apply=void 0;var n=r(8),i=r(76),a=r(28),o=r(28),s=r(16),u=r(7),l=r(34),c=r(46),d=r(18),p=r(25),m=r(10),f=r(26),g=r(118);function h(e,t,r){var a=function(e,t){return(0,u.isRangeOper)(t)&&(0,u.isSheetIndex)(t.sheets)&&1===t.ranges.length&&(0,u.isGridCell)(t.ranges[0])?e.dereferenceOper(t,d.SignatureType.All&~d.OperKind.Range):t}(e,t);return a instanceof i.LambdaOper&&a.checkArity(r)?a:n.valueErrorOper}function v(e,t){return function(r){var i=r;if((0,u.isRangeOper)(i)){if(!(0,u.isSheetIndex)(i.sheets)||1!==i.ranges.length||!(0,u.isGridCell)(i.ranges[0]))return(0,a.earlyReturn)((0,f.success)(n.calcErrorOper));i=t.dereferenceOper(i,d.SignatureType.All&~d.OperKind.Range),(0,m.assertTrue)("calc.funcs.coerceLambdaRvToArrayElt",!(0,u.isRangeOper)(i))}return(0,u.isArrayOper)(i)?1!==i.rows||1!==i.cols?(0,a.earlyReturn)((0,f.success)(n.calcErrorOper)):i.opers[0][0]:((0,u.isMissingOper)(i)&&(0,s.throwEvaluationError)((0,u.notImplemented)(["".concat((0,g.englishWorksheetFuncIdToName)(e),": MissingOper in result")])),i)}}function S(e,t,r,i,a){var s=h(e,i,r.length);if((0,u.isErrorOper)(s))return s;for(var l=[],d=0,m=r;d<m.length;d++){var f=m[d];if(!(0,u.isArrayOper)(f)&&!(0,u.isRangeOper)(f))return n.valueErrorOper;var g=(0,c.rangeOrArrayToVal)(f,n.valueErrorOper);if((0,u.isErrorOper)(g))return g;l.push(a((0,c.makeSlicer)(g)))}var S=l.map((function(e){return e.rows})).reduce(p.fastMin),y=l.map((function(e){return e.rows})).reduce(p.fastMax),F=l.map((function(e){return e.cols})).reduce(p.fastMin),C=l.map((function(e){return e.cols})).reduce(p.fastMax);return(0,c.validateArraySize)(y,C),(0,o.machineCall)(new o.ArrayMachine(e,y,C,(function(t,r){return t>=S||r>=F?n.naErrorOper:e.applyLambda(s,l.map((function(e){return e.slice(t,1,r,1)})))}),v(t,e)))}function y(e,t,r,i,s){var d=(0,c.rangeOrArrayToVal)(i,n.valueErrorOper);if((0,u.isErrorOper)(d))return d;var p=(0,c.makeSlicer)(d),f=h(e,s,2);if((0,u.isErrorOper)(f))return f;var g,S=!(0,u.isMissingOper)(r),y=S?r:void 0,F=!0;if(t===l.WorksheetFuncId.REDUCE)g=function(e){return y=e,n.blankOper};else{var C=v(t,e);g=function(e){var t=C(e);return t.kind===a.EarlyReturnKind.EarlyReturn||(y=t),t}}var R=(0,o.machineCall)(new o.ArrayMachine(e,p.rows,p.cols,(function(t,r){var n=F;return F=!1,n&&!S?p.slice(t,1,r,1):((0,m.assertTrue)("calc.funcs.scanReduce",void 0!==y),e.applyLambda(f,[y,p.slice(t,1,r,1)]))}),g));return t===l.WorksheetFuncId.REDUCE?(0,o.machineCall)(new o.ThenMachine(e,(function(){return R}),(function(){return(0,m.assertTrue)("calc.funcs.scanReduce",void 0!==y),y}))):R}t.apply=function(e,t){var r=t[0],n=t.slice(1),i=h(e,r,n.length);return(0,u.isErrorOper)(i)?i:e.applyLambda(i,n)},t.makearray=function(e,t){var r=t[0],i=t[1],a=t[2],s=h(e,a,2);if((0,u.isErrorOper)(s))return s;var d=e.mathpack,p=(0,u.isMissingOper)(r)?1:d.fix(r),m=(0,u.isMissingOper)(i)?1:d.fix(i);return p<1||m<1?n.valueErrorOper:((0,c.validateArraySize)(p,m),(0,o.machineCall)(new o.ArrayMachine(e,p,m,(function(t,r){var n=e.mathpack,i=[n.fromNumber(t+1),n.fromNumber(r+1)];return e.applyLambda(s,i)}),v(l.WorksheetFuncId.MAKEARRAY,e))))},t.map=function(e,t){var r=t.slice(0,t.length-1),n=t[t.length-1];return S(e,l.WorksheetFuncId.MAP,r,n,p.identity)},t.byrow=function(e,t){var r=[t[0]],i=t[1];return void 0===i?n.naErrorOper:S(e,l.WorksheetFuncId.BYROW,r,i,(function(e){return{rows:e.rows,cols:1,slice:function(t,r,n,i){return e.slice(t,r,0,e.cols)}}}))},t.bycol=function(e,t){var r=[t[0]],i=t[1];return void 0===i?n.naErrorOper:S(e,l.WorksheetFuncId.BYCOL,r,i,(function(e){return{rows:1,cols:e.cols,slice:function(t,r,n,i){return e.slice(0,e.rows,n,i)}}}))},t.reduce=function(e,t){var r=t[0],n=t[1],i=t[2];return y(e,l.WorksheetFuncId.REDUCE,r,n,i)},t.scan=function(e,t){var r=t[0],n=t[1],i=t[2];return y(e,l.WorksheetFuncId.SCAN,r,n,i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.not=t.false_=t.true_=t.switch_=t.ifs=t.choose=t.if_=void 0;var n=r(8),i=r(10),a=r(27),o=r(34),s=r(7),u=r(16),l=r(18),c=(0,a.makeStrict)((0,o.getWorksheetFuncType)(o.WorksheetFuncId.IFS)),d=(0,a.makeStrict)((0,o.getWorksheetFuncType)(o.WorksheetFuncId.SWITCH));function p(e,t,r,n){var i=n.slice();return e.dereferenceOpers(i,t),(0,a.arrayLift)(e,t,(function(n){for(var i=[],a=0;a<n.length;a+=1){var o=(0,s.getArgType)(t,a,n.length);i[a]=e.coerceOper(n[a],o)}return r(e,i)}),i)}t.if_=function(e,t){var r=t[0];(0,i.assertTrue)("calc.funcs.if: condition is not a boolean",(0,s.isBooleanOper)(r));var n=t[r.value?1:2];return(0,i.assertTrue)("calc.funcs.if: result is undefined",void 0!==n),n},t.choose=function(e,t){var r=t[0];(0,i.assertTrue)("calc.funcs.choose",(0,s.isNumberOper)(r));var a=e.mathpack.fix(r);return a<1||a>t.length-1?n.valueErrorOper:t[a]},t.ifs=function e(t,r){for(var a=0;a<r.length;a+=2){var o=r[a];if((0,s.isArrayOper)(o)){var u=r.slice(a);return p(t,c,e,u)}if((0,s.isErrorOper)(o))return o;if((0,i.assertTrue)("calc.funcs.ifs",(0,s.isBooleanOper)(o)),o.value)return r[a+1]}return n.naErrorOper},t.switch_=function e(t,r){var a=r[0];if((0,s.isArrayOper)(a))return p(t,d,e,r);if((0,s.isErrorOper)(a))return a;for(var o=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(t.kind){case l.OperKind.Number:return function(e){return(0,s.isRichOper)(e)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isNumberOper)(e)&&0===r.compare(t,e)};case l.OperKind.String:return function(e){return(0,s.isRichOper)(e)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isStringOper)(e)&&0===n.stringCompareCI(t.value,e.value)};case l.OperKind.Boolean:return function(e){return(0,s.isRichOper)(e)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isBooleanOper)(e)&&t.value===e.value};case l.OperKind.Rich:return(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,i.assertNever)("calc.funcs.makeSwitchComparer",t)}}(t.config,a),c=1;c<r.length-1;c+=2){var m=l.OperKind.Error|l.OperKind.Rich|l.OperKind.Number|l.OperKind.Boolean|l.OperKind.String|l.OperKind.Array,f=t.coerceOper(t.dereferenceOper(r[c],m),m);if((0,s.isArrayOper)(f))return p(t,d,e,r);if((0,s.isErrorOper)(f))return f;if(o(f))return r[c+1]}return r.length%2==0?r[r.length-1]:n.naErrorOper},t.true_=function(e,t){return n.trueOper},t.false_=function(e,t){return n.falseOper},t.not=function(e,t){var r=t[0];return(0,n.booleanOper)(!r.value)}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.sortOpers=void 0;var i=r(25),a=r(18),o=r(7),s=r(16),u=function(e){return e<0?-1:e>0?1:0},l=((n={})[a.OperKind.Number]=1,n[a.OperKind.String]=2,n[a.OperKind.Boolean]=3,n[a.OperKind.Array]=4,n[a.OperKind.Error]=5,n);t.sortOpers=function e(t,r,n,c,d){if((0,o.isBlankOper)(r))return(0,o.isBlankOper)(n)?0:1;if((0,o.isBlankOper)(n))return-1;if((0,o.isRichOper)(r)||(0,o.isRichOper)(n))return(0,s.throwEvaluationError)((0,o.notImplemented)(["rich value sort"]));if(r.kind!==n.kind)return u(c*(l[r.kind]-l[n.kind]));switch(r.kind){case a.OperKind.Number:return u(c*t.mathpack.cond2(r,n));case a.OperKind.String:return u(c*t.localeInfo.stringCompareCI(r.value,n.value));case a.OperKind.Boolean:return u(c*(r.value-n.value));case a.OperKind.Array:for(var p=r,m=n,f=(0,i.fastMin)(p.rows,m.rows),g=(0,i.fastMin)(p.cols,m.cols),h=0;h<f;++h){for(var v=0;v<g;++v){var S=e(t,p.opers[h][v],m.opers[h][v],c,d);if(0!==S)return S}if(p.cols!==m.cols)return u(c*(p.cols-m.cols))}return p.rows!==m.rows?u(c*(p.rows-m.rows)):0;case a.OperKind.Error:return d?u(c*(r.type-n.type)):0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuetotext=t.arraytotext=t.numbervalue=t.isWhitespace=t.timevalue=t.datevalue=t.value=t.dollar=t.fixed=t.text=void 0;var n,i=r(0),a=r(8),o=r(10),s=r(192),u=r(439),l=i.__importStar(r(189)),c=r(7),d=r(440),p=r(18),m=r(117),f=r(16),g=r(190),h=r(85),v=l.codePointSpace,S=l.codePointTab,y=l.codePointLF,F=l.codePointCR;function C(e,t,r,n){if(void 0===r||(0,c.isMissingOper)(r))return{formatValue:t,formatDecimals:null!=n?n:2};var i=e.config.mathpack;if(i.cond(r)<0){var u=(0,s.round)(e,[t,r]);return(0,o.assertTrue)("calc.funcs.fixedDollarRound",(0,c.isNumberOper)(u)||(0,c.isErrorOper)(u)),{formatValue:u,formatDecimals:0}}var l=i.sfix(r);return l<0||l>127?{formatValue:a.valueErrorOper,formatDecimals:0}:{formatValue:t,formatDecimals:l}}function R(e){for(var t=0;t<e.length&&e.charCodeAt(t)===v;)t+=1;return e.substring(t)}function b(e,t){var r;return(0,c.isStringOper)(t)?t.value.length>255?a.valueErrorOper:null!==(r=e.parseDate(R(t.value)))&&void 0!==r?r:a.valueErrorOper:a.valueErrorOper}function E(e){return e===v||e===S||e===F||e===y}function P(e,t,r){var i=void 0===r?n.Concise:e.mathpack.sfix(r);return i!==n.Concise&&i!==n.Strict?a.valueErrorOper:function e(t,r,i){var s=[],u=t.config.localeInfo;switch(r.kind){case p.OperKind.Array:for(var l=0;l<r.rows;++l)for(var d=0;d<r.cols;++d){var m=r.opers[l][d];if((0,c.isArrayOper)(m)||(0,c.isRangeOper)(m))return a.calcErrorOper}var g=i===n.Concise?u.listSeparator:u.rowSeparator,h=i===n.Concise?u.listSeparator:u.columnSeparator;i===n.Strict&&s.push(u.leftBrace);for(l=0;l<r.rows;++l){0!==l&&(s.push(g),i===n.Concise&&s.push(" "));for(d=0;d<r.cols;++d){0!==d&&(s.push(h),i===n.Concise&&s.push(" "));var v=e(t,r.opers[l][d],i);if((0,c.isErrorOper)(v))return v;s.push(v.value)}}i===n.Strict&&s.push(u.rightBrace);break;case p.OperKind.String:i===n.Strict?s.push('"'+r.value.replace(/"/g,'""')+'"'):s.push(r.value);break;case p.OperKind.Number:case p.OperKind.Boolean:var S=t.coerceOper(r,p.OperKind.String);(0,o.assertTrue)("calc.funcs.operToText",(0,c.isStringOper)(S)),s.push(S.value);break;case p.OperKind.Blank:break;case p.OperKind.Error:var y=u.errorNames[r.type];null==y&&(0,f.throwEvaluationError)((0,c.internal)("No locale data for error type ".concat(r.type))),s.push(y);break;case p.OperKind.Rich:(0,f.throwEvaluationError)((0,c.notImplemented)(["ARRAYTOTEXT/VALUETOTEXT rich argument"]));default:return(0,o.assertNever)("calc.funcs.operToText",r)}if(s.reduce((function(e,t){return e+t.length}),0)>a.cellStringLimit)return a.calcErrorOper;return(0,a.stringOper)(s.join(""))}(e,t,i)}t.text=function(e,t){var r,n=t[0],i=t[1].value,s=(0,c.isRichOper)(n)?n.getFallback():n;if((0,c.isStringOper)(s)&&s.value.length>255||i.length>255)return a.valueErrorOper;switch(s.kind){case p.OperKind.String:var u=e.coerceOper(s,p.OperKind.Number);r=(0,c.isNumberOper)(u)?u:s;break;case p.OperKind.Number:r=s;break;case p.OperKind.Boolean:u=e.coerceOper(s,p.OperKind.String);(0,o.assertTrue)("calc.funcs.text",(0,c.isStringOper)(u)),r=u;break;case p.OperKind.Error:return a.valueErrorOper}var l=e.applyFormat(e.originSheet.document,i,r,m.NumberFormatSource.CustomString);return void 0!==l?(0,a.stringOper)(l):a.valueErrorOper},t.fixed=function(e,t){var r,n,i=t[0],o=t[1],s=t[2],l=C(e,i,o,void 0),p=l.formatValue,f=l.formatDecimals;if((0,c.isErrorOper)(p))return p;n=null!==(r=null==s?void 0:s.value)&&void 0!==r&&r?0===f?u.KnownFormat.NoComFixed0:2===f?u.KnownFormat.NoComFixed:(0,d.buildNumberFormat)(e.config.localeInfo,!1,1,f):0===f?u.KnownFormat.Fixed0:2===f?u.KnownFormat.Fixed:(0,d.buildNumberFormat)(e.config.localeInfo,!0,4,f);var g=e.applyFormat(e.originSheet.document,n,p,m.NumberFormatSource.CustomBytecode);return void 0!==g?(0,a.stringOper)(g):a.valueErrorOper},t.dollar=function(e,t){var r=t[0],n=t[1],i=e.config.localeInfo,o=C(e,r,n,i.isEastAsia?i.currencyDecimals:void 0),s=o.formatValue,l=o.formatDecimals;if((0,c.isErrorOper)(s))return s;var p=0===l?u.KnownFormat.Currency:2===l?u.KnownFormat.CurrencyDec:(0,d.buildCurrencyFormat)(i,!1,l,!0,!1),f=e.applyFormat(e.originSheet.document,p,s,m.NumberFormatSource.CustomBytecode);return void 0!==f&&f.length>0&&f.charCodeAt(f.length-1)===v?(0,a.stringOper)(f.substring(0,f.length-1)):void 0!==f?(0,a.stringOper)(f):a.valueErrorOper},t.value=function(e,t){var r=t[0];switch(r.kind){case p.OperKind.Boolean:return a.valueErrorOper;case p.OperKind.Number:return r;case p.OperKind.String:return r.value.length>255?a.valueErrorOper:e.coerceOper((0,a.stringOper)(R(r.value)),p.OperKind.Number)}},t.datevalue=function(e,t){var r=b(e,t[0]);return(0,c.isErrorOper)(r)?r:e.mathpack.trunc(r)},t.timevalue=function(e,t){var r=b(e,t[0]);return(0,c.isErrorOper)(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))},t.isWhitespace=E,t.numbervalue=function(e,t){var r=t[0],n=t[1],i=t[2],s=e.mathpack,u=e.config.localeInfo;if(void 0!==n&&(!(0,c.isStringOper)(n)||""===n.value)||void 0!==i&&(!(0,c.isStringOper)(i)||""===i.value))return a.valueErrorOper;var l=function(e){return(0,g.stringFromCodePoint)((0,g.stringCodePointAt)(e,0))},d=u.decimalSeparator,m=n?l(n.value):d,f=i?l(i.value):u.thousandsSeparator;if(m===f){if(void 0!==i)return a.valueErrorOper;f=d}var v=r.value;if(""===v)return s.zero;for(var S=!1,y=0,F=[],C=0,R=function(e){return F.push(e),C+=e.length};y<v.length&&C<255;)if(E(v.charCodeAt(y)))y+=1;else if(S||!(0,h.stringStartsWith)(v,f,y))if((0,h.stringStartsWith)(v,m,y))S=!0,R(d),y+=m.length;else{var b=(0,g.stringCodePointAt)(v,y);R((0,g.stringFromCodePoint)(b)),y+=(0,g.numCodeUnits)(b)}else y+=f.length;if(y!==v.length)return a.valueErrorOper;for(var P=0;F.length>0&&"%"===F[F.length-1];)C-=F.pop().length,++P;if(0===F.length)return s.zero;var k=e.coerceOper((0,a.stringOper)(F.join("")),p.OperKind.Number);if(!(0,c.isNumberOper)(k))return a.valueErrorOper;for(var T=k;P>0;)T=s.div(T,s.fromNumber(100)),(0,o.assertTrue)("calc.funcs.numberValue",(0,c.isNumberOper)(T)),--P;return T},function(e){e[e.Concise=0]="Concise",e[e.Strict=1]="Strict"}(n||(n={})),t.arraytotext=function(e,t){return P(e,t[0],t[1])},t.valuetotext=function(e,t){return P(e,t[0],t[1])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulatext=t.isformula=t.isodd=t.iseven=t.isomitted=t.islambda=t.isref=t.isnumber=t.istext=t.isnontext=t.isna=t.islogical=t.isblank=t.iserr=t.iserror=void 0;var n=r(8),i=r(7),a=r(19),o=r(45),s=r(76),u=r(46);function l(e,t){var r=t[0],a=(0,u.chkNumOper)(e,r);if((0,i.isErrorOper)(a))return a;var o=e.mathpack,s=(0,u.assertNumber)(o.add(o.abs(a),o.fromNumber(1.0000000000000003e-10))),l=(0,u.assertNumber)(o.div(o.floor(s),o.fromNumber(2)));return(0,n.booleanOper)(0===o.cond2(l,o.floor(l)))}function c(e,t,r){if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;var s=t.ranges[0];if(e.calcingArray||!(0,i.isGridCell)(s)){var u=t.sheets;return(0,n.arrayOper)(s.rows,s.cols,(0,o.jaggedArray)(s.rows,s.cols,(function(t,n){var i=(0,a.sheetGridCell)(u,(0,a.gridCell)(s.row+t,s.col+n));return r(e.getCellFormula(i),i)})))}var l=(0,i.sheetGridRangeAnchor)((0,a.sheetGridRange)(t.sheets,s));return r(e.getCellFormula(l),l)}t.iserror=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r))},t.iserr=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r)&&r.type!==n.ErrorType.NA)},t.isblank=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isBlankOper)(r))},t.islogical=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isBooleanOper)(r))},t.isna=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r)&&r.type===n.ErrorType.NA)},t.isnontext=function(e,t){var r=t[0];return(0,n.booleanOper)(!(0,i.isStringOper)(r))},t.istext=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isStringOper)(r))},t.isnumber=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isNumberOper)(r))},t.isref=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isRangeOper)(r))},t.islambda=function(e,t){var r=t[0];return(0,n.booleanOper)(r instanceof s.LambdaOper)},t.isomitted=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isMissingOper)(r))},t.iseven=l,t.isodd=function(e,t){var r=l(e,t);return(0,i.isBooleanOper)(r)?(0,n.booleanOper)(!r.value):r},t.isformula=function(e,t){return c(e,t[0],(function(e){return(0,n.booleanOper)(void 0!==e)}))},t.formulatext=function(e,t){var r=t[0];return c(e,r,(function(t,r){if(void 0===t)return n.naErrorOper;var i=e.printFormula(t,r.range);return t.source.kind===a.LexicalKind.Cell?(0,n.stringOper)(i):(0,n.stringOper)("{"+i+"}")}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=t.transpose=t.offset=t.sheet=t.sheets=t.column=t.row=t.columns=t.rows=t.areas=void 0;var n=r(8),i=r(7),a=r(19),o=r(25),s=r(10),u=r(45);function l(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;if(t.ranges.length>1)return n.refErrorOper;var r=t.ranges[0];return[r,(0,i.isGridCell)(r)]}t.areas=function(e,t){var r=t[0];return(0,i.isSheetIndex)(r.sheets)?e.mathpack.fromNumber(r.ranges.length):n.valueErrorOper},t.rows=function(e,t){var r=t[0],a=e.mathpack;return(0,i.isArrayOper)(r)?a.fromNumber(r.rows):(0,i.isSheetIndex)(r.sheets)?r.ranges.length>1?n.refErrorOper:a.fromNumber(r.ranges[0].rows):n.valueErrorOper},t.columns=function(e,t){var r=t[0],a=e.mathpack;return(0,i.isArrayOper)(r)?a.fromNumber(r.cols):(0,i.isSheetIndex)(r.sheets)?r.ranges.length>1?n.refErrorOper:a.fromNumber(r.ranges[0].cols):n.valueErrorOper},t.row=function(e,t){var r=l(e,t[0]);if(!Array.isArray(r))return r;var i=r[0],a=r[1],o=e.mathpack;return a?o.fromNumber(i.row+1):(0,n.arrayOper)(i.rows,1,(0,u.jaggedArray)(i.rows,1,(function(e){return o.fromNumber(i.row+e+1)})))},t.column=function(e,t){var r=l(e,t[0]);if(!Array.isArray(r))return r;var i=r[0],a=r[1],o=e.mathpack;return a?o.fromNumber(i.col+1):(0,n.arrayOper)(1,i.cols,(0,u.jaggedArray)(1,i.cols,(function(e,t){return o.fromNumber(i.col+t+1)})))},t.sheets=function(e,t){var r=t[0],o=e.mathpack;return r?(0,i.isArrayOper)(r)?n.naErrorOper:o.fromNumber(e.getSheetRangeIndexes(r.sheets).length):o.fromNumber(e.getSheetRangeIndexes((0,a.allSheetsRange)(e.reflectionSheet.document)).length)},t.sheet=function(e,t){var r=t[0],a=e.mathpack;if(!r){var o=e.reflectionSheet;return void 0===o.index?n.naErrorOper:a.fromNumber(e.getSheetRangePosition(o)+1)}if((0,i.isStringOper)(r)){var u=e.getSheetIndex(e.reflectionSheet.document,r.value);return void 0===u?n.naErrorOper:a.fromNumber(e.getSheetRangePosition(u)+1)}return(0,i.isRangeOper)(r)?a.fromNumber(e.getSheetRangePosition(r.sheets)+1):(0,i.isArrayOper)(r)?n.naErrorOper:(0,s.assertNever)("calc.funcs.sheet",r)},t.offset=function(e,t){var r=t[0],s=t[1],u=t[2],l=t[3],c=t[4];if(!(0,i.isSheetIndex)(r.sheets))return n.valueErrorOper;if(1!==r.ranges.length)return n.valueErrorOper;var d=e.mathpack,p=r.ranges[0],m=p.row,f=p.col,g=p.rows,h=p.cols,v=m;(0,i.isNumberOper)(s)&&(v+=d.lfix(s));var S=f;(0,i.isNumberOper)(u)&&(S+=d.lfix(u));var y=v+g-1;if(void 0!==l&&(0,i.isNumberOper)(l)){if(0===(C=d.cond(l)))return n.refErrorOper;y=v+d.lfix(l)-(C>0?1:-1)}var F=S+h-1;if(void 0!==c&&(0,i.isNumberOper)(c)){var C;if(0===(C=d.cond(c)))return n.refErrorOper;F=S+d.lfix(c)-(C>0?1:-1)}var R=(0,o.fastMin)(v,y),b=(0,o.fastMin)(S,F),E=(0,o.fastMax)(v,y)-R+1,P=(0,o.fastMax)(S,F)-b+1;return R<0||b<0||R+E>a.sheetRows||b+P>a.sheetCols?n.refErrorOper:(0,n.rangeSeqOper)(r.sheets,[(0,a.gridRange)(R,b,E,P)])},t.transpose=function(e,t){var r=t[0];return(0,i.isArrayOper)(r)?(0,n.arrayOper)(r.cols,r.rows,(0,u.jaggedArray)(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r},t.single=function(e,t){var r=t[0];if((0,i.isPrimitiveOper)(r)||(0,i.isMissingOper)(r)||(0,i.isBlankOper)(r)||(0,i.isRichOper)(r))return r;if((0,i.isArrayOper)(r))return r.opers[0][0];if(!(0,i.isSheetIndex)(r.sheets))return n.refErrorOper;if(1!==r.ranges.length)return n.valueErrorOper;var a=e.originGridCell,o=(0,i.gridCellImplicitIsect)(a,r.ranges[0]);return void 0===o?n.valueErrorOper:(0,n.rangeSeqOper)(r.sheets,[o])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.record=t.fieldvalue=void 0;var n=r(8),i=r(7),a=r(116),o=r(76);t.fieldvalue=function(e,t){var r=t[0],a=t[1].value;if((0,i.isRichOper)(r)){var o=r.getField(a);if(void 0!==o)return o}return n.fieldErrorOper},t.record=function(e,t){for(var r=t[0],n=e.config.localeInfo,i=a.RedBlackMapTree.create(n.stringCompareCI),s=1;s<t.length;s+=2){var u=t[s].value,l=t[s+1];i=i.setValue(u,l)}return new o.RecordOper(i,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wraprows=t.wrapcols=t.torow=t.tocol=t.chooserows=t.choosecols=t.vstack=t.hstack=t.expand=t.drop=t.take=t.sequence=t.indirect=t.address=void 0;var n=r(8),i=r(8),a=r(19),o=r(119),s=r(441),u=r(7),l=r(34),c=r(34),d=r(10),p=r(85),m=r(26),f=r(18),g=r(16),h=r(25),v=r(45),S=r(84),y=r(46);t.address=function(e,t){var r=t[0],n=t[1],l=t[2],c=t[3],p=t[4],m=e.mathpack,g=(null==l?void 0:l.kind)===f.OperKind.Number?m.sfix(l)-1:0;if(g<0||g>3)return i.valueErrorOper;var h=0!=(1&g),v=0!=(2&g),S=(null==c?void 0:c.kind)!==f.OperKind.Boolean||c.value?o.RefStyle.A1:o.RefStyle.R1C1,y=function(e,t,r){return S===o.RefStyle.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},F=m.sfix(r);if(!y(v,a.sheetRows,F))return i.valueErrorOper;if(!(0,u.isNumberOper)(n))return i.valueErrorOper;var C=m.sfix(n);if(!y(h,a.sheetCols,C))return i.valueErrorOper;var R=(0,a.gridCell)(F<0?a.sheetRows-1:0,C<0?a.sheetCols-1:0),b=(0,o.pos)(v?o.PosKind.Rel:o.PosKind.Abs,S===o.RefStyle.R1C1&&v?F:F-1),E=(0,o.pos)(h?o.PosKind.Rel:o.PosKind.Abs,S===o.RefStyle.R1C1&&h?C:C-1),P=(0,s.formatCellPos)(e.config.localeInfo,S,R,b,E,!1);return(0,d.assertTrue)("calc.funcs.address: cell wrapped",void 0!==P),(null==p?void 0:p.kind)===f.OperKind.String?""===p.value?(0,i.stringOper)("!"+P):p.value.length>255?i.valueErrorOper:(0,i.stringOper)((0,s.formatQualifier)(e.config.localeInfo,e.config.refStyle,p.value)+"!"+P):(0,i.stringOper)(P)},t.indirect=function(e,t){var r,n=t[0].value,s=t[1],l=null===(r=null==s?void 0:s.value)||void 0===r||r?o.RefStyle.A1:o.RefStyle.R1C1;if(n.length>255||(0,p.stringStartsWith)(n," "))return i.valueErrorOper;var d=(0,a.originCell)(e.originSheet,e.originGridCell),f={lexicalKind:a.LexicalKind.Indirect,originGridCell:(0,m.success)(d.range),originSheet:(0,m.success)(d.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},h=e.parseFormula(l,d.range,f,"="+n);if(!(0,m.isSuccess)(h))return i.refErrorOper;for(var v=h.value.node,S=!1,y=!1;;){var F;if(!S&&v.kind===o.NodeKind.App&&(0,u.isOperatorNode)(v.head)&&v.head.id===c.OperatorId.Pound&&1===v.args.length&&(S=!0,v=v.args[0]),y||v.kind!==o.NodeKind.Name)return v.kind===o.NodeKind.CellRef?void 0===(F=e.getCellRef(v.qualifier,v.ref,d,!0))?i.refErrorOper:(0,u.isSheetIndex)(F.sheets)?S?(0,g.throwEvaluationError)((0,u.notImplemented)(["# operator in INDIRECT"])):F:i.refErrorOper:v.kind===o.NodeKind.StructRef?void 0===v.lhs||void 0===(F=e.getStructRef(v.lhs,v.rhs,d))||S?i.refErrorOper:F:i.refErrorOper;var C=e.getNameFormula(v.qualifier,v.whole,a.NameSource.Indirect);if(void 0===C)return i.refErrorOper;d=(0,a.originCell)(d.sheet,(0,a.gridCell)(0,0)),v=C[1],y=!0}};function F(e,t){if((0,h.fastAbs)(e)<t){var r=(0,h.fastAbs)(e);return e<0?{start:t-r,count:r}:{start:0,count:r}}return{start:0,count:t}}function C(e,t){if((0,h.fastAbs)(e)<t){var r=t-(0,h.fastAbs)(e);return e<0?{start:0,count:r}:{start:e,count:r}}return{start:0,count:0}}t.sequence=function(e,t){var r=t[0],n=t[1],o=t[2],s=t[3],l=e.mathpack,c=(0,u.isMissingOper)(r)?1:l.sfix(r),d=void 0===n||(0,u.isMissingOper)(n)?1:l.sfix(n);if(c<0||c>a.sheetRows||d<0||d>a.sheetRows)return i.valueErrorOper;if((0,y.validateArraySize)(c,d),0===c||0===d)return i.calcErrorOper;for(var p=void 0===o||(0,u.isMissingOper)(o)?l.fromNumber(1):o,m=void 0===s||(0,u.isMissingOper)(s)?l.fromNumber(1):s,f=p,g=[],h=0;h<c;h++){for(var v=[],S=0;S<d;S++)if(v.push(f),!(0,u.isErrorOper)(f)){var F=l.add(f,m);f=(0,u.isErrorOper)(F)?F:l.checkAlmostCancellation(m,F)}g.push(v)}return(0,i.arrayOper)(c,d,g)};t.take=function(e,t){var r=t[0],n=t[1],a=t[2],o=e.mathpack,s=(0,y.rangeOrArrayToVal)(r,i.valueErrorOper);if(!(0,u.isArrayOper)(s)&&!(0,u.isRangeOper)(s))return s;var l=(0,y.makeSlicer)(s),c=(0,u.isMissingOper)(n)?l.rows:o.lfix(n),d=void 0===a||(0,u.isMissingOper)(a)?l.cols:o.lfix(a),p=F(c,l.rows),m=p.start,f=p.count,g=F(d,l.cols),h=g.start,v=g.count;return 0===f||0===v?i.calcErrorOper:l.slice(m,f,h,v)};t.drop=function(e,t){var r=t[0],n=t[1],a=t[2],o=e.mathpack,s=(0,y.rangeOrArrayToVal)(r,i.valueErrorOper);if(!(0,u.isArrayOper)(s)&&!(0,u.isRangeOper)(s))return s;var l=(0,y.makeSlicer)(s),c=(0,u.isMissingOper)(n)?0:o.lfix(n),d=void 0===a||(0,u.isMissingOper)(a)?0:o.lfix(a),p=C(c,l.rows),m=p.start,f=p.count,g=C(d,l.cols),h=g.start,v=g.count;return 0===f||0===v?i.calcErrorOper:l.slice(m,f,h,v)},t.expand=function(e,t){var r=t[0],o=t[1],s=t[2],l=void 0===s?n.missingOper:s,c=t[3],d=void 0===c?n.missingOper:c,p=e.mathpack,m=(0,u.isMissingOper)(o)?r.rows:p.lfix(o),f=(0,u.isMissingOper)(l)?r.cols:p.lfix(l);if(m<r.rows||f<r.cols)return i.valueErrorOper;if(0===m||0===f)return i.calcErrorOper;if(f>a.sheetRows||m>a.sheetRows)return n.numErrorOper;(0,y.validateArraySize)(m,f);var g=(0,u.isMissingOper)(d)?n.naErrorOper:d;return(0,u.isArrayOper)(g)?i.valueErrorOper:(0,i.arrayOper)(m,f,(0,v.array2DToJaggedArray)(new v.StrictSparseArray2D(m,f,r.rows,r.cols,r.opers,g)))};t.hstack=function(e,t){return b(e,t,!0)};t.vstack=function(e,t){return b(e,t,!1)};var R=function(){return n.naErrorOper};function b(e,t,r){var o=e.dereferenceAllOpers(t).map((function(e){return(0,S.isRangeValues)(e)?e.arrays:[new v.StrictArray2D(e.rows,e.cols,e.opers)]})),s=(0,h.safeConcat)([],o).map((function(e){return r?(0,v.transposeArray2D)(e):e})),u=s.reduce((function(e,t){return(0,h.fastMax)(t.cols,e)}),0),l=s.reduce((function(e,t){return e+t.rows}),0);if(u>a.sheetRows||l>a.sheetRows)return n.numErrorOper;(0,y.validateArraySize)(l,u);var c=(0,h.safeConcat)([],s.map((function(e){return function(e,t,r){return e.cols>=t?e:new v.NonstrictSparseArray2D(e.rows,t,e.rows,e.cols,e.get.bind(e),r)}(e,u,R)})).map(v.array2DToJaggedArray)),d=new v.StrictArray2D(c.length,c[0].length,c),p=r?(0,v.transposeArray2D)(d):d;return(0,i.arrayOper)(p.rows,p.cols,(0,v.array2DToJaggedArray)(p))}function E(e,t,r){var n=t.lfix(e),a=n>0?n:-n;return a>r||0===a?i.valueErrorOper:(0,y.getAbsoluteIndex)(r,n)}function P(e,t,r){if(e.rows>1&&e.cols>1)return i.valueErrorOper;for(var n=[],a=0,o=e.opers;a<o.length;a++)for(var s=0,l=o[a];s<l.length;s++){var c=l[s];if(!(0,u.isNumberOper)(c))return(0,u.isErrorOper)(c)?c:i.valueErrorOper;var d=E(c,t,r);if("number"!=typeof d)return d;n.push(d)}return n}var k=function(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var a=i[n],o=t.opers[a];r.push(o)}return r},T=function(e,t){return t.opers.map((function(t){for(var r=[],n=0,i=e;n<i.length;n++){var a=i[n];r.push(t[a])}return r}))},A=function(e,t,r,o){var s=t[0],l=t.slice(1);if((0,u.isRangeOper)(s)){if(s.ranges.length>1)return i.refErrorOper;(0,d.assertTrue)("calc.funcs.ChooseColRow: not 3D ref",(0,u.isSheetIndex)(s.sheets))}var c=e.dereferenceOper(s,f.OperKind.Array);if(!(0,u.isArrayOper)(c))return c;var p=function(e,t,r){for(var n=[],i=0,a=e;i<a.length;i++){var o=a[i];if((0,u.isArrayOper)(o)){var s=P(o,t,r);if(!Array.isArray(s))return s;(0,h.safePush)(n,s)}else{if("number"!=typeof(s=E(o,t,r)))return s;n.push(s)}}return n}(l,e.mathpack,o?c.rows:c.cols);if(!Array.isArray(p))return p;if(p.length>a.sheetRows||(o?c.cols:c.rows)>a.sheetRows)return n.numErrorOper;o?(0,y.validateArraySize)(p.length,c.cols):(0,y.validateArraySize)(c.rows,p.length);var m=r(p,c);return 0===m.length||0===m[0].length?i.calcErrorOper:(0,i.arrayOper)(m.length,m[0].length,m)};t.choosecols=function(e,t){return A(e,t,T,!1)};function N(e,t){return t?new v.NonstrictArray2D(1,e.length,(function(t,r){return e[r]})):new v.NonstrictArray2D(e.length,1,(function(t){return e[t]}))}function _(e,t,r){var o=r[0],s=r[1],c=r[2],d=e.mathpack,p=e.dereferenceAllOpers([o])[0],m=(0,S.isRangeValues)(p)?p.arrays:[new v.StrictSparseArray2D(p.rows,p.cols,p.rows,p.cols,p.opers,n.blankOper)],f=void 0===s||(0,u.isMissingOper)(s)?0:d.lfix(s),g=void 0!==c&&!(0,u.isMissingOper)(c)&&c.value;if(f<0||f>3)return i.valueErrorOper;for(var h=1===f||3===f,F=2===f||3===f,C=[],R=[],b=function(e,t){h&&(0,u.isBlankOper)(e)||F&&(0,u.isErrorOper)(e)||(C.push(e),R.push(t))},E=0,P=m;E<P.length;E++){for(var k=P[E],T=g?(0,v.transposeSparseArray2D)(k):k,A=T.rows,_=T.cols,I=T.denseRows,O=T.denseCols,M=0;M<I;++M){for(var D=0;D<O;++D)b(T.get(M,D),1);O<_&&b(T.getSparse(),_-O)}I<A&&_>0&&b(T.getSparse(),_*(A-I))}var w=R.reduce((function(e,t){return e+t}),0);if(0===w)return i.calcErrorOper;if(w>a.sheetRows)return n.numErrorOper;t===l.WorksheetFuncId.TOROW?(0,y.validateArraySize)(1,w):(0,y.validateArraySize)(w,1);var L=[];for(M=0;M<C.length;++M)for(var x=C[M],K=R[M],U=0;U<K;++U)L.push(x);var B=N(L,t===l.WorksheetFuncId.TOROW);return(0,i.arrayOper)(B.rows,B.cols,(0,v.array2DToJaggedArray)(B))}function I(e,t,r){var a=r[0],o=r[1],s=r[2],c=void 0===s?n.missingOper:s;if(!(1===a.rows&&a.cols>=1||1===a.cols&&a.rows>=1))return i.valueErrorOper;var d=e.mathpack.lfix(o);if(d<1)return n.numErrorOper;var p=1===a.rows?a.opers[0]:a.opers.map((function(e){return e[0]})),m=p.length;if(d>=m){var f=N(p,t===l.WorksheetFuncId.WRAPROWS);return(0,i.arrayOper)(f.rows,f.cols,(0,v.array2DToJaggedArray)(f))}var g=Math.floor((m+d-1)/d);t===l.WorksheetFuncId.WRAPROWS?(0,y.validateArraySize)(g,d):(0,y.validateArraySize)(d,g);var h=(0,u.isMissingOper)(c)?n.naErrorOper:c,S=function(e,t){var r=e*d+t;return r>=p.length?h:p[r]},F=t===l.WorksheetFuncId.WRAPROWS?new v.NonstrictArray2D(g,d,(function(e,t){return S(e,t)})):new v.NonstrictArray2D(d,g,(function(e,t){return S(t,e)}));return(0,i.arrayOper)(F.rows,F.cols,(0,v.array2DToJaggedArray)(F))}t.chooserows=function(e,t){return A(e,t,k,!0)},t.tocol=function(e,t){return _(e,l.WorksheetFuncId.TOCOL,t)},t.torow=function(e,t){return _(e,l.WorksheetFuncId.TOROW,t)},t.wrapcols=function(e,t){return I(e,l.WorksheetFuncId.WRAPCOLS,t)},t.wraprows=function(e,t){return I(e,l.WorksheetFuncId.WRAPROWS,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAfter=t.textBefore=t.textSplit=t.substitute=t.search=t.replace=t.find=t.proper=t.upper=t.lower=t.unicode=t.code=t.unichar=t.char=t.clean=t.trim=t.rept=t.exact=t.concatenate=t.len=t.mid=t.left=t.right=void 0;var n=r(0),i=r(7),a=r(8),o=r(16),s=r(190),u=r(138),l=n.__importStar(r(189)),c=r(85),d=r(18),p=r(27),m=r(10),f=r(25),g=r(46),h=l.codePointSpace,v=l.codePointCapitalA,S=l.codePointCapitalZ,y=l.codePointSmallA,F=l.codePointSmallZ;function C(e,t){return void 0===t?1:e.cond(t)<0?a.valueErrorOper:e.sfix(t)}function R(e){return e>=v&&e<=S||e>=y&&e<=F}function b(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():(0,o.throwEvaluationError)((0,i.notImplemented)([t+" for non-ASCII input"]))}function E(e,t,r){if(void 0===t||(0,i.isMissingOper)(t))return[];if((0,i.isStringOper)(t))return r&&0===t.value.length?a.valueErrorOper:[t.value];for(var n=[],o=0;o<t.rows;++o)for(var s=t.opers[o],u=0;u<s.length;++u){var l=s[u],c=e.coerceOper(l,d.OperKind.String);if((0,i.isErrorOper)(c))return c;var p=(0,g.assertString)(c).value;if(r&&0===p.length)return a.valueErrorOper;n.push(p)}return n.sort((function(e,t){return e.length-t.length})),n}function P(e,t,r){for(var n=0,i=r;n<i.length;n++){var a=i[n];if((0,c.stringStartsWith)(e,a,t))return a}}t.right=function(e,t){var r,n=t[0].value,o=t[1];if(void 0!==o&&(0,i.isErrorOper)(o))return o;var u=C(e.mathpack,o);if("number"!=typeof u&&(0,i.isErrorOper)(u))return a.valueErrorOper;var l=null!==(r=(0,s.scanCodePointsBack)(n,n.length,u))&&void 0!==r?r:0;return(0,a.stringOper)(n.substring(l))},t.left=function(e,t){var r,n=t[0].value,o=t[1];if(void 0!==o&&(0,i.isErrorOper)(o))return o;var u=C(e.mathpack,o);if("number"!=typeof u&&(0,i.isErrorOper)(u))return a.valueErrorOper;var l=null!==(r=(0,s.scanCodePoints)(n,0,u))&&void 0!==r?r:n.length;return(0,a.stringOper)(n.substring(0,l))},t.mid=function(e,t){var r,n,i=t[0].value,o=t[1],u=t[2],l=e.mathpack,c=l.fix(o)-1,d=l.fix(u);if(l.cond(o)<0||c<0||l.cond(u)<0||d<0)return a.valueErrorOper;var p=null!==(r=(0,s.scanCodePoints)(i,0,c))&&void 0!==r?r:i.length,m=null!==(n=(0,s.scanCodePoints)(i,p,d))&&void 0!==n?n:i.length;return(0,a.stringOper)(i.substring(p,m))},t.len=function(e,t){var r=t[0].value;return e.mathpack.fromNumber((0,s.countCodePoints)(r,0,r.length))},t.concatenate=function(e,t){for(var r="",n=0;n<t.length;n+=1){var i=t[n].value;if(r.length+i.length>a.cellStringLimit){r+=i.substring(0,a.cellStringLimit-r.length);break}r+=i}return(0,a.stringOper)(r)},t.exact=function(e,t){var r=t[0],n=t[1];return((0,i.isRichOper)(r)||(0,i.isRichOper)(n))&&(0,o.throwEvaluationError)((0,i.notImplemented)(["EXACT rich argument"])),(0,a.booleanOper)(r.value===n.value)},t.rept=function(e,t){var r=t[0].value,n=t[1],i=e.mathpack,o=i.fix(n);return i.cond(n)<0||o>2147483647?a.valueErrorOper:""===r?p.emptyStringOper:o*r.length>a.cellStringLimit?a.valueErrorOper:(0,a.stringOper)((0,c.repeat)(r,o))},t.trim=function(e,t){for(var r=t[0].value,n="",i=0;i<r.length;){for(;i<r.length&&r.charCodeAt(i)===h;)i+=1;for(var o=i;i<r.length;){var s=r.charCodeAt(i)===h;if(i+=1,s)break}n+=r.substring(o,i)}return n.length>0&&n.charCodeAt(n.length-1)===h&&(n=n.substring(0,n.length-1)),(0,a.stringOper)(n)},t.clean=function(e,t){for(var r=t[0].value,n="",i=0;i<r.length;i+=1){var o=r.charCodeAt(i);(o>=256||(127&o)>=32)&&(n+=r.charAt(i))}return(0,a.stringOper)(n)},t.char=function(e,t){var r=t[0],n=e.mathpack.sfix(r);return n<1||n>255?a.valueErrorOper:(0,a.stringOper)(String.fromCharCode(n))},t.unichar=function(e,t){var r=t[0],n=e.mathpack,i=n.lfix(n.trunc(r));return n.cond2(r,n.one)<0||i>=1114112?a.valueErrorOper:i<=65535&&(0,s.isAnySurrogate)(i)||i>=64976&&i<=65007||(65535&i)>=65534?a.naErrorOper:(0,a.stringOper)((0,s.stringFromCodePoint)(i))},t.code=function(e,t){var r=t[0].value;if(0===r.length)return a.valueErrorOper;var n=r.charCodeAt(0);return n>255?(0,o.throwEvaluationError)((0,i.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)},t.unicode=function(e,t){var r=t[0].value;if(0===r.length)return a.valueErrorOper;var n=r.charCodeAt(0),i=e.mathpack;if(!(0,s.isAnySurrogate)(n))return i.fromNumber(n);if(1===r.length)return a.valueErrorOper;var o=r.charCodeAt(1),u=(0,s.surrogatePairToCodePoint)(n,o);return void 0===u?a.valueErrorOper:i.fromNumber(u)},t.lower=function(e,t){var r=t[0].value;return(0,a.stringOper)(b(r,"LOWER",r.toLowerCase.bind(r)))},t.upper=function(e,t){var r=t[0].value;return(0,a.stringOper)(b(r,"UPPER",r.toUpperCase.bind(r)))},t.proper=function(e,t){var r=t[0].value;return(0,a.stringOper)(b(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var i=n;n<e.length&&!R(e.charCodeAt(n));)n+=1;if(t+=e.substring(i,n),n===e.length)break;var a=n,o=(0,s.stringCodePointAt)(e,n);for(t+=(0,s.stringFromCodePoint)(o).toUpperCase(),n+=(0,s.numCodeUnits)(o);n<e.length&&R(e.charCodeAt(n));)n+=1;t+=e.substring(a+1,n)}return t})))},t.find=function(e,t){var r,n=t[0].value,i=t[1].value,o=t[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return a.valueErrorOper;var l=null!==(r=(0,s.scanCodePoints)(i,0,u))&&void 0!==r?r:i.length,c=i.indexOf(n,l);return c>=0?e.mathpack.fromNumber((0,s.countCodePoints)(i,0,c)+1):a.valueErrorOper},t.replace=function(e,t){var r,n,i=t[0].value,o=t[1],u=t[2],l=t[3].value,c=e.mathpack.sfix(o)-1;if(c<0||c>=a.cellStringLimit)return a.valueErrorOper;var d=e.mathpack.sfix(u);if(d<0||d>a.cellStringLimit)return a.valueErrorOper;var p=null!==(r=(0,s.scanCodePoints)(i,0,c))&&void 0!==r?r:i.length,m=null!==(n=(0,s.scanCodePoints)(i,p,d))&&void 0!==n?n:i.length,f=i.slice(0,p),g=i.slice(m);return f.length+l.length+g.length>a.cellStringLimit?a.valueErrorOper:(0,a.stringOper)(f+l+g)},t.search=function(e,t){var r,n=t[0].value,i=t[1].value,o=t[2],l=void 0!==o?e.mathpack.sfix(o)-1:0;if(l<0||l>=2147483647)return a.valueErrorOper;for(var c=null!==(r=(0,s.scanCodePoints)(i,0,l))&&void 0!==r?r:i.length,d=new u.WildExp(e.config.localeInfo,n,!0);c<i.length;c+=1)if(d.test(i.slice(c)))return e.mathpack.fromNumber((0,s.countCodePoints)(i,0,c)+1);return a.valueErrorOper},t.substitute=function(e,t){var r=t[0],n=t[1].value,o=t[2].value,s=t[3],u=r.value,l=1/0;if(void 0!==s){var c=e.coerceOper(s,d.OperKind.Number);if((0,i.isErrorOper)(c))return c;if((l=e.mathpack.sfix(c))<1||l>2147483646)return a.valueErrorOper}var p=n.length;if(p>0){for(var m="",f=0,g=0;l>=0&&-1!==(g=u.indexOf(n,g));)if((l-=1)===1/0||0===l){var h=u.slice(f,g);if(m.length+h.length+o.length>a.cellStringLimit)return a.valueErrorOper;m+=h,m+=o,f=g+=p}else g+=1;var v=u.slice(f);return m.length+v.length>a.cellStringLimit?a.valueErrorOper:(m+=v,(0,a.stringOper)(m))}return r};var k;function T(e,t,r,n,o,s,u){var l=t.value,c=void 0===n||(0,i.isMissingOper)(n)?1:e.mathpack.sfix(n),d=E(e,r,!1);if(!Array.isArray(d))return d;var p,m,f=d.reduce((function(e,t){return t.length<e?t.length:e}),d[0].length),g=-(l.length-f+1),h=l.length-f+1;if(void 0!==n&&!(0,i.isMissingOper)(n)){if(0!==f&&!(c>=g&&c<=h))return a.valueErrorOper;if(0===c)return a.valueErrorOper}if(void 0===o||(0,i.isMissingOper)(o))p=!1;else{var v=e.mathpack.lfix(o);if(0!==v&&1!==v)return a.valueErrorOper;p=1===v}if(void 0===s||(0,i.isMissingOper)(s))m=!1;else{var S=e.mathpack.lfix(s);if(0!==S&&1!==S)return a.valueErrorOper;m=1===S}return function(e,t,r,n,i,a,o){var s=e,u=t;if(0===r)return n>0?[0,0]:[s.length,s.length];if(s.length-r<0)return o;i&&(s=s.toLowerCase(),u=u.map((function(e){return e.toLowerCase()})));var l=n,c=0,d=s.length,p=1;for(n<0&&(p=-1,c=d);c<=d&&c>=0;){var m=P(s,c,u);if(void 0!==m){if(0===(l-=p))return[c,m.length];c+=p*(m.length-1)}c+=p}return a&&n-p==0?1===p?[s.length,0]:[0,0]:o}(l,d,f,c,p,m,void 0===u||(0,i.isMissingOper)(u)?a.naErrorOper:u)}function A(e,t,r,n,i,o,s,u){var l=T(t,r,n,i,o,s,u);if(Array.isArray(l)){var c=l[0],d=l[1];return e===k.TEXTBEFORE?(0,a.stringOper)(r.value.slice(0,c)):(0,a.stringOper)(r.value.slice(c+d))}return l}t.textSplit=function(e,t){var r=t[0],n=t[1],o=t[2],s=t[3],u=t[4],l=t[5],c=r.value;if(0===c.length)return a.valueErrorOper;var d=E(e,n,!0);if(!Array.isArray(d))return d;var p=E(e,o,!0);if(!Array.isArray(p))return p;var g,h=void 0!==s&&!(0,i.isMissingOper)(s)&&s.value;if(void 0===u||(0,i.isMissingOper)(u))g=!1;else{var v=e.mathpack.lfix(u);if(0!==v&&1!==v)return a.valueErrorOper;g=1===v}var S=void 0===l||(0,i.isMissingOper)(l)?a.naErrorOper:l;if((0,i.isArrayOper)(S))return a.valueErrorOper;var y=c;if(g&&(y=c.toLowerCase(),d=d.map((function(e){return e.toLowerCase()})),p=p.map((function(e){return e.toLowerCase()}))),0===d.length&&0===p.length)return a.valueErrorOper;var F=function(e,t,r,n,i){for(var o,s,u=0,l=0,c=[];u<=t.length;){var d=void 0,p=void 0;if(l<t.length&&(p=void 0===(d=P(t,l,r))?P(t,l,n):void 0),(0,m.assertTrue)("calc.runtime.textsplit: current in bounds",l<=t.length),void 0!==d||void 0!==p||l===t.length){(l-u>0||!i)&&(void 0===s&&(s=[],c.push(s)),s.push((0,a.stringOper)(e.slice(u,l))),void 0!==p&&(s=void 0));var f=(null!==(o=null!=d?d:p)&&void 0!==o?o:"1").length;(0,m.assertTrue)("calc.runtime.textsplit: matchLength > 0",f>0),u=l+=f}else++l}return c}(c,y,d,p,h);if(!Array.isArray(F))return F;if(0===F.length)return a.calcErrorOper;var C=F.reduce((function(e,t){return(0,f.fastMax)(t.length,e)}),0);return(0,m.assertTrue)("calc.runtime.textsplit: non-zero cols",C>0),(0,a.arrayOper)(F.length,C,F.map((function(e){for(;e.length<C;)e.push(S);return e})))},function(e){e[e.TEXTBEFORE=1]="TEXTBEFORE",e[e.TEXTAFTER=2]="TEXTAFTER"}(k||(k={}));t.textBefore=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5];return A(k.TEXTBEFORE,e,r,n,i,a,o,s)};t.textAfter=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5];return A(k.TEXTAFTER,e,r,n,i,a,o,s)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.today=t.now=t.randarray=t.randbetween=t.rand=void 0;var n=r(8),i=r(46),a=r(7),o=r(275),s=r(19),u=r(10);function l(e,t,r){var n=e.mathpack,a=(0,i.assertNumber)(n.add(r,n.one));return n.floor(c(e,t,a))}function c(e,t,r){var n=e.mathpack,o=n.sub(r,t),s=e.getRandom();if((0,a.isErrorOper)(o)){var l=n.div(t,n.fromNumber(3)),c=n.div(r,n.fromNumber(3));(0,u.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,a.isErrorOper)(l)&&!(0,a.isErrorOper)(c));var d=n.sub(c,l);return(0,u.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,a.isErrorOper)(d)&&n.cond(d)>=0),(0,i.assertNumber)(n.mul(n.fromNumber(3),(0,i.assertNumber)(n.add(l,(0,i.assertNumber)(n.mul(s,d))))))}return(0,i.assertNumber)(n.add(t,(0,i.assertNumber)(n.mul(s,o))))}t.rand=function(e,t){return e.getRandom()},t.randbetween=function(e,t){var r=t[0],o=t[1],s=(0,i.chkNumOper)(e,r),u=(0,i.chkNumOper)(e,o);if((0,a.isErrorOper)(s))return s;if((0,a.isErrorOper)(u))return u;var l=e.mathpack;if(l.cond2(s,u)>0)return n.numErrorOper;var c=e.getRandom(),d=l.ceil(s),p=l.floor(u),m=l.sub(p,d);return(0,a.isErrorOper)(m)?m:l.add(l.floor((0,i.assertNumber)(l.mul((0,i.assertNumber)(l.add(m,l.one)),c))),d)},t.randarray=function(e,t){var r=t[0],o=void 0===r?n.missingOper:r,u=t[1],d=void 0===u?n.missingOper:u,p=t[2],m=void 0===p?n.missingOper:p,f=t[3],g=void 0===f?n.missingOper:f,h=t[4],v=void 0===h?n.missingOper:h,S=e.mathpack,y=(0,a.isMissingOper)(o)?1:S.sfix(o),F=(0,a.isMissingOper)(d)?1:S.sfix(d);if(y<0||y>s.sheetRows||F<0||F>s.sheetRows)return n.valueErrorOper;if((0,i.validateArraySize)(y,F),0===y||0===F)return n.calcErrorOper;var C=(0,a.isMissingOper)(m)?S.zero:m,R=(0,a.isMissingOper)(g)?S.one:g;if(S.cond2(C,R)>0)return n.valueErrorOper;var b=!(0,a.isMissingOper)(v)&&v.value;if(b&&(!(0,i.numInt)(S,C)||!(0,i.numInt)(S,R)))return n.valueErrorOper;for(var E=[],P=0;P<y;P++){for(var k=[],T=0;T<F;T++){var A=b?l(e,C,R):c(e,C,R);k.push(A)}E.push(k)}return(0,n.arrayOper)(y,F,E)},t.now=function(e,t){return e.getTime(o.TimeGranularity.Instant)},t.today=function(e,t){return e.getTime(o.TimeGranularity.Day)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hyperlink=void 0,t.hyperlink=function(e,t){var r=t[0],n=t[1];return e.followHyperlinks?r:null!=n?n:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCompiler=t.compiledFormulaTerm=t.compiledFormula=void 0;var n=r(55);t.compiledFormula=n.compilerService.compiledFormula,t.compiledFormulaTerm=n.compilerService.compiledFormulaTerm,t.createCompiler=n.compilerService.createCompiler},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=void 0;var n=r(55);t.createEvaluator=n.evaluatorService.createEvaluator},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPasteRangePasteEdit=t.rangePasteEdit=t.arrayFormulaEdit=t.rangeFormatEdit=t.formatEditChangeDecimals=t.formatEditRibbonFormat=t.formatEditSetFormat=t.formatEditOperation=t.RibbonFormat=t.inferredRangeFormulaEdit=t.valueRangeFormulaEdit=t.cellFormulaRangeFormulaEdit=t.rangeFormulaEdit=t.columnData=t.namedTableData=t.namedObjectsPromote=t.undefinedNamesWrite=t.namedObjectsWrite=t.namedObjectsUpdate=t.namedObject=t.namedFailureData=t.namedRangeData=t.namedFormulaData=t.namedValueData=t.unusedCellsUpdate=t.arrayPromote=t.arrayWrite=t.arrayUpdate=t.arrayData=t.rangePromote=t.rangeWrite=t.rangeUpdate=t.valueCellData=t.arrayFormulaCellData=t.cellFormulaCellData=t.cellData=t.sheetCellLocation=t.sheetRangeLocation=t.rangeLocation=t.cellLocation=t.getCellFormatKind=t.getCellValueKind=t.richValue=t.errorValue=t.blankValue=t.sheetName=t.numberFormat=t.localeData=t.errorTypeName=t.worksheetFunctionName=void 0,t.internal=t.RecalcServiceDataTransformer=t.getTime=t.recalcServiceInsideInit=t.readOperToCellValue=t.cellValueToReadOper=t.localeInfoFromData=t.RecalcServiceCreateMode=t.createRecalcService=t.workbookProps=t.recalcServiceConfig=t.runExperiment=t.updateRequest=t.evalFormulaFormatAggregate=t.evalFormulaFormatInferred=t.evalFormulaFormatKnown=t.evalFormulaFormatIformat=t.evalFormulaFormatOrigin=t.evalFormulaFormat=t.evalFormulaData=t.recalcResults=t.rangeFailure=t.arrayDelta=t.rangeDelta=t.cellDataDelta=t.inferredFormat=void 0;var n=r(0),i=n.__importStar(r(77)),a=n.__importStar(r(454)),o=n.__importStar(r(120)),s=n.__importStar(r(194)),u=n.__importStar(r(13)),l=n.__importStar(r(317)),c=n.__importStar(r(94));t.worksheetFunctionName=i.worksheetFunctionName,t.errorTypeName=i.errorTypeName,t.localeData=i.localeData,t.numberFormat=i.numberFormat,t.sheetName=i.sheetName,t.blankValue=i.blankValue,t.errorValue=i.errorValue,t.richValue=i.richValue,t.getCellValueKind=i.getCellValueKind,t.getCellFormatKind=i.getCellFormatKind,t.cellLocation=i.cellLocation,t.rangeLocation=i.rangeLocation,t.sheetRangeLocation=i.sheetRangeLocation,t.sheetCellLocation=i.sheetCellLocation,t.cellData=i.cellData,t.cellFormulaCellData=i.cellFormulaCellData,t.arrayFormulaCellData=i.arrayFormulaCellData,t.valueCellData=i.valueCellData,t.rangeUpdate=i.rangeUpdate,t.rangeWrite=i.rangeWrite,t.rangePromote=i.rangePromote,t.arrayData=i.arrayData,t.arrayUpdate=i.arrayUpdate,t.arrayWrite=i.arrayWrite,t.arrayPromote=i.arrayPromote,t.unusedCellsUpdate=i.unusedCellsUpdate,t.namedValueData=i.namedValueData,t.namedFormulaData=i.namedFormulaData,t.namedRangeData=i.namedRangeData,t.namedFailureData=i.namedFailureData,t.namedObject=i.namedObject,t.namedObjectsUpdate=i.namedObjectsUpdate,t.namedObjectsWrite=i.namedObjectsWrite,t.undefinedNamesWrite=i.undefinedNamesWrite,t.namedObjectsPromote=i.namedObjectsPromote,t.namedTableData=i.namedTableData,t.columnData=i.columnData,t.rangeFormulaEdit=i.rangeFormulaEdit,t.cellFormulaRangeFormulaEdit=i.cellFormulaRangeFormulaEdit,t.valueRangeFormulaEdit=i.valueRangeFormulaEdit,t.inferredRangeFormulaEdit=i.inferredRangeFormulaEdit,t.RibbonFormat=i.RibbonFormat,t.formatEditOperation=i.formatEditOperation,t.formatEditSetFormat=i.formatEditSetFormat,t.formatEditRibbonFormat=i.formatEditRibbonFormat,t.formatEditChangeDecimals=i.formatEditChangeDecimals,t.rangeFormatEdit=i.rangeFormatEdit,t.arrayFormulaEdit=i.arrayFormulaEdit,t.rangePasteEdit=i.rangePasteEdit,t.copyPasteRangePasteEdit=i.copyPasteRangePasteEdit,t.inferredFormat=i.inferredFormat,t.cellDataDelta=i.cellDataDelta,t.rangeDelta=i.rangeDelta,t.arrayDelta=i.arrayDelta,t.rangeFailure=i.rangeFailure,t.recalcResults=i.recalcResults,t.evalFormulaData=i.evalFormulaData,t.evalFormulaFormat=i.evalFormulaFormat,t.evalFormulaFormatOrigin=i.evalFormulaFormatOrigin,t.evalFormulaFormatIformat=i.evalFormulaFormatIformat,t.evalFormulaFormatKnown=i.evalFormulaFormatKnown,t.evalFormulaFormatInferred=i.evalFormulaFormatInferred,t.evalFormulaFormatAggregate=i.evalFormulaFormatAggregate,t.updateRequest=i.updateRequest,t.runExperiment=i.runExperiment,t.recalcServiceConfig=i.recalcServiceConfig,t.workbookProps=i.workbookProps,t.createRecalcService=a.createRecalcService,t.RecalcServiceCreateMode=i.RecalcServiceCreateMode,t.localeInfoFromData=o.localeInfoFromData,t.cellValueToReadOper=o.cellValueToReadOper,t.readOperToCellValue=o.readOperToCellValue,t.recalcServiceInsideInit=s.recalcServiceInsideInit,t.getTime=u.getTimeImpl,t.RecalcServiceDataTransformer=c.RecalcServiceDataTransformer,t.internal=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocumentCollection=t.voidCallback=void 0;var n=r(0),i=r(457),a=r(15),o=r(11),s=r(11),u=r(12),l=r(78),c=r(72),d=r(30),p=r(20),m=r(20),f=r(110),g=r(109),h=r(54),v=r(106),S=r(133),y=r(289),F=r(9),C=r(9),R=r(9),b=r(13),E=r(36),P=r(296),k=r(2),T=r(4),A=r(290),N=r(161),_=r(162),I=r(197),O=r(459),M=r(23),D=r(178),w=r(260),L=r(51),x=r(5),K=r(105),U=r(1),B=r(115),W=r(139),G=r(460),V=r(177),j=r(35),q=r(21),H=r(297),z=r(136),Q=r(14),Y=(0,a.gridCell)(0,0),J=function(e){function t(){var t=e.call(this,void 0)||this;return t.fns=[],t}return n.__extends(t,e),t.prototype.wsfNode=function(e){this.fns.push((0,u.englishWorksheetFuncIdToName)(e))},t.prototype.operatorNode=function(e){this.fns.push((0,u.englishOperatorIdToName)(e))},t}(q.ConstVisitor);var $=(0,c.precedents)([],[],[],L.SpecialPrecs.None,c.PrecsBound.Exact);t.voidCallback={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onUnavailable:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}};var X=function(){function e(e,t,r,n,i,o){var u=this;this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=i,this.isServerWorkbookLoad=o,this.renderBlanksAsZerosEnabled=(0,Q.isChangeGateEnabled)("OfficeVSO:7042222_renderBlanksAsZeros"),this.random=new U.JSF32(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.version=0,this.interruptToken=[h.Interrupt.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=function(e,t,r){var n=e?m.FormulaMode.ServerNamedFormula:m.FormulaMode.EditNamedFormula;switch(r.kind){case"NamedFormula":var i=r.fmla,o=u.parser.parseFormula((0,v.parseLocals)(a.LexicalKind.NameManager,Y),i);(0,T.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var l=e&&u.isServerWorkbookLoad,c=(0,g.analyzeLocalsName)((0,a.originCell)((0,a.documentScope)(u.documentLoc),Y),void 0,l),d=o,f=u.checkFormula(c,d,i,n);return u.compileFormula((0,h.compileLocalsName)(Y),f);case"NamedValue":case"NamedRange":case"NamedTable":var S;o=void 0;if("NamedRange"===r.kind){var y=r.value;(0,T.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",(0,s.isDocumentLocEqual)(r.value.sheets.document,t.scope.document));var C=y.sheets,b=u.getDocument(C.document);if(!(0,x.isSuccess)(b))return u.cb.onUnavailableObject(b.reason),(0,x.failure)((0,s.unavailable)([b.reason]));var E=b.value.getSheetName(C.index);if(!(0,x.isSuccess)(E))return u.cb.onUnavailable(E.reason),E;var P=r.value.ranges[0];o=(0,R.formula)((0,R.cellRefNode)((0,R.cellRefRange)((0,R.cellRefSingle)((0,R.pos)(R.PosKind.Abs,P.row),(0,R.pos)(R.PosKind.Abs,P.col)),(0,R.cellRefSingle)((0,R.pos)(R.PosKind.Abs,P.row+P.rows-1),(0,R.pos)(R.PosKind.Abs,P.col+P.cols-1))),(0,R.sheetQualifier)(E.value)),[],[],1),S=(0,a.sheetGridCell)(C,Y)}else"NamedTable"===r.kind?(o=(0,R.formula)((0,R.structRefNode)((0,R.nameNode)((0,F.identNamePart)(t.name)),(0,R.structRef)(void 0)),[],[],1),S=(0,a.originCell)((0,a.documentScope)(u.documentLoc),Y)):(o=(0,R.formula)((0,R.literalNode)(r.value,!0),[],[],1),S=(0,a.originCell)((0,a.documentScope)(u.documentLoc),Y));f=u.analyzer.checkFormula((0,g.analyzeLocalsName)(S),o);return(0,x.isSuccess)(f)&&(0,s.isWellFormed)(f.value)?u.compileFormula((0,h.compileLocalsName)(Y),(0,x.success)(f.value)):(0,T.assertFalse)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ".concat((0,_.anonymizeFormula)(u.config,o,(0,a.lexicalSourceName)(t))));case"NamedFailure":return(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.ClientFailure,reason:r.failureReason}]));default:return(0,T.assertNever)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},this.config=e,this.parser=(0,S.createParser)(this),this.printer=(0,_.createPrinter)(this),this.analyzer=(0,f.createAnalyzer)(this),this.formatter=(0,D.createNumberFormatter)(this),this.compiler=(0,y.createCompiler)(this),this.evaluator=(0,A.createEvaluator)(this)}return e.prototype.clone=function(r,n){var i;void 0===r&&(r=t.voidCallback),void 0===n&&(n=l.CloningTarget.Server);var a=new e(this.config,r,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return a.documentLoc=this.documentLoc,a.document=null===(i=this.document)||void 0===i?void 0:i.clone(n),a.worksheetFuncOverrides=this.worksheetFuncOverrides,a.userDefinedFuncOverrides=this.userDefinedFuncOverrides,a.version=this.version,a},e.prototype.compareVersion=function(e){return this.version===e.version},e.prototype.reconfigure=function(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n,this.advanceVersion()},e.prototype.setConfig=function(e){this.config=e},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.DocumentLoc,document:(0,a.documentLoc)(e,t)}])):(0,x.success)(r)},e.prototype.getNameLoc=function(e,t,r){var n=this.getDocument(e.document);return n.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([n.reason])):n.value.getNameLoc(e.index,t,r)},e.prototype.getUserDefinedFuncLoc=function(e,t){if(void 0!==this.userDefinedFuncOverrides[t]){var r=(0,a.userDefinedFuncLoc)(e,t);return(0,x.success)([r])}return(0,x.failure)((0,s.notImplemented)(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([t.reason]));if(!0!==t.value)return(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedFormat(e);return r.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([r.reason])):r.value===m.SpecialFormat.Unavailable?(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.CellFormat}])):(0,x.success)(r.value)},e.prototype.getCellStyle=function(e){var t=this.allEditedAvailable(e);if(!(0,x.isSuccess)(t))return(0,x.failure)((0,s.unavailable)([t.reason]));if(!0!==t.value)return(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedStyle(e);return(0,x.isSuccess)(r)?r.value===m.SpecialStyle.Unavailable?(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):(0,x.failure)((0,s.unavailable)([r.reason]))},e.prototype.getIformat=function(e,t){var r=this.getDocument(e);if(r.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.getIformat(t);if(n.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([n.reason]));var i=n.value.getValue();return i.kind===x.ResultKind.Failure?(0,x.failure)((0,M.previousFormatFailure)((0,M.formatLocIFormat)(e,t))):i},e.prototype.getIformats=function(e,t,r){var n=this.getDocument(e);if(n.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([n.reason]));for(var i=n.value.getIformats(),a=[],o=t,u=(0,k.fastMin)(i.length,r);o<u;o+=1){var l=i[o];void 0!==l&&a.push({iformat:o,formatString:l.formatString,builtIn:l.builtIn})}return(0,x.success)(a)},e.prototype.getKnownFormat=function(e,t){var r=this.getDocument(e);if(r.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.getKnownFormat(t);if(n.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([n.reason]));var i=n.value.getValue();return i.kind===x.ResultKind.Failure?(0,x.failure)((0,M.previousFormatFailure)((0,M.formatLocKnownFormat)(e,t))):i},e.prototype.getFormatString=function(e,t){var r=this.getDocument(e);if(r.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.getFormatString(t);return n.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([n.reason])):n},e.prototype.getNameFormula=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.getNameFormula(e,t);if(n.kind===x.ResultKind.Failure)return n;if(void 0===n.value)return(0,x.success)(void 0);var i=n.value.lazyData.getValue();if((0,x.isSuccess)(i))return i;var a=this.hasRecalcNameFailure(e);return(0,x.isSuccess)(a)?a.value||this.setNameFailure(e,i.reason):this.cb.onUnavailable(a.reason),(0,x.failure)((0,h.previousNameFailure)(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([t.reason]));if(void 0===t.value)return(0,x.success)(void 0);var r=t.value,n=r[0],i=r[1];if(void 0===i.compiledFmla)return(0,x.success)(void 0);var o=(0,a.sheetGridRange)(e.sheet,n),u=this.readCompiledFmla(o,i.compiledFmla);return(0,x.isSuccess)(u)?(0,x.success)((0,h.cellFormula)((0,a.lexicalSourceGrid)(i.lexicalKind,o),u.value)):u},e.prototype.setCellValue=function(e,t,r){var n=this.setRecalcValue(e,t);if(n.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);var i=this.propagateEditTaint(e,r);if(i.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValue(e,t,r,i.value,this.evalParams)},e.prototype.setCellValues=function(e,t,r){var n=this.setClientValue(e,t);if(n.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(n.reason);var i=this.setRecalcValue(e,t);if(i.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);var a=this.propagateEditTaint(e,r);if(a.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValues(e,t,r,a.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){var t;if((0,E.isVolatileFunc)(e)){var r=!1,n=this.evalParams.volatileMode;switch(e){case E.WorksheetFuncId.RAND:case E.WorksheetFuncId.RANDBETWEEN:case E.WorksheetFuncId.RANDARRAY:case E.WorksheetFuncId.NOW:r=n===b.VolatileMode.GroundTruth;break;case E.WorksheetFuncId.TODAY:r=n===b.VolatileMode.GroundTruth||n===b.VolatileMode.Estimation;break;default:r=void 0===E.WorksheetFuncId[e]}if(!r)return(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.VolatileFunction,name:(0,u.englishWorksheetFuncIdToName)(e)}]))}var i=null!==(t=this.worksheetFuncOverrides[e])&&void 0!==t?t:(0,P.getWorksheetFunc)(e);return null!=i?(0,x.success)(i):(0,x.failure)((0,s.notImplemented)([(0,u.englishWorksheetFuncIdToName)(e)]))},e.prototype.getUserDefinedFunc=function(e){var t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?(0,x.success)(this.userDefinedFuncOverrides[t]):(0,x.failure)((0,s.notImplemented)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){return this.getSheetRangeIds(e)},e.prototype.setCellFailure=function(e,t,r){var n,i=this.setRecalcFailure(e.sheet,(0,d.createCellSetFromRange)(e.range));if(i.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(i.reason);var a=this.setClientValue(e,l.clientValueUnknownOper);if(a.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);var o=this.setRecalcValue(e,c.blankOper);if(o.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);var s=this.propagateEditTaint(e,r);if(s.kind===x.ResultKind.Failure)return this.cb.onUnavailableObject(s.reason);var u=this.evalParams;null===(n=u.onRangeFailure)||void 0===n||n.call(u,e,t,r),this.cb.onRangeFailure(e,t,r,s.value,u)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.getSheetName(t);return n.kind===x.ResultKind.Failure||void 0===n.value?n:(0,x.success)(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===x.ResultKind.Failure||void 0===n.value?n:(0,x.success)(n.value.index)},e.prototype.getContainingTable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([t.reason])):t.value.getContainingTable(e)},e.prototype.getNamedRanges=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([t.reason])):t.value.getNamedRanges(e)},e.prototype.getStructRefColumn=function(e,t){var r=this.getDocument(e.scope.document);return r.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([r.reason])):r.value.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getDocument(e.scope.document);return r.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([r.reason])):r.value.getStructRefSpecialRef(e,t)},e.prototype.getIntersectingTables=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([t.reason])):t.value.getIntersectingTables(e)},e.prototype.getNamedObject=function(e,t){var r,n=this.getDocument(e.scope.document);if(n.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([n.reason]));var i=n.value.getNameFormula(e,t);return i.kind===x.ResultKind.Failure?i:(0,x.success)(null===(r=i.value)||void 0===r?void 0:r.obj)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===x.ResultKind.Failure?l.hiddennessFullyUnavailable:n.value.getHiddenRows(e.index,t,r)},e.prototype.tryGetHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([n.reason]));var i=n.value.tryGetHiddenRows(e.index,t,r);return i.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([i.reason])):i},e.prototype.getHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===x.ResultKind.Failure?l.hiddennessFullyUnavailable:n.value.getHiddenCols(e.index,t,r)},e.prototype.tryGetHiddenCols=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([n.reason]));var i=n.value.tryGetHiddenCols(e.index,t,r);return i.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([i.reason])):i},e.prototype.getMergeCell=function(e){var t=this.allEditedAvailable(e);if(t.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([t.reason]));if(!0!==t.value)return(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.GridRange,unavailableCells:t.value,range:e}]));var r=this.getDocument(e.sheet.document);if(r.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.getMergeCell(e);return n.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([n.reason])):n},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([r.reason])):r},e.prototype.getRandom=function(){return(0,T.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===b.VolatileMode.GroundTruth),(0,x.success)(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(e,t){return(0,b.getTimeImpl)(this.config,e,t,this.evalParams.volatileMode)},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var i=t();return Array.isArray(i)?i:i.kind===x.ResultKind.Paused?(0,h.paused)((function(){return r.withEvalParams(e,i.resume)})):(0,h.breaked)((function(){return r.withEvalParams(e,i.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var i=t();return i.kind===x.ResultKind.Paused?(0,h.paused)((function(){return r.withEvalParamsEvalFormula(e,i.resume)})):i.kind===x.ResultKind.Breaked?(0,h.breaked)((function(){return r.withEvalParamsEvalFormula(e,i.resume)})):i}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t,r,n){var i=this;return this.withEvalParams({computeKind:e,computeCells:t,volatileMode:r,onRangeFailure:n},(function(){return i.evaluator.evalCells({},t)}))},e.prototype.evalFormula=function(e,t,r,n){var i=this,o={lexicalKind:a.LexicalKind.Other,originGridCell:(0,x.success)(t.range),originSheet:(0,x.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:!1,contextNames:void 0},s={lexicalSource:{kind:a.LexicalKind.Other},originGridCell:(0,x.success)(t.range),originSheet:(0,x.success)(t.sheet),calcingArray:!1,reflectionGridCell:(0,x.success)(t.range),reflectionSheet:(0,x.success)(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:(0,x.success)(!1),contextNames:void 0},u=function(e,n){if(n.kind===x.ResultKind.Paused)return(0,h.paused)((function(){return u(e,n.resume())}));if(n.kind===x.ResultKind.Breaked)return(0,h.breaked)((function(){return u(e,n.resume())}));if(!(0,x.isSuccess)(n))return(0,x.success)({value:n});var a=i.evalFormulaFormat(t,e,n.value,r);return(0,x.success)({value:(0,x.success)(n.value),formatted:a})};return this.withEvalParamsEvalFormula({computeKind:m.ComputeKind.EvalFormula,computeCells:[t],volatileMode:n},(function(){var t=i.parser.parseFormula(o,e),r=i.checkFormula(o,t,e,m.FormulaMode.EvalFormula),n=i.compileFormula(o,r);return(0,x.isSuccess)(n)?u(n.value,i.evaluator.evalFormula(s,n.value)):(0,x.success)({value:n})}))},e.prototype.evalFormulaFormat=function(e,t,r,n){var i;if(void 0!==n){if("number"==typeof n)return this.formatValueIformat(e.sheet.document,n,r);if(n.kind===m.SpecialFormat.Known)return this.formatValueKnownFormat(e.sheet.document,n.knownFormat,r);var a=r;if(this.renderBlanksAsZerosEnabled&&(0,s.isBlankOper)(r)&&(n.kind===m.SpecialFormat.Origin||n.kind===m.SpecialFormat.Inferred||n.kind===m.SpecialFormat.Edit)&&null!==(i=n.renderBlanksAsZeros)&&void 0!==i&&i&&(a=this.config.mathpack.zero),n.kind===m.SpecialFormat.Origin||n.kind===m.SpecialFormat.Aggregate){var o=this.ensureCellExists(e);return(0,k.isNone)(o)||!(0,x.isSuccess)(o)?o:n.kind===m.SpecialFormat.Origin?this.formatValueCell(e,a):this.formatValueAggregate(e,a)}return n.kind===m.SpecialFormat.Inferred?this.applyInferredFormat(e,t,a):n.kind===m.SpecialFormat.Edit?this.applyEditFormat(e,t,a,n.isWholeFormula):(0,T.assertNever)("calc.calc.PartialWorkbookDocumentCollection.evalFormulaFormat",n)}},e.prototype.evalValue=function(e,t,r){var n,i=this.evalParams;this.evalParams={computeKind:t,computeCells:[e],volatileMode:r};try{var a=this.getEditedFormula(e);if(!(0,x.isSuccess)(a))return this.cb.onUnavailableObject(a.reason);if(void 0!==(null===(n=a.value)||void 0===n?void 0:n[1].compiledFmla))return;var o=this.hasRecalcDirty(e);if(!(0,x.isSuccess)(o))return this.cb.onUnavailableObject(o.reason);if(o.value)return;var s=this.tryGetCellValue(e.range,e.sheet);if(void 0===s)return;(0,T.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.evalValue",s.kind===h.CellKind.FinalValue),this.cb.onReturnCellValue(e,s.oper,m.ComputedCellKind.EditedCell)}finally{this.evalParams=i}},e.prototype.advanceVersion=function(){return this.version++,this.version},e.prototype.setUserDefinedFuncOverrides=function(e){this.userDefinedFuncOverrides=e,this.advanceVersion()},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e,this.advanceVersion()},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===x.ResultKind.Failure?r:(this.document=r.value.setSheetNames(t),(0,x.success)(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e,this.advanceVersion())},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e,this.advanceVersion())},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,i=e.document,a=this.getDocument(i);return a.kind===x.ResultKind.Failure?a:a.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=e.index,i=e.document,a=this.getDocument(i);return a.kind===x.ResultKind.Failure?a:a.value.forEachServerNonBlankCellInSet(n,t,r)},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=e.index,i=e.document,a=this.getDocument(i);return a.kind===x.ResultKind.Failure?a:a.value.forEachEditedCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():l.emptyGridStatistics},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():W.emptyNameStatistics},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e,this.advanceVersion())},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getEditedFormula(e)},e.prototype.forEachEditedFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.forEachEditedFormula(e,t)},e.prototype.getEditedValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getEditedValue(e)},e.prototype.forEachEditedValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.forEachEditedValue(e,t)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getEditedFormat(e)},e.prototype.forEachEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.forEachEditedFormat(e,t)},e.prototype.getEditedStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getEditedStyle(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getServerFormat(e)},e.prototype.getServerStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getServerStyle(e)},e.prototype.getClientFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getClientFormat(e)},e.prototype.getClientValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getClientValue(e)},e.prototype.getRecalcValues=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getRecalcValues(e)},e.prototype.forEachRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.forEachRecalcValue(e,t)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getServerValue(e)},e.prototype.getServerFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getServerFormula(e)},e.prototype.getClientFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.getClientFormula(e)},e.prototype.getServerUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===x.ResultKind.Failure)return t;var r=t.value.getServerUsedRange(e.index);return r.kind===x.ResultKind.Failure||void 0===r.value?r:(0,x.success)((0,a.sheetGridRange)(e,r.value))},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachDocument((function(t){(0,k.safePush)(e,t.getServerAvailableCells())})),e},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,i=this.getDocument(r.document);return i.kind===x.ResultKind.Failure?i:i.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===x.ResultKind.Failure?r:r.value.extendServerUnused(e.index,t,this.advanceVersion())},e.prototype.setCellContents=function(e,t,r,n,i,o,s,u,c,d){var p=this.getDocument(t.sheet.document);if(p.kind===x.ResultKind.Failure)return p;var m=void 0===r?void 0:n?this.compileFmla(e,a.LexicalKind.Cell,(0,a.sheetGridCell)(t.sheet,i),void 0,r):""===r?l.blankCellGridFormula:{fmla:r,lexicalKind:a.LexicalKind.Cell,origin:i,compiledFmla:void 0,hasHyperlink:l.SpecialBoolean.ClientValueUnknown};return p.value.setCellContents(e,t,m,o,s,u,c,d,this.advanceVersion())},e.prototype.setRangeFormula=function(e,t,r,n,i,o,u,c){var d=this.getDocument(t.sheet.document);if(d.kind===x.ResultKind.Failure)return d;var p=""===r?l.blankRangeGridFormula:this.compileFmla(e,a.LexicalKind.Range,(0,a.sheetGridCell)(t.sheet,n),(0,s.gridRangeAnchor)(t.range),r);return d.value.setRangeFormula(e,t,p,i,o,u,c,this.advanceVersion())},e.prototype.copyRange=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.copyRange(e)},e.prototype.pasteRange=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.pasteRange(e,t,this.advanceVersion())},e.prototype.assumeRecalcFinal=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.assumeRecalcFinal(e,this.advanceVersion())},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);return n.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([n.reason])):n.value.setNamedObject(e,t,r,this.compileNamedObject)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([t.reason])):t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([r.reason])):r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t,r){var n=this,i=this.ensureDocument(e);if(i.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([i.reason]));var a=[];return t.forEach((function(e){var t=e.iformat,r=e.formatString,i=e.builtIn,o=n.compileNumberFormat(r,i);a[t]={formatString:r,builtIn:i,compiledFormat:o}})),(0,x.success)(i.value.setNumberFormats(a,r))},e.prototype.setStyles=function(e,t,r){var n=this.ensureDocument(e);return n.kind===x.ResultKind.Failure?n:(0,x.success)(n.value.setStyles(t,r))},e.prototype.setFonts=function(e,t,r){var n=this.ensureDocument(e);return n.kind===x.ResultKind.Failure?n:(0,x.success)(n.value.setFonts(t,r))},e.prototype.setFills=function(e,t,r){var n=this.ensureDocument(e);return n.kind===x.ResultKind.Failure?n:(0,x.success)(n.value.setFills(t,r))},e.prototype.setBorders=function(e,t,r){var n=this.ensureDocument(e);return n.kind===x.ResultKind.Failure?n:(0,x.success)(n.value.setBorders(t,r))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===x.ResultKind.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===x.ResultKind.Failure?n:n.value.setHiddenCols(e.index,t,r)},e.prototype.writeMergeCell=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.setMergeCell(e)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===x.ResultKind.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveCellFormat=function(e,t){if("number"!=typeof t)return(0,x.success)(t);var r=this.getDocument(e);if(!(0,x.isSuccess)(r))return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.getIformat(t);return(0,x.isSuccess)(n)?n.value.getValue():(0,x.failure)((0,s.unavailable)([n.reason]))},e.prototype.resolveCellStyle=function(e,t){var r=this.getDocument(e);if(!(0,x.isSuccess)(r))return(0,x.failure)((0,s.unavailable)([r.reason]));var n=r.value.resolveCellStyle(t);return(0,x.isSuccess)(n)?(0,x.success)(n.value):(0,x.failure)((0,s.unavailable)([n.reason]))},e.prototype.resolveValueFormat=function(e,t){var r;if("string"==typeof t)return this.resolveStringFormat(e,t);var n=this.getKnownFormat(e,t);if(!(0,x.isSuccess)(n))return n;var i=this.getFormatString(e,n.value.formatString);return(0,x.isSuccess)(i)?(0,x.success)(null!==(r=i.value)&&void 0!==r?r:n.value):i},e.prototype.resolveStringFormat=function(e,t){var r=this.getFormatString(e,t);return(0,x.isSuccess)(r)?void 0!==r.value?(0,x.success)(r.value):this.formatter.createFormat(t,!1):r},e.prototype.resolveObjectFormat=function(e,t){var r=this.getFormatString(e,t.formatString);return(0,x.isSuccess)(r)?void 0!==r.value?(0,x.success)(r.value):(0,x.success)(t):r},e.prototype.resolveEditFormat=function(e,t){return"number"==typeof t?(0,x.success)(t):this.resolveStringFormat(e,t)},e.prototype.resolveRibbonFormat=function(e,t,r){var n;switch(t){case z.RibbonFormat.GalleryShortDate:case z.RibbonFormat.GalleryLongDate:var i=this.getCellFormat(r);if(!(0,x.isSuccess)(i))return i;var a=this.resolveCellFormat(r.sheet.document,i.value);if(!(0,x.isSuccess)(a))return a;n=a.value}var o=(0,z.getRibbonFormat)(this.config.localeInfo,t,n);return this.resolveStringFormat(e,o)},e.prototype.resolveChangeDecimals=function(e,t,r){var n=this.getCellFormat(r);if(!(0,x.isSuccess)(n))return n;var i=this.resolveCellFormat(r.sheet.document,n.value);if(!(0,x.isSuccess)(i))return i;var a=this.formatter.changeFormatDecimals(i.value,t);return(0,x.isSuccess)(a)?void 0===a.value?x.successUndefined:this.resolveObjectFormat(e,a.value):a},e.prototype.parseInferredEdit=function(e,t,r){var n=this.getCellFormat(e);if(!(0,x.isSuccess)(n))return n;var i=this.resolveCellFormat(e.sheet.document,n.value);if(!(0,x.isSuccess)(i))return i;var a=this.evalParams;this.evalParams={computeKind:m.ComputeKind.ParseEdit,computeCells:[e],volatileMode:r};try{return this.formatter.parseEdit(t,i.value)}finally{this.evalParams=a}},e.prototype.inferFormulaFormat=function(e){var t=this.getEditedFormula(e);if(!(0,x.isSuccess)(t))return(0,x.success)(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return(0,x.success)(void this.cb.onUnavailableObject({kind:p.UnavailableKind.CellEvaluatingValue}));var r=t.value[1].compiledFmla.getValue();if(!(0,x.isSuccess)(r))return r;var n=(0,a.lexicalSourceGrid)(t.value[1].lexicalKind,(0,a.sheetGridRange)(e.sheet,t.value[0])),i=r.value;return this.formatter.evalFormat((0,M.evalFormatLocalsGrid)(n),i)},e.prototype.fillInferredFormat=function(e,t){var r=this,n=t,i=t===m.SpecialFormat.Unavailable?(0,x.success)(m.SpecialFormat.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!(0,x.isSuccess)(i)){var o=i.reason;(0,d.forEachRangeInSet)(e.set,(function(t){var n=(0,a.sheetGridRange)(e.sheet,t);return r.cb.onInferFormatFailure(n,o),!0})),i=(0,x.success)(m.SpecialFormat.Unavailable),n=m.SpecialFormat.Unavailable}var s=i.value;(0,d.forEachCellInSet)(e.set,(function(t){var i=(0,a.sheetGridCell)(e.sheet,t),o=r.getEditedFormat(i);if(!(0,x.isSuccess)(o))return r.cb.onUnavailableObject(o.reason),!0;if(o.value===m.SpecialFormat.Unavailable)return!0;var u=r.resolveCellFormat(e.sheet.document,o.value);if(!(0,x.isSuccess)(u))return r.cb.onInferFormatFailure(i,u.reason),!0;if((0,w.shouldInstallFormat)(s===m.SpecialFormat.Unavailable?void 0:s,u.value)){var l=r.setEditedFormat(i,n);(0,x.isSuccess)(l)||r.cb.onUnavailableObject(l.reason)}return!0}))},e.prototype.anonymizeFormula=function(e,t){var r,n,i,a=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==a&&(0,x.isSuccess)(a)?[(0,_.anonymizeFormula)(this.config,a.value,e),(n=a.value,i=new J,(0,q.reduceBottomUp)(i,n),i.fns)]:[(0,I.anonymizeFormulaString)(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,i){var a=this;return{fmla:i,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new b.ResettableLazy((function(){var o=a.parser.parseFormula((0,v.parseLocals)(t,r.range),i),s=e?o:a.autocorrectFormula((0,g.analyzeLocalsGrid)(t,r),o),u=e&&a.isServerWorkbookLoad,l=a.checkFormula((0,g.analyzeLocalsGrid)(t,r,void 0,u),s,i,e?m.FormulaMode.ServerCellFormula:m.FormulaMode.EditCellFormula),c=a.adjustFormulaOrigin(l,r,n);return a.compileFormula((0,h.compileLocalsGrid)(t,r.range),c)})),hasHyperlink:l.SpecialBoolean.ClientValueUnknown}},e.prototype.compileFormula=function(e,t){return(0,x.isSuccess)(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.checkFormula=function(e,t,r,n){if(!(0,x.isSuccess)(t))return t;var i=this.analyzer.checkFormulaWithDiagnostics(e,t.value);if(!(0,x.isSuccess)(i))return i;if(!(0,s.isWellFormed)(i.value[0])){var a="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+(0,I.anonymizeFormulaString)(r);return(0,x.failure)((0,h.illFormedFormula)(a,n,(0,g.summarizeFormulaDiagnostics)(i.value[1])))}return(0,x.success)(i.value[0])},e.prototype.autocorrectFormula=function(e,t){return(0,x.isSuccess)(t)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){if(!(0,x.isSuccess)(e)||void 0===r)return e;var n=(0,K.resolveLocalsGrid)(t);return(0,O.adjustFormulaOrigin)(this,n,r,e.value)},e.prototype.compileNumberFormat=function(e,t){var r=this;return new b.ResettableLazy((function(){var n=r.formatter.createFormat(e,t);return(0,x.isSuccess)(n)||r.cb.onNumberFormatFailure(n.reason),n}))},e.prototype.compileKnownFormats=function(){var e=this;return(0,k.numEnumMap)(B.KnownFormat,(function(t){return e.compileNumberFormat((0,V.getKnownFormat)(e.config.localeInfo,t),!1)}))},e.prototype.printFormulaBarText=function(e,t,r){return this.printer.printFormula((0,N.printLocalsGrid)(e,(0,a.sheetGridCell)(e.range.sheet,t)),r)},e.prototype.renderValueBarText=function(e,t,r){var n=this.getEditedResolvedFormat(e);return(0,x.isSuccess)(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,(0,j.stringStartsWith)(r,"'")):n},e.prototype.formatValueCell=function(e,t){if((0,s.isBlankOper)(t))return(0,x.success)((0,M.formattedValue)([],void 0,M.Alignment.Left,M.Clip.All));var r=this.getEditedResolvedFormat(e);if(!(0,x.isSuccess)(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueAggregate=function(e,t){if(!(0,o.isNumberOper)(t))return(0,x.success)((0,M.hashesValue)(M.aggregationError,void 0));var r;if((0,o.isNumberOper)(t)&&0===this.config.mathpack.cond(t))r=this.getKnownFormat(e.sheet.document,B.KnownFormat.General);else{if(r=this.getEditedResolvedFormat(e),!(0,x.isSuccess)(r))return r;var n=r.value.valueType;n===M.FormatValueType.Text?r=this.getKnownFormat(e.sheet.document,B.KnownFormat.General):n===M.FormatValueType.Time&&(r=this.getKnownFormat(e.sheet.document,B.KnownFormat.AbsHMMSS))}if(!(0,x.isSuccess)(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueIformat=function(e,t,r){var n=this.getIformat(e,t);return(0,x.isSuccess)(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.formatValueKnownFormat=function(e,t,r){var n=this.getKnownFormat(e,t);return(0,x.isSuccess)(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.getEditedResolvedFormat=function(e){var t=this.getEditedFormat(e);return(0,x.isSuccess)(t)?t.value===m.SpecialFormat.Unavailable?(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):(0,x.failure)((0,s.unavailable)([t.reason]))},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&(0,s.isDocumentLocEqual)(this.documentLoc,e)?(0,x.success)(this.document):(0,x.failure)({kind:p.UnavailableKind.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new i.PartialWorkbookDocument(e,this.config.localeInfo.stringCompareCI,new G.PartialWorkbookFormats(this.compileKnownFormats()),new H.PartialWorkbookStyles)),this.getDocument(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=(0,a.sheetGridRange)(t,e),i=e.row,o=e.col,u=e.rows,l=e.cols,c=this.getRecalcValues(n);if(c.kind!==x.ResultKind.Failure){for(var d=!1,m=0;m<u;m+=1)for(var f=c.value[m],g=0;g<l;g+=1){var v=f[g].failure;void 0!==v&&(this.setCellFailure((0,a.sheetGridCell)(t,(0,a.gridCell)(i+m,o+g)),v,$),d=!0)}if(!d){var S=function(e){return(0,h.finalValue)(e.oper)},y=c.value.map((function(e){return e.map(S)})),F=this.forEachRecalcDirty(n,(function(e){var n=(0,a.sheetGridCell)(t,e),u=r.getEditedFormula(n);if(u.kind===x.ResultKind.Failure)return r.cb.onUnavailableObject(u.reason),!1;if(void 0===u.value)return r.setCellFailure(n,(0,s.unavailable)([{kind:p.UnavailableKind.CellMissingFormula}]),$),d=!0,!0;var l=u.value,c=l[0],m=l[1];if(void 0===m.compiledFmla)return r.cb.onUnavailableObject({kind:p.UnavailableKind.CellEvaluatingValue}),!1;var f=r.readCompiledFmla((0,a.sheetGridRange)(t,c),m.compiledFmla);return(0,x.isSuccess)(f)?(y[e.row-i][e.col-o]=(0,h.pendingValue)((0,a.sheetGridCell)(t,(0,s.gridRangeAnchor)(c))),!0):(d=!0,!0)}));if((0,x.isSuccess)(F)){if(F.value&&!d)return y}else this.cb.onUnavailableObject(F.reason)}}else this.cb.onUnavailableObject(c.reason)},e.prototype.tryGetCellValue=function(e,t){var r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([n.reason]));if(!0!==n.value)return(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.GridRange,range:r,unavailableCells:n.value}]));var i=t.hasRecalcFailure(r);if(i.kind===x.ResultKind.Failure)return(0,x.failure)((0,s.unavailable)([i.reason]));if(i.value)return(0,x.failure)((0,h.previousFailure)(r));if((0,s.gridRangeSize)(r.range)>t.maxDereferenceCells)return(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.GridRangeSize,range:r}]));var a=e(r.range,r.sheet);return void 0===a?(0,x.failure)((0,h.previousFailure)(r)):(0,x.success)(a)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if((0,x.isSuccess)(r))return r;if(this.setCellFailure(e,r.reason,$),r.reason.kind===h.ReasonKind.Unavailable){r.reason;return r}return(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===x.ResultKind.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===x.ResultKind.Failure||void 0===r.value?r:(0,x.success)((0,a.sheetGridRange)(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([t.reason])):t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.allEditedAvailable(e)},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.forEachRecalcDirty(e,t)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===x.ResultKind.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setClientFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.setClientFormat(e,t,this.advanceVersion())},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===x.ResultKind.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.testAndSetClientValue=function(e,t){var r=this.getClientValue(e);if(r.kind===x.ResultKind.Failure)return r;var n=(0,l.isClientValueUnknownOper)(r.value.oper)||!(0,s.isReadOperEqual)(this.config.mathpack,r.value.oper,t,!0);if(n){var i=this.setClientValue(e,t);if(i.kind===x.ResultKind.Failure)return i}return(0,x.success)(n)},e.prototype.testAndSetClientFormat=function(e,t){var r=this.getClientFormat(e);if(r.kind===x.ResultKind.Failure)return r;var n=t!==r.value;if(n){var i=this.setClientFormat(e,t);if(i.kind===x.ResultKind.Failure)return i}return(0,x.success)(n)},e.prototype.testAndSetClientFormula=function(e,t,r){var n,i=this.getClientFormula((0,s.sheetGridRangeAnchor)(e));if(i.kind===x.ResultKind.Failure)return i;var o=null!==(n=i.value)&&void 0!==n?n:[e.range,l.blankClientGridFormula],u=o[0],c=o[1],d=(0,s.gridRangeAnchor)(e.range),p=void 0!==t&&t!==c.fmla||void 0!==c.compiledFmla&&!(0,s.isGridCellEqual)(d,c.origin),m=void 0!==r&&r!==c.hasHyperlink;if(p||m){var f=c.compiledFmla,g=this.setClientFormula((0,a.sheetGridRange)(e.sheet,u),{fmla:null!=t?t:c.fmla,compiledFmla:f,origin:void 0!==t?d:c.origin,hasHyperlink:null!=r?r:c.hasHyperlink});if(g.kind===x.ResultKind.Failure)return g}return(0,x.success)({hasFmlaChanged:p,hasHyperlinkChanged:m})},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===x.ResultKind.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===x.ResultKind.Failure)return r;if(r.value)return(0,x.success)(m.ComputedCellKind.EditedCell);for(var n=0,i=t.cells;n<i.length;n++){var a,o=i[n],s=this.hasRecalcEditTaint(o);if(s.kind===x.ResultKind.Failure)return s;if(s.value)return(a=this.setRecalcEditTaint(e.sheet,(0,d.createCellSetFromRange)(e.range))).kind===x.ResultKind.Failure?a:(0,x.success)(m.ComputedCellKind.DependentCell)}return 0!=(t.special&(L.SpecialPrecs.Calc|L.SpecialPrecs.Time))?(a=this.setRecalcEditTaint(e.sheet,(0,d.createCellSetFromRange)(e.range))).kind===x.ResultKind.Failure?a:(0,x.success)(m.ComputedCellKind.DependentCell):t.bound===c.PrecsBound.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===m.ComputeKind.EditedCell?(0,x.success)(m.ComputedCellKind.IndependentCell):(0,x.success)(m.ComputedCellKind.UnknownNonEditedCell)},e.prototype.setClientValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.setClientValue(e,t,this.advanceVersion())},e.prototype.setRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.setRecalcValue(e,t)},e.prototype.setClientFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===x.ResultKind.Failure?r:r.value.setClientFormula(e,t,this.advanceVersion())},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([t.reason])):t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===x.ResultKind.Failure?(0,x.failure)((0,s.unavailable)([t.reason])):t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===x.ResultKind.Failure)return this.cb.onUnavailable(r.reason);this.cb.onNameFailure(e,t,this.evalParams)},e.prototype.applyInferredFormat=function(e,t,r){var n=this.getInferredFormat(e,t);return(0,x.isSuccess)(n)?void 0===n.value?this.formatValueKnownFormat(e.sheet.document,B.KnownFormat.General,r):"number"==typeof n.value?this.formatValueIformat(e.sheet.document,n.value,r):this.formatter.applyFormat(n.value,r,!0):n},e.prototype.applyEditFormat=function(e,t,r,n){if(t.node.kind===C.NodeKind.CellRef&&!n)return this.applyInferredFormat(e,t,r);var i=this.ensureCellExists(e);if((0,k.isNone)(i)||!(0,x.isSuccess)(i))return i;var a=this.getEditedResolvedFormat(e);if(!(0,x.isSuccess)(a))return a;var o,s=this.getInferredFormat(e,t);if(!(0,x.isSuccess)(s))return s;if(void 0===s.value)o=void 0;else if("number"==typeof s.value){var u=this.getIformat(e.sheet.document,s.value);if(!(0,x.isSuccess)(u))return u;o=u.value}else o=s.value;var l=(0,V.getKnownFormat)(this.config.localeInfo,B.KnownFormat.General)===a.value.formatString;return(n||l)&&(0,k.isDefined)(o)&&(0,w.shouldInstallFormat)(o,a.value)?this.formatter.applyFormat(o,r,!0):this.formatter.applyFormat(a.value,r,!0)},e.prototype.getInferredFormat=function(e,t){var r={lexicalSource:{kind:a.LexicalKind.Other},originGridCell:(0,x.success)(e.range),originSheet:(0,x.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1};return this.formatter.evalFormat(r,t)},e.prototype.ensureCellExists=function(e){var t=this.allEditedAvailable(e);if((0,x.isSuccess)(t))return!0!==t.value?(0,x.failure)((0,s.unavailable)([{kind:p.UnavailableKind.GridRange,unavailableCells:t.value,range:e}])):(0,x.success)(!0);this.cb.onUnavailableObject(t.reason)},e}();t.PartialWorkbookDocumentCollection=X},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookNameManager=void 0;var n=r(15),i=r(2),a=r(5),o=r(9),s=r(11),u=r(4),l=r(139),c=r(105),d=r(458),p=r(20),m=function(){function e(e,t,r,i,c){var d=this;this.document=e,this.stringCompareCI=t,this.sheetScopedNames=r,this.oldSheetScopedNames=i,this.onWriteNamedObject=function(e,t,r){if("NamedRange"===t.kind){var n=t.value;if((0,u.assertTrue)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",(0,s.isDocumentLocEqual)(t.value.sheets.document,e.scope.document)),(i=d.getNamesBySheetId(n.sheets.index)).kind===a.ResultKind.Failure)return i;i.value.onWriteNamedRange(e,t,r)}if("NamedTable"===t.kind){var i;if((i=d.getNamesBySheetId(t.specialRefRanges[o.SpecialRefId.All].sheet.index)).kind===a.ResultKind.Failure)return i;i.value.onWriteNamedTable(e,t,r)}return a.successUndefined},this.globalNames=null!=c?c:new l.PartialWorkbookNames(t,(0,n.documentScope)(e))}return e.prototype.clone=function(){var t;if(this.sheetScopedNames)for(var r in t=(0,i.makeStringMap)(),this.sheetScopedNames){var n=this.sheetScopedNames[r];t[r]=n.clone()}return new e(this.document,this.stringCompareCI,t,void 0,this.globalNames.clone())},e.prototype.setNamedObject=function(e,t,r,i){var o=this.getNameFormula(t,n.NameSource.StructRef);void 0!==r&&"NamedTable"===r.kind&&(0,a.isSuccess)(o)&&void 0!==o.value&&"NamedTable"===o.value.obj.kind&&(0,l.isNamedTableRangeEqual)(o.value.obj,r)&&(r=(0,l.mergeNamedTables)(o.value.obj,r));var s=this.getNamesBySheetId(t.scope.index);return s.kind===a.ResultKind.Failure?s:s.value.setNamedObject(e,t,r,i,this.onWriteNamedObject)},e.prototype.setUndefinedNames=function(e){var t=this.getNamesBySheetId(e.index);return t.kind===a.ResultKind.Failure?t:(0,a.success)(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNamesBySheetId(e.index);return r.kind===a.ResultKind.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)},e.prototype.setSheetNames=function(t){for(var r,a,o=null!==(r=this.sheetScopedNames)&&void 0!==r?r:this.oldSheetScopedNames,s=(0,i.makeStringMap)(),u=0,c=t;u<c.length;u++){var d=c[u].sheetId;s[d]=null!==(a=null==o?void 0:o[d])&&void 0!==a?a:new l.PartialWorkbookNames(this.stringCompareCI,(0,n.sheetIndex)(this.document,d))}return new e(this.document,this.stringCompareCI,s,void 0,this.globalNames)},e.prototype.getNameLoc=function(e,t,r){var n=this.getNamesBySheetId(e);if(n.kind===a.ResultKind.Failure)return n;var i=n.value.getNameLoc(t,r);return i.kind,a.ResultKind.Failure,i},e.prototype.getAvailableNamesInScope=function(e){var t=this.getAllDocumentNames(),r=this.getNamesBySheetId(e);return r.kind===a.ResultKind.Success&&(0,i.safePush)(t,r.value.getAvailableNames((0,n.nameScope)(this.document,e))),t},e.prototype.getAllDocumentNames=function(){return this.globalNames.getAvailableNames((0,n.documentScope)(this.document))},e.prototype.getAvailableTableColumns=function(e){var t=this.getNameFormula(e,n.NameSource.StructRef),r=[];if(t.kind!==a.ResultKind.Success||void 0===t.value||"NamedTable"!==t.value.obj.kind)return{cols:r,isPartial:!0};var i=!t.value.obj.allColumnNamesAvailable;return t.value.obj.columnNames.forEach((function(e){return r.push(e),!0})),{cols:r,isPartial:i}},e.prototype.getNameFormula=function(e,t){var r=this.getNamesBySheetId(e.scope.index);return r.kind===a.ResultKind.Failure?r:r.value.getNameFormula(e.name,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNamesBySheetId(e.scope.index);return t.kind===a.ResultKind.Failure?t:(0,a.success)(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNamesBySheetId(e.scope.index);return t.kind===a.ResultKind.Failure?t:(0,a.success)(t.value.setRecalcFailure(e.name))},e.prototype.getNamesBySheetId=function(e){if(void 0===e)return(0,a.success)(this.globalNames);if(!this.sheetScopedNames)return(0,a.failure)((0,s.unavailable)([{kind:p.UnavailableKind.SheetNames}]));var t=this.sheetScopedNames[e];return void 0===t?(0,a.failure)((0,s.unavailable)([{kind:p.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,a.success)(t)},e.prototype.getContainingTable=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===a.ResultKind.Failure?t:(0,a.success)(t.value.getContainingTable(e.range))},e.prototype.getNamedRanges=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===a.ResultKind.Failure?t:(0,a.success)(t.value.getNamedRanges(e.range))},e.prototype.getIntersectingTables=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===a.ResultKind.Failure?t:(0,a.success)(t.value.getIntersectingTables(e.range))},e.prototype.getStructRefColumn=function(e,t){var r=this.getNameFormula(e,n.NameSource.StructRef);if(r.kind===a.ResultKind.Failure)return r;if(void 0===r.value)return(0,a.success)(void 0);if("NamedTable"!==r.value.obj.kind)return(0,a.failure)((0,c.invalidStructRef)(c.InvalidStructRefReason.NamedObjectNotTable));var i,u=r.value.obj;if("string"==typeof t)i=u.columnNames.getEntry(t);else{var l=u.columnIndexes.getValue(t);i=void 0===l?void 0:(0,d.entry)(l,t)}if(void 0===i)return u.allColumnNamesAvailable?(0,a.success)(void 0):(0,a.failure)((0,s.unavailable)([{kind:p.UnavailableKind.ColumnName,table:e,columnNameOrIndex:t}]));var m=u.specialRefRanges[o.SpecialRefId.Data],f=m.sheet,g=m.range,h=(0,n.sheetGridRange)(f,(0,n.gridRange)(g.row,i.value,g.rows,1));return(0,a.success)((0,n.structRefColumnLoc)(i.key,h,u.hasHeadersRow,u.hasTotalsRow))},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getNameFormula(e,n.NameSource.StructRef);return r.kind===a.ResultKind.Failure?r:void 0===r.value?(0,a.success)(void 0):"NamedTable"!==r.value.obj.kind?(0,a.failure)((0,c.invalidStructRef)(c.InvalidStructRefReason.NamedObjectNotTable)):(0,a.success)(r.value.obj.specialRefRanges[t])},e.prototype.onCellModified=function(e){this.forEachSheetScope((function(t){t.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheetScope((function(t){t.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheetScope((function(t){t.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0},e.prototype.resetLazyData=function(){this.forEachSheetScope((function(e){e.resetLazyData()})),this.globalNames.resetLazyData()},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheetScope((function(t){return e=(0,l.mergeNameStatistics)(e,t.getStatistics())})),e},e.prototype.forEachSheetScope=function(e){for(var t in this.sheetScopedNames){if(Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t))e(this.sheetScopedNames[t])}},e}();t.PartialWorkbookNameManager=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(1);t.floorToPowerOf2=n.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=n.arrayMapTree.ArrayMapTree,t.RootPointer=n.arrayMapTree.RootPointer,t.enumerateInOrder=n.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=n.arrayMapTree.enumerateKeysInOrder},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookSheets=void 0;var n=r(0),i=r(294),a=r(2),o=r(15),s=r(5),u=r(11),l=r(20),c=function(){function e(e,t,r,n,i,a){this.document=e,this.stringCompareCI=t,this.sheetPosToId=r,this.sheetNameToId=n,this.data=i,this.oldData=a}return e.prototype.clone=function(){return new e(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)},e.prototype.setSheetNames=function(t){for(var r,s=null!==(r=this.data)&&void 0!==r?r:this.oldData,u=(0,a.makeStringMap)(),l=[],c=[],d=0;d<t.length;d+=1){var p=t[d],m=p.sheetName,f=p.sheetId;l[d]=f,c.push([m,f]);var g=null==s?void 0:s[f];if(void 0===g){var h=(0,o.sheetIndex)(this.document,f);u[f]={pos:d,name:m,sheetIndex:h}}else u[f]=n.__assign(n.__assign({},g),{pos:d,name:m})}var v=i.ArrayMapTree.create(this.stringCompareCI).setValues(c);return new e(this.document,this.stringCompareCI,l,v,u,void 0)},e.prototype.advanceState=function(e){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0},e.prototype.getSheetRangeIds=function(e){var t,r;if(!this.sheetPosToId)return(0,s.failure)((0,u.unavailable)([{kind:l.UnavailableKind.SheetNames}]));if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{var n=this.getSheetById(e.index);if(!(0,s.isSuccess)(n))return n;var i=this.getSheetById(e.index2);if(!(0,s.isSuccess)(i))return i;t=(0,a.fastMin)(n.value.pos,i.value.pos),r=(0,a.fastMax)(n.value.pos,i.value.pos)+1}for(var c=[],d=t;d<r;d+=1)c.push(this.sheetPosToId[d]);return(0,s.success)((0,o.sheetRangeIndexes)(c,t))},e.prototype.getSheetById=function(e){if(!this.data)return(0,s.failure)((0,u.unavailable)([{kind:l.UnavailableKind.SheetNames}]));var t=this.data[e];return void 0===t?(0,s.failure)((0,u.unavailable)([{kind:l.UnavailableKind.SheetId,document:this.document,sheetId:e}])):(0,s.success)(t)},e.prototype.getSheetByName=function(e){if(!this.sheetNameToId)return(0,s.failure)((0,u.unavailable)([{kind:l.UnavailableKind.SheetNames}]));var t=this.sheetNameToId.getValue(e);return void 0===t?(0,s.success)(void 0):this.getSheetById(t)},e.prototype.forEachSheet=function(e){if(this.sheetPosToId&&this.data)for(var t=0,r=this.sheetPosToId;t<r.length;t++){var n=r[t],i=this.data[n];i&&e(i,n)}},e}();t.PartialWorkbookSheets=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=void 0;var n=r(55);t.getWorksheetFunc=n.getWorksheetFuncModule.getWorksheetFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookStyles=t.blankStyleValue=void 0;var n=r(5),i=r(298),a=r(20),o={type:i.BorderLineType.None,color:{argb:"00000000"}};t.blankStyleValue={font:{name:"Calibri",bold:!1,italic:!1,underline:i.FontUnderline.None,strikethrough:!1,verticalAlign:i.FontVerticalAlignment.None,size:11,color:{argb:"ff000000"}},fill:{kind:i.FillKind.Pattern,pattern:i.PatternType.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:o,bottom:o,left:o,right:o},alignment:{horizontal:i.HorizontalAlignment.Automatic,vertical:i.VerticalAlignment.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}};var s=function(){function e(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}return e.prototype.clone=function(){function t(e,t){Object.keys(e).map(Number).forEach((function(r){t[r]=e[r]}))}var r=new e;return t(this.styles,r.styles),t(this.fonts,r.fonts),t(this.fills,r.fills),t(this.borders,r.borders),r},e.prototype.resolveCellStyle=function(e){if(e===a.SpecialStyle.Blank)return(0,n.success)(t.blankStyleValue);var r=this.styles[e];if(void 0===r)return(0,n.failure)({kind:a.UnavailableKind.StyleId,styleId:e});var i=r.fontId,o=r.fillId,s=r.borderId,u=r.alignment,l=void 0!==i?this.fonts[i]:t.blankStyleValue.font;if(void 0===l)return(0,n.failure)({kind:a.UnavailableKind.FontId,fontId:i});var c=void 0!==o?this.fills[o]:t.blankStyleValue.fill;if(void 0===c)return(0,n.failure)({kind:a.UnavailableKind.FillId,fillId:o});var d=void 0!==s?this.borders[s]:t.blankStyleValue.border;return void 0===d?(0,n.failure)({kind:a.UnavailableKind.BorderId,borderId:s}):(0,n.success)({font:l,fill:c,border:d,alignment:u})},e.prototype.setStyles=function(e,t){var r=this;t||(this.styles=[]),Object.keys(e).map(Number).forEach((function(t){r.styles[t]=e[t]}))},e.prototype.setFonts=function(e,t){var r=this;t||(this.fonts=[]),Object.keys(e).map(Number).forEach((function(t){r.fonts[t]=e[t]}))},e.prototype.setFills=function(e,t){var r=this;t||(this.fills=[]),Object.keys(e).map(Number).forEach((function(t){r.fills[t]=e[t]}))},e.prototype.setBorders=function(e,t){var r=this;t||(this.borders=[]),Object.keys(e).map(Number).forEach((function(t){r.borders[t]=e[t]}))},e}();t.PartialWorkbookStyles=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.PatternType=t.HorizontalAlignment=t.FontVerticalAlignment=t.FontUnderline=t.FillKind=t.BorderLineType=void 0;var n=r(3);t.BorderLineType=n.styleServiceTypes.BorderLineType,t.FillKind=n.styleServiceTypes.FillKind,t.FontUnderline=n.styleServiceTypes.FontUnderline,t.FontVerticalAlignment=n.styleServiceTypes.FontVerticalAlignment,t.HorizontalAlignment=n.styleServiceTypes.HorizontalAlignment,t.PatternType=n.styleServiceTypes.PatternType,t.VerticalAlignment=n.styleServiceTypes.VerticalAlignment},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelUtils=void 0;var n=r(198),i=function(){function e(){}return e.column_name_to_index=function(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,r=0,n=e.split("");r<n.length;r++){t*=26,t+=n[r].charCodeAt(0)-"A".charCodeAt(0)+1}return t},e.column_index_to_name=function(e){for(var t="";e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(t,r,i){(0,n.watchdog)("wd0x1a9bd3");var a;if(a=e.cell_both_absolute.exec(t)){var o=e.column_name_to_index(a[1]),s=Number(a[2]);return a[2][0]>=""&&(s=Number(a[2].charCodeAt(0)-16384)),[o,s,0]}if((0,n.watchdog)("wd0xa26bda"),a=e.cell_col_absolute.exec(t)){o=e.column_name_to_index(a[1]),s=Number(a[2]);return a[2][0]>=""&&(s=Number(a[2].charCodeAt(0)-16384)),[o,s-i,0]}if((0,n.watchdog)("wd0x2a23e1"),a=e.cell_row_absolute.exec(t)){o=e.column_name_to_index(a[1]),s=Number(a[2]);return a[2][0]>=""&&(s=Number(a[2].charCodeAt(0)-16384)),[o-r,s,0]}if((0,n.watchdog)("wd0x3ebc91"),a=e.cell_both_relative.exec(t)){o=e.column_name_to_index(a[1]),s=Number(a[2]);return a[2][0]>=""&&(s=Number(a[2].charCodeAt(0)-16384)),[o-r,s-i,0]}throw new Error("We should never get here.")},e.toR1C1=function(t,r,n){void 0===n&&(n=!1);var i=e.cell_dependency(t,0,0),a=e.cell_dependency(r,0,0),o="R",s="C";n&&(o="",s="");var u=[];a.forEach((function(e,t,r){u.push(e-i[t])}));var l="";return e.cell_both_absolute.exec(r)?l=o+a[1]+s+a[0]:e.cell_col_absolute.exec(r)?(0===u[1]?l+=o:l+=o+"["+u[1]+"]",l+=s+a[0]):e.cell_row_absolute.exec(r)?(0===u[0]?l+=s:l+=s+"["+u[0]+"]",l=o+a[1]+l):(0===u[1]?l+=o:l+=o+"["+u[1]+"]",0===u[0]?l+=s:l+=s+"["+u[0]+"]"),l},e.formulaToR1C1=function(t,r,n){for(var i,a=t.slice(),o=e.column_index_to_name(r)+n;i=e.range_pair.exec(a);)if(i){var s=i[1];i[2];a=a.replace(i[0],e.toR1C1(o,i[1],!0)+":"+e.toR1C1(o,i[2],!0))}for(var u=null;u=e.single_dep.exec(a);)if(u){s=u[1];a=a.replace(u[0],e.toR1C1(o,s,!0))}return a=(a=a.replace(//g,"R")).replace(//g,"C")},e.extract_sheet_cell=function(t){(0,n.watchdog)("wd0x012630");var r=e.sheet_plus_cell.exec(t);return r?[r[1],r[2],r[2]]:["","",""]},e.all_cell_dependencies=function(t,r,i,a){void 0===a&&(a=!0),(0,n.watchdog)("wd0x2f82fe");var o=null,s=[];if("string"!=typeof t)return null;for(t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");o=e.range_pair.exec(t);)if((0,n.watchdog)("wd0x784918"),o){for(var u=o[1],l=e.cell_dependency(u,r,i),c=o[2],d=e.cell_dependency(c,r,i),p=d[0]-l[0]+1,m=d[1]-l[1]+1,f=0;f<p;f++)for(var g=0;g<m;g++)s.push([f+l[0],g+l[1],0]);t=t.replace(o[0],"_")}for(var h=null;h=e.single_dep.exec(t);)if((0,n.watchdog)("wd0x0fb232"),h){u=h[1];var v=e.cell_dependency(u,r,i);s.push(v),t=t.replace(h[0],"_")}if(a)for(var S=null;S=e.number_dep.exec(t);)(0,n.watchdog)("wd0xd82ed1"),S&&(s.push([0,0,1]),t=t.replace(S[0],"_"));return s},e.numeric_constants=function(t){var r=[];if("string"!=typeof(t=t.slice()))return r;t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(t);)n&&(t=t.replace(n[0],"_"));for(var i=null;i=e.single_dep.exec(t);)i&&(t=t.replace(i[0],"_"));for(var a=null;a=e.number_dep.exec(t);)a&&(r.push(parseFloat(a)),t=t.replace(a[0],"_"));return r},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(t,r,i,a,o){(0,n.watchdog)("wd0x961028");var s=[];if(t>=o.length||r>=o[0].length||t<0||r<0)return[];var u=o[t][r];return u.length>1&&"="===u[0]&&(s=e.all_cell_dependencies(u,a,i)),s},e.generate_all_references=function(t,r,i){(0,n.watchdog)("wd0x6a6002");for(var a={},o=0;o<t.length;o++)for(var s=t[o],u=0;u<s.length;u++){(0,n.watchdog)("wd0x93d412");var l=s[u];if("="===l[0])for(var c=0,d=e.all_cell_dependencies(l,0,0);c<d.length;c++){var p=d[c];if((0,n.watchdog)("wd0x8a466e"),0===p[0]&&0===p[1]&&0!==p[2]);else{var m=p[0]-r-1,f=p[1]-i-1,g=!1;if(f>=t.length||m>=t[0].length||m<0||f<0)g=!0;else{var h=t[f][m];void 0!==h&&"="!==h[0]&&(g=!0)}g&&(a[p.join(",")]=!0)}}}return a},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}();t.ExcelUtils=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnitExperiment=void 0;var n=r(0),i=r(4),a=r(15),o=r(36),s=r(9),u=r(105),l=r(160),c=r(200),d=r(201),p=r(301),m=r(302),f=r(302),g=r(196),h=r(35),v=r(92),S=r(5),y=r(51),F=r(21),C=r(154),R=r(11),b=r(30),E=r(39),P=function(){function e(){this.isDone=!1,this.lastStepMessage="before started"}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!1,configurable:!0}),e.prototype.freshCheckingState=function(e){var t=this;this.lastStepMessage="freshCheckingState";var r=[],i={};e.getServerAvailableCells().forEach((function(a){var o,s=e.getServerUsedRange(a.sheetIdx);if(s.kind!==S.ResultKind.Success)return t.isDone=!0,void(t.statsMessage="Unit experiment: getServerUsedRange failed");var u=n.__assign(n.__assign({},a),{usedRange:null===(o=s.value)||void 0===o?void 0:o.range});i[a.sheetIdx.index]=u,r.push(u)}));var a=void 0===e.getServerDocument()?function(){return(0,S.failure)(void 0)}:function(t){return e.getIformat(e.getServerDocument(),t)};return{kind:p.ExperimentState.Checking,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:(0,l.createResolver)(e),documentTypeContext:{formats:function(t){return e.getServerFormat(t)},types:{},available:i,getIformat:a,isStringValue:function(t){if(void 0===e.getServerDocument())return!1;var r=e.getServerValue(t);return r.kind===S.ResultKind.Success&&r.value.oper.kind===y.OperKind.String}},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:r,mutableState:{symbolContext:k.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(e){return this.lastStepMessage="freshSolvingState",{kind:p.ExperimentState.SolvingSimple,stats:e.stats,context:(0,f.makeSolverContext)(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,(0,i.assertNever)("".concat(d.Messages.Root,".").concat(d.Messages.Initialised),this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{var e=this.state;switch(e.kind){case p.ExperimentState.Checking:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case p.ExperimentState.SolvingSimple:return this.lastStepMessage="SolvingSimple",void(this.state=(0,f.runSolverStep)(e));case p.ExperimentState.SolvingFull:return e.constraintCursor<e.constraints.length?(this.lastStepMessage="SolvingFull",void(this.state=(0,f.runSolverStep)(e))):(this.lastStepMessage="done SolvingFull",this.isDone=!0,void(this.statsMessage=this.statsForLogging(e.stats)))}}catch(e){return this.statsMessage="".concat(d.Messages.Root,".").concat(d.Messages.Failure,": ").concat((0,h.messageFromError)(e)),void(this.isDone=!0)}}},e.prototype.setContext=function(e){var t=e.documents;this.documentContext=t},e.prototype.initialiseSheetStep=function(e){this.lastStepMessage="initialiseSheetStep";var t=e.mutableState,r=e.sheets[t.sheetCursor],n=r.usedRange,i=[];if(void 0!==n){var a=(0,E.intersectProduct)(r.availableCells,b.availableReadProduct);(0,b.forEachRangeInSet)(a,(function(e){var t=(0,R.gridRangeIsect)(e,n);if(void 0!==t){if((0,R.gridRangeSize)(t)<250)return i.push(t),!0;(0,R.forEachTileInRange)(t,15,(function(e){return i.push(e),!0}))}return!0}))}return t.ranges=i,t.rangeCursor=0,e.documentTypeContext.types[r.sheetIdx.index]=(0,v.makeGridRangeTable)(),e},e.prototype.initialiseRangeCells=function(e,t){this.lastStepMessage="initialiseRangeCells";var r=t.mutableState,n=t.stats,i=t.sheets,o=r.sheetCursor,s=[],u=i[o],l=r.ranges[r.rangeCursor];return e.forEachServerNonBlankCellInSet(u.sheetIdx,(0,b.createCellSetFromRange)(l),(function(r){var i,o=(0,a.sheetGridCell)(u.sheetIdx,r),l=e.getServerFormula(o);l.kind===S.ResultKind.Success&&void 0!==(null===(i=l.value)||void 0===i?void 0:i[1].compiledFmla)&&(s.push(l.value[1]),n.formulaCells+=1);var c=e.getServerFormat(o);return c.kind===S.ResultKind.Success&&(0,f.isInterestingFormat)(t.documentTypeContext,c.value)&&(0,f.updateFormatStatsFromCellFormat)(t.documentTypeContext,c.value,n,!1),n.totalCells+=1,!0})),r.cells=s,r.cellCursor=0,t},e.prototype.checkCell=function(e,t){this.lastStepMessage="checkCell";var r=t.sheets,n=t.constraints,o=t.stats,s=t.mutableState,u=s.cells,l=s.sheetCursor,c=s.cellCursor,m=r[l],g=u[c],h=g.compiledFmla.getValue();if(h.kind===S.ResultKind.Success){var v=(0,a.sheetGridCell)(m.sheetIdx,g.origin),y=function(e,t,r){var n=e.constraints,a=e.locale,o=e.mathpack,s=e.resolver,u=e.documentTypeContext,l=u.types[t.sheet.index],c=e.mutableState.symbolContext.copy(),m={origin:t,locale:a,mathpack:o,resolver:s,symbolContext:c,pushConstraint:function(e){return void 0!==e&&(n.push(e),!0)}},g=function(e,t){return(0,F.reducePledge)(new M(e),t)}(m,r),h=_(m,g),v=function e(t,r){switch(r.kind){case p.TypeKind.Scalar:if(void 0===r.unit){var n=t.symbolContext.freshSymbol();return(0,p.makePrimitiveType)(r.flags,n.unit)}return r;case p.TypeKind.Array:for(var a=r,o=[];a.kind===p.TypeKind.Array;)o.push(a.dimensions),a=a.elementType;var s=e(t,a);return o.reduceRight(p.makeArrayType,s);case p.TypeKind.Reference:case p.TypeKind.Union:return r;default:return(0,i.assertNever)(d.Messages.Root,r)}}(m,void 0===h?p.topType:h);if(v.kind===p.TypeKind.Reference){var S=c.freshSymbol(),y={kind:f.ConstraintKind.RangeEquality,type:v,target:S};v=(0,p.primitiveUnitType)(S.unit),n.push(y)}if(e.mutableState.symbolContext=c,v.kind===p.TypeKind.Array)return l;return l.setValue(t.range,v)}(t,v,h.value);t.documentTypeContext.types[m.sheetIdx.index]=y;var C=e.getServerFormat(v);C.kind===S.ResultKind.Success&&(0,f.isInterestingFormat)(t.documentTypeContext,C.value)&&(n.push({kind:f.ConstraintKind.FormatEquality,cell:v,format:C.value}),(0,f.updateFormatStatsFromCellFormat)(t.documentTypeContext,C.value,o,!0))}return t.mutableState.cellCursor+=1,t},e.prototype.runCheckStep=function(e,t){if(!function(e){return void 0!==e.mutableState.ranges}(t))return this.initialiseSheetStep(t);var r=t.mutableState;return r.rangeCursor===r.ranges.length?(r.ranges=void 0,r.sheetCursor+=1,t):function(e){return void 0!==e.mutableState.cells}(t)?r.cellCursor<t.mutableState.cells.length?this.checkCell(e,t):(r.cells=void 0,r.rangeCursor+=1,t):this.initialiseRangeCells(e,t)},e.prototype.statsForLogging=function(e){return JSON.stringify(e)},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var e;return null!==(e=this.statsMessage)&&void 0!==e?e:"".concat(d.Messages.Root,".").concat(d.Messages.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){var e,t,r,n,i,a=null===(e=this.state)||void 0===e?void 0:e.kind,o=(null===(t=this.state)||void 0===t?void 0:t.kind)===p.ExperimentState.Checking&&0===(null===(r=this.state)||void 0===r?void 0:r.mutableState.cellCursor);return"Units experiment timed out. Last step: ".concat(this.lastStepMessage,". Experiment state: ").concat(void 0!==a?p.ExperimentState[a]:"NotStarted",". isCellCursorZero: ").concat(o,". Number of constraints: ").concat(null===(n=this.state)||void 0===n?void 0:n.constraints.length,". Stats: ").concat(this.statsForLogging(null===(i=this.state)||void 0===i?void 0:i.stats))},enumerable:!1,configurable:!0}),e}();t.UnitExperiment=P;var k=function(){function e(e,t){this.seed=e,this.table=t}return e.init=function(){return new e(0,g.RedBlackMapTree.create((function(e,t){return e.localeCompare(t)})))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(e){var t="".concat(void 0===e?"gen":e,"@").concat(this.seed+=1),r={unit:(0,c.fromVar)(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function T(e,t,r){switch(e.kind){case p.TypeKind.Array:if(e.elementType.kind===p.TypeKind.Reference)return;return r?T(e.elementType,t,!1):void 0;case p.TypeKind.Reference:return{kind:f.ConstraintKind.RangeEquality,type:e,target:t};case p.TypeKind.Scalar:return void 0===e.unit?void 0:{kind:f.ConstraintKind.UnitEquality,unit:e.unit,target:t};case p.TypeKind.Union:return;default:return(0,i.assertNever)(d.Messages.Root,e)}}function A(e,t,r){switch(t.kind){case p.TypeKind.Array:if(t.elementType.kind===p.TypeKind.Reference)return;return r?A(e,t.elementType,!1):void 0;case p.TypeKind.Reference:var n=e.symbolContext.freshSymbol(),a={kind:f.ConstraintKind.RangeEquality,type:t,target:n};return[n.unit,a];case p.TypeKind.Scalar:return void 0===t.unit?void 0:[t.unit,void 0];case p.TypeKind.Union:return;default:return(0,i.assertNever)(d.Messages.Root,t)}}function N(e){var t=e.length;if(0===t)return p.topType;for(var r,n,i=p.bottomType,a=e[0].length,o=0;o<e.length;o+=1)for(var s=e[o],u=0;u<s.length;u+=1)r=i,n=s[u],i=r===p.bottomType?n:n===p.bottomType||r===p.topType?r:n===p.topType?n:r.kind===p.TypeKind.Scalar&&n.kind===p.TypeKind.Scalar&&void 0===r.unit&&void 0===n.unit?(0,p.makePrimitiveType)(r.flags|n.flags):p.topType;return(0,p.makeArrayType)(i,{rows:t,columns:a,exact:!0})}function _(e,t){if(t.kind===p.TypeKind.Reference&&!(0,p.isResolvedReferenceType)(t)){var r=function(e,t){var r=(0,u.resolveLocalsGrid)(e.origin),n=e.resolver.resolveCellRef(r,t.reference).resolution;return!!(0,S.isSuccess)(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?(0,p.makeResolvedReferenceType)(t.reference,r):r?p.errorType:void 0}if(t.kind===p.TypeKind.Array){var n=_(e,t.elementType);return void 0===n?n:n===t.elementType?t:(0,p.makeArrayType)(n,t.dimensions)}return t}function I(e,t,r,n,i){var a=e.symbolContext.freshSymbol(),o=T(t,a,n),s=T(r,a,n);if(void 0!==o&&void 0!==s||i&&(void 0!==o||void 0!==s))return e.pushConstraint(o),e.pushConstraint(s),a}function O(e,t,r){switch(t){case o.OperatorId.Add:case o.OperatorId.Sub:case o.OperatorId.Mul:case o.OperatorId.Div:case o.OperatorId.Pow:case o.OperatorId.Eq:case o.OperatorId.Ne:case o.OperatorId.Lt:case o.OperatorId.Le:case o.OperatorId.Gt:case o.OperatorId.Ge:case o.OperatorId.Range:case o.OperatorId.Isect:case o.OperatorId.Union:case o.OperatorId.Concat:case o.OperatorId.And:case o.OperatorId.Or:case o.OperatorId.Xor:case o.OperatorId.Min:case o.OperatorId.Max:return function(e,t,r){if(r.length<2)return p.topType;var n=_(e,r[0][0]),a=_(e,r[1][0]);if(void 0===n||void 0===a)return p.topType;var s=(0,p.getLiftingDimensionsFromTypes)(n,a);if(!1===s)return p.topType;var u="object"==typeof s;switch(t){case o.OperatorId.Add:case o.OperatorId.Sub:case o.OperatorId.Min:case o.OperatorId.Max:var l=I(e,n,a,u,!0);return(0,p.typeFromDimensions)(void 0===l?p.numberType:(0,p.makePrimitiveType)(y.OperKind.Number,l.unit),s);case o.OperatorId.Eq:case o.OperatorId.Ne:case o.OperatorId.Lt:case o.OperatorId.Le:case o.OperatorId.Gt:case o.OperatorId.Ge:return I(e,n,a,u,!1),(0,p.typeFromDimensions)(p.boolType,s);case o.OperatorId.Mul:case o.OperatorId.Div:if(m.UnitExperimentSettings.IgnoreDivMul)return p.numberType;var f=e.symbolContext.freshSymbol(),g=e.symbolContext.freshSymbol(),v=T(n,f,u),S=T(a,g,u);if(e.pushConstraint(v),e.pushConstraint(S),void 0===v&&void 0===S)return(0,p.typeFromDimensions)(p.numberType,s);var F=t===o.OperatorId.Mul?(0,c.prod)(f.unit,g.unit):(0,c.prod)(f.unit,(0,c.inv)(g.unit));return(0,p.typeFromDimensions)((0,p.makePrimitiveType)(y.OperKind.Number,F),s);case o.OperatorId.Pow:var C=r[1][1];if((0,R.isNumberLiteralNode)(C)){var b=e.mathpack.toNumber(C.oper);if((0,h.isInteger)(b)){var E=A(e,n,"object"==typeof s);return void 0===E?(0,p.typeFromDimensions)(p.numberType,s):(e.pushConstraint(E[1]),(0,p.typeFromDimensions)((0,p.makePrimitiveType)(y.OperKind.Number,(0,c.pow)(E[0],b,p.dimensionLess)),s))}}return p.topType;case o.OperatorId.Range:case o.OperatorId.Isect:case o.OperatorId.Union:return p.topType;case o.OperatorId.Concat:return(0,p.typeFromDimensions)(p.stringType,s);case o.OperatorId.And:case o.OperatorId.Or:case o.OperatorId.Xor:return(0,p.typeFromDimensions)(p.boolType,s);default:return(0,i.assertNever)(d.Messages.Root,t)}}(e,t,r);case o.OperatorId.Percent:case o.OperatorId.Neg:case o.OperatorId.Pos:case o.OperatorId.At:case o.OperatorId.Pound:return function(e,t,r){if(r.length<1)return p.topType;var n=_(e,r[0][0]);if(void 0===n)return p.topType;var a=(0,p.dimensionsFromType)(n);if(!1===a)return p.topType;switch(t){case o.OperatorId.Percent:return(0,p.typeFromDimensions)(p.dimensionlessNumberType,a);case o.OperatorId.Neg:case o.OperatorId.Pos:var s=A(e,n,"object"==typeof a);return void 0===s?(0,p.typeFromDimensions)(p.numberType,a):(e.pushConstraint(s[1]),(0,p.typeFromDimensions)((0,p.makePrimitiveType)(y.OperKind.Number,s[0]),a));case o.OperatorId.At:case o.OperatorId.Pound:return p.topType;default:return(0,i.assertNever)(d.Messages.Root,t)}}(e,t,r);default:return(0,i.assertNever)(d.Messages.Root,t)}}var M=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return(0,F.visitFormulaNode)(t,e)},this.lazyVisitFormulaNode=function(e){return C.Pledge.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){return C.Pledge.resolve(function(e){switch(e.kind){case y.OperKind.Number:return p.numberType;case y.OperKind.String:return p.stringType;case y.OperKind.Boolean:return p.boolType;case y.OperKind.Error:return p.errorType;default:return p.oneType}}(e))},e.prototype.arrayNode=function(e){var t=this;return C.Pledge.all(e.map((function(e){return C.Pledge.all(e.map(t.lazyVisitFormulaNode))}))).bind(N)},e.prototype.appNode=function(e,t){var r=this;return e.kind===s.NodeKind.Operator?C.Pledge.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return O(r.context,e.id,t)})):e.kind===s.NodeKind.WSF?C.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return function(e,t,r){switch(t){case o.WorksheetFuncId.SUM:case o.WorksheetFuncId.AVERAGE:case o.WorksheetFuncId.MAX:case o.WorksheetFuncId.MIN:if(0===r.length)return p.topType;var n=e.symbolContext.freshSymbol(),i=!0;return r.forEach((function(t){var r=_(e,t);r&&e.pushConstraint(T(r,n,!0))&&(i=!1)})),i?p.numberType:(0,p.makePrimitiveType)(y.OperKind.Number,n.unit);case o.WorksheetFuncId.IF:if(r.length<2)return p.topType;var a=_(e,r[0]),s=_(e,r[1]),u=_(e,void 0===r[2]?p.boolType:r[2]);if(void 0===a)return void 0!==s&&void 0!==u&&I(e,s,u,!0,!1),p.topType;var l=(0,p.dimensionsFromType)(a),c="object"==typeof l;if(void 0===s||void 0===u)return p.topType;var d=I(e,s,u,!0,!0),m=d?(0,p.primitiveUnitType)(d.unit):p.primitiveType;return c?(0,p.makeArrayType)(m,l):m;default:return p.topType}}(r.context,e.id,t)})):C.Pledge.resolve(p.topType)},e.prototype.letNode=function(e,t,r,n){return C.Pledge.resolve(p.topType)},e.prototype.lambdaNode=function(e,t,r,n){return C.Pledge.resolve(p.topType)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return C.Pledge.resolve(p.topType)},e.prototype.cellRefNode=function(e,t){return C.Pledge.resolve((0,p.makeReferenceType)((0,s.cellRefNode)(e,t)))},e.prototype.fieldRefNode=function(e,t){return C.Pledge.resolve(p.topType)},e.prototype.structRefNode=function(e,t){return C.Pledge.resolve(p.topType)},e.prototype.missingNode=function(e){return C.Pledge.resolve(p.topType)},e.prototype.badSequenceNode=function(e,t){return C.Pledge.resolve(p.topType)},e.prototype.badCharsNode=function(e,t){return C.Pledge.resolve(p.topType)},e.prototype.operatorNode=function(e,t){return C.Pledge.resolve((0,s.operatorNode)(e,t))},e.prototype.wsfNode=function(e,t,r){return C.Pledge.resolve((0,s.wsfNode)(e,t,r))},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentState=t.isResolvedReferenceType=t.primitiveUnitType=t.primitiveType=t.topType=t.bottomType=t.oneType=t.errorType=t.dimensionlessNumberType=t.dimensionLess=t.numberType=t.stringType=t.boolType=t.typeFromDimensions=t.joinDimensions=t.getLiftingDimensionsFromTypes=t.dimensionsFromType=t.makeArrayType=t.makeResolvedReferenceType=t.makeReferenceType=t.makePrimitiveType=t.TypeKind=void 0;var n,i=r(0),a=r(11),o=r(200),s=r(51);function u(e,t){return void 0===t&&(t=void 0),{kind:n.Scalar,flags:e,unit:t}}function l(e){return{kind:n.Reference,reference:e,resolution:void 0}}function c(e,t){return{kind:n.Array,elementType:e,dimensions:t}}function d(e){return{kind:n.Union,flags:e}}function p(e){var t;switch(e.kind){case n.Reference:var r=null===(t=e.resolution)||void 0===t?void 0:t.range;return void 0!==r&&(!!(0,a.isGridCell)(r)||{rows:r.rows,columns:r.cols,exact:!0});case n.Array:return e.dimensions;case n.Scalar:return!0;case n.Union:return!1}}function m(e,t){return"object"==typeof e?"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:i.__assign(i.__assign({},e),{exact:e.exact&&t}):"object"==typeof t?i.__assign(i.__assign({},t),{exact:t.exact&&e}):e&&t}!function(e){e[e.Scalar=0]="Scalar",e[e.Reference=1]="Reference",e[e.Array=2]="Array",e[e.Union=3]="Union"}(n||(t.TypeKind=n={})),t.makePrimitiveType=u,t.makeReferenceType=l,t.makeResolvedReferenceType=function(e,t){var r=l(e);return r.resolution=t,r},t.makeArrayType=c,t.dimensionsFromType=p,t.getLiftingDimensionsFromTypes=function(e,t){return m(p(e),p(t))},t.joinDimensions=m,t.typeFromDimensions=function(e,t){return!0===t?e:c(e,t)},t.boolType=u(s.OperKind.Boolean),t.stringType=u(s.OperKind.String),t.numberType=u(s.OperKind.Number),t.dimensionLess=(0,o.fromConstants)({}),t.dimensionlessNumberType=u(s.OperKind.Number,t.dimensionLess),t.errorType=u(s.OperKind.Error),t.oneType=u(s.OperKind.Missing|s.OperKind.Blank),t.bottomType=d(s.SignatureType.None),t.topType=d(s.SignatureType.All),t.primitiveType=u(s.OperKind.Number|s.OperKind.Boolean|s.OperKind.String);var f;t.primitiveUnitType=function(e){return u(s.OperKind.Number|s.OperKind.Boolean|s.OperKind.String,e)},t.isResolvedReferenceType=function(e){return void 0!==e.resolution},function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"}(f||(t.ExperimentState=f={}))},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.runSolverStep=t.numberFormatFromCellFormat=t.valueTypeFromCellFormat=t.updateFormatStatsFromCellFormat=t.isInterestingFormat=t.makeSolverContext=t.ConstraintKind=t.UnitExperimentSettings=void 0;var i,a,o=r(301),s=r(200),u=r(201),l=r(474),c=r(15),d=r(11),p=r(4),m=r(30),f=r(20),g=r(39),h=r(23),v=r(5),S=r(22);t.UnitExperimentSettings={get UnitlessTimeAndDate(){return(0,S.getTypedFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate")},get IgnoreDivMul(){return(0,S.getTypedFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul")}},function(e){e[e.RangeEquality=0]="RangeEquality",e[e.StagedRangeEquality=1]="StagedRangeEquality",e[e.UnitEquality=2]="UnitEquality",e[e.FormatEquality=3]="FormatEquality"}(i||(t.ConstraintKind=i={})),function(e){e[e.Solved=0]="Solved",e[e.Failed=1]="Failed",e[e.Deferred=2]="Deferred",e[e.Staged=3]="Staged"}(a||(a={}));var y={kind:a.Solved},F=function(e){return{kind:a.Deferred,constraint:e}},C=(0,s.fromConstants)({error:1}),R=(0,s.fromConstants)({}),b=(0,s.fromConstants)({currency:1}),E=(0,s.fromConstants)({date:1}),P=(0,s.fromConstants)({time:1});function k(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function T(e,t,r,n){return(0,p.assertTrue)(u.Messages.Root,0===r.varCount),e.uf.union(void 0===n?e.uf.makePoint(r):n,t,!0),y}function A(e,t,r,n,i){return t===e.errorUnit?((0,p.assertTrue)(u.Messages.Root,r===e.errorPoint),void 0!==i&&e.uf.union(e.errorPoint,i,!0),y):n===e.errorUnit?((0,p.assertTrue)(u.Messages.Root,i===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),y):0===t.varCount?0===n.varCount?(0,s.areSignaturesEqual)(t,n)?y:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==i&&e.uf.union(e.errorPoint,i,!0),o=[t,n],{kind:a.Failed,error:o}):((0,p.assertTrue)(u.Messages.Root,void 0!==i),T(e,i,t,r)):1===n.varCount?((0,p.assertTrue)(u.Messages.Root,void 0!==r),(0,p.assertTrue)(u.Messages.Root,void 0!==i),e.uf.union(r,i),y):((0,p.assertTrue)(u.Messages.Root,void 0!==r),T(e,r,n,i));var o}function N(e,t,r){if(!(0,s.isSimpleUnit)(t))return F({kind:i.UnitEquality,unit:t,target:r});var n=k(e,r),a=e.uf.findWithDescriptor(n),o=a[0],l=a[1];if(1===t.varCount){(0,p.assertTrue)(u.Messages.Root,void 0!==t.name);var c=e.symbolContext.getTable().getValue(t.name);(0,p.assertTrue)(u.Messages.Root,void 0!==c);var d=e.uf.findWithDescriptor(k(e,c)),m=d[0];return A(e,d[1],m,l,o)}return A(e,t,void 0,l,o)}function _(e,t){if(t===f.SpecialFormat.Unavailable||0===t)return!1;var r=M(e,t);if(void 0===r)return!1;var n=null==r?void 0:r.valueType;return void 0!==n&&n!==h.FormatValueType.General&&(n!==h.FormatValueType.Currency&&n!==h.FormatValueType.Accounting||void 0!==r.currencySymbol)}function I(e,t,r,n){var i,a,o;n?r.referencedFormatCells+=1:r.allFormatCells+=1;var s=M(e,t),u=n?r.enriched.referencedFormatTypes:r.enriched.allFormatTypes,l=null==s?void 0:s.valueType;if(void 0!==l&&(u[l]=(null!==(i=u[l])&&void 0!==i?i:0)+1),l===h.FormatValueType.Currency||l===h.FormatValueType.Accounting){var c=n?r.enriched.referencedCurrencyTypes:r.enriched.allCurrencyTypes,d=null==s?void 0:s.currencySymbol,p=null===(a=null==s?void 0:s.culture)||void 0===a?void 0:a.culture,m=void 0===d?"none":d===h.FormatCurrency.LocaleInfo?"defaultSymbol":d+"_"+p;c[m]=(null!==(o=c[m])&&void 0!==o?o:0)+1}}function O(e,t){var r;return null===(r=M(e,t))||void 0===r?void 0:r.valueType}function M(e,t){if("number"==typeof t){var r=e.getIformat(t);return(0,v.isSuccess)(r)?r.value:void 0}return t}function D(e,t,r){var n=e.typeContext.types[t.index];if(void 0===n)return(0,p.assertFalse)(u.Messages.Root);var i=n.getValue(r);if(void 0===i){var a=(0,c.sheetGridCell)(t,r),s=e.typeContext.formats(a);if((0,v.isSuccess)(s)){if(!_(e.typeContext,s.value)||e.typeContext.isStringValue(a)){var l=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,(0,o.primitiveUnitType)(l)),l}var d=w(e,s.value);return void 0===d?d=e.symbolContext.freshSymbol().unit:I(e.typeContext,s.value,e.stats,!0),e.typeContext.types[t.index]=n.setValue(r,(0,o.primitiveUnitType)(d)),d}var m=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,(0,o.primitiveUnitType)(m)),m}return i.kind===o.TypeKind.Scalar?i.unit:void 0}function w(e,r){var n=O(e.typeContext,r);if(void 0!==n)switch(n){case h.FormatValueType.Currency:case h.FormatValueType.Accounting:return b;case h.FormatValueType.Percentage:return R;case h.FormatValueType.Date:return t.UnitExperimentSettings.UnitlessTimeAndDate?R:E;case h.FormatValueType.Time:return t.UnitExperimentSettings.UnitlessTimeAndDate?R:P;default:return}}t.makeSolverContext=function(e,t,r){var n=new l.UF,i=n.makePoint(C),a=(0,s.createPoisonApplication)(C);return{symbolContext:e,typeContext:t,stats:r,uf:n,errorPoint:i,errorUnit:C,apply:a}},t.isInterestingFormat=_,t.updateFormatStatsFromCellFormat=I,t.valueTypeFromCellFormat=O,t.numberFormatFromCellFormat=M;var L=((n={})[i.UnitEquality]=function(e,t){return N(e,t.unit,t.target)},n[i.FormatEquality]=function(e,t){var r=w(e,t.format);if(void 0===r)return y;var n=D(e,t.cell.sheet,t.cell.range);if(void 0===n)return y;if(!(0,s.isSimpleUnit)(n))return F(t);if(1===n.varCount){(0,p.assertTrue)(u.Messages.Root,void 0!==n.name);var i=e.symbolContext.getTable().getValue(n.name);(0,p.assertTrue)(u.Messages.Root,void 0!==i);var a=e.uf.findWithDescriptor(k(e,i)),o=a[0];return A(e,a[1],o,r,void 0)}return A(e,n,void 0,r,void 0)},n[i.RangeEquality]=function(e,t){var r=t.type.resolution;if(!(0,d.isSheetIndex)(r.sheet))return y;if((0,d.isGridCell)(r.range)){var n=D(e,r.sheet,r.range);return void 0===n?y:N(e,n,t.target)}var o=e.typeContext.available[r.sheet.index];if(void 0===o)return y;var s=o.usedRange;if(void 0===s)return y;var u=(0,d.gridRangeIsect)(r.range,s);if(void 0===u)return y;var l=(0,g.intersectProduct)((0,g.intersectProduct)((0,m.createCellSetFromRange)(u),m.availableReadProduct),o.availableCells),c=[];return(0,m.forEachCellInSet)(l,(function(e){return c.push(e),!0})),{kind:a.Staged,constraint:{kind:i.StagedRangeEquality,cursor:0,index:o.sheetIdx,cells:c,target:t.target},output:void 0}},n[i.StagedRangeEquality]=function(e,t){var r=t.cursor,n=t.cells;if(r>=n.length)return y;var i=n[r],o=D(e,t.index,i),s=void 0===o?y:N(e,o,t.target);return t.cursor+=1,{kind:a.Staged,constraint:t,output:s}},n);t.runSolverStep=function(e){return e.kind===o.ExperimentState.SolvingSimple?e.constraintCursor===e.constraints.length?function(e){var t,r,n=e.context,i=n.apply,a=n.errorUnit,u={kind:o.ExperimentState.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(e,t){var r=i(u.substitution,e);if(r!==a){var n=i(u.substitution,t);if(n!==a){var o=(0,s.unify)(i,r,n);o.kind!==s.UnificationResultKind.Subst?(u.stats.errorCount+=1,u.stats.enriched.errors.push({error:[i(u.substitution,e),i(u.substitution,t)]})):u.substitution=(0,s.compose)(i,o.substitution,u.substitution)}}},substitution:(t=e.context,r=t.symbolContext.getTable(),function(e){var n=r.getValue(e);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=t.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution})};return u}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,i=e.deferred,o=t[n],s=L[o.kind](r,o);switch(s.kind){case a.Deferred:i.push(s.constraint);break;case a.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:s.error});break;case a.Staged:if(t[n]=s.constraint,void 0!==s.output)switch(s.output.kind){case a.Deferred:i.push(s.output.constraint);break;case a.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:s.output.error})}return e}return e.constraintCursor+=1,e}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,a=e.unifyNF,o=t[n];switch(o.kind){case i.UnitEquality:a(o.unit,o.target.unit);break;case i.FormatEquality:var s=w(r,o.format);if(void 0===s)break;var l=D(r,o.cell.sheet,o.cell.range);if(void 0===l)break;a(s,l);break;default:return e.constraintCursor+=1,(0,p.assertNever)(u.Messages.Root,o)}return e.constraintCursor+=1,e}(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delayPromiseImpl=t.asyncLoopFactory=t.asyncLoop=void 0;var n=r(1);t.asyncLoop=n.asyncLoopModule.asyncLoop,t.asyncLoopFactory=n.asyncLoopModule.asyncLoopFactory,t.delayPromiseImpl=n.asyncLoopModule.delayPromiseImpl},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logMissingJSFeatures=t.getMissingJSFeatures=void 0;var n=r(4),i=r(12),a=r(35),o=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i"),!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function s(){return o.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}t.getMissingJSFeatures=s,t.logMissingJSFeatures=function(e){e().then((function(e){var t={main:s(),worker:e},r="calc.calc.logMissingJSFeatures: missing = ".concat(JSON.stringify(t));n.ulsLogger.ULS.traceTag(561534152,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r)})).catch((function(e){var t="calc.calc.logMissingJSFeatures: threw ".concat((0,a.messageFromError)(e));n.ulsLogger.ULS.traceTag(561534153,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepeatedTaskScheduler=t.TaskKind=void 0;var n,i,a=r(306),o=r(141),s=r(203);function u(e,t){return{kind:e,handle:t}}function l(e){return void 0!==e?(e.kind=n.NoWorkScheduled,e.handle=void 0,e):u(n.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(n||(n={})),(0,o.staticAssertExtends)(),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(i||(t.TaskKind=i={}));var c=Promise.resolve(),d=function(){function e(e,t){void 0===t&&(t=s.defaultSetTimeoutInterface);var r=this;this.timer=t,this.handleState=l(),this.clearHandleClosureAndRunBody=function(){var t;switch(r.handleState.kind){case n.NoWorkScheduled:t=i.Sync;break;case n.PromiseScheduled:t=i.MicroTask;break;case n.ImmediateScheduled:case n.FutureScheduled:t=i.MacroTask;break;default:(0,a.assertNever)("Unknown handle state",r.handleState)}r.handleState=l(r.handleState),e(t)},this.promiseClosure=function(){r.handleState.kind===n.PromiseScheduled&&r.clearHandleClosureAndRunBody()}}return e.prototype.runNextSynchronously=function(){switch(this.handleState.kind){case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()},e.prototype.runNextAsMicrotask=function(){switch(this.handleState.kind){case n.PromiseScheduled:return;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=n.PromiseScheduled,e.handle=void 0,e):u(n.PromiseScheduled,void 0),c.then(this.promiseClosure)},e.prototype.runNextAsMacrotask=function(){switch(this.handleState.kind){case n.ImmediateScheduled:return;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=n.ImmediateScheduled,t.handle=e,t):u(n.ImmediateScheduled,e))},e.prototype.runNextInFuture=function(e){switch(this.handleState.kind){case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=n.FutureScheduled,r.handle=t,r):u(n.FutureScheduled,t))},e.prototype.clear=function(){switch(this.handleState.kind){case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=l(this.handleState)},e}();t.RepeatedTaskScheduler=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(1);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineQueueProcessor=t.defaultTimerInterface=void 0;var n=r(0),i=r(141),a=r(308),o=r(203),s=r(305);t.defaultTimerInterface=n.__assign(n.__assign({},o.defaultSetTimeoutInterface),{now:i.now});var u=function(){function e(e,r,n,i){void 0===i&&(i=t.defaultTimerInterface);var o,u,l=this;this.cmp=e,this.consumeMessage=r,this.timer=i,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new a.PriorityQueue((function(t,r){var n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=null!==(o=null==n?void 0:n.costThreshold)&&void 0!==o?o:1,this.timeThreshold=null!==(u=null==n?void 0:n.timeThreshold)&&void 0!==u?u:10,this.scheduler=new s.RepeatedTaskScheduler((function(e){l.totalSyncCost=0,l.lastFutureAbsoluteTime=void 0,e===s.TaskKind.MacroTask&&(l.startTime=void 0),l.continue()}),i)}return e.prototype.enqueue=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.push=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.pop=function(){var e;return 1===this.queue.getCount()&&this.scheduler.clear(),null===(e=this.queue.pop())||void 0===e?void 0:e.payload},e.prototype.peek=function(){return this.queue.peek()},e.prototype.getCount=function(){return this.queue.getCount()},e.prototype.continue=function(){var e;for(this.startTime=null!==(e=this.startTime)&&void 0!==e?e:this.now();this.totalSyncCost<this.costThreshold;){var t=this.queue.peek();if(void 0===t)return;if(t.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(t.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=t.abstractCost,this.consumeMessage(t.payload)}var r=this.queue.peek();if(void 0!==r){var n=this.now();n-this.startTime<this.timeThreshold&&r.delayUntil<=n?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(r.delayUntil,n)||this.scheduler.runNextAsMacrotask()}},e.prototype.tryRunNextInFuture=function(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)},e.prototype.now=function(){return this.maxWitnessedNow=this.timer.now()},e}();t.TimelineQueueProcessor=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var n=r(1);t.PriorityQueue=n.priorityQueue.PriorityQueue},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridImportManager=t.GridProvider=void 0;var n=r(0),i=n.__importStar(r(80)),a=r(35),o=r(4),s=r(24),u=r(47),l=function(){function e(e){this.onGridReady=e,this.gridService=void 0}return e.prototype.getGrid=function(){var e;return null===(e=this.gridService)||void 0===e?void 0:e.call},e.prototype.createIGridImportEndpoint=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r=this;return n.__generator(this,(function(n){switch(n.label){case 0:return this.onGridExporterClosed(),[4,i.Endpoint.createOutside(e,(function(e){r.gridService={call:void 0,close:function(){return e.close("Force")}}}))];case 1:return(t=n.sent()).hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call)),[2]}}))}))},e.prototype.onGridExporterClosed=function(){if(this.gridService){var e=this.gridService;this.gridService=void 0,e.close()}},e}();function c(e,t,r){var n=new MessageChannel,i=n.port1,l=n.port2;Promise.all([e.createIGridImportEndpoint({port:l,options:r}),t.createIGridExportEndpoint({port:i,options:r},(function(){return e.onGridExporterClosed()}))]).catch((function(t){o.ulsLogger.ULS.traceTag(540674071,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,u.x10Logger.formatLogMessage("connectGridImporterExporter",{description:"".concat((0,a.messageFromError)(t))}));try{e.onGridExporterClosed()}catch(t){o.ulsLogger.ULS.traceTag(540644190,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,u.x10Logger.formatLogMessage("connectGridImporterExporter",{description:"importer threw ".concat((0,a.messageFromError)(t))}))}}))}t.GridProvider=l;var d=function(){function e(e){this.timeout=e,this.exporter=void 0,this.importers=[]}return e.prototype.onGridExporterCreated=function(e){this.exporter=e;for(var t=0,r=this.importers;t<r.length;t++){var n=r[t];c(n.importer,e,{id:n.id,createTimeout:this.timeout})}},e.prototype.onGridImporterCreated=function(e,t){this.importers.push({importer:e,id:t}),this.exporter&&c(e,this.exporter,{id:t,createTimeout:this.timeout})},e}();t.GridImportManager=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spanCompare=t.spanToLSPRange=t.indexToLSPPosition=t.Timeline=void 0;var n=r(79);t.Timeline=n.helpers.Timeline,t.indexToLSPPosition=n.helpers.indexToLSPPosition,t.spanToLSPRange=n.helpers.spanToLSPRange,t.spanCompare=n.helpers.spanCompare},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.makeBatchRequester=t.customConflictResolverPluginKinds=t.CustomConflictResolverStrategy=void 0;var i,a=r(17),o=r(17),s=r(2);!function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(i||(t.CustomConflictResolverStrategy=i={})),t.customConflictResolverPluginKinds=((n={})[i.FunctionSuggestionAndArgumentAssistance]=[o.RequestKind.functionSuggestion,o.RequestKind.argumentAssistance,o.RequestKind.inCellSuggestion],n),t.makeBatchRequester=function(e){return{functionSuggestionAndArgumentAssistance:function(t,r,n){if((0,s.isNone)(t))return Promise.resolve(null);var o=t.functionSuggestion,u=t.argumentAssistance,l=t.inCellSuggestion;return(0,s.isNone)(o)||(0,s.isNone)(u)||(0,s.isNone)(l)?Promise.resolve(null):e.doBatchRequest({strategy:i.FunctionSuggestionAndArgumentAssistance,functionSuggestion:o,argumentAssistance:u,inCellSuggestion:l},r,null!=n?n:a.DefaultComputationGroup)}}},(0,s.staticAssertExtends)(),(0,s.staticAssertExtends)(),(0,s.staticAssertExtends)(),(0,s.staticAssertExtends)(),(0,s.staticAssertExtends)()},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultPluginResponseWindows=void 0;var i=r(17),a=r(2);t.defaultPluginResponseWindows=((n={})[i.RequestKind.functionSuggestion]={startDelta:5,stopDelta:2e3},n[i.RequestKind.inCellSuggestion]={startDelta:5,stopDelta:2e3},n[i.RequestKind.formulaHighlighting]={startDelta:5,stopDelta:2e3},n[i.RequestKind.argumentAssistance]={startDelta:5,stopDelta:2e3},n[i.RequestKind.valuePreview]={startDelta:5,stopDelta:2e3},n[i.RequestKind.gotoCtrlClick]={startDelta:5,stopDelta:2e3},n[i.RequestKind.formulaRepair]={startDelta:5,stopDelta:2e3},n[i.RequestKind.runExperiment]={startDelta:0,stopDelta:15e3},n[i.RequestKind.runAuthoringExperiment]={startDelta:0,stopDelta:15e3},n[i.RequestKind.runPerCharacterExperiment]={startDelta:5,stopDelta:2e3},n[i.RequestKind.runTest]={startDelta:0,stopDelta:15e3},n[i.RequestKind.chatGPTQuery]={startDelta:0,stopDelta:15e3},n[i.RequestKind.columnFormulaSuggestion]={startDelta:0,stopDelta:2e4},n[i.RequestKind.setCellPrefetch]={startDelta:5,stopDelta:2e3},n[i.RequestKind.getTranspiledFormulas]={startDelta:0,stopDelta:5e3},n),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionShortDescriptions=void 0;var n=r(36),i=r(13),a=r(4),o=r(24),s=r(22);t.functionShortDescriptions=new i.ResettableLazy((function(){try{for(var e=new Map,t={},r=0,i=Object.keys(n.WorksheetFuncId);r<i.length;r++){var u=i[r],l=Number(u);if(!isNaN(Number(l))){var c=FormulaAuthoringStrings[n.WorksheetFuncId[l]+"ShortDescription"];e.set(l.toString(),c),t[l.toString()]=c}}return(0,s.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?{descriptionMap:t}:{descriptionMap:e}}catch(e){return a.ulsLogger.ULS.traceTag(538792415,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"failed to get functionShortDescriptionsMap with exception ".concat(e)),{}}}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var n=r(1);t.PriorityQueue=n.priorityQueue.PriorityQueue},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=void 0,t.PackageName="excel-online-calc-recalc"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsyncClass=t.wrapIntoAsync=void 0;var n=r(1);t.wrapIntoAsync=n.wrapIntoAsyncModule.wrapIntoAsync,t.wrapIntoAsyncClass=n.wrapIntoAsyncModule.wrapIntoAsyncClass},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objectChecker=t.chPossiblyInfiniteNumber=t.chFiniteNumber=t.check=t.chBoolean=t.arrayChecker=t.incrementFailure=t.registerExperimentFactory=t.ExperimentKind=t.UnitExperiment=t.blankStyleValue=t.forEachProduct=t.project=t.compareProduct=t.intersectProduct=t.exceptProduct=t.meetsProduct=t.unionProduct=t.union=t.dense=t.empty=t.namedTable=t.namedFormula=t.makeGridRangeTable=t.forEachRangeInSet=t.forEachCellInSet=t.bspFactory=t.createCellSetFromRange=t.PartialWorkbook=t.blankStyle=t.knownFormatData=t.genFmt=t.locale=t.createRange=t.mathpack=t.englishLocaleData=t.blankCellFormat=t.CloningTarget=t.UnavailableKind=t.OutputMessageKind=t.isFailureOutputMessage=t.SpecialFormat=t.SpecialStyle=t.ComputeKind=t.ComputedCellKind=t.createSheetCellSetFromRange=t.sheetCellSet=t.voidCallback=t.VolatileMode=t.PartialWorkbookDocumentCollection=void 0,t.optChecker=t.oneOfChecker=void 0;var n=r(0),i=n.__importStar(r(13)),a=n.__importStar(r(526)),o=n.__importStar(r(20)),s=n.__importStar(r(292)),u=n.__importStar(r(195)),l=n.__importStar(r(78)),c=n.__importStar(r(527)),d=n.__importStar(r(30)),p=n.__importStar(r(69)),m=n.__importStar(r(39)),f=n.__importStar(r(297)),g=n.__importStar(r(92)),h=n.__importStar(r(139)),v=n.__importStar(r(140)),S=n.__importStar(r(93)),y=n.__importStar(r(300)),F=n.__importStar(r(94));t.PartialWorkbookDocumentCollection=s.PartialWorkbookDocumentCollection,t.VolatileMode=i.VolatileMode,t.voidCallback=s.voidCallback,t.sheetCellSet=o.sheetCellSet,t.createSheetCellSetFromRange=o.createSheetCellSetFromRange,t.ComputedCellKind=o.ComputedCellKind,t.ComputeKind=o.ComputeKind,t.SpecialStyle=o.SpecialStyle,t.SpecialFormat=o.SpecialFormat,t.isFailureOutputMessage=a.isFailureOutputMessage,t.OutputMessageKind=o.OutputMessageKind,t.UnavailableKind=o.UnavailableKind,t.CloningTarget=l.CloningTarget,t.blankCellFormat=l.blankCellFormat,t.englishLocaleData=c.englishLocaleData,t.mathpack=c.mathpack,t.createRange=c.createRange,t.locale=c.locale,t.genFmt=c.genFmt,t.knownFormatData=c.knownFormatData,t.blankStyle=c.blankStyle,t.PartialWorkbook=u.PartialWorkbook,t.createCellSetFromRange=d.createCellSetFromRange,t.bspFactory=d.bspFactory,t.forEachCellInSet=d.forEachCellInSet,t.forEachRangeInSet=d.forEachRangeInSet,t.makeGridRangeTable=g.makeGridRangeTable,t.namedFormula=h.namedFormula,t.namedTable=h.namedTable,t.empty=p.empty,t.dense=p.dense,t.union=p.union,t.unionProduct=m.unionProduct,t.meetsProduct=m.meetsProduct,t.exceptProduct=m.exceptProduct,t.intersectProduct=m.intersectProduct,t.compareProduct=m.compareProduct,t.project=m.project,t.forEachProduct=m.forEachProduct,t.blankStyleValue=f.blankStyleValue,t.UnitExperiment=y.UnitExperiment,t.ExperimentKind=v.ExperimentKind,t.registerExperimentFactory=v.registerExperimentFactory,t.incrementFailure=F.incrementFailure,t.arrayChecker=S.arrayChecker,t.chBoolean=S.chBoolean,t.check=S.check,t.chFiniteNumber=S.chFiniteNumber,t.chPossiblyInfiniteNumber=S.chPossiblyInfiniteNumber,t.objectChecker=S.objectChecker,t.oneOfChecker=S.oneOfChecker,t.optChecker=S.optChecker},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockTimerImmediate=t.MockTimer=void 0;var n=r(79);t.MockTimer=n.mockTimer.MockTimer,t.MockTimerImmediate=n.mockTimer.MockTimerImmediate},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argumentAssistancePluginDependenciesResolved=t.ArgumentAssistancePluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(21),s=r(533),u=r(12),l=r(5),c=r(23),d=r(96),p=r(534),m=r(320),f=r(13),g=r(31),h=r(122),v=r(22),S=r(6),y=r(14),F=r(9),C=function(){function e(){this.factoryName=S.PluginFactoryName.ArgumentAssistancePlugin}return e.prototype.create=function(){return new R},e}();t.ArgumentAssistancePluginFactory=C;var R=function(){function e(){this.timer=h.defaultTimerInterface,this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map,this.fixHandlingWhiteSpace=(0,v.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces"),this.newNamedObjectsEnabled=(0,y.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,y.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}return e.prototype.run=function(e){var t,r,a,g,h,v,S,y,C,R,b,E,P,k,T,A,N,_,I,O,M,D,w,L,x,K,U,B,W,G,V,j,q=this;return n.__generator(this,(function(n){switch(n.label){case 0:return this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map,[4,{kind:i.ComputationRequestKind.GetActiveCell}];case 1:return(t=n.sent()).kind!==i.ComputationRequestKind.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(this.addTimeStamp("GetActiveCell"),[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content}]);case 2:return r=n.sent(),this.addTimeStamp("ParseCellContentSync"),void 0!==r&&r.kind===i.ComputationRequestKind.ParseActiveCell&&(0,l.isSuccess)(r.result)?[3,4]:[4,{kind:i.ComputationRequestKind.ParseEdit,cell:t.activeCell,formulaBarText:e.content}];case 3:if(r=n.sent(),this.addTimeStamp("ParseCellContentAsync"),r.kind!==i.ComputationRequestKind.ParseEdit||!(0,l.isSuccess)(r.result))return[2,null];n.label=4;case 4:return r.result.value.kind!==c.EditKind.Formula?[2,null]:(a=r.result.value.formula,g=new p.ArgumentAssistanceVisitor(a,e.caretPosition,this.newNamedObjectsEnabled),(0,o.reduceBottomUp)(g,a),this.addTimeStamp("ArgumentAssistanceVisitor"),void 0===g.assistedFunctionHead?(this.logTimeStamp(),[2,null]):[4,{kind:i.ComputationRequestKind.GetConfig}]);case 5:return h=n.sent(),this.addTimeStamp("GetConfig"),v=h.kind===i.ComputationRequestKind.GetConfig?h.config.localeInfo.listSeparator:",",(S=g.assistedFunctionHead).kind!==F.NodeKind.Name?[3,8]:this.newNamedObjectsEnabled?[4,{kind:i.ComputationRequestKind.GetDefinedNamesInfo}]:[2,null];case 6:return(y=n.sent()).kind!==i.ComputationRequestKind.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):(C=y.definedNamesInfo,null==(null==(R=C.find((function(e){return e.name===S.whole})))?void 0:R.reference)?[2,null]:[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:R.reference}]);case 7:if((b=n.sent()).kind!==i.ComputationRequestKind.ParseActiveCell||!(0,l.isSuccess)(b.result)||b.result.value.kind!==c.EditKind.Formula)return[2,null];if(!(E=b.result.value.formula).isWellFormed||"Lambda"!==E.node.kind||!E.node.isClosed)return[2,null];for(P=[],k=0,T=E.node.params;k<T.length;k++){if(A=T[k],N=A.name.arg.name,_=N.name,I=N.isBracketed,"Ident"!==_.kind)return this.logFailure("unexpected parameter in lambda function: ".concat(_.kind)),[2,null];O=I?"[".concat(_.whole,"]"):_.whole,P.push(O)}return M=(0,m.getActiveParamIndex)(a,g.assistedFunctionArgs,e.caretPosition,this.fixHandlingWhiteSpace),[2,{kind:"Minimal",functionName:S.whole,listSeparator:v,parameters:{params:P,activeParam:M}}];case 8:return[4,{kind:i.ComputationRequestKind.GetFunctionInfo,functionName:S.whole}];case 9:return D=n.sent(),this.addTimeStamp("GetFunctionInfo"),D.kind!==i.ComputationRequestKind.GetFunctionInfo?(this.logFailure("failed to get function info for ".concat(S.whole)),[2,null]):(w=new f.ResettableLazy((function(){return(0,m.createFunctionRenderingInfo)(D.functionInfo,a,g.assistedFunctionArgs,e.caretPosition,S.id,v,q.fixHandlingWhiteSpace)})),L=s.functionExamples.getValue()[S.id],this.addTimeStamp("GetExampleString"),void 0===L?(this.logFailure("no example found for function: ".concat(S.whole,", id: ").concat(S.id)),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),[2,w.getValue()]):[4,{kind:i.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:L,kind:d.FormulaKind.CellFormula},useEnglishLocaleInfo:!0}]);case 10:return x=n.sent(),this.addTimeStamp("ParseExample"),x.kind===i.ComputationRequestKind.ParseCellFormula&&(0,l.isSuccess)(x.result)?h.kind===i.ComputationRequestKind.GetConfig&&h.config.localeInfo.lcid===u.LCID.USA?(U=(0,m.createFunctionRenderingInfo)(D.functionInfo,a,g.assistedFunctionArgs,e.caretPosition,S.id,v,this.fixHandlingWhiteSpace,L,x.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),[2,U]):[4,{kind:i.ComputationRequestKind.PrintFormula,formula:x.result.value,origin:t.activeCell}]:(this.logFailure("failed to parse example for function: ".concat(S.whole)),K=w.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),[2,K]);case 11:return B=n.sent(),this.addTimeStamp("localize example string"),B.kind===i.ComputationRequestKind.PrintFormula&&(0,l.isSuccess)(B.result)?[4,{kind:i.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:B.result.value,kind:d.FormulaKind.CellFormula},useEnglishLocaleInfo:!1}]:(this.logFailure("failed to pretty print localized example for function: ".concat(S.whole)),W=w.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),[2,W]);case 12:return G=n.sent(),this.addTimeStamp("parse localized example string"),G.kind===i.ComputationRequestKind.ParseCellFormula&&(0,l.isSuccess)(G.result)?(j=(0,m.createFunctionRenderingInfo)(D.functionInfo,a,g.assistedFunctionArgs,e.caretPosition,S.id,v,this.fixHandlingWhiteSpace,B.result.value,G.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),[2,j]):(this.logFailure("failed to parse localized example for function: ".concat(S.whole)),V=w.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),[2,V])}}))},e.prototype.logFailure=function(e){u.ulsLogger.ULS.traceTag(545388683,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Warning,"ArgumentAssistancePlugin encountered a failure with msg ".concat(e))},e.prototype.addTimeStampAndLog=function(e){this.addTimeStamp(e),this.logTimeStamp()},e.prototype.logTimeStamp=function(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);var e={};this.timeStamps.forEach((function(t,r){e[r]=t})),u.ulsLogger.ULS.traceTag(540377222,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,"".concat(JSON.stringify(e)))},e.prototype.addTimeStamp=function(e){this.timeStamps.set(e,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()},e}();(0,a.registerPluginFactory)(new C),t.argumentAssistancePluginDependenciesResolved=(0,f.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return(0,v.getTypedFeatureGate)("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?[4,g.dynamicPluginLoaderCreated.getValue()]:[3,2];case 1:return e=t.sent(),[3,4];case 2:return[4,g.workerThreadSpread.getValue()];case 3:e=t.sent(),t.label=4;case 4:return[4,e.loadPluginScript("formula-authoring-strings",!0)];case 5:return t.sent(),[4,e.createAndAttachPlugin(S.PluginFactoryName.ArgumentAssistancePlugin)];case 6:return t.sent(),[4,g.schedulerWithRecalcServiceAttached.getValue()];case 7:return t.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseParamName=t.getParamNumberSuffix=t.getParamIndexToHighlight=t.getActiveParamIndex=t.createFunctionRenderingInfo=void 0;var n=r(36);function i(e,t,r,n){var i,a=0;if(n)for(var o=0;o<t.length;o++){var s=e.spans[t[o].label];if(s&&s.start-s.pre.length<=r&&r<=s.end+s.post.length){a=o;break}}else for(o=t.length-1;o>=0;o-=1){var u=null===(i=e.spans[t[o].label])||void 0===i?void 0:i.end;void 0!==u&&r<=u&&(a=o)}return a}function a(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var a=t-1,o=r.restTypes.length,s=r.headTypes.length;if(e<s+o)return e;if(e>=s&&0===o)return-1;var u=(e-s)%o;return n?e<=a-r.tailTypes.length?e:a-r.tailTypes.length-(o-1)+u:s+(i&&0===u&&r.tailTypes.length>0?o:u)}function o(e,t,r){var n=a(e,t,r);return u(e,r)&&(n+=1),n}function s(e,t,r){return 1+Math.max(Math.floor((e-t)/r),0)}function u(e,t){return t.restTypes.length>0&&e>=t.headTypes.length+t.restTypes.length}function l(e){return e.match(/[^0-9\[\]]+/)}function c(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}}t.createFunctionRenderingInfo=function(e,t,r,d,p,m,f,g,h){var v=i(t,r,d,f),S=e.Params.split("!");return{kind:"Full",functionName:e.NameDataStrings,functionDescription:e.Help,signatures:S.map((function(t,r){return function(e,t,r,i,d,p,m,f){var g=(0,n.getWorksheetFuncType)(d),h=""!==t?t.split(p+" ").filter((function(e){return"..."!==e})):[],v=function(e,t,r){var n=e.slice(),i=t.headTypes.length,a=t.restTypes.length;if(a>0){for(var o=s(r,i,a),c=i;c<n.length;c+=a){for(var d=0;d<a;d+=1){var p=l(n[c+d]),m=o>1&&d%a==0?"[":"",f=o>1&&d%a==a-1?"]":"";n[c+d]="".concat(m).concat(p).concat(o).concat(f)}o+=1}n.push("..."),u(r,t)&&n.splice(i,0,"...")}return n}(h,g,i),S=function(e,t){if(void 0===e||void 0===t)return null;return t.node.args.map((function(r){var n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))}(m,f),y=function(e,t,r,n){var i=e.split("!");i=0===n?i.slice(0,t.length):i.slice(-1*t.length);if(r.restTypes.length>0){for(var a=r.headTypes.length;a<i.length;a+=1){var o=l(t[a]),s="".concat(o,"1,").concat(o,"2,... ");i[a]=s+i[a]}1===r.restTypes.length&&i.push(i[r.headTypes.length])}return i}(e.ParamsHelp,h,g,r),F=function(e,t){return e.filter((function(e){return"..."!==e})).slice(0,t.length).map((function(e){return function(e){if(e.startsWith("[")&&!e.endsWith("]"))return e+"]";if(!e.startsWith("[")&&e.endsWith("]"))return"["+e;return e}(e)}))}(v,y);return{signatureParams:c(v,o(i,h.length,g)),descriptions:y,descriptionParams:c(F,a(i,F.length,g)),exampleParams:null!==S?c(S,a(i,S.length,g,!0)):null,exampleDescription:""}}(e,t,r,v,p,m,g,h)})),activeSignature:0,listSeparator:m,isUDF:e.IsDynamicUdf,helpID:e.HelpId}},t.getActiveParamIndex=i,t.getParamIndexToHighlight=a,t.getParamNumberSuffix=s,t.getBaseParamName=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteFunctionPluginDependenciesResolved=t.AutocompleteFunctionPluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(12),s=r(5),u=r(23),l=r(13),c=r(31),d=r(21),p=r(313),m=r(6),f=r(6),g=r(86),h=r(322),v=r(14),S=r(2),y=r(22),F=function(){function e(){this.factoryName=f.PluginFactoryName.AutocompleteFunctionPlugin}return e.prototype.create=function(){return new C},e}();t.AutocompleteFunctionPluginFactory=F;var C=function(){function e(){this.autoCompleteForCellRefEnabled=(0,v.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"),this.isEnumAutoCompleteFixEnabled=(0,v.isChangeGateEnabled)("OfficeVSO:8593118_AutoCompleteEnumDescriptions")}return e.prototype.run=function(e){var t,r,a,o,l,c,m,f,v,S,y,F,C,R,b;return n.__generator(this,(function(E){switch(E.label){case 0:return[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content}];case 1:return(t=E.sent()).kind===i.ComputationRequestKind.ParseActiveCell&&(0,s.isSuccess)(t.result)?t.result.value.kind!==u.EditKind.Formula?[2,null]:(r=t.result.value.formula,a=new h.AutocompleteBaseVisitor(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled),(0,d.reduceBottomUp)(a,r),void 0===a.autocompleteString||void 0===a.stringStartPosition||void 0===a.stringEndPosition||a.isInsideArrayNode?[2,null]:(o=a.autocompleteString.toUpperCase(),l=a.stringStartPosition,c=a.stringEndPosition,[4,{kind:i.ComputationRequestKind.GetFunctionsInfo}])):[2,null];case 2:return(m=E.sent()).kind!==i.ComputationRequestKind.GetFunctionsInfo?(this.logFailure("failed to get functions info"),[2,null]):(f=m.functionsInfo,v=(0,g.filterSuggestionsAccordingToPrefix)(o,f,(function(e){return e.NameDataStrings})),S=v.prefixedSuggestions,y=v.notPrefixedSuggestions,null!==(F=p.functionShortDescriptions.getValue())&&null!==F.descriptionMap||this.logFailure("failed to get short descriptions, will show function info help description"),C=(0,g.getCompletedFunctionSuffix)(e.content,c),R=this.generateCompletionItems(S,F,l,c,!0,C),b=this.generateCompletionItems(y,F,l,c,!1,C),[2,{items:n.__spreadArray(n.__spreadArray([],R,!0),b,!0)}])}}))},e.prototype.generateCompletionItems=function(e,t,r,n,i,a){var s=this,u=[],l=e.map((function(e){var o,l,c=e.FunctionIndexInServer.toString(),d=(0,y.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?null===(o=t.descriptionMap)||void 0===o?void 0:o[c]:null===(l=t.descriptionMap)||void 0===l?void 0:l.get(c);return(0,S.isNone)(d)&&(u.push(e.FunctionIndexInServer),d=e.Help),{label:e.NameDataStrings,kind:m.CompletionItemKind.Function,detail:d,textEdit:{newText:e.NameDataStrings+a,range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:i,shouldRequestAutocompleteOnCommit:s.isEnumAutoCompleteFixEnabled}}));return u.length>0&&o.ulsLogger.ULS.traceTag(508871621,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AutocompleteFunctionPlugin missing short descriptions for func IDs: ".concat(JSON.stringify(u))),l},e.prototype.logFailure=function(e){o.ulsLogger.ULS.traceTag(539083013,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"AutocompleteFunctionPlugin encountered a failure with msg ".concat(e))},e}();(0,a.registerPluginFactory)(new F),t.autocompleteFunctionPluginDependenciesResolved=(0,l.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,c.autoCompletePluginsThread.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("formula-authoring-strings",!0)];case 2:return t.sent(),[4,e.createAndAttachPlugin(f.PluginFactoryName.AutocompleteFunctionPlugin)];case 3:return t.sent(),[4,c.schedulerWithRecalcServiceAttached.getValue()];case 4:return t.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteBaseVisitor=void 0;var n=r(0),i=r(9),a=function(e){function t(t,r,n,i){var a=e.call(this,t,r)||this;return a.formulaString=n,a.autoCompleteForCellRefEnabled=i,a}return n.__extends(t,e),t.prototype.nameNode=function(t,r,n){return t.kind!==i.NamePartKind.IdentNamePart&&t.kind!==i.NamePartKind.FieldRefNamePart||this.updateAutocompleteString(n,t.asWhole),e.prototype.nameNode.call(this,t,r,n)},t.prototype.appNode=function(t,r,n,a){return this.autoCompleteForCellRefEnabled&&t.kind===i.NodeKind.WSF&&this.updateAutocompleteString(a,t.whole),e.prototype.appNode.call(this,t,r,n,a)},t.prototype.cellRefNode=function(t,r,n){var a=this.parsedFormulaTree.spans[n];if(t.kind===i.CellRefKind.Single&&a){var o=this.formulaString.substring(a.start,a.end);this.updateAutocompleteString(n,o)}return e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.updateAutocompleteString=function(e,t){var r=this.parsedFormulaTree.spans[e].start,n=r+t.length;this.caretPosition===n&&(this.autocompleteString=t,this.stringEndPosition=n,this.stringStartPosition=r)},t}(r(83).CaretInsideArrayNodeIdentityVisitor);t.AutocompleteBaseVisitor=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteEnumPluginDependenciesResolved=t.AutocompleteEnumPluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(12),s=r(5),u=r(23),l=r(13),c=r(31),d=r(21),p=r(86),m=r(535),f=r(2),g=r(536),h=r(537),v=r(36),S=r(6),y=function(){function e(){this.factoryName=S.PluginFactoryName.AutocompleteEnumPlugin}return e.prototype.create=function(){return new F},e}();t.AutocompleteEnumPluginFactory=y;var F=function(){function e(){}return e.prototype.run=function(e){var t,r,a,o,l,c,p,S,y,F,C,R,b,E,P,k,T,A,N;return n.__generator(this,(function(_){switch(_.label){case 0:return[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content}];case 1:return(t=_.sent()).kind===i.ComputationRequestKind.ParseActiveCell&&(0,s.isSuccess)(t.result)?t.result.value.kind!==u.EditKind.Formula?[2,null]:(r=t.result.value.formula,a=new m.AutoCompleteEnumVisitor(r,e.caretPosition),(0,d.reduceBottomUp)(a,r),void 0===a.stringStartPosition||void 0===a.stringEndPosition||void 0===a.functionHead||void 0===a.argIndex||void 0===a.functionArgs||a.isInsideArrayNode?[2,null]:(o=a.argIndex+1,l=a.stringStartPosition,c=a.stringEndPosition,p=a.functionHead,S=e.caretPosition===c?e.content.substring(l,c).toUpperCase():"",y=void 0,p.id===v.WorksheetFuncId.CONVERT?y=(0,h.getConvertEnum)(o,r,e.content,a.functionArgs):(F=g.functionEnums.getValue(),y=this.getEnumInfoByArg(o,F,p.id)),(0,f.isNone)(y)?[2,null]:[4,{kind:i.ComputationRequestKind.GetConfig}])):[2,null];case 2:return(C=_.sent()).kind!==i.ComputationRequestKind.GetConfig?(this.logFailure("failed to get config"),[2,null]):(R=C.config.localeInfo,0===(b=this.getLocalizedEnumInfo(y,R)).length?(this.logFailure("failed to get enum info for values/descriptions"),[2,null]):(E=this.getFilteredEnumInfo(S,p.id,b),P=E.prefixedEnumInfo,k=E.notPrefixedEnumInfo,T=this.shouldAddDoubleQuotes(p.id),A=this.generateCompletionItems(P,l,c,!0,T),N=this.generateCompletionItems(k,l,c,!1,T),[2,{items:n.__spreadArray(n.__spreadArray([],A,!0),N,!0)}]))}}))},e.prototype.generateCompletionItems=function(e,t,r,n,i){return e.map((function(e){var a=i?'"'.concat(e.value,'"'):e.value;return{label:a,kind:S.CompletionItemKind.Enum,detail:e.description,textEdit:{newText:a,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))},e.prototype.getFilteredEnumInfo=function(e,t,r){var n=[],i=[],a=e.replace(/^"|"$/g,"");if(this.shouldAddDoubleQuotes(t)&&e.endsWith('"')&&e.startsWith('"'))n=r.filter((function(e){return e.value.toUpperCase()===a}));else{var o=(0,p.filterSuggestionsAccordingToPrefix)(a,r,(function(e){return e.value}));n=o.prefixedSuggestions,i=o.notPrefixedSuggestions}return 0===n.length&&0===i.length&&i.push.apply(i,r),{prefixedEnumInfo:n,notPrefixedEnumInfo:i}},e.prototype.getEnumInfoByArg=function(e,t,r){var n=t[r];if(!(0,f.isNone)(n))return n[e]},e.prototype.getLocalizedEnumInfo=function(e,t){var r=e.map((function(e){return{value:"function"==typeof e.value?e.value(t):e.value,description:"function"==typeof e.description?e.description(t):e.description}})),n=r.length,i=r.filter((function(e){var t=e.value,r=e.description;return void 0!==t&&void 0!==r&&""!==t&&"undefined"!==t}));return e.length!==n&&this.logFailure("failed to get enum info for some values"),i},e.prototype.shouldAddDoubleQuotes=function(e){return e===v.WorksheetFuncId.COMPLEX||e===v.WorksheetFuncId.INFO||e===v.WorksheetFuncId.CONVERT||e===v.WorksheetFuncId.CELL},e.prototype.logFailure=function(e){o.ulsLogger.ULS.traceTag(508350686,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"AutocompleteEnumPlugin encountered a failure with msg ".concat(e))},e}();(0,a.registerPluginFactory)(new y),t.autocompleteEnumPluginDependenciesResolved=(0,l.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,c.autoCompletePluginsThread.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("formula-authoring-strings",!0)];case 2:return t.sent(),[4,e.createAndAttachPlugin(S.PluginFactoryName.AutocompleteEnumPlugin)];case 3:return t.sent(),[4,c.schedulerWithRecalcServiceAttached.getValue()];case 4:return t.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteLetPluginDependenciesResolved=t.AutocompleteLetPluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(5),s=r(23),u=r(13),l=r(31),c=r(21),d=r(538),p=r(86),m=r(14),f=r(6),g=function(){function e(){this.factoryName=f.PluginFactoryName.AutocompleteLetPlugin}return e.prototype.create=function(){return new h},e}();t.AutocompleteLetPluginFactory=g;var h=function(){function e(){this.autoCompleteForCellRefEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")}return e.prototype.run=function(e){var t,r,a,u,l,m,f,g,h,v,S,y,F,C;return n.__generator(this,(function(R){switch(R.label){case 0:return[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content}];case 1:return(t=R.sent()).kind===i.ComputationRequestKind.ParseActiveCell&&(0,o.isSuccess)(t.result)?t.result.value.kind!==s.EditKind.Formula?[2,null]:(r=t.result.value.formula,a=e.caretPosition,u=new d.AutocompleteLetVisitor(this.autoCompleteForCellRefEnabled,e.content,r,a),(0,c.reduceBottomUp)(u,r),l=u.references.reverse(),m=Array.from(new Set(l)),void 0===(f=u.caretNodeText)||u.isInsideArrayNode?[2,null]:(h=(g=a)-f.length,v=(0,p.filterSuggestionsAccordingToPrefix)(f,m),S=v.prefixedSuggestions,y=v.notPrefixedSuggestions,F=this.stringsToCompletionItems(S,h,g,!0),C=this.stringsToCompletionItems(y,h,g,!1),[2,{items:n.__spreadArray(n.__spreadArray([],F,!0),C,!0)}])):[2,null]}}))},e.prototype.stringsToCompletionItems=function(e,t,r,n){return e.map((function(e){return{label:e,kind:f.CompletionItemKind.LetVariable,type:f.SuggestionKind.Simple,textEdit:{newText:e,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))},e}();(0,a.registerPluginFactory)(new g),t.autocompleteLetPluginDependenciesResolved=(0,u.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,l.autoCompletePluginsThread.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(f.PluginFactoryName.AutocompleteLetPlugin)];case 2:return e.sent(),[4,l.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteRichValuePluginDependenciesResolved=t.AutocompleteRichValuePluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(31),s=r(13),u=r(6),l=r(539),c=r(5),d=r(23),p=r(21),m=r(11),f=r(2),g=r(4),h=r(149),v=r(86),S=r(105),y=r(6),F=r(540),C=r(14),R=function(){function e(){this.factoryName=y.PluginFactoryName.AutocompleteRichValuePlugin}return e.prototype.create=function(){return new b},e}();t.AutocompleteRichValuePluginFactory=R;var b=function(){function e(){this.dontAlwaysAddBracketsEnabled=(0,C.isChangeGateEnabled)("OfficeVSO:7765276_RichValueAutoCompleteDontAlwayAddBrackets")}return e.prototype.run=function(e){var t,r,a,o,s,g,h,y,F,C,R,b,P,k,T,A,N,_,I,O,M,D,w,L,x,K,U;return n.__generator(this,(function(B){switch(B.label){case 0:return(0,f.isNone)(e.content)||(0,f.isNone)(e.caretPosition)?(E("missing request arguments"),[2,null]):[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content}];case 1:return(t=B.sent()).kind===i.ComputationRequestKind.ParseActiveCell&&(0,c.isSuccess)(t.result)?t.result.value.kind!==d.EditKind.Formula?[2,null]:(r=t.result.value.formula,[4,{kind:i.ComputationRequestKind.GetDefinedNamesInfo}]):[2,null];case 2:return(a=B.sent()).kind!==i.ComputationRequestKind.GetDefinedNamesInfo?(E("failed to get named objects info"),[2,null]):[4,{kind:i.ComputationRequestKind.GetActiveCell}];case 3:return(o=B.sent()).kind!==i.ComputationRequestKind.GetActiveCell?(E("failed to get active cell"),[2,null]):(s=o.activeCell,g=new l.AutocompleteRichValueVisitor(r,e.caretPosition,e.content,a.definedNamesInfo,s.range),(0,p.reduceBottomUp)(g,r),g.isInsideArrayNode?[2,null]:(y=void 0,(0,f.isDefined)(g.cellRef)?(h=g.cellRef,y=s.sheet.index,[3,6]):[3,4]));case 4:return(0,f.isDefined)(g.namedRangeNode)?(F={originGridCell:(0,c.success)(s.range),originSheet:(0,c.success)(s.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:i.ComputationRequestKind.ResolveReferences,nodes:[g.namedRangeNode],locals:F}]):[3,6];case 5:(C=B.sent()).kind===i.ComputationRequestKind.ResolveReferences&&(R=C.resolverResults[0]).kind===S.ResolvedKind.ResolvedStructRef&&(0,c.isSuccess)(R.resolution)&&void 0!==R.resolution.value&&(b=R.resolution.value.range,h={firstRow:b.row,firstColumn:b.col,lastRow:b.row+b.rows-1,lastColumn:b.col+b.cols-1},y=R.resolution.value.sheet.index),B.label=6;case 6:return(0,f.isDefined)(h)?(P=g.dotNotationPath,(0,f.isNone)(P)?(E("failed to parse cellRef"),[2,null]):(k="",(0,f.isDefined)(g.sheetName)?(k=g.sheetName,[3,9]):[3,7])):[2,null];case 7:return[4,{kind:i.ComputationRequestKind.GetSheetNames}];case 8:if((T=B.sent()).kind!==i.ComputationRequestKind.GetSheetNames)return E("failed to get sheet names"),[2,null];if(!(0,m.isDocumentLocEqual)(s.sheet.document,T.document))return E("sheet names document is different than that of active cell"),[2,null];if(!(0,f.isDefined)(y))return E("sheet index is undefined"),[2,null];k=T.sheets[T.idToIndex[y]].sheetName,B.label=9;case 9:return A=n.__assign(n.__assign({},h),{sheetName:k,namedObjectName:""}),[4,{kind:i.ComputationRequestKind.GetRichValueFieldListContext,rangeToQuery:A,dotNotationPath:P,singleColumn:!1,findRange:!1}];case 10:return(N=B.sent()).kind!==i.ComputationRequestKind.GetRichValueFieldListContext?(E("failed to get field list context data"),[2,null]):(0,f.isNone)(N.result)||0===N.result.length?[2,null]:(N.result.length>1&&E("fieldListContextRequest results length greater than 1"),_=(0,v.filterSuggestionsAccordingToPrefix)(g.richValueItemPrefix,N.result[0].FieldInfoDataList,(function(e){return e.Name}),!0),I=_.prefixedSuggestions,O=_.notPrefixedSuggestions,[4,{kind:i.ComputationRequestKind.GetConfig}]);case 11:return M=B.sent(),D=this.resultsToCompletionItems(I,!0,g.dotNotationIndex,null!==(x=g.fieldRefChainEndIndex)&&void 0!==x?x:e.caretPosition,M,!!g.namedRangeNode),w=this.resultsToCompletionItems(O,!1,g.dotNotationIndex,null!==(K=g.fieldRefChainEndIndex)&&void 0!==K?K:e.caretPosition,M,!!g.namedRangeNode),L=n.__spreadArray(n.__spreadArray([],D,!0),w,!0),g.shouldAddEmptySuggestion&&(L=n.__spreadArray([(W=g.dotNotationIndex,G=null!==(U=g.fieldRefChainEndIndex)&&void 0!==U?U:e.caretPosition,{label:"",kind:u.CompletionItemKind.RichEntityEmptyCellRef,detail:"",textEdit:{newText:"",range:{start:{line:0,character:W},end:{line:0,character:G}}},isPrefixed:!0})],L,!0)),[2,{items:L}]}var W,G}))},e.getTextToCommit=function(e,t,r,n){var a=e.Name;if(a=(a=(a=a.replace("'","''")).replace("[","'[")).replace("]","']"),e.RefersToDotFunction)return".".concat(a);if(r){if(n)return".[".concat(a,"]");var o=t.kind===i.ComputationRequestKind.GetConfig?t.config.localeInfo:void 0;return o&&!(0,F.isUnbracketedField)(o,a)?".[".concat(a,"]"):".".concat(a)}return".[".concat(a,"]")},e.prototype.resultsToCompletionItems=function(t,r,n,i,a,o){var s=this;return t.map((function(t){return{label:t.Name,kind:u.CompletionItemKind.RichEntity,detail:"",textEdit:{newText:e.getTextToCommit(t,a,s.dontAlwaysAddBracketsEnabled,o),range:{start:{line:0,character:n},end:{line:0,character:i}}},isPrefixed:r}}))},e}();function E(e){g.ulsLogger.ULS.traceTag(529056660,h.LogCategory.msoulscat_ES_EWAJS,h.TraceLevel.Warning,"AutocompleteRichValuePlugin encountered a failure with msg ".concat(e))}(0,a.registerPluginFactory)(new R),t.autocompleteRichValuePluginDependenciesResolved=(0,s.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,o.dynamicPluginLoaderCreated.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(y.PluginFactoryName.AutocompleteRichValuePlugin)];case 2:return e.sent(),[4,o.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteNamedObjectsPluginDependenciesResolved=t.AutocompleteNamedObjectsPluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(12),s=r(5),u=r(23),l=r(13),c=r(31),d=r(6),p=r(322),m=r(21),f=r(86),g=r(2),h=r(6),v=r(14),S=r(6),y=function(){function e(){this.factoryName=S.PluginFactoryName.AutocompleteNamedObjectsPlugin}return e.prototype.create=function(){return new F},e}();t.AutocompleteNamedObjectsPluginFactory=y;var F=function(){function e(){this.autoCompleteForCellRefEnabled=(0,v.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"),this.newNamedObjectsEnabled=(0,v.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,v.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}return e.prototype.run=function(e){var t,r,a,o,l,c,d,v,S,y,F,C,R,b,E,P,k,T,A,N,_;return n.__generator(this,(function(I){switch(I.label){case 0:return[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:e.content}];case 1:return(t=I.sent()).kind===i.ComputationRequestKind.ParseActiveCell&&(0,s.isSuccess)(t.result)?t.result.value.kind!==u.EditKind.Formula?[2,null]:(r=t.result.value.formula,[4,{kind:i.ComputationRequestKind.GetDefinedNamesInfo}]):[2,null];case 2:if((a=I.sent()).kind!==i.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),[2,null];if(o=a.definedNamesInfo,l=new p.AutocompleteBaseVisitor(r,e.caretPosition,e.content,this.autoCompleteForCellRefEnabled),(0,m.reduceBottomUp)(l,r),c=l.autocompleteString,d=l.stringStartPosition,v=l.stringEndPosition,S=l.isInsideArrayNode,!(0,g.isDefined)(c)||!(0,g.isDefined)(v)||!(0,g.isDefined)(d)||S)return[2,null];if(y=(0,f.filterSuggestionsAccordingToPrefix)(c,o,(function(e){return e.name})),F=y.prefixedSuggestions,C=y.notPrefixedSuggestions,!this.newNamedObjectsEnabled)return[3,7];R=n.__spreadArray(n.__spreadArray([],F.map((function(e){return n.__assign(n.__assign({},e),{isPrefixed:!0})})),!0),C.map((function(e){return n.__assign(n.__assign({},e),{isPrefixed:!1})})),!0),b=0,E=R,I.label=3;case 3:return b<E.length?(P=E[b],(0,g.isNone)(P.reference)||P.type!==h.DefinedNameInfoType.Other?[3,5]:[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:P.reference}]):[3,6];case 4:if((k=I.sent()).kind!==i.ComputationRequestKind.ParseActiveCell||!(0,s.isSuccess)(k.result)||k.result.value.kind!==u.EditKind.Formula)return[2,null];(T=k.result.value.formula).isWellFormed&&"Lambda"===T.node.kind&&T.node.isClosed&&(P.type=h.DefinedNameInfoType.Lambda),I.label=5;case 5:return b++,[3,3];case 6:return A=(0,f.getCompletedFunctionSuffix)(e.content,v),[2,{items:this.namesToCompletionItems(R,d,v,A)}];case 7:return N=this.namesToCompletionItemsOld(F,d,v,!0),_=this.namesToCompletionItemsOld(C,d,v,!1),[2,{items:n.__spreadArray(n.__spreadArray([],N,!0),_,!0)}]}}))},e.prototype.namesToCompletionItemsOld=function(e,t,r,n){return e.filter((function(e){return e.type!==h.DefinedNameInfoType.Invalid})).map((function(e){return{label:e.name,kind:e.type===h.DefinedNameInfoType.NamedRange?d.CompletionItemKind.NamedRange:d.CompletionItemKind.Table,type:d.SuggestionKind.Simple,textEdit:{newText:e.name,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:n}}))},e.prototype.namesToCompletionItems=function(e,t,r,n){return e.filter((function(e){return e.type!==h.DefinedNameInfoType.Invalid})).map((function(e){var i=function(e){switch(e.type){case h.DefinedNameInfoType.NamedRange:return d.CompletionItemKind.NamedRange;case h.DefinedNameInfoType.Table:return d.CompletionItemKind.Table;case h.DefinedNameInfoType.Lambda:return d.CompletionItemKind.Lambda;default:return d.CompletionItemKind.NamedOther}}(e),a=e.name;return i===d.CompletionItemKind.Lambda&&(a+=n),{label:e.name,kind:i,type:d.SuggestionKind.Simple,textEdit:{newText:a,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:e.isPrefixed}}))},e.prototype.logFailure=function(e){o.ulsLogger.ULS.traceTag(528562134,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"AutocompleteNamedObjectPlugin encountered a failure with msg ".concat(e))},e}();(0,a.registerPluginFactory)(new y),t.autocompleteNamedObjectsPluginDependenciesResolved=(0,l.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,c.autoCompletePluginsThread.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(S.PluginFactoryName.AutocompleteNamedObjectsPlugin)];case 2:return e.sent(),[4,c.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocompleteTableHeadersPluginDependenciesResolved=t.AutocompleteTableHeadersPluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(12),s=r(5),u=r(23),l=r(13),c=r(31),d=r(6),p=r(21),m=r(2),f=r(6),g=r(541),h=r(86),v=r(9),S=r(6),y=r(22),F=r(14),C=r(542),R=function(){function e(){this.factoryName=S.PluginFactoryName.AutocompleteTableHeadersPlugin}return e.prototype.create=function(){return new b},e}();t.AutocompleteTableHeadersPluginFactory=R;var b=function(){function e(){var e=this;this.getTableHeadersFromServerEnabled=(0,y.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer"),this.fixAutocompleteTableHeadersBugEnabled=(0,F.isChangeGateEnabled)("OfficeVSO:7899833_fixAutocompleteTableHeadersBug"),this.getCompletionItems=function(t,r,n,i,a,o){var s,u="@"===r.charAt(0);if(u||a){var l=u?n+1:n,c=u?r.substring(1):r;return e.generateHeadersCompletionItems(c,t,l,i,!0)}var d=[];if(""===r){var p=null===(s=o[v.SpecialRefId.ThisRow])||void 0===s?void 0:s.substring(1);e.fixAutocompleteTableHeadersBugEnabled?d.push(e.generateThisRowOpCompletionItem(n,n,p)):d.push(e.generateThisRowOpCompletionItem(n,i,p))}return d.push.apply(d,e.generateSpecialCaseCompletionItems(n,i,r,o)),d.push.apply(d,e.generateHeadersCompletionItems(r,t,n,i)),d},this.getHeaderTextEditCallback=function(t){return function(r){var n=P(r);return t&&e.hasSpecialChars(n)?"[".concat(n,"]"):n}},this.hasSpecialChars=function(t){try{return new RegExp("(?=\\P{L})(?=\\P{M})(?=\\P{N})","u").test(t)}catch(t){return e.logFailure("hasSpecialChars method, error: ".concat(t,".")),!0}}}return e.prototype.run=function(e){var t,r,a,l,c,d,h,v,S,y,F,R,b,E,P,k,T,A,N,_,I,O;return n.__generator(this,(function(n){switch(n.label){case 0:return t=e.content,r=e.caretPosition,(0,m.isNone)(t)||(0,m.isNone)(r)?[2,null]:[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:t}];case 1:return(a=n.sent()).kind===i.ComputationRequestKind.ParseActiveCell&&(0,s.isSuccess)(a.result)?a.result.value.kind!==u.EditKind.Formula?[2,null]:(l=a.result.value.formula,[4,{kind:i.ComputationRequestKind.GetDefinedNamesInfo}]):[2,null];case 2:return(c=n.sent()).kind!==i.ComputationRequestKind.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):0===(d=c.definedNamesInfo.filter((function(e){return e.type===f.DefinedNameInfoType.Table})).map((function(e){return e.name})).filter(m.isDefined)).length?[2,null]:(h=this.fixAutocompleteTableHeadersBugEnabled?new g.AutocompleteTableHeadersVisitor(l,r,d):new C.AutocompleteTableHeadersVisitorOld(l,r,d),(0,p.reduceBottomUp)(h,l),v=h.tableName,S=h.containingNode,y=h.isInsideArrayNode,F=h.isNodeClosed,(0,m.isNone)(S)||y?[2,null]:(0,m.isNone)(v)?[4,{kind:i.ComputationRequestKind.GetActiveCell}]:[3,5]);case 3:return(R=n.sent()).kind!==i.ComputationRequestKind.GetActiveCell?(this.logFailure("Couldn't get active cell"),[2,null]):[4,{kind:i.ComputationRequestKind.GetContainingTable,cell:R.activeCell}];case 4:if((b=n.sent()).kind!==i.ComputationRequestKind.GetContainingTable||!(0,s.isSuccess)(b.result))return this.logFailure("GetContainingTable request failed. result kind = ".concat(JSON.stringify(b))),[2,null];if(v=null===(O=b.result.value)||void 0===O?void 0:O.name,(0,m.isNone)(v))return[2,null];n.label=5;case 5:return E=S.start,P=S.end,"]"!==(k=t.charAt(P-1))&&")"!==k||P--,"["===t.charAt(E)&&E++,r===P||this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,E,r)?[4,{kind:i.ComputationRequestKind.GetAvailableTableHeaders,tableName:v}]:[2,null];case 6:return(T=n.sent()).kind!==i.ComputationRequestKind.GetAvailableTableHeaders||!(0,s.isSuccess)(T.result)||(0,m.isNone)(T.result.value)||this.getTableHeadersFromServerEnabled&&T.result.value.isPartial?[3,7]:(A=T.result.value.cols,[3,9]);case 7:return this.getTableHeadersFromServerEnabled?(o.ulsLogger.ULS.traceTag(509682331,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"AutocompleteTableHeadersPlugin getting col headers from server"),[4,{kind:i.ComputationRequestKind.GetFullTableHeadersFromServer,tableName:v}]):[3,9];case 8:if((N=n.sent()).kind!==i.ComputationRequestKind.GetFullTableHeadersFromServer||!(0,m.isDefined)(N.result))return this.logFailure("Failed to get header names from server"),[2,null];A=N.result,n.label=9;case 9:return(0,m.isDefined)(A)&&0!==A.length?(_="",this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,E,r)?P=F?P:E:_=t.substring(E,P),[4,{kind:i.ComputationRequestKind.GetConfig}]):[2,null];case 10:return(I=n.sent()).kind!==i.ComputationRequestKind.GetConfig?(this.logFailure("getConfig request failed"),[2,null]):[2,{items:this.getCompletionItems(A,_,E,P,h.isWithinThisRowOp,I.config.localeInfo.specialRefNames)}]}}))},e.prototype.caretIsInTheBeginning=function(e,t,r){return 0===e.substring(t,r).trim().length},e.prototype.generateCompletionItems=function(e,t,r,n,i,a){var o=[];return e.forEach((function(e){var s="string"==typeof e,u=s?e:e.name,l=s?void 0:e.description;o.push({label:u,kind:i,type:d.SuggestionKind.Simple,textEdit:{newText:(0,m.isDefined)(a)?a(u):u,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:l,isPrefixed:n})})),o},e.prototype.generateHeadersCompletionItems=function(e,t,r,i,a){void 0===a&&(a=!1);var o=(0,h.filterSuggestionsAccordingToPrefix)(e,t),s=o.prefixedSuggestions,u=o.notPrefixedSuggestions,l=this.getHeaderTextEditCallback(a);return n.__spreadArray(n.__spreadArray([],this.generateCompletionItems(s,r,i,!0,d.CompletionItemKind.TableHeader,l),!0),this.generateCompletionItems(u,r,i,!1,d.CompletionItemKind.TableHeader,l),!0)},e.prototype.generateSpecialCaseCompletionItems=function(e,t,r,i){var a=[v.SpecialRefId.All,v.SpecialRefId.Data,v.SpecialRefId.Headers,v.SpecialRefId.Totals].map((function(e){var t;return{name:null!==(t=i[e])&&void 0!==t?t:"",description:E.getValue()[e]}})),o=(0,h.filterSuggestionsAccordingToPrefix)(r,a,(function(e){return e.name})),s=o.prefixedSuggestions,u=o.notPrefixedSuggestions;return n.__spreadArray(n.__spreadArray([],this.generateCompletionItems(s,e,t,!0,d.CompletionItemKind.TableSpecialStructRef),!0),this.generateCompletionItems(u,e,t,!1,d.CompletionItemKind.TableSpecialStructRef),!0)},e.prototype.generateThisRowOpCompletionItem=function(e,t,r){return{label:"@ - ".concat(r),kind:d.CompletionItemKind.TableSpecialStructRef,type:d.SuggestionKind.Simple,textEdit:{newText:"@",range:{start:{line:0,character:e},end:{line:0,character:t}}},detail:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription),shouldRequestAutocompleteOnCommit:!0}},e.prototype.logFailure=function(e){o.ulsLogger.ULS.traceTag(526508764,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"AutocompleteTableHeadersPlugin encountered a failure with msg ".concat(e))},e}();(0,a.registerPluginFactory)(new R),t.autocompleteTableHeadersPluginDependenciesResolved=(0,l.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return(0,y.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer")?[4,c.dynamicPluginLoaderCreated.getValue()]:[3,2];case 1:return e=t.sent(),[3,4];case 2:return[4,c.autoCompletePluginsThread.getValue()];case 3:e=t.sent(),t.label=4;case 4:return[4,e.createAndAttachPlugin(S.PluginFactoryName.AutocompleteTableHeadersPlugin)];case 5:return t.sent(),[4,c.schedulerWithRecalcServiceAttached.getValue()];case 6:return t.sent(),[2]}}))}))}));var E=new l.ResettableLazy((function(){var e;return(e={})[v.SpecialRefId.All]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefAllDescription),e[v.SpecialRefId.Data]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefDataDescription),e[v.SpecialRefId.Headers]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefHeadersDescription),e[v.SpecialRefId.Totals]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefTotalsDescription),e[v.SpecialRefId.ThisRow]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription),e})),P=function(e){return e.replace(/\[|\]|\'|\@|\#/g,"'$&")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parenthesesCouplingPluginDependenciesResolved=t.ParenthesesCouplingPluginFactory=void 0;var n=r(0),i=r(2),a=r(13),o=r(5),s=r(21),u=r(23),l=r(29),c=r(31),d=r(17),p=r(543),m=r(6),f=function(){function e(){this.factoryName=m.PluginFactoryName.ParenthesesCouplingPlugin}return e.prototype.create=function(){return new g},e}();t.ParenthesesCouplingPluginFactory=f;var g=function(){function e(){}return e.prototype.run=function(e){var t,r,a;return n.__generator(this,(function(n){switch(n.label){case 0:return null!=e.selectionLength&&e.selectionLength>0?[2,null]:[4,{kind:d.ComputationRequestKind.ParseActiveCell,formulaText:e.content}];case 1:return(t=n.sent()).kind===d.ComputationRequestKind.ParseActiveCell&&(0,o.isSuccess)(t.result)?t.result.value.kind!==u.EditKind.Formula?[2,null]:(r=t.result.value.formula,a=new p.ParenthesesCouplingVisitor(r,e.caretPosition),(0,s.reduceBottomUp)(a,r),(0,i.isDefined)(a.parenthesesSpan)?[2,this.getParenthesesHighlights(a.parenthesesSpan)]:[2,{formulaHighlights:void 0}]):[2,null]}}))},e.prototype.getParenthesesHighlights=function(e){var t=e.start,r=e.end,n={kind:m.HighlightKind.Parentheses,span:{start:t,end:t+1}};return{formulaHighlights:[{kind:m.HighlightKind.Parentheses,span:{start:r,end:r+1}},n]}},e}();(0,l.registerPluginFactory)(new f),t.parenthesesCouplingPluginDependenciesResolved=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,c.dynamicPluginLoaderCreated.getValue()];case 1:return[4,e.sent().createAndAttachSyncPlugin(m.PluginFactoryName.ParenthesesCouplingPlugin)];case 2:return e.sent(),[4,c.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coloredReferencesPluginDependenciesResolved=t.ColoredReferencesPluginFactory=void 0;var n=r(0),i=r(12),a=r(13),o=r(5),s=r(21),u=r(23),l=r(29),c=r(31),d=r(17),p=r(544),m=r(2),f=r(209),g=r(11),h=r(6),v=function(){function e(){this.factoryName=h.PluginFactoryName.ColoredReferencesPlugin}return e.prototype.create=function(){return new S},e}();t.ColoredReferencesPluginFactory=v;var S=function(){function e(){}return e.prototype.run=function(e){var t,r,i,a,l,c,v,S,F,C,R,b,E;return n.__generator(this,(function(n){switch(n.label){case 0:return t=e.content,[4,{kind:d.ComputationRequestKind.ParseActiveCell,formulaText:t}];case 1:return(r=n.sent()).kind===d.ComputationRequestKind.ParseActiveCell&&(0,o.isSuccess)(r.result)?r.result.value.kind!==u.EditKind.Formula?[2,null]:[4,{kind:d.ComputationRequestKind.GetActiveCell}]:[2,null];case 2:return(i=n.sent()).kind!==d.ComputationRequestKind.GetActiveCell?(y("failed to get active cell"),[2,null]):(a=void 0,[4,{kind:d.ComputationRequestKind.GetSheetNames}]);case 3:return(l=n.sent()).kind===d.ComputationRequestKind.GetSheetNames?a=l:y("failed to get sheet names"),c=void 0,[4,{kind:d.ComputationRequestKind.GetDefinedNamesInfo}];case 4:return(v=n.sent()).kind===d.ComputationRequestKind.GetDefinedNamesInfo?c=v.definedNamesInfo:y("failed to get defined names"),S=i.activeCell,F=r.result.value.formula,C=new p.ColoredReferencesVisitor(S,F,t,a,c),(0,s.reduceBottomUp)(C,F),R=C.formulaHighlights,0===C.structRefNodes.length?[3,6]:(b={originGridCell:(0,o.success)(S.range),originSheet:(0,o.success)(S.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:d.ComputationRequestKind.ResolveReferences,nodes:C.structRefNodes,locals:b}]);case 5:(E=n.sent()).kind===d.ComputationRequestKind.ResolveReferences?R=R.concat(function(e,t,r){var n=[];return r.forEach((function(r){var i,a=e.spans[r.node.label];if(a)if((0,o.isSuccess)(r.resolution))if(void 0!==r.resolution.value){var s=r.resolution.value,u=(0,g.sheetRangeToSheetIndex)(s.sheet);if((0,m.isDefined)(u)&&(0,g.isSheetIndexEqual)(u,t.sheet)){var l=(0,f.gridRangeToRange)(s.range),c={kind:h.HighlightKind.StructRef,span:a,rangeInfo:{range:l}};n.push(c)}}else y("failed to resolve StructRef, resolution value undefined");else y("failed to resolve StructRef, reason: ".concat(null===(i=r.resolution)||void 0===i?void 0:i.reason.kind));else y("failed to resolve StructRef, formulaSpan null")})),n}(F,S,E.resolverResults)):y("failed to resolve node references"),n.label=6;case 6:return[2,{formulaHighlights:R}]}}))},e}();function y(e){i.ulsLogger.ULS.traceTag(525133647,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"ColoredReferencesPlugin encountered a failure with msg ".concat(e))}(0,l.registerPluginFactory)(new v),t.coloredReferencesPluginDependenciesResolved=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,c.dynamicPluginLoaderCreated.getValue()];case 1:return[4,e.sent().createAndAttachSyncPlugin(h.PluginFactoryName.ColoredReferencesPlugin)];case 2:return e.sent(),[4,c.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gotoCtrlClickPluginDependenciesResolved=t.GotoCtrlClickPluginFactory=void 0;var n=r(0),i=r(12),a=r(2),o=r(13),s=r(5),u=r(6),l=r(29),c=r(31),d=r(145),p=r(17),m=r(547),f=r(21),g=r(23),h=function(){function e(){this.factoryName=u.PluginFactoryName.GotoCtrlClickPlugin}return e.prototype.create=function(){return new v},e}();t.GotoCtrlClickPluginFactory=h;var v=function(){function e(){}return e.prototype.run=function(e){var t,r,i,o,l,c,h,v,y,F,C,R,b=e.text,E=e.index;return n.__generator(this,(function(e){switch(e.label){case 0:return t=b,E<0||E>=t.length?(S("caret out of formula scope"),[2,{kind:u.GotoCtrlClickResultKind.NoReferenceFound}]):[4,{kind:p.ComputationRequestKind.ParseActiveCell,formulaText:t}];case 1:return(r=e.sent()).kind===p.ComputationRequestKind.ParseActiveCell&&(0,s.isSuccess)(r.result)?r.result.value.kind!==g.EditKind.Formula?[2,null]:[4,{kind:p.ComputationRequestKind.GetActiveCell}]:[2,null];case 2:return(i=e.sent()).kind!==p.ComputationRequestKind.GetActiveCell?(S("failed to get active cell"),[2,null]):(o=void 0,[4,{kind:p.ComputationRequestKind.GetDefinedNamesInfo}]);case 3:return(l=e.sent()).kind===p.ComputationRequestKind.GetDefinedNamesInfo?o=l.definedNamesInfo:S("failed to get defined names"),c=i.activeCell,h=r.result.value.formula,v=new m.GotoCtrlClickVisitor(h,c.range,o,E),(0,f.reduceBottomUp)(v,h),v.referenceFound?(y=v.sheetRange,(0,a.isDefined)(v.structRefNodeToResolve)?(F=void 0,[4,{kind:p.ComputationRequestKind.GetSheetNames}]):[3,6]):[2,{kind:u.GotoCtrlClickResultKind.NoReferenceFound}];case 4:return(C=e.sent()).kind!==p.ComputationRequestKind.GetSheetNames?(S("failed to get sheet names"),[2,{kind:u.GotoCtrlClickResultKind.RangeResolutionFailure,span:v.span}]):(F=C,[4,{kind:p.ComputationRequestKind.ResolveReferences,nodes:[v.structRefNodeToResolve],locals:{originGridCell:(0,s.success)(c.range),originSheet:(0,s.success)(c.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0}}]);case 5:(R=e.sent()).kind===p.ComputationRequestKind.ResolveReferences?y=(0,d.getSheetRangeFromResolvedRef)(F,R.resolverResults[0],S):S("failed to resolve node references"),e.label=6;case 6:return(0,a.isDefined)(y)?[2,{kind:u.GotoCtrlClickResultKind.ReferenceFound,sheetRange:y,span:v.span}]:[2,{kind:u.GotoCtrlClickResultKind.RangeResolutionFailure,span:v.span}]}}))},e}();function S(e){i.ulsLogger.ULS.traceTag(508687389,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"GotoCtrlClickPlugin encountered a failure with msg ".concat(e))}(0,l.registerPluginFactory)(new h),t.gotoCtrlClickPluginDependenciesResolved=(0,o.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,c.workerThreadSpread.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(u.PluginFactoryName.GotoCtrlClickPlugin)];case 2:return e.sent(),[4,c.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valuePreviewPluginDependenciesResolved=t.ValuePreviewPluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(13),s=r(31),u=r(5),l=r(23),c=r(2),d=r(4),p=r(24),m=r(551),f=r(21),g=r(332),h=r(6),v=r(79),S=r(14),y=v.types.SpecialFormat,F=r(96),C=r(15),R=function(){function e(){this.factoryName=h.PluginFactoryName.ValuePreviewPlugin}return e.prototype.create=function(){return new b},e}();t.ValuePreviewPluginFactory=R;var b=function(){function e(){this.isLocalizedLetEnabled=(0,S.isChangeGateEnabled)("OfficeVSO:8549693_ValuePreviewLocalizedLet"),this.isDetectVolatileEnabled=(0,S.isChangeGateEnabled)("OfficeVSO:8501487_ValuePreviewDetectVolatile"),this.isRelabelPluginFailuresEnabled=(0,S.isChangeGateEnabled)("OfficeVSO:8544629_ValuePreviewFailureCaching"),this.isSnapshotActiveCellEnabled=(0,S.isChangeGateEnabled)("OfficeVSO:8561808_ValuePreviewSnapshotActiveCell")}return e.prototype.run=function(e){var t,r,a,o,s,h,v,S,R,b,k,T,A,N,_,I,O,M,D,w=e.text,L=e.index,x=e.length,K=e.activeCell;return n.__generator(this,(function(e){switch(e.label){case 0:return(0,c.isNone)(w)||(0,c.isNone)(L)||(0,c.isNone)(x)?(P("missing request arguments"),[2,null]):L<0||L+x>w.length?(P("invalid selection, ".concat(w.length,", ").concat(L,", ").concat(x)),[2,null]):[4,{kind:i.ComputationRequestKind.GetActiveCell}];case 1:return(t=e.sent()).kind!==i.ComputationRequestKind.GetActiveCell?this.isRelabelPluginFailuresEnabled?[2,{kind:"Failure",index:L,length:x,reason:"GetActiveCell failed"}]:(P("GetActiveCell fail"),[2,null]):(r=t.activeCell,!this.isSnapshotActiveCellEnabled||(0,c.isNone)(K)||(0,c.isNone)(K.sheetName)||function(e,t){var r=[];e.sheet.index!==t.sheetName&&r.push("sheet");e.range.col!==t.firstColumn&&r.push("col");e.range.row!==t.firstRow&&r.push("row");r.length>0&&d.ulsLogger.ULS.traceTag(507777486,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Info,"ValuePreviewPlugin.areCellsEqual - active cell diff: ".concat(r.join(",")));return 0===r.length}(r,K)?[4,{kind:i.ComputationRequestKind.ParseActiveCell,formulaText:w}]:[3,3]);case 2:return(s=e.sent()).kind===i.ComputationRequestKind.ParseActiveCell&&(0,u.isSuccess)(s.result)?s.result.value.kind!==l.EditKind.Formula?[2,null]:(a=s.result.value.formula,[3,5]):[2,null];case 3:return o=(0,C.unsafeGridRange)(K.firstRow,K.firstColumn,1,1),r=(0,C.sheetGridCell)((0,C.sheetIndex)(r.sheet.document,K.sheetName),o),[4,{kind:i.ComputationRequestKind.ParseCellFormula,cell:r,formula:{formulaBarText:w,kind:F.FormulaKind.CellFormula},useEnglishLocaleInfo:!1}];case 4:if((s=e.sent()).kind!==i.ComputationRequestKind.ParseCellFormula||!(0,u.isSuccess)(s.result))return[2,null];a=s.result.value,e.label=5;case 5:return"Success"!==(h=this.isDetectVolatileEnabled?function(e,t,r,n){var i;i=0===t?{start:1,end:r>0?r:e.length}:{start:t,end:t+r};var a,o=new m.ValuePreviewVisitor(n,i.start,i.end,e);(0,f.reduceBottomUp)(o,n),a=0===r?{start:0===t?t:o.subFormulaStart,end:o.subFormulaEnd}:{start:t,end:t+r};if(-1===a.start||a.end===a.start||o.isBadSelection||r>0&&!E(n,a))return(0,u.failure)("invalid selection");var s=e.substring(a.start,a.end);return(0,u.success)({subFormula:s,subFormulaSpan:a,isVolatile:o.isVolatile,letDefinitions:o.letDefinitions})}(w,L,x,a):function(e,t,r,n){var i,a=void 0;if(e.startsWith("=")&&0===t&&0===r||r===e.length)i={start:0,end:e.length};else if(a=new m.ValuePreviewVisitor(n,t,t+r,e),(0,f.reduceBottomUp)(a,n),-1===(i=0===r?{start:a.subFormulaStart,end:a.subFormulaEnd}:{start:t,end:t+r}).start||i.end===i.start||a.isBadSelection||r>0&&!E(n,i))return(0,u.failure)("invalid selection");var o=e.substring(i.start,i.end);return(0,u.success)({subFormula:o,subFormulaSpan:i,isVolatile:!1,letDefinitions:null==a?void 0:a.letDefinitions})}(w,L,x,a)).kind?[2,null]:(v=h.value.subFormula,S=h.value,R=S.subFormulaSpan,b=S.isVolatile,k=S.letDefinitions,T={index:R.start,length:R.end-R.start},!this.isLocalizedLetEnabled&&(0,c.isDefined)(k)&&(v=k+", "+v+")"),[4,{kind:i.ComputationRequestKind.GetConfig}]);case 6:return(A=e.sent()).kind!==i.ComputationRequestKind.GetConfig?this.isRelabelPluginFailuresEnabled?[2,n.__assign(n.__assign({kind:"Failure"},T),{reason:"GetConfig failed"})]:(P("GetConfig fail"),[2,null]):(this.isLocalizedLetEnabled&&(0,c.isDefined)(k)&&(v=k+A.config.localeInfo.listSeparator+v+")"),N=(v.startsWith("=")?"":"=")+v,[4,{kind:i.ComputationRequestKind.GetActiveCellFormat}]);case 7:return(_=e.sent()).kind!==i.ComputationRequestKind.GetActiveCellFormat?(P("GetActiveCellFormat failed"),[2,n.__assign(n.__assign({kind:"Unavailable",evaluatedFormula:N},T),{isVolatile:b,reason:"GetActiveCellFormat failed"})]):!(0,u.isSuccess)(_.result)||(0,c.isNone)(_.result.value)?(P("Empty cell format"),[2,n.__assign(n.__assign({kind:"Unavailable",evaluatedFormula:N},T),{isVolatile:b,reason:"Empty cell format"})]):(I={kind:y.Edit,renderBlanksAsZeros:!0,isWholeFormula:N===w},[4,{kind:i.ComputationRequestKind.EvalFormula,formula:N,origin:{sheet:r.sheet,range:{col:r.range.col,row:r.range.row,rows:1,cols:1}},format:I}]);case 8:if((O=e.sent()).kind!==i.ComputationRequestKind.EvalFormula)return this.isRelabelPluginFailuresEnabled?[2,n.__assign(n.__assign({kind:"Failure",evaluatedFormula:N},T),{reason:"EvalFormula failed"})]:(P("EvalFormula failed"),[2,null]);switch(M=new g.ValuePreviewResultExtractor(A.config),(D=M.fromEvalFormulaOutput(O.result)).kind){case"Success":return[2,n.__assign(n.__assign(n.__assign(n.__assign({},D),{evaluatedFormula:N}),T),{isVolatile:b})];case"Unavailable":return[2,n.__assign(n.__assign({kind:D.kind,evaluatedFormula:N},T),{isVolatile:b,reason:D.reason})];case"Failure":return[2,n.__assign(n.__assign({kind:D.kind,evaluatedFormula:N},T),{reason:D.reason})]}return[2]}}))},e}();function E(e,t){var r=0===t.start||Object.keys(e.spans).some((function(r){var n;return(null===(n=e.spans[Number(r)])||void 0===n?void 0:n.start)===t.start})),n=Object.keys(e.spans).some((function(r){var n;return(null===(n=e.spans[Number(r)])||void 0===n?void 0:n.end)===t.end}));return r&&n}function P(e){d.ulsLogger.ULS.traceTag(521692767,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,"ValuePreviewPlugin encountered a failure with msg ".concat(e))}(0,a.registerPluginFactory)(new R),t.valuePreviewPluginDependenciesResolved=(0,o.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.workerThreadSpread.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(h.PluginFactoryName.ValuePreviewPlugin)];case 2:return e.sent(),[4,s.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewResultExtractor=void 0;var n=r(0),i=r(2),a=r(5),o=r(51),s=r(72),u=r(23),l=r(54),c=r(38),d=r(4),p=r(149),m=r(14),f=function(){function e(e){this.onlyFallbackToServerOnSpecificErrorsEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8501092_ValuePreviewSpecificErrorFallback"),this.isUnavailableDetailedReasonEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8545001_ValuePreviewUnavailableReason"),this.isUnformattedStringFixEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8524802_ValuePreviewUnformattedString"),this.isBooleanFixEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8561267_ValuePreviewUnformattedBoolean"),this.isUnformattedBlankFixEnabled=(0,m.isChangeGateEnabled)("OfficeVSO:8554558_ValuePreviewUnformattedBlank"),this.mathpack=e.mathpack,this.localeInfo=e.localeInfo}return e.prototype.fromEvalFormulaOutput=function(e){var t=e.value,r=e.formatted;switch(t.kind){case a.ResultKind.Success:return this.resultFromSuccess(t.value,r);case a.ResultKind.Failure:return this.resultFromFailureReason(t.reason);default:return t}},e.prototype.resultFromSuccess=function(e,t){var r;switch(e.kind){case o.OperKind.String:case o.OperKind.Array:case o.OperKind.Blank:case o.OperKind.Number:r=this.resultFromFormatted(t);break;case o.OperKind.Boolean:r=this.isBooleanFixEnabled?this.resultFromBoolean(e):this.resultFromFormatted(t);break;case o.OperKind.Error:r=this.resultFromError(e,t);break;default:return{kind:"Failure",reason:"Unsupported operKind: ".concat(e.kind)}}if("Success"!==r.kind)return r;var i=this.getUnformattedValue(e,r);return n.__assign(n.__assign({},r),{unformattedValue:i,operKind:e.kind})},e.prototype.resultFromFormatted=function(e){if((0,i.isNone)(e))return{kind:"Failure",reason:"No formatted value"};switch(e.kind){case a.ResultKind.Success:if((0,u.isHashesValue)(e.value)){var t=e.value.units;return r="Evaluate HashesValue: ".concat(t.kind),d.ulsLogger.ULS.traceTag(520680450,p.LogCategory.msoulscat_ES_EWAJS,p.TraceLevel.Warning,"ValuePreviewResultExtractor encountered a failure with msg ".concat(r)),{kind:"Failure",reason:"HashesValue: ".concat(t.kind)}}return this.resultFromFormattedValue(e.value);case a.ResultKind.Failure:return this.resultFromFailureReason(e.reason);default:return e}var r},e.prototype.resultFromFormattedValue=function(e){var t=c.render.renderValue(this.mathpack,e,u.renderInfiniteWidth);if(t.kind===a.ResultKind.Failure)return{kind:"Failure",reason:"renderValue fail"};if((0,u.isHashesValue)(t.value)){var r=t.value.units;return{kind:"Failure",reason:"Render HashesValue: ".concat(r.kind)}}return{kind:"Success",value:(0,u.renderedValueToString)(t.value),color:e.color}},e.prototype.resultFromFailureReason=function(e){if(!this.isUnavailableDetailedReasonEnabled)return this.resultFromFailureReasonOld(e);var t=function(e){switch(e.kind){case l.ReasonKind.Unavailable:return"Unavailable - [".concat(e.objects.map((function(e){return"kind"in e?e.kind:""})).join(","),"]");case l.ReasonKind.NotImplemented:return"NotImplemented - [".concat(e.features.join(","),"]");case l.ReasonKind.PreviousFailure:return"PreviousFailure";default:return"".concat(e.kind)}}(e);switch(e.kind){case l.ReasonKind.Unavailable:case l.ReasonKind.NotImplemented:case l.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:"FailureReason: ".concat(t)};default:return{kind:"Failure",reason:"Unsupported FailureReason: ".concat(t)}}},e.prototype.resultFromFailureReasonOld=function(e){switch(e.kind){case l.ReasonKind.Unavailable:case l.ReasonKind.NotImplemented:case l.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:"FailureReason: ".concat(e.kind)};default:return{kind:"Failure",reason:"Unsupported FailureReason: ".concat(e.kind)}}},e.prototype.resultFromError=function(e,t){if(!this.onlyFallbackToServerOnSpecificErrorsEnabled)return{kind:"Unavailable",reason:"Unsupported error: ".concat(e.type)};switch(e.type){case s.ErrorType.NAME:case s.ErrorType.VALUE:case s.ErrorType.FIELD:return{kind:"Unavailable",reason:"Unsupported error: ".concat(e.type)}}return this.resultFromFormatted(t)},e.prototype.getUnformattedValue=function(e,t){var r=t.value;return e.kind===o.OperKind.String&&(t.value='"'.concat(t.value,'"'),this.isUnformattedStringFixEnabled&&(r=e.value)),e.kind===o.OperKind.Number&&(r=this.mathpack.toNumber(e).toString()),e.kind===o.OperKind.Blank&&this.isUnformattedBlankFixEnabled&&(r=this.mathpack.toNumber(this.mathpack.zero).toString()),r},e.prototype.resultFromBoolean=function(e){var t=e.value?this.localeInfo.trueName:this.localeInfo.falseName;return{kind:"Success",value:t,unformattedValue:t,operKind:o.OperKind.Boolean}},e}();t.ValuePreviewResultExtractor=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridInterface=t.SheetInterface=t.RangeInterface=void 0;var n=r(0),i=r(222),a=r(60),o=r(291),s=r(235),u=r(127),l=r(236),c=r(99);function d(e){return void 0!==e&&e.hasOwnProperty("value")}var p=function(){function e(){this.map={}}return e.prototype.set=function(e,t,r){e in this.map||(this.map[e]={}),this.map[e][t]=r},e.prototype.get=function(e,t){if(e in this.map&&t in this.map[e])return this.map[e][t]},e}(),m=function(){function e(e,t,r,n,i,a,o){this.grid=e,this.scheduler=t,this.sheetId=r,this.row=n,this.col=i,this.rows=a,this.cols=o}return e.prototype.setRange=function(e){var t=e.map((function(e){return e.map((function(e){return d(e)?e.value:e}))})),r=e.map((function(e){return e.map((function(e){return d(e)?e.format:void 0}))})),n=e.map((function(e){return e.map((function(e){return d(e)?e.formulaBarText:void 0}))}));this.grid.setRange(this.sheetId,this,t,r,n)},e.prototype.setTable=function(e,t,r){var i,s,u=this,l=[!(null!==(i=null==e?void 0:e.hideHeadersRow)&&void 0!==i&&i),null!==(s=null==e?void 0:e.hasTotalsRow)&&void 0!==s&&s],c=l[0],d=l[1];this.setRange(c?n.__spreadArray([t],r,!0):r);var p=[(0,o.namedObjectsWrite)(void 0,[(0,o.namedObject)(e.name,(0,o.namedTableData)((0,o.sheetRangeLocation)(this.sheetId,this.firstRow+(c?1:0),this.firstColumn,this.firstRow+r.length-(d?1:0),this.firstColumn+t.length-1),c,d,t.map((function(e,t){return(0,o.columnData)(u.firstColumn+t,e)}))))])];this.grid.setNamedObjects(p),this.scheduler.doNotify(a.NotificationKind.updateNamedObjects,[0,p])},Object.defineProperty(e.prototype,"topLeft",{get:function(){return{row:this.firstRow,col:this.firstColumn,rows:1,cols:1}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstRow",{get:function(){return this.row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstColumn",{get:function(){return this.col},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastRow",{get:function(){return this.row+this.rows-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastColumn",{get:function(){return this.col+this.cols-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sheet",{get:function(){return{document:{name:"",path:void 0},index:this.sheetId,index2:this.sheetId}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this.firstRow},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"colIndex",{get:function(){return this.firstColumn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sheetIndex",{get:function(){return this.sheet.index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docPath",{get:function(){var e;return null!==(e=this.sheet.document.path)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docName",{get:function(){return this.sheet.document.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tables",{get:function(){var e=this,t=this;return this.grid.getIntersectingTables(0,this).then((function(r){return n.__awaiter(e,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,t.grid.discardSnapshot(0)];case 1:return e.sent(),[2,"Success"===r.kind?r.value.tables:[]]}}))}))}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellValues",{get:function(){return this.cells.then((function(e){return e.map((function(e){return e.map((function(e){return e.value}))}))}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellFormats",{get:function(){return this.cells.then((function(e){return e.map((function(e){return e.map((function(e){return e.format}))}))}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cells",{get:function(){var e=this,t=this;return t.grid.getRangeValues(0,t).then((function(r){return t.grid.getRangeFormats(0,t).then((function(i){return n.__awaiter(e,void 0,void 0,(function(){var e=this;return n.__generator(this,(function(a){return[2,t.grid.getRangeFormulae(0,t).then((function(a){return n.__awaiter(e,void 0,void 0,(function(){var e,u,l,c,d,p,m;return n.__generator(this,(function(n){switch(n.label){case 0:for(e=h("Success"===r.kind?r.value.nonEmptyCells:[],(function(e){return(0,o.readOperToCellValue)(s.xlMathpack,e)})),u=h("Success"===i.kind?i.value.nonEmptyCells:[],(function(e){return Number(e)})),l=h("Success"===a.kind?a.value.nonEmptyCells:[],(function(e){return e})),c=[],d=t.firstRow;d<=t.lastRow;d++)for(c.push([]),p=t.firstColumn;p<=t.lastColumn;p++)c[d-t.firstRow].push({value:e.get(d,p),formulaBarText:null===(m=l.get(d,p))||void 0===m?void 0:m.formulaBarText,format:u.get(d,p)});return[4,t.grid.discardSnapshot(0)];case 1:return n.sent(),[2,c]}}))}))}))]}))}))}))}))},enumerable:!1,configurable:!0}),e}();t.RangeInterface=m;var f=function(){function e(e,t,r){this.grid=e,this.scheduler=t,this.id=r;var n={config:(0,u.calcConfig)((0,u.getEnglishLocaleInfo)(),void 0,s.xlMathpack)};this.parser=(0,l.createParser)(n)}return e.prototype.get=function(e){var t=this.parseRangeIndex(e);return this.getCoordinates(t.firstRow,t.firstColumn,t.lastRow,t.lastColumn)},e.prototype.getCoordinates=function(e,t,r,n){return new m(this.grid,this.scheduler,this.id,e,t,(null!=r?r:e)-e+1,(null!=n?n:t)-t+1)},e.prototype.parseRangeIndex=function(e){var t={col:0,row:0,cols:1,rows:1},r=this.parser.parseFormulaExpression((0,l.parseLocals)(i.LexicalKind.Range,t),e);if("Success"!==r.kind||"CellRef"!==r.value.node.kind)throw"Could not parse range: ".concat(e);var n=(0,c.getRangeFromCellRef)(r.value.node.ref,t,(function(e){throw e}));if(void 0===n)throw"Could not parse range: ".concat(e);return n},e}();t.SheetInterface=f;var g=function(){function e(e,t){this.grid=e,this.scheduler=t,this.sheets={}}return e.prototype.createSheet=function(e){var t=new f(this.grid,this.scheduler,e);return this.grid.setSheet(e,e,[[]]),this.sheets[e]=t,this.scheduler.doNotify(a.NotificationKind.updateSheetNames,[0,[{sheetId:e,sheetName:e}]]),t},e}();function h(e,t){for(var r,n,i=new p,a=0,o=e;a<o.length;a++)for(var s=o[a],u=s[0],l=u[0],c=u[1],d=null!==(r=u[2])&&void 0!==r?r:1,m=null!==(n=u[3])&&void 0!==n?n:1,f=s[1],g=l;g<l+d;g++)for(var h=c;h<c+m;h++)i.set(g,h,t(f));return i}t.GridInterface=g},function(e,t,r){r(335),r(336),e.exports=r(337)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,i=void 0,a=function(e,t){p[r]=e,p[r+1]=t,2===(r+=2)&&(i?i(m):S())},o="undefined"!=typeof window?window:void 0,s=o||{},u=s.MutationObserver||s.WebKitMutationObserver,l="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(m,1)}}var p=new Array(1e3);function m(){for(var e=0;e<r;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;r=0}var f,g,h,v,S=void 0;function y(e,t){var r=this,n=new this.constructor(R);void 0===n[C]&&O(n);var i=r._state;if(i){var o=arguments[i-1];a((function(){return _(i,n,o,r._result)}))}else A(r,n,e,t);return n}function F(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(R);return E(t,e),t}l?S=function(){return process.nextTick(m)}:u?(g=0,h=new u(m),v=document.createTextNode(""),h.observe(v,{characterData:!0}),S=function(){v.data=g=++g%2}):c?((f=new MessageChannel).port1.onmessage=m,S=function(){return f.port2.postMessage(0)}):S=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(m)}:d()}catch(e){return d()}}():d();var C=Math.random().toString(36).substring(2);function R(){}function b(t,r,n){r.constructor===t.constructor&&n===y&&r.constructor.resolve===F?function(e,t){1===t._state?k(e,t._result):2===t._state?T(e,t._result):A(t,void 0,(function(t){return E(e,t)}),(function(t){return T(e,t)}))}(t,r):void 0===n?k(t,r):e(n)?function(e,t,r){a((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?E(e,r):k(e,r))}),(function(t){n||(n=!0,T(e,t))}),e._label);!n&&i&&(n=!0,T(e,i))}),e)}(t,r,n):k(t,r)}function E(e,t){if(e===t)T(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(n=t),null===n||"object"!==i&&"function"!==i)k(e,t);else{var r=void 0;try{r=t.then}catch(t){return void T(e,t)}b(e,t,r)}var n,i}function P(e){e._onerror&&e._onerror(e._result),N(e)}function k(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(N,e))}function T(e,t){void 0===e._state&&(e._state=2,e._result=t,a(P,e))}function A(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=r,i[o+2]=n,0===o&&e._state&&a(N,e)}function N(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,a=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+r],n?_(r,n,i,a):i(a);e._subscribers.length=0}}function _(t,r,n,i){var a=e(n),o=void 0,s=void 0,u=!0;if(a){try{o=n(i)}catch(e){u=!1,s=e}if(r===o)return void T(r,new TypeError("A promises callback cannot return that same promise."))}else o=i;void 0!==r._state||(a&&u?E(r,o):!1===u?T(r,s):1===t?k(r,o):2===t&&T(r,o))}var I=0;function O(e){e[C]=I++,e._state=void 0,e._result=void 0,e._subscribers=[]}var M=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(R),this.promise[C]||O(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&k(this.promise,this._result))):T(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===F){var i=void 0,a=void 0,o=!1;try{i=e.then}catch(e){o=!0,a=e}if(i===y&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===D){var s=new r(R);o?T(s,a):b(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?T(n,r):this._result[t]=r),0===this._remaining&&k(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;A(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),D=function(){function t(e){this[C]=I++,this._result=this._state=void 0,this._subscribers=[],R!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){E(e,t)}),(function(t){T(e,t)}))}catch(t){T(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return D.prototype.then=y,D.all=function(e){return new M(this,e).promise},D.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var i=e.length,a=0;a<i;a++)r.resolve(e[a]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},D.resolve=F,D.reject=function(e){var t=new this(R);return T(t,e),t},D._setScheduler=function(e){i=e},D._setAsap=function(e){a=e},D._asap=a,D.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=D},D.Promise=D,D.polyfill(),D},e.exports=n()},function(e,t){!function(e,t){"use strict";if(!e.setImmediate){var r,n,i,a,o,s=1,u={},l=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){m(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){m(e.data)},r=function(e){i.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,r=function(e){var t=c.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(m,0,e)}:(a="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&m(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return u[s]=i,r(s),s++},d.clearImmediate=p}function p(e){delete u[e]}function m(e){if(l)setTimeout(m,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{p(e),l=!1}}}}}("undefined"==typeof self?"undefined"==typeof global?this:global:self)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsistentAnonymizer=t.x10TypesSubpackage=t.syntaxSubpackage=t.runtimeSubpackage=t.recalcSubpackage=t.numfmtSubpackage=t.langSubpackage=t.commonSubpackage=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.x10=t.worker=t.style=t.funcs=t.calc=t.runtime=t.numfmt=t.analyze=t.parse=t.date=t.math=t.config=t.util=t.signature=t.value=t.formula=t.location=t.common=t.sheetName=t.FormulaAuthoringHelperSingletonGlobal=t.PluginSchedulerSingletonGlobal=t.packageVersion=void 0;var n=r(0),i=r(338);Object.defineProperty(t,"packageVersion",{enumerable:!0,get:function(){return i.packageVersion}});var a=n.__importStar(r(146));t.common=a;var o=n.__importStar(r(222));t.location=o;var s=n.__importStar(r(233));t.formula=s;var u=n.__importStar(r(399));t.value=u;var l=n.__importStar(r(400));t.signature=l;var c=n.__importStar(r(401));t.util=c;var d=n.__importStar(r(127));t.config=d;var p=n.__importStar(r(235));t.math=p;var m=n.__importStar(r(407));t.date=m;var f=n.__importStar(r(236));t.parse=f;var g=n.__importStar(r(416));t.analyze=g;var h=n.__importStar(r(169));t.numfmt=h;var v=n.__importStar(r(428));t.runtime=v;var S=n.__importStar(r(291));t.calc=S;var y=n.__importStar(r(528));t.funcs=y;var F=n.__importStar(r(529));t.style=F;var C=n.__importStar(r(530));t.worker=C;var R=n.__importStar(r(532));t.x10=R;var b=r(97),E=r(562);t.PluginSchedulerSingletonGlobal=new b.PluginSchedulerSingleton,t.FormulaAuthoringHelperSingletonGlobal=new E.FormulaAuthoringHelperSingleton;var P=r(77);Object.defineProperty(t,"sheetName",{enumerable:!0,get:function(){return P.sheetName}});var k=r(22);Object.defineProperty(t,"getTypedFeatureGate",{enumerable:!0,get:function(){return k.getTypedFeatureGate}}),Object.defineProperty(t,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return k.isTypedChangeGateEnabled}});var T=n.__importStar(r(1));t.commonSubpackage=T;var A=n.__importStar(r(3));t.langSubpackage=A;var N=n.__importStar(r(38));t.numfmtSubpackage=N;var _=n.__importStar(r(315));t.recalcSubpackage=_;var I=n.__importStar(r(55));t.runtimeSubpackage=I;var O=n.__importStar(r(37));t.syntaxSubpackage=O;var M=n.__importStar(r(79));t.x10TypesSubpackage=M;var D=r(210);Object.defineProperty(t,"ConsistentAnonymizer",{enumerable:!0,get:function(){return D.ConsistentAnonymizer}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="52.7.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0;t.fnv1a=function(e){for(var t=2166136261,r=e.length,n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,r,n){void 0===r&&(r=function(){return""}),void 0===n&&(n=function(){return 1});for(var i=[e],a=new Set(i),o=0;o<i.length;o+=1)for(var s=0,u=t(i[o]);s<u.length;s++){var l=u[s];a.has(l)||(a.add(l),i.push(l))}a.clear(),i.reverse();var c=new Map,d=[],p=new Map,m=[];i.forEach((function(e,i){var a=t(e).map((function(e){return c.get(e)}));if(a.some((function(e){return void 0===e})))throw new Error("Circular references in the tree");var o=a.map((function(e){return d[e]})),s=function(e){var t=p.get(e);return void 0!==t||(t=p.size,p.set(e,t)),t}(o.join("/")+"/"+r(e));if(d.push(s),void 0===m[s]){var u=o.map((function(e){return m[e]})),l=u.map((function(e){return e.size})).reduce((function(e,t){return e+t}),n(e)),f=u.map((function(e){return e.depth})).reduce((function(e,t){return Math.max(e,t)}),0)+1;m[s]={subtrees:[e],size:l,depth:f}}else m[s].subtrees.push(e);c.set(e,i)}));for(var f=0,g=m;f<g.length;f++){(y=g[f]).subtrees.reverse()}for(var h=new Array(i.length),v=0,S=m;v<S.length;v++){var y=S[v];h[h.length-c.get(y.subtrees[0])-1]=y}return h.filter((function(e){return void 0!==e}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=void 0;var n=r(0);t.combinations=function e(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===t.length)return[[]];for(var i=t[0],a=t.slice(1),o=e.apply(void 0,a),s=[],u=0,l=i;u<l.length;u++)for(var c=l[u],d=0,p=o;d<p.length;d++){var m=p[d];s.push(n.__spreadArray([c],m,!0))}return s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=void 0,t.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a={};return Object.keys(n).forEach((function(t){a[t]=e(n[t],r+1)})),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},i=1;i<=t;i+=1)n(i);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var i=e[n];r=r.catch((function(){return t(i)}))},i=1;i<e.length;i+=1)n(i);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,i=0;i<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==n-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));var a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function i(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=n(),r=e,a=t,o={},s=function(e,t,n){return function(e,t,r,n,a,o){i(e,"end",r);var s={sessionName:t,result:n?"success":"failure",message:o,marks:e},u=JSON.stringify(s);a(u)}(o,r,a,e,t,n)};return o.start=0,{mark:function(e){return function(e){return i(o,e,a)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var i=n(),a=r;return{reset:function(e){null!=e&&(a=e),i=n()},stop:function(r){var o=n()-i,s=JSON.stringify({Target:a,Duration:o.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var n=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var i=!1,a=r.performance;try{a&&a.now&&a.now()!==1/0&&(i=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var o=0;o<e.length;o+=1){try{if(i){t.perfNow=!0;var s=Math.floor(100*a.now())%10;(s<0||s>9)&&(s=0);for(var u=0;u<s;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[o]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(n||(t.TextAreaVirtualKeyboardPolicy=n={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(i||(t.TextAreaInputMode=i={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0;t.replaceChildren=function(e){if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)};t.isReplaceChildrenSupported=function(e){return!!e.replaceChildren}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(151);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(152);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),i=r(152);function a(e){var t=(0,i.setChangeGateDictionaryGetter)(void 0);return(0,i.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=a,t.overrideTypedChangeGates=function(e,t){return a(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),i=r(151);function a(e){for(var t,r,a={},o=0,s=Object.keys(e);o<s.length;o++){var u=s[o];a[u]=null===(t=e[u])||void 0===t?void 0:t.toString()}var l=null!==(r=(0,i.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,i.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},l()),a)})),l}t.overrideFeatureGates=a,t.overrideTypedFeatureGates=function(e,t){return a(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var n,i,a=r(70),o=r(211),s=(n=.4531024141007942,i=null!=Object({NODE_ENV:"production"}).BXL_RUN?n:Math.random()*Date.now(),new o.JSF32(i));function u(e){return(0,a.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(s.next()*e))}t.randomFloat=function(){return s.next()},t.randomIndex=u,t.randomShuffled=function(e){return e.map((function(e){return[s.next(),e]})).sort((function(e,t){return e[0]<t[0]?-1:e[0]===t[0]?0:1})).map((function(e){return e[1]}))},t.randomElement=function(e){return e[u(e.length)]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(100);function i(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}t.floorToPowerOf2=i;var a=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],i=this.values[r];e(n,i)&&t.push([n,i])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,r=this.keys.map((function(e,r){return[e,t.values[r],r]})),n=r.length;e.forEach((function(e,t){var i=e[0],a=e[1];return r.push([i,a,t+n])})),r.sort((function(e,r){var n=e[0],i=e[2],a=r[0],o=r[2],s=t.keyCompare(n,a);return 0!==s?s:i-o}));for(var i=[],a=void 0,o=0;o<r.length;o+=1){var s=r[o],u=s[0],l=s[1];void 0===a||0!==this.keyCompare(u,a)?(i.push([u,l]),a=u):i[i.length-1]=[u,l]}return this.ofSequence(i)},e.prototype.getKeyIndex=function(e){for(var r=t.RootPointer;r>=0&&r<this.keys.length;){var n=this.keyCompare(e,this.keys[r]);if(0===n)return r;n<0?r=s(r):n>0&&(r=u(r))}},e.prototype.ofSequence=function(r){var n=this,a=r.slice();a.sort((function(e,t){var r=e[0],i=t[0];return n.keyCompare(r,i)}));for(var o=new Array(a.length),l=new Array(a.length),c=function(e){var r=new Array(e);return function e(t,r,n,a){if(t>=r.length)return;var o=function(e){var t=i(e);if(t/2-1<=e-t)return t-1;return e-t/2}(a);r[t]=n+o,e(s(t),r,n,o),e(u(t),r,n+o+1,a-o-1)}(t.RootPointer,r,0,e),r}(a.length),d=0;d<a.length;d+=1){var p=a[c[d]],m=p[0],f=p[1];o[d]=m,l[d]=f}return new e(this.keyCompare,o,l)},e}();function o(e,t){var r=[];return function e(t,r,n){if(r<0||r>=t.keys.length)return;e(t,s(r),n),n.push([t.keys[r],t.values[r]]),e(t,u(r),n)}(e,t,r),r}function s(e){return 2*e+1}function u(e){return 2*e+2}t.ArrayMapTree=a,t.RootPointer=0,t.enumerateInOrder=o,t.enumerateKeysInOrder=function(e,t){return o(e,t).map((function(e){return e[0]}))}},function(e,t,r){"use strict";function n(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;var i=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[n(this.front+t,r)]=this.values[n(this.front+t,e)];this.values.length=r,this.front=n(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[n(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=n(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[n(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.peekPos=function(e){if(!(e<0||e>=this.count))return this.values[n(this.front+e,this.values.length)]},e.prototype.popBack=function(){var e=n(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=n(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[n(this.front+r,t)]))return!1}return!0},e}();t.Deque=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;var n=r(100),i=r(49);function a(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,i.makeStringMap)(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)?n.value:void 0},getEntry:function(e){var t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue:function(e,r){var a=this.keyToString(e),o=t(this.entries,a)?this.entries[a]:void 0;(0,i.isDefined)(o)?o.value=r:this.entries[a]=(0,n.entry)(e,r)},contains:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)},remove:function(e){var r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var a=this.keyToString(e),o=t(this.entries,a)?this.entries[a]:void 0;if((0,i.isDefined)(o))return o.value;var s=r();return delete this.entries[a],this.entries[a]=(0,n.entry)(e,s),s},forEach:function(e){for(var r in this.entries){var n=t(this.entries,r)?this.entries[r]:void 0;if((0,i.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}t.makeDictionary=a,t.makeStringDict=function(){return a(i.identity)},t.makeNumberDict=function(){return a((function(e){return String(e)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;var n=r(49),i=r(215);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add:function(e){var t=this.keyToHash(e);if((0,n.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var r=this.map[t],a=0;a<r.length;a+=1)if(this.keyEquals(e,r[a]))return;(0,i.logCollisionKey)(e),r.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;for(var a=0;a<r.length;a+=1)if(this.keyEquals(e,r[a]))return!0;return(0,i.logCollisionKey)(e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(r){t.map[Number(r)].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,r=this.keyToHash(e),a=this.map[r];if((0,n.isNone)(a))return!1;var o=[],s=!1;return a.forEach((function(r){t.keyEquals(e,r)?(t.nelements-=1,s=!0):o.push(r)})),this.map[r]=o,s||(0,i.logCollisionKey)(e),s}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;var n=r(100),i=r(215),a=r(49);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount:function(){return this.nentries},getValue:function(e){var t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry:function(e){var t=this.keyToHash(e),r=this.map[t];if(!(0,a.isNone)(r)){for(var n=0;n<r.length;n+=1){var o=r[n];if(this.keyEquals(e,o.key))return o}(0,i.logCollisionKey)(e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,t){var r=this.keyToHash(e),a=this.map[r];if(null==a)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(var o=0;o<a.length;o+=1){var s=a[o];if(this.keyEquals(s.key,e))return void(s.value=t)}a.push((0,n.entry)(e,t)),this.nentries+=1,(0,i.logCollisionKey)(e)}},remove:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,a.isNone)(r))return!1;for(var n=[],o=!1,s=0;s<r.length;s+=1){var u=r[s];this.keyEquals(e,u.key)?(this.nentries-=1,o=!0):n.push(u)}return this.map[t]=n,o||(0,i.logCollisionKey)(e),o},getOrSetValue:function(e,t){var r=this.keyToHash(e),o=this.map[r];if((0,a.isNone)(o)){var s=t();return this.map[r]=[(0,n.entry)(e,s)],this.nentries+=1,s}for(var u=0;u<o.length;u+=1){var l=o[u];if(this.keyEquals(e,l.key))return l.value}var c=t();return o.push((0,n.entry)(e,c)),this.nentries+=1,(0,i.logCollisionKey)(e),c},forEach:function(e){var t=this;return Object.keys(this.map).every((function(r){return t.map[Number(r)].every((function(t){return e(t.key,t.value)}))}))},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0;var n=function(){function e(e){var t,r,n=this;this.buckets=e,this.createSampleCounts=function(){return new Array(n.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=(t=function(e,t){return e-t},r=n.buckets.length,function(e){return i(n.buckets,0,r,e,t)})}return e.prototype.addSample=function(e){var t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1},e.prototype.reset=function(){var e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e},e}();function i(e,t,r,n,i){for(var a=t,o=t+r-1;a<=o;){var s=a+(o-a>>>1),u=i(e[s],n);if(0===u)return s;u<0?a=s+1:o=s-1}return~a}t.Histogram=n,t.linearBuckets=function(e,t,r){for(var n=(t-e)/(r-1),i=[],a=e,o=0;o<r;a+=n,o+=1)i.push(a);return i},t.exponentialBuckets=function(e,t,r){for(var n=Math.log(e),i=(Math.log(t)-n)/(r-1),a=[],o=0,s=0;s<r;o+=i,s+=1)a.push(Math.exp(n+o));return a},t.binarySearch=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var n=r(213),i=function(){function e(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((function(t,r){var n=t[0],i=t[1],a=r[0],o=r[1],s=e(n,a);return 0!==s?s:i-o}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e.prototype.clear=function(){this.heap.clear()},e}();t.PriorityQueue=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;var n=r(0),i=r(214),a=function(e,t){var r,n,i=e[0],a=t[0];return r=String(i),n=String(a),r<n?-1:r>n?1:0},o={};var s=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t.push([i,e[i].id])}var s=function(e){for(var t="",r=0,n=e;r<n.length;r++){var i=n[r];t+=String(i[0]),t+="\0",t+=String(i[1]),t+="\0"}return t}(t.sort(a)),u=o[s];return void 0===u&&(u={box:{},probabilities:{},depth:1},o[s]=u),u};function u(e){return Object.getOwnPropertyNames(e).length>0}function l(e){return u(e)?{isSubspace:!0,bounds:e}:i.dense}function c(e){return e.isSubspace?1:e.subspaceCount}var d=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:c(e)+c(t)}};function p(e,t){if(t===i.dense)return t;if(t.isSubspace){for(var r=!1,n=0,a=Object.keys(t.bounds);n<a.length;n++){var o=a[n];if(Object.prototype.hasOwnProperty.call(e,o)){r=!0;break}}if(!r)return i.dense}return{productOperations:e,root:t}}function m(e){return void 0===e?i.dense:e}var f={unzip:function(e){for(var t={},r={},n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];if(Object.prototype.hasOwnProperty.call(e,o)){var s=e[o];if(s===i.empty)return i.empty;if(s===i.dense)continue;t[o]=s.setOperations,r[o]=s.root}}return p(t,l(r))},combineProduct:function(e,t,r,n){for(var a={},o=0,s=Object.keys(e);o<s.length;o++){var u=s[o];if(Object.prototype.hasOwnProperty.call(e,u)){var l=n(e[u],e[u].top,m(t[u]),m(r[u]));if(l===i.empty)return i.empty;if(l===i.dense)continue;a[u]=l}}return a},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},i=0,a=t;i<a.length;i++){var o=a[i];if(Object.prototype.hasOwnProperty.call(e,o)){var s=e[o];n[o]=s}}return n},fromUntypedProduct:function(e,t,r){for(var n={},a=0,o=r;a<o.length;a++){var s=o[a],u=t[s];n[s]=(0,i.fromUntyped)(e[s],void 0!==u?u:i.dense)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=i.dense}return t}};function g(e,t,r){var n=f.combineProduct(e,t,r,i.unionUntyped);if(n===i.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function h(e,t,r){for(var n=0,a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];if(Object.prototype.hasOwnProperty.call(e,s)){var u=m(t[s]),l=m(r[s]),c=e[s];if(void 0===(n=(0,i.combineCmp)(n,(0,i.compareUntyped)(c,c.top,u,l))))return}}return n}t.createFromProduct=f.unzip.bind(f);var v,S=(v={},function(e,t,r){var a;if(t===v.left&&r===v.right)return v.res;v.left=t,v.right=r;var o,s=h(e,t.bounds,r.bounds);if(void 0!==s)return v.res=s<=0?r:t;for(var u=0,c=Object.keys(e);u<c.length;u++){var d=c[u];if(Object.prototype.hasOwnProperty.call(e,d)&&0!==(0,i.compareUntyped)(e[d],e[d].top,m(t.bounds[d]),m(r.bounds[d]))){if(void 0!==o)return v.res=void 0;o=d}}if(void 0!==o){var p=(0,i.unionUntyped)(e[o],e[o].top,m(t.bounds[o]),m(r.bounds[o]));if(p===i.empty)return v.res=i.empty;if(p===i.dense){var f=t.bounds,g=o,S=(f[g],n.__rest(f,["symbol"==typeof g?g:g+""]));return v.res=l(S)}var y=n.__assign(n.__assign({},t.bounds),((a={})[o]=p,a));return v.res=l(y)}return v.res=void 0});function y(e,t,r){if(r===i.empty)return t;if(r===i.dense)return r;if(t===i.empty)return r;if(t===i.dense)return t;if(!t.isSubspace||!r.isSubspace)return d(t,r,g(e,t.bounds,r.bounds));var n=S(e,t,r);return void 0!==n?n:d(t,r,g(e,t.bounds,r.bounds))}function F(e,t,r){for(var a=[],o=3;o<arguments.length;o++)a[o-3]=arguments[o];if(t===i.empty||t===i.dense)return t;if(t.isSubspace){var s=f.restrict.apply(f,n.__spreadArray([t.bounds],a,!1));return l(s)}var u=R(e,r),c=u[0],d=u[1],p=b(e,t,c,d),m=p[0],g=p[1],h=F.apply(void 0,n.__spreadArray([e,m,c],a,!1)),v=F.apply(void 0,n.__spreadArray([e,g,d],a,!1));return y(e,h,v)}function C(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===i.dense||e===i.empty)return e;var a=f.restrict.apply(f,n.__spreadArray([e.productOperations],t,!1));if(!u(a))return i.dense;var o=F.apply(void 0,n.__spreadArray([a,e.root,s(a)],t,!1));return o===i.empty?o:p(a,o)}function R(e,t){var r,a,o,s;if(void 0!==t.children)return t.children;for(var u,l,c=t.box,d=t.probabilities,p=0,f=0,g=Object.keys(e);f<g.length;f++){var h=g[f];if(Object.prototype.hasOwnProperty.call(e,h)){var v=d[h],S=e[h];if(void 0===v){u=h,l=S.top;break}if(v>p){var y=m(c[h]);if(y===i.empty)throw new Error("the key split can never return empty");var F=S.top;if(y!==i.dense){if(!y.isExact)throw new Error("the key can always be represented exactly");F=y.key}if(!S.canSplit(F))continue;u=h,p=v,l=F}}}if(void 0===u||void 0===l)throw new Error("there has to be at least one dimension");var C=e[u],R=C.split(l),b=R[0],E=b[0],P=b[1],k=R[1],T=k[0],A=k[1],N=[{box:n.__assign(n.__assign({},c),(r={},r[u]=(0,i.lazy)(C,C.top,E),r)),probabilities:n.__assign(n.__assign({},d),(a={},a[u]=P,a)),depth:t.depth+1},{box:n.__assign(n.__assign({},c),(o={},o[u]=(0,i.lazy)(C,C.top,T),o)),probabilities:n.__assign(n.__assign({},d),(s={},s[u]=A,s)),depth:t.depth+1}];return t.depth<10&&(t.children=N),N}t.project=C;var b=function(e,t,r,n){return function e(t,r,n,a){if(r===i.empty)return[i.empty,i.empty];if(r===i.dense)return[l(n),l(a)];var o=h(t,r.bounds,n);if(void 0!==o&&o<=0)return[r,i.empty];var s=f.combineProduct(t,r.bounds,n,i.intersectUntyped);if(s===i.empty)return[i.empty,r];var u=f.combineProduct(t,r.bounds,a,i.intersectUntyped);if(r.isSubspace)return[l(s),u===i.empty?i.empty:l(u)];var c=e(t,r.left,n,a),d=c[0],p=c[1],m=e(t,r.right,n,a),g=m[0],v=m[1];return[y(t,d,g),y(t,p,v)]}(e,t,r.box,n.box)};function E(e,t,r,n,a){var o=R(e,n),s=o[0],u=o[1],l=b(e,t,s,u),c=l[0],d=l[1],p=b(e,r,s,u),m=p[0],f=p[1],g=a(e,c,m,s);return g===i.dense?i.dense:y(e,g,a(e,d,f,u))}function P(e,t,r,n){if(r===i.empty)return t;if(t===i.empty)return r;if(t===i.dense)return t;if(r===i.dense)return r;if(t.isSubspace&&r.isSubspace){var a=S(e,t,r);if(void 0!==a)return a}return E(e,t,r,n,P)}function k(e,t){if(t===i.empty)return e;if(t===i.dense)return t;if(e===i.empty)return t;if(e===i.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),a=P(r,e.root,t.root,s(r));return a===i.empty?a:p(r,a)}function T(e,t,r,n){if(t===i.empty||r===i.empty)return i.empty;if(t===i.dense)return r;if(r===i.dense)return t;if(t.isSubspace&&r.isSubspace){var a=f.combineProduct(e,t.bounds,r.bounds,i.intersectUntyped);return a===i.empty?i.empty:l(a)}return E(e,t,r,n,T)}function A(e,t,r,a){if(t===i.empty)return t;if(r===i.dense)return i.empty;if(r===i.empty)return t;if(t===i.dense)return E(e,t,r,a,A);if(t.isSubspace&&r.isSubspace){var o=function(e,t,r){var a,o,s=h(e,t.bounds,r.bounds);if(0===s||-1===s)return i.empty;for(var u=0,c=Object.keys(e);u<c.length;u++){var d=c[u];if(Object.prototype.hasOwnProperty.call(e,d)){var p=(0,i.compareUntyped)(e[d],e[d].top,m(t.bounds[d]),m(r.bounds[d]));if(void 0===p||p>0){if(void 0!==o)return;o=d}}}if(void 0!==o){var f=(0,i.exceptUntyped)(e[o],e[o].top,m(t.bounds[o]),m(r.bounds[o]));if(f===i.empty)return i.empty;if(f===i.dense){var g=t.bounds,v=o;g[v];return l(n.__rest(g,["symbol"==typeof v?v:v+""]))}return l(n.__assign(n.__assign({},t.bounds),((a={})[o]=f,a)))}}(e,t,r);if(void 0!==o)return o}return E(e,t,r,a,A)}function N(e,t){if(e===i.empty)return e;if(t===i.empty)return e;if(t===i.dense)return i.empty;if(e===i.dense){var r=A(t.productOperations,i.dense,t.root,s(t.productOperations));return r===i.empty?r:p(t.productOperations,r)}var a=n.__assign(n.__assign({},e.productOperations),t.productOperations),o=A(a,e.root,t.root,s(a));return o===i.empty?o:p(a,o)}function _(e,t,r,n){if(t===i.empty||r===i.empty)return!1;if(t===i.dense||r===i.dense)return!0;if(!function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];if(Object.prototype.hasOwnProperty.call(e,o)){var s=m(t[o]),u=m(r[o]),l=e[o];if(!(0,i.meetsUntyped)(l,l.top,s,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var a=R(e,n),o=a[0],s=a[1],u=b(e,t,o,s),l=u[0],c=u[1],d=b(e,r,o,s),p=d[0],f=d[1];return _(e,l,p,o)||_(e,c,f,s)}t.unionProduct=k,t.intersectProduct=function(e,t){if(e===i.empty)return e;if(t===i.empty)return t;if(e===i.dense)return t;if(t===i.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),a=T(r,e.root,t.root,s(r));return a===i.empty?a:p(r,a)},t.exceptProduct=N,t.compareProduct=function(e,t){if(e===t)return 0;if(e===i.empty)return-1;if(t===i.empty)return 1;if(e===i.dense)return t===i.dense?0:1;if(t===i.dense)return-1;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return function e(t,r,n,a){if(r===n)return 0;if(r===i.empty)return-1;if(n===i.empty)return 1;if(r===i.dense)return n===i.dense?0:1;if(n===i.dense)return-1;if(r.isSubspace&&n.isSubspace)return h(t,r.bounds,n.bounds);var o=R(t,a),s=o[0],u=o[1],l=b(t,r,s,u),c=l[0],d=l[1],p=b(t,n,s,u),m=p[0],f=p[1],g=e(t,c,m,s);return void 0!==g?(0,i.combineCmp)(g,e(t,d,f,u)):void 0}(r,e.root,t.root,s(r))},t.meetsProduct=function(e,t){if(e===i.empty||t===i.empty)return!1;if(e===i.dense||t===i.dense)return!0;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return _(r,e.root,t.root,s(r))};t.complementProduct=function(e){return N(i.dense,e)};t.symmetricDiffProduct=function(e,t){return k(N(e,t),N(t,e))},t.getSubspaces=function(e){if(e===i.empty||e===i.dense)return[];var t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var o=C.apply(void 0,n.__spreadArray([e],r,!1));if(o===i.empty)return!0;if(o===i.dense)return t(f.denseProduct(r));var s=o.productOperations,u=o.root;function l(e){return e.isSubspace?t(f.fromUntypedProduct(s,e.bounds,r)):l(e.left)&&l(e.right)}return l(u)},t.getSubspaceCount=function(e){return e===i.empty||e===i.dense?0:c(e.root)};var I=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),O=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function M(e,t){return function(r,i){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];var s=t.get(r);void 0===s?(e.apply(void 0,n.__spreadArray([r,i],a,!1)),t.set(r,t.size)):i.push("__cached__",s)}}function D(e,t){return function(r){for(var i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];if("__cached__"===r.pick()){r.pop();var o=r.pop();return t[o]}var s=e.apply(void 0,n.__spreadArray([r],i,!1));return t.push(s),s}}var w=function(){function e(t){var r,n,a,o,s=this;for(var u in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new O,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==i.empty&&e!==i.dense){var r=e,n=s.getDims(r.productOperations);t.push(n),s.serializeUntypedSparseProductCached(r.root,t,n)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===i.empty||t===i.dense)return t;e.putBack(t);for(var r={},n=e.pop(),a=0,o=n;a<o.length;a++){var u=o[a],l=s.globalProductOperations[u];r[u]=l}return{productOperations:r,root:s.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=function(t,r,n){r.push(null==t?void 0:t.isExact),r.push(s.serializers[n].serializeBound(null==t?void 0:t.infimum)),r.push(s.serializers[n].serializeBound(null==t?void 0:t.supremum));var a=e.normalizeKey(null==t?void 0:t.key);r.push(s.serializers[n].serializeKey(a));for(var o=0,u=[null==t?void 0:t.left,null==t?void 0:t.right];o<u.length;o++){var l=u[o];null==l||l===i.empty||l===i.dense?r.push(l):(r.push("us"),s.serializeUntypedSparseCached(l,r,n))}},this.deserializeUntypedSparse=function(e,t){var r=e.pop(),n=s.serializers[t].deserializeBound(e.pop()),i=s.serializers[t].deserializeBound(e.pop()),a=s.serializers[t].deserializeKey(e.pop()),o=["left","right"].map((function(r){var n=e.pop();return"us"===n?s.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:i,isExact:r,key:a,left:o[0],right:o[1]}},this.serializeUntypedSparseProduct=function(e,t,r){t.push(e.isSubspace);for(var n=0,i=r;n<i.length;n++){var a=i[n],o=e.bounds[a];s.serializeUntypedSparseCached(o,t,a)}e.isSubspace||(s.serializeUntypedSparseProductCached(e.left,t,r),s.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var r=e.pop(),n={},i=0,a=t;i<a.length;i++){var o=a[i],u=s.deserializeUntypedSparseCached(e,o);n[o]=u}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:s.deserializeUntypedSparseProductCached(e,t),right:s.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=M(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=D(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=M(this.serializeProductSet,this.cached),this.deserializeProductSetCached=D(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=M(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=D(this.deserializeUntypedSparseProduct,this.cache),t){var l={serializeKey:null!==(r=t[u].serializeKey)&&void 0!==r?r:function(e){return JSON.stringify(e)},deserializeKey:null!==(n=t[u].deserializeKey)&&void 0!==n?n:function(e){return JSON.parse(e)},serializeBound:null!==(a=t[u].serializeBound)&&void 0!==a?a:function(e){return JSON.stringify(e)},deserializeBound:null!==(o=t[u].deserializeBound)&&void 0!==o?o:function(e){return JSON.parse(e)}};this.serializers[u]=l}}return e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var r=0,n=e;r<n.length;r++){var i=n[r];this.serializeProductSetCached(i,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new I(JSON.parse(e)),r=t.pop(),n=[],i=0;i<r;i+=1){var a=this.deserializeProductSetCached(t);n.push(a)}return n},e.normalizeKey=function(e){if("object"==typeof e){var t=n.__assign({},e);return delete t.depth,delete t.split,t}return e},e}();t.ProductSetSerializer=w,t.productSetSerializer=function(e){return new w(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(217),i=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(n.emptyUntyped,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t=(0,n.findUntyped)(this,e,this.root);return null==t?void 0:t.value},e.prototype.getEntry=function(e){return(0,n.findUntyped)(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return(0,n.forEachUntyped)(e,this.root)},e.prototype.setValue=function(t,r){return new e((0,n.insertUntyped)(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e((0,n.removeUntyped)(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var i=this.getValue(t);if(void 0!==i)return[this,i];var a=r();return[new e((0,n.insertUntyped)(this,t,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(t){var r=this,i=n.emptyUntyped,a=0;return this.forEach((function(e,o){return t(e,o)&&(i=(0,n.insertUntyped)(r,e,o,i),a+=1),!1})),new e(i,a,this.keyCompare)},e}();t.RedBlackMapTree=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0;var n=function(){function e(e){void 0===e&&(e=1/0),this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}return e.prototype.count=function(){return this.counter},e.prototype.isEmpty=function(){return 0===this.counter},e.prototype.enqueue=function(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},e.prototype.dequeue=function(){if(!this.isEmpty()){var e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}},e.prototype.executeOnEveryElement=function(e){for(var t=0;t<this.counter;t++){var r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n)if(!e(n))return!1}return!0},e}();t.RingBuffer=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var n,i,a=r(0),o=r(49),s=r(100);function u(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var i=e.slice(0,-1);return t<e.length-1&&(i[t]=e[e.length-1]),i}function l(e,t,r){return{kind:e,key:t,value:r}}function c(e,t){return l(n.Ptr,e,t)}function d(e,t){return l(n.Leaf,e,t)}function p(e,t){return l(n.Branch,e,t)}t.copyExcept=u,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(n||(t.RTKind=n={})),function(e){e[e.NotFound=1]="NotFound",e[e.Removed=2]="Removed",e[e.Delete=3]="Delete"}(i||(i={}));var m=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,i,a){void 0===a&&(a=2);var o=a>1?Math.ceil(a):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:i,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!1,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,i){var a=r.keyCompare(i.key,e);if(i.kind===n.Ptr)return 0===a?i.value:void 0;if(!(void 0===a||a<0))for(var o=0,s=i.value;o<s.length;o++){var u=t(r,s[o]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:(0,s.entry)(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var i=y(this.lattice,this.root,t,n,r);return void 0!==i?i===this.root?this:new e(this.lattice,i,this.count):new e(this.lattice,S(this.lattice,this.root,c(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==y(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return f(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return f(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return f(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return f(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var a=[],s=this.lattice,l=function(e,r){var c=s.keyCompare(e.key,t);if(void 0===c||c<0)return(0,o.pair)(e,i.NotFound);if(e.kind===n.Leaf){for(var m=e.value,f=0;f<m.length;f+=1)if(0===s.keyCompare(m[f].key,t)){if((F=u(m,f)).length<r){var g=d(e.key,F);return a.push(g),(0,o.pair)(g,i.Delete)}return(0,o.pair)(d(h(s,F),F),i.Removed)}}else for(m=e.value,f=0;f<m.length;f+=1){var v=l(m[f],s.minChildren),S=v[0],y=v[1];if(y===i.Delete){var F;if((F=u(m,f)).length>=r)return(0,o.pair)(p(h(s,F),F),i.Removed);g=p(e.key,F);return a.push(g),(0,o.pair)(g,i.Delete)}if(y===i.Removed)return(0,o.pair)(p(e.key,u(m,f,S)),i.Removed)}return(0,o.pair)(e,i.NotFound)},m=this.root.kind===n.Leaf?1:2,g=l(this.root,m),v=g[0],y=g[1];if(v===this.root)return this;for(var F=y===i.Delete?void 0:v,C=0;C<a.length;C+=1)f(a[C],(function(e,t){return F=S(r.lattice,F,c(e,t)),!0}));return new e(this.lattice,F,this.count-1)},e}();function f(e,t,r,i){var a=void 0!==r?r:function(){return!0},o=void 0!==i?i:function(){return!0};if(null==e)return!0;var s=function(e){if(!a(e.key))return!0;if(e.kind===n.Leaf)for(var r=e.value,i=0;i<r.length;i+=1){var u=r[i];if(o(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,i=0;i<r.length;i+=1)if(!s(r[i]))return!1;return!0};return s(e)}function g(e,t){for(var r=function(e,t){for(var r=0,n=1,i=e.keyDistance(t[0].key,t[1].key),a=2;a<t.length;a+=1)for(var s=0;s<a;s+=1){var u=e.keyDistance(t[s].key,t[a].key);u>i&&(r=s,n=a,i=u)}return(0,o.pair)(r,n)}(e,t),n=r[0],i=r[1],a=t[n].key,s=t[i].key,u=[],l=0;l<t.length;l+=1){var c=t[l];u.push([c,e.keyDistance(a,c.key)-e.keyDistance(s,c.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var d=e.minChildren;d<t.length-e.minChildren&&u[d][1]<0;d+=1);var p=[],m=[];for(l=0;l<d;l+=1)p.push(u[l][0]);for(l=d;l<t.length;l+=1)m.push(u[l][0]);return(0,o.pair)(p,m)}function h(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function v(e,t,r){var n=g(e,r),i=n[0],a=n[1];return(0,o.pair)(l(t,h(e,i),i),l(t,h(e,a),a))}function S(e,t,r){if(null==t)return d(r.key,[r]);var i=function t(i){if(i.kind===n.Leaf){var s=a.__spreadArray(a.__spreadArray([],i.value,!0),[r],!1);if(s.length>e.maxChildren){var u=v(e,i.kind,s),l=u[0],c=u[1];return(0,o.pair)(d(l.key,l.value),c)}return(0,o.pair)(d(e.keyJoin(i.key,r.key),s),void 0)}var m=i.value.slice(),f=function(e,t,r){for(var n=0,i=e.keyDistance(t[0].key,r),a=t[0].value.length,o=1;o<t.length;o+=1){var s=t[o],u=e.keyDistance(s.key,r);(u<i||u===i&&s.value.length<a)&&(n=o,i=u,a=s.value.length)}return n}(e,m,r.key),g=t(m[f]),h=g[0],S=g[1];if(m[f]=h,null!=S&&(m.push(S),m.length>e.maxChildren)){var y=v(e,i.kind,m),F=y[0];c=y[1];return(0,o.pair)(p(F.key,F.value),c)}return(0,o.pair)(p(e.keyJoin(i.key,r.key),m),void 0)}(t),s=i[0],u=i[1];return null!=u?p(e.keyJoin(s.key,u.key),[s,u]):s}function y(e,t,r,i,a){if(void 0!==t)return function t(i){if(i.kind!==n.Leaf)for(a=0;a<i.value.length;a+=1){s=i.value[a];if(e.keyMeets(s.key,r))if(void 0!==(l=t(s)))return p(i.key,u(i.value,a,l))}else for(var a=0;a<i.value.length;a+=1){var s,l;if(void 0!==(l=o(s=i.value[a])))return d(i.key,u(i.value,a,l))}}(t);function o(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&i(t.value)?c(t.key,a):t}}t.RTree=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;var n=r(49),i=r(216);function a(e,t,r){var n=Math.pow(t,e),i=1-Math.pow(t/r,e),a=Math.pow(r,e),o=a*n,s=a-n,u=-1/e;return{cdf:1===e?function(e){return(1-n/e)/i}:function(t){return(1-n*Math.pow(t,-e))/i},invCdf:1===e?function(e){return 1/((a-e*s)/o)}:function(e){return Math.pow((a-e*s)/o,u)}}}function o(e,t,r){var i=a(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],a=i.cdf(r),o=i.cdf(t+1),s=i.invCdf((a+o)/2),u=(0,n.fastMin)((0,n.fastMax)(Math.round(s),t+1),r-1);return[[[t,u],i.cdf(u)-i.cdf(t+1)],[[u,r],i.cdf(r)-i.cdf(u)]]}}}t.boundedPareto=a,t.boundedParetoSplitter=o,t.boundedParetoSetOperations=function(e,t,r,a,s){var u=o(e,t,r);return{id:s,split:function(e){return u.split(e)},canSplit:function(e){return u.canSplit(e)},meets:i.ivlMeets,intersect:i.ivlMeet,union:function(e,t){return(0,i.ivlMeetsOrTouches)(e,t)?(0,i.ivlJoin)(e,t):void 0},except:i.ivlExcept,compare:i.ivlCompare,top:a,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return(0,n.fastMin)(e,t)},combineSuprema:function(e,t){return(0,n.fastMax)(e,t)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.sparseArray2DTo1D=t.transposeSparseArray2D=t.transposeArray2D=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.StrictArray2D=void 0;var n=r(70),i=r(49),a=function(){function e(e,t,r){(0,n.assertNatural)("calc.common.StrictArray2D",e),(0,n.assertNatural)("calc.common.StrictArray2D",t);var i=r.length;i<e&&(0,n.assertFalse)("calc.common.StrictArray2D: expected elements.length >= ".concat(e,"; given ").concat(i));for(var a=0;a<i;a+=1){var o=r[a].length;o<t&&(0,n.assertFalse)("calc.common.StrictArray2D: expected elements[".concat(a,"].length >= ").concat(e,"; given ").concat(o))}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new s(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();t.StrictArray2D=a;var o=function(){function e(e,t,r,i,a,o){(0,n.assertNatural)("calc.common.StrictSparseArray2D",e),(0,n.assertNatural)("calc.common.StrictSparseArray2D",t),(0,n.assertIndex)("calc.common.StrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.StrictSparseArray2D",i,t+1);var s=a.length;s<r&&(0,n.assertFalse)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(r,"; given ").concat(s));for(var u=0;u<s;u+=1){var l=a[u].length;l<i&&(0,n.assertFalse)("calc.common.StrictSparseArray2D: expected elements[".concat(u,"].length >= ").concat(i,"; given ").concat(l))}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseElements=a,this.sparseElement=o}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new u(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}();t.StrictSparseArray2D=o;var s=function(){function e(e,t,r){(0,n.assertNatural)("calc.common.NonstrictArray2D",e),(0,n.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=l(this.rows,this.cols,this.func);return new a(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}();t.NonstrictArray2D=s;var u=function(){function e(e,t,r,i,a,o){(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",i,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseFunc=a,this.sparseFunc=o}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=l(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new o(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function l(e,t,r){for(var n=[],i=0;i<e;i+=1){for(var a=[],o=0;o<t;o+=1)a[o]=r(i,o);n[i]=a}return n}function c(e,t,r){for(var n=[],i=[],a=0;a<t;a+=1)i[a]=r;for(var o=0;o<e;o+=1)n[o]=i;return n}function d(e,t,r){return new s(e,t,(function(e,t){return r}))}t.NonstrictSparseArray2D=u,t.array2DForall=function(e,t){for(var r=0;r<t.rows;r+=1)for(var n=0;n<t.cols;n+=1)if(!e(t.get(r,n)))return!1;return!0},t.array2DForall2=function(e,t,r){for(var n=(0,i.fastMin)(t.rows,r.rows),a=(0,i.fastMin)(t.cols,r.cols),o=0;o<n;o+=1)for(var s=0;s<a;s+=1)if(!e(t.get(o,s),r.get(o,s)))return!1;return!0},t.jaggedArray=l,t.array2DToJaggedArray=function(e){return l(e.rows,e.cols,e.get.bind(e))},t.constantArray=c,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new s(1,e.length,(function(t,r){return e[r]}))},t.colArray2D=function(e){return new s(e.length,1,(function(t,r){return e[t]}))},t.transposeArray2D=function(e){return new s(e.cols,e.rows,(function(t,r){return e.get(r,t)}))},t.transposeSparseArray2D=function(e){return new u(e.cols,e.rows,e.denseCols,e.denseRows,(function(t,r){return e.get(r,t)}),(function(){return e.getSparse()}))},t.sparseArray2DTo1D=function(e,t){var r=e.getSparse.bind(e);return(0,n.assertTrue)("calc.common.sparseArray2DTo1D",t?0===e.cols||e.rows>0:0===e.rows||e.cols>0),t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}},t.broadcastArray=function(e,t,r,n,i,a){if(e===r&&t===n)return i;if(1===e&&1===t)return c(r,n,void 0===i[0]?a:i[0][0]);var o,s=[];o=1===e?function(e,r){return r<t?i[0][r]:a}:1===t?function(t,r){return t<e?i[t][0]:a}:function(r,n){return r<e&&n<t?i[r][n]:a};for(var u=0;u<r;u+=1){s.push([]);for(var l=0;l<n;l+=1)s[u][l]=o(u,l)}return s},t.broadcastArray2D=function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new s(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new s(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new s(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=t.asyncLoopFactory=t.delayPromiseImpl=void 0;var n=r(49),i=r(123),a=r(218);function o(e){return function(t){return new Promise((function(r){return e.setTimeout(r,t,void 0)}))}}function s(e){return function(t,r){var a,o,s,u=null!==(a=null==r?void 0:r.timeThreshold)&&void 0!==a?a:10,l=null!==(o=null==r?void 0:r.costThreshold)&&void 0!==o?o:1,c=null!==(s=null==r?void 0:r.macrotaskDelay)&&void 0!==s?s:0,d={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},p=(0,i.newPromise)(),m=p[0],f=p[1],g=f[0],h=f[1];var v=!0;var S=e(c),y=(0,n.now)();return function r(){if(!v||!function(){try{for(var e=0;e<l;){d.iterations+=1;var r=t();if(void 0===r)return!1;e+=r}return!0}catch(e){return h(e),!1}}())return g();var i=(0,n.now)();i-y<u?(Promise.resolve().then(r),d.microtaskContinues+=1):(S.then((function(){S=e(c),y=(0,n.now)(),d.macrotaskTotalDelay+=y-i,r()})),d.macrotaskContinues+=1)}(),{promise:m,stop:function(){v=!1},stats:d}}}t.delayPromiseImpl=o,t.asyncLoopFactory=s,t.asyncLoop=s(o(a.defaultSetTimeoutInterface))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;var n=r(0),i=r(24),a=n.__importStar(r(80)),o=r(70),s=r(219),u=r(150),l=r(148),c=r(123),d=r(373);t.initCalcCalled=new c.ResolvablePromise,t.maxRetriesForLoadingScript=9;var p=/^(https)|(http)|(file):\/\//,m=!1,f=void 0;function g(){if(null==f)throw new Error("initCalc was not passed calcAbsUrl");return f}function h(e,r,n,c){if(m){o.ulsLogger.ULS.traceTag(595910878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{if(o.ulsLogger.setLogger(e),(0,s.initStopwatch)(e),(0,u.initFeatureConfiguration)(r),null!=n&&!p.test(n)){var g="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(n);o.ulsLogger.ULS.traceTag(595910879,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,g)}a.setConfig(null!=c?c:{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError:function(e){var t={error:(0,l.messageFromError)(e),innerError:e.info.error?(0,l.messageFromError)(e.info.error):void 0},r="calc.onWorkerError: ".concat(JSON.stringify(t));o.ulsLogger.ULS.traceTag(593335298,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},onCreateWorker:function(e){var t="calc.onCreateWorker: ".concat(JSON.stringify(e));o.ulsLogger.ULS.traceTag(593335299,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}}),f=n,m=!0;var h=" (".concat("production",")"),v="calc.config.initCalc: package version ".concat(d.packageVersion).concat(h," initialized");o.ulsLogger.ULS.traceTag(594642132,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,v),t.initCalcCalled.resolve(void 0)}}t.isCalcInit=function(){return m},t.getCalcAbsUrl=function(){return f},t.getCalcAbsUrlOrThrow=g,t.initCalc=function(e,t,r){h(e,t,r,void 0)},t.initCalcInThread=function(e,t,r,i){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,a.Endpoint.createOutside(e)];case 1:return o=n.sent(),h((s=o.post,u=function(e){return"[".concat((new Date).toISOString(),"] ").concat(e)},{shipAssertTag:function(e,t,r,n){s.shipAssertTag(e,t,r,u(n))},assertTag:function(e,t,r,n){s.assertTag(e,t,r,u(n))},traceTag:function(e,t,r,n){s.traceTag(e,t,r,u(n))},debugTraceTag:function(e,t,r,n){s.debugTraceTag(e,t,r,u(n))},dnmTraceTag:function(e,t,r,n){s.dnmTraceTag(e,t,r,u(n))}}),(function(e){return!0===t[e]}),r,i),[2]}var s,u}))}))},t.initCalcThread=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r,i,s,l;return n.__generator(this,(function(n){switch(n.label){case 0:t=g(),r=new MessageChannel,i={port:r.port1,options:{id:"WorkerThreadLogger"}},s={port:r.port2,options:{id:"WorkerThreadLogger"}},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Promise.all([a.Endpoint.createInside(i,(function(){return o.ulsLogger.noThrowLogger})),e.call.initCalcThreadInside.transfer([s.port],s,(0,u.getFeatures)(),t)])];case 2:return[2,n.sent()[0]];case 3:throw l=n.sent(),i.port.close(),l;case 4:return[2]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packageVersion=void 0,t.packageVersion="7.4.18"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var n=r(0);t.mixin=function(e,t,r){return function(e){function i(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var a=e.apply(this,n)||this,o=t(a),s=0,u=r;s<u.length;s++){var l=u[s];Object.defineProperty(a,l,{value:o[l].bind(o),enumerable:!1,configurable:!1})}return a}return n.__extends(i,e),i}(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeIsInClass=t.forEachClassInterval=t.codePointIterator=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;var n=r(49);function i(e){return 55296==(64512&e)}function a(e){return 56320==(64512&e)}function o(e){return 55296==(63488&e)}function s(e,t){if(i(e)&&a(t))return 65536+((1023&e)<<10|1023&t)}function u(e,t){var r=e.charCodeAt(t);if(!o(r))return r;if(t+1>=e.length)return 65533;var n=s(r,e.charCodeAt(t+1));return null!=n?n:65533}function l(e){return e>=65536?2:1}function c(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2){t(e[r],e[r+1])}}t.isHighSurrogate=i,t.isLowSurrogate=a,t.isAnySurrogate=o,t.surrogatePairToCodePoint=s,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)},t.scanCodePoints=function(e,t,r){for(var n=t,o=0;o<r;o+=1){if(n>=e.length)return;i(e.charCodeAt(n))&&n+1<e.length&&a(e.charCodeAt(n+1))?n+=2:n+=1}return n},t.scanCodePointsBack=function(e,t,r){for(var n=t,o=0;o<r;o+=1){if(n-1<0)return;a(e.charCodeAt(n-1))&&n-2>=0&&i(e.charCodeAt(n-2))?n-=2:n-=1}return n},t.countCodePoints=function(e,t,r){for(var n=0,o=t;o<r;n+=1){i(e.charCodeAt(o))&&o+1<r&&a(e.charCodeAt(o+1))?o+=2:o+=1}return n},t.stringCodePointAt=u,t.numCodeUnits=l,t.codePointIterator=function(e,t){void 0===t&&(t=0);for(var r=[],n=t;n<e.length;){var i=u(e,n);r.push(i),n+=l(i)}return r},t.forEachClassInterval=c;t.makeIsInClass=function(e){var t=function(e){for(var t=[],r=0;r<512;++r)t.push([]);return c(e,(function(e,r){for(var i=r-1>>7,a=e>>7;a<=i;++a){var o=a<<7,s=a+1<<7;t[a].push((0,n.fastMax)(e,o),(0,n.fastMin)(r,s))}})),t}(e);return function(e){if(e<0||e>65535)return!1;for(var r=t[e>>>7],n=0;n<r.length;n+=2){var i=r[n],a=r[n+1];if(e>=i&&e<a)return!0}return!1}}},function(e,t,r){"use strict";function n(){return function(e){return function(e){for(var t=function(e){this.obj=e},r=function(e){t.prototype[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=(t=this.obj)[e].apply(t,r);return Promise.resolve(i)}},n=0,i=e;n<i.length;n++){r(i[n])}return t}(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=n,t.wrapIntoAsync=function(e,t){return new(n()(t))(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var n=r(0);t.createArrayLogger=function(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=function(){return!0});var i=new Set,a=new Set;return{log:[],addTriggerListener:function(e){i.add(e)},waitForMessage:function(e,t){var r=this;return new Promise((function(n){var i=setTimeout((function(){console.warn("ArrayLogger.waitForMessage: timed out waiting for message; timeout = ".concat(t)),n(!1)}),t);r.addTriggerListener((function(t){var r=e(t);return r&&(clearTimeout(i),n(!0)),r}))}))},waitForReceivedButDelayedMessages:function(){var e=[];return a.forEach((function(t){return e.push(t)})),Promise.all(e).then((function(){}))},addLogMessage:function(o){var s=this;if(t(o)){var u=new Promise((function(t){var a;a=function(){s.log.push(o),e&&console.log.apply(console,n.__spreadArray([(new Date).toISOString()],o,!1)),i.forEach((function(e){e(o)&&i.delete(e)})),t()},void 0===r?a():setTimeout((function(){return a()}),r)})).then((function(){a.delete(u)}));a.add(u)}},shipAssertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["shipAssertTag",e]);var r=e[2],n=e[3];if(!r)throw new TypeError("shipAssertTag: ".concat(n))},assertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["assertTag",e]);var r=e[2],n=e[3];if(!r)throw new TypeError("assertTag: ".concat(n))},traceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["traceTag",e])},dnmTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["dnmTraceTag",e])},debugTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["debugTraceTag",e])}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.AssertLogger=t.ConsoleLogger=void 0;var n=r(150),i=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){if(console.assert(r,"shipAssertTag2 ".concat(e," ").concat(t," ").concat(n)),!r)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.assertTag=function(e,t,r,n){if(console.assert(r,"assertTag2 ".concat(e," ").concat(t," ").concat(n)),!r)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag2",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag2",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag2",e,n,t,r)},e}();t.ConsoleLogger=i;var a=function(){function e(){this.traceTag=function(){},this.debugTraceTag=function(){},this.dnmTraceTag=function(){}}return e.prototype.shipAssertTag=function(e,t,r,n){if(!r)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.assertTag=function(e,t,r,n){if(!r)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(n))},e}();t.AssertLogger=a,t.featureEnabledDummyCallback=function(e){switch(e){case n.FeatureName.FeatureCheckingEnabled:return!0;case n.FeatureName.CalcRecordFunctions:case n.FeatureName.CalcNestedRecordFunction:case n.FeatureName.CalcLetRecFunction:case n.FeatureName.CalcLambdaBasicFunctions:case n.FeatureName.CalcLambdaDefaultParameters:case n.FeatureName.CalcLambdaCellValues:case n.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(220),i=r(153),a=function(){function e(t,r,i){this.transition=t,this.onFulfilled=r,this.onRejected=i,this.runStatus=!(t instanceof e||t.kind===n.TransitionKind.CallMachine)&&t}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e},e.prototype.next=function(){return this.transition instanceof e?this.transition=(0,n.callMachineTransition)(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if((0,i.isSuccess)(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState((0,i.failure)((0,i.javaScriptError)(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState((0,i.success)(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new n.AllMachine(t.map(e.resolve)))},e.prototype.settle=function(){return new n.MachineRuntime(this).runToResult()},e.settleOrThrow=function(e){var t=e.settle();if((0,i.isSuccess)(t))return t.value;throw t.reason.error},e.resolve=function(t){return t instanceof e?t:new e((0,i.success)(t),void 0,void 0)},e.reject=function(t){return new e((0,i.failure)(t),void 0,void 0)},e.undefinedPledge=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefinedPledge,void 0,void 0);return r.transition=(0,n.callMachineTransition)(t,r),r},e.try=function(t){return e.undefinedPledge.bind(t)},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?(0,n.callMachineTransition)(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return(0,i.isSuccess)(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?(0,i.success)(this.accum):(this.accum=e,n.nextTransition)},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}();t.Pledge=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwAfterSteps=t.pauseAfterSteps=void 0,t.pauseAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),r=0;return function(){return(r+=1)>=t}},t.throwAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),r=0;return function(){if((r+=1)<t)return!1;throw t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevocableSingleton=void 0;var n=function(){function e(e,t){var r=this;this.target=e,this.isRevoked=!1;var n=function(e){if(r.isRevoked)throw new TypeError("".concat(String(e),": ").concat(t))};this.proxy="undefined"==typeof Proxy?e:new Proxy(e,{get:function(e,t,r){return n(t),Reflect.get(e,t,r)},set:function(e,t,r,i){return n(t),Reflect.set(e,t,r,i)}})}return e.prototype.revoke=function(){this.isRevoked=!0},e}(),i=function(){function e(e){this.message=e}return e.prototype.getInstance=function(){var e;return null===(e=this.instance)||void 0===e?void 0:e.proxy},e.prototype.setInstance=function(e){var t;return null===(t=this.instance)||void 0===t||t.revoke(),void 0===e?this.instance=void 0:(this.instance=new n(e,this.message),this.instance.proxy)},e.prototype.revokeInstance=function(){if(this.instance)return this.instance.revoke(),this.instance=new n(this.instance.target,this.message),this.instance.proxy},e}();t.RevocableSingleton=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var n=r(0),i=r(50),a=r(40),o=r(61),s=r(124),u=r(156),l=r(88),c=r(42),d=r(103),p=r(158),m=r(104);function f(e,t,r,n){if(r.kind===a.PosKind.Abs)return r;var i=(0,u.wrapPosition)(e,r.index,n)-t;return i===r.index?r:(0,a.pos)(a.PosKind.Rel,i)}function g(e,t,r,n){var o=f(t.row,r.row,n.row,i.sheetRows),u=f(t.col,r.col,n.col,i.sheetCols),l=(0,s.canonicaliseBrackets)(e,o)||(0,s.canonicaliseBrackets)(e,u);return(0,a.cellRefSingle)(o,u,l,n.label)}function h(e,t,r,n){switch(n.kind){case a.CellRefKind.Error:case a.CellRefKind.Bad:return n;case a.CellRefKind.Single:return g(e,t,r,n);case a.CellRefKind.Range:var o=g(e,t,r,n.ref1),u=g(e,t,r,n.ref2);return o===n.ref1&&u===n.ref2?n:(0,a.cellRefRange)(o,u,n.label);case a.CellRefKind.Row:var l=f(t.row,r.row,n.row1,i.sheetRows),c=f(t.row,r.row,n.row2,i.sheetRows),d=(0,s.canonicaliseBrackets)(e,l)||(0,s.canonicaliseBrackets)(e,c);return(0,a.cellRefRow)(l,c,d,n.label);case a.CellRefKind.Col:var p=f(t.col,r.col,n.col1,i.sheetCols),m=f(t.col,r.col,n.col2,i.sheetCols);d=(0,s.canonicaliseBrackets)(e,p)||(0,s.canonicaliseBrackets)(e,m);return(0,a.cellRefCol)(p,m,d,n.label)}}var v=(0,o.createFailureErrorClass)("TransformRefsError"),S=function(e){function t(t,r,n,i){var a=e.call(this)||this;return a.fn=t,a.locals=n,a.annotations=i,a.resolver=(0,p.createResolver)(r),a}return n.__extends(t,e),t.prototype.nameNode=function(e,t,r){var n=(0,a.nameNode)(e,t,r),i=this.resolver.resolveDottedName(this.locals,n,this.annotations),o=i.headResolved,s=i.fieldsResolved,u=(0,a.flattenNameParts)(e).parts;if((0,p.canDenoteCellRef)(this.locals,t,u)){var m=u[0],f=u[1],g=u.slice(2);if(o.kind===d.ResolvedKind.ResolvedCellRef){(0,c.assertTrue)("calc.analyze.adjustFormulaOrigin: all flattened field parts resolved",u.length===1+s.length);var h=this.fn(m.ref);if(h.kind===a.CellRefKind.Single||h.kind===a.CellRefKind.Row||h.kind===a.CellRefKind.Col){var S=function(e,t){return(0,a.fieldRefNamePart)(e,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel)};return(0,a.nameNode)(g.reduce(S,S((0,a.cellRefNamePart)(h,m.asWhole,m.label,m.qualifiedLabel),f)),t,r)}var y=function(e,t){var r=t.rhs,n=t.qualifiedLabel;return(0,a.fieldRefNode)(e,r,n)};return g.reduce(y,y((0,a.cellRefNode)(h,o.node.qualifier,o.node.label),f))}if(o.resolution.kind!==l.ResultKind.Success&&o.resolution.reason.kind!==d.ResolveReasonKind.NoOriginSheet&&o.resolution.reason.kind!==d.ResolveReasonKind.InvalidQualifier)throw new v(o.resolution.reason)}return n},t.prototype.cellRefNode=function(e,t,r){return(0,a.cellRefNode)(this.fn(e),t,r)},t}(m.IdentityVisitor);t.adjustFormulaOrigin=function(e,t,r,i){var a=t.originGridCell.value;if((0,o.isGridCellEqual)(a,r))return(0,l.success)(i);try{var s=(0,m.reduceBottomUp)(new S(h.bind(void 0,e.config.refStyle,a,r),e,t,i.annotations),i);return(0,l.success)(n.__assign(n.__assign({},i),{node:s}))}catch(e){if(e instanceof v)return(0,l.failure)(e.reason);throw e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(1);t.ivlJoin=n.interval.ivlJoin,t.ivlMeet=n.interval.ivlMeet,t.ivlDistance=n.interval.ivlDistance,t.ivlMeets=n.interval.ivlMeets,t.ivlMeetsOrTouches=n.interval.ivlMeetsOrTouches,t.ivlExcept=n.interval.ivlExcept,t.ivlCompare=n.interval.ivlCompare},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var n=r(0),i=r(42),a=r(385),o=r(225),s=r(155),u=r(40),l=r(61),c=r(104),d=function(e){function t(t,r,n){var i=e.call(this,c.voidVisitor)||this;return i.localeInfo=t,i.annotations=r,i.names=n,i}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){var a=this;return o.Pledge.try((function(){return t.kind===u.NodeKind.Name&&(a.annotations[t.label]=u.appHeadNameAnnotation),e.prototype.appNode.call(a,t,r,n,i)}))},t.prototype.letNode=function(e,t,r,n){var a=this,u=e.id===s.WorksheetFuncId.LETREC||e.id!==s.WorksheetFuncId.LET&&(0,i.assertFalse)("calc.lang.buildAnnotations"),l=this.bindNames(t),d=l[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return u?o.Pledge.all(t.map((function(e){var t=e.binder;return o.Pledge.try((function(){return(0,c.visitFormulaNode)(d,t.arg)}))}))):o.Pledge.all(t.map((function(e,t){var r=e.binder,n=l[t];return o.Pledge.try((function(){return(0,c.visitFormulaNode)(n,r.arg)}))})))})).bind((function(e){return void 0===r?void 0:(0,c.visitFormulaNode)(d,r.arg)})).bind((function(e){return o.Pledge.all(n.map((function(e){return o.Pledge.try((function(){return(0,c.visitFormulaNode)(a,e.arg)}))})))})).bind((function(e){}))},t.prototype.lambdaNode=function(e,t,r,n){var i=this,a=this.bindNames(t),s=a[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return o.Pledge.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return o.Pledge.resolve(void 0);var n=a[t],i=r.arg.def;return o.Pledge.try((function(){return(0,c.visitFormulaNode)(n,i.rhs)}))})))})).bind((function(e){return void 0===r?void 0:(0,c.visitFormulaNode)(s,r.arg)})).bind((function(e){return o.Pledge.all(n.map((function(e){return o.Pledge.try((function(){return(0,c.visitFormulaNode)(i,e.arg)}))})))})).bind((function(e){}))},t.prototype.bindNames=function(e){var r=this,n=[this];return e.reduce((function(e,i){var a=i.name;if(void 0===a.arg.wholeName)return n.push(new t(r.localeInfo,r.annotations,e)),e;var o=(0,l.getBoundName)(r.localeInfo,a.arg.wholeName),s=e.setValue(o,a.arg);return n.push(new t(r.localeInfo,r.annotations,s)),r.annotations[a.arg.label]=(0,u.localNameDeclAnnotation)(o,a.arg.wholeName),s}),this.names),n},t.prototype.nameNode=function(t,r,n){var i=this;return o.Pledge.try((function(){if(void 0===r){var a=(0,u.headNamePart)(t),o=i.names.getEntry((0,l.getBoundName)(i.localeInfo,a.asWhole));if(void 0===o);else if(o.value.kind===u.NodeKind.ContextName)i.annotations[a.label]=(0,u.localNameUseAnnotation)(o.key,o.value.whole,o.value.label);else{i.annotations[a.label]=(0,u.localNameUseAnnotation)(o.key,o.value.wholeName,o.value.label),i.annotations[o.value.label].uses.push({label:a.label})}}return e.prototype.nameNode.call(i,t,r,n)}))},t}(c.PledgeReducer);t.buildAnnotations=function(e,t,r,n){var i=[];return(0,c.reduceTopDown_Pledge)(new d(e,i,(null!=r?r:[]).reduce((function(t,r){var n=(0,l.getBoundName)(e,r.whole);return t.setValue(n,r)}),a.RedBlackMapTree.create(e.stringCompareCI))),t),i[t.label]=(0,u.formulaRootAnnotation)(r,n),i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(1);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIdentContinue=t.isIdentStart=void 0;var n=r(1).unicode.makeIsInClass;t.isIdentStart=n([65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,697,699,706,711,712,713,716,717,718,720,722,728,732,733,734,736,741,750,751,880,884,886,888,890,894,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1316,1329,1367,1369,1370,1377,1416,1488,1515,1520,1523,1569,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2308,2362,2365,2366,2384,2385,2392,2402,2417,2419,2427,2432,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3134,3160,3162,3168,3170,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3333,3341,3342,3345,3346,3369,3370,3386,3389,3390,3424,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3806,3840,3841,3904,3912,3913,3949,3976,3980,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5109,5121,5741,5743,5751,5761,5787,5792,5867,5870,5873,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6264,6272,6313,6314,6315,6400,6429,6480,6510,6512,6517,6528,6570,6593,6600,6656,6679,6917,6964,6981,6988,7043,7073,7086,7088,7168,7204,7245,7248,7258,7294,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8208,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8232,8240,8241,8242,8244,8245,8246,8251,8252,8305,8306,8308,8309,8319,8320,8321,8325,8336,8341,8450,8452,8453,8454,8455,8456,8457,8468,8469,8471,8473,8478,8481,8483,8484,8485,8486,8487,8488,8489,8490,8494,8495,8506,8508,8512,8517,8522,8526,8527,8531,8533,8539,8543,8544,8585,8592,8602,8658,8659,8660,8661,8704,8705,8706,8708,8711,8713,8715,8716,8719,8720,8721,8722,8725,8726,8730,8731,8733,8737,8739,8740,8741,8742,8743,8749,8750,8751,8756,8760,8764,8766,8776,8777,8780,8781,8786,8787,8800,8802,8804,8808,8810,8812,8814,8816,8834,8836,8838,8840,8853,8854,8857,8858,8869,8870,8895,8896,8978,8979,9312,9398,9424,9450,9472,9548,9552,9589,9601,9616,9618,9622,9632,9634,9635,9642,9650,9652,9654,9656,9660,9662,9664,9666,9670,9673,9675,9676,9678,9682,9698,9702,9711,9712,9733,9735,9737,9738,9742,9744,9756,9757,9758,9759,9792,9793,9794,9795,9824,9826,9827,9830,9831,9835,9836,9838,9839,9840,11264,11311,11312,11359,11360,11376,11377,11390,11392,11493,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12288,12292,12293,12312,12317,12320,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12544,12549,12590,12593,12687,12704,12728,12784,12829,12832,12842,12849,12851,12857,12858,12896,12924,12927,12928,12963,12969,13059,13060,13069,13070,13076,13077,13080,13081,13090,13092,13094,13096,13099,13100,13110,13111,13115,13116,13129,13131,13133,13134,13137,13138,13143,13144,13179,13183,13184,13189,13192,13259,13261,13268,13269,13271,13272,13273,13275,13278,13312,19894,19968,40900,40960,42125,42240,42509,42512,42528,42538,42540,42560,42592,42594,42607,42624,42648,42786,42888,42891,42893,43003,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43274,43302,43312,43335,43520,43561,43584,43587,43588,43596,44032,55204,57344,63561,63744,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511]),t.isIdentContinue=n([48,58,63,64,65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,888,890,894,900,903,904,907,908,909,910,930,931,1316,1329,1367,1369,1370,1377,1416,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1520,1523,1536,1540,1542,1545,1547,1548,1550,1563,1567,1568,1569,1631,1632,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2305,2362,2364,2382,2384,2389,2392,2404,2406,2416,2417,2419,2427,2432,2433,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2555,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2930,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3073,3076,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3162,3168,3172,3174,3184,3192,3200,3202,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3330,3332,3333,3341,3342,3345,3346,3369,3370,3386,3389,3397,3398,3401,3402,3406,3415,3416,3424,3428,3430,3446,3449,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3770,3771,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3806,3840,3844,3859,3898,3902,3912,3913,3949,3953,3973,3974,3980,3984,3992,3993,4029,4030,4045,4046,4048,4096,4170,4176,4250,4254,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4959,4961,4969,4989,4992,5018,5024,5109,5121,5741,5743,5751,5760,5787,5792,5867,5870,5873,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6264,6272,6315,6400,6429,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6570,6576,6602,6608,6618,6624,6684,6912,6988,6992,7002,7009,7037,7040,7083,7086,7098,7168,7224,7232,7242,7245,7294,7424,7655,7678,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8192,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8241,8242,8244,8245,8246,8251,8252,8260,8261,8274,8275,8287,8293,8298,8306,8308,8317,8319,8333,8336,8341,8352,8374,8400,8433,8448,8528,8531,8585,8592,9001,9003,9192,9216,9255,9280,9291,9312,9886,9888,9917,9920,9924,9985,9989,9990,9994,9996,10024,10025,10060,10061,10062,10063,10067,10070,10071,10072,10079,10081,10088,10102,10133,10136,10160,10161,10175,10176,10181,10183,10187,10188,10189,10192,10214,10224,10627,10649,10712,10716,10748,10750,11085,11088,11093,11264,11311,11312,11359,11360,11376,11377,11390,11392,11499,11517,11518,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12288,12312,12317,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12544,12549,12590,12593,12687,12688,12728,12736,12772,12784,12831,12832,12868,12880,13055,13056,19894,19904,40900,40960,42125,42128,42183,42240,42509,42512,42540,42560,42592,42594,42611,42620,42622,42623,42648,42752,42893,43003,43052,43072,43124,43136,43205,43216,43226,43264,43311,43312,43348,43520,43575,43584,43598,43600,43610,44032,55204,57344,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65063,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65279,65280,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(1);t.floorToPowerOf2=n.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=n.arrayMapTree.ArrayMapTree,t.RootPointer=n.arrayMapTree.RootPointer,t.enumerateInOrder=n.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=n.arrayMapTree.enumerateKeysInOrder},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0,t.getTempRet0=function(){return p},t.setTempRet0=function(e){p=e};var n=r(159);const i=Math.sqrt;t.Math_sqrt=i;const a=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=a;const o=Math.log;t.Math_log=o;const s=Math.exp;t.Math_exp=s;const u=Math.sin;t.Math_sin=u;const l=Math.cos;t.Math_cos=l;const c=Math.tan;t.Math_tan=c;const d=Math.atan;t.Math_atan=d;let p=0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;var n,i,a=r(126),o=r(229);function s(e,t,r,n,i,a,o,s,u){return{yr:e,mon:t,dom:r,hour:n,min:i,sec:a,wdy:o,fracSec:s,rounding:u}}function u(e){return s((0,a.Dtr_Yr)(e),(0,a.Dtr_Mon)(e),(0,a.Dtr_DOM)(e),(0,a.Dtr_Hour)(e),(0,a.Dtr_Min)(e),(0,a.Dtr_Sec)(e),(0,a.Dtr_Wdy)(e),(0,a.Dtr_FracSec)(e),(0,a.Dtr_Rounding)(e))}function l(e,t){(0,a.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return(0,a.Dtr_DaysPerMonth)(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(n||(t.Rounding=n={})),t.dtr=s,t.fromNum=function(e,t,r,n){var i=t;return 0===(0,a.Dtr_FromNum)(e,i,0,r?1:0,n?1:0)&&u(0)},t.toNum=function(e,t,r){l(0,e);var n=(0,a.Dtr_ToNum)(0,t?1:0,r?1:0),i=(0,a.Mathpack_TakeMathError)();return i===o.MathErrorNum.None?n:(0,o.mathError)(i)},t.toNumWithDuration=function(e,t,r,n,i){l(0,e);var s=n,u=(0,a.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,s,i),c=(0,a.Mathpack_TakeMathError)();return c===o.MathErrorNum.None?u:(0,o.mathError)(c)},t.toDays=function(e,t,r){return l(0,e),0===(0,a.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,a.Dtr_Days)()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(i||(t.TimeDivision=i={})),t.toTime=function(e,t,r){var n=t,i=r,s=(0,a.Dtr_ToTime)(e,n,i);return(0,a.Mathpack_TakeMathError)()===o.MathErrorNum.None&&s},t.utcToLocal=function(e,t,r,n){return l(0,e),null!=t.standardDate&&l(1,t.standardDate),null!=t.daylightDate&&l(2,t.daylightDate),0!==(0,a.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,n?1:0)&&u(0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;var n=r(0),i=r(40),a=r(104);t.relabelFormula=function(e,t){var r;void 0===t&&(r=1,t=function(){return r++});var o=e.spans,s=e.annotations,u=e.depthUpperBound,l=[],c=[],d=[],p=[];function m(e){var r=t(),n=o[e];null!=n&&(l[r]=n);var i=s[e];return null!=i&&(c[r]=i),d[e]=r,p[r]=e,r}function f(e){return n.__assign(n.__assign({},e),{label:m(e.label)})}function g(e){if(e.kind===i.CellRefKind.Range){var t=e;return(0,i.cellRefRange)(g(t.ref1),g(t.ref2),m(e.label))}return n.__assign(n.__assign({},e),{label:m(e.label)})}function h(e){return null!=e?(0,i.documentQualifier)(e.document,e.path,e.isQuoted,m(e.label)):void 0}function v(e){return(0,i.fieldRef)(function(e){switch(e.kind){case i.NodeKind.Ident:return F(e);case i.NodeKind.Missing:return(0,i.missingNode)(e.chars,m(e.label));case i.NodeKind.BadChars:return(0,i.badCharsNode)(e.type,e.chars,m(e.label))}}(e.field),e.isBracketed,e.isClosed,e.shouldBeBracketed,m(e.label))}function S(e){switch(null==e?void 0:e.kind){case void 0:return;case i.StructRefKind.SpecialRef:return(0,i.specialRef)(e.id,e.isBracketed,e.isClosed,m(e.label));case i.StructRefKind.ColumnRef:return(0,i.columnRef)(e.name,e.isBracketed,e.isClosed,m(e.label));case i.StructRefKind.RangeOpRef:return(0,i.rangeOpRef)(S(e.lhs),S(e.rhs),m(e.label));case i.StructRefKind.CommaOpRef:return(0,i.commaOpRef)(e.refs.map(S),m(e.label));case i.StructRefKind.ThisRowOpRef:return(0,i.thisRowOpRef)(void 0!==e.ref?S(e.ref):void 0,m(e.label));case i.StructRefKind.MissingRef:return(0,i.missingRef)(m(e.label));case i.StructRefKind.BadRef:return(0,i.badRef)(e.chars,e.isBracketed,e.isClosed,m(e.label))}}function y(e,t,r){return(0,i.nameNode)(function(e){var t=(0,i.flattenNameParts)(e),r=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,a=t.label,o=t.qualifiedLabel;return(0,i.fieldRefNamePart)(e,v(r),n,m(a),m(o))};if(t.kind===i.NamePartKind.IdentNamePart){var n=t.parts,a=n[0],o=n.slice(1),s=(0,i.identNamePart)(a.asWhole,a.canDenoteNamedObject,m(a.label),m(a.qualifiedLabel));return o.reduce(r,s)}var u=t.parts,l=u[0],c=u[1],d=u.slice(2),p=(0,i.cellRefNamePart)(g(l.ref),l.asWhole,m(l.label),m(l.qualifiedLabel));return d.reduce(r,r(p,c))}(e),function(e){if(null!=e)return e.kind===i.QualifierKind.Sheet||e.kind===i.QualifierKind.SheetRange?n.__assign(n.__assign({},e),{document:h(e.document),label:m(e.label)}):n.__assign(n.__assign({},e),{label:m(e.label)})}(t),m(r))}function F(e){var t=e.whole,r=e.label;return(0,i.identNode)(t,m(r))}function C(e){var t=(0,i.paramName)(function(e){switch(e.kind){case i.NodeKind.Ident:return F(e);case i.NodeKind.Missing:return(0,i.missingNode)(e.chars,m(e.label));case i.NodeKind.BadChars:return(0,i.badCharsNode)(e.type,e.chars,m(e.label))}}(e.name.name),e.name.isBracketed,e.name.isClosed,m(e.name.label)),r=void 0===e.def?void 0:(0,i.paramDefault)(e.def.rhs,m(e.def.label));return(0,i.paramNode)(t,r,m(e.label))}for(var R={literalNode:function(e,t,r){return(0,i.literalNode)(e,t,m(r))},arrayNode:function(e,t,r){return(0,i.arrayNode)(e,t,m(r))},appNode:function(e,t,r,n){return(0,i.appNode)(e,t,r,m(n))},letNode:function(e,t,r,n,a,o){return(0,i.letNode)(e,t.map((function(e){var t=e.name,r=e.binder;return(0,i.letVar)((0,i.indexedArg)(function(e){var t=e.name,r=e.label;return(0,i.varNode)(F(t),m(r))}(t.arg),t.index),r)})),r,n,a,m(o))},lambdaNode:function(e,t,r,n,a,o){return(0,i.lambdaNode)(e,t.map((function(e){var t=e.name;return(0,i.lambdaParam)((0,i.indexedArg)(C(t.arg),t.index))})),r,n,a,m(o))},parenNode:function(e,t,r){return(0,i.parenNode)(e,t,m(r))},nameNode:function(e,t,r){return y(e,t,r)},cellRefNode:function(e,t,r){return(0,i.cellRefNode)(g(e),function(e){if(null!=e)return e.kind===i.QualifierKind.Sheet||e.kind===i.QualifierKind.SheetRange?n.__assign(n.__assign({},e),{document:h(e.document),label:m(e.label)}):n.__assign(n.__assign({},e),{label:m(e.label)})}(t),m(r))},fieldRefNode:function(e,t,r){return(0,i.fieldRefNode)(e,v(t),m(r))},structRefNode:function(e,t,r){return(0,i.structRefNode)(void 0===e?void 0:function(e){return y(e.parts,e.qualifier,e.label)}(e),(n=t,(0,i.structRef)(S(n.innerRef),n.isClosed,m(n.label))),m(r));var n},missingNode:function(e,t){return(0,i.missingNode)(e,m(t))},badSequenceNode:function(e,t,r){return(0,i.badSequenceNode)(e,t,m(r))},badCharsNode:function(e,t,r){return(0,i.badCharsNode)(e,t,m(r))},operatorNode:function(e,t){return(0,i.operatorNode)(e,m(t))},wsfNode:function(e,t,r){return(0,i.wsfNode)(e,t,m(r))}},b=(0,i.formula)((0,a.reduceBottomUp)(R,e),l,c,u),E=0,P=Object.keys(c);E<P.length;E++){var k=P[E],T=Number(k),A=c[T];switch(null==A?void 0:A.kind){case i.AnnotationKind.LocalNameUse:c[T]=(0,i.localNameUseAnnotation)(A.name,A.whole,d[A.label]);break;case i.AnnotationKind.LocalNameDecl:c[T]=(0,i.localNameDeclAnnotation)(A.name,A.whole,A.uses.map((function(e){var t=e.label;return{label:d[t]}})))}}for(var N=0,_=Object.keys(l).map(Number);N<_.length;N++){var I=_[N],O=l[I],M=null==O?void 0:O.preComments,D=null==O?void 0:O.postComments;(M||D)&&(l[I]=n.__assign(n.__assign({},O),{preComments:M?M.map(f):void 0,postComments:D?D.map(f):void 0}))}return{formula:b,oldToNewLabel:d,newToOldLabel:p}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;var n=r(0),i=r(87),a=r(32),o=r(231),s=n.__importStar(r(125)),u=r(89),l=r(42),c=r(71),d=r(102);var p=s.codePointDigitZero;function m(e){return{kind:c.OperKind.Number,_valueIEEE:e}}var f=m(0),g=m(1),h=m(Math.PI);function v(e){return isFinite(e)?m(e):i.numErrorOper}function S(e,t){var r=e._valueIEEE,n=t._valueIEEE;return r<n?-1:r>n?1:0}function y(e,t){var r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),i=!(0,u.stringStartsWith)(r,"-"),a=r.substring(i?0:1,n).replace(".",""),o=parseInt(r.substring(n+1),10)+1;return function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==p)return!1;return!0}(a)?{sign:i,mantissa:"",exponent:0}:{sign:i,mantissa:a,exponent:o}}var F=["0","1","2","3","4","5","6","7","8","9"];function C(e){var t=e._valueIEEE;return m(t<0?Math.ceil(t):Math.floor(t))}function R(e){var t=e._valueIEEE;return m(Math.floor(t))}function b(e){return e.substring(0,1)+"."+e.substring(1)}t.ieeeMathpack={zero:f,one:g,pi:h,add:function(e,t){return v(e._valueIEEE+t._valueIEEE)},sub:function(e,t){return v(e._valueIEEE-t._valueIEEE)},mul:function(e,t){return v(e._valueIEEE*t._valueIEEE)},div:function(e,t){var r=e._valueIEEE,n=t._valueIEEE;return 0===n?i.div0ErrorOper:v(r/n)},power:function(e,t){var r=e._valueIEEE,n=t._valueIEEE,a=Math.pow(r,n);return isFinite(a)?m(a):isNaN(a)?i.div0ErrorOper:i.numErrorOper},percent:function(e){return m(e._valueIEEE/100)},neg:function(e){return m(-e._valueIEEE)},compare:S,formatGeneral:function(e,t,r){var n=e.decimalSeparator,i=t._valueIEEE,a=String(i).replace("e","E");return"."!==n&&(a=a.replace(".",n)),a},formatFixed:function(e,t,r){var n,i=e._valueIEEE,a=y(i),s=a.sign,u=a.mantissa,l=a.exponent,c=r+(l+t);if(0===c){var d=parseFloat("5e"+String(l-1));if(Math.abs(i)>=d)return(0,o.numberComponents)(s,"1",l+t+1)}if(c<1)return(0,o.numberComponents)(!0,"",0);c<=21&&(s=(n=y(i,c-1)).sign,u=n.mantissa,c=r+((l=n.exponent)+t));var p=u.substring(0,c);return(0,o.numberComponents)(s,p,0===p.length?0:l+t)},formatScientific:function(e,t,r){var n,i=e._valueIEEE,a=y(i),s=a.sign,u=a.mantissa,c=a.exponent,d=(0,o.formatScientificLeft)(c,t),p=d+r;if((0,l.assertTrue)("calc.lang.ieeeFormatScientific",p>0),0===p){var m=parseFloat("5e"+String(c-1));if(Math.abs(i)>=m)return(0,o.numberComponents)(s,"",c+1)}if(p<1)return(0,o.numberComponents)(!0,"",0);p<=21&&(s=(n=y(i,p-1)).sign,u=n.mantissa,c=n.exponent,p=(d=(0,o.formatScientificLeft)(c,t))+r);var f=u.substring(0,p);return(0,o.numberComponents)(s,f,0===f.length?0:c)},parse:function(e,t,r,n){return m(Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",i=0,a=(0,d.codePointIterator)(t);i<a.length;i++){var o=a[i];n+=F[r(o)]}return n}(e,n)+"E"+String(r)))},trunc:C,ceil:function(e){var t=e._valueIEEE;return m(Math.ceil(t))},floor:R,abs:function(e){return m(Math.abs(e._valueIEEE))},cond:function(e){return S(e,f)},cond2:S,fromNumber:m,toNumber:function(e){return e._valueIEEE},sqrt:function(e){return v(Math.sqrt(e._valueIEEE))},exp:function(e){return v(Math.exp(e._valueIEEE))},ln:function(e){return v(Math.log(e._valueIEEE))},log:function(e){return v(Math.log(e._valueIEEE)/Math.LN10)},sin:function(e){return m(Math.sin(e._valueIEEE))},cos:function(e){return m(Math.cos(e._valueIEEE))},tan:function(e){return m(Math.tan(e._valueIEEE))},asin:function(e){return v(Math.asin(e._valueIEEE))},acos:function(e){return v(Math.acos(e._valueIEEE))},atan:function(e){return v(Math.atan(e._valueIEEE))},atan2:function(e,t){return m(Math.atan2(t._valueIEEE,e._valueIEEE))},mod:function(e,t){return m(e._valueIEEE%t._valueIEEE)},round:function(e,t){var r=e._valueIEEE;if(0===r)return f;var n=y(r).exponent,i=C(t)._valueIEEE+n;if(0===i){var a=parseFloat("5e"+String(n-1));if(Math.abs(r)>=a)return v((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return i<1?f:i>21?e:v(parseFloat(r.toExponential(i-1)))},roundUp:function(e,t){var r=e._valueIEEE;if(0===r)return f;var n=y(r),i=n.sign,a=n.mantissa,o=n.exponent,s=C(t)._valueIEEE+o;return s<1?v(parseFloat((i?"":"-")+"10e"+String(o-1-s))):s>21?e:v(parseFloat((i?"":"-")+function(e,t){if(e.length<=t)return b(e);for(var r=e.substring(0,t),n=0,i=r.length-1;i>=0&&r.charCodeAt(i)-p==9;i-=1)n+=1;return n===r.length?"10":b(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(a,s)+"e"+String(o-1)))},roundDown:function(e,t){var r=e._valueIEEE;if(0===r)return f;var n=y(r),i=n.sign,a=n.mantissa,o=n.exponent,s=C(t)._valueIEEE+o;if(s<1)return f;if(s>21)return e;var u=a.substring(0,s);return v(parseFloat((i?"":"-")+b(u)+"e"+String(o-1)))},tenTo:function(e){return(0,l.assertInteger)("calc.lang.ieeeTenTo",e),v(Math.pow(10,e))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=e._valueIEEE,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){var t=C(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=R(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:a.identity}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var n,i=r(0),a=r(40),o=r(87),s=r(101),u=r(42),l=r(61),c=r(50),d=r(226),p=r(395),m=r(124),f=r(89),g=r(103),h=r(158),v=r(88),S=r(104),y=r(71),F=r(396),C=r(232),R=r(102),b=/'/g,E=/"/g,P=(0,c.sheetGridCell)((0,c.sheetIndex)((0,c.documentLoc)(void 0,"Book1"),0),(0,c.gridCell)(0,0));function k(e){if(!(0,v.isSuccess)(e)&&e.reason.kind!==g.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==g.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==g.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==g.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==g.ResolveReasonKind.EmptyIntersection)throw new U(e.reason)}function T(e){for(var t=[],r=[],n=0,i=e;n<i.length;n++){var a=i[n];a.length>0&&(0,R.numCodeUnits)((0,R.stringCodePointAt)(a,0))===a.length?t[(0,R.stringCodePointAt)(a,0)]=!0:r.push(a)}return function(e,n){var i=(0,R.stringCodePointAt)(e,n);if(!0===t[i])return!0;for(var a=0,o=r;a<o.length;a++){var s=o[a];if((0,f.stringStartsWith)(e,s,n))return!0}return!1}}function A(e,t){for(var r="",n=0;n<e.length;){t(e,n)&&(r+="'");var i=(0,R.stringCodePointAt)(e,n);r+=(0,R.stringFromCodePoint)(i),n+=(0,R.numCodeUnits)(i)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(n||(n={}));var N=function(e){this.str=e,this.append=I,this.length=e.length},_=function(e,t){this.lhs=e,this.rhs=t,this.append=I,this.length=e.length+t.length};function I(e){return new _(this,"string"==typeof e?new N(e):e)}function O(e,t){return 0===e.length?new N(""):e.reduce((function(e,r){return e.append(t).append(r)}))}var M={pre:"",preComments:void 0},D={pre:" ",preComments:void 0},w={post:"",postComments:void 0},L={literalNode:function(e,t,r){return r},arrayNode:function(e,t,r){return r},appNode:function(e,t,r,n){return n},letNode:function(e,t,r,n,i,a){return a},lambdaNode:function(e,t,r,n,i,a){return a},parenNode:function(e,t,r){return r},nameNode:function(e,t,r){return r},cellRefNode:function(e,t,r){return r},fieldRefNode:function(e,t,r){return r},structRefNode:function(e,t,r){return r},missingNode:function(e,t){return t},badSequenceNode:function(e,t,r){return r},badCharsNode:function(e,t,r){return r},operatorNode:function(e,t){return t},wsfNode:function(e,t,r){return r}},x=i.__assign(i.__assign({},(0,S.constVisitor)(void 0)),{operatorNode:function(e){return e}}),K=function(){function e(e,t,r,n){var a,o,s,u,l=this;this.root=r,this.anonymize=n,this.labelToRope=[],this.anon=function(e){return l.anonymize?(0,p.anonymizeFormulaString)(e):e},this.locals=t,this.localeInfo=null!==(o=null===(a=t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==o?o:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(u=null===(s=t.config)||void 0===s?void 0:s.refStyle)&&void 0!==u?u:e.config.refStyle,this.resolver=(0,h.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;var c=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],d=i.__spreadArray(i.__spreadArray([],c,!0),["\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"],!1);this.isStructRefEscapable=T(c),this.isStructRefBracketedThisRef=T(d),this.isFieldRefEscapable=T(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return e.prototype.print=function(){var e=this,t=new S.ComposeVisitor(new S.ZipVisitor({str:this,label:L,op:x}),(function(t){return e.record(t.label,t.str),t})),r=(0,S.reduceBottomUp)(t,this.root),n=new N("=").append(this.recordPrePost(r.label,this.pre(r.label,M),r.str,this.postIfComments(r.label)));return this.printRope(n)},e.prototype.pre=function(e,t){var r;return this.anonymize?t:null!==(r=this.spans[e])&&void 0!==r?r:t},e.prototype.post=function(e,t){var r;return this.anonymize?t:null!==(r=this.spans[e])&&void 0!==r?r:t},e.prototype.preIfComments=function(e){if(this.anonymize)return M;var t=this.spans[e];return null!=(null==t?void 0:t.preComments)&&t.preComments.length>0?t:M},e.prototype.postIfComments=function(e){if(this.anonymize)return w;var t=this.spans[e];return null!=(null==t?void 0:t.postComments)&&t.postComments.length>0?t:w},e.prototype.printRef=function(e,t){var r=new N("");switch(e.kind){case a.StructRefKind.SpecialRef:(t===n.Original&&e.isBracketed||t===n.Bracketed)&&(r=r.append(this.localeInfo.leftBracket));var i=this.localeInfo.specialRefNames[e.id];if(null==i)throw new U((0,l.internal)("No locale data for specialRefName"));r=r.append(i),(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed)&&(r=r.append(this.localeInfo.rightBracket));break;case a.StructRefKind.ColumnRef:var o=0===e.name.length||(0,f.stringStartsWith)(e.name," ")||(0,f.stringEndsWith)(e.name," ");(t===n.Original&&e.isBracketed||t===n.Bracketed||t===n.Unbracketed&&o)&&(r=r.append(this.localeInfo.leftBracket));var s=A(e.name,this.isStructRefEscapable);r=r.append(this.anon(s)),(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed||t===n.Unbracketed&&o)&&(r=r.append(this.localeInfo.rightBracket));break;case a.StructRefKind.RangeOpRef:r=r.append(this.printRef(e.lhs,t===n.Original?t:n.Bracketed)).append(":").append(this.printRef(e.rhs,t===n.Original?t:n.Bracketed));break;case a.StructRefKind.MissingRef:break;case a.StructRefKind.BadRef:e.isBracketed&&(r=r.append(this.localeInfo.leftBracket)),r=r.append(this.anon(e.chars)),e.isBracketed&&e.isClosed&&(r=r.append(this.localeInfo.rightBracket))}return this.record(e.label,r)},e.prototype.printThisRowOpRef=function(e,t){var r=new N("@");return e&&(r=e.kind===a.StructRefKind.ColumnRef?r.append(this.printRef(e,e.isClosed?function(e,t){for(var r=0;r<e.length;){if(t(e,r))return!0;r+=(0,R.numCodeUnits)((0,R.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?n.Bracketed:n.Unbracketed:n.Original)):r.append(this.printRef(e,(0,l.isRangeOpClosed)(e)&&(0,l.isRangeOpNoMissing)(e)?n.Bracketed:n.Original))),this.record(t,r)},e.prototype.printApplication=function(e,t,r,n){var i=this,a=t.map((function(e,t,r){return i.recordPrePost(e.label,i.pre(e.label,0===t||0===e.str.length?M:D),e.str,t===r.length-1?i.post(e.label,w):i.postIfComments(e.label))}));return e.str.append("(").append(O(a,this.localeInfo.listSeparator)).append(r?")":"")},e.prototype.printCellRef=function(e){var t=e.ref,r=e.qualifier;return(void 0!==r?this.recordPrePost(r.label,M,(0,S.visitQualifier)(this,r).str,this.postIfComments(r.label)):new N("")).append((0,S.visitCellRef)(this,t).str)},e.prototype.printName=function(e,t){for(var r=e.qualifier,n=e.parts,i=void 0!==r?this.recordPrePost(r.label,M,(0,S.visitQualifier)(this,r).str,this.postIfComments(r.label)):new N(""),o=new N(""),s=0,u=(0,a.flattenNameParts)(n).parts;s<u.length;s++){var l=u[s],c=void 0;if(l.kind===a.NamePartKind.FieldRefNamePart){var d=l.rhs.field;c=this.record(l.rhs.label,new N(".").append(this.record(d.label,this.anon(d.kind===a.NodeKind.Ident?d.whole:d.chars))))}else c=l.kind===a.NamePartKind.CellRefNamePart&&t===g.ResolvedKind.ResolvedCellRef?this.printCellRef((0,a.cellRefNode)(l.ref,void 0,l.label)):new N(this.anon(l.asWhole));o=this.record(l.label,o.append(c)),this.recordQualified(l.qualifiedLabel,i,o)}return i.append(o)},e.prototype.printUnrecordedDocQual=function(e){if(void 0===e)return e;var t=e.path,r=e.document;return this.anon((null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket)},e.prototype.printParamNameIdent=function(e){return e.kind===a.NodeKind.Ident?this.record(e.label,this.anon((0,l.getBoundName)(this.localeInfo,e.whole))):this.recordPrePost(e.label,this.pre(e.label,M),this.anon(e.chars),this.post(e.label,w))},e.prototype.printParamName=function(e){return this.record(e.label,new N(e.isBracketed?this.localeInfo.leftBracket:"").append(this.printParamNameIdent(e.name)).append(e.isBracketed&&e.isClosed?this.localeInfo.rightBracket:""))},e.prototype.record=function(e,t){var r="string"==typeof t?new N(t):t;return this.labelToRope[e]={ropeStart:r,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0},r},e.prototype.recordQualified=function(e,t,r){this.labelToRope[e]={ropeStart:t,ropeEnd:r,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0}},e.prototype.recordPrePost=function(e,t,r,n){var i=t.pre,a=t.preComments,o=n.post,s=n.postComments,u="string"==typeof r?new N(r):r,l=new N(i),c=new N(o);return this.labelToRope[e]={ropeStart:u,ropeEnd:u,startOffset:0,endOffset:0,pre:i,post:o,preComments:a,postComments:s},a&&this.recordComments(a,l,this.spans[e].start-i.length),s&&this.recordComments(s,c,this.spans[e].end),l.append(u).append(c)},e.prototype.recordComments=function(e,t,r){for(var n=0,i=e;n<i.length;n++){var a=i[n],o=this.spans[a.label];if(null==o)return;this.labelToRope[a.label]={ropeStart:t,ropeEnd:t,startOffset:o.start-r,endOffset:o.end-r-t.length,pre:"",post:"",preComments:void 0,postComments:void 0}}},e.prototype.printRope=function(e){for(var t=function(e){for(var t=new Map,r=[],n=0,i=[e];i.length>0;){var a=i.pop();t.set(a,{start:n,end:n+a.length}),a instanceof _?i.push(a.rhs,a.lhs):(r.push(a.str),n+=a.str.length)}return{str:r.join(""),ropeToSpan:t}}(e),r=t.str,n=t.ropeToSpan,i=[],o=0,s=Object.keys(this.labelToRope).map(Number);o<s.length;o++){var u=s[o],l=this.labelToRope[u],c=l.ropeStart,d=l.ropeEnd,p=l.startOffset,m=l.endOffset,f=l.pre,g=l.post,h=l.preComments,v=l.postComments,S=n.get(c).start,y=n.get(d).end;i[u]=(0,a.formulaSpan)(S+p,y+m,f,g,h,v)}return{formula:r,spans:i}},e.prototype.literalNode=function(e,t,r){switch(e.kind){case y.OperKind.String:return new N('"'+this.anon(e.value).replace(E,'""')+'"');case y.OperKind.Boolean:return new N(e.value?this.localeInfo.trueName:this.localeInfo.falseName);case y.OperKind.Number:return new N(this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21)));case y.OperKind.Missing:return new N("");case y.OperKind.Error:var n=this.localeInfo.errorNames[e.type];if(null==n)throw new U((0,l.internal)("No locale data for error type ".concat(e.type)));return new N(n);default:return(0,u.assertNever)("calc.lang.printFormula",e)}},e.prototype.missingNode=function(e,t){return new N(this.anon(e))},e.prototype.arrayNode=function(e,t,r){var n=this;return new N(this.localeInfo.leftBrace).append(O(e.map((function(e){return O(e.map((function(e){return n.recordPrePost(e.label,n.preIfComments(e.label),e.str,n.postIfComments(e.label))})),n.localeInfo.columnSeparator)})),this.localeInfo.rowSeparator)).append(t?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(e,t,r,n){if(void 0!==e.op){if(1===t.length){var i=t[0];switch(e.op){case s.OperatorId.Percent:return i.str.append(this.recordPrePost(e.label,this.pre(e.label,M),e.str,w));case s.OperatorId.Pound:return i.str.append(this.recordPrePost(e.label,this.preIfComments(e.label),e.str,w));default:return this.recordPrePost(e.label,M,e.str,this.post(e.label,w)).append(i.str)}}if(2===t.length){var a=t[0],o=t[1],l=" ",c=" ";switch(e.op){case s.OperatorId.Range:l=c="";break;case s.OperatorId.Isect:c="";break;case s.OperatorId.Union:l=""}return a.str.append(this.recordPrePost(e.label,this.pre(e.label,{pre:l}),e.str,this.post(e.label,{post:c}))).append(o.str)}return(0,u.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,o){var s=this,u=t.map((function(e){var t=e.name,r=e.binder;return(0,a.letVar)((0,a.indexedArg)({str:s.record(t.arg.label,s.record(t.arg.name.label,s.anon((0,l.getBoundName)(s.localeInfo,t.arg.wholeName)))),label:t.arg.label,op:void 0},t.index),r)}));return this.printApplication(e,(0,a.flattenLetArgs)(u,r,n),i,o)},e.prototype.lambdaNode=function(e,t,r,n,i,o){var s=this,u=t.map((function(e){var t=e.name,r=s.printParamName(t.arg.name),n=void 0===t.arg.def?new N(""):s.recordPrePost(t.arg.def.label,s.pre(t.arg.def.label,D),new N(":=").append(s.recordPrePost(t.arg.def.rhs.label,s.pre(t.arg.def.rhs.label,0===t.arg.def.rhs.str.length?M:D),t.arg.def.rhs.str,w)),w);return(0,a.lambdaParam)((0,a.indexedArg)({str:r.append(n),label:t.arg.label,op:void 0},t.index))}));return this.printApplication(e,(0,a.flattenLambdaArgs)(u,r,n),i,o)},e.prototype.parenNode=function(e,t,r){return new N("(").append(this.recordPrePost(e.label,this.pre(e.label,M),e.str,this.post(e.label,w))).append(t?")":"")},e.prototype.nameNode=function(e,t,r){var n=this.resolver.resolveDottedName(this.locals,(0,a.nameNode)(e,t,r),this.annotations),i=n.headResolved,o=n.node;return k(i.resolution),this.printName(o,i.kind)},e.prototype.cellRefNode=function(e,t,r){var n=this.resolver.resolveCellRef(this.locals,(0,a.cellRefNode)(e,t,r)),i=n.node;return k(n.resolution),this.printCellRef(i)},e.prototype.fieldRefNode=function(e,t,r){var n=t.shouldBeBracketed,i=t.isBracketed||n?this.localeInfo.leftBracket:"",o=t.isBracketed&&t.isClosed||n?this.localeInfo.rightBracket:"",s=this.record(t.field.label,this.anon(t.field.kind===a.NodeKind.Ident?A(t.field.whole,this.isFieldRefEscapable):t.field.chars)),u=t.field.kind!==a.NodeKind.Ident?this.pre(t.label,M):this.preIfComments(t.label);return e.str.append(this.recordPrePost(t.label,u,new N("."+i).append(s).append(o),this.post(t.label,w)))},e.prototype.structRefNode=function(e,t,r){var i,o=this,s=this.resolver.resolveStructRef(this.locals,(0,a.structRefNode)(e,t,r)),u=s.node,c=s.table;k(s.resolution);var d=u.rhs.innerRef,p=void 0===u.lhs?void 0:this.record(u.lhs.label,this.printName(u.lhs,g.ResolvedKind.ResolvedName));if(void 0!==p||void 0===c||!u.rhs.isClosed||(null==d?void 0:d.kind)===a.StructRefKind.ColumnRef||(null==d?void 0:d.kind)===a.StructRefKind.ThisRowOpRef&&(null===(i=d.ref)||void 0===i?void 0:i.kind)===a.StructRefKind.ColumnRef||(p=new N(c.name)),void 0===d&&u.rhs.isClosed&&void 0!==p)return p;var m=new N(this.localeInfo.leftBracket);switch(null==d?void 0:d.kind){case a.StructRefKind.ColumnRef:case a.StructRefKind.SpecialRef:if(d.kind===a.StructRefKind.SpecialRef&&d.id===a.SpecialRefId.ThisRow&&d.isClosed){m=m.append(this.printThisRowOpRef(void 0,d.label));break}m=m.append(this.printRef(d,d.isClosed?n.Unbracketed:n.Original));break;case a.StructRefKind.RangeOpRef:var f=(h=(0,l.isRangeOpClosed)(d)&&(0,l.isRangeOpNoMissing)(d))?n.Bracketed:n.Original;m=m.append(this.printRef(d,f));break;case a.StructRefKind.CommaOpRef:var h;if((h=(0,l.isCommaOpRefWellFormed)(d)&&(0,l.isCommaOpClosed)(d)&&(0,l.isCommaOpNoBadOrMissing)(d))&&d.specialRefs[a.SpecialRefId.ThisRow]){m=m.append(this.printThisRowOpRef(0===d.columnRefs.length?void 0:d.columnRefs[0],d.label));break}var v=h?(0,l.normalizeCommaOpRef)(d):d.refs,S=h?1===v.length?n.Unbracketed:n.Bracketed:n.Original;m=m.append(this.record(d.label,O(v.map((function(e){return o.printRef(e,S)})),this.localeInfo.listSeparator)));break;case a.StructRefKind.ThisRowOpRef:m=m.append(this.printThisRowOpRef(d.ref,d.label));break;case a.StructRefKind.BadRef:m=m.append(this.printRef(d,n.Original))}return u.rhs.isClosed&&(m=m.append(this.localeInfo.rightBracket)),(null!=p?p:new N("")).append(this.record(u.rhs.label,m))},e.prototype.badSequenceNode=function(e,t,r){var n=this;return O(t.map((function(e){return n.recordPrePost(e.label,n.pre(e.label,M),e.str,n.post(e.label,w))})),"")},e.prototype.badCharsNode=function(e,t,r){return new N(this.anon(t))},e.prototype.operatorNode=function(e,t){var r=(0,d.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new U((0,l.internal)("Invalid operator"));return new N(r)},e.prototype.wsfNode=function(e,t,r){return new N(this.localeInfo.getWorksheetFuncName(e))},e.prototype.cellRefError=function(e){var t=this.localeInfo.errorNames[o.ErrorType.REF];if(null==t)throw new U((0,l.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}},e.prototype.cellRefSingle=function(e,t,r,n){var i=(0,m.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==i?{str:this.record(n,this.anon(i)),label:n}:this.cellRefError(n)},e.prototype.cellRefRange=function(e,t,r){var n=(0,m.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==n?{str:this.record(r,this.anon(n)),label:r}:this.cellRefError(r)},e.prototype.cellRefRow=function(e,t,r,n){var i=(0,m.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==i?{str:this.record(n,this.anon(i)),label:n}:this.cellRefError(n)},e.prototype.cellRefCol=function(e,t,r,n){var i=(0,m.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==i?{str:this.record(n,this.anon(i)),label:n}:this.cellRefError(n)},e.prototype.cellRefBad=function(e,t,r){return{str:this.record(r,this.anon(e)),label:r}},e.prototype.errorQualifier=function(e){var t=this.localeInfo.errorNames[o.ErrorType.REF];if(null==t)throw new U((0,l.internal)("No locale data for #REF"));return{str:this.record(e,t),label:e}},e.prototype.relativeQualifier=function(e){return{str:this.record(e,"!"),label:e}},e.prototype.documentQualifier=function(e,t,r,n){return{str:this.record(n,(0,m.quoteQualifier)(this.printUnrecordedDocQual((0,a.documentQualifier)(e,t)))+"!"),label:n}},e.prototype.sheetQualifier=function(e,t,r,n){var i=this.printUnrecordedDocQual(t),a=this.anon(e),o=(0,m.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(null!=i?i:"")+a);return o&&(i=null==i?void 0:i.replace(b,"''"),a=a.replace(b,"''")),{str:this.record(n,new N(o?"'":"").append(void 0===i?new N(""):this.record(t.label,i)).append(a).append(o?"'":"").append("!")),label:n}},e.prototype.identQualifier=function(e,t,r){return{str:this.record(r,(0,m.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"),label:r}},e.prototype.sheetRangeQualifier=function(e,t,r,n,i){var a=this.printUnrecordedDocQual(r),o=this.anon(e),s=this.anon(t),u=(0,m.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(null!=a?a:"")+o)||(0,m.shouldQuoteQualifier)(this.localeInfo,this.refStyle,s);return u&&(a=null==a?void 0:a.replace(b,"''"),o=o.replace(b,"''"),s=s.replace(b,"''")),{str:this.record(i,new N(u?"'":"").append(void 0===a?new N(""):this.record(r.label,a)).append(o).append(":").append(s).append(u?"'":"").append("!")),label:i}},e.prototype.badQualifier=function(e,t,r,n,i){return{str:this.record(i,this.anon(e)),label:i}},e}(),U=(0,l.createFailureErrorClass)("PrintFormulaError"),B=(0,l.createFailureErrorClass)("PrintRangeError");function W(e,t,r,n){void 0===n&&(n=!1);try{return(0,v.success)(new K(e,t,r,n).print())}catch(e){return e instanceof U?(0,v.failure)(e.reason):(0,v.failure)((0,v.javaScriptError)(e))}}function G(e,t){return void 0===e?(0,a.pos)(a.PosKind.Abs,t):(0,a.pos)(a.PosKind.Rel,t-e)}function V(e,t){return(0,a.cellRefSingle)(G(null==e?void 0:e.row,t.row),G(null==e?void 0:e.col,t.col))}function j(e,t){if(0===t.col&&t.cols===c.sheetCols)return function(e,t,r){return(0,a.cellRefRow)(G(null==e?void 0:e.row,t),G(null==e?void 0:e.row,t+r-1))}(e,t.row,t.rows);if(0===t.row&&t.rows===c.sheetRows)return function(e,t,r){return(0,a.cellRefCol)(G(null==e?void 0:e.col,t),G(null==e?void 0:e.col,t+r-1))}(e,t.col,t.cols);var r=V(e,(0,l.gridRangeAnchor)(t));if((0,l.isGridCell)(t))return r;var n=V(e,(0,c.gridCell)(t.row+t.rows-1,t.col+t.cols-1));return(0,a.cellRefRange)(r,n)}function q(e){return(0,v.isSuccess)(e)?((0,u.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,v.success)(e.value)):e.reason.kind===g.ResolveReasonKind.InvalidStructRef?(0,u.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,v.failure)(e.reason)}function H(e,t,r,n){var o,s;void 0===n&&(n=(0,F.makeEmptyTable)());try{var u=t.originSheet.value;if(!(0,l.isDocumentLocEqual)(u.document,r.sheet.document))throw new B((0,l.notImplemented)(["printRange cross-document"]));return(0,v.success)(null!==(s=null!==(o=function(e,t,r,n){var o=t.originSheet.value,s=e.getNamedRanges(r);if(!(0,v.isSuccess)(s))throw new B(s.reason);if(0!==s.value.length){var u=function(e){return void 0!==e.index&&(void 0===o.index||!(0,l.isSheetIndexEqual)(e,o))},d=s.value.filter((function(e){var t=e.scope;return void 0===t.index?(0,l.isDocumentLocEqual)(t.document,r.sheet.document):(0,l.isSheetIndexEqual)(t,r.sheet)})).filter((function(t){var r=t.scope,n=t.name;if(void 0!==r.index||void 0===o.index)return!0;var i=o,a=e.getNameLoc(i,n,c.NameSource.Plain);if(!(0,v.isSuccess)(a))throw new B(a.reason);return null==a.value})).filter((function(e){var t=e.scope,r=e.name;return u(t)||!n.contains(r)}));if(0!==d.length){var p,m=1===d.length?d[0]:i.__spreadArray([],d,!0).sort((function(t,r){return e.config.localeInfo.stringCompareCI(t.name,r.name)}))[0];if(u(m.scope)){var f=e.getSheetName(m.scope.document,m.scope.index);if(!(0,v.isSuccess)(f))throw new B(f.reason);p=(0,a.sheetQualifier)(f.value)}return(0,a.nameNode)((0,a.identNamePart)(m.name),p)}}}(e,t,r,n))&&void 0!==o?o:function(e,t,r){var n=r.sheet,i=r.range,o=e.getContainingTable((0,c.sheetGridCell)(n,(0,l.gridRangeAnchor)(i)));if(!(0,v.isSuccess)(o))throw new B(o.reason);if(null!=o.value){var s=o.value,u=q(e.getStructRefSpecialRef(s,a.SpecialRefId.All));if(!(0,v.isSuccess)(u))throw new B(u.reason);var d=u.value.range,p=u.value.sheet,m=(0,l.gridRangeCompare)(d,i);if(!(void 0===m||m<0)){var f=q(e.getStructRefSpecialRef(s,a.SpecialRefId.Data));if(!(0,v.isSuccess)(f))throw new B(f.reason);var g=f.value.range,h=t.originGridCell.value,S=t.originSheet.value,y=void 0!==S.index&&(0,l.isSheetIndexEqual)(S,p)&&(0,l.gridRangeIsects)(d,h)?void 0:(0,a.nameNode)((0,a.identNamePart)(s.name)),F=null!=y?y:(0,a.nameNode)((0,a.identNamePart)(s.name)),C=g.cols>1&&i.col===g.col&&i.cols===g.cols,R=function(){var t=q(e.getStructRefColumn(s,i.col));if(!(0,v.isSuccess)(t))throw new B(t.reason);if(1===i.cols)return(0,a.columnRef)(t.value.name);var r=q(e.getStructRefColumn(s,i.col+i.cols-1));if(!(0,v.isSuccess)(r))throw new B(r.reason);return(0,a.rangeOpRef)((0,a.columnRef)(t.value.name),(0,a.columnRef)(r.value.name))};if(i.row===d.row&&i.rows===d.rows)return(0,a.structRefNode)(F,(0,a.structRef)(C?(0,a.specialRef)(a.SpecialRefId.All):(0,a.commaOpRef)([(0,a.specialRef)(a.SpecialRefId.All,!0),R()])));if(1===i.rows&&i.row===h.row&&i.row>=g.row&&i.row<g.row+g.rows)return(0,a.structRefNode)(1===i.cols?y:F,(0,a.structRef)((0,a.thisRowOpRef)(C?void 0:R())));if(i.row===g.row&&i.rows===g.rows)return C?(0,a.structRefNode)(F,(0,a.structRef)(void 0)):(0,a.structRefNode)(1===i.cols?y:F,(0,a.structRef)(R()));var b=i.row===d.row&&i.row+i.rows===g.row,E=i.row===g.row+g.rows&&i.row+i.rows===d.row+d.rows;if(b||E){var P=(0,a.specialRef)(b?a.SpecialRefId.Headers:a.SpecialRefId.Totals,!C);return(0,a.structRefNode)(F,(0,a.structRef)(C?P:(0,a.commaOpRef)([P,R()])))}var k=i.row===d.row&&d.row<g.row&&i.row+i.rows===g.row+g.rows,T=i.row===g.row&&d.row+d.rows>g.row+g.rows&&i.row+i.rows===d.row+d.rows;if(k||T){var A=(0,a.specialRef)(k?a.SpecialRefId.Headers:a.SpecialRefId.Data,!0),N=(0,a.specialRef)(k?a.SpecialRefId.Data:a.SpecialRefId.Totals,!0);return(0,a.structRefNode)(F,(0,a.structRef)(C?(0,a.commaOpRef)([A,N]):(0,a.commaOpRef)([A,N,R()])))}}}}(e,t,r))&&void 0!==s?s:function(e,t,r){var n,i=t.originSheet.value,o=j(t.printAbsoluteReferences?void 0:t.originGridCell.value,r.range);if(void 0===i.index||!(0,l.isSheetIndexEqual)(i,r.sheet)){var s=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,v.isSuccess)(s))throw new B(s.reason);n=(0,a.sheetQualifier)(s.value)}return(0,a.cellRefNode)(o,n)}(e,t,r))}catch(e){return e instanceof B?(0,v.failure)(e.reason):(0,v.failure)((0,v.javaScriptError)(e))}}t.anonymizeFormula=function(e,t,r){try{var n=r.kind===c.LexicalKind.Cell||r.kind===c.LexicalKind.Range?(0,C.printLocalsGrid)(r,(0,l.sheetGridRangeAnchor)(r.range)):r.kind===c.LexicalKind.NameManager?(0,C.printLocalsName)(r,P):(0,u.assertNever)("calc.lang.anonymizeFormula",r),i=W((0,C.createSimplePrintGlobals)((0,d.calcConfig)((0,d.getEnglishLocaleInfo)(),a.RefStyle.A1,e.mathpack)),n,t,!0);if(i.kind===v.ResultKind.Success)return i.value.formula;if(i.reason.kind===v.ReasonKind.JavaScriptError)throw i.reason.error}catch(e){var o="calc.lang.anonymizeFormula: Format failed: "+(0,f.messageFromError)(e);u.ulsLogger.ULS.traceTag(507381981,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,o)}return(0,p.anonymize)(t)};var z={getNamedRanges:function(){return(0,u.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}};t.createPrinter=function(e){var t=function(e){var t,r,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:null===(t=e.getStructRefSpecialRef)||void 0===t?void 0:t.bind(e),getNamedRanges:null!==(n=null===(r=e.getNamedRanges)||void 0===r?void 0:r.bind(e))&&void 0!==n?n:z.getNamedRanges}}(e);return{printFormula:function(t,r){var n=W(e,t,r);return(0,v.isSuccess)(n)?(0,v.success)(n.value.formula):n},printFormulaEx:function(t,r){return W(e,t,r)},printRange:function(e,r,n){return H(t,e,r,n)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(1);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n=r(1);t.makeEmptyTable=n.table.makeEmptyTable,t.entry=n.table.entry},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldRef=t.fieldRefNamePart=t.nameNode=t.lambdaNode=t.letNode=t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpCharsNode=t.badFieldRefNode=t.badStructRefNode=t.badUnexpSeqNode=t.absPos=t.relPos=t.expectTrue=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;var n=r(50),i=r(61),a=r(40),o=r(101);function s(e,t){return void 0===t&&(t=0),(0,a.badSequenceNode)(a.BadType.Unexpected,e,t)}function u(e,t){return void 0===t&&(t=0),(0,a.badCharsNode)(a.BadType.Unexpected,e,t)}function l(e){return function(t){return void 0===t&&(t=0),(0,a.operatorNode)(e,t)}}function c(e,t,r,n,i){return(0,a.fieldRef)("string"==typeof e?(0,a.identNode)(e):e,t,r,n,i)}t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0),t.createSingleRange=function(e,r){var i=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,i)},t.isNameLocEqual=function(e,t,r){return(0,i.isNameScopeEqual)(t.scope,r.scope)&&0===e.stringCompareCI(t.name,r.name)},t.expectTrue=function(e){expect(e).toBeTruthy()},t.relPos=function(e){return(0,a.pos)(a.PosKind.Rel,e)},t.absPos=function(e){return(0,a.pos)(a.PosKind.Abs,e)},t.badUnexpSeqNode=s,t.badStructRefNode=function(e,t){return void 0===t&&(t=0),(0,a.badSequenceNode)(a.BadType.StructRef,e,t)},t.badFieldRefNode=function(e,t){return void 0===t&&(t=0),(0,a.badSequenceNode)(a.BadType.FieldRef,e,t)},t.badUnexpCharsNode=u,t.badNumberLiteralNode=function(e,t){return void 0===t&&(t=0),(0,a.badCharsNode)(a.BadType.NumberLiteral,e,t)},t.badStringLiteralNode=function(e,t){return void 0===t&&(t=0),(0,a.badCharsNode)(a.BadType.StringLiteral,e,t)},t.badErrorLiteralNode=function(e,t){return void 0===t&&(t=0),(0,a.badCharsNode)(a.BadType.ErrorLiteral,e,t)},t.badFieldNameNode=function(e,t){return void 0===t&&(t=0),(0,a.badCharsNode)(a.BadType.FieldName,e,t)},t.badParamNameNode=function(e,t){return void 0===t&&(t=0),(0,a.badCharsNode)(a.BadType.ParamName,e,t)},t.badCellRefNode=function(e,t,r,n){return void 0===t&&(t=e.indexOf("[")>=0),void 0===r&&(r=0),void 0===n&&(n=0),(0,a.cellRefNode)((0,a.cellRefBad)(e,t,r),void 0,n)},t.badQualNode=function(e,t){return void 0===t&&(t=0),(0,a.badCharsNode)(a.BadType.Qualifier,e,t)},t.badBracketNode=function(e,t){void 0===t&&(t=!0);var r=[u("["),e];return t&&r.push(u("]")),s(r)},t.addNode=l(o.OperatorId.Add),t.subNode=l(o.OperatorId.Sub),t.mulNode=l(o.OperatorId.Mul),t.divNode=l(o.OperatorId.Div),t.powNode=l(o.OperatorId.Pow),t.percentNode=l(o.OperatorId.Percent),t.negNode=l(o.OperatorId.Neg),t.posNode=l(o.OperatorId.Pos),t.concatNode=l(o.OperatorId.Concat),t.eqNode=l(o.OperatorId.Eq),t.neNode=l(o.OperatorId.Ne),t.ltNode=l(o.OperatorId.Lt),t.leNode=l(o.OperatorId.Le),t.gtNode=l(o.OperatorId.Gt),t.geNode=l(o.OperatorId.Ge),t.rangeNode=l(o.OperatorId.Range),t.isectNode=l(o.OperatorId.Isect),t.unionNode=l(o.OperatorId.Union),t.andNode=l(o.OperatorId.And),t.orNode=l(o.OperatorId.Or),t.xorNode=l(o.OperatorId.Xor),t.minNode=l(o.OperatorId.Min),t.maxNode=l(o.OperatorId.Max),t.atNode=l(o.OperatorId.At),t.poundNode=l(o.OperatorId.Pound),t.letNode=function(e,t,r,n,i,o){void 0===n&&(n=[]);var s=t.map((function(e){return t=e,Array.isArray(t)?[e[0].kind===a.NodeKind.Ident?(0,a.varNode)(e[0]):e[0],e[1]]:e;var t}));return(0,a.letNode)(e,s,r,n,i,o)},t.lambdaNode=function(e,t,r,n,i,o){void 0===n&&(n=[]);var s=t.map((function(e){return void 0===e.kind||e.kind===a.NodeKind.Param?e:(0,a.paramNode)((0,a.paramName)(e,!1),void 0)}));return(0,a.lambdaNode)(e,s,r,n,i,o)},t.nameNode=function(e,t,r){var n="string"==typeof e?(0,a.identNamePart)(e,!0):e;return(0,a.nameNode)(n,t,r)},t.fieldRefNamePart=function(e,t,r,n,i){var o="string"==typeof t?c(t,!1,!0,!1):t;return(0,a.fieldRefNamePart)(e,o,r,n,i)},t.fieldRef=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;var n,i,a,o,s,u,l,c=r(32);!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(n||(t.FontUnderline=n={})),(0,c.staticAssertSame)(),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(i||(t.FontVerticalAlignment=i={})),(0,c.staticAssertSame)(),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(a||(t.FillKind=a={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(o||(t.PatternType=o={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(s||(t.BorderLineType=s={})),(0,c.staticAssertSame)(),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(u||(t.HorizontalAlignment=u={})),(0,c.staticAssertSame)(),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(l||(t.VerticalAlignment=l={})),(0,c.staticAssertSame)()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.externalErrorOper=t.busyErrorOper=t.calcErrorOper=t.fieldErrorOper=t.unknownErrorOper=t.blockedErrorOper=t.connectErrorOper=t.spillErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.booleanOper=t.stringOper=t.precedents=t.ErrorType=t.falseOper=t.trueOper=t.OperKind=t.PrecsBound=t.SpecialPrecs=void 0;var n=r(0),i=n.__importStar(r(72)),a=n.__importStar(r(51));t.SpecialPrecs=a.SpecialPrecs,t.PrecsBound=i.PrecsBound,t.OperKind=a.OperKind,t.trueOper=i.trueOper,t.falseOper=i.falseOper,t.ErrorType=i.ErrorType,t.precedents=i.precedents,t.stringOper=i.stringOper,t.booleanOper=i.booleanOper,t.errorOper=i.errorOper,t.nullErrorOper=i.nullErrorOper,t.div0ErrorOper=i.div0ErrorOper,t.valueErrorOper=i.valueErrorOper,t.refErrorOper=i.refErrorOper,t.nameErrorOper=i.nameErrorOper,t.numErrorOper=i.numErrorOper,t.naErrorOper=i.naErrorOper,t.gettingDataErrorOper=i.gettingDataErrorOper,t.spillErrorOper=i.spillErrorOper,t.connectErrorOper=i.connectErrorOper,t.blockedErrorOper=i.blockedErrorOper,t.unknownErrorOper=i.unknownErrorOper,t.fieldErrorOper=i.fieldErrorOper,t.calcErrorOper=i.calcErrorOper,t.busyErrorOper=i.busyErrorOper,t.externalErrorOper=i.externalErrorOper,t.arrayOper=i.arrayOper,t.rangeSeqOper=i.rangeSeqOper,t.range3DOper=i.range3DOper,t.missingOper=i.missingOper,t.blankOper=i.blankOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncType=t.getOperatorType=t.unknownFunctionType=t.functionType=t.SpecialPrecs=t.WorksheetFuncId=t.OperatorId=t.FunctionFlags=t.SignatureType=void 0;var n=r(0),i=n.__importStar(r(36)),a=n.__importStar(r(51));t.SignatureType=a.SignatureType,t.FunctionFlags=a.FunctionFlags,t.OperatorId=i.OperatorId,t.WorksheetFuncId=i.WorksheetFuncId,t.SpecialPrecs=a.SpecialPrecs,t.functionType=a.functionType,t.unknownFunctionType=i.unknownFunctionType,t.getOperatorType=i.getOperatorType,t.getWorksheetFuncType=i.getWorksheetFuncType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonKind=t.isSuccess=t.successUndefined=t.failure=t.success=t.ResultKind=t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.isValidArgsLength=t.getArgType=t.getArguments=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isWSFNode=t.isOperatorNode=t.isUnqualifiedNameNode=t.isWellFormed=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isSheetGridCell=t.isGridCell=t.isSheetGridRange=t.isSheetIndex=void 0,t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=t.resolveGridRef=t.createResolver=t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedWorksheetFunc=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.InvalidStructRefReason=t.invalidStructRef=t.InvalidCellRefReason=t.invalidCellRef=t.InvalidQualifierReason=t.invalidQualifier=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.formatName=t.formatGridRange=t.formatQualifier=t.formatRangePos=t.formatCellPos=t.formatColRange=t.formatRowRange=t.formatCol=t.formatRow=t.resolvePosition=t.columnName=t.createFailureErrorClass=t.javaScriptError=t.internal=t.unavailable=t.notImplemented=void 0,t.relabelFormula=t.createPrinter=t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=t.buildAnnotations=t.reducePledge=t.reduceBottomUp=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=void 0;var n=r(0),i=n.__importStar(r(234)),a=n.__importStar(r(402)),o=n.__importStar(r(11)),s=n.__importStar(r(105)),u=n.__importStar(r(5)),l=n.__importStar(r(160)),c=n.__importStar(r(21)),d=n.__importStar(r(403)),p=n.__importStar(r(404)),m=n.__importStar(r(161)),f=n.__importStar(r(162));t.isSheetIndex=o.isSheetIndex,t.isSheetGridRange=o.isSheetGridRange,t.isGridCell=o.isGridCell,t.isSheetGridCell=o.isSheetGridCell,t.forEachCellInRange=o.forEachCellInRange,t.forEachTileInRange=o.forEachTileInRange,t.gridRangeJoin=o.gridRangeJoin,t.gridRangeJoinOpt=o.gridRangeJoinOpt,t.gridRangesJoin=o.gridRangesJoin,t.gridRangeIsect=o.gridRangeIsect,t.gridRangeIsects=o.gridRangeIsects,t.gridCellImplicitIsect=o.gridCellImplicitIsect,t.gridRangeCompare=o.gridRangeCompare,t.gridRangeExcept=o.gridRangeExcept,t.gridRangeSize=o.gridRangeSize,t.isDocumentLocEqual=o.isDocumentLocEqual,t.isSheetIndexEqual=o.isSheetIndexEqual,t.isNameScopeEqual=o.isNameScopeEqual,t.isGridCellEqual=o.isGridCellEqual,t.isGridRangeEqual=o.isGridRangeEqual,t.isSheetGridCellEqual=o.isSheetGridCellEqual,t.isSheetGridRangeEqual=o.isSheetGridRangeEqual,t.isWellFormed=o.isWellFormed,t.isUnqualifiedNameNode=o.isUnqualifiedNameNode,t.isOperatorNode=o.isOperatorNode,t.isWSFNode=o.isWSFNode,t.gridRangeAnchor=o.gridRangeAnchor,t.sheetGridRangeAnchor=o.sheetGridRangeAnchor,t.gridCellRange=o.gridCellRange,t.getArguments=o.getArguments,t.getArgType=o.getArgType,t.isValidArgsLength=o.isValidArgsLength,t.isNumberOper=o.isNumberOper,t.isStringOper=o.isStringOper,t.isBooleanOper=o.isBooleanOper,t.isErrorOper=o.isErrorOper,t.isRangeOper=o.isRangeOper,t.isArrayOper=o.isArrayOper,t.isMissingOper=o.isMissingOper,t.isBlankOper=o.isBlankOper,t.isRichOper=o.isRichOper,t.isPrimitiveOper=o.isPrimitiveOper,t.isWriteOper=o.isWriteOper,t.isReadOperEqual=o.isReadOperEqual,t.ResultKind=u.ResultKind,t.success=u.success,t.failure=u.failure,t.successUndefined=u.successUndefined,t.isSuccess=u.isSuccess,t.ReasonKind=o.ReasonKind,t.notImplemented=o.notImplemented,t.unavailable=o.unavailable,t.internal=o.internal,t.javaScriptError=u.javaScriptError,t.createFailureErrorClass=o.createFailureErrorClass,t.columnName=i.columnName,t.resolvePosition=i.resolvePosition,t.formatRow=i.formatRow,t.formatCol=i.formatCol,t.formatRowRange=i.formatRowRange,t.formatColRange=i.formatColRange,t.formatCellPos=i.formatCellPos,t.formatRangePos=i.formatRangePos,t.formatQualifier=i.formatQualifier,t.formatGridRange=i.formatGridRange,t.formatName=i.formatName,t.parseGridCellA1=a.parseGridCellA1,t.parseGridRangeA1=a.parseGridRangeA1,t.parseQualifier=a.parseQualifier,t.wrapPosition=a.wrapPosition,t.resolveLocalsGrid=s.resolveLocalsGrid,t.ResolveReasonKind=s.ResolveReasonKind,t.noOriginSheet=s.noOriginSheet,t.invalidQualifier=s.invalidQualifier,t.InvalidQualifierReason=s.InvalidQualifierReason,t.invalidCellRef=s.invalidCellRef,t.InvalidCellRefReason=s.InvalidCellRefReason,t.invalidStructRef=s.invalidStructRef,t.InvalidStructRefReason=s.InvalidStructRefReason,t.emptyIntersection=s.emptyIntersection,t.ResolvedKind=s.ResolvedKind,t.resolvedName=s.resolvedName,t.resolvedCellRef=s.resolvedCellRef,t.resolvedUserDefinedFunc=s.resolvedUserDefinedFunc,t.resolvedLocalName=s.resolvedLocalName,t.resolvedWorksheetFunc=s.resolvedWorksheetFunc,t.resolvedStructRef=s.resolvedStructRef,t.resolvedNever=s.resolvedNever,t.resolvedDottedName=s.resolvedDottedName,t.createResolver=l.createResolver,t.resolveGridRef=l.resolveGridRef,t.visitFormulaNode=c.visitFormulaNode,t.visitOperatorNode=c.visitOperatorNode,t.visitWSFNode=c.visitWSFNode,t.visitAppHeadNode=c.visitAppHeadNode,t.visitQualifier=c.visitQualifier,t.visitCellRef=c.visitCellRef,t.IdentityVisitor=c.IdentityVisitor,t.identityVisitor=c.identityVisitor,t.ConstVisitor=c.ConstVisitor,t.constVisitor=c.constVisitor,t.voidVisitor=c.voidVisitor,t.DelegatingVisitor=c.DelegatingVisitor,t.BinaryVisitor=c.BinaryVisitor,t.binaryVisitor=c.binaryVisitor,t.ComposeVisitor=c.ComposeVisitor,t.composeVisitor=c.composeVisitor,t.reduceBottomUp=c.reduceBottomUp,t.reducePledge=c.reducePledge,t.buildAnnotations=d.buildAnnotations,t.createSimplePrintGlobals=m.createSimplePrintGlobals,t.printLocalsGrid=m.printLocalsGrid,t.printLocalsName=m.printLocalsName,t.createPrinter=f.createPrinter,t.relabelFormula=p.relabelFormula},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseQualifier=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var n=r(3);t.SpecialPos=n.cellParse.SpecialPos,t.isR1C1IdentStart=n.cellParse.isR1C1IdentStart,t.parseCellRef=n.cellParse.parseCellRef,t.parseGridCellA1=n.cellParse.parseGridCellA1,t.parseGridRangeA1=n.cellParse.parseGridRangeA1,t.parseQualifier=n.cellParse.parseQualifier,t.wrapPosition=n.cellParse.wrapPosition},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var n=r(3);t.buildAnnotations=n.annotations.buildAnnotations},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;var n=r(3);t.relabelFormula=n.relabel.relabelFormula},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberComponents=t.formatScientificLeft=void 0;var n=r(3);t.formatScientificLeft=n.mathpack.formatScientificLeft,t.numberComponents=n.mathpack.numberComponents},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;var n=r(3);t.ieeeMathpack=n.mathpackIEEE.ieeeMathpack},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.dateTime=t.tzUTC=t.tzData=t.Rounding=t.TimeDivision=void 0;var n=r(0).__importStar(r(129));t.TimeDivision=n.TimeDivision,t.Rounding=n.Rounding,t.tzData=n.tzData,t.tzUTC=n.tzUTC,t.dateTime=n.dateTime,t.TimeGranularity=n.TimeGranularity,t.xlDatepack=n.xlDatepack},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;var n=r(237),i=r(239),a=r(411);t.createAnalyzer=function(e){return{checkFormula:function(t,r){return(0,n.checkFormula)(e,t,r)},checkFormulaWithDiagnostics:function(t,r){return(0,n.checkFormulaWithDiagnostics)(e,t,r)},autocorrectFormula:function(t,r){return(0,i.autocorrectFormula)(e,t,r)},resolveStaticPrecedents:function(t,r){return(0,a.resolveStaticPrecedents)(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(1);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(1);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=void 0;var n=r(0),i=r(41),a=r(107),o=r(43),s=r(33),u=r(130),l=r(165),c=r(240),d=r(82),p=r(56),m=r(62),f=r(57),g=r(166),h=r(242),v={getDocumentLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc")},getSheetIndex:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex")},getSheetName:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName")},getNameLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes")},getContainingTable:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable")},getStructRefColumn:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")}};var S=(0,m.createFailureErrorClass)("ResolveStaticPrecedentsError"),y=function(e){function t(t,r,n){var i=e.call(this)||this;return i.locals=r,i.annotations=n,i.cells=[],i.names=[],i.udfs=[],i.nameSpecial=p.SpecialPrecs.None,i.ownSpecial=p.SpecialPrecs.None,i.resolutions=[],i.globals=function(e){var t,r,n,i,a,o,s,u,l,c,d,p,m,f,g,h,S,y;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:v.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:v.getSheetIndex,getSheetName:null!==(o=null===(a=e.getSheetName)||void 0===a?void 0:a.bind(e))&&void 0!==o?o:v.getSheetName,getNameLoc:null!==(u=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==u?u:v.getNameLoc,getUserDefinedFuncLoc:null!==(c=null===(l=e.getUserDefinedFuncLoc)||void 0===l?void 0:l.bind(e))&&void 0!==c?c:v.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(p=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==p?p:v.getSheetRangeIndexes,getContainingTable:null!==(f=null===(m=e.getContainingTable)||void 0===m?void 0:m.bind(e))&&void 0!==f?f:v.getContainingTable,getStructRefColumn:null!==(h=null===(g=e.getStructRefColumn)||void 0===g?void 0:g.bind(e))&&void 0!==h?h:v.getStructRefColumn,getStructRefSpecialRef:null!==(y=null===(S=e.getStructRefSpecialRef)||void 0===S?void 0:S.bind(e))&&void 0!==y?y:v.getStructRefSpecialRef}}(t),i.resolver=(0,l.createResolver)(i.globals),i}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){var a,l,f,g,h=this;if(t.kind===s.NodeKind.WSF){var v=t.id,S=(0,d.getWorksheetFuncType)(v).staticPrecs;switch(v){case d.WorksheetFuncId.LOOKUP:case d.WorksheetFuncId.SUMIF:case d.WorksheetFuncId.AVERAGEIF:var y=function(e){var t=e.label,r=h.resolutions[t],n=(null==r?void 0:r.kind)===c.ResolvedKind.ResolvedCellRef||(null==r?void 0:r.kind)===c.ResolvedKind.ResolvedStructRef?r.resolution:void 0;return(null==n?void 0:n.kind)===o.ResultKind.Success?n.value:void 0};(r.length<3||r[2].kind===s.NodeKind.Literal||r[2].kind===s.NodeKind.Array||(a=r[2],l=v===d.WorksheetFuncId.LOOKUP?r[1]:r[0],f=y(a),g=y(l),void 0!==f&&void 0!==g&&(0,u.isSheetGridRange)(f)&&(0,u.isSheetGridRange)(g)&&(0,m.isDocumentLocEqual)(f.sheet.document,g.sheet.document)&&f.range.rows===g.range.rows&&f.range.cols===g.range.cols))&&(S&=~p.SpecialPrecs.AllCells)}S!==p.SpecialPrecs.None&&(this.ownSpecial|=S)}return e.prototype.appNode.call(this,t,r,n,i)},t.prototype.nameNode=function(t,r,n){var i=this.resolver.resolveDottedName(this.locals,(0,s.nameNode)(t,r,n),this.annotations);this.resolutions[n]=i,(0,a.safePush)(this.names,i.precedents.names),(0,a.safePush)(this.udfs,i.precedents.udfs);var u=i.headResolved;switch(u.kind){case c.ResolvedKind.ResolvedName:if(!(0,o.isSuccess)(u.resolution)){this.handleResolutionError(u.resolution.reason);break}void 0!==u.resolution.value&&(this.nameSpecial|=p.SpecialPrecs.All);break;case c.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,o.isSuccess)(u.resolution)){this.handleResolutionError(u.resolution.reason);break}break;case c.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(u.resolution)}return e.prototype.nameNode.call(this,t,r,n)},t.prototype.cellRefNode=function(t,r,n){var i=this.resolver.resolveCellRef(this.locals,(0,s.cellRefNode)(t,r,n));this.resolutions[n]=i;var a=i.resolution;return this.pushResolvedGridRef(a),e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.structRefNode=function(t,r,n){var i=this.resolver.resolveStructRef(this.locals,(0,s.structRefNode)(t,r,n));this.resolutions[n]=i,(0,a.safePush)(this.names,i.precedents);var o=i.resolution;return this.pushResolvedGridRef(o),e.prototype.structRefNode.call(this,t,r,n)},t.prototype.pushResolvedGridRef=function(e){if(e.kind!==o.ResultKind.Success)return this.handleResolutionError(e.reason);if(void 0!==e.value){var t=e.value;if((0,u.isSheetGridRange)(t))this.cells.push(t);else{this.ownSpecial|=p.SpecialPrecs.OwnDocSheets;var r=this.globals.getSheetRangeIndexes(t.sheet);if(!(0,o.isSuccess)(r))throw new S(r.reason);(0,a.safePush)(this.cells,r.value.sheets.map((function(e){return(0,u.sheetGridRange)((0,u.sheetIndex)(t.sheet.document,e),t.range)})))}}},t.prototype.handleResolutionError=function(e){switch(e.kind){case c.ResolveReasonKind.NoOriginSheet:case c.ResolveReasonKind.InvalidStructRef:case c.ResolveReasonKind.InvalidCellRef:case c.ResolveReasonKind.InvalidQualifier:case c.ResolveReasonKind.EmptyIntersection:return}throw new S(e)},t}(g.IdentityVisitor);t.resolveStaticPrecedents=function(e,t,r){try{var n=new y(e,t,r.annotations);return(0,g.reduceBottomUp)(n,r),(0,o.success)((0,h.staticPrecedents)(n.cells,n.names,n.udfs,n.nameSpecial|n.ownSpecial,n.ownSpecial,f.PrecsBound.Upper,n.resolutions))}catch(e){return e instanceof S?(0,o.failure)(e.reason):(0,o.failure)((0,o.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var n=r(3);t.buildAnnotations=n.annotations.buildAnnotations},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.ExtractLetVisitor=t.CaretInsideArrayNodeIdentityVisitor=void 0;var n=r(0),i=r(41),a=r(33),o=r(238),s=r(82),u=r(43),l=r(166),c=r(107),d=r(168),p=r(56),m=r(57),f=r(14),g=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.caretPosition=r,n.isInsideArrayNode=!1,n.autoCompleteFixForArrayNodesEnabled=(0,f.isChangeGateEnabled)("OfficeVSO:7896479_autoCompleteFixForArrayNodesEnabled"),n}return n.__extends(t,e),t.prototype.arrayNode=function(t,r,n){var i=e.prototype.arrayNode.call(this,t,r,n);return this.autoCompleteFixForArrayNodesEnabled&&this.caretInNode(i)&&(this.isInsideArrayNode=!0),i},t.prototype.caretInNode=function(e){if(void 0===e)return!1;var t=this.parsedFormulaTree.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end},t}(l.IdentityVisitor);function h(e,t){var r=e[t];return(0,i.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",void 0!==r),r}t.CaretInsideArrayNodeIdentityVisitor=g;var v=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.references=[],n}return n.__extends(t,e),t.prototype.letNode=function(t,r,n,i,a,o){if(this.caretInNode(null==n?void 0:n.arg))this.pushNames(r);else for(var u=0;u<r.length;u+=1){var l=r[u].binder;if(this.caretInNode(l.arg)){this.pushNames(t.id===s.WorksheetFuncId.LET?r.slice(0,u):r);break}}return e.prototype.letNode.call(this,t,r,n,i,a,o)},t.prototype.lambdaNode=function(t,r,n,i,a,o){if(this.caretInNode(null==n?void 0:n.arg))this.pushNames(r);else for(var s=0;s<r.length;s+=1){var u=r[s].name;if(void 0!==u.arg.def&&this.caretInNode(u.arg.def.rhs)){this.pushNames(r.slice(0,s));break}}return e.prototype.lambdaNode.call(this,t,r,n,i,a,o)},t.prototype.pushNames=function(e){(0,c.safePush)(this.references,e.map((function(e){return e.name.arg.wholeName})).filter(c.isDefined).reverse())},t}(g);function S(e,t,r,s,c,f,g){if(void 0===c&&(c=!1),!(0,u.isSuccess)(e))return!1;try{!function(e,t,r,i,o,s,c){if(null==e||null==i)return;var d={};null!=r?r.forEach((function(e){d[e]=!0})):d["*"]=!0;var f={},g=0,v=[],S=n.__assign(n.__assign({},l.voidVisitor),{letNode:function(t,r,n,i,a,o){for(var s=0,u=r;s<u.length;s++){var l=u[s].name;f[l.arg.label]=g}v.push({letCount:g,span:h(e.spans,o)}),g+=1},lambdaNode:function(t,r,n,i,a,o){for(var s=0,u=r;s<u.length;s++){var l=u[s].name;f[l.arg.label]=g}v.push({letCount:g,span:h(e.spans,o)}),g+=1}});(0,l.reduceBottomUp)(S,e),v.sort((function(e,t){return e.span.start-t.span.start}));for(var y={},F=0;F<v.length;F+=1)y[v[F].letCount]=F;for(var C=0,R=Object.keys(f).map(Number);C<R.length;C++){var b=R[C];f[b]=y[f[b]]}var E={literalNode:function(e,t,r){var n=l.identityVisitor.literalNode(e,t,r);return P("literal")&&i("literal",{label:r,value:n,valueKind:e.kind}),n},missingNode:function(e,t){var r=l.identityVisitor.missingNode(e,t);return P("literal")&&i("literal",{label:t,value:(0,a.literalNode)(m.missingOper,!0,t),valueKind:p.OperKind.Missing}),r},arrayNode:function(e,t,r){return l.identityVisitor.arrayNode(e,t,r)},appNode:function(e,t,r,n){var i=l.identityVisitor.appNode(e,t,r,n);return T(e,t,r,n),i},letNode:function(e,t,r,n,o,s){var u=(0,a.letNode)(e,t,r,n,o,s);T(e,u.args,o,s);for(var l=0,c=t;l<c.length;l++){var d=c[l].name;P("letName")&&i("letName",{label:d.arg.label,name:d.arg.wholeName,number:f[d.arg.label],qualifier:void 0})}return u},lambdaNode:function(e,t,r,n,o,s){var u=(0,a.lambdaNode)(e,t,r,n,o,s);T(e,u.args,o,s);for(var l=0,c=t;l<c.length;l++){var d=c[l].name;P("letName")&&i("letName",{label:d.arg.name.name.label,name:d.arg.wholeName,number:f[d.arg.label],qualifier:void 0})}return u},parenNode:function(e,t,r){return l.identityVisitor.parenNode(e,t,r)},nameNode:function(t,r,n){var o=(0,a.nameNode)(t,r,n),s=e.annotations[t.label],u=e.annotations[n];if((null==u?void 0:u.kind)===a.AnnotationKind.AppHeadName);else if((null==s?void 0:s.kind)===a.AnnotationKind.LocalNameUse){var l=f[s.label];P("letName")&&null!=l&&i("letName",{label:n,name:s.name,number:l,qualifier:void 0})}else if(P("namedRange")){var c=o.whole.split(".");i("namedRange",{label:n,name:c[0],names:c.slice(1),qualifier:k(o)})}return o},cellRefNode:function(t,r,n){var o=(0,a.cellRefNode)(t,r,n);return P("range")&&function(t){if(null==e||null==i)return;switch(t.ref.kind){case a.CellRefKind.Error:break;case a.CellRefKind.Col:var r=t.ref;i("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:h(e.spans,r.label),qualifier:k(t)});break;case a.CellRefKind.Row:var n=t.ref;i("range",{label:t.label,type:"row",startIndex:n.row1,endIndex:n.row2,span:h(e.spans,n.label),qualifier:k(t)});break;case a.CellRefKind.Single:var o=t.ref;i("range",{label:t.label,type:"cell",row:o.row,col:o.col,span:h(e.spans,o.label),qualifier:k(t)});break;case a.CellRefKind.Range:var s=t.ref;i("range",{label:t.label,type:"range",top:s.ref1.row,left:s.ref1.col,bottom:s.ref2.row,right:s.ref2.col,topLeftSpan:h(e.spans,s.ref1.label),bottomRightSpan:h(e.spans,s.ref2.label),qualifier:k(t)})}}(o),o},fieldRefNode:function(e,t,r){return l.identityVisitor.fieldRefNode(e,t,r)},structRefNode:function(t,r,n){var o=(0,a.structRefNode)(t,r,n);if(P("structRefRange")){if(null==c||null==s)return o;var l=c.resolveStructRef(s,o).resolution;if(!(0,u.isSuccess)(l)||void 0===l.value)return o;var d=l.value;i("structRefRange",{label:n,type:"range",top:(0,a.pos)(a.PosKind.Rel,d.range.row),left:(0,a.pos)(a.PosKind.Rel,d.range.col),bottom:(0,a.pos)(a.PosKind.Rel,d.range.row+d.range.rows-1),right:(0,a.pos)(a.PosKind.Rel,d.range.col+d.range.cols-1),span:h(e.spans,n),qualifier:void 0!==t?k(t):void 0,name:void 0!==t?t.whole:void 0})}return o},badSequenceNode:function(e,t,r){return l.identityVisitor.badSequenceNode(e,t,r)},badCharsNode:function(e,t,r){return l.identityVisitor.badCharsNode(e,t,r)},operatorNode:function(e,t){return l.identityVisitor.operatorNode(e,t)},wsfNode:function(e,t,r){return l.identityVisitor.wsfNode(e,t,r)}};function P(e){return d[e]||d["*"]}function k(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case a.QualifierKind.Sheet:var r=e.qualifier;t.type="Sheet",t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case a.QualifierKind.SheetRange:var n=e.qualifier;t.type="SheetRange",t.sheet1=n.sheet1,t.sheet2=n.sheet2,null!=n.document&&(t.document=n.document.document,null!=n.document.path&&(t.documentPath=n.document.path));break;case a.QualifierKind.Ident:var i=e.qualifier;t.type="Ident",t.name=i.name;break;case a.QualifierKind.Document:var o=e.qualifier;t.type="Document",t.document=o.document,null!=o.path&&(t.documentPath=o.path)}return t}}function T(e,t,r,n){if(null!=i)switch(e.kind){case a.NodeKind.Operator:P("operator")&&i("operator",{label:n,value:e.id});break;case a.NodeKind.WSF:case a.NodeKind.Name:P("function")&&i("function",{label:n,name:e.whole,isClosed:r,args:[]})}}(0,l.reduceBottomUp)(E,e)}(e.value,null!=s||(0,o.getEnglishLocaleInfo)(),t,r,0,f,g)}catch(e){var v="ParseResultHelper.traverse: unhandled error ".concat((0,d.messageFromError)(e));i.ulsLogger.ULS.traceTag(507381982,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,v)}return!0}t.ExtractLetVisitor=v,t.parseResultHelper={isSuccess:u.isSuccess,traverse:S,extractReferences:function(e,t,r,n,i){if(void 0===r&&(r=!1),(0,u.isSuccess)(e)){var a=[];return S(e,["range","namedRange","letName","literal","function","structRefRange"],(function(t,r){var n={kind:t,ref:r,span:h(e.value.spans,r.label)};a.push(n)}),t,r,n,i),a.sort((function(e,t){var r;return 0!=(r=e.span.start-t.span.start)||0!=(r=t.span.end-e.span.end)?r:0})),a}},extractLetVariables:function(e,t){if((0,u.isSuccess)(e))try{var r=new v(e.value,t);return(0,l.reduceBottomUp)(r,e.value),r.references.reverse()}catch(e){var n="ParseResultHelper.extractLetVariables: unhandled error ".concat((0,d.messageFromError)(e));return i.ulsLogger.ULS.traceTag(507381983,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,n),[]}}}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;var i=r(0),a=r(249),o=r(244),s=r(243),u=r(62),l=r(43),c=i.__importStar(r(108)),d=c.codePointEqualsSign,p=c.codePointPlusSign,m=c.codePointMinusSign,f=c.codePointAtSign,g=((n={})[d]=1,n[p]=0,n[m]=0,n[f]=-1,n);function h(e,t,r,n){var i,s,u,c,d=null!==(s=null===(i=t.config)||void 0===i?void 0:i.localeInfo)&&void 0!==s?s:e.config.localeInfo,p=null!==(c=null===(u=t.config)||void 0===u?void 0:u.refStyle)&&void 0!==c?c:e.config.refStyle,m=e.config.mathpack,f=(0,a.tokenizeFormula)(d,m,p,t.originGridCell.value,r,n,t.syntaxFeatures),g=(0,o.runFormulaParser)(d,m,p,t.lexicalKind,t.originGridCell.value,t.contextNames,t.syntaxFeatures,f);return(0,l.success)(g)}t.createParser=function(e){return{parseFormula:function(t,r,n){return function(e,t,r,n){void 0===n&&(n=0);try{var i=n>=0&&n<r.length?g[r.charCodeAt(n)]:void 0;return null==i?(0,l.failure)((0,s.notFormulaString)("first character is not '=', '+', '-' or '@'")):i<0?(0,l.failure)((0,u.notImplemented)(["Lotus 1-2-3 syntax"])):h(e,t,r,n+i)}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}(e,t,r,n)},parseFormulaExpression:function(t,r,n){return function(e,t,r,n){void 0===n&&(n=0);try{return h(e,t,r,n)}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}(e,t,r,n)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isLineBreak=t.isSpace=void 0;var n=r(3);t.isSpace=n.literalParse.isSpace,t.isLineBreak=n.literalParse.isLineBreak,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=t.analyzeLocalsName=t.analyzeLocalsGrid=void 0;var n=r(0),i=n.__importStar(r(109)),a=n.__importStar(r(110));t.analyzeLocalsGrid=i.analyzeLocalsGrid,t.analyzeLocalsName=i.analyzeLocalsName,t.diagnostics=i.diagnostics,t.summarizeFormulaDiagnostics=i.summarizeFormulaDiagnostics,t.staticPrecedents=i.staticPrecedents,t.createAnalyzeGlobals=i.createAnalyzeGlobals,t.createAnalyzer=a.createAnalyzer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operatorNode=t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=void 0;var n=r(3);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(3);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;var n=r(3);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(3);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(1);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;var n=r(64),i=r(255),a=r(170),o=r(176),s=r(253),u=r(257),l=r(259);t.createNumberFormatter=function(e){return{createFormat:function(t,r){return(0,i.createFormat)(e,t,"boolean"!=typeof r?r:r?n.NumberFormatSource.Builtin:n.NumberFormatSource.CustomString)},applyFormat:function(t,r,n){return(0,i.applyFormat)(e,t,r,n)},changeFormatDecimals:i.changeFormatDecimals,renderValue:function(t,r){return(0,o.renderValue)(e.config.mathpack,t,r)},renderHashesValue:function(e,t){return(0,o.renderHashesValue)(e,t)},renderFormulaBar:function(t,r,n,i){return(0,u.renderFormulaBar)(this,e,t,r,n,i)},parseGeneral:function(t,r,n,i){return(0,l.parseGeneral)(e,t,r,n,i)},parseDate:function(t,r){return(0,l.parseDate)(e,t,r)},parseEdit:function(t,r){return(0,a.parseEdit)(e,t,r)},evalFormat:function(t,r){return(0,s.evalFormat)(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberComponents=t.formatScientificLeft=void 0;var n=r(3);t.formatScientificLeft=n.mathpack.formatScientificLeft,t.numberComponents=n.mathpack.numberComponents},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(1);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonFormat=t.RibbonFormat=void 0;var n,i=r(0),a=r(114),o=r(65),s=r(113);function u(e,t){return(0,s.buildSingle)(e,a.PictureSingle.ColorStart,"$-",t,a.PictureSingle.ColorEnd)}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(n||(t.RibbonFormat=n={})),t.getRibbonFormat=function(e,t,r){var l,c,d=(null!==(c=null===(l=null==r?void 0:r.culture)||void 0===l?void 0:l.calendar)&&void 0!==c?c:o.Calendar.Gregorian)===o.Calendar.Gregorian;switch(t){case n.GalleryGeneral:case n.KeyboardGeneral:return(0,s.getKnownFormat)(e,o.KnownFormat.General);case n.GalleryNumber:return(0,s.buildNumberFormat)(e,!1,1,e.currencyDecimals);case n.KeyboardNumber:return(0,s.buildNumberFormat)(e,!0,4,e.currencyDecimals);case n.GalleryCurrency:var p=i.__assign(i.__assign({},e),{currencyFormat:e.currencyFormat===o.CurrencyFormat.Paren?o.CurrencyFormat.Lead:e.currencyFormat});return(0,s.buildCurrencyFormat)(p,!1,e.currencyDecimals,!0,!1,void 0,!0);case n.KeyboardCurrency:return(0,s.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case n.GalleryAccounting:case n.ButtonAccounting:return(0,s.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case n.GalleryShortDate:return d?(0,s.getKnownFormat)(e,o.KnownFormat.MMDDYY):(0,s.buildSingle)(e,a.PictureSingle.Month,a.PictureSingle.DateSep,a.PictureSingle.Day,a.PictureSingle.Sep,a.PictureSingle.Text);case n.GalleryLongDate:return d?u(e,"x-sysdate")+(0,s.buildSingle)(e,a.PictureSingle.Day,a.PictureSingle.Day,a.PictureSingle.Day,a.PictureSingle.Day,", ",a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month," ",a.PictureSingle.Day,a.PictureSingle.Day,", ",a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Year):(0,s.buildSingle)(e,a.PictureSingle.Month,a.PictureSingle.DateSep,a.PictureSingle.Day,a.PictureSingle.DateSep,a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Sep,a.PictureSingle.Text);case n.GalleryTime:return u(e,"x-systime")+(0,s.buildSingle)(e,a.PictureSingle.Hour,a.PictureSingle.Colon,a.PictureSingle.Minute,a.PictureSingle.Minute,a.PictureSingle.Colon,a.PictureSingle.Second,a.PictureSingle.Second," ")+(0,s.getSpecial)(e,a.PictureSpecial.AP1);case n.KeyboardDate:return u(e,"en-US")+(0,s.buildSingle)(e,a.PictureSingle.Day,"-",a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month,"-",a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Sep,a.PictureSingle.Text);case n.KeyboardTime:return u(e,"en-US")+(0,s.buildSingle)(e,a.PictureSingle.Hour,a.PictureSingle.Colon,a.PictureSingle.Minute,a.PictureSingle.Minute," ",(0,s.getSpecial)(e,a.PictureSpecial.AP1),a.PictureSingle.Sep,a.PictureSingle.Text);case n.GalleryPercentage:return(0,s.buildPercentFormat)(e,e.currencyDecimals);case n.ButtonPercentage:case n.KeyboardPercentage:return(0,s.getKnownFormat)(e,o.KnownFormat.Pct0);case n.GalleryFraction:return(0,s.getKnownFormat)(e,o.KnownFormat.Fract);case n.GalleryScientific:case n.KeyboardScientific:return(0,s.buildScientificFormat)(e,1,e.currencyDecimals,2);case n.GalleryText:return(0,s.getKnownFormat)(e,o.KnownFormat.Text);case n.ButtonComma:return(0,s.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commonFormats=void 0,t.commonFormats=["#","##","###","########\\ \\ \\ \\ \\ \\ \\ \\ ","###,###","###\\ ###","###\\-##\\-####","##,###.##\\ \\ \\ ","#,###","#,###.#","#,###.##","#,###_)","#,###_)_ ","#.##","#.##%","#.#%","#;\\(\\ \\ @\\ \\ \\ \\)",'#"\\""\\""\\""\\"\\ ??/??',"#\\ ###",";;",";;;","@\\ ","\\ #######\\ \\ \\ \\ ","\\ \\ @","\\(###\\)\\ ###\\-####","\\(\\ ###\\ \\)\\ ###\\-####","\\:","__@","[$$]#,##0_);\\([$$]#,##0\\);[$$]#,##0_);@_)","[$$]#,##0.0_);\\([$$]#,##0.0\\);[$$]#,##0.0_);@_)","[$$-1009]#,##0.00","[$$-1009]#,##0;[Red]\\-[$$-1009]#,##0","[$$-409]#,##0","[$$-409]#,##0.00","[$$-409]#,##0.00_);\\([$$-409]#,##0.00\\)",'_([$$-409]* #,##0.00_);_([$$-409]* \\(#,##0.00\\);_([$$-409]* "-"??_);_(@_)',"[$$-409]#,##0.0000","[$$-409]#,##0.0000_);\\([$$-409]#,##0.0000\\)","[$$-409]#,##0.00_);[Red]\\([$$-409]#,##0.00\\)","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);[Red]\\([$$-409]#,##0\\)","[$$-C09]#,##0.00","[$$-C09]#,##0.000","[$$-C09]#,##0.0000","[$$-C09]#,##0.00000","[$-809]#,##0","[$-809]#,##0.00","[$-809]#,##0.00;[Red]\\-[$-809]#,##0.00","[$-809]#,##0;[Red][$-809]#,##0","[$-411]#,##0","[$-2]\\ #,##0.00","[$-2]\\ #,##0.00_);[Red]\\([$-2]\\ #,##0.00\\)","[$-2]\\ #,##0_);[Red]\\([$-2]\\ #,##0\\)",'"$"#,##0','"$"#,##0;\\("$"#,##0\\)','"$"#,##0;\\-"$"#,##0','"$"#,##0_);\\("$"#,##0\\)','"$"#,##0_);\\("$"#,##0\\);"-"??_)','"$"#,##0_);\\("$"#,##0\\);\\ \\-\\ ','"$"\\ #,##0;\\("$"\\ #,##0\\)',"\\$#,##0_);\\(\\$#,##0\\)",'_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"_ ;_ @_ ','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0_);_("$"\\ * \\(#,##0\\);_("$"\\ * "-"_);_(@_)','_-"$"* #,##0_-;\\-"$"* #,##0_-;_-"$"* "-"_-;_-@_-','"$"#,##0_%_);\\("$"#,##0\\)_%;"$"#,##0_%_);@_%_)','"$"#,##0.0','"$"#.00','"$"0.0','"$"#,##0.0,_);\\("$"#,##0.0,\\)','"$"#,##0.0;\\("$"#,##0.0\\);','"$"#,##0.0_);\\("$"#,##0.0\\)','"$"\\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.0_ ;_ "$"\\ * \\-#,##0.0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"?_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"_);_(@_)','_-"$"* #,##0.0_-;\\-"$"* #,##0.0_-;_-"$"* "-"_-;_-@_-','"$"#,##0.0_%_);\\("$"#,##0.0\\)_%;"$"#,##0.0_%_);@_%_)','"$"#,##0.00','"$"#.000','"$"\\ #,##0.00','"$"#,##0.00,_);\\("$"#,##0.00,\\)','"$"#,##0.00;\\("$"#,##0.00\\)','"$"#,##0.00;\\-"$"#,##0.00','"$"#,##0.00_);\\("$"#,##0.00\\)','"$"\\ \\ \\ #,##0.00_);\\("$"\\ \\ \\ #,##0.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.00_ ;_ "$"\\ * \\-#,##0.00_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0.00_);_("$"\\ * \\(#,##0.00\\);_("$"\\ * "-"??_);_(@_)','_-"$"* #,##0.00_-;\\-"$"* #,##0.00_-;_-"$"* "-"??_-;_-@_-','"$"#,##0.00_%_);\\("$"#,##0.00\\)_%;"$"#,##0.00_%_);@_%_)','"$"#,##0.000','"$"0.000','"$"0000','"$"#,##0.000_);\\("$"#,##0.0\\)','"$"#,##0.000_);\\("$"#,##0.00\\)','"$"#,##0.000_);\\("$"#,##0.000\\)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000','"$"0.0000','"$"#,##0.0000_);\\("$"#,##0.00\\)','"$"#,##0.0000_);\\("$"#,##0.0000\\)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000','"$"#,##0.00000_);\\("$"#,##0.000\\)','"$"#,##0.00000_);\\("$"#,##0.00000\\)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"?????_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"_);_(@_)','"$"#,##0.000000','"$"#,##0.000000_);\\("$"#,##0.000000\\)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??????_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000000','"$"#,##0.0000000_);\\("$"#,##0.0000000\\)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000000','"$"#,##0.00000000_);\\("$"#,##0.00000000\\)','_("$"* #,##0.00000000_);_("$"* \\(#,##0.00000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.000000000_);\\("$"#,##0.000000000\\)','_("$"* #,##0.000000000_);_("$"* \\(#,##0.000000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.0000000000_);\\("$"#,##0.0000000000\\)','"$"#,##0.0000000;[Red]\\-"$"#,##0.0000000','"$"#,##0.0000000_);[Red]\\("$"#,##0.0000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\);"- "_)','"$"#,##0.00000;[Red]\\-"$"#,##0.00000','"$"#,##0.00000_);[Red]\\("$"#,##0.00000\\)','"$"#,##0.0000;[Red]\\-"$"#,##0.0000','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\)','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\);"- "_)','"$"#,##0.000" /GJ"','"$"#,##0.000_);[Red]\\("$"#,##0.000\\)','"$"#,##0.00" /GJ"','"$"#,##0.00" /mmbtu"','"$"#,##0.00" /MWh"','"$"#,##0.00;[Red]"$"#,##0.00','"$"#,##0.00;[Red]\\-"$"#,##0.00','"$"#,##0.00_);[Red]\\("$"#,##0.00\\)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"- "_)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"-"','"$"* #,##0.00;[Red]\\ \\("$"* #,##0.00\\)','"$"\\ #,##0.00;[Red]"$"\\ \\-#,##0.00','"$"\\ #,##0.00_);[Red]\\("$"\\ #,##0.00\\)','"$"\\ \\ #,##0.00_);[Red]\\("$"\\ \\ #,##0.00\\)',"\\$#,##0.00;[Red]\\$\\(#,##0.00\\);\\-",'"$"0.0"MM"','"$"#,##0.0;[Red]\\("$"#,##0.0\\)','"$"#,##0.0;[Red]\\-"$"#,##0.0','"$"#,##0.0_);[Red]\\("$"#,##0.0\\)','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);"- "_)','"$"\\ \\ #,##0.0_);[Red]\\("$"\\ \\ #,##0.0\\)','"$"0" / kW"','"$"0"MM"','"$"#,##0\\ "/MW"','"$"#,##0\\ "/MWh"','"$"#,##0\\ "/MWH"','"$"#,##0;[Red]"$"#,##0','"$"#,##0;[Red]\\-"$"#,##0','"$"#,##0_);[Red]\\("$"#,##0\\)','"$"#,##0_);[Red]\\("$"#,##0\\);"- "_)','"$"#,##0_);[Red]\\<"$"#,##0\\>','"$"\\ #,##0;[Red]\\-"$"\\ #,##0','"$"\\ #,##0_);[Red]\\("$"\\ #,##0\\)','"$"\\ \\ #,##0_);[Red]\\("$"\\ \\ #,##0\\)','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',"[$CAD]\\ #,##0.000","[$CAD]\\ #,##0.000_);\\([$CAD]\\ #,##0.000\\)","[$R$ -416]#,##0_);\\([$R$ -416]#,##0\\)","[$R$ -416]#,##0.00_);\\([$R$ -416]#,##0.00\\)","[$R$-416]#,##0.0000_);[Red]\\([$R$-416]#,##0.0000\\)","[$R$-416]#,##0.000_);[Red]\\([$R$-416]#,##0.000\\)","[$R$-416]#,##0.00_);[Red]\\([$R$-416]#,##0.00\\)","[$R$-416]#,##0_);[Red]\\([$R$-416]#,##0\\)",'""#,##0','""#,##0;\\-""#,##0',"\\#,##0_);\\(\\#,##0\\)",'_ ""* #,##0_ ;_ ""* \\-#,##0_ ;_ ""* "-"_ ;_ @_ ','_(""* #,##0_);_(""* \\(#,##0\\);_(""* "-"_);_(@_)','_-""* #,##0_-;\\-""* #,##0_-;_-""* "-"_-;_-@_-','""#,##0.0',"\\#,##0.0_);\\(\\#,##0.0\\)",'""#,##0.00','""#,##0.00;\\-""#,##0.00',"\\#,##0.00_);\\(\\#,##0.00\\)",'_ ""* #,##0.00_ ;_ ""* \\-#,##0.00_ ;_ ""* "-"??_ ;_ @_ ','_(""* #,##0.00_);_(""* \\(#,##0.00\\);_(""* "-"??_);_(@_)','_-""* #,##0.00_-;\\-""* #,##0.00_-;_-""* "-"??_-;_-@_-',"\\#,##0.000_);\\(\\#,##0.000\\)","\\#,##0.0000_);\\(\\#,##0.0000\\)",'_-""* #,##0.0000_-;\\-""* #,##0.0000_-;_-""* "-"??_-;_-@_-','""#,##0.00;[Red]\\-""#,##0.00','""#,##0.00_);[Red]\\(""#,##0.00\\)',"\\#,##0.00_);[Red]\\(\\#,##0.00\\)","\\#,##0.0_);[Red]\\(\\#,##0.0\\)",'""#,##0;[Red]\\-""#,##0','""#,##0_);[Red]\\(""#,##0\\)',"\\#,##0_);[Red]\\(\\#,##0\\)","###\\ ###\\ ###\\ ###.0","###0","#,###.0#","#,###_);\\(#,##0\\);\\ \\-_ ","#,###___);\\(#,##0\\);\\ \\-\\ __","#,##0.##","#,##0.####","#,##0_)","#.0%","#0",'"#"\\ 0',"\\(0\\)",'0%;_("-"\\)',"0%\\ \\ ","0.",'0"  "',"0_)","0_;",'0" $/MWh"','#,##0""_);\\(#,##0""\\)','_ * #,##0_)""_ ;_ * \\(#,##0\\)""_ ;_ * "-"_)""_ ;_ @_ ','_ * #,##0_)__ ;_ * \\(#,##0\\)__ ;_ * "-"_)__ ;_ @_ ','#,##0""_);[Red]\\(#,##0""\\)',"#,###.00###","#,###.00###\\ \\ \\ ","#,##0.;\\-#,##0.","#,##0.0","#,##0.0___;","#,##0;\\(#,##0\\)","#,##0;\\(#,##0\\);\\-\\-","#,##0;\\-#,##0",'#,##0;\\-#,##0;"-"',"#,##0\\ ;\\(#,##0\\)","#,##0_ ;\\-#,##0\\ ","#,##0_ \\ ;\\(#,##0\\ \\ \\)","#,##0_);\\(#,##0\\);",'#,##0_);\\(#,##0\\);\\ "  -"',"#,##0_);\\(#,##0\\);\\ \\-\\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ \\ \\ ","#,##0_);\\(#,##0\\);\\-","#,##0_);\\(#,##0\\);\\-\\ \\ ","#,##0_);\\(#,##0\\);\\-_)","#,##0_);\\(#,##0\\);\\-_)_ _ ","#,##0_);\\(#,##0\\);_ \\-\\ \\ ","#,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0_);\\(#,##0\\)\\-","#,##0_)_ ;\\(#,##0\\)\\ ;\\ \\-_ _)","#,##0_)_ ;\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0___);\\(#,##0\\);\\ \\-\\ __","#,##0___);\\(#,##0\\);\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\);___-\\ \\ ","#,##0___);\\(#,##0\\)_;\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\)___;\\ \\-__\\ \\ ","#,##0_____);\\(#,##0\\);_____-\\ \\ ","#,##0_________);\\(#,##0\\);_________-\\ \\ ","#,#00",".00",'"**"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"*"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;\\-"\\"#,##0',"\\(#,##0_)\\);\\(#,##0\\)",'_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"??_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* \\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ',"_##,##0_);\\(#,##0\\);\\-_)_ _ ","_##,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","_(##0_);\\(##0\\)_ ;\\-_)_ _ ",'_(#,##0_);\\(#,##0\\);"-    "','_(* #,##0_);_(* \\(#,##0\\);_(* "-"???_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"?_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* ""??_);_(@_)','_-* #,##0_-;\\-* #,##0_-;_-* "-"??_-;_-@_-','_-* #,##0_-;\\-* #,##0_-;_-* "-"_-;_-@_-','_-* #,##0_-;_-* #,##0\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0_-;\\-"\\"* #,##0_-;_-"\\"* "-"_-;_-@_-',"0%\\-0%","0.0","0.0%",'0.0%;_(* "-"_)','0.0%;_("-"\\)','0.0%;_("-"_)','0.0%;_(\\ "-"_)',"0.0%\\ \\)",'0.0%\\-;_("-"_)','0.0"  "','0.0"%"','0.0_ "  "',"0.0_)","0.0_;","0.0____","0;\\-0;","0;\\-0;;","0;\\-0;;@\\ ","0_ ;\\-0\\ ","0_);\\(0\\)","00","###0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,###.0_);\\(#,##0.0\\);\\ \\-\\ _ ","#,##0.00#","#,##0.00###","#,##0.00__;","#,##0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,##0_);\\(#,##0\\);#,##0_);@_)",'"@ "\\&0.00%','"@ "0.00%','_(* #,##0_);_(* \\(#,##0\\);_(* "0"??_);_(@_)',"0%_);\\(0%\\);0%_);@_%_)","0.00#%",'0.00%;_(* "-"_)','0.00%;_("-"\\)',"0.00;;",'0.00"  "',"0.00_)","0_%_);\\(0\\)_%;0_%_);@_%_)","000","000#",'#,##0.00" $";\\-#,##0.00" $"',"#,##0.00\\ [$DM-407]","#,##0.00\\ [$EUR-407]",'#,##0.00" $";[Red]\\-#,##0.00" $"','#,##0.00""_);\\(#,##0.00""\\)','_ * #,##0.00_)""_ ;_ * \\(#,##0.00\\)""_ ;_ * "-"??_)""_ ;_ @_ ','_ * #,##0.00_)__ ;_ * \\(#,##0.00\\)__ ;_ * "-"??_)__ ;_ @_ ','#,##0.00""_);[Red]\\(#,##0.00""\\)',"##0.000","#,##0.0%_);\\(#,##0.0%\\);","#,##0.0_);\\(#,##0.0\\)","#,##0.0_);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_);\\(#,##0.0\\);_ \\ \\-","#,##0.0____\\);\\(#,##0.0\\);___ \\-\\ \\ ","#,##0.0_______);\\(#,##0.0\\);______\\ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);_______ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.000","#,##0.000___;",".0000",".0000%",'_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"??_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"?_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"_);_(@_)','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"??_-;_-@_-','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"_-;_-@_-',"0.0%;\\(0.0\\)%;\\ \\-\\ \\ ",'0.0%;\\-0.0%;\\ "-"_%;@_%',"0.0%\\ ;\\(0.0\\)%\\ ;\\-\\ \\ \\ ","0.0%\\);\\(0.0\\)%;\\ \\-","0.0%_);\\(0.0%\\)","0.0%_);\\(0.0\\)%;\\ \\-","0.0%_;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_%;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_);\\(0.0\\)","0.000","0.000%",'0.000%;_("-"\\)',"0.000_)","0.000_;","0000","##0.000\\ \\","#,##0.00_);\\(#,##0.0\\)","#,##0.0000","#,##0.0000___;","0.0000","0.0000%",'0.0000%;_(* "-"_)','0.0000%;_("-"\\)','0.0000"  "',"0.0000\\ %","0.0000_)","00\\-000","00\\-000_)","00000","###0.00_);\\(#,##0.00\\)","#,##0.0%_);\\(#,##0.0%\\);0.0%_);@_%_)","#,##0.0_%_);\\(#,##0.0\\)_%;#,##0.0_%_);@_%_)","#,##0.0_);\\(#,##0.0\\);#,##0.0_);@_)","#,##0.00%_);\\(#,##0.00%\\)","#,##0.00;#,##0.00;","#,##0.00;\\(#,##0.00\\)","#,##0.00;\\(#,##0.00\\);\\-\\-","#,##0.00_);\\(#,##0.00\\);\\ \\-\\ ","#,##0.00_);\\(#,##0.00\\);\\-","#,##0.00_);\\(#,##0.00\\);\\-\\ \\ ","#,##0.00_);\\(#,##0.00\\);_ \\ \\-","#,##0.00_);\\(#,##0.00\\);_ \\-\\ \\ ","#,##0.00__\\);\\(#,##0.00\\);__\\ \\ \\-","#,##0.00___);\\(#,##0.00\\);___ \\ \\-","#,##0.00___);\\(#,##0.00_);\\ \\-\\ \\ \\ ","#,##0.00000","#,##0.00000___;",'"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\"\\-#,##0.00','"\\"#,##0.00;\\-"\\"#,##0.00','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * \\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* \\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"????_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"?_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"_);_(@_)','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"??_-;_-@_-','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"_-;_-@_-','_-* #,##0.00_-;_-* #,##0.00\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0.00_-;\\-"\\"* #,##0.00_-;_-"\\"* "-"??_-;_-@_-',"0.0%_);\\(0.0%\\);0.0%_);@_%_)","0.0\\%_);\\(0.0\\%\\);0.0\\%_);@_%_)","0.00%_);\\(0.00%\\)","0.00;\\-0.00;","0.00_);\\(0.00\\)","0.00000","0.00000%",'0.00000"  "',"0.00000_)","000000","#,###.000_);\\(#,##0.000\\);\\ \\-\\ _ ","#,##0.000000","0.000000","0.000000%","0.000000_)","#,##0.000;\\(#,##0.000\\)","#,##0.000;\\(#,##0.000\\);\\-\\-","#,##0.000_);\\(#,##0.000\\)","#,##0.000_);\\(#,##0.000\\);\\ \\-\\ \\ ","#,##0.000_);\\(#,##0.000\\);\\-","#,##0.000_);\\(#,##0.000\\);_ \\-\\ \\ ","#,##0.0000000",'_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"???_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"??_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"?_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"_);_(@_)','_-* #,##0.000_-;\\-* #,##0.000_-;_-* "-"??_-;_-@_-',"_00000000","0.000_);\\(0.000\\)","0.0000000","0.0000000%","0.0000000_)","0000\\ \\-\\ 0000","00000000","#,###.0000_);\\(#,##0.0000\\);\\ \\-\\ _ ","#,##0.00_%_);\\(#,##0.00\\)_%;#,##0.00_%_);@_%_)","#,##0.00000000","0.00%_);\\(0.00%\\);0.00%_);@_%_)","0.00000000","0.00000000%","0.00000000_)","000\\-00\\-0000","000000000","#,##0.0000;\\(#,##0.0000\\)","#,##0.0000;\\-#,##0.0000","#,##0.0000_);\\(#,##0.0000\\)","#,##0.0000_);\\(#,##0.0000\\);_ \\-\\ \\ ","#,##0.0000_);\\(#,##0.0000_)","#,##0.0000___);\\(#,##0.0000_);\\ \\-\\ \\ \\ ","#,##0.000000000","\\(000\\)000\\-0000",'_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"????_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"?_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"_);_(@_)','_-* #,##0.0000_-;\\-* #,##0.0000_-;_-* "-"??_-;_-@_-',"0.0000_);\\(0.0000\\)","0.000000000","0.000000000%","0.000000000_)","0000000000","#,###.00000_);\\(#,##0.00000\\);\\ \\-\\ _ ","#,##0.0000000000","0.0000000000","0.0000000000_)","#,##0.00000_);\\(#,##0.00000\\)","#,##0.00000000000",'_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"?????_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"??_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"_);_(@_)','_-* #,##0.00000_-;\\-* #,##0.00000_-;_-* "-"??_-;_-@_-',"0.00000_);\\(0.00000\\)","0.00000000000","0.00000000000_)","#,###.000000_);\\(#,##0.000000\\);\\ \\-\\ _ ","0.000000000000","#,##0.000000_);\\(#,##0.000000\\)",'_(* #,##0.000000_);_(* \\(#,##0.000000\\);_(* "-"??_);_(@_)','0.000000%;\\-0.000000%;\\ "-"_%;@_%',"0.0000000000000","0.0000000000000_)","0.00000000000000%","#,##0.0000000_);\\(#,##0.0000000\\)",'_(* #,##0.0000000_);_(* \\(#,##0.0000000\\);_(* "-"??_);_(@_)',"0.0000000_);\\(0.0000000\\)","0.000000000000000%","0.0000000000000000","#,##0.00000000_);\\(#,##0.00000000\\)",'_(* #,##0.00000000_);_(* \\(#,##0.00000000\\);_(* "-"??_);_(@_)',"0.00000000000000000","0.00000000000000000%","0.000000000000000000","0.000000000000000000%","#,##0.000000000_);\\(#,##0.000000000\\)",'_(* #,##0.000000000_);_(* \\(#,##0.000000000\\);_(* "-"??_);_(@_)',"#,##0.00000000000000000000","#,##0.0000000000_);\\(#,##0.0000000000\\)",'_(* #,##0.0000000000_);_(* \\(#,##0.0000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000","0.0000000000000000000000%",'_(* #,##0.000000000000_);_(* \\(#,##0.000000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000000","0.00000000000000000000000000",'_(* #,##0.0000000000000_);_(* \\(#,##0.0000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000","0.0000000000000000000000000000",'_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"??_);_(@_)','_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000000","0.00000000000000000000000000000000","#,##0.0000000000000000_);\\(#,##0.0000000000000000\\)","0.000000000000000000000000000000000","0.0000000000000000000000000000000000","0.00000000000000000000000000000000000","#,##0.00000000000000000000_);[Red]\\(#,##0.00000000000000000000\\)","#,##0.0000000000000_);[Red]\\(#,##0.0000000000000\\)","#,##0.000000000000_);[Red]\\(#,##0.000000000000\\)","#,##0.00000000000_);[Red]\\(#,##0.00000000000\\)","#,##0.0000000000_);[Red]\\(#,##0.0000000000\\)","#,##0.00000000_);[Red]\\(#,##0.00000000\\)","#,##0.0000000_);[Red]\\(#,##0.0000000\\)","#,##0.000000_);[Red]\\(#,##0.000000\\)","0.000000\\x_);\\(0.000000\\x\\)","0.00000E+00","#,##0.00000_);[Red]\\(#,##0.00000\\)","0.00000_);[Red]\\(0.00000\\)","0.0000E+00","###0.0000_);[Red]\\(###0.0000\\)","#,##0.0000\\ ;[Red]\\(#,##0.0000\\)","#,##0.0000_ ;[Red]\\-#,##0.0000\\ ","#,##0.0000_);[Red]\\(#,##0.0000\\)","0.0000%;[Red]\\-0.0000%","0.0000%\\ ;[Red]\\(0.0000%\\)","0.0000;[Red]0.0000","0.0000_ ;[Red]\\-0.0000\\ ","0.0000_);[Red]\\(0.0000\\)","0.0000\\x_);\\(0.0000\\x\\)","0.000E+00","0.000E+00_)",'0.000" MWh/GJ"',"###0.000_);[Red]\\(###0.000\\)","#,##0.000;[Red]\\(#,##0.000\\)","#,##0.000;[Red]\\(#,##0.000\\);\\-","#,##0.000\\ ;[Red]\\(#,##0.000\\)","#,##0.000_);[Red]\\(#,##0.000\\)","0.000;[Red]0.000","0.000_);[Red]\\(0.000\\)","0.000_);[Red]\\-0.000_)","#,##0.0_%_);\\(#,##0.0\\)_%;[White]#,##0.0_%_);@_%_)",'0.00%" Capitalization Rate"','0.00%" Discount Rate"','_-* #,##0.00\\ "DM"_-;\\-* #,##0.00\\ "DM"_-;_-* "-"??\\ "DM"_-;_-@_-','_-* #,##0.00\\ _D_M_-;\\-* #,##0.00\\ _D_M_-;_-* "-"??\\ _D_M_-;_-@_-','#,##0.00" F"_);\\(#,##0.00" F"\\)','_-* #,##0.00\\ "F"_-;\\-* #,##0.00\\ "F"_-;_-* "-"??\\ "F"_-;_-@_-','_-* #,##0.00\\ _F_-;\\-* #,##0.00\\ _F_-;_-* "-"??\\ _F_-;_-@_-','0.00" GJ//MWh"','0.00" GJ/MWh"','0.00\\ "MW"','0.00%" of Avg LTD"','0.00%" of Sales"','0.00%" perpetual annual growth"','_-* #,##0.00\\ "Pts"_-;\\-* #,##0.00\\ "Pts"_-;_-* "-"??\\ "Pts"_-;_-@_-','_-* #,##0.00\\ _P_t_s_-;\\-* #,##0.00\\ _P_t_s_-;_-* "-"??\\ _P_t_s_-;_-@_-',"###0.00_);[Red]\\(###0.00\\)","#,##0.00%_);[Red]\\(#,##0.00%\\)","#,##0.00;[Red]#,##0.00",'#,##0.00;[Red]"-"#,##0.00',"#,##0.00;[Red]\\(#,##0.00\\)","#,##0.00;[Red]\\(#,##0.00\\);\\-","#,##0.00\\ ;[Red]\\(#,##0.00\\)","#,##0.00\\ \\);[Red]\\(#,##0.00\\)","#,##0.00_ ;[Red]\\-#,##0.00\\ ",'#,##0.00_);[Red]\\(#,##0.00\\);"-"','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\"\\-#,##0.00','"\\"#,##0.00;[Red]\\-"\\"#,##0.00','_(* #,##0.00_);[Red]_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00%;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\);\\-","0.00;[Red]0.00","0.00_ ;[Red]\\-0.00\\ ","0.00_);[Red]\\(0.00\\)","0.00_);[Red]\\(0.00\\);;","#,##0.00_);[Red]\\(#,##0.00\\)*1000","0.00\\x",'_(* #,##0.00\\x\\ \\ ;_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00\\x_);\\(0.00\\x\\)","_(##0_);\\(##0\\)_1;\\-_)_ _ ",'""0.0%" --\x3e 61.5% of Sales 1st 5 yrs.; steady state thereafter"','00\\ "Coal Upgrade"',"0.0E+00",'0.0" GJ/MWh"','00\\ "Hydro"','00\\ "Incremental"','0.0" mmbtu//MWh"','0.0%" of beg. Net PPE + Intgble Amort."','0.0%" of Sales"','0.0%" of Total Assets"',"#,##0.0_);[Red]\\(#,##0\\)","###0.0_);[Red]\\(###0.0\\)","#,##0.0;[Red]\\(#,##0.0\\)","#,##0.0;[Red]\\(#,##0.0\\);\\-","#,##0.0;[Red]\\-#,##0.0","#,##0.0\\ ;[Red]\\(#,##0.0\\)","#,##0.0_ ;[Red]\\-#,##0.0\\ ","#,##0.0_);[Red]\\(#,##0.0\\)","#,##0.0_);[Red]\\(#,##0.0\\);","#,##0.0_);[Red]\\(#,##0.0\\);\\-","0.0%;[Red]\\(0.0%\\)","0.0%\\ ;[Red]\\(0.0%\\)","0.0%_);[Red]\\(0.0%\\)","0.0_);[Red]\\(0.0\\)","0.0_);[Red]\\-0.0_)","#,##0.0_);[Red]\\(#,##0.0\\)*1000",'0.0"x"','0.0\\ "x"',"0.0\\x","#,##0.0\\x_);\\(#,##0.0\\x\\)","#,##0.0\\x_);\\(#,##0.0\\x\\);",'0.0\\x_)_);"NM"_x_)_);0.0\\x_)_);@_%_)',"#,##0.0\\x_);[Red]\\(#,##0.0\\x\\);",'0%\\ "Beg. Net PPE + Intangibles"','0" Days"','_-* #,##0\\ "DM"_-;\\-* #,##0\\ "DM"_-;_-* "-"\\ "DM"_-;_-@_-','_-* #,##0\\ _D_M_-;\\-* #,##0\\ _D_M_-;_-* "-"\\ _D_M_-;_-@_-',"#,##0_e","0.E+00","0E+00","0\\ \\f",'_-* #,##0\\ "F"_-;\\-* #,##0\\ "F"_-;_-* "-"\\ "F"_-;_-@_-','_-* #,##0\\ _F_-;\\-* #,##0\\ _F_-;_-* "-"\\ _F_-;_-@_-','#,##0" GJ/D"','0\\ "Hydro"','0" / kW"','0\\ "Last Year"','#,##0" MMBTUs";\\-#,##0" MMBTUs"','0" months"','0\\ "mos"','0" MW"','#,##0" MWh";\\-#,##0" MWh"','#,##0" MWh/D"','#,##0_)"MWH";[Red]\\("$"#,##0\\);"- "_)','#,##0_)"mW";[Red]\\("$"#,##0\\);"- "_)','0\\ " of"','0%" of Sales"','_-* #,##0\\ "Pts"_-;\\-* #,##0\\ "Pts"_-;_-* "-"\\ "Pts"_-;_-@_-','_-* #,##0\\ _P_t_s_-;\\-* #,##0\\ _P_t_s_-;_-* "-"\\ _P_t_s_-;_-@_-',"#,##0_r_)",'#,##0"r"_)',"###0_);[Red]\\(#,##0\\)","##,##0;[Red]\\(##,##0\\)","#,##0;[Red]#,##0",'#,##0;[Red]"-"#,##0',"#,##0;[Red]\\(#,##0\\)","#,##0;[Red]\\(#,##0\\);\\-","#,##0;[Red]\\-#,##0","#,##0;[Red]\\-#,##0;\\-","#,##0\\ ;[Red]\\(#,##0\\)","#,##0_ ;[Red]\\-#,##0\\ ","#,##0_);[Red]\\(#,##0\\);","#,##0_);[Red]\\(#,##0\\);;",'#,##0_);[Red]\\(#,##0\\);"-   "','#,##0_);[Red]\\(#,##0\\);"- "_)','#,##0_);[Red]\\(#,##0\\);"-"',"#,##0_);[Red]\\(#,##0\\);\\-","#,##0_);[Red]\\<#,##0\\>","#.0,,;[Red]\\(#.0,,\\)",'"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\"\\-#,##0','"\\"#,##0;[Red]\\-"\\"#,##0','_(* #,##0_);[Red]* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);[Red]\\(* \\(#,##0\\);_(* "-"_);_(@_)',"0%\\ ;[Red]\\(0%\\)",'0%\\ ;[Red]\\(0%\\)\\ ;"-  "',"0%\\);[Red]\\(0%\\)","0%_);[Red]\\(0%\\)","0;[Red]0","0_);[Red]\\(0\\)","0_);[Red]\\(0\\);;","0_);[Red]\\-0_)","#,##0_);[Red]\\(#,##0,\\)*1000",'0%" Tax Rate"','0\\ "Wind"','0\\ "WTG"','0" Year"','0" years"',"0\\ \\y\\e\\a\\r\\s",'0"  Years"',"\\10000000","#?/12","#\\ ?/32","#\\ ?/32;[Red]\\(#?/32\\)","#\\ ?/32;[Red]\\(#\\ ?/32\\)","#\\ ?/4","#\\ ?/64","[<=9999999]###\\-####;\\(###\\)\\ ###\\-####",'"and"\\ 0\\ "--\x3e6-year average"','"As of "\\ mm/dd/yy','"As of "mmmm\\ dd\\,\\ yyyy','"As of"\\ mmmm\\ dd\\,\\ yyyy','"As of "mmmm\\ d\\,\\ yyyy','"Ave. Debt Bal. * "0.00%" cost * (1-t)"','#\\ "BP"','_(\\C"$"* #,##0.00000_);_(\\C"$"* \\(#,##0.00000\\);_(\\C"$"* "0"_);_(@_)','\\C"$"#,##0_);\\(\\C"$"#,##0\\)','_(\\C"$"* #,##0_);_(\\C"$"* \\(#,##0\\);_(\\C"$"* "0"_);_(@_)','\\C"$"\\ #,##0\\);[Red]\\(\\C"$"\\ #,##0\\)','"Canada Cash Desk Economics (CDN$) for"\\ mmm\\-yy\\ "as of:"','"Change since "mmmm\\ dd\\,\\ yyyy','"Changes Since "mmmm\\ dd\\,\\ yyyy','_ "CHF"\\ * #,##0.00_ ;_ "CHF"\\ * \\-#,##0.00_ ;_ "CHF"\\ * "-"??_ ;_ @_ ','"Converted at "_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','"Cr$"\\ #,##0_);\\("Cr$"\\ #,##0\\)','"Current Day ("mm/dd/yy") Theoretical Sensitivities"\\ ','"Curves Loaded for"\\ \\ mm/dd/yy','"DATE:"\\ dd\\-mmm\\-yy','"DATE="mm/dd/yy','#\\ "Day"',"dd","ddd","dddd","ddd\\ \\-\\ dd","ddd\\-dd","dddd\\ d\\ mmmm\\ yyyy","ddd\\-dd\\-mmm\\-yy","ddd\\ dd\\ mmm\\ yyyy\\ hh:mm","dd\\-ddd\\-yy","dddd\\ mmmm\\ dd\\ ","dddd\\,\\ mmmm\\ dd\\,\\ yyyy","dddd\\,\\ mmmm\\ d\\,\\ yyyy","dddd\\,\\ mmmm\\,\\ d\\,\\ yyyy","dddd\\,mmmm\\,d\\,yyyy","ddd\\,\\ mmm\\ d","ddd\\-mmm\\-dd","ddd\\ yy/mm/dd","dd\\-mmm_)","dd\\-mmm\\-yy","dd\\-mmm\\-yy_)","dd\\-mmm\\-yy_);[Red]dd\\-mmm\\-yy_)","dd\\ mmm\\ yyyy","dd\\-mmm\\-yyyy","ddmmyy",'"Detail of New Transactions By Originator - "mmmm\\,\\ yyyy','"Discount Rate of"\\ 0.00%',"d\\-mmm\\,ddd",'d\\-mmm\\-yy\\ "Cycle 6"',"d/mmm/yyyy","d\\-mmm\\-yyyy",'d\\-mmm\\-yyyy\\ "Cycle 6"',"d/m/yy\\ h:mm","d\\.m\\.yy\\ h:mm",'"down"\\ 0.0','"DR="0.00%','"Effective Date: "\\ dd\\-mmm\\-yyyy','"EQUITY CASH FLOW PV AT "#0.00"%"','"First Period Days =  "\\ 0','"Fuel Cost:"\\ 0.00',"General\\ ","General_)","General;[Red]\\-General","General_);[Red]\\-General_)","h","hh:mm","hh:mm\\ AM/PM","hh:mm\\ AM/PM_)","hh:mm:ss","[h]:mm",'h:mm:ss"\\""\\""\\""\\"\\ AM/PM','"Include";;"Exclude"','" K-"#','_ "kr"\\ * #,##0.00_ ;_ "kr"\\ * \\-#,##0.00_ ;_ "kr"\\ * "-"??_ ;_ @_ ','_ "kr"\\ * #,##0_ ;_ "kr"\\ * \\-#,##0_ ;_ "kr"\\ * "-"_ ;_ @_ ','"LTD Through "mmmm\\ dd\\,\\ yyyy','##"m"',"m","m/d","m/dd/yyyy","m/d/yy","m/d/yy_%_)","m\\-d\\-yy","m/d/yy\\ h:mm","m/d/yy\\ h:mm\\ AM/PM","m\\/d\\/yyyy","m/d/yyyy\\ h:mm:ss","mm","mm/dd","mmdd","mm/dd/ddd","mm/dd/yy","mm/dd/yy_)","mm\\-dd\\-yy","mmddyy","mm/dd/yy\\ hh:mm","mm\\-dd\\-yy\\ hmm\\ AM/PM","mm/dd/yyyy",'mm"/"dd"/"yyyy',"mm\\-dd\\-yyyy","mm\\-dd\\-yyyy\\ ","mm\\/dd\\/yyyy","mm/dd/yyyy\\ hh:mm\\ AM/PM","mm/dd/yyyy\\ hh:mmAM/PM","mm\\-dd\\-yyyy\\ \\ hh:mm:ss\\ AM/PM\\ \\ ","mm\\-dd\\-yyyy\\ hh:mm:ss\\ AM/PM","mmm","mmm\\ d","mmm\\-dd","mmm\\-dd\\ \\ \\ h:mm\\ AM/PM","mmm\\ dd\\ yy_;","mmm\\-dd\\-yy","mmm\\-dd\\-yy\\ h:mm\\ AM/PM","mmm\\ dd\\ yyyy;","mmmddyyyy","mmm\\ dd\\ yyyy\\ hh:mm\\ AM/PM","mmm\\-d\\-yy","mmm\\-d\\-yy\\ ","mmm\\ d\\,\\ yyyy","mmmm","mmmm\\ d",'mmmm\\ dd","\\ yyyy',"mmmm\\ dd\\,\\ yyyy","mmmm\\ dd\\,\\ yyyy\\ \\ h:mm\\ AM/PM","\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ mmmm\\ d\\,\\ yyyy","mmmm\\ d\\,\\ yyyy","mmmmm","mm\\-mmm\\-yy","mmmm\\-yy","mmmm\\ yyyy","mmmm\\-yyyy","mmm\\ yy","mmm\\-yy_)","mmm\\.yy","mmm\\ yyyy","mmm\\,\\ yyyy","mmm\\-yyyy","mmm\\-yyyy_)","mm/yy","mm\\-yy","mm/yyyy","mm\\-yyyy",'"MTD Through "mmmm\\ dd\\,\\ yyyy',"m/yy","m\\/yy","m/yyyy","\\n\\o\\t\\ \\Q0",'"On";;"Off"','_("P"* #,##0.00_);_("P"* \\(#,##0.00\\);_("P"* "-"??_);_(@_)','_("P"\\ * #,##0.00_);_("P"\\ * \\(#,##0.00\\);_("P"\\ * "-"??_);_(@_)','_("P"* #,##0_);_("P"* \\(#,##0\\);_("P"* "-"_);_(@_)','_("P"\\ * #,##0_);_("P"\\ * \\(#,##0\\);_("P"\\ * "-"_);_(@_)','"Pmts per Year = "0',"\\P\\P\\ #,##0.00000_);\\(\\P\\P\\ #,##0.00000_)",'_("Ps. "* #,##0.00_);_("Ps. "* \\(#,##0.00\\);_("Ps. "* "-"??_);_(@_)','"Ps. "#,##0.00_);[Red]\\("Ps. "#,##0.00\\)','_("Ps. "* #,##0_);_("Ps. "* \\(#,##0\\);_("Ps. "* "-"_);_(@_)',"\\Q\\ 0","\\Q0",'_("R$"* #,##0.00_);_("R$"* \\(#,##0.00\\);_("R$"* "-"??_);_(@_)','_("R$"* #,##0_);_("R$"* \\(#,##0\\);_("R$"* "-"_);_(@_)',"[Red]#,##0;\\-#,##0","[Red]#,##0.0;[Blue]\\<#,##0.0\\>",'_-"Rs."* #,##0.00_-;\\-"Rs."* #,##0.00_-;_-"Rs."* "-"??_-;_-@_-','_-"Rs."* #,##0_-;\\-"Rs."* #,##0_-;_-"Rs."* "-"_-;_-@_-','_-"S/."\\ * #,##0.00_-;\\-"S/."\\ * #,##0.00_-;_-"S/."\\ * "-"??_-;_-@_-','_-"S/."\\ * #,##0_-;\\-"S/."\\ * #,##0_-;_-"S/."\\ * "-"_-;_-@_-','"Sales growth declines from "0.0%" to 10% in yr 5"','"Sensitivity Change from Prior Day ("mm/dd/yy")"','_ "SFr."* #,##0.00_ ;_ "SFr."* \\-#,##0.00_ ;_ "SFr."* "-"??_ ;_ @_ ','"SFr."#,##0;[Red]"SFr."\\-#,##0','"SFr."#,##0;"SFr."\\-#,##0','_ "SFr."* #,##0_ ;_ "SFr."* \\-#,##0_ ;_ "SFr."* "-"_ ;_ @_ ','"Stmt Date "m/d/yy','"Through "mmmm\\ dd\\,\\ yyyy','_(\\U"$"* #,##0_);_(\\U"$"* \\(#,##0\\);_(\\U"$"* "0"_);_(@_)','"up"\\ 0.0','"VS"\\ mmm\\-yy',"\\W#,##0","\\W#,##0.0",'"Wire Date "m/d/yy','"with "0%" tax"',"#\\x","\\X",'"Yes";;"No"','"Yes"_%_);;"No"_%_)','"YTD Through "mmmm\\ dd\\,\\ yyyy',"yyddmm","yy/m","yy/mm","yy\\-mm\\-dd","yymmdd",'yy"\\""\\""\\"\\-mm"\\""\\""\\"\\-dd"\\""\\""\\""\\"\\ h:mm',"yy\\ mmm","yy\\ mmm\\ dd","yyyy","yyyyddmm","yyyy/mm","yyyy\\.mm\\.dd","yyyy\\-mm\\-dd\\ hh:mm","yyyy/mm/dd\\ hh:mm:ss:ss","yyyy\\-mm\\-dd\\ hh:mm:ss\\.ss","yyyy\\ \\-\\ mmm","yyyy\\-mmm","yyyy\\-mmm\\-dd","yyyymmmdd","yyyy\\ mmmm"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.renderFormat=t.initUtilGlobals=t.getValueEditOperKind=t.getFormatString=t.applyValueEdit=void 0;var n=r(38);t.applyValueEdit=n.util.applyValueEdit,t.getFormatString=n.util.getFormatString,t.getValueEditOperKind=n.util.getValueEditOperKind,t.initUtilGlobals=n.util.initUtilGlobals,t.renderFormat=n.util.renderFormat,t.toXLNumber=n.util.toXLNumber},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extension=t.createEvaluator=t.createCompiler=t.RecordOper=t.LambdaOper=t.LimitKind=t.limitExceeded=t.createCompileGlobals=t.illFormedFormula=t.compileLocalsName=t.compileLocalsGrid=t.evalLocals=t.evalGlobals=t.previousNameFailure=t.previousFailure=t.breaked=t.paused=t.cellCycle=t.nameCycle=t.stopped=t.userDefinedFunc=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.runtimePositionFirstOrderFunc=t.runtimePositionFormulaRoot=t.runtimePositionEtaLambdaBody=t.runtimePositionLambdaParam=t.runtimePositionLambdaRoot=t.runtimePositionLetVal=t.RuntimePositionKind=t.StepAction=t.Interrupt=t.CellKind=t.interval=t.ReasonKind=void 0;var n=r(0),i=n.__importStar(r(54)),a=n.__importStar(r(289)),o=n.__importStar(r(290)),s=n.__importStar(r(451)),u=n.__importStar(r(452));t.ReasonKind=i.ReasonKind,t.interval=i.interval,t.CellKind=i.CellKind,t.Interrupt=i.Interrupt,t.StepAction=i.StepAction,t.RuntimePositionKind=i.RuntimePositionKind,t.runtimePositionLetVal=i.runtimePositionLetVal,t.runtimePositionLambdaRoot=i.runtimePositionLambdaRoot,t.runtimePositionLambdaParam=i.runtimePositionLambdaParam,t.runtimePositionEtaLambdaBody=i.runtimePositionEtaLambdaBody,t.runtimePositionFormulaRoot=i.runtimePositionFormulaRoot,t.runtimePositionFirstOrderFunc=i.runtimePositionFirstOrderFunc,t.finalValue=i.finalValue,t.pendingValue=i.pendingValue,t.cellWellFormedFormula=i.cellWellFormedFormula,t.cellFormula=i.cellFormula,t.userDefinedFunc=i.userDefinedFunc,t.stopped=i.stopped,t.nameCycle=i.nameCycle,t.cellCycle=i.cellCycle,t.paused=i.paused,t.breaked=i.breaked,t.previousFailure=i.previousFailure,t.previousNameFailure=i.previousNameFailure,t.evalGlobals=i.evalGlobals,t.evalLocals=i.evalLocals,t.compileLocalsGrid=i.compileLocalsGrid,t.compileLocalsName=i.compileLocalsName,t.illFormedFormula=i.illFormedFormula,t.createCompileGlobals=i.createCompileGlobals,t.limitExceeded=i.limitExceeded,t.LimitKind=i.LimitKind,t.LambdaOper=s.LambdaOper,t.RecordOper=s.RecordOper,t.createCompiler=a.createCompiler,t.createEvaluator=o.createEvaluator,t.extension=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IterativeRecalcState=t.cellRead=t.cellWrite=t.rangeWrite=t.TransactionLogMessageKind=t.TransactionLog=t.WriteResultKind=void 0;var n,i=r(0),a=r(19),o=r(261),s=r(25),u=r(67),l=r(27),c=r(7);!function(e){e[e.Next=0]="Next",e[e.Done=1]="Done",e[e.CellWriteLimitReached=2]="CellWriteLimitReached",e[e.CellCycle=3]="CellCycle"}(n||(t.WriteResultKind=n={}));var d,p=function(){function e(e){this.state=e}return e.prototype.forEachMeets=function(e,t){var r=this.state[e.sheet.index];void 0!==r&&r.forEachMeets(e.range,t)},e.prototype.setValue=function(t,r){var n,a,s=null!==(a=this.state[t.sheet.index])&&void 0!==a?a:(0,o.makeGridRangeTable)();return new e(i.__assign(i.__assign({},this.state),((n={})[t.sheet.index]=s.setValue(t.range,r),n)))},e.empty=function(){return new e({})},e}(),m=function(){function e(){this.log=[]}return e.prototype.extract=function(){return this.log},e.prototype.lookup=function(t){var r=[];return void 0!==this.current&&(this.current.previousVersions.forEachMeets(t,(function(e,t){return r.push(t),!0})),e.meets(t,this.current.range)&&r.push(this.current)),r},Object.defineProperty(e.prototype,"current",{get:function(){return this.log[this.log.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.log.length},enumerable:!1,configurable:!0}),e.prototype.insert=function(e,t){if(void 0!==this.current){var r={version:this.current.version+1,range:e,message:t,previousVersions:this.current.previousVersions.setValue(this.current.range,this.current)};this.log.push(r)}else this.log.push({version:0,range:e,message:t,previousVersions:p.empty()})},e.prototype.rollBack=function(t){if(void 0===this.current)return!1;var r=void 0;return this.current.previousVersions.forEachMeets(t,(function(e,t){return(void 0===r||t.version<r.version)&&(r=t),!0})),void 0===r?!!e.meets(t,this.current.range)&&(this.truncLog(this.log.length-1),!0):(this.truncLog(r.version),!0)},e.prototype.truncLog=function(e){this.log.length=(0,s.fastMax)(e,0)},e.meets=function(e,t){return e.sheet.index===t.sheet.index&&(0,c.gridRangeIsects)(e.range,t.range)},e}();function f(e,t){return{kind:d.RangeWrite,range:e,opers:t}}function g(e,t){return{kind:d.CellWrite,cell:e,oper:t}}t.TransactionLog=m,function(e){e[e.RangeWrite=0]="RangeWrite",e[e.CellWrite=1]="CellWrite",e[e.CellRead=2]="CellRead"}(d||(t.TransactionLogMessageKind=d={})),t.rangeWrite=f,t.cellWrite=g,t.cellRead={kind:d.CellRead};var h={kind:n.CellWriteLimitReached},v=function(){function e(e){this.transactionLog=new m,this.anchorVisitCounts={},this.workStack=[[e,u.emptyVisitedCells]]}return e.prototype.registerVisibleCells=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this.ensureNeedsVisit(i)}return{kind:n.Next,address:this.address}},e.prototype.registerDynamicDependency=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],a={cell:i,previous:this.visitedCells.current,cycle:void 0},o=this.visitedCells.map.getValue(i);if(void 0!==o)return(0,u.recordCellCycle)(o,this.visitedCells.current),{kind:n.CellCycle,cycle:o.cycle};this.workStack.push([i,(0,u.appendVisitedCell)(this.visitedCells,a)]),this.ensureNeedsVisit(i)}return{kind:n.Next,address:this.address}},e.prototype.registerRead=function(){return 0===this.transactionLog.lookup(this.address).length&&this.transactionLog.insert(this.address,t.cellRead),this.next()},e.prototype.writeRange=function(e){var t=this.address,r=t.sheet,n=t.range,i=n.row,o=n.col,s=(0,a.sheetGridRange)(r,(0,a.gridRange)(i,o,e.length,e[0].length));return this.write(s,f(s,e))},e.prototype.writeCell=function(e){return this.write(this.address,g(this.address,e))},Object.defineProperty(e.prototype,"address",{get:function(){return this.workStack[this.workStack.length-1][0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visitedCells",{get:function(){return this.workStack[this.workStack.length-1][1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){return this.transactionLog},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remainingWork",{get:function(){return this.workStack},enumerable:!1,configurable:!0}),e.prototype.incrementCellWriteCount=function(e){var t=this.ensureNeedsVisit(e);if(t[1]+=1,t[1]>10)return h},e.prototype.ensureNeedsVisit=function(e){var t,r=this.anchorVisitCounts[e.sheet.index];return void 0===r&&(r=this.anchorVisitCounts[e.sheet.index]={}),r[(0,l.gridRangeAnchorHash)(e.range)]=null!==(t=r[(0,l.gridRangeAnchorHash)(e.range)])&&void 0!==t?t:[e,0]},e.prototype.write=function(e,t){if(this.transactionLog.rollBack(e))return{kind:n.Next,address:this.address};var r=this.incrementCellWriteCount(this.address);return void 0!==r?r:(this.transactionLog.insert(e,t),this.next())},e.prototype.next=function(){for(;this.workStack.length>1;)if(this.workStack.pop(),0===this.transactionLog.lookup(this.address).length)return{kind:n.Next,address:this.address};if(0===this.transactionLog.lookup(this.address).length)return{kind:n.Next,address:this.address};var e=this.unevaluatedVisibleRanges();if((0,s.safePush)(this.workStack,e),e.length>0)return{kind:n.Next,address:this.address};for(var t=[],r=[],i=0,a=this.transactionLog.extract();i<a.length;i++){var o=a[i];switch(o.message.kind){case d.CellWrite:t.push([o.message.cell,o.message.oper]);break;case d.RangeWrite:r.push([o.range,o.message.opers])}}return{kind:n.Done,cellWrites:t,rangeWrites:r}},e.prototype.unevaluatedVisibleRanges=function(){var e=[];for(var t in this.anchorVisitCounts)for(var r in this.anchorVisitCounts[t]){var n=this.anchorVisitCounts[t][r][0];0===this.transactionLog.lookup(n).length&&e.push([n,u.emptyVisitedCells])}return e},e}();t.IterativeRecalcState=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var n=r(1);t.copyExcept=n.rTree.copyExcept,t.RTKind=n.rTree.RTKind,t.RTree=n.rTree.RTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var n=r(3);t.adjustFormulaOrigin=n.adjust.adjustFormulaOrigin},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.renderFormat=t.initUtilGlobals=t.getValueEditOperKind=t.getFormatString=t.applyValueEdit=void 0;var n=r(38);t.applyValueEdit=n.util.applyValueEdit,t.getFormatString=n.util.getFormatString,t.getValueEditOperKind=n.util.getValueEditOperKind,t.initUtilGlobals=n.util.initUtilGlobals,t.renderFormat=n.util.renderFormat,t.toXLNumber=n.util.toXLNumber},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var n=r(3);t.createSimplePrintGlobals=n.printServiceTypes.createSimplePrintGlobals,t.printLocalsGrid=n.printServiceTypes.printLocalsGrid,t.printLocalsName=n.printServiceTypes.printLocalsName},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=t.evalName=t.evalCellsAsync=t.evalCells=t.evalFormula=t.evaluationMachineContext=t.runtimeEvaluationContext=void 0;var n=r(267),i=r(75),a=r(10),o=r(26),s=r(268),u=r(182),l=r(7),c=r(188),d=r(269),p=r(186),m=r(187),f=r(435),g=r(185),h=r(16),v=r(28),S=r(28),y=r(44),F=r(67);function C(e){return{globals:e,timer:(0,g.runtimeTimer)(),machineContext:R(e)}}function R(e){return{globals:e,resolver:(0,u.createResolver)(e),numberFormatter:(0,c.createNumberFormatter)(e),parser:(0,d.createParser)(e),printer:(0,s.createPrinter)(e),analyzer:(0,n.createAnalyzer)(e),createCellEvaluationMachine:p.createCellEvaluationMachine,createFormulaEvaluationMachine:m.createFormulaEvaluationMachine,createCallTermEvaluationMachine:m.createCallTermEvaluationMachine}}function b(e,t,r){var n,s=C(e),u=(0,h.bottomEvalPrecedents)(),c=(0,m.createFormulaEvaluationMachine)(s.machineContext,t.stepConfig,(0,h.evalLocalsSlice)(t),u,F.emptyVisitedCells,F.emptyVisitedNames,S.readOperType,r),d=new g.EvaluationRuntime(s,[c]),p=(0,g.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return function e(t){if(Array.isArray(t)){var r=t[0];if(r.kind===o.ResultKind.Success){if((0,l.isRangeOper)(r.value)||(0,l.isMissingOper)(r.value)){var n="expected ReadOper; given ".concat((0,i.anonymize)(r)),s="calc.runtime.evalFormula: ".concat(n);return(0,a.assertFalse)(s)}return r}return r}return t.kind===o.ResultKind.Paused?(0,y.paused)((function(r){return e(t.resume(r))})):(0,y.breaked)((function(){return e(t.resume())}))}(d.evaluateSync(p))}function E(e,t,r){for(var n=C(e),i=[],a=0;a<r.length;a+=1)i.push(new v.VoidMachine((0,p.createCellEvaluationMachine)(n.machineContext,t,F.emptyVisitedCells,r[a])));return new g.EvaluationRuntime(n,i)}function P(e,t,r){var n;if(0===r.length)return[];var i=E(e,t.stepConfig,r),a=(0,g.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return i.evaluateSync(a)}function k(e,t,r){var n;if(0===r.length)return Promise.resolve([]);var i=E(e,void 0,r),a=(0,g.createSchedule)(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return i.evaluateAsync(a)}function T(e,t,r,n){var i,a=C(e),s=(0,f.createNameEvaluationMachine)(a.machineContext,t.stepConfig,r,n),u=new g.EvaluationRuntime(a,[s]),l=(0,g.createSchedule)(null!==(i=t.schedulerConfig)&&void 0!==i?i:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:t.kind===o.ResultKind.Paused?(0,y.paused)((function(r){return e(t.resume(r))})):(0,y.breaked)((function(){return e(t.resume())}))}(u.evaluateSync(l))}t.runtimeEvaluationContext=C,t.evaluationMachineContext=R,t.evalFormula=b,t.evalCells=P,t.evalCellsAsync=k,t.evalName=T,t.createEvaluator=function(e){return{evalFormula:function(t,r){return b(e,t,r)},evalCells:function(t,r){return P(e,t,r)},evalName:function(t,r,n){return T(e,t,r,n)},evalCellsAsync:function(t,r){return k(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNameEvaluationMachine=void 0;var n=r(75),i=r(10),a=r(26),o=r(137),s=r(19),u=r(18),l=r(16),c=r(67),d=function(){function e(e,t,r,n){this.context=e,this.stepConfig=t,this.name=r,this.origin=n}return e.prototype.evalName=function(){var e=this.context.globals.getNameFormula(this.name,s.NameSource.Plain);if(e.kind===a.ResultKind.Failure)return o.Pledge.reject(e.reason);var t=e.value;if(null==t)return o.Pledge.resolve(void 0);var r=(0,l.bottomEvalPrecedents)(),n=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,l.evalLocalsName)((0,s.lexicalSourceName)(this.name),(0,l.evalLocalsGrid)(this.origin)),r,c.emptyVisitedCells,(0,c.appendVisitedName)(c.emptyVisitedNames,this.name),u.SignatureType.All,t);return o.Pledge.fromMachine(n).catch(this.receiveFailure())},e.prototype.receiveFailure=function(){return function(e){if(e.kind===l.RuntimeInternalReasonKind.Unevaluated){var t="unexpected reason ".concat((0,n.anonymize)(e)),r="calc.runtime.NameEvaluationMachine.receiveFailure: ".concat(t);return(0,i.assertFalse)(r)}return o.Pledge.reject(e)}},e}();t.createNameEvaluationMachine=function(e,t,r,n){return o.Pledge.try((function(){return new d(e,t,r,n).evalName()}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomCellEvaluationTest=t.randomTestSheetContents=t.randomTestCellContents=t.randomTestFormula=t.runCellEvaluationTest=t.runMockCellEvaluationTest=t.makeRandomizedTimer=t.abstractEvalCells=t.sheet=t.document=t.makeDirtyCellContents=t.makeFailedCellContents=t.makeFinalCellContents=t.TestCellState=t.SpecialContents=t.locationFormula=t.locationValue=t.parsed=t.compiled=t.makeTestContext=void 0;var n,i,a=r(0),o=r(10),s=r(45),u=r(437),l=r(266),c=r(44),d=r(16),p=r(185),m=r(181),f=r(438),g=r(270),h=r(19),v=r(7),S=r(265),y=r(269),F=r(118),C=r(443),R=r(119),b=r(8),E=r(34),P=r(182),k=r(28),T=r(267),A=r(67),N=r(188),_=r(26),I=r(444),O=r(268),M=r(445),D=r(186),w=r(187),L=r(74);function x(e,r,n,i,o){void 0===o&&(o=!1);var s=r.kind===h.LexicalKind.NameManager?(0,l.analyzeLocalsName)((0,h.sheetGridCell)(t.sheet,n)):(0,l.analyzeLocalsGrid)(r.kind,(0,h.sheetGridCell)(t.sheet,n)),u=e.analyzer.checkFormula(s,i);if((0,_.isSuccess)(u)&&(0,v.isWellFormed)(u.value)){var d=r.kind===h.LexicalKind.NameManager?(0,c.compileLocalsName)(n):(0,c.compileLocalsGrid)(r.kind,n),p=e.compiler.compileFormula(o?a.__assign(a.__assign({},d),{emitStepInfo:o}):d,u.value);if(p.kind===_.ResultKind.Success)return p.value;throw new Error("unexpected result ".concat(JSON.stringify(p)))}throw new Error("not well formed formula ".concat(JSON.stringify(u)))}t.makeTestContext=function(e,t,r){var n=(0,M.createArrayLogger)();(0,C.initCalc)(n,null!=e?e:u.featureEnabledDummyCallback),(0,L.overrideTypedFeatureGates)(L.getTypedFeatureGate,{"Microsoft.Office.Excel.CalcEtaLambda":!0,"Microsoft.Office.Excel.EtaReducedLambdas":!0});var i=(0,F.calcConfig)(null!=t?t:(0,F.getEnglishLocaleInfo)(),void 0,r),a={config:i},o={config:i},s={config:i};return{logger:n,config:i,compileGlobals:o,parser:(0,y.createParser)(a),analyzer:(0,T.createAnalyzer)(s),compiler:(0,m.createCompiler)(o)}},t.compiled=x,t.parsed=function(e,t,r,n,i,a,s){void 0===n&&(n=R.RefStyle.A1),void 0===i&&(i=t.kind!==h.LexicalKind.NameManager?(0,v.gridRangeAnchor)(t.range.range):(0,o.assertFalse)("must pass origin for LexicalSourceName")),void 0===a&&(a=!1);var u=e.parser.parseFormula((0,S.parseLocals)(t.kind,i,{refStyle:n},s),r);if(u.kind!==_.ResultKind.Success)throw new Error("unexpected result ".concat(JSON.stringify(u)));return x(e,t,i,u.value,a)},t.locationValue=function(e,t){return{cell:e,oper:t}},t.locationFormula=function(e,t){return{source:e,formula:(0,R.formula)(t,[],[],1)}},function(e){e.ValueMocked="ValueMocked",e.ValueUnavailable="ValueUnavailable",e.FormulaUnavailable="FormulaUnavailable",e.EvalNotImplemented="EvalNotImplemented",e.EvalJavaScriptError="EvalJavaScriptError"}(n||(t.SpecialContents=n={})),function(e){e.Dirty="Dirty",e.Final="Final",e.Failed="Failed"}(i||(t.TestCellState=i={}));var K,U=((K=(0,d.bottomEvalPrecedents)()).bound=b.PrecsBound.Exact,K);function B(e,t,r){return{oper:e,reason:t,state:r,precedents:U}}function W(e){return B(e,void 0,i.Final)}function G(e){return B(e,void 0,i.Dirty)}function V(e){var t=e.row,r=e.col;return"R".concat(t+1,"C").concat(r+1)}function j(e,t){return"number"==typeof t?(0,R.literalNode)(e.config.mathpack.fromNumber(t)):t===n.EvalNotImplemented?(0,R.appNode)((0,R.wsfNode)(E.WorksheetFuncId.RAND,"RAND"),[]):t===n.EvalJavaScriptError?(0,R.appNode)((0,R.wsfNode)(E.WorksheetFuncId.NOW,"NOW"),[]):Array.isArray(t)?(0,R.appNode)((0,R.wsfNode)(E.WorksheetFuncId.SUM,"SUM"),t.map(j.bind(void 0,e))):(0,R.cellRefNode)((0,R.cellRefSingle)((0,f.absPos)(t.row),(0,f.absPos)(t.col)))}function q(e,t,r){var a={};for(var s in t){var u=t[s];if(null!=u){var l=u[1];if("number"==typeof l){var d=W(e.config.mathpack.fromNumber(l));a[s]=d}else if(Array.isArray(l)||l===n.FormulaUnavailable||l===n.EvalNotImplemented||l===n.EvalJavaScriptError){d=G(b.blankOper);a[s]=d}else l===n.ValueUnavailable||l===n.ValueMocked||(0,o.assertNever)("calc.runtime.abstractEvalCells, tc",l)}}var p={},m=[];function f(r){var s=V(r),u=t[s];if(null!=u){var l=u[1];if("number"!=typeof l&&l!==n.ValueUnavailable){var d=a[s];if(null==d&&(d=W(b.blankOper),a[s]=d),d.state!==i.Failed){if(d.state!==i.Final){var g={cycle:!1};(0,o.assertTrue)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: undetected cycle",null==p[s]),p[s]=g,m.push(g);try{switch(l){case n.ValueMocked:return(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: unexpected ValueMocked");case n.FormulaUnavailable:throw new Error("calc.runtime.makeCellEvaluationTest.abstractEvalCell: dummy Failure from getCellFormula")}var h=function r(s,u){if("number"==typeof u)return(0,_.success)(e.config.mathpack.fromNumber(u));if(u===n.EvalNotImplemented)return(0,_.failure)({kind:c.ReasonKind.NotImplemented});if(u===n.EvalJavaScriptError)return(0,_.failure)({kind:c.ReasonKind.JavaScriptError});for(var l=[],d=0;d<u.length;d+=1){var g=u[d];if("object"!=typeof g||Array.isArray(g)){var h=r(s,g);if(!(0,_.isSuccess)(h))return h;l.push(e.config.mathpack.toNumber(h.value))}else l.push(g)}var v=function(e){var r=l[e];if("number"==typeof r)return"continue";var o=V(r),s=t[o];if(null!=s&&s[1]===n.ValueUnavailable)return{value:(0,_.failure)({kind:c.ReasonKind.Unavailable})};var u=a[o];if(null!=u&&u.state===i.Failed)return{value:(0,_.failure)({kind:c.ReasonKind.PreviousFailure})};var d=p[o];if(void 0!==d){for(var f=m.findIndex((function(e){return e===d}));-1!==f&&f<m.length;f+=1)m[f].cycle=!0;return{value:(0,_.failure)({kind:c.ReasonKind.CellCycle})}}};for(d=0;d<l.length;d+=1){var S=v(d);if("object"==typeof S)return S.value}var y=0;for(d=0;d<l.length;d+=1){var F=l[d];if("number"!=typeof F){var C=f(F);if(void 0!==C)return(0,_.failure)({kind:C});var R=V(F),b=a[R];if(null!=b){if(b.state===i.Failed)return(0,_.failure)({kind:s.cycle?c.ReasonKind.CellCycle:c.ReasonKind.PreviousFailure});(0,o.assertTrue)("calc.runtime.testUtil: Final after abstractEvalCell",b.state===i.Final),y+=e.config.mathpack.toNumber(b.oper)}}else y+=F}return(0,_.success)(e.config.mathpack.fromNumber(y))}(g,l);return(0,_.isSuccess)(h)?void function(e,t){if(e.state!==i.Dirty){var r="expected dirty cellContent; given ".concat(JSON.stringify(e));(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFinal: ".concat(r))}e.oper=t,e.state=i.Final}(d,h.value):void function(e,t){if(e.state!==i.Dirty){var r="expected dirty cellContent; given ".concat(JSON.stringify(e));(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFailed: ".concat(r))}e.reason=t,e.state=i.Failed}(d,h.reason.kind)}catch(e){return c.ReasonKind.JavaScriptError}finally{delete p[s],m.pop()}}}else(0,o.assertTrue)("calc.runtime.makeCellEvaluationTest",null!=d.reason)}}}return{evalResults:r.map((function(e){try{return f(e)}catch(e){return c.ReasonKind.JavaScriptError}})),sheetState:a}}function H(e){return"string"==typeof e?c.ReasonKind.PreviousFailure:e}function z(e){return null==e?e:a.__assign(a.__assign({},e),{reason:void 0})}function Q(e,t){for(var r in e){var n=e[r];null!=n&&n.state===i.Dirty&&(delete e[r],delete t[r])}}function Y(e,t){var r={};for(var n in e)r[n]=t(e[n]);return r}function J(e){for(var t=[],r=0;r<e;r+=1)t.push(r);return t}function $(e,t){return null==t?t:"number"==typeof t.row&&"number"==typeof t.col&&1===t.rows&&1===t.cols?"gridCell(".concat(t.row,", ").concat(t.col,")"):128===t.kind&&1===Object.getOwnPropertyNames(t).length?"blankOper":t}function X(e,r,a,u,l,m,f,S){void 0===S&&(S={});var F=function(e,r){var a={},u={};function l(e){var t=a[e];return null==t&&(t=W(b.blankOper),a[e]=t),t}for(var p in r){var m=r[p];if(null!=m){var f=m[0],S=m[1];if("number"==typeof S)l(p).oper=e.config.mathpack.fromNumber(S);else if(Array.isArray(S)||S===n.EvalNotImplemented||S===n.EvalJavaScriptError){l(p).state=i.Dirty;var y=(0,R.formula)(j(e,S),[],[],2);u[p]=x(e,(0,h.lexicalSourceCell)((0,h.sheetGridCell)(t.sheet,f)),f,y)}else if(S===n.ValueMocked||S===n.FormulaUnavailable){l(p).state=i.Dirty}else S===n.ValueUnavailable||(0,o.assertNever)("calc.runtime.makeCellEvaluationTest, tc",S)}}function F(e,t){return(0,d.throwEvaluationError)((0,v.notImplemented)(["RAND"]))}function C(e,t){throw new Error("JavaScript error")}var P={config:e.config,getDocumentLoc:function(e,r){return(0,_.success)(t.document)},getSheetIndex:function(e,r){return(0,_.success)(t.sheet.index)},getSheetName:function(e,t){return(0,_.success)("Sheet1")},getSheetRangeIndexes:function(e){return(0,_.success)((0,h.sheetRangeIndexes)([t.sheet.index],0))},getNameLoc:function(e,t){return(0,_.failure)((0,v.unavailable)(["name at ".concat(JSON.stringify((0,h.nameLoc)(e,t)))]))},getUserDefinedFuncLoc:function(e,t){return(0,_.success)([])},getCellValue:function(e){var t=V(e.range),o=r[t];if(null!=o&&o[1]===n.ValueUnavailable)return(0,_.failure)((0,v.unavailable)(["value at ".concat(t)]));var s=a[t];return null==s?(0,_.success)((0,c.finalValue)(b.blankOper)):s.state===i.Final?(0,_.success)((0,c.finalValue)(s.oper)):s.state===i.Failed?(0,_.failure)((0,c.previousFailure)(e)):(0,_.success)((0,c.pendingValue)(e))},getCellValues:function(e){var t=e.sheet,r=e.range,n=r.row,i=r.col,a=r.rows,o=r.cols,u=void 0,l=(0,s.jaggedArray)(a,o,(function(e,r){var a=P.getCellValue((0,h.sheetGridCell)(t,(0,h.gridCell)(e+n,r+i)));return a.kind===_.ResultKind.Failure?(null==u&&(u=a),(0,c.finalValue)(b.blankOper)):a.value}));return null!=u?u:(0,_.success)(l)},getWorksheetFunc:function(e){if(e===E.WorksheetFuncId.SUM){var t=(0,g.getWorksheetFunc)(e);return null!=t?(0,_.success)(t):(0,_.failure)((0,v.notImplemented)(["SUM"]))}return(0,_.success)(e===E.WorksheetFuncId.RAND?F:C)},getUserDefinedFunc:function(){return(0,_.failure)((0,v.unavailable)(["getUserDefinedFunc"]))},getNameFormula:function(e){return(0,_.failure)((0,v.unavailable)(["name at ".concat(JSON.stringify(e))]))},getCellFormula:function(e){var t=V(e.range),i=r[t];if(null!=i&&i[1]===n.FormulaUnavailable)return(0,_.failure)((0,v.unavailable)(["formula at ".concat(t)]));var a=u[t];return null!=a?(0,_.success)((0,c.cellFormula)((0,h.lexicalSourceCell)(e),a)):(0,_.success)(void 0)},interruptToken:[c.Interrupt.Continue],tryGetHiddenRows:function(e,t,r){return(0,_.success)([])},tryGetHiddenCols:function(e,t,r){return(0,_.success)([])},isInFilterMode:function(e){return(0,_.success)(!1)},getKnownFormat:function(){return(0,_.failure)((0,v.notImplemented)(["getKnownFormat"]))},getIformat:function(){return(0,_.failure)((0,v.notImplemented)(["getIformat"]))},getFormatString:function(){return(0,_.failure)((0,v.notImplemented)(["getFormatString"]))},getRandom:function(){return(0,_.failure)((0,v.notImplemented)(["getRandom"]))},getTime:function(){return(0,_.failure)((0,v.notImplemented)(["getTime"]))},schedulerConfig:{},limits:{},setCellValue:function(e,t){var r=V(e.range),n=a[r];if(null==n||n.state!==i.Dirty){var s="expected dirty cell at ".concat(JSON.stringify(e)," but have ").concat(JSON.stringify(n),"; given ").concat(JSON.stringify(t));(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellValue: ".concat(s))}n.oper=t,n.state=i.Final},setCellValues:function(e,t){throw new Error("unexpected call to setCellValues")},setCellFailure:function(e,t){if(!(0,v.isSheetGridCell)(e)){var r="expected cell; given range ".concat(JSON.stringify(e));return(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(r))}var n=V(e.range),s=a[n];if(null==s||s.state!==i.Dirty){r="expected dirty cell at ".concat(JSON.stringify(e)," but have ").concat(JSON.stringify(s),"; given ").concat(JSON.stringify(t));(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(r))}s.reason=t.kind,s.state=i.Failed},getUsedRange:function(e){return(0,_.success)((0,h.sheetGridRange)(e,(0,h.gridRange)(0,0,h.sheetRows,h.sheetCols)))},getContainingTable:function(){return(0,_.failure)((0,v.notImplemented)(["getContainingTable"]))},getIntersectingTables:function(){return(0,_.failure)((0,v.notImplemented)(["getIntersectingTables"]))},getStructRefColumn:function(){return(0,_.failure)((0,v.notImplemented)(["getStructRefColumn"]))},getStructRefSpecialRef:function(){return(0,_.failure)((0,v.notImplemented)(["getStructRefSpecialRef"]))}};return[t.sheet,a,P]}(e,u),C=F[0],I=F[1],M=F[2];for(var D in S){var w=D;M[w]=S[w](M[w])}for(var L=[u,l,m,f],K=l.map((function(e){return(0,h.sheetGridCell)(C,e)})),U=null!=f?f:J(l.length),B=[],G=0;G<U.length;G+=1)B[U[G]]=G;var q={globals:M,resolver:(0,P.createResolver)(M),numberFormatter:(0,N.createNumberFormatter)(M),parser:(0,y.createParser)(M),printer:(0,O.createPrinter)(M),analyzer:(0,T.createAnalyzer)(M),createCellEvaluationMachine:r.createCellEvaluationMachine.bind(r),createFormulaEvaluationMachine:r.createFormulaEvaluationMachine.bind(r),createCallTermEvaluationMachine:r.createCallTermEvaluationMachine.bind(r)},X={globals:M,timer:a,machineContext:q},Z=[];for(G=0;G<U.length;G+=1){var ee=K[U[G]];Z.push(new k.VoidMachine(q.createCellEvaluationMachine(q,void 0,A.emptyVisitedCells,ee)))}return new p.EvaluationRuntime(X,Z).evaluateAsync((0,p.createSchedule)(X.globals.schedulerConfig)).then((function(e){return B.map((function(t){var r=e[t];return r.kind===_.ResultKind.Success?r.value:r.reason.kind}))})).catch((function(e){return null!=e.reason?e.reason.stack:e.stack})).then((function(e){if(Array.isArray(e)){var t=e,r=I,n=m.evalResults,i=m.sheetState;null!=f&&(t=t.map(H),n=n.map(H),function(e,t){Q(e,t),Q(t,e)}(r=Y(r,z),i=Y(i,z)));try{expect([L,t,r]).toEqual([L,n,i])}catch(e){throw console.warn("runMockCellEvaluationTest: test failure:",JSON.stringify({testData:L,testResults:t,testState:r},$,2)),e}}else expect([L,e]).toEqual([L,void 0])}))}t.makeFinalCellContents=W,t.makeFailedCellContents=function(e,t){return B(e,t,i.Failed)},t.makeDirtyCellContents=G,t.document={path:void 0,name:"Book1"},t.sheet=(0,h.sheetIndex)(t.document,0),t.abstractEvalCells=q,t.makeRandomizedTimer=function(e){return void 0===e&&(e=.5),{doTimeout:function(t){return(0,I.randomFloat)()>e}}},t.runMockCellEvaluationTest=X,t.runCellEvaluationTest=function(e,t,r,n,i,a){return void 0===a&&(a={}),X(e,{createCellEvaluationMachine:D.createCellEvaluationMachine,createFormulaEvaluationMachine:w.createFormulaEvaluationMachine,createCallTermEvaluationMachine:function(e){}},(0,p.runtimeTimer)(),t,r,n,i,a)};function Z(e,t,r){void 0===r&&(r=0);var i=(0,I.randomFloat)()*(r<3?1:.625);return i<.05?n.EvalJavaScriptError:i<.1?n.EvalNotImplemented:i<.55?1:a.__spreadArray([],new Array((0,I.randomIndex)(3)+1),!0).map((function(){return(0,I.randomFloat)()<.5?(0,h.gridCell)((0,I.randomIndex)(e),(0,I.randomIndex)(t)):Z(e,t,r+1)}))}function ee(e,t){for(;;){var r=(0,I.randomFloat)();return r<.1?n.ValueUnavailable:r<.2?n.FormulaUnavailable:Z(e,t)}}function te(e,t){for(var r={},n=0;n<e;n+=1)for(var i=0;i<t;i+=1)if((0,I.randomFloat)()<.5){var a=ee(e,t),o=(0,h.gridCell)(n,i);r[V(o)]=[o,a]}return r}t.randomTestFormula=Z,t.randomTestCellContents=ee,t.randomTestSheetContents=te,t.randomCellEvaluationTest=function(e,t,r){var n=te(t,r),i=[];for(var a in n){var o=n[a];null!=o&&(0,I.randomFloat)()<.75&&i.push(o[0])}return[n,i=(0,I.randomShuffled)(i),q(e,n,i),(0,I.randomFloat)()<.5?(0,I.randomShuffled)(J(i.length)):void 0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.ConsoleLogger=t.AssertLogger=void 0;var n=r(1);t.AssertLogger=n.testConfig.AssertLogger,t.ConsoleLogger=n.testConfig.ConsoleLogger,t.featureEnabledDummyCallback=n.testConfig.featureEnabledDummyCallback},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldRef=t.fieldRefNamePart=t.lambdaNode=t.letNode=t.nameNode=t.xorNode=t.unionNode=t.subNode=t.sheet1Name=t.sheet1=t.relPos=t.rangeNode=t.powNode=t.poundNode=t.posNode=t.percentNode=t.orNode=t.negNode=t.neNode=t.mulNode=t.minNode=t.maxNode=t.ltNode=t.leNode=t.isectNode=t.isNameLocEqual=t.gtNode=t.geNode=t.expectTrue=t.eqNode=t.document1=t.divNode=t.createSingleRange=t.concatNode=t.badUnexpCharsNode=t.badStructRefNode=t.badStringLiteralNode=t.badUnexpSeqNode=t.badQualNode=t.badParamNameNode=t.badNumberLiteralNode=t.badFieldRefNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badCellRefNode=t.badBracketNode=t.atNode=t.andNode=t.addNode=t.absPos=void 0;var n=r(3);t.absPos=n.testUtil.absPos,t.addNode=n.testUtil.addNode,t.andNode=n.testUtil.andNode,t.atNode=n.testUtil.atNode,t.badBracketNode=n.testUtil.badBracketNode,t.badCellRefNode=n.testUtil.badCellRefNode,t.badErrorLiteralNode=n.testUtil.badErrorLiteralNode,t.badFieldNameNode=n.testUtil.badFieldNameNode,t.badFieldRefNode=n.testUtil.badFieldRefNode,t.badNumberLiteralNode=n.testUtil.badNumberLiteralNode,t.badParamNameNode=n.testUtil.badParamNameNode,t.badQualNode=n.testUtil.badQualNode,t.badUnexpSeqNode=n.testUtil.badUnexpSeqNode,t.badStringLiteralNode=n.testUtil.badStringLiteralNode,t.badStructRefNode=n.testUtil.badStructRefNode,t.badUnexpCharsNode=n.testUtil.badUnexpCharsNode,t.concatNode=n.testUtil.concatNode,t.createSingleRange=n.testUtil.createSingleRange,t.divNode=n.testUtil.divNode,t.document1=n.testUtil.document1,t.eqNode=n.testUtil.eqNode,t.expectTrue=n.testUtil.expectTrue,t.geNode=n.testUtil.geNode,t.gtNode=n.testUtil.gtNode,t.isNameLocEqual=n.testUtil.isNameLocEqual,t.isectNode=n.testUtil.isectNode,t.leNode=n.testUtil.leNode,t.ltNode=n.testUtil.ltNode,t.maxNode=n.testUtil.maxNode,t.minNode=n.testUtil.minNode,t.mulNode=n.testUtil.mulNode,t.neNode=n.testUtil.neNode,t.negNode=n.testUtil.negNode,t.orNode=n.testUtil.orNode,t.percentNode=n.testUtil.percentNode,t.posNode=n.testUtil.posNode,t.poundNode=n.testUtil.poundNode,t.powNode=n.testUtil.powNode,t.rangeNode=n.testUtil.rangeNode,t.relPos=n.testUtil.relPos,t.sheet1=n.testUtil.sheet1,t.sheet1Name=n.testUtil.sheet1Name,t.subNode=n.testUtil.subNode,t.unionNode=n.testUtil.unionNode,t.xorNode=n.testUtil.xorNode,t.nameNode=n.testUtil.nameNode,t.letNode=n.testUtil.letNode,t.lambdaNode=n.testUtil.lambdaNode,t.fieldRefNamePart=n.testUtil.fieldRefNamePart,t.fieldRef=n.testUtil.fieldRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;var n=r(3);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKnownFormatDefined=t.getSpecial=t.getSingle=t.getKnownFormat=t.getColor=t.englishXLSXKnownFormat=t.buildSingle=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.buildMMDDYYFormat=t.buildFractionFormat=t.buildCurrencyFormat=void 0;var n=r(38);t.buildCurrencyFormat=n.knownFormat.buildCurrencyFormat,t.buildFractionFormat=n.knownFormat.buildFractionFormat,t.buildMMDDYYFormat=n.knownFormat.buildMMDDYYFormat,t.buildNumberFormat=n.knownFormat.buildNumberFormat,t.buildPercentFormat=n.knownFormat.buildPercentFormat,t.buildScientificFormat=n.knownFormat.buildScientificFormat,t.buildSingle=n.knownFormat.buildSingle,t.englishXLSXKnownFormat=n.knownFormat.englishXLSXKnownFormat,t.getColor=n.knownFormat.getColor,t.getKnownFormat=n.knownFormat.getKnownFormat,t.getSingle=n.knownFormat.getSingle,t.getSpecial=n.knownFormat.getSpecial,t.isKnownFormatDefined=n.knownFormat.isKnownFormatDefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRange=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;var n=r(3);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRange=n.cellFormat.formatGridRange,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unique=t.sortby=t.sort=t.filter=void 0;var n=r(45),i=r(10),a=r(116),o=r(85),s=r(18),u=r(7),l=r(8),c=r(8),d=r(84),p=r(280),m=r(46);function f(e){return(0,u.isBlankOper)(e)?(0,c.arrayOper)(1,1,[[e]]):e}function g(e,t,r,n){void 0===t&&(t=l.missingOper);var i=e.mathpack,a=(0,u.isMissingOper)(t)?(0,c.arrayOper)(1,1,[[i.one]]):t;if(!(1===a.rows&&a.cols>=1||1===a.cols&&a.rows>=1))return c.valueErrorOper;if(a.rows*a.cols>r)return c.valueErrorOper;for(var o=[],d=0;d<a.rows;++d)for(var p=0;p<a.cols;++p){var f=e.coerceOper(a.opers[d][p],s.OperKind.Number);if(!(0,u.isNumberOper)(f))return(0,m.assertError)(f);var g=n(i.sfix(f));if("number"!=typeof g)return g;o.push(g)}return o}function h(e,t){return t?new n.NonstrictArray2D(e.cols,e.rows,(function(t,r){return e.opers[r][t]})):new n.StrictArray2D(e.rows,e.cols,e.opers)}function v(e,t,r,i){for(var a=t.rows,o=t.cols,s=e.config,u=[],l=0;l<a;++l)u.push(l);u.sort((function(e,t){for(var r=0;r<i.length;++r){var n=i[r],a=n[0],o=n[1],u=(0,p.sortOpers)(s,a(e),a(t),o,!1);if(0!==u)return u}return e-t}));var d=new n.NonstrictArray2D(a,o,(function(e,r){return t.get(u[e],r)})),m=r?(0,n.transposeArray2D)(d):d;return(0,c.arrayOper)(m.rows,m.cols,(0,n.array2DToJaggedArray)(m))}t.filter=function(e,t){var r=t[0],i=t[1],a=t[2],o=(0,m.rangeOrArrayToVal)(r,c.refErrorOper);if((0,u.isErrorOper)(o))return o;var l=(0,m.rangeOrArrayToVal)(i,c.refErrorOper);if((0,u.isErrorOper)(l))return l;var p=(0,m.makeSlicer)(o),f=p.rows,g=p.cols,h=(0,m.makeSlicer)(l),v=h.rows,S=h.cols;if(!(1===v&&S>=1||1===S&&v>=1))return c.valueErrorOper;var y=1===v&&1===S?1===f:v>1;if(y?v!==f:S!==g)return c.valueErrorOper;for(var F=e.dereferenceAllOpers([l])[0],C=(0,n.sparseArray2DTo1D)((0,d.isRangeValues)(F)?F.arrays[0]:new n.StrictSparseArray2D(F.rows,F.cols,F.rows,F.cols,F.opers,c.blankOper),!y),R=[],b=0;b<C.length;++b){var E=e.coerceOper(C.get(b),s.OperKind.Boolean);if(!(0,u.isBooleanOper)(E))return E;if(E.value)R.push(b);else if(b>=C.denseLength)break}if(y?(0,m.validateArraySize)(R.length,g):(0,m.validateArraySize)(f,R.length),0===R.length)return void 0===a||(0,u.isMissingOper)(a)?c.calcErrorOper:a;var P=e.dereferenceAllOpers([o])[0],k=(0,d.isRangeValues)(P)?P.arrays[0]:new n.StrictArray2D(P.rows,P.cols,P.opers),T=function(e){return new n.NonstrictArray2D(R.length,e.cols,(function(t,r){return e.get(R[t],r)}))},A=y?T(k):(0,n.transposeArray2D)(T((0,n.transposeArray2D)(k)));return(0,c.arrayOper)(A.rows,A.cols,(0,n.array2DToJaggedArray)(A))},t.sort=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=f(r),u=!!a&&a.value,l=h(s,u),d=l.cols,p=g(e,n,d,(function(e){return e>=1&&e<=d?e-1:c.valueErrorOper}));if(!Array.isArray(p))return p;var m=g(e,i,p.length,(function(e){return 1===e||-1===e?e:c.valueErrorOper}));if(!Array.isArray(m))return m;if(1===m.length)m.length=p.length,(0,o.arrayFill)(m,m[0]);else if(m.length!==p.length)return c.valueErrorOper;var S=p.map((function(e,t){return[function(t){return l.get(t,e)},m[t]]}));return 1===l.rows?s:v(e,l,u,S)},t.sortby=function(e,t){var r,n=t[0],a=t.slice(1),o=f(n);(0,i.assertTrue)("calc.funcs.sortby",a.every((function(e,t){return t%2==0?(0,u.isArrayOper)(e)||(0,u.isBlankOper)(e):(0,u.isNumberOper)(e)||(0,u.isMissingOper)(e)})));for(var s=[],d=0;d<a.length;d+=2)s.push([f(a[d]),null!==(r=a[d+1])&&void 0!==r?r:l.missingOper]);for(var p=s[0][0].cols>=s[0][0].rows&&s[0][0].cols===o.cols,m=h(o,p),g=[],S=function(t,r){if(1!==t.rows&&1!==t.cols)return{value:c.valueErrorOper};if(!(p?t.cols===o.cols:t.rows===o.rows))return{value:c.valueErrorOper};var n=t.opers,i=e.mathpack.sfix((0,u.isNumberOper)(r)?r:e.mathpack.one);if(1!==i&&-1!==i)return{value:c.valueErrorOper};g.push([p?function(e){return n[0][e]}:function(e){return n[e][0]},i])},y=0,F=s;y<F.length;y++){var C=F[y],R=S(C[0],C[1]);if("object"==typeof R)return R.value}return 1===m.rows?o:v(e,m,p,g)},t.unique=function(e,t){var r,i,o=t[0],s=t[1],u=t[2],l=f(o),d=null!==(r=null==s?void 0:s.value)&&void 0!==r&&r,m=null!==(i=null==u?void 0:u.value)&&void 0!==i&&i,g=h(l,d);if(1===g.rows)return l;for(var v=e.config,S=[],y=a.RedBlackMapTree.create((function(e,t){for(var r=0;r<g.cols;++r){var n=(0,p.sortOpers)(v,g.get(e,r),g.get(t,r),1,!0);if(0!==n)return n}return 0})),F=function(e){var t,r=void 0;t=y.getOrSetValue(e,(function(){return{firstRow:e,count:0}})),y=t[0],(r=t[1]).count+=1,S.push(r)},C=0;C<g.rows;++C)F(C);var R=m?S.filter((function(e){return 1===e.count})):S.filter((function(e,t){return e.firstRow===t}));if(0===R.length)return c.calcErrorOper;var b=new n.NonstrictArray2D(R.length,g.cols,(function(e,t){return g.get(R[e].firstRow,t)})),E=d?(0,n.transposeArray2D)(b):b;return(0,c.arrayOper)(E.rows,E.cols,(0,n.array2DToJaggedArray)(E))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxRetriesForLoadingScript=t.isCalcInit=t.initCalcThread=t.initCalcInThread=t.initCalcCalled=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=void 0;var n=r(1);t.getCalcAbsUrl=n.config.getCalcAbsUrl,t.getCalcAbsUrlOrThrow=n.config.getCalcAbsUrlOrThrow,t.initCalc=n.config.initCalc,t.initCalcCalled=n.config.initCalcCalled,t.initCalcInThread=n.config.initCalcInThread,t.initCalcThread=n.config.initCalcThread,t.isCalcInit=n.config.isCalcInit,t.maxRetriesForLoadingScript=n.config.maxRetriesForLoadingScript},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var n=r(1);t.randomFloat=n.testUtil.randomFloat,t.randomIndex=n.testUtil.randomIndex,t.randomShuffled=n.testUtil.randomShuffled,t.randomElement=n.testUtil.randomElement},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var n=r(1);t.createArrayLogger=n.arrayLogger.createArrayLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FuncContextMock=void 0;var n=r(188),i=r(16),a=r(117),o=r(26),s=function(){function e(e){this.config=e,this.formatter=(0,n.createNumberFormatter)({config:this.config}),this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"calcingArray",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),e.prototype.applyFunction=function(e,t){throw new Error("Method not implemented.")},e.prototype.applyLambda=function(e,t){throw new Error("Method not implemented.")},e.prototype.handleEvaluationError=function(e){throw new Error("Method not implemented.")},e.prototype.coerceOper=function(e,t){throw new Error("Method not implemented.")},e.prototype.parseGeneral=function(e,t){var r,n=this.formatter.parseGeneral(e,!1,t,a.GetTimeKind.NonVolatile);return(0,o.isSuccess)(n)||(0,i.throwEvaluationError)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.formatter.parseDate(e,a.GetTimeKind.NonVolatile);return(0,o.isSuccess)(r)||(0,i.throwEvaluationError)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getCellFormula=function(e){throw new Error("Method not implemented.")},e.prototype.getSheetIndex=function(e,t){throw new Error("Method not implemented.")},e.prototype.getSheetRangePosition=function(e){throw new Error("Method not implemented.")},e.prototype.getSheetRangeIndexes=function(e){throw new Error("Method not implemented.")},e.prototype.getNameFormula=function(e,t){throw new Error("Method not implemented.")},e.prototype.getCellRef=function(e,t,r,n){throw new Error("Method not implemented.")},e.prototype.getStructRef=function(e,t,r){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpers=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpersAndFormulae=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceOper=function(e,t){throw new Error("Method not implemented.")},e.prototype.dereferenceOpers=function(e,t){throw new Error("Method not implemented.")},e.prototype.isInFilterMode=function(){throw new Error("Method not implemented.")},e.prototype.printFormula=function(e,t){throw new Error("Method not implemented.")},e.prototype.getBinaryOperator=function(e){throw new Error("Method not implemented.")},e.prototype.getUnaryOperator=function(e){throw new Error("Method not implemented.")},e.prototype.parseFormula=function(e,t,r,n){throw new Error("Method not implemented.")},e.prototype.applyFormat=function(e,t,r){throw new Error("Method not implemented.")},e.prototype.getRandom=function(){throw new Error("Method not implemented.")},e.prototype.getTime=function(e){throw new Error("Method not implemented.")},e}();t.FuncContextMock=s},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=void 0;var i=r(34),a=r(448),o=r(449),s=r(450),u=((n={})[i.WorksheetFuncId.TEXTBEFORE]=s.textBefore,n[i.WorksheetFuncId.TEXTAFTER]=s.textAfter,n[i.WorksheetFuncId.TEXTSPLIT]=s.textSplit,n[i.WorksheetFuncId.XMATCH]=o.xmatch,n[i.WorksheetFuncId.XLOOKUP]=o.xlookup,n[i.WorksheetFuncId.TAKE]=a.take,n[i.WorksheetFuncId.DROP]=a.drop,n[i.WorksheetFuncId.CHOOSECOLS]=a.choosecols,n[i.WorksheetFuncId.SEQUENCE]=a.sequence,n[i.WorksheetFuncId.MAP]=a.map,n[i.WorksheetFuncId.FILTER]=a.filter,n[i.WorksheetFuncId.VSTACK]=a.vstack,n[i.WorksheetFuncId.HSTACK]=a.hstack,n);t.nextFuncs={v1:u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hstack=t.vstack=t.filter=t.map=t.drop=t.take=t.rangeOrArrayToVal=t.choosecols=t.sequence=void 0;var n=r(18),i=r(7),a=r(8),o=r(8),s=r(28),u=r(76),l=r(193),c=r(25),d=r(10),p=r(19),m=r(46);t.sequence=function(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],u=e.mathpack,l=(0,i.isMissingOper)(r)?1:u.sfix(r),c=void 0===n||(0,i.isMissingOper)(n)?1:u.sfix(n);if(l<0||l>p.sheetRows||c<0||c>p.sheetRows)return o.valueErrorOper;if((0,m.validateArraySize)(l,c),0===l||0===c)return o.calcErrorOper;for(var d=void 0===a||(0,i.isMissingOper)(a)?u.fromNumber(1):a,f=void 0===s||(0,i.isMissingOper)(s)?u.fromNumber(1):s,g=d,h=[],v=0;v<l;v++){for(var S=[],y=0;y<c;y++)if(S.push(g),!(0,i.isErrorOper)(g)){var F=u.add(g,f);g=(0,i.isErrorOper)(F)?F:u.checkAlmostCancellation(f,F)}h.push(S)}return(0,o.arrayOper)(l,c,h)};t.choosecols=function(e,t){var r=t[0],n=t.slice(1),a=e.mathpack,u=(0,s.refToVal)(e,r,!1);if(!(0,i.isArrayOper)(u))return u;var c=u.opers.map((function(e){var t=e.length,r=[];return n.forEach((function(n){(0,i.isNumberOper)(n)?r.push(e[(0,l.getAbsoluteIndex)(t,a.toNumber(n))]):function(e,t){var r=[];return t.opers.forEach((function(t){t.forEach((function(t){(0,i.isNumberOper)(t)&&r.push(e.toNumber(t))}))})),r}(a,n).forEach((function(n){r.push(e[(0,l.getAbsoluteIndex)(t,n)])}))})),r}));return 0===c.length||0===c[0].length?o.calcErrorOper:(0,o.arrayOper)(c.length,c[0].length,c)};var f=function(){function e(e){this.oper=e;var t=e.ranges[0],r=t.rows,n=t.cols;this.rows=r,this.cols=n}return e.prototype.slice=function(e,t,r,n){var i=this.oper.ranges[0],o=i.row,s=i.col;return(0,a.range3DOper)(this.oper.sheets,(0,p.gridRange)(o+e,s+r,t,n))},e}(),g=function(){function e(e){this.oper=e,this.rows=e.opers.length,this.cols=e.opers[0].length}return e.prototype.slice=function(e,t,r,n){return(0,o.arrayOper)(t,n,this.oper.opers.slice(e,e+t).map((function(e){return e.slice(r,r+n)})))},e}();function h(e){return(0,i.isRangeOper)(e)?e.ranges.length>1?o.valueErrorOper:((0,d.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,i.isSheetIndex)(e.sheets)),e):e}function v(e,t){if((0,c.fastAbs)(e)<t){var r=(0,c.fastAbs)(e);return e<0?{start:t-r,count:r}:{start:0,count:r}}return{start:0,count:t}}function S(e,t){if((0,c.fastAbs)(e)<t){var r=t-(0,c.fastAbs)(e);return e<0?{start:0,count:r}:{start:e,count:r}}return{start:0,count:0}}t.rangeOrArrayToVal=h;t.take=function(e,t){var r=t[0],n=t[1],a=t[2],s=e.mathpack,u=h(r);if(!(0,i.isArrayOper)(u)&&!(0,i.isRangeOper)(u))return u;var l=(0,i.isRangeOper)(u)?new f(u):new g(u),c=(0,i.isMissingOper)(n)?l.rows:s.lfix(n),d=void 0===a||(0,i.isMissingOper)(a)?l.cols:s.lfix(a),p=v(c,l.rows),m=p.start,S=p.count,y=v(d,l.cols),F=y.start,C=y.count;return 0===S||0===C?o.calcErrorOper:l.slice(m,S,F,C)};t.drop=function(e,t){var r=t[0],n=t[1],a=t[2],s=e.mathpack,u=h(r);if(!(0,i.isArrayOper)(u)&&!(0,i.isRangeOper)(u))return u;var l=(0,i.isRangeOper)(u)?new f(u):new g(u),c=(0,i.isMissingOper)(n)?0:s.lfix(n),d=void 0===a||(0,i.isMissingOper)(a)?0:s.lfix(a),p=S(c,l.rows),m=p.start,v=p.count,y=S(d,l.cols),F=y.start,C=y.count;return 0===v||0===C?o.calcErrorOper:l.slice(m,v,F,C)};t.map=function(e,t){var r=(0,s.refToVal)(e,t[t.length-1],!0),n=t.slice(0,t.length-1).map((function(t){return(0,s.refToVal)(e,t,!1)}));if(!n.every(i.isArrayOper))return(0,l.ni)("MAP: Non array input");if(!(r instanceof u.LambdaOper)||0===n.length)return(0,l.ni)("MAP: No lambda or array");var a=n[0],o=a.rows,c=a.cols;return n.every((function(e){return e.rows===o&&e.cols===c}))?(0,s.machineCall)(new s.ArrayMachine(e,o,c,(function(t,i){return e.applyLambda(r,n.map((function(e){return e.opers[t][i]})))}),(function(e){return(0,i.isRangeOper)(e)?(0,l.ni)("MAP: nested range"):(0,i.isArrayOper)(e)?(0,l.ni)("MAP: nested array"):(0,i.isMissingOper)(e)?(0,l.ni)("MAP: nested missing"):e}))):(0,l.ni)("MAP: Bad dimensions")};t.filter=function(e,t){var r=t[0],a=t[1],u=t[2],c=(0,s.refToVal)(e,r,!1),d=(0,s.refToVal)(e,a,!1),p=void 0===u||(0,i.isMissingOper)(u)?o.calcErrorOper:u;return(0,i.isArrayOper)(c)&&(0,i.isArrayOper)(d)?1===d.rows&&d.cols===c.cols?function(e,t,r,a){for(var s=[],u=0,l=0;l<r.length;l++){var c=r[l],d=e.coerceOper(c,n.OperKind.Boolean);if(!(0,i.isBooleanOper)(d))return c;var p=d.value;p&&(s.push(p),u++)}return 0===u?a:(0,o.arrayOper)(t.length,u,t.map((function(e){return e.filter((function(e,t){var r;return null===(r=s[t])||void 0===r||r}))})))}(e,c.opers,d.opers[0],p):1===d.cols&&d.cols===c.cols?function(e,t,r,a){for(var s=[],u=0;u<r.length;u++){var l=r[u],c=e.coerceOper(l,n.OperKind.Boolean);if(!(0,i.isBooleanOper)(c))return l;c.value&&s.push(t[u])}return 0===s.length?a:(0,o.arrayOper)(s.length,s[0].length,s)}(e,c.opers,d.opers.map((function(e){return e[0]})),p):o.valueErrorOper:(0,l.ni)("FILTER: non-array input")};t.vstack=function(e,t){var r=t.map((function(t){return(0,s.refToVal)(e,t,!1)}));if(!r.every(i.isArrayOper))return(0,l.ni)("VSTACK: non array input");for(var n=0,a=0,u=r;a<u.length;a++){(m=u[a]).cols>n&&(n=m.cols)}if(n<1)return(0,l.ni)("VSTACK: Empty array");for(var c=[],d=0,p=r;d<p.length;d++)for(var m,f=0,g=(m=p[d]).opers;f<g.length;f++){for(var h=g[f].slice();h.length<n;)h.push(o.naErrorOper);c.push(h)}return(0,o.arrayOper)(c.length,n,c)};t.hstack=function(e,t){var r,n,a=t.map((function(t){return(0,s.refToVal)(e,t,!1)}));if(!a.every(i.isArrayOper))return(0,l.ni)("HSTACK: non array input");for(var u=0,d=0,p=a;d<p.length;d++){var m=p[d];m.rows>u&&(u=m.rows)}if(u<1)return(0,l.ni)("HSTACK: Empty array");for(var f=[],g=function(e){var t=[];a.forEach((function(r){return(0,c.safePush)(t,e<r.rows?r.opers[e]:Array(r.cols).fill(o.naErrorOper))})),f.push(t)},h=0;h<u;h++)g(h);return(0,o.arrayOper)(u,null!==(n=null===(r=f[0])||void 0===r?void 0:r.length)&&void 0!==n?n:0,f)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlookup=t.xmatch=void 0;var n=r(34),i=r(7),a=r(8),o=r(28),s=r(191),u=r(193);t.xmatch=function(e,t){var r=t[0],l=t[1],c=t[2],d=t[3];if(void 0!==c&&!(0,i.isMissingOper)(c)||void 0!==d&&!(0,i.isMissingOper)(d))return(0,u.ni)("XMATCH: unsupported optional args");if((0,i.isRichOper)(r))return(0,u.ni)("XMATCH: unsupported rich lookup");var p,m=(0,o.refToVal)(e,l,!1),f=(0,s.makeLookupComparer)(e,r);if(!(0,i.isArrayOper)(m))return(0,i.isRangeOper)(m)?(0,u.ni)("XMATCH: range oper"):f(m).sgnT===n.OperatorId.Eq?e.mathpack.fromNumber(1):a.naErrorOper;if(1===m.rows)p=m.opers[0];else{if(1!==m.cols)return(0,u.ni)("XMATCH: non-vector");p=m.opers.map((function(e){return e[0]}))}for(var g=0;g<p.length;g++)if(f(p[g]).sgnT===n.OperatorId.Eq)return e.mathpack.fromNumber(g+1);return a.naErrorOper};t.xlookup=function(e,t){return(0,u.ni)("XLOOKUP: Not implemented")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textAfter=t.textBefore=t.textSplit=void 0;var n=r(10),i=r(7),a=r(8),o=r(193);function s(e){var t=[];if((0,i.isArrayOper)(e))for(var r=e.rows,n=e.cols,a=e.opers,s=0;s<r;s++)for(var u=0;u<n;u++){var l=a[s][u];if(!(0,i.isStringOper)(l))return(0,o.ni)("TEXTSPLIT array with non-text element");t.push(l.value)}else t.push(e.value);return t}function u(e,t){for(var r=[],n=[],i=0;i<e.length;){for(var a=!1,o=0;o<t.length;o++){var s=t[o];s.length>0&&e.startsWith(s,i)&&(r.push(i),n.push(s.length),i+=s.length,a=!0)}a||i++}return{matchStart:r,matchLength:n}}t.textSplit=function(e,t){var r=t[0],u=t[1],l=t[2],c=t[3],d=t[4],p=t[5],m=r.value;if((0,i.isMissingOper)(u)||void 0!==l&&!(0,i.isMissingOper)(l)||void 0!==d&&!(0,i.isMissingOper)(d)||void 0!==p&&!(0,i.isMissingOper)(p))return(0,o.ni)("TEXTSPLIT unsupported arguments");var f=s(u);if(f.some((function(e){return""===e})))return a.valueErrorOper;for(var g=void 0!==c&&!(0,i.isMissingOper)(c)&&c.value,h=[],v=0,S=m;v<S.length;){for(var y=S.length-v,F=!1,C=0;C<f.length;C++){var R=f[C];S.startsWith(R,v)&&(h.push(S.slice(0,v)),S=S.slice(v+R.length),v=0,F=!0)}F?(0,n.assertTrue)("calc.funcs.textsplit: Loop invariant",S.length-v<y):v++}return h.push(S),g&&(h=h.filter((function(e){return 0!==e.length}))),0===h.length?a.calcErrorOper:(0,a.arrayOper)(1,h.length,[h.map(a.stringOper)])};t.textBefore=function(e,t){var r=t[0],n=t[1],l=t[2],c=t[3],d=t[4],p=t[5];if(void 0!==c&&!(0,i.isMissingOper)(c)||void 0!==d&&!(0,i.isMissingOper)(d))return(0,o.ni)("TEXTBEFORE unsupported arguments");var m=r.value,f=s(n),g=void 0===l||(0,i.isMissingOper)(l)?1:Math.floor(e.mathpack.toNumber(l)),h=null!=p?p:a.naErrorOper,v=Math.abs(g);if(0===g||v>m.length||f.every((function(e){return m.length-e.length+1<v})))return a.valueErrorOper;if(f.some((function(e){return 0===e.length})))return(0,a.stringOper)(g<0?m:"");var S=u(m,f).matchStart,y=S[(0,o.getAbsoluteIndexNoClamp)(S.length,g<0?g:g-1)];return void 0===y?h:(0,a.stringOper)(m.slice(0,y))};t.textAfter=function(e,t){var r=t[0],n=t[1],l=t[2],c=t[3],d=t[4],p=t[5];if(void 0!==c&&!(0,i.isMissingOper)(c)||void 0!==d&&!(0,i.isMissingOper)(d))return(0,o.ni)("TEXTAFTER unsupported arguments");var m=r.value,f=s(n),g=void 0===l||(0,i.isMissingOper)(l)?1:Math.floor(e.mathpack.toNumber(l)),h=null!=p?p:a.naErrorOper,v=Math.abs(g);if(0===g||v>m.length||f.every((function(e){return m.length-e.length+1<v})))return a.valueErrorOper;if(f.some((function(e){return 0===e.length})))return(0,a.stringOper)(g<0?"":m);var S=u(m,f),y=S.matchStart,F=S.matchLength,C=(0,o.getAbsoluteIndexNoClamp)(y.length,g<0?g:g-1),R=y[C];return void 0===R?h:(0,a.stringOper)(m.slice(R+F[C]))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecordOper=t.LambdaOper=void 0;var n=r(55);t.LambdaOper=n.value.LambdaOper,t.RecordOper=n.value.RecordOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.machine=t.DerefOperKind=void 0;var n=r(0).__importStar(r(453));t.DerefOperKind=n.DerefOperKind,t.machine=n.machine},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rangeValues=t.machine=t.isRangeValues=t.DerefOperKind=void 0;var n=r(55);t.DerefOperKind=n.extensionTypes.DerefOperKind,t.isRangeValues=n.extensionTypes.isRangeValues,t.machine=n.extensionTypes.machine,t.rangeValues=n.extensionTypes.rangeValues},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRecalcService=void 0;var n=r(0),i=n.__importStar(r(80)),a=r(24),o=r(4),s=r(194),u=r(35),l=r(95),c=r(2),d=r(97),p=r(60),m=r(128),f=r(304);t.createRecalcService=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var g=t[0],h=t[1];return n.__awaiter(this,void 0,void 0,(function(){function t(e){void 0===e&&(e="Requested"),E=e,R.close()}var r,v,S,y,F,C,R,b,E,P,k,T,A,N,_,I=this;return n.__generator(this,(function(O){switch(O.label){case 0:return r="boolean"==typeof g?g?[(new d.PluginSchedulerSingleton).instance(),(new d.GridImportManagerSingleton).instance()]:[void 0,void 0]:[g,h],v=r[0],S=r[1],y=-1/0,F=!1,C={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){y=e},onAlert:function(e){if(!F){var t=document.createElement("div"),r=document.createElement("p");r.textContent=e,t.appendChild(r);var n=document.createElement("button");n.textContent="OK",t.appendChild(n),t.setAttribute("style","position: fixed; top: 0; left: 30%; right: 30%; background: red; color: white; font-size: 16px; font-weight: bold; z-index: 1000; padding: 3em; white-space: pre-line;"),n.onclick=function(){document.body.removeChild(t)},document.body.appendChild(t),F=!0}}},[4,i.createWorker({id:"RecalcService",createMode:e},{local:s.recalcServiceInsideInit,thread:{scriptUrl:(0,m.getCalcAbsUrlOrThrow)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(function(){return C}))];case 1:R=O.sent(),b=[],E="Requested",R.onClose=function(){for(var e=0,t=b;e<t.length;e++){var r=t[e];try{r()}catch(e){o.ulsLogger.ULS.traceTag(539341771,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"calc.calc.createRecalcService.service.onClose: callback threw ".concat((0,u.messageFromError)(e)))}}var n="calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ".concat(E);o.ulsLogger.ULS.traceTag(561534148,a.LogCategory.msoulscat_ES_EWAJS,"Requested"===E?a.TraceLevel.Info:a.TraceLevel.Warning,n)},O.label=2;case 2:return O.trys.push([2,5,,6]),"Thread"!==R.createMode?[3,4]:[4,(0,m.initCalcThread)(R)];case 3:P=O.sent(),b.push((function(){return P.close()})),(0,f.logMissingJSFeatures)(R.call.getMissingJSFeatures),O.label=4;case 4:return R.call.ping.callTimeout=3e4,k=3,T=0,A=function(){},(0,l.promiseLoop)((function(){return n.__awaiter(I,void 0,void 0,(function(){var e,r,s,u,l,d,p;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(n.sent(),R.hasBeenClosed())return[2,void 0];e=R.call.ping.callTimeout,r=(0,c.now)(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,R.call.ping()];case 3:return n.sent(),[3,5];case 4:if(s=n.sent(),!i.WorkerError.isWorkerError(s)||"Timeout"!==s.info.cause)throw s;return u=(0,c.now)()-r,(T+=1)>=k&&t("Unresponsive"),l=R.hasBeenClosed(),d={timeout:e,waitTime:u,timeoutCount:T,hasBeenClosed:l},p="calc.calc.RecalcService: unresponsive; ".concat(JSON.stringify(d)),o.ulsLogger.ULS.traceTag(561534149,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,p),A(e,u,T,l),[2,!0];case 5:return T=0,[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: ".concat((0,u.messageFromError)(e));o.ulsLogger.ULS.traceTag(561534150,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t)})),R.post.updateRanges.onPostMessageError=i.dispatchWorkerError,N={setOnRecalcResults:function(e){C.onRecalcResults=e},setOnUpdateRequest:function(e){C.onUpdateRequest=e},setOnUnresponsive:function(e){A=e},setA1ReferenceStyle:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=R.post).setA1ReferenceStyle.apply(e,t),void 0!==v&&v.doNotify(p.NotificationKind.setA1ReferenceStyle,t)},setLocale:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=R.post).setLocale.apply(e,t),void 0!==v&&v.doNotify(p.NotificationKind.setLocale,t)},setWorkbookProps:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=R.post).setWorkbookProps.apply(e,t),void 0!==v&&v.doNotify(p.NotificationKind.setWorkbookProps,t)},updateSheetNames:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=R.post).updateSheetNames.apply(e,t),void 0!==v&&v.doNotify(p.NotificationKind.updateSheetNames,t)},updateNamedObjects:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=R.post).updateNamedObjects.apply(e,t),void 0!==v&&v.doNotify(p.NotificationKind.updateNamedObjects,t)},setNumberFormats:R.post.setNumberFormats,updateUnusedCells:R.post.updateUnusedCells,updateRanges:R.post.updateRanges,updateArrays:R.post.updateArrays,editRangeFormulas:R.post.editRangeFormulas,editRangeFormats:R.post.editRangeFormats,editArrayFormulas:R.post.editArrayFormulas,editRangePaste:R.post.editRangePaste,resumeRecalc:R.post.resumeRecalc,reconfigure:function(e){var t,r;R.call.ping.callTimeout=null!==(t=e.responsivenessPingTimeout)&&void 0!==t?t:3e4,k=null!==(r=e.responsivenessPingAttempts)&&void 0!==r?r:3,R.post.reconfigure(e)},clearCache:function(){R.post.clearCache(),y=-1/0},testAdvanceState:R.post.testAdvanceState,testResumeRecalc:R.call.testResumeRecalc,close:t,stateIdAvailable:function(e){return e>=y},evalFormula:R.call.evalFormula,evalOnClonedModel:R.call.evalOnClonedModel,localizeEnglishFormula:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=R.call).localizeEnglishFormula.apply(e,t)},createIGridExportEndpoint:function(e,t){return b.push(t),R.call.createIGridExportEndpoint.transfer([e.port],e)}},void 0!==S&&S.onGridExporterCreated(N),[2,N];case 5:throw _=O.sent(),t("Error"),_;case 6:return[2]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(1);t.ivlJoin=n.interval.ivlJoin,t.ivlMeet=n.interval.ivlMeet,t.ivlDistance=n.interval.ivlDistance,t.ivlMeets=n.interval.ivlMeets,t.ivlMeetsOrTouches=n.interval.ivlMeetsOrTouches,t.ivlExcept=n.interval.ivlExcept,t.ivlCompare=n.interval.ivlCompare},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;var n=r(1);t.boundedPareto=n.split.boundedPareto,t.boundedParetoSplitter=n.split.boundedParetoSplitter,t.boundedParetoSetOperations=n.split.boundedParetoSetOperations},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookDocument=void 0;var n=r(11),i=r(2),a=r(78),o=r(30),s=r(20),u=r(5),l=r(39),c=r(293),d=r(295),p=function(){function e(e,t,r,n,i,a,o,s){void 0===i&&(i=new d.PartialWorkbookSheets(e,t)),void 0===s&&(s=new c.PartialWorkbookNameManager(e,t)),this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=i,this.grids=a,this.oldGrids=o,this.nameManager=s}return e.prototype.clone=function(t){var r;if(void 0===t&&(t=a.CloningTarget.Server),this.grids)for(var n in r=(0,i.makeStringMap)(),this.grids){var o=this.grids[n];r[n]=o.clone(t)}return new e(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),r,void 0,this.nameManager.clone())},e.prototype.setClientValue=function(e,t,r){var n=this.getGridById(e.sheet.index);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setClientValue(e.range,t,r))},e.prototype.setClientFormula=function(e,t,r){var n=this.getGridById(e.sheet.index);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setClientFormula(e.range,e.range,t,r))},e.prototype.setRecalcFailure=function(e,t){var r=this.getGridById(e);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getGridById(e);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setRecalcEditTaint(t))},e.prototype.setRecalcValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setRecalcValue(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setEditedFormat(e.range,t))},e.prototype.setClientFormat=function(e,t,r){var n=this.getGridById(e.sheet.index);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setClientFormat(e.range,t,r))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setHiddenRows(t,r))},e.prototype.setHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.setHiddenCols(t,r))},e.prototype.setMergeCell=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.setMergeCell(e.range))},e.prototype.setInFilterMode=function(e,t){var r=this.getGridById(e);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,i,a,o,s,l,c){var d=this.getGridById(t.sheet.index);if(d.kind===u.ResultKind.Failure)return d;var p=void 0!==l&&(0,n.isSheetIndexEqual)(t.sheet,l.sheet)?l.range:void 0;return(0,u.success)(d.value.setCellContents(e,t.set,r,i,a,o,s,p,c))},e.prototype.setRangeFormula=function(e,t,r,i,a,o,s,l){var c=this.getGridById(t.sheet.index);if(c.kind===u.ResultKind.Failure)return c;var d=void 0!==s&&(0,n.isSheetIndexEqual)(t.sheet,s.sheet)?s.range:void 0;return(0,u.success)(c.value.setRangeFormula(e,t.range,r,i,a,o,d,l))},e.prototype.copyRange=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.copyRange(e.range))},e.prototype.pasteRange=function(e,t,r){var n=this.getGridById(e.sheet.index);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.pasteRange(e.range,t,r))},e.prototype.assumeRecalcFinal=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.assumeRecalcFinal(e.set,t))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push((0,s.sheetCellSet)(t.sheetIndex,r.getDirtyEditedCells()))})),e},e.prototype.getNonDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push((0,s.sheetCellSet)(t.sheetIndex,r.getNonDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push((0,s.sheetCellSet)(t.sheetIndex,r.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r,n){return this.nameManager.setNamedObject(e,t,r,n)},e.prototype.setUndefinedNames=function(e){return this.nameManager.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){return this.nameManager.promoteNamedObjects(e,t)},e.prototype.setSheetNames=function(t){for(var r,n,o=null!==(r=this.grids)&&void 0!==r?r:this.oldGrids,s=(0,i.makeStringMap)(),u=0,l=t;u<l.length;u++){var c=l[u].sheetId;s[c]=null!==(n=null==o?void 0:o[c])&&void 0!==n?n:a.PartialWorkbookGrid.create()}return new e(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(t),s,void 0,this.nameManager.setSheetNames(t))},e.prototype.extendServerUnused=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.extendServerUnused(t,r))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t,r){return this.nameManager.getNameLoc(e,t,r)},e.prototype.getNameFormula=function(e,t){return this.nameManager.getNameFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){return this.nameManager.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){return this.nameManager.setRecalcNameFailure(e)},e.prototype.getContainingTable=function(e){var t=this.nameManager.getContainingTable(e);if(t.kind===u.ResultKind.Failure||void 0!==t.value)return t;var r=this.getGridById(e.sheet.index);if(r.kind===u.ResultKind.Failure)return(0,u.failure)((0,n.unavailable)([r.reason]));var i=(0,l.intersectProduct)((0,o.createCellSetFromRange)(e.range),o.availableSetProduct);return(0,l.meetsProduct)(i,r.value.getServerAvailability())?u.successUndefined:(0,u.failure)((0,n.unavailable)([{kind:s.UnavailableKind.ContainingTable,range:e}]))},e.prototype.getNamedRanges=function(e){var t=this.nameManager.getNamedRanges(e);if(t.kind===u.ResultKind.Failure||void 0!==t.value)return t;var r=this.getGridById(e.sheet.index);if(r.kind===u.ResultKind.Failure)return(0,u.failure)((0,n.unavailable)([r.reason]));var i=(0,l.intersectProduct)((0,o.createCellSetFromRange)(e.range),o.availableSetProduct);return(0,l.meetsProduct)(i,r.value.getServerAvailability())?(0,u.success)([]):(0,u.failure)((0,n.unavailable)([{kind:s.UnavailableKind.NamedRanges,range:e}]))},e.prototype.getIntersectingTables=function(e){return this.nameManager.getIntersectingTables(e)},e.prototype.getStructRefColumn=function(e,t){return this.nameManager.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){return this.nameManager.getStructRefSpecialRef(e,t)},e.prototype.getEditedFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedFormula(e.range))},e.prototype.forEachEditedFormula=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachEditedFormula(e.range,t))},e.prototype.getEditedValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedValue(e.range))},e.prototype.forEachEditedValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachEditedValue(e.range,t))},e.prototype.getEditedFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedFormat(e.range))},e.prototype.forEachEditedFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachEditedFormat(e.range,t))},e.prototype.getEditedStyle=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedStyle(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getGridById(e);return t.kind===u.ResultKind.Failure?t:t.value.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?a.hiddennessFullyUnavailable:n.value.getHiddenRows(t,r)},e.prototype.tryGetHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:n.value.tryGetHiddenRows(t,r)},e.prototype.getHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?a.hiddennessFullyUnavailable:n.value.getHiddenCols(t,r)},e.prototype.tryGetHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:n.value.tryGetHiddenCols(t,r)},e.prototype.getMergeCell=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getMergeCell(e.range))},e.prototype.getServerFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerFormat(e.range))},e.prototype.getServerStyle=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerStyle(e.range))},e.prototype.getClientFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getClientFormat(e.range))},e.prototype.getClientValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getClientValue(e.range))},e.prototype.getRecalcValues=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getRecalcValues(e.range))},e.prototype.forEachRecalcValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachRecalcValue(e.range,t))},e.prototype.getServerValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerFormula(e.range))},e.prototype.getClientFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getClientFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getGridById(e);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.allEditedAvailable(e.range))},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===u.ResultKind.Failure?r:(0,u.success)(r.value.forEachRecalcDirty(e.range,t))},e.prototype.hasRecalcDirty=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getGridById(e.sheet.index);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.forEachServerNonBlankCellInSet(t,r))},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===u.ResultKind.Failure?n:(0,u.success)(n.value.forEachEditedCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.sheets.getSheetByName(e);return t.kind===u.ResultKind.Failure||void 0===t.value?t:(0,u.success)(t.value.sheetIndex)},e.prototype.getSheetName=function(e){var t=this.sheets.getSheetById(e);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getGridById(e);return t.kind===u.ResultKind.Failure?t:(0,u.success)(t.value.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){return this.sheets.getSheetRangeIds(e)},e.prototype.getIformat=function(e){return this.formats.getIformat(e)},e.prototype.getIformats=function(){return this.formats.getIformats()},e.prototype.getKnownFormat=function(e){return this.formats.getKnownFormat(e)},e.prototype.getFormatString=function(e){return this.formats.getFormatString(e)},e.prototype.resolveCellStyle=function(e){return this.styles.resolveCellStyle(e)},e.prototype.setNumberFormats=function(e,t){this.formats.setNumberFormats(e,t)},e.prototype.setStyles=function(e,t){this.styles.setStyles(e,t)},e.prototype.setFonts=function(e,t){this.styles.setFonts(e,t)},e.prototype.setFills=function(e,t){this.styles.setFills(e,t)},e.prototype.setBorders=function(e,t){this.styles.setBorders(e,t)},e.prototype.onCellModified=function(e,t){this.forEachSheet((function(r,n){n.onCellModified(e,t)})),this.nameManager.onCellModified(e)},e.prototype.collectGarbage=function(e,t){this.forEachSheet((function(r,n){n.collectGarbage(e,t)})),this.nameManager.collectGarbage(e)},e.prototype.advanceState=function(e,t){this.forEachSheet((function(r,n){n.advanceState(e,t)})),this.nameManager.advanceState(e),this.sheets.advanceState(e),this.oldGrids=this.grids,this.grids=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e,t){t.clearCompiledFormulas()})),this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var e=a.emptyGridStatistics;return this.forEachSheet((function(t,r){return e=(0,a.mergeGridStatistics)(e,r.getStatistics())})),e},e.prototype.getNameStatistics=function(){return this.nameManager.getNameStatistics()},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push({sheetIdx:t.sheetIndex,availableCells:r.getServerAvailability()})})),e},e.prototype.forEachSheet=function(e){var t=this.grids;t&&this.sheets.forEachSheet((function(r,n){var i=t[n];i&&e(r,i)}))},e.prototype.getGridById=function(e){var t=this.grids;if(!t)return(0,u.failure)({kind:s.UnavailableKind.SheetNames});var r=t[e];return void 0===r?(0,u.failure)({kind:s.UnavailableKind.SheetId,document:this.document,sheetId:e}):(0,u.success)(r)},e}();t.PartialWorkbookDocument=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n=r(1);t.makeEmptyTable=n.table.makeEmptyTable,t.entry=n.table.entry},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var n=r(3);t.adjustFormulaOrigin=n.adjust.adjustFormulaOrigin},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialWorkbookFormats=void 0;var n=r(2),i=r(5),a=r(20),o=function(){function e(e){this.iformats=[],this.formatStrings=(0,n.makeStringMap)(),this.knownFormats=e}return e.prototype.clone=function(){var t=this,r=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((function(e){r.iformats[e]=t.iformats[e]})),Object.keys(this.formatStrings).forEach((function(e){r.formatStrings[e]=t.formatStrings[e]})),r},e.prototype.clearCompiledNumberFormats=function(){var e=this;this.iformats.forEach((function(e){e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((function(e){return Number(e)})).forEach((function(t){e.knownFormats[t].reset()})),this.formatStrings=(0,n.makeStringMap)(),Object.keys(this.iformats).map(Number).forEach((function(t){var r=e.iformats[t];e.formatStrings[r.formatString]=t}))},e.prototype.getIformat=function(e){var t=this.iformats[e];return void 0===t?(0,i.failure)({kind:a.UnavailableKind.NumberFormat,iformat:e}):(0,i.success)(t.compiledFormat)},e.prototype.getIformats=function(){return this.iformats},e.prototype.getKnownFormat=function(e){return(0,i.success)(this.knownFormats[e])},e.prototype.getFormatString=function(e){return(0,i.success)(this.formatStrings[e])},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[],this.formatStrings=(0,n.makeStringMap)()),Object.keys(e).map(Number).forEach((function(t){var n=r.iformats[t];void 0!==n&&delete r.formatStrings[n.formatString];var i=e[t];r.iformats[t]=i,r.formatStrings[i.formatString]=t}))},e}();t.PartialWorkbookFormats=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsStopwatchFactory=t.initStopwatch=void 0;var n=r(1);t.initStopwatch=n.stopwatch.initStopwatch,t.ulsStopwatchFactory=n.stopwatch.ulsStopwatchFactory},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityScheduler=t.QueuePos=void 0;var n,i=r(221);!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(n||(t.QueuePos=n={}));var a=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var a,o=null!==(a=this.taskDeqs[e])&&void 0!==a?a:this.taskDeqs[e]=new i.Deque;t===n.Back?o.pushBack(r):o.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(e){var t,r;return void 0!==e?null!==(r=null===(t=this.taskDeqs[e])||void 0===t?void 0:t.getCount())&&void 0!==r?r:0:this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}();t.PriorityScheduler=a},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.PrecisionExperiment=t.PrecisionStopReason=t.PrecisionMessageKind=t.precisionValue=void 0;var a,o,s=r(0),u=r(11),l=r(15),c=r(2),d=r(1),p=r(197),m=r(69),f=r(464),g=r(154),h=r(20),v=r(78),S=r(30),y=r(39),F=r(12),C=r(4),R=r(51),b=r(5),E=r(21),P=r(36),k=r(465),T=r(94),A=r(13);function N(e,t){switch(t.kind){case R.OperKind.Number:return{kind:"n",magnitude:(0,p.anonymizeMagnitude)(e.toNumber(t))};case R.OperKind.String:return{kind:"s"};case R.OperKind.Boolean:return{kind:"b"};case R.OperKind.Error:return{kind:"e",type:(0,F.englishErrorTypeToName)(t.type)};case R.OperKind.Rich:return{kind:"r"};case R.OperKind.Array:return{kind:"a"};case R.OperKind.Blank:return{kind:"z"};default:return(0,C.assertNever)("calc.calc.precisionValue",t)}}function _(e,t){var r=e[t.sheet.index];return void 0!==r&&(0,y.meetsProduct)(r,(0,S.createCellSetFromRange)(t.range))}function I(e,t){var r,n=null!==(r=e[t.sheet.index])&&void 0!==r?r:m.empty;e[t.sheet.index]=(0,y.unionProduct)(n,(0,S.createCellSetFromRange)(t.range))}t.precisionValue=N,function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(a||(t.PrecisionMessageKind=a={})),function(e){e.Success="Success",e.Timeout="Timeout"}(o||(t.PrecisionStopReason=o={}));var O=((n={})[P.OperatorId.Add]=.05,n[P.OperatorId.Sub]=.069,n[P.OperatorId.Eq]=.097,n[P.OperatorId.Mul]=.1,n[P.OperatorId.Div]=.11,n[P.OperatorId.Concat]=.36,n[P.OperatorId.Gt]=.65,n[P.OperatorId.Ne]=.79,n[P.OperatorId.Lt]=.89,n[P.OperatorId.Le]=1.6,n[P.OperatorId.Ge]=1.9,n[P.OperatorId.Percent]=2.9,n[P.OperatorId.At]=6.2,n[P.OperatorId.Pow]=13,n[P.OperatorId.Range]=67,n),M=((i={})[P.WorksheetFuncId.IF]=.076,i[P.WorksheetFuncId.SUM]=.11,i[P.WorksheetFuncId.IFERROR]=.5,i[P.WorksheetFuncId.COUNTIF]=.77,i[P.WorksheetFuncId.AND]=.82,i[P.WorksheetFuncId.VLOOKUP]=1.5,i[P.WorksheetFuncId.AVERAGE]=1.5,i[P.WorksheetFuncId.HOUR]=1.9,i[P.WorksheetFuncId.MINUTE]=1.9,i[P.WorksheetFuncId.TEXT]=2,i[P.WorksheetFuncId.OR]=2,i[P.WorksheetFuncId.NOW]=2.1,i[P.WorksheetFuncId.ISBLANK]=2.3,i[P.WorksheetFuncId.CONCATENATE]=2.6,i[P.WorksheetFuncId.SUMIF]=2.7,i[P.WorksheetFuncId.COUNTIFS]=3.3,i[P.WorksheetFuncId.LEFT]=3.4,i[P.WorksheetFuncId.ISNUMBER]=3.7,i[P.WorksheetFuncId.MID]=3.9,i[P.WorksheetFuncId.COUNTA]=4,i[P.WorksheetFuncId.MONTH]=4.2,i[P.WorksheetFuncId.SECOND]=4.3,i[P.WorksheetFuncId.LEN]=4.9,i[P.WorksheetFuncId.WEEKNUM]=5,i[P.WorksheetFuncId.DAY]=5.2,i[P.WorksheetFuncId.ROUND]=5.4,i[P.WorksheetFuncId.FIND]=5.8,i[P.WorksheetFuncId.NETWORKDAYS]=6.2,i[P.WorksheetFuncId.COUNT]=6.2,i[P.WorksheetFuncId.YEAR]=6.3,i[P.WorksheetFuncId.INT]=6.4,i[P.WorksheetFuncId.RIGHT]=6.7,i[P.WorksheetFuncId.ABS]=7,i[P.WorksheetFuncId.CONCAT]=7.2,i[P.WorksheetFuncId.CHAR]=7.4,i[P.WorksheetFuncId.MAX]=8,i[P.WorksheetFuncId.ROW]=8.1,i[P.WorksheetFuncId.WEEKDAY]=9.1,i[P.WorksheetFuncId.DAYS]=9.2,i[P.WorksheetFuncId.MIN]=9.8,i[P.WorksheetFuncId.SEARCH]=9.8,i[P.WorksheetFuncId.WORKDAY]=11,i[P.WorksheetFuncId.DATEDIF]=12,i[P.WorksheetFuncId.TIME]=13,i[P.WorksheetFuncId.HYPERLINK]=13,i[P.WorksheetFuncId.IFS]=13,i[P.WorksheetFuncId.ISERROR]=13,i[P.WorksheetFuncId.COUNTBLANK]=14,i[P.WorksheetFuncId.TODAY]=14,i[P.WorksheetFuncId.VALUE]=18,i[P.WorksheetFuncId.ROUNDUP]=18,i[P.WorksheetFuncId.MATCH]=19,i[P.WorksheetFuncId.DATE]=20,i[P.WorksheetFuncId.SUBSTITUTE]=20,i[P.WorksheetFuncId.INDIRECT]=22,i[P.WorksheetFuncId.INDEX]=23,i[P.WorksheetFuncId.TRIM]=24,i[P.WorksheetFuncId.UPPER]=25,i[P.WorksheetFuncId.SUMIFS]=28,i[P.WorksheetFuncId.EXACT]=29,i[P.WorksheetFuncId.NOT]=32,i[P.WorksheetFuncId.PRODUCT]=35,i[P.WorksheetFuncId.ROUNDDOWN]=37,i[P.WorksheetFuncId.AVERAGEIF]=38,i[P.WorksheetFuncId.ISTEXT]=40,i[P.WorksheetFuncId.ISOWEEKNUM]=41,i[P.WorksheetFuncId.EOMONTH]=42,i[P.WorksheetFuncId.MROUND]=45,i[P.WorksheetFuncId.COLUMN]=45,i[P.WorksheetFuncId.ROWS]=46,i[P.WorksheetFuncId.TIMEVALUE]=52,i[P.WorksheetFuncId.TRUNC]=53,i[P.WorksheetFuncId.LOOKUP]=59,i[P.WorksheetFuncId.NA]=59,i[P.WorksheetFuncId.DAYS360]=61,i[P.WorksheetFuncId.RANK]=67,i[P.WorksheetFuncId.EDATE]=72,i[P.WorksheetFuncId.MOD]=82,i[P.WorksheetFuncId.OFFSET]=83,i[P.WorksheetFuncId.STDEV]=87,i[P.WorksheetFuncId.SUBTOTAL]=91,i),D=(0,E.binaryVisitor)(s.__assign(s.__assign({},(0,E.constVisitor)(.01)),{nameNode:function(){return 1},operatorNode:function(e){var t;return null!==(t=O[e])&&void 0!==t?t:100},wsfNode:function(e){var t;return null!==(t=M[e])&&void 0!==t?t:100}}),c.fastMax);var w=function(){function e(e){var t,r,n,i,o=this;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=function(e){var t=e.cell,r=e.p;return o.resumeToPledge((function(){return o.docs.evaluate(h.ComputeKind.EditedCell,[t],A.VolatileMode.PrecisionTest)}),r)},this.testPrint=function(e){var t=e.cell,r=e.p;return g.Pledge.try((function(){var e=o.getFormula(t);if(!(0,b.isSuccess)(e))return o.onUnavailableObject(e.reason);var n,i=e.value,s=i[0],u=i[1];if(void 0===u.compiledFmla){var l=o.docs.getServerValue(t);if(!(0,b.isSuccess)(l))return o.onUnavailableObject(l.reason);n=o.docs.renderValueBarText(t,l.value.oper,u.fmla)}else{var c=u.compiledFmla.getValue();n=(0,b.isSuccess)(c)?o.docs.printFormulaBarText(s,u.origin,c.value):c}if((0,b.isSuccess)(n)){var d=(0,p.anonymizeFormulaString)(u.fmla),m=n.value===u.fmla?{expected:d,p:r}:{expected:d,sampled:(0,p.anonymizeFormulaString)(n.value),p:r};o.log.push({kind:a.PrintFormulaStatistics,stats:{samples:[m],failures:[]}})}else o.log.push({kind:a.PrintFormulaStatistics,stats:{samples:[],failures:[n.reason]}})}))},this.config={samplePrecisionEvalRate:null!==(t=e.samplePrecisionEvalRate)&&void 0!==t?t:0,samplePrecisionPrintFormulaRate:null!==(r=e.samplePrecisionPrintFormulaRate)&&void 0!==r?r:0,samplePrecisionPrintValueRate:null!==(n=e.samplePrecisionPrintValueRate)&&void 0!==n?n:0,rngSeed:null!==(i=e.rngSeed)&&void 0!==i?i:0|(0,c.now)()},this.rng=new d.JSF32(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(o.Success)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(o.Timeout)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!1,configurable:!0}),e.prototype.setContext=function(e){var t=this;this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new f.MachineRuntime(this.sampleCells().bind((function(e){var r=e.evalCells,n=e.printCells;return g.Pledge.all(s.__spreadArray(s.__spreadArray([],r.map(t.testEval),!0),n.map(t.testPrint),!0))})).catch((function(e){t.log.push({kind:a.UnhandledFailure,reason:e})})))},e.prototype.step=function(){if(!this.result){var e=this.runtime.step();this.result=e.kind===k.TransitionKind.Break||e.kind===k.TransitionKind.Next?void 0:e}},e.prototype.sampleCells=function(){var e=this,t=[],r=[],n=[];return this.docs.getServerAvailableCells().forEach((function(i){var a=i.sheetIdx;return n.push(g.Pledge.try((function(){e.docs.forEachServerNonBlankCellInSet(a,m.dense,(function(n){var i=(0,l.sheetGridCell)(a,n),o=e.config,s=o.samplePrecisionEvalRate,u=o.samplePrecisionPrintFormulaRate,d=o.samplePrecisionPrintValueRate;if(s>0){var p=e.getWeight(i);void 0!==(f=void 0===p?void 0:s>=1?1:(0,c.fastMin)(1,s*p))&&e.rng.next()<f&&(I(e.sampledSets,i),t.push({cell:i,p:f}))}var m=(0,c.fastMax)(u,d);if(m>0){var f,g=e.rng.next();if(g<m)g<(f=e.isValueCell(i)?d:u)&&r.push({cell:i,p:f})}return!0}))}))),!0})),g.Pledge.all(n).bind((function(){return{evalCells:t,printCells:r}}))},e.prototype.getWeight=function(e){var t=this.getFormula(e);if(!(0,b.isSuccess)(t))return this.onUnavailableObject(t.reason);var r=t.value[1];return void 0!==r.compiledFmla?function(e){return(0,b.isSuccess)(e)?(0,E.reduceBottomUp)(D,e.value):1}(r.compiledFmla.getValue()):void 0},e.prototype.isValueCell=function(e){var t=this.getFormula(e);return(0,b.isSuccess)(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)},e.prototype.resumeToPledge=function(e,t){var r=this;return g.Pledge.try((function(){try{r.p=t;var n=e();return Array.isArray(n)?n:r.resumeToPledge(n.resume,t)}finally{r.p=void 0}}))},e.prototype.getFormula=function(e){var t,r=this.docs.getEditedFormula(e);if(!(0,b.isSuccess)(r))return r;var n=null!==(t=r.value)&&void 0!==t?t:[e.range,v.blankCellGridFormula],i=n[0],a=n[1],o=(0,l.lexicalSourceGrid)(a.lexicalKind,(0,l.sheetGridRange)(e.sheet,i));return(0,b.success)([o,a])},e.prototype.onRangeFailure=function(e,t,r,n,i){var o={samples:[],failures:[t]};this.log.push({kind:a.EvalStatistics,stats:o})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(e){var t=(0,u.unavailable)([e]);this.onUnavailable(t)},e.prototype.onUnavailable=function(e){this.log.push({kind:a.UnhandledFailure,reason:e})},e.prototype.hasWrongPrecedent=function(e){var t=this;return e.cells.some((function(e){return _(t.precisionWrongSets,e)}))},e.prototype.onSetCellValue=function(e,t,r,n,i){var a=this.getFormula(e);if(!(0,b.isSuccess)(a))return this.onUnavailableObject(a.reason);var o=a.value,s=o[0],u=o[1],l=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,s,u,l)},e.prototype.onSetCellValues=function(e,t,r,n,i){var a=this,o=this.getFormula((0,u.sheetGridRangeAnchor)(e));if(!(0,b.isSuccess)(o))return this.onUnavailableObject(o.reason);var s=o.value,c=s[0],d=s[1],p=this.hasWrongPrecedent(r);(0,u.forEachCellInRange)(e.range,(function(r,n,i){return a.logPrecisionResult((0,l.sheetGridCell)(e.sheet,r),t[n][i],c,d,p),!0}))},e.prototype.logPrecisionResult=function(e,t,r,n,i){var o=this.docs.allServerAvailable(e);if(!(0,b.isSuccess)(o))return this.onUnavailableObject(o.reason);if(!0===o.value){var s=this.docs.getServerValue(e);if(!(0,b.isSuccess)(s))return this.onUnavailableObject(s.reason);var u=_(this.sampledSets,e),l=this.precisionResult(t,s.value.oper,r,n,u,i);(function(e){return void 0===e.sampled})(l)||I(this.precisionWrongSets,e);var c={samples:[l],failures:[]};this.log.push({kind:a.EvalStatistics,stats:c})}},e.prototype.precisionResult=function(e,t,r,n,i,a){var o=this.p,s=this.docs.config.mathpack,l=N(s,t),c=this.docs.anonymizeFormula(r,n),d=c[0],m=c[1];if((0,u.isReadOperEqual)(s,e,t,!0))return{expected:l,formula:d,functions:m,root:i,cascaded:a,p:o};var f=N(s,e);if((0,u.isNumberOper)(t)&&(0,u.isNumberOper)(e)){var g=s.toNumber(t),h=s.toNumber(e);return{expected:l,sampled:f,relMagnitude:(0,p.anonymizeMagnitude)(0===g?h:(h-g)/g),formula:d,functions:m,root:i,cascaded:a,p:o}}return{expected:l,sampled:f,formula:d,functions:m,root:i,cascaded:a,p:o}},e.prototype.createResultLogMessage=function(e){var t,r;if(0!==this.log.length||e!==o.Success){for(var n={samples:[],failures:{}},i={samples:[],failures:{}},s={},u=0,l=this.log;u<l.length;u++){var c=l[u];switch(c.kind){case a.EvalStatistics:(t=n.samples).push.apply(t,c.stats.samples);for(var d=0,p=c.stats.failures;d<p.length;d++){var m=p[d];(0,T.incrementFailure)(n.failures,m)}break;case a.PrintFormulaStatistics:(r=i.samples).push.apply(r,c.stats.samples);for(var f=0,g=c.stats.failures;f<g.length;f++){m=g[f];(0,T.incrementFailure)(i.failures,m)}break;case a.UnhandledFailure:(0,T.incrementFailure)(s,c.reason);break;default:(0,C.assertNever)("calc.calc.PrecisionExperiment.createResultMessage",c)}}return["PrecisionExperiment",e,"stateId = ".concat(this.stateId),"evalStats = ".concat(JSON.stringify(n)),"printStats = ".concat(JSON.stringify(i)),"unhandledFailures = ".concat(JSON.stringify(s))].join(", ")}},e}();t.PrecisionExperiment=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.earlyReturn=t.EarlyReturnKind=t.singleReadOperType=t.refToVal=t.readOperType=t.MachineRuntime=t.breakTransition=t.nextTransition=t.callMachineTransition=t.nextOnSuccessReceiver=t.machineCall=t.isMachineCall=t.ThenMachine=t.MachineCallKind=t.ArrayMachine=void 0;var n=r(55);t.ArrayMachine=n.machine.ArrayMachine,t.MachineCallKind=n.machine.MachineCallKind,t.ThenMachine=n.machine.ThenMachine,t.isMachineCall=n.machine.isMachineCall,t.machineCall=n.machine.machineCall,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.callMachineTransition=n.machine.callMachineTransition,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition,t.MachineRuntime=n.machine.MachineRuntime,t.readOperType=n.machine.readOperType,t.refToVal=n.machine.refToVal,t.singleReadOperType=n.machine.singleReadOperType,t.EarlyReturnKind=n.machine.EarlyReturnKind,t.earlyReturn=n.machine.earlyReturn},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakTransition=t.nextTransition=t.nextOnSuccessReceiver=t.callMachineTransition=t.TransitionKind=t.MachineRuntime=t.MachineCycle=t.AllMachine=void 0;var n=r(1);t.AllMachine=n.machine.AllMachine,t.MachineCycle=n.machine.MachineCycle,t.MachineRuntime=n.machine.MachineRuntime,t.TransitionKind=n.machine.TransitionKind,t.callMachineTransition=n.machine.callMachineTransition,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExceLintExperiment=void 0;var n=r(0),i=r(15),a=r(467),o=r(1),s=r(234),u=r(197),l=r(4),c=r(12),d=r(5),p=r(9);var m=function(){function e(e){void 0===e&&(e=75),this.timeLimitMS=e,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.setContext=function(e){var t=e.documents;try{l.ulsLogger.ULS.traceTag(578588694,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var r=function(e){for(var t,r,a,u,l=e.getServerDocument(),c=[],m=0,f=e.getServerAvailableCells();m<f.length;m++){var g=f[m],h="UndefinedSheet";if(void 0!==l){var v=e.getSheetName(l,g.sheetIdx.index);v.kind===d.ResultKind.Success&&(h=v.value)}var S=e.getServerUsedRange(g.sheetIdx);if(S.kind!==d.ResultKind.Failure&&void 0!==S.value){var y=S.value.sheet,F=n.__assign({},S.value.range);F.cols=Math.min(F.cols,75),F.rows=Math.min(F.rows,1e3);for(var C=[],R=[],b=[],E=0,P=F.row,k=F.row+F.rows-1;P<=k;P+=1){for(var T=[],A=[],N=[],_=F.col,I=F.col+F.cols-1;_<=I;_+=1){var O=(0,i.sheetGridCell)(y,(0,i.gridCell)(P,_)),M=e.getServerValue(O),D=M.kind===d.ResultKind.Success?JSON.stringify(M.value):"";A.push(D);var w=e.getServerFormat(O),L=w.kind===d.ResultKind.Success?(0,o.fnv1a)(JSON.stringify(w.value)).toString():"";N.push(L);var x=e.getServerFormula(O),K=x.kind===d.ResultKind.Success?null===(r=null===(t=x.value)||void 0===t?void 0:t[1].compiledFmla)||void 0===r?void 0:r.getValue():void 0,U=(null==K?void 0:K.kind)===d.ResultKind.Success&&null!==(u=null===(a=x.value)||void 0===a?void 0:a[1].fmla)&&void 0!==u?u:"";""!==U&&(E+=1),T.push(U)}C.push(T),R.push(A),b.push(N)}if(0!==E){var B={sheetName:h,usedRangeAddress:(0,s.formatGridRange)(e.config.localeInfo,F,p.RefStyle.A1,h),values:R,formulas:C,styles:b};c.push(B)}}}return{workbookName:"PartialWorkbook",worksheets:c}}(t);this.result=(0,a.detect_errors)(r,void 0,void 0,this.timeLimitMS)}catch(e){this.result="ExceLint experiment crashed with error: ".concat(e)}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var e=this;return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((function(t){var r=e.result.worksheets[t],n=r.exampleFixes.map((function(e,t){var n=r.proposedFixes[t][0],i=e.rangeSizes,a=i.reduce((function(e,t){return e+t}),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:a,sizeOfEachSFRRange:i,redactedFormulaForEachSFR:e.formulas.map(u.anonymizeFormulaString),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),i=n.map((function(e){return e.sizeOfEachSFRRange.length})).reduce((function(e,t){return e+t}),0);return{totalFormulas:r.numFormulaCells,totalSimilarFormulaRanges:i,numberOfAdjacentSFRs:n.length,numberOfAnomalousRanges:r.suspiciousRanges,numberOfCellsInAnomalousRanges:r.suspiciousCells,anomalies:n,elapsedTimeSeconds:r.elapsedTimeSeconds,proposedFixesTimeSeconds:r.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:r.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:r.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:r.exampleFixesTimeSeconds,numCountingTimeSeconds:r.numCountingTimeSeconds,columns:r.columns,rows:r.rows}})).filter((function(e){return e.totalFormulas>0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: ".concat(JSON.stringify(this.report))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.resultLogMessage+" BTW, experiment ran out of time budget"},enumerable:!1,configurable:!0}),e}();t.ExceLintExperiment=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(468);Object.defineProperty(t,"detect_errors",{enumerable:!0,get:function(){return n.detect_errors}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(299),i=r(469),a=r(199),o=r(198);function s(e,t){for(var r=e[0],n=e[1],i=t[0],a=t[1],o=[],s=r;s<=i;s++)for(var u=n;u<=a;u++)o.push([s,u,0]);return o}t.detect_errors=function(e,t,r,u){void 0===u&&(u=1/0),t=null!=t?t:i.Colorize.getFormattingDiscount(),r=null!=r?r:i.Colorize.getReportingThreshold(),o.watchdog.arm(u);for(var l={},c=0,d=e.worksheets.map((function(e){if((0,o.watchdog)("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};var u=e.usedRangeAddress;u=u.replace(/!(!+)/,"!");var l=new a.Timer("excelint"),c=i.Colorize.process_suspicious(u,e.formulas,e.values),d=(c[0],c[1],c[2],c[3]);(0,o.watchdog)("wd0x7919b4");var p=l.elapsedTime(),m=i.Colorize.adjust_proposed_fixes(d,e.styles,0,0),f=l.elapsedTime(),g=m.map((function(e){(0,o.watchdog)("wd0xfb8f16");var n=e[0],a=e[1],s=e[2],u=e[3],l=-n;return u||(l*=(100-t)/100),100*l>=r?(0,i.tuple)(l,a,s,u):null})).filter((function(e){return null!==e})),h=function(e,t){return(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1)},v=l.elapsedTime(),S=g.map((function(t){(0,o.watchdog)("wd0x2375dd");for(var r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",i=[],a=[],s=[],u=[],l=[],c=[],d=[],p=[],m=[],f=t[3],g=[h.apply(void 0,t[1]),h.apply(void 0,t[2])],v=0;v<2;v++){var S=t[v+1][0],y=S[1]-1,F=S[0]-1,C=e.formulas[y][F],R=n.ExcelUtils.numeric_constants(C);l.push(R),c.push(c.reduce((function(e,t){return e+t}),0));var b=n.ExcelUtils.all_cell_dependencies(C,F+1,y+1,!1);d.push(b.length);var E=n.ExcelUtils.formulaToR1C1(C,F+1,y+1),P=n.ExcelUtils.column_index_to_name(F+1)+(y+1)+":",k=P+E;s.push(E),u.push(k),i.push(C),a.push(P+C),p.push((C.match(/\$/g)||[]).length),m.push(b)}var T=Math.abs(c[0]-c[1]),A=[];for(v=0;v<m.length;v++)if(m[v].length>0){if("vertical"===r&&0===m[v][0][0]&&-1===m[v][0][1]){A.push("recurrent-formula");break}if("horizontal"===r&&-1===m[v][0][0]&&0===m[v][0][1]){A.push("recurrent-formula");break}}d[0]!==d[1]&&A.push("different-referent-count"),l[0].length!==l[1].length&&(1===Math.abs(l[0].length-l[1].length)?A.push("one-extra-constant"):A.push("number-of-constants-mismatch")),l[0].length>0&&l[1].length>0&&(d[0]+d[1]===0?A.push("both-constants"):d[0]*d[1]==0&&A.push("one-is-all-constants")),s[0]!==s[1]&&JSON.stringify(m[0].sort())!==JSON.stringify(m[1].sort())&&A.push("r1c1-mismatch"),p[0]!==p[1]&&A.push("absolute-ref-mismatch");for(v=0;v<m.length;v++)if(m[v].length>0&&m[v][0][0]*m[v][0][1]!=0){A.push("off-axis-reference");break}return 0===A.length&&A.push("unclassified"),{bin:A,direction:r,sameFormat:f,rangeSizes:g,numbers:c,sameConstants:l[0]===l[1],numeric_difference:T,magnitude_numeric_difference:0===T?0:Math.log10(T),formulas:a,r1c1formulas:u,dependence_vectors:m}})),y=l.elapsedTime(),F=e.formulas.flat().filter((function(e){return e.length>0})).length,C=e.values.flat().filter((function(e){return e.length>0})).length,R=e.values[0].length,b=e.values.length,E=b*R,P=g.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0),k=g.map((function(e){return(0,o.watchdog)("wd0xbcc23c"),e[0]>=r/100?s(e[1][0],e[1][1]).concat(s(e[2][0],e[2][1])):[]})),T=Array.from(new Set(k.flat(1).map((function(e){return JSON.stringify(e)}))));k=T.map((function(e){return JSON.parse(e)}));var A=l.elapsedTime(),N={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:g,exampleFixes:S,suspiciousRanges:g.length,weightedSuspiciousRanges:P,suspiciousCells:k.length,elapsedTimeSeconds:A/1e3,proposedFixesTimeSeconds:p/1e3,adjustProposedFixesTimeSeconds:(f-p)/1e3,adjustFormatProposedFixesTimeSeconds:(v-f)/1e3,exampleFixesTimeSeconds:(y-v)/1e3,numCountingTimeSeconds:(A-y)/1e3,columns:R,rows:b,totalCells:E,numFormulaCells:F,numValueCells:C};return{name:e.sheetName,out:N}})).filter((function(e){return null!==e.out}));c<d.length;c++){var p=d[c],m=p.name,f=p.out;l[m]=f}return{workbookName:e.workbookName,worksheets:l}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numComparator=t.find_all_proposed_fixes=t.Colorize=t.tuple=void 0;var n=r(299),i=r(470),a=r(199),o=r(471),s=r(472),u=r(198),l=r(473);function c(e,t){if("number"==typeof e)return e-t;e=e,t=t;for(var r=0;r<e.length;r+=1){var n=c(e[r],t[r]);if(0!==n)return n}return 0}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}t.tuple=d;var p=function(){function e(){}return e.setReportingThreshold=function(t){e.reportingThreshold=t},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(t){e.formattingDiscount=t},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(t,r,i){(0,u.watchdog)("wd0xea1170");for(var a=JSON.stringify(n.ExcelUtils.baseVector()),o=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},s=[],l=0;l<t.length;l++){(0,u.watchdog)("wd0xa1597b");for(var c=t[l],d=0;d<c.length;d++){(0,u.watchdog)("wd0x0d7fc8");var p=c[d].toString();if(p.length>0){var m=n.ExcelUtils.all_dependencies(l,d,i+l,r+d,t),f=d+r+1,g=l+i+1;if(0===m.length)"="===p[0]&&s.push([[f,g,0],e.distinguishedZeroHash]);else{var h=m.reduce(o);if(JSON.stringify(h)===a)s.push([[f,g,0],h.toString()]);else{var v=this.hash_vector(h).toString();s.push([[f,g,0],v])}}}}}return s},e.color_all_data=function(t){for(var r=[],n=0,i=Object.keys(t);n<i.length;n++){var a=i[n];(0,u.watchdog)("wd0xc22046");var o=a.split(","),s=Number(o[0]),l=Number(o[1]);r.push([[s,l,0],e.distinguishedZeroHash])}return r},e.process_values=function(t,r,n,i){for(var a=[],o=0;o<t.length;o++){(0,u.watchdog)("wd0x503d57");for(var s=t[o],l=0;l<s.length;l++){(0,u.watchdog)("wd0x366ad1");var c=s[l].toString();if(c.length>0&&"="!==r[o][l][0])if(Number(c).toString()===c){var d=l+n+1,p=o+i+1;a.push([[d,p,1],e.distinguishedZeroHash])}}}return a},e.identify_ranges=function(e,t){for(var r={},n=0,i=e;n<i.length;n++){var a=i[n];(0,u.watchdog)("wd0x770d8c"),r[a[1]]=r[a[1]]||[],r[a[1]].push(a[0])}for(var o=0,s=Object.keys(r);o<s.length;o++){var l=s[o];(0,u.watchdog)("wd0x84ae4d"),r[l].sort(t)}return r},e.group_ranges=function(e,t){var r={},n=0,i=1;t||(n=1,i=0);for(var a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];(0,u.watchdog)("wd0xa372ae"),r[s]=[];for(var l=e[s].shift(),c=l,d=0,p=e[s];d<p.length;d++){var m=p[d];m[n]===c[n]&&m[i]===c[i]+1||(r[s].push([l,c]),l=m),c=m}r[s].push([l,c])}return r},e.identify_groups=function(e){var t=this.identify_ranges(e,(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),r=this.group_ranges(t,!0),n=o.JSONclone.clone(r);return this.merge_groups(n)},e.processed_to_matrix=function(t,r,n,i,a){for(var o=new Array(t),s=0;s<t;s++)o[s]=new Array(r).fill(0);for(var u=0,l=a;u<l.length;u++){var c=l[u],d=c[0],p=d[0],m=d[1],f=d[2],g=c[1],h=m-i-1,v=p-n-1,S=Number(e.distinguishedZeroHash);1===f||(S=Number(g)),o[h][v]=S}return o},e.stencilize=function(e){return s.Stencil.stencil_computation(e,(function(e,t){return e*t}),1)},e.compute_stencil_probabilities=function(e,t,r){for(var n=new Array(e),i=0;i<e;i++)n[i]=new Array(t).fill(0);var a=0,o={};for(i=0;i<e;i++)for(var s=0;s<t;s++)o[r[i][s]]=o[r[i][s]]+1||1,0!==r[i][s]&&(a+=1);for(i=0;i<e;i++)for(s=0;s<t;s++)n[i][s]=o[r[i][s]]/a;var u=0,l=0;for(i=0;i<e;i++)for(s=0;s<t;s++)r[i][s]>0&&(l+=o[r[i][s]]);for(i=0;i<e;i++)for(s=0;s<t;s++)o[r[i][s]]>0&&(u+=this.entropy(o[r[i][s]]/l));Math.log2(a);return n},e.generate_suspicious_cells=function(e,t,r,n,i,a,o){void 0===o&&(o=.01);for(var s=[],u=0,l=0,c=0;c<e;c++)for(var d=0;d<t;d++){var p=d+r+1,m=c+n+1;a[c][d]>0&&(u+=i[c][d],l+=1,a[c][d]<=o&&0!==i[c][d]&&s.push([p,m,a[c][d]]))}var f=u/l;return s.sort((function(e,t){return Math.abs(t[2]-f)-Math.abs(e[2]-f)})),s},e.process_suspicious=function(t,r,i){(0,u.watchdog)("wd0x72fd38");new a.Timer("process_suspicious");var o=n.ExcelUtils.extract_sheet_cell(t),s=(o[0],o[1]),l=n.ExcelUtils.cell_dependency(s,0,0),c=[];r.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):c=e.process_formulas(r,l[0]-1,l[1]-1);var p=[],m=[],f=i.length,g=i[0].length;if(i.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var h=n.ExcelUtils.generate_all_references(r,l[0]-1,l[1]-1);p=e.color_all_data(h),m=e.process_values(i,r,l[0]-1,l[1]-1)}var v=e.identify_groups(p),S=e.identify_groups(c),y=[];return i.length<1e4&&(y=e.find_suspicious_cells(f,g,l,r,c,m,1)),d(y,S,v,e.generate_proposed_fixes(S))},e.entropy=function(e){return-e*Math.log2(e)},e.entropydiff=function(e,t){var r=e+t;return-((this.entropy(e/r)+this.entropy(t/r))/Math.log2(r))},e.fix_metric=function(e,t,r,n){var a=t[0],o=t[1],s=n[0],u=n[1],l=i.RectangleUtils.area([[a[0],a[1],0],[o[0],o[1],0]]),c=i.RectangleUtils.area([[s[0],s[1],0],[u[0],u[1],0]]),d=Math.min(l,c),p=Math.max(l,c),m=Math.min(r,e),f=Math.max(r,e),g=Math.abs(f-m)/this.Multiplier;g<1&&(g=1);var h=(1+this.entropydiff(d,p))/(g*d);return h=-h},e.count_proposed_fixes=function(e){var t=0;for(var r in e){var n=e[r][1],a=n[0],o=n[1],s=e[r][2],u=s[0],l=s[1];t+=i.RectangleUtils.diagonal([[a[0],a[1],0],[o[0],o[1],0]]),t+=i.RectangleUtils.diagonal([[u[0],u[1],0],[l[0],l[1],0]])}return t},e.fix_proposed_fixes=function(t){var r={},n={};for(var i in t){if(t[i][1]>t[i][2]){var a=t[i][1];t[i][1]=t[i][2],t[i][2]=a}r[JSON.stringify(t[i][1])]=t[i],n[JSON.stringify(t[i][2])]=t[i]}var o=[],s={};for(var i in t){var u=t[i][0];if(!(-u<e.reportingThreshold/100)){var l=JSON.stringify(t[i][1]),c=JSON.stringify(t[i][2]);if(l in n||c in r){if(!s[l]&&l in n){var d=[-u*JSON.parse(n[l][0]),t[i][1],n[l][1]];o.push(d),s[l]=!0,s[c]=!0;continue}if(!s[c]&&c in r){d=[-u*JSON.parse(r[c][0]),t[i][1],r[c][2]];o.push(d),s[c]=!0,s[l]=!0}}else o.push(t[i])}}return o},e.generate_proposed_fixes=function(e){var t=f(e);return t.sort(c),t},e.merge_groups=function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];(0,u.watchdog)("wd0x781a33");var i=e[n].slice();e[n]=this.merge_individual_groups(i)}return e},e.merge_individual_groups=function(e){var t=new a.Timer("merge_individual_groups"),r=0;for(e=e.sort();;){(0,u.watchdog)("wd0x0a3668");for(var n=!1,o={},s=[],l=e.slice();l.length>0;)for(var c=l.shift(),d=0;d<l.length;d++)if((0,u.watchdog)("wd0x9cf1d5"),i.RectangleUtils.is_mergeable(c,l[d])){var p=JSON.stringify(c),m=JSON.stringify(l[d]);if(!(p in o)&&!(m in o)){s.push(i.RectangleUtils.bounding_box(c,l[d])),o[p]=!0,o[m]=!0,n=!0;break}}for(d=0;d<e.length;d++)(0,u.watchdog)("wd0x1bc2bb"),JSON.stringify(e[d])in o||s.push(e[d]);if(s.sort(),!n)return s;if(e=s.slice(),++r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(e){var t=0,r=0,n=Math.abs(e[0]-t),i=Math.abs(e[1]-r),a=e[2];return this.Multiplier*(n+i+a)},e.adjust_proposed_fixes=function(e,t,r,n){return e.map((function(e){var i=e[0];if(100*-i<1)return null;for(var a=e[1].map((function(e){return e.toString().padStart(10,"0")})),o=e[2].map((function(e){return e.toString().padStart(10,"0")})),s=a<o?e[1]:e[2],u=a<o?e[2]:e[1],l=s[0],c=l[0],p=l[1],m=s[1],f=(m[0],m[1],u[0]),g=(f[0],f[1],u[1]),h=g[0],v=g[1],S=c-r-1,y=p-n-1,F=h-r-1,C=v-n-1,R=!0,b=JSON.stringify(t[y][S]),E=y;E<=C;E++)for(var P=S;P<=F;P++){if(JSON.stringify(t[E][P])!==b){R=!1;break}}return d(i,s,u,R)})).filter((function(e){return null!==e}))},e.find_suspicious_cells=function(e,t,r,n,i,a,o){return(0,u.watchdog)("wd0x8cabd6"),[]},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();function m(e,t){var r=e[0],n=(e[1],t[0]);t[1];return r[0]!==n[0]?r[0]-n[0]:r[1]-n[1]}function f(e){var t=[],r={};!function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];(0,u.watchdog)("wd0xa287cd"),t[i]=e[i].sort(m).map((function(e,t,r){return[e[0].map((function(e,t,r){return Number(e)})),e[1].map((function(e,t,r){return Number(e)}))]}))}}(e,r);for(var n={},i={},a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];(0,u.watchdog)("wd0xb02b87"),n[s]=r[s].map((function(e,t,r){var n=e[0];e[1];return n})),i[s]=r[s].map((function(e,t,r){e[0];return e[1]}))}var l=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var i=n[r],a=1e6,o=1e6,s=-1e6,u=-1e6,l=0;l<e[i].length;l++){var c=e[i][l][0][0],d=e[i][l][1][0],p=e[i][l][0][1],m=e[i][l][1][1];d>s&&(s=d),c<a&&(a=c),m>u&&(u=m),p<o&&(o=p)}t[i]=[[a,o,0],[s,u,0]]}return t}(e),c=Object.keys(e);g(c,(function(e,t){return l[e][0][0]-l[t][0][0]}));var d=c.map((function(e,t,r){return l[e]})),p=Object.keys(e);g(p,(function(e,t){return l[e][0][1]-l[t][0][1]}));for(var f,S=p.map((function(e,t,r){return l[e]})),y=0,F=Object.keys(e);y<F.length;y++){s=F[y];for(var C=0;C<r[s].length;C++){(0,u.watchdog)("wd0xe37031");var R=v(s,r[s][C],r,c,p,n,i,l,d,S);t=t.concat(R)}}return t=t.map((function(e,t,r){return h(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]]})),f={},t=t.filter((function(e){return!(f[e]=e in f)}))}function g(e,t){for(var r=e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item})),n=0;n<e.length;n+=1)e[n]=r[n];return e}function h(e,t){for(var r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function v(e,t,r,n,i,a,o,s,u,c){var d,m,f,g=t[0],v=t[1],S=[],y=(0,l.binsearch)(u,t,(function(e,t){return e[0][0]-t[0][0]})),F=(0,l.binsearch)(c,t,(function(e,t){return e[0][1]-t[0][1]}));y>F?(d=n,f=y,m=0):(d=i,f=F,m=1),f>0&&(f-=1);for(var C=function(r){var n=d[r];if(n===e)return"continue";var i=s[n];if(0===m){if(v[0]+1<i[0][0])return"break"}else if(v[1]+1<i[0][1])return"break";if(v[0]+1<i[0][0]||v[1]+1<i[0][1]||i[1][0]+1<g[0]||i[1][1]+1<g[1]);else{var u=function(e,t,r,n){var i=e[0],a=e[1],o=t[0],s=t[1],u=[i-1,s,0],c=[o,a-1,0],d=[o+1,a,0],p=[i,s+1,0],m=[],f=-1;if(-1!==(f=(0,l.strict_binsearch)(n,u,h))&&r[f][1]===a){var g=[r[f],n[f]];m.push(g)}if(-1!==(f=(0,l.strict_binsearch)(n,c,h))&&r[f][0]===i){g=[r[f],n[f]];m.push(g)}if(-1!==(f=(0,l.strict_binsearch)(r,d,h))&&n[f][1]===s){g=[r[f],n[f]];m.push(g)}if(-1!==(f=(0,l.strict_binsearch)(r,p,h))&&n[f][0]===o){g=[r[f],n[f]];m.push(g)}return m}(g,v,a[n],o[n]);u.length>0&&(S=S.concat(u.map((function(r,i,a){return[p.fix_metric(parseFloat(e),t,parseFloat(n),r),t,r]}))))}},R=f;R<d.length;R++){if("break"===C(R))break}return S}t.Colorize=p,t.find_all_proposed_fixes=f,t.numComparator=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleUtils=void 0;var n=function(){function e(){}return e.is_adjacent=function(e,t){var r=e[0],n=r[0],i=r[1],a=(r[2],e[1]),o=a[0],s=a[1],u=(a[2],t[0]),l=u[0],c=u[1],d=(u[2],t[1]),p=d[0],m=d[1];d[2];return!(n-p>1||l-o>1||i-m>1||c-s>1)},e.bounding_box=function(e,t){var r=e[0],n=r[0],i=r[1],a=(r[2],e[1]),o=a[0],s=a[1],u=(a[2],t[0]),l=u[0],c=u[1],d=(u[2],t[1]),p=d[0],m=d[1];d[2];return[[Math.min(n,l),Math.min(i,c),0],[Math.max(o,p),Math.max(s,m),0]]},e.area=function(e){var t=e[0],r=t[0],n=t[1],i=(t[2],e[1]),a=i[0],o=i[1];i[2];return(a-r+1)*(o-n+1)},e.diagonal=function(e){var t=e[0],r=t[0],n=t[1],i=(t[2],e[1]),a=i[0],o=i[1],s=(i[2],a-r+1),u=o-n+1;return Math.sqrt(s*s+u*u)},e.overlap=function(e,t){var r=e[0],n=r[0],i=r[1],a=(r[2],e[1]),o=a[0],s=a[1],u=(a[2],t[0]),l=u[0],c=u[1],d=(u[2],t[1]),p=d[0],m=d[1];d[2];return(o>p?p-n+1:o-l+1)*(s>m?m-i+1:s-c+1)},e.is_mergeable=function(t,r){return e.is_adjacent(t,r)&&e.area(t)+e.area(r)-e.overlap(t,r)===e.area(e.bounding_box(t,r))},e}();t.RectangleUtils=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONclone=void 0;var n=function(){function e(){}return e.clone=function(t){if(t){if(Array.isArray(t))return t.slice();if(t.constructor===Object){for(var r={},n=0,i=Object.keys(t);n<i.length;n++){var a=i[n];r[a]=e.clone(t[a])}return r}return t}return null},e}();t.JSONclone=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stencil=t.InfoGain=void 0;var n=function(){function e(){}return e.normalized_entropy=function(e){for(var t=e.reduce((function(e,t){return e+t}),0),r=0,n=0;n<e.length;n++){var i=e[n]/t;0!==i&&(r-=i*Math.log2(i))}return r/Math.log2(t)},e}();t.InfoGain=n;var i=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_left=e.stencil.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_top=e.stencil.filter((function(e){e[0];return e[1]>=0})),e.stencil_bottom=e.stencil.filter((function(e){e[0];return e[1]<=0})),e.stencil_topleft=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_topright=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_bottomleft=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_bottomright=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t<=0})),e.reflectStencils){var t=void 0;t=e.stencil.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_right=e.stencil_right.concat(t),t=e.stencil.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_left=e.stencil_left.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_top=e.stencil_top.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]>0})).map((function(e){return[e[0],-e[1]]})),e.stencil_bottom=e.stencil_bottom.concat(t),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),t=e.stencil_left.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),e.stencil_topleft.splice(e.stencil_topleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,1])})),1),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),t=e.stencil_right.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),e.stencil_topright.splice(e.stencil_topright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t>0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),t=e.stencil_left.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,-1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),t=e.stencil_right.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,-1])})),1)}e.initialized=!0}},e.apply_stencil=function(t,r,n,i,a,o){if(t.length!==e.stencil.length)throw Error("Length mismatched");for(var s=a,u=0;u<t.length;u++){var l=t[u],c=l[0];s=o(s,r[n+l[1]][i+c])}return s},e.stencil_computation=function(t,r,n){e.initialize();for(var i=t.length,a=t[0].length,o=Array(i).fill(0).map((function(){return Array(a).fill(0)})),s=1;s<a-1;s++)for(var u=1;u<i-1;u++)o[u][s]=e.apply_stencil(e.stencil,t,s,u,n,r);for(u=1;u<a-1;u++)o[0][u]=e.apply_stencil(e.stencil_top,t,0,u,n,r),o[i-1][u]=e.apply_stencil(e.stencil_bottom,t,i-1,u,n,r);for(s=1;s<i-1;s++)o[s][0]=e.apply_stencil(e.stencil_left,t,s,0,n,r),o[s][a-1]=e.apply_stencil(e.stencil_right,t,s,a-1,n,r);return o[0][0]=e.apply_stencil(e.stencil_topleft,t,0,0,n,r),o[0][a-1]=e.apply_stencil(e.stencil_topright,t,0,a-1,n,r),o[i-1][0]=e.apply_stencil(e.stencil_bottomleft,t,i-1,0,n,r),o[i-1][a-1]=e.apply_stencil(e.stencil_bottomright,t,i-1,a-1,n,r),o},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();t.Stencil=i},function(e,t,r){"use strict";function n(e,t,r){for(var n=0,i=e.length;n<i;){var a=Math.floor((n+i)/2);r(e[a],t)<0?n=a+1:i=a}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.strict_binsearch=t.binsearch=void 0,t.binsearch=function(e,t,r){return void 0===r&&(r=void 0),void 0===r&&(r=function(e,t){return e===t?0:e<t?-1:1}),n(e,t,r)},t.strict_binsearch=function(e,t,r){void 0===r&&(r=void 0);var i=n(e,t,r);return i===e.length||0!==r(e[i],t)?-1:i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UF=void 0;var n=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(e){var t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t},e.prototype.find=function(e){for(var t=this.roots,r=e;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r},e.prototype.findWithDescriptor=function(e){var t=this.find(e);return[t,this.descriptors[t]]},e.prototype.union=function(e,t,r){void 0===r&&(r=!1);var n=this.find(e),i=this.find(t);if(n!==i){var a=this.roots,o=this.backlinks,s=this.ranks;if(r){var u=o[i];return o[i]=o[n],o[n]=u,a[i]=n,void(s[n]<=s[i]&&(s[n]=s[i]+1))}if(s[n]<s[i]){u=o[n];o[n]=o[i],o[i]=u,a[n]=i}else{u=o[i];o[i]=o[n],o[n]=u,a[i]=n,s[n]===s[i]&&(s[n]+=1)}}},e.prototype.forEachInClass=function(e,t){var r=this.backlinks,n=e;for(t(n);r[n]!==e;)t(n=r[n])},e}();t.UF=n},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange",e[e.Lambda=2]="Lambda",e[e.Other=3]="Other"}(n||(t.DefinedNameInfoType=n={}))},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(n||(t.MajorityDataType=n={}))},function(e,t,r){"use strict";var n,i,a,o,s,u;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef",e[e.NamedOther=110]="NamedOther"}(n||(t.CompletionItemKind=n={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(i||(t.SuggestionKind=i={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(a||(t.DiagnosticSeverity=a={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(o||(t.DiagnosticTag=o={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(s||(t.CodeActionKind=s={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(u||(t.RepairItemPartType=u={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceMode=t.IncompatibilityType=void 0,function(e){e[e.gMove=1]="gMove"}(n||(t.IncompatibilityType=n={})),function(e){e[e.R1C1=0]="R1C1",e[e.A1=1]="A1"}(i||(t.ReferenceMode=i={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(n||(t.Rounding=n={}))},function(e,t,r){"use strict";var n,i,a,o,s,u,l,c,d,p,m,f,g,h;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOrientation=t.RecognizedTablesMetadataState=t.ColumnFormulaSuggestionUpdateKind=t.SchedulerFeature=t.GotoCtrlClickResultKind=t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(n||(t.EditorMessageType=n={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(i||(t.MessageType=i={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"}(a||(t.PluginFactoryName=a={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(o||(t.PluginGroup=o={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(s||(t.PluginAttachGroup=s={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(u||(t.PerCharacterExperimentResultKind=u={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(l||(t.HighlightKind=l={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(c||(t.PositionKind=c={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(d||(t.ValuePreviewResultKind=d={})),function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure"}(p||(t.GotoCtrlClickResultKind=p={})),function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"}(m||(t.SchedulerFeature=m={})),function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"}(f||(t.ColumnFormulaSuggestionUpdateKind=f={})),function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"}(g||(t.RecognizedTablesMetadataState=g={})),function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"}(h||(t.TableOrientation=h={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r(0).__exportStar(r(487),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSampleWithProbability=t.getHistogramBinIndexForDuration=t.updateDurationHistogramsWithRequestTimes=t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS=void 0;var n=r(2),i=r(489);t.REQUEST_DURATION_THRESHOLDS=[5,10,20,50,100,200],t.histogramBinCount=t.REQUEST_DURATION_THRESHOLDS.length+1;var a=new i.JSF32(0);function o(e){for(var r=0;r<t.REQUEST_DURATION_THRESHOLDS.length;r++)if(e<t.REQUEST_DURATION_THRESHOLDS[r])return r;return t.REQUEST_DURATION_THRESHOLDS.length}t.updateDurationHistogramsWithRequestTimes=function(e,r){var i;return(i=r,Object.entries(i)).forEach((function(r){var i,a=r[0],s=r[1];if((0,n.isDefined)(s)&&s.numberOfRequests>0){var u=o(s.requestDuration/s.numberOfRequests),l=null!==(i=e[a])&&void 0!==i?i:Array(t.histogramBinCount).fill(0);l[u]+=s.numberOfRequests,e[a]=l}})),e},t.getHistogramBinIndexForDuration=o,t.addSampleWithProbability=function(e,t,r){return function(e){return e>=0&&e<=1}(r)&&a.next()<r&&e.push(t),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var n=r(1);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return n.JSF32}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeUnavailableCellsStats=void 0;var n=r(20),i=r(30),a=r(11),o=r(39),s=r(2),u=r(69);t.computeUnavailableCellsStats=function(e){for(var t,r,l,c,d,p,m,f=(0,s.makeStringMap)(),g=(0,s.makeStringMap)(),h=0,v=e;h<v.length;h++){var S=v[h],y=S.range;if(S.reason.kind===a.LangReasonKind.Unavailable)for(var F=0,C=S.reason.objects;F<C.length;F++){var R=C[F];R.kind===n.UnavailableKind.GridRange&&((0,a.isSheetIndexEqual)(R.range.sheet,y.sheet)?f[R.range.sheet.index]=(0,o.unionProduct)(null!==(t=f[R.range.sheet.index])&&void 0!==t?t:u.empty,!0!==R.unavailableCells?R.unavailableCells:u.empty):g[R.range.sheet.index]=(0,o.unionProduct)(null!==(r=g[R.range.sheet.index])&&void 0!==r?r:u.empty,!0!==R.unavailableCells?R.unavailableCells:u.empty))}}var b=0,E=0,P=0,k=(0,s.makeStringMap)();for(var T in f){var A=null!==(l=f[T])&&void 0!==l?l:u.empty;k[T]=(0,o.unionProduct)(null!==(c=k[T])&&void 0!==c?c:u.empty,A),(0,i.forEachRangeInSet)(A,(function(e){return b+=e.rows*e.cols,!0}))}for(var T in g){A=null!==(d=g[T])&&void 0!==d?d:u.empty;k[T]=(0,o.unionProduct)(null!==(p=k[T])&&void 0!==p?p:u.empty,A),(0,i.forEachRangeInSet)(A,(function(e){return E+=e.rows*e.cols,!0}))}for(var T in k){A=null!==(m=k[T])&&void 0!==m?m:u.empty;(0,i.forEachRangeInSet)(A,(function(e){return P+=e.rows*e.cols,!0}))}return{numOfUnavailableCellsInTheSameSheet:b,numOfUnavailableCellsInDifferentSheet:E,totalNumOfUnavailableCells:P}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var n=r(1);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return n.mixin}})},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialFormat=void 0,function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"}(n||(t.SpecialFormat=n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockTimerImmediate=t.MockTimer=void 0;var n=r(0),i=r(308),a=r(494),o=r(203),s=function(){function e(e){var t=this;this.nowTimes=e,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(void 0!==t.handle)throw"setImmediate called, even though we already have a callback";return t.setImmediateCalls.push(n.__spreadArray([e],r,!0)),t.handle=(0,o.setImmediateUnified)((function(){return t.handle=void 0,e.apply(void 0,r)}))},this.clearImmediate=function(e){if(t.handle!==e)throw"clearImmediate called with a different handle than the one supplied";(0,o.clearTimerUnified)(t.handle),t.clearImmediateCalls.push([e]),t.handle=void 0},this.setTimeout=function(e,r){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];if(void 0!==t.handle)throw"setTimeout called, even though we already have a callback";return t.setTimeoutCalls.push(n.__spreadArray([e,r],i,!0)),t.handle=(0,o.setImmediateUnified)((function(){return t.handle=void 0,e.apply(void 0,i)}))},this.clearTimeout=function(e){if(t.handle!==e)throw"clearTimeout called with a different handle than the one supplied";(0,o.clearTimerUnified)(t.handle),t.clearTimeoutCalls.push([e]),t.handle=void 0}}return e.prototype.now=function(){var e=this.nowTimes.shift();if(void 0===e)throw"now was called too many times";return e},e}();t.MockTimer=s;var u=function(){function e(t,r){void 0===t&&(t=1),void 0===r&&(r=0);var n=this;this.precisionMs=t,this.startTime=r,this.setImmediate=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a={delayUntil:-1,callback:t,args:r,isValid:!0};return n.queue.enqueue(a),new e.Immediate(a)},this.clearImmediate=function(t){if(!(t instanceof e.Immediate))throw new TypeError("handle is not a MockFullTimer.Immediate");(0,o.clearTimerUnified)(t)},this.setTimeout=function(t,r){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var o=n.time+(r>4?r:4),s={delayUntil:o,callback:t,args:i,isValid:!0};return n.queue.enqueue(s),new e.Timeout(s)},this.clearTimeout=function(t){if(!(t instanceof e.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");(0,o.clearTimerUnified)(t)},this.time=r>0?r:0,this.queue=new i.PriorityQueue((function(e,t){return e.delayUntil-t.delayUntil}))}return e.prototype.preciseNow=function(){return this.time},e.prototype.now=function(){return Math.floor(this.time/this.precisionMs)*this.precisionMs},e.prototype.busyWait=function(e){this.time+=e>0?e:0},e.prototype.busyWaitUntil=function(e){this.time=this.time<e?e:this.time},e.prototype.runMacrotasksWhile=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(e){return setImmediate((function(){return e()}))}))];case 1:if(r.sent(),!e())return[2];if(!(t=this.queue.pop()))return[2];if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback.apply(t,t.args)}catch(e){dispatchEvent(new ErrorEvent("error",{error:e,message:(0,a.messageFromError)(e),filename:"",lineno:0,colno:0}))}return[3,0];case 2:return[2]}}))}))},e.Immediate=function(e){this.delayedCallback=e,this.kind="Mocking"},e.Timeout=function(e){this.delayedCallback=e,this.kind="Mocking"},e}();t.MockTimerImmediate=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(1);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runQueueProcessorUntil=void 0;var n=r(0),i=r(496);t.runQueueProcessorUntil=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,a,o,s=this;return n.__generator(this,(function(u){switch(u.label){case 0:return r=!1,(a=Promise.resolve(t)).then((function(){return r=!0})),o=0,[4,(0,i.promiseLoop)((function(){return n.__awaiter(s,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return++o%100!=0?[3,2]:[4,new Promise((function(e){return setTimeout(e,1)}))];case 1:t.sent(),t.label=2;case 2:return r?[2,void 0]:(e.step(),[2,!0])}}))}))}),!0)];case 1:return u.sent(),[2,a]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promiseLoop=t.promiseFinally=t.newPromise=t.isThenable=t.collapseThenable=t.bindMaybeThenable=t.MaybeThenable=void 0;var n=r(1);t.MaybeThenable=n.promise.MaybeThenable,t.bindMaybeThenable=n.promise.bindMaybeThenable,t.collapseThenable=n.promise.collapseThenable,t.isThenable=n.promise.isThenable,t.newPromise=n.promise.newPromise,t.promiseFinally=n.promise.promiseFinally,t.promiseLoop=n.promise.promiseLoop},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0,function(e){e.doNothing="doNothing",e.setActiveCell="setActiveCell",e.setActiveCellFormat="setActiveCellFormat",e.setFunctionsInfo="setFunctionsInfo",e.setDefinedNamesInfo="setDefinedNamesInfo",e.notifyWorkbookClosing="notifyWorkbookClosing",e.setSchedulerFeatures="setSchedulerFeatures",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination"}(n||(t.NotificationKind=n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockGlobals=void 0;var n=r(499),i=r(500),a=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(){return(0,n.failure)((0,i.notImplemented)(["getDocumentLoc"]))},e.prototype.getSheetIndex=function(){return(0,n.failure)((0,i.notImplemented)(["getSheetIndex"]))},e.prototype.getSheetName=function(){return(0,n.failure)((0,i.notImplemented)(["getSheetName"]))},e.prototype.getNameLoc=function(){return(0,n.failure)((0,i.notImplemented)(["getNameLoc"]))},e.prototype.getUserDefinedFuncLoc=function(){return(0,n.failure)((0,i.notImplemented)(["getUserDefinedFuncLoc"]))},e.prototype.getSheetRangeIndexes=function(){return(0,n.failure)((0,i.notImplemented)(["getSheetRangeIndexes"]))},e.prototype.getContainingTable=function(){return(0,n.failure)((0,i.notImplemented)(["getContainingTable"]))},e.prototype.getStructRefColumn=function(){return(0,n.failure)((0,i.notImplemented)(["getStructRefColumn"]))},e.prototype.getStructRefSpecialRef=function(){return(0,n.failure)((0,i.notImplemented)(["getStructRefSpecialRef"]))},e.prototype.getTime=function(){return(0,n.failure)((0,i.unavailable)(["getTime"]))},e}();t.MockGlobals=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(1);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRangeEqual=t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberLiteralNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanLiteralNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=void 0;var n=r(3);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanLiteralNode=n.util.isBooleanLiteralNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberLiteralNode=n.util.isNumberLiteralNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spanCompare=t.Timeline=t.spanToLSPRange=t.indexToLSPPosition=void 0;var n=r(0),i=r(141),a=r(307),o=r(24),s=r(306),u=r(80);function l(e,t){for(var r=0,n=0;n<t;){var a=e.indexOf("\n",n),o=e.indexOf("\r",n),s=a<0?o:o<0?a:(0,i.fastMin)(a,o);if(s<0||s>=t)break;r+=1,n=s+1+(s===o&&s+1<t&&10===e.charCodeAt(s+1)?1:0)}return{line:r,character:t-n}}t.indexToLSPPosition=l,t.spanToLSPRange=function(e,t,r){return{start:l(e,t),end:l(e,r)}};var c=function(){function e(e,t,r){void 0===r&&(r=!0),this.name=e,this.logThreshold=t,this.enabled=r,this.timestamps=new Map,this.timer=a.defaultTimerInterface,this.workerInfo={isWorkerThread:(0,u.isWorkerThread)(),workerName:(0,u.workerName)()},s.ulsLogger.ULS.traceTag(526223315,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Timeline[".concat(this.name,"]: Initializing, ").concat(JSON.stringify(this.workerInfo)))}return e.prototype.stamp=function(e){this.enabled&&!this.timestamps.has(e)&&this.timestamps.set(e,this.timer.now())},e.prototype.log=function(e){if(this.enabled){this.stamp(e);var t={},r=this.timer.now(),i=0;this.timestamps.forEach((function(e,n){r=Math.min(r,e),i=Math.max(i,e),t[n]=e})),i-r>this.logThreshold&&s.ulsLogger.ULS.traceTag(526234881,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Timeline[".concat(this.name,"]: ").concat(JSON.stringify(n.__assign(n.__assign({},t),this.workerInfo)))),this.timestamps.clear()}},e}();t.Timeline=c,t.spanCompare=function(e,t){var r;return 0!=(r=e.start-t.start)||0!=(r=t.end-e.end)?r:0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoResumeRecalc=t.emptyRangeFormat=t.emptyRangeFormula=t.emptyRangeValue=t.FormulaKind=void 0;var n,i=r(0),a=r(503),o=r(504),s=r(141);!function(e){e.Value="Value",e.CellFormula="CellFormula"}(n||(t.FormulaKind=n={})),t.emptyRangeValue=o.blankOper,t.emptyRangeFormula={kind:n.Value,formulaBarText:"",origin:(0,a.gridCell)(0,0)},(0,s.staticAssertExtends)(),t.emptyRangeFormat=0,t.wrapIntoResumeRecalc=function(e,t){return{evalClonedModelOnSnapshot:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.evalClonedModelOnSnapshot.apply(e,i.__spreadArray([r],n,!1));return t(r),o},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getRangeFormats.apply(e,i.__spreadArray([r],n,!1));return t(r),o},getRangeValues:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getRangeValues.apply(e,i.__spreadArray([r],n,!1));return t(r),o},getRangeFormulae:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getRangeFormulae.apply(e,i.__spreadArray([r],n,!1));return t(r),o},getSheetNames:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getSheetNames.apply(e,i.__spreadArray([r],n,!1));return t(r),o},getIntersectingTables:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getIntersectingTables.apply(e,i.__spreadArray([r],n,!1));return t(r),o},getIformats:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getIformats.apply(e,i.__spreadArray([r],n,!1));return t(r),o},getHiddenRows:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getHiddenRows.apply(e,i.__spreadArray([r],n,!1));return t(r),o},getHiddenCols:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getHiddenCols.apply(e,i.__spreadArray([r],n,!1));return t(r),o},evalFormulaOnSnapshot:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.evalFormulaOnSnapshot.apply(e,i.__spreadArray([r],n,!1));return t(r),o},getCorrespondingSnapshotID:function(t){return e.getCorrespondingSnapshotID(t)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceRange=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(3);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.lexicalSourceRange=n.location.lexicalSourceRange,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(3);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNotifier=void 0;var n=r(0),i=r(2),a=r(2),o=r(60),s=r(48),u=r(48),l=r(506);(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)();var c=[o.NotificationKind.conflictResolverEarlyTermination];var d=(0,i.strEnumArray)(o.NotificationKind).filter((function(e){return c.findIndex((function(t){return t===e}))<0}));t.makeNotifier=function(e){var t,r,i,a=e.doNotify.bind(e),c=(0,u.functionMapFromDUFunction)(a,d),p=(0,u.bindMethodsUnbox)(c,d),m=(0,u.bindMethodsNullCheck)(p,d),f=n.__assign(n.__assign({},m),((t={})[o.NotificationKind.notifyWorkbookClosing]=function(){return p.notifyWorkbookClosing()},t));return r=f,i=l.notificationMethodArgumentsConvertorsMap,(0,s.mapFromArrayOfDependantPairs)(d.map((function(e){return[e,function(t){return r[e].apply(r,i[e](t))}]})))}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.notificationMethodArgumentsConvertorsMap=void 0;var i=r(0),a=r(60),o=r(233),s=r(169),u=r(35),l=r(127),c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},d=function(e){switch(null==e?void 0:e.kind){case"NamedValue":switch(e.value.kind){case"Number":return i.__assign(i.__assign({},e),{value:e.value.numberValue});case"String":return i.__assign(i.__assign({},e),{value:e.value.stringValue});case"Boolean":return i.__assign(i.__assign({},e),{value:e.value.booleanValue});case"Error":return i.__assign(i.__assign({},e),{value:e.value})}default:return e}};t.notificationMethodArgumentsConvertorsMap=((n={})[a.NotificationKind.doNothing]=c,n[a.NotificationKind.setActiveCell]=c,n[a.NotificationKind.setActiveCellFormat]=c,n[a.NotificationKind.setFunctionsInfo]=c,n[a.NotificationKind.setDefinedNamesInfo]=c,n[a.NotificationKind.notifyWorkbookClosing]=c,n[a.NotificationKind.setSchedulerFeatures]=c,n[a.NotificationKind.setA1ReferenceStyle]=c,n[a.NotificationKind.setWorkbookProps]=c,n[a.NotificationKind.updateSheetNames]=c,n[a.NotificationKind.setLocale]=function(){for(var e,t,r,n,a,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];var p=c[0];return[i.__assign(i.__assign({},p),{specialRefNames:(0,u.partialArray)((e={},e[o.SpecialRefId.All]=p.specialRefNames.All,e[o.SpecialRefId.Data]=p.specialRefNames.Data,e[o.SpecialRefId.Headers]=p.specialRefNames.Headers,e[o.SpecialRefId.ThisRow]=p.specialRefNames.ThisRow,e[o.SpecialRefId.Totals]=p.specialRefNames.Totals,e)),currencyFormat:s.CurrencyFormat[p.currencyFormat],dateOrder:s.DateOrder[p.dateOrder],timeAltSeparator:p.timeAltSeparator,pictureSpecial:(0,u.partialArray)((t={},t[l.PictureSpecial.AP1]=p.pictureSpecial.AP1,t[l.PictureSpecial.AP2]=p.pictureSpecial.AP2,t[l.PictureSpecial.AP3]=p.pictureSpecial.AP3,t[l.PictureSpecial.Currency]=p.pictureSpecial.Currency,t[l.PictureSpecial.General]=p.pictureSpecial.General,t[l.PictureSpecial.GeneralOldMAC]=p.pictureSpecial.GeneralOldMAC,t)),pictureSingle:(0,u.partialArray)((r={},r[l.PictureSingle.Sep]=p.pictureSingle.Sep,r[l.PictureSingle.Hash]=p.pictureSingle.Hash,r[l.PictureSingle.Zero]=p.pictureSingle.Zero,r[l.PictureSingle.Decimal]=p.pictureSingle.Decimal,r[l.PictureSingle.Percent]=p.pictureSingle.Percent,r[l.PictureSingle.Comma]=p.pictureSingle.Comma,r[l.PictureSingle.Colon]=p.pictureSingle.Colon,r[l.PictureSingle.DateSep]=p.pictureSingle.DateSep,r[l.PictureSingle.Slash]=p.pictureSingle.Slash,r[l.PictureSingle.Space]=p.pictureSingle.Space,r[l.PictureSingle.Minus]=p.pictureSingle.Minus,r[l.PictureSingle.Plus]=p.pictureSingle.Plus,r[l.PictureSingle.OpenParen]=p.pictureSingle.OpenParen,r[l.PictureSingle.CloseParen]=p.pictureSingle.CloseParen,r[l.PictureSingle.Extra]=p.pictureSingle.Extra,r[l.PictureSingle.Backslash]=p.pictureSingle.Backslash,r[l.PictureSingle.Star]=p.pictureSingle.Star,r[l.PictureSingle.Year]=p.pictureSingle.Year,r[l.PictureSingle.Month]=p.pictureSingle.Month,r[l.PictureSingle.Day]=p.pictureSingle.Day,r[l.PictureSingle.Hour]=p.pictureSingle.Hour,r[l.PictureSingle.Minute]=p.pictureSingle.Minute,r[l.PictureSingle.Second]=p.pictureSingle.Second,r[l.PictureSingle.E]=p.pictureSingle.E,r[l.PictureSingle.APDelim]=p.pictureSingle.APDelim,r[l.PictureSingle.Quote]=p.pictureSingle.Quote,r[l.PictureSingle.ColorStart]=p.pictureSingle.ColorStart,r[l.PictureSingle.ColorEnd]=p.pictureSingle.ColorEnd,r[l.PictureSingle.Text]=p.pictureSingle.Text,r[l.PictureSingle.Question]=p.pictureSingle.Question,r[l.PictureSingle.Underscore]=p.pictureSingle.Underscore,r[l.PictureSingle.Reign]=p.pictureSingle.Reign,r[l.PictureSingle.LocDay]=p.pictureSingle.LocDay,r[l.PictureSingle.Era]=p.pictureSingle.Era,r[l.PictureSingle.EraYear]=p.pictureSingle.EraYear,r[l.PictureSingle.Nen1]=p.pictureSingle.Nen1,r[l.PictureSingle.Gatsu1]=p.pictureSingle.Gatsu1,r[l.PictureSingle.Nichi1]=p.pictureSingle.Nichi1,r[l.PictureSingle.Nen2]=p.pictureSingle.Nen2,r[l.PictureSingle.Gatsu2]=p.pictureSingle.Gatsu2,r[l.PictureSingle.Nichi2]=p.pictureSingle.Nichi2,r[l.PictureSingle.BidiDate]=p.pictureSingle.BidiDate,r[l.PictureSingle.BidiNum]=p.pictureSingle.BidiNum,r[l.PictureSingle.DayTh]=p.pictureSingle.DayTh,r[l.PictureSingle.MonthTh]=p.pictureSingle.MonthTh,r[l.PictureSingle.YearTh]=p.pictureSingle.YearTh,r[l.PictureSingle.EngYearTh]=p.pictureSingle.EngYearTh,r[l.PictureSingle.ThYear]=p.pictureSingle.ThYear,r[l.PictureSingle.HourTh]=p.pictureSingle.HourTh,r[l.PictureSingle.MinuteTh]=p.pictureSingle.MinuteTh,r[l.PictureSingle.SecondTh]=p.pictureSingle.SecondTh,r[l.PictureSingle.ZeroTh]=p.pictureSingle.ZeroTh,r)),pictureColor:(0,u.partialArray)((n={},n[l.PictureColor.Black]=p.pictureColor.Black,n[l.PictureColor.Blue]=p.pictureColor.Blue,n[l.PictureColor.Color]=p.pictureColor.Color,n[l.PictureColor.Cyan]=p.pictureColor.Cyan,n[l.PictureColor.Green]=p.pictureColor.Green,n[l.PictureColor.Magenta]=p.pictureColor.Magenta,n[l.PictureColor.Red]=p.pictureColor.Red,n[l.PictureColor.White]=p.pictureColor.White,n[l.PictureColor.Yellow]=p.pictureColor.Yellow,n)),pictureDbnum:(0,u.partialArray)((a={},a[l.PictureDbnum.DBNUM1]=p.pictureDbnum.DBNUM1,a[l.PictureDbnum.DBNUM2]=p.pictureDbnum.DBNUM2,a[l.PictureDbnum.DBNUM3]=p.pictureDbnum.DBNUM3,a[l.PictureDbnum.DBNUM4]=p.pictureDbnum.DBNUM4,a)),ampmSymbols:[p.ampmSymbols.first,p.ampmSymbols.second]})]},n[a.NotificationKind.updateNamedObjects]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],n=e[1];return[r,n.map((function(e){var t;return i.__assign(i.__assign({},e),{scope:e.scope,objects:null===(t=e.objects)||void 0===t?void 0:t.map((function(e){var t;return i.__assign(i.__assign({},e),{data:d(null!==(t=e.data)&&void 0!==t?t:void 0)})})),fromStateId:e.fromStateId})}))]},n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conflictResolver=void 0;var n=r(0),i=r(2),a=r(29),o=r(6),s=r(6),u=r(4),l=r(86),c=r(310);t.conflictResolver={runTest:p,runExperiment:p,runAuthoringExperiment:p,runPerCharacterExperiment:p,argumentAssistance:m,valuePreview:m,gotoCtrlClick:m,formulaRepair:m,chatGPTQuery:m,columnFormulaSuggestion:m,setCellPrefetch:m,getTranspiledFormulas:m,inCellSuggestion:function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t],a=n[0].factoryName,o=n[1];if(a===s.PluginFactoryName.AutocompleteRangeSuggestionPlugin&&(0,i.isDefined)(o))return o}return null},formulaHighlighting:function(e){var t;if(e.length>0){for(var r=[],n=0,a=e;n<a.length;n++){var o=a[n],s=(o[0],null===(t=o[1].formulaHighlights)||void 0===t?void 0:t.filter(i.isDefined));void 0!==s&&(r=r.concat(s))}return r.sort((function(e,t){return(0,i.isDefined)(e.span)&&(0,i.isDefined)(t.span)?(0,c.spanCompare)(e.span,t.span):(0,i.isDefined)(e)?1:(0,i.isDefined)(t)?-1:0})),{formulaHighlights:r}}return null},functionSuggestion:function(e){var t=[],r=[],a=[],c=void 0;if(e.filter((function(e){return"enum"===v(e[0].factoryName)})).forEach((function(e){e[0];var t=e[1];(0,i.isDefined)(t.items)&&t.items.filter(i.isDefined).filter((function(e){return(0,i.isDefined)(e.textEdit)||(0,i.isDefined)(e.label)})).forEach((function(e){return a.push(n.__assign(n.__assign({},e),{type:o.SuggestionKind.Simple}))}))})),a.length>0)return{items:n.__spreadArray([],a,!0),data:c};for(var p=0,m=e;p<m.length;p++){var f=m[p],g=f[0].factoryName,h=f[1];v(g)===o.SuggestionKind.Smart?((0,i.isDefined)(h.items)&&h.items.filter(i.isDefined).filter((function(e){return(0,i.isDefined)(e.textEdit)||(0,i.isDefined)(e.label)})).forEach((function(e){return t.push(n.__assign(n.__assign({},e),{type:o.SuggestionKind.Smart}))})),(0,i.isDefined)(h.data)&&(c=h.data)):(0,i.isDefined)(h.items)&&h.items.filter(i.isDefined).filter((function(e){return(0,i.isDefined)(e.textEdit)||(0,i.isDefined)(e.label)})).forEach((function(e){return r.push(n.__assign(n.__assign({},e),{type:o.SuggestionKind.Simple}))}))}return{items:n.__spreadArray(n.__spreadArray([],t,!0),r.sort((function(e,t){if((0,i.isDefined)(e.label)&&(0,i.isDefined)(t.label)){if((0,i.isDefined)(e.isPrefixed)&&(0,i.isDefined)(t.isPrefixed)&&e.isPrefixed!==t.isPrefixed)return e.isPrefixed?-1:1;if(d.includes(e.kind)&&d.includes(t.kind)){var r=(0,l.getStructRefCompletionItemRank)(e),n=(0,l.getStructRefCompletionItemRank)(t);if(r!==n)return n-r}return e.label.toLocaleLowerCase()>t.label.toLocaleLowerCase()?1:-1}return(0,i.isDefined)(e.label)?1:(0,i.isDefined)(t.label)?-1:0})),!0),data:c};function v(e){switch(e){case s.PluginFactoryName.AutocompletePlugin:case s.PluginFactoryName.FormulaCollectionPlugin:return o.SuggestionKind.Smart;case s.PluginFactoryName.DragPlugin:case s.PluginFactoryName.SlowTestPlugin:case s.PluginFactoryName.AutocompleteFunctionPlugin:case s.PluginFactoryName.AutocompleteLetPlugin:case s.PluginFactoryName.AutocompleteRichValuePlugin:case s.PluginFactoryName.AutocompleteNamedObjectsPlugin:case s.PluginFactoryName.AutocompleteTableHeadersPlugin:case s.PluginFactoryName.PythonAutocompletePlugin:return o.SuggestionKind.Simple;case s.PluginFactoryName.AutocompleteEnumPlugin:return"enum";default:(0,u.assertNever)("unknown plugin factory name: ".concat(e),e)}}}};var d=[o.CompletionItemKind.TableHeader,o.CompletionItemKind.TableSpecialStructRef];function p(e){for(var t=[],r=0,n=e;r<n.length;r++){var a=n[r],o=(a[0],a[1].results);(0,i.isDefined)(o)&&t.push.apply(t,o.filter(i.isDefined))}return{results:t}}function m(e){if(0===e.length)return null;var t=e[0],r=t[0].factoryName,n=t[1];if(1===e.length)return n;var i=a.pluginFactoryKindMap[r];throw new Error("Conflict resolver: ".concat(i,": ").concat(e.length," results received, while only one active plugin is currently supported"))}(0,i.staticAssertExtends)()},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.customConflictResolverFactories=t.FunctionSuggestionAndArgumentAssistanceConflictResolver=void 0;var i=r(311),a=r(2),o=r(121),s=r(17),u=r(4),l=r(14),c=r(6),d=function(){function e(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.inCellSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.inCellSuggestionSet=!1,this.promise=new o.ResolvablePromise}return e.prototype.consumeResult=function(e){var t;if((0,l.isChangeGateEnabled)("OfficeVSO:7640530_InCellSuggestionRequestResolverEnabledV2"))switch(e.kind){case s.RequestKind.functionSuggestion:(0,u.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0,this.resolvePromiseIfPossible();break;case s.RequestKind.argumentAssistance:(0,u.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0,this.resolvePromiseIfPossible();break;case s.RequestKind.inCellSuggestion:(0,u.assertTrue)("inCellSuggestionSet should be false when receiving inCellSuggestion request",!this.inCellSuggestionSet),this.inCellSuggestionResult=e.result,this.inCellSuggestionSet=!0,this.resolvePromiseIfPossible();break;default:(0,u.assertNever)("unknown result: ".concat(e),e)}else switch(e.kind){case s.RequestKind.functionSuggestion:if((0,u.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),(0,a.isDefined)(e.result)&&(0,a.isDefined)(e.result.items)&&e.result.items.length>0&&(null===(t=e.result.items[e.result.items.length-1])||void 0===t?void 0:t.type)===c.SuggestionKind.Simple)return this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet)return null!==this.argumentAssistanceResult?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null,inCellSuggestion:null});this.functionSuggestionResult=e.result,this.functionSuggestionSet=!0;break;case s.RequestKind.argumentAssistance:if((0,u.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return null!==e.result?this.promise.resolve({functionSuggestion:null,argumentAssistance:e.result,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0;break;case s.RequestKind.inCellSuggestion:break;default:(0,u.assertNever)("unknown result: ".concat(e),e)}},e.create=function(){return new e},e.prototype.resolvePromiseIfPossible=function(){var e,t;if(this.functionSuggestionSet){if((0,a.isDefined)(this.functionSuggestionResult)&&(0,a.isDefined)(this.functionSuggestionResult.items)&&this.functionSuggestionResult.items.length>0)return(null===(e=this.functionSuggestionResult.items[length-1])||void 0===e?void 0:e.type)===c.SuggestionKind.Smart&&((0,u.assertTrue)("can't get argument assistance and smart suggestion at the same time",!this.argumentAssistanceSet||null==this.argumentAssistanceResult),(0,u.assertTrue)("can't get in cell suggestion and smart suggestion at the same time",!this.inCellSuggestionSet||null==(null===(t=this.inCellSuggestionResult)||void 0===t?void 0:t.completionItem))),this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet&&this.inCellSuggestionSet)return this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:this.inCellSuggestionResult})}},e}();t.FunctionSuggestionAndArgumentAssistanceConflictResolver=d,(0,a.staticAssertExtends)(),t.customConflictResolverFactories=((n={})[i.CustomConflictResolverStrategy.FunctionSuggestionAndArgumentAssistance]=d,n),(0,a.staticAssertExtends)()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapRequest=t.wrapSyncRequest=t.InternalSchedulerResponseKind=void 0;var n,i=r(4),a=r(2),o=r(17);function s(e,t){switch(e.kind){case o.ComputationRequestKind.Delay:case o.ComputationRequestKind.CreateTask:case o.ComputationRequestKind.PromiseToTask:case o.ComputationRequestKind.GetActiveCell:case o.ComputationRequestKind.GetActiveCellFormat:case o.ComputationRequestKind.GetConfig:case o.ComputationRequestKind.GetCultureTag:case o.ComputationRequestKind.GetCorrelationId:case o.ComputationRequestKind.GetFunctionInfo:case o.ComputationRequestKind.GetFunctionsInfo:case o.ComputationRequestKind.GetDefinedNameInfo:case o.ComputationRequestKind.GetDefinedNamesInfo:case o.ComputationRequestKind.SetActiveCell:case o.ComputationRequestKind.IsSchedulerFeatureEnabled:case o.ComputationRequestKind.TriggerEvent:return{kind:o.SchedulerTimelineQueueMessageKind.NoOpRequest,request:e,computation:t};case o.ComputationRequestKind.GetSheetNames:case o.ComputationRequestKind.GetAvailableTableHeaders:case o.ComputationRequestKind.ParseCellFormula:case o.ComputationRequestKind.ParseNumberFormat:case o.ComputationRequestKind.PrintFormula:case o.ComputationRequestKind.ParseActiveCell:case o.ComputationRequestKind.ResolveReferences:case o.ComputationRequestKind.UnsafeGetContainingTableName:case o.ComputationRequestKind.UnsafeGetIntersectingTableNames:case o.ComputationRequestKind.GetStructRefColumn:case o.ComputationRequestKind.GetStructRefSpecialRef:return{kind:o.SchedulerTimelineQueueMessageKind.SyncRequest,request:e,computation:t};default:(0,i.assertNever)("unknown request: ".concat(e),e)}}!function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure",e[e.AsyncException=3]="AsyncException"}(n||(t.InternalSchedulerResponseKind=n={})),(0,a.staticAssertExtends)(),t.wrapSyncRequest=s,t.wrapRequest=function(e,t){switch(e.kind){case o.ComputationRequestKind.GetRange:case o.ComputationRequestKind.GetCell:case o.ComputationRequestKind.GetContainingTable:case o.ComputationRequestKind.GetIntersectingTables:case o.ComputationRequestKind.GetIformat:case o.ComputationRequestKind.AwaitPromise:case o.ComputationRequestKind.AwaitTask:case o.ComputationRequestKind.AwaitBatch:case o.ComputationRequestKind.AwaitAll:case o.ComputationRequestKind.AwaitAny:case o.ComputationRequestKind.ParseEdit:case o.ComputationRequestKind.GetRichValueFieldListContext:case o.ComputationRequestKind.GetHiddenRows:case o.ComputationRequestKind.GetHiddenCols:case o.ComputationRequestKind.EvalOnClonedModel:case o.ComputationRequestKind.EvalFormula:case o.ComputationRequestKind.GetCorrespondingSnapshotID:case o.ComputationRequestKind.GetEditFormat:case o.ComputationRequestKind.UpdateSnapshot:case o.ComputationRequestKind.GetFullTableHeadersFromServer:case o.ComputationRequestKind.CreateChatGPTSession:case o.ComputationRequestKind.CloseChatGPTSession:case o.ComputationRequestKind.SendChatGPTQuery:case o.ComputationRequestKind.SendAugLoopSignal:case o.ComputationRequestKind.AwaitEvent:case o.ComputationRequestKind.GetRecognizedRangeTables:return{kind:o.SchedulerTimelineQueueMessageKind.AsyncRequest,request:e,computation:t};default:return s(e,t)}},(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)(),(0,a.staticAssertExtends)()},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.processSyncRequest=t.processRequest=t.requestProcessorMap=void 0;var i=r(0),a=r(2),o=r(95),s=r(95),u=r(5),l=r(12),c=r(15),d=r(162),p=r(161),m=r(17),f=r(11),g=r(47),h=r(143),v=r(22),S=r(98),y=r(511),F=h.X10TaskInternal.createToken();function C(e,t){return e.kind===u.ResultKind.Failure?e:(0,u.success)(t(e.value))}function R(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r;return i.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=u.success,[4,e];case 1:return[2,t.apply(void 0,[n.sent()])];case 2:return r=n.sent(),[2,(0,u.failure)(r)];case 3:return[2]}}))}))}t.requestProcessorMap=((n={})[m.ComputationRequestKind.Delay]=function(){return(0,u.success)({})},n[m.ComputationRequestKind.AwaitPromise]=function(e){var t=e.request.promise;return i.__awaiter(void 0,void 0,void 0,(function(){var e,r;return i.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t];case 1:return e=n.sent(),[2,(0,u.success)({result:e})];case 2:return r=n.sent(),[2,(0,u.failure)(r)];case 3:return[2]}}))}))},n[m.ComputationRequestKind.CreateTask]=function(e){var t=e.request.request,r=e.handle,n=e.schedulerState,i=new h.X10TaskInternal(n.scheduler.processRequest(r,t,{onFulfilled:function(e){if(e.kind!==u.ResultKind.Success)throw{kind:"RequestFailure"};return e.value},onRejected:function(e){throw e}}),F);return(0,u.success)({task:i})},n[m.ComputationRequestKind.PromiseToTask]=function(e){var t=e.request.promise;return(0,u.success)({task:new h.X10TaskInternal(t,F)})},n[m.ComputationRequestKind.AwaitTask]=function(e){var t=e.request.task;return i.__awaiter(void 0,void 0,void 0,(function(){var e,r;return i.__generator(this,(function(n){switch(n.label){case 0:return e=u.success,r={},[4,R(t.resolve(F))];case 1:return[2,e.apply(void 0,[(r.result=n.sent(),r)])]}}))}))},n[m.ComputationRequestKind.AwaitBatch]=function(e){var t=e.request.tasks;return i.__awaiter(void 0,void 0,void 0,(function(){var e,r,n,a,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:e=[],r=0,n=t,i.label=1;case 1:return r<n.length?(a=n[r],s=(o=e).push,[4,R(a.resolve(F))]):[3,4];case 2:s.apply(o,[i.sent()]),i.label=3;case 3:return r++,[3,1];case 4:return[2,(0,u.success)({results:e})]}}))}))},n[m.ComputationRequestKind.AwaitAll]=function(e){var t=e.request.tasks;return i.__awaiter(void 0,void 0,void 0,(function(){var e,r,n;return i.__generator(this,(function(i){switch(i.label){case 0:return e=o.MaybeThenable.all(t.map((function(e){return e.resolve(F)}))),r=u.success,n={},[4,R(e)];case 1:return[2,r.apply(void 0,[(n.result=i.sent(),n)])]}}))}))},n[m.ComputationRequestKind.AwaitAny]=function(e){var t=e.request.tasks;return i.__awaiter(void 0,void 0,void 0,(function(){var e,r,n;return i.__generator(this,(function(i){switch(i.label){case 0:return e=o.MaybeThenable.any(t.map((function(e){return e.resolve(F)}))),r=u.success,n={},[4,R(e)];case 1:return[2,r.apply(void 0,[(n.result=i.sent(),n)])]}}))}))},n[m.ComputationRequestKind.GetCell]=function(e){var t=e.request.cell,r=e.cache;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return void 0===r?[2,(0,u.failure)(void 0)]:[4,r.getCell(t)];case 1:return e=n.sent(),[2,(0,u.success)({result:e})]}}))}))},n[m.ComputationRequestKind.GetContainingTable]=function(e){var t=e.request.cell,r=e.cache;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return void 0===r?[2,(0,u.failure)(void 0)]:[4,r.getContainingTable(t)];case 1:return e=n.sent(),[2,(0,u.success)({result:e})]}}))}))},n[m.ComputationRequestKind.UnsafeGetContainingTableName]=function(e){var t=e.request.cell,r=e.cache;if(void 0===r)return(0,u.failure)(void 0);var n=r.getContainingTableName(t);return(0,u.success)({result:n})},n[m.ComputationRequestKind.GetAvailableTableHeaders]=function(e){var t=e.request.tableName,r=e.cache;if(void 0===r)return(0,u.failure)(void 0);var n=r.getAvailableTableHeaders(t);return(0,u.success)({result:n})},n[m.ComputationRequestKind.GetIntersectingTables]=function(e){var t=e.request.range,r=e.cache;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return void 0===r?[2,(0,u.failure)(void 0)]:[4,r.getIntersectingTables(t)];case 1:return e=n.sent(),[2,(0,u.success)({result:e})]}}))}))},n[m.ComputationRequestKind.UnsafeGetIntersectingTableNames]=function(e){var t=e.request.range,r=e.cache;if(void 0===r)return(0,u.failure)(void 0);var n=r.getIntersectingTableNames(t);return(0,u.success)({result:n})},n[m.ComputationRequestKind.GetRange]=function(e){var t=e.request,r=t.range,n=t.layers,a=e.cache;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:return void 0===a?[2,(0,u.failure)(void 0)]:[4,a.getRange(r,n)];case 1:return e=t.sent(),[2,(0,u.success)({localSheetGrid:e})]}}))}))},n[m.ComputationRequestKind.GetSheetNames]=function(e){var t=e.cache;return void 0===t?(0,u.failure)(void 0):t.getSheetNames()},n[m.ComputationRequestKind.GetStructRefColumn]=function(e){var t=e.request,r=t.table,n=t.nameOrCol,i=e.cache;if(void 0===i)return(0,u.failure)(void 0);var a=i.getStructRefColumn(r,n);return(0,u.success)({result:a})},n[m.ComputationRequestKind.GetStructRefSpecialRef]=function(e){var t=e.request,r=t.table,n=t.id,i=e.cache;if(void 0===i)return(0,u.failure)(void 0);var a=i.getStructRefSpecialRef(r,n);return(0,u.success)({result:a})},n[m.ComputationRequestKind.GetIformat]=function(e){var t=e.request,r=t.document,n=t.iformat,a=e.cache;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:return void 0===a?[2,(0,u.failure)(void 0)]:[4,a.getIformat(r,n)];case 1:return e=t.sent(),[2,(0,u.success)({result:e})]}}))}))},n[m.ComputationRequestKind.ParseCellFormula]=function(e){var t=e.request,r=t.cell,n=t.formula,i=t.useEnglishLocaleInfo,a=e.cache;return void 0===a?(0,u.failure)(void 0):(0,u.success)(a.parseCellFormula(r,n,i))},n[m.ComputationRequestKind.ParseEdit]=function(e){var t=e.request,r=t.cell,n=t.formulaBarText,a=e.cache;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:return void 0===a?[2,(0,u.failure)(void 0)]:(e=u.success,[4,a.parseEdit(r,n)]);case 1:return[2,e.apply(void 0,[t.sent()])]}}))}))},n[m.ComputationRequestKind.ParseActiveCell]=function(e){var t=e.request.formulaText,r=e.schedulerState,n=r.activeCell,i=r.activeCellFormat,o=e.cache;if(void 0===o||(0,a.isNone)(n)||void 0===i)return(0,u.failure)(void 0);var s=null!=i?i:{formatString:"General",builtIn:!0};return(0,u.success)(o.parseEditSync(n,t,s))},n[m.ComputationRequestKind.ParseNumberFormat]=function(e){var t=e.request,r=t.formatString,n=t.builtIn,i=e.cache;return void 0===i?(0,u.failure)(void 0):(0,u.success)(i.parseNumberFormat(r,n))},n[m.ComputationRequestKind.PrintFormula]=function(e){var t=e.request,r=t.formula,n=t.origin,i=e.config;if(void 0===i)return(0,u.failure)([]);var a=(0,d.createPrinter)((0,p.createSimplePrintGlobals)(i)).printFormula((0,p.printLocalsGrid)((0,c.lexicalSourceGrid)(c.LexicalKind.Cell,n),n),r);return(0,u.success)({result:a})},n[m.ComputationRequestKind.GetActiveCell]=function(e){var t=e.schedulerState.activeCell;return void 0===t?(l.ulsLogger.ULS.traceTag(512274723,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,g.x10Logger.formatLogMessage("GetActiveCell",{description:"failed because activeCell was undefined"})),(0,u.failure)(void 0)):(0,u.success)({activeCell:t})},n[m.ComputationRequestKind.GetActiveCellFormat]=function(e){var t=e.schedulerState.activeCellFormat;return void 0===t?(0,u.failure)(void 0):null===t?(0,u.success)({result:(0,u.failure)((0,f.unavailable)(["unavailableFormat"]))}):(0,u.success)({result:(0,u.success)(t)})},n[m.ComputationRequestKind.GetConfig]=function(e){var t=e.config;return void 0===t?(0,u.failure)(void 0):(0,u.success)({config:t})},n[m.ComputationRequestKind.GetCultureTag]=function(e){var t=e.request.lcid,r=(0,y.convertKnownLCID)(t).toString();return-1===r.indexOf("-")?(0,u.failure)(void 0):(0,u.success)({cultureTag:r})},n[m.ComputationRequestKind.GetFunctionsInfo]=function(e){var t=e.schedulerState.functionsInfoMap;if(void 0===t)return l.ulsLogger.ULS.traceTag(512274722,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,g.x10Logger.formatLogMessage("GetFunctionsInfo",{description:"failed because functionsInfoMap was undefined"})),(0,u.failure)(void 0);var r=Object.keys(t).map((function(e){return t[e]}));return(0,u.success)({functionsInfo:r})},n[m.ComputationRequestKind.GetFunctionInfo]=function(e){var t=e.request.functionName,r=e.schedulerState;if(void 0===r.functionsInfoMap)return l.ulsLogger.ULS.traceTag(512274721,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,g.x10Logger.formatLogMessage("GetFunctionInfo",{description:"failed because functionsInfoMap was undefined"})),(0,u.failure)(void 0);var n=r.functionsInfoMap[t.toUpperCase()];return void 0===n?(0,u.failure)(void 0):(0,u.success)({functionInfo:n})},n[m.ComputationRequestKind.GetDefinedNamesInfo]=function(e){var t=e.schedulerState.definedNamesInfoMap;if(void 0===t)return l.ulsLogger.ULS.traceTag(512274720,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,g.x10Logger.formatLogMessage("GetDefinedNamesInfo",{description:"failed because definedNamesInfoMap was undefined"})),(0,u.failure)(void 0);var r=Object.keys(t).map((function(e){return t[e]}));return(0,u.success)({definedNamesInfo:r})},n[m.ComputationRequestKind.GetDefinedNameInfo]=function(e){var t=e.request.definedName,r=e.schedulerState;if(void 0===r.definedNamesInfoMap)return(0,u.failure)(void 0);var n=r.definedNamesInfoMap[t.toUpperCase()];return(0,u.success)({definedNameInfo:n})},n[m.ComputationRequestKind.EvalOnClonedModel]=function(e){var t=e.cache,r=e.request;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return[4,null==t?void 0:t.evalOnClonedModel(r.updates,r.edits,r.formatResults)];case 1:return void 0===(e=n.sent())||e.kind!==u.ResultKind.Success?[2,(0,u.failure)(void 0)]:[2,(0,u.success)({result:e.value})]}}))}))},n[m.ComputationRequestKind.EvalFormula]=function(e){var t=e.cache,r=e.request;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return[4,null==t?void 0:t.evalFormula(r.formula,r.origin,r.format)];case 1:return void 0===(e=n.sent())?[2,(0,u.failure)(void 0)]:e.kind!==u.ResultKind.Success?[2,(0,u.failure)(e.reason)]:[2,(0,u.success)({result:e.value})]}}))}))},n[m.ComputationRequestKind.GetCorrelationId]=function(e){var t=e.correlationId;return(0,u.success)({correlationId:t})},n[m.ComputationRequestKind.SetActiveCell]=function(e){return e.schedulerState=i.__assign(i.__assign({},e.schedulerState),{activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat}),(0,u.success)({})},n[m.ComputationRequestKind.GetRichValueFieldListContext]=function(e){var t=e.schedulerState,r=e.request,n=r.rangeToQuery,o=r.dotNotationPath,s=r.singleColumn,l=r.findRange;return i.__awaiter(void 0,void 0,void 0,(function(){var e,r;return i.__generator(this,(function(i){switch(i.label){case 0:return e=t.serverDataProvider,(0,a.isNone)(e)?[2,(0,u.failure)(void 0)]:[4,e.getRichValueFieldListContext(n,o,s,l)];case 1:return r=i.sent(),(0,v.isTypedChangeGateEnabled)("OfficeVSO:8575821_x10MapGetRichValueFieldListContext")||(0,u.success)({result:r}),[2,(0,u.success)({result:r})]}}))}))},n[m.ComputationRequestKind.GetHiddenRows]=function(e){var t=e.cache,r=e.request;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return void 0===t?[2,(0,u.failure)([])]:[4,t.getHiddenRows(r.sheet,r.start,r.endExclusive)];case 1:return e=n.sent(),[2,(0,u.success)({result:e})]}}))}))},n[m.ComputationRequestKind.GetHiddenCols]=function(e){var t=e.cache,r=e.request;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return void 0===t?[2,(0,u.failure)([])]:[4,t.getHiddenCols(r.sheet,r.start,r.endExclusive)];case 1:return e=n.sent(),[2,(0,u.success)({result:e})]}}))}))},n[m.ComputationRequestKind.ResolveReferences]=function(e){var t=e.cache,r=e.request,n=r.locals,i=r.nodes;if(void 0===t||void 0===n||void 0===i)return(0,u.failure)(void 0);var a=t.resolveReferences(n,i);return(0,u.success)({resolverResults:a})},n[m.ComputationRequestKind.GetCorrespondingSnapshotID]=function(e){var t=e.cache;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(r){switch(r.label){case 0:return void 0===t?[2,(0,u.failure)(void 0)]:[4,t.getCorrespondingSnapshotID()];case 1:return e=r.sent(),[2,(0,u.success)({snapshotID:e})]}}))}))},n[m.ComputationRequestKind.GetEditFormat]=function(e){var t=e.cache,r=e.request.cell;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return void 0===t?[2,(0,u.failure)(void 0)]:[4,t.getEditFormat(r)];case 1:return e=n.sent(),[2,(0,u.success)({result:void 0===e?(0,u.failure)((0,f.unavailable)(["Unavailable Format"])):(0,u.success)(e)})]}}))}))},n[m.ComputationRequestKind.UpdateSnapshot]=function(e){var t=e.handle,r=e.schedulerState;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return[4,r.scheduler.updatePrefetchingCache(t)];case 1:return[2,void 0===(e=n.sent())?(0,u.failure)(void 0):(0,u.success)({snapshotID:e})]}}))}))},n[m.ComputationRequestKind.GetFullTableHeadersFromServer]=function(e){var t=e.schedulerState,r=e.request.tableName;return i.__awaiter(void 0,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(i){switch(i.label){case 0:return e=t.serverDataProvider,(0,a.isNone)(e)?[2,(0,u.failure)(void 0)]:[4,e.getTableColHeaders(r)];case 1:return n=i.sent(),(0,a.isNone)(n)?[2,(0,u.success)({result:[]})]:[2,(0,u.success)({result:n.filter(a.isDefined)})]}}))}))},n[m.ComputationRequestKind.CreateChatGPTSession]=function(e){var t=e.schedulerState.scheduler,r=e.finalizer,n=e.request.options;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(i){switch(i.label){case 0:return void 0===n?[2,(0,u.failure)(void 0)]:[4,t.createChatGPTSession(n)];case 1:return(e=i.sent()).kind===u.ResultKind.Success&&r.subscribe((function(){return t.closeChatGPTSession(e.value)})),[2,C(e,(function(e){return{result:e}}))]}}))}))},n[m.ComputationRequestKind.CloseChatGPTSession]=function(e){var t=e.schedulerState.scheduler,r=e.request.session;return i.__awaiter(void 0,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return void 0===r?[2,(0,u.failure)(void 0)]:(e=C,[4,t.closeChatGPTSession(r)]);case 1:return[2,e.apply(void 0,[n.sent(),function(){return{result:void 0}}])]}}))}))},n[m.ComputationRequestKind.SendChatGPTQuery]=function(e){var t=e.schedulerState.scheduler,r=e.request,n=r.session,a=r.request;return i.__awaiter(void 0,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return void 0===n||void 0===a?[2,(0,u.failure)(void 0)]:[4,t.sendChatGPTQuery(n,a)];case 1:return[2,C(e.sent(),(function(e){return{result:e}}))]}}))}))},n[m.ComputationRequestKind.IsSchedulerFeatureEnabled]=function(e){var t=e.schedulerState.scheduler,r=e.request.feature,n=t.isSchedulerFeatureEnabled(r);return(0,u.success)({isFeatureEnabled:n})},n[m.ComputationRequestKind.SendAugLoopSignal]=function(e){var t=e.schedulerState.scheduler,r=e.handle,n=e.request.signal;return i.__awaiter(void 0,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return void 0===n?[2,(0,u.failure)(void 0)]:[4,t.sendAugLoopSignal(n,r.info.computationIdentifier.factoryName)];case 1:return[2,C(e.sent(),(function(e){return{result:e}}))]}}))}))},n[m.ComputationRequestKind.TriggerEvent]=function(e){var t=e.schedulerState.scheduler,r=e.request,n=r.eventKind,i=r.event;return void 0===n?(0,u.failure)(void 0):(t.triggerEventImmediate(n,i),(0,u.success)({}))},n[m.ComputationRequestKind.AwaitEvent]=function(e){var t=e.schedulerState.scheduler,r=e.request;return i.__awaiter(void 0,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(i){switch(i.label){case 0:return(0,S.isALAnnotationEventKind)(r.eventKind)?[4,t.registerALAnnotation(r.eventKind)]:[3,2];case 1:if((e=i.sent()).kind!==u.ResultKind.Success)return[2,e];i.label=2;case 2:return[4,t.catchEvent(r)];case 3:return n=i.sent(),[2,(0,u.success)({result:n})]}}))}))},n[m.ComputationRequestKind.GetRecognizedRangeTables]=function(e){var t=e.schedulerState.scheduler,r=e.handle,n=e.request,a=n.sheetId,o=n.range,s=n.metadataStates,u=n.maxRevisions;return i.__awaiter(void 0,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return[4,t.getRecognizedTablesInfo(a,o,s,r.info.computationIdentifier.factoryName,u)];case 1:return[2,C(e.sent(),(function(e){return{result:e}}))]}}))}))},n),t.processRequest=function(e,t,r,n,a){var o=r.info.correlationId,l=r.schedulerState,c=r.finalizer,d=e[t.kind],p={request:t,correlationId:o,cache:n,config:a,schedulerState:l,finalizer:c,handle:r},m=d(p);return(0,s.bindMaybeThenable)(m,(function(e){return e.kind!==u.ResultKind.Success?(0,u.failure)(void 0):(r.schedulerState=p.schedulerState,(0,u.success)(i.__assign({kind:t.kind},e.value)))}))},t.processSyncRequest=function(e,t,r,n,a){var o={request:t,correlationId:r.info.correlationId,cache:n,config:a,schedulerState:r.schedulerState,finalizer:r.finalizer,handle:r},s=(0,e[t.kind])(o);return s.kind!==u.ResultKind.Success?(0,u.failure)(void 0):(r.schedulerState=o.schedulerState,(0,u.success)(i.__assign({kind:t.kind},s.value)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBundledLocaleInfo=t.convertKnownLCID=void 0;var n=r(38);t.convertKnownLCID=n.localeData.convertKnownLCID,t.getBundledLocaleInfo=n.localeData.getBundledLocaleInfo},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDataModel=t.MaxStateIdDifferenceForGC=void 0;var n=r(0),i=r(94),a=r(120),o=r(77),s=r(295),u=r(293),l=r(15),c=r(5),d=r(11),p=r(60),m=function(){};t.MaxStateIdDifferenceForGC=17;var f=function(){function e(){this.dataTransformer=new i.RecalcServiceDataTransformer,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new s.PartialWorkbookSheets(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new u.PartialWorkbookNameManager(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.schedulerFeatures=[]}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),e.prototype.getStateAsNotifications=function(){return n.__spreadArray(n.__spreadArray(n.__spreadArray(n.__spreadArray([],this.configNotifications,!0),this.getSheetStateAsNotifications(),!0),this.getNameStateAsNotifications(),!0),this.getSchedulerFeaturesAsNotifications(),!0)},e.prototype.getSchedulerFeaturesAsNotifications=function(){return[[p.NotificationKind.setSchedulerFeatures,[this.schedulerFeatures]]]},e.prototype.getSheetStateAsNotifications=function(){var e=[];return this.sheets.forEachSheet((function(t,r){e.push((0,o.sheetName)(r,t.name))})),e.length>0?[[p.NotificationKind.updateSheetNames,[this.stateId,e]]]:[]},e.prototype.getNameStateAsNotifications=function(){var e=this,t=[],r=function(r){var n=[];r.forEachAvailableName((function(t,r){var i=(0,a.namedObjectToNamedObjectData)(e.config.mathpack,e.dataTransformer.document,null==r?void 0:r.obj);return n.push((0,o.namedObject)(t,i)),!0})),n.length>0&&t.push((0,o.namedObjectsWrite)(r.scope.index,n)),r.allAvailable()&&t.push((0,o.undefinedNamesWrite)(r.scope.index))},n=this.nameManager.getNamesBySheetId(void 0);return(0,c.isSuccess)(n)&&r(n.value),this.nameManager.forEachSheetScope((function(e){r(e)})),t.length>0?[[p.NotificationKind.updateNamedObjects,[this.stateId,t]]]:[]},e.prototype.trySetStateId=function(e,r){if(r<this.stateId)return!1;if(r>this.stateId){var n=this.stateId;if(this.stateId=r,this.sheets.advanceState(n),this.nameManager.advanceState(n),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=t.MaxStateIdDifferenceForGC){this.stateChangesSinceLastGC=0;var i=this.stateId-t.MaxStateIdDifferenceForGC;this.nameManager.collectGarbage(i)}}return!0},e.prototype.clearCompiledFormulas=function(){this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){},e.prototype.setA1ReferenceStyle=function(e){this.configNotifications.push([p.NotificationKind.setA1ReferenceStyle,[e]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,e)},e.prototype.setLocale=function(e){this.configNotifications.push([p.NotificationKind.setLocale,[e]]);this.dataTransformer.setLocaleInfo(this,this.stateId,e,{})},e.prototype.setWorkbookProps=function(e){this.configNotifications.push([p.NotificationKind.setWorkbookProps,[e]]);this.dataTransformer.setWorkbookProps(this,this.stateId,e,{})},e.prototype.updateSheetNames=function(e,t){this.dataTransformer.updateSheetNames(this,e,t,{})},e.prototype.updateNamedObjects=function(e,t){this.dataTransformer.updateNamedObjects(this,e,t,{})},e.prototype.setSchedulerFeatures=function(e){this.schedulerFeatures=e},e.prototype.setLangConfig=function(e,t){if(this.trySetStateId(!0,e)){var r=this.config.localeInfo!==t.localeInfo,n=this.config.refStyle!==t.refStyle;this.config=t,r&&this.clearCompiledNumberFormats(),(r||n)&&this.clearCompiledFormulas()}},e.prototype.setSheetNames=function(e,t,r){this.trySetStateId(!0,r)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))},e.prototype.writeNamedObject=function(e,t,r,n){if(this.trySetStateId(!0,e)){var i=this.nameManager.setNamedObject(!0,(0,l.nameLoc)(t,r),n,m);(0,c.isSuccess)(i)}},e.prototype.writeUndefinedNames=function(e,t){if(this.trySetStateId(!0,e)){var r=this.nameManager.setUndefinedNames(t);(0,c.isSuccess)(r)}},e.prototype.promoteNamedObjects=function(e,t,r){if(this.trySetStateId(!0,e)){var n=this.nameManager.promoteNamedObjects(t,r);(0,c.isSuccess)(n)&&n.value}},e.prototype.getDocumentLoc=function(e,t){var r=this.dataTransformer.document;return void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?(0,c.failure)((0,d.unavailable)([(0,l.documentLoc)(e,t)])):(0,c.success)(r)},e.prototype.getSheetIndex=function(e,t){var r=this.sheets.getSheetByName(t);return(0,c.isSuccess)(r)?void 0===r.value?r:(0,c.success)(r.value.sheetIndex.index):r},e.prototype.getSheetName=function(e,t){var r=this.sheets.getSheetById(t);return(0,c.isSuccess)(r)?(0,c.success)(r.value.name):r},e.prototype.getNameLoc=function(e,t,r){return this.nameManager.getNameLoc(e.index,t,r)},e.prototype.getUserDefinedFuncLoc=function(e,t){return(0,c.failure)((0,d.notImplemented)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){return this.sheets.getSheetRangeIds(e)},e.prototype.getContainingTable=function(e){return this.nameManager.getContainingTable(e)},e.prototype.getStructRefColumn=function(e,t){return this.nameManager.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){return this.nameManager.getStructRefSpecialRef(e,t)},e.prototype.getTime=function(){return(0,c.failure)((0,d.unavailable)(["getTime"]))},e}();t.SyncDataModel=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExcelOnlineCalcNewPackagesNames=void 0;var n=r(1),i=r(3),a=r(37),o=r(38),s=r(55),u=r(315),l="".concat(n.PackageName,", ").concat(i.PackageName,",\n  ").concat(a.PackageName,", ").concat(o.PackageName,", ").concat(s.PackageName,", ").concat(u.PackageName);t.getExcelOnlineCalcNewPackagesNames=function(){return l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTService=void 0;var n=r(0),i=r(2),a=r(5),o=function(){function e(e){this.provider=e,this.set=new Set}return e.prototype.createSession=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,this.provider.openChat(e)];case 1:return t=r.sent(),(0,i.isDefined)(t)?(this.set.add(t),[2,(0,a.success)(t)]):[2,(0,a.failure)(void 0)]}}))}))},e.prototype.closeSession=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:if(!this.set.has(e))return[2,(0,a.failure)(void 0)];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.provider.close(e)];case 2:return t.sent(),this.set.delete(e),[2,(0,a.success)(void 0)];case 3:return t.sent(),[2,(0,a.failure)(void 0)];case 4:return[2]}}))}))},e.prototype.request=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:if(!this.set.has(e))return[2,(0,a.failure)(void 0)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.provider.send(e,t)];case 2:return r=n.sent(),[2,(0,a.success)(r)];case 3:return n.sent(),[2,(0,a.failure)(void 0)];case 4:return[2]}}))}))},e}();t.ChatGPTService=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputationFinalizer=void 0;var n=r(0),i=r(12),a=r(143),o=r(516),s=r(4),u=r(47),l=r(17),c=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.subject=new a.Subject,this.isClosed=!1;for(var r=0,n=e;r<n.length;r++){var i=n[r];this.subscribe(i)}}return e.prototype.subscribe=function(e){if(!this.isClosed)return this.subject.subscribe(e);i.ulsLogger.ULS.traceTag(509109123,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,u.x10Logger.formatLogMessage("PluginFinalizer",{description:"subscription for a closed finalizer was requested"}))},e.prototype.finalize=function(e,t){var r=this.extractComputationInfo(e);t===l.ExecutionStopReason.Unknown&&i.ulsLogger.ULS.traceTag(509109122,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,u.x10Logger.formatLogMessage("PluginFinalizer",{description:"finalize was invoked with an unknown stop reason",data:r})),this.isClosed?i.ulsLogger.ULS.traceTag(509109121,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,u.x10Logger.formatLogMessage("PluginFinalizer",{description:"finalizer was invoked more than once",data:n.__assign({stopReason:t},r)})):(this.isClosed=!0,this.finalizeComputationGeneratorExecution(e,t),this.subject.next({computationInfo:r,stopReason:t}))},e.prototype.finalizeComputationGeneratorExecution=function(e,t){switch(t){case l.ExecutionStopReason.Unknown:case l.ExecutionStopReason.Frame.Timeout:case l.ExecutionStopReason.Frame.Superseded:case l.ExecutionStopReason.Frame.ConflictResolverEarlyTermination:var r=!1;try{e.generator.throw(new o.X10ExceptionComputationTermination(t))}catch(n){r=!0,n instanceof o.X10ExceptionComputationTermination&&n.stopReason&&(null==n?void 0:n.stopReason)!==t&&i.ulsLogger.ULS.traceTag(508903693,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,u.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation threw an exception during execution",data:e.info}))}finally{i.ulsLogger.ULS.assertTag(508903692,i.LogCategory.msoulscat_ES_EWAJS,r,u.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation terminated by x10 with exception but did not threw the exception back",data:e.info}))}break;case l.ExecutionStopReason.Computation.Done:case l.ExecutionStopReason.Computation.Skipped:case l.ExecutionStopReason.Computation.Exception:break;default:(0,s.assertNever)("Unknown stopReason",t)}},e.prototype.extractComputationInfo=function(e){var t,r,n=e.info;for(var i in n.totalRuntime=e.info.computationTime,e.info.requestTimes)n.totalRuntime+=null!==(r=null===(t=e.info.requestTimes[i])||void 0===t?void 0:t.requestDuration)&&void 0!==r?r:0;return n},e}();t.ComputationFinalizer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10ExceptionComputationTermination=t.X10Exception=void 0;var n=r(0),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t}(Error);t.X10Exception=i;var a=function(e){function t(t){var r=e.call(this,"Computation execution was terminated with '".concat(t,"'."))||this;return r.stopReason=t,r}return n.__extends(t,e),t}(i);t.X10ExceptionComputationTermination=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AugLoopService=void 0;var n=r(0),i=r(5),a=r(2),o=r(6),s=r(518),u=r(206),l=r(48),c=r(13),d=function(){function e(e){var t=this;this.augLoopInterop=e,this.registerAnnotationCallbacks=(0,l.mapFromArrayOfDependantPairs)((0,a.strEnumArray)(u.ALAnnotationKind).map((function(e){return[e,new c.ResettableLazy((function(){return n.__awaiter(t,void 0,void 0,(function(){var t,r,a;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=s.AnnotationDefinitionsMap[e],[4,this.augLoopInterop.registerOnAnnotation(u.ALAnnotationKind[e],t.annotationName,t.featureName,t.isModelRequired)];case 1:return r=n.sent(),[2,(0,i.success)(r)];case 2:return a=n.sent(),[2,(0,i.failure)(a)];case 3:return[2]}}))}))}))]})))}return e.prototype.registerALAnnotation=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,t=this.registerAnnotationCallbacks[e].getValue()];case 1:return"Failure"===r.sent().kind&&this.registerAnnotationCallbacks[e].reset(),[2,t]}}))}))},e.prototype.sendSignal=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,u;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.augLoopInterop.sendSignal(e,"".concat(s.alFeatureNamePrefix,"_").concat(o.PluginFactoryName[t]))];case 1:return r=n.sent(),(0,a.isDefined)(r)?[2,(0,i.success)(r)]:[2,(0,i.failure)(r)];case 2:return u=n.sent(),[2,(0,i.failure)(u)];case 3:return[2]}}))}))},e}();t.AugLoopService=d},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationDefinitionsMap=t.RegisterAnnotation=t.alFeatureNamePrefix=void 0;var a=r(565),o=r(2),s=r(206),u=r(48);t.alFeatureNamePrefix="x10";var l=((n={})[s.ALAnnotationKind.FormulaByExample]={annotationType:a.FormulaByExampleAnnotation,isModelRequired:!1},n);t.RegisterAnnotation=((i={})[s.ALAnnotationKind.FormulaByExample]=!0,i),t.AnnotationDefinitionsMap=(0,u.mapFromArrayOfDependantPairs)((0,o.strEnumArray)(s.ALAnnotationKind).map((function(e){return[e,{annotationName:l[e].annotationType.getTypeName(),featureName:"".concat(t.alFeatureNamePrefix,"_").concat(e),isModelRequired:l[e].isModelRequired}]})))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X10TableIntelligenceService=void 0;var n=r(0),i=r(4),a=r(2),o=r(5),s=r(12),u=r(47),l=function(){function e(e){this.tableIntelligenceProvider=e}return e.prototype.getRecognizedRangeTablesInfo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.__awaiter(this,void 0,void 0,(function(){var t,r,i;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(i=this.tableIntelligenceProvider).getRecognizedRangeTablesInfo.apply(i,e)];case 1:return t=n.sent(),(0,a.isDefined)(t)?[2,(0,o.success)(t.filter(a.isDefined))]:[2,(0,o.failure)(void 0)];case 2:return r=n.sent(),c("getRecognizedRangeTablesInfo","failed to get recognized range tables info: ".concat(r)),[2,(0,o.failure)(r)];case 3:return[2]}}))}))},e}();function c(e,t){i.ulsLogger.ULS.traceTag(508171735,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,u.x10Logger.formatLogMessage("X10TableIntelligenceService.".concat(e),{description:t}))}t.X10TableIntelligenceService=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentQueueProcessorFactory=t.ExperimentQueueProcessor=void 0;var n=r(2),i=r(314),a=r(17),o=function(){function e(e){this.consumeMessage=e,this.queue=new i.PriorityQueue((function(){return 0}))}return e.prototype.enqueue=function(e,t,r){(0,n.isDefined)(r)&&e.kind===a.SchedulerTimelineQueueMessageKind.StopComputationFrame||this.queue.enqueue(e)},e.prototype.step=function(){var e=this.queue.pop();(0,n.isDefined)(e)&&this.consumeMessage(e)},Object.defineProperty(e.prototype,"done",{get:function(){return 0===this.queue.getCount()},enumerable:!1,configurable:!0}),e}();t.ExperimentQueueProcessor=o;t.experimentQueueProcessorFactory=function(e){return new o(e)},(0,n.staticAssertExtends)()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dynamicPluginLoaderInsideInit=t.timelineQueueProcessorFactory=t.createPrefetchingCacheFactory=t.DynamicPluginLoader=void 0;var n=r(0),i=n.__importStar(r(80)),a=r(24),o=r(204),s=r(204),u=r(128),l=r(4),c=r(29),d=r(2),p=r(122),m=r(122),f=r(309),g=r(48),h=r(13),v=r(47),S=r(522),y=function(){function e(e,t){if(!(t instanceof s.FormulaBarScheduler))throw new TypeError("DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ".concat(JSON.stringify(t)));this.scheduler=t,v.x10Logger.threadId=e}return e.prototype.loadPluginScriptTrace=function(e,t){l.ulsLogger.ULS.traceTag(553734797,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,v.x10Logger.formatLogMessage("loadPluginScript",{description:"".concat(e," loaded, time to load ").concat(t)}))},e.prototype.createAndAttachPlugin=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){return r=(0,c.getPluginFactory)(e),this.scheduler.createAndAttachPlugin(r,t),[2]}))}))},e.prototype.createAndAttachSyncPlugin=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){return r=(0,c.getPluginFactory)(e),this.scheduler.createAndAttachSyncPlugin(r,t),[2]}))}))},e}(),F=function(e){function t(t,r,n,i){var a=e.call(this,"Main",n)||this;a.threadEntryPoint=t,a.gridManager=r,a.loader=i;var o=i.getConfig();return a.resolveScript=o.resolveScript,a}return n.__extends(t,e),t.prototype.loadPluginScript=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,i,a;return n.__generator(this,(function(n){switch(n.label){case 0:return(0,d.isNone)(e)||(0,d.isNone)(t)?[2]:(r=m.defaultTimerInterface,i=r.now(),[4,this.loader.loadScript(e)]);case 1:return n.sent(),a=r.now()-i,this.loadPluginScriptTrace(e,a),[2]}}))}))},t.prototype.isThreadingSupported=function(){return i.isThreadingSupported()&&void 0!==(0,u.getCalcAbsUrl)()},t.prototype.createPluginThread=function(e){return n.__awaiter(this,void 0,void 0,(function(){var r,s,c,d,p,m,f,h=this;return n.__generator(this,(function(S){switch(S.label){case 0:return r="DynamicPluginLoaderThread-".concat(t.lastThreadNum+=1,"-").concat(e),s="".concat(r,"-IGrid"),[4,u.initCalcCalled];case 1:return S.sent(),[4,i.createWorker({createMode:"Thread",id:r},i.paramInsideDef({scriptUrl:(0,u.getCalcAbsUrlOrThrow)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),(function(){return n.__assign(n.__assign({},(0,g.bindMethods)(h.scheduler,n.__spreadArray(n.__spreadArray([],o.parentMethodsCall,!0),o.parentMethodsPost,!0))),{resolveScript:h.resolveScript})}))];case 2:c=S.sent(),S.label=3;case 3:return S.trys.push([3,5,,6]),d=function(){},c.onClose=function(){d(),l.ulsLogger.ULS.traceTag(553734798,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,v.x10Logger.formatLogMessage("DynamicPluginLoader",{description:"Thread closed"}))},[4,(0,u.initCalcThread)(c)];case 4:return p=S.sent(),d=function(){return p.close()},this.scheduler.doNotifyStatelessSubject.subscribe((function(e){return c.post.processNotification(e)})),this.scheduler.requestWithCorrelationIdSubject.subscribe((function(e){var t;return(t=c.post).requestWithCorrelationId.apply(t,e)})),this.scheduler.doNotifyStatefulSubject.subscribe((function(e){return c.post.processNotification(e)})),m={createIGridImportEndpoint:function(e){return c.call.createIGridImportEndpoint.transfer([e.port],e)},onGridExporterClosed:c.post.onGridExporterClosed},this.gridManager.onGridImporterCreated(m,s),[2,new C(c)];case 5:throw f=S.sent(),c.close(),f;case 6:return[2]}}))}))},t.lastThreadNum=0,t}(y);t.DynamicPluginLoader=F;var C=function(){function e(e){this.outside=e}return e.prototype.loadPluginScript=function(e,t){return this.outside.call.loadPluginScript(e,t)},e.prototype.createAndAttachPlugin=function(e,t){return this.outside.call.createAndAttachPlugin(e,t)},e.prototype.createAndAttachSyncPlugin=function(e,t){return this.outside.call.createAndAttachSyncPlugin(e,t)},e.prototype.recalcServiceAttached=function(){return this.outside.call.recalcServiceAttached()},e.prototype.close=function(){this.outside.close()},e}();t.createPrefetchingCacheFactory=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=e.getGrid();if(void 0!==i)return S.PrefetchingCache.create.apply(S.PrefetchingCache,n.__spreadArray([i],t,!1))}};t.timelineQueueProcessorFactory=function(e){return function(t){return new p.TimelineQueueProcessor((function(e,t){return e.kind-t.kind}),t,void 0,e)}};t.dynamicPluginLoaderInsideInit=function(e,t){return function(r,a){var u=r.config,l=r.connection,c=a.pluginResponseWindows;return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(r){return[2,i.Endpoint.createInside(l,(function(r){var i=n.__assign(n.__assign({},(0,g.bindLazyMethods)(new h.ResettableLazy((function(){return r.call})),o.parentMethodsCall)),(0,g.bindLazyMethods)(new h.ResettableLazy((function(){return r.post})),o.parentMethodsPost)),a=new f.GridProvider((function(){return d.registerAsyncGrid()})),d=new s.FormulaBarScheduler(e(void 0),t(a),c,void 0,i);return new R(String(l.options.id),a,d,u,r)}))]}))}))}};var R=function(e){function t(t,r,i,a,o){var s=e.call(this,t,i)||this;return s.gridImporter=r,s.twConfig=a,s.inside=o,s.loadedScripts=(0,d.makeStringMap)(),s.initCalcThreadInside=function(e,t,r){return n.__awaiter(s,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,(0,u.initCalcInThread)(e,t,r,this.twConfig)];case 1:return n.sent(),[2]}}))}))},s.createIGridImportEndpoint=s.gridImporter.createIGridImportEndpoint.bind(s.gridImporter),s.onGridExporterClosed=s.gridImporter.onGridExporterClosed.bind(s.gridImporter),s.processNotification=s.scheduler.processNotification.bind(s.scheduler),s.requestWithCorrelationId=s.scheduler.requestWithCorrelationId.bind(s.scheduler),s}return n.__extends(t,e),t.prototype.loadPluginScript=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,a,o,s,l;return n.__generator(this,(function(n){switch(n.label){case 0:return(0,d.isNone)(e)||(0,d.isNone)(t)||!0===this.loadedScripts[e]?[2]:(r=m.defaultTimerInterface,a=r.now(),s=(o=i).importScriptsWithRetry,[4,this.inside.call.resolveScript({identifier:e,isLocalized:t})]);case 1:return s.apply(o,[[n.sent()],u.maxRetriesForLoadingScript]),l=r.now()-a,this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e,l),[2]}}))}))},t.prototype.recalcServiceAttached=function(){return this.scheduler.recalcServiceAttached()},t}(y)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrefetchingCache=void 0;var n=r(0),i=r(15),a=r(523),o=r(11),s=r(5),u=r(5),l=r(4),c=r(12),d=r(35),p=r(95),m=r(2),f=r(92),g=r(30),h=r(69),v=r(39),S=r(196),y=r(23),F=r(23),C=r(178),R=r(106),b=r(109),E=r(133),P=r(110),k=r(54),T=r(9),A=r(160),N=r(47);function _(e){var t=e.hasHeadersRow,r=e.hasTotalsRow,n=e.dataRange;return(0,i.gridRange)(n.row-Number(t),n.col,n.rows+Number(t)+Number(r),n.cols)}function I(e,t,r,n){for(var a=t.name,o=t.hasHeadersRow,s=t.hasTotalsRow,u=t.dataRange,l=t.columns,c=o?(0,i.gridRange)(u.row-1,u.col,1,u.cols):void 0,d=s?(0,i.gridRange)(u.row+u.rows,u.col,1,u.cols):void 0,p={},m=S.RedBlackMapTree.create(e.stringCompareCI),f=0,g=l;f<g.length;f++){var h=g[f];p[h.column]=h,m=m.setValue(h.name,h)}return{name:a,sheet:r,dataRange:u,headersRange:c,totalsRange:d,allRange:n,indexToColumn:p,nameToColumn:m,allColumnNamesAvailable:l.length===u.cols}}function O(e,t){var r;return(null!==(r=(0,v.compareProduct)((0,g.createCellSetFromRange)(t),e))&&void 0!==r?r:1)<=0}var M=(0,u.failure)((0,o.unavailable)(["getCell"])),D=(0,u.failure)((0,o.unavailable)(["getContainingTable"])),w=(0,u.failure)((0,o.unavailable)(["getIntersectingTables"])),L=(0,u.failure)((0,o.unavailable)(["getIntersectingTableNames"])),x=(0,u.failure)((0,o.unavailable)(["getIformats"])),K=(0,u.failure)((0,o.unavailable)(["GetAvailableTableHeaders"]));function U(e,t){var r=Object.create(e);for(var n in t)r[n]=t[n];return r}var B=function(){function e(e,t,r){this.grid=e,this.syncDataStore=t,this.correlationId=r,this.correspondingSnapshotID=-1,this.sheet2contents=(0,m.makeStringMap)(),this.currentDocumentLoc=(0,i.documentLoc)(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=(0,E.createParser)(t),this.analyzer=(0,P.createAnalyzer)(t),this.formatter=(0,C.createNumberFormatter)(t),this.resolver=(0,A.createResolver)(t);var n=U(t,{config:U(t.config,{localeInfo:(0,c.getEnglishLocaleInfo)()})});this.englishParser=(0,E.createParser)(n),this.englishAnalyzer=(0,P.createAnalyzer)(n)}return e.getOrFetchTile=function(t,r,n){var a=r.range.row>>>e.tileHeightPow,o=r.range.col>>>e.tileWidthPow;void 0===t[a]&&(t[a]=[]);var s=t[a][o];return void 0===s?n((0,i.sheetGridRange)(r.sheet,(0,i.gridRange)(a<<e.tileHeightPow,o<<e.tileWidthPow,1<<e.tileHeightPow,1<<e.tileWidthPow))).then((function(e){return t[a][o]=e})):s},e.create=function(t,r,n){return new e(t,r,n)},e.prototype.getSheetContents=function(e){var t;return null!==(t=this.sheet2contents[e])&&void 0!==t?t:this.sheet2contents[e]={cellTiles:[],tables:(0,f.makeGridRangeTable)(),tableTiles:[],hiddenRows:h.empty,hiddenRowsAvailability:h.empty,hiddenCols:h.empty,hiddenColsAvailability:h.empty}},e.prototype.getCurrentDocumentLoc=function(){return this.currentDocumentLoc},e.prototype.getSheetNames=function(){if(void 0===this.sheetNames){var e=[];this.syncDataStore.sheets.forEachSheet((function(t){e.push({sheetIndex:t.sheetIndex,sheetName:t.name})}));for(var t={},r=S.RedBlackMapTree.create(this.syncDataStore.config.localeInfo.stringCompareCI),n=0;n<e.length;n+=1){var i=e[n],a=i.sheetIndex,o=i.sheetName;t[a.index]=n,r=r.setValue(o,n)}var s=this.getCurrentDocumentLoc();this.sheetNames={document:s,sheets:e,idToIndex:t,nameToIndex:r}}return(0,u.success)(this.sheetNames)},e.prototype.getRangeValues=function(e){return this.grid.getRangeValues(this.correlationId,e)},e.prototype.getRangeFormulae=function(e){return this.grid.getRangeFormulae(this.correlationId,e)},e.prototype.getRangeFormats=function(e){return this.grid.getRangeFormats(this.correlationId,e)},e.prototype.getHiddenRows=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var a,o,s,u,l,c;return n.__generator(this,(function(n){switch(n.label){case 0:return a=this.getSheetContents(e.index),o=g.bspFactory.row([t,r]),s=(0,h.compare)(o,a.hiddenRowsAvailability),0===s||-1===s?[3,2]:[4,this.grid.getHiddenRows(this.correlationId,e,(0,m.fastMax)(0,t-10),(0,m.fastMin)(i.sheetRows,r+10))];case 1:u=n.sent(),a.hiddenRows=u.hidden.reduce((function(e,t){var r=t.start,n=t.end;return(0,h.union)(e,g.bspFactory.row([r,n]))}),a.hiddenRows),a.hiddenRowsAvailability=u.available.reduce((function(e,t){var r=t.start,n=t.end;return(0,h.union)(e,g.bspFactory.row([r,n]))}),a.hiddenRowsAvailability),n.label=2;case 2:return l=[],(0,g.forEachRow)((0,h.intersect)(a.hiddenRowsAvailability,o),(function(e){var t=e[0],r=e[1];return l.push((0,k.interval)(t,r)),!0})),c=[],(0,g.forEachRow)((0,h.intersect)(a.hiddenRows,o),(function(e){var t=e[0],r=e[1];return c.push((0,k.interval)(t,r)),!0})),[2,{available:l,hidden:c}]}}))}))},e.prototype.getHiddenCols=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var a,o,s,u,l,c;return n.__generator(this,(function(n){switch(n.label){case 0:return a=this.getSheetContents(e.index),o=g.bspFactory.col([t,r]),s=(0,h.compare)(o,a.hiddenColsAvailability),0===s||-1===s?[3,2]:[4,this.grid.getHiddenCols(this.correlationId,e,(0,m.fastMax)(0,t-10),(0,m.fastMin)(i.sheetCols,r+10))];case 1:u=n.sent(),a.hiddenCols=u.hidden.reduce((function(e,t){var r=t.start,n=t.end;return(0,h.union)(e,g.bspFactory.col([r,n]))}),a.hiddenCols),a.hiddenColsAvailability=u.available.reduce((function(e,t){var r=t.start,n=t.end;return(0,h.union)(e,g.bspFactory.col([r,n]))}),a.hiddenColsAvailability),n.label=2;case 2:return l=[],(0,g.forEachCol)((0,h.intersect)(a.hiddenColsAvailability,o),(function(e){var t=e[0],r=e[1];return l.push((0,k.interval)(t,r)),!0})),c=[],(0,g.forEachCol)((0,h.intersect)(a.hiddenCols,o),(function(e){var t=e[0],r=e[1];return c.push((0,k.interval)(t,r)),!0})),[2,{available:l,hidden:c}]}}))}))},e.prototype.getRange=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,i,s,l,c,d,p,m;return n.__generator(this,(function(n){switch(n.label){case 0:return r=void 0===t||t.indexOf("values")>-1,i=void 0===t||t.indexOf("formulae")>-1,s=void 0===t||t.indexOf("formats")>-1,l=(0,u.failure)((0,o.unavailable)(["getRange"])),[4,Promise.all([r?this.getRangeValues(e):l,i?this.getRangeFormulae(e):l,s?this.getRangeFormats(e):l])];case 1:return c=n.sent(),d=c[0],p=c[1],m=c[2],[2,new a.NaiveLocalSheetGrid(e.sheet,d,p,m)]}}))}))},e.prototype.getCell=function(t){var r=this,i=this.getSheetContents(t.sheet.index),o=e.getOrFetchTile(i.cellTiles,t,(function(e){return n.__awaiter(r,void 0,void 0,(function(){var r,i,o,s,l;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.grid.getRangeValues(this.correlationId,e)];case 1:return l=[n.sent()],[4,this.grid.getRangeFormulae(this.correlationId,e)];case 2:return l=l.concat([n.sent()]),[4,this.grid.getRangeFormats(this.correlationId,e)];case 3:return r=l.concat([n.sent()]),i=r[0],o=r[1],s=r[2],(0,u.isSuccess)(i)&&(0,u.isSuccess)(o)&&(0,u.isSuccess)(s)?[2,new a.NaiveLocalSheetGrid(t.sheet,i,o,s)]:[2,"unavailable"]}}))}))}));return(0,p.bindMaybeThenable)(o,(function(e){if("unavailable"===e)return M;var r=e.getCellValue(t.range.row,t.range.col),n=e.getCellFormula(t.range.row,t.range.col),i=e.getCellFormat(t.range.row,t.range.col);return(0,u.isSuccess)(r)&&(0,u.isSuccess)(n)&&(0,u.isSuccess)(i)?(0,u.success)({value:r.value,formula:n.value,format:i.value}):M}))},e.prototype.getAvailableTableHeaders=function(e){var t=this.syncDataStore.nameManager;if(!t)return K;var r=t.getAllDocumentNames().find((function(t){return t.name===e}));if(!r)return K;var n=t.getAvailableTableColumns(r);return(0,u.success)(n)},e.prototype.getStructRefColumn=function(e,t){var r=this.syncDataStore.getStructRefColumn(e,t);return r.kind===s.ResultKind.Failure?(0,u.failure)((0,o.unavailable)(["getStructRefColumn"])):r},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.syncDataStore.getStructRefSpecialRef(e,t);return r.kind===s.ResultKind.Failure?(0,u.failure)((0,o.unavailable)(["getStructRefSpecialRef"])):r},e.prototype.getContainingTableName=function(e){var t=this.syncDataStore.getContainingTable(e);return t.kind===s.ResultKind.Failure?(0,u.failure)((0,o.unavailable)(["getContainingTableName"])):t},e.prototype.getContainingTable=function(t){return n.__awaiter(this,void 0,void 0,(function(){var r,i,a=this;return n.__generator(this,(function(o){return r=this.getSheetContents(t.sheet.index),i=e.getOrFetchTile(r.tableTiles,t,(function(e){return n.__awaiter(a,void 0,void 0,(function(){var i,a,o,s,l,c;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,e)];case 1:if(i=n.sent(),!(0,u.isSuccess)(i))return[2,"unavailable"];for(a=i.value.availableRanges.map(g.createCellSetFromRange).reduce(v.unionProduct,h.empty),o=0,s=i.value.tables;o<s.length;o++)l=s[o],c=_(l),r.tables.getValue(c)||(r.tables=r.tables.setValue(c,I(this.syncDataStore.config.localeInfo,l,t.sheet,c)));return[2,a]}}))}))})),[2,(0,p.bindMaybeThenable)(i,(function(e){return"unavailable"===e?D:(r.tables.forEachGe(t.range,(function(e,t){return n=t,!1})),void 0!==n||O(e,t.range)?(0,u.success)(n):D);var n}))]}))}))},e.prototype.getIntersectingTables=function(t){return n.__awaiter(this,void 0,void 0,(function(){var r,a,o,s,l,c,d,m,f,S,y=this;return n.__generator(this,(function(n){switch(n.label){case 0:r=this.getSheetContents(t.sheet.index),a=h.empty,o=t.range.row,s=t.range.row+t.range.rows,n.label=1;case 1:if(!(o<s))return[3,8];l=t.range.col,c=t.range.col+t.range.cols,n.label=2;case 2:return l<c?(d=e.getOrFetchTile(r.tableTiles,(0,i.sheetGridCell)(t.sheet,(0,i.gridCell)(o,l)),(function(e){return y.fetchTableTile(e.sheet,r,e)})),(0,p.isThenable)(d)?[4,d]:[3,4]):[3,7];case 3:return f=n.sent(),[3,5];case 4:f=d,n.label=5;case 5:if("unavailable"===(m=f))return[2,w];a=(0,v.unionProduct)(a,m),n.label=6;case 6:return l+=1<<e.tileWidthPow,[3,2];case 7:return o+=1<<e.tileHeightPow,[3,1];case 8:return S=[],r.tables.forEachMeets(t.range,(function(e,t){return S.push(t),a=(0,v.unionProduct)(a,(0,g.createCellSetFromRange)(e)),!0})),[2,O(a,t.range)?(0,u.success)(S):w]}}))}))},e.prototype.getIntersectingTableNames=function(e){if(void 0===this.syncDataStore.nameManager)return L;var t=this.syncDataStore.nameManager.getIntersectingTables(e);return t.kind===s.ResultKind.Failure?L:t},e.prototype.fetchTableTile=function(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var i,a,o,s,l,c;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,r)];case 1:if(i=n.sent(),!(0,u.isSuccess)(i))return[2,"unavailable"];for(a=i.value.availableRanges.map(g.createCellSetFromRange).reduce(v.unionProduct,h.empty),o=0,s=i.value.tables;o<s.length;o++)l=s[o],c=_(l),t.tables.getValue(c)||(t.tables=t.tables.setValue(c,I(this.syncDataStore.config.localeInfo,l,e,c)));return[2,a]}}))}))},e.prototype.getIformat=function(t,r){return n.__awaiter(this,void 0,void 0,(function(){var i,a,o,s,l,c,d,p,m,f;return n.__generator(this,(function(n){switch(n.label){case 0:return i=r>>>e.formatPagePow,a=i<<e.formatPagePow,o=a+(1<<e.formatPagePow),void 0!==(s=this.formatPages[i])?[3,2]:[4,this.grid.getIformats(this.correlationId,t,a,o)];case 1:if(l=n.sent(),(0,u.isSuccess)(l)){for(c=[],d=0,p=l.value.availableFormats;d<p.length;d++)(m=p[d]).iformat<a||m.iformat>=o||(c[m.iformat-a]=m);s=this.formatPages[i]=c}else s=this.formatPages[i]="unavailable";n.label=2;case 2:return"unavailable"===s||void 0===(f=s[r-a])?[2,x]:[2,(0,u.success)(f)]}}))}))},e.prototype.parseCellFormula=function(t,r,n){return{result:e.cachedParseFormula(n?this.englishFormulaCache:this.formulaCache,n?this.englishParser:this.parser,n?this.englishAnalyzer:this.analyzer,t,r)}},e.prototype.parseEdit=function(e,t){var r;return n.__awaiter(this,void 0,void 0,(function(){var i;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getEditFormat(e)];case 1:return i=null!==(r=n.sent())&&void 0!==r?r:{valueType:F.FormatValueType.General,bidiDate:void 0,culture:void 0},[2,this.parseEditInternal(e,t,i)]}}))}))},e.prototype.parseEditSync=function(e,t,r){var n,i=this.parseNumberFormat(r.formatString,r.builtIn).result;return n=(0,u.isSuccess)(i)?i.value:{valueType:F.FormatValueType.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(e,t,n)},e.prototype.resolveReferences=function(e,t){var r=this;return t.map((function(t){switch(t.kind){case T.NodeKind.StructRef:return r.resolveStructRefSync(e,t).result;case T.NodeKind.CellRef:return r.resolveCellRefNodeSync(e,t).result}}))},e.prototype.getCorrespondingSnapshotID=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return-1!==this.correspondingSnapshotID?[3,2]:(e=this,[4,this.grid.getCorrespondingSnapshotID(this.correlationId)]);case 1:e.correspondingSnapshotID=t.sent(),t.label=2;case 2:return[2,this.correspondingSnapshotID]}}))}))},e.prototype.getEditFormat=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r,i,a,o,s;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getCell(e)];case 1:return t=n.sent(),(0,u.isSuccess)(t)?"string"!=typeof t.value.format?[3,2]:(r=this.parseNumberFormat(t.value.format,!1).result,[3,4]):[2,void 0];case 2:return[4,this.getIformat(e.sheet.document,t.value.format)];case 3:if(i=n.sent(),!(0,u.isSuccess)(i))return[2,void 0];a=i.value,o=a.formatString,s=a.builtIn,r=this.parseNumberFormat(o,s).result,n.label=4;case 4:return[2,(0,u.isSuccess)(r)?r.value:void 0]}}))}))},e.prototype.parseEditInternal=function(t,r,n){var i=this.formatter.parseEdit(r,n);if(!(0,u.isSuccess)(i))return{result:i};if(i.value.kind===F.EditKind.String&&"="===r&&n.valueType!==F.FormatValueType.Text&&(i=(0,u.success)((0,y.formulaEdit)(r))),i.value.kind!==F.EditKind.Formula)return{result:(0,u.success)(i.value)};var a=e.parseCheckedFormula(this.parser,this.analyzer,t,i.value.fmla,t.range);return(0,u.isSuccess)(a)?{result:(0,u.success)({kind:F.EditKind.Formula,fmla:i.value.fmla,formula:a.value})}:{result:a}},e.cachedParseFormula=function(t,r,n,i,a){var o,s=t.get(a);if(void 0!==s)return s;var u=e.parseWellFormedFormula(r,n,i,a.formulaBarText,null!==(o=a.origin)&&void 0!==o?o:i.range);return t.set(a,u),u},e.parseWellFormedFormula=function(t,r,n,i,a){var s=e.parseCheckedFormula(t,r,n,i,a);return(0,u.isSuccess)(s)?(0,o.isWellFormed)(s.value)?(0,u.success)(s.value):(0,u.failure)((0,k.illFormedFormula)("ill-formed formula")):s},e.parseCheckedFormula=function(e,t,r,n,a){var o=e.parseFormula((0,R.parseLocals)(i.LexicalKind.Cell,a),n);if(!(0,u.isSuccess)(o))return o;var s=t.checkFormula((0,b.analyzeLocalsGrid)(i.LexicalKind.Cell,(0,i.sheetGridCell)(r.sheet,a)),o.value);return(0,u.isSuccess)(s)?(0,u.success)(s.value):s},e.prototype.parseNumberFormat=function(e,t){return{result:this.cachedParseNumberFormat(e,t)}},e.prototype.evalOnClonedModel=function(e,t,r){return this.grid.evalClonedModelOnSnapshot(this.correlationId,e,t,r)},e.prototype.evalFormula=function(e,t,r){return this.grid.evalFormulaOnSnapshot(this.correlationId,e,t,r)},e.prototype.cachedParseNumberFormat=function(e,t){var r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;var n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n},e.prototype.resolveStructRefSync=function(e,t){return{result:this.resolver.resolveStructRef(e,t)}},e.prototype.resolveCellRefNodeSync=function(e,t){return{result:this.resolver.resolveCellRef(e,t)}},e.prototype.close=function(){this.grid.discardSnapshot(this.correlationId).catch((function(e){l.ulsLogger.ULS.traceTag(553734788,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,N.x10Logger.formatLogMessage("PrefetchingCache.close",{description:(0,d.messageFromError)(e)}))}))},e.tileWidthPow=2,e.tileHeightPow=4,e.formatPagePow=6,e}();t.PrefetchingCache=B},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NaiveLocalSheetGrid=void 0;var n=r(2),i=r(5),a=r(15),o=r(11),s=r(96),u=r(30),l=r(39),c=r(69),d=r(51),p=r(4),m=function(){function e(t,r,n,a){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,(0,i.isSuccess)(r)&&(this.values=e.buildSparseMatrix(r.value.nonEmptyCells,(function(e){return e})),this.valueAvailabilitySet=e.unionRanges(r.value.availableRanges)),(0,i.isSuccess)(a)&&(this.formats=e.buildSparseMatrix(a.value.nonEmptyCells,(function(e){return e})),this.formatAvailabilitySet=e.unionRanges(a.value.availableRanges)),(0,i.isSuccess)(n)&&(this.formulae=e.buildSparseMatrix(n.value.nonEmptyCells,(function(e){return e})),this.formulaAvailabilitySet=e.unionRanges(n.value.availableRanges))}return e.buildSparseMatrix=function(e,t){for(var r=[],n=0,i=e;n<i.length;n++)for(var a=i[n],o=a[0],s=o[0],u=o[1],l=o[2],c=void 0===l?1:l,d=o[3],p=void 0===d?1:d,m=a.slice(1),f=m.length,g=u,h=0;g<u+p;g+=1)for(var v=s;v<s+c;v+=1,h=(h+1)%f)void 0===r[v]&&(r[v]=[]),r[v][g]=t(m[h],v,g);return r},e.forEachInSparseMatrix=function(e,t,r){void 0===r&&(r=function(){return!1});var n=!0;return e.forEach((function(e,i){n&&e.forEach((function(e,o){n&&(r(e)||t((0,a.gridCell)(i,o),e)||(n=!1))}))})),n},e.unionRanges=function(e){return e.map(u.createCellSetFromRange).reduce(l.unionProduct,c.empty)},e.prototype.getCellValue=function(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?(0,i.success)(this.values[e][t]):(0,i.success)(s.emptyRangeValue):(0,i.failure)((0,o.unavailable)(["getCellValue"]))},e.prototype.getCellFormat=function(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?(0,i.success)(this.formats[e][t]):(0,i.success)(s.emptyRangeFormat):(0,i.failure)((0,o.unavailable)(["getCellFormat"]))},e.prototype.getCellFormula=function(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?(0,i.success)(this.formulae[e][t]):(0,i.success)(s.emptyRangeFormula):(0,i.failure)((0,o.unavailable)(["getCellFormula"]))},e.prototype.foreachNonBlankCellValue=function(t){return void 0===this.values||e.forEachInSparseMatrix(this.values,t,(function(e){return e.kind===d.OperKind.Blank}))},e.prototype.foreachNonBlankCellFormula=function(t){return void 0===this.formulae||e.forEachInSparseMatrix(this.formulae,t,(function(e){return e.kind===s.emptyRangeFormula.kind&&e.formulaBarText===s.emptyRangeFormula.formulaBarText}))},e.prototype.isAvailable=function(e,t,r){var n,i;switch(r){case"value":i=this.valueAvailabilitySet;break;case"formula":i=this.formulaAvailabilitySet;break;case"format":i=this.formatAvailabilitySet;break;default:(0,p.assertNever)("isAvailable",r)}return void 0!==i&&(null!==(n=(0,l.compareProduct)((0,u.createCellSetFromRange)((0,a.gridCell)(e,t)),i))&&void 0!==n?n:1)<=0},e}();t.NaiveLocalSheetGrid=m,(0,n.staticAssertExtends)()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeCalcGrid=void 0;var n=r(0),i=r(525),a=r(194),o=r(303),s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};t.makeCalcGrid=function(e){return void 0===e&&(e=i.defaultSetTimeoutInterface),(new(function(t){function r(){var r=t.call(this,s,s,s,s,(0,o.asyncLoopFactory)((0,o.delayPromiseImpl)(e)))||this;return r.calcGrid=r,r}return n.__extends(r,t),Object.defineProperty(r.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),r}(a.RecalcServiceImpl))).calcGrid}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;var n=r(1);t.setImmediateUnified=n.setTimeoutInterfaceModule.setImmediateUnified,t.clearTimerUnified=n.setTimeoutInterfaceModule.clearTimerUnified,t.defaultSetTimeoutInterface=n.setTimeoutInterfaceModule.defaultSetTimeoutInterface},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFailureOutputMessage=void 0;var n=r(20),i=[n.OutputMessageKind.RangeFailure,n.OutputMessageKind.NameFailure,n.OutputMessageKind.NumberFormatFailure,n.OutputMessageKind.PrintFormulaFailure,n.OutputMessageKind.InferFormatFailure,n.OutputMessageKind.FormatValueFailure,n.OutputMessageKind.UnhandledFailure];t.isFailureOutputMessage=function(e){return i.includes(e.kind)}},function(e,t,r){"use strict";var n,i,a,o,s,u,l;Object.defineProperty(t,"__esModule",{value:!0}),t.createPartialWorkbook=t.blankStyle=t.genFmt=t.knownFormatData=t.kfToIformat=t.englishLocaleData=t.defaultConfig=t.mathpack=t.locale=t.createRange=t.assertMessageOrder=void 0;var c,d=r(0),p=r(20),m=r(4),f=r(54),g=r(15),h=r(30),v=r(163),S=r(195),y=r(12),F=r(9),C=r(129),R=r(115),b=r(2),E=r(177),P=r(77),k=r(140),T=r(35);!function(e){e.EditedPhase="EditedPhase",e.DependentPhase="DependentPhase",e.StatisticsPhase="StatisticsPhase",e.Finished="Finished"}(c||(c={}));var A={kind:c.EditedPhase,stateId:-1/0};var N=Object.getOwnPropertyNames(p.OutputMessageKind);function _(e,t){var r={};return e.forEach((function(e){return r[e]=t})),r}var I=((n={})[c.EditedPhase]=d.__assign(d.__assign(d.__assign(((i={})[p.OutputMessageKind.StateAdvanced]=function(){return c.EditedPhase},i[p.OutputMessageKind.RecalcStatistics]=function(e,t){if(t.message===p.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===p.ComputedCellKind.EditedCell)return c.EditedPhase;if(t.cellKind===p.ComputedCellKind.DependentCell)return c.DependentPhase;if(t.cellKind===p.ComputedCellKind.IndependentCell)return c.EditedPhase;if(t.cellKind===p.ComputedCellKind.UnknownNonEditedCell)return e("a different message.cellKind than ".concat(t.cellKind));(0,m.assertNever)("calc.calc.partialWorkbook.testutilsutils.transitions",t.cellKind)}if(t.message===p.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===p.ComputedCellKind.EditedCell)return c.EditedPhase;if(t.cellKind===p.ComputedCellKind.DependentCell)return c.DependentPhase;if(t.cellKind===p.ComputedCellKind.IndependentCell)return c.EditedPhase;if(t.cellKind===p.ComputedCellKind.UnknownNonEditedCell)return e("a different message.cellKind than ".concat(t.cellKind));(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===p.RecalcStatisticsMessage.ContinueComputation?c.EditedPhase:t.message===p.RecalcStatisticsMessage.EditFinished||t.message===p.RecalcStatisticsMessage.StateTimedOut?c.StatisticsPhase:t.message===p.RecalcStatisticsMessage.RecalcFinished?c.Finished:void(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},i),_([p.OutputMessageKind.CellWrite,p.OutputMessageKind.RangeWrite],(function(e,t){return t.cellKind===p.ComputedCellKind.EditedCell?c.EditedPhase:t.cellKind===p.ComputedCellKind.DependentCell?c.DependentPhase:void(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}))),((a={})[p.OutputMessageKind.RangeFailure]=function(e,t){return t.cellKind===p.ComputedCellKind.EditedCell?c.EditedPhase:t.cellKind===p.ComputedCellKind.DependentCell?c.DependentPhase:t.cellKind===p.ComputedCellKind.IndependentCell?c.EditedPhase:t.cellKind===p.ComputedCellKind.UnknownNonEditedCell?c.DependentPhase:void(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)},a[p.OutputMessageKind.PrintFormulaFailure]=function(){return c.EditedPhase},a[p.OutputMessageKind.InferFormatFailure]=function(){return c.EditedPhase},a[p.OutputMessageKind.FormatValueFailure]=function(){return c.EditedPhase},a)),_([p.OutputMessageKind.GarbageCollected,p.OutputMessageKind.Alert,p.OutputMessageKind.ExperimentRunResult,p.OutputMessageKind.UpdateRequest,p.OutputMessageKind.WorkbookStatistics,p.OutputMessageKind.UnhandledFailure,p.OutputMessageKind.NumberFormatFailure,p.OutputMessageKind.NameFailure,p.OutputMessageKind.UpdateNamesRequest],(function(){return c.EditedPhase}))),n[c.DependentPhase]=d.__assign(d.__assign(d.__assign(d.__assign(((o={})[p.OutputMessageKind.RecalcStatistics]=function(e,t){if(t.message===p.RecalcStatisticsMessage.ChangedCell){if(t.cellKind===p.ComputedCellKind.EditedCell)return e("a different cellKind than ".concat(t.cellKind));if(t.cellKind===p.ComputedCellKind.DependentCell)return c.DependentPhase;if(t.cellKind===p.ComputedCellKind.IndependentCell)return c.DependentPhase;if(t.cellKind===p.ComputedCellKind.UnknownNonEditedCell)return e("a different cellKind than ".concat(t.cellKind));(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}if(t.message===p.RecalcStatisticsMessage.UnchangedCell){if(t.cellKind===p.ComputedCellKind.EditedCell)return e("a different cellKind than ".concat(t.cellKind));if(t.cellKind===p.ComputedCellKind.DependentCell)return c.DependentPhase;if(t.cellKind===p.ComputedCellKind.IndependentCell)return c.DependentPhase;if(t.cellKind===p.ComputedCellKind.UnknownNonEditedCell)return e("a different cellKind than ".concat(t.cellKind));(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}return t.message===p.RecalcStatisticsMessage.ContinueComputation?e("a different message.message than ".concat(t.message)):t.message===p.RecalcStatisticsMessage.EditFinished?c.StatisticsPhase:t.message===p.RecalcStatisticsMessage.StateTimedOut||t.message===p.RecalcStatisticsMessage.RecalcFinished?e("a different message.message than ".concat(t.message)):void(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},o),_([p.OutputMessageKind.CellWrite,p.OutputMessageKind.RangeWrite],(function(e,t){return t.cellKind===p.ComputedCellKind.EditedCell?e("a different message.cellKind than ".concat(t.cellKind)):t.cellKind===p.ComputedCellKind.DependentCell?c.DependentPhase:void(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)}))),((s={})[p.OutputMessageKind.RangeFailure]=function(e,t){return t.cellKind===p.ComputedCellKind.EditedCell?t.reason.kind===f.ReasonKind.CellCycle?c.DependentPhase:e("the current state to be ".concat(c.EditedPhase,", or ").concat(c.DependentPhase," and failure ").concat(f.ReasonKind.CellCycle)):t.cellKind===p.ComputedCellKind.IndependentCell||t.cellKind===p.ComputedCellKind.DependentCell||t.cellKind===p.ComputedCellKind.UnknownNonEditedCell?c.DependentPhase:void(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.cellKind)},s[p.OutputMessageKind.FormatValueFailure]=function(){return c.DependentPhase},s)),_([p.OutputMessageKind.GarbageCollected,p.OutputMessageKind.Alert,p.OutputMessageKind.ExperimentRunResult],(function(e,t){return e("a different message.kind than ".concat(t.kind))}))),_([p.OutputMessageKind.StateAdvanced,p.OutputMessageKind.UpdateRequest,p.OutputMessageKind.WorkbookStatistics,p.OutputMessageKind.UnhandledFailure,p.OutputMessageKind.NumberFormatFailure,p.OutputMessageKind.NameFailure,p.OutputMessageKind.PrintFormulaFailure,p.OutputMessageKind.InferFormatFailure,p.OutputMessageKind.UpdateNamesRequest],(function(e,t){return e("a different message.kind than ".concat(t.kind))}))),n[c.StatisticsPhase]=d.__assign(d.__assign(((u={})[p.OutputMessageKind.RecalcStatistics]=function(e,t){return t.message===p.RecalcStatisticsMessage.ChangedCell||t.message===p.RecalcStatisticsMessage.UnchangedCell||t.message===p.RecalcStatisticsMessage.ContinueComputation||t.message===p.RecalcStatisticsMessage.EditFinished||t.message===p.RecalcStatisticsMessage.StateTimedOut?e("a different message.message than ".concat(t.message)):t.message===p.RecalcStatisticsMessage.RecalcFinished?c.Finished:void(0,m.assertNever)("calc.calc.partialWorkbook.testutils.transitions",t.message)},u),_([p.OutputMessageKind.GarbageCollected,p.OutputMessageKind.Alert,p.OutputMessageKind.ExperimentRunResult],(function(e,t){return e("a different message.kind than ".concat(t.kind))}))),_([p.OutputMessageKind.CellWrite,p.OutputMessageKind.RangeWrite,p.OutputMessageKind.RangeFailure,p.OutputMessageKind.PrintFormulaFailure,p.OutputMessageKind.InferFormatFailure,p.OutputMessageKind.FormatValueFailure,p.OutputMessageKind.StateAdvanced,p.OutputMessageKind.UpdateRequest,p.OutputMessageKind.WorkbookStatistics,p.OutputMessageKind.NumberFormatFailure,p.OutputMessageKind.UnhandledFailure,p.OutputMessageKind.NameFailure,p.OutputMessageKind.UpdateNamesRequest],(function(e,t){return e("a different message.kind than ".concat(t.kind))}))),n[c.Finished]=_(N,(function(e){return e("no message once recalc finished")})),n);function O(e,t,r){var n=e.stateId,i=e.kind,a=function(e,t){switch(t.kind){case p.OutputMessageKind.GarbageCollected:return expect(t.minStateIdKept).toBeLessThanOrEqual(e),e;case p.OutputMessageKind.Alert:return e;case p.OutputMessageKind.ExperimentRunResult:return t.experimentKind===k.ExperimentKind.OneShot&&expect(e).toEqual(1),e;default:return expect(e).toBeLessThanOrEqual(t.stateId),t.stateId}}(n,t);return{kind:(0,I[i][t.kind])((function(n){return expect({state:e,message:t,index:r}).toEqual(n)}),t,i),stateId:a}}t.assertMessageOrder=function(e){e.reduce(O,A)},t.createRange=function(e,t){return[(0,g.sheetGridRange)(e,t),(0,p.sheetCellSet)(e,(0,h.createCellSetFromRange)(t))]},t.locale=(0,y.getEnglishLocaleInfo)(),t.mathpack=v.xlMathpack,t.defaultConfig={localeInfo:t.locale,mathpack:t.mathpack,refStyle:F.RefStyle.A1,date1904:!1,dateCompatibility:!0,timezone:C.tzUTC,datepack:C.xlDatepack},t.englishLocaleData=(0,P.localeData)([{functionId:0,functionName:"COUNT"}],[{errorType:1,errorName:"#NULL!"}],"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",[3,0],",",1033,1,2,!1," ",!1,"Paren",!0,!1,"$",2,"MDY","/","-",!0,!1,!1,!0,":",null,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["AM/PM","A/P","/",null,"General","$"],[null,";","#","0",".","%",",",":","/","/"," ","-","+","(",")",null,"\\","*","y","m","d","h","m","s","E","/",'"',"[","]","@","?","_","r","a","g","e",null,null,null,null,null,null,"B","N","","","","b","","","","","",null],["Black","White","Red","Green","Blue","Yellow","Magenta","Cyan","Color"],["DBNum1","DBNum2","DBNum3","DBNum4"],(0,T.partialArray)(((l={})[F.SpecialRefId.All]="#All",l[F.SpecialRefId.Data]="#Data",l[F.SpecialRefId.Headers]="#Headers",l[F.SpecialRefId.Totals]="#Totals",l[F.SpecialRefId.ThisRow]="#This Row",l)),"dddd, mmmm dd, yyyy","h:mm:ss AM/PM");t.kfToIformat=function(e){return Math.abs(e)},t.knownFormatData=(0,b.numEnumArray)(R.KnownFormat).filter((function(e){return(0,E.isKnownFormatDefined)(e,(0,y.getEnglishLocaleInfo)())})).map((function(e){return(0,P.numberFormat)((0,t.kfToIformat)(e),(0,E.getKnownFormat)(t.locale,e),!0)})),t.genFmt=(0,t.kfToIformat)(R.KnownFormat.General),t.blankStyle=p.SpecialStyle.Blank,t.createPartialWorkbook=function(e,r,n){var i,a,o,s=new S.PartialWorkbook(d.__assign(d.__assign({},t.defaultConfig),{localeInfo:null!==(i=null==n?void 0:n.localeOverride)&&void 0!==i?i:t.locale}),r);return s.setWorksheetFuncOverrides(null!==(a=null==n?void 0:n.worksheetFuncOverrides)&&void 0!==a?a:{}),(null===(o=null==n?void 0:n.setNumberFormats)||void 0===o||o)&&s.setNumberFormats(e,t.knownFormatData,!1,-1/0),s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextFuncs=t.getWorksheetFunc=void 0;var n=r(0).__importStar(r(296)),i=r(55);t.getWorksheetFunc=n.getWorksheetFunc,t.nextFuncs=i.nextFuncs.nextFuncs},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;var n=r(0).__importStar(r(298));t.FontUnderline=n.FontUnderline,t.FontVerticalAlignment=n.FontVerticalAlignment,t.FillKind=n.FillKind,t.PatternType=n.PatternType,t.BorderLineType=n.BorderLineType,t.HorizontalAlignment=n.HorizontalAlignment,t.VerticalAlignment=n.VerticalAlignment},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cancelSmokeTest=t.runSmokeTest=void 0;var n=r(0).__importStar(r(531));t.runSmokeTest=n.runSmokeTest,t.cancelSmokeTest=n.cancelSmokeTest},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runSmokeTest=t.cancelSmokeTest=void 0,t.cancelSmokeTest=function(){},t.runSmokeTest=function(){return Promise.resolve()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensurePluginAttached=t.ensureGroupAttachedLegacy=t.ensureGroupAttached=t.spanToLSPRange=t.ValuePreviewResultExtractor=t.GotoCtrlClickPluginFactory=t.ValuePreviewPluginFactory=t.ColoredReferencesPluginFactory=t.ParenthesesCouplingPluginFactory=t.AutocompleteTableHeadersPluginFactory=t.AutocompleteNamedObjectsPluginFactory=t.AutocompleteRichValuePluginFactory=t.AutocompleteLetPluginFactory=t.AutocompleteEnumPluginFactory=t.AutocompleteFunctionPluginFactory=t.ArgumentAssistancePluginFactory=t.PluginRegistry=t.ALAnnotationKind=t.EventKind=t.ExecutionType=t.ComputationType=t.NotificationKind=t.RequestKind=t.delay=t.wrapIntoAsync=t.awaitPromise=t.typedRequest=t.PluginRequestKind=t.ComputationRequestKind=t.stableDynamicPluginLoaderInsideInit=t.DefaultComputationGroup=t.registerPluginFactory=t.PluginFactoryName=t.PluginGroup=t.MockTimerImmediate=t.setMockGridSheetAndNotify=t.createMockGridExporter=t.createMockGridProvider=t.createMockAsyncGrid=t.RecalcSideGrid=t.SchedulerVersionCompatibility=t.FormulaKind=t.GridImportManagerSingleton=t.PluginSchedulerSingleton=t.getSchedulerFactories=t.defaultPluginResponseWindows=t.ChatGPTPlugin=t.staticTypeHint=t.core=t.platform=void 0,t.Test=t.TestGateOverrideManager=t.runQueueProcessorUntil=t.VisitorHelpers=t.RangeHelpers=t.TimelineQueueProcessor=t.defaultTimerInterface=t.resolveScriptLoaderPromise=t.setX10Features=void 0;var n=r(0),i=n.__importStar(r(2)),a=n.__importStar(r(48)),o=n.__importStar(r(312)),s=n.__importStar(r(97)),u=n.__importStar(r(207)),l=n.__importStar(r(318)),c=n.__importStar(r(29)),d=n.__importStar(r(17)),p=n.__importStar(r(60)),m=n.__importStar(r(96)),f=n.__importStar(r(319)),g=n.__importStar(r(321)),h=n.__importStar(r(323)),v=n.__importStar(r(324)),S=n.__importStar(r(325)),y=n.__importStar(r(326)),F=n.__importStar(r(327)),C=n.__importStar(r(328)),R=n.__importStar(r(329)),b=n.__importStar(r(310)),E=n.__importStar(r(545)),P=n.__importStar(r(316)),k=n.__importStar(r(202)),T=n.__importStar(r(331)),A=n.__importStar(r(332)),N=n.__importStar(r(330)),_=n.__importStar(r(122)),I=n.__importStar(r(554)),O=n.__importStar(r(206)),M=n.__importStar(r(555)),D=n.__importStar(r(144)),w=n.__importStar(r(142)),L=n.__importStar(r(6)),x=n.__importStar(r(145)),K=n.__importStar(r(99)),U=n.__importStar(r(557)),B=n.__importStar(r(558)),W=n.__importStar(r(559)),G=r(208);Object.defineProperty(t,"platform",{enumerable:!0,get:function(){return G.platform}}),t.core=i,t.staticTypeHint=a.staticTypeHint,t.ChatGPTPlugin=I.ChatGPTPlugin,t.defaultPluginResponseWindows=o.defaultPluginResponseWindows,t.getSchedulerFactories=s.getSchedulerFactories,t.PluginSchedulerSingleton=s.PluginSchedulerSingleton,t.GridImportManagerSingleton=s.GridImportManagerSingleton,t.FormulaKind=m.FormulaKind,t.SchedulerVersionCompatibility=d.SchedulerVersionCompatibility,t.RecalcSideGrid=k.RecalcSideGrid,t.createMockAsyncGrid=u.createMockAsyncGrid,t.createMockGridProvider=u.createMockGridProvider,t.createMockGridExporter=u.createMockGridExporter,t.setMockGridSheetAndNotify=u.setMockGridSheetAndNotify,t.MockTimerImmediate=l.MockTimerImmediate,t.PluginGroup=L.PluginGroup,t.PluginFactoryName=L.PluginFactoryName,t.registerPluginFactory=c.registerPluginFactory,t.DefaultComputationGroup=d.DefaultComputationGroup,t.stableDynamicPluginLoaderInsideInit=s.dynamicPluginLoaderInsideInit,t.ComputationRequestKind=d.ComputationRequestKind,t.PluginRequestKind=d.ComputationRequestKind,t.typedRequest=d.typedRequest,t.awaitPromise=d.awaitPromise,t.wrapIntoAsync=P.wrapIntoAsync,t.delay=d.delay,t.RequestKind=d.RequestKind,t.NotificationKind=p.NotificationKind,t.ComputationType=D.ComputationType,t.ExecutionType=w.ExecutionType,t.EventKind=O.EventKind,t.ALAnnotationKind=O.ALAnnotationKind,t.PluginRegistry=M.PluginRegistry,t.ArgumentAssistancePluginFactory=f.ArgumentAssistancePluginFactory,t.AutocompleteFunctionPluginFactory=g.AutocompleteFunctionPluginFactory,t.AutocompleteEnumPluginFactory=h.AutocompleteEnumPluginFactory,t.AutocompleteLetPluginFactory=v.AutocompleteLetPluginFactory,t.AutocompleteRichValuePluginFactory=S.AutocompleteRichValuePluginFactory,t.AutocompleteNamedObjectsPluginFactory=y.AutocompleteNamedObjectsPluginFactory,t.AutocompleteTableHeadersPluginFactory=F.AutocompleteTableHeadersPluginFactory,t.ParenthesesCouplingPluginFactory=C.ParenthesesCouplingPluginFactory,t.ColoredReferencesPluginFactory=R.ColoredReferencesPluginFactory,t.ValuePreviewPluginFactory=T.ValuePreviewPluginFactory,t.GotoCtrlClickPluginFactory=N.GotoCtrlClickPluginFactory,t.ValuePreviewResultExtractor=A.ValuePreviewResultExtractor,t.spanToLSPRange=b.spanToLSPRange,t.ensureGroupAttached=E.ensureGroupAttached,t.ensureGroupAttachedLegacy=E.ensureGroupAttachedLegacy,t.ensurePluginAttached=E.ensurePluginAttached,t.setX10Features=E.setX10Features,t.resolveScriptLoaderPromise=E.resolveScriptLoaderPromise,t.defaultTimerInterface=_.defaultTimerInterface,t.TimelineQueueProcessor=_.TimelineQueueProcessor,t.RangeHelpers=x,t.VisitorHelpers=K,t.runQueueProcessorUntil=U.runQueueProcessorUntil,t.TestGateOverrideManager=B.GateOverrideManager,t.Test=W},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionExamples=void 0;var n=r(36),i=r(13);t.functionExamples=new i.ResettableLazy((function(){var e;return(e={})[n.WorksheetFuncId.ABS]="=ABS(2)",e[n.WorksheetFuncId.CUBEMEMBERPROPERTY]='=CUBEMEMBERPROPERTY("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'","[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fiscal),'].[2014]",$A$3)'),e[n.WorksheetFuncId.CUBERANKEDMEMBER]='=CUBERANKEDMEMBER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'",$D$4,1,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TopMonth),'")'),e[n.WorksheetFuncId.BINOM_DIST_RANGE]="=BINOM.DIST.RANGE(60,0.75,48)",e[n.WorksheetFuncId.NETWORKDAYS_INTL]="=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",e[n.WorksheetFuncId.AVERAGE_WEIGHTED]="=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",e[n.WorksheetFuncId.GAMMALN_PRECISE]="=GAMMALN.PRECISE(4)",e[n.WorksheetFuncId.CONFIDENCE_NORM]="=CONFIDENCE.NORM(0.05,2.5,50)",e[n.WorksheetFuncId.CEILING_PRECISE]="=CEILING.PRECISE(4.3)",e[n.WorksheetFuncId.FORECAST_LINEAR]="=FORECAST.LINEAR(30,A2:A6,B2:B6)",e[n.WorksheetFuncId.PERCENTRANK_EXC]="=PERCENTRANK.EXC(A2:A11,2)",e[n.WorksheetFuncId.PERCENTRANK_INC]="=PERCENTRANK.INC(A2:A11,2)",e[n.WorksheetFuncId.PERCENTILE_EXC]="=PERCENTILE.EXC(B2:B10,0.25)",e[n.WorksheetFuncId.PERCENTILE_INC]="=PERCENTILE.INC(A2:A5,0.3)",e[n.WorksheetFuncId.CUBEKPIMEMBER]='=CUBEKPIMEMBER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MySalesKPI),'",1)'),e[n.WorksheetFuncId.CHISQ_DIST_RT]="=CHISQ.DIST.RT(18.307,10)",e[n.WorksheetFuncId.FLOOR_PRECISE]="=FLOOR.PRECISE(-3.2,-1)",e[n.WorksheetFuncId.NEGBINOM_DIST]="=NEGBINOM.DIST(10,5,0.25,TRUE)",e[n.WorksheetFuncId.GETPIVOTDATA]='=GETPIVOTDATA("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'", $A$3, "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.South),'")'),e[n.WorksheetFuncId.CUBESETCOUNT]="=CUBESETCOUNT(A3)",e[n.WorksheetFuncId.ERFC_PRECISE]="=ERFC.PRECISE(1)",e[n.WorksheetFuncId.CHISQ_INV_RT]="=CHISQ.INV.RT(0.3, 2)",e[n.WorksheetFuncId.CONFIDENCE_T]="=CONFIDENCE.T(0.05,1,50)",e[n.WorksheetFuncId.CEILING_MATH]="=CEILING.MATH(24.3,5)",e[n.WorksheetFuncId.HYPGEOM_DIST]="=HYPGEOM.DIST(1,4,8,20,TRUE)",e[n.WorksheetFuncId.LOGNORM_DIST]="=LOGNORM.DIST(4,3.5,1.2,TRUE)",e[n.WorksheetFuncId.NEGBINOMDIST]="=NEGBINOMDIST(10,5,0.25)",e[n.WorksheetFuncId.PERMUTATIONA]="=PERMUTATIONA(3,2)",e[n.WorksheetFuncId.POISSON_DIST]="=POISSON.DIST(1, 2, TRUE)",e[n.WorksheetFuncId.WEIBULL_DIST]="=WEIBULL.DIST(105,20,100,TRUE)",e[n.WorksheetFuncId.COVARIANCE_P]="=COVARIANCE.P(A2:A6, B2:B6)",e[n.WorksheetFuncId.COVARIANCE_S]="=COVARIANCE.S(A3:A5,B3:B5)",e[n.WorksheetFuncId.QUARTILE_EXC]="=QUARTILE.EXC(A2:A12,1)",e[n.WorksheetFuncId.QUARTILE_INC]="=QUARTILE.INC(A2:A9,1)",e[n.WorksheetFuncId.ECMA_CEILING]="=ECMA.CEILING(1.5, 0.1)",e[n.WorksheetFuncId.WORKDAY_INTL]="=WORKDAY.INTL(DATE(2012,1,1),30,0)",e[n.WorksheetFuncId.STOCKHISTORY]="=STOCKHISTORY(MSFT,1-1-2020)",e[n.WorksheetFuncId.ERF_PRECISE]="=ERF.PRECISE(0.745)",e[n.WorksheetFuncId.NUMBERVALUE]="=NUMBERVALUE(0.035)",e[n.WorksheetFuncId.HYPGEOMDIST]="=HYPGEOMDIST(1,4,8,20)",e[n.WorksheetFuncId.LOGNORMDIST]="=LOGNORMDIST(4,3.5,1.2)",e[n.WorksheetFuncId.LOGNORM_INV]="=LOGNORM.INV(0.039084, 3.5, 1.2)",e[n.WorksheetFuncId.NORM_S_DIST]="=NORM.S.DIST(1.33, TRUE)",e[n.WorksheetFuncId.STANDARDIZE]="=STANDARDIZE(42,40,1.5)",e[n.WorksheetFuncId.FORMULATEXT]="=FORMULATEXT(A2)",e[n.WorksheetFuncId.PERCENTRANK]="=PERCENTRANK(A2:A11,2)",e[n.WorksheetFuncId.CONCATENATE]='=CONCATENATE("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas),'", " ", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser),'")'),e[n.WorksheetFuncId.ISO_CEILING]="=ISO.CEILING(4.3)",e[n.WorksheetFuncId.VALUETOTEXT]='=VALUETOTEXT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SomeText),'")'),e[n.WorksheetFuncId.ARRAYTOTEXT]="=ARRAYTOTEXT(B1:B3)",e[n.WorksheetFuncId.AVERAGEIFS]='=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',e[n.WorksheetFuncId.COUNTBLANK]="=COUNTBLANK(A2:B5)",e[n.WorksheetFuncId.ERROR_TYPE]="=ERROR.TYPE(#NULL!)",e[n.WorksheetFuncId.CUBEMEMBER]='=CUBEMEMBER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'",(B4, C6, D5),"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesFor2004),'")'),e[n.WorksheetFuncId.ISOWEEKNUM]="=ISOWEEKNUM(40977)",e[n.WorksheetFuncId.SUBSTITUTE]='=SUBSTITUTE("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesData),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cost),'")'),e[n.WorksheetFuncId.SUMPRODUCT]="=SUMPRODUCT(C2:C5,D2:D5)",e[n.WorksheetFuncId.WEBSERVICE]="=WEBSERVICE(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WebServiceLink),")"),e[n.WorksheetFuncId.BINOM_DIST]="=BINOM.DIST(6,10,0.5,FALSE)",e[n.WorksheetFuncId.CHISQ_DIST]="=CHISQ.DIST(0.5,1,TRUE)",e[n.WorksheetFuncId.CONFIDENCE]="=CONFIDENCE(0.05,2.5,50)",e[n.WorksheetFuncId.EXPON_DIST]="=EXPON.DIST(0.2,10,TRUE)",e[n.WorksheetFuncId.FLOOR_MATH]="=FLOOR.MATH(24.3,5)",e[n.WorksheetFuncId.GAMMA_DIST]="=GAMMA.DIST(4.79, 1.234, 7, TRUE)",e[n.WorksheetFuncId.NORM_S_INV]="=NORM.S.INV(0.908789)",e[n.WorksheetFuncId.CHISQ_TEST]="=CHISQ.TEST(A2:B4,A6:B8)",e[n.WorksheetFuncId.PERCENTILE]="=PERCENTILE(E2:E5,0.3)",e[n.WorksheetFuncId.FIELDVALUE]='=FIELDVALUE(A2, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price),'")'),e[n.WorksheetFuncId.AVERAGEIF]='=AVERAGEIF(B2:B5,"<23000")',e[n.WorksheetFuncId.BITLSHIFT]="=BITLSHIFT(4,2)",e[n.WorksheetFuncId.BITRSHIFT]="=BITRSHIFT(13,2)",e[n.WorksheetFuncId.DATEVALUE]='=DATEVALUE("1/1/2008")',e[n.WorksheetFuncId.FILTERXML]='=FILTERXML(B3,"//rc/@title")',e[n.WorksheetFuncId.CUBEVALUE]='=CUBEVALUE(Sales,"['.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),']","[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time),'].[2004]","[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProduct),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Beverages),']")'),e[n.WorksheetFuncId.ENCODEURL]='=ENCODEURL("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EncodeURLExmapleLink),'")'),e[n.WorksheetFuncId.HYPERLINK]='=HYPERLINK("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HyperlinkExampleLink),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ClickForReport),'")'),e[n.WorksheetFuncId.ISLOGICAL]="=ISLOGICAL(TRUE)",e[n.WorksheetFuncId.ISNONTEXT]="=ISNONTEXT(A2)",e[n.WorksheetFuncId.ISFORMULA]="=ISFORMULA(A2)",e[n.WorksheetFuncId.PDURATION]="=PDURATION(2.5%,2000,2200)",e[n.WorksheetFuncId.TIMEVALUE]="=TIMEVALUE(0.1)",e[n.WorksheetFuncId.TRANSPOSE]="=TRANSPOSE(A2:F9)",e[n.WorksheetFuncId.FREQUENCY]="=FREQUENCY(A2:A20, B2:B5)",e[n.WorksheetFuncId.BETA_DIST]="=BETA.DIST(2,8,10,TRUE,1,3)",e[n.WorksheetFuncId.BINOMDIST]="=BINOMDIST(6,10,0.5,FALSE)",e[n.WorksheetFuncId.BINOM_INV]="=BINOM.INV(6,0.5,0.75)",e[n.WorksheetFuncId.CHISQ_INV]="=CHISQ.INV(0.3, 2)",e[n.WorksheetFuncId.CRITBINOM]="=CRITBINOM(6,0.5,0.75)",e[n.WorksheetFuncId.EXPONDIST]="=EXPONDIST(0.2,10,TRUE)",e[n.WorksheetFuncId.F_DIST_RT]="=F.DIST.RT(15.2069,6,4)",e[n.WorksheetFuncId.FISHERINV]="=FISHERINV(0.972955)",e[n.WorksheetFuncId.GAMMADIST]="=GAMMADIST(10.00001131,9,2,FALSE)",e[n.WorksheetFuncId.GAMMA_INV]="=GAMMA.INV(0.068094,9,2)",e[n.WorksheetFuncId.NORM_DIST]="=NORM.DIST(1, 0, 1, TRUE)",e[n.WorksheetFuncId.T_DIST_2T]="=T.DIST.2T(1.959999998,60)",e[n.WorksheetFuncId.T_DIST_RT]="=T.DIST.RT(1.959999998,60)",e[n.WorksheetFuncId.INTERCEPT]="=INTERCEPT(A2:A6, B2:B6)",e[n.WorksheetFuncId.MODE_MULT]="=MODE.MULT(A2:A13)",e[n.WorksheetFuncId.MODE_SNGL]="=MODE.SNGL(A2:A7)",e[n.WorksheetFuncId.AGGREGATE]="=AGGREGATE(12, 6, A1:A11, B1:B11)",e[n.WorksheetFuncId.RANDARRAY]="=RANDARRAY(5,3,1,100)",e[n.WorksheetFuncId.COUNTIFS]='=COUNTIFS(A2:A7,"<6",A2:A7,">1")',e[n.WorksheetFuncId.DAVERAGE]='=DAVERAGE(A4:E10, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:B2)'),e[n.WorksheetFuncId.BAHTTEXT]="=BAHTTEXT(1234)",e[n.WorksheetFuncId.DPRODUCT]='=DPRODUCT(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:F3)'),e[n.WorksheetFuncId.INDIRECT]="=INDIRECT(B&A)",e[n.WorksheetFuncId.ISNUMBER]="=ISNUMBER(A2)",e[n.WorksheetFuncId.MINVERSE]="=MINVERSE(A1:D4)",e[n.WorksheetFuncId.RANK_AVG]="=RANK.AVG(94,B2:B8)",e[n.WorksheetFuncId.SUBTOTAL]="=SUBTOTAL(9,A2:A5)",e[n.WorksheetFuncId.BETADIST]="=BETADIST(2,8,10,1,3)",e[n.WorksheetFuncId.BETA_INV]="=BETA.INV(0.685470581,8,10,1,3)",e[n.WorksheetFuncId.F_INV_RT]="=F.INV.RT(0.01,6,4)",e[n.WorksheetFuncId.GAMMAINV]="=GAMMAINV(0.65, 4, 2)",e[n.WorksheetFuncId.NORMDIST]="=NORMDIST(42,40,1.5,TRUE)",e[n.WorksheetFuncId.NORM_INV]="=NORM.INV(0.908789,40,1.5)",e[n.WorksheetFuncId.NORMSINV]="=NORMSINV(0.9088)",e[n.WorksheetFuncId.SUMX2MY2]="=SUMX2MY2(A3:A9,B3:B9)",e[n.WorksheetFuncId.SUMX2PY2]="=SUMX2PY2(A3:A9,B3:B9)",e[n.WorksheetFuncId.FORECAST]="=FORECAST(30,A2:A6,B2:B6)",e[n.WorksheetFuncId.QUARTILE]="=QUARTILE(A2:A9,1)",e[n.WorksheetFuncId.TRIMMEAN]="=TRIMMEAN(A2:A12,0.2)",e[n.WorksheetFuncId.T_INV_2T]="=T.INV.2T(0.546449,60)",e[n.WorksheetFuncId.AVERAGEA]="=AVERAGEA(A2:A6)",e[n.WorksheetFuncId.TEXTJOIN]="=TEXTJOIN(, , TRUE, A2:A8)",e[n.WorksheetFuncId.SEQUENCE]="=SEQUENCE(4,5)",e[n.WorksheetFuncId.ADDRESS]='=ADDRESS(2,3,1,FALSE,"['.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Book1),"]").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sheet1),'")'),e[n.WorksheetFuncId.AVERAGE]="=AVERAGE(A2:A6)",e[n.WorksheetFuncId.COLUMNS]="=COLUMNS(C1:E4)",e[n.WorksheetFuncId.COUNTIF]='=COUNTIF(B2:B5,">55")',e[n.WorksheetFuncId.DAYS360]="=DAYS360(30-Jan-11,1-Feb-11)",e[n.WorksheetFuncId.DCOUNTA]='=DCOUNTA(A4:E10, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),'", A1:F2)'),e[n.WorksheetFuncId.DECIMAL]="=DECIMAL(FF,16)",e[n.WorksheetFuncId.DEGREES]="=DEGREES(PI())",e[n.WorksheetFuncId.DSTDEVP]='=DSTDEVP(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[n.WorksheetFuncId.CUBESET]='=CUBESET("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'","[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Product),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProducts),"].").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Children),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Products),'",1,"[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesAmount),']")'),e[n.WorksheetFuncId.HLOOKUP]='=HLOOKUP("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Axles),'", A1:C4, 2, TRUE)'),e[n.WorksheetFuncId.IFERROR]='=IFERROR(55/0, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ErrorInCalculation),'")'),e[n.WorksheetFuncId.ISBLANK]="=ISBLANK(A2)",e[n.WorksheetFuncId.ISERROR]="=ISERROR(#REF!)",e[n.WorksheetFuncId.XLOOKUP]='=XLOOKUP("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom),'",A2:A9,C2:C9,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NotFound),'",0,1)'),e[n.WorksheetFuncId.MDETERM]="=MDETERM(A2:D5)",e[n.WorksheetFuncId.PRODUCT]="=PRODUCT(A2:A4)",e[n.WorksheetFuncId.RADIANS]="=RADIANS(270)",e[n.WorksheetFuncId.RANK_EQ]="=RANK.EQ(7,A2:A6,1)",e[n.WorksheetFuncId.REPLACE]='=REPLACE(2009,3,2,"10")',e[n.WorksheetFuncId.STDEV_S]="=STDEV.S(A2:A11)",e[n.WorksheetFuncId.STDEV_P]="=STDEV.P(A3:A12)",e[n.WorksheetFuncId.UNICODE]="=UNICODE(B)",e[n.WorksheetFuncId.UNICHAR]="=UNICHAR(66)",e[n.WorksheetFuncId.VLOOKUP]="=VLOOKUP(103, A2:B26, 2, FALSE)",e[n.WorksheetFuncId.WEEKDAY]="=WEEKDAY(39492)",e[n.WorksheetFuncId.GAMMALN]="=GAMMALN(4)",e[n.WorksheetFuncId.BETAINV]="=BETAINV(0.685470581,8,10,1,3)",e[n.WorksheetFuncId.CHIDIST]="=CHIDIST(18.307,10)",e[n.WorksheetFuncId.COMBINA]="=COMBINA(4,3)",e[n.WorksheetFuncId.CEILING]="=CEILING(2.5, 1)",e[n.WorksheetFuncId.NORMINV]="=NORMINV(0.908789,40,1.5)",e[n.WorksheetFuncId.POISSON]="=POISSON(1, 2, TRUE)",e[n.WorksheetFuncId.WEIBULL]="=WEIBULL(105,20,100,TRUE)",e[n.WorksheetFuncId.SUMXMY2]="=SUMXMY2(A3:A9,B3:B9)",e[n.WorksheetFuncId.CHITEST]="=CHITEST(A2:B4,A6:B8)",e[n.WorksheetFuncId.PEARSON]="=PEARSON(A3:A7,B3:B7)",e[n.WorksheetFuncId.GEOMEAN]="=GEOMEAN(A2:A8)",e[n.WorksheetFuncId.HARMEAN]="=HARMEAN(A2:A8)",e[n.WorksheetFuncId.STDEVPA]="=STDEVPA(A3:A12)",e[n.WorksheetFuncId.DATEDIF]='=DATEDIF(1/1/2001,1/1/2003,"Y")',e[n.WorksheetFuncId.ARABIC]="=ARABIC(LVII)",e[n.WorksheetFuncId.CHOOSE]='=CHOOSE(3,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wide),'",115,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.World),'",8)'),e[n.WorksheetFuncId.COLUMN]="=COLUMN(C9)",e[n.WorksheetFuncId.COUNTA]="=COUNTA(B2:B6)",e[n.WorksheetFuncId.DCOUNT]='=DCOUNT(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Age),'", A1:F2)'),e[n.WorksheetFuncId.DOLLAR]="=DOLLAR(1.2351, 4)",e[n.WorksheetFuncId.DSTDEV]='=DSTDEV(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[n.WorksheetFuncId.GROWTH]="=GROWTH(#VALUE!)",e[n.WorksheetFuncId.IMCOSH]='=IMCOSH("4+3i")',e[n.WorksheetFuncId.IMCSCH]='=IMCSCH("4+3i")',e[n.WorksheetFuncId.IMSECH]='=IMSECH("4+3i")',e[n.WorksheetFuncId.IMSINH]='=IMSINH("4+3i")',e[n.WorksheetFuncId.ISTEXT]='=ISTEXT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region1),'")'),e[n.WorksheetFuncId.LINEST]="=LINEST(B2:B10, A2:A10, FALSE, TRUE)",e[n.WorksheetFuncId.LOGEST]="=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",e[n.WorksheetFuncId.LOOKUP]="=LOOKUP(4.19, A2:A6, B2:B6)",e[n.WorksheetFuncId.XMATCH]="=XMATCH(F2,C3:C9,1)",e[n.WorksheetFuncId.MEDIAN]="=MEDIAN(A2:A6)",e[n.WorksheetFuncId.MINUTE]="=MINUTE(0.53125)",e[n.WorksheetFuncId.OFFSET]="=OFFSET(D3,3,-2,1,1)",e[n.WorksheetFuncId.PROPER]='=PROPER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisIsATITLE),'")'),e[n.WorksheetFuncId.SEARCH]='=SEARCH("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.E),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Statements),'",6)'),e[n.WorksheetFuncId.SECOND]="=SECOND(0.700208333333333)",e[n.WorksheetFuncId.SHEETS]="=SHEETS(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.My3DRef),")"),e[n.WorksheetFuncId.STDEVP]="=STDEVP(A3:A12)",e[n.WorksheetFuncId.SUMIFS]='=SUMIFS(A2:A9, B2:B9, "<>'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bananas),'", C2:C9, "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom),'")'),e[n.WorksheetFuncId.AVEDEV]="=AVEDEV(A2:A8)",e[n.WorksheetFuncId.CHIINV]="=CHIINV(0.3, 2)",e[n.WorksheetFuncId.COMBIN]="=COMBIN(8,2)",e[n.WorksheetFuncId.F_DIST]="=F.DIST(15.2069,6,4,TRUE)",e[n.WorksheetFuncId.FISHER]="=FISHER(0.75)",e[n.WorksheetFuncId.LOGINV]="=LOGINV(0.039084, 3.5, 1.2)",e[n.WorksheetFuncId.PERMUT]="=PERMUT(100,3)",e[n.WorksheetFuncId.T_DIST]="=T.DIST(60,1,TRUE)",e[n.WorksheetFuncId.CORREL]="=CORREL(A2:A6, B2:B6)",e[n.WorksheetFuncId.F_TEST]="=F.TEST(A2:A6,B2:B6)",e[n.WorksheetFuncId.T_TEST]="=T.TEST(A2:A10,B2:B10,2,1)",e[n.WorksheetFuncId.SKEW_P]="=SKEW.P(A2:A11)",e[n.WorksheetFuncId.Z_TEST]="=Z.TEST(A2:A11,4)",e[n.WorksheetFuncId.STDEVA]="=STDEVA(A3:A12)",e[n.WorksheetFuncId.MAXIFS]='=MAXIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB),'",D2:D7,">100")'),e[n.WorksheetFuncId.MINIFS]='=MINIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB),'",D2:D7,">100")'),e[n.WorksheetFuncId.CONCAT]='=CONCAT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas),'"," ", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser),'")'),e[n.WorksheetFuncId.SWITCH]='=SWITCH(WEEKDAY(10/10/2016),1,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday),'",2,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday),'",3,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoMatch),'")'),e[n.WorksheetFuncId.FILTER]='=FILTER(A5:D20,(C5:C20="'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Apple),'")*(A5:A20="').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.East),'"),"")'),e[n.WorksheetFuncId.UNIQUE]="=UNIQUE(A2:A12)",e[n.WorksheetFuncId.SORTBY]="=SORTBY(D2:D9,E2:E9,1)",e[n.WorksheetFuncId.BITAND]="=BITAND(1,5)",e[n.WorksheetFuncId.BITXOR]="=BITXOR(5,3)",e[n.WorksheetFuncId.ACOSH]="=ACOSH(10)",e[n.WorksheetFuncId.ACOTH]="=ACOTH(6)",e[n.WorksheetFuncId.ATANH]="=ATANH(-0.1)",e[n.WorksheetFuncId.ATAN2]="=ATAN2(4,0)",e[n.WorksheetFuncId.CLEAN]="=CLEAN(A2)",e[n.WorksheetFuncId.COUNT]="=COUNT(A2:A7)",e[n.WorksheetFuncId.DVARP]='=DVARP(A4:E10, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[n.WorksheetFuncId.EXACT]='=EXACT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Goodbye),'")'),e[n.WorksheetFuncId.FALSE]="=FALSE()",e[n.WorksheetFuncId.FIXED]="=FIXED(-1234.567, -1, TRUE)",e[n.WorksheetFuncId.IMCOT]='=IMCOT("4+3i")',e[n.WorksheetFuncId.IMCSC]='=IMCSC("4+3i")',e[n.WorksheetFuncId.IMSEC]='=IMSEC("4+3i")',e[n.WorksheetFuncId.IMTAN]='=IMTAN("4+3i")',e[n.WorksheetFuncId.INDEX]="=INDEX(A2:B3,2,1)",e[n.WorksheetFuncId.ISERR]="=ISERR(#N/A)",e[n.WorksheetFuncId.ISREF]="=ISREF(A2)",e[n.WorksheetFuncId.LOWER]='=LOWER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EECummings),'")'),e[n.WorksheetFuncId.MATCH]="=MATCH(39,B2:B5,1)",e[n.WorksheetFuncId.MMULT]="=MMULT(A1:B3, C1:F2)",e[n.WorksheetFuncId.MONTH]="=MONTH(40648)",e[n.WorksheetFuncId.RIGHT]='=RIGHT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice),'",5)'),e[n.WorksheetFuncId.ROUND]="=ROUND(2.149, 1)",e[n.WorksheetFuncId.SHEET]="=SHEET(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Table1),")"),e[n.WorksheetFuncId.STDEV]="=STDEV(A3:A12)",e[n.WorksheetFuncId.SUMIF]='=SUMIF(A2:A5,">160000")',e[n.WorksheetFuncId.TODAY]="=TODAY()",e[n.WorksheetFuncId.TREND]="=TREND(B2:B10, A2:A10, A11:A13, TRUE)",e[n.WorksheetFuncId.TRUNC]="=TRUNC(8.9)",e[n.WorksheetFuncId.UPPER]='=UPPER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KelliXu),'")'),e[n.WorksheetFuncId.VALUE]="=VALUE(1000)",e[n.WorksheetFuncId.VAR_S]="=VAR.S(A2:A11)",e[n.WorksheetFuncId.VAR_P]="=VAR.P(A2:A11)",e[n.WorksheetFuncId.GAMMA]="=GAMMA(-3.75)",e[n.WorksheetFuncId.GAUSS]="=GAUSS(2)",e[n.WorksheetFuncId.FDIST]="=FDIST(15.20686486,6,4)",e[n.WorksheetFuncId.F_INV]="=F.INV(0.01,6,4)",e[n.WorksheetFuncId.FLOOR]="=FLOOR(23.25, 0.1)",e[n.WorksheetFuncId.TDIST]="=TDIST(60, 1, 1)",e[n.WorksheetFuncId.COVAR]="=COVAR(A2:A6, B2:B6)",e[n.WorksheetFuncId.FTEST]="=FTEST(A2:A6,B2:B6)",e[n.WorksheetFuncId.STEYX]="=STEYX(A3:A9,B3:B9)",e[n.WorksheetFuncId.SLOPE]="=SLOPE(A3:A9,B3:B9)",e[n.WorksheetFuncId.TTEST]="=TTEST(A2:A10,B2:B10,2,1)",e[n.WorksheetFuncId.DEVSQ]="=DEVSQ(A2:A8)",e[n.WorksheetFuncId.SUMSQ]="=SUMSQ(3, 4)",e[n.WorksheetFuncId.ZTEST]="=ZTEST(A2:A11,6)",e[n.WorksheetFuncId.LARGE]="=LARGE(A2:B6,7)",e[n.WorksheetFuncId.SMALL]="=SMALL(A2:A10,4)",e[n.WorksheetFuncId.MUNIT]="=MUNIT(2)",e[n.WorksheetFuncId.T_INV]="=T.INV(0.75,2)",e[n.WorksheetFuncId.ROMAN]="=ROMAN(499,0)",e[n.WorksheetFuncId.POWER]="=POWER(5,2)",e[n.WorksheetFuncId.ISPMT]="=ISPMT(10%, 2, 5, 1000)",e[n.WorksheetFuncId.VARPA]="=VARPA(1, 2)",e[n.WorksheetFuncId.AREAS]="=AREAS(B2:D4)",e[n.WorksheetFuncId.ASINH]="=ASINH(10)",e[n.WorksheetFuncId.BITOR]="=BITOR(23,10)",e[n.WorksheetFuncId.ACOS]="=ACOS(-0.5)",e[n.WorksheetFuncId.ACOT]="=ACOT(2)",e[n.WorksheetFuncId.ATAN]="=ATAN(1)",e[n.WorksheetFuncId.CELL]='=CELL("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Address),'", C2)'),e[n.WorksheetFuncId.CHAR]="=CHAR(65)",e[n.WorksheetFuncId.COSH]="=COSH(EXP(1))",e[n.WorksheetFuncId.COTH]="=COTH(2)",e[n.WorksheetFuncId.CSCH]="=CSCH(2)",e[n.WorksheetFuncId.DATE]="=DATE(2008,1,2)",e[n.WorksheetFuncId.DAYS]="=DAYS(3/15/11,2/1/11)",e[n.WorksheetFuncId.DGET]='=DGET(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[n.WorksheetFuncId.DMAX]='=DMAX(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),'", A1:F3)'),e[n.WorksheetFuncId.DMIN]='=DMIN(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),'", A1:F3)'),e[n.WorksheetFuncId.DSUM]='=DSUM(A4:E10,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),'", A1:F3)'),e[n.WorksheetFuncId.DVAR]='=DVAR(A4:E10, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[n.WorksheetFuncId.FACT]="=FACT(5)",e[n.WorksheetFuncId.FIND]='=FIND("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.M),'",A2)'),e[n.WorksheetFuncId.HOUR]="=HOUR(0.75)",e[n.WorksheetFuncId.IFNA]='=IFNA("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoNAError),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Error),'")'),e[n.WorksheetFuncId.IPMT]="=IPMT(10%, 3, 3, 8000)",e[n.WorksheetFuncId.ISNA]="=ISNA(#REF!)",e[n.WorksheetFuncId.LEFT]='=LEFT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice),'",4)'),e[n.WorksheetFuncId.MIRR]="=MIRR(A2:A7, 0.1, 0.12)",e[n.WorksheetFuncId.NPER]="=NPER(0.12/12, -100, -1000, 10000, 1)",e[n.WorksheetFuncId.PPMT]="=PPMT(0.08, 10, 10, 200000)",e[n.WorksheetFuncId.RAND]="=RAND()",e[n.WorksheetFuncId.RANK]="=RANK(3.5,A2:A6,1)",e[n.WorksheetFuncId.RATE]="=RATE(4*12, -200, 8000)",e[n.WorksheetFuncId.REPT]='=REPT("*-", 3)',e[n.WorksheetFuncId.ROWS]="=ROWS(C1:E4)",e[n.WorksheetFuncId.SECH]="=SECH(0)",e[n.WorksheetFuncId.SIGN]="=SIGN(10)",e[n.WorksheetFuncId.SINH]="=SINH(2)",e[n.WorksheetFuncId.SQRT]="=SQRT(16)",e[n.WorksheetFuncId.TANH]="=TANH(0.5)",e[n.WorksheetFuncId.TEXT]='=TEXT(1234.567,"$#,##0.00")',e[n.WorksheetFuncId.TIME]="=TIME(16,48,10)",e[n.WorksheetFuncId.TRIM]='=TRIM("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuarterEarnings),'")'),e[n.WorksheetFuncId.TRUE]="=TRUE()",e[n.WorksheetFuncId.TYPE]='=TYPE("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Smith),'")'),e[n.WorksheetFuncId.VARP]="=VARP(A2:A11)",e[n.WorksheetFuncId.YEAR]="=YEAR(39634)",e[n.WorksheetFuncId.INFO]='=INFO("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numfile),'")'),e[n.WorksheetFuncId.EVEN]="=EVEN(1.5)",e[n.WorksheetFuncId.FINV]="=FINV(0.42, 2, 3)",e[n.WorksheetFuncId.PROB]="=PROB(A3:A6,B3:B6,2)",e[n.WorksheetFuncId.KURT]="=KURT(A2:A11)",e[n.WorksheetFuncId.SKEW]="=SKEW(A2:A11)",e[n.WorksheetFuncId.MODE]="=MODE(A2:A7)",e[n.WorksheetFuncId.MINA]="=MINA(A2:A6)",e[n.WorksheetFuncId.MAXA]="=MAXA(A2:A6)",e[n.WorksheetFuncId.VARA]="=VARA(1, 2)",e[n.WorksheetFuncId.SORT]="=SORT(A2:A17)",e[n.WorksheetFuncId.ASIN]="=ASIN(-0.5)",e[n.WorksheetFuncId.BASE]="=BASE(7,2)",e[n.WorksheetFuncId.CODE]='=CODE("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CodeA),'")'),e[n.WorksheetFuncId.AND]="=AND(A2>1,A2<100)",e[n.WorksheetFuncId.COS]="=COS(1.047)",e[n.WorksheetFuncId.COT]="=COT(30)",e[n.WorksheetFuncId.CSC]="=CSC(15)",e[n.WorksheetFuncId.DAY]="=DAY(40648)",e[n.WorksheetFuncId.DDB]="=DDB(2400,300,10*365,1)",e[n.WorksheetFuncId.RTD]='=RTD(mycomaddin.progid,,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ServerName),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price),'")'),e[n.WorksheetFuncId.EXP]="=EXP(1)",e[n.WorksheetFuncId.INT]="=INT(8.9)",e[n.WorksheetFuncId.IRR]="=IRR(A2:A4,-10%)",e[n.WorksheetFuncId.LEN]='=LEN("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Excel),'")'),e[n.WorksheetFuncId.LOG]="=LOG(10)",e[n.WorksheetFuncId.MAX]="=MAX(A2:A6)",e[n.WorksheetFuncId.MID]='=MID("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FluidFlow),'",1,5)'),e[n.WorksheetFuncId.MIN]="=MIN(A2:A6)",e[n.WorksheetFuncId.MOD]="=MOD(3, 2)",e[n.WorksheetFuncId.NOT]="=NOT(A2>100)",e[n.WorksheetFuncId.NPV]="=NPV(0.1, -10000, 3000, 4200, 6800)",e[n.WorksheetFuncId.PMT]="=PMT(0.08/12,10,10000)",e[n.WorksheetFuncId.ROW]="=ROW(C10)",e[n.WorksheetFuncId.RRI]="=RRI(96,10000,11000)",e[n.WorksheetFuncId.SEC]="=SEC(30)",e[n.WorksheetFuncId.SIN]="=SIN(PI())",e[n.WorksheetFuncId.SLN]="=SLN(30000, 7500, 10)",e[n.WorksheetFuncId.SUM]="=SUM(A1:A3)",e[n.WorksheetFuncId.SYD]="=SYD(30000,7500,10,1)",e[n.WorksheetFuncId.TAN]="=TAN(0.785)",e[n.WorksheetFuncId.VAR]="=VAR(A2:A11)",e[n.WorksheetFuncId.VDB]="=VDB(2400, 300, 10*365, 0, 1)",e[n.WorksheetFuncId.XOR]="=XOR(3>0,2<9)",e[n.WorksheetFuncId.ODD]="=ODD(1.5)",e[n.WorksheetFuncId.PHI]="=PHI(0.75)",e[n.WorksheetFuncId.RSQ]="=RSQ(A3:A9, B3:B9)",e[n.WorksheetFuncId.IFS]='=IFS(A2>89,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsA),'",A2>79,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB),'",A2>69,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsC),'",A2>59,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsD),'",TRUE,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsF),'")'),e[n.WorksheetFuncId.DB]="=DB(1000000,100000,6,1,7)",e[n.WorksheetFuncId.FV]="=FV(0.06/12, 10, -200, -500, 1)",e[n.WorksheetFuncId.IF]='=IF(C2>B2,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OverBudget),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WithinBudget),'")'),e[n.WorksheetFuncId.LN]="=LN(86)",e[n.WorksheetFuncId.NA]="=NA()",e[n.WorksheetFuncId.OR]="=OR(A2>1,A2<100)",e[n.WorksheetFuncId.PV]="=PV(0.08/12, 12*20, 500, , 0)",e[n.WorksheetFuncId.N]="=N(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Even),")"),e[n.WorksheetFuncId.T]='=T("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello),'")'),e[n.WorksheetFuncId.ACCRINT]="=ACCRINT(39508,39691,39569,0.1,1000,2,0)",e[n.WorksheetFuncId.ACCRINTM]="=ACCRINTM(39539,39614,0.1,1000,3)",e[n.WorksheetFuncId.AMORDEGRC]="=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",e[n.WorksheetFuncId.AMORLINC]="=AMORLINC(2400,39679,39813,300,1,0.15,1)",e[n.WorksheetFuncId.BESSELI]="=BESSELI(1.5,1)",e[n.WorksheetFuncId.BESSELJ]="=BESSELJ(1.9,2)",e[n.WorksheetFuncId.BESSELK]="=BESSELK(1.5,1)",e[n.WorksheetFuncId.BESSELY]="=BESSELY(2.5,1)",e[n.WorksheetFuncId.BIN2DEC]="=BIN2DEC(1100100)",e[n.WorksheetFuncId.BIN2HEX]="=BIN2HEX(11111011, 4)",e[n.WorksheetFuncId.BIN2OCT]="=BIN2OCT(1001, 3)",e[n.WorksheetFuncId.COMPLEX]='=COMPLEX(3,4,"j")',e[n.WorksheetFuncId.CONVERT]='=CONVERT(1,"lbm","kg")',e[n.WorksheetFuncId.COUPDAYBS]="=COUPDAYBS(25-Jan-11,15-Nov-11,2,1)",e[n.WorksheetFuncId.COUPDAYS]="=COUPDAYS(25-Jan-11,15-Nov-11,2,1)",e[n.WorksheetFuncId.COUPDAYSNC]="=COUPDAYSNC(25-Jan-11,15-Nov-11,2,1)",e[n.WorksheetFuncId.COUPNCD]="=COUPNCD(25-Jan-11,15-Nov-11,2,1)",e[n.WorksheetFuncId.COUPNUM]="=COUPNUM(25-Jan-11,15-Nov-12,2,1)",e[n.WorksheetFuncId.COUPPCD]="=COUPPCD(25-Jan-11,15-Nov-11,2,1)",e[n.WorksheetFuncId.CUMIPMT]="=CUMIPMT(A2/12,A3*12,A4,13,24,0)",e[n.WorksheetFuncId.CUMPRINC]="=CUMPRINC(A2/12,A3*12,A4,13,24,0)",e[n.WorksheetFuncId.DEC2BIN]="=DEC2BIN(9, 4)",e[n.WorksheetFuncId.DEC2HEX]="=DEC2HEX(100,4)",e[n.WorksheetFuncId.DEC2OCT]="=DEC2OCT(58,3)",e[n.WorksheetFuncId.DELTA]="=DELTA(5,4)",e[n.WorksheetFuncId.DISC]="=DISC(7/1/2018,1/1/2048,97.975,100,1)",e[n.WorksheetFuncId.DOLLARDE]="=DOLLARDE(1.02,16)",e[n.WorksheetFuncId.DOLLARFR]="=DOLLARFR(1.125,16)",e[n.WorksheetFuncId.DURATION]="=DURATION(7/1/2018,1/1/2048,8%,9%,2,1)",e[n.WorksheetFuncId.EDATE]="=EDATE(15-Jan-11,1)",e[n.WorksheetFuncId.EFFECT]="=EFFECT(0.0525,4)",e[n.WorksheetFuncId.EOMONTH]="=EOMONTH(1-Jan-11,1)",e[n.WorksheetFuncId.ERF]="=ERF(0.745)",e[n.WorksheetFuncId.ERFC]="=ERFC(1)",e[n.WorksheetFuncId.FACTDOUBLE]="=FACTDOUBLE(6)",e[n.WorksheetFuncId.FORECAST_ETS]="=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",e[n.WorksheetFuncId.FORECAST_ETS_CONFINT]="=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",e[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]="=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",e[n.WorksheetFuncId.FORECAST_ETS_STAT]="=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",e[n.WorksheetFuncId.FVSCHEDULE]="=FVSCHEDULE(1,{0.09,0.11,0.1})",e[n.WorksheetFuncId.GCD]="=GCD(24,36)",e[n.WorksheetFuncId.GESTEP]="=GESTEP(5,4)",e[n.WorksheetFuncId.HEX2BIN]="=HEX2BIN(F,8)",e[n.WorksheetFuncId.HEX2DEC]="=HEX2DEC(FFFFFFFF5B)",e[n.WorksheetFuncId.HEX2OCT]="=HEX2OCT(F, 3)",e[n.WorksheetFuncId.IMABS]='=IMABS("5+12i")',e[n.WorksheetFuncId.IMAGE]='=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',e[n.WorksheetFuncId.IMAGINARY]='=IMAGINARY("3+4i")',e[n.WorksheetFuncId.IMARGUMENT]='=IMARGUMENT("3+4i")',e[n.WorksheetFuncId.IMCONJUGATE]='=IMCONJUGATE("3+4i")',e[n.WorksheetFuncId.IMCOS]='=IMCOS("1+i")',e[n.WorksheetFuncId.IMDIV]='=IMDIV("-238+240i","10+24i")',e[n.WorksheetFuncId.IMEXP]='=IMEXP("1+i")',e[n.WorksheetFuncId.IMLN]='=IMLN("3+4i")',e[n.WorksheetFuncId.IMLOG10]='=IMLOG10("3+4i")',e[n.WorksheetFuncId.IMLOG2]='=IMLOG2("3+4i")',e[n.WorksheetFuncId.IMPOWER]='=IMPOWER("2+3i", 3)',e[n.WorksheetFuncId.IMPRODUCT]='=IMPRODUCT("3+4i","5-3i")',e[n.WorksheetFuncId.IMREAL]='=IMREAL("6-9i")',e[n.WorksheetFuncId.IMSIN]='=IMSIN("4+3i")',e[n.WorksheetFuncId.IMSQRT]='=IMSQRT("1+i")',e[n.WorksheetFuncId.IMSUB]='=IMSUB("13+4i","5+3i")',e[n.WorksheetFuncId.IMSUM]='=IMSUM("3+4i","5-3i")',e[n.WorksheetFuncId.INTRATE]="=INTRATE(2/15/2008,5/15/2008,1000000,1014420,2)",e[n.WorksheetFuncId.ISEVEN]="=ISEVEN(2.5)",e[n.WorksheetFuncId.ISODD]="=ISODD(2.5)",e[n.WorksheetFuncId.LAMBDA]="=LAMBDA(a, b, SQRT((a^2+b^2)))",e[n.WorksheetFuncId.LET]="=LET(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total),", SUM(A1:A10), ").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count),", COUNT(A1:A10), ").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)," / ").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count),")"),e[n.WorksheetFuncId.LCM]="=LCM(5,2)",e[n.WorksheetFuncId.LOG10]="=LOG10(86)",e[n.WorksheetFuncId.MDURATION]="=MDURATION(1/1/2008,1/1/2016,8%,9%,2,1)",e[n.WorksheetFuncId.MROUND]="=MROUND(10,3)",e[n.WorksheetFuncId.MULTINOMIAL]="=MULTINOMIAL(2,3,4)",e[n.WorksheetFuncId.NETWORKDAYS]="=NETWORKDAYS(10/1/2012,3/1/2013)",e[n.WorksheetFuncId.NOMINAL]="=NOMINAL(0.053543, 4)",e[n.WorksheetFuncId.NOW]="=NOW()",e[n.WorksheetFuncId.OCT2BIN]="=OCT2BIN(3,3)",e[n.WorksheetFuncId.OCT2DEC]="=OCT2DEC(54)",e[n.WorksheetFuncId.OCT2HEX]="=OCT2HEX(100,4)",e[n.WorksheetFuncId.ODDFPRICE]="=ODDFPRICE(11/11/2008,3/1/2021,10/15/2008,3/1/2009,7.85%,6.25%,100,2,1)",e[n.WorksheetFuncId.ODDFYIELD]="=ODDFYIELD(11/11/2008,3/1/2021,10/15/2008,3/1/2009,5.75%,84.5,100,2,0)",e[n.WorksheetFuncId.ODDLPRICE]="=ODDLPRICE(2/7/2008,6/15/2008,10/15/2007,3.75%,4.05%,100,2,0)",e[n.WorksheetFuncId.ODDLYIELD]="=ODDLYIELD(4/20/2008,6/15/2008,12/24/2007,3.75%,99.875,100,2,0)",e[n.WorksheetFuncId.PI]="=PI()",e[n.WorksheetFuncId.PRICE]="=PRICE(2/15/2008,11/15/2017,5.75%,6.5%,100,2,0)",e[n.WorksheetFuncId.PRICEDISC]="=PRICEDISC(2/16/2008,3/1/2008,5.25%,100,2)",e[n.WorksheetFuncId.PRICEMAT]="=PRICEMAT(2/15/2008,4/13/2008,11/11/2007,6.1%,6.1%,0)",e[n.WorksheetFuncId.QUOTIENT]="=QUOTIENT(5,2)",e[n.WorksheetFuncId.RANDBETWEEN]="=RANDBETWEEN(1,100)",e[n.WorksheetFuncId.RECEIVED]="=RECEIVED(2/15/2008,5/15/2008,1000000,5.75%,2)",e[n.WorksheetFuncId.RECURSE]="=RECURSE()",e[n.WorksheetFuncId.ROUNDDOWN]="=ROUNDDOWN(3.14159,3)",e[n.WorksheetFuncId.ROUNDUP]="=ROUNDUP(3.14159,3)",e[n.WorksheetFuncId.SERIESSUM]="=SERIESSUM(0.785398163,0,2,A4:A7)",e[n.WorksheetFuncId.SQRTPI]="=SQRTPI(1)",e[n.WorksheetFuncId.TBILLEQ]="=TBILLEQ(3/31/2008,6/1/2008,9.14%)",e[n.WorksheetFuncId.TBILLPRICE]="=TBILLPRICE(3/31/2008,6/1/2008,9%)",e[n.WorksheetFuncId.TBILLYIELD]="=TBILLYIELD(3/31/2008,6/1/2008,98.45%)",e[n.WorksheetFuncId.TINV]="=TINV(0.05464,60)",e[n.WorksheetFuncId.WEEKNUM]="=WEEKNUM(3/9/2012,2)",e[n.WorksheetFuncId.WORKDAY]="=WORKDAY(10/1/2008,151)",e[n.WorksheetFuncId.XIRR]="=XIRR(A3:A7, B3:B7, 0.1)",e[n.WorksheetFuncId.XNPV]="=XNPV(0.09, A2:A6, B2:B6)",e[n.WorksheetFuncId.YEARFRAC]="=YEARFRAC(1/1/2012,7/30/2012)",e[n.WorksheetFuncId.YIELD]="=YIELD(2/15/2008,11/15/2016,5.75%,95.04287,100,2,0)",e[n.WorksheetFuncId.YIELDDISC]="=YIELDDISC(2/16/2008,3/1/2008,99.795,100,2)",e[n.WorksheetFuncId.YIELDMAT]="=YIELDMAT(3/15/2008,11/3/2008,11/8/2007,6.25%,100.0123,0)",e[n.WorksheetFuncId.TEXTSPLIT]='=TEXTSPLIT("1,2,3;4,5,6",",",";")',e[n.WorksheetFuncId.TEXTBEFORE]='=TEXTBEFORE("Red riding hood\'s, red hood", "hood")',e[n.WorksheetFuncId.TEXTAFTER]='=TEXTAFTER("Red riding hood\'s, red hood", "hood")',e[n.WorksheetFuncId.VSTACK]="=VSTACK({1,2},{3,4},5)",e[n.WorksheetFuncId.HSTACK]="=HSTACK({1;2},{3;4},5)",e[n.WorksheetFuncId.MAP]="=MAP(A1:C2, LAMBDA(a, IF(a>4,a*a,a)))",e[n.WorksheetFuncId.WRAPROWS]="=WRAPROWS(A2:G2,3)",e[n.WorksheetFuncId.SCAN]="=SCAN(1, A1:C2, LAMBDA(a,b,a*b))",e[n.WorksheetFuncId.MAKEARRAY]="=MAKEARRAY(3, 3, LAMBDA(row,col, row*col))",e[n.WorksheetFuncId.REDUCE]="=REDUCE(, A1:C2, LAMBDA(a,b,a+b^2))",e[n.WorksheetFuncId.NORMSDIST]="=NORMDIST(A2,A3,A4,TRUE)",e[n.WorksheetFuncId.CHOOSEROWS]="=CHOOSEROWS(A2:B7,1,3,5,1)",e[n.WorksheetFuncId.CHOOSECOLS]="=CHOOSECOLS(A2:E7,1,3,5,1)",e[n.WorksheetFuncId.DROP]="=DROP(A2:C4,2)",e[n.WorksheetFuncId.WRAPCOLS]="=WRAPCOLS(A2:F2,3)",e[n.WorksheetFuncId.TOCOL]="=TOCOL(A2:D4)",e[n.WorksheetFuncId.TAKE]="=TAKE(A2:C4,2)",e[n.WorksheetFuncId.TOROW]="=TOROW(A2:D4)",e[n.WorksheetFuncId.BYCOL]="=BYCOL(A1:C2, LAMBDA(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array),", MAX(").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array),")))"),e[n.WorksheetFuncId.BYROW]="=BYROW(A1:C2, LAMBDA(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array),", MAX(").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array),")))"),e[n.WorksheetFuncId.EXPAND]="=EXPAND(A2:B3,3,3)",e[n.WorksheetFuncId.DBCS]='=DBCS("EXCEL")',e[n.WorksheetFuncId.ASC]='=ASC("EXCEL")',e[n.WorksheetFuncId.LENB]='=LENB("EXCEL")',e[n.WorksheetFuncId.FURIGANA]="=PHONETIC(C4)",e[n.WorksheetFuncId.ISOMITTED]='=LAMBDA(x,y, IF(ISOMITTED(y),"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingSecondArgument),'",x+y))(1,)'),e[n.WorksheetFuncId.MIDB]="=MIDB(A2,7,20)",e[n.WorksheetFuncId.RIGHTB]="=RIGHTB(A2,7)",e}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentAssistanceVisitor=void 0;var n=r(0),i=r(22),a=r(9),o=function(e){function t(t,r,n){var a=e.call(this)||this;return a.parsedFormulaTree=t,a.caretPosition=r,a.newNamedObjectsEnabled=n,a.assistedFunctionScopeStart=0,a.fixHandlingWhiteSpace=!1,a.fixHandlingWhiteSpace=(0,i.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces"),a}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){return(t.kind===a.NodeKind.WSF||this.newNamedObjectsEnabled&&t.kind===a.NodeKind.Name)&&this.updateAssistedFunction(t,r),e.prototype.appNode.call(this,t,r,n,i)},t.prototype.letNode=function(t,r,n,i,a,o){var s=e.prototype.letNode.call(this,t,r,n,i,a,o);return this.updateAssistedFunction(t,s.args),s},t.prototype.lambdaNode=function(t,r,n,i,a,o){var s=e.prototype.lambdaNode.call(this,t,r,n,i,a,o);return this.updateAssistedFunction(t,s.args),s},t.prototype.updateAssistedFunction=function(e,t){var r=this.parsedFormulaTree.spans[t[0].label],n=this.parsedFormulaTree.spans[t[t.length-1].label],i=r.start,a=n.end;this.fixHandlingWhiteSpace&&(i-=r.pre.length,a+=n.post.length),this.caretPosition<=a&&this.caretPosition>=i&&(void 0===this.assistedFunctionHead||i>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=i)},t}(r(21).IdentityVisitor);t.ArgumentAssistanceVisitor=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoCompleteEnumVisitor=void 0;var n=r(0),i=r(9),a=function(e){function t(t,r){return e.call(this,t,r)||this}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,a){return t.kind===i.NodeKind.WSF&&this.updateAssistedFunctionAndArgIndex(t,r),e.prototype.appNode.call(this,t,r,n,a)},t.prototype.updateAssistedFunctionAndArgIndex=function(e,t){for(var r=0;r<t.length;r++){var n=this.parsedFormulaTree.spans[t[r].label];if(n&&n.start-n.pre.length<=this.caretPosition&&this.caretPosition<=n.end+n.post.length&&void 0===this.functionHead){this.functionHead=e,this.argIndex=r,this.functionArgs=t,this.stringStartPosition=n.start,this.stringEndPosition=n.end;break}}},t}(r(83).CaretInsideArrayNodeIdentityVisitor);t.AutoCompleteEnumVisitor=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionEnums=void 0;var n=r(36),i=r(13),a=r(72);t.functionEnums=new i.ResettableLazy((function(){var e;return(e={})[n.WorksheetFuncId.ERROR_TYPE]={1:[{value:function(e){var t;return null!==(t=e.errorNames[a.ErrorType.NULL])&&void 0!==t?t:""},description:a.ErrorType.NULL.toString()},{value:function(e){var t;return null!==(t=e.errorNames[a.ErrorType.DIV0])&&void 0!==t?t:""},description:a.ErrorType.DIV0.toString()},{value:function(e){var t;return null!==(t=e.errorNames[a.ErrorType.VALUE])&&void 0!==t?t:""},description:a.ErrorType.VALUE.toString()},{value:function(e){var t;return null!==(t=e.errorNames[a.ErrorType.REF])&&void 0!==t?t:""},description:a.ErrorType.REF.toString()},{value:function(e){var t;return null!==(t=e.errorNames[a.ErrorType.NAME])&&void 0!==t?t:""},description:a.ErrorType.NAME.toString()},{value:function(e){var t;return null!==(t=e.errorNames[a.ErrorType.NUM])&&void 0!==t?t:""},description:a.ErrorType.NUM.toString()},{value:function(e){var t;return null!==(t=e.errorNames[a.ErrorType.NA])&&void 0!==t?t:""},description:a.ErrorType.NA.toString()}]},e[n.WorksheetFuncId.SUBTOTAL]={1:[{value:"1",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)}},{value:"3",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)}},{value:"4",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MAX)}},{value:"5",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MIN)}},{value:"6",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)}},{value:"7",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)}},{value:"8",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)}},{value:"9",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}},{value:"10",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.VAR)}},{value:"11",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.VARP)}},{value:"101",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)}},{value:"102",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)}},{value:"103",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)}},{value:"104",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MAX)}},{value:"105",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MIN)}},{value:"106",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)}},{value:"107",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)}},{value:"108",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)}},{value:"109",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}},{value:"110",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.VAR)}},{value:"111",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.VARP)}}]},e[n.WorksheetFuncId.AGGREGATE]={1:[{value:"1",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)}},{value:"3",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)}},{value:"4",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MAX)}},{value:"5",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MIN)}},{value:"6",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.PRODUCT)}},{value:"7",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.STDEV)}},{value:"8",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.STDEVP)}},{value:"9",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}},{value:"10",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.VAR)}},{value:"11",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.VARP)}},{value:"12",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)}},{value:"13",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MODE_SNGL)}},{value:"14",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.LARGE)}},{value:"15",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.SMALL)}},{value:"16",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_INC)}},{value:"17",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_INC)}},{value:"18",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.PERCENTILE_EXC)}},{value:"19",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.QUARTILE_EXC)}}],2:[{value:"0",description:function(e){return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))}},{value:"1",description:function(e){return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))}},{value:"2",description:function(e){return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))}},{value:"3",description:function(e){return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",e.getWorksheetFuncName(n.WorksheetFuncId.SUBTOTAL)).replace("{1}",e.getWorksheetFuncName(n.WorksheetFuncId.AGGREGATE))}},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNothing)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRows)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValues)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValues)}]},e[n.WorksheetFuncId.CUBESET]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.None)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaAscending)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaDescending)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalAscending)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalDescending)}]},e[n.WorksheetFuncId.VLOOKUP]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},e[n.WorksheetFuncId.HLOOKUP]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},e[n.WorksheetFuncId.XLOOKUP]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},e[n.WorksheetFuncId.RANK]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},e[n.WorksheetFuncId.RANK_AVG]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},e[n.WorksheetFuncId.RANK_EQ]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},e[n.WorksheetFuncId.MATCH]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LessThan)},{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GreaterThan)}]},e[n.WorksheetFuncId.XMATCH]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},e[n.WorksheetFuncId.FINDN]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}],7:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheFirstCharacterPositionOfTheString)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheLastCharacterPositionOfTheString)}]},e[n.WorksheetFuncId.TEXTBEFORE]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},e[n.WorksheetFuncId.TEXTAFTER]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},e[n.WorksheetFuncId.TEXTSPLIT]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}]},e[n.WorksheetFuncId.ACCRINT]={6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.ACCRINTM]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.ADDRESS]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)}],3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Absolute)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AbsoluteRowRelativeColumn)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RelativeRowAbsoluteColumn)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Relative)}]},e[n.WorksheetFuncId.AMORDEGRC]={7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.AMORLINC]={7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.BETA_DIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.BINOMDIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[n.WorksheetFuncId.BINOM_DIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[n.WorksheetFuncId.CHISQ_DIST]={3:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.COMPLEX]={3:[{value:"i",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ISuffixDescriptionForComplexNumber)},{value:"j",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.JSuffixDescriptionForComplexNumber)}]},e[n.WorksheetFuncId.COUPDAYBS]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.COUPDAYS]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.COUPDAYSNC]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.COUPNCD]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.COUPNUM]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.COUPPCD]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.CUMIPMT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.CUMPRINC]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.DAYS360]={3:[{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASDMethod)},{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EuropeanMethod)}]},e[n.WorksheetFuncId.DISC]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.DURATION]={5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.EXPONDIST]={3:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.EXPON_DIST]={3:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.F_DIST]={3:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.FIXED]={3:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PreventCommas)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotPreventCommas)}]},e[n.WorksheetFuncId.FV]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.GAMMADIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.GAMMA_DIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.HYPGEOM_DIST]={5:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.INDIRECT]={2:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)}]},e[n.WorksheetFuncId.INTRATE]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.IPMT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.LINEST]={3:[{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},e[n.WorksheetFuncId.LOGEST]={3:[{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},e[n.WorksheetFuncId.LOGNORM_DIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.MDURATION]={5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.NEGBINOM_DIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[n.WorksheetFuncId.NORM_S_DIST]={2:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.NORMDIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[n.WorksheetFuncId.NORM_DIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[n.WorksheetFuncId.NPER]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.ODDFPRICE]={8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.ODDFYIELD]={8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.ODDLPRICE]={7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.ODDLYIELD]={7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.PMT]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.POISSON]={3:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[n.WorksheetFuncId.POISSON_DIST]={3:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[n.WorksheetFuncId.PPMT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.PRICE]={6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.PRICEDISC]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.PRICEMAT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.QUARTILE]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},e[n.WorksheetFuncId.QUARTILE_INC]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},e[n.WorksheetFuncId.QUARTILE_EXC]={2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)}]},e[n.WorksheetFuncId.RATE]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.RECEIVED]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.ROMAN]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Classic)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Simplified)}]},e[n.WorksheetFuncId.STOCKHISTORY]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Daily)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Weekly)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monthly)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoHeader)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Showheader)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ShowInstrumentIdentifierAndHeader)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],10:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],11:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}]},e[n.WorksheetFuncId.TREND]={4:[{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},e[n.WorksheetFuncId.TTEST]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},e[n.WorksheetFuncId.T_TEST]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},e[n.WorksheetFuncId.VDB]={7:[{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SwitchToStraightLineDepreciation)},{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotSwitchToStraightLineDepreciation)}]},e[n.WorksheetFuncId.WEEKDAY]={2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers0Mondaythrough6Sunday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Tuesdaythrough7Monday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Wednesdaythrough7Tuesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Thursdaythrough7Wednesday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Fridaythrough7Thursday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Saturdaythrough7Friday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)}]},e[n.WorksheetFuncId.WEIBULL]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.WEIBULL_DIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.YEARFRAC]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.YIELD]={6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.YIELDDISC]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.YIELDMAT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[n.WorksheetFuncId.GROWTH]={4:[{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},e[n.WorksheetFuncId.PV]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[n.WorksheetFuncId.TDIST]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}]},e[n.WorksheetFuncId.T_DIST]={4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[n.WorksheetFuncId.WEEKNUM]={2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wednesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Thursday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Friday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Saturday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"21",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}]},e[n.WorksheetFuncId.NETWORKDAYS_INTL]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},e[n.WorksheetFuncId.WORKDAY_INTL]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},e[n.WorksheetFuncId.FORECAST_ETS]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)}},{value:"3",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)}},{value:"4",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MAX)}},{value:"5",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MIN)}},{value:"7",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}}]},e[n.WorksheetFuncId.FORECAST_ETS_CONFINT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],7:[{value:"1",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)}},{value:"3",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)}},{value:"4",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MAX)}},{value:"5",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MIN)}},{value:"7",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}}]},e[n.WorksheetFuncId.FORECAST_ETS_SEASONALITY]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],4:[{value:"1",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)}},{value:"3",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)}},{value:"4",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MAX)}},{value:"5",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MIN)}},{value:"7",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}}]},e[n.WorksheetFuncId.FORECAST_ETS_STAT]={4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaParameterOfETSalgorithm)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BetaParameterOfETSalgorithm)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GammaParameterOfETSalgorithm)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MASEMetric)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMAPEMetric)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MAEMetric)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RMSEMetric)},{value:"8",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.StepSizeDetected)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNT)}},{value:"3",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.COUNTA)}},{value:"4",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MAX)}},{value:"5",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.MIN)}},{value:"7",description:function(e){return e.getWorksheetFuncName(n.WorksheetFuncId.SUM)}}]},e[n.WorksheetFuncId.TEXTJOIN]={2:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}]},e[n.WorksheetFuncId.SORT]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}],4:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByColumn)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByRow)}]},e[n.WorksheetFuncId.UNIQUE]={2:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueColumns)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueRows)}],3:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnitemsthatAppearExactlyOnce)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnEveryDistinctItem)}]},e[n.WorksheetFuncId.SORTBY]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}]},e[n.WorksheetFuncId.RANDARRAY]={5:[{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Integer)},{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Decimal)}]},e[n.WorksheetFuncId.VALUETOTEXT]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},e[n.WorksheetFuncId.ARRAYTOTEXT]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},e[n.WorksheetFuncId.TOCOL]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},e[n.WorksheetFuncId.TOROW]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:function(e){return e.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:function(e){return e.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},e[n.WorksheetFuncId.IMAGE]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FitCell)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FillCell)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OriginalSize)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CustomSize)}]},e}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConvertEnum=t.speedUnitTypeEnums=t.informationUnitTypeEnums=t.areaUnitTypeEnums=t.volumeUnitTypeEnums=t.temperatureUnitTypeEnums=t.magnetismUnitTypeEnums=t.powerUnitTypeEnums=t.energyUnitTypeEnums=t.forceUnitTypeEnums=t.pressureUnitTypeEnums=t.timeUnitTypeEnums=t.distanceUnitTypeEnums=t.massUnitTypeEnums=void 0;var n=r(13);t.massUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"g",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gram)},{value:"sg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Slug)},{value:"lbm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundM)},{value:"u",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atomic)},{value:"ozm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ozm)},{value:"grain",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Grain)},{value:"cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeight)},{value:"uk_cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeightUk)},{value:"stone",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Stone)},{value:"ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ton)},{value:"uk_ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TonUk)}]})),t.distanceUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"m",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Meter)},{value:"mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMile)},{value:"Nmi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMile)},{value:"in",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Inch)},{value:"ft",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ft)},{value:"yd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yd)},{value:"ang",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Angs)},{value:"Pica",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pica)},{value:"ell",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ell)},{value:"ly",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYr)},{value:"parsec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Parsec)},{value:"survey_mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MileUs)}]})),t.timeUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"yr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yr)},{value:"day",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Day)},{value:"hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hour)},{value:"mn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Minute)},{value:"sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sec)}]})),t.pressureUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"Pa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pascal)},{value:"atm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atmos)},{value:"mmHg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Merc)},{value:"psi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Psi)},{value:"Torr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Torr)}]})),t.forceUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"N",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Newton)},{value:"dyn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Dyne)},{value:"lbf",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundF)},{value:"pond",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pond)}]})),t.energyUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"J",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Joule)},{value:"e",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Erg)},{value:"cal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ItCal)},{value:"eV",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volt)},{value:"HPh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePwHr)},{value:"Wh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WattHr)},{value:"flb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FtPound)},{value:"BTU",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Btu)},{value:"c",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThermCal)}]})),t.powerUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"HP",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePw)},{value:"W",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Watt)},{value:"PS",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorseStr)}]})),t.magnetismUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"T",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tessla)},{value:"ga",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gauss)}]})),t.temperatureUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"C",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cels)},{value:"F",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fahr)},{value:"K",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Kelv)},{value:"Rank",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Rankine)},{value:"Reau",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Reaumur)}]})),t.volumeUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"tsp",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tsp)},{value:"tbs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tbs)},{value:"oz",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Oz)},{value:"cup",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cup)},{value:"qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUs)},{value:"gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gal)},{value:"l",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Liter)},{value:"uk_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUk)},{value:"us_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUs)},{value:"ang^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow3)},{value:"barrel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Barrel)},{value:"bushel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bushel)},{value:"ft^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow3)},{value:"GRT",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegTon)},{value:"in^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow3)},{value:"ly^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow3)},{value:"mi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow3)},{value:"MTON",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeasTon)},{value:"Nmi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow3)},{value:"Pica^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow3)},{value:"tspm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MdnTsp)},{value:"uk_gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GalUk)},{value:"yd^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow3)},{value:"uk_qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUk)}]})),t.areaUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"uk_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUk)},{value:"us_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUs)},{value:"ang^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow2)},{value:"ar",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Are)},{value:"ft^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow2)},{value:"ha",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hectare)},{value:"in^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow2)},{value:"ly^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow2)},{value:"m^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeterPow2)},{value:"Morgen",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Morgen)},{value:"mi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow2)},{value:"Nmi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow2)},{value:"Pica^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow2)},{value:"yd^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow2)}]})),t.informationUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"bit",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bit)},{value:"byte",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Byte)}]})),t.speedUnitTypeEnums=new n.ResettableLazy((function(){return[{value:"admkn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AdmKnot)},{value:"kn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Knot)},{value:"m/hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashHr)},{value:"m/sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashSec)},{value:"mph",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MPH)}]}));var i=new n.ResettableLazy((function(){return[t.massUnitTypeEnums,t.distanceUnitTypeEnums,t.timeUnitTypeEnums,t.pressureUnitTypeEnums,t.forceUnitTypeEnums,t.energyUnitTypeEnums,t.powerUnitTypeEnums,t.magnetismUnitTypeEnums,t.temperatureUnitTypeEnums,t.volumeUnitTypeEnums,t.areaUnitTypeEnums,t.informationUnitTypeEnums,t.speedUnitTypeEnums]}));t.getConvertEnum=function(e,t,r,n){var a,o=i.getValue().map((function(e){return e.getValue()})),s=(a=[]).concat.apply(a,o);if(2===e)return s;if(3===e){var u=function(e,t,r){var n,a=e.spans[r[1].label].start,o=e.spans[r[1].label].end,s=null!==(n=t.substring(a,o).replace(/^"|"$/g,""))&&void 0!==n?n:"";if(""===s)return[];for(var u=0,l=i.getValue();u<l.length;u++){var c=l[u];if(c.getValue().find((function(e){return e.value===s})))return c.getValue()}return[]}(t,r,n);return u.length>0?u:s}return[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteLetVisitor=void 0;var n=r(0),i=r(9),a=function(e){function t(t,r,n,i){var a=e.call(this,n,i)||this;return a.autoCompleteForCellRefEnabled=t,a.formulaString=r,a}return n.__extends(t,e),t.prototype.nameNode=function(t,r,n){return this.updateCaretNodeText(n,t.asWhole),e.prototype.nameNode.call(this,t,r,n)},t.prototype.cellRefNode=function(t,r,n){var a=this.parsedFormulaTree.spans[n];if(this.autoCompleteForCellRefEnabled&&t.kind===i.CellRefKind.Single&&a){var o=this.formulaString.substring(a.start,a.end);this.updateCaretNodeText(n,o)}return e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.updateCaretNodeText=function(e,t){var r,n=null===(r=this.parsedFormulaTree.spans[e])||void 0===r?void 0:r.end;void 0!==n&&this.caretPosition===n&&t.length>0&&(this.caretNodeText=t)},t}(r(83).ExtractLetVisitor);t.AutocompleteLetVisitor=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteRichValueVisitor=void 0;var n=r(0),i=r(2),a=r(12),o=r(9),s=r(6),u=r(14),l=r(22),c=r(99),d=function(e){function t(t,r,n,i,a){var o=e.call(this,t,r)||this;return o.formulaText=n,o.definedNames=i,o.activeCell=a,o.dotNotationPath="",o.richValueItemPrefix="",o.dotNotationIndex=0,o.shouldAddEmptySuggestion=!1,o.onlySendNestedDotNotationPathEnabled=(0,l.isTypedChangeGateEnabled)("OfficeVSO:6476056_OnlySendNestedDotNotationPath"),o.passLogFunctionToGetRangeFromCellRef=(0,u.isChangeGateEnabled)("OfficeVSO:7251290_PassLogFunctionToGetRangeFromCellRef"),o}return n.__extends(t,e),t.prototype.nameNode=function(t,r,n){var a,s,u=null===(a=this.parsedFormulaTree.spans[n])||void 0===a?void 0:a.end;if(u===this.caretPosition&&t.kind===o.NamePartKind.IdentNamePart&&this.trySetDefinedName(t)&&(this.dotNotationIndex=u,this.childFieldRefLabel=n),t.kind===o.NamePartKind.FieldRefNamePart){var l=null===(s=this.parsedFormulaTree.spans[t.lhs.label])||void 0===s?void 0:s.end;if((0,i.isDefined)(l)&&(this.caretPosition===u||this.isCaretAfterDotBeforeStartOfFieldRef(l,t.rhs)&&t.lhs.kind!==o.NamePartKind.FieldRefNamePart)){var c=!1;t.lhs.kind===o.NamePartKind.CellRefNamePart?(this.setCellRef(t.lhs.ref,r),c=!0):t.lhs.kind===o.NamePartKind.IdentNamePart&&this.trySetDefinedName(t.lhs)&&(c=!0),c&&(this.dotNotationIndex=l,t.rhs.field.kind===o.NodeKind.Ident&&(this.caretPosition===u?this.richValueItemPrefix=t.rhs.field.whole:this.fieldRefChainEndIndex=u))}}return e.prototype.nameNode.call(this,t,r,n)},t.prototype.cellRefNode=function(t,r,n){var i,a=null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.end;return void 0!==a&&this.caretPosition===a&&(this.setCellRef(t,r),this.dotNotationIndex=a,this.childFieldRefLabel=n,this.shouldAddEmptySuggestion=!0),e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.fieldRefNode=function(t,r,n){var i,a,o=null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.end,s=null===(a=this.parsedFormulaTree.spans[t.label])||void 0===a?void 0:a.end;return void 0===o||void 0===s||(this.isCaretAtEndOfFieldRefNode(o,r)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(t,n),this.dotNotationIndex=s,this.richValueItemPrefix=p(r)):this.isCaretAfterDotBeforeStartOfFieldRef(s,r)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(t,n),this.dotNotationIndex=s,this.fieldRefChainEndIndex=o):t.label===this.childFieldRefLabel&&(this.fieldRefChainEndIndex=o,this.childFieldRefLabel=n)),e.prototype.fieldRefNode.call(this,t,r,n)},t.prototype.structRefNode=function(t,r,n){var a,u=e.prototype.structRefNode.call(this,t,r,n),l=null===(a=this.parsedFormulaTree.spans[n])||void 0===a?void 0:a.end;this.caretPosition===l&&(0,i.isDefined)(t)&&r.isClosed&&u.kind===o.NodeKind.StructRef&&(this.definedNames.some((function(e){return e.type===s.DefinedNameInfoType.Table&&(0,i.isDefined)(e.name)&&e.name.toLowerCase()===t.whole.toLowerCase()}))&&(this.setNamedNodeRef(u),this.dotNotationIndex=l));return u},t.prototype.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath=function(e,t){for(var r=e;r.kind===o.NodeKind.FieldRef;)this.dotNotationPath="["+p(r.rhs)+"]."+this.dotNotationPath,r=r.lhs;r.kind===o.NodeKind.CellRef&&this.setCellRef(r.ref,r.qualifier),r.kind===o.NodeKind.StructRef&&this.setNamedNodeRef(r),r.kind===o.NodeKind.Name&&this.trySetDefinedName(r.parts),this.childFieldRefLabel=t},t.prototype.getRefString=function(e){var t,r,n=null===(t=this.parsedFormulaTree.spans[e])||void 0===t?void 0:t.start,a=null===(r=this.parsedFormulaTree.spans[e])||void 0===r?void 0:r.end;return(0,i.isDefined)(n)&&(0,i.isDefined)(a)&&n>=0&&a<this.formulaText.length?this.formulaText.substring(n,a):""},t.prototype.setCellRef=function(e,t){var r=this;e.kind!==o.CellRefKind.Single&&e.kind!==o.CellRefKind.Range||(this.cellRef=(0,c.getRangeFromCellRef)(e,this.activeCell,this.passLogFunctionToGetRangeFromCellRef?m:void 0)),(0,i.isDefined)(t)&&(this.sheetName=(0,c.getSheetNameFromQualifier)(t,m)),this.trySetDotNotationPathOrigin((function(){return r.getRefString(e.label)}))},t.prototype.setNamedNodeRef=function(e){var t=this;this.namedRangeNode=e,this.trySetDotNotationPathOrigin((function(){return t.getRefString(e.label)}))},t.prototype.isCaretAfterDotBeforeStartOfFieldRef=function(e,t){var r;if(!(0,i.isDefined)(t))return!1;var n=null===(r=this.parsedFormulaTree.spans[t.field.label])||void 0===r?void 0:r.start;return void 0!==n&&this.caretPosition>e&&(this.caretPosition<n||!t.isBracketed&&this.caretPosition===n)},t.prototype.isCaretAtEndOfFieldRefNode=function(e,t){var r;if(this.caretPosition===e)return!0;var n=null===(r=this.parsedFormulaTree.spans[t.field.label])||void 0===r?void 0:r.end;return!(!(0,i.isDefined)(n)||this.caretPosition!==n)},t.prototype.trySetDefinedName=function(e){if(e.canDenoteNamedObject){var t=this.definedNames.find((function(t){var r;return(null===(r=t.name)||void 0===r?void 0:r.toLowerCase())===e.asWhole.toLowerCase()}));if((0,i.isDefined)(t))return this.setDefinedName(t),!0}return!1},t.prototype.setDefinedName=function(e){var t,r=e.namedRange;if((0,i.isDefined)(r)){var n=null!==(t=e.sheetName)&&void 0!==t?t:r.sheetName;(0,i.isDefined)(n)&&(this.sheetName=n),this.cellRef={firstRow:r.top-1,firstColumn:r.left-1,lastRow:r.bottom-1,lastColumn:r.right-1},this.trySetDotNotationPathOrigin((function(){return e.name}))}},t.prototype.trySetDotNotationPathOrigin=function(e){if(this.onlySendNestedDotNotationPathEnabled){if(this.dotNotationPath.length>0){var t=e();(0,i.isDefined)(t)?this.dotNotationPath=t+"."+this.dotNotationPath:m("tryUpdateDotNotationPath with undefined name")}}else this.dotNotationPath=e()+(this.dotNotationPath.length>0?"."+this.dotNotationPath:"")},t}(r(83).CaretInsideArrayNodeIdentityVisitor);function p(e){return e.field.kind!==o.NodeKind.Ident?"":e.field.whole}function m(e){a.ulsLogger.ULS.traceTag(523257827,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"AutocompleteRichValueVisitor failed with msg: ".concat(e))}t.AutocompleteRichValueVisitor=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;var n=r(37);t.isUnbracketedField=n.parseFieldRefModule.isUnbracketedField,t.parseFieldRef=n.parseFieldRefModule.parseFieldRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitor=void 0;var n=r(0),i=r(2),a=r(9),o=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.tableNames=n,o.isWithinThisRowOp=!1,o.isStructRefClosed=!1,o.isNodeClosed=!1,o.findContainingNode=function(e){var t=o.parsedFormulaTree.spans[e.label];if(o.isCaretInNode(e))switch(e.kind){case a.StructRefKind.SpecialRef:case a.StructRefKind.ColumnRef:case a.StructRefKind.BadRef:o.isTighterThanCurrent(t)&&(o.containingNode=t,o.isNodeClosed=o.getIsNodeClosed(e));break;case a.StructRefKind.ThisRowOpRef:var r=e.ref;if(o.isCaretInBeginningOfNode(t))break;o.isWithinThisRowOp=!0,(0,i.isDefined)(r)?o.findContainingNode(r):o.isTighterThanCurrent(t)&&(o.containingNode=t,o.isNodeClosed=o.isStructRefClosed);break;case a.StructRefKind.CommaOpRef:if(o.isCaretInBeginningOfNode(t))break;e.refs.map(o.findContainingNode);break;case a.StructRefKind.RangeOpRef:if(o.isCaretInBeginningOfNode(t))break;var n=e;o.findContainingNode(n.lhs),o.findContainingNode(n.rhs);break;case a.StructRefKind.MissingRef:o.containingNode=void 0}},o.isTighterThanCurrent=function(e){return(0,i.isDefined)(e)&&((0,i.isNone)(o.containingNode)||e.end<o.containingNode.end||e.start>o.containingNode.start)},o}return n.__extends(t,e),t.prototype.structRefNode=function(t,r,n){var i=this;if(this.isCaretInNode(r)){t&&this.tableNames.forEach((function(e){e.toLocaleLowerCase()===t.whole.toLocaleLowerCase()&&(i.tableName=e)}));var a=this.parsedFormulaTree.spans[r.label];this.isNodeClosed=this.isStructRefClosed=r.isClosed,this.containingNode=a,void 0!==r.innerRef&&this.findContainingNode(r.innerRef)}return e.prototype.structRefNode.call(this,t,r,n)},t.prototype.getIsNodeClosed=function(e){return e.isBracketed?e.isClosed:this.isStructRefClosed},t.prototype.isCaretInNode=function(e){var t=this.parsedFormulaTree.spans[e.label];return(0,i.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start},t.prototype.isCaretInBeginningOfNode=function(e){return(0,i.isDefined)(e)&&this.caretPosition===e.start},t}(r(83).CaretInsideArrayNodeIdentityVisitor);t.AutocompleteTableHeadersVisitor=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteTableHeadersVisitorOld=void 0;var n=r(0),i=r(2),a=r(9),o=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.tableNames=n,o.isWithinThisRowOp=!1,o.isNodeClosed=!1,o.findContainingNode=function(e){var t=o.parsedFormulaTree.spans[e.label];if(o.isCaretInNode(e))switch(e.kind){case a.StructRefKind.SpecialRef:case a.StructRefKind.ColumnRef:case a.StructRefKind.BadRef:o.isTighterThanCurrent(t)&&(o.containingNode=t);break;case a.StructRefKind.ThisRowOpRef:var r=e.ref;o.isWithinThisRowOp=!0,(0,i.isDefined)(r)?o.findContainingNode(r):o.isTighterThanCurrent(t)&&(o.containingNode=t);break;case a.StructRefKind.CommaOpRef:e.refs.map(o.findContainingNode);break;case a.StructRefKind.RangeOpRef:var n=e;o.findContainingNode(n.lhs),o.findContainingNode(n.rhs);break;case a.StructRefKind.MissingRef:o.containingNode=void 0}},o.isTighterThanCurrent=function(e){return(0,i.isDefined)(e)&&((0,i.isNone)(o.containingNode)||e.end<o.containingNode.end||e.start>o.containingNode.start)},o}return n.__extends(t,e),t.prototype.structRefNode=function(t,r,n){var i=this;return this.isCaretInNode(r)&&(t&&this.tableNames.forEach((function(e){e.toLocaleLowerCase()===t.whole.toLocaleLowerCase()&&(i.tableName=e)})),void 0===r.innerRef?this.containingNode=this.parsedFormulaTree.spans[r.label]:this.findContainingNode(r.innerRef)),e.prototype.structRefNode.call(this,t,r,n)},t.prototype.isCaretInNode=function(e){var t=this.parsedFormulaTree.spans[e.label];return(0,i.isDefined)(t)&&this.caretPosition<=t.end&&this.caretPosition>=t.start},t}(r(83).CaretInsideArrayNodeIdentityVisitor);t.AutocompleteTableHeadersVisitorOld=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParenthesesCouplingVisitor=void 0;var n=r(0),i=r(9),a=function(e){function t(t,r){var n=e.call(this)||this;return n.formula=t,n.caretPosition=r,n.parenthesesSpan=void 0,n.checkLeft=!1,n.checkRight=!1,n.areParenthesesLeftOfCaret=!1,n}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,a){return t.kind!==i.NodeKind.Operator&&this.matchFormula(t,n,a),e.prototype.appNode.call(this,t,r,n,a)},t.prototype.parenNode=function(t,r,n){var i=this.formula.spans[n];return r&&i&&this.matchParentheses(i.start,i.end-1),e.prototype.parenNode.call(this,t,r,n)},t.prototype.letNode=function(t,r,n,i,a,o){return this.matchFormula(t,a,o),e.prototype.letNode.call(this,t,r,n,i,a,o)},t.prototype.lambdaNode=function(t,r,n,i,a,o){return this.matchFormula(t,a,o),e.prototype.lambdaNode.call(this,t,r,n,i,a,o)},t.prototype.matchFormula=function(e,t,r){var n=this.formula.spans[r],i=this.formula.spans[e.label];t&&n&&i&&this.matchParentheses(i.end,n.end-1)},t.prototype.matchParentheses=function(e,t){e===this.caretPosition&&(this.checkRight=!0),t===this.caretPosition-1&&(this.checkLeft=!0),this.checkRight&&this.shouldUpdateLocation(e,t,this.caretPosition+1)||this.shouldUpdateLocation(e,t,this.caretPosition)?(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!1):this.checkLeft&&this.shouldUpdateLocation(e,t,this.caretPosition-1)&&(this.parenthesesSpan={start:e,end:t},this.areParenthesesLeftOfCaret=!0)},t.prototype.shouldUpdateLocation=function(e,t,r){return e<r&&r<=t&&(void 0===this.parenthesesSpan||this.areParenthesesLeftOfCaret&&e<=this.parenthesesSpan.start||e>this.parenthesesSpan.start)},t}(r(21).IdentityVisitor);t.ParenthesesCouplingVisitor=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColoredReferencesVisitor=void 0;var n=r(0),i=r(2),a=r(12),o=r(36),s=r(6),u=r(9),l=r(9),c=r(21),d=r(99),p=r(11),m=r(209),f=r(145),g=r(6),h=function(e){function t(t,r,n,i,a,o){var s=e.call(this)||this;return s.activeCell=t,s.parsedFormulaTree=r,s.formulaString=n,s.sheetNames=i,s.definedNameInfoList=a,s.failureCallback=o,s.structRefNodes=[],s.formulaHighlights=[],s.activeCellSheetName=void 0,s._namedObjectsMap=void 0,s}return n.__extends(t,e),t.prototype.structRefNode=function(t,r,n){var i=e.prototype.structRefNode.call(this,t,r,n);return this.structRefNodes.push(i),i},t.prototype.nameNode=function(t,r,n){var a=e.prototype.nameNode.call(this,t,r,n);if(!this.isRefInActiveSheet(r))return a;if(a.parts.kind===u.NamePartKind.FieldRefNamePart)return this.createAndAppendFieldRefHighlight(a.parts.lhs),a;if(!(0,i.isDefined)(this.namedObjectsMap))return a;var o=this.namedObjectsMap.get(t.asWhole.toLocaleLowerCase());return void 0!==o&&o.type!==g.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(n,o),a},t.prototype.cellRefNode=function(t,r,n){var i=e.prototype.cellRefNode.call(this,t,r,n);if(!(0,d.isValidCellRef)(t)||!this.isRefInActiveSheet(r))return i;var a=this.parsedFormulaTree.spans[n];if(a){var o=this.createRangeInfoFromCellRef(t),u=this.formulaSpanToHighlightingSpan(a,l.NodeKind.CellRef);this.formulaHighlights.push(v(s.HighlightKind.CellRef,u,o))}return i},Object.defineProperty(t.prototype,"namedObjectsMap",{get:function(){return(0,i.isDefined)(this._namedObjectsMap)||(0,i.isDefined)(this.definedNameInfoList)&&(this._namedObjectsMap=(0,d.createNameToDefinedNameInfoMapping)(this.definedNameInfoList)),this._namedObjectsMap},enumerable:!1,configurable:!0}),t.prototype.createAndAppendNamedRefHighlight=function(e,t){var r=this.parsedFormulaTree.spans[e];if((0,i.isDefined)(r)&&(0,i.isDefined)(this.sheetNames)){var n=t.sheetName;if((0,i.isDefined)(n)){var a=(0,d.getSheetIndexFromSheetName)(n,this.sheetNames);if((0,i.isDefined)(a)){if((0,p.isSheetIndexEqual)(a,this.activeCell.sheet)){var o=(0,f.getRangeFromDefinedName)(t);void 0!==o&&this.formulaHighlights.push(v(s.HighlightKind.NamedRange,r,{range:o}))}}else S("createAndAppendNamedRef: sheetIndex undefined, DefinedNameInfo type: ".concat(t.type))}else S("createAndAppendNamedRef - sheetName undefined, DefinedNameInfo type: ".concat(t.type))}},t.prototype.createAndAppendFieldRefHighlight=function(e){switch(e.kind){case u.NamePartKind.CellRefNamePart:this.createAndAppendCellRefPartHighlight(e);break;case u.NamePartKind.IdentNamePart:if(!(0,i.isDefined)(this.namedObjectsMap))return;var t=this.namedObjectsMap.get(e.asWhole.toLocaleLowerCase());void 0!==t&&t.type!==g.DefinedNameInfoType.Invalid&&this.createAndAppendNamedRefHighlight(e.label,t);break;case u.NamePartKind.FieldRefNamePart:this.createAndAppendFieldRefHighlight(e.lhs)}},t.prototype.createAndAppendCellRefPartHighlight=function(e){var t=this.parsedFormulaTree.spans[e.label];if((0,i.isDefined)(t)){var r=this.createRangeInfoFromCellRef(e.ref),n=this.formulaSpanToHighlightingSpan(t,l.NodeKind.CellRef),a=v(s.HighlightKind.CellRef,n,r);this.formulaHighlights.push(a)}},t.prototype.formulaSpanToHighlightingSpan=function(e,t){var r,i,a=n.__assign({},e);return t===l.NodeKind.CellRef&&(r=e,(i=this.formulaString).length>r.end&&i.charAt(r.end)===o.operatorStrings[o.OperatorId.Pound]&&(a.end+=1)),a},t.prototype.createRangeInfoFromCellRef=function(e){return{range:(0,d.getRangeFromCellRef)(e,this.activeCell.range,S),positionKindInfo:(0,m.getPositionKindInfoFromCellRef)(e)}},t.prototype.isRefInActiveSheet=function(e){var t;if(!(0,i.isDefined)(e))return!0;if(!(0,i.isDefined)(this.sheetNames))return!1;var r=(0,d.getSheetIndexFromQualifier)(e,this.sheetNames,this.failureCallback);return(0,i.isDefined)(r)?(0,p.isSheetIndexEqual)(r,this.activeCell.sheet):(null===(t=this.failureCallback)||void 0===t||t.call(this,"CellRefHighlightCreator.isRefInActiveSheet: sheetIndex is undefined"),!1)},t}(c.IdentityVisitor);function v(e,t,r){return{kind:e,span:t,rangeInfo:r}}function S(e){a.ulsLogger.ULS.traceTag(520935561,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"ColoredReferencesVisitor encountered a failure with msg ".concat(e))}t.ColoredReferencesVisitor=h},function(e,t,r){"use strict";var n,i,a,o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.ensureGroupAttachedLegacy=t.ensureGroupAttached=t.ensurePluginAttached=t.setX10Features=t.ensurePluginAttachedLegacy=t.resolveScriptLoaderPromise=void 0;var u=r(0),l=r(22),c=r(319),d=r(546),p=r(31),m=r(321),f=r(323),g=r(328),h=r(329),v=r(330),S=r(324),y=r(325),F=r(548),C=r(326),R=r(327),b=r(331),E=r(552),P=r(4),k=r(12),T=r(2),A=r(47),N=r(97),_=r(60),I=r(6),O=r(553),M=r(208),D={Web:(n={},n[I.PluginFactoryName.ArgumentAssistancePlugin]=[c.argumentAssistancePluginDependenciesResolved,void 0,void 0,"ArgumentAssistance"],n[I.PluginFactoryName.AutocompletePlugin]=[d.autocompletePluginDependenciesResolved,void 0,void 0,"SmartSuggestionsAutoComplete"],n[I.PluginFactoryName.AutocompleteFunctionPlugin]=[m.autocompleteFunctionPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],n[I.PluginFactoryName.ParenthesesCouplingPlugin]=[g.parenthesesCouplingPluginDependenciesResolved,void 0,void 0,"ParenthesisCoupling"],n[I.PluginFactoryName.ColoredReferencesPlugin]=[h.coloredReferencesPluginDependenciesResolved,void 0,void 0,"ColoredReferences"],n[I.PluginFactoryName.GotoCtrlClickPlugin]=[v.gotoCtrlClickPluginDependenciesResolved,void 0,void 0,"GotoCtrlClick"],n[I.PluginFactoryName.AutocompleteLetPlugin]=[S.autocompleteLetPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],n[I.PluginFactoryName.AutocompleteRichValuePlugin]=[y.autocompleteRichValuePluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],n[I.PluginFactoryName.FormulaCollectionPlugin]=[F.formulaCollectionPluginDependenciesResolved,"Microsoft.Office.Excel.FormulaCollection"],n[I.PluginFactoryName.AutocompleteNamedObjectsPlugin]=[C.autocompleteNamedObjectsPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],n[I.PluginFactoryName.ParserPerformanceMeasurements]=[d.parserPerformanceMeasurementsAttach,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],n[I.PluginFactoryName.AutocompleteTableHeadersPlugin]=[R.autocompleteTableHeadersPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],n[I.PluginFactoryName.ValuePreviewPlugin]=[b.valuePreviewPluginDependenciesResolved,void 0,void 0,"ValuePreview"],n[I.PluginFactoryName.SyntaxErrorsPlugin]=[O.syntaxErrorsPluginDependenciesResolved,void 0,void 0,"SyntaxErrors"],n[I.PluginFactoryName.AutocompleteRangeSuggestionPlugin]=[d.autocompleteRangeSuggestionPluginAttach,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin"],n[I.PluginFactoryName.AutocompleteWrapperPlugin]=[d.autocompleteWrapperPluginAttach,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled"],n[I.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]=[d.autocompleteBinaryModelExperimentPluginAttach,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin"],n[I.PluginFactoryName.FormulaRepairShadowEvalPlugin]=[O.formulaRepairShadowEvalPluginDependenciesResolved,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled"],n[I.PluginFactoryName.PythonAutocompletePlugin]=[E.pythonAutocompletePluginAttach,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled"],n[I.PluginFactoryName.ChatGPTPlugin]=[d.chatGPTPluginAttach,"Microsoft.Office.Excel.ChatGPTPluginEnabled"],n[I.PluginFactoryName.FormulaByExamplePlugin]=[O.formulaByExamplePluginAttach,"Microsoft.Office.Excel.FormulaByExamplePluginEnabled"],n[I.PluginFactoryName.TestPlugin]=[p.workerThreadInitialized,"Microsoft.Office.Excel.MockWorkerThreadPlugin"],n[I.PluginFactoryName.AutocompleteEnumPlugin]=[f.autocompleteEnumPluginDependenciesResolved,void 0,void 0,"EnumAutoComplete"],n[I.PluginFactoryName.SetCellPrefetchPlugin]=[O.setCellPreftechPluginAttach,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled"],n[I.PluginFactoryName.FormulaTranspilerPlugin]=[O.formulaTranspilerPluginAttach,"Microsoft.Office.Excel.FormulaRemediation"],n),Win32:{}},w=((i={})[I.PluginAttachGroup.Core]=!0,i[I.PluginAttachGroup.Python]=!1,i[I.PluginAttachGroup.SmartSuggestionsAutoComplete]=!1,i);(0,T.staticAssertExtends)();var L=((a={})[I.PluginAttachGroup.Core]=((o={})[I.PluginFactoryName.AutocompletePlugin]=!1,o),a[I.PluginAttachGroup.Python]={},a[I.PluginAttachGroup.SmartSuggestionsAutoComplete]=((s={})[I.PluginFactoryName.AutocompletePlugin]=!0,s),a);function x(e,t,r){return void 0===r&&(r=[]),u.__awaiter(this,void 0,void 0,(function(){var n,i,a,o,s,c;return u.__generator(this,(function(u){switch(u.label){case 0:if((0,l.isTypedChangeGateEnabled)("OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures")&&N.PluginSchedulerSingleton.instance().doNotify(_.NotificationKind.setSchedulerFeatures,[r.map((function(e){return I.SchedulerFeature[e]}))]),p.scriptLoaderPromise.resolve(t),void 0===(n=D.Web[e]))return[2,!1];if(i=n[0],a=n[1],o=n[2],s=n[3],void 0!==a&&!(0,l.getTypedFeatureGate)(a)||void 0!==o&&!(0,l.isTypedChangeGateEnabled)(o)||void 0!==s&&-1===r.indexOf(s))return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,i.getValue()];case 2:return u.sent(),[2,!0];case 3:return c=u.sent(),P.ulsLogger.ULS.traceTag(523352029,k.LogCategory.msoulscat_ES_EWAJS,k.TraceLevel.Error,A.x10Logger.formatLogMessage("ensurePluginAttached",{description:'Failed to ensure plugin "'.concat(I.PluginFactoryName[e],'" is attached with exception'),data:c})),[3,4];case 4:return[2,!1]}}))}))}function K(e){return u.__awaiter(this,void 0,void 0,(function(){var t,r,n,i,a,o,s,c;return u.__generator(this,(function(u){switch(u.label){case 0:if(void 0===(t=D[M.platform][e]))return[2,!1];if(r=N.PluginSchedulerSingleton.instance(),n=r.getSchedulerFeatures(),i=t[0],a=t[1],o=t[2],s=t[3],void 0!==a&&!(0,l.getTypedFeatureGate)(a)||void 0!==o&&!(0,l.isTypedChangeGateEnabled)(o)||void 0!==s&&-1===n.indexOf(I.SchedulerFeature[s]))return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,i.getValue()];case 2:return u.sent(),[2,!0];case 3:return c=u.sent(),P.ulsLogger.ULS.traceTag(507381789,k.LogCategory.msoulscat_ES_EWAJS,k.TraceLevel.Error,A.x10Logger.formatLogMessage("ensurePluginAttached",{description:'Failed to ensure plugin "'.concat(I.PluginFactoryName[e],'" is attached with exception'),data:c})),[3,4];case 4:return[2,!1]}}))}))}function U(e){return Object.keys(e).map((function(e){return parseInt(e,10)}))}function B(e,t){var r;return null!==(r=L[t][e])&&void 0!==r?r:w[t]}t.resolveScriptLoaderPromise=function(e){p.scriptLoaderPromise.resolve(e)},t.ensurePluginAttachedLegacy=x,t.setX10Features=function(e){N.PluginSchedulerSingleton.instance().doNotify(_.NotificationKind.setSchedulerFeatures,[e.map((function(e){return I.SchedulerFeature[e]}))])},t.ensurePluginAttached=K,t.ensureGroupAttached=function(e){return u.__awaiter(this,void 0,void 0,(function(){var t,r,n,i;return u.__generator(this,(function(a){switch(a.label){case 0:t=0,r=0,n=U(D[M.platform]),a.label=1;case 1:return r<n.length?B(i=n[r],e)?[4,K(i)]:[3,3]:[3,4];case 2:a.sent()&&(t+=1),a.label=3;case 3:return r++,[3,1];case 4:return[2,t]}}))}))},t.ensureGroupAttachedLegacy=function(e,t,r){return void 0===r&&(r=[]),u.__awaiter(this,void 0,void 0,(function(){var n,i,a,o;return u.__generator(this,(function(s){switch(s.label){case 0:n=0,i=0,a=U(D.Web),s.label=1;case 1:return i<a.length?B(o=a[i],t)?[4,x(o,e,r)]:[3,3]:[3,4];case 2:s.sent()&&(n+=1),s.label=3;case 3:return i++,[3,1];case 4:return[2,n]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chatGPTPluginAttach=t.parserPerformanceMeasurementsAttach=t.autocompleteBinaryModelExperimentPluginAttach=t.autocompleteRangeSuggestionPluginAttach=t.autocompleteWrapperPluginAttach=t.autocompletePluginDependenciesResolved=void 0;var n=r(0),i=r(6),a=r(13),o=r(31),s=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,o.workerThreadSpread.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("excelOnlineAutocomplete",!1)];case 2:return t.sent(),[2,e]}}))}))}));t.autocompletePluginDependenciesResolved=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(i.PluginFactoryName.AutocompletePlugin)];case 2:return e.sent(),[4,o.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))})),t.autocompleteWrapperPluginAttach=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(i.PluginFactoryName.AutocompleteWrapperPlugin)];case 2:return e.sent(),[2]}}))}))})),t.autocompleteRangeSuggestionPluginAttach=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(i.PluginFactoryName.AutocompleteRangeSuggestionPlugin)];case 2:return e.sent(),[2]}}))}))})),t.autocompleteBinaryModelExperimentPluginAttach=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(i.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin)];case 2:return e.sent(),[2]}}))}))})),t.parserPerformanceMeasurementsAttach=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(i.PluginFactoryName.ParserPerformanceMeasurements)];case 2:return e.sent(),[2]}}))}))})),t.chatGPTPluginAttach=(0,a.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(i.PluginFactoryName.ChatGPTPlugin)];case 2:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GotoCtrlClickVisitor=void 0;var n=r(0),i=r(12),a=r(2),o=r(9),s=r(21),u=r(6),l=r(99),c=r(145),d=function(e){function t(t,r,n,i){var a=e.call(this)||this;return a.parsedFormulaTree=t,a.activeCell=r,a.definedNameInfoList=n,a.caretPosition=i,a.structRefNodeToResolve=void 0,a.span=void 0,a.sheetRange=void 0,a.referenceFound=!1,a._namedObjectsMap=void 0,a}return n.__extends(t,e),Object.defineProperty(t.prototype,"namedObjectsMap",{get:function(){return(0,a.isDefined)(this._namedObjectsMap)?this._namedObjectsMap:(0,a.isDefined)(this.definedNameInfoList)?(this._namedObjectsMap=(0,l.createNameToDefinedNameInfoMapping)(this.definedNameInfoList),this._namedObjectsMap):void p("namedObjectsMap: was called but definedNameInfoList is undefined")},enumerable:!1,configurable:!0}),t.prototype.structRefNode=function(t,r,n){var i=e.prototype.structRefNode.call(this,t,r,n);if(this.referenceFound)return i;var a=this.parsedFormulaTree.spans[n];return(0,l.caretInSpanScope)(this.caretPosition,a)&&(this.referenceFound=!0,this.span=a,this.structRefNodeToResolve=i),i},t.prototype.cellRefNode=function(t,r,n){var i=e.prototype.cellRefNode.call(this,t,r,n);if(this.referenceFound)return i;var a=this.parsedFormulaTree.spans[n];return(0,l.caretInSpanScope)(this.caretPosition,a)&&(this.referenceFound=!0,this.span=a,this.sheetRange=(0,c.sheetRangeFromCellRef)(t,r,this.activeCell,p)),i},t.prototype.nameNode=function(t,r,n){var i,a=e.prototype.nameNode.call(this,t,r,n);if(this.referenceFound)return a;var s=this.parsedFormulaTree.spans[n];if(!(0,l.caretInSpanScope)(this.caretPosition,s))return a;if(a.parts.kind===o.NamePartKind.FieldRefNamePart)this.tryFindFieldRefGotoReference(a.parts,r);else{var d=null===(i=this.namedObjectsMap)||void 0===i?void 0:i.get(t.asWhole.toLocaleLowerCase());void 0!==d&&d.type!==u.DefinedNameInfoType.Invalid&&(this.referenceFound=!0,this.span=s,this.sheetRange=(0,c.getSheetRangeFromDefinedNameInfo)(d,r))}return a},t.prototype.tryFindFieldRefGotoReference=function(e,t){var r=(0,l.findFieldRefSourceLhs)(e);switch(r.kind){case o.NamePartKind.CellRefNamePart:var n=this.parsedFormulaTree.spans[r.label];return void((0,l.caretInSpanScope)(this.caretPosition,n)&&(this.referenceFound=!0,this.span=n,this.sheetRange=(0,c.sheetRangeFromCellRef)(r.ref,void 0,this.activeCell,p)));case o.NamePartKind.IdentNamePart:n=this.parsedFormulaTree.spans[r.label];if((0,a.isDefined)(this.namedObjectsMap)&&(0,l.caretInSpanScope)(this.caretPosition,n)){this.referenceFound=!0,this.span=n;var i=(0,l.getNamePartIfExists)(r,this.namedObjectsMap);if(!(0,a.isDefined)(i))return;this.sheetRange=(0,c.getSheetRangeFromDefinedNameInfo)(i,t)}return;default:p("tryFindFieldRefGotoReference: Was not able to parse a left-most NamePart")}},t}(s.IdentityVisitor);function p(e){i.ulsLogger.ULS.traceTag(508687388,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"GotoCtrlClickVisitor encountered a failure with msg ".concat(e))}t.GotoCtrlClickVisitor=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaCollectionPluginDependenciesResolved=t.combineSplitCollectedFormulaLogs=t.deserializeSplitCollectedFormulaLog=t.FormulaCollectionPlugin=t.FormulaCollectionPluginFactory=void 0;var n=r(0),i=r(17),a=r(29),o=r(12),s=r(5),u=r(23),l=r(15),c=r(24),d=r(210),p=r(109),m=r(110),f=r(11),g=r(13),h=r(31),v=r(6);function S(e){for(var t=0,r=function(e){var t=JSON.stringify(e),r=0,n=[];for(;t.length>0;){var i=E(t,r,e.i),a=i[0],o=i[1];t=o,r+=1,n.push(a)}return n}(e);t<r.length;t++){var n=b(r[t]);o.ulsLogger.ULS.dnmTraceTag(537962336,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,n)}}function y(e){o.ulsLogger.ULS.traceTag(537962337,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Verbose,e)}var F=function(){function e(){this.factoryName=v.PluginFactoryName.FormulaCollectionPlugin}return e.prototype.create=function(){return new C},e}();t.FormulaCollectionPluginFactory=F;var C=function(){function e(){this.lastEdit=void 0,this.consistentAnonymizer=new d.ConsistentAnonymizer,this.sheetIdAnonymization=new Map}return e.prototype.getEditEntry=function(e,t){var r={content:e,cell:t};if(void 0===this.lastEdit||!(0,f.isSheetGridCellEqual)(this.lastEdit.cell,t)||this.lastEdit.content!==e)return this.lastEdit=r,r},e.prototype.anonymizeSheetId=function(e){if(this.sheetIdAnonymization.has(e))return this.sheetIdAnonymization.get(e);var t=(0,c.getNewGuid)()[0];return this.sheetIdAnonymization.set(e,t),t},e.prototype.run=function(t){var r,a,o,c,d,f,g,h,v,F,C,b,E,P,k,T,A,N;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,{kind:i.ComputationRequestKind.GetActiveCell}];case 1:return(r=n.sent()).kind!==i.ComputationRequestKind.GetActiveCell?(y(R.GetActiveCell),[2,null]):(a=r.activeCell,null==t.content?(y(R.EmptyContent),[2,null]):t.content.trimLeft().startsWith("=")?void 0===(o=this.getEditEntry(t.content,a))?[2,null]:[4,{kind:i.ComputationRequestKind.GetConfig}]:[2,null]);case 2:return(c=n.sent()).kind!==i.ComputationRequestKind.GetConfig?(y(R.GetConfig),[2,null]):(d=c.config,f=(0,p.createAnalyzeGlobals)(d),g=(0,l.lexicalSourceCell)(o.cell),h=(0,p.analyzeLocalsGrid)(g.kind,g.range),v=(0,m.createAnalyzer)(f),F=this.consistentAnonymizer.anonymize(o.content,d,a.range),[4,{kind:i.ComputationRequestKind.ParseEdit,cell:o.cell,formulaBarText:F}]);case 3:return(C=n.sent()).kind===i.ComputationRequestKind.ParseEdit&&(0,s.isSuccess)(C.result)?C.result.value.kind!==u.EditKind.Formula?[2,null]:(b=C.result.value.formula,E=b.isWellFormed,P=void 0,E||(k=v.checkFormulaWithDiagnostics(h,b),(0,s.isSuccess)(k)&&void 0!==(T=null==k?void 0:k.value[1])&&(P=function(e,t){var r={},n={};return Object.keys(e).forEach((function(i){var a=Number(i),o=e[a];void 0!==o&&(r[i]=o);var s=t.spans[a];void 0!==s&&(n[i]=s)})),{spanDiagnostics:r,spans:n}}(T,b))),[4,{kind:i.ComputationRequestKind.GetCorrelationId}]):(y(R.ParseEdit),[2,null]);case 4:return"GetCorrelationId"!==(A=n.sent()).kind||(N=A.correlationId,S({v:e.formulaCollectionVersion,f:F,ok:E,d:P,c:{s:this.anonymizeSheetId(o.cell.sheet.index),c:o.cell.range.col,r:o.cell.range.row},i:N})),[2,null]}}))},e.factoryName=v.PluginFactoryName.FormulaCollectionPlugin,e.formulaCollectionVersion=1,e}();t.FormulaCollectionPlugin=C;var R;function b(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function E(e,t,r){var n=2300-(r.toString().length+t.toString().length+2);return[{correlationId:r,logPartId:t,partialMessage:e.slice(0,n)},e.slice(n)]}t.deserializeSplitCollectedFormulaLog=function(e){var t=e,r=t.indexOf(","),n=Number(t.slice(0,r));return r=(t=t.slice(r+1)).indexOf(","),{correlationId:n,logPartId:Number(t.slice(0,r)),partialMessage:t.slice(r+1)}},t.combineSplitCollectedFormulaLogs=function(e){var t=e.sort((function(e){return e.logPartId})).map((function(e){return e.partialMessage})).join("");return JSON.parse(t)},function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"}(R||(R={})),(0,a.registerPluginFactory)(new F),t.formulaCollectionPluginDependenciesResolved=(0,g.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,h.workerThreadSpread.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(v.PluginFactoryName.FormulaCollectionPlugin)];case 2:return e.sent(),[4,h.schedulerWithRecalcServiceAttached.getValue()];case 3:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;var n=r(37);t.tokenizeFormula=n.tokenizeFormulaModule.tokenizeFormula},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subOperatorToken=t.specialRefToken=t.spacesToken=t.rowSepToken=t.rightSQuoteToken=t.rightParenToken=t.rightBracketToken=t.rightBraceToken=t.rangeOperatorToken=t.qualSepToken=t.powOperatorToken=t.poundOperatorToken=t.percentOperatorToken=t.operatorToken=t.neOperatorToken=t.mulOperatorToken=t.ltOperatorToken=t.literalToken=t.listSepToken=t.leftSQuoteToken=t.leftParenToken=t.leftBracketToken=t.leftBraceToken=t.leOperatorToken=t.isNumberLikeOper=t.isBadNumberOper=t.isBadErrorOper=t.identToken=t.identOrBooleanToken=t.gtOperatorToken=t.geOperatorToken=t.escapeToken=t.eqOperatorToken=t.endToken=t.dotSepToken=t.divOperatorToken=t.concatOperatorToken=t.colSepToken=t.cellRefR1C1Token=t.cellRefA1Token=t.badNumberOper=t.badErrorOper=t.atOperatorToken=t.assignSepToken=t.appendToken=t.addOperatorToken=t.TokenOperKind=t.TokenKind=t.SepId=t.DelimId=void 0,t.multiLineCommentToken=t.singleLineCommentToken=t.unexpectedToken=void 0;var n=r(37);t.DelimId=n.token.DelimId,t.SepId=n.token.SepId,t.TokenKind=n.token.TokenKind,t.TokenOperKind=n.token.TokenOperKind,t.addOperatorToken=n.token.addOperatorToken,t.appendToken=n.token.appendToken,t.assignSepToken=n.token.assignSepToken,t.atOperatorToken=n.token.atOperatorToken,t.badErrorOper=n.token.badErrorOper,t.badNumberOper=n.token.badNumberOper,t.cellRefA1Token=n.token.cellRefA1Token,t.cellRefR1C1Token=n.token.cellRefR1C1Token,t.colSepToken=n.token.colSepToken,t.concatOperatorToken=n.token.concatOperatorToken,t.divOperatorToken=n.token.divOperatorToken,t.dotSepToken=n.token.dotSepToken,t.endToken=n.token.endToken,t.eqOperatorToken=n.token.eqOperatorToken,t.escapeToken=n.token.escapeToken,t.geOperatorToken=n.token.geOperatorToken,t.gtOperatorToken=n.token.gtOperatorToken,t.identOrBooleanToken=n.token.identOrBooleanToken,t.identToken=n.token.identToken,t.isBadErrorOper=n.token.isBadErrorOper,t.isBadNumberOper=n.token.isBadNumberOper,t.isNumberLikeOper=n.token.isNumberLikeOper,t.leOperatorToken=n.token.leOperatorToken,t.leftBraceToken=n.token.leftBraceToken,t.leftBracketToken=n.token.leftBracketToken,t.leftParenToken=n.token.leftParenToken,t.leftSQuoteToken=n.token.leftSQuoteToken,t.listSepToken=n.token.listSepToken,t.literalToken=n.token.literalToken,t.ltOperatorToken=n.token.ltOperatorToken,t.mulOperatorToken=n.token.mulOperatorToken,t.neOperatorToken=n.token.neOperatorToken,t.operatorToken=n.token.operatorToken,t.percentOperatorToken=n.token.percentOperatorToken,t.poundOperatorToken=n.token.poundOperatorToken,t.powOperatorToken=n.token.powOperatorToken,t.qualSepToken=n.token.qualSepToken,t.rangeOperatorToken=n.token.rangeOperatorToken,t.rightBraceToken=n.token.rightBraceToken,t.rightBracketToken=n.token.rightBracketToken,t.rightParenToken=n.token.rightParenToken,t.rightSQuoteToken=n.token.rightSQuoteToken,t.rowSepToken=n.token.rowSepToken,t.spacesToken=n.token.spacesToken,t.specialRefToken=n.token.specialRefToken,t.subOperatorToken=n.token.subOperatorToken,t.unexpectedToken=n.token.unexpectedToken,t.singleLineCommentToken=n.token.singleLineCommentToken,t.multiLineCommentToken=n.token.multiLineCommentToken},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValuePreviewVisitor=void 0;var n=r(0),i=r(4),a=r(24),o=r(2),s=r(9),u=r(36),l=r(21),c=r(14),d=function(e){function t(t,r,n,i){var a=e.call(this)||this;return a.parsedFormulaTree=t,a.selectionStart=r,a.selectionEnd=n,a.formula=i,a.subFormulaStart=-1,a.subFormulaEnd=-1,a.isBadSelection=!1,a.isRefNode=!1,a.isVolatile=!1,a.letDefinitions=void 0,a.volatileFunctions=[],a.nodeLabel=-1,a.isBadSelectionValidationEnabled=(0,c.isChangeGateEnabled)("OfficeVSO:8549607_ValuePreviewBadSelection"),a.isDetectVolatileEnabled=(0,c.isChangeGateEnabled)("OfficeVSO:8501487_ValuePreviewDetectVolatile"),a}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){var a=e.prototype.appNode.call(this,t,r,n,i);return this.tryUpdateAppNodeAsSubFormula(t,a),a},t.prototype.literalNode=function(t,r,n){var i=e.prototype.literalNode.call(this,t,r,n);return this.tryUpdateNodeAsSubFormula(i),i},t.prototype.missingNode=function(t,r){var n=e.prototype.missingNode.call(this,t,r);return this.tryUpdateNodeAsSubFormula(n),n},t.prototype.arrayNode=function(t,r,n){var i=e.prototype.arrayNode.call(this,t,r,n);return this.tryUpdateNodeAsSubFormula(i),i},t.prototype.cellRefNode=function(t,r,n){var i=e.prototype.cellRefNode.call(this,t,r,n);return this.validateSelection(n,"whole"),this.tryUpdateNodeAsSubFormula(i)&&(this.isRefNode=!0),i},t.prototype.fieldRefNode=function(t,r,n){var i=e.prototype.fieldRefNode.call(this,t,r,n);return this.validateSelection(n,"prefix"),this.tryUpdateNodeAsSubFormula(i),i},t.prototype.structRefNode=function(t,r,n){var i=e.prototype.structRefNode.call(this,t,r,n);return this.validateSelection(n,"prefix"),this.tryUpdateNodeAsSubFormula(i)&&(this.isRefNode=!0),i},t.prototype.nameNode=function(t,r,n){var i=e.prototype.nameNode.call(this,t,r,n);return this.validateSelection(n,"prefix"),this.tryUpdateNodeAsSubFormula(i)&&(this.isRefNode=!0),i},t.prototype.badSequenceNode=function(t,r,n){var i=this,a=e.prototype.badSequenceNode.call(this,t,r,n);return r.some((function(e){return e.label===i.nodeLabel}))&&(this.updateNodeAsSubFormula(a),this.isBadSelection=!0),a},t.prototype.parenNode=function(t,r,n){var i=e.prototype.parenNode.call(this,t,r,n);return r&&this.tryUpdateNodeAsSubFormula(i),i},t.prototype.letNode=function(t,r,n,i,a,o){var s=e.prototype.letNode.call(this,t,r,n,i,a,o),u=this.parsedFormulaTree.spans[o];return this.isMatchingArg(u,!0)&&this.updateLetNodeAsSubFormula(s),s},t.prototype.wsfNode=function(t,r,n){var i=e.prototype.wsfNode.call(this,t,r,n);return this.validateSelection(n,"none"),i},t.prototype.operatorNode=function(t,r){var n=e.prototype.operatorNode.call(this,t,r);return this.validateSelection(r,"none"),n},t.prototype.tryUpdateNodeAsSubFormula=function(e){return!!this.isMinimalMatchingSpan(this.parsedFormulaTree.spans[e.label])&&(this.updateNodeAsSubFormula(e),!0)},t.prototype.tryUpdateAppNodeAsSubFormula=function(e,t){if(e.kind===s.NodeKind.WSF||e.kind===s.NodeKind.Operator){var r=this.parsedFormulaTree.spans[e.label],n=this.parsedFormulaTree.spans[t.label];this.tryAddVolatileFunction(e,t),this.isMatchingAppNode(r,n,e.kind,t.isClosed)&&this.updateNodeAsSubFormula(t)}else i.ulsLogger.ULS.traceTag(509347166,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"ValuePreviewVisitor - visitor encountered higher order function, kind: ".concat(e.kind))},t.prototype.updateLetNodeAsSubFormula=function(e){var t=this.parsedFormulaTree.spans[e.head.label],r=this.parsedFormulaTree.spans[e.label];if(this.isMatchingAppNode(t,r,s.NodeKind.WSF,e.isClosed))this.updateNodeAsSubFormula(e);else for(var n=0;n<e.args.length;n++){var i=e.args[n],a=this.parsedFormulaTree.spans[i.label];if(!(0,o.isDefined)(a))return;if(this.isMatchingArg(a,!0)){if(1===n)return;var u=n%2==0,l=e.args.length-2,c=u?Math.min(l,n+1):n-2,d=this.parsedFormulaTree.spans[e.args[c].label];if(!(0,o.isDefined)(d))return;var p=this.formula.substring(r.start,d.end);this.letDefinitions=p,this.isVolatile=this.checkIntersectionWithVolatileFunction(r),this.isMinimalMatchingSpan(a)&&(this.subFormulaStart=a.start,this.subFormulaEnd=a.end,this.nodeLabel=i.label)}}},t.prototype.updateNodeAsSubFormula=function(e){var t=this.parsedFormulaTree.spans[e.label];this.subFormulaStart=t.start,this.subFormulaEnd=t.end,this.nodeLabel=e.label,this.isVolatile=this.checkIntersectionWithVolatileFunction(t)},t.prototype.isMinimalMatchingSpan=function(e){return-1===this.nodeLabel&&this.isMatchingArg(e)},t.prototype.isMatchingArg=function(e,t){return void 0===t&&(t=!1),!!(0,o.isDefined)(e)&&(this.selectionStart===this.selectionEnd?this.selectionStart>=e.start&&this.selectionEnd<e.end:t?this.selectionStart>=e.start&&this.selectionEnd<=e.end:this.selectionStart===e.start&&this.selectionEnd===e.end)},t.prototype.isMatchingAppNode=function(e,t,r,n){if(!(0,o.isDefined)(e)||!(0,o.isDefined)(t)||!n)return!1;if(this.selectionStart===this.selectionEnd)switch(r){case s.NodeKind.WSF:return this.selectionStart===e.end||this.selectionStart===t.end-1||this.selectionStart>=e.start&&this.selectionStart<e.end;case s.NodeKind.Operator:return this.selectionStart>=e.start-e.pre.length&&this.selectionStart<e.end+e.post.length}else if(this.isBadSelectionValidationEnabled&&e.start<=this.selectionStart&&this.selectionEnd<=e.end)return this.isBadSelection=!0,!1;return this.selectionStart===t.start&&this.selectionEnd===t.end},t.prototype.tryAddVolatileFunction=function(e,t){if(this.isDetectVolatileEnabled&&e.kind===s.NodeKind.WSF&&t.isClosed){var r=this.parsedFormulaTree.spans[t.label];(0,o.isNone)(r)||(0,u.isVolatileFunc)(e.id)&&this.volatileFunctions.push({start:r.start,end:r.end})}},t.prototype.checkIntersectionWithVolatileFunction=function(e){return!!this.isDetectVolatileEnabled&&this.volatileFunctions.some((function(t){return e.start<=t.start&&e.end>=t.end}))},t.prototype.validateSelection=function(e,t){if(this.isBadSelectionValidationEnabled&&this.selectionStart!==this.selectionEnd){var r=this.parsedFormulaTree.spans[e];if((0,o.isDefined)(r)&&!(this.selectionStart<r.start||this.selectionEnd>r.end))switch(t){case"prefix":return void(this.selectionStart!==r.start&&(this.isBadSelection=!0));case"suffix":return void(this.selectionEnd!==r.end&&(this.isBadSelection=!0));case"whole":return void(this.selectionStart===r.start&&this.selectionEnd===r.end||(this.isBadSelection=!0));case"none":return void(this.isBadSelection=!0)}}},t}(l.IdentityVisitor);t.ValuePreviewVisitor=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pythonAutocompletePluginAttach=void 0;var n=r(0),i=r(13),a=r(31),o=r(22),s=r(6),u=(0,i.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,a.workerThreadSpread.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript((0,o.isTypedChangeGateEnabled)("Microsoft.Office.Excel.X10IntelligentPythonWP5")?"pythonIntelliSenseWP5":"pythonIntelliSense",!1)];case 2:return t.sent(),[2,e]}}))}))}));t.pythonAutocompletePluginAttach=(0,i.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,u.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(s.PluginFactoryName.PythonAutocompletePlugin)];case 2:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaTranspilerPluginAttach=t.setCellPreftechPluginAttach=t.formulaByExamplePluginAttach=t.formulaRepairShadowEvalPluginDependenciesResolved=t.syntaxErrorsPluginDependenciesResolved=void 0;var n=r(0),i=r(13),a=r(6),o=r(31),s=(0,i.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,o.workerThreadSpread.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("excelOnlineX10Plugins",!1)];case 2:return t.sent(),[2,e]}}))}))}));t.syntaxErrorsPluginDependenciesResolved=(0,i.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,s.getValue()];case 1:return e=t.sent(),[4,o.schedulerWithRecalcServiceAttached.getValue()];case 2:return t.sent(),[4,e.createAndAttachPlugin(a.PluginFactoryName.SyntaxErrorsPlugin)];case 3:return t.sent(),[2]}}))}))})),t.formulaRepairShadowEvalPluginDependenciesResolved=(0,i.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,s.getValue()];case 1:return e=t.sent(),[4,o.schedulerWithRecalcServiceAttached.getValue()];case 2:return t.sent(),[4,e.createAndAttachPlugin(a.PluginFactoryName.FormulaRepairShadowEvalPlugin)];case 3:return t.sent(),[2]}}))}))})),t.formulaByExamplePluginAttach=(0,i.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,s.getValue()];case 1:return e=t.sent(),[4,o.schedulerWithRecalcServiceAttached.getValue()];case 2:return t.sent(),[4,e.createAndAttachPlugin(a.PluginFactoryName.FormulaByExamplePlugin)];case 3:return t.sent(),[2]}}))}))})),t.setCellPreftechPluginAttach=(0,i.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,s.getValue()];case 1:return e=t.sent(),[4,o.schedulerWithRecalcServiceAttached.getValue()];case 2:return t.sent(),[4,e.createAndAttachPlugin(a.PluginFactoryName.SetCellPrefetchPlugin)];case 3:return t.sent(),[2]}}))}))})),t.formulaTranspilerPluginAttach=(0,i.asyncLazy)((function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,o.workerThreadSpread.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("excelOnlineFormulaTranspiler",!1)];case 2:return t.sent(),[4,e.createAndAttachPlugin(a.PluginFactoryName.FormulaTranspilerPlugin)];case 3:return t.sent(),[2]}}))}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatGPTPlugin=t.ChatGPTPluginFactory=void 0;var n=r(0),i=r(6),a=r(2),o=r(29),s=r(17),u=function(){function e(){this.factoryName=i.PluginFactoryName.ChatGPTPlugin}return e.prototype.create=function(){return new l},e}();t.ChatGPTPluginFactory=u;var l=function(){function e(){}return e.prototype.run=function(e){var t,r,i,o;return n.__generator(this,(function(n){switch(n.label){case 0:return t=e.query,(0,a.isDefined)(t)?[4,{kind:s.ComputationRequestKind.CreateChatGPTSession,options:e.context}]:[2,null];case 1:if((r=n.sent()).kind!==s.ComputationRequestKind.CreateChatGPTSession)throw new Error("Inconsistent yield request response type");return[4,{kind:s.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:t}];case 2:if((i=n.sent()).kind!==s.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");return[4,{kind:s.ComputationRequestKind.SendChatGPTQuery,session:r.result,request:"Explain your answer"}];case 3:if((o=n.sent()).kind!==s.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");return[2,{result:i.result,details:o.result}]}}))},e}();t.ChatGPTPlugin=l,(0,o.registerPluginFactory)(new u)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;var n=r(556);Object.defineProperty(t,"PluginRegistry",{enumerable:!0,get:function(){return n.PluginRegistry}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;var n=r(0),i=r(144),a=r(205),o=r(146),s=r(142),u=r(22),l=function(){function e(e,t,r){this.factoryName=e,this.pluginGroup=t,this.gate=r,this.factory=void 0,this.registeredUIHandlers=[],this.registeredEventHandlers=[]}return e.creator=function(){return function(t,r,n){return new e(t,r,n)}},Object.defineProperty(e,"create",{get:function(){return e.creator()},enumerable:!1,configurable:!0}),e.prototype.x10Plugin=function(e){var t=this;return function(r,s){var l=String(s.name),c={registryInitialized:function(){return!t.gate||(0,u.isTypedChangeGateEnabled)(t.gate)},factoryName:t.factoryName,pluginName:l,pluginGroup:t.pluginGroup,create:function(t){return new(r.bind.apply(r,n.__spreadArray([void 0],e?e(t):[],!1)))}};(0,o.assertTrue)("Registry object cannot be used on '".concat(c.pluginName,"' class. 'x10Plugin' decorator must be called only once on plugin class"),void 0===t.factory),t.factory=c;for(var d=0,p=t.registeredUIHandlers;d<p.length;d++){var m=p[d];(0,a.registerComputation)(i.ComputationType.UIMessage,m.kind,m.executionType,t.pluginGroup,{factoryName:t.factoryName,pluginName:l,computationName:m.name},m.modifiers,m.computationGenerator,m.predicate)}for(var f=0,g=t.registeredEventHandlers;f<g.length;f++){m=g[f];(0,a.registerComputation)(i.ComputationType.Event,m.kind,m.executionType,t.pluginGroup,{factoryName:t.factoryName,pluginName:l,computationName:m.name},m.modifiers,m.computationGenerator,m.predicate)}}},e.prototype.uiMessageHandler=function(e){var t=this;return function(r,n){var a,o,u;t.registeredUIHandlers.push({type:i.ComputationType.UIMessage,kind:e.kind,name:String(n.name),executionType:null!==(o=null===(a=e.modifiers)||void 0===a?void 0:a.executionType)&&void 0!==o?o:s.ExecutionType.Async,modifiers:null!==(u=e.modifiers)&&void 0!==u?u:{},computationGenerator:r,predicate:e.predicate})}},e.prototype.eventHandler=function(e){var t=this;return function(r,n){var a,o,u;t.registeredEventHandlers.push({type:i.ComputationType.Event,kind:e.kind,name:String(n.name),executionType:null!==(o=null===(a=e.modifiers)||void 0===a?void 0:a.executionType)&&void 0!==o?o:s.ExecutionType.Async,modifiers:null!==(u=e.modifiers)&&void 0!==u?u:{},computationGenerator:r,predicate:e.predicate})}},e.prototype.injectPluginFactory=function(){return(0,o.assertTrue)("Plugin factory not initialized. `x10Plugin` decorator must be called on plugin class",void 0!==this.factory),this.factory},e}();t.PluginRegistry=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runQueueProcessorUntil=void 0;var n=r(79);t.runQueueProcessorUntil=n.testUtils.runQueueProcessorUntil},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flaky=t.YarnExecutionArgs=t.GateOverrideManager=t.testingCGOverrides=void 0;var n=r(22),i=r(14),a=r(14),o=r(2),s=["OfficeVSO:8762152_x10PluginRegistryEnabled"];t.testingCGOverrides=[],0===s.length?t.testingCGOverrides.push(void 0):s.forEach((function(e){var r,n;return t.testingCGOverrides.push(((r={})[e]=!0,r),((n={})[e]=!1,n))}));var u=function(){function e(){}return e.prototype.override=function(e){return{changeGates:(0,o.isDefined)(e.changeGates)?(0,a.overrideTypedChangeGates)(n.isTypedChangeGateEnabled,e.changeGates):void 0,featureGates:(0,o.isDefined)(e.featureGates)?(0,n.overrideTypedFeatureGates)(n.getTypedFeatureGate,e.featureGates):void 0}},e.prototype.revert=function(e){(0,i.setChangeGateDictionaryGetter)(e.changeGates),(0,n.setFeatureGateDictionaryGetter)(e.featureGates)},e}();t.GateOverrideManager=u;var l=function(){function e(){var e,t;this.args=[],this.args=null!==(t=JSON.parse(null!==(e=Object({NODE_ENV:"production"}).npm_config_argv)&&void 0!==e?e:"{}").original)&&void 0!==t?t:[]}return Object.defineProperty(e,"instance",{get:function(){return(0,o.isDefined)(this._instance)||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.has=function(t){return e.instance.args.findIndex((function(e){return e===t}))>=0},e}();t.YarnExecutionArgs=l;t.flaky=function(){return l.has("--flaky")?it:it.skip}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=t.flaky=t.skip=t.each=t.test=void 0;var n=r(0),i=n.__importStar(r(560)),a=n.__importStar(r(561));t.test=i.test,t.each=i.each,t.skip=i.skip,t.flaky=i.flaky,t.Types=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.x10Test=t.flaky=t.skip=t.each=t.test=void 0;var n=r(0),i=r(146),a=r(207),o=r(318),s=r(97),u=r(333),l=function(){function e(){var e,t;this.args=[],this.args=null!==(t=JSON.parse(null!==(e=Object({NODE_ENV:"production"}).npm_config_argv)&&void 0!==e?e:"{}").original)&&void 0!==t?t:[]}return Object.defineProperty(e,"instance",{get:function(){return(0,i.isDefined)(this._instance)||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.has=function(t){return e.instance.args.findIndex((function(e){return e===t}))>=0},e}(),c=function(){function e(e){var t=this;this.timer=e,this.runMacrotasksWhile=function(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(e=t.timer).runMacrotasksWhile.apply(e,r)},this.runMacrotasksFor=function(e){var r=t.preciseNow;return t.runMacrotasksWhile((function(){return t.preciseNow<r+e}))}}return Object.defineProperty(e.prototype,"startTime",{get:function(){return this.timer.startTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preciseNow",{get:function(){return this.timer.preciseNow()},enumerable:!1,configurable:!0}),e.prototype.jolt=function(){return new Promise((function(e){return setImmediate((function(){return e()}))}))},e.prototype.runUntilResolved=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:return t=!1,(r=Promise.resolve(e)).then((function(){return t=!0})),[4,this.runMacrotasksWhile((function(){return!t}))];case 1:return n.sent(),[2,r]}}))}))},e}();function d(){var e=(0,a.createMockAsyncGrid)(),t=new o.MockTimerImmediate,r=(0,s.getSchedulerFactories)().createFormulaBarScheduler((0,a.createMockGridProvider)(e),void 0,t),n=new u.GridInterface(e,r);return r.registerAsyncGrid(),{scheduler:r,grid:n,timer:new c(t)}}function p(e,t,r){it(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(void 0,n.__spreadArray([d()],e,!1))}),r)}function m(e){return function(t,r,i){it.each(e)(t,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,n.__spreadArray([d()],e,!1))}),i)}}function f(e,t,r){it.skip(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(void 0,n.__spreadArray([d()],e,!1))}),r)}function g(e){return l.has("--flaky")?p:f}t.test=p,t.each=m,t.skip=f,t.flaky=g,t.x10Test={test:p,each:m,skip:f,flaky:g}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RangeInterface=t.SheetInterface=t.GridInterface=void 0;var n=r(0).__importStar(r(333));t.GridInterface=n.GridInterface,t.SheetInterface=n.SheetInterface,t.RangeInterface=n.RangeInterface},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelperSingleton=void 0;var n=r(2),i=r(563);t.FormulaAuthoringHelperSingleton=(0,n.singleton)((function(){return new i.FormulaAuthoringHelper}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaAuthoringHelper=void 0;var n=r(2),i=r(12),a=r(320),o=r(210),s=r(564),u=function(){function e(){var e=this;this.hasRepeatingParams=function(t){return(0,n.isNone)(t)?(e.logError("hasRepeatingParams: funcInfo is null or undefined"),!1):(0,s.getWorksheetFuncTypeWrapper)(t).restTypes.length>0}}return e.prototype.getMinimalParamArray=function(e,t){var r;if(!(0,n.isNone)(t)){for(var i=(0,s.getWorksheetFuncTypeWrapper)(t),a=i.minArgs,o=i.restTypes.length>0?Math.max(a,2):null!==(r=null==e?void 0:e.length)&&void 0!==r?r:0,u=[],l=0;l<o;l+=1){var c=this.getFunctionParamByIndex(e,t,l);(0,n.isDefined)(c)&&u.push(c)}return u}},e.prototype.getFunctionParamByIndex=function(e,t,r){if(!(0,n.isNone)(t)){var i=(0,s.getWorksheetFuncTypeWrapper)(t),o=i.headTypes.length,u=t.ParamsHelp.split("!"),l=(0,a.getParamIndexToHighlight)(r,e.length,i,!1,!0);if(-1!==l){if(!(l>=e.length)){var c=r<o?e[l].match(/[^\[\]]+/).toString():"".concat((0,a.getBaseParamName)(e[l])).concat((0,a.getParamNumberSuffix)(r,o,i.restTypes.length)),d=u[(0,a.getParamIndexToHighlight)(r,t.ParamsHelp.split("!").length,i)];return{name:c,isOptional:r>=i.minArgs,description:d,type:"TO DO"}}this.logError("Trying to add param for a signature that doesn't have rest params.")}else this.logError("Trying to get param by index that is out of bounds")}},e.prototype.getFormulaAnonymizer=function(e){var t=this,r=new o.ConsistentAnonymizer;return{anonymize:function(i,a){try{return o=i,(0,n.isDefined)(o)&&"string"==typeof o?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"localeInfo"in e&&"mathpack"in e&&"refStyle"in e}(e)?function(e){return(0,n.isDefined)(e)&&"object"==typeof e&&"row"in e&&"col"in e&&1===e.rows&&1===e.cols}(a)?r.anonymize(i,e,a):(t.logError("getFormulaAnonymizer: Origin"),null):(t.logError("getFormulaAnonymizer: Config"),null):(t.logError("getFormulaAnonymizer: Formula"),null)}catch(e){return t.logError("getFormulaAnonymizer: ".concat(e)),null}var o}}},e.prototype.logError=function(e){i.ulsLogger.ULS.traceTag(512331973,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"FormulaAuthoringHelper error: ".concat(e))},e}();t.FormulaAuthoringHelper=u},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncTypeWrapper=void 0;var i=r(36),a=r(36);t.getWorksheetFuncTypeWrapper=function(e){return o(e)?s[e.FunctionIndexInServer][e.signatureIndex]:(0,a.getWorksheetFuncType)(e.FunctionIndexInServer)};var o=function(e){if(void 0===e)return!1;var t=e,r=t.FunctionIndexInServer,n=t.signatureIndex;return!(0!==n&&1!==n||r!==i.WorksheetFuncId.AGGREGATE&&r!==i.WorksheetFuncId.INDEX&&r!==i.WorksheetFuncId.LOOKUP)},s=((n={})[i.WorksheetFuncId.AGGREGATE]=[{headTypes:[1,1,48,17],restTypes:[],tailTypes:[],minArgs:3,maxArgs:4},{headTypes:[1,1],restTypes:[16],tailTypes:[],minArgs:3,maxArgs:255}],n[i.WorksheetFuncId.INDEX]=[{headTypes:[48,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[48,1,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:4}],n[i.WorksheetFuncId.LOOKUP]=[{headTypes:[263,48,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[263,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:2}],n)},function(e,t,r){"use strict";var n,i,a;r.r(t),r.d(t,"FormulaByExampleResultKind",(function(){return n})),r.d(t,"FormulaByExampleInvocationMethod",(function(){return i})),r.d(t,"ValueType",(function(){return a})),r.d(t,"FormulaByExampleSignal",(function(){return s})),r.d(t,"FormulaByExampleWarmUpSignal",(function(){return u})),r.d(t,"FormulaByExampleAnnotation",(function(){return l})),r.d(t,"FormulaByExampleWarmUpAnnotation",(function(){return c})),function(e){e[e.Success=0]="Success",e[e.NoFormulas=1]="NoFormulas",e[e.Failed=2]="Failed"}(n||(n={})),function(e){e[e.Explicit=0]="Explicit",e[e.Implicit=1]="Implicit"}(i||(i={})),function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.DateTime=2]="DateTime"}(a||(a={}));class o{constructor(e){o.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=o.getTypeNameFor(e);return t?[t,...o.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const r=o.getTypeNameFor(e),n=o.getBaseTypesFor(e);for(const e of t){if(e===r)return!0;if(n.indexOf(e)>=0)return!0}return!1}static assign(e,t,r){if(r)for(const e of Object.keys(r))t[e]=r[e];return t.H_=e.H_,t}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class s{constructor(e){o.assign(s,this,e)}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class u{constructor(e){o.assign(u,this,e)}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.assign(l,this,e)}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.assign(c,this,e)}static getTypeName(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map