'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1176:function(y,m){function a(){return"undefined"===typeof globalThis.x7c?b:globalThis.x7c()}function c(e,k){var d;return null!==(d=a()[e])&&void 0!==d?d:k}Object.defineProperty(m,"__esModule",{value:!0});m.setFeatureGateDictionaryGetter=m.getIntFeatureGate=m.JKf=m.getBooleanFeatureGate=m.getStringFeatureGate=m.wSb=void 0;var b={};m.wSb=a;m.getStringFeatureGate=c;m.getBooleanFeatureGate=function(e,k){var d;e=
null===(d=c(e))||void 0===d?void 0:d.trim().toLowerCase();return"true"===e?!0:"false"===e?!1:k};m.JKf=function(e,k){var d;e=null===(d=c(e))||void 0===d?void 0:d.trim().toLowerCase();if(void 0===e)return k;if("infinity"===e||"+infinity"===e)return Infinity;if("-infinity"===e)return-Infinity;d=parseFloat(e);return isNaN(d)?k:d};m.getIntFeatureGate=function(e,k){var d;e=null===(d=c(e))||void 0===d?void 0:d.trim();if(void 0===e)return k;d=parseInt(e,10);return isNaN(d)?k:d};m.setFeatureGateDictionaryGetter=
function(e){var k=globalThis.x7c;globalThis.x7c=e;return k}},1177:function(y,m){function a(){return"undefined"===typeof globalThis.w7c?{}:globalThis.w7c()}Object.defineProperty(m,"__esModule",{value:!0});m.setChangeGateDictionaryGetter=m.isChangeGateEnabled=m.QAc=void 0;m.QAc=a;m.isChangeGateEnabled=function(c){var b;return null!==(b=a()[c])&&void 0!==b?b:!0};m.setChangeGateDictionaryGetter=function(c){var b=globalThis.w7c;globalThis.w7c=c;return b}},1545:function(y,m,a){Object.defineProperty(m,"__esModule",
{value:!0});var c=a(127);c.__exportStar(a(1176),m);c.__exportStar(a(1546),m);c.__exportStar(a(1177),m);c.__exportStar(a(1547),m);c.__exportStar(a(1548),m);c.__exportStar(a(1549),m)},1546:function(y,m,a){Object.defineProperty(m,"__esModule",{value:!0});m.ZEj=void 0;var c=a(1176);m.ZEj=function(b){return function(e){var k=b[e];switch(typeof k){case "boolean":return(0,c.getBooleanFeatureGate)(e,k);case "number":return(0,c.JKf)(e,k);case "string":return(0,c.getStringFeatureGate)(e,k);default:throw Error("Wrong defaultValue type");
}}}},1547:function(y,m,a){Object.defineProperty(m,"__esModule",{value:!0});m.fFj=void 0;var c=a(1177);m.fFj=function(){return function(b){return(0,c.isChangeGateEnabled)(b)}}},1548:function(y,m,a){function c(k){var d=(0,e.setChangeGateDictionaryGetter)(void 0);(0,e.setChangeGateDictionaryGetter)(function(){var u=void 0!==d?d():{};return b.__assign(b.__assign({},u),k)});return d}Object.defineProperty(m,"__esModule",{value:!0});m.g5j=m.Z4j=void 0;var b=a(127),e=a(1177);m.Z4j=c;m.g5j=function(k,d){return c(d)}},
1549:function(y,m,a){function c(k){function d(){return{}}for(var u,n,v={},f=0,w=Object.keys(k);f<w.length;f++){var r=w[f];v[r]=null===(u=k[r])||void 0===u?void 0:u.toString()}var t=null!==(n=(0,e.setFeatureGateDictionaryGetter)(void 0))&&void 0!==n?n:d;(0,e.setFeatureGateDictionaryGetter)(function(){return b.__assign(b.__assign({},t()),v)});return t}Object.defineProperty(m,"__esModule",{value:!0});m.h5j=m.d5j=void 0;var b=a(127),e=a(1176);m.d5j=c;m.h5j=function(k,d){return c(d)}},214:function(y,m,
a){function c(nb){if(window&&window.performance&&window.performance.mark)try{window.performance.mark(nb)}catch(ic){}}function b(nb,ic){return nb?nb.nameManagerItems.filter(ic).map(Bc=>({runtimeUid:Bc.metadata.runtimeUid,name:Bc.name,reference:"="+Bc.reference,comment:Bc.comment,type:Gb.NRi(Bc.metadata.type),scope:Gb.XWi(Bc.scope),referenceSheetName:Bc.referenceSheetName,isInvalidReference:Bc.isInvalidReference,topLeft:Bc.topLeft,bottomRight:Bc.bottomRight})):null}function e(){return{show:{count:0,
repairCounts:[]},hideDurations:{escape:[],ignore:[],selection:[],edit:[],commit:[],scroll:[]}}}a.r(m);var k={};a.r(k);a.d(k,"AutoSumCommandHandler",function(){return oa});var d={};a.r(d);a.d(d,"CellImageToFloatingObjectController",function(){return Xa});var u={};a.r(u);a.d(u,"ClearCommandHandler",function(){return mc});var n={};a.r(n);a.d(n,"ClearContentNotifier",function(){return Fc});var v={};a.r(v);a.d(v,"DefinedNameManager",function(){return Ub});var f={};a.r(f);a.d(f,"FileCollectionOperation",
function(){return Vc});var w={};a.r(w);a.d(w,"FloatingObjectToCellImageController",function(){return wc});var r={};a.r(r);a.d(r,"FontDropdownHelper",function(){return jd});var t={};a.r(t);a.d(t,"FormatCellsCommandHandler",function(){return Qa});var l={};a.r(l);a.d(l,"FormulaAnonymizer",function(){return Ob});var x={};a.r(x);var A={};a.r(A);a.d(A,"FormulaRepairTelemetry",function(){return hd});var z={};a.r(z);a.d(z,"FreezePanesDragDirection",function(){return Be});a.d(z,"FreezePaneDragOrigin",function(){return Ee});
a.d(z,"FreezePaneDragAction",function(){return Ve});var F={};a.r(F);a.d(F,"FreezePanesCommandHandler",function(){return If});var D={};a.r(D);a.d(D,"HeaderInsert",function(){return tc});var G={};a.r(G);a.d(G,"ImageInCellCommandHandler",function(){return ge});var Q={};a.r(Q);a.d(Q,"NameManagerCommandHandler",function(){return Ba});var O={};a.r(O);a.d(O,"OfficePyUXCommandHandler",function(){return sc});var J=a(127),H=a(0),N=a(15),L=a(262),Z=a(235),ba=a(64);const K=(nb,ic,Bc,Qc,pd,Xd)=>{if(ic){const ue=
nb.Xa;nb.isEditing||nb.startEdit(ic,!0);nb.EZd=!0;nb.text=Bc;ue.caretPosition=pd;pd<Xd&&(Qc&&nb.FQa(),ue.selectRange(0,Xd+1),ue.selectRange(pd,Xd))}};var E=a(63);class U{constructor(nb,ic){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=nb;this.type=ic}xmb(){return this.sharedSheetRange}}Object(H.a)(U,"MacroRecorderAutoSumPayload",null,[149]);var X=a(46),ia=a(431),Ma=a(216),qa=a(78),Ha=a(40),ha=a(365),La=a(36),fa=a(1),ja=a(212),ta=a(265),Ka=a(23),Ga=a(145),Na=a(676),cb=a(68),jb=a(5),
Sa=a(92),bb=a(91);let oa=class extends Z.a{constructor(nb){super();this.m4j={[-134268171]:"+",[406756244]:"-",[1405397228]:"*",[-264074569]:"/"};this.ZOj=ic=>{const Bc=Ka.f(this.$);if(ic=ic.Result){let Qc=X.H(ic.NewSelection),pd=X.H(ic.NewActiveCell);if(Qc&&pd)if(!ic.Committed&&ic.AutoSumFormula){const Xd=Bc.yh(pd);Xd&&(Bc.ha.updateSelection(Qc,pd,60),Qc=pd=X.H(ic.MarkedArea),Bc.OM=2,K(Bc.cellTextEditBox,Xd,ic.AutoSumFormula,!!Qc,ic.FormulaMarkStart,ic.FormulaMarkEnd),Qc&&pd&&Bc.ha.updateSelection(Qc,
pd,0),Ha.TaskExtensions.$e(fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(bb.d)(Sa.a.resolve(jb.l,{va:0})):qa.GetServiceTaskFactory.dk(this.$.qa,211,212,0),ue=>{ue.result.Fca(Bc.cellTextEditBox.text)},this.$.ya,3),Bc.cellTextEditBox.EZd=!1,void Sa.a.resolve(jb.Yc,{va:0}).then(ue=>{ue.akb(null)}))}else Bc.ha.updateSelection(Qc,pd,60)}};this.$=nb}Ri(){return!1}executeCommand(nb,ic,Bc){nb=ic.command;switch(nb){case 1220954656:case 505713221:ic=this.Prf(0,
ic);break;case -1537138325:ic=this.Prf(parseInt(Bc[E.a.Pi].toString(),10),ic);break;case -134268171:case 406756244:case 1405397228:case -264074569:ic=this.T2i(ic);break;default:ic=ja.a(nb)}return ic}Ei(nb,ic){if(nb=1===nb)switch(ic.command){case 1220954656:case 505713221:case -1537138325:break;case -134268171:case 406756244:case 1405397228:case -264074569:nb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BasicArithmeticOperations",!1);break;default:nb=!1}return nb}dj(){return!1}bKf(nb,
ic){return(nb=nb.wB(ic))?nb:ic}cTb(nb,ic,Bc){ic="above"===Bc?X.I(ic,nb.jj):X.J(ic,nb.jj);return this.bKf(nb,ic)}p5h(nb,ic){const Bc=this.bKf(nb,nb.ha.pa.activeCell);const Qc=1===Bc.top||1===this.cTb(nb,Bc,"above").top;var pd=Qc?this.cTb(nb,Bc,"below"):this.cTb(nb,Bc,"above");var Xd=JSON.parse(JSON.stringify(pd));Xd.left=Bc.left;Xd=Qc?this.cTb(nb,Xd,"below"):this.cTb(nb,Xd,"above");ic=`=${pd.topLeft} ${ic} `;pd=nb.Dh;nb.startEdit(!0,1);pd.text=`${ic}`;pd.Xa.nxb(ic.length);pd.Xa.caretPosition=ic.length;
nb.ha.updateSelection(Xd.topLeft,Bc,60)}T2i(nb){const ic=Ka.f(this.$),Bc=this.m4j[nb.command];return Bc?L.a.Ua(Sa.a.resolve(jb.Gc,{va:0}).then(()=>{this.p5h(ic,Bc);return!0}).catch(Qc=>{N.ULS.sendTraceTag(507381573,0,10,`AutoSumCommandHandler.handleArithmeticOperator: Error occurred while resolving FormulaAssistanceManagerService: ${Qc}`);return!1})):(N.ULS.sendTraceTag(507388317,0,10,`AutoSumCommandHandler.handleArithmeticOperator: Unhandled command ${nb.command}`),L.a.Ua(!1))}Prf(nb,ic){const Bc=
Ka.f(this.$);Bc.ho.DU(!1);if(!Ka.f(this.$).ha.pa.Yn)return ic=Ka.f(this.$).ha.pa.OV,N.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${nb} due to discontinuous selection. Number of selected ranges is ${ic}`),this.wOa(),cb.Task.Ua(!1);const Qc=Bc.KK();if(!Qc)return null;const pd=X.x(Bc.ha.pa.oj,this.$),Xd=X.q(Bc.ha.pa.activeCell,this.$),ue=X.q(Qc,this.$),Ie=this.$.oa.ta.Wh(),Je=()=>new U(pd,nb);return this.$.wy(Bc.ha.pa.selectedRanges,!0)?ia.a(this.$.userOperationManager,
(He,hf,rf)=>{var qf=this.$.oa.ta;He=ta.c(He,this.ZOj);const We=qf.Za(9,Ie);We.selectedRange=pd;We.activeCell=Xd;We.autoSumType=nb;We.topLeftCell=ue;return ba.h(qf,"AutoSum",We,He,hf,rf,nb,0)},He=>new Ma.a(502,0,He,64,Je),ic):cb.Task.Ua(!1)}wOa(){Na.a(Ga.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);const nb=La.a.nj(1,1,751,2192,0,371863010,"DiscontinuousSelectionBlocking");new ha.a(this.$,nb)}};oa=Object(J.__decorate)([Object(Sa.d)(jb.v),Object(J.__param)(0,Object(jb.Ob)())],oa);
Object(H.a)(oa,"AutoSumCommandHandler",Z.a,[36]);var ka=a(80),ya=a(792),Oa=a(183),za=a(37),ea=a(940),Aa=a(12),ub=a(84),rb=a(130),Ja=a(141);let Xa=class extends ka.a{constructor(nb,ic,Bc,Qc){super();this.rj=()=>{this.button.getButton(this.da.fh.Wn(this.da.ha.pa.activeCell)).gub();Oa.a.sendTelemetryEvent({name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:rb.a.xn({["buttonType"]:"CellImageToFloatingObject"})});const pd=new ub.a(2000316912,E.a.ph,this.$.ji,9,null);this.$.Ia.qh(pd,null)};
this.xm=()=>{this.hda()};this.nq=()=>{this.hda()};this.YE=()=>{this.hda()};this.Vy=()=>{this.hda()};this.Jn=()=>{this.xY()};this.Yu=()=>{this.xY()};this.IA=()=>{this.hda()};this.$=nb;this.button=Bc.wNb(nb,ic,this.rj,null,null,Aa.a.instance.ia(2318),"CellImageToFloatingObjectPointerDown");this.isVisible=!1;this.da=Ka.f(this.$);this.da.ha.BX(this.xm);this.da.Dh.fM(this.Jn);this.da.gA(this.YE);this.$.LI(this.nq);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.fa.lK(this.IA);
this.da.view.uz(this.Vy);this.da.ha.$a.AO(this.Yu);this.ariaLiveNotifier=Qc}dispose(){this.da&&(this.da.ha.JZ(this.xm),this.da.view.gy(this.Vy),this.da.dF(this.YE),this.da.ha.$a.dW(this.Yu),this.da.Dh&&this.da.Dh.HN(this.Jn));this.$&&(this.$.mL(this.nq),fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.fa.gI(this.IA));this.button.dispose();this.ariaLiveNotifier=this.$=this.da=this.button=null;super.dispose()}Hnd(){this.isVisible&&this.rj(null,null)}hda(){if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&
!this.$.isEditMode)this.xY();else{fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8478102_HideOOUIOnFloatingObjectSelected")&&this.da.ha.$a.isFloatingObjectSelected&&this.xY();var nb=this.da.ha.pa.activeCell;if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){var ic=new Ja.a(this.$.sa);if(ic&&ic.Bn&&(ic.K3f(nb,this.da)||!ic.Sj(1))){this.xY();return}}ic=this.da.za.Wx(nb);null!=ic&&ic.B0a?this.hra(nb):this.xY()}}hra(nb){const ic=this.da.fh.Wn(nb);nb=this.da.Hl(nb,ic);
const Bc=this.da.ol(ic).Zr;var Qc=this.da.ha.pa.activeCell;if(!(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8352188_DisableInCellOOUIForFormulaBasedImage")&&Qc&&this.da.oh.uWb(Qc)&&this.da.oh.aWd(Qc)||fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8352225_DisableInCellOOUIForPivotTable")&&this.da.oh.NY(Qc)))if(1===this.da.ha.Hk&&nb&&nb.$i(Bc)&&Bc.width>nb.width){Qc=nb.bottomRight.x+this.PE;let pd=nb.topLeft.y-this.PE-this.button.buttonWidth;Qc+this.button.buttonWidth>Bc.bottomRight.x&&(Qc=nb.topLeft.x-
this.PE-this.button.buttonWidth);pd<Bc.topLeft.y+this.PE&&(pd=Bc.topLeft.y+this.PE);this.hv(Qc,pd,this.da.rtl,ic)}else this.xY()}hv(nb,ic,Bc,Qc){this.button.v4c(ea.a.Pfj,Aa.a.instance.ia(2318),Qc);this.button.X3c(Aa.a.instance.ia(2318),Qc);this.button.hv(nb,ic,Bc,Qc,!1,!0);this.isVisible=!0;this.BIh()}xY(){this.button.hide();this.isVisible=!1}BIh(){let nb;nb=za.a.isMac?Aa.a.instance.ia(2321):Aa.a.instance.ia(2320);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.Fca(nb)}get PE(){return this.button.PE}};
Xa=Object(J.__decorate)([Object(Sa.d)(jb.P),Object(J.__param)(0,Object(jb.Ob)()),Object(J.__param)(1,Object(ya.h)()),Object(J.__param)(2,Object(jb.Tf)()),Object(J.__param)(3,Object(jb.l)())],Xa);Object(H.a)(Xa,"CellImageToFloatingObjectController",ka.a,[]);var Y=a(191),Ia=a(247),$a=a(27),Ea=a(41),Lb=a(1317),Ib=a(255),Mb=a(65);let mc=class extends Ea.a{constructor(nb,ic,Bc,Qc){super();this.$=nb;this.Qj=ic;this.xk=Bc;this.clearContentNotifier=Qc;this.oQj=(pd,Xd)=>{if(!Ib.a(pd)&&Xd){const ue=!!pd&&!!pd.RequestTelemetryData;
Ka.f(this.$).tk.c2(Xd.toString(),pd.StateId,ue?pd.RequestTelemetryData.EcsOperationDuration:0,ue?pd.RequestTelemetryData.EcsRequestDuration:0,ue?pd.RequestTelemetryData.WfeRequestDuration:0)}}}Ri(){return!1}executeCommand(nb,ic){nb=ic.command;switch(nb){case -730106152:ic=this.iRd(ic,3);break;case -1228228458:ic=this.iRd(ic,4);break;case -848953656:case 2045211913:if(this.zqj()){ic=cb.Task.Ua(!0);break}ic=this.iRd(ic,1);break;default:ic=ja.a(nb)}return ic}Ei(nb,ic){if(nb=1===nb)switch(ic.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;
default:nb=!1}return nb}dj(){return!1}iRd(nb,ic){const Bc=Ka.f(this.$),Qc=Bc.ha.pa.selectedRanges,pd=nb.command,Xd=Y.a.create().toString();if(!this.$.wy(Qc,!0)&&-730106152!==pd)return cb.Task.Ua(!0);const ue=X.t(Qc,this.$);this.LRk(pd,Bc,Qc,Xd);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.clearContentNotifier.iek();const Ie=this.$.oa.ta.Wh({Oza:!0,rya:1}),Je=()=>new Lb.a(ic,ue);return ia.a(this.$.userOperationManager,(He,hf,rf)=>{this.$.eD();
return ba.d(this.$.oa.ta,ic,ue,!1,ta.c(He,this.oQj),hf,rf,Xd,Ie)},He=>new Ma.a(508,0,He,67,Je),nb)}LRk(nb,ic,Bc,Qc){if(-848953656!==nb&&2045211913!==nb&&-730106152!==nb&&-1228228458!==nb)N.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${nb}.`);else if(!Ia.a.any(Bc,Xd=>0<ic.getRangeInformation(Xd).length)){var pd=Ia.a.any(Bc,Xd=>this.Qj.d0d(Xd));(-730106152===nb||-1228228458===nb)&&pd||fa.EwaSettings.sV()&&fa.EwaSettings.Lkj()&&2045211913===nb&&this.Qnj(Bc)||
(this.rWk(ic,nb,Qc,Bc),-730106152!==nb&&-1228228458!==nb||this.xk.jra(ic,-730106152,{}),-1228228458!==nb&&2045211913!==nb&&-848953656!==nb||this.xk.gxd(Bc,!0,Qc),ic.tk.HT(Qc,Mb.BasicTelemetryCalculator.nS))}}rWk(nb,ic,Bc,Qc){let pd="";switch(ic){case -1228228458:pd="ClearAll";break;case 2045211913:case -848953656:pd="ClearContent";break;case -730106152:pd="ClearFormat";break;default:N.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${ic}.`)}ic=
Qc.length;Qc=X.b(Qc);nb.tk.BQ(15,Bc,pd+(", ranges to clear: "+ic+", cells to clear: "+Qc))}zqj(){if(Ka.f(this.$).eG){const nb=this.$.qa.zh(296);return!!nb&&nb.K5.YK}return!1}Qnj(nb){return Ia.a.any(nb,ic=>{var Bc;const Qc=Ka.f(this.$);for(let pd=ic.top;pd<=ic.bottom;pd++)for(let Xd=ic.left;Xd<=ic.right;Xd++){const ue=null===(Bc=Qc.yh($a.Range.yi(pd,Xd)))||void 0===Bc?void 0:Bc.cell;if(ue&&ue.inCellControlOptions&&0!==ue.inCellControlOptions.Type)return!0}return!1})}};mc=Object(J.__decorate)([Object(Sa.d)(jb.Y),
Object(J.__param)(0,Object(jb.Ob)()),Object(J.__param)(1,Object(jb.yg)()),Object(J.__param)(2,Object(jb.zc)()),Object(J.__param)(3,Object(jb.Z)())],mc);Object(H.a)(mc,"ClearCommandHandler",Ea.a,[36]);var jc=a(371);let Fc=class extends Ea.a{Dpd(nb){this.addHandler("ekcvc",nb)}wVc(nb){this.removeHandler("ekcvc",nb)}iek(){this.raiseEvent("ekcvc",new jc.a)}};Fc=Object(J.__decorate)([Object(Sa.d)(jb.Z)],Fc);Object(H.a)(Fc,"ClearContentNotifier",Ea.a,[538]);var Gc=a(128),xc=a(75),Uc=a(1608);class Pa{}Pa.udl=
"utf-8";Pa.WSi="GetOperationTimer";Pa.Cei="DeleteOperationTimer";Pa.Jcl="UpsertOperationTimer";Pa.jdi=[Uc.a.NamedRange,Uc.a.Table,Uc.a.PrintArea,Uc.a.Others];Pa.fKj=[0];Pa.tzk=[0,1];Object(H.a)(Pa,"ConstantsDefinedNameManager",null,[]);class Bb extends Sys.EventArgs{constructor(nb,ic,Bc,Qc){Qc=void 0===Qc?!1:Qc;super();this.status=nb;this.operationType=ic;this.gxb=Bc;this.loj=Qc}}Object(H.a)(Bb,"DefinedNameOperationEventArgs",Sys.EventArgs,[]);var Nb=a(61);class oc{static create(nb){const ic=new oc;
Object.assign(ic,nb);return Nb.a.Di(ic)}}Object(H.a)(oc,"NameManagerTelemetryData",null,[]);class aa{static VE(nb,ic){(nb||ic)&&N.ULS.sendTraceTag(507581128,0,nb,ic)}static Ona(nb){switch(nb){case "success":return 50;case "successWithServerException":case "failure":return 10}}}Object(H.a)(aa,"NameManagerTelemetry",null,[]);var rc=a(28);const yb={namedrange:Uc.a.NamedRange,table:Uc.a.Table,others:Uc.a.Others,print_area:Uc.a.PrintArea},Fb={global:0,local:1},Qb=[1546370075,472177316,-1818810228,-201732986],
ac={[0]:nb=>0===nb.scope,[1]:nb=>1===nb.scope,[2]:nb=>nb.isInvalidReference,[3]:nb=>!nb.isInvalidReference,[4]:nb=>nb.type===Uc.a.NamedRange,[5]:nb=>nb.type===Uc.a.Table},Wa=(nb,ic,Bc,Qc,pd)=>{nb=Object.assign({},{method:`NameManagerUtils.${Bc}`,executionTime:ic-nb},Qc&&{input_length:Qc},pd&&{output_length:pd});N.ULS.sendTraceTag(507581578,0,50,Nb.a.Di(nb))};class Gb{static Z7i(nb,ic,Bc,Qc,pd){return void 0===Qc&&0!==(null===nb||void 0===nb?void 0:nb.length)&&0!==(null===ic||void 0===ic?void 0:ic.length)?
!0:Qc&&nb&&ic&&pd?(pd=pd.find(Xd=>Xd.runtimeUid===Qc))?(null===pd||void 0===pd?void 0:pd.name)!==nb||(null===pd||void 0===pd?void 0:pd.reference)!==ic||(null===pd||void 0===pd?void 0:pd.comment)!==Bc:!1:!1}static NRi(nb){return void 0!==nb?yb[nb.toLowerCase()]:null}static XWi(nb){return void 0!==nb?Fb[nb.toLowerCase()]:null}static search(nb,ic){if(!nb||0===nb.length||!ic)return nb;const Bc=performance.now(),Qc=nb.filter(Xd=>Xd.name.toLowerCase().includes(ic.toLowerCase().trim())),pd=performance.now();
Wa(Bc,pd,"search",nb.length,Qc.length);return Qc}static MKi(nb,ic){return null!==nb&&void 0!==nb&&nb.length&&null!==ic&&void 0!==ic&&0!==ic.length?nb.find(Bc=>Bc.runtimeUid===ic):null}static bPi(nb,ic){return null!==nb&&void 0!==nb&&nb.length&&null!==ic&&void 0!==ic&&0!==ic.length?nb.findIndex(Bc=>Bc.metadata.runtimeUid===ic):-1}static l_c(nb){return nb?Qb.includes(nb):!1}static iMi(nb){if(!nb||!nb.gxb||nb.status)return null;const ic=[];let Bc;if(Gb.l_c(nb.gxb))switch(null===nb||void 0===nb?void 0:
nb.gxb){case 472177316:ic.push({target:1,errorMessage:Aa.a.instance.Aa(912)});break;case 1546370075:ic.push({target:0,errorMessage:Aa.a.instance.Aa(911)});break;case -1818810228:Bc=Aa.a.instance.Aa(1008);break;default:Bc=Gb.XGf(nb.operationType)}return{dfg:ic,Kac:Bc}}static XGf(nb){if(nb)switch(nb){case "add":return Aa.a.instance.Aa(905);case "update":return Aa.a.instance.Aa(906);case "delete":return Aa.a.instance.Aa(907)}return null}static cfl(nb,ic,Bc,Qc,pd){const Xd=[];let ue;pd!==Uc.a.Table&&
(ue=Gb.qVh(Bc,nb));nb=Gb.oVh(Qc);ic=Gb.pVh(ic);ue&&Xd.push(ue);nb&&Xd.push(nb);ic&&Xd.push(ic);return Xd}static lPd(nb){return nb&&1===nb.length?nb[0].MessageId:null}static pVh(nb){let ic;var Bc;if(!(Bc=!nb||0===(null===nb||void 0===nb?void 0:nb.length)||255<(null===nb||void 0===nb?void 0:nb.length))){a:{for(Bc=0;Bc<nb.length;Bc++){const Qc=nb.charAt(Bc),pd=nb.charCodeAt(Bc);if(!Bc){if("\\"!==Qc&&"_"!==Qc&&!rc.a.isLetter(pd)){Bc=!1;break a}}else if("_"!==Qc&&"."!==Qc&&!rc.a.g1f(pd)&&!rc.a.isNumeral(pd)){Bc=
!1;break a}}Bc=!0}Bc=!Bc}if(Bc||rc.a.mI(nb,"_xl"))ic=Aa.a.instance.Aa(910);return ic?{target:0,errorMessage:ic}:null}static oVh(nb){let ic;255<(null===nb||void 0===nb?void 0:nb.length)&&(ic=Aa.a.instance.Aa(914));return ic?{target:2,errorMessage:ic}:null}static qVh(nb,ic){if(nb&&0===nb.length)nb=Aa.a.instance.Aa(912);else switch(ic(nb)){case "valid":return null;case "notFormulaString":nb=Aa.a.instance.Aa(913);break;default:nb=Aa.a.instance.Aa(912)}return{target:1,errorMessage:nb}}static filterBy(nb,
ic){if(!nb||0===nb.length||void 0===ic)return nb;const Bc=performance.now();ic=nb.filter(ac[ic]);const Qc=performance.now();Wa(Bc,Qc,"filterBy",nb.length,ic.length);return ic}static K4h(nb){const ic={[0]:0,[1]:0,[2]:0,[3]:0,[4]:0,[5]:0};if(!nb||0===nb.length)return ic;const Bc=performance.now();for(var Qc of nb)for(const pd in ac)ac[pd](Qc)&&ic[pd]++;Qc=performance.now();Wa(Bc,Qc,"countByFilter",nb.length);return ic}static groupBy(nb,ic,Bc){const Qc={};ic.forEach(pd=>{Qc[pd]=[]});for(const pd of nb)nb=
Bc(pd),Qc[nb].push(pd);return Qc}static pOi(nb){switch(nb){case 0:return{aRd:Pa.jdi,bRd:ic=>ic.type};case 1:return{aRd:Pa.fKj,bRd:()=>0};case 2:return{aRd:Pa.tzk,bRd:ic=>ic.scope}}}static sort(nb,ic){switch(ic){case 0:return nb.sort((Bc,Qc)=>Bc.name.localeCompare(Qc.name));case 1:return nb.sort((Bc,Qc)=>Qc.name.localeCompare(Bc.name))}}static $Qd(nb,ic,Bc){if(!nb||0===nb.length||void 0===ic||void 0===Bc)return nb;const Qc=performance.now(),{aRd:pd,bRd:Xd}=Gb.pOi(ic),ue=Gb.groupBy(nb,pd,Xd),Ie=[];
pd.forEach(Je=>{Ie.push(...Gb.sort(ue[Je],Bc))});ic=performance.now();Wa(Qc,ic,"groupAndSortBy",nb.length,Ie.length);return Ie}static L4h(nb){if(!nb)return null;const ic={};nb.forEach(Bc=>{const Qc=Bc.scope;Bc=Bc.metadata.type;ic[Qc]||(ic[Qc]={});ic[Qc][Bc]||(ic[Qc][Bc]=0);ic[Qc][Bc]++});return ic}}Object(H.a)(Gb,"NameManagerUtils",null,[]);let Ub=class{constructor(nb,ic){var Bc;this.eh=new Ea.a;this.stateId=0;this.KXd=fa.EwaSettings.hIc();this.e6e=Qc=>{this.eh.addHandler("dnek",Qc)};this.L0d=Qc=>
this.Mj.L0d(Qc);this.Wl=()=>{var Qc;const pd=null===(Qc=this.$.fa.Aq)||void 0===Qc?void 0:Qc.NamedManagerResponseStateId;pd>this.stateId&&(this.stateId=pd,N.ULS.sendTraceTag(507639444,0,50,"DefinedNameManager.OnWorkbookMetadataChanged : Received a stateId change and Invoked GetDefinedNames API"),this.$de(!0))};this.$de=Qc=>{this.vKa=this.$.Eh.Oi("WebServiceCall",Pa.WSi);const pd=ue=>{this.t3i(ue,Qc)},Xd=ue=>{var Ie,Je;null===(Ie=this.vKa)||void 0===Ie?void 0:Ie.stop();ue=Gc.a.$j(ue.data);ue=La.a.fi(ue);
Ie=oc.create({operationType:"get",status:"failure",executionTime:null===(Je=this.vKa)||void 0===Je?void 0:Je.Ci,error:ue});aa.VE(aa.Ona("failure"),Ie);this.IYa=null;this.raiseEvent("dnek",new Bb(!1,"get",null,Qc))};ia.a(this.$.userOperationManager,(ue,Ie,Je)=>{var He=this.$.oa.ta;ue=ta.c(ue,pd);Ie=ta.b(Ie,Xd);var hf=this.$;const rf=He.Za(1,null);return ba.h(He,"GetDefinedNames",rf,ue,Ie,Je,hf,0)},ue=>new Ma.a(1037,0,ue,16),null)};this.raiseEvent=(Qc,pd)=>{this.eh.raiseEvent(Qc,pd)};this.upsertDefinedName=
(Qc,pd,Xd,ue,Ie)=>{var Je;this.yAb=this.$.Eh.Oi("WebServiceCall",Pa.Jcl);const He=Gb.bPi(null===(Je=this.IYa)||void 0===Je?void 0:Je.nameManagerItems,ue),hf=We=>{this.S6i(We,He,Ie)},rf=We=>{var Jf,tf;null===(Jf=this.yAb)||void 0===Jf?void 0:Jf.stop();We=Gc.a.$j(We.data);We=La.a.fi(We);Jf=oc.create({operationType:-1!==He?"update":"add",status:"failure",executionTime:null===(tf=this.yAb)||void 0===tf?void 0:tf.Ci,error:We,type:Ie});aa.VE(aa.Ona("failure"),Jf);this.raiseEvent("dnuek",new Bb(!1,-1!==
He?"update":"add",null))},qf={Name:Qc,Reference:pd,SheetName:"",Comment:Xd,Type:Ie,RuntimeUid:ue};ia.a(this.$.userOperationManager,(We,Jf,tf)=>{var ff=this.$.oa.ta;We=ta.c(We,hf);Jf=ta.b(Jf,rf);var xf=this.$;const Lf=ff.Za(9,null);Lf.definedNameRequest=qf;return ba.h(ff,"UpsertDefinedName",Lf,We,Jf,tf,xf,0)},We=>new Ma.a(1035,0,We),null)};this.$=nb;this.Mj=ic;this.KXd&&(this.$.fa.vz(this.Wl),this.$.fa.Aq&&(this.stateId=null===(Bc=this.$.fa.Aq)||void 0===Bc?void 0:Bc.NamedManagerResponseStateId))}gGh(nb){this.eh.addHandler("dnuek",
nb)}bDh(nb){this.eh.addHandler("dndok",nb)}Vpk(nb){this.eh.removeHandler("dnek",nb)}Uqk(nb){this.eh.removeHandler("dnuek",nb)}iok(nb){this.eh.removeHandler("dndok",nb)}vz(){var nb;this.KXd||(this.$.fa.vz(this.Wl),this.$.fa.Aq&&(this.stateId=null===(nb=this.$.fa.Aq)||void 0===nb?void 0:nb.NamedManagerResponseStateId))}SB(){this.KXd||this.$.fa.SB(this.Wl)}getItems(nb){return b(this.IYa,nb)}t3i(nb,ic){var Bc,Qc,pd,Xd,ue,Ie,Je,He,hf;let rf=!1,qf;try{if(nb&&!Ib.a(nb)){const We=new Uint8Array(nb.Result),
Jf=(new TextDecoder(Pa.udl)).decode(We.buffer);this.IYa=JSON.parse(Jf);null===(Bc=this.vKa)||void 0===Bc?void 0:Bc.stop();rf=!0;const tf=oc.create({operationType:"get",status:"success",executionTime:null===(Qc=this.vKa)||void 0===Qc?void 0:Qc.Ci,count:null===(Xd=null===(pd=this.IYa)||void 0===pd?void 0:pd.nameManagerItems)||void 0===Xd?void 0:Xd.length,metadata:Gb.L4h(null===(ue=this.IYa)||void 0===ue?void 0:ue.nameManagerItems)});aa.VE(aa.Ona("success"),tf)}else{null===(Ie=this.vKa)||void 0===Ie?
void 0:Ie.stop();qf=Gb.lPd(null===nb||void 0===nb?void 0:nb.Errors);this.IYa=null;const We=oc.create({operationType:"get",status:"successWithServerException",executionTime:null===(Je=this.vKa)||void 0===Je?void 0:Je.Ci,serverMessageId:qf.toString()});aa.VE(aa.Ona("successWithServerException"),We)}}catch(We){this.IYa=null,null===(He=this.vKa)||void 0===He?void 0:He.stop(),nb=oc.create({operationType:"get",status:"failure",executionTime:null===(hf=this.vKa)||void 0===hf?void 0:hf.Ci,error:"JsonParsingError"}),
aa.VE(aa.Ona("failure"),nb)}this.raiseEvent("dnek",new Bb(rf,"get",qf,ic))}xvc(nb){this.ejb=this.$.Eh.Oi("WebServiceCall",Pa.Cei);const ic=Qc=>{this.u3i(Qc,nb)},Bc=Qc=>{var pd,Xd;null===(pd=this.ejb)||void 0===pd?void 0:pd.stop();Qc=Gc.a.$j(Qc.data);Qc=La.a.fi(Qc);pd=oc.create({operationType:"delete",status:"failure",executionTime:null===(Xd=this.ejb)||void 0===Xd?void 0:Xd.Ci,error:Qc});aa.VE(aa.Ona("failure"),pd);this.raiseEvent("dndok",new Bb(!1,"delete",null))};ia.a(this.$.userOperationManager,
(Qc,pd,Xd)=>{var ue=this.$.oa.ta;Qc=ta.c(Qc,ic);pd=ta.b(pd,Bc);var Ie=this.$;const Je=ue.Za(9,null);Je.definedNameIds=nb;return ba.h(ue,"DeleteDefinedNames",Je,Qc,pd,Xd,Ie,0)},Qc=>new Ma.a(1036,0,Qc),null)}u3i(nb,ic){var Bc,Qc,pd;let Xd=!1,ue;if(nb&&!Ib.a(nb)&&ic){Xd=!0;null===(Bc=this.ejb)||void 0===Bc?void 0:Bc.stop();var Ie=oc.create({operationType:"delete",status:"success",executionTime:null===(Qc=this.ejb)||void 0===Qc?void 0:Qc.Ci,countOfNamesDeleted:ic.length});aa.VE(aa.Ona("success"),Ie)}else ue=
Gb.lPd(null===nb||void 0===nb?void 0:nb.Errors),null===(pd=this.ejb)||void 0===pd?void 0:pd.stop(),Gb.l_c(ue)&&xc.a(this.$).yj.kK(ue),Qc=oc.create({operationType:"delete",status:"successWithServerException",executionTime:null===(Ie=this.ejb)||void 0===Ie?void 0:Ie.Ci,serverMessageId:ue.toString(),countOfNamesDeleted:ic.length}),aa.VE(aa.Ona("successWithServerException"),Qc);this.raiseEvent("dndok",new Bb(Xd,"delete",ue))}S6i(nb,ic,Bc){var Qc,pd,Xd;let ue=!1,Ie;if(nb&&!Ib.a(nb)){ue=!0;null===(Qc=this.yAb)||
void 0===Qc?void 0:Qc.stop();var Je=oc.create({operationType:-1!==ic?"update":"add",status:"success",executionTime:null===(pd=this.yAb)||void 0===pd?void 0:pd.Ci,type:Bc});aa.VE(aa.Ona("success"),Je)}else null===(Xd=this.yAb)||void 0===Xd?void 0:Xd.stop(),Ie=Gb.lPd(null===nb||void 0===nb?void 0:nb.Errors),Gb.l_c(Ie)&&xc.a(this.$).yj.kK(Ie),Bc=oc.create({operationType:-1!==ic?"update":"add",status:"successWithServerException",type:Bc,executionTime:null===(Je=this.yAb)||void 0===Je?void 0:Je.Ci,serverMessageId:Ie.toString()}),
aa.VE(aa.Ona("successWithServerException"),Bc);this.raiseEvent("dnuek",new Bb(ue,-1!==ic?"update":"add",Ie))}};Ub=Object(J.__decorate)([Object(Sa.d)(jb.Ab),Object(J.__param)(0,Object(jb.Ob)()),Object(J.__param)(1,Object(jb.G)())],Ub);Object(H.a)(Ub,"DefinedNameManager",null,[539]);var Ra=a(6),Rb=a(138),ib=a(52),la=a(13),db=a(242);class $b{}$b.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(H.a)($b,"FileUploadDialogHTML",null,[]);var Ic=a(171),Tc=a(26),Zc=a(24);class cc extends db.a{constructor(nb){super(!1,!1,cc.q3);this.s5d=!1;this.bcg=!0;this.hbg=0;this.Xxj=(ic,Bc)=>{const Qc=Bc[cc.bvd]||"";let pd=!0;void 0!==Bc[cc.Eqc]&&null!==Bc[cc.Eqc]&&(pd=Bc[cc.Eqc]);this.CD(ic,Qc,pd)};this.che=(ic,Bc)=>{this.CD(ic,Bc.text||"",Bc.reportErrorChecked)};this.CZj=ic=>{Ra.AFrameworkApplication.xh.Uj(Tc.a.D4b,2,ic)};this.Oh=1;this.si(1,Object(Zc.a)("Send"));this.si(0,Object(Zc.a)("NoThanks"));
this.rp=$b.HTML;this.Zag=nb;this.fl=cc.rSh}lp(nb,ic,Bc,Qc,pd){pd=void 0===pd?!0:pd;this.s5d=void 0===Qc?!1:Qc;this.SQk(ic);this.hbg=nb;pd&&Ra.AFrameworkApplication.cE(nb)}SQk(nb){if(cc.q3)this.QSk(nb);else{var ic={};ic[cc.nSh]=nb;ic[cc.tSh]=Object(Zc.a)("SendFileErrorReportMessage");ic[cc.uSh]=Object(Zc.a)("SendFileErrorReportTextCaption");ic[cc.bvd]="";ic[cc.qSh]=Object(Zc.a)("UserReportLinkText");ic[cc.Eqc]=!0;this.initializeAndShow(Object(Zc.a)("DefaultDialogTitle"),this.Xxj,ic);this.kja(cc.ASh)}}QSk(nb){nb=
{["id"]:this.fl,["bodyControls"]:{["reportErrorCheckboxProps"]:this.s5d?{["label"]:Object(Zc.a)("UserReportLinkText")}:null,["textAreaProps"]:this.bcg?{}:null,["privacyStatementLinkProps"]:{["text"]:Object(Zc.a)("PrivacyStatement"),["handler"]:{["href"]:Ra.AFrameworkApplication.privacyUrl,["target"]:"_blank"}}},["errorMessage"]:nb,["errorReportMessage"]:Object(Zc.a)("SendFileErrorReportMessage"),["errorTextPrompt"]:Object(Zc.a)("SendFileErrorReportTextCaption")};this.initializeAndShow(Object(Zc.a)("DefaultDialogTitle"),
this.che,nb)}cQc(){if(!cc.q3){var nb=document.getElementById(cc.wSh);nb&&(nb.className=cc.vSh,nb.appendChild(Ic.a(32,32,cc.sSh,null,!0,Object(Zc.a)("DialogError"))));if(nb=document.getElementById(cc.ySh))nb.innerText=Object(Zc.a)("PrivacyStatement"),nb.href=Ra.AFrameworkApplication.privacyUrl,ib.a.addHandler(nb,"click",this.CZj);this.bcg||(nb=document.getElementById(cc.bvd))&&nb.parentNode&&nb.parentNode.removeChild(nb);this.s5d||(nb=document.getElementById(cc.pSh))&&nb.parentNode&&nb.parentNode.removeChild(nb)}}zT(){cc.q3||
(super.zT(),document.getElementById(this.hp("WACDialogPanel")).style.width=String.format("{0}px",400))}CD(nb,ic,Bc){this.Zag&&(Bc&&N.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.hbg),this.Zag(nb,ic,Bc))}get ufa(){return!1}static get q3(){return Ra.AFrameworkApplication.ra.$g.lN&&Ra.AFrameworkApplication.ra.$g.$qj}}cc.nSh="WACDialogErrorMessage";cc.tSh="WACDialogErrorReportMessage";cc.uSh="WACDialogErrorTextPrompt";cc.bvd="WACDialogInput";cc.ySh="WACDialogPrivacyText";
cc.wSh="WACDialogIconPanel";cc.sSh="CancelRequest_32x32x32";cc.vSh="WACDialogIcon";cc.ASh="WACDialogTextPanel";cc.Eqc="WACDialogSendFileCheckbox";cc.pSh="WACDialogSendFileCheckboxContainer";cc.qSh="WACDialogSendFileCheckboxText";cc.rSh="FileUploadErrorDialog";Object(H.a)(cc,"FileUploadErrorDialog",db.a,[]);var Yc;let Vc=Yc=class extends Ea.a{constructor(nb){super();this.$=nb;this.uyg=0;this.PM=null;this.nmk=ic=>{this.Wnk(ic)};this.l_h=(ic,Bc)=>{if(1===ic&&this.PM.FileCollectionErrorStateId){ic=this.$.oa.ta;
var Qc=this.PM.MessageId,pd=this.PM.OriginalEcsServerId,Xd=this.PM.FileCollectionErrorStateId;const ue=ic.Za(0);ue.errorMessageId=Qc;ue.ecsServerId=pd;ue.fileCollectionErrorStateId=Xd;ue.userComment=Bc;ic.rvd("CollectFile",ue,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)}}OCh(nb){this.addHandler("fileCollectionComplete",nb)}Wnk(nb){this.removeHandler("fileCollectionComplete",nb)}k_h(nb,ic,Bc){this.uyg=ic;this.PM=nb;this.OCh(Bc);Ra.AFrameworkApplication.privacyUrl=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;
nb=new cc(this.l_h);Ra.AFrameworkApplication.xh.Uh(Tc.a.D4b,Rb.a.frame,Yc.zbk);nb.lp(0,"",null,!1,!1)}static zbk(nb,ic,Bc,Qc,pd){ib.a.lB(pd);Ra.AFrameworkApplication.privacyUrl&&la.HelperMethods.Em(Ra.AFrameworkApplication.privacyUrl,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}};Vc=Yc=Object(J.__decorate)([Object(Sa.d)(jb.hc),Object(J.__param)(0,Object(jb.Ob)()),Object(J.__param)(1,Object(jb.eb)())],Vc);Object(H.a)(Vc,"FileCollectionOperation",Ea.a,[541,2]);var wd=a(72);let wc=class extends ka.a{constructor(nb,
ic,Bc,Qc){super();this.sl=null;this.rj=()=>{this.button.getButton(this.sl.Am.paneType).gub();Oa.a.sendTelemetryEvent({name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:rb.a.xn({["buttonType"]:"FloatingObjectToCellImage"})});const pd=new ub.a(-700002548,E.a.ph,this.$.ji,9,null);this.$.Ia.qh(pd,null)};this.YE=()=>{this.hda()};this.Gkg=()=>{this.fzb()};this.VQc=()=>{this.fzb()};this.$Qc=()=>{this.fzb()};this.Gng=()=>{this.fzb()};this.i2b=()=>{this.fzb()};this.Ing=()=>{this.fzb()};this.nq=
()=>{this.hda()};this.Vy=()=>{this.hda()};this.Yu=()=>{this.hda()};this.IA=()=>{this.hda()};this.$=nb;this.isVisible=!1;this.button=Bc.wNb(nb,ic,this.rj,null,null,Aa.a.instance.ia(2319),"FloatingObjectToCellImagePointerDown");this.da=Ka.f(this.$);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")&&this.da.gA(this.YE);this.$.LI(this.nq);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.fa.lK(this.IA);this.da.view.uz(this.Vy);
this.da.ha.$a.AO(this.Yu);this.ariaLiveNotifier=Qc}dispose(){this.da&&(this.da.view.gy(this.Vy),this.da.ha.$a.dW(this.Yu));this.$&&(this.$.mL(this.nq),fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.fa.gI(this.IA));this.button.dispose();this.$=this.da=this.button=null;super.dispose()}Hnd(){this.isVisible&&this.rj(null,null)}hda(){if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&!this.$.isEditMode)this.xY();else{var nb=
this.da.ha.$a;if(nb.isFloatingObjectSelected&&1===nb.Ih.floatingObject.type){if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){const ic=new Ja.a(this.$.sa);if(ic&&ic.Bn){this.xY();return}}null!==this.sl&&this.gFg(this.sl);this.sl=nb.Ih;this.hra()}else this.xY()}}hra(){const nb=this.sl.Am.Zr,ic=this.sl.floatingObject;this.fzh(this.sl);let Bc=ic.Z_+this.zqc,Qc=ic.eB,pd=0;var Xd=0;switch(this.sl.Am.paneType){case 3:pd=this.da.fh.cA;Xd=this.da.fh.eB-this.da.Mw.y;
break;case 4:pd=this.da.fh.cA-this.da.Mw.x;Xd=this.da.fh.eB;break;case 1:pd=this.da.fh.cA;Xd=this.da.fh.eB;break;case 2:pd=this.da.fh.cA-this.da.Mw.x,Xd=this.da.fh.eB-this.da.Mw.y}Bc-=pd;Qc-=Xd;Xd=new wd.a(ic.cA-pd,Qc,ic.width,ic.height);Bc+this.button.buttonWidth>nb.bottomRight.x&&(Bc=ic.cA-pd-this.zqc-this.button.buttonWidth);Qc<nb.topLeft.y+this.zqc&&(Qc=nb.topLeft.y+this.zqc);4===this.da.ha.Hk&&nb.$i(Xd)&&nb.width>ic.width?this.hv(Bc,Qc,this.da.rtl,this.sl.Am.paneType,!0):this.xY()}hv(nb,ic,Bc,
Qc,pd){fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")||this.da.gA(this.YE);this.button.v4c(ea.a.T7j,Aa.a.instance.ia(2319),Qc);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8352230_UpdateDivTitleForSVGLaunchButtonOOUI")&&this.button.X3c(Aa.a.instance.ia(2319),Qc);this.button.hv(nb,ic,Bc,Qc,!1,pd);this.isVisible=!0;this.AIh()}xY(){this.da.dF(this.YE);null!==this.sl&&(this.gFg(this.sl),this.sl=null);this.button.hide();this.isVisible=!1}fzb(){this.button.hide();
this.isVisible=!1}AIh(){let nb;nb=za.a.isMac?Aa.a.instance.ia(2323):Aa.a.instance.ia(2322);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.Fca(nb)}get zqc(){return this.button.DLb}fzh(nb){var ic,Bc,Qc,pd,Xd,ue;if(nb=nb.extension)null===(ic=nb.laa)||void 0===ic?void 0:ic.v5e(this.Gkg),null===(Bc=nb.iwb)||void 0===Bc?void 0:Bc.zqd(this.VQc),null===(Qc=nb.XKg)||void 0===Qc?void 0:Qc.AFh(this.$Qc),null===(pd=nb.MP)||void 0===pd?void 0:pd.cqd(this.i2b),null===(Xd=nb.MP)||void 0===Xd?void 0:
Xd.dEh(this.Gng),null===(ue=nb.MP)||void 0===ue?void 0:ue.gEh(this.Ing)}gFg(nb){var ic,Bc,Qc,pd,Xd,ue;if(nb=nb.extension)null===(ic=nb.laa)||void 0===ic?void 0:ic.pGg(this.Gkg),null===(Bc=nb.iwb)||void 0===Bc?void 0:Bc.TGg(this.VQc),null===(Qc=nb.XKg)||void 0===Qc?void 0:Qc.nqk(this.$Qc),null===(pd=nb.MP)||void 0===pd?void 0:pd.dke(this.i2b),null===(Xd=nb.MP)||void 0===Xd?void 0:Xd.dpk(this.Gng),null===(ue=nb.MP)||void 0===ue?void 0:ue.gpk(this.Ing)}};wc=Object(J.__decorate)([Object(Sa.d)(jb.vc),
Object(J.__param)(0,Object(jb.Ob)()),Object(J.__param)(1,Object(ya.h)()),Object(J.__param)(2,Object(jb.Tf)()),Object(J.__param)(3,Object(jb.l)())],wc);Object(H.a)(wc,"FloatingObjectToCellImageController",ka.a,[]);var Ya=a(496),ob=a(436),Cb=a(34),Wb=a(638),ad=a(601),$c=a(1316);a(229);var Ld=a(25);Object(Sa.b)(jb.xc,{rk:"singleton"})(nb=>xo(function*(){const ic=yield Sa.a.resolve(jb.Ob,nb),Bc=!fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8838479_RemoveOldFSImplementation")&&Ld.a.Xk()?yield Sa.a.resolve(jb.yc,
nb):null;return new jd(ic,Bc)}));class jd{constructor(nb,ic){this.$=nb;this.sA=ic;this.menuId=this.Tud=this.oda=this.Wwa=null;this.jJd=0;this.$Hj="+mn-lt";this.NEj="+mj-lt";this.QQc=Bc=>{this.iYb=!0;this.$.q6(Qc=>{Qc.lub("FontName_New")});N.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Bc}`)};this.Kij=!!String.fromCodePoint&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.iYb=!1;this.da=Ka.f(this.$);this.Xk=!fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8838479_RemoveOldFSImplementation")&&
Ld.a.Xk();this.M1f=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1);this.Xk&&this.sA&&(this.sA.smj?this.OPg():this.sA.NBc(()=>{this.OPg()}))}get Tw(){this.YG||(this.YG=Sa.a.lh(jb.Fg));return this.YG}OPg(){this.oda=this.sA.J_g;this.Wwa=this.sA.dAi;this.jJd=2;this.iYb=this.sA.iYb}get J_g(){return this.oda}XDf(nb,ic,Bc,Qc){Qc=void 0===Qc?null:Qc;const pd=Object.assign(new Ya.a,{Id:"FontDropdownMenu"});pd.MenuSectionList=[];this.Tw&&(this.Tw.lJa(Qc),Qc=Object.assign(new ob.a,
{ControlsId:"ThemeFontsMenuSectionControl",Title:Aa.a.instance.ia(1337),ControlList:this.WZi(nb,ic,Bc)}),pd.MenuSectionList.push(Qc));Qc=Object.assign(new ob.a,{ControlsId:"FontsMenuSectionControl"});Qc.Title=Aa.a.instance.ia(1338);Qc.ControlList=this.uNi(nb,ic,Bc);pd.MenuSectionList.push(Qc);return pd}WZi(nb,ic,Bc){var Qc;const pd=[];var Xd=this.da.ha.$a.Ih;Xd=5===(null===(Qc=null===Xd||void 0===Xd?void 0:Xd.floatingObject)||void 0===Qc?void 0:Qc.type);let ue,Ie;this.Tw.gz?(ue=this.Tw.gz.d7d,Ie=
this.Tw.gz.O5d):N.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(Qc=this.Lnf(Ie,1,Xd,nb,ic,Bc))&&pd.push(Qc);(nb=this.Lnf(ue,2,Xd,nb,ic,Bc))&&pd.push(nb);return pd}Lnf(nb,ic,Bc,Qc,pd,Xd){var ue=2===ic?this.$Hj:this.NEj;let Ie;nb?(Bc=Bc?ue:Cb.a.qm(nb),ue=Cb.a.qm(la.HelperMethods.DTb(nb,ic)),Ie=Cb.a.qm(nb)):(Bc=Bc?ue:void 0,ue=Cb.a.qm(String.fromCodePoint(0)),Ie="msofp");return Object.assign(new Wb.a,{MenuItemId:2===ic?$c.b:$c.a,CommandValueId:Bc,LabelText:ue,LabelCss:String.format("font-size:12pt;font-family:{0};",
Ie),Styles:jd.hTb(Ie),AriaLabel:ue,Alt:ue,Command:Qc.toString(),CommandPreviewId:pd.toString(),CommandRevertId:Xd.toString(),Disabled:!nb})}uNi(nb,ic,Bc){if(this.Tud)return this.Tud.ZBd;let Qc;const pd=la.HelperMethods.vN(()=>{const Xd=this.Kij&&!this.iYb;let ue=!1;this.Wwa||(this.pWf(),ue=!0,N.ULS.sendTraceTag(509654348,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: fontCodepointMap is Null. Initialize with old Font Dictionary."));Qc=this.emf(nb,ic,Bc,this.Wwa,Xd,ue);Qc.k_c&&!ue&&(N.ULS.sendTraceTag(520710162,
1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.pWf(),Qc=this.emf(nb,ic,Bc,this.Wwa,Xd,Qc.k_c));this.Xk&&!Qc.k_c&&(this.Tud=Qc);Xd&&!this.Xk&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.QQc)});10<pd&&N.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${pd}`);return Qc.ZBd}emf(nb,ic,Bc,Qc,pd,Xd){const ue=[];let Ie;const Je=this.Xk&&!Xd;Ie=
Je?"msofpNew":this.M1f?"msofp_v4_29":"msofp";for(const We in Qc){var He=We,hf=Qc[We],rf=Cb.a.qm(He),qf=void 0;if(Je)if(qf=this.oda?this.oda[He]:null)qf=Cb.a.qm(qf);else return N.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${He}`),{k_c:!0,ZBd:[]};else qf=Cb.a.qm(la.HelperMethods.oda[He]);He=Cb.a.qm(He);pd||(hf=0);rf=Object.assign(new Wb.a,{MenuItemId:rf,CommandValueId:rf,LabelText:pd&&0<hf?Cb.a.qm(String.fromCodePoint(hf)):
qf,LabelCss:String.format("font-size:12pt;font-family:{0};",pd&&0<hf?Ie:He),Styles:jd.hTb(pd&&0<hf?Ie:He),AriaLabel:qf,Alt:qf,Command:nb.toString(),CommandPreviewId:ic.toString(),CommandRevertId:Bc.toString()});ue.push(rf)}return{k_c:Xd,ZBd:ue}}gHk(nb){this.menuId=nb}umj(){return 2!==this.jJd&&3!==this.jJd?!1:!0}pWf(){this.M1f?(this.Wwa={["Angsana New"]:983051,["Aptos Display"]:983056,["Aptos Narrow"]:983060,["Arial Black"]:983065,["Arial"]:983064,["Batang"]:983087,["Book Antiqua"]:983104,["Browallia New"]:983109,
["Calibri"]:983112,["Cambria"]:983116,["Candara"]:983118,["Century"]:983121,["Comic Sans MS"]:983128,["Consolas"]:983134,["Constantia"]:983135,["Corbel"]:983139,["Cordia New"]:983140,["Courier New"]:983142,["DilleniaUPC"]:983153,["Dotum"]:983155,["FangSong"]:983175,["Garamond"]:983193,["Georgia"]:983195,["Gulim"]:983222,["GungSuh"]:983226,["KaiTi"]:983263,["JasmineUPC"]:983258,["Malgun Gothic"]:983302,["Mangal"]:983306,["Meiryo"]:983309,["Microsoft JhengHei"]:983317,["Microsoft YaHei"]:983329,["MingLiU"]:983337,
["MingLiU_HKSCS"]:983341,["MS Gothic"]:983290,["MS Mincho"]:983292,["MS PGothic"]:983294,["MS PMincho"]:983296,["PMingliU"]:983372,["PMingLiU-ExtB"]:983374,["SimHei"]:983441,["SimSun"]:983443,["SimSun-ExtB"]:983445,["Source Sans Pro"]:983464,["Tahoma"]:983472,["THSarabunPSK"]:983471,["Times New Roman"]:983484,["Trebuchet MS"]:983495,["Verdana"]:983519,["Yu Gothic"]:983540,["Yu Mincho"]:983550},ad.a.Jy('@font-face{font-family:"msofp_v4_29";font-style:normal;font-weight:normal;src:url("https://fs.microsoft.com/fs/4.35/flat_officeFontsPreview.ttf") format(\'truetype\')}')):
this.Wwa={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,
["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,
["Yu Mincho"]:983474}}static hTb(nb){const ic={};ic["font-family"]=nb;ic["font-size"]="12pt";nb={};nb.optionText=ic;return nb}}Object(H.a)(jd,"FontDropdownHelper",null,[540]);var Td=a(877),re;(function(nb){nb[nb.FormatCellsListView=0]="FormatCellsListView";nb[nb.NumberFormatItemView=1]="NumberFormatItemView";nb[nb.AlignmentItemView=2]="AlignmentItemView";nb[nb.FontItemView=3]="FontItemView";nb[nb.BorderItemView=4]="BorderItemView"})(re||(re={}));var Nd;(function(nb){nb[nb.General=0]="General";nb[nb.Number=
1]="Number";nb[nb.Currency=2]="Currency";nb[nb.Accounting=3]="Accounting";nb[nb.Date=4]="Date";nb[nb.Time=5]="Time";nb[nb.Percentage=6]="Percentage";nb[nb.Fraction=7]="Fraction";nb[nb.Scientific=8]="Scientific";nb[nb.Text=9]="Text";nb[nb.Special=10]="Special";nb[nb.Custom=11]="Custom"})(Nd||(Nd={}));var uc=a(10),pc=a(217),Hd=a(1545);Object(Hd.isChangeGateEnabled)("OfficeVSO:8756610_UserBrowserPerformanceAPI");class wb{constructor(nb,ic,Bc){this.F$=!1;this.J1a=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");
this.UK=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.oWb=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8837194_ScopePollForStateAndUpdateToPane");this.XC=()=>{this.dispose()};this.H7=()=>{this.xo()};this.onActiveCellChanged=(Qc,pd)=>{pd&&pd.description===re[re.AlignmentItemView]&&this.vQa()};this.Yu=(Qc,pd)=>{pd&&pd.zJd===re.AlignmentItemView&&(this.UK?0!==(pd.Hk&470)?this.Po.Q8(re.AlignmentItemView,null):this.vQa():this.Po.Q8(re.AlignmentItemView,
null,!0))};this.JB=(Qc,pd)=>{pd&&pd.description===re[re.AlignmentItemView]&&this.vQa()};this.rPc=(Qc,pd)=>{pd&&pd.description===re[re.AlignmentItemView]&&(this.oWb?this.Po.Cwg():this.reactRibbonRoot.Ln(),this.vQa())};this.$=nb;this.properties=ic;this.Nh=Bc;this.Po=Ta.RBc(this.$,this.properties,this.Nh);this.alignmentModel={horizontalAlignmentType:0,verticalAlignmentType:0,readingOrderType:0,isJustifyDistributed:!1,indent:0,orientation:0,isWrapText:!1,isShrinkToFit:!1,isMergeCells:!1,isMergeCellsDisabled:!1,
isFlipVertical:!1,disableAllControls:!1};this.MCf={};this.J1a&&!this.oWb&&(this.reactRibbonRoot=nb.qa.zh(337,!0))}static getInstance(nb,ic,Bc){return this.Va||(this.Va=new this(nb,ic,Bc))}vQa(){var nb;const ic=Ka.f(this.$),Bc=null===(nb=ic.yh(ic.ha.pa.activeCell))||void 0===nb?void 0:nb.cell;Bc&&(c("AlignmentTab::Update::Start"),this.alignmentModel.horizontalAlignmentType=Bc.$H,this.alignmentModel.verticalAlignmentType=Bc.verticalAlignment,this.alignmentModel.isJustifyDistributed=8===Bc.$H?!0:!1,
this.alignmentModel.indent=Bc.indentation||0,this.alignmentModel.isWrapText=Bc.sF,this.alignmentModel.isShrinkToFit=Bc.f$b,this.alignmentModel.isMergeCells=Bc.fG,this.alignmentModel.isMergeCellsDisabled=pc.c(ic),this.alignmentModel.readingOrderType=Bc.lUc,this.J1a&&(this.alignmentModel.disableAllControls=ic.Dh.isEditing),fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8475627_FixVerticalTextOrientation")?(this.alignmentModel.orientation=Bc.SKc?0:Bc.lF||0,this.alignmentModel.isFlipVertical=Bc.SKc):(this.alignmentModel.orientation=
Bc.lF||0,this.alignmentModel.isFlipVertical=this.alignmentModel.orientation===uc.a.verticalText?!0:!1),this.q$k(this.alignmentModel))}q$k(nb){this.MCf.alignmentModel=nb;this.Po.Q8(re.AlignmentItemView,this.MCf);this.F$||this.Kp()}qh(nb,ic){c("AlignmentTab::CmdUpdate::Start");ic=Object.assign({},ic);ic[Td.a.sja]=!1;this.$.oi(nb,E.a.ph,12,ic);N.ULS.sendTraceTag(508389411,0,50,`Ribbon command called from Alignment Task Pane: ${nb}`)}fBe(nb){switch(nb){case 0:this.fBe(this.alignmentModel.horizontalAlignmentType);
break;case 1:this.qh(-1150205178,null);break;case 2:this.qh(-1142465846,null);break;case 3:this.qh(-286432209,null);break;case 6:this.qh(2007171328,null)}}YJa(){return{onHorizontalAlignmentChange:nb=>{this.alignmentModel.horizontalAlignmentType!==nb&&this.fBe(nb)},onVerticalAlignmentChange:nb=>{switch(nb){case 0:this.qh(-394785302,null);break;case 1:this.qh(1041132226,null);break;case 2:this.qh(-571165336,null)}},justifyDistributed:nb=>{nb&&this.fBe(8)},onTextDirectionChange:()=>{},onIndentationChange:nb=>
{const ic=this.alignmentModel.indent;this.qh(nb>ic?-1942512156:-1920201820,{Indentation:nb-ic});this.vQa()},onOrientationChange:nb=>{this.qh(-1220714308,{Orientation:nb});this.vQa()},wrapText:()=>{this.qh(-1116189897,null)},mergeCells:nb=>{this.qh(nb?1097660126:155820588,null)},flipVertical:()=>{this.qh(-1526602249,null)}}}dispose(){this.xo();this.Po.Sje(this.XC);wb.Va=null}Kp(){this.Po.Spd(this.H7);this.Po.Rpd(this.XC);this.Po.add_activeCellChanged(this.onActiveCellChanged);this.Po.AO(this.Yu);this.Po.X5e(this.JB);
this.J1a&&(this.Po.CCh(this.rPc),this.Po.BCh(this.rPc));this.F$=!0;N.ULS.sendTraceTag(508355650,0,50,"AlignmentViewModel events registered")}xo(){this.Po.Tje(this.H7);this.Po.remove_activeCellChanged(this.onActiveCellChanged);this.Po.dW(this.Yu);this.Po.MGg(this.JB);this.J1a&&(this.Po.Mnk(this.rPc),this.Po.Lnk(this.rPc));this.F$=!1;N.ULS.sendTraceTag(508355649,0,50,"AlignmentViewModel events Unregistered")}}Object(H.a)(wb,"AlignmentTaskPaneManager",null,[2]);var Xb=a(184),Kb=a(1459);class Zb{constructor(nb,
ic){this.UK=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.$=ic;this.Po=nb}showTaskPane(nb,ic,Bc){Ld.a.xp()?void Sa.a.resolve(jb.lf,{va:0}).then(Qc=>Qc.ZH("FormatCellsTaskPane",this.qr(nb,ic,Bc))):void Xb.a.fo().then(Qc=>{Qc.showTaskPane("FormatCellsTaskPane",this.qr(nb,ic,Bc));return null})}updateTaskPane(nb,ic,Bc){Ld.a.xp()?void Sa.a.resolve(jb.lf,{va:0}).then(Qc=>Qc.updateTaskPane("FormatCellsTaskPane",this.qr(nb,ic,Bc))):void Xb.a.fo().then(Qc=>
{Qc.updateTaskPane("FormatCellsTaskPane",this.qr(nb,ic,Bc));return null})}hideTaskPane(){Ld.a.xp()?void Sa.a.resolve(jb.lf,{va:0}).then(nb=>nb.hideTaskPane("FormatCellsTaskPane")):void Xb.a.fo().then(nb=>{nb.hideTaskPane("FormatCellsTaskPane",2);return null})}close(){throw Error("Method not implemented.");}qr(nb,ic,Bc){nb={type:"FormatCellsTaskPaneProps",activePage:nb,callbacks:this.Po.YJa(),viewModelData:ic,isFloatingObjectSelected:Bc};return Object.assign(new Kb.a,{contentProps:nb,actionButtonProps:nb.activePage!==
re.FormatCellsListView&&(this.UK||!Bc)&&{label:Aa.a.instance.ia(2351),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateTaskPane(re.FormatCellsListView,null,this.UK?void 0:Bc);this.Po.activePage=re.FormatCellsListView}},title:nb.activePage===re.FormatCellsListView?Aa.a.instance.ia(2304):Aa.a.instance.ia(2305),onShow:()=>{this.Po.hZj()},onHide:()=>{this.Po.H7()},onClose:()=>{this.Po.XC()},width:320})}}Object(H.a)(Zb,"FormatCellsTaskPane",null,[586]);var Oc=a(1319);class Cd extends Sys.EventArgs{constructor(nb,
ic,Bc,Qc){super();this.uo=nb;this.cellFormat=ic;this.zJd=Bc;this.Hk=Qc}}Object(H.a)(Cd,"FormatCellsTaskPaneEventArgs",Sys.EventArgs,[]);class Wd extends Ea.a{constructor(nb,ic,Bc){super();this.uY=!1;this.J1a=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");this.UK=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.activePage=re.FormatCellsListView;this.isFloatingObjectSelected=this.Xpb=!1;this.xSi=()=>this.activePage===re.NumberFormatItemView?
Ta.gOd(this.$,this.properties,this.Nh).YJa():null;this.pFi=()=>this.activePage===re.AlignmentItemView?Ta.TKd(this.$,this.properties,this.Nh).YJa():null;this.Yig=()=>{this.raiseEvent("CellEditingStarted",new Oc.a(re[this.activePage],null))};this.Xig=()=>{this.raiseEvent("CellEditingEnded",new Oc.a(re[this.activePage],null))};this.onActiveCellChanged=()=>{this.raiseEvent("ActiveCellChanged",new Oc.a(re[this.activePage],null));this.activePage===re.FormatCellsListView&&this.isFloatingObjectSelected&&
this.Q8(re.FormatCellsListView,null,this.UK?void 0:!1);this.UK||(this.isFloatingObjectSelected=!1)};this.Yu=(Qc,pd)=>{this.isFloatingObjectSelected=this.UK?pd&&0!==(pd.Hk&470):!0;this.activePage===re.FormatCellsListView?this.Q8(re.FormatCellsListView,null,this.UK?void 0:!0):this.raiseEvent("FloatingObjectSelectionChanged",new Cd(1461300262,null,this.activePage,pd.Hk))};this.WZb=()=>{this.$.fa.yk!==uc.a.Ek&&this.$.fa.ki&&(this.uY=!0)};this.JB=()=>{this.$.fa.yk!==uc.a.Ek&&this.uY&&(this.uY=!1,(new Ja.a(this.$.sa)).Sj(4)?
this.raiseEvent("OnGridConsistent",new Oc.a(re[this.activePage],null)):this.blb.hideTaskPane())};this.Xi=(Qc,pd)=>{!pd.$l&&this.Xpb&&this.blb.hideTaskPane()};this.$=nb;this.properties=ic;this.Nh=Bc;this.blb=new Zb(this,nb);this.da=Ka.f(this.$);this.w0d=fa.EwaSettings.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8836792_AsyncTaskPaneUITiming");this.UK&&(this.isFloatingObjectSelected=this.da.ha.$a.isFloatingObjectSelected)}static getInstance(nb,ic,Bc){return this.Va||(this.Va=
new this(nb,ic,Bc))}Q8(nb,ic,Bc){Bc=void 0===Bc?this.UK?this.QOk(nb)?this.isFloatingObjectSelected:!1:!1:Bc;this.Xpb?this.blb.updateTaskPane(nb,ic,Bc):(this.w0d&&void this.p3k(),this.blb.showTaskPane(nb,ic,Bc),this.Xpb=!0,this.Tz());this.activePage=nb}Spd(nb){this.addHandler("FCPaneCollapsed",nb)}Tje(nb){this.removeHandler("FCPaneCollapsed",nb)}Rpd(nb){this.addHandler("FCPaneClosed",nb)}Sje(nb){this.removeHandler("FCPaneClosed",nb)}add_activeCellChanged(nb){this.addHandler("ActiveCellChanged",nb)}remove_activeCellChanged(nb){this.removeHandler("ActiveCellChanged",
nb)}AO(nb){this.addHandler("FloatingObjectSelectionChanged",nb)}dW(nb){this.removeHandler("FloatingObjectSelectionChanged",nb)}X5e(nb){this.addHandler("OnGridConsistent",nb)}MGg(nb){this.removeHandler("OnGridConsistent",nb)}CCh(nb){this.addHandler("CellEditingStarted",nb)}Mnk(nb){this.removeHandler("CellEditingStarted",nb)}BCh(nb){this.addHandler("CellEditingEnded",nb)}Lnk(nb){this.removeHandler("CellEditingEnded",nb)}H7(){this.raiseEvent("FCPaneCollapsed");this.v3c();this.Xpb=!1;N.ULS.sendTraceTag(508385100,
0,50,"TaskPane Collapsed")}XC(){this.raiseEvent("FCPaneClosed");this.v3c();window.setTimeout(()=>{this.dispose()},0);N.ULS.sendTraceTag(508385099,0,50,"TaskPane Closed")}hZj(){this.UK&&(this.isFloatingObjectSelected=this.da.ha.$a.isFloatingObjectSelected);if(!this.Xpb)if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8593272_FormatCellSheetProtectionFix")&&!(new Ja.a(this.$.sa)).Sj(4))this.blb.hideTaskPane();else switch(this.activePage){case re.NumberFormatItemView:Ta.gOd(this.$,this.properties,this.Nh).xWg(this.properties);
N.ULS.sendTraceTag(508389441,0,50,"NumberFormatTaskPane Opened");break;case re.AlignmentItemView:Ta.TKd(this.$,this.properties,this.Nh).vQa();N.ULS.sendTraceTag(508389440,0,50,"Alignment TaskPane Opened");break;case re.FontItemView:Ta.oDc(this.$,this.properties,this.Nh).$9b(re.FontItemView);N.ULS.sendTraceTag(508078217,0,50,"Font tab opened");break;case re.BorderItemView:Ta.oDc(this.$,this.properties,this.Nh).$9b(re.BorderItemView),N.ULS.sendTraceTag(507896131,0,50,"Border tab opened")}}dispose(){this.blb=
this.$=null;this.Xpb=!1;this.properties=null;Wd.Va=null}p3k(){const nb=this;return xo(function*(){var ic;if(null!==(ic=nb.properties)&&void 0!==ic&&ic.event){ic=nb.properties.event.rawEvent||nb.properties.event;var Bc=ic.type.includes("key")?"keyboard":"mouse";(yield Sa.a.resolve(jb.Gd)).iz(ic,`task_pane_open_format_cell_${Bc}`,null,["task-pane"])}})}Tz(){this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.ha.$a.AO(this.Yu);this.$.fa&&(this.$.fa.mK(this.WZb),this.$.fa.zGa(this.JB));
this.$.Pp(this.Xi);this.J1a&&(this.da.Dh.fM(this.Xig),this.da.Dh.zX(this.Yig))}v3c(){this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);this.da.ha.$a.dW(this.Yu);this.$.fa&&(this.$.fa.nL(this.WZb),this.$.fa.hBa(this.JB));this.$.wu(this.Xi);this.J1a&&(this.da.Dh.HN(this.Xig),this.da.Dh.J2(this.Yig))}YJa(){return{onItemClick:nb=>{if(this.UK||!this.isFloatingObjectSelected){this.activePage===re.FormatCellsListView&&N.ULS.sendTraceTag(507597594,0,50,`User switched from Format Cells List View to ${re[nb]}`);
var ic={};ic[Td.a.sja]=!1;switch(nb){case re.NumberFormatItemView:this.$.oi(-395879625,E.a.ph,12,ic);break;case re.AlignmentItemView:this.$.oi(-2019948858,E.a.ph,12,ic);break;case re.FontItemView:this.$.oi(456320978,E.a.ph,12,ic);break;case re.BorderItemView:this.$.oi(119664190,E.a.ph,12,ic)}}},numberFormatCallbacks:this.xSi(),alignmentCallbacks:this.pFi()}}QOk(nb){switch(nb){case re.AlignmentItemView:case re.NumberFormatItemView:return!0;default:return!1}}Cwg(){const nb=this.$.qa.zh(337,!0);if(nb){var ic=
appChrome.selectors.getActiveControlsMapForATaskPane("FormatCellsTaskPane");nb.A2.MAa(ic,12)}else N.ULS.shipAssertTag(507323542,0,!1,"ReactRibbonRoot not found in service registry")}}Object(H.a)(Wd,"FormatCellsTaskPaneManager",Ea.a,[]);var ee=a(994),he=a(2);class pe{constructor(nb,ic,Bc){this.F$=!1;this.GQ=this.NCf=this.vw=null;this.q1b=-1;this.d_c=!0;this.yQ=!1;this.UK=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.categoryDescriptionStrings=[Aa.a.instance.ia(2306),
Aa.a.instance.ia(2307),Aa.a.instance.ia(2308),Aa.a.instance.ia(2309),Aa.a.instance.ia(2310),Aa.a.instance.ia(2311),Aa.a.instance.ia(2312),Aa.a.instance.ia(2313),Aa.a.instance.ia(2314),Aa.a.instance.ia(2315),Aa.a.instance.ia(2316),Aa.a.instance.ia(2317)];this.logUserAction=Qc=>{this.GQ[Qc]=this.GQ[Qc]?this.GQ[Qc]+1:1;this.GQ.Total+=1};this.XC=()=>{this.dispose()};this.H7=()=>{this.H5g()};this.SNa=()=>{const Qc=this.numberFormatViewModel.XIc(4,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded"),
pd=this.numberFormatViewModel.XIc(3,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded");if(pd||Qc)this.Po.Q8(re.NumberFormatItemView,this.fIf()),pd?(this.d_c?(this.numberFormatViewModel.formatCells(this.numberFormatViewModel.M_a(),this.Nh),this.q1b=-1):this.d_c=!0,N.ULS.sendTraceTag(508355619,0,50,"NumberFormatViewModel Loaded by the TaskPane")):N.ULS.sendTraceTag(508355618,0,50,"NumberFormatViewModel Loaded by the Active Cell")};this.RNa=()=>{N.ULS.sendTraceTag(508889099,0,50,"NumberFormatTaskPaneManager.onNumberFormatViewModelFailedLoad - Webservice call failed")};
this.onActiveCellChanged=(Qc,pd)=>{var Xd;if(pd&&pd.description===re[re.NumberFormatItemView]){this.logUserAction("ActiveCellChange");Qc=null===(Xd=Ka.f(this.$).yh(null))||void 0===Xd?void 0:Xd.cell;if(!this.UK&&this.Po.isFloatingObjectSelected||this.$1f(Qc))this.UK||(this.Po.isFloatingObjectSelected=!1),this.I6(!0,4);!fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&Qc&&(this.iod=Qc)}};this.Yu=(Qc,pd)=>{pd&&pd.zJd===re.NumberFormatItemView&&(this.UK?0!==(pd.Hk&470)?
this.Po.Q8(re.NumberFormatItemView,null):this.I6(!0,4):this.Po.Q8(re.NumberFormatItemView,null,!0))};this.JB=(Qc,pd)=>{var Xd,ue;pd&&pd.description===re[re.NumberFormatItemView]&&(Qc=null===(Xd=Ka.f(this.$).yh(null))||void 0===Xd?void 0:Xd.cell,this.$1f(Qc)&&!this.yQ?(this.d_c=!1,this.I6(!0)):(this.yQ=!1,fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&(this.q1b=null!==(ue=null===Qc||void 0===Qc?void 0:Qc.to)&&void 0!==ue?ue:-1)))};this.$=nb;this.properties=ic;this.Nh=
Bc;this.Po=Ta.RBc(this.$,this.properties,this.Nh);this.GQ={Total:0}}static getInstance(nb,ic,Bc){return this.Va||(this.Va=new this(nb,ic,Bc))}xWg(nb){this.Po.Q8(re.NumberFormatItemView,this.NCf);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8589523_AvoidApplyingFormatOnPaneOpen")&&(this.d_c=!1);this.I6(!0,3,nb)}dispose(){N.ULS.sendTraceTag(507875737,0,20,`Number format usage ${JSON.stringify(this.GQ)}`);this.H5g();this.Po.Sje(this.XC);pe.Va=null}YJa(){return{onCategoryTypeChange:nb=>{this.logUserAction("CategoryTypeChange");
this.vw.NumberFormatCategory=nb;this.yQ=!0;switch(nb){case 0:case 9:this.Rla();break;default:this.I6()}N.ULS.sendTraceTag(508387598,0,50,`Number Format Category Changed ${nb}`)},onThousandSeparatorChanged:nb=>{this.logUserAction("ThousandsSeparatorChange");this.vw.IsComma=nb;this.yQ=!0;this.I6();N.ULS.sendTraceTag(508368995,0,50,`Thousand Separator Changed ${nb}`)},onDecimalPlacesChanged:nb=>{this.logUserAction("DecimalPlacesChange");this.vw.DecimalPlaces=nb;this.yQ=!0;switch(this.vw.NumberFormatCategory){case 3:case 6:case 8:fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8507884_FixIncreaseDecreaseDecimalFlicker")?
this.I6():this.Rla();break;default:this.I6()}N.ULS.sendTraceTag(508368994,0,50,`Decimal Places Changed ${nb}`)},onLocaleChanged:nb=>{this.logUserAction("LocaleChange");this.vw.LocaleType=nb;this.yQ=!0;this.I6();N.ULS.sendTraceTag(508389409,0,50,`Locale Changed ${nb}`)},overrideLocale:()=>{this.logUserAction("overrideLocale");this.yQ=!0;this.$.oi(151715844,E.a.ph,12,{selectedIndex:this.vw.LocaleType});N.ULS.sendTraceTag(508389408,0,50,`Override default Locale button clicked ${this.vw.LocaleType}`)},
onInputCalendarChecked:nb=>{this.logUserAction("InputCalendarChecked");this.yQ=!0;this.vw.IsInputCalendar=nb;this.I6();N.ULS.sendTraceTag(508387596,0,50,"Change in Input Calendar Type")},onGannenChecked:nb=>{this.logUserAction("GannenChecked");this.vw.IsGannen=nb;this.yQ=!0;this.I6();N.ULS.sendTraceTag(508389407,0,50,`Gannen changed ${this.vw.LocaleType} ${nb}`)},onCalendarTypeChanged:nb=>{this.logUserAction("CalendarTypeChange");this.vw.CalendarType=nb;this.yQ=!0;this.I6();N.ULS.sendTraceTag(508389406,
0,50,`Calendar Type changed ${nb}`)},onSymbolChanged:nb=>{this.logUserAction("SymbolChange");this.vw.CurrencyType=nb;this.yQ=!0;3===this.vw.NumberFormatCategory?this.Rla():this.I6();N.ULS.sendTraceTag(508387595,0,50,`Currency Symbol changed ${nb}`)},onNegativeNumberTypeChanged:nb=>{this.logUserAction("NegativeNumberTypeChange");this.yQ=!0;this.vw.NegativeNumberType=nb;this.Rla();N.ULS.sendTraceTag(508387594,0,50,`Negative Number Type changed ${nb}`)},onDateTypeChanged:nb=>{this.logUserAction("DateTypeChange");
this.yQ=!0;this.vw.DateType=nb;this.Rla();N.ULS.sendTraceTag(508387593,0,50,`Date Type Changed ${nb}`)},onTimeTypeChanged:nb=>{this.logUserAction("TimeTypeChange");this.yQ=!0;this.vw.TimeType=nb;this.Rla();N.ULS.sendTraceTag(508387592,0,50,`Time Type changed ${nb}`)},onFractionTypeChanged:nb=>{this.logUserAction("FractionTypeChange");this.yQ=!0;this.vw.FractionType=nb;this.Rla();N.ULS.sendTraceTag(508387591,0,50,`Fraction Type changed ${nb}`)},onSpecialTypeChanged:nb=>{this.logUserAction("SpecialTypeChange");
this.yQ=!0;this.vw.SpecialType=nb;this.Rla();N.ULS.sendTraceTag(508387590,0,50,`Special Type changed ${nb}`)},onCustomTypeChanged:nb=>{this.logUserAction("CustomTypeChange");this.yQ=!0;this.vw.CustomType=nb;this.Rla();N.ULS.sendTraceTag(508387589,0,50,`CustomType changed ${nb}`)},onNegativeCurrencyTypeChanged:nb=>{this.logUserAction("NegativeCurrencyTypeChange");this.yQ=!0;this.vw.NegativeCurrencyType=nb;this.Rla();N.ULS.sendTraceTag(508387588,0,50,`Negative Currency Type changed ${nb}`)}}}I6(nb,
ic,Bc){ic=void 0===ic?3:ic;let Qc=null;if(this.activeCell=this.rAc())c("NumberFormatTab::DelayedUpdate::Start"),Bc&&(Bc.currencyType||E.a.Pi in Bc&&Bc[E.a.Pi])&&(Qc=parseInt(Bc[E.a.Pi].toString(),10)),this.numberFormatViewModel?(this.F$||this.NUc(),Qc||nb?this.I8f(Qc,ic,Bc):(this.vw.Caller=ic,this.numberFormatViewModel.TPb(this.activeCell,this.vw))):this.k9h(Qc)}k9h(nb){void Sa.a.resolve(jb.ke,{va:0}).then(ic=>{this.numberFormatViewModel=ic;this.F$||this.NUc();this.numberFormatViewModel.vme();this.I8f(nb)})}NUc(){this.F$=
!0;this.numberFormatViewModel.ifb(this.SNa);this.numberFormatViewModel.fqd(this.RNa);this.Po.Spd(this.H7);this.Po.Rpd(this.XC);this.Po.add_activeCellChanged(this.onActiveCellChanged);this.Po.AO(this.Yu);this.Po.X5e(this.JB);N.ULS.sendTraceTag(508355648,0,50,"NumberFormatViewModel events Registered")}I8f(nb,ic,Bc){ic=void 0===ic?3:ic;nb=Object(he.a)(new ee.a,{Caller:ic,NumberFormatCategory:null!==nb&&void 0!==nb?nb:-1});Bc&&Bc.currencyType&&(nb.CurrencyType=Bc.currencyType,nb.NumberFormatCategory=
3);this.numberFormatViewModel.TPb(this.activeCell,nb)}fIf(nb){var ic=this.numberFormatViewModel.zp.NumberFormatElement.toString();this.vw=nb=nb?this.hGf():this.numberFormatViewModel.M_a();return this.NCf=ic={numberFormatModel:{categories:this.numberFormatViewModel.zp.Categories,categoryDescriptionStrings:this.categoryDescriptionStrings,negativeNumberTypes:this.numberFormatViewModel.zp.NegativeNumberTypes,negativeCurrencyTypes:this.numberFormatViewModel.zp.NegativeCurrencyTypes,currencySymbols:this.numberFormatViewModel.zp.CurrencySymbols,
dateTypes:this.numberFormatViewModel.zp.DateTypes,timeTypes:this.numberFormatViewModel.zp.TimeTypes,fractionTypes:this.numberFormatViewModel.zp.FractionTypes,specialTypes:this.numberFormatViewModel.zp.SpecialTypes,customTypes:this.numberFormatViewModel.zp.CustomTypes,localeOptions:this.numberFormatViewModel.zp.Locales,calendarTypes:this.numberFormatViewModel.zp.Calendars,isInputCalendarCheckboxRequired:"57607"===ic||"319751"===ic?!0:!1,isGannenCheckboxRequired:"319751"===ic?!0:!1,currentCategory:nb.NumberFormatCategory,
decimalPlaces:nb.DecimalPlaces,isComma:nb.IsComma,currencyType:nb.CurrencyType,negativeNumberType:nb.NegativeNumberType,dateType:nb.DateType,timeType:nb.TimeType,fractionType:nb.FractionType,specialType:nb.SpecialType,customType:nb.CustomType,negativeCurrencyType:nb.NegativeCurrencyType,calendarType:nb.CalendarType,localeIndex:nb.LocaleType,isInputCalendarChecked:nb.IsInputCalendar,isGannenChecked:nb.IsGannen}}}rAc(){var nb,ic;let Bc;const Qc=Ka.f(this.$),pd=Qc.ha.pa.activeCell;if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")){var Xd=
null===(nb=Qc.yh(pd))||void 0===nb?void 0:nb.cell;this.q1b=null!==(ic=null===Xd||void 0===Xd?void 0:Xd.to)&&void 0!==ic?ic:-1}else this.iod=null===(Xd=Qc.yh(pd))||void 0===Xd?void 0:Xd.cell;pd&&(Bc=X.q(pd,this.$));return Bc}H5g(){this.F$=!1;this.numberFormatViewModel&&(this.numberFormatViewModel.Lvb(this.SNa),this.numberFormatViewModel.hke(this.RNa),this.Po.Tje(this.H7),this.Po.remove_activeCellChanged(this.onActiveCellChanged),this.Po.dW(this.Yu),this.Po.MGg(this.JB),N.ULS.sendTraceTag(508355617,
0,50,"NumberFormatViewModel events Un-registered"))}hGf(){const nb=this.numberFormatViewModel.M_a();nb.NumberFormatCategory=this.vw.NumberFormatCategory;nb.NegativeNumberType=this.vw.NegativeNumberType;nb.NegativeCurrencyType=this.vw.NegativeCurrencyType;nb.DateType=this.vw.DateType;nb.TimeType=this.vw.TimeType;nb.FractionType=this.vw.FractionType;nb.SpecialType=this.vw.SpecialType;nb.CustomType=this.vw.CustomType;nb.DecimalPlaces=this.vw.DecimalPlaces;nb.CurrencyType=this.vw.CurrencyType;return nb}Rla(){c("NumberFormatTab::InstantUpdate::Start");
this.numberFormatViewModel.formatCells(this.hGf(),this.Nh);this.q1b=-1;this.Po.Q8(re.NumberFormatItemView,this.fIf(!0))}$1f(nb){return fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")?nb&&nb.to!==this.q1b:nb&&this.iod&&nb.to!==this.iod.to}}Object(H.a)(pe,"NumberFormatTaskPaneManager",null,[2]);class Se{constructor(nb,ic,Bc){this.F$=!1;this.activePage=re.FormatCellsListView;this.isFloatingObjectSelected=!1;this.UK=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");
this.oWb=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8837194_ScopePollForStateAndUpdateToPane");this.XC=()=>{this.dispose()};this.H7=()=>{this.xo()};this.onActiveCellChanged=(Qc,pd)=>{this.isFloatingObjectSelected&&pd&&pd.description===re[this.activePage]&&(this.$9b(this.activePage),this.isFloatingObjectSelected=!1)};this.Yu=(Qc,pd)=>{pd&&pd.zJd===this.activePage&&(this.isFloatingObjectSelected=!0,this.Po.Q8(this.activePage,null,!0))};this.Po=Ta.RBc(nb,ic,Bc);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&
!this.oWb&&(this.reactRibbonRoot=nb.qa.zh(337,!0))}static getInstance(nb,ic,Bc){return this.Va||(this.Va=new this(nb,ic,Bc))}$9b(nb){this.Po.Q8(nb,null);this.activePage=nb;this.F$||this.Kp();fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&requestAnimationFrame(()=>{this.oWb?this.Po.Cwg():this.reactRibbonRoot.Ln()})}dispose(){this.xo();this.Po.Sje(this.XC);Se.Va=null}Kp(){this.Po.Spd(this.H7);this.Po.Rpd(this.XC);this.UK||(this.Po.add_activeCellChanged(this.onActiveCellChanged),
this.Po.AO(this.Yu));this.F$=!0;N.ULS.sendTraceTag(508078168,0,50,"Events registered")}xo(){this.Po.Tje(this.H7);this.UK||(this.Po.remove_activeCellChanged(this.onActiveCellChanged),this.Po.dW(this.Yu));this.F$=!1;N.ULS.sendTraceTag(508078167,0,50,"Events unregistered")}}Object(H.a)(Se,"StoreConnectedItemViewTaskPaneManager",null,[2]);class Ta{constructor(){}static RBc(nb,ic,Bc){return Wd.getInstance(nb,ic,Bc)}static gOd(nb,ic,Bc){return pe.getInstance(nb,ic,Bc)}static TKd(nb,ic,Bc){return wb.getInstance(nb,
ic,Bc)}static oDc(nb,ic,Bc){return Se.getInstance(nb,ic,Bc)}}Object(H.a)(Ta,"FormatCellsTaskPaneHelper",null,[]);let Qa=class{constructor(nb,ic){this.xK=ic;this.$=nb}Ri(){return!1}executeCommand(nb,ic,Bc){var Qc;nb=!1;const pd=ic.command;switch(pd){case 2055979337:Ta.RBc(this.$,Bc,ic).Q8(re.FormatCellsListView,null);nb=!0;N.ULS.sendTraceTag(508369024,0,50,"FormatCellsTaskPane opened using FormatCells Command");break;case -395879625:Ta.gOd(this.$,Bc,ic).xWg(Bc);nb=!0;N.ULS.sendTraceTag(508385094,0,
50,"NumberFormat Tab in FormatCellsTaskPane opened using showNumberFormat");break;case -2019948858:Ta.TKd(this.$,Bc,ic).vQa();nb=!0;N.ULS.sendTraceTag(508385093,0,50,"Alignment Tab in FormatCellsTaskPane opened using showAlignmentPane");break;case 456320978:Ta.oDc(this.$,Bc,ic).$9b(re.FontItemView);nb=!0;N.ULS.sendTraceTag(508078218,0,50,"Font Tab in FormatCellsTaskPane opened.");break;case 119664190:Ta.oDc(this.$,Bc,ic).$9b(re.BorderItemView),nb=!0,N.ULS.sendTraceTag(507896130,0,50,"Border Tab in FormatCellsTaskPane opened.")}fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8607151_FormatTaskpaneFloatieUI")&&
(ic=null!==(Qc=Bc[Td.a.C$a])&&void 0!==Qc?Qc:0,nb&&9===ic&&this.xK.Job()&&this.xK.pH());return nb?cb.Task.Ua(!0):ja.a(pd)}Ei(nb,ic){switch(ic.command){case 2055979337:case -395879625:case -2019948858:case 456320978:case 119664190:return!0;default:return!1}}dj(){return!1}};Qa=Object(J.__decorate)([Object(Sa.d)(jb.Ac),Object(J.__param)(0,Object(jb.Ob)()),Object(J.__param)(1,Object(jb.gb)())],Qa);Object(H.a)(Qa,"FormatCellsCommandHandler",null,[36]);Object(Sa.b)(jb.Dc)(nb=>xo(function*(){const ic=yield Sa.a.resolve(jb.Kc,
nb),Bc=yield Sa.a.resolve(jb.G,nb);yield Bc.bWf;return new Ob(ic.getFormulaAnonymizer(Bc.config))}));class Ob{constructor(nb){this.CIh=nb}anonymize(nb,ic){return this.CIh.anonymize(nb,{row:ic.top-1,col:ic.left-1,rows:1,cols:1})}}Object(H.a)(Ob,"FormulaAnonymizer",null,[]);class Jb{constructor(nb,ic,Bc,Qc){this.$=nb;this.formulaAssistanceUIControl=ic;this.kD=Bc;this.UF=Qc;this.e0b=Ld.a.w1f();this.Sya=this.UPe=!1;this.Rba={repairs:[],cell:null};this.da=Object(Ka.f)(this.$);this.container=document.createElement("div");
this.$.domElement.appendChild(this.container)}get CLa(){return this.UPe}set CLa(nb){this.UPe=nb;this.UF.ap=nb}YSk(nb,ic,Bc,Qc){Qc=void 0===Qc?"beside":Qc;this.Isd("card");this.kD.ole("repair",ic.repairs.length);this.CLa=!0;const pd=this.iwd(nb),Xd=Object.assign({},ic,{callbacks:Bc,Bwl:Qc});this.Rba={repairs:ic.repairs,cell:nb.GC};this.formulaAssistanceUIControl.renderFormulaRepair(this.container,pd,Xd);this.uBe=ue=>{ue=Object.assign({},Xd,{repairs:ue});this.formulaAssistanceUIControl.renderFormulaRepair(this.container,
pd,ue)}}qTk(nb,ic){this.Isd("card");this.kD.ole("errorIndication");this.CLa=!0;nb=this.iwd(nb);this.formulaAssistanceUIControl.renderSyntaxErrorIndication(this.container,nb,ic)}mRk(nb,ic){this.Isd("icon");this.kD.ole("icon");this.Sya=!0;nb=this.iwd(nb);this.formulaAssistanceUIControl.renderFormulaRepairIcon(this.container,nb,ic)}hide(nb){let ic=!1;this.Sya&&(ic=!0,this.Sya=!1);this.CLa&&(this.e0b&&"commit"!==nb&&this.Rba.repairs&&0<this.Rba.repairs.length&&this.Rba.cell&&this.kD.ibe(this.Rba),ic=
!0,this.CLa=!1,this.uBe=null);ic&&(this.formulaAssistanceUIControl.dismiss(this.container),this.kD.Hsk(nb),this.Rba={repairs:[],cell:null});return ic}Isd(nb){N.ULS.shipAssertTag(508315279,0,!this.CLa&&!this.Sya,`FormulaRepairControl: Trying to show ${nb} while a ui is shown. Card: ${this.CLa}, icon:${this.Sya}.`)}iwd(nb){nb=this.da.getCellBounds(nb,!0);return{top:nb.y,bottom:nb.y+nb.height,left:nb.x,right:nb.x+nb.width}}}Object(H.a)(Jb,"FormulaRepairControl",null,[]);var Jc=a(307),zb=a(7),tb=a(306),
zc=a(16);class dd{constructor(nb,ic,Bc){this.$=nb;this.Eoe=ic;this.formulaAssistanceUIControl=Bc;this.aXa=!1}get ap(){return this.aXa}set ap(nb){this.aXa!==nb&&(nb?tb.a(this.$).Wq(this):tb.a(this.$).fI(this),this.aXa=nb)}get el(){return this.Eoe}get ij(){return this.ht}set ij(nb){this.ht=nb}Lp(nb,ic){nb=!1;ic||(nb=this.formulaAssistanceUIControl.focusElement(this.ij));return nb}wq(nb){return null!=this.ij?zc.DOMElementExtensions.Co(this.ij,nb):!1}Rs(){}nu(){}}Object(H.a)(dd,"FormulaRepairFocusManager",
null,[42]);var od=a(284),gb=a(659);class gc{constructor(nb,ic,Bc,Qc,pd){this.$=nb;this.pluginScheduler=ic;this.H4g=Bc;this.kD=Qc;this.HCe=pd;this.w1d=Ld.a.IIc();this.isValuePreviewEnabled=this.f2f=this.C0d=!1;this.ATc=this.Huc=null;this.Qr={id:0,active:!1,cell:null};this.onActiveCellChanged=(Xd,ue)=>{var Ie,Je;this.C0d=!1;this.Qr.active&&Object(Jc.b)(ue.cell)&&ue.cell.range.toString()===(null===(Ie=this.Qr.cell)||void 0===Ie?void 0:Ie.GC.toString())||(Object(Jc.b)(this.ATc)?(Xd=null===(Je=this.da.yh(this.ATc))||
void 0===Je?void 0:Je.cell,void this.FWc("editCommitted",Xd),this.ATc=null):(this.hide("selection"),void this.FWc("selection")))};this.onScroll=()=>{this.hide("scroll")};this.C2j=(Xd,ue)=>{const Ie=this.Qr.cell;if(Object(Jc.c)(Xd))this.control.qTk(Ie,this.YJa("SyntaxErrorIndication"));else{this.Huc=Xd;var Je;this.isValuePreviewEnabled&&(Je=this.soi(this.Huc.repairs));this.kmj&&"editCommitted"!==ue?this.uyb("icon"):this.isValuePreviewEnabled?void this.Sgl(Je):this.uyb("card")}};this.uyb=Xd=>{this.f2f||
this.da.domElement.addEventListener("scroll",this.onScroll);"card"===Xd?this.control.YSk(this.Qr.cell,this.Huc,this.YJa("FormulaRepairCard"),this.gUi()):"icon"===Xd&&this.control.mRk(this.Qr.cell,this.CWj)};this.CWj=()=>{this.control.hide("commit");this.uyb("card")};this.YJa=Xd=>({onCommit:this.onCommit,onFeedback:this.onFeedback(Xd),onDismiss:this.onDismiss,onIgnore:this.onIgnore,onRender:this.onRender,getItemHighlights:this.cWi});this.onCommit=Xd=>{const ue=this.Qr.cell.GC;this.da.setCell({Text:Xd.text,
Fonts:[],TextRuns:[]},ue,0,127,null);this.w1d&&this.kD.x1d.nsg({Gq:ue,cellText:Xd.text,committed:!0});this.hide("commit")};this.onDismiss=()=>{this.Huc=null};this.onIgnore=()=>{this.mtg("ignore")};this.onFeedback=Xd=>()=>{const ue={};ue[zb.a.QM]=Xd;this.$.oi(802602464,0,19,ue)};this.onRender=Xd=>{Xd&&(this.UF.ij=Xd)};this.plk=Xd=>{const ue=this.Qr.id,Ie=()=>{this.Qr.id===ue&&void this.FWc(Xd,this.Qr.cell);this.da.za.Ax(Ie)};this.da.za.qy(Ie)};this.cWi=Xd=>{this.XF||N.ULS.sendTraceTag(508347539,0,
15,"FormulaRepair.getRepairItemHighlights: formulaHighlightsControl is null");var ue=this.XF.SZi(Xd.text,[gb.HighlightKind.Parentheses]);if(!ue)return null;const Ie=ue.highlightRanges;var Je=ue.n2c;ue=[];var He=0;for(var hf=0;hf<Je.length;hf++){const rf=Je[hf];ue.push({start:He,end:He+rf.text.length,color:rf.color});He+=rf.text.length}Xd=Xd.repairedFormulaParts;Je=[];for(hf=He=0;He<Xd.length&&hf<ue.length;)Je.push({location:{start:Math.max(Xd[He].location.start,ue[hf].start),end:Math.min(Xd[He].location.end,
ue[hf].end)},type:Xd[He].type,color:ue[hf].color}),Xd[He].location.end<ue[hf].end?He++:(Xd[He].location.end>ue[hf].end||He++,hf++);return{coloredParts:Je,highlightRanges:Ie}};this.Jn=()=>{this.hide("edit")};this.im=(Xd,ue)=>{Xd=ue.committed;const Ie=ue.CIa;ue=ue.Gq;const Je="keydown"===(null===Ie||void 0===Ie?void 0:Ie.type);!Xd||!Je||null!==Ie&&void 0!==Ie&&Ie.ctrlKey?Je&&void this.FWc(Xd?"editCommitted":"editDismissed"):this.ATc=ue};this.da=Object(Ka.f)(this.$);this.UF=new dd(this.$,od.a.gDf,this.H4g);
this.control=new Jb(this.$,this.H4g,Qc,this.UF);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.Dh.fM(this.Jn);this.da.Dh.Ox(this.im);void Sa.a.uj(jb.Gc).then(Xd=>{this.XF=Xd.XF});this.isValuePreviewEnabled=Ld.a.Boa();this.kmj=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRepairIcon",!1)&&"renderFormulaRepairIcon"in Bc}mtg(nb){this.hide(nb)&&(this.C0d=!0)}FWc(nb,ic){ic=void 0===ic?null:ic;const Bc=this;return xo(function*(){var Qc;if(!Bc.da.isEditing&&!Bc.C0d){var pd=
null!==ic&&void 0!==ic?ic:null===(Qc=Bc.da.yh(null))||void 0===Qc?void 0:Qc.cell;Bc.Qr={active:!1,id:Bc.Qr.id+1,cell:pd};Bc.da.za.lba()?!Object(Jc.c)(pd)&&pd.hasError&&(Bc.Qr.active=!0,Bc.kD.addressable.selected++,Qc=Bc.pluginScheduler.requester().formulaRepair({formula:Bc.Qr.cell.text},gb.PluginGroup.Excel,null),Qc=yield Bc.EDe(Qc),Object(Jc.c)(Qc)||"Done"!==Qc.kind?Bc.Qr.active=!1:Bc.C2j(Qc.payload,nb)):Bc.plk(nb)}})}Sgl(nb){const ic=this;return xo(function*(){let Bc;var Qc=new Promise(pd=>{Bc=
setTimeout(()=>{pd(!0)},100)});Qc=Promise.race([Qc,nb]).finally(()=>clearTimeout(Bc));(yield ic.EDe(Qc))&&ic.uyb("card")})}soi(nb){const ic=this;return xo(function*(){const Bc=Array(nb.length);for(let pd=0;pd<nb.length;pd++){var Qc=ic.HCe.Wle({text:nb[pd].text,index:0,length:nb[pd].text.length},2E3,!1);if((Qc=yield ic.EDe(Qc))&&"Success"===Qc.kind)Bc[pd]=Qc.value;else return!1}nb.forEach((pd,Xd)=>pd.formulaValue=Bc[Xd]);ic.control.CLa&&Object(Jc.b)(ic.control.uBe)&&ic.control.uBe(nb);return!0})}EDe(nb){const ic=
this;return xo(function*(){const Bc=ic.Qr.id,Qc=yield nb;return ic.Qr.id===Bc&&ic.Qr.active?Qc:null})}hide(nb){this.Qr.active=!1;this.Qr.cell=null;this.f2f&&this.da.domElement.removeEventListener("scroll",this.onScroll);return this.control.hide(nb)}gUi(){const nb=this.da.ha.pa.activeCell,ic=this.Qr.cell.GC;if(nb&&ic&&nb.left!==ic.left)return"below"}}Object(H.a)(gc,"FormulaRepair",null,[]);Object(Sa.b)(jb.Tc,{rk:"singleton"})(nb=>xo(function*(){var ic;const Bc=yield Sa.a.resolve(jb.Ob,nb),Qc=Sa.a.resolve(ya.f,
nb),pd=Object(bb.e)(qa.GetServiceTaskFactory.dk(Bc.qa,448,449,null!==(ic=nb.va)&&void 0!==ic?ic:0));ic=Sa.a.resolve(jb.Gc,nb);const Xd=Sa.a.resolve(jb.Uc,nb),ue=Sa.a.resolve(jb.Jc,nb),[Ie,Je,He,hf]=yield Promise.all([Qc,pd,Xd,ue,ic]);return new gc(Bc,Ie,Je,He,hf)}));class Dc{constructor(nb){this.$=nb;this.Rba=null;this.X5d=0;this.im=(ic,Bc)=>{this.xo();this.vlj(Bc)&&this.X5d++;this.Rba=null};this.da=Ka.f(this.$)}ibe(nb){this.Rba=nb;this.registerEvent()}registerEvent(){this.da.cellTextEditBox.zX(this.im)}xo(){this.da.cellTextEditBox.J2(this.im)}vlj(nb){return nb.committed&&
null!==this.Rba&&nb.Gq.equals(this.Rba.cell)&&this.Rba.repairs.some(ic=>ic.text.toLowerCase().replace(/\s+/g,"")===nb.cellText.toLowerCase().replace(/\s+/g,""))}}Object(H.a)(Dc,"ManualFormulaRepairTelemetry",null,[]);let hd=class{constructor(nb,ic){this.x1d=nb;this.$=ic;this.w1d=Ld.a.IIc();this.e0b=Ld.a.w1f();this.id=0;this.yza=null;this.vl={reportName:"FormulaRepair",addressable:{selected:0,committed:0},repairUsage:e(),indicationUsage:e(),iconUsage:e()};this.vl.repairUsage.keptData=this.x1d.zNd();
this.e0b&&(this.W5d=new Dc(this.$),this.vl.repairUsage.manualRepair=this.W5d.X5d);this.repairUsage=this.vl.repairUsage;this.indicationUsage=this.vl.indicationUsage;this.iconUsage=this.vl.iconUsage;this.addressable=this.vl.addressable;this.klk()}ole(nb,ic){switch(nb){case "repair":this.iIb=this.repairUsage;this.iIb.show.repairCounts.push(ic);break;case "icon":this.iIb=this.iconUsage;break;case "errorIndication":this.iIb=this.indicationUsage}this.iIb.show.count++;this.yza=performance.now();this.cXf()}Hsk(nb){if(null!==
this.yza){const ic=performance.now()-this.yza;this.iIb.hideDurations[nb].push(ic)}else N.ULS.sendTraceTag(508370960,1,10,"FormulaRepairTelemetry.reportHide: lastShowTime is null");this.cXf();this.yza=null}ibe(nb){this.e0b&&this.W5d.ibe(nb)}klk(){this.$.qa.zi(276,nb=>{nb.v$(this.vl)})}cXf(){N.ULS.sendTraceTag(509137429,1,50,`${JSON.stringify({id:this.id++,addressable:this.addressable,repairUsage:this.repairUsage,iconUsage:this.iconUsage,indicationUsage:this.indicationUsage,keptData:this.w1d?this.x1d.zNd():
"",manualRepair:this.e0b?this.W5d.X5d:""})}`)}};hd=Object(J.__decorate)([Object(Sa.d)(jb.Uc),Object(J.__param)(0,Object(jb.Jd)()),Object(J.__param)(1,Object(jb.Ob)())],hd);Object(H.a)(hd,"FormulaRepairTelemetry",null,[]);var xd=a(30),fd=a(943),kd=a(119),Yb=a(494);class Cc{static getSelection(nb,ic,Bc){var Qc=nb.pa;nb=Qc.activeCell.clone();Qc=Qc.activeRange;Qc.hk&&(N.ULS.sendTraceTag(507556643,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${nb.top}) and firstUnfreezeCell.Bottom (${nb.bottom}) to equal topLeftRange.Top (${ic.top})`),
nb.top=nb.bottom=ic.top);Qc.isRow&&(N.ULS.sendTraceTag(507556642,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${nb.left}) and firstUnfreezeCell.Right (${nb.right}) to equal topLeftRange.Left (${ic.left})`),nb.left=nb.right=ic.left);if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(Bc.command){case -73576432:case -1156879868:nb.top===nb.maxRows&&(nb.top=nb.bottom=nb.maxRows-1);break;case -1564089444:case -1929078919:nb.left===
nb.maxColumns&&(nb.left=nb.right=nb.maxColumns-1)}return nb}static mYb(nb,ic){if(nb.SD(ic))return!0;for(const Bc of nb.Av){if(!nb.fh.OD(Bc.paneType))continue;const Qc=nb.Hl(ic,Bc.paneType),pd=Bc.Zr;if(Qc&&pd&&Cc.wWb(Qc,pd))return!0}return!1}static wWb(nb,ic){return!nb||ic.topLeft.y>nb.bottomRight.y||ic.topLeft.x>nb.bottomRight.x||ic.bottomRight.y<nb.bottomRight.y||ic.bottomRight.x<nb.bottomRight.x?!1:!0}static RP(nb,ic,Bc,Qc){if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var pd=
"FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",Xd={};Xd.operationType=Yb.a(ic.command);Xd.isSuccessful=Bc;Xd.preExistingPanes=nb.fh.nx;Xd.message=Qc?Qc:"";pd+=Nb.a.Di(Xd);N.ULS.sendTraceTag(507556641,0,50,pd)}}static LMc(nb,ic,Bc,Qc,pd){N.ULS.sendTraceTag(507381773,0,50,JSON.stringify({preExistingPanes:nb.fh.nx,message:null!==pd&&void 0!==pd?pd:"",dragOrigin:ic,dragDirection:Bc,eventName:Qc}))}static ASb(nb){var ic,Bc=null!==(ic=nb.Cmb())&&void 0!==ic?ic:nb.s6();if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix"))return ic=
nb.jj,nb=Math.max(Bc.top,ic.m1(Bc.top,!0,!0)),Bc=Math.max(Bc.left,ic.m1(Bc.left,!1,!0)),{rowNumber:nb,columnNumber:Bc};ic=nb.Baa(!0);nb=nb.Baa(!1);return{rowNumber:ic>Bc.top?ic:Bc.top,columnNumber:nb>Bc.left?nb:Bc.left}}}Object(H.a)(Cc,"FreezePanesUtils",null,[]);var td=a(139),Ad;(function(nb){nb[nb.HORIZONTAL=0]="HORIZONTAL";nb[nb.VERTICAL=1]="VERTICAL";nb[nb.BOTH=2]="BOTH"})(Ad||(Ad={}));Object(H.b)("FreezePanesPreviewDirection",Ad);var oe;(function(nb){nb[nb.TOPLEFT=0]="TOPLEFT";nb[nb.BOTTOMRIGHT=
1]="BOTTOMRIGHT"})(oe||(oe={}));Object(H.b)("FreezePanesPreviewPosition",oe);class qe{constructor(nb){this.da=nb}E7h(nb){qe.GEa||nb===Ad.VERTICAL||(qe.GEa=document.createElement("div"),qe.GEa.classList.add(xd.Gb),qe.GEa.role="presentation",this.da.$m.appendChild(qe.GEa));qe.Lea||nb===Ad.HORIZONTAL||(qe.Lea=document.createElement("div"),qe.Lea.classList.add(xd.Hb),qe.Lea.role="presentation",this.da.$m.appendChild(qe.Lea))}dId(nb,ic){ic=void 0===ic?oe.BOTTOMRIGHT:ic;var Bc=this.da.fh.QJ,Qc=this.da.fh.KL;
var pd=this.da.fh.Im;const Xd=this.da.fh.en,{LJ:ue,IB:Ie}=this.da.r6(),Je=this.da.jj;if(Je){var He=this.h1(Je,ue.top,ue.left);ic=this.h1(Je,nb.top+ic,nb.left+ic);var hf=this.h1(Je,pd,Xd);var rf=Ie.x+He.wk-hf.wk,qf=Ie.y+He.ik-hf.ik;He=this.da.ys;var We=this.da.yC;hf=We+ic.ik-qf;0<Bc&&(Bc=this.gxa(Je,0,0),hf=nb.top<pd?We+ic.ik-Bc.ik:We+ic.ik-Bc.ik-qf);pd=He+ic.wk-rf;0<Qc&&(Qc=this.gxa(Je,0,0),pd=Xd>nb.left?He+ic.wk-Qc.wk:He+ic.wk-Qc.wk-rf);return{onb:pd,LAb:hf}}}ryb(nb,ic,Bc){Bc=void 0===Bc?oe.BOTTOMRIGHT:
Bc;nb=this.dId(nb,Bc);void 0!==nb?this.sRk(nb.onb,nb.LAb,ic):cb.Task.Ua(!1)}sRk(nb,ic,Bc){this.E7h(Bc);Bc!==Ad.BOTH&&Bc!==Ad.HORIZONTAL||!this.QUh(ic)||(qe.GEa.style.top=la.HelperMethods.Li(Math.max(ic,this.da.yC)));Bc!==Ad.BOTH&&Bc!==Ad.VERTICAL||!this.UUh(nb)||(this.da.rtl?(qe.Lea.style.left="unset",qe.Lea.style.right=la.HelperMethods.Li(Math.max(nb,this.da.ys))):(qe.Lea.style.right="unset",qe.Lea.style.left=la.HelperMethods.Li(Math.max(nb,this.da.ys))));cb.Task.Ua(!0)}QUh(nb){return fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?
nb>=this.da.$m.clientHeight-td.a.Ex?(this.hLa(Ad.HORIZONTAL),!1):!0:!0}UUh(nb){return fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?nb>=this.da.$m.clientWidth-td.a.Ex?(this.hLa(Ad.VERTICAL),!1):!0:!0}hLa(nb){nb=void 0===nb?Ad.BOTH:nb;nb!==Ad.HORIZONTAL&&nb!==Ad.BOTH||!qe.GEa||(this.da.$m.removeChild(qe.GEa),qe.GEa=null);nb!==Ad.VERTICAL&&nb!==Ad.BOTH||!qe.Lea||(this.da.$m.removeChild(qe.Lea),qe.Lea=null);return cb.Task.Ua(!0)}h1(nb,ic,Bc){return nb.bV(kd.a.yi(ic,
Bc))}gxa(nb,ic,Bc){const {rowNumber:Qc,columnNumber:pd}=Cc.ASb(this.da);return this.h1(nb,Qc+ic,pd+Bc)}freezePanesRowAndColumnPreview(nb,ic){let Bc=!0,Qc=!0,pd=oe.TOPLEFT;var Xd=this.da.jj;if(!Xd)return Cc.RP(this.da,nb,!1,"sheetProcessedData is not available."),cb.Task.Ua(!1);ic=Cc.getSelection(this.da.ha,ic,nb);if(!Cc.mYb(this.da,ic))return Cc.RP(this.da,nb,!0,"Preview not shown as selection is not in visible area"),cb.Task.Ua(!0);switch(nb.command){case -1006176541:var ue=this.da.fh.Im;const Je=
this.da.fh.en,{LJ:He,IB:hf}=this.da.r6(),rf=this.gxa(Xd,0,0);var Ie=this.h1(Xd,He.top,He.left);const qf=this.h1(Xd,ic.top,ic.left);Xd=this.h1(Xd,ue,Je);ue=hf.x+Ie.wk-Xd.wk;Ie=hf.y+Ie.ik-Xd.ik;if(qf.ik===rf.ik&&qf.wk===rf.wk)return this.z3b(nb);if(qf.ik===rf.ik||qf.ik<=rf.ik||qf.AJ>=Xd.AJ&&qf.ik<Xd.ik+Ie)Bc=!1;if(qf.ik===rf.ik&&qf.wk===rf.wk||qf.wk<=rf.wk||qf.WI>=Xd.WI&&qf.wk<Xd.wk+ue)Qc=!1;break;case -1156879868:pd=oe.BOTTOMRIGHT;Qc=!1;break;case -1929078919:pd=oe.BOTTOMRIGHT;Bc=!1;break;default:return Cc.RP(this.da,
nb,!1,"Unexpected preview Ribbon Command"),cb.Task.Ua(!0)}Qc&&this.ryb(ic,Ad.VERTICAL,pd);Bc&&this.ryb(ic,Ad.HORIZONTAL,pd);Cc.RP(this.da,nb,!0);return cb.Task.Ua(!0)}z3b(nb){const {rowNumber:ic,columnNumber:Bc}=Cc.ASb(this.da),Qc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?$a.Range.yi(ic,Bc):this.da.s6();this.ryb(Qc,Ad.HORIZONTAL,oe.BOTTOMRIGHT);Cc.RP(this.da,nb,!0);return cb.Task.Ua(!0)}Vce(nb){const {rowNumber:ic,columnNumber:Bc}=Cc.ASb(this.da),Qc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?
$a.Range.yi(ic,Bc):this.da.s6();this.ryb(Qc,Ad.VERTICAL,oe.BOTTOMRIGHT);Cc.RP(this.da,nb,!0);return cb.Task.Ua(!0)}}Object(H.a)(qe,"FreezePanesPreviewManager",null,[]);var Be;(function(nb){nb.HORIZONTAL="horizontal";nb.VERTICAL="vertical"})(Be||(Be={}));Object(H.b)("FreezePanesDragDirection",Be);var Ee;(function(nb){nb.HEADER="header";nb.FREEZEPANELINE="freezepaneline"})(Ee||(Ee={}));Object(H.b)("FreezePaneDragOrigin",Ee);let Ve=class{constructor(nb,ic){this.da=nb;this.yA=ic;this.wla=this.Tka=null;
this.LMe=!1;this.icd=this.mVa=this.zTa=this.q1e=this.MOe=null;this.jcb=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8857299_RevertLostPointerCapture");this.FEa=this.cGa=Ee.HEADER;this.sWe="PointerCaptureLost";this.rWe="PointerCancelledTriggered";this.Nmg=()=>{this.I2c(Be.HORIZONTAL)};this.Mmg=()=>{this.I2c(Be.HORIZONTAL)};this.stg=()=>{this.I2c(Be.VERTICAL)};this.rtg=()=>{this.I2c(Be.VERTICAL)};this.Smg=Bc=>{Bc.preventDefault();this.MOe=Bc.clientY;this.yA.startTrackAnimation(Bc,this.FEa===Ee.HEADER?
"freeze_pane_header_drag_horizontal":"freeze_pane_line_drag_horizontal");this.e7e(Be.HORIZONTAL);this.XL||(this.XL=document.createElement("div"),this.XL.classList.add(xd.Db),this.da.$m.appendChild(this.XL));this.icd=this.da.$m.getBoundingClientRect();this.XL.style.display="block";this.XL.style.top=Bc.clientY/this.da.PQ-this.icd.top+"px";this.XL.setPointerCapture(Bc.pointerId);this.XL.style.cursor="grabbing";Cc.LMc(this.da,this.FEa,Be.HORIZONTAL,"FreezePaneDragStarted");this.jcb||this.XL.addEventListener("lostpointercapture",
this.Pmg);this.XL.addEventListener("pointermove",this.Qmg);this.XL.addEventListener("pointerup",this.Rmg);this.XL.addEventListener("pointercancel",this.Omg)};this.xtg=Bc=>{this.yA.startTrackAnimation(Bc,this.cGa===Ee.HEADER?"freeze_pane_header_drag_vertical":"freeze_pane_line_drag_vertical");Bc.preventDefault();this.q1e=Bc.clientX;this.e7e(Be.VERTICAL);this.dM||(this.dM=document.createElement("div"),this.dM.classList.add(xd.Ib),this.da.$m.appendChild(this.dM));this.dM.style.display="block";this.dM.style.left=
Bc.clientX/this.da.PQ+"px";this.dM.setPointerCapture(Bc.pointerId);this.dM.style.cursor="grabbing";Cc.LMc(this.da,this.cGa,Be.VERTICAL,"FreezePaneDragStarted");this.jcb||this.dM.addEventListener("lostpointercapture",this.utg);this.dM.addEventListener("pointermove",this.vtg);this.dM.addEventListener("pointerup",this.wtg);this.dM.addEventListener("pointercancel",this.ttg)};this.Qmg=Bc=>{const Qc=la.HelperMethods.Li(this.da.yC),pd=la.HelperMethods.Li(Bc.clientY/this.da.PQ-this.icd.top),Xd=`calc(100% - ${la.HelperMethods.Li(td.a.Ex)} - 2px)`;
this.XL.style.top=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?`clamp(${Qc}, ${pd}, ${Xd})`:pd;(this.zTa=this.Axi(Bc))?this.BEa.ryb(this.zTa,0):this.BEa.hLa(0)};this.vtg=Bc=>{const Qc=this.da.rtl?la.HelperMethods.Li(td.a.Ex):la.HelperMethods.Li(this.da.ys),pd=la.HelperMethods.Li(Bc.clientX/this.da.PQ),Xd=`calc(100% - ${la.HelperMethods.Li(this.da.rtl?this.da.ys:td.a.Ex)} - 2px)`;this.dM.style.left=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?
`clamp(${Qc}, ${pd}, ${Xd})`:pd;(this.mVa=this.Wxi(Bc))?this.BEa.ryb(this.mVa,1):this.BEa.hLa(1)};this.Pmg=Bc=>this.iae(Bc,!0,this.sWe);this.utg=Bc=>this.Sbe(Bc,!0,this.sWe);this.Omg=Bc=>this.iae(Bc,!0,this.rWe);this.ttg=Bc=>this.Sbe(Bc,!0,this.rWe);this.wtg=Bc=>this.Sbe(Bc,!1);this.Rmg=Bc=>this.iae(Bc,!1);this.iae=(Bc,Qc,pd)=>{const Xd=performance.now();Cc.LMc(this.da,this.FEa,Be.HORIZONTAL,Qc?"FreezePaneDragCancelled":"FreezePaneDragEnded",pd);this.XL.style.display="none";this.XL.removeEventListener("pointermove",
this.Qmg);this.XL.removeEventListener("pointerup",this.Rmg);this.XL.removeEventListener("pointercancel",this.Omg);this.jcb||this.XL.removeEventListener("lostpointercapture",this.Pmg);this.BEa.hLa(0);this.yA.stopTrackAnimation(this.FEa===Ee.HEADER?"freeze_pane_header_drag_horizontal":"freeze_pane_line_drag_horizontal");if(!this.jcb&&Qc)return this.zTa=null,!0;if(this.MOe===Bc.clientY)return!0;this.zTa?this.da.$.oi(-73576432,2,30,{dragProperties:{dragDirection:Be.HORIZONTAL,dragOrigin:this.FEa,target:this.jHh(this.zTa),
dragReleasedTime:Xd}}):this.da.$.oi(83934709,2,30,{dragProperties:{dragDirection:Be.HORIZONTAL,dragOrigin:this.FEa,target:null,dragReleasedTime:Xd,unfreeze:!0}});this.zTa=null;return!0};this.Sbe=(Bc,Qc,pd)=>{const Xd=performance.now();this.dM.style.display="none";Cc.LMc(this.da,this.cGa,Be.VERTICAL,Qc?"FreezePaneDragCancelled":"FreezePaneDragEnded",pd);this.dM.removeEventListener("pointermove",this.vtg);this.dM.removeEventListener("pointerup",this.wtg);this.dM.removeEventListener("pointercancel",
this.ttg);this.jcb||this.dM.removeEventListener("lostpointercapture",this.utg);this.BEa.hLa(1);this.yA.stopTrackAnimation(this.cGa===Ee.HEADER?"freeze_pane_header_drag_vertical":"freeze_pane_line_drag_vertical");if(this.q1e===Bc.clientX)return!0;if(!this.jcb&&Qc)return this.mVa=null,!0;this.mVa?this.da.$.oi(-1564089444,2,30,{dragProperties:{dragDirection:Be.VERTICAL,dragOrigin:this.cGa,target:this.iHh(this.mVa),dragReleasedTime:Xd}}):this.da.$.oi(83934709,2,30,{dragProperties:{dragDirection:Be.VERTICAL,
dragOrigin:this.cGa,target:null,dragReleasedTime:Xd,unfreeze:!0}});this.mVa=null;return!0};this.Axi=Bc=>{const {position:Qc,area:pd,Dhf:Xd}=this.RAf(Bc);if(!Xd||!pd||!Qc)return null;if(Qc.y-pd.topLeft.y<pd.height/2){Bc=this.da.jj.IRb(Xd);Bc=$a.Range.yi(Bc.top,Bc.left);if(Bc.equals(Xd))return null;const ue=this.BEa.dId(Bc);return void 0!==ue&&ue.LAb<=this.da.yC?null:Bc}return Xd};this.Wxi=Bc=>{const {position:Qc,area:pd,Dhf:Xd}=this.RAf(Bc);if(!Xd||!pd||!Qc)return null;if(Qc.x-pd.topLeft.x<pd.width/
2){Bc=this.da.jj.SSb(Xd);Bc=$a.Range.yi(Bc.top,Bc.left);if(Bc.equals(Xd))return null;const ue=this.BEa.dId(Bc);return void 0!==ue&&ue.onb<=this.da.ys?null:Bc}return Xd};this.BEa=new qe(this.da)}Adj(){this.Tka&&this.wla||(this.Tka=zc.DOMElementExtensions.getElementById(this.da.$m,zb.a.mDf),this.wla=zc.DOMElementExtensions.getElementById(this.da.$m,zb.a.nDf));this.LMe||(this.Tka.addEventListener("pointerdown",this.Smg),this.wla.addEventListener("pointerdown",this.xtg),fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8830745_FreezePanesColorChangeOnHover")&&
(this.Tka.addEventListener("mouseover",this.Nmg),this.Tka.addEventListener("mouseout",this.Mmg),this.wla.addEventListener("mouseover",this.stg),this.wla.addEventListener("mouseout",this.rtg)),this.LMe=!0)}I2c(nb){const ic=zc.DOMElementExtensions.getElementsByClassName(this.da.$m,nb===Be.HORIZONTAL?xd.dc:xd.Fc);for(let Bc=0;Bc<ic.length;Bc++)ic[Bc].classList.toggle(nb===Be.HORIZONTAL?xd.cc:xd.Ec)}c7g(nb,ic){nb?(this.Tka.className=xd.Eb,this.FEa=Ee.FREEZEPANELINE):(this.Tka.className=xd.Jb,this.FEa=
Ee.HEADER);ic?(this.wla.className=xd.Fb,this.cGa=Ee.FREEZEPANELINE):(this.wla.className=xd.Kb,this.cGa=Ee.HEADER)}dispose(){this.Tka.removeEventListener("pointerdown",this.Smg);this.wla.removeEventListener("pointerdown",this.xtg);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8830745_FreezePanesColorChangeOnHover")&&(this.Tka.removeEventListener("mouseover",this.Nmg),this.Tka.removeEventListener("mouseout",this.Mmg),this.wla.removeEventListener("mouseover",this.stg),this.wla.removeEventListener("mouseout",
this.rtg));this.XL&&this.da.$m.removeChild(this.XL);this.dM&&this.da.$m.removeChild(this.dM)}e7e(nb){const ic=this.da.fh;if(ic.nx){var Bc=ic.QJ,Qc=ic.KL;nb===Be.HORIZONTAL&&0<Bc?this.da.KC($a.Range.$U(ic.Im,ic.Im,!0),60,"FreezePaneDragAction.adjustScroll"):nb===Be.VERTICAL&&0<Qc&&this.da.KC($a.Range.mY(ic.en,ic.en,!0),60,"FreezePaneDragAction.adjustScroll")}}RAf(nb){var ic=new Sys.UI.DomEvent(nb);nb=new Sys.UI.Point(nb.clientX/this.da.PQ,nb.clientY/this.da.PQ);ic=this.da.ha.K4(nb,ic.target,-1,!0);
const Bc=this.da.Hl(ic,this.da.paneType,!0),Qc=this.da.ol(this.da.paneType);return{position:fd.a.jz(Qc.view.tn,this.da.domElement.parentNode,nb,this.da.rtl),area:Bc,Dhf:ic}}jHh(nb){return nb&&nb.top===uc.a.Ok?Object(X.E)(this.da.jj.IRb(nb)):nb}iHh(nb){return nb&&nb.left===uc.a.Ak?Object(X.E)(this.da.jj.SSb(nb)):nb}};Ve=Object(J.__decorate)([Object(Sa.d)(jb.Vc),Object(J.__param)(0,Object(jb.kd)()),Object(J.__param)(1,Object(jb.Gd)())],Ve);Object(H.a)(Ve,"FreezePaneDragAction",null,[537,2]);var Oe=
a(680),Ye=a(95);class nf{}Object(H.a)(nf,"FreezePanesCommandParameters",null,[]);var of=a(410),Cf=a(33),Ff=a(311),Wf=a(301);class Mf{constructor(nb){this.freezeOptions=null;this.freezeOptions=nb}getSheetName(){return this.freezeOptions.SheetName}}Object(H.a)(Mf,"MacroRecorderSheetPaneFrozenPayload",null,[149]);var ng=a(43),Rf=a(309),$f=a(19),jf,Hf;(function(nb){nb[nb.horizontal=0]="horizontal";nb[nb.vertical=1]="vertical"})(Hf||(Hf={}));Object(H.b)("Direction",Hf);var Uf;(function(nb){nb.DRAG_HANDLE=
"DRAG_HANDLE";nb.RIBBON="RIBBON"})(Uf||(Uf={}));Object(H.b)("FreezePanesRequestInitiator",Uf);let If=jf=class{constructor(nb,ic,Bc,Qc){this.$=nb;this.da=Bc;this.klb=this.Xfe=null;this.FPb=this.REd=this.f$f=this.muf=this.Qjb=!1;this.eka=$f.a.GD;this.beh=zb.a.oDf;this.zgh=zb.a.pDf;this.QJd=this.WZa=this.j2a=!1;this.vba=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8683456_FreezePanePreviewRefactor");this.$Nd=(pd,Xd,ue,Ie)=>{const Je=this.da.fh,He=this.da.qY(),hf=Je.QJ,rf=Je.KL;let qf=0,We=0,Jf=0,tf=
0;const ff=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8528403_FixFreezePaneCalcWhenGridUnderPane");switch(pd.command){case 1844679312:qf=ue.top-1;We=ue.left-1;Jf=qf-(Xd.top-1);tf=We-(Xd.left-1);ff&&Je.nx&&(hf&&He&&Jf>=He.bottom-He.top+1+hf&&(Jf=hf+(ue.top-He.top)+1),rf&&He&&tf>=He.right-He.left+1+rf&&(tf=rf+(ue.left-He.left)+1));break;case -73576432:qf=ue.top;Jf=qf-(Xd.top-1);ff&&Je.nx&&hf&&He&&Jf>=He.bottom-He.top+1+hf&&(Jf=hf+(ue.top-He.top)+1);Ie&&(We=Je.en-1,tf=We-Xd.left+1,ff&&Je.nx&&rf&&
He&&tf>=He.right-He.left+1+rf&&(tf=rf+(Je.en-He.left)+1));break;case -1564089444:We=ue.left,tf=We-(Xd.left-1),ff&&Je.nx&&rf&&He&&tf>=He.right-He.left+1+rf&&(tf=rf+(ue.left-He.left)+1),Ie&&(qf=Je.Im-1,Jf=qf-Xd.top+1,ff&&Je.nx&&hf&&He&&Jf>=He.bottom-He.top+1+hf&&(Jf=hf+(Je.Im-He.top)+1))}return{Oce:qf,Nce:We,VJd:Jf,UJd:tf}};this.Qlg=()=>{fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8593029_RevertFPLinesIfExist")&&(this.vba?this.XZa.hLa():this.pyg());fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",
!1)&&fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8551192_HighlightSelectionPostFreezeOp")&&(this.da.Fh.sAb(),this.da.Fh.zja());if(this.klb){const pd=Ff.a(Cf.a.kh.Xj,this.klb);jf.vJ.totalDuration=pd;const Xd=jf.vJ;this.muf?window.requestIdleCallback?window.requestIdleCallback(()=>{this.T3e(Xd);this.R$d(Xd)}):window.setTimeout(()=>{this.T3e(Xd);this.R$d(Xd)},100):this.R$d(Xd)}jf.vJ={};this.klb=null;this.GRc()};this.eUj=(pd,Xd)=>{var ue,Ie,Je,He;jf.vJ.EcsOperationDuration=null===(ue=pd.RequestTelemetryData)||
void 0===ue?void 0:ue.EcsOperationDuration;jf.vJ.WfeRequestDuration=null===(Ie=pd.RequestTelemetryData)||void 0===Ie?void 0:Ie.WfeRequestDuration;jf.vJ.EcsRequestDurations=null===(Je=pd.RequestTelemetryData)||void 0===Je?void 0:Je.EcsRequestDuration;jf.vJ.isSuccessful=!(0<(null===(He=pd.Errors)||void 0===He?void 0:He.length));this.j2a&&(ue=!!pd&&!!pd.RequestTelemetryData,!Ib.a(pd)&&Xd&&Xd.correlationId&&this.da.tk.c2(Xd.correlationId,pd.StateId,ue?pd.RequestTelemetryData.EcsOperationDuration:0,ue?
pd.RequestTelemetryData.EcsRequestDuration:0,ue?pd.RequestTelemetryData.WfeRequestDuration:0))};this.C9f=()=>{if(this.klb){const pd=Ff.a(Cf.a.kh.Xj,this.klb);jf.vJ.lastCacheUpdateDuration=pd}};this.$=nb;this.da=Ka.f(nb);this.gridInstantaneousAction=Qc;this.sN=ic.HNb(this.$.domElement,500,null,null);this.Qjb=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8406295_AddFreezePanePropsTo8cadq");this.muf=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8452940_AddGridContentPropsToFreezePaneTelemtry");this.f$f=
fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606820_addHasPanesLogTo8cadq");this.FPb=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8561471_EstimatePaneDataFix");this.REd=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnablePaneEstimationForAllFpOps",!1);this.XZa=new qe(this.da);this.j2a=fa.EwaSettings.Mob();this.Tli=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8845070_EstimatePaneViewDataCrashFix");fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&
fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&(this.aoa=document.getElementById(this.beh),this.s3=document.getElementById(this.zgh));this.q1f=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8839836_LogUnfreezeAndFreezeAfterFreezeCse");this.WZa=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",!1);this.QJd=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8797568_FreezePaneDragTelemetry")}Ri(nb,ic,Bc){let Qc=!1;switch(ic){case 1844679312:Qc=
1!==nb&&!this.da.fh.nx;break;case -73576432:case -1564089444:if(fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",!1)&&fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8764078_EnableFPCommandsForDrag")){Bc&&"dragProperties"in Bc&&(Qc=!1);break}fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8475425_DisableFreezeUpToCommandsWhenSelectionNotCell")&&(Qc=1!==nb);break;case -1006176541:case 179232729:case -1156879868:case -247664224:case -1929078919:Qc=!(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&
fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1))}this.$.fa.isEditMode||this.$.fa.Kh.allowViewCollab||(Qc=!0);return Qc}executeCommand(nb,ic,Bc){var Qc;nb=this.da.fh;const pd=null!==(Qc=this.da.Cmb())&&void 0!==Qc?Qc:this.da.s6();this.g7(ic);Qc=this.vba?Cc.getSelection(this.da.ha,pd,ic):this.getSelection(pd,ic);switch(ic.command){case 1844679312:return this.setFreezePanes(ic,pd,nb.vp);case 83934709:return this.P4g(ic,pd,Bc);case -73576432:return fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?
this.xxg(Qc,ic.command,ic.jk)?this.nqe(ic,pd,!1,Bc):cb.Task.Ua(!1):this.nqe(ic,pd,nb.vp,Bc);case -1564089444:return fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.xxg(Qc,ic.command,ic.jk)?this.mqe(ic,pd,!1,Bc):cb.Task.Ua(!1):this.mqe(ic,pd,nb.vp,Bc);case 340334732:return nb.tzc?cb.Task.Ua(!1):this.eGk(ic,pd);case -806625837:return nb.r$a?cb.Task.Ua(!1):this.fGk(ic,pd);case -1006176541:return this.vba?this.XZa.freezePanesRowAndColumnPreview(ic,pd):
this.freezePanesRowAndColumnPreview(ic,pd);case -342472547:case 1558501543:case -2036655906:case 1870830702:case -1588000013:return this.vba?this.XZa.hLa():this.pyg();case 179232729:if(this.vba)return this.XZa.z3b(ic);this.da.KK();return this.z3b(ic);case -1156879868:return this.vba?this.XZa.freezePanesRowAndColumnPreview(ic,pd):this.freezePanesRowAndColumnPreview(ic,pd);case -247664224:if(this.vba)return this.XZa.Vce(ic);this.da.KK();return this.Vce(ic);case -1929078919:return this.vba?this.XZa.freezePanesRowAndColumnPreview(ic,
pd):this.freezePanesRowAndColumnPreview(ic,pd)}return cb.Task.Ua(!1)}Ei(nb,ic){nb=!1;switch(ic.command){case 1844679312:case 340334732:case -806625837:case 1745254833:case 83934709:nb=!0;break;case -73576432:case -1564089444:nb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1);break;case -1006176541:case -342472547:case 179232729:case 1558501543:case -1156879868:case -2036655906:case -247664224:case 1870830702:case -1929078919:case -1588000013:nb=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&
fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)}return nb}dj(){return!1}g7(nb){Ra.AFrameworkApplication.ra.$g.jJ&&this.$.g7&&(1844679312===nb.command||340334732===nb.command||-806625837===nb.command)&&Oe.a.LX(1,2)}xxg(nb,ic,Bc){const Qc=this.da.fh;if(!Qc.vp||this.WZa&&30===Bc||Qc.QJ&&Qc.KL)return!0;switch(ic){case -73576432:return nb.top!==Qc.Im-1;case -1564089444:return nb.left!==Qc.en-1}return!1}wWb(nb,ic){return!nb||ic.topLeft.y>nb.bottomRight.y||ic.topLeft.x>
nb.bottomRight.x||ic.bottomRight.y<nb.bottomRight.y||ic.bottomRight.x<nb.bottomRight.x?!1:!0}mYb(nb){if(this.da.SD(nb))return!0;for(const ic of this.da.Av){if(!this.da.fh.OD(ic.paneType))continue;const Bc=this.da.Hl(nb,ic.paneType),Qc=ic.Zr;if(Bc&&Qc&&this.wWb(Bc,Qc))return!0}return!1}zCe(nb,ic,Bc,Qc){const pd=this.da.Hl(nb),Xd=this.da.view.visibleArea;return(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.vba?Cc.mYb(this.da,nb):this.mYb(nb):this.vba?
Cc.wWb(pd,Xd):this.wWb(pd,Xd))?0>=ic&&0>=Bc?(N.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),nb=Ka.f(this.$).rtl?1493:1492,ic=Ka.f(this.$).rtl?-2131054257:-1953454131,nb=La.a.nj(1,0,26,nb,0,ic,"FreezePaneA1SelectedErr"),this.urf(this.$,nb,Qc),!1):!0:(N.ULS.sendTraceTag(537159583,0,50,fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8802624_FreezePanesToastForDragOutsideVP")?`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${nb}, rangeViewportArea=${pd?
pd.toString():"null"}, visibleArea=${Xd.toString()}, requestInitiator=${Qc}`:`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${nb}, rangeViewportArea=${pd?pd.toString():"null"}, visibleArea=${Xd.toString()}`),nb=La.a.nj(1,0,26,1491,0,2105967339,"FreezePaneSelectionNotInViewErr"),this.urf(this.$,nb,Qc),!1)}getSelection(nb,ic){var Bc=this.da.ha.pa;const Qc=Bc.activeCell.clone();Bc=Bc.activeRange;Bc.hk&&(N.ULS.sendTraceTag(537159585,
0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${Qc.top}) and firstUnfreezeCell.Bottom (${Qc.bottom}) to equal topLeftRange.Top (${nb.top})`),Qc.top=Qc.bottom=nb.top);Bc.isRow&&(N.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${Qc.left}) and firstUnfreezeCell.Right (${Qc.right}) to equal topLeftRange.Left (${nb.left})`),Qc.left=Qc.right=nb.left);if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(ic.command){case -73576432:case -1156879868:Qc.top===
Qc.maxRows&&(Qc.top=Qc.bottom=Qc.maxRows-1);break;case -1564089444:case -1929078919:Qc.left===Qc.maxColumns&&(Qc.left=Qc.right=Qc.maxColumns-1)}return Qc}P4g(nb,ic,Bc){if(this.WZa&&Bc&&"dragProperties"in Bc){const Qc=Bc.dragProperties,pd=Qc.dragDirection;if("horizontal"===pd&&this.da.fh.OD(4))return this.da.fh.OD(3)?this.mqe(new ub.a(-1564089444,nb.method,nb.mode,nb.jk,nb.tabName),ic,!1,{dragProperties:{dragDirection:"vertical",dragOrigin:Qc.dragOrigin,target:$a.Range.mY(this.da.fh.en-1,this.da.fh.en,
!1),unfreeze:!0}}):cb.Task.Ua(!0);if("vertical"===pd&&this.da.fh.OD(3))return this.da.fh.OD(4)?this.nqe(new ub.a(-73576432,nb.method,nb.mode,nb.jk,nb.tabName),ic,!1,{dragProperties:{dragDirection:"horizontal",dragOrigin:Qc.dragOrigin,target:$a.Range.$U(this.da.fh.Im-1,this.da.fh.Im,!1),unfreeze:!0}}):cb.Task.Ua(!0)}this.Mvd(Bc);return this.$wb(nb,!1,0,0,0,0,ic,null)}setFreezePanes(nb,ic,Bc){if(fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)||!Bc){Bc=this.vba?Cc.getSelection(this.da.ha,
ic,nb):this.getSelection(ic,nb);Bc.top===ic.top&&Bc.left===ic.left&&(Bc=$a.Range.yi(Bc.top+1,Bc.left));const {Oce:Qc,Nce:pd,VJd:Xd,UJd:ue}=this.$Nd(nb,ic,Bc,!1);return this.zCe(Bc,Xd,ue,Uf.RIBBON)?this.$wb(nb,!0,Qc,pd,Xd,ue,ic,Bc):(this.$.Fm(),this.GRc(),cb.Task.Ua(!0))}return this.P4g(nb,ic)}yKf(nb,ic){const Bc=this.da.jj;let Qc=null;ic===Hf.vertical?Qc=Bc.h_a(nb):ic===Hf.horizontal&&(Qc=Bc.X_a(nb));if(Qc&&Qc!==nb)return new $a.Range(Qc.top,Qc.left,Qc.bottom,Qc.right,!1,!1);N.ULS.sendTraceTag(507790169,
0,50,`Could Not get First Scrollable Cell for : ${ic===Hf.horizontal?"horizontal":"vertical"}`);return nb}WFf(nb,ic,Bc){return this.WZa&&Bc&&"dragProperties"in Bc?(nb=Bc.dragProperties,ic=nb.dragDirection,{V1d:nb.target,wVd:nb.unfreeze?!1:this.da.fh.OD(3)&&"vertical"===ic||this.da.fh.OD(4)&&"horizontal"===ic}):{V1d:this.vba?Cc.getSelection(this.da.ha,ic,nb):this.getSelection(ic,nb),wVd:!1}}nqe(nb,ic,Bc,Qc){if(Bc)return cb.Task.Ua(!1);const {V1d:pd,wVd:Xd}=this.WFf(nb,ic,Qc),{Oce:ue,Nce:Ie,VJd:Je,
UJd:He}=this.$Nd(nb,ic,pd,Xd);if(!this.zCe(pd,Je,He,Qc&&"dragProperties"in Qc?Uf.DRAG_HANDLE:Uf.RIBBON))return this.$.Fm(),this.GRc(),cb.Task.Ua(!0);this.Mvd(Qc);return this.$wb(nb,!0,ue,Ie,Je,He,ic,this.FPb?this.yKf(pd,Hf.vertical):pd)}Mvd(nb){var ic;if(this.QJd&&this.WZa&&nb&&"dragProperties"in nb){nb=nb.dragProperties;const Bc=nb.dragReleasedTime;jf.vJ.isDrag=!0;jf.vJ.dragDirection=nb.dragDirection;jf.vJ.dragOrigin=nb.dragOrigin;jf.vJ.isUnfreezeFromDrag=null!==(ic=nb.unfreeze)&&void 0!==ic?ic:
!1;Bc&&(jf.vJ.dragReleaseToFreezeApplied=performance.now()-Bc)}}mqe(nb,ic,Bc,Qc){if(Bc)return cb.Task.Ua(!1);const {V1d:pd,wVd:Xd}=this.WFf(nb,ic,Qc),{Oce:ue,Nce:Ie,VJd:Je,UJd:He}=this.$Nd(nb,ic,pd,Xd);if(!this.zCe(pd,Je,He,Qc&&"dragProperties"in Qc?Uf.DRAG_HANDLE:Uf.RIBBON))return this.$.Fm(),this.GRc(),cb.Task.Ua(!0);this.Mvd(Qc);return this.$wb(nb,!0,ue,Ie,Je,He,ic,this.FPb?this.yKf(pd,Hf.horizontal):pd)}eGk(nb,ic){let Bc=0;const Qc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");
Qc&&(Bc=Cc.ASb(this.da).columnNumber);return this.$wb(nb,!0,0,Qc?Bc:ic.left,0,Qc?Bc-ic.left+1:1,ic,null)}fGk(nb,ic){let Bc=0;const Qc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");Qc&&(Bc=Cc.ASb(this.da).rowNumber);return this.$wb(nb,!0,Qc?Bc:ic.top,0,Qc?Bc-ic.top+1:1,0,ic,null)}urf(nb,ic,Bc){this.WZa&&fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8802624_FreezePanesToastForDragOutsideVP")&&Bc===Uf.DRAG_HANDLE?this.MVg(Aa.a.instance.ia(2560)):fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",
!1)?this.MVg(Aa.a.instance.ia(2427)):this.lp(nb,ic)}MVg(nb){nb=Rf.a.fB.eL.WX(nb,!1);nb.image=Ld.a.tpb()?1:0;Rf.a.fB.eL.HF(nb)}lp(nb,ic){new ha.a(this.$,ic)}$wb(nb,ic,Bc,Qc,pd,Xd,ue,Ie){var Je;this.Xfe=ng.a(this.$).pua(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.Qjb&&this.da.za.sz(this.C9f);this.da.x$(this.Qlg);this.sN.B9a();this.da.XWk(ic?"":"UnsetFreezePane");const He=Object(he.a)(new nf,{SheetName:null===(Je=this.$.la)||void 0===Je?void 0:Je.name,Freeze:ic,FrozenRows:pd,FrozenColumns:Xd,
FirstRow:Bc,FirstColumn:Qc});N.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${ic}, FrozenRows=${pd}, FrozenColumns=${Xd}, FirstRow=${Bc}, FirstColumn=${Qc} `);const hf=()=>new Mf(He),rf=Y.a.create().toString();this.Qjb&&(jf.vJ.isFreeze=ic,jf.vJ.operationType=Yb.a(nb.command),jf.vJ.frozenRows=pd,jf.vJ.frozenColumns=Xd,jf.vJ.firstRow=Bc,jf.vJ.firstColumn=Qc,jf.vJ.referencedBlocksBefore=this.da.za.zCc(),this.f$f&&(jf.vJ.hasPanes=this.da.fh.nx));this.klb=Cf.a.kh.Xj;
this.j2a&&this.i4k(nb,He,ue,Ie,rf);return ia.a(this.$.userOperationManager,(qf,We,Jf)=>{if(fa.EwaSettings.Na(59)){var tf=window.performance;tf.clearMarks();tf.mark("FreezePanes request sent")}tf=this.da.jj;var ff=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth"),xf=this.da.fh.vp;ff=ff?xf||!ic:!0;tf&&(ff||this.REd)?this.FPb&&xf?this.$.eD():(tf=this.Ovf(He,tf,ue,Ie),this.b4k(tf)):this.$.eD();xf=ta.c(qf,this.eUj);tf=this.$.oa.ta;qf=this.Qjb?xf:qf;xf=this.j2a?{setPanes:ic,correlationId:rf}:
ic;ff=tf.Za(9,null);ff.freezeSettings=He;return ba.h(tf,"FreezeOrUnfreezePanes",ff,qf,We,Jf,xf,0)},qf=>new Ma.a(151,0,qf,void 0,hf),nb)}i4k(nb,ic,Bc,Qc,pd){N.ULS.sendTraceTag(507577612,0,50,"FreezePanesCommandHandler.triggerFreezePaneCSE triggerFreezePaneCSE Initiated ");const Xd=this.da.jj;!this.q1f&&this.da.fh.vp?N.ULS.sendTraceTag(507574365,0,15,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${nb.command}, parameter = ActiveSheetProcessedData, value = null reason = No active sheet processed data`):
(this.gridInstantaneousAction.Nhe(),window.setTimeout(()=>{this.da.tk.Pza();var ue=this.q1f?`command:${Yb.a(nb.command)}, isFreeze:${ic.Freeze}`:Yb.a(nb.command);this.da.tk.BQ(23,pd,ue);ue={Rz:this.Ovf(ic,Xd,Bc,Qc)};this.gridInstantaneousAction.Xsd(nb.command,void 0,ue);N.ULS.sendTraceTag(507585429,0,50,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${nb.command}, parameter = FreezePaneCSEAttempted, value = Success reason = Initiated FreezePane CSE`)},10))}Ovf(nb,ic,Bc,Qc){try{N.ULS.shipAssertTag(537159580,
1,!!ic,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!nb.Freeze)return null;const pd=Wf.a();pd.State=1;pd.IsEstimated=!0;let Xd=!1,ue=!1;const Ie=ic.bV($a.Range.yi(Bc.top,Bc.left));if(null===Ie)return N.ULS.sendTraceTag(507893269,1,50,"EstimatePaneViewDataOnPaneRequest.topLeftAllPanesOffsetData Null"),null;let Je=nb.FrozenRows,He=nb.FrozenColumns;if(1!==nb.FrozenRows||nb.FrozenColumns)if(nb.FrozenRows||1!==nb.FrozenColumns){const hf=ic.bV($a.Range.yi(nb.FirstRow+
1,nb.FirstColumn+1)),rf=ic.bV($a.Range.yi(Bc.top,Bc.left));pd.Width=hf.wk-Ie.wk;pd.Height=hf.ik-Ie.ik;this.FPb&&(0>pd.Width?pd.Width=0:pd.Width,0>pd.Height?pd.Height=0:pd.Height);0<nb.FrozenRows&&(pd.AbsoluteTop=hf.ik,ue=!0);0<nb.FrozenColumns&&(pd.AbsoluteLeft=hf.wk,Xd=!0);Je=hf.AJ-rf.AJ;He=hf.WI-rf.WI}else pd.Width=ic.TCc(kd.a.yi(Bc.top,Bc.left)),Qc=$a.Range.yi(Bc.top,Bc.left+1),pd.AbsoluteLeft=Ie.wk+pd.Width,Xd=!0;else pd.Height=ic.QCc(kd.a.yi(Bc.top,Bc.left)),Qc=$a.Range.yi(Bc.top+1,Bc.left),
pd.AbsoluteTop=Ie.ik+pd.Height,ue=!0;if(this.Tli&&!Qc)return N.ULS.sendTraceTag(507316444,0,15,"FreezePanesCommandHandler.estimatePaneViewDataOnPaneRequest, firstUnfreezeCell is null"),null;ue&&(pd.FirstFrozenRow=Bc.top,pd.FirstScrollableRow=Qc.top);Xd&&(pd.FirstFrozenColumn=Bc.left,pd.FirstScrollableColumn=Qc.left);pd.VisibleRows=Je;pd.VisibleColumns=He;return pd}catch(pd){return N.ULS.sendTraceTag(507316443,0,15,`FreezePanesCommandHandler.estimatePaneViewDataOnPaneRequest, caught exception: ${pd}`),
null}}b4k(nb){cb.Task.delay(this.$.ua.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.la&&this.$.fa&&(this.$.fa.n9(uc.a.Ek,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),of.b(this.$.la,nb,-1,void 0,!0))})}GRc(){this.sN.I9a();Ye.a.gh(this.Xfe);this.Xfe=null;this.da.I2(this.Qlg);this.Qjb&&this.da.za.Vz(this.C9f)}R$d(nb){let ic=`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${nb.totalDuration} `;if(this.Qjb){var Bc=
this.s_a();Bc&&(Bc=this.da.oh.yCc(Array(Bc)),nb.activeCells=Bc);nb.referencedBlocksAfter=this.da.za.zCc();nb.enabledExperiments=[];this.REd&&nb.enabledExperiments.push("paneEstimation");this.j2a&&nb.enabledExperiments.push("cseEnabled");this.WZa&&this.QJd&&nb.enabledExperiments.push("freezePanesDrag");fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")&&fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1)&&nb.enabledExperiments.push("freezePanesNewEntries");
fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&nb.enabledExperiments.push("previewFreezePanes");ic+=Nb.a.Di(nb)}N.ULS.sendTraceTag(570949840,0,50,ic)}T3e(nb){let ic=0,Bc=0,Qc=0,pd=0;const Xd=new Set,ue=new Set,Ie=new Set,Je=la.HelperMethods.vN(()=>{var He=this.da.za.UJa(this.da.qY(),this.$.la.name);if(He)for(var hf of He)if(0!==hf.vs){if(He=pc.b(this.da.$,hf.zj,!0))for(var rf of He){He=rf.type;const qf=rf.Zq;if(""!==qf||null!=qf)2===He?ue.add(qf):1===He&&Ie.add(qf)}if(hf.cLb)for(const qf of hf.cLb)Xd.add(qf.Id);
rf=hf.Ti;hf=hf.CKa();if(hf=null===hf||void 0===hf?void 0:hf.Cells)for(const qf of hf)if(hf=this.da.za.hKf(rf,qf.Row,qf.Col))ic+=hf.fG?1:0,Qc+=hf.jS?1:0,pd+=hf.z0a?1:0,Bc+=hf.LC?1:0;break}});nb.mergedCells=ic;nb.formulaCells=Bc;nb.conditionalFormatting=Qc;nb.coloredCells=pd;nb.tables=ue.size;nb.pivotTables=Ie.size;nb.floatingObjects=Xd.size;nb.gridContentLogTime=Je}s_a(){const nb=this.da.s6(),ic=this.da.HAc();return null===nb||null===ic?null:new $a.Range(nb.top,nb.left,ic.bottom,ic.right,!0,!0)}h1(nb,
ic,Bc){return nb.bV(kd.a.yi(ic,Bc))}Vce(nb){const ic=this.da.fh.KL;var {IB:Bc}=this.da.r6(),Qc=this.da.jj;if(null===Qc)return this.RP(nb,!1,"sheetProcessedData is not available."),cb.Task.Ua(!1);const pd=this.gxa(Qc,0,0);Qc=this.gxa(Qc,0,1);Bc=this.da.ys+Qc.wk-(Bc.x+pd.wk);0<ic&&(Bc=this.da.ys+Qc.wk-pd.wk);if(null!==this.s3)this.da.rtl?this.s3.style.right=la.HelperMethods.Li(Bc):this.s3.style.left=la.HelperMethods.Li(Bc),this.s3.classList.remove(this.eka);else return this.RP(nb,!1,"verticalPreviewBar is null"),
cb.Task.Ua(!0);this.RP(nb,!0);return cb.Task.Ua(!0)}z3b(nb){const ic=this.da.fh.QJ;var Bc=this.da.jj;if(null===Bc)return this.RP(nb,!1,"sheetProcessedData is not available."),cb.Task.Ua(!1);({IB:pd}=this.da.r6());const Qc=this.gxa(Bc,0,0);Bc=this.gxa(Bc,1,0);var pd=this.da.yC+Bc.ik-(pd.y+Qc.ik);0<ic&&(pd=this.da.yC+Bc.ik-Qc.ik);if(null!==this.aoa)this.aoa.style.top=la.HelperMethods.Li(pd),this.aoa.classList.remove(this.eka);else return this.RP(nb,!1,"horizontalPreviewBar is null"),cb.Task.Ua(!0);
this.RP(nb,!0);return cb.Task.Ua(!0)}freezePanesRowAndColumnPreview(nb,ic){let Bc,Qc;let pd=!0,Xd=!0;const ue=this.da.fh.QJ,Ie=this.da.fh.KL,Je=this.da.fh.Im,He=this.da.fh.en,{LJ:hf,IB:rf}=this.da.r6();var qf=this.da.jj;if(null===qf)return this.RP(nb,!1,"sheetProcessedData is not available."),cb.Task.Ua(!1);const We=this.gxa(qf,0,0);ic=this.getSelection(ic,nb);if(!this.mYb(ic))return this.RP(nb,!0,"Preview not shown as selection is not in visible area"),cb.Task.Ua(!0);var Jf=this.h1(qf,hf.top,hf.left);
const tf=this.h1(qf,ic.top+0,ic.left+0);var ff=this.h1(qf,ic.top+1,ic.left);const xf=this.h1(qf,ic.top,ic.left+1);qf=this.h1(qf,Je,He);const Lf=rf.x+Jf.wk-qf.wk;Jf=rf.y+Jf.ik-qf.ik;if(-1006176541===nb.command){ff=tf;if(tf.ik===We.ik&&tf.wk===We.wk)return this.z3b(nb);if(tf.ik===We.ik||tf.ik<=We.ik||tf.AJ>=qf.AJ&&tf.ik<qf.ik+Jf)pd=!1}pd&&(Qc=this.da.yC+ff.ik-Jf,0<ue&&(Qc=ic.top<Je?this.da.yC+ff.ik-We.ik:this.da.yC+ff.ik-We.ik-Jf));if(-1006176541===nb.command){if(ff=tf,tf.ik===We.ik&&tf.wk===We.wk||
tf.wk<=We.wk||tf.WI>=qf.WI&&tf.wk<qf.wk+Lf)Xd=!1}else ff=xf;Xd&&(Bc=this.da.ys+ff.wk-Lf,0<Ie&&(Bc=He>ic.left?this.da.ys+ff.wk-We.wk:this.da.ys+ff.wk-We.wk-Lf));if(null!==this.aoa&&pd)this.aoa.style.top=la.HelperMethods.Li(Qc),this.aoa.classList.remove(this.eka);else if(pd)return this.RP(nb,!1,"horizontalPreviewBar is null"),cb.Task.Ua(!0);if(null!==this.s3&&Xd)this.da.rtl?this.s3.style.right=la.HelperMethods.Li(Bc):this.s3.style.left=la.HelperMethods.Li(Bc),this.s3.classList.remove(this.eka);else if(Xd)return this.RP(nb,
!1,"verticalPreviewBar is null"),cb.Task.Ua(!0);-1156879868===nb.command&&this.s3.classList.add(this.eka);-1929078919===nb.command&&this.aoa.classList.add(this.eka);this.RP(nb,!0);return cb.Task.Ua(!0)}pyg(){this.s3&&(this.s3.style.left=null,this.s3.style.right=null,this.s3.classList.contains(this.eka)||this.s3.classList.add(this.eka));this.aoa&&(this.aoa.classList.contains(this.eka)||this.aoa.classList.add(this.eka));return cb.Task.Ua(!0)}RP(nb,ic,Bc){if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var Qc=
"FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",pd={};pd.operationType=Yb.a(nb.command);pd.isSuccessful=ic;pd.preExistingPanes=this.da.fh.nx;pd.message=Bc?Bc:"";Qc+=Nb.a.Di(pd);N.ULS.sendTraceTag(507655369,0,50,Qc)}}gxa(nb,ic,Bc){var Qc;const pd=null!==(Qc=this.da.Cmb())&&void 0!==Qc?Qc:this.da.s6();Qc=this.da.Baa(!0);const Xd=this.da.Baa(!1);return this.h1(nb,(Qc>pd.top?Qc:pd.top)+ic,(Xd>pd.left?Xd:pd.left)+Bc)}};If.vJ={};If=jf=Object(J.__decorate)([Object(Sa.d)(jb.Wc),Object(J.__param)(0,
Object(jb.Ob)()),Object(J.__param)(1,Object(jb.Tf)()),Object(J.__param)(2,Object(jb.kd)()),Object(J.__param)(3,Object(jb.id)())],If);Object(H.a)(If,"FreezePanesCommandHandler",null,[36]);var sf;let tc=sf=class{constructor(nb,ic){this.da=nb;this.$=ic;this.selectedRanges=[];this.Wqf=this.C7a=this.A6=this.HWf=this.j5b=this.Hoa=this.XXd=!1;this.HQf=()=>{this.Ebc(this.selectedRanges,!1);this.LSd();this.Rr&&this.iAb(this.Rr.Uu,this.Rr.EG,this.Rr.isRow,!0,!0,!1);this.XXd=!0};this.GQf=()=>{this.XXd=!1;this.Ebc(this.selectedRanges,
!0);this.Rr&&this.Tya(this.Rr.isRow)&&this.iAb(this.Rr.Uu,this.Rr.EG,this.Rr.isRow,!0,!0,!0)};this.Hoa=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8756282_HeaderInsertAllowedRefactor");this.j5b=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8797344_refactorGetAdjacentCellIndex");this.HWf=this.Hoa&&fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8797454_insertBasedOnAdjacentSelection");this.A6=fa.EwaSettings.YXd();this.C7a=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8805838_HeaderInsertRestrictOnFreezePane");
this.Wqf=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8819939_DisableHeaderInsertForSelectAll")}isHeaderInsertAllowed(nb,ic,Bc){return this.Hoa?this.Vt&&this.Vt.isRow===ic&&(this.Vt.EG===nb&&this.Vt.Eya===Bc||this.Vt.brd===nb&&this.Vt.Eya===!Bc):this.Tya(ic)&&(!this.DLa(nb,ic)||!!this.lob(nb,ic,Bc))}OSf(nb,ic,Bc,Qc){Qc?(!this.Rr||this.Rr.EG===ic&&this.Rr.isRow===Bc||this.OSf(this.Rr.Uu,this.Rr.EG,this.Rr.isRow,!1),this.Rr={isRow:Bc,EG:ic,Uu:nb}):(this.Rr&&this.Rr.EG===ic&&this.Rr.isRow===Bc||N.ULS.sendTraceTag(507581474,
0,15,"HeaderInsert.headerCellHoveredCallback: Got unset hover event for a cell that was not previously hovered."),this.Rr=void 0);this.Tya(Bc)&&!this.DLa(ic,Bc)&&this.iAb(nb,ic,Bc,!0,!0,!0)}headerInsertHitAreaHoveredCallback(nb,ic,Bc,Qc){Qc?(!this.Vt||this.Vt.EG===nb&&this.Vt.isRow===ic&&this.Vt.Eya===Bc||this.headerInsertHitAreaHoveredCallback(this.Vt.EG,this.Vt.isRow,this.Vt.Eya,!1),this.Hoa?this.IRk(nb,ic,Bc):this.Vt={isRow:ic,EG:nb,brd:void 0,Eya:Bc}):(this.Vt&&this.Vt.EG===nb&&this.Vt.isRow===
ic&&this.Vt.Eya===Bc||N.ULS.sendTraceTag(507581473,0,15,"HeaderInsert.headerInsertHitAreaHoveredCallback: Got unset hover event for a hit region that was not previously hovered."),this.Hoa?this.LSd():this.Vt=void 0);!this.Hoa&&this.isHeaderInsertAllowed(nb,ic,Bc)&&(this.m7g(nb,ic,Bc),Qc?this.fWg(nb,ic,Bc):this.uTf(ic))}headerInsertButtonInvokedCallback(nb,ic,Bc){1!==this.da.ha.Hk&&this.da.J8();if(this.HWf){var Qc=Bc;let Xd=this.lob(nb,ic,Bc);if(!Xd){var pd=-1;this.Vt.isRow===ic&&this.Vt.EG===nb?pd=
this.Vt.brd:N.ULS.sendTraceTag(507355294,0,15,"HeaderInsert.headerInsertButtonInvokedCallback: hoveredHitRegion should be set to the current cell at this point.");if(pd=this.lob(pd,ic,!Bc))Qc=!Bc,Xd=pd}null!==Xd&&void 0!==Xd?Xd:Xd=ic?$a.Range.$U(nb,nb):$a.Range.mY(nb,nb);this.da.$.oi(Qc?ic?-1113896058:1415868706:ic?75170472:-612877076,2,32,{[zb.a.H7a]:[Xd],["skipTableIntersectionChecks"]:!0})}else nb=(Qc=this.DLa(nb,ic))?[Qc]:[ic?$a.Range.$U(nb,nb):$a.Range.mY(nb,nb)],this.da.$.oi(Bc?ic?-1113896058:
1415868706:ic?75170472:-612877076,2,32,{[zb.a.H7a]:nb})}nEc(nb){var ic,Bc;nb=this.Wqf?nb.filter(Qc=>Qc.isRow!==Qc.hk):nb.filter(Qc=>Qc.isRow||Qc.hk);if(0!==this.selectedRanges.length||0!==nb.length)this.Ebc(this.selectedRanges,!1),this.selectedRanges=nb,this.Ebc(this.selectedRanges,!0),this.Rr&&this.Tya(this.Rr.isRow)&&this.iAb(this.Rr.Uu,this.Rr.EG,this.Rr.isRow,!0,!0,!0),this.Hoa||!this.Vt||this.Vt.isRow===(null===(ic=this.Rr)||void 0===ic?void 0:ic.isRow)&&this.Vt.EG===(null===(Bc=this.Rr)||void 0===
Bc?void 0:Bc.EG)||!this.Tya(this.Vt.isRow)||this.m7g(this.Vt.EG,this.Vt.isRow,this.Vt.Eya)}h4i(nb){nb?this.HQf():this.GQf()}IQf(nb){nb?this.HQf():this.GQf()}fWg(nb,ic,Bc){Bc||nb++;Bc=ic?$a.Range.$U(nb,nb):$a.Range.mY(nb,nb);ic=ic?sf.RWf:sf.JWf;this.da.Fh.wt(Bc,ic,!1);this.da.Fh.Qw(ic,void 0,void 0,fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8741722_HeaderInsertHighlightLag")?!0:void 0)}uTf(nb){this.da.Fh.fr(nb?sf.RWf:sf.JWf,fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8741722_HeaderInsertHighlightLag")?
!0:void 0)}Tya(nb){var ic;if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8740942_DisableHeaderInsertEditing")){if(this.A6&&this.XXd||!this.$.fa.isEditMode||this.da.isEditing)return!1;null!==(ic=this.fE)&&void 0!==ic?ic:this.fE=new Ja.a(this.$.sa);return!this.fE.Sj(nb?64:32)||this.$.vh.UE?!1:!0}this.fE||(this.fE=new Ja.a(this.$.sa));return this.fE.Sj(nb?64:32)&&this.$.fa.isEditMode&&!this.$.vh.UE}u4c(){0!==this.selectedRanges.length&&this.Ebc(this.selectedRanges,!0);this.LSd();if(this.Rr){const nb=
this.Rr;this.Rr=void 0;this.iAb(nb.Uu,nb.EG,nb.isRow,!0,!0,this.Tya(nb.isRow))}}DIc(nb,ic,Bc,Qc){if(!Bc&&nb===(ic?uc.a.Ok:uc.a.Ak))return!1;if(ic?this.da.fh.xUb:this.da.fh.HEc){const pd=ic?this.da.fh.Im:this.da.fh.en;if(Bc&&pd===nb||!Bc&&(nb=null!==Qc&&void 0!==Qc?Qc:this.LRb(nb,ic,!0),sf.NKc(nb,ic)&&pd===nb))return!1}return!0}Ebc(nb,ic){nb.forEach(Bc=>{const Qc=Bc.isRow;if(this.Tya(Qc)){var pd=Qc?Bc.top:Bc.left,Xd=this.Lkb(Qc,pd);this.C7a&&ic&&!this.DIc(pd,Qc,!0)||this.uxb(Xd,pd,!0,ic?0:void 0);
Bc=Qc?Bc.bottom:Bc.right;pd=Bc===pd?Xd:this.Lkb(Qc,Bc);this.C7a&&ic&&!this.DIc(Bc,Qc,!1)||this.uxb(pd,Bc,!1,ic?0:void 0)}})}iAb(nb,ic,Bc,Qc,pd,Xd){Qc&&this.uxb(nb,ic,!0,this.tNd(ic,Bc,!0,Xd));pd&&this.uxb(nb,ic,!1,this.tNd(ic,Bc,!1,Xd))}YOk(nb,ic,Bc,Qc){if(!Qc)return!1;Qc=this.C7a?this.LRb(nb,ic,!Bc):void 0;if(this.C7a&&!this.DIc(nb,ic,Bc,Qc))return!1;const pd=!!this.DLa(nb,ic);return!pd&&this.Rr&&this.Rr.isRow===ic&&this.Rr.EG===nb||this.lob(nb,ic,Bc)||!pd&&(this.C7a?(this.j5b?sf.NKc(Qc,ic):Qc!==
nb)&&this.DLa(Qc,ic):this.ZXf(nb,ic,!Bc))?!0:!1}WOk(nb,ic,Bc,Qc){return this.Tya(ic)&&(!this.C7a||this.DIc(nb,ic,Bc,Qc))&&(!this.DLa(nb,ic)||!!this.lob(nb,ic,Bc))}IRk(nb,ic,Bc){const Qc=this.LRb(nb,ic,!Bc);this.WOk(nb,ic,Bc,Qc)&&(this.uxb(this.Lkb(ic,nb),nb,Bc,1),this.fWg(nb,ic,Bc),this.Vt={isRow:ic,EG:nb,brd:Qc,Eya:Bc})}LSd(){if(this.Vt){var nb=this.Vt.isRow,ic=this.Vt.EG,Bc=this.Vt.Eya;this.Vt=void 0;this.uxb(this.Lkb(nb,ic),ic,Bc,this.tNd(ic,nb,Bc,this.Tya(nb)));this.uTf(nb)}}m7g(nb,ic,Bc){var Qc,
pd,Xd;const ue=nb===(null===(Qc=this.Rr)||void 0===Qc?void 0:Qc.EG)&&ic===(null===(pd=this.Rr)||void 0===pd?void 0:pd.isRow)?null===(Xd=this.Rr)||void 0===Xd?void 0:Xd.Uu:this.Lkb(ic,nb);ue&&this.iAb(ue,nb,ic,Bc,!Bc,!0)}Lkb(nb,ic){if(this.Hoa&&this.Rr&&this.Rr.isRow===nb&&this.Rr.EG===ic)return this.Rr.Uu;nb=nb?this.da.Rce:this.da.w3b;for(const Bc of nb)if(nb=Bc.yxi(ic))return nb}tNd(nb,ic,Bc,Qc){const pd=!!this.DLa(nb,ic),Xd=!!this.lob(nb,ic,Bc);if(this.Vt&&this.Vt.EG===nb&&this.Vt.isRow===ic&&this.Vt.Eya===
Bc&&(this.Hoa||!pd||Xd))return 1;if(this.Hoa){if(this.YOk(nb,ic,Bc,Qc))return 0}else if(this.Rr&&this.Rr.isRow===ic&&this.Rr.EG===nb&&!pd||Xd||!pd&&this.ZXf(nb,ic,!Bc))return 0}uxb(nb,ic,Bc,Qc){var pd;if(nb&&!nb.rRg(ic,Bc,Qc)){const Xd=this.LRb(ic,nb.isRow,!Bc);if(this.j5b?sf.NKc(Xd,nb.isRow):Xd!==ic)null===(pd=this.Lkb(nb.isRow,Xd))||void 0===pd?void 0:pd.rRg(Xd,!Bc,Qc)}}DLa(nb,ic){var Bc;return null===(Bc=this.selectedRanges)||void 0===Bc?void 0:Bc.find(Qc=>ic?Qc.isRow&&Qc.l_d(nb):Qc.hk&&Qc.O1a(nb))}lob(nb,
ic,Bc){return this.selectedRanges.find(Qc=>ic?Qc.isRow&&(Bc?Qc.top===nb:Qc.bottom===nb):Qc.hk&&(Bc?Qc.left===nb:Qc.right===nb))}ZXf(nb,ic,Bc){Bc=this.LRb(nb,ic,Bc);return(this.j5b?sf.NKc(Bc,ic):Bc!==nb)?!!this.DLa(Bc,ic):!1}LRb(nb,ic,Bc){const Qc=this.da.jj;if(this.j5b)return Qc.m1(Bc?nb+1:nb-1,ic,Bc);if(ic)return nb=kd.a.yi(nb,1),Bc?Qc.h_a(nb).top:Qc.IRb(nb).top;nb=kd.a.yi(1,nb);return Bc?Qc.X_a(nb).left:Qc.SSb(nb).left}static NKc(nb,ic){ic=ic?uc.a.Ok:uc.a.Ak;return 0<nb&&nb<=ic}};tc.RWf=[70,72];
tc.JWf=[71,73];tc=sf=Object(J.__decorate)([Object(Sa.d)(jb.ld),Object(J.__param)(0,Object(jb.kd)()),Object(J.__param)(1,Object(jb.Ob)())],tc);Object(H.a)(tc,"HeaderInsert",null,[]);class ld{constructor(nb,ic){this.selectedRanges=null;this.fRemoveOriginRef=!1;this.selectedRanges=nb;this.fRemoveOriginRef=ic}}Object(H.a)(ld,"MacroRecorderImageInCellConvertToFloatingObjectPayload",null,[149]);var Ed=a(170),ze=a(102);let ge=class{constructor(nb,ic,Bc){this.pRj=Qc=>{let pd;!Qc||La.a.ll(Qc.Errors)||rc.a.Km(pd=
Qc.Result)?Qc&&La.a.ll(Qc.Errors)&&N.ULS.sendTraceTag(509142304,0,50,`ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded with errors. Errors: ${La.a.fi(Qc.Errors)}`):(N.ULS.sendTraceTag(509142305,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded"),Ed.a(this.$).y6a(3),ze.a(this.$).IPa(1,pd))};this.oRj=()=>{N.ULS.sendTraceTag(509142303,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oFailed: operation failed")};this.$=
nb;this.da=Ka.f(this.$);this.VVh=ic;this.dzi=Bc;this.YYb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1);this.MWb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateReferenceFloatingInCellImages",!1);this.djj=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CellImagesOnObjectUI",!1)}Ri(){return!1}executeCommand(nb,ic){Ha.TaskExtensions.Yq();nb=X.t(this.da.ha.pa.selectedRanges,this.$);const Bc=ic.command;switch(Bc){case 2000316912:ic=
this.pkf(nb,!0,ic);break;case 1983877126:ic=this.pkf(nb,!1,ic);break;case -1125542248:ic=this.popInCellImageToFloatingFromOnObjectUI();break;case 457756232:ic=this.Uck();break;default:return ja.a(Bc)}return ic||cb.Task.Ua(!0)}Ei(nb,ic){nb=!1;switch(ic.command){case 457756232:case -1125542248:nb=this.$.isEditMode&&this.YYb&&this.MWb&&this.djj;break;case 2000316912:case 1983877126:nb=this.$.isEditMode&&this.YYb&&this.MWb}return nb}dj(){return!1}popInCellImageToFloatingFromOnObjectUI(){if(!this.$.wy(null,
!1))return cb.Task.Ua(!0);this.VVh.Hnd();return cb.Task.Ua(!0)}Uck(){if(!(new Ja.a(this.$.sa)).Sj(1))return cb.Task.Ua(!0);this.dzi.Hnd();return cb.Task.Ua(!0)}pkf(nb,ic,Bc){if(!this.$.wy(null,!1))return cb.Task.Ua(!0);const Qc=()=>new ld(nb,ic);return ia.a(this.$.userOperationManager,(pd,Xd,ue)=>{var Ie=this.$.oa.ta;pd=ta.c(pd,this.pRj);Xd=ta.b(Xd,this.oRj);const Je=Ie.Za(41,null);Je.selectedRanges=nb;Je.fRemoveOriginRef=ic;return ba.h(Ie,"ConvertToFloatingE2o",Je,pd,Xd,ue,null,0)},pd=>new Ma.a(268,
0,pd,void 0,Qc),Bc)}};ge=Object(J.__decorate)([Object(Sa.d)(jb.ud),Object(J.__param)(0,Object(jb.Ob)()),Object(J.__param)(1,Object(jb.P)()),Object(J.__param)(2,Object(jb.vc)())],ge);Object(H.a)(ge,"ImageInCellCommandHandler",null,[36]);var Ne=a(924),Ge=a(925);class ca{constructor(nb,ic,Bc,Qc){this.$=nb;this.Tz=ic;this.H$a=Bc;this.Mhb=Qc}showTaskPane(nb,ic,Bc,Qc,pd,Xd,ue,Ie){Ld.a.xp()?void Sa.a.resolve(jb.lf,{va:0}).then(Je=>Je.ZH("NameManagerTaskPane",this.qr(nb,ic,Bc,Qc,pd,void 0,Xd,ue,Ie))):Xb.a.fo().then(Je=>
{Je.showTaskPane("NameManagerTaskPane",this.qr(nb,ic,Bc,Qc,pd,void 0,Xd,ue,Ie));return null}).catch(()=>{throw Error("showTaskPane: Error while opening task pane");})}updateTaskPane(nb,ic,Bc,Qc,pd,Xd,ue,Ie,Je){Ld.a.xp()?void Sa.a.resolve(jb.lf,{va:0}).then(He=>He.updateTaskPane("NameManagerTaskPane",this.qr(nb,ic,Bc,Qc,pd,Xd,ue,Ie,Je))):Xb.a.fo().then(He=>{He.updateTaskPane("NameManagerTaskPane",this.qr(nb,ic,Bc,Qc,pd,Xd,ue,Ie,Je));return null}).catch(()=>{throw Error("updateTaskPane: Error while opening task pane");
})}hideTaskPane(){Ld.a.xp()?void Sa.a.resolve(jb.lf,{va:0}).then(nb=>nb.hideTaskPane("NameManagerTaskPane")):Xb.a.fo().then(nb=>{nb.hideTaskPane("NameManagerTaskPane",2);return null}).catch(()=>{throw Error("hideTaskPane: Error while hiding task pane");})}QX(){this.E0g&&this.E0g()}getTitle(nb,ic){switch(nb){case 1:return Aa.a.instance.Aa(ic?1003:902);case 0:case 2:return Aa.a.instance.Aa(901);default:return""}}qr(nb,ic,Bc,Qc,pd,Xd,ue,Ie,Je){Bc={type:"NameManagerTaskPaneProps",activePage:nb,showLoader:ue,
rangePickerController:Ka.f(this.$).ho.R_a(),callbacks:Bc,items:ic,errors:Ie,updateView:Qc,toast:pd,filterCountMap:Je};return Object.assign(new Kb.a,{id:"NameManagerTaskPane",title:this.getTitle(nb,this.Vob(ic)),actionButtonProps:Xd,contentProps:Bc,width:320,onOpen:()=>{this.Tz()},onClose:()=>{this.H$a()},preventCloseCallback:He=>{this.E0g=He;fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8720866_XLONameManagerApplyChangesToast")?1===nb?this.Mhb(ic):He():He()}})}Vob(nb){return nb&&null===nb[0]?!0:!1}}
Object(H.a)(ca,"NameManagerTaskPane",null,[552]);class sb{constructor(nb,ic){this.c2g=0;this.wXc=[];this.searchText="";this.Tz=()=>{this.DK.e6e(this.Hpf);this.DK.gGh(this.G6g);this.DK.bDh(this.xvc);this.DK.vz();this.$.Pp(this.bOa)};this.callbacks={onItemClick:Bc=>{this.B4i(Bc)},onItemSave:(Bc,Qc,pd,Xd,ue)=>{this.QQf(Bc,Qc,pd,Xd,ue)},onItemsDelete:Bc=>{Bc&&(this.wXc=Bc,this.DK.xvc(Bc))},onSearch:(Bc,Qc)=>{this.searchText=Bc;this.Toc=Qc;if(fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",
!1)){N.ULS.sendTraceTag(507610080,Ne.a.mNa,Ge.a.info,Nb.a.Di({isSearching:""!==Bc,sortBy:Qc.sortBy,sortOrder:Qc.sortOrder,filterBy:Qc.filterBy}));const pd=Gb.filterBy(this.items,Qc.filterBy);Bc=Gb.search(pd,Bc);Qc=Gb.$Qd(Bc,Qc.sortBy,Qc.sortOrder);this.o9(0,void 0,Qc)}else N.ULS.sendTraceTag(507581340,Ne.a.mNa,Ge.a.info,"NameManagerTaskPaneController.callbacks Search functionality is used"),Qc=Gb.search(this.items,Bc),this.o9(0,void 0,Qc)},onCloseButtonClick:(Bc,Qc,pd,Xd,ue)=>{Gb.Z7i(Bc,Qc,pd,Xd,
this.getDefinedNames())?(this.J6b={name:Bc,reference:Qc,comment:pd,type:ue,runtimeUid:Xd,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""},this.toast=this.uDc(Aa.a.instance.Aa(915),Aa.a.instance.Aa(916),()=>{this.QQf(Bc,Qc,pd,Xd,ue)},!0,()=>{this.Zrb.QX()}),this.o9(1,this.ogb(),[this.J6b],null)):this.Zrb.QX()}};this.updateView=(Bc,Qc)=>{switch(Bc){case 1:case 3:this.o9(Bc,this.ogb(),[Qc]);break;case 0:this.o9(Bc,void 0);break;default:this.o9(Bc,this.ogb())}};this.ogb=
()=>({label:Aa.a.instance.Aa(903),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateView(0)},onTabKeyDown:()=>{}});this.Hpf=(Bc,Qc)=>{this.e2h();(null===Qc||void 0===Qc?0:Qc.loj)?this.x6i():this.updateView(this.items?0:4)};this.G6g=(Bc,Qc)=>{let pd;Bc=null===Qc||void 0===Qc?void 0:Qc.status;!Bc&&(pd=Gb.iMi(Qc),null===pd||void 0===pd?0:pd.Kac)&&(this.toast=this.uDc(pd.Kac,null,null));Bc?this.o9(0,null,this.getDefinedNames(),null===pd||void 0===pd?void 0:pd.dfg):this.o9(1,this.ogb(),
[this.J6b],null===pd||void 0===pd?void 0:pd.dfg)};this.xvc=(Bc,Qc)=>{(null===Qc||void 0===Qc?0:Qc.status)&&this.items&&(this.items=this.items.filter(pd=>!this.wXc.includes(pd.runtimeUid)));this.toast=(null===Qc||void 0===Qc?0:Qc.status)?this.i_i(Qc):this.h_i(Qc);this.o9(0,null,this.items,null)};this.bOa=(Bc,Qc)=>{!Qc.$l&&this.Zrb&&this.Zrb.hideTaskPane()};this.H$a=()=>{this.DK.Vpk(this.Hpf);this.DK.Uqk(this.G6g);this.DK.iok(this.xvc);this.DK.SB();this.$.wu(this.bOa)};this.Mhb=Bc=>{this.o9(3,this.ogb(),
Bc)};this.$=nb;this.DK=ic;this.da=Ka.f(nb);this.Zrb=new ca(nb,this.Tz,this.H$a,this.Mhb)}cSk(){this.c2g=0;this.toast={sequenceNumber:0,message:"",actionButtonText:"",onActionButtonClick:null,autoHide:!1,onCloseButtonClick:null,allowDismiss:!1};this.Toc={filterBy:void 0,sortOrder:0,sortBy:0};this.Zrb.showTaskPane(0,this.getDefinedNames(),this.callbacks,this.updateView,this.toast,!0,void 0,this.filterCountMap);this.DK.$de(!1)}o9(nb,ic,Bc,Qc){this.Mbi=nb;this.Zrb.updateTaskPane(nb,Bc||this.getDefinedNames(),
this.callbacks,this.updateView,this.toast,ic,!1,Qc,this.filterCountMap);this.J6b=null}B4i(nb){if(nb=Gb.MKi(this.items,nb)){nb=X.kb(nb.reference.slice(1),this.$.listSeparator,this.$.sa);const ic=Ka.f(this.$).ha;this.da.q1(nb&&nb.d8&&nb.sheetName?nb.d8:[ic.pa.Haa],fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8756334_NameManagerSelectionUpdateAfterDiscontinuousSelection")?0:ic.pa.Ly,nb.sheetName,null,null,null,null,3,"NameManager.SelectNamedRange",null,null,null,!0)}}x6i(){switch(this.Mbi){case 0:if(this.items)if(fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",
!1)){var nb=Gb.filterBy(this.items,this.Toc.filterBy);nb=Gb.search(nb,this.searchText);nb=Gb.$Qd(nb,this.Toc.sortBy,this.Toc.sortOrder);this.o9(0,void 0,nb)}else nb=Gb.search(this.items,this.searchText),this.o9(0,void 0,nb);else this.updateView(4);break;case 4:this.updateView(this.items?0:4);break;case 2:this.updateView(this.items?2:4)}}e2h(){this.items=this.DK.getItems(nb=>nb&&nb.metadata&&nb.metadata.isVisibleToNameManager);0!==this.items.length&&(this.items=Gb.$Qd(this.items,0,0),fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",
!1)&&(this.filterCountMap=Gb.K4h(this.items)))}h_i(nb){return nb&&!nb.status&&nb.gxb?Gb.l_c(nb.gxb)?this.uDc(Gb.XGf("delete"),null,null):null:null}i_i(nb){var ic,Bc;if(!nb||!nb.status||nb.gxb)return null;nb=1===(null===(ic=this.wXc)||void 0===ic?void 0:ic.length)?Aa.a.instance.Aa(908):String.format(Aa.a.instance.Aa(909),null===(Bc=this.wXc)||void 0===Bc?void 0:Bc.length);return this.uDc(nb,Aa.a.instance.Aa(904),()=>{this.$.oi(-1502853784,E.a.ph,12,null)})}getDefinedNames(){return this.items}uDc(nb,
ic,Bc,Qc,pd){return nb?{sequenceNumber:++this.c2g,message:nb,actionButtonText:ic,onActionButtonClick:Bc,autoHide:void 0===Qc?!0:Qc,onCloseButtonClick:void 0===pd?null:pd,allowDismiss:!0}:null}QQf(nb,ic,Bc,Qc,pd){const Xd=Gb.cfl(this.DK.L0d,nb,ic,Bc,pd);this.J6b={name:nb,reference:ic,comment:Bc,type:pd,runtimeUid:Qc,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""};0!==Xd.length?this.o9(1,this.ogb(),[this.J6b],Xd):this.DK.upsertDefinedName(nb,ic,Bc,Qc,Uc.a[pd])}}Object(H.a)(sb,
"NameManagerTaskPaneController",null,[]);let Ba=class{constructor(nb,ic){this.wea=null;this.$=nb;this.DK=ic}Ri(){return!1}get bSc(){this.wea||(this.wea=new sb(this.$,this.DK));return this.wea}executeCommand(nb,ic){nb=!1;ic=ic.command;switch(ic){case 1910465940:this.bSc.cSk(),nb=!0}return nb?cb.Task.Ua(!0):ja.a(ic)}Ei(nb,ic){switch(ic.command){case 1910465940:return!0;default:return!1}}dj(){return!1}};Ba=Object(J.__decorate)([Object(Sa.d)(jb.Yd),Object(J.__param)(0,Object(jb.Ob)()),Object(J.__param)(1,
Object(jb.Ab)())],Ba);Object(H.a)(Ba,"NameManagerCommandHandler",null,[36]);var V=a(190);class Fa extends V.a{constructor(){super();this.CD=()=>{this.hide()}}showDialog(nb,ic){try{this.fl="OfficePyBlockPythonEditDialog",this.Oh=0,this.show({["type"]:"StandardDialogProps",["id"]:this.fl,["headerText"]:nb,["resultHandler"]:this.CD,["titleText"]:ic})}catch(Bc){this.O6c(nb,ic)}}O6c(nb){const ic=new db.a(!1,!1,!1);ic.Oh=0;ic.fl="OfficePyBlockPythonEditLegacyDialog";ic.initializeAndShow(nb,this.Veh,null)}Veh(){this.hide()}}
Object(H.a)(Fa,"OfficePyBlockPythonEditDialog",V.a,[]);let sc=class{constructor(nb){this.$=nb}Ri(){return!1}executeCommand(nb,ic){nb=!1;ic=ic.command;switch(ic){case 883532127:(new Fa).showDialog("Python is not supported in Excel for the web","Excel for the web does not support calculating or interacting with Python formulas. To use Python formulas, open this file with the desktop app for Windows."),nb=!0}return nb?cb.Task.Ua(!0):ja.a(ic)}Ei(nb,ic){switch(ic.command){case 883532127:return fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficePyUX",
!1);default:return!1}}dj(){return!1}};sc=Object(J.__decorate)([Object(Sa.d)(jb.pe),Object(J.__param)(0,Object(jb.Ob)())],sc);Object(H.a)(sc,"OfficePyUXCommandHandler",null,[36]);var Kc=a(9),qd=a(934);class Eb extends qd.a{constructor(nb){super(nb)}sw(){const nb=Object(bb.d)(Sa.a.resolve(jb.Tf,{va:this.gi})),ic=Object(bb.d)(Sa.a.resolve(jb.id,{va:this.gi}));Ha.TaskExtensions.$e(nb,Bc=>{Bc=Bc.result;const Qc=Ka.f(this.$);this.Zt([new If(this.$,Bc,Qc,ic.result)])},this.$.ya)}static Ga(nb){nb.qa.Rh(116,
new Eb(nb))}}Object(H.a)(Eb,"FreezePanesCommandHandlerFactory",qd.a,[]);var vc=a(432),Kd=a(939);class Zd extends vc.a{constructor(nb){super();this.$=nb;this.sn()}create(){Ld.a.Xk()?void Sa.a.uj(jb.yc).then(nb=>{this.dl(Object(Kd.a)(this.$.qa,502,()=>new jd(this.$,nb)))}):this.dl(Object(Kd.a)(this.$.qa,502,()=>new jd(this.$,null)))}static Ga(nb){nb.qa.Rh(503,new Zd(nb))}}Object(H.a)(Zd,"FontDropdownHelperFactory",vc.a,[]);(()=>{Kc.a.hh(nb=>{jb.Wc.Ma()||Eb.Ga(nb)})})();(()=>{Kc.a.hh(nb=>{jb.xc.Ma()||
Zd.Ga(nb)})})();String(k);String(d);String(u);String(n);String(v);String(f);String(w);String(r);String(t);String(l);String(x);String(A);String(z);String(F);String(D);String(G);String(Q);String(O);window.___1712031311674_closurehack=k;window.___1712031311674_closurehack=d;window.___1712031311674_closurehack=u;window.___1712031311674_closurehack=n;window.___1712031311674_closurehack=v;window.___1712031311674_closurehack=f;window.___1712031311674_closurehack=w;window.___1712031311674_closurehack=r;window.___1712031311674_closurehack=
t;window.___1712031311674_closurehack=l;window.___1712031311674_closurehack=x;window.___1712031311674_closurehack=A;window.___1712031311674_closurehack=z;window.___1712031311674_closurehack=F;window.___1712031311674_closurehack=D;window.___1712031311674_closurehack=G;window.___1712031311674_closurehack=Q;window.___1712031311674_closurehack=O}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kpae.js.map/432b040dcac7ad0889aa4bd0e00bb315/EwaTS.kpae.js.map