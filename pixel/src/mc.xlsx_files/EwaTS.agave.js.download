'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1003:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{constructor(b,e,k,d){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=k;this.ArrayData=void 0===d?null:d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(y.a)(c,"DdaEventArgs",null,[])},1048:function(y,m,a){a.d(m,"a",function(){return b});y=a(0);
class c{constructor(){this.title=this.id=this.tabs=null}}Object(y.a)(c,"AddInDataTransferObject",null,[]);class b{constructor(e,k,d){this.Gdc=e;this.Yhh=k;this.Zhh=d}get nC(){return this.Gdc}get Bzh(){return this.Yhh}get Czh(){return this.Zhh}static zRb(e){return(e=e.N7)?Object.assign(new c,{tabs:e.nC.toArray(),id:e.Bzh,title:e.Czh}):null}}Object(y.a)(b,"OneLineRibbonExtensibility",null,[])},1066:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);var c;(function(b){b[b.OK=0]="OK";b[b.Fvl=1]="notReady";
b[b.kxl=2]="storeDisabled";b[b.jpl=3]="invokeFailure";b[b.Rwl=4]="serviceDisabled";b[b.lnl=5]="builtinAddinDetails"})(c||(c={}));Object(y.b)("AddinDetailsQueryError",c)},1068:function(y,m,a){a.d(m,"a",function(){return c});a.d(m,"b",function(){return b});const c=e=>{let k=null;switch(e){case 0:k="omex";break;case 1:k="spcatalog";break;case 2:k="spapp";break;case 3:k="filesystem";break;case 4:k="exchange";break;case 6:k="registry";break;case 7:k="inmemory";break;case 8:k="uploadfiledevcatalog";break;
case 9:k="hardcodedpreinstall";break;case 10:k="excatalog";break;case 16:k="wopicatalog"}return k},b=e=>{let k=-1;switch(e.toLowerCase()){case "omex":k=0;break;case "spcatalog":k=1;break;case "spapp":k=2;break;case "filesystem":k=3;break;case "exchange":k=4;break;case "registry":k=6;break;case "inmemory":k=7;break;case "uploadfiledevcatalog":k=8;break;case "hardcodedpreinstall":k=9;break;case "excatalog":k=10;break;case "wopicatalog":k=16}return k}},1069:function(y,m,a){a.d(m,"a",function(){return e});
var c=a(6),b=a(60);const e=(k,d)=>b.a.y3d(66,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,c.AFrameworkApplication.ea.Ij("MaxRetriesForLoadingScript",0),k,d)},1130:function(y,m,a){m=a(492);a=a(1482);a=a.$q?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1133:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);var c;(function(b){b[b.cKj=0]="myAddins";b[b.pHh=1]="adminManaged";b[b.jwl=2]="popular"})(c||(c={}));Object(y.b)("AddinCollectionType",
c)},1134:function(y,m,a){a.d(m,"a",function(){return b});y=a(0);var c=a(12);class b{constructor(){this.Uyf={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.Syf={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ia(1633),c.a.instance.ia(1637)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ia(1634),c.a.instance.ia(1638)],["tabdeveloper"]:["Ribbon.Developer",c.a.instance.ia(1635),c.a.instance.ia(1639)],
["tabaddins"]:["Ribbon.AddIns",c.a.instance.ia(1636),c.a.instance.ia(1640)]};this.lyc=null}get Fva(){return"SourceControlId"}get yY(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}cRi(){if(!this.lyc){this.lyc={};for(const e of Object.keys(this.Uyf))this.lyc[e]=this.Uyf[e];for(const e of Object.keys(this.Syf))this.lyc[e]=this.Syf[e][0]}}}Object(y.a)(b,"AddinCommandsStringProvider",null,[279])},1136:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{constructor(){this.a1a=
0;this.eva=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.cFc=!1;this.SUf=this.dwa=null}}Object(y.a)(c,"AddInCommandsNotificationParameters",null,[])},1138:function(y,m,a){a.d(m,"a",function(){return c});const c=b=>b.qa.zh(34)},1183:function(y,m,a){a.d(m,"a",function(){return N});y=a(0);var c=a(1276),b=a(15),e=a(144),k=a(171),d=a(17),u=a(491),n=a(24);class v extends Sys.UI.Control{constructor(L,Z,ba,K){super(document.createElement("div"));this.G3=this.D3=this.vF=this.KSa=
this.iR=this.QDa=this.sFa=null;this.XDb=this.CEa=!1;this.content=this.oy=null;this.Mda=0;this.Raf=null;this.S4=0;this.Rrg=null;this.QX=()=>{this.dismiss();return!0};this.U_e=L;this.RVe=Z;this.N_=ba;this.tK=K;this.nn=Z.ownerDocument;this.FEc=this.xB=this.rEb=!1}get Q7(){this.sFa||(this.sFa=this.nn.createElement("div"),this.sFa.id=this.hp("WACCalloutOuter"),this.sFa.className="WACCalloutOuter",this.sFa.setAttribute(u.a.fk,u.a.mWa),this.sFa.style.width=this.Mda+"px");return this.sFa}get tKb(){if(!this.QDa){this.QDa=
this.nn.createElement("div");this.QDa.id=this.hp("WACCalloutBeakContainer");this.QDa.className="WACCalloutBeakContainer";var L="CalloutBeakTopFilled_32x16x32";if(5===this.S4||6===this.S4||4===this.S4)L="CalloutBeakBottomFilled_32x16x32";L=k.a(32,16,L,"WACCalloutBeak",!0,"");this.QDa.appendChild(L)}return this.QDa}set tKb(L){this.QDa=L}get W1a(){return this.rEb}get title(){return this.oy}set title(L){this.oy!==L&&(this.oy=L,this.D3&&(this.D3.innerText=this.oy))}get xB(){return this.CEa}set xB(L){this.CEa!==
L&&(this.CEa=L,this.iR&&(this.iR.contains(this.vF)&&!this.CEa?this.iR.removeChild(this.vF):!this.iR.contains(this.vF)&&this.CEa&&this.s3e()))}get FEc(){return this.XDb}set FEc(L){this.XDb!==L&&(this.XDb=L,this.iR&&(this.iR.contains(this.D3)&&!this.XDb?this.iR.removeChild(this.D3):!this.iR.contains(this.D3)&&this.XDb&&this.K4e()))}show(){this.rEb||(this.$6h(),this.Iu(),this.RVe.appendChild(this.Q7),this.Q7.style.display="Block",this.RIk(),this.rEb=!0,this.Rrg&&this.Rrg())}dismiss(){this.rEb&&(this.Yfa(),
this.RVe.removeChild(this.Q7),this.rEb=!1,this.tK&&this.tK())}dispose(){this.dismiss();this.D3=this.vF=this.KSa=this.QDa=this.iR=this.sFa=null;Sys.Component.prototype.dispose.call(this)}hp(L){return this.get_element().id+L}$6h(){this.iR=this.nn.createElement("div");this.iR.id=this.hp("WACCalloutHeader");this.iR.className="WACCalloutHeader";this.xB&&this.s3e();this.FEc&&this.K4e();this.KSa=this.nn.createElement("div");this.KSa.id=this.hp("WACCalloutContent");this.KSa.className="WACCalloutContent";
this.KSa.style.width=190<this.Mda?this.Mda-26+"px":"164px";this.KSa.appendChild(this.content);this.Q7.appendChild(this.tKb);this.Q7.appendChild(this.iR);this.Q7.appendChild(this.KSa)}s3e(){this.vF=this.nn.createElement("a");this.vF.className="WACCalloutCloseAnchor";this.vF.id=this.hp("WACCalloutCloseAnchor");this.vF.href="#";this.iR.appendChild(this.vF);const L=k.a(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,Object(n.a)("DialogClose"));this.vF.appendChild(L)}K4e(){this.D3=this.nn.createElement("div");
this.D3.className="WACCalloutTitle UIFontBold";this.D3.style.width=190<this.Mda?this.Mda-30+"px":"160px";this.D3.id=this.hp("WACCalloutTitle");this.D3.innerText=this.title;this.iR.contains(this.vF)?this.iR.insertBefore(this.D3,this.vF):this.iR.appendChild(this.D3)}RIk(){var L=this.U_e;let Z;if(1===this.S4){var ba=this.Raf.y+16;Z=-16}else 2===this.S4||3===this.S4||0===this.S4?(ba=L.y+L.height+15,Z=-15):(ba=L.y-this.Q7.clientHeight-15-2,Z=this.Q7.clientHeight-1);this.Q7.style.top=ba+"px";this.tKb.style.top=
Z+"px";1===this.S4?(L=this.Raf.x-16,this.Q7.style.left="50%",this.Q7.style.marginLeft=-this.Mda/2+"px",ba=Sys.UI.DomElement.getBounds(this.Q7),this.tKb.style.left=L-ba.x+"px"):(ba=L.x+this.U_e.width/2,2===this.S4||5===this.S4?(L=20,ba-=36):0===this.S4||4===this.S4?(L=this.Mda/2-16,ba-=this.Mda/2):(L=this.Mda-20-32,ba=ba-this.Mda+36),this.Q7.style.left=ba+"px",this.tKb.style.left=L+"px")}Iu(){this.xB&&!this.G3&&(this.G3=this.QX,this.N_.xa(d.a.click,this.vF,this.G3,null))}Yfa(){this.xB&&this.G3&&(this.N_.Oa(d.a.click,
this.vF,this.G3),this.G3=null)}}Object(y.a)(v,"Callout",Sys.UI.Control,[361]);class f extends v{constructor(L,Z,ba,K,E,U){super(L,ba,E.e9,void 0===U?null:U);this.UTe=0;this.rj=()=>{this.dismiss();return!0};this.Mda=this.kRi(K);this.peb=Z;this.Pm=E;this.t1k=7;this.Jt=this.peb.ownerDocument.createElement("div");this.Jt.className="ModalCalloutControlOverlay";this.Jt.tabIndex=0;this.peb.insertBefore(this.Jt,this.peb.firstChild)}show(){this.W1a||(this.Pm.eTc(),this.Pm.m0(!1),this.Jt.style.zIndex=String(this.Pm.Oea),
super.show(),this.Kp(),this.UTe=window.setTimeout(Object(e.a)(this,this.dismiss,"dismiss"),1E3*this.t1k))}dismiss(){this.W1a&&(this.Pm.bY(!1),this.xo(),this.peb&&this.peb.contains(this.Jt)&&this.peb.removeChild(this.Jt),super.dismiss(),window.clearTimeout(this.UTe))}Kp(){this.Pm.BGa(Object(e.a)(this,this.dismiss,"dismiss"));this.Pm.IJ.xa(d.a.click,this.Jt,this.rj)}xo(){this.Pm.Mvb(Object(e.a)(this,this.dismiss,"dismiss"));this.Pm.IJ.Oa(d.a.click,this.Jt,this.rj)}kRi(L){let Z=0;switch(L){case 0:Z=
190;break;case 1:Z=250;break;case 2:Z=300;break;case 3:Z=360}return Z}}Object(y.a)(f,"ModalCallout",v,[]);var w=a(540),r=a(184);class t extends f{constructor(L,Z,ba,K,E,U){super(L,Z,ba,K,E,void 0===U?null:U);this.Hic=null}show(){if(!this.W1a){const L=Object.assign(new w.a,{onShow:()=>{f.prototype.show.call(this)}});r.a.IK().then(Z=>{const ba=Z.externalNotification();this.Hic=Z.addNotification(ba,L);return null},Z=>{b.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",Z);return null})}}dismiss(){this.W1a&&
this.Hic&&(r.a.IK().then(L=>{L.removeNotification(this.Hic);return this.Hic=null},L=>{b.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",L);return null}),super.dismiss())}}Object(y.a)(t,"ReactManagedModalCallout",f,[]);var l=a(6);class x{static M8h(L,Z,ba){var K=void 0===K?null:K;return l.AFrameworkApplication.ra.$g.PY?new t(L,Z,ba,3,l.AFrameworkApplication.ra,K):new f(L,Z,ba,3,l.AFrameworkApplication.ra,K)}}Object(y.a)(x,"ModalCalloutControlFactory",null,[]);var A=a(85),
z=a(1131),F=a(689),D=a(1132),G=a(190),Q=a(69),O=a(59),J=a(1048),H=a(929);class N{static get $fb(){return N.C9||(N.C9=Object(c.b)())}static olf(L,Z,ba,K){N.gU&&N.gU.W1a&&N.gU.dismiss();N.gU=x.M8h(Z,L,L);N.gU.content=ba;H.b(K)||(N.gU.title=K,N.gU.FEc=!0);L=new Sys.UI.Bounds(0,0,Q.a.HTb(),Q.a.GTb());N.gU.S4=N.DHi(L,Z,N.gU.Mda);N.gU.show();N.$fb&&N.$fb.LBa(ba.innerText,!0)}static Nzd(L,Z,ba,K){K=void 0===K?null:K;r.a.IK().then(E=>{let U=null;N.qGb&&(E.removeNotification(N.qGb),N.qGb=null);const X=E.callout(Object.assign(new z.a,
{target:L,title:Z,content:ba,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new D.a,{onDismiss:()=>{E.removeNotification(U)},directionalHint:null!=K?K:null})})),ia=Object.assign(new w.a,{expirationOptions:Object.assign(new F.a,{displayTimeoutSeconds:7,onExpire:()=>{E.removeNotification(N.qGb)}})});U=N.qGb=E.addNotification(X,ia);return null},E=>{b.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",E);return null})}static Ote(L,
Z){Z=void 0===Z?null:Z;N.gU&&N.gU.W1a&&N.gU.dismiss();const ba=new G.a;ba.AQa=!1;ba.Oh=0;ba.CL(A.a.Lwj,Object(n.a)("DialogError"),H.b(L)?N.cHf():L,Z)}static Pte(L){N.gU&&N.gU.W1a&&N.gU.dismiss();b.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",L.errorCode));const Z=H.b(L.description)?N.cHf():L.description,ba=new G.a;let K=null;L.eva?(ba.Oh=1,ba.si(1,L.buttonText),ba.jja(1)):ba.Oh=0;K=E=>{1===E?L.eva():L.dwa&&L.dwa()};ba.AQa=!1;0===L.a1a?ba.CL(L.errorCode,
L.title?L.title:Object(n.a)("DialogError"),Z,K):1===L.a1a?ba.xW(L.title?L.title:Object(n.a)("DialogWarning"),Z,K):ba.iCa(L.title?L.title:Object(n.a)("DialogInfo"),Z,K)}static DHi(L,Z,ba){let K=4;const E=L.x+L.width-Z.x-Z.width;Z.x-L.x+Z.width/2<=ba/2?K=5:E+Z.width/2<=ba/2&&(K=6);return K}static sQk(L,Z,ba,K){K=void 0===K?!1:K;(Z=J.a.zRb(Z))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Z,E=>{E&&(K||N.Nzd(E,ba,L,5))})}static tQk(L,
Z,ba){ba=void 0===ba?!1:ba;N.sQk(Z.startedNode?Z.startedNode.description:String.format(Object(n.a)("NewAddInLoadedContent"),L),Z,Z.startedNode?Z.startedNode.title:String.format(Object(n.a)("NewAddInLoadedTitle"),L),ba)}static rQk(L,Z,ba,K){if(N.Z8g)L=String.format(Object(n.a)("ErrorLoadingAddInsContentOuterString"),String.format(Object(n.a)("ErrorLoadingAddInsContentInnerString"),ba,K,Object(n.a)("InsertionDialogRefresh"))),N.Nzd(Z,Object(n.a)("ErrorLoadingAddInsTitle"),L,1);else{Z=O.a.Wv(Z);var E=
Object(n.a)("ErrorLoadingAddInsContentOuterString").split("{0}"),U=document.createElement("span");U.innerText=E[0];var X=document.createElement("span");X.innerText=String.format(Object(n.a)("ErrorLoadingAddInsContentInnerString"),ba,K,Object(n.a)("InsertionDialogRefresh"));X.className="UIFontBold";ba=document.createElement("span");ba.innerText=E[1];K=document.createElement("div");Sys.UI.DomElement.addCssClass(K,"ModalCalloutControl");K.appendChild(U);K.appendChild(X);K.appendChild(ba);N.olf(L,Z,K,
Object(n.a)("ErrorLoadingAddInsTitle"))}}static $Rk(L,Z,ba,K){N.Z8g?N.Nzd(Z,ba,K):(Z=O.a.Wv(Z),N.olf(L,Z,N.ERh(K),ba))}static ERh(L){const Z=document.createElement("div");Sys.UI.DomElement.addCssClass(Z,"ModalCalloutControl");Z.innerText=L;return Z}static cHf(){return Object(n.a)("InternalError")+" "+Object(n.a)("InternalError_Directive")}static get Z8g(){return l.AFrameworkApplication.ra.$g.Tq&&l.AFrameworkApplication.ra.$g.PY}}N.gU=null;N.qGb=null;N.C9=null;Object(y.a)(N,"AddInCommandsNotificationFactory",
null,[])},1184:function(y,m,a){a.r(m);a.d(m,"DynamicRibbon",function(){return l});y=a(0);var c=a(15),b=a(183),e=a(130),k=a(947),d=a(968);class u{constructor(){this.dataFields=this.samplingPolicy=this.name=null}}Object(y.a)(u,"TelemetryEvent",null,[]);class n{constructor(x,A,z,F){this.mv=!1;this._id=x;this.TG=A;this.$da=z;this.Hj=F}get enabled(){return this.mv}set enabled(x){const {DynamicRibbon:A}=a(1184);var z=this.Hj.OwnerAddinStoreType?this.Hj.OwnerAddinStoreType:this.Hj.PrimaryMarketplace.MarketplaceType;
const F=this.Hj.PrimaryMarketplace.MarketplaceRef,D=this.Hj.AssetMarketplace?this.Hj.AssetMarketplace.SolutionId:null,G=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.TG,z,null,null,null,F);z={["addinSolutionId"]:G,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hj.OwnerAddinSolutionId,z,D,null,null,F),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Button",["toggle"]:x};b.a.sendTelemetryEvent(Object.assign(new u,{name:A.g2c+"ControlUpdate",dataFields:e.a.xn(z)}));this.mv=
x;this.$da.kV(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.TG,["PrivacyCompliantSolutionId"]:G,["SourceControlId"]:this.id,["MethodData"]:this.mv})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(x){switch(x){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);}invokePropertyGetAsync(x){x=
this.invokePropertyGet(x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)}invokePropertySet(x,A){switch(x){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(A,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);}invokePropertySetAsync(x,A){this.invokePropertySet(x,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(x,A){switch(x){case 5:return this.uFk(A);case 1:return this.cSa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);
}invokeMethodAsync(x,A){x=this.invokeMethod(x,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)}uFk(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"boolean");this.setEnabled(x);return null}cSa(){this._OnAccess();return null}}Object(y.a)(n,"RibbonButton",null,[]);class v{constructor(x,A,z,F){this._id=x;this.TG=A;this.$da=z;this.Hj=F}get id(){return this._id}setVisibility(x){const {DynamicRibbon:A}=a(1184),z=this.Hj.OwnerAddinStoreType?this.Hj.OwnerAddinStoreType:
this.Hj.PrimaryMarketplace.MarketplaceType;var F=this.Hj.PrimaryMarketplace.MarketplaceRef;const D=this.Hj.AssetMarketplace?this.Hj.AssetMarketplace.SolutionId:null,G=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.TG,z,D,null,null,F);F={["addinSolutionId"]:G,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hj.OwnerAddinSolutionId,z,D,null,null,F),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Tab",["toggle"]:x};b.a.sendTelemetryEvent(Object.assign(new u,{name:A.g2c+
"ControlUpdate",dataFields:e.a.xn(F)}));this.$da.kV(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.TG,["PrivacyCompliantSolutionId"]:G,["StoreType"]:z,["SourceControlId"]:this.id,["MethodData"]:x})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(x){switch(x){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);}invokePropertyGetAsync(x){x=this.invokePropertyGet(x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)}invokePropertySet(x){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);
}invokePropertySetAsync(x,A){this.invokePropertySet(x,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(x,A){switch(x){case 3:return this.BJk(A);case 1:return this.cSa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);}invokeMethodAsync(x,A){x=this.invokeMethod(x,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)}BJk(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"boolean");this.setVisibility(x);
return null}cSa(){this._OnAccess();return null}}Object(y.a)(v,"RibbonTab",null,[]);var f=a(1288),w=a(178),r=a(1627),t;(function(x){x[x.static=0]="static";x[x.dynamic=1]="dynamic"})(t||(t={}));Object(y.b)("RibbonExtensionGenerateType",t);class l{constructor(x,A,z,F,D){this.TG=x;this.Iv=z;this.$da=F;this.Hj=D;this.ACb=this.Iv.Fl;this.zI=this.ACb.getOsfControl(A);this.wqh=this.zI.getManifest()}get buttons(){return null}executeRequestCreate(x){try{var A=this.Hj.OwnerAddinStoreType?this.Hj.OwnerAddinStoreType:
this.Hj.PrimaryMarketplace.MarketplaceType;const F=this.Hj.PrimaryMarketplace.MarketplaceRef,D=this.Hj.AssetMarketplace?this.Hj.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.TG,A,D,null,null,F);const G={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hj.OwnerAddinSolutionId,A,D,null,null,F),["ownerAddinStoreType"]:this.Hj.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};b.a.sendTelemetryEvent(Object.assign(new u,
{name:l.g2c+"ExecuteRequestCreate",dataFields:e.a.xn(G)}));const Q=w.a.Vp(x);x={};A={};A[k.a.YYa]=this.zI;A[k.a.ZYa]=Q;A[k.a.fEd]=this.Hj;x[k.a.tPb]=3;x[k.a.fga]=this.TG;x[k.a.Wwc]=z;x[k.a.ega]=A;this.$da.kV(-1014260128,x);let O=l.nAc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,O)}catch(F){z=l.nAc("ExecuteRequestCreate",!1,F.toString()),c.ULS.sendTraceTag(538572825,0,50,z)}return null}executeRequestUpdate(x){try{var A=this.Hj.OwnerAddinStoreType?this.Hj.OwnerAddinStoreType:this.Hj.PrimaryMarketplace.MarketplaceType;
const F=this.Hj.PrimaryMarketplace.MarketplaceRef,D=this.Hj.AssetMarketplace?this.Hj.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.TG,A,D,null,null,F);const G={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hj.OwnerAddinSolutionId,A,D,null,null,F),["ownerAddinStoreType"]:this.Hj.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};b.a.sendTelemetryEvent(Object.assign(new u,{name:l.g2c+"ExecuteRequestUpdate",
dataFields:e.a.xn(G)}));const Q=w.a.Vp(x);x={};A={};A[k.a.YYa]=this.zI;A[k.a.ZYa]=Q;A[k.a.fEd]=this.Hj;x[k.a.tPb]=3;x[k.a.fga]=this.TG;x[k.a.Wwc]=z;x[k.a.ega]=A;this.$da.kV(-1014260128,x);let O=l.nAc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,O)}catch(F){z=l.nAc("ExecuteRequestUpdate",!1,F.toString()),c.ULS.sendTraceTag(538572823,0,50,z)}return null}getButton(x){let A=null;if(!this.YZf())return this.rlf();if(x&&0<x.length){if(!this.igf(x))return this.Ilf(x);A=new n(x,this.TG,
this.$da,this.Hj)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(A)}getTab(x){let A=null;if(!this.YZf())return this.rlf();if(this.zI.getOwnerAddinControlRecreated())return this.X7h();if(x&&0<x.length){if(!this.igf(x))return this.Ilf(x);A=new v(x,this.TG,this.$da,this.Hj)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(A)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(x){switch(x){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);
}invokePropertyGetAsync(x){x=this.invokePropertyGet(x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)}invokePropertySet(x){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);}invokePropertySetAsync(x,A){this.invokePropertySet(x,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(x){switch(x){case 1:return this.cSa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);}invokeMethodAsync(x,A){switch(x){case 7:return this.lui(A);
case 6:return this.mui(A);case 3:return this.gHi(A);case 5:return this.pZi(A)}x=this.invokeMethod(x,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)}lui(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.executeRequestCreate(x)}mui(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.executeRequestUpdate(x)}gHi(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.getButton(x)}pZi(x){x=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.getTab(x)}cSa(){this._OnAccess();return null}Ilf(x){return f.a(d.a.k3h,w.a.ia(1771)+x)}rlf(){return f.a(d.a.lwk,w.a.ia(1767))}X7h(){return f.a(d.a.hostRestartNeeded,w.a.ia(1772))}YZf(){var x=this.zI.getSharedRuntimeId();x=!!x&&0<x.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",x));return x}igf(x){const A=this.wqh.getRibbonExtensionControlMap();return x in
A||this.fXh(x)}fXh(x){var A=this.Pxi();if(A){A=A.dtf;for(const z of A.tabs){if(z.id===x)return!0;for(const F of z.groups)for(const D of F.controls){if(D.id===x)return!0;if("Menu"===D.type){A=D;for(const G of A.items)if(G.id===x)return!0}}}}return!1}Pxi(){return r.a.getInstance().Kwa(this.Hj.PrimaryMarketplace.MarketplaceType,this.Hj.PrimaryMarketplace.SolutionId,t.dynamic)}static nAc(x,A,z){const F={};F.methodName="DynamicRibbon."+x;F.result=A?"Succeeded":"Failed";F.message=z;return w.a.Di(F)}}l.g2c=
"Office.Online.Extensibility.Ribbon.";Object(y.a)(l,"DynamicRibbon",null,[])},1278:function(y,m,a){a.d(m,"a",function(){return c});const c=(b,e)=>{let k=!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(k=!0));return k}},1284:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Nua=this.bRa=this.iNd=this.ETb=this.JKa=this.Lxe=null}}Object(y.a)(c,"AppsForOfficeOauthResult",
null,[])},1285:function(y,m,a){a.r(m);a.d(m,"WebExtensionView",function(){return F});y=a(0);var c=a(95),b=a(154);m=a(380);var e=a(30),k=a(19),d=a(275),u=a(56),n=a(288),v=a(1138),f=a(468),w=a(73),r=a(66),t=a(16),l=a(70),x=a(92),A=a(5),z=a(1130);a.n(z);Object(x.b)(A.Wg,{rk:"singleton"})(D=>xo(function*(){const G=yield x.a.resolve(A.Ob,D);return new F(G,new f.FloatingObjectBlockManager(G,G.fa,G.oa.kH,3,0),G.Dl.appendChild(G.Dl.ownerDocument.createElement("div")))}));class F extends m.a{constructor(D,
G,Q){super(Q,D);this.NKa=this.hashCode=null;this.mtc=!1;this.wx=(O,J)=>{J.Oj.hash===this.hashCode&&this.NKa&&(A.yb.Ma()?x.a.lh(A.yb):Object(b.a)(a(958).DdaFacade,this.$.qa.zh(35))).xRk(this.NKa.InstanceId)};this.onBlockCacheItemChanged=(O,J)=>{switch(J.Oj.block.state){case 1:case 3:case 5:this.WBa(J)}};this.mq=()=>{this.VTc(!0)};this.onActiveItemChanging=(O,J)=>{this.isVisible&&this.J$a(J.OB);this.clearCache()};this.onActiveItemChanged=(O,J)=>{this.lZg(J.la,!!J.OB)};this.cQ=()=>{this.$.fa.cOa()};
this.rab=G;this.domElement.classList.add(e.yb);this.domElement.classList.add(k.a.yH);Q.tabIndex=0;this.lZg(this.$.la,!1);this.qj.Ga("mousedown",this.cQ);this.qj.Ga("contextmenu",O=>{l.g(O)});this.$.sa.yX(this.onActiveItemChanging);this.$.$h.yX(this.onActiveItemChanging);this.$.$h.vn(this.onActiveItemChanged);this.$.sa.vn(this.onActiveItemChanged);this.za.sz(this.onBlockCacheItemChanged);this.za.uU(this.wx);this.za.qy(this.mq);this.gA(this.Isb)}get za(){return this.rab}dispose(){this.$&&(this.$.sa.H2(this.onActiveItemChanging),
this.$.$h.H2(this.onActiveItemChanging),this.$.$h.Nn(this.onActiveItemChanged),this.$.sa.Nn(this.onActiveItemChanged));this.rab&&(this.rab.Vz(this.onBlockCacheItemChanged),this.rab.cW(this.wx),this.rab.Ax(this.mq));this.dF(this.Isb);this.clearCache();c.a.gh(this.rab);this.rab=null;t.DOMElementExtensions.jn(this.domElement);super.dispose()}HPg(D){t.DOMElementExtensions.jn(t.DOMElementExtensions.getElementById(this.domElement,D.id));this.domElement.appendChild(D)}JVb(){if(this.NKa&&!this.mtc){var D=
(A.yb.Ma()?x.a.lh(A.yb):Object(b.a)(a(958).DdaFacade,n.a(this.$))).ks(this.NKa.InstanceId);D&&(D.resize(this.NKa.Width,this.NKa.Height),D.Ga(this.domElement),D.showHide(!0),this.mtc=!0)}}dZb(){return!0}WBa(D){this.NKa=D.Oj.block.Yj;this.mtc=!1;this.JVb()}J$a(D){this.$.fa.Q6&&D&&(D.XA||(D.XA=new d.a),D.XA.tn=new u.a(this.domElement.scrollLeft,this.domElement.scrollTop),D.XA.$3b=20)}clearCache(){this.za.Bvb(this.hashCode,"ClearCacheWebExtensionView");this.NKa=this.hashCode=null;this.mtc=!1}lZg(D,G){if(this.isVisible=
!!D&&w.n(D))this.hashCode=this.za.sGa(D,r.a.hCd,this.hashCode,!1),this.OZc(G)}static kKb(D){if(!v.a(D)){const G=D.Dl;D.qa.Rh(34,new F(D,new f.FloatingObjectBlockManager(D,D.fa,D.oa.kH,3,0),G.appendChild(G.ownerDocument.createElement("div"))))}}}Object(y.a)(F,"WebExtensionView",m.a,[235,4,2]);String(z);window.___1712031261987_closurehack=z},1288:function(y,m,a){a.d(m,"a",function(){return c});const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((k,d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,
e))})},1404:function(y,m,a){a.r(m);a.d(m,"CustomFunctionsInstaller",function(){return jb});y=a(0);var c=a(2),b=a(15),e=a(6),k=a(186),d=a(215),u=a(154),n=a(216),v=a(64),f=a(40),w=a(257),r=a(128),t=a(631);class l{constructor(Sa){Sa=Sa.split("|");this.TG=Sa[1];this.sld=Sa[2];this.Ewe=Sa[3]}get solutionId(){return this.TG}get solutionVersion(){return this.sld}get needToRestoreManifest(){return this.Ewe===OSF.StoreTypeEnum.Registry.toString()}}Object(y.a)(l,"AddinStoreInfo",null,[]);class x{}Object(y.a)(x,
"CustomFunctionRegistrationInfos",null,[]);var A=a(226),z=a(77);const F=(Sa,bb,oa)=>D(Sa,bb,A.a.none,z.a.current,oa),D=(Sa,bb,oa,ka,ya)=>{oa=Sa.continueWith(()=>{bb(Sa)},3,oa,ka);oa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,ya)},4);return oa},G=(Sa,bb,oa)=>Q(Sa,bb,A.a.none,z.a.current,oa),Q=(Sa,bb,oa,ka,ya)=>{oa=Sa.nB(()=>bb(Sa),3,oa,ka);oa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,ya)},4);return f.TaskExtensions.P3c(oa)},O=(Sa,bb,oa)=>J(Sa,bb,A.a.none,z.a.current,oa),J=(Sa,bb,
oa,ka,ya)=>{oa=Sa.nB(()=>bb(Sa),3,oa,ka);oa.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,ya)},4);return oa},H=(Sa,bb,oa)=>N(Sa,bb,A.a.none,z.a.current,oa),N=(Sa,bb,oa,ka,ya)=>{oa=Sa.nB(()=>bb(Sa),3,oa,ka);oa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ya)},4);return f.TaskExtensions.P3c(oa)},L=(Sa,bb,oa)=>Z(Sa,bb,A.a.none,z.a.current,oa),Z=(Sa,bb,oa,ka,ya)=>{oa=Sa.continueWith(()=>{bb(Sa)},3,oa,ka);oa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,ya)},4);return oa},ba=(Sa,bb)=>
{O(a(1404).CustomFunctionsInstaller.LJf("CustomFunctionsRuntimeLogging"),oa=>{if(oa.result&&window.console)switch(oa=K(Sa.severity)+" "+Sa.message+bb,Sa.severity){case 2:window.console.log&&window.console.log(oa);break;case 0:window.console.info&&window.console.info(oa);break;case 1:window.console.error&&window.console.error(oa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},K=Sa=>{switch(Sa){case 0:return"Medium";case 1:return"Unexpected";
case 2:return"Verbose";default:return""}};var E=a(1278);class U{}Object(y.a)(U,"InstallationInfo",null,[]);class X{}Object(y.a)(X,"UninstallationInfo",null,[]);var ia=a(33),Ma=a(84),qa=a(42),Ha=a(36),ha=a(1),La=a(28),fa=a(265),ja=a(617),ta=a(68);class Ka{constructor(Sa,bb){this.Kkd=Sa;this._message=bb}get severity(){return this.Kkd}get message(){return this._message}}Object(y.a)(Ka,"CustomFunctionLog",null,[]);var Ga=a(5),Na=a(91),cb=a(92);class jb{constructor(Sa,bb,oa){this.Goa=!1;this.DP={};this.$=
Sa;this.At=bb;this.XUd().yBa();this.indexedDB=oa;this.indexedDB.zl()&&(this.Goa=!0,this.indexedDB.initialize(jb.Lnb,jb.Mnb))}get L6(){return this.At.L6}VWf(Sa,bb,oa,ka){if(ka.invariantNamespace)for(let ya=0;ya<ka.invariantNamespace.length;++ya){const Oa=ka.invariantNamespace.charAt(ya);if("."!==Oa&&"_"!==Oa&&"a">Oa&&"z"<Oa&&"A">Oa&&"Z"<Oa&&"0">Oa&&"9"<Oa)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${Oa}', Position=${ya}.`),
Error.create("InvariantNamespace validation failed");}return G(this.OSh(oa,ka.manifest),()=>G(this.ohe(Sa),ya=>{let Oa=ya.result;return(null===Oa||void 0===Oa?0:Oa.isDynamicMetadata)?this.xie(Sa,bb,Oa,!1,!1,!1):G(this.Dhl(Sa,bb,ka),za=>{Oa=new U;Oa.addinId=oa;Oa.locale=ka.locale;Oa.addinInvariantNamespace=ka.invariantNamespace;Oa.addinNamespace=ka.namespace;Oa.addinTitle=ka.title;Oa.isXllCompatible=ka.isXllCompatible;Oa.metadataContent=JSON.stringify(JSON.parse(za.result));return this.xie(Sa,bb,Oa,
!1,jb.mvi(ka.osfControl.getStoreType()),E.a(this.$,ka))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}WWf(Sa,bb,oa,ka){if(!jb.H0d(oa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return G(this.ohe(Sa),ya=>{ya=ya.result;if(!ya&&(ya=qa.a.tj(this.L6,Sa),!ya))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa,bb,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ya.metadataContent=JSON.stringify(JSON.parse(oa));ya.isDynamicMetadata=!0;return this.xie(Sa,bb,ya,!0,!0,ka)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}e5g(Sa,
bb){this.At.swa();const oa=Object(c.a)(new X,{solutionId:Sa}),ka=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa,bb,null)}.`;return G(this.jje(Sa),()=>G(this.rje(Sa),()=>this.qAe(this.At,Sa,bb,oa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),ka)}Dhl(Sa,bb,oa){const ka=new k.a;OSF.OUtil.xhrGet(oa.metadataUrl,ya=>{ya?ka.setResult(ya):ka.setException(Error.create("Invalid manifest"))},
ya=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa,bb,null)}. ErrorCode: ${ya}.`);ka.fD()});return ka.task}XUd(){return G(this.kUc(),Sa=>{const bb=Sa.result;if(!bb.length)return ta.Task.Ua(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Sa=new d.a;const oa=[];for(let ka=
0;ka<bb.length;ka++){const ya=Object(u.a)(String,bb[ka]);Sa.add(O(this.ohe(ya),Oa=>{if(Oa=Oa.result){const za=qa.a.tj(this.DP,Oa.addinId);za&&za===Oa.metadataContent||(this.DP[Oa.addinId]=Oa.metadataContent,this.L6[ya]=Oa,oa.push(Oa))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return H(ta.Task.WhenAllEnumerable(Sa),()=>{if(oa.length){const ka=new x;ka.registrationInfos=oa;return this.Npc(this.At,bb,ka)}b.ULS.sendTraceTag(537163546,
0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ta.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}XWf(){var Sa=new k.a;const bb=[],oa=[];Object.keys(this.L6).forEach(ka=>{ka=Object(u.a)(String,ka);const ya=qa.a.tj(this.L6,ka);bb.push(ya);oa.push(ka)});if(!oa.length)return Sa.setResult(!0),Sa.task;Sa=Object(c.a)(new x,
{registrationInfos:bb});return this.Npc(this.At,oa,Sa)}kUc(){return O(this.GNd(t.a.rfb),Sa=>{Sa=Sa.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Sa||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Sa||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Uah(Sa){return this.yqe(t.a.rfb,Sys.Serialization.JavaScriptSerializer.serialize(Sa))}ohe(Sa){return G(this.GNd(t.a.imb(Sa)),bb=>{bb=bb.result||
"";return 0<bb.length?ta.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(bb,!0)):ta.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}thl(Sa,bb){return G(this.Zuf(Sa),()=>G(this.yqe(t.a.imb(Sa),Sys.Serialization.JavaScriptSerializer.serialize(bb)),()=>jb.zqe(t.a.aSd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}jje(Sa){return G(this.TEg(Sa),
()=>G(this.qFg(t.a.imb(Sa)),()=>G(this.kUc(),bb=>bb.result.length?ta.Task.Ua(!0):jb.zqe(t.a.aSd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}qCg(Sa){return this.GNd(t.a.hmb(Sa))}Qah(Sa,bb){return G(this.Zuf(Sa),
()=>this.yqe(t.a.hmb(Sa),bb),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}rje(Sa){return G(this.TEg(Sa),()=>this.qFg(t.a.hmb(Sa)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}Zuf(Sa){return G(this.kUc(),bb=>{bb=bb.result;const oa=Sa.toLowerCase();if(bb.includes(oa))return ta.Task.Ua(!0);bb.push(oa);return this.Uah(bb)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}TEg(Sa){return G(this.kUc(),
bb=>{bb=bb.result;const oa=Sa.toLowerCase();return bb.includes(oa)?(bb.splice(Array.indexOf(bb,oa),1),this.Uah(bb)):ta.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}OSh(Sa,bb){if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Sa=new OSF.AddinIdInfo(Sa),Sa.needToRestoreManifest()?this.Qah(Sa.getSolutionId(),bb):ta.Task.Ua(!0);Sa=new l(Sa);return Sa.needToRestoreManifest?this.Qah(Sa.solutionId,
bb):ta.Task.Ua(!0)}Hvk(Sa){if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const oa=new OSF.AddinIdInfo(Sa);return oa.needToRestoreManifest()?O(this.qCg(oa.getSolutionId()),ka=>{(ka=ka.result)&&OSF.OsfManifestManager.cacheManifestFromXml(oa.getSolutionId(),oa.getSolutionVersion(),ka,this.$.ua.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ta.Task.Ua(!0)}const bb=new l(Sa);return bb.needToRestoreManifest?
O(this.qCg(bb.solutionId),oa=>{(oa=oa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(bb.solutionId,bb.solutionVersion,oa,this.$.ua.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ta.Task.Ua(!0)}qFg(Sa){return this.Goa?this.indexedDB.BCd(Sa):jb.Emk(Sa)}yqe(Sa,bb){return this.Goa?this.indexedDB.BBa(new ja.a(Sa,bb)):jb.zqe(Sa,bb)}GNd(Sa){return this.Goa?this.indexedDB.rxa(Sa):jb.LJf(Sa)}xie(Sa,bb,oa,ka,ya,Oa){const za=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa,
bb,null)}.`;return f.TaskExtensions.P3c(O(this.yie(this.At,Sa,bb,oa,!1,ka,Oa),()=>ya?this.thl(Sa,oa):ta.Task.Ua(!0),za))}yie(Sa,bb,oa,ka,ya,Oa,za){if(!Oa&&(Oa=qa.a.tj(this.DP,ka.addinId))&&Oa===ka.metadataContent)return ta.Task.Ua(!0);this.DP[ka.addinId]=ka.metadataContent;this.L6[bb]=ka;za||Sa.I5b(bb);Sa.swa();return G(this.Fjk(bb,oa,ka),()=>this.Pfe(ka.addinId,ya),"Failed to register functions for customfunction addin")}Fjk(Sa,bb,oa){const ka=new k.a,ya=this.LWa(oa);return this.qga(Oa=>{ba(jb.eOb,
Sa);(Oa=Oa.Result)&&204===Oa.ResponseStatusCode?ka.setResult(!0):(delete this.DP[oa.addinId],delete this.L6[Sa],F(this.jje(Sa),()=>{F(this.rje(Sa),()=>{this.DVg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Sa}. Received status code ${Oa?Oa.ResponseStatusCode.toString():"Unknown"}.`),ka.setResult(!1))},Oa=>{Oa=r.a.$j(Oa.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa,
bb,null)}. Errors: ${Ha.a.fi(Oa)}.`);ba(jb.dOb,Sa);delete this.DP[oa.addinId];delete this.L6[Sa];ka.setResult(!1)},ya,ka,!0)}Npc(Sa,bb,oa){const ka=new k.a,ya=ia.a.kh.Xj.m;bb.forEach(za=>{za=Object(u.a)(String,za);Sa.Nff(za)});Sa.swa();const Oa=this.zud(oa);return this.qga(za=>{ba(jb.eOb,Sys.Serialization.JavaScriptSerializer.serialize(bb));za=za.Result;let ea=!0,Aa=[];if(null===za||void 0===za?0:za.ResponseBody){var ub=Sys.Serialization.JavaScriptSerializer.deserialize(za.ResponseBody.toString());
Array.isArray(ub.value)&&(Aa=ub.value)}ub=new d.a;for(let rb=0;rb<Aa.length;rb++)if(!Aa[rb]){ea=!1;const Ja=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${za.ResponseStatusCode}.`;ub.add(G(this.jje(bb[rb]),()=>{delete this.DP[oa.registrationInfos[rb].addinId];delete this.L6[bb[rb]];return this.rje(bb[rb])},Ja))}L(ta.Task.WhenAllEnumerable(ub),()=>{F(this.Pfe("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${ia.a.kh.Xj.m-
ya} Millisecond.`);ea?ka.setResult(ea):L(this.DVg(),()=>{ka.setResult(ea)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},za=>{za=r.a.$j(za.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${Ha.a.fi(za)}.`);
ba(jb.dOb,Sys.Serialization.JavaScriptSerializer.serialize(bb));for(za=0;za<oa.registrationInfos.length;za++)delete this.DP[oa.registrationInfos[za].addinId],delete this.L6[bb[za]];ka.setResult(!1)},Oa,ka,!0)}qAe(Sa,bb,oa,ka){return G(this.E7k(Sa,bb,oa,ka),()=>this.Pfe(ka.solutionId,!1),"Failed to unregister functions for customfunction addin")}E7k(Sa,bb,oa,ka){const ya=new k.a;Sa.I5b(bb);(Sa=qa.a.tj(this.L6,bb))&&delete this.DP[Sa.addinId];delete this.L6[bb];ka=this.Pud(ka);return this.qga(()=>{ba(jb.zBd,
bb);ya.setResult(!0)},Oa=>{Oa=r.a.$j(Oa.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(bb,oa,null)}. Errors: ${Ha.a.fi(Oa)}.`);ba(jb.yBd,bb);ya.setResult(!1)},ka,ya,!1)}qga(Sa,bb,oa,ka,ya){const Oa=this.$.userOperationManager,za=this.$.oa;let ea=null,Aa=null,ub=null;const rb=()=>{if(Oa.PXa()||0<za.ta.rga||0<za.kH.rga)return!1;ea&&Oa.vu(ea);Aa&&za.oL(Aa);
ub&&za.KZ(ub);const Ja=oa.request;Oa.kP(new n.a(507,0,(Xa,Y,Ia)=>{ba(ya?jb.xBd:jb.ABd,Ja.RequestBody);return v.h(za.ta,"ExecuteRichApiRequest",oa,fa.c(Xa,Sa),fa.b(Y,bb),Ia,null,0)},Ja.RequestFlags&1&&256!==(Ja.RequestFlags&256)?64:80));return!0};rb()||(ea=()=>{rb()},Aa=()=>{rb()},ub=()=>{rb()},Oa.qw(ea),za.MI(Aa),za.CX(ub));return ka.task}LWa(Sa){const bb={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};bb.RequestBody=JSON.stringify(Sa);bb.RequestFlags=1;bb.RequestFlags|=
256;Sa=this.$.oa.ta.Za(1);Sa.request=bb;return Sa}zud(Sa){const bb={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};bb.RequestBody=JSON.stringify(Sa);bb.RequestFlags=1;bb.RequestFlags|=256;Sa=this.$.oa.ta.Za(1);Sa.request=bb;return Sa}Pud(Sa){const bb={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};bb.RequestBody=JSON.stringify(Sa);bb.RequestFlags=1;bb.RequestFlags|=256;Sa=this.$.oa.ta.Za(1);Sa.request=bb;return Sa}Pfe(Sa,bb){const oa=
Object(Na.d)(cb.a.resolve(Ga.Yc,{va:1}));return Q(oa,()=>{oa.result.bme();return Sa&&bb?this.Hvk(Sa):ta.Task.Ua(!0)},this.$.ya,w.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}DVg(){const Sa=new Ma.a(1949669462,0,this.$.ji,0,null);return this.$.Ia.qh(Sa)}static LJf(Sa){try{return ta.Task.Ua(localStorage.getItem(Sa))}catch(bb){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${bb.message||
"Unknown"}`),ta.Task.Ua(null)}}static zqe(Sa,bb){try{return localStorage.setItem(Sa,bb),ta.Task.Ua(!0)}catch(oa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${oa.message||"Unknown"}`),ta.Task.Ua(!1)}}static Emk(Sa){try{return localStorage.removeItem(Sa),ta.Task.Ua(!0)}catch(bb){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${bb.message||
"Unknown"}`),ta.Task.Ua(!1)}}static mvi(Sa){return La.a.equals(Sa,"registry",!0)||La.a.equals(Sa,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static H0d(Sa){if(!Sa)return!1;try{JSON.parse(Sa)}catch(bb){return!1}return!0}}jb.Lnb="CustomFunctionCache";jb.Mnb="CustomFunction";jb.xBd=new Ka(2,"CustomFunctions [Registration] [Begin] SolutionId=");jb.eOb=new Ka(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");jb.dOb=new Ka(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
jb.ABd=new Ka(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");jb.zBd=new Ka(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");jb.yBd=new Ka(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(jb,"CustomFunctionsInstaller",null,[272])},1406:function(y,m,a){a.r(m);a.d(m,"CustomFunctionsLegacyInstaller",function(){return U});y=a(0);var c=a(2),b=a(15),e=a(1183),k=a(186),d=a(154),u=a(216),n=a(64),v=a(78),f=a(40),w=a(128),r=a(631),t=a(1278);class l{constructor(X){X=
X.split("|");this.TG=X[1];this.sld=X[2];this.Ewe=X[3]}get solutionId(){return this.TG}get solutionVersion(){return this.sld}get needToRestoreManifest(){return this.Ewe===OSF.StoreTypeEnum.Registry.toString()}}Object(y.a)(l,"AddinStoreInfo",null,[]);class x{}Object(y.a)(x,"CustomFunctionRegistrationInfos",null,[]);const A=(X,ia)=>{if(a(1406).CustomFunctionsLegacyInstaller.TSb("CustomFunctionsRuntimeLogging")&&window.console)switch(ia=z(X.severity)+" "+X.message+ia,X.severity){case 2:window.console.log&&
window.console.log(ia);break;case 0:window.console.info&&window.console.info(ia);break;case 1:window.console.error&&window.console.error(ia)}},z=X=>{switch(X){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class F{}Object(y.a)(F,"InstallationInfo",null,[]);class D{}Object(y.a)(D,"UninstallationInfo",null,[]);var G=a(200),Q=a(42),O=a(36),J=a(12),H=a(265),N=a(1136),L=a(68);class Z{constructor(X,ia){this.Kkd=X;this._message=ia}get severity(){return this.Kkd}get message(){return this._message}}
Object(y.a)(Z,"CustomFunctionLog",null,[]);var ba=a(5),K=a(91),E=a(92);class U{constructor(X){this.DP={};this.$=X;this.XUd().yBa()}VWf(X,ia,Ma,qa){const Ha=new k.a;if(qa.invariantNamespace)for(ia=0;ia<qa.invariantNamespace.length;++ia){const La=qa.invariantNamespace.charAt(ia);if("."!==La&&"_"!==La&&"a">La&&"z"<La&&"A">La&&"Z"<La&&"0">La&&"9"<La)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${La}', Position=${ia}.`),
Ha.setResult(!1),Ha.task}U.cacheManifest(Ma,qa.manifest);let ha=U.phe(X);(null===ha||void 0===ha?0:ha.isDynamicMetadata)?this.wie(X,ha,Ha,!1,!1):OSF.OUtil.xhrGet(qa.metadataUrl,La=>{ha=Object(c.a)(new F,{addinId:Ma,locale:qa.locale,addinInvariantNamespace:qa.invariantNamespace,addinNamespace:qa.namespace,addinTitle:qa.title,isXllCompatible:qa.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(La))});this.wie(X,ha,Ha,!1,t.a(this.$,qa))},La=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${X}. ErrorCode: ${La}.`);
Ha.setResult(!1)});return Ha.task}WWf(X,ia,Ma,qa){ia=new k.a;if(!U.H0d(Ma))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),ia.setResult(!1),ia.task;const Ha=U.phe(X);if(!Ha)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),ia.setResult(!1),ia.task;Ha.metadataContent=JSON.stringify(JSON.parse(Ma));Ha.isDynamicMetadata=
!0;this.wie(X,Ha,ia,!0,qa);return ia.task}e5g(X){const ia=new k.a,Ma=ba.yb.Ma()?Object(K.d)(E.a.resolve(ba.yb,{va:1})):v.GetServiceTaskFactory.create(this.$.qa,106,this.$.ya,1);f.TaskExtensions.$e(Ma,()=>{const qa=Ma.result;qa.swa();const Ha=Object(c.a)(new D,{solutionId:X});U.kje(X);U.sje(X);f.TaskExtensions.$e(this.qAe(qa,X,Ha),ha=>{G.b(ha)?ia.setResult(ha.result):(ha.Jm?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${X}.`):
ha.so&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${X}.`),ia.setResult(!1))},this.$.ya,0)},this.$.ya,3);return ia.task}XUd(){const X=new k.a,ia=U.the();0<ia.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Ma=[];ia.forEach(Ha=>{Ha=Object(d.a)(String,Ha);if(Ha=U.phe(Ha)){const ha=Q.a.tj(this.DP,Ha.addinId);
ha&&ha===Ha.metadataContent||(this.DP[Ha.addinId]=Ha.metadataContent,Ma.push(Ha))}});if(!Ma.length)return X.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),X.task;const qa=ba.yb.Ma()?Object(K.d)(E.a.resolve(ba.yb,{va:1})):v.GetServiceTaskFactory.create(this.$.qa,106,this.$.ya,1);f.TaskExtensions.$e(qa,()=>{const Ha=qa.result,ha=Object(c.a)(new x,{registrationInfos:Ma});f.TaskExtensions.$e(this.Npc(Ha,
ia,ha),La=>{G.b(La)?X.setResult(La.result):(La.Jm?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):La.so&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),X.setResult(!1))},this.$.ya,0)},this.$.ya,3);return X.task}Gvk(X){X=new l(X);if(X.needToRestoreManifest){const ia=U.Fgk(X.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(X.solutionId,
X.solutionVersion,ia,this.$.ua.UICultureTag)}}wie(X,ia,Ma,qa,Ha){const ha=ba.yb.Ma()?Object(K.d)(E.a.resolve(ba.yb,{va:1})):v.GetServiceTaskFactory.create(this.$.qa,106,this.$.ya,1);f.TaskExtensions.$e(ha,()=>{f.TaskExtensions.$e(this.yie(ha.result,X,ia,!1,qa,Ha),La=>{G.b(La)?((La=La.result)&&U.uhl(X,ia),Ma.setResult(La)):(La.Jm?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${X}.`):La.so&&b.ULS.sendTraceTag(537163487,
0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${X}.`),Ma.setResult(!1))},this.$.ya,0)},this.$.ya,3)}yie(X,ia,Ma,qa,Ha,ha){if(!Ha&&(Ha=Q.a.tj(this.DP,Ma.addinId))&&Ha===Ma.metadataContent)return L.Task.Ua(!0);this.DP[Ma.addinId]=Ma.metadataContent;const La=new k.a;ha||X.I5b(ia);X.swa();X=this.LWa(Ma);return this.qga(fa=>{A(U.eOb,ia);const ja=fa.Result;204===ja.ResponseStatusCode?f.TaskExtensions.$e(this.Ofe(La,Ma.addinId,qa),ta=>{ta.Jm?ia?
b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${ia}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Ma.addinId}.`):ta.so&&(ia?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${ia}.`):b.ULS.sendTraceTag(537163482,
0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Ma.addinId}.`));La.setResult(!1)},this.$.ya,4):(fa=()=>{delete this.DP[Ma.addinId];U.kje(ia);U.sje(ia);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${ia}. Received status code ${ja.ResponseStatusCode}.`);La.setResult(!1)},fa=Object(c.a)(new N.a,{a1a:OSF.InfoType.Error,title:Ma.addinTitle,description:String.format(J.a.instance.sh(153),
J.a.instance.ia(1892)),buttonText:J.a.instance.ia(4),eva:fa,cFc:!1,dwa:fa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.Pte(fa))},fa=>{fa=w.a.$j(fa.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${ia}. Errors: ${O.a.fi(fa)}.`);A(U.dOb,ia);delete this.DP[Ma.addinId];La.setResult(!1)},X,La,!0)}Npc(X,ia,Ma){const qa=new k.a;ia.forEach(ha=>{ha=Object(d.a)(String,ha);X.Nff(ha)});
X.swa();const Ha=this.zud(Ma);return this.qga(ha=>{A(U.eOb,Sys.Serialization.JavaScriptSerializer.serialize(ia));ha=ha.Result;let La=!0;var fa=[];fa=Sys.Serialization.JavaScriptSerializer.deserialize(ha.ResponseBody.toString()),fa=Array.isArray(fa.value)?fa.value:null;for(let ja=0;ja<fa.length;ja++)fa[ja]||(La=!1,delete this.DP[Ma.registrationInfos[ja].addinId],U.kje(ia[ja]),U.sje(ia[ja]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${ia[ja]}. Received status code ${ha.ResponseStatusCode}.`));
f.TaskExtensions.$e(this.Ofe(qa,"",!1),ja=>{ja.Jm?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ja.so&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");qa.setResult(!1)},this.$.ya,4);qa.setResult(La)},ha=>{ha=w.a.$j(ha.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(ia)}. Errors: ${O.a.fi(ha)}.`);
A(U.dOb,Sys.Serialization.JavaScriptSerializer.serialize(ia));for(const La of Ma.registrationInfos)delete this.DP[La.addinId];qa.setResult(!1)},Ha,qa,!0)}qAe(X,ia,Ma){const qa=new k.a;X.I5b(ia);X=this.Pud(Ma);return this.qga(()=>{A(U.zBd,ia);f.TaskExtensions.$e(this.Ofe(qa,Ma.solutionId,!1),Ha=>{Ha.Jm?ia&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${ia}.`):Ha.so&&ia&&b.ULS.sendTraceTag(537163472,
0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${ia}.`);qa.setResult(!1)},this.$.ya,4)},Ha=>{Ha=w.a.$j(Ha.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${ia}. Errors: ${O.a.fi(Ha)}.`);A(U.yBd,ia);qa.setResult(!1)},X,qa,!1)}qga(X,ia,Ma,qa,Ha){const ha=this.$.userOperationManager,La=this.$.oa;let fa=null,ja=null,
ta=null;const Ka=()=>{if(ha.PXa()||0<La.ta.rga||0<La.kH.rga)return!1;fa&&ha.vu(fa);ja&&La.oL(ja);ta&&La.KZ(ta);const Ga=Ma.request;ha.kP(new u.a(507,0,(Na,cb,jb)=>{A(Ha?U.xBd:U.ABd,Ga.RequestBody);return n.h(La.ta,"ExecuteRichApiRequest",Ma,H.c(Na,X),H.b(cb,ia),jb,null,0)},(Ga.RequestFlags&1?0:16)|64));return!0};Ka()||(fa=()=>{Ka()},ja=()=>{Ka()},ta=()=>{Ka()},ha.qw(fa),La.MI(ja),La.CX(ta));return qa.task}LWa(X){const ia={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};
ia.RequestBody=JSON.stringify(X);ia.RequestFlags=1;X=this.$.oa.ta.Za(1);X.request=ia;return X}zud(X){const ia={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ia.RequestBody=JSON.stringify(X);ia.RequestFlags=1;X=this.$.oa.ta.Za(1);X.request=ia;return X}Pud(X){const ia={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ia.RequestBody=JSON.stringify(X);ia.RequestFlags=1;X=this.$.oa.ta.Za(1);X.request=ia;return X}Ofe(X,ia,Ma){const qa=
Object(K.d)(E.a.resolve(ba.Yc,{va:1}));f.TaskExtensions.$e(qa,()=>{qa.result.bme();ia&&Ma&&this.Gvk(ia);X.setResult(!0)},this.$.ya,3);return qa}XWf(){return L.Task.Ua(!0)}static the(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(U.TSb(r.a.rfb)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(U.TSb(r.a.rfb)||"[]"):null)||[]}static Vah(X){U.Aqe(r.a.rfb,Sys.Serialization.JavaScriptSerializer.serialize(X))}static phe(X){X=U.TSb(r.a.imb(X))||"";return 0<X.length?Sys.Serialization.JavaScriptSerializer.deserialize(X,
!0):null}static uhl(X,ia){U.Yuf(X);U.Aqe(r.a.imb(X),Sys.Serialization.JavaScriptSerializer.serialize(ia))}static kje(X){U.SEg(X);U.rFg(r.a.imb(X))}static Fgk(X){return U.TSb(r.a.hmb(X))}static vhl(X,ia){U.Yuf(X);U.Aqe(r.a.hmb(X),ia)}static sje(X){U.SEg(X);U.rFg(r.a.hmb(X))}static Yuf(X){const ia=U.the();X=X.toLowerCase();ia.includes(X)||(ia.push(X),U.Vah(ia))}static SEg(X){const ia=U.the();X=X.toLowerCase();ia.includes(X)&&(ia.splice(Array.indexOf(ia,X),1),U.Vah(ia))}static cacheManifest(X,ia){X=
new l(X);X.needToRestoreManifest&&U.vhl(X.solutionId,ia)}static TSb(X){try{return localStorage.getItem(X)}catch(ia){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${ia.message||"Unknown"}`),null}}static Aqe(X,ia){try{localStorage.setItem(X,ia)}catch(Ma){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Ma.message||
"Unknown"}`)}}static rFg(X){try{localStorage.removeItem(X)}catch(ia){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${ia.message||"Unknown"}`)}}static H0d(X){if(!X)return!1;try{JSON.parse(X)}catch(ia){return!1}return!0}}U.xBd=new Z(2,"CustomFunctions [Registration] [Begin] SolutionId=");U.eOb=new Z(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");U.dOb=new Z(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
U.ABd=new Z(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");U.zBd=new Z(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");U.yBd=new Z(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(U,"CustomFunctionsLegacyInstaller",null,[272])},1416:function(y,m,a){a.d(m,"a",function(){return F});y=a(0);var c=a(226),b=a(15);class e{}Object(y.a)(e,"AddinCommandsHost",null,[]);var k=a(1483),d=a(1609),u=a(1134),n=a(64);const v=(D,G,Q,O,J,H)=>{const N=D.Za(9);
N.sharedInfo=G;return n.h(D,"InsertAgaveTaskpane",N,Q,O,J,H,0)};var f=a(431),w=a(216),r=a(40),t=a(1),l=a(265);m=a(242);class x extends m.a{constructor(D){super();this.fl=this.USa="AddInCommandsDialog";this.Oh=5;this.dialogWidth=695;this.dialogHeight=438;this.t2h="100%";this.q2h="408px";this.r2h="15px";this.s2h="0";this.hrh=D}get containerDiv(){return this.Yo}vG(){super.vG();this.Yo.style.width=this.t2h;this.Yo.style.height=this.q2h;this.Yo.style.marginTop=this.r2h;this.Yo.style.padding=this.s2h}zT(){super.zT();
this.rh.style.width=String.format("{0}px",this.dialogWidth);this.rh.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.hrh()}}Object(y.a)(x,"AddInCommandsDialog",m.a,[]);var A=a(68),z=a(77);a=a(107);class F extends e{constructor(D,G,Q,O,J){O=void 0===O?null:O;J=void 0===J?null:J;super();this.$=D;this.ti=G;this.ownerAddinInfo=Q;this.Nh=J;this.swb=O||A.Task.Ua(!0)}n2h(){const D=this.swb;this.swb=A.Task.Ua(!0);return D}disposeHost(D){this.ti.g7a(D)}setOwnerAddinEToken(D){this.ownerAddinInfo.eToken=
D}showTaskpane(D,G,Q){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let O=null,J=!1;const H=(new k.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new u.a,!0)).Bof(D.solutionId.substr(this.ownerAddinInfo.solutionId.length));O=G.getSharedRuntimeForTaskpane("Workbook",H);J=!!O&&1===O.LifeTime;this.ti.Qff(J?this.ownerAddinInfo.solutionId:D.solutionId,J?O:null,null)||(this.U$f(J,!0),this.swb=this.VUd(D,O,(N,L)=>{N?(J&&(N.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,
N.SharedRuntime=O),N.WebExtensionOsfControlType=3,this.ti.gYa(N),Q(N.InstanceId,L),this.U$f(J,!1),t.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),Q(null,L))}))}getSettings(D,G){const Q=this.ti.a6(D.solutionId);Q?G(this.ti.gY(Q).OsfPropertyBag):this.swb=this.VUd(D,null,O=>{O?G(O.OsfPropertyBag):b.ULS.sendTraceTag(537170641,
220,10,"GetSettings: insertData is null.")})}showDialog(D,G,Q){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const O=this.$.oa.ta,J=N=>{const L=N.Result,Z=L?L.AgaveData:null;Z?(this.ti.rnf(Z,()=>{const ba=new x(()=>{this.disposeHost(Z.InstanceId)});ba.initializeAndShow("",null,null);return ba.containerDiv}),Q(Z.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),Q(null,N.Errors?N.Errors[0].ErrorCause:5001))},H=F.UHa(D,this.ownerAddinInfo);this.swb=
f.a(this.$.userOperationManager,(N,L,Z)=>v(O,H,l.c(N,J),L,Z,null),N=>new w.a(500,0,N,64),this.Nh)}createUILessSandbox(D,G,Q){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const O=G.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),J=!!O&&1===O.LifeTime;(G=this.ti.Txi(J?this.ownerAddinInfo.solutionId:D.solutionId,J?O:null))?Q(G,0):this.swb=this.VUd(D,O,(H,N)=>{H?(J?(H.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,H.SharedRuntime=O,H.TaskpaneVisible=!1,H.WebExtensionOsfControlType=
3,this.ti.gYa(H)):(H.WebExtensionOsfControlType=4,this.ti.rnf(H,()=>{F.Uzb.ga(H.InstanceId,new d.a);return F.Uzb.ma(H.InstanceId).Yma})),Q(H.InstanceId,N)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),Q(null,N))})}VUd(D,G,Q){let O=null;const J=this.$.oa.ta,H=K=>{const E=K.Result;(O=E?E.AgaveData:null)||Q(null,K.Errors?K.Errors[0].ErrorCause:5001)},N=F.UHa(D,this.ownerAddinInfo);G&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),N.SharedRuntimeId=G.Resid);
let L=500;var Z=(K,E,U)=>v(J,N,l.c(K,H),E,U,null);let ba=0;void 0===N.IsToBePersisted||null===N.IsToBePersisted||N.IsToBePersisted||(L=538,Z=(K,E,U)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));K=l.c(K,H);const X=J.Za(9,null);X.sharedInfo=N;return n.h(J,
"ShowAgaveTaskpane",X,K,E,U,null,0)},ba=16);ba|=64;Z=f.a(this.$.userOperationManager,Z,K=>new w.a(L,0,K,ba),this.Nh);return r.TaskExtensions.ts(Z,()=>O?this.z3d(J,O.InstanceId,(K,E)=>{if(K){G||(O.PrimaryMarketplace.MarketplaceType=D.storeType);D.assetId?D.assetId.toLowerCase().startsWith("wa")?O.AssetMarketplace={SolutionId:D.assetId,SolutionVersion:D.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:D.assetStoreId}:(O.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):
O.AssetMarketplace=null;O.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;O.OwnerAddinStoreType=this.ownerAddinInfo.storeType;O.OsfPropertyBag=[];for(E=0;E<K.Settings.length;E++){const U=[];U[0]=K.Settings[E].Name;U[1]=K.Settings[E].Value;O.OsfPropertyBag[E]=U}Q(O,0)}else Q(null,E.Errors?E.Errors[0].ErrorCause:5001)}):A.Task.Ua(!1),c.a.none,3,z.a.current)}z3d(D,G,Q){const O=J=>{Q(J.Result,J)};return f.a(this.$.userOperationManager,(J,H,N)=>{J=l.c(J,O);const L=D.Za(1);L.controlId=G;return n.h(D,
"DdaLoadSettings",L,J,H,N,null,0)},J=>new w.a(501,0,J,80),this.Nh)}U$f(D,G){var Q;D&&(null===(Q=window.performance)||void 0===Q?0:Q.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${G}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(D){F.Uzb.mh(D)&&F.Uzb.ma(D).initializeAndShowWithTitle()}static hideUILessDialog(D){F.Uzb.mh(D)&&
F.Uzb.ma(D).hide()}static UHa(D,G){var Q,O;const J={};J.SolutionId=D.solutionId;J.Version=D.version;J.StoreType=G.storeType;J.StoreId=D.storeId;J.AssetId=null!==(Q=D.assetId)&&void 0!==Q?Q:D.solutionId;J.AssetStoreId=null!==(O=D.assetStoreId)&&void 0!==O?O:"omex";J.TargetType=1;J.Width=350;J.OwnerAddinSolutionId=G.solutionId;J.OwnerAddinStoreType=G.storeType;J.SharedRuntimeId=null;J.Preload=!1;return J}}F.Uzb=new a.a;Object(y.a)(F,"WACExcelAddinCommandsHost",e,[])},1432:function(y,m,a){a.d(m,"a",
function(){return f});y=a(0);var c=a(215),b=a(383),e=a(15);class k{}k.getUserId="getUserId";k.getLastStoreUpdate="laststoreupdate";k.getEntitlement="getEntitlements";k.getEToken="getEToken";k.getManifest="getManifest";k.getAppState="getAppState";k.getKilledApps="getRemovedAddins";k.getAppDetails="getAppDetails";k.removeApps="removeAddin";k.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";k.getPrivateCatalogAddIns="getAddIns";k.getPrivateCatalogManifests="getAppManifests";k.isStoreDisabled=
"isStoreDisabled";Object(y.a)(k,"S2SWebRequestActions",null,[]);var d=a(6),u=a(289),n=a(34),v=a(686);class f{getUserId(w,r){const t=new c.a;t.add(new b.a("corr",w));this.D8(k.getUserId,t,1,r)}getLastStoreUpdate(w,r,t){const l=new c.a;l.add(new b.a("lc",w));l.add(new b.a("corr",r));this.D8(k.getLastStoreUpdate,l,1,t)}getEntitlement(w,r,t,l){w=new c.a;w.add(new b.a("av",r));w.add(new b.a("corr",t));this.D8(k.getEntitlement,w,1,l)}getEToken(w,r,t,l,x,A){const z=new c.a;z.add(new b.a("cmu",w));z.add(new b.a("cmf",
r));z.add(new b.a("assetid",t));z.add(new b.a("expver",l));z.add(new b.a("corr",x));this.D8(k.getEToken,z,1,A)}getManifest(w,r,t,l){const x=new c.a;x.add(new b.a("cmu",w));x.add(new b.a("assetid",r));x.add(new b.a("corr",t));this.D8(k.getManifest,x,1,l)}getAppState(w,r,t){const l=new c.a;l.add(new b.a("ma",w));l.add(new b.a("corr",r));this.D8(k.getAppState,l,1,t)}getKilledApps(w,r){const t=new c.a;t.add(new b.a("corr",w));this.D8(k.getKilledApps,t,1,r)}getAppDetails(w,r,t,l){const x=new c.a;x.add(new b.a("cmo",
w));x.add(new b.a("corr",t));this.sendWithBody(k.getAppDetails,x,r,2,l,!1)}removeApps(w,r,t){const l=new c.a;l.add(new b.a("corr",r));this.sendWithBody(k.removeApps,l,w,2,t,!1)}getLastPrivateCatalogUpdate(w,r,t,l,x,A){const z=new c.a;z.add(new b.a("catalog","privatecatalog"));z.add(new b.a("clientCode",w));z.add(new b.a("clientVersion",r));z.add(new b.a("corr",x));w=String.format("authorizationCode={0}&refreshToken={1}",t?n.a.Bl(t):"",l?n.a.Bl(l):"");this.sendWithBody(k.getLastPrivateCatalogUpdate,
z,w,2,A,!0)}getPrivateCatalogAddIns(w,r,t,l,x,A){const z=new c.a;z.add(new b.a("catalog","privatecatalog"));z.add(new b.a("clientCode",w));z.add(new b.a("clientVersion",r));z.add(new b.a("corr",x));w=String.format("authorizationCode={0}&refreshToken={1}",t?n.a.Bl(t):"",l?n.a.Bl(l):"");this.sendWithBody(k.getPrivateCatalogAddIns,z,w,2,A,!0)}getPrivateCatalogManifests(w,r,t,l,x){const A=new c.a;A.add(new b.a("catalog","privatecatalog"));A.add(new b.a("corr",l));w=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",
n.a.Bl(w),r?n.a.Bl(r):"",t?n.a.Bl(t):"");this.sendWithBody(k.getPrivateCatalogManifests,A,w,2,x,!0)}isStoreDisabled(w,r){const t=new c.a;t.add(new b.a("corr",w));this.D8(k.isStoreDisabled,t,2,r)}D8(w,r,t,l){this.sendWithBody(w,r,null,t,l,!1)}sendWithBody(w,r,t,l,x,A){const z=new u.QueryStringBuilder("AddinServiceHandler.ashx");z.Op("action",w);z.Op("app",v.a[d.AFrameworkApplication.ra.$g.qn]);for(const F of r)z.Op(F.key,F.value);r=String.format("{0}{1}&{2}",d.AFrameworkApplication.ra.$g.f2,z.toString(),
d.AFrameworkApplication.Oo);d.AFrameworkApplication.lj.qv(r,l,t,null,!1,2,F=>{let D=null,G=null;F&&F.data&&(F.data.responseHeaders["X-BlockedForMinor"]&&"1"===F.data.responseHeaders["X-BlockedForMinor"].toString()&&(F.data.httpStatus=451),D=F.data.responseData,G=F.data.responseHeaders);x(F.data.httpStatus,D,G)},F=>{var D=null;let G=null;A&&F&&F.data&&F.data.responseData&&(D=F.data.responseData,G=F.data.responseHeaders);x(F.data.httpStatus,D,G);if(d.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){D={message:"AddinServiceHandler request failed"};D.code=F.data.httpStatus;D.action=w;if(F.data.request||F.data.request.get_headers())D["X-UserSessionId"]=F.data.request.get_headers()["X-UserSessionId"];408===F.data.httpStatus||503===F.data.httpStatus?e.ULS.sendTraceTag(538784582,220,50,JSON.stringify(D)):e.ULS.sendTraceTag(18392345,220,50,JSON.stringify(D))}else e.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",F.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+
w,void 0,void 0,void 0,["X-UserKey"])}}Object(y.a)(f,"S2SWebRequestManager",null,[])},1433:function(y,m,a){a.d(m,"a",function(){return n});y=a(0);var c=a(658),b=a(15),e=a(243);class k{constructor(v,f,w){this.iRf=r=>{try{if(r&&r.rawEvent&&r.rawEvent.origin&&this.iframe&&this.iframe.id){var t=this.ivg(r.rawEvent.origin);const l=this.ivg(document.domain);if(c.a.tm().equals(l,t))if(r.rawEvent.source&&r.rawEvent.source.frameElement&&r.rawEvent.source.frameElement.id&&c.a.tm().equals(r.rawEvent.source.frameElement.id,
this.iframe.id)){t=null;try{t=JSON.parse(r.rawEvent.data)}catch(x){b.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",x.message)}t?(t.statusCode!==e.a.NL||void 0!==t.error&&t.error?(b.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",t.statusCode,t.error),this.onError()):(b.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.p2(t.authorizationCode?t.authorizationCode:t.signInUrl)),$removeHandler(window,"message",this.iRf),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):b.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):b.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):b.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else b.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else b.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else b.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(l){b.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",l.message)}};this.iframe=v;this.p2=f;this.onError=w;$addHandler(window,"message",this.iRf)}ivg(v){let f="";try{v&&(f=-1<v.indexOf("//")?v.split("/")[2]:
v.split("/")[0])&&(f=f.split(":")[0],f=f.split("?")[0])}catch(w){b.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",w.message)}return f}static Ga(v,f,w){new k(v,f,w)}}Object(y.a)(k,"ResponseHandler",null,[]);var d=a(6),u=a(289);class n{constructor(v){this.pVa=v}tryAuthenticate(v,f){this.Ytb(n.coh,()=>{v()},f)}tryAuthorize(v,f){this.Ytb(n.Yih,v,f)}getSignInUrl(v,f){this.Ytb(n.RZe,v,f)}signOut(v,f){this.Ytb(n.puh,v,f)}Ytb(v,f,w){var r=new u.QueryStringBuilder("AuthenticationProxyHandler.aspx");
r.Op("responseType",v);d.AFrameworkApplication.Reb(r);r=String.format("{0}{1}&{2}",this.pVa,r.toString(),d.AFrameworkApplication.Oo);const t=document.createElement("iframe");t.setAttribute("id","privateCatalogIframe");t.setAttribute("name","privateCatalogIframe");t.setAttribute("style","display: none");c.a.tm().equals(v,n.RZe)||t.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");k.Ga(t,f,w);t.setAttribute("src",r);document.body.appendChild(t)}}n.Yih=
"authcode";n.coh="identitytoken";n.RZe="signinurl";n.puh="signout";Object(y.a)(n,"AuthenticationProxy",null,[])},1482:function(y,m,a){m=a(493)(!1);m.push([y.i,".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}",""]);y.exports=m},1483:function(y,m,a){a.d(m,"a",function(){return b});y=a(0);a(15);var c=a(6);class b{constructor(e,k,d,u){this.DFb=e;c.AFrameworkApplication.ea.ka("AddInCommandsMissingTabIsEnabled")&&
d.cRi();this.TG=k;this.Xth=u}get S0b(){return this.DFb}get solutionId(){return this.TG}get fte(){return this.Xth}u_a(e){e=this.S0b+this.solutionId+e;return this.fte?(e in b.doc||(b.doc[e]="AddinControl"+b.uGh++),b.doc[e]):e}Bof(e){if(this.fte){const d=b.doc;for(const u in d){var k=u;if(e===d[u])return k.substr(this.S0b.length+this.solutionId.length)}}return e}ENf(e){e=this.S0b+this.solutionId+e;return this.fte?(e in b.Zqd||(b.Zqd[e]="AddinTab"+b.KGh++),b.Zqd[e]):e}}b.doc={};b.Zqd={};b.KGh=0;b.uGh=
0;Object(y.a)(b,"DefaultRibbonNamingProvider",null,[291])},1562:function(y,m,a){a.d(m,"a",function(){return Q});y=a(0);var c=a(215),b=a(15),e=a(107);class k{constructor(){this.startTime=0;this.callback=null}}Object(y.a)(k,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(y.a)(d,"AccessTokenInformation",null,[358]);var u=a(1284);class n{constructor(){this.token=null;this.expiresOn=0;this.Nua=this.authChallenge=null}}Object(y.a)(n,"CachedTokenInfo",null,[]);class v{constructor(){this.vec=
new c.a;this.Pla=this.Ola=!1;this.LCa=this.authChallenge=null;this.startTime=this.retryCount=0;this.O6e=null}get callbacks(){return this.vec}}Object(y.a)(v,"SSORequestInfo",null,[]);class f extends v{constructor(){super();this.errorCode=0}}Object(y.a)(f,"SSOFailedRequestInfo",v,[]);var w=a(6),r=a(130),t=a(183);class l{static Mha(O,J,H,N){var L=O.startTime;let Z=0;0<L&&(Z=l.ZF()-L);L={["callInstanceId"]:L.toString(),["callDuration"]:Z.toString(),["errorCode"]:J.toString()};if(N)for(const ba in N)L[ba]=
N[ba];b.ULS.sendTraceTag(51401116,344,50,"{0}",L);t.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:r.a.xn(L)});O.callback(J,H)}static ZF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(O){}return Date.now()}}Object(y.a)(l,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class x{constructor(O,J,H,N){this.i4=new c.a;this.dR=new c.a;this.UDa=null;this.udb=new c.a;this.oSe=Promise.resolve(null);this.PZe=!1;this.Wjc=
J;this.aU=O;this.w_e=H;this.eih=N}static uuf(){return w.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ReduceAddinSSOThrottleErrors")}qOk(O){if(this.UDa&&this.UDa.authChallenge===O.authChallenge){if(Date.now()/1E3+x.rGj>this.UDa.expiresOn)return this.UDa=null,!1;O=new u.a;O.token=this.UDa.token;O.expiresOn=this.UDa.expiresOn;O.Nua=this.UDa.Nua;O.bRa=!0;O.JKa=0;this.fUb(O);return!0}return!1}MMk(O){for(let J=0;J<this.dR.count;J++)if(this.dR.ma(J).authChallenge===
O.authChallenge&&this.dR.ma(J).LCa===O.LCa){let H;(H=this.dR.ma(J)).retryCount=H.retryCount+1;O.retryCount=this.dR.ma(J).retryCount;if(this.dR.ma(J).retryCount<x.RGj||!this.dR.ma(J).Ola&&O.Ola||!this.dR.ma(J).Pla&&O.Pla){if(!this.dR.ma(J).Ola&&O.Ola||!this.dR.ma(J).Pla&&O.Pla)O.retryCount=0;this.dR.removeAt(J);break}O=new u.a;O.errorCode=this.dR.ma(J).errorCode;this.fUb(O);return!0}return!1}ABh(O,J){for(let H=0;H<this.dR.count;H++)if(this.dR.ma(H).LCa===O.LCa&&this.dR.ma(H).authChallenge===O.authChallenge)return;
this.dR.add(Object.assign(new f,{Ola:O.Ola,Pla:O.Pla,authChallenge:O.authChallenge,LCa:O.LCa,errorCode:J,retryCount:O.retryCount}))}get resource(){return this.Wjc}EKd(O,J,H,N,L,Z){""===H&&(H=null);if(this.PZe)l.Mha(Z,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var ba=null;for(const K of this.i4)if(K.Ola===O&&K.Pla===J&&K.authChallenge===H&&K.LCa===L){ba=K;break}ba||(ba=Object.assign(new v,{Ola:O,Pla:J,authChallenge:H,O6e:N,LCa:L,retryCount:0,startTime:l.ZF()}),this.i4.add(ba));
ba.retryCount=0;ba.callbacks.add(Z);this.oSe=this.oSe.then(()=>{if(0<this.i4.count){var K=this.i4.ma(0);if(this.qOk(K)||this.MMk(K))return null;for(var E=0;E<this.udb.count;)this.udb.ma(E)+x.p0k<l.ZF()?this.udb.removeAt(E):E++;E=x.uuf()?x.NGj:x.OGj;if(this.udb.count>=E||this.i4.count>=x.lGj)return K=new u.a,K.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.fUb(K),null;let U=null;w.AFrameworkApplication.ra&&(E=w.AFrameworkApplication.ra.GL)&&(U=E.Oi("ComponentAttach",this.aU+
x.Kuh));return K.LCa.lxh(this.resource,K.Ola,K.Pla,K.authChallenge,this.eih,K.O6e).then(X=>{U&&U.stop();this.fUb(X)},()=>{U&&U.stop();const X=new u.a;X.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.fUb(X)})}return null})}}fUb(O){try{if(this.i4.count){var J=this.i4.ma(0);this.i4.removeAt(0);var H=null;O.errorCode||(H=new d,H.accessToken=O.token);O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&
O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.ABh(J,O.errorCode);var N={};null!=O.JKa&&(N.getTokenSilentTime=O.JKa.toString());null!=O.ETb&&(N.getTokenPopupTime=O.ETb.toString());null!=O.iNd&&(N.getIDTokenTime=O.iNd.toString());null!=O.bRa&&(N.tokenCached=O.bRa.toString());O.Lxe&&(N.detailedError=O.Lxe);O.Nua&&(N.authLibrary=O.Nua);J.retryCount&&(N.retryCount=J.retryCount);for(var L of J.callbacks)l.Mha(L,
O.errorCode,H,N);if(x.uuf()){const Z=Number.isFinite(O.JKa)&&0<=O.JKa&&O.JKa<x.Avi;(0<O.ETb||!Z&&!O.bRa)&&this.udb.add(J.startTime)}else null!=O.bRa&&O.bRa||this.udb.add(J.startTime);if(!O.errorCode)for(null!=O.expiresOn&&(this.UDa=Object.assign(new n,{token:O.token,expiresOn:O.expiresOn,authChallenge:J.authChallenge,Nua:O.Nua})),this.dR.clear(),L=0;L<this.i4.count;)if(this.i4.ma(L).authChallenge===J.authChallenge){for(const Z of this.i4.ma(L).callbacks)l.Mha(Z,O.errorCode,H,N);this.i4.removeAt(L)}else L++}}catch(Z){b.ULS.sendTraceTag(21628945,
344,10,"ReceivedAccessTokenHandler: exception message: {0}",Z.message)}}shutdown(){this.PZe=!0;this.i4.clear()}}x.p0k=6E4;x.OGj=6;x.NGj=8;x.lGj=6;x.RGj=3;x.rGj=300;x.Avi=100;x.Kuh="GetAccessToken";Object(y.a)(x,"SSOCallbackManager",null,[]);var A=a(947),z=a(612),F=a(79),D=a(37),G=a(34);class Q{constructor(O,J,H){H=void 0===H?null:H;this.Z7c=new e.a;const N=new c.a;J&&N.add(J.FEj);H&&N.addRange(H);this.Er=O;this.Pvh=N}FKd(O,J,H,N,L,Z,ba,K,E,U){U=Object.assign(new k,{startTime:l.ZF(),callback:U});try{const Ma=
!!H&&""!==H;var X=U.startTime;const qa=this.getOsfControl(O);let Ha=qa.getStoreType()||"",ha=qa.getOwnerAddinStoreType()||"",La=qa.getSolutionId()||"";const fa=qa.getVersion()||"";Ha=Ha.toLowerCase();ha=ha.toLowerCase();La=La.toLowerCase();var ia=F.a.gNd(J)||"";const ja=F.a.gNd(qa.getIframeUrl())||"",ta=ia.toLowerCase()===ja.toLowerCase();ia=Ha;"inmemory"===Ha&&(ia=ha);const Ka=Telemetry.PrivacyRules.GetPrivacyCompliantId(La,ia,qa.getAssetId(),null,null,qa.getStoreId()),Ga={["callInstanceId"]:X.toString(),
["controlSolutionId"]:Ka,["controlVersion"]:fa,["storeType"]:Ha,["ownerStoreType"]:ha,["allowConsentPrompt"]:N.toString(),["forMSGraphAccess"]:L.toString(),["allowSignInPrompt"]:Z.toString(),["hasAddinAuthChallenge"]:Ma.toString(),["securityOriginEqualsSourceLocation"]:ta.toString(),["singleSignOnEnabled"]:ba.toString(),["accountTypeFilter"]:K||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",Ga);t.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:r.a.xn(Ga)});
X=!0;const Na=w.AFrameworkApplication.ea.Ya("HostAuthType");switch(K){case "aad":X="aad"===Na;break;case "msa":X="msa"===Na;break;default:X=!K||"noFilter"===K}if(X){K=null;if(ba)for(const cb of this.Pvh)if(cb.qlj(La)){K=cb;break}K?this.isSSOAddin(O)?(ba=!0,"omex"===ia&&(ba=!1),"spapp"===ia||"spcatalog"===ia?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),l.Mha(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):L&&!ba?(b.ULS.sendTraceTag(51234570,
344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),l.Mha(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(L&&"exchange"===ia&&(N=!1),this.EKd(O,J,H,ia,N,Z,E,K,U))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),l.Mha(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):l.Mha(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else l.Mha(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,
null,null)}catch(Ma){this.FMc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Ma.message),l.Mha(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(O,J,H,N){this.FKd(O,H[A.a.Xqd]||null,H[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,H[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,H[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,H[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||
!1,J,H[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,H[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,N)}EKd(O,J,H,N,L,Z,ba,K,E){this.Z7c.mh(O)?N=this.Z7c.ma(O):(N=new x(O,this.getWebApplicationResource(O).split(",")[0],N,this.getDefaultDisplayName(O)),this.Z7c.add(O,N));const U=N.resource;O=Q.oWi(U,this.getWebApplicationId(O));const X=OfficeExt.WACUtils.getHostSecure(J);O&&X?O.toLowerCase()===X.toLowerCase()?N.EKd(L,Z,H,ba,K,E):(Q.X3a('SSO Resource "'+
U+'" cannot be used from "'+J+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),l.Mha(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(O||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),X||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),l.Mha(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}FMc(){b.ULS.sendTraceTag(39068820,
344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(O){return this.Er.getOsfControl(O)}isSSOAddin(O){return this.getOsfControl(O).getManifest().isSSOAddin()}getWebApplicationId(O){return this.getOsfControl(O).getManifest().getWebApplicationId()}getWebApplicationResource(O){return this.getOsfControl(O).getManifest().getWebApplicationResource()}getDefaultDisplayName(O){return this.getOsfControl(O).getManifest().getDefaultDisplayName()}static kYi(){try{const O=
{};D.a.gMa&&z.a.WUb&&(O.UiHostSupportsAuthTokenAddinList=Q.tBf);O.UiHostSupportsAuthToken=z.a.WUb;return O}catch(O){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",O.message)}return null}static getInstance(O,J,H){Q.Va||(Q.Va=new Q(O,void 0===H?null:H));return Q.Va}static X3a(O){window.console.warn&&window.console.warn(O)}static oWi(O,J){if(!O)return"";J||(J="");let H=O.toLowerCase();var N=J.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(N)||
(Q.X3a('SSO App Id "'+J+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));H.endsWith(N)||(Q.X3a('SSO Resource "'+O+'" does not end with App Id "'+J+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!H.startsWith("https://")&&!H.startsWith("api://"))return Q.X3a('SSO Resource "'+O+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(J=0;J<O.length;J++){N=O.charAt(J);const L=G.a.charCodeAt(O,J);if(33>L||126<L||"&"===N||"?"===N||"#"===N||"%"===N||"\\"===N)return Q.X3a('SSO Resource "'+O+'" contains an invalid character "'+N+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+N+"' in resource URI."),""}if(0<=O.indexOf("::"))return Q.X3a('SSO Resource "'+O+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
O.length)return Q.X3a('SSO Resource "'+O+'" is '+O.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+O.length+"."),"";H.startsWith("api://")&&(H="https://"+H.substring(6,H.length));return 8===H.length?"":OfficeExt.WACUtils.getHostSecure(H)||""}}Q.tBf="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");
Q.Va=null;Object(y.a)(Q,"AppsForOfficeSingleSignOnManager",null,[330])},1571:function(y,m,a){a.r(m);a.d(m,"DdaEventDispatch",function(){return t});y=a(0);var c=a(15),b=a(154),e;(function(l){l[l.none=0]="none";l[l.testEvent=1]="testEvent";l[l.test1Event=2]="test1Event";l[l.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";l[l.worksheetActivatedEvent=11]="worksheetActivatedEvent";l[l.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";l[l.worksheetAddedEvent=13]="worksheetAddedEvent";
l[l.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";l[l.worksheetDeletedEvent=15]="worksheetDeletedEvent";l[l.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";l[l.worksheetFilteredEvent=17]="worksheetFilteredEvent";l[l.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";l[l.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";l[l.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";l[l.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";l[l.worksheetRowHiddenChangedEvent=
22]="worksheetRowHiddenChangedEvent";l[l.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";l[l.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";l[l.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";l[l.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";l[l.worksheetMovedEvent=27]="worksheetMovedEvent";l[l.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";l[l.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";
l[l.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";l[l.chartAddedEvent=50]="chartAddedEvent";l[l.chartActivatedEvent=51]="chartActivatedEvent";l[l.chartDeactivatedEvent=52]="chartDeactivatedEvent";l[l.chartDeletedEvent=53]="chartDeletedEvent";l[l.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";l[l.tableDataChangedEvent=101]="tableDataChangedEvent";l[l.tableAddedEvent=102]="tableAddedEvent";l[l.tableDeletedEvent=103]="tableDeletedEvent";l[l.tableFilteredEvent=
104]="tableFilteredEvent";l[l.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";l[l.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";l[l.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";l[l.commentAddedEvent=250]="commentAddedEvent";l[l.commentDeletedEvent=251]="commentDeletedEvent";l[l.commentChangedEvent=252]="commentChangedEvent";l[l.invocationMessage=1E3]="invocationMessage";l[l.cancellationMessage=1001]="cancellationMessage";l[l.metadataMessage=
1002]="metadataMessage";l[l.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";l[l.visualChangeEvent=2001]="visualChangeEvent";l[l.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";l[l.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";l[l.shapeActivatedEvent=2101]="shapeActivatedEvent";l[l.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";l[l.shapeAddedEvent=2103]="shapeAddedEvent";l[l.shapeDeletedEvent=2104]="shapeDeletedEvent";l[l.workbookAutoSaveSettingChangedEvent=
2200]="workbookAutoSaveSettingChangedEvent";l[l.wacOperationEvent=2201]="wacOperationEvent";l[l.recordingStateChangedEvent=2202]="recordingStateChangedEvent";l[l.workbookActivatedEvent=2203]="workbookActivatedEvent";l[l.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";l[l.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";l[l.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";l[l.linkedDataTypeRefreshModeChangedEvent=
2501]="linkedDataTypeRefreshModeChangedEvent";l[l.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";l[l.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";l[l.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";l[l.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";l[l.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";l[l.lineageActivityUpdateAvailableEvent=2800]=
"lineageActivityUpdateAvailableEvent";l[l.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";l[l.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";l[l.pivotTableAddedEvent=2900]="pivotTableAddedEvent";l[l.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";l[l.namedItemAddedEvent=3E3]="namedItemAddedEvent";l[l.namedItemDeletedEvent=3001]="namedItemDeletedEvent";l[l.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";
l[l.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";l[l.vbaRecorderRecordingChanged2Event=3202]="vbaRecorderRecordingChanged2Event";l[l.workbookActionRecordedEvent=3201]="workbookActionRecordedEvent";l[l.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";l[l.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";l[l.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";
l[l.applicationUndoChangedEvent=3500]="applicationUndoChangedEvent";l[l.linkedEntityDataDomainLinkedEntityDataDomainAddedEvent=3600]="linkedEntityDataDomainLinkedEntityDataDomainAddedEvent";l[l.linkedEntityDataDomainRefreshCompletedEvent=3601]="linkedEntityDataDomainRefreshCompletedEvent";l[l.linkedEntityDataDomainRefreshModeChangedEvent=3602]="linkedEntityDataDomainRefreshModeChangedEvent";l[l.externalCodeServiceInitializationSettingsOnEnvironmentDefinitionInitializationResponseReceivedEvent=3603]=
"externalCodeServiceInitializationSettingsOnEnvironmentDefinitionInitializationResponseReceivedEvent";l[l.tableApplyPowerQueryTableUpdatePlanCompletedEvent=3604]="tableApplyPowerQueryTableUpdatePlanCompletedEvent";l[l.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";l[l.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent";l[l.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent";l[l.premiumLicenseChangedEvent=65542]=
"premiumLicenseChangedEvent"})(e||(e={}));Object(y.b)("MessageType",e);var k=a(1003),d=a(288),u=a(958),n=a(61),v=a(40),f=a(200),w=a(1),r=a(5);class t{constructor(l,x){this.CK=null;this.G2g={};this.I2g={};this.nId={};this.J8d={};this.LRd=(A,z)=>{A=this.$.Eh.Oi("Task","DdaEventDispatch.HandleServerEvent");z=z.KOg;for(let Q=0;Q<z.length;Q++)switch(z[Q].EventType){case 2:var F=z[Q],D={};D.Name=F.Name;D.BindingType=F.BindingType;D.ColCount=F.ColCount;D.RowCount=F.RowCount;this.TKa(F.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,
D,null);break;case 4:this.TKa(z[Q].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(F=z[Q],F.InstanceId){D=Array(F.Entries.length);for(var G=0;G<F.Entries.length;G++)D[G]=t.aDc(F.Entries[G],F.IsRemoteOverride);0<F.Entries.length&&1===F.Entries[0].Category?this.Obk(F.InstanceId,D):F.InstanceId&&this.TKa(F.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,D)}else{this.nId={};this.J8d={};for(D=0;D<F.Entries.length;D++)this.srf(F.Entries[D],F.IsRemoteOverride);
F=JSON.stringify(this.nId);D=JSON.stringify(this.J8d);G=JSON.stringify(this.G2g);const O=JSON.stringify(this.I2g);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${F}, Number of Not Fired event: ${D}, Total Number of Fired event: ${G}, Total Number of Not Fired event: ${O}`)}}A.stop()};this.W7b=(A,z)=>{this.TKa(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,z)};this.$=l;this.ddaFacade=x;this.GYc=this.LRd}Knc(l){l&&(this.swa(),this.CK.push(l))}LVc(l){this.CK&&(Array.remove(this.CK,
l),this.CK.length||(this.$.wantServerEvents=!1,this.$.yqk(this.GYc),this.CK=null))}Obk(l,x){const A=r.yb.Ma()?this.ddaFacade:Object(b.a)(u.DdaFacade,d.a(this.$));v.TaskExtensions.$e(A.aTi(l),z=>{if(f.b(z)){var F=z.result;z=A.ks(F);if(F)if(z.mJc)this.TKa(F,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,x);else if(z.Suc)for(F=0;F<x.length;F++)z.Suc.push(x[F]);else z.Suc=x}else z.Jm?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):
z.so&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ya,0)}lck(l,x){const A=r.yb.Ma()?this.ddaFacade:Object(b.a)(u.DdaFacade,d.a(this.$)),z=A.ZEi(l);z?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(z,x,this.W7b):A.$4h(l,x)}srf(l,x){let A=!1;const z=parseInt(l.Type,10);var F=l.Target;const D=r.yb.Ma()?this.ddaFacade:Object(b.a)(u.DdaFacade,d.a(this.$));if((F=D.Zn.kTi(z,F))&&0<Object.keys(F).length){A=
!0;for(const Q in F)if(F=Q,D.Zn.gpc(F)){const O=Array(1);O[0]=t.aDc(l,x);if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var G=O[0][3];if(void 0!==G&&null!==G&&(G=Object(b.a)(Object,n.a.Vp(G)))&&void 0!==G.triggerControlId&&null!==G.triggerControlId&&void 0!==G.triggerSource&&null!==G.triggerSource){let J=!1;x?(G.triggerSource="Unknown",J=!0):D.iii(G.triggerControlId,F)&&(G.triggerSource="ThisLocalAddin",J=!0);J&&(O[0][3]=n.a.Di(G))}}this.TKa(F,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,O)}}A?(this.NFc(e[z],this.nId),this.NFc(e[z],this.G2g)):(this.NFc(e[z],this.J8d),this.NFc(e[z],this.I2g))}swa(){this.CK||(this.CK=[],this.$.n6e(this.GYc),this.$.wantServerEvents=!0)}NFc(l,x){l in x||(x[l]=0);x[l]+=1}TM(l,x,A){const z={};z.Target=x;z.Category=65536;z.Type=l;z.Message=A;z.Id=-1;this.srf(z,!1)}jyi(l,x){const A={Target:"",Category:2,Type:1E3};A.Message=x;A.Id=0;x=Array(1);x[0]=t.aDc(A,!1);this.lck(l,x)}rzc(l,x,A,z){const F={};F.Target=A;F.Category=65536;F.Type=x;F.Message=z;F.Id=
-1;x=Array(1);x[0]=t.aDc(F,!1);this.TKa(l,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,x)}iyi(l,x){this.TKa(l,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,x)}TKa(l,x,A,z){if(this.CK){var F=r.yb.Ma()?this.ddaFacade:Object(b.a)(u.DdaFacade,d.a(this.$));if(!F||x!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&x!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||F.Zn.gpc(l)){l=new k.a(x,l,A,z);for(let D=0,G=this.CK.length;D<G;D++)(x=this.CK[D])&&x(l)}}}static aDc(l,x){const A=Array(6);
A[0]=l.Category;A[1]=l.Type;A[2]=l.Target;A[3]=l.Message;A[4]=l.Id;A[5]=x;return A}}Object(y.a)(t,"DdaEventDispatch",null,[])},1609:function(y,m,a){a.d(m,"a",function(){return e});y=a(0);m=a(242);var c=a(491),b=a(24);class e extends m.a{constructor(){super(void 0,void 0,void 0,!0);this.USa="AddinCommandsUILessDialog";this.wmd="WACDialogTitleText";this.I9="0";this.hO=380;this.SL=190;this.fl=this.USa;this.Oh=5;this.Ekh=String.format("{0}px",this.hO);this.H9=String.format("{0}px",this.SL);this.IRf=this.xB=
!1;this.vG()}vG(){super.vG();this.Yo.style.width=this.Ekh;this.Yo.style.height=this.H9;this.Yo.style.padding=this.I9}yL(k){this.zT();document.getElementById(this.hp(this.wmd)).innerText=k}zT(){super.zT();this.rh.style.width=String.format("{0}px",this.hO);this.rh.style.height=String.format("{0}px",this.SL);this.rh.removeAttribute(c.a.fk);this.rh.removeAttribute(c.a.yU)}hide(){this.inb()}get Yma(){return this.Yo}initializeAndShowWithTitle(){this.initializeAndShow(Object(b.a)("NotificationUITitle"),
null,null)}}Object(y.a)(e,"AddinCommandsUILessDialog",m.a,[300])},1627:function(y,m,a){a.d(m,"a",function(){return d});y=a(0);var c=a(215),b=a(116);class e{constructor(){this.dtf=this.displayName=this.UMb=this.Pw=this.hL=null;this.isUpgraded=!1}B3f(u,n){return this.hL.getStoreType().toLowerCase()===u.toLowerCase()&&this.hL.getSolutionId().toLowerCase()===n.toLowerCase()}}Object(y.a)(e,"AddinCommandsResourceItem",null,[]);var k=a(24);class d{constructor(){this.a8c=null;this.rcd=0;this.ded=!1;this.ih=
new b.a;this.uoh=new c.a}eCh(u){this.ih.addHandler("AddinCommandsLoadingMessageChanged",u)}snk(u){this.ih.removeHandler("AddinCommandsLoadingMessageChanged",u)}get EGa(){return this.a8c}Exb(u){u!==this.a8c&&(this.a8c=u,this.ih.raiseEvent("AddinCommandsLoadingMessageChanged"))}bEk(){this.rcd++;this.EGa||this.Exb(Object(k.a)("LoadingAddInsTitle"))}fqe(){this.rcd--;this.zMc()&&(this.ded?this.EGa!==Object(k.a)("ErrorLoadingAddInsTitle")&&this.Exb(Object(k.a)("ErrorLoadingAddInsTitle")):this.Exb(null))}eQg(u){this.ded=
!0;this.Exb((void 0===u?0:u)?Object(k.a)("InstallingCustomFunctionsErrorStatusBarMsg"):Object(k.a)("ErrorLoadingAddInsTitle"))}xgf(){this.ded=!1;this.zMc()?this.Exb(null):this.Exb(Object(k.a)("LoadingAddInsTitle"))}zMc(){return 0>=this.rcd}get Snb(){return this.uoh}Kwa(u,n,v){v=void 0===v?0:v;for(const f of this.Snb)if(f.B3f(u,n)&&(!f.Pw||f.Pw.uEi===v))return f;return null}d4e(u,n,v,f){const w=new e;w.hL=u;w.Pw=n;w.UMb=v;w.displayName=f;this.Snb.add(w)}Xzh(u,n,v,f){const w=new e;w.hL=u;w.Pw=n;w.UMb=
null;w.dtf=v;w.displayName=f;this.Snb.add(w)}Dlk(u,n){let v=0;for(const f of this.Snb)f.hL.getStoreType()===u&&f.hL.getSolutionId()===n?this.Snb.removeAt(v):v++}static getInstance(){d.Va||(d.Va=new d);return d.Va}}d.Va=null;Object(y.a)(d,"AddinCommandsResourceManager",null,[])},367:function(y,m,a){function c(B,ra){var vb=document.getElementById(B);vb?ra?vb.innerHTML=ra:vb.remove():ra&&(vb=document.createElement("style"),vb.id=B,vb.type="text/css",vb.innerHTML=ra,document.head.appendChild(vb))}function b(B,
ra){B=B.map(vb=>{var dc;vb="AddinFlyoutControl"+vb;return`[data-icon-name=${vb}]::after {
      content: "";
      position: absolute;
      top: 9px;
      right: 18px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: ${null!==(dc=null===ra||void 0===ra?void 0:ra.palette.red)&&void 0!==dc?dc:"#CC4A31"};
      }
      @media screen and (-ms-high-contrast: active) {
        [data-icon-name=${vb}]::after {
          border: WindowText 1px solid;
        }
      }
      `}).join("");c("RedDotNotification",B)}function e(B,ra){B=B.map(vb=>{var dc,Hc,ed;vb="AddinFlyoutControl"+vb;return`[data-icon-name=${vb}]::after {
        content: "New";
        position: absolute;
        top: 6px;
        right: 10px;
        width: 30px;
        height: 16px;
        border-radius: 50%/100%;
        border: 1px solid;
        border-color: ${null!==(dc=null===ra||void 0===ra?void 0:ra.palette.SRa)&&void 0!==dc?dc:"white"};
        background-color: ${null!==(Hc=null===ra||void 0===ra?void 0:ra.palette.zxl)&&void 0!==Hc?Hc:"#0078D4"};
        color: ${null!==(ed=null===ra||void 0===ra?void 0:ra.palette.SRa)&&void 0!==ed?ed:"white"};
        font-size: 10px;
        font-style: normal;
    }
      @media screen and (-ms-high-contrast: active) {
        [data-icon-name=${vb}]::after {
          border-color: WindowText;
          color: WindowText;
        }
      }`}).join("");c("NewStringNotification",B)}function k(B){c("ButtonGroupHighlight",`#${B}[type="button"] { font-weight: 600; background-color: var(--legacy_themeDark); color: white; }`)}function d(B){return xo(function*(){let ra;for(let $d=0;10>$d;++$d)(ra=document.getElementById("fluent-default-layer-host"))||(yield new Promise(Ae=>setTimeout(Ae,1E3)));if(!ra)throw Error("Cannot find the flyout container.");let vb=!1,dc=performance.now(),Hc;const ed=$d=>{const Ae=performance.now();$d?(vb=!0,
B(!0,0),dc=Ae):vb&&(vb=!1,B(!1,Ae-dc))},Id=$d=>{Hc&&Hc.disconnect();const Ae=$d.querySelector('[id="InsertAddInFlyoutMenuId"]');Ae?(Hc=new MutationObserver(Ke=>{for(const Ze of Ke)"attributes"===Ze.type&&Ze.target instanceof HTMLElement&&("InsertAddInFlyoutMenuId"!==Ze.target.id?ed(!1):ed(!0))}),Hc.observe(Ae,{attributes:!0,attributeFilter:["id"]}),ed(!0)):(Hc=new MutationObserver(Ke=>{for(const Ze of Ke)"attributes"===Ze.type&&Ze.target instanceof HTMLElement&&("hidden"===Ze.target.style.visibility?
ed(!1):ed(!0))}),Hc.observe($d,{attributes:!0,attributeFilter:["style"]}),"hidden"!==$d.style.visibility&&ed(!0))},Pd=new WeakSet,Rd=new MutationObserver($d=>{for(const Ke of $d){for($d=0;$d<Ke.addedNodes.length;++$d){var Ae=Ke.addedNodes.item($d);Ae instanceof HTMLElement&&(Ae.querySelector('[id="Ribbon-InsertAddInFlyoutDropdown"]')||Ae.querySelector('[id="InsertAddInFlyoutMenuId"]'))&&(Id(Ae.querySelector(".ms-Callout-container")),Pd.add(Ae))}for($d=0;$d<Ke.removedNodes.length;++$d)Ae=Ke.removedNodes.item($d),
Pd.has(Ae)&&(Pd.delete(Ae),ed(!1))}});Rd.observe(ra,{attributes:!1,childList:!0});return{dispose:()=>{Rd.disconnect();null===Hc||void 0===Hc?void 0:Hc.disconnect()}}})}function u(B,ra){const vb=[];ra=new xj(ra);for(var dc=0;30>dc;dc++)Array.add(vb,ra.next(B.count));ra=0;for(const Hc of B){dc=!1;for(const ed of vb)if(ra===ed){dc=!0;break}ra++;if(dc){let ed;(ed=Hc.addinInfo).AUP=20*ed.AUP}else if(1===Hc.addinInfo.priority){let ed;(ed=Hc.addinInfo).AUP=4*ed.AUP}else if(2===Hc.addinInfo.priority){let ed;
(ed=Hc.addinInfo).AUP=2*ed.AUP}}B.Sc((Hc,ed)=>Hc.addinInfo.AUP<ed.addinInfo.AUP?1:-1);return B}function n(B){return Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.storeType,B.assetId,null,null,B.storeId)}function v(B,ra){return Object.assign(new B,ra)}function f(B,ra,vb){return`<a href="${ra}" target="${void 0===vb?"_blank":vb}" >${B}</a>`}function w(){const B=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");B&&(B.style.border="transparent",B.addEventListener("focus",()=>{const ra=
document.getElementById("AddinDialogControlSearchBox");ra&&ra.focus()},{once:!0}))}function r(B,ra,vb){c(B,ra?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${vb}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        margin-bottom: 14px;

        [id$="ErrorView"] {
          width: 100%;
          height: 102px;
          display: flex;
          flex-direction: row;

          >i {
            width: 100%;
            height: 102px;
            margin-left: 20px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin-top: 0;

            >label {
              font-weight: 600;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button {
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${vb}) {
          button {
          }
        }
      }
    }
  }

  .addin-flyout-highlight {
    transition: all 0.5s;
    background-color: var(--legacy_themeLighter);
  }

  .addin-flyout-highlighted {
    background-color: rgba(0, 0, 0, 0);
  }

  button[id^=FRECarouselSwitchIcon_LEFT], button[id^=FRECarouselSwitchIcon_RIGHT] {
    width: 16px;
    height: 18px;
    font-size: 8px;
    background-color: transparent;

    >span >i {
      font-weight: 600;
      color: var(--legacy_white);
    }

    cursor: pointer;
  }

  button[id^=FRECarouselSwitchIcon_MIDDLE] {
    width: 34px;
    height: 14px;
    font-size: 10px;
    background-color: transparent;

    >span >div {
      font-weight: 600;
      color: var(--legacy_white);
      margin: 0px;
      overflow-x: visible;
    }
  }

  [id=FRECarouselDescriptionIconView] {
    padding-left: 0;
    margin-left: 0;
  }

  [id=FRECarouselDescriptionIconView]>span {
    height: unset;
    background-color: var(--colorNeutralBackground1);
    padding: 6px 4px;
    box-sizing: border-box;
    border: 1px solid var(--border-color);
    display: inline-block;
    text-decoration: none;
    text-align: center;
    cursor: pointer;
    vertical-align: top;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 700;
    position: relative;
    word-break: keep-all;
    user-select: none;
    white-space: nowrap;
  }

  [id^=FRECarouselDescriptionIcon] {
    cursor: pointer;
  }
  `:"")}function t(){return Object(xc.a)("AddinsFlyoutSeeAllButtonText")}function l(B){const ra=Oh().Word[B];return ra?ra:"IPWAI"===B?Object(xc.a)("AddinsFREDescriptionWordAI"):"WF"===B?Object(xc.a)("AddinsFREDescriptionWordWriting"):"APID"===B?Object(xc.a)("AddinsFREDescriptionWordInsertGraphics"):"FlyoutBannerCommon"}function x(B,ra,vb){const dc=Id=>{switch(Id){case gi.LEFT:return Object(xc.a)("AddinsFRECarouselPreviousButton");case gi.RIGHT:return Object(xc.a)("AddinsFRECarouselNextButton");case gi.fka:return`${vb+
1} of ${ra}`;default:return""}},Hc=[gi.LEFT,gi.fka,gi.RIGHT],ed=v(Vj.a,{Id:"AddInFlyoutFREBanner",ExternalId:"AddInFlyoutFREBanner",IconName:"IPWAI"===B?"FREWordBannerAI":"WF"===B?"FREWordBannerWriting":"APID"===B?"FREWordBannerInsertGraphics":"FREWordBannerGPTForExcelWord"});return v(M.a,{ControlList:[...Hc.map(Id=>{var Pd=hk.a,Rd=Ag.a.M1c.toString();a:switch(Id){case gi.LEFT:var $d="ChevronLeft";break a;case gi.RIGHT:$d="ChevronRight";break a;default:$d=null}Pd=v(Pd,{Id:`FRECarouselSwitchIcon_${Id}_${ra}`,
ExternalId:`FRECarouselSwitchIcon_${Id}_${ra}`,Command:Rd,Icon:$d,FullIconStyle:{["root"]:{position:"absolute",width:"100%",height:"100%"}},Role:"button",Alt:dc(Id),LabelText:Id===gi.fka?`${vb+1} of ${ra}`:null});Pd=v(vk,{SectionId:"FRECarouselSwitchIconSection_"+Id,GalleryButtons:[Pd]});return v(gk.a,{Id:"FRECarouselSwitchButton_"+Id,ExternalId:"FRECarouselSwitchButton_"+Id,GalleryStyle:{["galleryStack"]:{["root"]:{position:"absolute",maxWidth:"unset",width:Id===gi.fka?"35px":"16px",height:"18px",
padding:"0px",zIndex:Id===gi.fka?"2":"3",top:"79px",left:Id===gi.LEFT?"267px":Id===gi.fka?"279px":"309px",borderRadius:Id===gi.LEFT?"18px 0px 0px 18px":Id===gi.fka?"none":"0px 18px 18px 0px",backgroundColor:"var(--legacy_themeDarker)"},["inner"]:{margin:"0px",width:Id===gi.fka?"34px":"18px",height:"18px"}}},Type:4,GallerySections:[Pd],DismissHostingSurfaceOnExecute:!1})}),ed,v(gk.a,{Id:"FRECarouselDescription",ExternalId:"FRECarouselDescription",GalleryStyle:{["galleryStack"]:{["root"]:{["maxWidth"]:"100%",
["padding"]:"0px",["cursor"]:"pointer"},["inner"]:{["padding"]:"2px",["flex-wrap"]:"nowrap"}},["galleryButtonInExpanded"]:{["root"]:{"white-space":"normal",backgroundColor:"transparent",textAlign:"left",width:"unset",height:"unset",fontWeight:500,fontSize:13,padding:"4px 6px 8px"},["flexContainer"]:{},["label"]:{}}},Type:4,GallerySections:[v(vk,{SectionId:"FRECarouselDescriptionSection",GalleryButtons:[v(hk.a,{Id:"FRECarouselDescriptionIcon",Command:Ag.a.L1c.toString(),ExternalId:"FRECarouselDescriptionIcon",
FullIconStyle:{["root"]:{["display"]:"none"}},Alt:l(B),Role:"button",LabelText:l(B)}),v(hk.a,{Id:"FRECarouselDescriptionIconView",Command:Ag.a.L1c.toString(),ExternalId:"FRECarouselDescriptionIconView",FullIconStyle:{["root"]:{["display"]:"none"}},Alt:t(),Role:"button",LabelText:t()})]})],DismissHostingSurfaceOnExecute:!1})]})}function A(B,ra,vb){c(B,ra?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${vb}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        margin-bottom: 5px;

        [id$="ErrorView"] {
          width: 100%;
          height: 102px;
          display: flex;
          flex-direction: row;

          >i {
            width: 100%;
            height: 102px;
            margin-left: 20px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin-top: 0;

            >label {
              font-weight: 600;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button[role="menuitem"] {
          margin-left: 0px;
          width: 100%;
          padding: 15px 13px;
          box-sizing: border-box;

          >i {
            border: none;
            min-width: 36px;
            height: 36px;
            padding: 3px;
            background-color: #fff;
          }

          >div>div>span {
            white-space: normal;
            text-align: left;
            margin-bottom: 5px;
          }

          &:hover {
            background-color: transparent;
            border-color: transparent;
          }

          &:focus {
            background-color: transparent;
          }
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${vb}) {
          button[role="menuitem"] {
            &:hover {
              background-color: highlight;
            }
          }
        }
      }
    }
  }
  `:"")}function z(B,ra,vb){c(B,ra?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${vb}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        padding-bottom: 5px;

        [id$="ErrorView"] {
          width: 100%;
          height: 100%;
          display: flex;
          flex-direction: column;

          >i {
            width: 100%;
            height: 102px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin: 0;
            padding: 0;
            width: 100%;

            [id="AddInFlyoutPopularBannerGroupMessage"] {
              min-width: 100%;
              padding: 8px 12px 4px 12px;
              font-weight: 600;
              font-size: 12px;
              line-height: 16px;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button[role="menuitem"] {
          width: 306px;
          padding: 4px 8px;
          margin: 6px 12px 8px 12px;
          box-sizing: border-box;
          background-color: var(--colorNeutralBackground1);

          >div>div {
            font-size: 12px;

            >span {
              white-space: normal;
              text-align: left;
              font-size: 12px;
              font-weight: 600;
              line-height: 16px;
            }
          }
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${vb}) {
          button[role="menuitem"] {
            background-color: transparent;

            &:hover {
              background-color: highlight;
            }
          }
        }
      }
    }
  }
  `:"")}function F(B,ra){if(!B)switch(ra){case "Word":return["wa200005502","wa200001011","wa200000368"];case "Excel":return["wa200005502"];case "PowerPoint":return["wa200005566"];default:return[]}return B.split("|")}function D(B,ra){var vb;return(null===(vb=Oh()[B])||void 0===vb?void 0:vb[ra])||Oh().cLk[ra]||""}function G(B,ra){a:{var vb=ra.solutionId;switch(null===vb||void 0===vb?void 0:vb.toLowerCase()){case "wa200005502":if("Word"===B){vb="FREWordBannerGPTForExcelWord";break a}if("Excel"===B){vb=
"FREBannerGPTForExcelWord";break a}}vb="FlyoutBannerCommon"}a:{var dc;switch(B){case "Excel":B="Boost your productivity in Excel with this ChatGPT add-in.";break a;case "PowerPoint":B=null!==(dc=Object(xc.a)("AddinsFlyoutFREDescriptionPPT"))&&void 0!==dc?dc:"Elevate your slides! Add-ins for flawless presentations.";break a;default:B="Boost your productivity in Word with this ChatGPT add-in."}}ra=v(kk.a,{Id:"AddInFlyoutPopularBannerAction",iconSet:null,ExternalId:"AddInFlyoutPopularBannerAction",CommandId:"AddInFlyoutPopularBannerAction",
CommandIdMapped:Ag.a.D3a.toString(),SecondaryLabel:null,Label:B,ActionText:Object(xc.a)("AddinListAdd"),Links:[v(Nk,{text:Object(xc.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+ra.solutionId})],ActionId:Ag.a.qya.toString(),ActionIdMapped:Ag.a.qya.toString(),ActionCommandValueId:ra.solutionId,CommandValueId:ra.solutionId});ra=[v(Vj.a,{Id:"AddInFlyoutPopularBanner",ExternalId:"AddInFlyoutPopularBanner",IconName:vb}),ra];return v(M.a,{ControlList:ra})}function Q(B){B.MenuSectionList.some(ra=>
ra.ControlList.some(vb=>"AddInFlyoutPopularBanner"===vb.Id))||A("PopularBanner",!1,-1)}function O(B){B.MenuSectionList.some(ra=>ra.ControlList.some(vb=>"AddInFlyoutPopularBannerGroup"===vb.Id))||z("PopularBannerGroup",!1,-1)}function J(B,ra,vb,dc,Hc,ed,Id){dc.concat(Hc).find(Pd=>Pd.solutionId.toLowerCase()===B.solutionId.toLowerCase())?ra.MenuSectionList.push(vb):(dc=G(Id,B))?(Hc=ra.MenuSectionList.some(Pd=>"MRUAddinsSection"===Pd.Id),ed=ed&&Hc?2:3,ra.MenuSectionList.push(v(M.a,Object.assign({},vb,
{ControlList:vb.ControlList.slice(0,ed)}))),ra.MenuSectionList.push(dc),A("PopularBanner",!0,ra.MenuSectionList.length),ra.MenuSectionList.push(v(M.a,Object.assign({},vb,{ControlList:vb.ControlList.slice(ed),Title:null})))):ra.MenuSectionList.push(vb)}function H(B,ra){ra=ra.filter(dc=>!!dc&&!!dc.solutionId).map(dc=>{const Hc=`${"AddInFlyoutPopularBannerGroup"}_${dc.solutionId}`;return v(kk.a,{Id:Hc,ExternalId:Hc,CommandId:Hc,CommandIdMapped:Ag.a.D3a.toString(),iconSet:{default:"AddinFlyoutControl"+
dc.solutionId},SecondaryLabel:null,Label:dc.displayName,Description:dc.description,ActionText:Object(xc.a)("AddinListAdd"),Links:[v(Nk,{text:Object(xc.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+dc.solutionId})],ActionId:Ag.a.qya.toString(),ActionIdMapped:Ag.a.qya.toString(),ActionCommandValueId:dc.solutionId,CommandValueId:dc.solutionId})});var vb="Word"===B?"FREWordBannerAI":"FlyoutBannerCommon";B=D(B,"IPWAI");B=[v(Vj.a,{Id:"AddInFlyoutPopularBannerGroup",ExternalId:"AddInFlyoutPopularBannerGroup",
IconName:vb,Label:B,AriaDescription:B}),...ra];return v(M.a,{ControlList:B})}function N(B,ra,vb,dc,Hc,ed,Id){B=null===B||void 0===B?void 0:B.filter(Pd=>!!Pd&&!!Pd.solutionId);if(0!==(null===B||void 0===B?void 0:B.length)){dc=dc.concat(Hc);if(0<(null===dc||void 0===dc?void 0:dc.length)){const Pd=dc.filter(Rd=>!!Rd&&!!Rd.solutionId).map(Rd=>Rd.solutionId.toLowerCase());B=B.filter(Rd=>!Pd.includes(Rd.solutionId.toLowerCase()))}0<(null===B||void 0===B?void 0:B.length)?(Id=H(Id,B))?(dc=ra.MenuSectionList.some(Pd=>
"MRUAddinsSection"===Pd.Id),ed=ed&&dc?2:3,ra.MenuSectionList.push(v(M.a,Object.assign({},vb,{ControlList:vb.ControlList.slice(0,ed)}))),ra.MenuSectionList.push(Id),z("PopularBannerGroup",!0,ra.MenuSectionList.length),ra.MenuSectionList.push(v(M.a,Object.assign({},vb,{ControlList:vb.ControlList.slice(ed),Title:null}))),ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutShowBannerGroupInPopular",dataFields:Ne.a.ZOa({["addins"]:null===B||void 0===B?void 0:B.map(Pd=>Pd.solutionId)})})):
ra.MenuSectionList.push(vb):ra.MenuSectionList.push(vb)}}function L(B){const ra=document.createElement("div");ra.innerHTML=`
  ${'<svg style="animation: addin-flyout-bounce 1.5s infinite;" width="16" height="10" viewBox="0 0 9 6" xmlns="http://www.w3.org/2000/svg">\n  <path class=\'OfficeIconColors_HighContrast\' d="M7.89612 4.86822C8.09952 5.07162 8.42929 5.07162 8.63269 4.86822C8.83609 4.66482 8.83609 4.33505 8.63269 4.13165L4.86926 0.36822C4.76734 0.266293 4.63367 0.215444 4.50008 0.215672C4.36676 0.215652 4.23343 0.266502 4.13171 0.368221L0.368285 4.13165C0.164887 4.33505 0.164887 4.66482 0.368285 4.86822C0.571683 5.07162 0.901456 5.07162 1.10485 4.86822L4.50049 1.47259L7.89612 4.86822Z"/>\n  <path style="fill: var(--colorNeutralForeground1)" d="M7.89612 4.86822C8.09952 5.07162 8.42929 5.07162 8.63269 4.86822C8.83609 4.66482 8.83609 4.33505 8.63269 4.13165L4.86926 0.36822C4.76734 0.266293 4.63367 0.215444 4.50008 0.215672C4.36676 0.215652 4.23343 0.266502 4.13171 0.368221L0.368285 4.13165C0.164887 4.33505 0.164887 4.66482 0.368285 4.86822C0.571683 5.07162 0.901456 5.07162 1.10485 4.86822L4.50049 1.47259L7.89612 4.86822Z"/>\n  </svg>'}
  <div style="font-weight: 600; font-size: 18px; font-family: "Segoe UI Semibold", "Segoe UI Semibold_EmbeddedFont", "Segoe UI Semibold_MSFontService", sans-serif;">${B}</div>`;return ra}function Z(){const B=[];document.body.querySelectorAll('\n  [id="Ribbon-InsertAddInFlyoutDropdown"] [class^="container-"], [id="InsertAddInFlyoutMenuId"] [class^="container-"]').forEach(ra=>{B.push(ra)});return B}function ba(){c("AppsFlyoutScrollIndicator","\n  @keyframes addin-flyout-bounce {\n    0% {\n      transform: translateY(0);\n    }\n    50% {\n      transform: translateY(-5px);\n    }\n    100% {\n      transform: translateY(0);\n    }\n  }\n  ");
d(B=>{var ra;if(B&&!("MRUAddinsGalleryControl"in appChrome.selectors.getFlyoutAnchorMenuItems("InsertAddInFlyout"))){var vb=Z();if(0!==vb.length){B=dc=>{if(!(0>=dc.deltaY)){dc=dc.currentTarget;var Hc=dc.querySelector("#apps-flyout-scroll-indicator");!Hc||10>dc.scrollTop||(Hc.style.opacity="0",ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutFREScrolled"}))}};for(const dc of vb)dc.style.position="relative",dc.removeEventListener("wheel",B),dc.addEventListener("wheel",B),null===(ra=
dc.querySelector("#apps-flyout-scroll-indicator"))||void 0===ra?void 0:ra.remove(),vb=L(Object(xc.a)("AddinsFlyoutScrollDownHintText")||"Scroll up to explore more!"),vb.setAttribute("style","pointer-events: none; transition: all 0.5s ease-out; padding: 30px 0 5px 0; width: 100%; position: fixed; left: 0; bottom: 69px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: linear-gradient(rgb(from var(--colorNeutralBackground1) r g b / 0%) 5px, rgb(from var(--colorNeutralBackground1) r g b / 80%), rgb(from var(--colorNeutralBackground1) r g b / 90%));"),
vb.id="apps-flyout-scroll-indicator",dc.appendChild(vb)}}})}a.r(m);var K={};a.r(K);a.d(K,"AgaveCommandHandler",function(){return ka});var E={};a.r(E);a.d(E,"AgaveListenerHandler",function(){return Oa});var U={};a.r(U);a.d(U,"AgaveOnSelectedReadoutHandler",function(){return Ja});var X={};a.r(X);a.d(X,"DdaMethodHandler",function(){return af});var ia={};a.r(ia);a.d(ia,"MacroRecorderEventHandler",function(){return Hi});var Ma={};a.r(Ma);var qa={};a.r(qa);a.d(qa,"SmartLookupCommandHandler",function(){return lg});
var Ha=a(127),ha=a(0),La=a(6),fa=a(960),ja=a(23),ta=a(25),Ka=a(40),Ga=a(1),Na=a(212),cb=a(36),jb=a(365),Sa=a(5),bb=a(792),oa=a(92);let ka=class{constructor(B,ra){this.$=B;this.agaveCommandManager=ra;this.ate=vb=>La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",!1)&&"InsertMoreAddInsFromFooter"===(null===vb||void 0===vb?void 0:vb.SourceControlId)?!0:!1;this.ha=ja.f(this.$).ha;this.pa=this.ha.pa}dj(){return!1}Ri(){return!1}Ei(B,ra,vb,dc){let Hc=
!1;switch(ra.command){case -684355545:Hc=!0;break;case -741808261:Hc=!!vb;break;case -859308420:Hc=!!dc&&1===dc.sM;break;case 418618014:Hc=1===B&&!!dc&&1===dc.sM;break;case -167264441:Hc=ta.a.eXb(this.$)&&1===B&&!!dc&&1===dc.sM;break;case -515602470:Hc=1===B&&!!dc&&1===dc.sM;break;case -1444574190:case -336193495:Hc=1===B&&!!dc&&1===dc.sM;break;case 1296389134:Hc=!this.ate(vb)&&1===B&&!!dc&&1===dc.sM;break;case 1221897806:Hc=Ga.EwaSettings.Na(155)&&2===B;break;case 1172793074:case 1930653487:Hc=Ga.EwaSettings.Na(155)&&
2===B;break;case -1753056834:Hc=!0;break;case 932597253:Hc=!0;break;case 301511274:Hc=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Hc=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!0)&&this.$.isEditMode;break;case 1723441034:Hc=this.$.isEditMode&&this.$.fa.j9b;break;case -1997160483:Hc=ta.a.qV()&&this.$.isEditMode&&this.pa.hJ();break;case 1485761473:Hc=ta.a.qV()&&this.$.isEditMode;break;case 762629271:Hc=
ta.a.qV()&&Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")}return Hc}executeCommand(B,ra,vb){B=Ka.TaskExtensions.Yq();const dc=ra.command;switch(ra.command){case 1296389134:La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",!1)&&fa.a.instance.getItem("removeFlyoutTaskTimeoutId")&&(window.clearTimeout(Number(fa.a.instance.getItem("removeFlyoutTaskTimeoutId"))),fa.a.instance.removeItem("removeFlyoutTaskTimeoutId"));
this.agaveCommandManager.MWk(vb.SourceControlId,vb.LabelText);break;case -684355545:this.agaveCommandManager.Avd();break;case -741808261:B=this.agaveCommandManager.insertAgave(vb,ra);break;case 1172793074:Ga.EwaSettings.Na(155)&&(B=this.agaveCommandManager.rRd(vb,ra));break;case -1997160483:case 1485761473:if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")&&this.Nii()){this.D6h();break}B=this.agaveCommandManager.rRd(vb,ra);break;case -859308420:case -515602470:case -167264441:case -336193495:case -1444574190:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:case 762629271:B=
this.agaveCommandManager.rRd(vb,ra);Ga.EwaSettings.tS()&&this.$.VCa();break;default:B=Na.a(dc)}return B}Nii(){var B=this.$.kk;const ra=B.get(1),vb=B.get(4);B=B.get(117);return(ra||vb)&&!B}D6h(){const B=cb.a.nj(1,1,751,2407,0,0,"CopilotNoExtractPermissionsErrorDialog");new jb.a(this.$,B)}};ka=Object(Ha.__decorate)([Object(oa.d)(Sa.h),Object(Ha.__param)(0,Object(Sa.Ob)()),Object(Ha.__param)(1,Object(bb.a)())],ka);Object(ha.a)(ka,"AgaveCommandHandler",null,[36]);var ya=a(15);let Oa=class{constructor(B){this.$=
B;this.WQf=ra=>{if(null!==ra&&void 0!==ra&&ra.data&&(ra=ra.data)&&"OfficeCopilotExcelTaskPane"===ra.Origin)switch(ra.Event){case "Office.Excel.Copilot.AnalyzeReceived":this.xda(-168711560);break;case "Office.Excel.Copilot.GenerateReceived":this.xda(-1805433217);break;case "Office.Excel.Copilot.CommandReceived":this.xda(-112212005);break;case "Office.Excel.Copilot.AnalyzeApplied":this.xda(347349230);break;case "Office.Excel.Copilot.GenerateApplied":this.xda(-2005275355);break;case "Office.Excel.Copilot.CommandApplied":this.xda(306959157);
break;default:ya.ULS.sendTraceTag(508044939,0,10,"AgaveListenerHandler.handleMessageReceived - Unhandled Event.")}}}addListener(){window.addEventListener("message",this.WQf,!1)}removeListener(){window.removeEventListener("message",this.WQf,!1)}xda(B){this.$.oi(B,-1,0,null)}};Oa=Object(Ha.__decorate)([Object(oa.d)(Sa.i),Object(Ha.__param)(0,Object(Sa.Ob)())],Oa);Object(ha.a)(Oa,"AgaveListenerHandler",null,[]);var za=a(95),ea=a(361),Aa=a(154),ub=a(58),rb=a(54);let Ja=class{constructor(B,ra){this.D6a=
this.E6a=null;this.o3g=(vb,dc)=>{let Hc=null,ed=null,Id=null;dc?(Object(ea.a)(252,dc)?(Hc=dc.sJb,Id=dc.instanceId):Object(ea.a)(409,dc)&&(Hc=dc.get_element(),Id=dc.instanceId),Hc)?(ed=Object(Aa.a)(254,vb),ed)?this.yCg(Id,Hc,ed)||Id in this.D6a||(this.E6a[Id]=0,this.D6a[Id]=ub.a.instance.$O(()=>{10<=this.E6a[Id]||this.yCg(Id,Hc,ed)?(delete this.E6a[Id],this.D6a[Id].dispose(),delete this.D6a[Id]):this.E6a[Id]+=1},500,rb.a.yHh,!0,!1)):ya.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):
ya.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):ya.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=B;this.$=ra;this.Usd=!1}Ga(B){this.Usd?ya.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.Usd=!0,this.D6a={},this.E6a={},B?B.UCh(this.o3g):ya.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(B){if(B){B.cok(this.o3g);
B=this.D6a;for(const ra in B)za.a.gh(B[ra]);this.E6a=this.D6a=null;this.Usd=!1}else ya.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}yCg(B,ra,vb){if(this.Whj(vb,B))return!1;B=ra.querySelector("iframe");if(!B)return ya.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;B=B.title;if(!B||!B.length)return ya.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),
!0;this.ariaLiveNotifier.readText(B);return!0}Whj(B,ra){return(B=B.Fl.getOsfControl(ra))?B.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};Ja=Object(Ha.__decorate)([Object(oa.d)(Sa.j),Object(Ha.__param)(0,Object(Sa.l)()),Object(Ha.__param)(1,Object(Sa.Ob)())],Ja);Object(ha.a)(Ja,"AgaveOnSelectedReadoutHandler",null,[410]);var Xa=a(958),Y=a(1562);class Ia{constructor(){this.context=null;this.errorCode=0}}Object(ha.a)(Ia,"NestedAppAuthContextResult",null,[]);class $a{static YNd(B,ra){const vb=
new Ia;(B=B.getOsfControl(ra))&&B.isFirstParty()?(vb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,B={},ra=La.AFrameworkApplication.ea.Ya("AADUserObjectId"),B.userObjectId=ra?ra:La.AFrameworkApplication.ea.Ya("LoggableUserId"),B.userPrincipalName=La.AFrameworkApplication.ea.Ya("UserPrincipalName"),B.tenantId=La.AFrameworkApplication.ea.Ya("TenantId"),B.puid=La.AFrameworkApplication.ea.Ya("Puid"),B.authorityBaseUrl=La.AFrameworkApplication.ea.Ya("HostAuthAuthority"),ra=(La.AFrameworkApplication.ea.Ya("HostAuthType")||
"").toLowerCase(),B.authorityType="aad"===ra?"aad":"msa"===ra?"msa":"other",vb.context=B):vb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return vb}}Object(ha.a)($a,"NestedAppAuthUtil",null,[]);var Ea=a(1141),Lb=a(1284),Ib=a(1197);class Mb{}Mb.generalException="generalException";Mb.invalidArgument="invalidArgument";Mb.qgg="notAllowed";Mb.Goc="apiNotAvailable";Mb.c8k="unresolvedPendingRequest";Mb.timeout="timeout";Mb.Mod="adalTimeout";Mb.pCe="userNotSignedIn";Mb.zAb="userAborted";
Mb.JXg="silentSignInFailed";Mb.Unb="invalidResourceUrl";Mb.BGc="invalidGrant";Mb.Bjf="connectionLost";Mb.msc="clientError";Mb.serverError="serverError";Object(ha.a)(Mb,"WopiHostErrorCodes",null,[]);var mc=a(947),jc=a(612);class Fc{}Object(ha.a)(Fc,"OAuthCallerMetadata",null,[]);var Gc=a(37),xc=a(24);class Uc{constructor(B){this.Lza=B;this.Ylh=La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}lxh(B,ra,vb,dc,Hc,ed){if(!this.Lza)return dc=new Lb.a,
dc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(dc);const Id=new Fc;Id.AddinName=Hc;Id.AddinTrustId=ed;let Pd=-1,Rd=-1;ed=null;const $d=La.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.EnableAddinPopupTimerTelemetry"),Ae=(Ke,Ze,cg,Vf,Xf)=>{const Pf=Date.now();return this.Lza.A$a(Ke,Ze,cg,Vf,Xf).then(Kg=>{Rd=Date.now()-Pf;return Kg})};if(dc&&this.Y0f())ed=$d?Ae(mc.a.lzb,B,dc,Uc.NCc(Hc),Id):this.Lza.A$a(mc.a.lzb,B,dc,Uc.NCc(Hc),
Id);else{const Ke=Date.now();ed=this.Lza.nF(mc.a.lzb,B,Id).then(Ze=>{Pd=Date.now()-Ke;const cg=(ra||vb)&&("login_required"===Ze.ErrorCode||"Cookies Disabled"===Ze.ErrorCode);return(ra&&("interaction_required"===Ze.ErrorCode||"consent_required"===Ze.ErrorCode||"invalid_grant"===Ze.ErrorCode||"UserInteractionRequired"===Ze.ErrorCode)||cg)&&this.Y0f()?$d?Ae(mc.a.lzb,B,null,Uc.NCc(Hc),Id):this.Lza.A$a(mc.a.lzb,B,null,Uc.NCc(Hc),Id):Promise.resolve(Ze)})}return ed.then(Ke=>{const Ze=new Lb.a;Ke.IsSuccess?
(Ze.token=Ke.Token,Ke.Telemetry&&(Ze.bRa=Ke.Telemetry.fromCache,Ze.expiresOn=Ke.Telemetry.expiresOn)):(Ze.errorCode=this.DFj(Ke),Ze.Lxe=this.Z5j(Ke));return Ze}).catch(()=>{const Ke=new Lb.a;Ke.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Ke)}).then(Ke=>{Ke.Nua="OauthManager";0<=Pd&&(Ke.JKa=Pd);0<=Rd&&(Ke.ETb=Rd);return Ke})}qlj(B){const ra=(La.AFrameworkApplication.ea.Ya(La.AFrameworkApplication.o_)||"").toLowerCase();return(La.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.Enable3rdPartySsoApiForTeams")||
!(Gc.a.gMa||"teams"===ra&&jc.a.WUb)||Uc.Vkj(B))&&this.Lza&&this.Lza.x1a()?!0:!1}Y0f(){return this.Ylh||1!==Ib.a.CAc()}DFj(B){switch(B.ErrorCode){case "UserCancelled":case "interaction_required":B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "UserInteractionRequired":case "consent_required":case "invalid_grant":B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":B=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":B=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:B=B.ErrorCode===Mb.zAb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:B.ErrorCode===Mb.JXg?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:B.ErrorCode===Mb.Unb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:B.ErrorCode===
Mb.BGc?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:B.ErrorCode===Mb.Bjf?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return B}Z5j(B){let ra="";(B=RegExp("AADSTS(\\d+)").exec(B.ErrorMessage))&&1<B.length&&(ra=B[1]);return ra}static NCc(B){return String.format(Object(xc.a)("SSOSignInNeededNotification_Description_Text_Addins"),B)}static Vkj(B){if(!B)return!1;B=B.toLowerCase();for(const ra of Y.a.tBf)if(ra===B)return!0;return!1}}
Object(ha.a)(Uc,"AppsforOfficeTokenFromOauthManager",null,[381]);class Pa{constructor(B){this.FEj=B}static $Ca(){if(La.AFrameworkApplication.ea.ka("AppForOfficeSSOV2IsEnabled")){var B=null;try{B=Object(Ea.a)()}catch(ra){ya.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ra)}B=new Uc(B);Pa.Va=new Pa(B)}}static getInstance(){Pa.mPe||(Pa.$Ca(),Pa.mPe=!0);return Pa.Va}}Pa.Va=null;Pa.mPe=!1;Object(ha.a)(Pa,"AppsForOfficeOauthManagerFactory",null,[366]);var Bb=a(224),Nb=a(191),oc=
a(1464),aa=a(190);class rc{constructor(B,ra,vb,dc){this.menuItemId=B;this.kF=ra;this.cYk=vb;this.qwi=dc}}Object(ha.a)(rc,"NewDocumentParameters",null,[]);var yb=a(10);const Fb=B=>{var ra=B.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var vb=ra.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);vb.addParameter("shortcuts","String[]",1,null,0);ra.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",
0);vb=ra.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);vb.addParameter("shortcuts","Object",1,null,0);ra=B.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);vb=ra.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);vb.addParameter("pickerCustomizationJsonString","String",1,null,0);ra=B.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",
3,2);vb=ra.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);vb.addParameter("appName","String",1,null,0);vb.addParameter("target","String",1,null,0);ra=B.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);ra.addProperty("Data",4,"String",1,!1,null,0);ra=B.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",
3,2);vb=ra.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);vb.addParameter("data","String",1,null,0);ra.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);ra.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);ra=B.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);ra.addProperty("BatchId",6,"String",
1,!1,null,0);ra=B.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);vb=ra.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);vb.addParameter("batchId","String",1,null,0);vb=ra.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);vb.addParameter("batchId","String",1,null,0);ra.addMethod("Undo",1,"Boolean",1,0,"Undo",4);ra.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",
4);ra.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);ra=B.addEnumType("Microsoft.Office.UserFeedbackType");ra.addEnumField("Like",0);ra.addEnumField("Dislike",1);ra.addEnumField("Idea",2);ra.addEnumField("Unclassified",3);ra=B.addEnumType("Microsoft.Office.UserFeedbackUIType");ra.addEnumField("ModalDialog",0);ra.addEnumField("Taskpane",1);ra=B.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",
3,2);ra.addMethod("CanCollectUserFeedback",27,"Boolean",1,1,"CanCollectUserFeedback",4);vb=ra.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);vb.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);vb.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);vb.addParameter("featureArea","String",1,null,0);vb.addParameter("options","Object",1,null,0);ra.addMethod("_RegisterUserFeedbackResponseEvent",28,"Void",0,1,"_RegisterUserFeedbackResponseEvent",
4);ra.addMethod("_RegisterUserFeedbackUIDismissedEvent",18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);ra.addMethod("_UnregisterUserFeedbackResponseEvent",29,"Void",0,1,"_UnregisterUserFeedbackResponseEvent",4);ra.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);ra=B.addType("Microsoft.Office.NotificationService","{d9d9f329-4dbd-46fd-937d-8534fca075f2}","{f665e4ed-18e6-496d-9693-4622a232c1bc}",3,2);vb=ra.addMethod("AddNotification",
1,"String",1,0,"AddNotification",4);vb.addParameter("props","String",1,null,0);vb.addParameter("options","String",1,null,0);vb=ra.addMethod("RemoveNotification",3,"Void",0,0,"RemoveNotification",4);vb.addParameter("id","String",1,null,0);vb=ra.addMethod("UpdateNotification",2,"Void",0,0,"UpdateNotification",4);vb.addParameter("id","String",1,null,0);vb.addParameter("props","String",1,null,0);ra=B.addType("Microsoft.Office.SensitivityLabelInfo","{9c48b796-11fa-4374-9910-4495541ed32f}","{57df5dd1-1d5c-49c2-954e-54cdce9d6082}",
2,0);ra.addProperty("Color",15,"String",1,!1,null,0);ra.addProperty("Description",13,"String",1,!1,null,0);ra.addProperty("DisplayName",12,"String",1,!1,null,0);ra.addProperty("EncryptionType",8,"Microsoft.Office.EncryptionType",1,!1,null,0);ra.addProperty("HasExtractForUser",10,"Boolean",1,!1,null,0);ra.addProperty("IsDke",9,"Boolean",1,!1,null,0);ra.addProperty("IsEnabled",7,"Boolean",1,!1,null,0);ra.addProperty("LabelId",5,"String",1,!1,null,0);ra.addProperty("Order",11,"Int32",1,!1,null,0);ra.addProperty("ParentName",
14,"String",1,!1,null,0);ra.addProperty("TenantId",6,"String",1,!1,null,0);ra.addProperty("Version",4,"Int32",1,!1,null,0);ra=B.addType("Microsoft.Office.SensitivityLabelChangedEventArgs","{ca0930bd-14ec-4274-baf8-b0d81b2cd6af}","{afcf1725-5270-469f-91c8-ad4f0268a459}",2,0);ra.addProperty("Context",20,"String",1,!1,null,0);ra.addProperty("Error",21,"Microsoft.Office.TryUpgradeLabelError",1,!1,null,0);ra.addProperty("NewLabel",19,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);ra.addProperty("PreviousLabel",
18,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);ra=B.addType("Microsoft.Office.SensitivityService","{c7d4ae5b-a48c-4bfd-bf0b-1532a604d330}","{774bff62-b736-4038-a7a8-7bc1eeef213e}",3,2);vb=ra.addMethod("GetHighestSensitivityLabel",3,"Microsoft.Office.SensitivityLabelInfo",2,0,"HighestSensitivityLabel",4);vb.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo[]",2,null,0);ra.addMethod("GetLabel",1,"Microsoft.Office.SensitivityLabelInfo",2,0,"Label",4);vb=ra.addMethod("TryUpgradeLabel",
2,"Void",0,0,"TryUpgradeLabel",4);vb.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo",2,null,0);vb.addParameter("context","String",1,null,0);ra.addMethod("_RegisterSensitivityLabelChangedEvent",16,"Void",0,1,"_RegisterSensitivityLabelChangedEvent",4);ra.addMethod("_UnregisterSensitivityLabelChangedEvent",17,"Void",0,1,"_UnregisterSensitivityLabelChangedEvent",4);ra=B.addType("Microsoft.Office.CopilotService","{d81cdd7f-f828-45a1-89fd-b1f6d0af7f76}","{c86a3d8f-7782-4ef9-8ded-2b569327f30c}",
3,2);vb=ra.addMethod("LaunchHelpPaneByArticleId",2,"Void",0,0,"LaunchHelpPaneByArticleId",4);vb.addParameter("articleId","Int32",1,null,0);vb=ra.addMethod("LaunchHelpPaneByArticleIdString",3,"Void",0,0,"LaunchHelpPaneByArticleIdString",4);vb.addParameter("articleId","String",1,null,0);vb=ra.addMethod("LaunchHelpPaneByQuery",1,"Void",0,0,"LaunchHelpPaneByQuery",4);vb.addParameter("query","String",1,null,0);ra=B.addEnumType("Microsoft.Office.BusinessBarType");ra.addEnumField("Info",0);ra.addEnumField("Error",
1);ra.addEnumField("Blocked",2);ra.addEnumField("SevereWarning",3);ra.addEnumField("Success",4);ra.addEnumField("Warning",5);ra=B.addType("Microsoft.Office.BusinessBarShowArgs","{9cd04f48-f89b-4720-affd-b69cda192318}","{fb97b13e-bd55-46f2-a1bc-92cf8525546f}",2,0);ra.addProperty("HideCloseButton",6,"Boolean",1,!1,null,0);ra.addProperty("Message",4,"String",1,!1,null,0);ra.addProperty("MessageType",5,"Microsoft.Office.BusinessBarType",1,!1,null,0);ra.addProperty("Title",3,"String",1,!1,null,0);ra=B.addType("Microsoft.Office.BusinessBarService",
"{0234fef7-ca58-4b3e-9ae8-6972ccf29564}","{8787e4f8-8270-480c-8721-5854ecbc8227}",3,2);vb=ra.addMethod("Hide",2,"Void",0,0,"Hide",4);vb.addParameter("caller","String",1,null,0);vb=ra.addMethod("Show",1,"Void",0,0,"Show",4);vb.addParameter("caller","String",1,null,0);vb.addParameter("options","Microsoft.Office.BusinessBarShowArgs",2,null,0);ra=B.addEnumType("Microsoft.Office.SimpleDialogCategory");ra.addEnumField("information",0);ra.addEnumField("error",1);ra.addEnumField("warning",2);ra.addEnumField("question",
3);ra.addEnumField("other",4);ra=B.addType("Microsoft.Office.ShowSimpleDialog","{55fc9dc0-9f07-4859-8ba1-f33c353972da}","{f55bd118-7884-4f60-9e0e-e3a7972b7ecb}",3,2);vb=ra.addMethod("LaunchSimpleDialog",1,"Microsoft.Office.SimpleDialogState",1,0,"LaunchSimpleDialog",4);vb.addParameter("title","String",1,null,0);vb.addParameter("description","String",1,null,0);vb.addParameter("telemetryid","String",1,null,0);vb.addParameter("Category","Microsoft.Office.SimpleDialogCategory",1,null,0);vb.addParameter("hasButton",
"Boolean",1,null,0);vb.addParameter("buttonLabel","String",1,null,0);vb.addParameter("hasCheckbox","Boolean",1,null,0);vb.addParameter("checkboxLabel","String",1,null,0);ra=B.addType("Microsoft.Office.DispatchApiService","{1e3afc74-fb27-4b5d-a37b-fda697c46f78}","{82297de7-ac3a-4ee2-853d-26598d2e90e2}",3,2);vb=ra.addMethod("Execute",1,"String",1,1,"Execute",4);vb.addParameter("apiName","String",1,null,0);vb.addParameter("paramsData","String",1,null,0);ra=B.addEnumType("Microsoft.Office.DevicePermissionType");
ra.addEnumField("camera",0);ra.addEnumField("microphone",1);ra.addEnumField("geolocation",2);ra=B.addType("Microsoft.Office.DevicePermissionService","{31dd135c-e19d-4a24-9247-ed31f197e3fb}","{6ed57f43-8908-4730-8c45-d5579c9e3c1c}",3,2);vb=ra.addMethod("RequestPermissions",1,"Boolean",1,1,"RequestPermissions",4);vb.addParameter("permissions","Microsoft.Office.DevicePermissionType[]",1,null,0);ra=B.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);vb=ra.addMethod("CreateAndOpenWorkbook",
1,"Void",0,1,"CreateAndOpenWorkbook",0);vb.addParameter("base64File","String",1,null,0);ra=B.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);ra.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);vb=ra.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);vb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ra=B.addType("Microsoft.ExcelServices.CustomFunctionManager",
"{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);ra.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);vb=ra.addMethod("Register",1,"Void",0,0,"Register",0);vb.addParameter("metadata","String",1,null,0);vb.addParameter("javascript","String",1,null,0);ra=B.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);ra.addProperty("Enabled",1,"Boolean",1,!1,null,0);ra.addProperty("NativeRuntime",
3,"Boolean",1,!1,null,0);ra.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);ra=B.addEnumType("Microsoft.Authentication.IdentityType");ra.addEnumField("OrganizationAccount",0);ra.addEnumField("MicrosoftAccount",1);ra=B.addEnumType("Microsoft.Authentication.AuthorityType");ra.addEnumField("External",0);ra.addEnumField("Msa",1);ra.addEnumField("Aad",2);ra=B.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",
2,0);ra.addProperty("DisplayName",4,"String",1,!1,null,0);ra.addProperty("Email",3,"String",1,!1,null,0);ra.addProperty("FederationProvider",2,"String",1,!1,null,0);ra.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);ra=B.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);ra.addProperty("AppId",4,"String",1,!1,null,0);ra.addProperty("Authority",2,"String",1,!1,null,0);ra.addProperty("AuthorityType",
3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);ra.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);ra.addProperty("TenantId",6,"String",1,!1,null,0);ra.addProperty("Upn",1,"String",1,!1,null,0);ra=B.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);ra.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);vb=ra.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",
2,1,"AccessToken",4);vb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);ra.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);ra.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);ra=B.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);ra.addProperty("AuthChallenge",3,"String",1,
!1,null,0);ra.addProperty("CorrelationId",7,"String",1,!1,null,0);ra.addProperty("Policy",4,"String",1,!1,null,0);ra.addProperty("Resource",2,"String",1,!1,null,0);ra.addProperty("Scope",5,"String",1,!1,null,0);ra.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);ra=B.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);ra.addProperty("AccessToken",2,"String",1,!1,null,0);ra.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",
1,!1,null,0);ra=B.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);ra.addProperty("Id",1,"String",1,!0,null,0);ra.addProperty("Value",2,"Object",1,!1,null,0);ra=B.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);vb=ra.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);vb.addParameter("id","String",1,null,0);vb=ra.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",
3,1,"ItemOrNullObject",0);vb.addParameter("id","String",1,null,0);ra=B.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ra.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);vb=ra.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);vb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ra=B.addEnumType("Microsoft.AppRuntime.AppRuntimeState");
ra.addEnumField("Inactive",0);ra.addEnumField("Background",1);ra.addEnumField("Visible",2);ra=B.addEnumType("Microsoft.AppRuntime.Visibility");ra.addEnumField("Hidden",1);ra.addEnumField("Visible",2);ra=B.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ra.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);vb=ra.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",
0);vb.addParameter("jsonCreate","String",1,null,0);vb=ra.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);vb.addParameter("jsonUpdate","String",1,null,0);vb=ra.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);vb.addParameter("id","String",1,null,0);vb=ra.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);vb.addParameter("id","String",1,null,0);ra.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ra=B.addType("Microsoft.DynamicRibbon.RibbonTab",
"{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ra.addProperty("Id",2,"String",1,!0,null,0);vb=ra.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);vb.addParameter("visibility","Boolean",1,null,0);ra.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ra=B.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ra.addProperty("Enabled",3,"Boolean",1,!1,null,0);ra.addProperty("Id",2,"String",1,!0,null,0);ra.addProperty("Label",4,"String",1,!0,null,0);
vb=ra.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);vb.addParameter("enabled","Boolean",1,null,0);ra.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ra=B.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ra.addMethod("GetCount",3,"Int32",1,1,"Count",0);vb=ra.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);vb.addParameter("key","String",1,null,0);ra.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ra.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",
!0);ra=B.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ra.addEnumField("Unknown",0);ra.addEnumField("Basic",1);ra.addEnumField("Premium",2);ra=B.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);vb=ra.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);vb.addParameter("feature","String",1,null,0);vb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",
1,null,0);vb=ra.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);vb.addParameter("feature","String",1,null,0);vb=ra.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);vb.addParameter("feature","String",1,null,0);vb.addParameter("fallbackValue","Boolean",1,null,0);ra.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);vb=ra.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);vb.addParameter("experienceId",
"String",1,null,0);vb=ra.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);vb.addParameter("feature","String",1,null,0);ra=B.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);ra.addProperty("Id",5,"String",1,!0,null,0);ra.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);ra.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ra=B.addType("Microsoft.InternalService.AddinInternalService",
"{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);ra.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);ra=B.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);ra.addMethod("Disable",3,"Void",0,1,"Disable",0);ra.addMethod("Enable",2,"Void",0,1,"Enable",0);ra.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var Qb=
a(968),ac=a(178);class Wa{constructor(B,ra){this.xqh=B;this.Rqh=ra}createAndOpenWorkbook(B){if(B&&B.length>this.xqh)throw ya.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",B.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.invalidArgument,ac.a.ia(1769));const ra=new rc("blank","agave",B?"streamBase64":"streamEmpty",B);let vb=null;return OfficeExtension.WacRuntime.Utility.createPromise((dc,Hc)=>{const ed=new aa.a,Id=ac.a.gBc("GeneralAddInMessageDialogTitle"),
Pd=ac.a.gBc("NewFileAPIConsentMessage");ed.Oh=4;ed.So(Id,Pd,1,Rd=>{2===Rd||0===Rd?Hc("Cancelled"):(vb=window.open(""),this.Rqh.create(dc,Hc,ra).yib())})}).then(dc=>{if(!dc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.generalException,ac.a.ia(1765));try{vb.top.location.href=dc}catch(Hc){ya.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Gc.a.$v,Hc),ya.ULS.sendTraceTag(538572819,0,50,
"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),vb.location.replace(dc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},dc=>{if("Cancelled"===dc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.oce,ac.a.ia(1768));vb.close();this.w0k();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=
this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 1:return this.q5h(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}q5h(B){B=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");return this.createAndOpenWorkbook(B)}w0k(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.generalException,ac.a.ia(1765));}}Object(ha.a)(Wa,"WacWorkbook",null,[]);const Gb=(B,ra)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof B+", objectId="+B+", value="+ra);return null},Ub=B=>{B.add("InternalTest","PreviewExecutionMethod",Gb)};var Ra=a(288),Rb=a(966),ib=a(967);
class la{constructor(B){this.th=B}get $(){return this.th}}Object(ha.a)(la,"RichApiPreviewExecutionContext",null,[]);var db=a(27),$b=a(73),Ic=a(63),Tc=a(61),Zc=a(46),cc=a(1287),Yc=a(78),Vc=a(672),wd=a(244),wc=a(34),Ya=a(248),ob=a(150),Cb=a(19),Wb=a(16),ad=a(13),$c=a(28);class Ld extends Ya.a{constructor(B,ra,vb,dc,Hc){super(B,"Select Data");this.yKb=null;this.Qof=ra;this.$Bd=vb;this.Bi=Hc;this.callback=dc}get Ji(){return"DdaBindingPrompt"}start(B,ra){let vb="<div class='"+ob.l+" "+Cb.a.yH+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+
ob.c+"' /></div>";vb=String.format(vb,wc.a.Vr(this.$Bd.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Bi.hr(this.vj,vb);this.yKb=Wb.DOMElementExtensions.getElementById(this.vj,"bindingText");B=ra?B.Jkb(ra,this.$Bd.DdaBindingsMethod.BindingId):null;(null===B||void 0===B?0:B.IsValidRef)?(ra=new db.Range(B.Reference.FirstRow+1,B.Reference.FirstColumn+1,B.Reference.LastRow+1,B.Reference.LastColumn+1,!1,!1),this.yKb.value=B.Reference.SheetName+"!"+ra):(B=ja.f(this.$).ha,this.yKb.value=
$b.f(this.$.la)||!B.pa.Yn?"":B.Uva);this.initialize();this.Ys()}hF(){this.Vwd();this.addButton(0);this.addButton(1);super.hF()}setFocus(){Wb.DOMElementExtensions.setFocus(this.yKb)}validate(){return!0}commit(){let B=this.yKb.value.trim();const ra=B.indexOf("!");-1!==ra&&(B=this.WXi(B.substring(0,ra))+B.substr(ra));this.Qof.addBinding(this.$Bd,B,0,this.callback);return!0}pLb(){this.Qof.P0.qo(Rb.a.internalError,this.callback);super.pLb()}WXi(B){B=$c.a.trimStart(B.trim(),"=");return B.length?B.startsWith("'")&&
B.endsWith("'")?B:ad.HelperMethods.Hxc(B):""}}Object(ha.a)(Ld,"DdaBindingPrompt",Ya.a,[]);class jd{constructor(B){this.fa=B}qo(B,ra){if(ra){const vb={};vb.Error=B;vb.Version=this.fa.yk;ra(vb)}}a_a(B,ra){this.qo(B,ra)}YR(B,ra){this.qo(Rb.a.rDf(B.Errors[0].MessageId),ra)}FE(B){B&&B(this.JR())}JR(){const B={Error:0};B.Version=this.fa.yk;return B}}Object(ha.a)(jd,"DdaErrorGenerator",null,[]);var Td=a(255);class re{constructor(B,ra,vb){this.$=B;this.P0=ra;this.RJ=vb}M7d(B,ra){const vb=B.DdaGoToByIdMethod.GoToType,
dc=B.DdaGoToByIdMethod.SelectionMode,Hc=B.DdaGoToByIdMethod.Id.toString().trim(),ed=Id=>{const Pd=this.$.sa.getItemByName(Id.SheetName);(null===Pd||void 0===Pd?0:Pd.visible)?(ja.f(this.$).fp(Id,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.P0.FE(ra)):this.P0.qo(Rb.a.kVh,ra)};0===vb?this.DKj(Hc,dc,B.DdaMethod.ControlId,ed,ra):1===vb?this.GKj(Hc,dc,ed,ra):this.P0.qo(Rb.a.u8k,ra)}DKj(B,ra,vb,dc,Hc){this.RJ.ddaGetBinding(vb,B,ed=>{if(!Td.a(ed)&&ed.Result&&ed.Result.Reference){ed=
ed.Result;var Id={};Id.SheetName=ed.Reference.SheetName;Id.FirstRow=ed.Reference.FirstRow;Id.FirstColumn=ed.Reference.FirstColumn;Id.LastRow=ed.Reference.LastRow;Id.LastColumn=ed.Reference.LastColumn;re.ird(Id,ra);1!==ed.BindingType?dc(Id):this.RJ.ddaGetBindingData(vb,B,1,0,2,0,0,-1,-1,Pd=>{Td.a(Pd)||!Pd.Result?this.P0.YR(Pd,Hc):(Pd=Pd.Result,2!==ra&&(Id.FirstRow-=Pd.Headers.length,0>Id.FirstRow&&(Id.FirstRow=0)),dc(Id))},Hc)}else this.P0.a_a(Rb.a.CYg,Hc)},Hc)}GKj(B,ra,vb,dc){var Hc=Zc.D(B);Hc?(Hc=
Zc.x(Hc,this.$),re.ird(Hc,ra),vb(Hc)):this.$.fa.isNamedObjectViewMode&&this.$.$h.Pq(B)?this.$.$h.Wqa(this.$.$h.getItemByName(B),"dda"):(Hc=ed=>{Td.a(ed)||!ed.Result?this.$.sa.contains(B)?(ed={},ed.SheetName=B,ed.FirstRow=0,ed.FirstColumn=0,ed.LastRow=0,ed.LastColumn=0,vb(ed)):this.P0.a_a(Rb.a.CYg,dc):(ed=ed.Result,re.ird(ed,ra),vb(ed))},this.$.sa.la?this.RJ.parseRangeForGoto(B,this.$.sa.la.name,Hc,dc):this.RJ.parseRange(B,Hc,dc))}static ird(B,ra){B.LastRow=2===ra?B.FirstRow:B.LastRow;B.LastColumn=
2===ra?B.FirstColumn:B.LastColumn}}Object(ha.a)(re,"DdaNavigator",null,[]);var Nd=a(216),uc=a(64);const pc=(B,ra,vb,dc,Hc,ed)=>{const Id=B.Za(1);Id.request=ra;return uc.h(B,"ExecuteRichApiRequest",Id,vb,dc,Hc,ed,0)};var Hd=a(343),wb=a(94),Xb=a(787),Kb=a(658),Zb;(function(B){B[B.unsupported=0]="unsupported";B[B.surface=1]="surface";B[B.combo=2]="combo";B[B.column=3]="column";B[B.column3D=4]="column3D";B[B.bar=5]="bar";B[B.bar3D=6]="bar3D";B[B.line=7]="line";B[B.line3D=8]="line3D";B[B.pie=9]="pie";
B[B.pie3D=10]="pie3D";B[B.scatter=11]="scatter";B[B.bubble=12]="bubble";B[B.area=13]="area";B[B.area3D=14]="area3D";B[B.doughnut=15]="doughnut";B[B.radar=16]="radar";B[B.stock=17]="stock";B[B.waterfall=18]="waterfall";B[B.funnel=19]="funnel";B[B.treemap=20]="treemap";B[B.sunburst=21]="sunburst";B[B.boxWhisker=22]="boxWhisker";B[B.histogram=23]="histogram";B[B.pareto=24]="pareto";B[B.regionMap=25]="regionMap";B[B.noVisibleSeries=26]="noVisibleSeries";B[B.complexDataSource=27]="complexDataSource";B[B.pivotChart=
28]="pivotChart"})(Zb||(Zb={}));Object(ha.b)("ChartCategory",Zb);class Oc{constructor(B,ra){this.source=B;this.eventId=ra}}Object(ha.a)(Oc,"MacroRecorderEventData",null,[]);class Cd{constructor(B,ra,vb){this.response=this.request=this.eventId=this.source=null;B&&(this.source=B.source,this.eventId=B.eventId,this.request=ra,this.response=vb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(ha.a)(Cd,"MacroRecorderRichApiRequestExecutedPayload",
null,[149]);class Wd{constructor(B,ra,vb){this.parentName=B;this.$=ra;this.request=vb}fWi(B){var ra;if(void 0===B||null===B||void 0===B.RequestBody||null===B.RequestBody)return null;const vb=JSON.parse(B.RequestBody);if(void 0!==B.ActiveFloatingObjectId&&null!==B.ActiveFloatingObjectId){vb.ActiveFloatingObjectId=B.ActiveFloatingObjectId;const dc=ja.f(this.$).ha.$a.Ih;if(null===(ra=null===dc||void 0===dc?void 0:dc.floatingObject)||void 0===ra?0:ra.Ui)vb.ActiveChartType=Zb[dc.floatingObject.Ui.ChartCategory]}void 0!==
B.SheetMultiRange&&null!==B.SheetMultiRange&&(vb.SheetName=B.SheetMultiRange.SheetName);return vb}qWi(B){if(void 0===B||null===B||void 0===B.Result||null===B.Result)return null;B=B.Result;return void 0===B.ResponseBody||null===B.ResponseBody||B.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(B.ResponseBody.join(""))}erj(B){return!!B&&!(void 0===B.eventId||null===B.eventId)&&0<B.eventId.length}Ot(B){return()=>{if(this.$.vha){const ra=this.TQh(this.request);if(this.erj(ra)){const vb=this.fWi(this.request),
dc=this.qWi(B);if(vb&&!wb.a.isEmpty(vb)&&dc&&!wb.a.isEmpty(dc))return ya.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Cd(ra,vb,dc);ya.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${vb?"(not null)":"(null)"}; responseInfo: ${dc?"(not null)":"(null)"}`}`)}}return new Cd(null,null,null)}}TQh(B){const ra=this.frj(B.SolutionId),vb=Wd.IVi(B);if(vb&&ra)return ya.ULS.sendTraceTag(537163162,
0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:vb,["request.SolutionId"]:B.SolutionId})}`),new Oc(B.SolutionId,vb);B=JSON.stringify({["recorderEventId"]:vb,["isRecorderAwareAddin"]:ra,["request.SolutionId"]:B.SolutionId});ya.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${B}`);return null}frj(B){if(!B)return!1;B=B.toLowerCase();return Wd.C1i().contains(B)}static C1i(){Wd.$Oa||(Wd.$Oa=new Xb.a(Kb.a.tm()),Wd.$Oa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),
Wd.$Oa.add("fa000000005"),Wd.$Oa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Wd.$Oa.add("fa000000014"),Wd.$Oa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Wd.$Oa}static IVi(B){let ra=null;var vb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(vb.test(B.RequestBody))ra=vb.exec(B.RequestBody)[1];else{B=B.RequestHeaders;if(!B)return ra;vb=yb.a.MNj.toLowerCase();for(let dc=0;dc<B.length;dc++)if(B[dc].Name.toLowerCase()===vb){ra=B[dc].Value;break}}return ra}}Wd.$Oa=
null;Object(ha.a)(Wd,"DdaRichApiRequestRecorder",null,[]);var ee=a(265);class he extends Hd.a{constructor(B,ra,vb,dc,Hc,ed,Id,Pd){super(10,0,ra,Pd);this.qHb=vb;this.wDb=dc;this.Wfa=Hc;this.jVa=ed;this.request=Id;this.jne=new Wd("10",B,Id)}get i5c(){return this.jVa}get FQ(){return this.qHb}get Gwa(){return this.wDb}qfa(B){return super.qfa(B)||this.YTh(B)}Ot(){return this.jne.Ot(this.lk)}tzb(){const B={OperationType:3};B.RichApiRequest=this.request;return B}YTh(B){return(ra,vb,dc)=>pc(B,this.request,
ee.c(ra,this.qHb),ee.b(vb,this.wDb),dc,this.Wfa)}}Object(ha.a)(he,"DdaRichApiRequestBatchOperation",Hd.a,[]);class pe extends Nd.a{constructor(B,ra,vb,dc){super(576,0,vb,dc);this.jne=new Wd("576",B,ra)}Ot(){return this.jne.Ot(this.lk)}}Object(ha.a)(pe,"DdaRichApiRequestOperation",Nd.a,[]);class Se{constructor(B,ra){this.ZS=(vb,dc)=>{this.P0.a_a(Rb.a.internalError,dc)};this.$=B;this.P0=ra}ddaAddBinding(B,ra,vb,dc,Hc,ed,Id){this.UU((Pd,Rd,$d)=>{var Ae=this.$.oa.ta,Ke=this.kxa();Pd=ee.c(Pd,ed);Rd=ee.b(Rd,
this.ZS);const Ze=Ae.Za(9);Ze.controlId=B;Ze.bindingId=ra;Ze.bindingType=vb;Ze.currentSheetName=Ke;Ze.formula=dc;Ze.options=Hc;return uc.h(Ae,"DdaAddBinding",Ze,Pd,Rd,$d,Id,0)},Id,563)}ddaReleaseBinding(B,ra,vb,dc){this.UU((Hc,ed,Id)=>{var Pd=this.$.oa.ta;Hc=ee.c(Hc,vb);ed=ee.b(ed,this.ZS);const Rd=Pd.Za(9);Rd.controlId=B;Rd.bindingId=ra;return uc.h(Pd,"DdaReleaseBinding",Rd,Hc,ed,Id,dc,0)},dc,564)}ddaGetBinding(B,ra,vb,dc){this.UU((Hc,ed,Id)=>{var Pd=this.$.oa.ta;Hc=ee.c(Hc,vb);ed=ee.b(ed,this.ZS);
const Rd=Pd.Za(1);Rd.controlId=B;Rd.bindingId=ra;return uc.h(Pd,"DdaGetBinding",Rd,Hc,ed,Id,dc,0)},dc,565,16)}ddaGetAllBindings(B,ra,vb){this.UU((dc,Hc,ed)=>{var Id=this.$.oa.ta;dc=ee.c(dc,ra);Hc=ee.b(Hc,this.ZS);const Pd=Id.Za(1);Pd.controlId=B;return uc.h(Id,"DdaGetAllBindings",Pd,dc,Hc,ed,vb,0)},vb,566,16)}ddaGetBindingData(B,ra,vb,dc,Hc,ed,Id,Pd,Rd,$d,Ae){this.UU((Ke,Ze,cg)=>{var Vf=this.$.oa.ta,Xf=this.kxa();Ke=ee.c(Ke,$d);Ze=ee.b(Ze,this.ZS);const Pf=Vf.Za(1);Pf.controlId=B;Pf.bindingId=ra;
Pf.coerceType=vb;Pf.valueFormat=dc;Pf.filterType=Hc;Pf.startRow=ed;Pf.startCol=Id;Pf.rowCount=Pd;Pf.colCount=Rd;Pf.currentSheetName=Xf;return uc.h(Vf,"DdaGetBindingData",Pf,Ke,Ze,cg,Ae,0)},Ae,567,16)}ddaSetBindingData(B,ra,vb,dc,Hc,ed,Id){this.UU((Pd,Rd,$d)=>{var Ae=this.$.oa.ta,Ke=this.kxa();Pd=ee.c(Pd,ed);Rd=ee.b(Rd,this.ZS);const Ze=Ae.Za(9);Ze.controlId=B;Ze.bindingId=ra;Ze.startRow=vb;Ze.startCol=dc;Ze.currentSheetName=Ke;Ze.bindingData=Hc;return uc.h(Ae,"DdaSetBindingData",Ze,Pd,Rd,$d,Id,0)},
Id,568)}ddaGetSelectedData(B,ra,vb,dc,Hc,ed,Id){this.UU((Pd,Rd,$d)=>{var Ae=this.$.oa.ta,Ke=this.kxa();Pd=ee.c(Pd,ed);Rd=ee.b(Rd,this.ZS);const Ze=Ae.Za(1);Ze.controlId=B;Ze.coerceType=ra;Ze.valueFormat=vb;Ze.filterType=dc;Ze.currentSheetName=Ke;Ze.formula=Hc;return uc.h(Ae,"DdaGetSelectedData",Ze,Pd,Rd,$d,Id,0)},Id,569,16)}ddaSetSelectedData(B,ra,vb,dc,Hc){this.UU((ed,Id,Pd)=>{var Rd=this.$.oa.ta,$d=this.kxa();ed=ee.c(ed,dc);Id=ee.b(Id,this.ZS);const Ae=Rd.Za(9);Ae.controlId=B;Ae.currentSheetName=
$d;Ae.formula=ra;Ae.bindingData=vb;return uc.h(Rd,"DdaSetSelectedData",Ae,ed,Id,Pd,Hc,0)},Hc,570)}ddaLoadSettings(B,ra,vb){this.UU((dc,Hc,ed)=>{var Id=this.$.oa.ta;dc=ee.c(dc,ra);Hc=ee.b(Hc,this.ZS);const Pd=Id.Za(1);Pd.controlId=B;return uc.h(Id,"DdaLoadSettings",Pd,dc,Hc,ed,vb,0)},vb,501,16)}ddaSaveSettings(B,ra,vb,dc,Hc){this.UU((ed,Id,Pd)=>{var Rd=this.$.oa.ta;ed=ee.c(ed,dc);Id=ee.b(Id,this.ZS);const $d=Rd.Za(9);$d.controlId=B;$d.settings=ra;$d.overwriteIfStale=vb;return uc.h(Rd,"DdaSaveSettings",
$d,ed,Id,Pd,Hc,0)},Hc,571)}ddaAddRowsColumns(B,ra,vb,dc,Hc,ed){this.UU((Id,Pd,Rd)=>{var $d=this.$.oa.ta,Ae=this.kxa();Id=ee.c(Id,Hc);Pd=ee.b(Pd,this.ZS);const Ke=$d.Za(9);Ke.controlId=B;Ke.bindingId=ra;Ke.isRow=vb;Ke.currentSheetName=Ae;Ke.bindingData=dc;return uc.h($d,"DdaAddRowsColumns",Ke,Id,Pd,Rd,ed,0)},ed,572)}ddaDeleteAllDataValues(B,ra,vb,dc){this.UU((Hc,ed,Id)=>{var Pd=this.$.oa.ta,Rd=this.kxa();Hc=ee.c(Hc,vb);ed=ee.b(ed,this.ZS);const $d=Pd.Za(9);$d.controlId=B;$d.bindingId=ra;$d.currentSheetName=
Rd;return uc.h(Pd,"DdaDeleteAllDataValues",$d,Hc,ed,Id,dc,0)},dc,573)}ddaClearBindingFormats(B,ra,vb,dc){this.UU((Hc,ed,Id)=>{var Pd=this.$.oa.ta,Rd=this.kxa();Hc=ee.c(Hc,vb);ed=ee.b(ed,this.ZS);const $d=Pd.Za(9);$d.controlId=B;$d.bindingId=ra;$d.currentSheetName=Rd;return uc.h(Pd,"DdaClearBindingFormats",$d,Hc,ed,Id,dc,0)},dc,574)}ddaSetBindingFormats(B,ra,vb,dc,Hc,ed){this.UU((Id,Pd,Rd)=>{var $d=this.$.oa.ta,Ae=this.kxa();Id=ee.c(Id,Hc);Pd=ee.b(Pd,this.ZS);const Ke=$d.Za(9);Ke.controlId=B;Ke.bindingId=
ra;Ke.currentSheetName=Ae;Ke.bindingData=vb;Ke.isSetFormats=dc;return uc.h($d,"DdaSetBindingFormats",Ke,Id,Pd,Rd,ed,0)},ed,575)}parseRange(B,ra,vb){this.UU((dc,Hc,ed)=>{const Id=this.$.oa.ta.Wh();return uc.x(this.$.oa.ta,B,-1,ee.c(dc,ra),ee.b(Hc,this.ZS),ed,vb,Id)},vb,162,16)}parseRangeForGoto(B,ra,vb,dc){this.UU((Hc,ed,Id)=>{const Pd=this.$.oa.ta.Wh();return uc.y(this.$.oa.ta,B,ra,ee.c(Hc,vb),ee.b(ed,this.ZS),Id,dc,Pd)},dc,562,16)}executeRichApiRequest(B,ra,vb){B.RequestFlags&=12287;if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7867662_RichApiUndoThirdPartyFlight")){var dc=
Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichApiUndoThirdParty",!1);const Hc=0!==(B.RequestFlags&128);dc||"sdxcatalog"===B.MarketplaceType||Hc||(B.RequestFlags&=-17)}Ga.EwaSettings.Na(233)?this.rui(this.$.oa.ta.Wh(),ra,()=>{this.P0.a_a(Rb.a.internalError,vb)},vb,B):(dc=Xa.DdaFacade.nOd(B),!this.$.vh.UE||dc&16?(dc|=64,this.$.userOperationManager.kP(new pe(this.$,B,(Hc,ed,Id)=>pc(this.$.oa.ta,B,ee.c(Hc,ra),ee.b(ed,this.ZS),Id,vb),dc))):(this.P0.a_a(Rb.a.m6c,vb),ya.ULS.sendTraceTag(537163160,
0,50,"Write operation is not allowed")))}kxa(){return this.$.fa.isNamedObjectViewMode?this.$.la.sheetName:this.$.activeItemName}UU(B,ra,vb,dc){dc=void 0===dc?0:dc;!this.$.vh.UE||dc&16?this.$.userOperationManager.kP(new Nd.a(vb,0,B,dc|64)):(this.P0.a_a(Rb.a.m6c,ra),ya.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}rui(B,ra,vb,dc,Hc){let ed=Xa.DdaFacade.nOd(Hc);if(!this.$.vh.UE||ed&16){var Id=this.$.Eh.Oi("UserAction","Rich Api request");this.$.userOperationManager.enqueueOperation(new he(this.$,
B,ra,vb,dc,Id,Hc,ed|64),null)}else this.P0.a_a(Rb.a.m6c,dc),ya.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(ha.a)(Se,"DdaWebServiceHelper",null,[]);class Ta{constructor(B,ra,vb,dc){this.ewi=B;this.fileSize=ra;this.IUk=dc}}Object(ha.a)(Ta,"DocumentFile",null,[]);class Qa{}Qa.generalException="GeneralException";Qa.HIh="ApiNotFound";Qa.oce="OperationCancelled";Qa.invalidArgument="InvalidArgument";Object(ha.a)(Qa,"ErrorCodes",null,[]);class Ob{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(ha.a)(Ob,"WacApiDelegates",null,[]);var Jb=a(750);class Jc extends Ob{constructor(B,ra){super();this.c4f=(vb,dc)=>{vb=Jc.C3h(vb,dc);if(!Jb.a(this.$,vb))return!0;vb=this.$.shortcutKeyManager.vPd(vb);return!!vb&&0<vb.length};this.addinId=B;this.$=ra}replaceShortcuts(B){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,B,this.c4f)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(B){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(B,
this.c4f)}static n8h(B,ra){const vb=document.createEvent("KeyboardEvent");if(Gc.a.kJ)vb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(B&8),!!(B&32),!!(B&4),!!(B&256));else{const dc=[];B&4&&dc.push("Shift");B&8&&dc.push("Control");B&32&&dc.push("Alt");vb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,dc.join(" "),!1,"en-US")}B=new Sys.UI.DomEvent(vb);B.keyCode=ra;return B}static C3h(B,ra){if(Gc.a.Cm)switch(ra){case 189:ra=173;break;case 187:ra=61;break;case 186:ra=59}return Jc.n8h(B,
ra)}}Object(ha.a)(Jc,"ExcelWacApiDelegates",Ob,[]);class zb{constructor(B){this.SYa={};this.AGj=B}Yyh(B,ra){this.wEc(B)||(this.SYa[B]={});if(this.Ukj(B))return ya.ULS.sendTraceTag(537163157,344,50,`App ${B} has reach the limit of number of cached files.`),Rb.a.mHj;this.SYa[B][ra.ewi.toString()]=ra;return Rb.a.success}sLi(B,ra){let vb=null;this.wEc(B)&&(vb=this.SYa[B][ra.toString()]);vb||ya.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${B}, fileHandler:${ra}] doesn't exist`);return vb}wEc(B){return B in
this.SYa}rlk(B,ra){if(this.wEc(B)){const vb=this.SYa[B];delete vb[ra.toString()];1>Object.keys(vb).length&&delete this.SYa[B];return ra.toString()in vb?Rb.a.internalError:Rb.a.success}return Rb.a.internalError}Ukj(B){return this.wEc(B)?Object.keys(this.SYa[B]).length>=this.AGj:!1}static getInstance(B){return B.qa.zh(200)||B.qa.Rh(200,new zb(zb.BGj))}static tLj(){return++zb.TSh}}zb.cGj=4194304;zb.BGj=1;zb.TSh=0;Object(ha.a)(zb,"GetFileApiHelper",null,[]);class tb{constructor(B){this.hs=B}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.hs)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){switch(B){case 1:return this.dMj()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){B=this.invokeMethod(B,
ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}dMj(){this.notifyActionHandlerReady();return null}}Object(ha.a)(tb,"AddinInternalService",null,[]);class zc{constructor(B,ra){this.Iv=ra;this.hs=B}getAppRuntimeState(){let B=this.hs;ac.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.Iv.e_&&(B=this.Iv.p6(this.hs));return this.Iv.getAppRuntimeState(B)?2:1}setAppRuntimeState(B){switch(B){case 2:B=!0;break;case 1:B=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.invalidArgument,
ac.a.ia(1769));}let ra=this.hs;ac.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.Iv.e_&&(ra=this.Iv.p6(this.hs));this.Iv.setAppRuntimeState(ra,B)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B,ra){switch(B){case 2:return this.OFi();case 1:return this.SDk(ra)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}OFi(){return this.getAppRuntimeState()}SDk(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
0,"int");this.setAppRuntimeState(B);return null}}Object(ha.a)(zc,"AppRuntimeService",null,[]);var dd=a(1288);class od{constructor(B,ra,vb,dc){this.TG=B;this.$da=vb;this.zI=dc.Fl.getOsfControl(ra)}disable(){try{if(!ac.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.slf();if(!this.A3f())return this.tlf();this.$da.v7k(this.TG)}catch(B){return ya.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",B.message||
"Unknown"),this.qlf()}return null}enable(){try{if(!ac.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.slf();if(!this.A3f())return this.tlf();this.$da.ijk(this.TG)}catch(B){return ya.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",B.message||"Unknown"),this.qlf()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){switch(B){case 1:return this.cSa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 3:return this.Ggi();
case 2:return this.Vli()}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}Ggi(){return this.disable()}Vli(){return this.enable()}cSa(){this._OnAccess();return null}slf(){return dd.a(Qb.a.notImplemented,ac.a.ia(1770))}tlf(){return dd.a(Qb.a.sharedRuntimeNotAvailable,ac.a.ia(1774))}qlf(){return dd.a(Qb.a.generalException,ac.a.ia(1765))}A3f(){const B=this.zI.getSharedRuntimeId();return!!B&&0<B.length}}Object(ha.a)(od,"BeforeDocumentCloseNotification",null,
[]);class gb{constructor(){this.x_e=this.nUe=this.mv=!1}get enabled(){return this.mv}set enabled(B){this.mv=B}get nativeRuntime(){return this.nUe}set nativeRuntime(B){this.nUe=B}get streamingEnabled(){return this.x_e}set streamingEnabled(B){this.x_e=B}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(B){switch(B){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B,ra){switch(B){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}}Object(ha.a)(gb,"CustomFunctionEngineStatus",null,[]);class gc{constructor(B,ra,vb){this.Boh=B;this.Coh=ra;this.Dsh=vb}get status(){const B=new gb;B.enabled=this.Boh;
B.streamingEnabled=this.Coh;B.nativeRuntime=!1;return B}register(B){return OfficeExtension.WacRuntime.Utility.createPromise(this.Dsh(B))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(B){switch(B){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 1:return this.bkk(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}bkk(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
1,"string");return this.register(ra,B)}}Object(ha.a)(gc,"CustomFunctionManager",null,[]);var Dc=a(1184);class hd{constructor(B,ra,vb,dc){this.zJe="";this.Zfc=0;this.y_=B;this._id=ra;this.hs=vb;this.Iv=dc}get id(){return this._id}_RegisterStateChange(){this.Zfc||this.y_.execute(B=>{this.zJe=B.R6a(this._id,ra=>{this.Iv.hyi(this.hs,this._id,JSON.stringify(ra))})});this.Zfc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.Zfc--;this.Zfc||this.y_.execute(B=>
{B.fje(this._id,this.zJe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(B){switch(B){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 6:return this.Ehh();case 7:return this.Khh()}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}Ehh(){return this._RegisterStateChange()}Khh(){return this._UnregisterStateChange()}}Object(ha.a)(hd,"LicenseFeature",
null,[]);class xd{constructor(B,ra){this.y_=Bb.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.hs=B;this.Iv=ra;this.kUa=this.Iv.Fl.getOsfControl(this.hs)}getFeatureTier(B,ra){return OfficeExtension.WacRuntime.Utility.createPromise(vb=>{const dc=1===ra?1:2===ra?2:0;this.y_.execute(Hc=>{Hc.getFeatureTier(B,dc).then(ed=>{vb(this.pQi(ed))},()=>{vb(ra)})})})}getLicenseFeature(B){B=new hd(this.y_,B,this.hs,this.Iv);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}isFeatureEnabled(B,
ra){return OfficeExtension.WacRuntime.Utility.createPromise(vb=>{this.y_.execute(dc=>{dc.isFeatureEnabled(B,ra).then(Hc=>{vb(Hc)},()=>{vb(ra)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(B=>{this.y_.execute(ra=>{ra=ra.isFreemiumUpsellEnabled();B(ra)})})}launchUpsellExperience(B){if(this.kUa.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.y_.execute(ra=>{ra.launchUpsellExperience(B)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.Knd,
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B,
ra){switch(B){case 6:return this.Hhh(ra)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 2:return this.yMi(ra);case 5:return this.oQi(ra);case 1:return this.Slj(ra);case 3:return this.Nmj();case 4:return this.Exj(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}yMi(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
1,"int");return this.getFeatureTier(ra,B)}oQi(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");return this.getLicenseFeature(B)}Slj(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,1,"boolean");return this.isFeatureEnabled(ra,B)}Nmj(){return this.isFreemiumUpsellEnabled()}Exj(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");return this.launchUpsellExperience(B)}Hhh(B){B=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");this._TestFireStateChangedEvent(B);return null}pQi(B){switch(B){case 1:return 1;case 2:return 2;default:return 0}}}Object(ha.a)(xd,"License",null,[]);class fd{constructor(){this.JIe=null;this.FYe=this.Wjc=this.eO="";this.TZe=!0;this.options=null}get authChallenge(){return this.JIe}set authChallenge(B){this.JIe=B}get correlationId(){return this.eO}set correlationId(B){this.eO=B}get policy(){return null}set policy(B){}get resource(){return this.Wjc}set resource(B){this.Wjc=
B}get scope(){return this.FYe}set scope(B){this.FYe=B}get silentLogin(){return this.TZe}set silentLogin(B){this.TZe=B}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(B){switch(B){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B,ra){switch(B){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");
return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,
ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}}Object(ha.a)(fd,"TokenParameters",null,[309]);var kd=a(200),Yb=a(12);const Cc=(B,ra,vb)=>dc=>(Hc,ed)=>{Ka.TaskExtensions.$e(Yc.GetServiceTaskFactory.create(ra.qa,279,ra.ya,1),Id=>{Id=Id.result;let Pd=!1;var Rd=vb.Fl.getOsfControl(B);let $d=null;Rd&&($d=Rd.getStoreType(),(Rd=Rd.getManifest())&&Rd.getSharedRuntimeForCustomFunctions("Workbook")&&(Pd=!0));Ka.TaskExtensions.$e(Id.WWf(B,$d,dc,Pd),Ae=>{kd.b(Ae)?
Ae.result?Hc(null):ed(OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.invalidArgument,Yb.a.instance.ia(1769))):ed(OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.generalException,Yb.a.instance.ia(1765)))},ra.ya,3)},ra.ya,3)};class td{constructor(B){if(!B)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.L5d=B}areShortcutsInUse(B){return OfficeExtension.WacRuntime.Utility.createPromise((ra,vb)=>
{this.L5d.checkShortcutsInUse(B).then(dc=>{ra(dc)}).catch(dc=>{vb(dc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((B,ra)=>{this.L5d.getShortcuts().then(vb=>{B(vb)}).catch(vb=>{ra(vb)})})}replaceShortcuts(B){return OfficeExtension.WacRuntime.Utility.createPromise((ra,vb)=>{this.L5d.replaceShortcuts(B).then(()=>{ra(null)}).catch(dc=>{vb(dc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 3:return this.AKh(ra);case 1:return this.bYi();
case 2:return this.$rk(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}AKh(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"Array<string>");return this.areShortcutsInUse(B)}bYi(){return this.getShortcuts()}$rk(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"any");return this.replaceShortcuts(B)}}Object(ha.a)(td,"ActionService",null,[]);class Ad{constructor(){this.data=null}}Object(ha.a)(Ad,"AugLoopHostMessageReceivedEventArgs",
null,[]);var oe=a(1289);class qe{constructor(B,ra,vb){this.aU=B;this.iX=void 0===ra?!1:ra;this.bX=(void 0===vb?null:vb)||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(B){this.iX||oe.a.oCk(B)}_RegisterHostMessageReceivedEvent(){this.iX||(qe.oEg||(oe.a.Tjk(B=>{this.bX.fireEvent("",65542,Object.assign(new Ad,{data:B}))}),qe.oEg=!0),this.bX.register(this.aU,"",65542))}_UnregisterHostMessageReceivedEvent(){this.iX||this.bX.unregister(this.aU,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B,ra){switch(B){case 1:return this.ZBk(ra);case 2:return this.Chh();case 3:return this.Ihh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}ZBk(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");this.sendMessage(B);return null}Chh(){this._RegisterHostMessageReceivedEvent();return null}Ihh(){this._UnregisterHostMessageReceivedEvent();return null}}qe.oEg=!1;Object(ha.a)(qe,"AugLoopEventService",null,[]);var Be=a(1017),Ee=a(987),Ve=a(125),Oe=a(615);class Ye{constructor(B,ra,vb){this.xhd=this.TNe=
null;this.aU=B;this.CVe=ra;if(this.Ea=vb)this.TNe=this.Ea.Ya("GetAccessTokenOAuthFirstPartyAllowList")}ESi(){this.xhd||(this.xhd=Oe.a.Rw(Object(Be.a)()));return this.xhd}cnj(B,ra){if(!this.CVe||""===this.aU||!this.Ea)return!1;const vb=this.CVe.getOsfControl(this.aU);if(!vb)return!1;let dc=!1;this.TNe.split(";").forEach(Hc=>{ra===Hc&&(dc=!0)});return 1===La.AFrameworkApplication.ra.$g.qn&&vb.isFirstParty()&&B===Ye.eIh&&dc&&Ve.d(vb.getSolutionId())===Ye.fIh}getAccessTokenFirstPartyOAuth(B,ra){let vb;
vb=this.cnj(B,ra)?dc=>{const Hc=this.ESi();Hc.continueWith(()=>{Hc.result.nF(B,ra).then(ed=>{dc(ed);return ed})})}:dc=>{dc(Object.assign(new Ee.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(vb)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 1:return this.HEi(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}HEi(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
1,"string");return this.getAccessTokenFirstPartyOAuth(ra,B)}}Ye.eIh="Maker";Ye.fIh="fa000000043";Object(ha.a)(Ye,"Auth",null,[]);var nf=a(1070),of=a(47),Cf=a(68);class Ff{constructor(){this.MFa=null}NXi(){this.MFa||(this.MFa=Oe.a.Rw(Object(nf.a)()));return this.MFa}getSharedFilePickerResponse(B){return OfficeExtension.WacRuntime.Utility.createPromise((ra,vb)=>{try{const dc=this.NXi();Cf.Task.WAA.call(null,dc).continueWith(()=>{const Hc=dc.result;if(Hc){let ed={};(()=>{let Id=of.d(B);({Fz:ed}=Id);
return Id})().returnValue?Hc.GBc(ed).then(Id=>{Id&&0<Id.length?ra(Id):vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Id=>{vb(Id)}):vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(dc){vb(dc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 1:return this.MXi(ra)}B=this.invokeMethod(B,
ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}MXi(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");return this.getSharedFilePickerResponse(B)}}Object(ha.a)(Ff,"SharedFilePicker",null,[]);var Wf=a(184);class Mf{Dkf(B){return'[data-unique-id="Ribbon-'+B+'"]'}kvg(B,ra){ra=JSON.parse(ra);if("callout"===ra.type)return ra.params.target=this.Dkf(ra.params.target),B.callout(ra.params);ra.props.target=this.Dkf(ra.props.target);return ra.props}p6j(B){return JSON.parse(B)}addNotification(B,
ra){if(!this.iX)return Wf.a.IK().then(vb=>vb.addNotification(this.kvg(vb,B),this.p6j(ra)))}removeNotification(B){if(!this.iX)return Wf.a.IK().then(ra=>ra.removeNotification(B))}updateNotification(B,ra){if(!this.iX)return Wf.a.IK().then(vb=>vb.updateNotification(B,this.kvg(vb,ra)))}getTypeName(){return"Microsoft.Office.NotificationService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 1:return this.$zh(ra);case 3:return this.Imk(ra);case 2:return this.ral(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}$zh(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
0,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,1,"string");return this.addNotification(ra,B)}Imk(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");return this.removeNotification(B)}ral(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,1,"string");return this.updateNotification(ra,B)}}Object(ha.a)(Mf,"NotificationService",null,[]);class ng{constructor(B){this.Ybg=
B}execute(B,ra){if(this.Ybg){const vb=this.Ybg.lookupApi(B);if(vb)return vb.doExecutionAsync(ra)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}getTypeName(){return"Microsoft.Office.DispatchApiService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 1:return this.dui(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}dui(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
1,"string");return this.execute(ra,B)}}Object(ha.a)(ng,"DispatchApiService",null,[]);class Rf{createInstance(B,ra,vb,dc,Hc,ed){vb=void 0===vb?"":vb;dc=void 0===dc?null:dc;Hc=void 0===Hc?null:Hc;ed=void 0===ed?null:ed;switch(B){case "Microsoft.Office.ActionService":return new td(ra);case "Microsoft.Office.SharedFilePicker":return new Ff;case "Microsoft.Office.Auth":return new Ye(vb,dc,Hc);case "Microsoft.Office.AugLoopEventService":return new qe(vb);case "Microsoft.Office.NotificationService":return new Mf;
case "Microsoft.Office.DispatchApiService":return new ng(ed)}return null}}Object(ha.a)(Rf,"WacApiHost",null,[]);var $f=a(144);class jf{constructor(){this.responseData=null}}Object(ha.a)(jf,"UserFeedbackResponseEventArgs",null,[]);class Hf{constructor(){this.isFeedbackSent=!1}}Object(ha.a)(Hf,"UserFeedbackUIDismissedEventArgs",null,[]);var Uf=a(247);class If{constructor(B,ra,vb,dc){this.aU=B;this.blh=ra;this.iX=void 0===vb?!1:vb;this.bX=(void 0===dc?null:dc)||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(B){this.bX.fireEvent("",
65546,Object.assign(new Hf,{isFeedbackSent:B}))}onError(){}avi(B){this.bX.fireEvent("",65550,Object.assign(new jf,{responseData:JSON.stringify(B)}))}ISi(B){switch(B){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}JSi(B){switch(B){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}HSi(B){const ra={};ra.isScenarioEnabled=B.isScenarioEnabled;ra.scenarioType=B.scenarioType;if(B=B.question){const vb={};vb.questionUiType=
B.questionUIType;vb.questionUiBehavior=B.questionUiBehavior;vb.questionUiBehaviour=B.questionUiBehaviour;vb.questionInstruction=B.questionInstruction;vb.questionOptions=B.questionOptions;ra.questionDetails=vb}return ra}JVa(B,ra,vb){"True"===vb?B[ra]=!0:"False"===vb&&(B[ra]=!1)}canCollectUserFeedback(){return La.AFrameworkApplication.jD}collectUserFeedback(B,ra,vb,dc){if(!this.iX){const Hc={};La.AFrameworkApplication.ea.Yod(Hc);const ed=this.blh.getContext(Hc);ed.initialFeedbackType=this.ISi(B);ed.uiType=
this.JSi(ra);ed.telemetryGroup.featureArea=vb;dc.v2Config.contextDataFiles&&(ed.isShareContextDataEnabled=!0,ed.getContextData=()=>Promise.all(Uf.a.map(dc.v2Config.contextDataFiles,Id=>window.fetch("data:application/octet-stream;base64,"+Id.base64Data).then(Pd=>Pd.blob()).then(Pd=>new File([Pd],Id.fileName,{type:Id.fileType})))));(B=dc.v2Config.scenarioConfig)&&(ed.scenarioConfig=this.HSi(B));this.JVa(ed,"showEmailAddress",dc.v2Config.isEmailCollectionEnabled);this.JVa(ed,"isFileUploadEnabled",dc.v2Config.isFileUploadEnabled);
this.JVa(ed,"screenshot",dc.v2Config.isScreenshotEnabled);this.JVa(ed,"isScreenRecordingEnabled",dc.v2Config.isScreenRecordingEnabled);this.JVa(ed,"isThankYouPageDisabled",dc.v2Config.isThankYouPageDisabled);this.JVa(ed,"isHostManagedContextDataEnabled",dc.v2Config.isHostManagedContextDataEnabled);this.JVa(ed,"isRetrieveFormDataEnabled",dc.v2Config.isRetrieveFormDataEnabled);ed.hostManagedContextDataExplanationUrl=dc.v2Config.hostManagedContextDataExplanationUrl;Wf.a.QKf().then(Id=>{Id.initializeFeedbackModal(ed,
Object($f.a)(this,this.onDismiss,"onDismiss"),Object($f.a)(this,this.onError,"onError"),Object($f.a)(this,this.avi,"extractFeedbackDataForHost"));return Id})}}_RegisterUserFeedbackResponseEvent(){this.iX||this.bX.register(this.aU,"",65550)}_RegisterUserFeedbackUIDismissedEvent(){this.iX||this.bX.register(this.aU,"",65546)}_UnregisterUserFeedbackResponseEvent(){this.iX||this.bX.unregister(this.aU,"",65550)}_UnregisterUserFeedbackUIDismissedEvent(){this.iX||this.bX.unregister(this.aU,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B,ra){switch(B){case 27:return this.vUh();case 1:return this.q_h(ra);case 28:return this.Fhh();case 18:return this.Ghh();case 29:return this.Lhh();
case 19:return this.Mhh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}vUh(){return this.canCollectUserFeedback()}q_h(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"int"),vb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,1,"int"),dc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,2,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
3,"object");this.collectUserFeedback(ra,vb,dc,B);return null}Fhh(){this._RegisterUserFeedbackResponseEvent();return null}Ghh(){this._RegisterUserFeedbackUIDismissedEvent();return null}Lhh(){this._UnregisterUserFeedbackResponseEvent();return null}Mhh(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(ha.a)(If,"UserFeedbackService",null,[]);class sf{constructor(){this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=
!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0;this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0}getTypeName(){return"Microsoft.Office.SensitivityLabelInfo"}invokePropertyGet(B){switch(B){case 15:return this.color;case 13:return this.description;case 12:return this.displayName;case 8:return this.encryptionType;case 10:return this.hasExtractForUser;
case 9:return this.isDke;case 7:return this.isEnabled;case 5:return this.labelId;case 11:return this.order;case 14:return this.parentName;case 6:return this.tenantId;case 4:return this.version}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B,ra){switch(B){case 15:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,
0,"string");return;case 13:this.description=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 12:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 8:this.encryptionType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"int");return;case 10:this.hasExtractForUser=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"boolean");return;case 9:this.isDke=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,
0,"boolean");return;case 7:this.isEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"boolean");return;case 5:this.labelId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 11:this.order=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"int");return;case 14:this.parentName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,
0,"string");return;case 4:this.version=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}}
Object(ha.a)(sf,"SensitivityLabelInfo",null,[]);var tc;(function(B){B[B.zEi=0]="generic";B[B.coherencyFailure=1]="coherencyFailure";B[B.crf=2]="disabledByPolicy";B[B.xol=3]="fileCheckedOut";B[B.yol=4]="fileEncrypted";B[B.zol=5]="fileLocked";B[B.Bol=6]="fileNotSupported";B[B.fileTooLarge=7]="fileTooLarge";B[B.ipl=8]="invalidOperationOnZeroByteFile";B[B.qwj=9]="labelDisabled";B[B.Bpl=10]="labelErrorRetryLater";B[B.rwj=11]="labelIdNotFound";B[B.Cpl=12]="labelIrmDisabledByTenant";B[B.Dpl=13]="labelNotSupported";
B[B.Spl=14]="mandatoryConflict";B[B.Xpl=15]="minorVersionLimitExceeded"})(tc||(tc={}));Object(ha.b)("SetPolicyLabelErrorType",tc);var ld=a(1290),Ed;(function(B){B[B.Dll=0]="S_APPLYLABEL_OK";B[B.qdh=2147467259]="E_APPLYLABEL_FAIL";B[B.xdh=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT";B[B.pdh=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY";B[B.rdh=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION";B[B.sdh=2147205117]="E_APPLYLABEL_LABELDISABLED";B[B.zdh=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP";B[B.tdh=
2147205115]="E_APPLYLABEL_LABELING_DISABLED";B[B.wdh=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE";B[B.ydh=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE";B[B.udh=2147205112]="E_APPLYLABEL_LABELNOTFOUND";B[B.vdh=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"})(Ed||(Ed={}));Object(ha.b)("TryUpgradeLabelError",Ed);class ze{constructor(){this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null;this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null}getTypeName(){return"Microsoft.Office.SensitivityLabelChangedEventArgs"}invokePropertyGet(B){switch(B){case 20:return this.context;
case 21:return this.error;case 19:return this.newLabel;case 18:return this.previousLabel}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B,ra){switch(B){case 20:this.context=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 21:this.error=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,
"int");return;case 19:this.newLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"SensitivityLabelInfo");return;case 18:this.previousLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"SensitivityLabelInfo");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}}Object(ha.a)(ze,"SensitivityLabelChangedEventArgs",null,[]);var ge=a(183),Ne=a(130);class Ge{constructor(B,ra){this.bX=OfficeExtension.WacRuntime.RichApi.getEventManager();this.aU=B;this.tgc=ra}e7(){var B;return null===(B=La.AFrameworkApplication.ea)||void 0===B?void 0:B.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}upb(){var B;return null===
(B=La.AFrameworkApplication.ea)||void 0===B?void 0:B.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorCasesInOfficeJS",!1)}SZd(){var B;return null===(B=La.AFrameworkApplication.ea)||void 0===B?void 0:B.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorEventInOfficeJS",!1)}jId(B,ra,vb){const dc=new ze;dc.context=B;dc.error=ra;dc.newLabel=vb;this.bX.fireEvent("",65549,dc)}cL(B,ra){ge.a.sendTelemetryEvent({name:"Office.Online.Extensibility.ContextualTabsRichApi.Diagnostics",
dataFields:Ne.a.xn({["Class"]:"SensitivityService",["ControlId"]:this.aU,["Api"]:B,["Hr"]:ra.toString()})})}W0i(B){return B.HasUserDefinedPermissions?2:B.IsEndpointProtectionEnabled?1:0}V5c(B){var ra;const vb=new sf;vb.color=B.Color;vb.description=B.Tooltip;vb.displayName=B.ParentName?B.ParentName+"\\"+B.DisplayName:B.DisplayName;vb.encryptionType=this.W0i(B);vb.hasExtractForUser=B.HasExtractForUser;vb.isDke=!1;vb.isEnabled=B.Enabled;vb.labelId=B.Id;vb.order=B.Order;vb.parentName=B.ParentName;vb.tenantId=
null===(ra=La.AFrameworkApplication.ea)||void 0===ra?void 0:ra.Ya("TenantId");vb.version=0;return vb}KNj(B){const ra=new ld.a;ra.Id=B.labelId;ra.Enabled=B.isEnabled;ra.DisplayName=B.displayName;ra.Order=B.order;ra.Tooltip=B.description;ra.IsEndpointProtectionEnabled=1==B.encryptionType||2==B.encryptionType;ra.Color=B.color;ra.HasUserDefinedPermissions=2==B.encryptionType;ra.ParentName=B.parentName;return ra}NHk(B){switch(B){case tc.zEi:return 2147467259;case tc.crf:return 2147205115;case tc.rwj:return 2147205112;
case tc.qwj:return 2147205117;default:return 2147467259}}g0f(B){var ra;return B.tenantId===(null===(ra=La.AFrameworkApplication.ea)||void 0===ra?void 0:ra.Ya("TenantId"))}getHighestSensitivityLabel(B){return OfficeExtension.WacRuntime.Utility.createPromise((ra,vb)=>{var dc,Hc,ed;if(this.e7())if(!this.upb()||null!==(dc=La.AFrameworkApplication.ea)&&void 0!==dc&&dc.ka("SupportsPolicies"))if(B&&0!=B.length){if(this.upb()&&(null===(Hc=La.AFrameworkApplication.ea)||void 0===Hc||!Hc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpCopilotDisableTenantCheck",
!1)))for(const Pd of B)if(!this.g0f(Pd)){this.cL("getHighestSensitivityLabel",2147647531);vb(2147647531);return}if(dc=null===(ed=this.tgc)||void 0===ed?void 0:ed.instance){if(this.upb()){var Id=B.map(Pd=>Pd.labelId);if(Id=dc.getHighestSensitivityLabel(Id))return ra(this.V5c(Id));this.cL("getHighestSensitivityLabel",2147647531);return vb(2147647531)}ed=null;ed=[];for(Id of B)ed=ed.concat(Id.labelId);ed=dc.getHighestSensitivityLabel(ed);null==ed?(this.cL("getHighestSensitivityLabel",2147205112),vb(2147205112)):
ra(this.V5c(ed))}else this.cL("getHighestSensitivityLabel",2147942488),vb(2147942488)}else this.cL("getHighestSensitivityLabel",2147942487),vb(2147942487);else this.cL("getHighestSensitivityLabel",2147205115),vb(2147205115);else this.cL("getHighestSensitivityLabel",2147500033),vb(2147500033)})}getLabel(){return OfficeExtension.WacRuntime.Utility.createPromise((B,ra)=>{var vb;if(this.e7()){var dc=null===(vb=this.tgc)||void 0===vb?void 0:vb.instance;if(dc){var [Hc,ed]=dc.PFi();Hc?B(this.V5c(ed)):(this.cL("getLabel",
ed),ra(ed))}else this.cL("getLabel",2147942488),ra(2147942488)}else this.cL("getLabel",2147500033),ra(2147500033)})}tryUpgradeLabel(B,ra){return OfficeExtension.WacRuntime.Utility.createPromise((vb,dc)=>{var Hc,ed;if(this.e7())if(!this.upb()||null!==(Hc=La.AFrameworkApplication.ea)&&void 0!==Hc&&Hc.ka("SupportsPolicies"))if(B)if(this.upb()&&!this.g0f(B))this.cL("tryUpgradeLabel",2147205120),this.SZd()&&this.jId(ra,2147205120,B),dc(2147205120);else if(Hc=null===(ed=this.tgc)||void 0===ed?void 0:ed.instance)if(ra=
"OFFICEJS_SENSITIVITY_CONTEXT_"+ra,ed=Hc.tryUpgradeLabel(this.KNj(B),ra),0==ed)vb(ed);else{this.cL("tryUpgradeLabel",ed);if(this.SZd()&&(Object.values(Ed).includes(ed)&&this.jId(ra.substring(29),ed,B),2147205105===ed)){vb(0);return}dc(ed)}else this.cL("tryUpgradeLabel",2147942488),dc(2147942488);else this.cL("tryUpgradeLabel",2147942487),dc(2147942487);else this.cL("tryUpgradeLabel",2147205115),this.SZd()&&this.jId(ra,2147205115,B),dc(2147205115);else this.cL("tryUpgradeLabel",2147500033),dc(2147500033)})}_RegisterSensitivityLabelChangedEvent(){var B,
ra;this.e7()?!this.upb()||null!==(B=La.AFrameworkApplication.ea)&&void 0!==B&&B.ka("SupportsPolicies")?(B=null===(ra=this.tgc)||void 0===ra?void 0:ra.instance)?(B.VIb((vb,dc)=>{var Hc;vb=new ze;vb.context=(null===(Hc=dc.context)||void 0===Hc?0:Hc.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"))?dc.context.substring(29):dc.context;vb.error=dc.p2?0:this.NHk(dc.CRg);vb.newLabel=this.V5c(dc.Uoc);this.bX.fireEvent("",65549,vb)}),this.bX.register(this.aU,"",65549)):this.cL("registerSensitivityLabelChangedEvent",
2147942488):this.cL("getHighestSensitivityLabel",2147205115):this.cL("registerSensitivityLabelChangedEvent",2147500033)}_UnregisterSensitivityLabelChangedEvent(){this.e7()?this.bX.unregister(this.aU,"",65549):this.cL("unregisterSensitivityLabelChangedEvent",2147500033)}getTypeName(){return"Microsoft.Office.SensitivityService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){switch(B){case 16:return this.Dhh();case 17:return this.Jhh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 3:return this.KOi(ra);case 1:return this.YPi();case 2:return this.t6k(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}KOi(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
0,"Array<Common.App.AppsForOffice.SensitivityLabelInfo>");return this.getHighestSensitivityLabel(B)}YPi(){return this.getLabel()}t6k(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"SensitivityLabelInfo");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,1,"string");return this.tryUpgradeLabel(ra,B)}Dhh(){this._RegisterSensitivityLabelChangedEvent();return null}Jhh(){this._UnregisterSensitivityLabelChangedEvent();return null}}Object(ha.a)(Ge,"SensitivityService",
null,[]);class ca{launchSimpleDialog(){return null}getTypeName(){return"Microsoft.Office.ShowSimpleDialog"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokeMethodAsync(B,ra){switch(B){case 1:return this.yxj(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}yxj(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string"),vb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,1,"string"),dc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,2,"string"),Hc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,3,"int"),ed=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
4,"boolean"),Id=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,5,"string"),Pd=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,6,"boolean");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,7,"string");return this.launchSimpleDialog(ra,vb,dc,Hc,ed,Id,Pd,B)}}Object(ha.a)(ca,"ShowSimpleDialog",null,[]);var sb=a(1019),Ba=a(1625),V=a(1281),Fa=a(1283),sc=a(1279),Kc=a(1282);class qd{ARd(B){const ra=new V.a("FA000000012","sdxcatalog","sdxcatalog","0.0.0.0"),vb=new Kc.a(sb.a.KSi(),
"Web","en-Us"),dc=new Fa.a;dc.jx=B;Ba.a.instance.Bza(ra,sc.a.taskpane,"CopilotHelpTaskpane",vb,dc)}launchHelpPaneByArticleId(B){this.ARd({SourceControlId:"SearchHelp",query:"AssetID="+B});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByArticleIdString(B){this.ARd({SourceControlId:"SearchHelp",query:"AssetID="+B});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByQuery(B){this.ARd({SourceControlId:"SearchHelp",query:B});
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.CopilotService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokeMethodAsync(B,ra){switch(B){case 2:return this.fxj(ra);case 3:return this.gxj(ra);case 1:return this.hxj(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}fxj(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"int");return this.launchHelpPaneByArticleId(B)}gxj(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");return this.launchHelpPaneByArticleIdString(B)}hxj(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
0,"string");return this.launchHelpPaneByQuery(B)}}Object(ha.a)(qd,"CopilotService",null,[]);class Eb{constructor(B,ra){this.hideInternal=B;this.showInternal=ra}hide(B){this.checkInvalidArgument(B,"caller");return OfficeExtension.WacRuntime.Utility.createPromise((ra,vb)=>{this.hideInternal(B).then(ra).catch(vb)})}show(B,ra){this.checkInvalidArgument(B,"caller");this.checkInvalidArgument(ra,"options");return OfficeExtension.WacRuntime.Utility.createPromise((vb,dc)=>{this.showInternal(B,ra).then(vb).catch(dc)})}getTypeName(){return"Microsoft.Office.BusinessBarService"}checkInvalidArgument(B,
ra){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(B))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(ra);}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,
ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 2:return this.c9i(ra);case 1:return this.NRk(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}c9i(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"string");return this.hide(B)}NRk(B){const ra=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
0,"string");B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,1,"BusinessBarShowArgs");return this.show(ra,B)}}Object(ha.a)(Eb,"BusinessBarService",null,[]);class vc{constructor(){this.m_hideCloseButton=!1;this.m_message="";this.m_messageType=0;this.m_title=""}get hideCloseButton(){return this.m_hideCloseButton}set hideCloseButton(B){this.m_hideCloseButton=B}get message(){return this.m_message}set message(B){this.m_message=B}get messageType(){return this.m_messageType}set messageType(B){this.m_messageType=
B}get title(){return this.m_title}set title(B){this.m_title=B}getTypeName(){return"Microsoft.Office.BusinessBarShowArgs"}invokePropertyGet(B){switch(B){case 6:return this.hideCloseButton;case 4:return this.message;case 5:return this.messageType;case 3:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B,ra){switch(B){case 6:this.hideCloseButton=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"boolean");return;case 4:this.message=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 5:this.messageType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"int");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,
ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}}Object(ha.a)(vc,"BusinessBarShowArgs",null,[]);var Kd;(function(B){B[B.info=0]="info";B[B.error=1]="error";B[B.gOh=2]="blocked";B[B.Twl=3]="severeWarning";B[B.success=4]="success";B[B.warning=5]="warning"})(Kd||(Kd={}));
Object(ha.b)("BusinessBarType",Kd);var Zd=a(673);class nb{doExecutionAsync(B){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}}Object(ha.a)(nb,"DoEchoRichApi",null,[308]);var ic;(function(B){B[B.pnl=0]="camera";B[B.Wpl=1]="microphone";B[B.geolocation=2]="geolocation"})(ic||(ic={}));Object(ha.b)("DevicePermissionType",ic);class Bc{constructor(B){this.kUa=B}Okj(){var B;let ra=La.AFrameworkApplication.ea.Ya("OfficeApplicationName")||"";ra=ra.replace("Web","");return"excel"===ra.toLowerCase()?
!0:null===(B=La.AFrameworkApplication.ea)||void 0===B?void 0:B.getBooleanFeatureGate(`Microsoft.Office.${ra}Online.IsDevicePermissionServiceEnabled`,!1)}requestPermissions(B){const ra=this;return xo(function*(){if(!ra.Okj())throw Error("DevicePermissionService is not enabled");var vb=B.map(Ae=>ic[Ae]);const dc=ra.kUa.getManifest().getDefaultDisplayName(),Hc=yield ra.kUa.getBrowserPermissions(),ed=vb.filter(Ae=>!Hc.includes(Ae));if(0===ed.length)return yield ra.kUa.setBrowserPermissions(ed,!1),Promise.resolve(!0);
vb=ed.map(Ae=>{let Ke="";switch(Ae){case "camera":Ke=Object(xc.a)("CameraPermission");break;case "microphone":Ke=Object(xc.a)("MicrophonePermission");break;case "geolocation":Ke=Object(xc.a)("GeolocationPermission")}return Ke}).join(", ");const Id=new aa.a;Id.Oh=9;Id.xB=!1;Id.si(1,Object(xc.a)("DialogAllow"));Id.si(2,Object(xc.a)("DialogAllowOnce"));Id.si(0,Object(xc.a)("DialogDeny"));Id.Wod(Object(xc.a)("LearnMore"),null,"2263603");const Pd=String.format(Object(xc.a)("AddInRequestPermissionsTitle"),
dc,vb),Rd=String.format(Object(xc.a)("AddInRequestPermissionsDescription"),vb);let $d;return new Promise(Ae=>{Id.So(Pd,Rd,0,Ke=>{1===Ke?($d=!0,ra.kUa.setBrowserPermissions(ed,!0)):2===Ke?($d=!0,ra.kUa.setBrowserPermissions(ed,!1)):$d=!1;Ae($d)})})})}getTypeName(){return"Microsoft.Office.DevicePermissionService"}invokePropertyGet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);
}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 1:return this.Dtk(ra)}B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}Dtk(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"Array<string>");return this.requestPermissions(B)}}Object(ha.a)(Bc,
"DevicePermissionService",null,[]);class Qc{constructor(B,ra,vb,dc,Hc){this.gkc=this.yeb=null;this.Vdc=B;this.hs=ra;this.Iv=vb;this.th=dc;this.A1e=Hc;this.gkc=new Map;this.gkc.set("Sample.doEcho",new nb)}hostName(){return"ExcelOnline"}appId(){return this.Vdc}createInstance(B){switch(B){case "Microsoft.Authentication.AuthenticationService":B=Bb.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory");var ra=this.Iv.Fl,vb=this.hs;this.Iv.TK&&(vb=this.Iv.p6(this.hs));
return B.create(vb,ra);case "Microsoft.Authentication.TokenParameters":return new fd;case "Microsoft.ExcelServices.CustomFunctionManager":return B=Ga.EwaSettings.Na(114),ra=Ga.EwaSettings.Na(115),new gc(B,ra,Cc(this.Vdc,this.th,this.Iv));case "Microsoft.AppRuntime.AppRuntimeService":return new zc(this.hs,this.Iv);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return B=Sa.yb.Ma()?this.Iv:Ra.a(this.th),new od(this.Vdc,this.hs,B,this.Iv);case "Microsoft.DynamicRibbon.DynamicRibbon":return B=
Sa.yb.Ma()?this.Iv:Ra.a(this.th),ra=null,ra=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?B.LZa(this.hs).mo:B.ks(this.hs).mo,new Dc.DynamicRibbon(this.Vdc,this.hs,this.Iv,B,ra);case "Microsoft.Office.Licensing.License":return new xd(this.hs,this.Iv);case "Microsoft.InternalService.AddinInternalService":return new tb(this.hs);case "Microsoft.Office.AugLoopEventService":const dc=Sa.yb.Ma()?this.Iv:Ra.a(this.th);let Hc=null;Hc=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",
!1)?dc.LZa(this.hs).mo:dc.ks(this.hs).mo;ra=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===Hc.PrimaryMarketplace.SolutionId&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===this.th.ua.DocumentHostInfo.HostTier||"Dogfood"===La.AFrameworkApplication.mi.AudienceGroup);if(Zd.a(Hc)||ra())return B=Pd=>(Rd,$d,Ae)=>{dc.Zn.pRd({actionType:Pd,controlId:Rd,messageType:Ae,targetId:$d,message:""})},B={register:B(1),unregister:B(2),fireEvent:(Pd,
Rd,$d)=>{dc.Zn.qS(Rd,Pd)&&dc.TM(Rd,Pd,JSON.stringify($d))}},new qe(this.hs,!1,B);break;case "Microsoft.Office.UserFeedbackService":const ed=Sa.yb.Ma()?this.Iv:Ra.a(this.th);let Id=null;Id=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?ed.LZa(this.hs).mo:ed.ks(this.hs).mo;ra=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===Id.PrimaryMarketplace.SolutionId&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.UserFeedbackServiceDevBypass",!1)&&("TestHost"===
this.th.ua.DocumentHostInfo.HostTier||"Dogfood"===La.AFrameworkApplication.mi.AudienceGroup);if(Zd.a(Id)||ra())return B=Pd=>(Rd,$d,Ae)=>{ed.Zn.pRd({actionType:Pd,controlId:Rd,messageType:Ae,targetId:$d,message:""})},B={register:B(1),unregister:B(2),fireEvent:(Pd,Rd,$d)=>{ed.Zn.qS(Rd,Pd)&&ed.TM(Rd,Pd,JSON.stringify($d))}},new If(this.hs,Bb.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),!1,B);break;case "Microsoft.Office.SensitivityLabelInfo":return new sf;case "Microsoft.Office.SensitivityService":ra=
Sa.yb.Ma()?this.Iv:Ra.a(this.th);vb=null;vb=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?ra.LZa(this.hs).mo:ra.ks(this.hs).mo;if(Zd.a(vb))return new Ge(this.hs,Bb.a.instance.Dk("Common.App.Policy.Contracts.IPolicyManager"));break;case "Microsoft.Office.CopilotService":ra=Sa.yb.Ma()?this.Iv:Ra.a(this.th);vb=null;vb=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?ra.LZa(this.hs).mo:ra.ks(this.hs).mo;if("9202c06a-b7d3-466f-9adb-acad75789dbc"===
vb.PrimaryMarketplace.SolutionId)return new qd;break;case "Microsoft.Office.BusinessBarShowArgs":return new vc;case "Microsoft.Office.BusinessBarService":ra=(Sa.yb.Ma()?this.Iv:Ra.a(this.th)).ks(this.hs).mo;if(Zd.a(ra)){const Pd={officeScriptsRunningStatus:64,msFormsDataSyncRunningStatus:69},Rd=oa.a.resolve(Sa.E,{va:1}).catch($d=>{throw $d;});return new Eb($d=>xo(function*(){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(Pd[$d]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");
(yield Rd).removeEntry(Pd[$d])}),($d,Ae)=>xo(function*(){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(Pd[$d]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");Ae.businessBarType=Kd[Ae.messageType];(yield Rd).fnc(Pd[$d],Ae)}))}break;case "Microsoft.Office.ShowSimpleDialog":ra=(Sa.yb.Ma()?this.Iv:Ra.a(this.th)).ks(this.hs).mo;if(Zd.a(ra))return new ca;break;case "Microsoft.Office.DispatchApiService":if(ra=this.Iv.Fl)if(vb=ra.getOsfControl(this.hs),null===
vb||void 0===vb?0:vb.isFirstParty())return this.yeb||(this.yeb=new Rf),this.yeb.createInstance(B,this.A1e,this.hs,ra,La.AFrameworkApplication.ea,this);break;case "Microsoft.Office.DevicePermissionService":ra=Sa.yb.Ma()?this.Iv:Ra.a(this.th);vb=this.Iv.p6(this.hs);if(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IsDevicePermissionServiceEnabled",!1))return B=ra.Fl.getOsfControl(vb),new Bc(B);break;default:if(this.yeb||(this.yeb=new Rf),ra=this.yeb.createInstance(B,this.A1e,this.hs,this.Iv.Fl,
La.AFrameworkApplication.ea))return ra}ya.ULS.sendTraceTag(537163155,0,10,`Typename: ${B} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.generalException,Qb.a.generalException);}lookupApi(B){if(this.gkc)return this.gkc.get(B)}}Object(ha.a)(Qc,"RichApiHost",null,[]);var pd=a(446),Xd=a(33),ue=a(147),Ie=a(84),Je=a(42),He=a(120),hf=a(331),rf=a(102),qf=a(43),We=a(287),Jf=a(62),tf=a(8),ff=a(75),xf=a(1069),Lf=a(1465);
class Ig{constructor(){this.bNe=this.yMe=this.vsa=null;this.fEb=0}get displayName(){return this.vsa}set displayName(B){this.vsa=B}get email(){return this.yMe}set email(B){this.yMe=B}get federationProvider(){return this.bNe}set federationProvider(B){this.bNe=B}get identityType(){return this.fEb}set identityType(B){this.fEb=B}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(B){switch(B){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;
case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B,ra){switch(B){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,
0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}static G7h(B){const ra=
new Ig;ra.displayName=B.displayName;ra.email=B.email;if(ac.a.isChangeGateEnabled("OfficeVSO:8577366_FixIdentityType"))switch(B.authority){case "MicrosoftAccount":ra.identityType=1;break;default:ra.identityType=0}else switch(B.authority){case Lf.a.Wtg:ra.identityType=1;break;default:ra.identityType=0}ra.federationProvider="";return ra}}Object(ha.a)(Ig,"OfficeIdentityInfo",null,[]);class vf{static get Evf(){return vf.gmh}static Ulb(B){return B in vf.Evf?vf.Evf[B].toString():B}}vf.gmh={["GeneralException"]:Qb.a.generalException,
["AccessDenied"]:Qb.a.Knd,["ApiNotAvailable"]:Qb.a.Goc,["UserNotSignedIn"]:Qb.a.pCe,["UserAborted"]:Qb.a.zAb,["UnsupportedUserIdentity"]:Qb.a.x8k,["InvalidResourceUrl"]:Qb.a.Unb,["InvalidGrant"]:Qb.a.BGc,["AddinIsAlreadyRequestingToken"]:Qb.a.EGh,["ResourceNotAllowed"]:Qb.a.jvk,["ClientError"]:Qb.a.msc,["ServerError"]:Qb.a.serverError};vf.map=null;Object(ha.a)(vf,"SingleSignOnErrorCodeMap",null,[]);class rg{constructor(B,ra){this.xdc=B;this.fEb=ra}get accessToken(){return this.xdc}set accessToken(B){this.xdc=
B}get tokenIdenityType(){return this.fEb}set tokenIdenityType(B){this.fEb=B}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(B){switch(B){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B,ra){switch(B){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ra,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){B=this.invokeMethod(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}}
Object(ha.a)(rg,"SingleSignOnToken",null,[]);class jg{constructor(B,ra){this.ACb=ra;this.hs=B}get roamingSettings(){return null}getAccessToken(B){const ra=this.ACb.getOsfControl(this.hs),vb=ra.getManifest(),dc=vb.getMarketplaceID();this.GV(B,dc);return OfficeExtension.WacRuntime.Utility.createPromise((Hc,ed)=>{ra.isFirstParty()&&this.ACb._enableFirstPartySSO?this.sij(vb,B)?Bb.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(B,dc).then(Id=>{Hc(Id)},Id=>{ed(Id)}):ed(Qb.a.Knd):
ed(Qb.a.Goc)}).then(Hc=>{let ed;switch(Hc.authority){case Lf.a.Wtg:ed=1;break;default:ed=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new rg(Hc.accessToken,ed))},Hc=>{this.logErrorResponse(B,dc,Hc);return Hc?OfficeExtension.WacRuntime.Utility.createPromise((ed,Id)=>{Id(OfficeExtension.WacRuntime.Utility.createRichApiException(Hc,vf.Ulb(Hc)))}):OfficeExtension.WacRuntime.Utility.createPromise((ed,Id)=>{Id(OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.generalException,
vf.Ulb(Qb.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const B=this.ACb.getOsfControl(this.hs);B.getManifest();const ra=B.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((vb,dc)=>{Bb.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(ra).then(Hc=>{vb(Hc)},Hc=>{dc(Hc.toString())})}).then(vb=>{vb=Ig.G7h(vb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(vb)},vb=>vb?OfficeExtension.WacRuntime.Utility.createPromise((dc,
Hc)=>{Hc(OfficeExtension.WacRuntime.Utility.createRichApiException(vb,vf.Ulb(vb)))}):OfficeExtension.WacRuntime.Utility.createPromise((dc,Hc)=>{Hc(OfficeExtension.WacRuntime.Utility.createRichApiException(Qb.a.generalException,vf.Ulb(Qb.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(B){switch(B){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertyGetAsync(B){B=this.invokePropertyGet(B);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}invokePropertySet(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokePropertySetAsync(B,ra){this.invokePropertySet(B,ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(B){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(B);}invokeMethodAsync(B,ra){switch(B){case 1:return this.IEi(ra);case 3:return this.eGi();case 2:return this.BUi()}B=this.invokeMethod(B,
ra);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}IEi(B){B=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,fd);return this.getAccessToken(B)}eGi(){return this.getAuthContext()}BUi(){return this.getPrimaryIdentityInfo()}sij(B,ra){let vb=!1;const dc=B.getWebApplicationAuthorizations();B=null;for(const Hc of dc)if(Hc.getResource().toLowerCase()===ra.resource.toLowerCase()){B=Hc;vb=!0;break}if(!vb)return!1;ra=ra.scope.split(" ,+");for(const Hc of ra)if(Hc&&Hc.length){ra=
!1;for(const ed of B.getScopes())Hc.toLowerCase()===ed.toLowerCase()&&(ra=!0);if(!ra)return!1}return!0}GV(B,ra){B=this.khg(B.resource);ya.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:ra,["resource"]:B})}logErrorResponse(B,ra,vb){B=this.khg(B.resource);ya.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:ra,["resource"]:B,["error"]:vb})}khg(B){return B.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(ha.a)(jg,"AuthenticationService",null,[]);class sg{create(B,
ra){return new jg(B,ra)}}Object(ha.a)(sg,"AuthenticationServiceFactory",null,[]);Object(oa.b)(Sa.zb,{rk:"singleton"})(B=>xo(function*(){var ra;const vb=yield oa.a.resolve(Sa.Ob,B),dc=yield oa.a.resolve(Sa.yb,B),Hc=yield oa.a.resolve(Sa.rd,B),ed=yield oa.a.resolve(Sa.Xb,B),Id=yield oa.a.resolve(Sa.he,B);yield xf.a(vb.ya,null!==(ra=B.va)&&void 0!==ra?ra:0);yield oa.a.resolve(Sa.pd,B);Bb.a.instance.register(sg,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Ai().Ii(()=>
new sg);return new af(vb,dc,Id,Hc,ed)}));class af{constructor(B,ra,vb,dc,Hc){this.Bi=this.rangePicker=this.externalLinksManager=null;this.$=B;this.ti=ra;this.Bi=dc;this.Yk=new jd(B.fa);this.RJ=new Se(B,this.Yk);this.Ofg=vb;this.Fyc=new Map;this.externalLinksManager=Hc}get P0(){return this.Yk}dispose(){this.$=this.Fyc=null}Ri(){return!1}dj(){return!1}executeCommand(B,ra,vb){B=ra.command;switch(B){case 451041795:this.Yk.qo(vb[Ic.a.hl],vb[Ic.a.Wfa]);break;case 974713501:this.R4i(vb[Ic.a.hl],vb[Ic.a.Wfa]);
break;case 1237877382:this.Yk.FE(vb[Ic.a.Wfa]);break;default:return Na.a(B)}return Cf.Task.Ua(!0)}Ei(B,ra,vb){if(B=!!vb)switch(ra.command){case 974713501:case 1237877382:case 451041795:break;default:B=!1}return B}R4i(B,ra){var vb;const dc=B.DdaMethod;"undefined"===typeof dc.DispatchId?this.Yk.qo(Rb.a.internalError,ra):af.Ekj(B)||this.$.Kj&1?(dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Ld(this.$,this,B,ra,this.Bi)).start(this.ti,B.DdaMethod.ControlId):dc.DispatchId===
OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.kXi(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.KIk(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(B,this.RLd(B.DdaMethod.ControlId),0,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.yGi(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.cEk(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.xGi(B,
ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.qlk(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.rFi(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.z3d(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(B.DdaAddRowsColumns.IsRow=!0,this.v4e(B,ra)):dc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(B.DdaAddRowsColumns.IsRow=
!1,this.v4e(B,ra)):dc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.jei(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.lYh(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(B.DdaSetBindingFormats.IsSetFormats=!0,this.lPg(B,ra)):dc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(B.DdaSetBindingFormats.IsSetFormats=!1,this.lPg(B,ra)):dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(B,
B.DdaBindingsMethod.ItemName,B.DdaBindingsMethod.FailOnCollision?2:1,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.FMi(ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.M7d(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.pLi(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.qLi(B,ra):dc.DispatchId===
OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.slk(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(B.DdaMethod.ControlId,B),this.Yk.FE(ra)):dc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.IHj(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?this.FHj(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(B,ra):dc.DispatchId===
OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod?this.YNd(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteFeature?this.executeFeature(B,ra):dc.DispatchId===OSF.DDA.MethodDispId.dispidQueryFeature?this.queryFeature(B,ra):this.Yk.qo(Rb.a.rce,ra),Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&dc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(ra=B.DdaMethod.ControlId,this.ti.TK&&(ra=this.ti.p6(B.DdaMethod.ControlId)),B=this.ti.gY(ra),ra="",B&&(ra=Xa.DdaFacade.getSolutionId(B,this.$),ra=Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,B.OwnerAddinStoreType||B.PrimaryMarketplace.MarketplaceType,null===(vb=B.AssetMarketplace)||void 0===vb?void 0:vb.SolutionId,null,null,B.PrimaryMarketplace.MarketplaceRef)),ya.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${dc.DispatchId}, AppID: ${ra}`))):this.Yk.qo(Rb.a.isf,ra)}yGi(B,ra){B.DdaGetBindingData.CoerceType=
af.zsc(B.DdaGetBindingData.CoerceType);B.DdaGetBindingData.FilterType=af.KAf(B.DdaGetBindingData.FilterType);B.DdaGetBindingData.ValueFormat=af.T9g(B.DdaGetBindingData.ValueFormat);if(this.OKc(B.DdaGetBindingData.CoerceType,ra)){if(B.DdaGetBindingData){var vb=B.DdaGetBindingData;0===vb.FilterType&&(vb.FilterType=2);vb.StartCol|=0;vb.StartRow|=0;vb.ColCount=void 0===vb.ColCount?-1:vb.ColCount;vb.RowCount=void 0===vb.RowCount?-1:vb.RowCount}vb=B.DdaMethod.ControlId;this.ti.TK&&this.ti.e_&&(vb=this.ti.yxa(B.DdaMethod.ControlId));
this.RJ.ddaGetBindingData(vb,B.DdaGetBindingData.BindingId,B.DdaGetBindingData.CoerceType,B.DdaGetBindingData.ValueFormat,B.DdaGetBindingData.FilterType,B.DdaGetBindingData.StartRow,B.DdaGetBindingData.StartCol,B.DdaGetBindingData.RowCount,B.DdaGetBindingData.ColCount,dc=>{if(Td.a(dc)||!dc.Result)this.Yk.YR(dc,ra);else{const Hc=this.Yk.JR();Hc.Data=af.dcf(dc.Result);ra(Hc)}},ra)}}cEk(B,ra){B.DdaSetBindingData.CoerceType=af.zsc(B.DdaSetBindingData.CoerceType);if(this.OKc(B.DdaSetBindingData.CoerceType,
ra)){var vb=af.Aud(B.DdaSetBindingData.CoerceType,B.DdaSetBindingData.Data);if(af.YGc(vb))this.Yk.qo(Rb.a.M3c,ra);else{1===vb.CoerceType&&(vb.CellFormat||(vb.CellFormat=B.DdaSetBindingData.CellFormat),vb.TableOptions||(vb.TableOptions=B.DdaSetBindingData.TableOptions));B.DdaSetBindingData&&(B.DdaSetBindingData.StartCol|=0,B.DdaSetBindingData.StartRow|=0);var dc=B.DdaMethod.ControlId;this.ti.TK&&this.ti.e_&&(dc=this.ti.yxa(B.DdaMethod.ControlId));this.RJ.ddaSetBindingData(dc,B.DdaSetBindingData.BindingId,
B.DdaSetBindingData.StartRow,B.DdaSetBindingData.StartCol,vb,Hc=>{Td.a(Hc)?this.Yk.YR(Hc,ra):this.Yk.FE(ra)},ra)}}}kXi(B,ra){B.DdaGetBindingData.CoerceType=af.zsc(B.DdaGetBindingData.CoerceType);B.DdaGetBindingData.ValueFormat=af.T9g(B.DdaGetBindingData.ValueFormat);B.DdaGetBindingData.FilterType=af.KAf(B.DdaGetBindingData.FilterType);if(this.OKc(B.DdaGetBindingData.CoerceType,ra)){var vb=this.RLd(B.DdaMethod.ControlId);vb?this.RJ.ddaGetSelectedData(B.DdaMethod.ControlId,B.DdaGetBindingData.CoerceType,
B.DdaGetBindingData.ValueFormat,B.DdaGetBindingData.FilterType,vb,dc=>{if(Td.a(dc))this.Yk.YR(dc,ra);else{const Hc=this.Yk.JR();Hc.Data=af.dcf(dc.Result);ra(Hc)}},ra):this.Yk.qo(Rb.a.LMf,ra)}}pLi(B,ra){const vb=B[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],dc=B[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Hc=B.DdaMethod.ControlId,ed=zb.getInstance(this.$);if(0>=dc)ya.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Yk.qo(Rb.a.Ggj,
ra);else if(dc>zb.cGj)ya.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Yk.qo(Rb.a.WGf,ra);else{var Id=null;switch(vb){case 1:Id="Compressed";break;case 0:Id="Text";break;case 2:Id="Pdf";break;default:ya.ULS.sendTraceTag(537163219,344,15,`Requested file type ${vb} is not supported.`);this.Yk.qo(Rb.a.zAf,ra);return}if("Text"===Id)ya.ULS.sendTraceTag(537163218,344,15,`Requested file type ${Id} is not supported.`),this.Yk.qo(Rb.a.zAf,ra);else{Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?
(B=new Sys.StringBuilder,B.append(cc.a(this.$,Id)),"Pdf"===Id&&wd.a.pr(B,yb.a.iAg,"WholeWorkbook"),B=B.toString()):B=cc.a(this.$,Id);var Pd=null,Rd=new XMLHttpRequest;Rd.onreadystatechange=()=>{if(4===Rd.readyState)if(200===Rd.status){var $d=Rd.response;if($d){Pd=new Uint8Array($d);$d=this.Yk.JR();var Ae=Pd.length,Ke=zb.tLj(),Ze={},cg=0;for(let Vf=0;Vf<Ae;Vf+=dc){const Xf=[],Pf=Vf+dc<Ae?Vf+dc:Ae;for(let Kg=0,oh=Vf;oh<Pf;Kg++,oh++)Xf[Kg]=Pd[oh];Ze[(cg++).toString()]=Xf}Ze=new Ta(Ke,Ae,dc,Ze);Ze=ed.Yyh(Hc,
Ze);Ze!==Rb.a.success?this.Yk.qo(Ze,ra):($d[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Ke,$d[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Ae,ya.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${Id}, the file size is ${Ae}`),ra($d))}else ya.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${Id}.`),this.Yk.qo(Rb.a.internalError,ra)}else 500===Rd.status?this.Yk.qo(Rb.a.rDf(parseInt(Rd.statusText,
10)),ra):(ya.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${Id}.`),this.Yk.qo(Rb.a.XKj,ra))};Rd.open("GET",B,!0);Rd.responseType="arraybuffer";Rd.setRequestHeader("If-Modified-Since","0");Rd.send(null)}}}qLi(B,ra){var vb=B[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],dc=B[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];B=B.DdaMethod.ControlId;(vb=zb.getInstance(this.$).sLi(B,vb))?(vb=vb.IUk,0>dc||dc>=Object.keys(vb).length?this.Yk.qo(Rb.a.Maj,
ra):(dc=vb[dc.toString()],vb=this.Yk.JR(),vb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=dc,vb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=dc.length,ra(vb))):this.Yk.qo(Rb.a.internalError,ra)}slk(B,ra){var vb=B[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];B=B.DdaMethod.ControlId;vb=zb.getInstance(this.$).rlk(B,vb);vb===Rb.a.success?this.Yk.FE(ra):this.Yk.qo(vb,ra)}KIk(B,ra){B.DdaSetBindingData.CoerceType=af.zsc(B.DdaSetBindingData.CoerceType);if(this.OKc(B.DdaSetBindingData.CoerceType,
ra)){var vb=this.RLd(B.DdaMethod.ControlId);if(vb){var dc=af.Aud(B.DdaSetBindingData.CoerceType,B.DdaSetBindingData.Data),Hc=ja.f(this.$).ha;1===dc.CoerceType&&(!dc.Data&&Hc.pa.h7&&(dc.Headers||(dc.Headers=[]),dc.Headers.length||dc.Headers.push([]),dc.Headers[0].length||dc.Headers[0].push("")),af.YGc(dc)||(dc.CellFormat||(dc.CellFormat=B.DdaSetBindingData.CellFormat),dc.TableOptions||(dc.TableOptions=B.DdaSetBindingData.TableOptions)));if(af.YGc(dc))this.Yk.qo(Rb.a.M3c,ra);else{var ed=Hc.pa.oj.clone(),
Id=Hc.pa.activeCell.clone();this.RJ.ddaSetSelectedData(B.DdaMethod.ControlId,vb,dc,Pd=>{var Rd;if(Td.a(Pd))this.Yk.YR(Pd,ra);else{Pd=ed.clone();const $d=dc.Headers?dc.Headers[0].length:dc.Data[0].length;1!==dc.CoerceType||dc.Data?1===dc.CoerceType&&(null===(Rd=dc.TableOptions)||void 0===Rd?0:Rd.length)&&0==dc.TableOptions[0]?(Pd.top+=1,Pd.bottom=Pd.top+dc.Data.length-1):Pd.bottom=Pd.top+dc.Data.length-(1===dc.CoerceType?0:1):Pd.bottom=Pd.top+1;Pd.right=Pd.left+$d-1;Rd=Pd.contains(Id)?Id:Pd.topLeft;
Hc.updateSelection(Pd,Rd,0);this.Yk.FE(ra)}},ra)}}else this.Yk.qo(Rb.a.Mef,ra)}}addBinding(B,ra,vb,dc){if(ra){var Hc=B.DdaMethod.ControlId;this.ti.TK&&this.ti.e_&&(Hc=this.ti.yxa(B.DdaMethod.ControlId));this.RJ.ddaAddBinding(Hc,B.DdaBindingsMethod.BindingId,B.DdaBindingsMethod.BindingType,ra,vb,ed=>{if(Td.a(ed))this.Yk.YR(ed,dc);else{const Id=this.Yk.JR();Id.Bindings=Array(1);Id.Bindings[0]=this.ti.Rpc(ed.Result);dc(Id)}},dc)}else this.Yk.qo(Rb.a.eBk,dc)}xGi(B,ra){let vb=B.DdaMethod.ControlId;this.ti.TK&&
this.ti.e_&&(vb=this.ti.yxa(B.DdaMethod.ControlId));this.RJ.ddaGetBinding(vb,B.DdaBindingsMethod.BindingId,dc=>{if(Td.a(dc)||!dc.Result)this.Yk.YR(dc,ra);else{const Hc=this.Yk.JR();Hc.Bindings=Array(1);Hc.Bindings[0]=this.ti.Rpc(dc.Result);ra(Hc)}},ra)}FMi(B){const ra=this.Yk.JR(),vb={};vb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;ra[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=vb;B(ra)}qlk(B,ra){let vb=B.DdaMethod.ControlId;this.ti.TK&&
this.ti.e_&&(vb=this.ti.yxa(B.DdaMethod.ControlId));this.RJ.ddaReleaseBinding(vb,B.DdaBindingsMethod.BindingId,dc=>{Td.a(dc)?this.Yk.YR(dc,ra):this.Yk.FE(ra)},ra)}rFi(B,ra){let vb=B.DdaMethod.ControlId;this.ti.TK&&this.ti.e_&&(vb=this.ti.yxa(B.DdaMethod.ControlId));this.RJ.ddaGetAllBindings(vb,dc=>{if(Td.a(dc))this.Yk.YR(dc,ra);else{const Hc=this.Yk.JR();if(dc.Result){dc=dc.Result;Hc.Bindings=Array(dc.length);for(let ed=0;ed<dc.length;ed++)Hc.Bindings[ed]=this.ti.Rpc(dc[ed])}else Hc.Bindings=null;
ra(Hc)}},ra)}z3d(B,ra){this.RJ.ddaLoadSettings(B.DdaMethod.ControlId,vb=>{if(Td.a(vb))this.Yk.YR(vb,ra);else{const dc=this.Yk.JR();dc.Properties=vb.Result;ra(dc)}},ra)}saveSettings(B,ra){const vb={Settings:[]};for(let dc=0;dc<B.DdaSettingsMethod.Properties.length;dc++){const Hc={};Hc.Name=B.DdaSettingsMethod.Properties[dc][0];Hc.Value=B.DdaSettingsMethod.Properties[dc][1];vb.Settings[dc]=Hc}this.RJ.ddaSaveSettings(B.DdaMethod.ControlId,vb,B.DdaSettingsMethod.OverwriteIfStale,dc=>{Td.a(dc)?this.Yk.YR(dc,
ra):this.Yk.FE(ra)},ra)}v4e(B,ra){const vb=af.Aud(1,B.DdaAddRowsColumns.Data);af.YGc(vb)?this.Yk.qo(Rb.a.M3c,ra):this.RJ.ddaAddRowsColumns(B.DdaMethod.ControlId,B.DdaAddRowsColumns.BindingId,B.DdaAddRowsColumns.IsRow,vb,dc=>{Td.a(dc)?this.Yk.YR(dc,ra):this.Yk.FE(ra)},ra)}jei(B,ra){this.RJ.ddaDeleteAllDataValues(B.DdaMethod.ControlId,B.DdaBindingsMethod.BindingId,vb=>{Td.a(vb)?this.Yk.YR(vb,ra):this.Yk.FE(ra)},ra)}lYh(B,ra){this.RJ.ddaClearBindingFormats(B.DdaMethod.ControlId,B.DdaClearBindingFormats.BindingId,
vb=>{Td.a(vb)?this.Yk.YR(vb,ra):this.Yk.FE(ra)},ra)}lPg(B,ra){const vb={},dc=B.DdaSetBindingFormats.IsSetFormats;dc?vb.CellFormat=B.DdaSetBindingFormats.CellFormat:vb.TableOptions=B.DdaSetBindingFormats.TableOptions;this.RJ.ddaSetBindingFormats(B.DdaMethod.ControlId,B.DdaSetBindingFormats.BindingId,vb,dc,Hc=>{Td.a(Hc)?this.Yk.YR(Hc,ra):this.Yk.FE(ra)},ra)}executeRichApiRequest(B,ra){var vb;const dc=B.ArrayData,Hc={},ed=ja.f(this.$).ha;if(dc){if("WacPartition"===dc[0]){this.Uti(B,ra);return}const Ke=
Sa.yb.Ma()?this.ti:Object(Aa.a)(Xa.DdaFacade,Ra.a(this.$));var Id=B.DdaMethod.ControlId;this.ti.TK&&this.ti.e_&&(Id=this.ti.p6(B.DdaMethod.ControlId));"SetOsfControlContainerReadyForCustomFunctions"===dc[0]&&(Id=Ke.ks(Id))&&(Id.mJc=!0,Id.rzg());Hc.HttpMethod=dc[1];Hc.PathAndQuery=dc[2];Hc.RequestHeaders=af.GIf(dc[3]);Hc.RequestBody=dc[4];Hc.AppPermission=dc[5];Id=dc[6];Hc.RequestFlags=Id;var Pd=0;if($b.i(this.$.la))switch(ed.Hk){case 1:Pd=2;break;case 2:Pd=3;break;case 64:Pd=16;break;case 128:Pd=
4;break;default:Pd=1}var Rd=null;ed.$a.AK&&(Rd=ed.$a.AK.Zq);Hc.SheetMultiRange=Zc.t(ed.pa.selectedRanges,this.$);Hc.ActiveCell=Zc.x(ed.pa.activeCell,this.$);Hc.ActiveFloatingObjectId=Rd;Hc.SelectionState=Pd;Pd=null;this.ti.TK?this.ti.e_?(Rd=this.ti.yxa(B.DdaMethod.ControlId),Pd=this.ti.p6(B.DdaMethod.ControlId),Pd=this.ti.gY(Pd),Hc.InstanceId=Rd):(Pd=this.ti.gY(B.DdaMethod.ControlId),Hc.InstanceId=Pd?Pd.InstanceId:""):(Pd=this.ti.gY(B.DdaMethod.ControlId),Hc.InstanceId=Pd?Pd.InstanceId:"");if(Pd&&
Pd.PrimaryMarketplace){let Ze;if(Pd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)Ze=Pd.PrimaryMarketplace.SolutionId,Rd=Pd.PrimaryMarketplace.MarketplaceType;else{if(!Pd.OwnerAddinSolutionId){ya.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.Yk.qo(Rb.a.$Vb,ra);return}if(!Pd.OwnerAddinStoreType){ya.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Yk.qo(Rb.a.$Vb,ra);return}Ze=
Pd.OwnerAddinSolutionId;Rd=Pd.OwnerAddinStoreType}const cg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ze,Rd,null===(vb=Pd.AssetMarketplace)||void 0===vb?void 0:vb.SolutionId,null,null,Pd.PrimaryMarketplace.MarketplaceRef);Hc.CompliantSolutionId=cg;Hc.SolutionId=Ze;Hc.MarketplaceType=Rd;Hc.SolutionVersion=Pd.PrimaryMarketplace.SolutionVersion;Hc.StoreLocation=Pd.PrimaryMarketplace.MarketplaceRef}else Hc.SolutionId=Hc.MarketplaceType="",Hc.CompliantSolutionId="";Hc.IsEventsEnabled=void 0===Ke||null===
Ke||Ke.Zn.gpc(Hc.InstanceId);Hc.RequestGuid=Nb.a.create().toString();vb=Hc.RequestBody.length;if(vb>this.$.ua.ExcelRichApiMaxAllowedRequestPayloadSize){this.Yk.qo(Rb.a.Atk,ra);ya.ULS.sendTraceTag(537163213,0,50,`Request payload size:${vb} exceeded the limit`);return}Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Id&4096&&(vb=new la(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(vb,Ub,dc),Hc.RequestBody=dc[4])}const $d=af.lMf(Hc.RequestHeaders);af.lde++;
const Ae=Xd.a.kh.vi;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Hc&&Hc.RequestBody&&ya.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Hc.RequestBody.length}`);this.RJ.executeRichApiRequest(Hc,Ke=>{var Ze;this.tOg(Ae,!0,Ke.ServerCorrelationId);let cg=null,Vf=null;var Xf=Ke.ServerCorrelationId;if(null===(Ze=null===Ke||void 0===Ke?void 0:Ke.Errors)||void 0===Ze?0:Ze[0])cg=Ke.Errors[0].MessageIdName,Vf=Ke.Errors[0].Description,ff.a(this.$).yj.kK(Ke.Errors[0].MessageId);
if(Td.a(Ke)||!Ke.Result)this.lrb(Xf,$d,"Server error",cg,Vf),this.Yk.YR(Ke,ra);else{let Kg=null;if(Ga.EwaSettings.Na(233))if((Ze=Ke.Result)&&Ze.length){for(let Gh=0;Gh<Ze.length;Gh++)if(Ze[Gh].RequestGuid===Hc.RequestGuid){Kg=Ze[Gh];break}Kg||this.Yk.YR(Ke,ra)}else Kg=Ke.Result;else Kg=Ke.Result;if(!cg&&Kg&&Kg.ResponseBody&&Kg.ResponseBody[0])if(Ke=Kg.ResponseBody[0],Ke.startsWith('{"Error":')){1<Kg.ResponseBody.length&&(Ke=Ke.substring(0,Ke.indexOf("}")+1),Ke+="}");try{var Pf=Tc.a.Vp(Ke);Pf.Error&&
this.lrb(Xf,$d,"Pipeline error",Pf.Error.Code,Pf.Error.Message)}catch(Gh){this.lrb(Xf,$d,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.lrb(Xf,$d);else this.lrb(Xf,$d,"Server error",cg,Vf);const oh=(Xf=Kg.SheetMultiRange)?Xf.SheetName:null;Pf=Kg.ActiveFloatingObjectId;const Hg=Kg.SelectionState;Ke=5===Hg&&!!Xf||6===Hg||7===Hg||17===Hg||8===Hg;if(this.$.vh.UE&&Ke)this.Yk.qo(Rb.a.m6c,ra),ya.ULS.sendTraceTag(537163211,0,50,`${Hg.toString()} is not allowed`);else if(5===
Hg&&Xf){if(this.$.sa&&oh)if(this.$.sa.Pq(oh))this.rod(oh);else{let Gh=null;Gh=()=>{this.$.sa.Pq(oh)&&(ya.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.rod(oh),this.$.sa.HVc(Gh))};this.$.sa.Fnc(Gh);if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let xi=null;xi=()=>{this.$.sa.Pq(oh)&&(this.rod(oh),this.$.sa.iBa(xi))};this.$.sa.rua(xi)}}}else if(6===Hg||7===Hg||17===Hg||8===Hg||9===Hg){if(Xf){const Gh=Zc.h(Xf.Ranges);
if(oh&&Zc.mb(Gh,!0))if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.sa.Pq(oh)){let xi=null;xi=()=>{this.a8g(ed,Gh,oh,Hg);this.$.sa.iBa(xi)};this.$.sa.rua(xi)}else this.a8g(ed,Gh,oh,Hg)}if(7===Hg||17===Hg||8===Hg)Pf="{"+Ve.e(Pf)+"}",rf.a(this.$).QAk(Pf);9===Hg&&(this.$.ua.ApiCallToSetPageLayout=!0)}Kg.PostProcessActions?(Xf=Tc.a.Vp(Kg.PostProcessActions),this.i$j(Xf).then(()=>{this.Ywb(Kg,ra);this.lId(B.DdaMethod.ControlId,Hc);return Promise.resolve(null)},
Gh=>{this.Ywb(Kg,ra,Gh);return Promise.reject(Gh)})):this.Ywb(Kg,ra)}},Ke=>{this.tOg(Ae,!1,null);this.lrb(null,$d,"Web service error");ra(Ke)})}lId(B,ra){const vb=Sa.yb.Ma()?this.ti:Object(Aa.a)(Xa.DdaFacade,Ra.a(this.$));(null===vb||void 0===vb?0:vb.ine)&&vb.ks(B)&&af.qNk(ra.RequestHeaders)&&(ya.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${B}; SolutionId: ${ra.SolutionId}.`),vb.ine.qni(B))}Uti(B,ra){var vb=B.DdaMethod.ControlId;
this.ti.TK&&this.ti.e_&&(vb=this.ti.p6(B.DdaMethod.ControlId));const dc=this.ti.gY(vb),Hc=Xa.DdaFacade.getSolutionId(dc,this.$);var ed=null;ed=Xa.DdaFacade.PJa(dc,this.$);ed=new Jc(ed,this.$);this.ti.TK&&this.ti.e_&&(vb=this.ti.yxa(B.DdaMethod.ControlId));ed=new Qc(Hc,vb,this.ti,this.$,ed);const Id={ResponseHeaders:[]};Id.ResponseBody=Array(1);vb=af.GIf(B.ArrayData[3]);const Pd=af.lMf(vb);vb=new Wa(this.$.ua.CreateWorkbookMaxAllowedBase64Size,this.Ofg);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(ed,
Fb,vb,B.ArrayData).then(Rd=>{if(!Rd)return this.s4d(!1,"The rich api executor call failed",Pd),ya.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Id.ResponseStatusCode=500,this.Ywb(Id,ra),null;this.s4d(!0,"The rich api executor call succeeded",Pd);Id.ResponseStatusCode=Rd[0];Id.ResponseBody[0]=Rd[2];this.Ywb(Id,ra);return null},Rd=>{Id.ResponseStatusCode=400;Id.ResponseBody[0]=Rd.toString();this.s4d(!1,"The rich api executor call failed",Pd);ya.ULS.sendTraceTag(537163207,0,10,
`A Excel Rich API batch execution was failed, AppId:${Hc}`);this.Ywb(Id,ra);return null})}tOg(B,ra,vb){af.lde--;B=ue.a(Xd.a.kh,B);ya.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${B}, requests pending:${af.lde}, request result:${ra?"success":"false"}, server correlationid: ${vb}.`)}Ywb(B,ra,vb){vb=void 0===vb?null:vb;const dc=Array(3);dc[0]=B.ResponseStatusCode;dc[1]=af.SYi(B.ResponseHeaders);const Hc=[];var ed=!1;if(vb&&B.ResponseBody){const Id=Tc.a.Vp(B.ResponseBody.join(""));
Id.Error||(ed={},ed.Error=vb,ed.TraceIds=Id.TraceIds,ed.ProcessedResults={},ed.ProcessedResults.Results=Id.Results,Hc[0]=Tc.a.Di(ed),ed=!0)}dc[2]=ed?Hc:B.ResponseBody;B=this.Yk.JR();B.Data=dc;ra(B)}M7d(B,ra){(new re(this.$,this.Yk,this.RJ)).M7d(B,ra)}IHj(B,ra){ya.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const vb=B[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],dc=B[mc.a.Xqd],Hc=B[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];B=this.$.qa.zh(232).jjb.JHj(B.DdaMethod.ControlId,
vb,dc,Hc);B===Rb.a.success?this.Yk.FE(ra):(ya.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.Yk.qo(B,ra))}FHj(B,ra){ya.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const vb=B[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],dc=B[mc.a.Xqd],Hc=B[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin],ed=this.$.qa.zh(232);let Id=B.DdaMethod.ControlId;this.ti.TK&&(Id=this.ti.p6(B.DdaMethod.ControlId));ed.jjb.$Bk(Id,vb,dc,Hc);this.Yk.FE(ra)}getAccessToken(B,ra){ya.ULS.sendTraceTag(537163203,
0,50,"GetAccessToken API called!");let vb=B.DdaMethod.ControlId;this.ti.TK&&(vb=this.ti.p6(B.DdaMethod.ControlId));const dc=(Hc,ed)=>{var Id;if(Hc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Hc=this.Yk.JR(),Hc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=ed.accessToken,ra(Hc);else{ed=this.ti.gY(vb);const Pd=null!==ed.OwnerAddinStoreType?ed.OwnerAddinStoreType:ed.PrimaryMarketplace.MarketplaceType;ya.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:Hc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Xa.DdaFacade.getSolutionId(ed,
this.$),Pd,null===(Id=ed.AssetMarketplace)||void 0===Id?void 0:Id.SolutionId,null,null,ed.PrimaryMarketplace.MarketplaceRef),["storeType"]:Pd})}.`);this.Yk.qo(Hc,ra)}};Sa.pd.Ma()?void oa.a.resolve(Sa.pd,{va:1}).then(Hc=>{const ed=this.ti.Fl,Id=Pa.getInstance();Y.a.getInstance(ed,Hc,Id).getAccessToken(vb,!0,B,dc)}):Ka.TaskExtensions.$e(Yc.GetServiceTaskFactory.create(this.$.qa,137,this.$.ya,1),Hc=>{const ed=this.ti.Fl,Id=Pa.getInstance();Y.a.getInstance(ed,Hc.result,Id).getAccessToken(vb,!0,B,dc)},
this.$.ya)}getAuthContext(B,ra){const vb=()=>{var dc=this.ti.Fl,Hc=B.DdaMethod.ControlId;this.ti.TK&&(Hc=this.ti.p6(B.DdaMethod.ControlId));dc=dc.getOsfControl(Hc);if(dc.isFirstParty()){dc=dc.getManifest();Hc=dc.getMarketplaceID();var ed=dc.getWebApplicationId(),Id=dc.getWebApplicationMsaId();Bb.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Hc).then(Pd=>{const Rd=this.Yk.JR(),$d={};$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=ed;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=
Id||ed;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Pd.upn;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Pd.userId;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Pd.authority;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=oc.a.hGi(Pd.authorityType);$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Pd.isAnonymous;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Pd.tenantId;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=
Pd.supportsAuthToken;Rd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=$d;ra(Rd)},Pd=>{const Rd=this.Yk.JR(),$d={},Ae=new oc.a;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=ed;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Id||ed;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ae.upn;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ae.userId;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ae.authority;
$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Ae.authorityType;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ae.isAnonymous;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ae.tenantId;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Pd;$d[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ae.supportsAuthToken;Rd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=$d;Rd.Error=1;ra(Rd)})}};Sa.pd.Ma()?
void oa.a.resolve(Sa.pd,{va:1}).then(()=>{vb()}):Ka.TaskExtensions.$e(Yc.GetServiceTaskFactory.create(this.$.qa,137,this.$.ya,1),()=>{vb()},this.$.ya)}YNd(B,ra){let vb=B.DdaMethod.ControlId;this.ti.TK&&(vb=this.ti.p6(B.DdaMethod.ControlId));B=$a.YNd(this.ti.Fl,vb);B.errorCode===Rb.a.success?(B=Object.assign({},this.Yk.JR(),B.context),ra(B)):this.Yk.qo(B.errorCode,ra)}executeFeature(B,ra){32===La.AFrameworkApplication.xh.$k(B[0],2)?ra(this.Yk.JR()):this.Yk.qo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
ra)}queryFeature(B,ra){B=[32===La.AFrameworkApplication.xh.$k(B[0],1),!0];B=Object.assign({},this.Yk.JR(),B);ra(B)}okj(B){const ra=ja.f(this.$).ha;return 16===ra.Hk&&!!ra.$a.Ih&&!!ra.$a.Ih.floatingObject&&$c.a.equals(ra.$a.Ih.floatingObject.id,B,!0)}RLd(B){const ra=ja.f(this.$).ha;return ra.pa.Yn?1===ra.Hk||this.okj(B)?ra.Uva:null:null}OKc(B,ra){return 1!==B&&2!==B&&3!==B?(this.Yk.qo(Rb.a.Yhf,ra),!1):!0}s4d(B,ra,vb){const dc={};dc.a=this.$.ua.UserSessionId;dc.b=B;dc.c=ra;dc.d=null;dc.e=vb;Jf.b().Ol(37,
dc)}lrb(B,ra,vb,dc,Hc){vb=void 0===vb?null:vb;dc=void 0===dc?null:dc;Hc=void 0===Hc?null:Hc;const ed={};B&&(ed.ServerCorrelationId=B);void 0!==ra&&null!==ra&&(ed.Source=ra);vb&&(ed.ErrorType=vb);dc&&(ed.MessageId=dc);Hc&&(ed.StatusDescription=Hc);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&dc&&"ExternalDataRefreshFailed"===dc&&(ed.StatusDescription="");ya.ULS.sendTraceTag(50688452,0,50,Tc.a.Di(ed))}i$j(B){let ra=new Promise(vb=>{vb(null)});for(let vb=0;vb<B.length;vb++)ra=
this.h$j(ra,B[vb]);return ra}h$j(B,ra){const vb=this;return xo(function*(){if(!ra)return ya.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),B.then(()=>Promise.reject(af.vlb(Qa.generalException,Yb.a.instance.ia(1765),null)));switch(ra.actionType){case 1:case 2:B=B.then(()=>{const ed=Sa.yb.Ma()?vb.ti:Object(Aa.a)(Xa.DdaFacade,Ra.a(vb.$));if(ed.ks(ra.controlId))switch(ed.Zn.pRd(ra),ra.messageType){case 14:case 100:ed.hne.Bpc(ra);break;case 11:case 12:ed.Kwk.jKb(ra);break;case 51:case 52:ed.Iwk.jKb(ra);
break;case 2101:case 2102:ed.Jwk.jKb(ra);break;case 2E3:ed.Lwk.Bpc(ra);break;case 2201:vb.$.$ya&&ed.ine.CLh(ra);break;case 2203:ed.Mwk.DLh(ra);break;case 2700:Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&ed.gne.Bpc(ra);break;case 65541:ed.fne.BLh(ra)}else ya.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${ra.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:B=B.then(()=>{vb.r3i(ra);return Promise.resolve(null)});break;case 15:Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
(B=B.then(()=>{vb.G5i(ra);return Promise.resolve(null)}));break;case 4:B=B.then(()=>{var ed=ja.f(vb.$).ha.pa.activeCell;ed.top!==ra.row+1&&ed.left!==ra.column+1&&(ed=Zc.x(db.Range.yi(ra.row+1,ra.column+1),vb.$),ja.f(vb.$).fp(ed,null,null,null,3,"DdaMethodHandler.ShowCard"));Sa.J.Ma()?void oa.a.resolve(Sa.J,{va:0}).then(Id=>{Id.W8a(ra.row+1,ra.column+1,1,!1,!1)}):Vc.a(vb.$,243,242,0,Id=>{Id.W8a(ra.row+1,ra.column+1,1,!1,!1)});return Promise.resolve(null)});break;case 7:B=B.then(()=>{(Sa.yb.Ma()?vb.ti:
Object(Aa.a)(Xa.DdaFacade,Ra.a(vb.$))).Zn.puf(ra.controlId,ra.isEnableEvents);return Promise.resolve(null)});break;case 5:B=B.then(()=>vb.obi(ra));break;case 6:B=B.then(()=>vb.d4j(ra));break;case 8:B=B.then(()=>{Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&(Sa.yb.Ma()?vb.ti:Object(Aa.a)(Xa.DdaFacade,Ra.a(vb.$))).kYh();const ed=new We.a(tf.a.hq,5,null);qf.a(vb.$).Zy(ed);return Promise.resolve(null)});break;case 9:B=B.then(()=>vb.hEk(ra));
break;case 10:B=B.then(()=>vb.khl(ra));break;case 11:B=B.then(()=>vb.jhl());break;case 12:B=B.then(()=>vb.ghl());break;case 13:B=B.then(()=>vb.hhl(ra));break;case 14:B=B.then(()=>vb.ihl(ra));break;case 16:B=B.then(()=>Promise.resolve(ra));break;case 17:B=B.then(()=>vb.$zk(ra,Object(Aa.a)(Xa.DdaFacade,Sa.yb.Ma()?vb.ti:Ra.a(vb.$))));break;case 18:ja.f(vb.$).focus();break;case 19:vb.VPf(ra.entryType,!1,ra.options);break;case 20:vb.VPf(ra.entryType,!0,ra.options);break;case 21:const dc=Sa.yb.Ma()?vb.ti:
Ra.a(vb.$);B=B.then(()=>dc.fne.U2i(ra));break;case 22:const Hc=Sa.yb.Ma()?vb.ti:Ra.a(vb.$);B=B.then(()=>Hc.fne.V2i(ra));break;case 23:(ta.a.eXb(vb.$)||ta.a.qV())&&vb.ti.JKg.v6i(ra.worksheetId,ra.anchorCell,ra.values,ra.options);break;case 24:(ta.a.eXb(vb.$)||ta.a.qV())&&vb.ti.JKg.k4i(ra.worksheetId);break;default:B=B.then(()=>Promise.reject(af.vlb(Qa.HIh,Yb.a.instance.ia(1766),null)))}return B})}G5i(B){var ra=(Sa.yb.Ma()?this.ti:Object(Aa.a)(Xa.DdaFacade,Ra.a(this.$))).ks(B.controlId);if(ra&&!(0===
B.operationType^!ra.Iqa)){ja.f(this.$).rVb=!0;switch(B.operationType){case 0:var vb=new hf.a(document.createElement("input"));vb.text=B.range;ra.Aej(ja.f(this.$).ho.L$h(vb,new pd.a(this.$)));ra.Iqa.startEdit(!0);break;case 1:ra.HFg();this.rangePicker=null;break;case 2:ra.Iqa.q8g(B.range);break;case 3:ra.Iqa.q8g(B.startingRange);ra=B.expandSelection;vb=B.getNextDataRegionCell;let dc=0;switch(B.keyboardDirectionValue){case 2:dc=38;B=ra&&vb?105288353:ra?-31900117:vb?542791952:137938150;break;case 3:dc=
40;B=ra&&vb?-1297307319:ra?-1603798598:vb?1713663844:-798660877;break;case 0:dc=37;B=ra&&vb?-403586027:ra?2039316657:vb?-2012742350:-1470715894;break;case 1:dc=39;B=ra&&vb?784916030:ra?589730764:vb?1324884057:-1231471547;break;default:B=1461300262}ra=this.auc("keydown",dc,ra,vb);ja.f(this.$).m7b(ra,new Ie.a(B,1,0,8,null))}ja.f(this.$).rVb=!1}}auc(B,ra,vb,dc){const Hc=document.createEvent("KeyboardEvent");if(Gc.a.kJ)Hc.initKeyboardEvent(B,!1,!1,window.self,"A",0,dc,!1,vb,!1);else{let ed="";vb&&(ed+=
"Shift");dc&&(ed+=0<ed.length?" Control":"Control");Hc.initKeyboardEvent(B,!1,!1,window.self,"A",0,ed,!1,"en-US")}B=new Sys.UI.DomEvent(Hc);B.keyCode=ra;return B}r3i(B){switch(B.operationType){case 1:void oa.a.resolve(Sa.Yc,{va:0}).then(ra=>{ra.bme()});break;case 2:if(B=(Sa.yb.Ma()?this.ti:Object(Aa.a)(Xa.DdaFacade,Ra.a(this.$))).ks(B.controlId))B.mJc=!0,B.rzg()}}obi(B){const ra=B.fileBase64;return ra&&ra.length>this.$.ua.CreateWorkbookMaxAllowedBase64Size?Promise.reject(af.vlb(Qa.invalidArgument,
Yb.a.instance.ia(1769),"Application.CreateWorkbook")):(new Promise((vb,dc)=>{const Hc=new aa.a;Hc.Oh=4;Hc.So(La.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.GeneralAddInMessageDialogTitle:CommonUIStrings.l_GeneralAddInMessageDialogTitle,La.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.NewFileAPIConsentMessage:CommonUIStrings.l_NewFileAPIConsentMessage,1,ed=>{2!==ed&&0!==ed||dc(af.vlb(Qa.oce,Yb.a.instance.ia(1768),"Application.CreateWorkbook"));ed=new rc("blank",
"agave",ra?"streamBase64":"streamEmpty",ra);this.Ofg.create(vb,dc,ed).yib()})})).then(vb=>{this.Fyc.set(B.fakeFileId,vb);return Promise.resolve(null)},vb=>vb?Promise.reject(vb):Promise.reject(af.vlb(Qa.generalException,Yb.a.instance.ia(1765),"Application.CreateWorkbook")))}d4j(B){return new Promise((ra,vb)=>{if(this.Fyc.has(B.fakeFileId)){const dc=this.Fyc.get(B.fakeFileId);vb=new aa.a;vb.Oh=4;La.AFrameworkApplication.ea.ka("IsNewStringEnabled")?vb.So(CommonUiStrings.GeneralAddInMessageDialogTitle,
CommonUiStrings.OpenWindowConsentMessage,1,Hc=>{1===Hc&&ad.HelperMethods.Em(dc,void 0,void 0,"DdaMethodHandler.fileUrl");ra(null)}):vb.So(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Hc=>{1===Hc&&ad.HelperMethods.Em(dc,void 0,void 0,"DdaMethodHandler.fileUrl");ra(null)})}else vb(af.vlb(Qa.generalException,Yb.a.instance.ia(1765),"Document.Open"))})}hEk(B){return new Promise(ra=>{(Sa.yb.Ma()?this.ti:Object(Aa.a)(Xa.DdaFacade,Ra.a(this.$))).KKg=B.runtimeCalculationMode;
const vb=oa.a.lh(Sa.Ed);vb&&vb.N8d(3===B.runtimeCalculationMode);ra(null)})}khl(B){ta.a.fZb(this.$)&&(Sa.Xb.Ma()?this.externalLinksManager:this.$.qa.zh(331)).Zwb(0,B.urlStr,!0,!0,null);return Promise.resolve(null)}jhl(){ta.a.fZb(this.$)&&(Sa.Xb.Ma()?this.externalLinksManager:this.$.qa.zh(331)).Zwb(1,null,!0,!0,null);return Promise.resolve(null)}ghl(){ta.a.fZb(this.$)&&(Sa.Xb.Ma()?this.externalLinksManager:this.$.qa.zh(331)).lxc();return Promise.resolve(null)}hhl(B){ta.a.fZb(this.$)&&(Sa.Xb.Ma()?this.externalLinksManager:
this.$.qa.zh(331)).Zwb(5,B.urlStr,!0,!0,null);return Promise.resolve(null)}ihl(B){if(ta.a.fZb(this.$)){const ra=Sa.Xb.Ma()?this.externalLinksManager:this.$.qa.zh(331);for(const vb of ra.nna)vb.IsActive&&vb.HostEditUrl&&vb.UrlStr===B.hostEditUrlStr&&ad.HelperMethods.Em(vb.HostEditUrl,"_blank")}return Promise.resolve(null)}$zk(B,ra){const vb=ib.a.kW;B=Tc.a.Vp(B.payload);const dc={};"eventId"in B&&"payload"in B&&(dc.eventId=B.eventId,dc.payload=B.payload);ra.TM(2201,vb,Tc.a.Di(dc));return Promise.resolve(null)}VPf(B,
ra,vb){const dc=oa.a.lh(Sa.E);dc&&(B=this.dHi(B))&&(ra?dc.removeEntry(B):dc.fnc(B,vb))}dHi(B){switch(B){case 0:return 64;case 1:if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}rod(B){B=Object(Aa.a)(He.a,this.$.sa.getItemByName(B));(null===B||void 0===B?0:B.visible)&&B.activate({disableAutoFocusOnGrid:!0,scenario:"dda"})}a8g(B,ra,vb,dc){var Hc=B.pa.Ly;const ed=Hc<ra.length&&ra[Hc].contains(B.pa.activeCell);B=ed?B.pa.activeCell:ra[0].topLeft;Hc=ed?Hc:0;ja.f(this.$).q1(ra,
Hc,vb,null,B,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===dc)}static get Fci(){af.hEa||(af.hEa={},af.hEa[Microsoft.Office.WebExtension.CoercionType.Table]=1,af.hEa[Microsoft.Office.WebExtension.CoercionType.Text]=2,af.hEa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,af.hEa[Microsoft.Office.WebExtension.CoercionType.Html]=4,af.hEa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return af.hEa}static get Ici(){af.MCb||(af.MCb={},af.MCb[Microsoft.Office.WebExtension.FilterType.All]=
1,af.MCb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return af.MCb}static get Jci(){af.NCb||(af.NCb={},af.NCb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,af.NCb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return af.NCb}static GIf(B){if(!B||!B.length)return null;const ra=Array(B.length/2);for(let vb=0;vb<B.length/2;vb++)ra[vb]={},ra[vb].Name=B[2*vb],ra[vb].Value=B[2*vb+1];return ra}static SYi(B){if(!B||!B.length)return null;const ra=Array(2*B.length);for(let vb=
0;vb<B.length;vb++)ra[2*vb]=B[vb].Name,ra[2*vb+1]=B[vb].Value;return ra}static FId(B){if(!B||!B.length)return null;const ra=Array(B.length);for(let vb=0,dc=B.length;vb<dc;vb++){const Hc=B[vb].length;if(Hc){ra[vb]=Array(Hc);for(let ed=0;ed<Hc;ed++)ra[vb][ed]=null==B[vb][ed]?null:B[vb][ed].toString()}else return null}return ra}static zsc(B){return"string"===typeof B?Je.a.Vw(af.Fci,B,0):B}static KAf(B){return"string"===typeof B?Je.a.Vw(af.Ici,B,0):B}static T9g(B){return"string"===typeof B?Je.a.Vw(af.Jci,
B,0):B}static Ekj(B){switch(B.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static Aud(B,ra){const vb={};vb.CoerceType=B;1===vb.CoerceType?(vb.Data=af.FId(ra.Rows),vb.Headers=af.FId(ra.Headers)):vb.Data=af.FId(ra);return vb}static dcf(B){return 1===B.CoerceType?{["Headers"]:B.Headers,["Rows"]:B.Data}:B.Data}static YGc(B){return 1===B.CoerceType?!B.Data&&!B.Headers:!B.Data}static lMf(B){let ra="Unknown";if(!B)return ra;for(let vb=0;vb<B.length;vb++)if(B[vb].Name.toLowerCase()===
yb.a.Nwk){ra=B[vb].Value;break}return ra}static qNk(B){if(!B)return!1;const ra=yb.a.NNj.toLowerCase();for(let vb=0;vb<B.length;vb++)if(B[vb].Name.toLowerCase()===ra)return!0;return!1}static vlb(B,ra,vb){const dc={};dc.Code=B;dc.Message=ra;dc.Location=vb;dc.ActionIndex=0;return dc}}af.hEa=null;af.MCb=null;af.NCb=null;af.lde=0;Object(ha.a)(af,"DdaMethodHandler",null,[36,2]);var Ef=a(215);class be{constructor(){this.gbd=this.hbd=this.Mhd=this.$md=null}get operations(){this.Mhd||(this.Mhd=new Ef.a,this.ri());
return this.Mhd}get y5c(){this.$md||(this.$md=new Ef.a,this.Um());return this.$md}get cAf(){this.gbd||(this.gbd=new Ef.a);return this.gbd}get featureGates(){this.hbd||(this.hbd=new Ef.a,this.initializeFeatureGates());return this.hbd}Um(){}initializeFeatureGates(){}Fj(B){this.y5c.add(B)}di(B){this.operations.contains(B)||this.operations.add(B)}J3e(B){this.cAf.add(B)}}Object(ha.a)(be,"MacroRecorderEventBase",null,[]);class h extends be{constructor(){super()}get eventId(){return 130}ri(){this.di(100)}}
Object(ha.a)(h,"AccessibilityCheckRunEvent",be,[]);class qc extends be{constructor(){super()}get eventId(){return 160}ri(){this.di(241)}Um(){this.Fj(B=>B.addToPrintArea)}}Object(ha.a)(qc,"AddedToPrintAreaEvent",be,[]);class ma extends be{constructor(){super()}get eventId(){return 65}ri(){this.di(516)}}Object(ha.a)(ma,"AutoFilterToggledEvent",be,[]);class Ab extends be{constructor(){super()}get eventId(){return 118}ri(){this.di(502)}Um(){this.Fj(B=>!(B.xmb().FirstColumn===B.xmb().LastColumn&&B.xmb().FirstRow===
B.xmb().LastRow))}}Object(ha.a)(Ab,"AutoSumEvent",be,[]);class ec extends be{constructor(){super()}get eventId(){return 223}ri(){this.di(1032)}}Object(ha.a)(ec,"CellImageAltTextAppliedEvent",be,[]);class na extends be{constructor(B,ra){super();this.Csa=B;this.pel=ra}get eventId(){return this.Csa}ri(){this.di(529);this.di(594)}Um(){this.Fj(B=>this.pel.includes(B.oOd()))}}Object(ha.a)(na,"ChartPropertyAppliedEventBase",be,[]);class pb extends na{constructor(){super(84,[348,349,350,351,352,353,354,355,
356,357,372,373,374,375])}}Object(ha.a)(pb,"ChartAxisChangedEvent",na,[]);class R extends na{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(ha.a)(R,"ChartAxisTitleChangedEvent",na,[]);class ua extends na{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(ha.a)(ua,"ChartDataLabelsChangedEvent",na,[]);class xb extends na{constructor(){super(76,[-100])}}Object(ha.a)(xb,"ChartDataSelectedEvent",na,[]);class W extends na{constructor(){super(83,
[500,501,502])}}Object(ha.a)(W,"ChartDataTableChangedEvent",na,[]);class xa extends be{constructor(){super()}}Object(ha.a)(xa,"RichApiRequestExecutedEventBase",be,[]);class kb extends xa{constructor(){super()}get eventId(){return 117}$K(B){kb.Nia||(kb.Nia=new Xb.a(Kb.a.tm()),kb.Nia.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),kb.Nia.add("fa000000014"));return!!B&&kb.Nia.contains(B.toLowerCase())}ri(){this.di(507);this.di(10);this.di(576)}Um(){this.Fj(B=>Object(ea.a)(Cd,B)&&(B=Object(Aa.a)(Cd,B),B.isValid&&
this.$K(B.source))?(ya.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${B.eventId}`),!0):!1)}}kb.Nia=null;Object(ha.a)(kb,"ChartFormatRichApiRequestExecutedEvent",xa,[]);class Pb extends na{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(ha.a)(Pb,"ChartGridlinesChangedEvent",na,[]);class T extends be{constructor(){super()}get eventId(){return 66}ri(){this.di(528)}}Object(ha.a)(T,"ChartInsertedEvent",be,[]);class Za extends na{constructor(){super(81,
[100,101,102,103,104,105,106])}}Object(ha.a)(Za,"ChartLegendChangedEvent",na,[]);class Db extends na{constructor(){super(75,[-101])}}Object(ha.a)(Db,"ChartRowColumnSwitchedEvent",na,[]);class kc extends na{constructor(){super(79,[0,1,2,-102])}}Object(ha.a)(kc,"ChartTitleChangedEvent",na,[]);class Wc extends na{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(ha.a)(Wc,
"ChartTypeChangedEvent",na,[]);class yd extends be{constructor(){super()}get eventId(){return 131}ri(){this.di(521)}}Object(ha.a)(yd,"ConnectorFloatingObjectResizedEvent",be,[]);class Od extends be{constructor(){super()}get eventId(){return 129}ri(){this.di(109)}}Object(ha.a)(Od,"EntitySelectedEvent",be,[]);class me extends be{constructor(){super()}get eventId(){return 49}ri(){this.di(149);this.di(147)}}Object(ha.a)(me,"FindCellEvent",be,[]);class De extends be{constructor(){super()}get eventId(){return 96}ri(){this.di(122)}}
Object(ha.a)(De,"FloatingObjectAltTextAppliedEvent",be,[]);class Le extends be{constructor(){super()}get eventId(){return 93}ri(){this.di(522)}}Object(ha.a)(Le,"FloatingObjectDeletedEvent",be,[]);class Pe extends be{constructor(){super()}get eventId(){return 94}ri(){this.di(524)}}Object(ha.a)(Pe,"FloatingObjectMovedAndResizedEvent",be,[]);class ef extends be{constructor(){super()}get eventId(){return 95}ri(){this.di(523)}}Object(ha.a)(ef,"FloatingObjectRotatedEvent",be,[]);class yf extends be{constructor(){super()}get eventId(){return 100}ri(){this.di(543)}}
Object(ha.a)(yf,"GroupDetailsShownOrHiddenEvent",be,[]);class Kf extends be{constructor(){super()}get eventId(){return 154}ri(){this.di(125)}}Object(ha.a)(Kf,"HyperlinksRemovedFromRangeEvent",be,[]);class ig extends xa{constructor(){super()}get eventId(){return 125}$K(B){ig.Nia||(ig.Nia=new Xb.a(Kb.a.tm()),ig.Nia.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ig.Nia.add("fa000000005"));return!!B&&ig.Nia.contains(B.toLowerCase())}ri(){this.di(507);this.di(10);this.di(576)}Um(){this.Fj(B=>Object(ea.a)(Cd,
B)?(B=Object(Aa.a)(Cd,B),B.isValid&&this.$K(B.source)):!1)}}ig.Nia=null;Object(ha.a)(ig,"IdeasRichApiRequestExecutedEvent",xa,[]);class kg extends be{constructor(){super()}get eventId(){return 136}ri(){this.di(115)}}Object(ha.a)(kg,"LinkedEntityConvertedEvent",be,[]);class vg extends be{constructor(){super()}get eventId(){return 148}ri(){this.di(114)}}Object(ha.a)(vg,"LinkedEntityDisambiguationPaneToggledEvent",be,[]);class yg extends be{constructor(){super()}get eventId(){return 127}ri(){this.di(119)}}
Object(ha.a)(yg,"MovedToEdgeEvent",be,[]);class ag extends be{constructor(){super()}get eventId(){return 135}ri(){this.di(191)}}Object(ha.a)(ag,"NamedSheetViewCreatedEvent",be,[]);class gg extends be{constructor(){super()}get eventId(){return 166}ri(){this.di(200)}}Object(ha.a)(gg,"NamedSheetViewDeletedEvent",be,[]);class ch extends be{constructor(){super()}get eventId(){return 133}ri(){this.di(192)}}Object(ha.a)(ch,"NamedSheetViewExitedEvent",be,[]);class Eg extends be{constructor(){super()}get eventId(){return 162}ri(){this.di(199)}}
Object(ha.a)(Eg,"NamedSheetViewRenamedEvent",be,[]);class ph extends be{constructor(){super()}get eventId(){return 167}ri(){this.di(195)}}Object(ha.a)(ph,"NamedSheetViewSwitchedEvent",be,[]);class Rg extends be{constructor(){super()}get eventId(){return 99}ri(){this.di(174)}}Object(ha.a)(Rg,"OutlineLevelSetEvent",be,[]);class Dg extends be{constructor(){super()}get eventId(){return 156}ri(){this.di(244)}}Object(ha.a)(Dg,"PageBreakInsertedEvent",be,[]);class fb extends be{constructor(){super()}get eventId(){return 157}ri(){this.di(245)}}
Object(ha.a)(fb,"PageBreakRemovedEvent",be,[]);class Va extends be{constructor(){super()}get eventId(){return 158}ri(){this.di(246)}}Object(ha.a)(Va,"PageBreaksAllResetEvent",be,[]);class bd extends be{constructor(){super()}get eventId(){return 112}ri(){this.di(503)}Um(){this.Fj(B=>!!B.pasteParameters.ClientEstimationFloatingObjectId&&2===B.pasteParameters.CopyPasteTargetType&&!B.isFromCurrentSession)}}Object(ha.a)(bd,"PasteArtOtherWorkbookEvent",be,[]);class je extends be{constructor(){super()}get eventId(){return 52}ri(){this.di(503)}Um(){this.Fj(B=>
!!B.pasteParameters.ClientEstimationFloatingObjectId&&2===B.pasteParameters.CopyPasteTargetType&&B.isFromCurrentSession)}}Object(ha.a)(je,"PasteArtSameWorkbookEvent",be,[]);class se extends be{constructor(){super()}get eventId(){return 110}ri(){this.di(204)}}Object(ha.a)(se,"PasteHtmlEvent",be,[]);class Xe extends be{constructor(){super()}get eventId(){return 35}ri(){this.di(506)}}Object(ha.a)(Xe,"PasteRangeEvent",be,[]);class wf extends be{constructor(){super()}get eventId(){return 111}ri(){this.di(503)}Um(){this.Fj(B=>
1===B.pasteParameters.CopyPasteTargetType)}}Object(ha.a)(wf,"PasteShadowWorkbookRangeEvent",be,[]);class Nf extends be{constructor(){super()}get eventId(){return 42}ri(){this.di(180)}}Object(ha.a)(Nf,"PasteStringEvent",be,[]);class fg extends be{constructor(){super()}get eventId(){return 134}ri(){this.di(220)}}Object(ha.a)(fg,"PendingMergeEvent",be,[]);class Of extends be{constructor(){super()}get eventId(){return 122}ri(){this.di(510)}}Object(ha.a)(Of,"PictureInsertedEvent",be,[]);class Bg extends be{constructor(){super()}get eventId(){return 153}ri(){this.di(161)}}
Object(ha.a)(Bg,"PivotDrillToggledEvent",be,[]);class uf extends be{constructor(B,ra){super();this.Csa=B;this.opType=ra}get eventId(){return this.Csa}ri(){this.di(225)}Um(){this.Fj(B=>B.opType===this.opType)}}Object(ha.a)(uf,"PivotTableSettingsChangedEventBase",be,[]);class Lg extends uf{constructor(){super(171,4)}}Object(ha.a)(Lg,"PivotTableAllItemLabelsRepeatedEvent",uf,[]);class zg extends uf{constructor(){super(184,17)}}Object(ha.a)(zg,"PivotTableAltTextDescriptionChangedEvent",uf,[]);class mh extends uf{constructor(){super(183,
16)}}Object(ha.a)(mh,"PivotTableAltTextTitleChangedEvent",uf,[]);class Cg extends uf{constructor(){super(173,6)}}Object(ha.a)(Cg,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",uf,[]);class Sf extends uf{constructor(){super(172,5)}}Object(ha.a)(Sf,"PivotTableBlankLineAfterEachItemToggledEvent",uf,[]);class dh extends uf{constructor(){super(170,3)}}Object(ha.a)(dh,"PivotTableColumnGrandTotalShownEvent",uf,[]);class jh extends be{constructor(){super()}get eventId(){return 98}ri(){this.di(132)}}
Object(ha.a)(jh,"PivotTableCreatedEvent",be,[]);class lc extends uf{constructor(){super(177,10)}}Object(ha.a)(lc,"PivotTableDisplayErrorStringToggledEvent",uf,[]);class md extends uf{constructor(){super(178,11)}}Object(ha.a)(md,"PivotTableDisplayNullStringToggledEvent",uf,[]);class Yd extends uf{constructor(){super(179,12)}}Object(ha.a)(Yd,"PivotTableErrorStringChangedEvent",uf,[]);class ke extends uf{constructor(){super(174,7)}}Object(ha.a)(ke,"PivotTableExpandCollapseButtonsShownEvent",uf,[]);class bf extends uf{constructor(){super(187,
20)}}Object(ha.a)(bf,"PivotTableIndentChangedEvent",uf,[]);class cf extends uf{constructor(){super(176,9)}}Object(ha.a)(cf,"PivotTableItemsWithNoDataOnColumnsShownEvent",uf,[]);class Df extends uf{constructor(){super(175,8)}}Object(ha.a)(Df,"PivotTableItemsWithNoDataOnRowsShownEvent",uf,[]);class Af extends uf{constructor(){super(186,19)}}Object(ha.a)(Af,"PivotTableLayoutTypeSetEvent",uf,[]);class qg extends uf{constructor(){super(180,13)}}Object(ha.a)(qg,"PivotTableNullStringChangedEvent",uf,[]);
class Pg extends be{constructor(){super()}get eventId(){return 149}ri(){this.di(219)}}Object(ha.a)(Pg,"PivotTablePivotLocationChangedEvent",be,[]);class Mg extends be{constructor(){super()}get eventId(){return 102}ri(){this.di(145)}}Object(ha.a)(Mg,"PivotTablePivotedEvent",be,[]);class gh extends uf{constructor(){super(182,15)}}Object(ha.a)(gh,"PivotTableRefreshDataOnLoadToggledEvent",uf,[]);class Hh extends be{constructor(){super()}get eventId(){return 104}ri(){this.di(50)}Um(){this.Fj(B=>!!B.pivotTableId&&
!!B.pivotTableName)}}Object(ha.a)(Hh,"PivotTableRefreshedEvent",be,[]);class Ph extends uf{constructor(){super(168,1)}}Object(ha.a)(Ph,"PivotTableRenamedEvent",uf,[]);class rh extends uf{constructor(){super(169,2)}}Object(ha.a)(rh,"PivotTableRowGrandTotalShownEvent",uf,[]);class eh extends uf{constructor(){super(181,14)}}Object(ha.a)(eh,"PivotTableSaveSourceDataWithFileToggledEvent",uf,[]);var Yf=a(760);class Qg extends be{constructor(){super()}get eventId(){return 155}ri(){this.di(131)}Um(){this.Fj(B=>
{B=Object(Aa.a)(Yf.a,B);return!!B&&!!B.getFieldName()&&!!B.hierarchyName})}}Object(ha.a)(Qg,"PivotTableSortedEvent",be,[]);class uh extends uf{constructor(){super(185,18)}}Object(ha.a)(uh,"PivotTableSubTotalsVisibilitySettingSetEvent",uf,[]);class Kh extends be{constructor(){super()}get eventId(){return 206}ri(){this.di(560)}}Object(ha.a)(Kh,"PivotValueFieldSettingAppliedEvent",be,[]);class ai extends be{constructor(){super()}get eventId(){return 161}ri(){this.di(243)}}Object(ha.a)(ai,"PrintAreaClearedEvent",
be,[]);class fh extends be{constructor(){super()}get eventId(){return 159}ri(){this.di(241)}Um(){this.Fj(B=>!B.addToPrintArea)}}Object(ha.a)(fh,"PrintAreaSetEvent",be,[]);class Uh extends be{constructor(){super()}get eventId(){return 57}ri(){this.di(517)}}Object(ha.a)(Uh,"RangeAutoFilterClearedEvent",be,[]);class Sg extends be{constructor(B,ra){super();this.Csa=B;this.vCe=ra}get eventId(){return this.Csa}ri(){this.di(11)}Um(){this.Fj(B=>16===B.i1().ValidMembers);this.Fj(B=>B.i1().Font.ValidMembers===
this.vCe)}}Object(ha.a)(Sg,"RangeFontFormattedEventBase",be,[]);class xh extends Sg{constructor(){super(3,4)}}Object(ha.a)(xh,"RangeBoldedEvent",Sg,[]);class Fg extends be{constructor(){super()}get eventId(){return 2}ri(){this.di(11)}Um(){this.Fj(B=>128===B.i1().ValidMembers)}}Object(ha.a)(Fg,"RangeBorderedEvent",be,[]);class Tg{}Tg.rtb="Table";Tg.IRc="Sheet";Object(ha.a)(Tg,"MacroRecorderEventConstants",null,[]);class sh extends be{constructor(){super()}get eventId(){return 113}ri(){this.di(208)}Um(){this.Fj(B=>
B.getParameters().FilterType===Tg.IRc)}}Object(ha.a)(sh,"RangeCheckedItemsFilteredEvent",be,[]);class Vh extends be{constructor(){super()}get eventId(){return 109}ri(){this.di(105)}}Object(ha.a)(Vh,"RangeConditionalFormattingCreatedEvent",be,[]);class Qf extends be{constructor(){super()}get eventId(){return 124}ri(){this.di(221)}}Object(ha.a)(Qf,"RangeConditionalFormattingRuleDeletedEvent",be,[]);class vh extends be{constructor(){super()}get eventId(){return 29}ri(){this.di(508)}Um(){this.Fj(B=>3===
B.KD()||1===B.KD()||4===B.KD())}}Object(ha.a)(vh,"RangeContentClearedEvent",be,[]);class bg extends be{constructor(){super()}get eventId(){return 40}ri(){this.di(104)}}Object(ha.a)(bg,"RangeCopiedCutCellsInsertedEvent",be,[]);class Wh extends be{constructor(){super()}get eventId(){return 114}ri(){this.di(209)}Um(){this.Fj(B=>B.getParameters().FilterType===Tg.IRc)}}Object(ha.a)(Wh,"RangeCustomFilteredEvent",be,[]);class Zg extends be{constructor(){super()}get eventId(){return 106}ri(){this.di(121)}}
Object(ha.a)(Zg,"RangeDataValidationChangedEvent",be,[]);class sa extends Sg{constructor(){super(4,64)}}Object(ha.a)(sa,"RangeDoubleUnderlinedEvent",Sg,[]);class Vb extends be{constructor(){super()}get eventId(){return 69}ri(){this.di(190)}}Object(ha.a)(Vb,"RangeDuplicatesRemovedEvent",be,[]);class Sc extends be{constructor(){super()}get eventId(){return 1}ri(){this.di(527);this.di(12)}}Object(ha.a)(Sc,"RangeEditedEvent",be,[]);class ud extends be{constructor(){super()}get eventId(){return 164}ri(){this.di(255)}Um(){this.Fj(B=>
4===B.actionType)}}Object(ha.a)(ud,"RangeExternalLinksBrokeAllLinksEvent",be,[]);class va extends be{constructor(){super()}get eventId(){return 119}ri(){this.di(255)}Um(){this.Fj(B=>3===B.actionType)}}Object(ha.a)(va,"RangeExternalLinksBrokeLinkEvent",be,[]);class mb extends be{constructor(){super()}get eventId(){return 205}ri(){this.di(256)}initializeFeatureGates(){this.J3e("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(ha.a)(mb,"RangeExternalLinksChangeSourceEvent",
be,[]);class Tb extends be{constructor(){super()}get eventId(){return 163}ri(){this.di(553)}Um(){this.Fj(B=>1===B.actionType)}}Object(ha.a)(Tb,"RangeExternalLinksRefreshedAllEvent",be,[]);class yc extends be{constructor(){super()}get eventId(){return 77}ri(){this.di(553)}Um(){this.Fj(B=>0===B.actionType)}}Object(ha.a)(yc,"RangeExternalLinksRefreshedEvent",be,[]);class Nc extends be{constructor(){super()}get eventId(){return 165}ri(){this.di(224)}}Object(ha.a)(Nc,"RangeExternalLinksSetAutoRefreshEvent",
be,[]);class zd extends be{constructor(){super()}get eventId(){return 5}ri(){this.di(11)}Um(){this.Fj(B=>64===B.i1().ValidMembers)}}Object(ha.a)(zd,"RangeFillColoredEvent",be,[]);class fe extends be{constructor(){super()}get eventId(){return 59}ri(){this.di(155)}}Object(ha.a)(fe,"RangeFilledEvent",be,[]);class Ud extends be{constructor(){super()}get eventId(){return 115}ri(){this.di(176)}Um(){this.Fj(B=>B.autoFilterOptions.AutoFilterType===Tg.IRc&&!!B.autoFilterOptions.CriteriaType)}}Object(ha.a)(Ud,
"RangeFilterAppliedEvent",be,[]);class P extends be{constructor(){super()}get eventId(){return 58}ri(){this.di(176)}Um(){this.Fj(B=>B.autoFilterOptions.AutoFilterType===Tg.IRc&&!B.autoFilterOptions.CriteriaType)}}Object(ha.a)(P,"RangeFilterClearedEvent",be,[]);class Da extends be{constructor(){super()}get eventId(){return 41}ri(){this.di(518)}}Object(ha.a)(Da,"RangeFilterReappliedEvent",be,[]);class eb extends be{constructor(){super()}get eventId(){return 86}ri(){this.di(150)}}Object(ha.a)(eb,"RangeFlashFilledEvent",
be,[]);class bc extends Sg{constructor(){super(6,32)}}Object(ha.a)(bc,"RangeFontColoredEvent",Sg,[]);class Pc extends Sg{constructor(){super(7,8)}}Object(ha.a)(Pc,"RangeFontItalicizedEvent",Sg,[]);class gd extends Sg{constructor(){super(8,1)}Um(){this.Fj(B=>16===B.i1().ValidMembers);this.Fj(B=>1===(B.i1().Font.ValidMembers&1))}}Object(ha.a)(gd,"RangeFontNamedEvent",Sg,[]);class nd extends Sg{constructor(){super(9,2)}}Object(ha.a)(nd,"RangeFontSizedEvent",Sg,[]);class Vd extends be{constructor(){super()}get eventId(){return 74}ri(){this.di(215)}}
Object(ha.a)(Vd,"RangeFormattedAsTableEvent",be,[]);class ie extends be{constructor(){super()}get eventId(){return 97}ri(){this.di(188)}}Object(ha.a)(ie,"RangeGroupedOrUngroupedEvent",be,[]);class vd extends be{constructor(){super()}get eventId(){return 60}ri(){this.di(11)}Um(){this.Fj(B=>2===B.i1().ValidMembers)}}Object(ha.a)(vd,"RangeHorizontallyAlignedEvent",be,[]);class Sd extends be{constructor(){super()}get eventId(){return 43}ri(){this.di(526)}}Object(ha.a)(Sd,"RangeHyperlinkAppliedEvent",
be,[]);class te extends be{constructor(){super()}get eventId(){return 63}ri(){this.di(11)}Um(){this.Fj(B=>256===B.i1().ValidMembers)}}Object(ha.a)(te,"RangeIndentChangedEvent",be,[]);class ne extends be{constructor(){super()}get eventId(){return 53}ri(){this.di(156)}Um(){this.Fj(B=>2===B.KD()||5===B.KD()||6===B.KD()||7===B.KD())}}Object(ha.a)(ne,"RangeMergedEvent",be,[]);class Ce extends be{constructor(){super()}get eventId(){return 107}ri(){this.di(216)}}Object(ha.a)(Ce,"RangeNamedCellStyleAppliedEvent",
be,[]);class Qe extends be{constructor(){super()}get eventId(){return 12}ri(){this.di(11)}Um(){this.Fj(B=>32===B.i1().ValidMembers)}}Object(ha.a)(Qe,"RangeNumberFormattedEvent",be,[]);var df=a(1242);class da extends be{constructor(){super()}get eventId(){return 108}ri(){this.di(141)}Um(){this.Fj(B=>Object(ea.a)(df.a,B))}}Object(ha.a)(da,"RangeSortedEvent",be,[]);class hb extends Sg{constructor(){super(10,128)}}Object(ha.a)(hb,"RangeStrikedThroughEvent",Sg,[]);class Ac extends Sg{constructor(){super(11,
16)}}Object(ha.a)(Ac,"RangeUnderlinedEvent",Sg,[]);class Lc extends be{constructor(){super()}get eventId(){return 61}ri(){this.di(11)}Um(){this.Fj(B=>1===B.i1().ValidMembers)}}Object(ha.a)(Lc,"RangeVerticallyAlignedEvent",be,[]);class Qd extends be{constructor(){super()}get eventId(){return 62}ri(){this.di(11)}Um(){this.Fj(B=>8===B.i1().ValidMembers)}}Object(ha.a)(Qd,"RangeWrapTextToggledEvent",be,[]);class de extends be{constructor(){super()}get eventId(){return 103}ri(){this.di(51)}}Object(ha.a)(de,
"RefreshedAllEvent",be,[]);class Me extends be{constructor(){super()}get eventId(){return 47}ri(){this.di(148)}}Object(ha.a)(Me,"ReplaceAllEvent",be,[]);class Te extends be{constructor(){super()}get eventId(){return 226}ri(){this.di(1025)}}Object(ha.a)(Te,"SampleTableCreatedEvent",be,[]);class zf extends be{constructor(){super()}get eventId(){return 91}ri(){this.di(532)}Um(){this.Fj(B=>95!==B.getShapeType()&&96!==B.getShapeType()&&97!==B.getShapeType()&&98!==B.getShapeType()&&100!==B.getShapeType()&&
102!==B.getShapeType()&&103!==B.getShapeType())}}Object(ha.a)(zf,"ShapeInsertedEvent",be,[]);class dg extends be{constructor(){super()}get eventId(){return 92}ri(){this.di(531)}}Object(ha.a)(dg,"ShapeStyleSetEvent",be,[]);var tg=a(1063);class Gg extends be{constructor(B,ra){super();this.Csa=B;this.vCe=ra}get eventId(){return this.Csa}ri(){this.di(581)}Um(){this.Fj(B=>Object(ea.a)(tg.a,B)&&4===B.getShapeTextFormat().ValidMembers);this.Fj(B=>Object(ea.a)(tg.a,B)&&B.getShapeTextFormat().Font.ValidMembers===
this.vCe)}}Object(ha.a)(Gg,"ShapeTextFontFormattedEventBase",be,[]);class ah extends Gg{constructor(){super(193,4)}}Object(ha.a)(ah,"ShapeTextBoldedEvent",Gg,[]);var bh=a(1262);class Bh extends be{constructor(){super()}get eventId(){return 191}ri(){this.di(581)}Um(){this.Fj(B=>Object(ea.a)(bh.a,B))}}Object(ha.a)(Bh,"ShapeTextChangedEvent",be,[]);class Qh extends Gg{constructor(){super(196,32)}}Object(ha.a)(Qh,"ShapeTextFontColorChangedEvent",Gg,[]);class Lh extends Gg{constructor(){super(197,1)}}
Object(ha.a)(Lh,"ShapeTextFontNameChangedEvent",Gg,[]);class Rh extends Gg{constructor(){super(198,2)}}Object(ha.a)(Rh,"ShapeTextFontSizeChangedEvent",Gg,[]);class Gf extends be{constructor(){super()}get eventId(){return 199}ri(){this.di(581)}Um(){this.Fj(B=>Object(ea.a)(tg.a,B)&&2===B.getShapeTextFormat().ValidMembers)}}Object(ha.a)(Gf,"ShapeTextHorizontallyAlignedEvent",be,[]);class Yh extends Gg{constructor(){super(194,8)}}Object(ha.a)(Yh,"ShapeTextItalicizedEvent",Gg,[]);class wg extends Gg{constructor(){super(195,
16)}}Object(ha.a)(wg,"ShapeTextUnderlinedEvent",Gg,[]);class Ai extends be{constructor(){super()}get eventId(){return 200}ri(){this.di(581)}Um(){this.Fj(B=>Object(ea.a)(tg.a,B)&&1===B.getShapeTextFormat().ValidMembers)}}Object(ha.a)(Ai,"ShapeTextVerticallyAlignedEvent",be,[]);class yh extends be{constructor(){super()}get eventId(){return 13}ri(){this.di(138)}}Object(ha.a)(yh,"SheetAddedEvent",be,[]);class bi extends be{constructor(){super()}get eventId(){return 142}ri(){this.di(237)}Um(){this.Fj(B=>
!!B.insertDeleteMultiRangeParameters);this.Fj(B=>!B.insertDeleteMultiRangeParameters.IsTableCommand);this.Fj(B=>{B=B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>B.DeltaColumn&&!B.DeltaRow&&(!!B.InsertDeleteRange.FirstRow||B.InsertDeleteRange.LastRow!==yb.a.kG)||!B.DeltaColumn&&0>B.DeltaRow&&(!!B.InsertDeleteRange.FirstColumn||B.InsertDeleteRange.LastColumn!==yb.a.WE)})}}Object(ha.a)(bi,"SheetCellsDeletedEvent",be,[]);class vi extends be{constructor(){super()}get eventId(){return 143}ri(){this.di(237)}Um(){this.Fj(B=>
!!B.insertDeleteMultiRangeParameters);this.Fj(B=>!B.insertDeleteMultiRangeParameters.IsTableCommand);this.Fj(B=>{B=B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<B.DeltaColumn&&!B.DeltaRow&&(!!B.InsertDeleteRange.FirstRow||B.InsertDeleteRange.LastRow!==yb.a.kG)||!B.DeltaColumn&&0<B.DeltaRow&&(!!B.InsertDeleteRange.FirstColumn||B.InsertDeleteRange.LastColumn!==yb.a.WE)})}}Object(ha.a)(vi,"SheetCellsInsertedEvent",be,[]);class Vi extends be{constructor(){super()}get eventId(){return 139}ri(){this.di(237)}Um(){this.Fj(B=>
!!B.insertDeleteMultiRangeParameters);this.Fj(B=>!B.insertDeleteMultiRangeParameters.IsTableCommand);this.Fj(B=>0>B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Fj(B=>B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===yb.a.kG)}}Object(ha.a)(Vi,"SheetColumnDeletedEvent",
be,[]);class Wi extends be{constructor(){super()}get eventId(){return 138}ri(){this.di(237)}Um(){this.Fj(B=>!!B.insertDeleteMultiRangeParameters);this.Fj(B=>!B.insertDeleteMultiRangeParameters.IsTableCommand);this.Fj(B=>0<B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Fj(B=>B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
yb.a.kG)}}Object(ha.a)(Wi,"SheetColumnInsertedEvent",be,[]);class wi extends be{constructor(){super()}get eventId(){return 14}ri(){this.di(137)}}Object(ha.a)(wi,"SheetDeletedEvent",be,[]);class Xi extends be{constructor(){super()}get eventId(){return 137}ri(){this.di(185)}}Object(ha.a)(Xi,"SheetDirectionChangedEvent",be,[]);class fj extends be{constructor(){super()}get eventId(){return 54}ri(){this.di(139)}}Object(ha.a)(fj,"SheetDuplicatedEvent",be,[]);class Mi extends be{constructor(){super()}get eventId(){return 15}ri(){this.di(207)}}
Object(ha.a)(Mi,"SheetNameEditedEvent",be,[]);class pj extends be{constructor(){super()}get eventId(){return 90}ri(){this.di(151)}}Object(ha.a)(pj,"SheetPaneFrozenEvent",be,[]);class Yi extends be{constructor(){super()}get eventId(){return 120}ri(){this.di(226)}}Object(ha.a)(Yi,"SheetPrintSettingsSavedEvent",be,[]);var qj=a(1142);class ni extends be{constructor(){super()}get eventId(){return 215}ri(){this.di(507)}initializeFeatureGates(){this.J3e("Microsoft.Office.Excel.SheetProtectionMacroRecording")}Um(){this.Fj(B=>
Object.getType(B)===qj.a)}}Object(ha.a)(ni,"SheetProtectionPausedResumedEvent",be,[]);class Zh extends be{constructor(){super()}get eventId(){return 64}ri(){this.di(557)}}Object(ha.a)(Zh,"SheetReorderedEvent",be,[]);class Ni extends be{constructor(){super()}get eventId(){return 141}ri(){this.di(237)}Um(){this.Fj(B=>!!B.insertDeleteMultiRangeParameters);this.Fj(B=>!B.insertDeleteMultiRangeParameters.IsTableCommand);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Fj(B=>0>B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Fj(B=>B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===yb.a.WE)}}Object(ha.a)(Ni,"SheetRowDeletedEvent",be,[]);class Xh extends be{constructor(){super()}get eventId(){return 140}ri(){this.di(237)}Um(){this.Fj(B=>!!B.insertDeleteMultiRangeParameters);this.Fj(B=>!B.insertDeleteMultiRangeParameters.IsTableCommand);
this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Fj(B=>0<B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Fj(B=>B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===yb.a.WE)}}Object(ha.a)(Xh,"SheetRowInsertedEvent",be,[]);class di extends be{constructor(){super()}get eventId(){return 39}ri(){this.di(135)}}
Object(ha.a)(di,"SheetRowsColumnsAutoFitEvent",be,[]);class gj extends be{constructor(){super()}get eventId(){return 36}ri(){this.di(136)}}Object(ha.a)(gj,"SheetRowsColumnsResizedEvent",be,[]);class kh extends be{constructor(){super()}get eventId(){return 68}ri(){this.di(183)}}Object(ha.a)(kh,"SheetShowGridlinesToggledEvent",be,[]);class Bi extends be{constructor(){super()}get eventId(){return 67}ri(){this.di(184)}}Object(ha.a)(Bi,"SheetShowHeadingsToggledEvent",be,[]);class Ci extends be{constructor(){super()}get eventId(){return 89}ri(){this.di(213)}}
Object(ha.a)(Ci,"SheetSpellCheckedEvent",be,[]);class hj extends be{constructor(){super()}get eventId(){return 70}ri(){this.di(515)}}Object(ha.a)(hj,"SheetTabColoredEvent",be,[]);class ij extends be{constructor(){super()}get eventId(){return 71}ri(){this.di(157)}}Object(ha.a)(ij,"SheetVisibilityChangedEvent",be,[]);class wh extends be{constructor(){super()}get eventId(){return 126}ri(){this.di(239)}}Object(ha.a)(wh,"SheetsVisibilityChangedEvent",be,[]);class Ih extends be{constructor(){super()}get eventId(){return 188}ri(){this.di(203)}}
Object(ha.a)(Ih,"SlicerInsertedEvent",be,[]);class jj extends be{constructor(){super()}get eventId(){return 189}ri(){this.di(173)}Um(){this.Fj(B=>!B.clearFilter)}}Object(ha.a)(jj,"SlicerSelectionAppliedEvent",be,[]);class kj extends be{constructor(){super()}get eventId(){return 190}ri(){this.di(173)}Um(){this.Fj(B=>B.clearFilter)}}Object(ha.a)(kj,"SlicerSelectionClearedEvent",be,[]);class Dh extends be{constructor(){super()}get eventId(){return 27}ri(){this.di(208)}Um(){this.Fj(B=>B.getParameters().FilterType===
Tg.rtb)}}Object(ha.a)(Dh,"TableCheckedItemsFilteredEvent",be,[]);class oi extends be{constructor(){super()}get eventId(){return 144}ri(){this.di(237)}Um(){this.Fj(B=>!!B.insertDeleteMultiRangeParameters);this.Fj(B=>B.insertDeleteMultiRangeParameters.IsTableCommand);this.Fj(B=>0>B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ha.a)(oi,"TableColumnDeletedEvent",be,[]);class og extends be{constructor(){super()}get eventId(){return 145}ri(){this.di(237)}Um(){this.Fj(B=>
!!B.insertDeleteMultiRangeParameters);this.Fj(B=>B.insertDeleteMultiRangeParameters.IsTableCommand);this.Fj(B=>0<B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ha.a)(og,"TableColumnInsertedEvent",be,[]);var Jh=a(1241);class rj extends be{constructor(){super()}get eventId(){return 121}ri(){this.di(141)}Um(){this.Fj(B=>Object(ea.a)(Jh.a,B))}}Object(ha.a)(rj,"TableColumnSortedEvent",
be,[]);class ei extends be{constructor(){super()}get eventId(){return 105}ri(){this.di(193)}}Object(ha.a)(ei,"TableConvertedToRangeEvent",be,[]);class Bj extends be{constructor(){super()}get eventId(){return 16}ri(){this.di(206)}}Object(ha.a)(Bj,"TableCreatedEvent",be,[]);class Ch extends be{constructor(){super()}get eventId(){return 30}ri(){this.di(209)}Um(){this.Fj(B=>B.getParameters().FilterType===Tg.rtb)}}Object(ha.a)(Ch,"TableCustomFilteredEvent",be,[]);var Cj=a(1605);class sj extends be{constructor(){super()}get eventId(){return 25}ri(){this.di(187)}Um(){this.Fj(B=>
B.options.OperationType===Cj.d.CustomSort)}}Object(ha.a)(sj,"TableCustomSortedEvent",be,[]);class Md extends be{constructor(){super()}get eventId(){return 28}ri(){this.di(176)}Um(){this.Fj(B=>B.autoFilterOptions.AutoFilterType===Tg.rtb);this.Fj(B=>0===B.autoFilterOptions.CriteriaType)}}Object(ha.a)(Md,"TableFilterClearedEvent",be,[]);class ve extends be{constructor(){super()}get eventId(){return 32}ri(){this.di(176)}Um(){this.Fj(B=>B.autoFilterOptions.AutoFilterType===Tg.rtb);this.Fj(B=>{const ra=
new Ef.a;ra.add(1);ra.add(2);ra.add(8);ra.add(9);ra.add(10);ra.add(11);ra.add(12);ra.add(13);ra.add(14);ra.add(15);ra.add(16);ra.add(17);ra.add(18);ra.add(19);ra.add(20);ra.add(21);ra.add(22);ra.add(23);ra.add(24);ra.add(25);ra.add(26);ra.add(27);ra.add(28);ra.add(29);ra.add(30);ra.add(31);ra.add(32);ra.add(33);ra.add(34);ra.add(35);ra.add(36);ra.add(37);ra.add(38);ra.add(39);return ra.contains(B.autoFilterOptions.CriteriaType)})}}Object(ha.a)(ve,"TableItemFilteredEvent",be,[]);class Oi extends be{constructor(){super()}get eventId(){return 101}ri(){this.di(217)}}
Object(ha.a)(Oi,"TableRenamedEvent",be,[]);class nh extends be{constructor(){super()}get eventId(){return 73}ri(){this.di(211)}}Object(ha.a)(nh,"TableResizedEvent",be,[]);class ii extends be{constructor(){super()}get eventId(){return 44}ri(){this.di(514)}}Object(ha.a)(ii,"TableRowColumnRearrangedEvent",be,[]);class Ei extends be{constructor(){super()}get eventId(){return 146}ri(){this.di(237)}Um(){this.Fj(B=>!!B.insertDeleteMultiRangeParameters);this.Fj(B=>B.insertDeleteMultiRangeParameters.IsTableCommand);
this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Fj(B=>0>B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ha.a)(Ei,"TableRowDeletedEvent",be,[]);class tj extends be{constructor(){super()}get eventId(){return 147}ri(){this.di(237)}Um(){this.Fj(B=>!!B.insertDeleteMultiRangeParameters);this.Fj(B=>B.insertDeleteMultiRangeParameters.IsTableCommand);this.Fj(B=>!B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Fj(B=>0<B.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ha.a)(tj,"TableRowInsertedEvent",be,[]);class Zi extends be{constructor(){super()}get eventId(){return 26}ri(){this.di(177)}Um(){this.Fj(B=>B.autoFilterOptions.AutoFilterType===Tg.rtb)}}Object(ha.a)(Zi,"TableSortedEvent",be,[]);class uj extends be{constructor(){super()}get eventId(){return 87}ri(){this.di(212)}}Object(ha.a)(uj,"TableStyleAppliedEvent",be,[]);class $i extends be{constructor(){super()}get eventId(){return 88}ri(){this.di(196)}}
Object(ha.a)($i,"TableStyleOptionToggledEvent",be,[]);class ji extends be{constructor(){super()}get eventId(){return 31}ri(){this.di(210)}Um(){this.Fj(B=>B.getParameters().FilterType===Tg.rtb)}}Object(ha.a)(ji,"TableTop10FilteredEvent",be,[]);class ci extends be{constructor(){super()}get eventId(){return 207}ri(){this.di(238)}}Object(ha.a)(ci,"TextToColumnsEvent",be,[]);class Tj extends be{constructor(){super()}get eventId(){return 128}ri(){this.di(559)}}Object(ha.a)(Tj,"ValuesSortedEvent",be,[]);
class pi extends be{constructor(){super()}get eventId(){return 55}ri(){this.di(197)}}Object(ha.a)(pi,"WorkbookCalculationModeSetEvent",be,[]);class ki extends be{constructor(){super()}get eventId(){return 34}ri(){this.di(181)}Um(){this.Fj(B=>!!B.parentCommentId)}}Object(ha.a)(ki,"WorkbookCommentRepliedEvent",be,[]);class lh extends be{constructor(){super()}get eventId(){return 33}ri(){this.di(181)}Um(){this.Fj(B=>!B.parentCommentId)}}Object(ha.a)(lh,"WorkbookCommentedEvent",be,[]);class qi extends be{constructor(){super()}get eventId(){return 56}ri(){this.di(128)}}
Object(ha.a)(qi,"WorkbookRecalculatedEvent",be,[]);class Fi extends be{constructor(){super()}get eventId(){return 46}ri(){this.di(171)}}Object(ha.a)(Fi,"WorkbookRedoEvent",be,[]);class Sh extends be{constructor(){super()}get eventId(){return 45}ri(){this.di(170);this.di(1033)}}Object(ha.a)(Sh,"WorkbookUndoEvent",be,[]);class Dj extends be{constructor(){super()}get eventId(){return 116}ri(){this.di(507);this.di(576);this.di(10)}Um(){this.Fj(B=>{if(Object(ea.a)(Cd,B)&&(B=Object(Aa.a)(Cd,B),void 0!==
B.source&&null!==B.source&&void 0!==B.eventId&&null!==B.eventId))return ya.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${B.source}; eventId: ${B.eventId}.`),!0;ya.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(ha.a)(Dj,"DefaultRichApiRequestExecutedEvent",be,[]);class Pi extends be{constructor(){super()}get eventId(){return 216}ri(){this.di(1022)}}Object(ha.a)(Pi,"TablelAltTextEditedEvent",
be,[]);class Uj extends be{constructor(){super()}get eventId(){return 217}ri(){this.di(263)}}Object(ha.a)(Uj,"FloatingObjectZOrderChangedEvent",be,[]);var Ej=a(1261);class aj extends be{constructor(){super()}get eventId(){return 192}ri(){this.di(507)}Um(){this.Fj(B=>Object(ea.a)(Ej.a,B)?!0:!1)}}Object(ha.a)(aj,"VisualPropertySetEvent",be,[]);class Fj extends na{constructor(){super(219,[510])}}Object(ha.a)(Fj,"ChartSeriesDeletedEvent",na,[]);class eg extends be{get eventId(){return 220}ri(){this.di(1027)}}
Object(ha.a)(eg,"ChartDataChangedEvent",be,[]);class gf extends na{constructor(){super(221,[512])}}Object(ha.a)(gf,"ChartSeriesDataChangedEvent",na,[]);class Eh extends be{constructor(){super()}get eventId(){return 225}ri(){this.di(269)}}Object(ha.a)(Eh,"FloatingObjectPutFloatingImageInCellEvent",be,[]);class th extends be{constructor(){super()}get eventId(){return 224}ri(){this.di(268)}}Object(ha.a)(th,"ImageInCellConvertToFloatingObjectEvent",be,[]);class qh{constructor(B){this.Bh=null;this.$=B}get macroRecorderEvents(){this.Bh||
(this.Bh=new Ef.a,this.Bh.add(new Sc),this.Bh.add(new Fg),this.Bh.add(new xh),this.Bh.add(new sa),this.Bh.add(new zd),this.Bh.add(new bc),this.Bh.add(new Pc),this.Bh.add(new gd),this.Bh.add(new nd),this.Bh.add(new hb),this.Bh.add(new Ac),this.Bh.add(new Qe),this.Bh.add(new yh),this.Bh.add(new wi),this.Bh.add(new Mi),this.Bh.add(new Bj),this.Bh.add(new oi),this.Bh.add(new og),this.Bh.add(new Ei),this.Bh.add(new tj),this.Bh.add(new Wi),this.Bh.add(new Vi),this.Bh.add(new Xh),this.Bh.add(new Ni),this.Bh.add(new sj),
this.Bh.add(new Zi),this.Bh.add(new Dh),this.Bh.add(new Md),this.Bh.add(new vh),this.Bh.add(new Ch),this.Bh.add(new ji),this.Bh.add(new ve),this.Bh.add(new lh),this.Bh.add(new ki),this.Bh.add(new Xe),this.Bh.add(new gj),this.Bh.add(new bi),this.Bh.add(new vi),this.Bh.add(new di),this.Bh.add(new bg),this.Bh.add(new Da),this.Bh.add(new Sd),this.Bh.add(new Nf),this.Bh.add(new ii),this.Bh.add(new Fi),this.Bh.add(new Sh),this.Bh.add(new Me),this.Bh.add(new me),this.Bh.add(new je),this.Bh.add(new ne),this.Bh.add(new fj),
this.Bh.add(new pi),this.Bh.add(new qi),this.Bh.add(new Uh),this.Bh.add(new P),this.Bh.add(new fe),this.Bh.add(new vd),this.Bh.add(new Lc),this.Bh.add(new Qd),this.Bh.add(new te),this.Bh.add(new Zh),this.Bh.add(new ma),this.Bh.add(new T),this.Bh.add(new Bi),this.Bh.add(new kh),this.Bh.add(new Vb),this.Bh.add(new ij),this.Bh.add(new hj),this.Bh.add(new nh),this.Bh.add(new Vd),this.Bh.add(new Db),this.Bh.add(new xb),this.Bh.add(new yc),this.Bh.add(new ec),this.Bh.add(new Wc),this.Bh.add(new kc),this.Bh.add(new R),
this.Bh.add(new Za),this.Bh.add(new ua),this.Bh.add(new W),this.Bh.add(new pb),this.Bh.add(new Pb),this.Bh.add(new eb),this.Bh.add(new uj),this.Bh.add(new $i),this.Bh.add(new Ci),this.Bh.add(new pj),this.Bh.add(new zf),this.Bh.add(new dg),this.Bh.add(new Le),this.Bh.add(new Pe),this.Bh.add(new ef),this.Bh.add(new De),this.Bh.add(new ie),this.Bh.add(new jh),this.Bh.add(new Rg),this.Bh.add(new yf),this.Bh.add(new Oi),this.Bh.add(new Mg),this.Bh.add(new de),this.Bh.add(new Hh),this.Bh.add(new ei),this.Bh.add(new Zg),
this.Bh.add(new Ce),this.Bh.add(new da),this.Bh.add(new Vh),this.Bh.add(new se),this.Bh.add(new wf),this.Bh.add(new bd),this.Bh.add(new sh),this.Bh.add(new Wh),this.Bh.add(new Ud),this.Bh.add(new Ab),this.Bh.add(new Of),this.Bh.add(new va),this.Bh.add(new Yi),this.Bh.add(new rj),this.Bh.add(new Qf),this.Bh.add(new wh),this.Bh.add(new yg),this.Bh.add(new Tj),this.Bh.add(new Od),this.Bh.add(new h),this.Bh.add(new yd),this.Bh.add(new ch),this.Bh.add(new fg),this.Bh.add(new ag),this.Bh.add(new kg),this.Bh.add(new Xi),
this.Bh.add(new vg),this.Bh.add(new Pg),this.Bh.add(new Bg),this.Bh.add(new Kf),this.Bh.add(new Qg),this.Bh.add(new Dg),this.Bh.add(new fb),this.Bh.add(new Va),this.Bh.add(new fh),this.Bh.add(new qc),this.Bh.add(new ai),this.Bh.add(new Eg),this.Bh.add(new Tb),this.Bh.add(new ud),this.Bh.add(new Nc),this.Bh.add(new gg),this.Bh.add(new ph),this.Bh.add(new Ph),this.Bh.add(new rh),this.Bh.add(new dh),this.Bh.add(new Lg),this.Bh.add(new Sf),this.Bh.add(new Cg),this.Bh.add(new ke),this.Bh.add(new Df),this.Bh.add(new cf),
this.Bh.add(new lc),this.Bh.add(new md),this.Bh.add(new Yd),this.Bh.add(new qg),this.Bh.add(new eh),this.Bh.add(new gh),this.Bh.add(new mh),this.Bh.add(new zg),this.Bh.add(new uh),this.Bh.add(new Af),this.Bh.add(new bf),this.Bh.add(new Ih),this.Bh.add(new jj),this.Bh.add(new kj),this.Bh.add(new Bh),this.Bh.add(new ah),this.Bh.add(new Yh),this.Bh.add(new wg),this.Bh.add(new Qh),this.Bh.add(new Lh),this.Bh.add(new Rh),this.Bh.add(new Gf),this.Bh.add(new Ai),this.Bh.add(new mb),this.Bh.add(new Kh),this.Bh.add(new ci),
this.Bh.add(new ni),this.Bh.add(new Pi),this.Bh.add(new Uj),this.Bh.add(new aj),this.Bh.add(new Fj),this.Bh.add(new gf),this.Bh.add(new eg),this.Bh.add(new th),this.Bh.add(new Eh),this.Bh.add(new Te),Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.bmk());return this.Bh}WJf(B,ra){let vb=this.XJf(B,this.macroRecorderEvents,ra);vb||(vb=this.XJf(B,qh.z1i(),ra),!vb&&this.x1f(B,qh.vpf,ra)&&(vb=qh.vpf));return vb}XJf(B,ra,vb){const dc=new Ef.a;for(const Hc of ra)this.x1f(B,
Hc,vb)&&dc.add(Hc);return 1===dc.count?dc.ma(0):1<dc.count?qh.wGi(dc):null}x1f(B,ra,vb){const dc=qh.l4j(B,ra);return vb?dc&&qh.jfl(B,ra):dc}bmk(){const B=new Ef.a;for(const ra of this.Bh){let vb=!1;for(const dc of ra.featureGates)if(!Ga.EwaSettings.Na(dc)){B.add(ra);vb=!0;break}if(!vb)for(const dc of ra.cAf)if(!Ga.EwaSettings.getBooleanFeatureGate(dc,!1)){B.add(ra);break}}for(const ra of B)this.Bh.remove(ra)}static z1i(){qh.b0b||(qh.b0b=new Ef.a,qh.b0b.add(new kb),qh.b0b.add(new ig));return qh.b0b}static l4j(B,
ra){return ra.operations.contains(B.operation)}static jfl(B,ra){ra=ra.y5c;if(!ra.count)return!0;let vb=!0;for(const dc of ra)if(!dc(B.payload)){vb=!1;break}return vb}static wGi(B){let ra=B.ma(0);for(const vb of B)vb.y5c.count>ra.y5c.count&&(ra=vb);return ra}}qh.b0b=null;qh.vpf=new Dj;Object(ha.a)(qh,"MacroRecorderEventList",null,[]);var Lj=a(710);class vj{constructor(){this.LBb=null}get jNh(){this.LBb||(this.LBb=new Ef.a,this.LBb.add(12),this.LBb.add(11));return this.LBb}vij(B){return this.jNh.contains(B.operation)}O6k(B){const ra=
[],vb=B.payload;for(const dc of vb.batchedOperations)ra.push(new Lj.a(B.operation,dc));return ra}}Object(ha.a)(vj,"MacroRecorderBatchedEventList",null,[]);var Gi=a(121);class Pj{equals(B,ra){return B===ra}getHashCode(B){return B}oxa(B){return B}}Object(ha.a)(Pj,"UserOperationNameComparer",null,[98,99]);class mf{static F1i(){mf.Zi||(mf.Zi=new Xb.a(new Pj),mf.Zi.add(507),mf.Zi.add(10),mf.Zi.add(576),mf.Zi.add(563),mf.Zi.add(564),mf.Zi.add(565),mf.Zi.add(566),mf.Zi.add(567),mf.Zi.add(568),mf.Zi.add(569),
mf.Zi.add(570),mf.Zi.add(571),mf.Zi.add(572),mf.Zi.add(573),mf.Zi.add(574),mf.Zi.add(575),mf.Zi.add(501),mf.Zi.add(520),mf.Zi.add(1),mf.Zi.add(1002),mf.Zi.add(129),mf.Zi.add(198),mf.Zi.add(500),mf.Zi.add(519),mf.Zi.add(538),mf.Zi.add(1E3),mf.Zi.add(1003),mf.Zi.add(144),mf.Zi.add(502),mf.Zi.add(505),mf.Zi.add(179),mf.Zi.add(205),mf.Zi.add(134),mf.Zi.add(230),mf.Zi.add(103),mf.Zi.add(110),mf.Zi.add(112),mf.Zi.add(113),mf.Zi.add(124),mf.Zi.add(133),mf.Zi.add(154),mf.Zi.add(162),mf.Zi.add(168),mf.Zi.add(172),
mf.Zi.add(201),mf.Zi.add(222),mf.Zi.add(227),mf.Zi.add(513),mf.Zi.add(534),mf.Zi.add(539),mf.Zi.add(545),mf.Zi.add(600),mf.Zi.add(547),mf.Zi.add(555),mf.Zi.add(558),mf.Zi.add(562),mf.Zi.add(585),mf.Zi.add(1001),mf.Zi.add(1005),mf.Zi.add(1008),mf.Zi.add(1010),mf.Zi.add(1011),mf.Zi.add(1012),mf.Zi.add(1018),mf.Zi.add(252),mf.Zi.add(253),mf.Zi.add(258),mf.Zi.add(101),mf.Zi.add(102),mf.Zi.add(108),mf.Zi.add(257),mf.Zi.add(119),mf.Zi.add(120),mf.Zi.add(123),mf.Zi.add(126),mf.Zi.add(127),mf.Zi.add(130),
mf.Zi.add(140),mf.Zi.add(159),mf.Zi.add(160),mf.Zi.add(165),mf.Zi.add(166),mf.Zi.add(167),mf.Zi.add(169),mf.Zi.add(189),mf.Zi.add(223),mf.Zi.add(214),mf.Zi.add(228),mf.Zi.add(233),mf.Zi.add(247),mf.Zi.add(504),mf.Zi.add(511),mf.Zi.add(512),mf.Zi.add(525),mf.Zi.add(533),mf.Zi.add(537),mf.Zi.add(542),mf.Zi.add(544),mf.Zi.add(548),mf.Zi.add(550),mf.Zi.add(551),mf.Zi.add(552),mf.Zi.add(554),mf.Zi.add(577),mf.Zi.add(584),mf.Zi.add(586),mf.Zi.add(587),mf.Zi.add(588),mf.Zi.add(592),mf.Zi.add(1009),mf.Zi.add(612),
mf.Zi.add(1016),mf.Zi.add(1017),mf.Zi.add(1024),mf.Zi.add(260),mf.Zi.add(597),mf.Zi.add(264),mf.Zi.add(596),mf.Zi.add(254),mf.Zi.add(262),mf.Zi.add(1030),mf.Zi.add(1031),mf.Zi.add(606),mf.Zi.add(1045));return mf.Zi}}mf.Zi=null;Object(ha.a)(mf,"MacroRecorderUnrecognizedEventList",null,[]);let Hi=class{constructor(B,ra,vb){ra=void 0===ra?new qh(B):ra;vb=void 0===vb?new vj:vb;this.MQb=null;this.IEj=(dc,Hc)=>{this.qUg()&&this.kId(Hc)};this.ocg=ra;this.ncg=vb;this.$=B;this.$.a7&&this.$.OEh(this.IEj)}init(B){this.$.a7&&
(B?this.MQb=B:ya.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}kId(B){if(this.qUg())try{if(this.ncg.vij(B)){var ra=this.ncg.O6k(B);for(const vb of ra)this.nBf(vb)}else this.nBf(B)}catch(vb){ra=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${Gi.a(B.operation)}, Exception: ${vb.stack}`;ya.ULS.sendTraceTag(537155423,0,10,ra);try{this.gyi(B)}catch(dc){}}}nBf(B){var ra=this.ocg.WJf(B,!0);ra?(this.MQb(ra.eventId,Tc.a.Di(B.payload)),
ya.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${ra.eventId}`)):(ra=this.ocg.WJf(B,!1))?ya.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${ra.eventId}, but failed to match filters`):mf.F1i().contains(B.operation)||(this.MQb(0,Tc.a.Di(B.operation)),B=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${Gi.a(B.operation)}`,ya.ULS.sendTraceTag(537155420,0,50,B))}gyi(B){this.MQb(222,Tc.a.Di(B.operation))}qUg(){return this.$.$ya&&
this.MQb&&this.$.vha?!0:!1}};Hi=Object(Ha.__decorate)([Object(oa.d)(Sa.Ud),Object(Ha.__param)(0,Object(Sa.Ob)())],Hi);Object(ha.a)(Hi,"MacroRecorderEventHandler",null,[412]);Object(oa.b)(Sa.he,{rk:"singleton"})(B=>xo(function*(){yield oa.a.resolve(Sa.ge,B);return Bb.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory")}));var lj=a(2);class Mj{}Object(ha.a)(Mj,"Selection",null,[]);var Yg=a(1280),Gj=a(41);class Zj{}Object(ha.a)(Zj,"SmartLookupApplicationInterface",null,
[]);class mj{}Object(ha.a)(mj,"ApplicationProperties",null,[]);class ri{}Object(ha.a)(ri,"EnterpriseUserInfo",null,[]);class Qi{}Object(ha.a)(Qi,"FeatureGates",null,[]);class Mh{constructor(B,ra,vb){this.o2k=9E5;this.q2k=3E5;this.l5d=null;this.Yag="";this.i5d=0;this.mOb=Date.now;this.Lza=B;this.wrb=ra;(void 0===vb||vb)&&this.YKd()}fYi(){var B=void 0===B?!0:B;const ra=this.mOb();if(ra<this.i5d+this.o2k)return ra>this.i5d+this.q2k&&this.YKd(),this.Yag;B&&this.YKd();return""}YKd(){this.l5d=this.l5d||
new Promise(B=>{this.gYi().then(ra=>{this.Yag=ra;this.i5d=this.mOb();this.l5d=null;B(ra)})})}gYi(){return this.wrb&&this.wrb.length?new Promise(B=>{this.Lza.nF("SmartLookup",this.wrb).then(ra=>{ra.IsSuccess?ra.Token||(B(""),ya.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(ya.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+ra.ErrorCode+": "+ra.ErrorMessage),B(""));B(ra.Token)}).catch(ra=>{ra=of.c(ra);ya.ULS.sendTraceTag(51446546,
1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+ra);B("")})}):(ya.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(ha.a)(Mh,"SmartLookupAuthenticationManager",null,[310]);class Ri{static YLi(){switch(Object(Aa.a)(String,La.AFrameworkApplication.mi.AudienceGroup)||""){case "Dogfood":if(La.AFrameworkApplication.ea){let B=La.AFrameworkApplication.ea.Ya("UserPrincipalName");B=wc.a.As(B);const ra=La.AFrameworkApplication.ea.Rv("SmartLookupINTEnabledForSKITeam")?
La.AFrameworkApplication.ea.Kz("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(ra,B)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static AXi(){switch(La.AFrameworkApplication.ea.ka("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":La.AFrameworkApplication.ea.ka("IntentSvcEnableProdSourceLocationOverride")?"PROD":La.AFrameworkApplication.ea.ka("IntentSvcEnableIntSourceLocationOverride")?"INT":Ri.YLi()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";
case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(ha.a)(Ri,"Utils",null,[]);var nj=a(79),ck=a(664);class Vg{constructor(B){ya.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Hbg=La.AFrameworkApplication.ea.ka("IsTellMeUpSellEnterpriseEnabled");this.YDj=La.AFrameworkApplication.ea.Ya("SmartLookupApprovedOriginPattern");this.wrb=La.AFrameworkApplication.ea.Ya("SmartLookupShredderServiceEndpoint");
this.DEj=nj.a.fV(La.AFrameworkApplication.ea.Ya("AppCatalogUrl")||"");this.vrb=new Qi;this.vrb.EnableAllTabV2=!0;this.vrb.EnableIntentService=!0;this.vrb.EnableInDocumentSearch=La.AFrameworkApplication.ea.ka("SmartLookupEnableInDocumentSearch");this.vrb.EnableLocalSearch=La.AFrameworkApplication.ea.ka("SmartLookupEnableLocalSearch");this.vrb.IntentServiceEndpoint=Ri.AXi();this.yEj=new Mh(B,this.wrb)}get approvedOriginPattern(){return this.YDj}MFi(){return Promise.resolve(this.NFi())}NFi(){const B=
new mj;B.anid="";B.applicationVersion=La.AFrameworkApplication.buildVersion;B.appCorrelationId=Nb.a.create().toString();B.themePlatform=Vg.ogl;B.lcid=La.AFrameworkApplication.lcid;B.launchUtcTime=(new Date).toUTCString();B.featureGates=this.vrb;var ra=ck.a.bS(La.AFrameworkApplication.lcid);ra=ra?ra.name:null;B.market=this.mBc(ra);B.uiLanguage=ra;B.sessionId=La.AFrameworkApplication.userSessionId;B.themeId=0;B.parentalControl=Vg.X5j;const vb=new ri;vb.CountryCode=this.mBc(ra);vb.ServiceEndpoint=this.wrb;
vb.IsGoLocal=!1;vb.IsEnabled=this.Hbg;vb.IsEnterpriseEnabled=this.Hbg;vb.TenantRoot=this.DEj;B.enterpriseUserInfo=vb;B.accessToken=this.yEj.fYi();return B}mBc(B){B=B.split("-");return B[B.length-1]}}Vg.ogl="web";Vg.X5j="yes";Object(ha.a)(Vg,"SmartLookupManager",null,[286]);var Th;let lg=Th=class extends Gj.a{constructor(B){super();this.$=B;this.isFirstLaunch=!1}dj(){return!1}Ri(){return!1}Ei(B,ra){B=Ga.EwaSettings.Na(127);return-983891024===ra.command&&B}executeCommand(B,ra){B=Ka.TaskExtensions.Yq();
-983891024===ra.command&&this.Zwj();return B}Zwj(){var B=new Vg(null);const ra={};var vb=ja.f(this.$).yh(null).originalText;vb=Object(lj.a)(new Mj,{neighborhood:vb,mentionStart:0,mentionLength:vb?vb.length:0});const dc=Object(lj.a)(new Zj,{selection:vb,entryPoint:0});B.MFi().then(ed=>{ed.applicationName=Th.appName;ed.isFirstLaunch=this.isFirstLaunch;ed.themeId=5;ra[Th.kVk]=JSON.stringify(dc);ra[Th.SIh]=JSON.stringify(ed);this.isFirstLaunch=!1});B=new Kc.a("ExcelOnline","Web","en-Us");vb=new V.a("FA000000006",
OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Hc=new Fa.a;Hc.Bk[Yg.a.Zs]=Yb.a.instance.ia(1810);Hc.Bk[Yg.a.taskPaneWidth]=350;Hc.Bk[Yg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Hc.jx=ra;Ba.a.instance.Bza(vb,"Taskpane","SmartLookupSDXTaskpane",B,Hc)}};lg.SIh="AppProperties";lg.appName="Excel";lg.kVk="SmartLookupApplicationInterface";lg=Th=Object(Ha.__decorate)([Object(oa.d)(Sa.mg),Object(Ha.__param)(0,Object(Sa.Ob)()),Object(Ha.__param)(1,Object(bb.a)())],lg);Object(ha.a)(lg,
"SmartLookupCommandHandler",Gj.a,[36]);var Qj=a(1285),M=a(436);class wa{constructor(){this.Ljh=new Ef.a}get Jqc(){return this.Ljh}LSi(B){ya.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",B);const ra=new Ef.a;for(const vb of this.Jqc)for(const dc of vb.x1b)dc.id===B&&ra.add(dc);return ra}x3e(B){this.Jqc.add(B)}Vlk(B){for(const ra of this.Jqc)if(ra.m7e===B.m7e){this.Jqc.remove(ra);break}}static Cgi(B,ra,vb){vb=void 0===vb?null:vb;B=wa.tJi(B);0<B.length&&(wa.iZc(B,!1),vb&&vb(ra,B))}static tJi(B){const ra=
[];if(B&&B.x1b&&0<B.x1b.count)for(const vb of B.x1b)if(vb.controls&&0<vb.controls.count)for(const dc of vb.controls)if(dc.menuItems&&0<dc.menuItems.count)for(const Hc of dc.menuItems)Array.add(ra,Hc.id);return ra}static iZc(B,ra){if(B.length){var vb=[];for(const dc of B)vb.push(appChrome.actions.updateControlEnabledDisabledState(dc,ra));appChrome.api.dispatch(vb)}}}Object(ha.a)(wa,"ContextMenuExtensibilityCache",null,[294,295]);var ab=a(1627),Sb=a(1136),fc=a(1048);class Mc{Yeb(B,ra){ra=void 0===ra?
null:ra;if(B=fc.a.zRb(B)){appChrome.addInApi.dispatchActionsToInstallAddIn(B,ra);for(const vb of B.tabs)if(vb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(B,()=>{});break}}}Cje(B){(B=fc.a.zRb(B))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(B)}UQg(){}static Lgi(B,ra,vb){vb=void 0===vb?null:vb;B=Mc.tWi(B);0<B.length&&(Mc.iZc(B,!1),vb&&vb(ra,B))}static tWi(B){const ra=[];if(B&&(B=B.N7,B.nC&&0<B.nC.count))for(const vb of B.nC)if(vb.groups&&0<vb.groups.length)for(const dc of vb.groups)if(dc.controls&&
0<dc.controls.length)for(const Hc of dc.controls)Array.add(ra,Hc.id);return ra}static iZc(B){if(B.length){var ra=[];for(const vb of B)ra.push(appChrome.actions.updateControlEnabledDisabledState(vb,!0));appChrome.api.dispatch(ra)}}}Object(ha.a)(Mc,"OneLineRibbonExtensibilityManager",null,[323]);var rd=a(1183);class Jd{constructor(){this.MIe=this.G7c=null;this.TVf=(B,ra)=>{let vb=null;vb=()=>{B.getIsUpgrading()?window.setTimeout(vb,1E3):B.getUpgradingFailed()?Mc.iZc(ra,!0):La.AFrameworkApplication.ra.aC()};
window.setTimeout(vb,1E3)}}get Qnd(){return this.G7c||(this.G7c=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set Qnd(B){this.G7c=B}get JMh(){return this.MIe||(this.MIe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(B,ra){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(B,ra)}eRd(B,ra,vb,dc,Hc,ed,Id){ed=void 0===ed?null:ed;Id=void 0===Id?null:Id;var Pd;ya.ULS.sendTraceTag(17138449,
220,50,"Control id: {0}.",B);La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8642303_FixedTelemetryForAddinCommandsActionEnabled")&&(B={["solutionId"]:null===(Pd=globalThis.Telemetry)||void 0===Pd?void 0:Pd.PrivacyRules.GetPrivacyCompliantId(Hc.ownerAddinInfo.solutionId,Hc.ownerAddinInfo.storeType,Hc.ownerAddinInfo.assetId,null,null,Hc.ownerAddinInfo.storeId)},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.HandleAddinCommandsAction",dataFields:Ne.a.xn(B)}));if((ra=ra.Kwa(Hc.ownerAddinInfo.storeType,
Hc.ownerAddinInfo.solutionId))&&ra.hL&&!ra.hL.getIsUpgrading())if(Pd=null,0<ra.hL.getNotificationParams().length&&(Pd=this.ocf(ra.hL.getNotificationParams()[0]))&&2147758681===Pd.errorCode&&(ra.isUpgraded=!0),2!==ra.hL.getStatus()&&(1!==ra.hL.getStatus()||Pd&&2147758681===Pd.errorCode))Pd&&this.kVg(ra,Pd,Id);else try{vb.setOwnerAddinEToken(ra.hL.getEToken()),Hc.action(vb,dc.Qpa),ed&&ed()}catch(Rd){ya.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",La.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?
Rd.stack:Rd.message)),rd.a.Ote(Object(xc.a)("InternalError")+" "+Object(xc.a)("InternalError_Directive"))}}kVg(B,ra,vb){vb=void 0===vb?null:vb;const dc=B.hL;if(1===dc.getNotificationParams().length||ra.cFc){const Hc=ra.eva,ed=ra.dwa;ra.eva=()=>{dc.removeFirstNotification();if(0<dc.getNotificationParams().length){const Id=this.ocf(dc.getNotificationParams()[0]);this.kVg(B,Id)}2147758681===ra.errorCode&&(Mc.Lgi(B.Pw,dc,this.TVf),wa.Cgi(B.UMb,dc,this.TVf));Hc&&Hc()};ra.dwa=()=>{ed&&ed();vb&&vb()};rd.a.Pte(ra)}}ocf(B){const ra=
new Sb.a;ra.a1a=B.infoType;ra.id=B.id;ra.title=B.title;ra.description=B.description;ra.buttonText=B.buttonTxt;ra.eva=B.buttonCallback;ra.cFc=B.highPriority;ra.dwa=B.dismissCallback;ra.errorCode=B.errorCode;ra.SUf=B.iframeNotificationUrl;return ra}}Object(ha.a)(Jd,"AddinCommandsActionHandler",null,[302]);var le=a(186),ye=a(934),$e=a(7),kf=a(978),Bf=a(929);class Zf{constructor(B,ra){this.Wa=B;this.L2h=ra}uDi(B){if(void 0!==B&&null!==B&&B===$e.a.Zjf)B="ContextMenuCell";else return null;const ra=this.Wa.ii();
this.GCi(ra,B);return ra}GCi(B,ra){ra=this.L2h.LSi(ra);for(const vb of ra){ra=vb.controls;for(const dc of ra)this.qCi(B,dc)}}qCi(B,ra){var vb=ra.j5[kf.a.id];const dc=ra.j5[kf.a.xab],Hc=ra.j5[kf.a.Bab];let ed="Image16by16",Id=ra.j5[kf.a.yab];Bf.c(Hc)&&(ed="None");0<ra.menuItems.count?(vb=this.Wa.Dz(vb,vb,dc,798637440),vb.D8b(ed,Hc,null),this.sDi(vb.menu,ra),B.buttons.push(vb)):B.buttons.push(this.Wa.cYa(vb,dc,Id,Hc,ed,null,!1))}sDi(B,ra){const vb=this.Wa.ii();for(const dc of ra.menuItems){ra=dc.Rza[kf.a.id];
const Hc=dc.Rza[kf.a.xab],ed=dc.Rza[kf.a.Bab];let Id="Image16by16";const Pd=dc.Rza[kf.a.yab];Bf.c(ed)&&(Id="None");ra=this.Wa.cYa(ra,Hc,Pd,ed,Id,null,!1);vb.buttons.push(ra)}B.Jh.push(vb)}}Object(ha.a)(Zf,"AddInCommandsContextMenuExtensibilityHandler",null,[284]);var xg=a(1055);class Og{constructor(){this.Do=null;this.visible=!1}}Object(ha.a)(Og,"AddinStatusCommandValues",null,[]);class hh{static jdk(B){const ra=new Og;ra.Do=B.EGa;ra.visible=ra.Do?!0:!1;return ra}static V_c(B,ra,vb,dc,Hc){const ed=
document.getElementById(vb);ed?hh.TRk(B,ra,ed,dc,Hc):ya.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",vb))}static TRk(B,ra,vb,dc,Hc){vb?B.EGa===Object(xc.a)("ErrorLoadingAddInsTitle")?rd.a.rQk(ra,vb,dc,Hc):B.EGa===Object(xc.a)("InstallingCustomFunctionsErrorStatusBarMsg")&&rd.a.$Rk(ra,vb,Object(xc.a)("InstallingCustomFunctionsErrorStatusBarMsg"),Object(xc.a)("InstallingCustomFunctionsErrorCalloutMsg")):ya.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(ha.a)(hh,"AddinCommandsStatusHandler",null,[]);var ih=a(256),Ii=a(90);class Fh extends Gj.a{constructor(B,ra){super();this.agaveCommandManager=this.statusBarManager=null;this.Qo=!1;this.Rgf=()=>{this.qL&&this.qL.xgf()};this.RPf=()=>{this.raiseEvent("LAC")};this.hj=(vb,dc)=>{!vb.ki&&ih.b(dc)&&this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null)};this.qL=ra;this.$=B;this.Qo=ta.a.Qo(this.$);this.Qo||(this.kwe=B.xi+"OfficeAddinLabel-Medium14");this.$.qa.zi(29,vb=>
{this.statusBarManager=vb;vb.vO(this)});this.$.fa.Nq(this.hj);this.qL.eCh(this.RPf);this.$.qa.zi(206,vb=>{this.agaveCommandManager=vb;vb.SDh(this.Rgf)})}ry(B){this.addHandler("LAC",B)}fy(B){this.removeHandler("LAC",B)}Aw(B,ra){if("QueryAddinLabel"!==B)return!1;B=!1;this.Qo?(B=appChrome.selectors.getControlLabel(Ii.a.m9d),B=!(!B&&!this.qL.EGa)&&B!==this.qL.EGa):B=ra[xg.a.LabelText]!==this.qL.EGa;B&&(B=hh.jdk(this.qL),ra[xg.a.LabelText]=B.Do,ra[xg.a.Visible]=B.visible,window.setTimeout(()=>{this.V_c()},
0));return!0}Up(){return!0}V_c(){if(this.$){if(this.Qo){const B=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');B&&(this.kwe=B.getElementsByClassName("ms-Button-label")[0].id)}this.kwe&&hh.V_c(this.qL,this.$.domElement,this.kwe,Yb.a.instance.ia(333),Yb.a.instance.ia(334))}}dispose(){this.$.fa.Lq(this.hj);this.qL.snk(this.RPf);this.agaveCommandManager&&(this.agaveCommandManager.Tok(this.Rgf),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.GN(this),
this.statusBarManager=null);this.qL=this.$=null;super.dispose()}}Object(ha.a)(Fh,"AddinCommandsStatusBarManager",Gj.a,[176,177]);class $g{constructor(){this.Ver=1}}Object(ha.a)($g,"CacheItem",null,[]);class si{constructor(B){this.bFa=B}ro(B){const ra=this.bFa.getItem(B);if(ra){let vb=new $g;try{vb=Sys.Serialization.JavaScriptSerializer.deserialize(ra,!0)}catch(dc){return this.bFa.removeItem(B),null}return vb.Data?vb.Data:vb.data}return null}Bvb(B){this.bFa.removeItem(B)}}Object(ha.a)(si,"AppsDataCacheManager",
null,[322]);class Nh{constructor(){new si(fa.a.instance)}WOg(B,ra){B=mc.a.SHf()+B;fa.a.instance.setItem(B,ra.toString())}yUi(){var B=mc.a.ELf();ya.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",B);B=fa.a.instance.getItem(B);return of.a(B)}UHk(B){const ra=mc.a.ELf();ya.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ra);fa.a.instance.setItem(ra,of.c(B))}XOg(B){const ra=mc.a.FLf();ya.ULS.sendTraceTag(507364892,306,50,"get cache key:{0}",ra);fa.a.instance.setItem(ra,of.c(Array.from(B)))}RKd(){var B=
mc.a.FLf();ya.ULS.sendTraceTag(507364891,306,50,"get cache key:{0}",B);B=fa.a.instance.getItem(B);B=of.a(B);return Array.isArray(B)?new Set(B):new Set}Hoj(){return!!fa.a.instance.localStorage}static get instance(){Nh.Va||(Nh.Va=new Nh);return Nh.Va}}Nh.Va=null;Object(ha.a)(Nh,"AddInCommandsCacheManager",null,[289]);var ti=a(112);class bj{constructor(B){this.Ea=B}get host(){var B;const ra=null===(B=this.Ea)||void 0===B?void 0:B.Ya("Application");return"Word"===ra||"Excel"===ra||"PowerPoint"===ra?ra:
""}get zua(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",!1)}get zGh(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutOpenCloseTelemetryEnabled",!1)}get F6e(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinContextMenuShareButtonEnabled",!1)}get j5j(){return this.Ea?this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryIds",
""):""}get k5j(){return this.Ea?this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryNames",""):""}get i5j(){return this.Ea?this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableCategoryAddinIdsMapping",""):""}get M7b(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get b0(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get yGh(){return!!this.Ea&&
this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutNoSearchResultsV2Enabled",!1)}get UXh(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.CitationEnabled",!1)}get xGh(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREScrollEnabled",!1)}get BGh(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchWithOmexEnabled",!1)}get J6e(){var B,ra;return null!==(ra=null===(B=
this.Ea)||void 0===B?void 0:B.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchDebouncing",100))&&void 0!==ra?ra:100}get K6e(){return!!this.Ea&&this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchRecommendedKeyword","")}get AGh(){return this.Ea?this.Ea.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchRequestSentTimeoutMs",2E4):2E4}get l5j(){return this.Ea?this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableSearchQueryParameters",
""):""}get Wqd(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutBannerInPopularEnabled",!1)}get Vqd(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutBannerGroupInPopularEnabled",!1)}get afa(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)}get I6e(){return!!this.Ea&&this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREBannerAddins",
"")}get wbf(){return!!this.Ea&&"Dev Box"===this.Ea.Ya("StatusBarEnvironmentNameToUse")}get H6e(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutCDNotificationUpdateEnabled",!1)}get Nyb(){return!!this.Ea&&this.Ea.isChangeGateEnabled("StoreDisabledErrorViewFixEnabled")}get ebc(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get XId(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyEnabled",
!1)}get Lzi(){return this.Ea?this.Ea.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutTriggerSurveyTimeMs",25E3):25E3}get Izi(){return!!this.Ea&&this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.FlyoutStoreFooterLabelString","")}get fRb(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",!1)}get Hzi(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpUseLabelsEnabled",!1)}get Fzi(){return!!this.Ea&&
this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpSearchWithAppSourceEnabled",!1)}get Gzi(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpUXRenderCheckerEnabled",!1)}get Ezi(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpRetryIfNotReady",!1)}get Dzi(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreAdvancedUXEnabled",!1)}}Object(ha.a)(bj,"AppsFlyoutGeneratorContext",
null,[]);var oj;(function(B){B.LEFT="LEFT";B.fka="MIDDLE";B.RIGHT="RIGHT"})(oj||(oj={}));Object(ha.b)("FRECarouselDirection",oj);const Hj=()=>({["APIC"]:Object(xc.a)("AddInCategoryTitleAddingPicturesIconsAndCharts"),["APID"]:Object(xc.a)("AddInCategoryTitleAddingPicturesIconsAndDiagrams"),["BBM"]:Object(xc.a)("AddInCategoryTitleBuildByMicrosoft"),["CAIP"]:Object(xc.a)("AddInCategoryTitleDesigningAnInteractivePresentation"),["DA"]:Object(xc.a)("AddInCategoryTitleDataSyncAndAnalysis"),["DWT"]:Object(xc.a)("AddInCategoryTitleDesigningWithTemplates"),
["ER"]:Object(xc.a)("AddInCategoryTitleEducationalPurpose"),["FA"]:Object(xc.a)("AddInCategoryTitleFinancialAnalytics"),["IPWAI"]:Object(xc.a)("AddInCategoryTitleImprovingProductivityWithAI"),["TD"]:Object(xc.a)("AddInCategoryTitleTrendingAddins"),["WN"]:Object(xc.a)("AddInCategoryTitleNewAddins"),["WF"]:Object(xc.a)("AddInCategoryTitleWritingFluently"),["PAIYO"]:Object(xc.a)("AddInCategoryTitlePopularAddinsInYourOrg"),default:Object(xc.a)("PopularAddins")}),Oh=()=>({["Word"]:{["APID"]:Object(xc.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsWord")||
"Add photos, icons, and diagrams to your documents.",["ER"]:Object(xc.a)("AddInCategoryDescriptionEducationalResources")||"Resources for educators and students.",["IPWAI"]:Object(xc.a)("AddInCategoryDescriptionImprovingProductivityWithAIWord")||"Draft and summarize with the power of generative AI.",["WF"]:Object(xc.a)("AddInCategoryDescriptionWritingFluently")||"Get help with spelling, grammar, and more."},["Excel"]:{["APID"]:Object(xc.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsExcel")||
"Add photos, icons, and diagrams to spreadsheets.",["DA"]:Object(xc.a)("AddInCategoryDescriptionDataAnalytics")||"Get key insights about the data in your speadsheets",["IPWAI"]:Object(xc.a)("AddInCategoryDescriptionImprovingProductivityWithAIExcel")||"Use the power of AI to capture and understand your data.",["FA"]:Object(xc.a)("AddInCategoryDescriptionFinancialAnalytics")||"Track expenses, budget, and more."},["PowerPoint"]:{["IPWAI"]:Object(xc.a)("AddInCategoryDescriptionImprovingProductivityWithAIPowerPoint")||
"Use the power of AI in your presentations.",["APID"]:Object(xc.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsPowerPoint")||"Add photos, icons, and diagrams to slides.",["CAIP"]:Object(xc.a)("AddInCategoryDescriptionCreatingAnInteractivePresentation")||"Add polls, timers, and more.",["DWT"]:Object(xc.a)("AddInCategoryDescriptionDesigningWithTemplates")||"Create beautiful slides with templates you can customize."},cLk:{["BBM"]:Object(xc.a)("AddInCategoryDescriptionBuildByMicrosoft")||"Create surveys, visualize data, and more, all from Microsoft.",
["TD"]:Object(xc.a)("AddInCategoryDescriptionTrending")||"Recently added by others.",["WN"]:Object(xc.a)("AddInCategoryDescriptionWhatsNew")||"Brand new or updated add ins.",["PAIYO"]:Object(xc.a)("AddInCategoryDescriptionPopularAddinsInYourOrg")||"Add ins people add and use the most in your organization."}});class xj{constructor(B){this.skd=B}next(B){this.skd=(9301*this.skd+49297)%233280;return Math.floor(this.skd/233280*B)}}Object(ha.a)(xj,"Random",null,[]);class cj{constructor(B){this.vU=B;this.S2d=
new Set;this.eIe=[];this.Rqd=Nh.instance;this.pRc=()=>this.Noc=ti.a("getTheme")?appChrome.api.getTheme():null;this.context=new bj(La.AFrameworkApplication.ea);this.Noc=ti.a("getTheme")?appChrome.api.getTheme():null;ti.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.pRc)}get SVa(){return this.eIe}set SVa(B){this.eIe=B}GFj(B){if(this.context.H6e&&this.SVa.includes(B)){this.S2d.add(B);var ra=this.Rqd.RKd();ra.has(B)&&(ra.delete(B),this.Rqd.XOg(ra))}}fFi(B){const ra=
this.vU.getUpgradedAddinsOfOmex(),vb=this.Rqd.RKd(),dc=B.filter(Hc=>vb.has(Hc)&&!this.S2d.has(Hc));B=B.filter(Hc=>ra.has(Hc)&&!this.S2d.has(Hc));return{oHh:dc,xcl:B}}addNotification(B){if(this.context.H6e){var {oHh:ra,xcl:vb}=this.fFi(B.map(dc=>dc.solutionId));this.SVa=[];b(vb,this.Noc);this.SVa.push(...vb);e(ra,this.Noc);this.SVa.push(...ra);0!==this.SVa.length&&(B={["Upgraded"]:vb.map(dc=>n(this.vU.DH(dc))),["AdminInstalled"]:ra.map(dc=>n(this.vU.DH(dc)))},this.dxb(B,"ShowNotificationAddins"))}}dxb(B,
ra){ge.a.sendTelemetryEvent({name:`Office.Extensibility.Host.${ra}`,dataFields:Ne.a.xn(B)})}}Object(ha.a)(cj,"AppsInFlyoutNotificationManager",null,[]);var dj=a(1133),Ki=a(1466),ak=a(136),C=a(685),Ca=a(146);class qb{constructor(){this.pfb=null}setErrorMessageForAddin(B,ra){this.pfb||(this.pfb={});this.pfb[B]=ra}eMi(B){return this.pfb&&B in this.pfb?this.pfb[B]:null}}Object(ha.a)(qb,"AddinCommandsErrorManager",null,[]);var nc=a(116);class Rc{constructor(){this.FA=this.UAa=0;this.Tqd=null;this.ETc=
this.U2c=0;this.ZDa=this.Qbd=this.$7c=null}get coc(){this.$7c||(this.$7c=new Ef.a);return this.$7c}get WJd(){this.Qbd||(this.Qbd=new Ef.a);return this.Qbd}get QXa(){this.ZDa||(this.ZDa=new Ef.a);return this.ZDa}}Object(ha.a)(Rc,"AddinCommandsListLoaderContext",null,[]);class id{constructor(B,ra){this.entitlement=B;this.metadata=ra}Hac(){var B=this.entitlement;const ra={};ra.solutionId=B.solutionId;ra.version=B.version;ra.storeType=B.storeType;ra.storeId=B.storeId;ra.assetId=B.assetId;ra.assetStoreId=
B.assetStoreId;ra.targetType=B.targetType;ra.requireConsent=B.requireConsent||!1;ra.isAddinCommands=!0;ra.addinCommandsActionType=0;ra.targetType=this.targetType;return ra}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?
this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(ha.a)(id,"AddinEntitlementEx",null,[]);var sd=a(298),Fd=a(383);class S{}Object(ha.a)(S,"AppsForOfficeEntitlementQueryInfo",null,[]);class Ua{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(ha.a)(Ua,"AddinAbstract",null,[]);class Hb extends Sys.EventArgs{constructor(){super();
this.Pw=this.ns=null}}Object(ha.a)(Hb,"InsertionParamEventArgs",Sys.EventArgs,[]);class Ec{constructor(B,ra,vb,dc){this.U_a=Hc=>{let ed=!1,Id=null;try{if(0<Hc.data.responseData.length){const Pd=Object(Aa.a)(Object,of.a(Hc.data.responseData)),Rd=Pd?Pd[this.appName]:null;Rd&&(Id=Object(Aa.a)(Object,of.a(Rd.toString())))}ed=!0}catch(Pd){this.Cxa(null)}ed&&this.UDb&&this.UDb(Id)};this.Cxa=Hc=>{this.QDb&&this.QDb(Hc?Hc.data:null)};this.OAa=Hc=>{this.gGb&&this.gGb(Hc?Hc.data:null)};this.k7b=La.AFrameworkApplication.ea.Ya("RoamingServiceHandlerWebServiceBase");
this.appName=B;this.UDb=ra;this.QDb=vb;this.gGb=void 0===dc?null:dc}TGd(B){this.cui(B,this.U_a,this.Cxa)}cui(B,ra,vb){const dc=new Sys.StringBuilder(this.k7b);dc.append("RoamingServiceHandler.ashx?action=");dc.append("getAddinTeachingCalloutSettings");dc.append("&");dc.append(this.LOd(B));dc.append("&");dc.append(La.AFrameworkApplication.Oo);La.AFrameworkApplication.lj.qv(dc.toString(),1,null,null,!0,2,ra,vb,null)}oyc(B){this.hui(B)}hui(B){var ra=new Sys.StringBuilder(this.k7b);ra.append("RoamingServiceHandler.ashx?action=");
ra.append("saveAddinTeachingCalloutSettings");ra.append("&");ra.append(La.AFrameworkApplication.Oo);ra=ra.toString();B=of.c(B);La.AFrameworkApplication.lj.qv(ra,2,B,null,!0,4,null,this.OAa,null)}LOd(B){const ra=new Sys.StringBuilder("requestedsettings=");for(let vb=0;vb<B.count;vb++)ra.append(B.ma(vb)),vb<B.count-1&&ra.append(";");return ra.toString()}}Object(ha.a)(Ec,"AddinTeachingUIRoamingRequestHandler",null,[]);class cd extends Sys.EventArgs{constructor(B){super();this.solutionId=B.solutionId;
this.assetId=B.assetId;this.storeType=B.storeType;this.storeId=B.storeId;this.assetStoreId=B.assetStoreId;this.targetType=B.targetType;this.width=B.width;this.height=B.height;this.displayName=B.displayName;this.version=B.version}}Object(ha.a)(cd,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);class Bd{constructor(B){this.sfb=this.ns=null;this.gXc=!1;this.ZDa=this.Idc=this.lqa=this.Fl=this.d8c=this.zwb=null;this.uXj=()=>{const ra=new sd.ScriptSharpLegacyMap;this.sfb&&this.sfb.tabs&&
!this.sfb.tabs[0].isOfficeTab&&ra.ga("SDX.FeatureFlags","NonOfficeTab");this.erb(Bd.Pga(this.ns),"ClickOnLaunch",ra);this.CNc();this.sfb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.sfb,()=>{const vb=new Hb;vb.ns=this.ns;this.eh.raiseEvent(mc.a.D7f,vb)}):ya.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};this.wQj=()=>{this.erb(Bd.Pga(this.ns),"ClickOnClose");this.CNc()};this.hSj=()=>{this.erb(Bd.Pga(this.ns),"ClickOnDismiss");
this.CNc()};this.Qig=ra=>{if(ra&&(ra=ra.detail)&&ra.id&&this.Oij(ra.id)){const vb=(ra.action||"").toLowerCase();if(ra.success&&"opened"===vb)this.erb(Bd.Pga(this.ns),"CampaignLaunched"),ya.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.CNc(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.Qig,!0);else{let dc;try{dc=JSON.stringify(ra),ya.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+dc)}catch(Hc){dc=
"id : "+ra.id+" telemetryEventName: "+ra.telemetryEventName,ya.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+dc+" Error: "+(Hc?Hc.toString():""))}}}};this.U_a=ra=>{ra?this.gPk(ra)?(ya.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.zwb="AddinHasShown"in ra&&ra.AddinHasShown?ra.AddinHasShown.toString():null,this.gjf()):(ya.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),this.lqa(this.DGa,null)):(ya.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),
this.zwb=null,this.gjf())};this.Cxa=ra=>{ya.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",ra?ra.httpStatus:-1);this.lqa(this.DGa,null)};this.OAa=ra=>{ya.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",ra?ra.httpStatus:-1)};this.eh=B}get appName(){return La.AFrameworkApplication.ea.Ya("WebAppShortName")}get pJb(){this.d8c||(this.d8c=new Ec(this.appName,this.U_a,this.Cxa,this.OAa));return this.d8c}get DGa(){this.Idc||
(this.Idc=new Ef.a);return this.Idc}set DGa(B){this.Idc=B}get QXa(){this.ZDa||(this.ZDa=new Ef.a);return this.ZDa}set QXa(B){this.ZDa=B}dzh(B,ra){window.addEventListener?(this.ns=B,this.sfb=ra,window.addEventListener("LaunchAddinTaskpane",this.uXj,!0),window.addEventListener("DismissCallout",this.hSj,!0),window.addEventListener("CloseCallout",this.wQj,!0),window.addEventListener("FGWebSurfaceEvent",this.Qig,!0)):ya.ULS.sendTraceTag(508625357,220,15,"AddEventListenerForTeachingCallout failed to get Window")}t$a(B,
ra,vb,dc){this.Fl=B;this.DGa=ra;this.QXa=vb;this.lqa=dc;ya.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",ra?ra.count.toString():"null",vb?vb.count.toString():"null");0<this.DGa.count||0<this.QXa.count?(B=new Ef.a,B.add(this.appName),this.pJb.TGd(B)):this.lqa(new Ef.a,null)}Oij(B){B=wc.a.As(B);return-1!==B.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==B.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||
-1!==B.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==B.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==B.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==B.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}CXc(B){if(this.appName){const ra={},vb={};vb.LastTeachingUIShowTime=(new Date).toUTCString();vb.AddinHasShown=B;ra[this.appName]=of.c(vb);this.pJb.oyc(ra);ya.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else ya.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}CNc(){if(!this.gXc){const B=window.g_roamingAddinList;B&&(this.CXc(B),this.gXc=!0)}}gjf(){const B=this.Bfi();0===B.targetType?(B.solutionId?this.ddk(B):this.erb(null,"NoSolutionId"),this.V7g(B),this.lqa(this.DGa,null)):this.lqa(this.DGa,B);ya.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",B.addinId)}ddk(B){const ra=new S;ra.callbackFunc=vb=>{if(vb.errorCode){this.erb(B.solutionId,"FailToGetAppDetails");var dc=window.g_roamingAddinList;
dc&&this.CXc(dc)}else if(vb.value)for(dc of vb.value)if(vb=dc[1],vb===B.solutionId){const Hc={};Hc.solutionId=vb;Hc.assetId=dc[5];Hc.storeType=dc[12];Hc.storeId=dc[11];Hc.assetStoreId=dc[6];Hc.targetType=dc[3];Hc.width=dc[7];Hc.height=dc[8];Hc.displayName=dc[0];Hc.version=dc[4];ya.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",B.solutionId);dc=new cd(Hc);this.eh.raiseEvent(mc.a.pVg,dc);break}};ra.storeType=OSF.StoreTypeEnum.PrivateCatalog;ra.fromInsertDialog=
!1;ra.refresh=!1;this.Fl.queryEntitlementDetails(ra)}gPk(B){if("LastTeachingUIShowTime"in B){if(B=+new Date-+new Date(B.LastTeachingUIShowTime.toString()),B<La.AFrameworkApplication.ea.tP("AddinShowTeachingUIIntervalInMS",864E5))return ya.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",B),!1}else ya.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}Bfi(){let B=new Fd.a(new Ua,0),ra=new Fd.a(new Ua,0),vb=0,dc=0,Hc=0;var ed=
new Ef.a;for(var Id of this.DGa)ed.add(Id);for(const Pd of this.QXa)ed.add(Pd);for(const Pd of ed)if(!("excatalog"!==Pd.storeType||Bf.c(Pd.installTimeInMS)||!Pd.installTimeInMS||Pd.installTimeInMS<=La.AFrameworkApplication.ea.tP("DateTimeInMSForNewAddin",16409952E5))){ed=Bd.IEf(Pd);if(this.zwb&&(Id=this.zwb.split(","),0<Id.length&&Array.contains(Id,ed))){Hc++;ya.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}ed.startsWith("private_")?(B=Bd.AJf(Pd,B),dc++):(ra=
Bd.AJf(Pd,ra),vb++)}ya.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",dc,vb,Hc);return 0<ra.value?ra.key:0<B.value?B.key:Object.assign(new Ua,{addinId:null,targetType:-1,solutionId:null})}erb(B,ra,vb){vb=void 0===vb?null:vb;B={["AppTeachingUICalloutAction"]:ra,["SDX.Id"]:B,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(vb)for(const dc of vb.keys)B[dc]=vb.ma(dc);ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ne.a.xn(B)})}V7g(B){B&&(window.g_roamingAddinList=this.zwb?this.zwb+","+B.addinId:B.addinId)}static Pga(B){return Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.storeType,B.assetId,null,null,B.storeId)}static AJf(B,ra){return ra.value<B.installTimeInMS?new Fd.a(Object.assign(new Ua,{addinId:Bd.IEf(B),targetType:B.targetType,solutionId:B.solutionId}),B.installTimeInMS):ra}static IEf(B){return Telemetry.PrivacyRules.IsPrivateAddin(B.storeType,B.assetId,null,null,B.storeId)?"private_"+
B.installTimeInMS:B.solutionId}}Object(ha.a)(Bd,"PrivateCatalogTeachingCalloutHandler",null,[]);const ce=()=>{const B=nj.a.Qaa(window.location.href.toLowerCase(),"wdomexsrctype");return!!B&&"4"===B},Fe=()=>nj.a.Qaa(window.location.href.toLowerCase(),"wdtpl"),Ue=()=>{const B=nj.a.Qaa(window.location.href.toLowerCase(),"wdomexsrctype");return!!B&&"1"===B};var pf=a(1068);class Tf extends Sys.EventArgs{constructor(B){super();this.properties=B}}Object(ha.a)(Tf,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);class pg{constructor(B,ra,vb){this.eh=new nc.a;this.context=new Rc;this.$ld=null;this.bXj=(dc,Hc,ed,Id)=>{dc?(dc=new id(ed.targetData,Id),Hc&&this.context.coc.add(dc),10===this.context.UAa&&(this.context.WJd.add(dc),0===dc.targetType&&this.context.QXa.add(dc))):(Hc=ed.targetData,ya.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Hc.solutionId,Hc.storeType,Hc.assetId,null,null,Hc.storeId),Hc.storeType));
this.G9d()};this.contextActivationMgr=B;this.vGh=ra;this.ofb=vb;this.appName=La.AFrameworkApplication.ea.Ya("WebAppShortName")}get bzb(){this.$ld||(this.$ld=new Bd(this.eh));return this.$ld}cCh(B){this.eh.addHandler(mc.a.D6e,B)}QFh(B){this.eh.addHandler(mc.a.pVg,B)}f6k(B){null!==B&&(this.context.UAa=B[mc.a.A$],this.context.FA=B[mc.a.D4],this.context.U2c=this.context.ETc=0,B=mc.a.PVa in B?B[mc.a.PVa]:0,-1!==this.context.UAa&&0!==this.context.FA&&(this.context.Tqd=this.vGh.createAddinDataProvider(pf.a(this.context.UAa),
this.contextActivationMgr),this.context.Tqd?this.context.Tqd.getEntitlementsAsync(this.contextActivationMgr.Qpa,!0,B,ra=>{this.GXj(ra)}):ya.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.UAa)))}GXj(B){if(B&&0<B.length){this.context.U2c=B.length;const vb=Fe();for(let dc=0;dc<B.length;dc++){const Hc=B[dc];if(Ue()&&Hc&&Hc.storeType&&"omex"===Hc.storeType.toLowerCase()&&Hc.assetId&&vb&&Hc.assetId.toLowerCase()===vb.toLowerCase()){var ra={["SDX_AppInstallOrigin"]:"DeeplinkUser",
["SDX_Id"]:pg.Pga(Hc)};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:Ne.a.xn(ra)})}!Hc||1!==Hc.targetType&&-1!==Hc.targetType?this.G9d():(ra={},La.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ra.solutionId=Hc.solutionId,ra.version=Hc.version):(ra.marketplaceId=Hc.solutionId,ra.marketplaceVersion=Hc.version),ra.storeType=Hc.storeType,ra.storeId=Hc.storeId,ra.targetData=Hc,this.contextActivationMgr.isAddinCommandsExAsync(ra,
this.bXj))}}else this.G9d()}G9d(){var B;(B=this.context).ETc=B.ETc+1;this.context.ETc>=this.context.U2c&&(this.ofb.WOg(this.context.UAa,!1),0<this.context.U2c&&10===this.context.UAa&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(B=!1,ce()&&(B=this.$Aj(this.context.WJd)),this.lAj(this.context.WJd),B?this.lqa(this.fjf(this.context.coc)):this.bzb.t$a(this.contextActivationMgr,this.context.coc,this.context.QXa,(ra,vb)=>{const dc=new Ef.a;for(const Hc of ra)ra=Hc.Hac(),
vb&&vb.solutionId===Hc.solutionId&&(ra.showCallout=!0,this.bzb.V7g(vb)),dc.add(ra);this.lqa(dc)})):this.lqa(this.fjf(this.context.coc)))}fjf(B){const ra=new Ef.a;if(B)for(const vb of B)ra.add(vb.Hac());return ra}lqa(B){B&&B.count||sb.a.lRa(mc.a.Sqd,"false",this.context.UAa);B={["ack2"]:B};B[mc.a.A$]=this.context.UAa;B[mc.a.D4]=this.context.FA;this.eh.raiseEvent(mc.a.D6e,new Tf(B),this)}$Aj(B){let ra=!1;if(B&&1>B.count)return ra;const vb=Fe();if(!vb)return ra;for(const dc of B)if(dc.storeId&&dc.storeId.toLowerCase()===
vb.toLowerCase()||dc.assetId&&dc.assetId.toLowerCase()===vb.toLowerCase())B={["SDX_Id"]:pg.DLf(dc),["SDX_TargetType"]:Bf.c(dc.targetType)?"":dc.targetType.toString()},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Ne.a.xn(B)}),ra=!0;return ra}lAj(B){if(!(B&&1>B.count))if(this.ofb.Hoj()){var ra=this.ofb.yUi();ra?(B=this.MGf(B,ra),ya.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(B=this.MGf(B,null),ya.ULS.sendTraceTag(527523847,
306,50,"no data from cache"));this.ofb.UHk(B)}else ya.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}MGf(B,ra){const vb={};let dc=!1;const Hc=new Set;for(const ed of B)if(B=pg.DLf(ed))!ra||B in ra||(Hc.add(ed.solutionId),this.VE(ed,B),ya.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===B.toLowerCase()?dc||(dc=!0,vb[B]=null):vb[B]=null;La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutCDNotificationUpdateEnabled",
!1)&&(ra=this.ofb.RKd(),this.ofb.XOg(new Set([...Hc,...ra])));return vb}VE(B,ra){var vb=B.installTimeInMS?(new Date(B.installTimeInMS)).toISOString():"";vb={["SDX.Id"]:ra,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Bf.c(B.targetType)?"":B.targetType.toString(),["SDX.AdminDeploymentTime"]:vb};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:Ne.a.xn(vb)});1===B.targetType&&ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppPinning",dataFields:Ne.a.xn({["SDX.Id"]:ra,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"})})}static Pga(B){return Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.storeType,B.assetId,null,null,B.storeId)}static DLf(B){return Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.storeType,B.assetId,null,null,B.storeId)}}Object(ha.a)(pg,"AddInCommandsListLoader",null,[]);class Ng{constructor(B){this.trh=B}get Qpa(){return this.trh}insertOsfControl(B){return this.Qpa.insertOsfControl(B)}getManifestInvaildErrorString(){return this.Qpa.getManifestInvaildErrorString()}isAddinCommandsAsync(B,
ra){this.Qpa.isAddinCommandsAsync(B,ra)}isAddinCommandsExAsync(B,ra){this.Qpa.isAddinCommandsExAsync(B,ra)}ownerAddinControlRecreated(B,ra){this.Qpa.ownerAddinControlRecreated(B,ra)}queryEntitlementDetails(B){this.Qpa.queryEntitlementDetails(B)}}Object(ha.a)(Ng,"ContextActivationMgrWrapper",null,[296]);class Ug{createAddinDataProvider(B,ra){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(B,ra.Qpa)}static get instance(){Ug.Va||(Ug.Va=new Ug);return Ug.Va}}Ug.Va=null;Object(ha.a)(Ug,
"OSFAddinDataProviderFactory",null,[288]);class $h{constructor(B,ra,vb,dc,Hc,ed){this.FA=B;this.ns=ra;this.Tca=vb;this.displayName=Hc;this.B6f=ed}}Object(ha.a)($h,"PostLaunchAddinCommandsParameters",null,[]);class Yj{constructor(B){this.qfd=null;this.uPe=B}get t3a(){return this.qfd}Yeb(B,ra){this.uPe.Yeb(B,void 0===ra?null:ra);this.qfd=B}Cje(B){this.uPe.Cje(B)}UQg(B){this.qfd=B}}Object(ha.a)(Yj,"RibbonExtensibilityManagerWithChangeDetection",null,[323]);var Oj=a(1099),Sj=a(107);class Di{static TIf(B){const ra=
new Ef.a;if(Di.Pif)for(var vb of Di.Pif)ra.add(vb);vb=null;switch(B){case "Workbook":vb=Di.dhl;break;case "Document":vb=Di.Dii;break;case "Presentation":vb=Di.Hak}if(vb)for(const dc of vb)ra.add(dc);return ra}}Di.Pif=["PrimaryCommandSurface","ContextMenu"];Di.dhl=null;Di.Dii=null;Di.Hak=null;Object(ha.a)(Di,"ExtensionPointType",null,[]);class fi{constructor(B){this.VUe=null;if(Bf.c(B))throw ya.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");
this.mih=B}get x1b(){return this.VUe||(this.VUe=new Ef.a)}get m7e(){return this.mih}}Object(ha.a)(fi,"ContextMenuExtensibility",null,[301]);class Ji{constructor(B,ra,vb){ra=void 0===ra?null:ra;vb=void 0===vb?0:vb;if(Bf.c(B))throw ya.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.mrh=B;this.Duh=ra;this.bnh=vb}get N7(){return this.mrh}get startedNode(){return this.Duh}get uEi(){return this.bnh}}
Object(ha.a)(Ji,"RibbonExtensibility",null,[350]);class dk{constructor(B){this.cmh=B.entitlement}get entitlement(){return this.cmh}createActionContext(B,ra){B={};B.ownerAddinInfo=this.entitlement;B.action=ra;return B}}Object(ha.a)(dk,"AddInCommandsContextProvider",null,[]);class wj{constructor(B,ra,vb){this.dIe=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=B;this.eventBuilder=ra;this.contextMenuBuilder=vb}get addinInfo(){return this.dIe}A6h(B){return new dk(B)}createActionBuilder(B,
ra){return OfficeExt.DefaultControlActionBinder.createActionBuilder(B,ra.entitlement,ra.manifest)}startApplyAddin(B){this.dIe=B;const ra=this.A6h(B);this.actionBuilder=this.createActionBuilder(ra,B)}endApplyAddin(){}yKd(B,ra,vb){vb=void 0===vb?0:vb;return this.ribbonBuilder.nC&&0<this.ribbonBuilder.nC.count?new Ji(this.IDi(B,ra),this.addinInfo.startedNode,vb):null}RDf(){var B=void 0===B?null:B;if(this.contextMenuBuilder.TNc&&0<this.contextMenuBuilder.TNc.count){B||(B=this.addinInfo.entitlement.solutionId);
B=new fi(B);for(const ra of this.contextMenuBuilder.TNc)B.x1b.add(ra);return B}return null}IDi(B,ra){return this.ribbonBuilder.nC&&0<this.ribbonBuilder.nC.count?new fc.a(this.ribbonBuilder.nC,B,ra):null}}Object(ha.a)(wj,"AddinCommandsBuilder",null,[]);class qk{constructor(B,ra,vb,dc,Hc,ed,Id){this.K9a=new Sj.a;this.FA=B;this.Fl=ra;this.Px=vb;this.ribbonManager=dc;this.contextMenuManager=Hc;this.qL=ed;this.xua=Id;this.f_=La.AFrameworkApplication.ra.GL}YZb(B,ra,vb,dc,Hc,ed,Id){const Pd=(Rd,$d,Ae,Ke)=>
{Hc(Rd,$d,Ae,Ke);const Ze=Oj.a[this.FA]+$d.assetId;let cg;(()=>{let Vf=this.K9a.tj(Ze);({value:cg}=Vf);return Vf})().returnValue&&(cg.stop(),cg=null,this.K9a.remove(Ze))};if(0!==this.FA&&B){ya.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",B.count);4===this.FA&&(ya.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",dc)),this.hYh(B,dc),ed());for(const Rd of B)if(B=Rd,ya.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Px.yY,
Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.ownerAddinStoreType||B.storeType,B.assetId,null,null,B.storeId))),this.b$g(B))if(Id&&B.requireConsent)Id(B,$d=>{try{if(this.f_){const Ke=Oj.a[this.FA]+$d.solutionId,Ze=this.f_.Oi("ComponentAttach",Ke);this.K9a.ga(Ke,Ze)}const Ae=this.qL.Kwa($d.storeType,$d.solutionId);6!==this.FA&&(Ae&&(this.Vrc(Ae),Ae.hL.purge(!1)),this.Fl.insertOsfControl(this.l4b($d,ra,vb,Pd)),Ae&&this.Fl.ownerAddinControlRecreated($d.solutionId,$d.storeType))}catch(Ae){ya.ULS.sendTraceTag(572839882,
220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Px.yY,Telemetry.PrivacyRules.GetPrivacyCompliantId($d.solutionId,$d.ownerAddinStoreType||$d.storeType,$d.assetId,null,null,$d.storeId),$d.version,$d.storeType,$d.storeId,Ae.message)),Pd(!1,$d,null,null)}});else try{if(this.f_){const Ae=Oj.a[this.FA]+B.solutionId,Ke=this.f_.Oi("ComponentAttach",Ae);this.K9a.ga(Ae,Ke)}const $d=this.qL.Kwa(B.storeType,B.solutionId);
3!==La.AFrameworkApplication.ra.$g.qn&&1!==La.AFrameworkApplication.ra.$g.qn&&2!==La.AFrameworkApplication.ra.$g.qn||3!==this.FA||"excatalog"===B.storeType||!$d||$d.isUpgraded?6!==this.FA&&($d&&(this.Vrc($d),$d.hL.purge(!1)),this.Fl.insertOsfControl(this.l4b(B,ra,vb,Pd)),$d&&this.Fl.ownerAddinControlRecreated(B.solutionId,B.storeType)):(this.ribbonManager.UQg($d.Pw),Pd(!0,B,null,$d.displayName))}catch($d){ya.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Px.yY,Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.ownerAddinStoreType||B.storeType,B.assetId,null,null,B.storeId),B.version,B.storeType,B.storeId,$d.message)),Pd(!1,B,null,null)}else Pd(!1,B,null,null)}}Ywj(B,ra,vb,dc,Hc,ed){const Id=(Pd,Rd,$d,Ae)=>{ed(Pd,Rd,$d,Ae);const Ke=Oj.a[this.FA]+Rd.solutionId;let Ze;(()=>{let cg=this.K9a.tj(Ke);({value:Ze}=cg);return cg})().returnValue&&(Ze.stop(),Ze=null,this.K9a.remove(Ke))};if(6===this.FA&&B)if(ya.ULS.sendTraceTag(592290762,220,50,
String.format("{0}: Install dynamic ribbon {1}",this.Px.yY,Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.ownerAddinStoreType||B.storeType,B.assetId,null,null,B.storeId))),this.b$g(B))try{if(this.f_){const Rd=Oj.a[this.FA]+B.solutionId,$d=this.f_.Oi("ComponentAttach",Rd);this.K9a.ga(Rd,$d)}const Pd=this.qL.Kwa(B.storeType,B.solutionId);Pd||Id(!1,B,null,null);La.AFrameworkApplication.ra&&La.AFrameworkApplication.ra.$g.delayInstallAddInIsEnabled?this.xEf(B,ra,dc,Hc,vb,Rd=>{Id(Rd,B,vb,Pd.displayName)}):
(this.xEf(B,ra,dc,Hc,vb),Id(!0,B,vb,Pd.displayName))}catch(Pd){ya.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Px.yY,Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.ownerAddinStoreType||B.storeType,B.assetId,null,null,B.storeId),B.version,B.storeType,B.storeId,Pd.message)),Id(!1,B,null,null)}else Id(!1,B,null,null)}sOj(B,ra,vb,dc,Hc,ed){if(ed)if(ed._isAddinCommandsManifest(this.Px.yY))try{La.AFrameworkApplication.ra&&
La.AFrameworkApplication.ra.$g.delayInstallAddInIsEnabled?this.wEf(B,ra,vb,Hc,ed,Id=>{dc(Id,B,ed,ed.getDefaultDisplayName())}):(this.wEf(B,ra,vb,Hc,ed),dc(!0,B,ed,ed.getDefaultDisplayName()))}catch(Id){ya.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Px.yY,Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.ownerAddinStoreType||B.storeType,B.assetId,null,
null,B.storeId),B.version,B.storeType,B.storeId,Id.message)),dc(!1,B,ed,ed.getDefaultDisplayName())}else ya.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.Px.yY,Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.ownerAddinStoreType||B.storeType,B.assetId,null,null,B.storeId),B.version,B.storeType,B.storeId)),dc(!1,B,null,null);else ya.ULS.sendTraceTag(17586259,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Px.yY,Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.ownerAddinStoreType||B.storeType,B.assetId,null,null,B.storeId),B.version,B.storeType,B.storeId)),dc(!1,B,null,null)}l4b(B,ra,vb,dc){const Hc={},ed=document.createElement("div");ed.setAttribute("visible","false");Hc.div=ed;Hc.id=B.solutionId;Hc.solutionId=B.solutionId;Hc.version=B.version;Hc.storeType=B.storeType;
Hc.storeId=B.storeId;Hc.assetId=B.assetId;Hc.assetStoreId=B.assetStoreId;Hc.isvirtualOsfControl=!0;Hc.virtualOsfControlActivationCallback=(Id,Pd)=>{const Rd=this.qL.Kwa(B.storeType,B.solutionId);Rd&&(Rd.isUpgraded&&(B.isUpgraded=!0),this.Vrc(Rd));this.sOj(B,ra,vb,dc,Id,Pd)};Hc.reason=3===this.FA?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Hc}wEf(B,ra,vb,dc,Hc,ed){ed=void 0===ed?null:ed;const Id={};Id.solutionId=
dc.getSolutionId();Id.version=dc.getVersion();Id.storeType=dc.getStoreType();Id.storeId=dc.getStoreId();Id.assetId=dc.getAssetId();Id.assetStoreId=dc.getAssetStoreId();Id.targetType=dc.getOsfControlType();let Pd=null,Rd=null;if(La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Pd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Px.yY,this.Px.formFactor)).parseExtensions(Id,Hc,this.xua),Rd=Di.TIf(this.Px.yY);
else try{Pd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Px.yY,this.Px.formFactor)).parseExtensions(Id,Hc,this.xua),Rd=Di.TIf(this.Px.yY)}catch(Ae){throw ya.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ae.message),Ae;}if(Rd&&0<Rd.count){if(La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var $d=ra(B);ra=vb(B);vb=!!La.AFrameworkApplication.ea&&La.AFrameworkApplication.ea.ka("AddinCommandsMultipleCustomTabsEnabled");
$d=new wj($d,null,ra);for(const Ae of Rd)$d.commandSurface=Ae,Pd.apply($d,this.xua,vb)}else try{const Ae=ra(B),Ke=vb(B),Ze=!!La.AFrameworkApplication.ea&&La.AFrameworkApplication.ea.ka("AddinCommandsMultipleCustomTabsEnabled");$d=new wj(Ae,null,Ke);for(const cg of Rd)$d.commandSurface=cg,Pd.apply($d,this.xua,Ze)}catch(Ae){throw ya.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Ae.message),Ae;}if(OSF.OUtil.checkFlight(14))try{const Ae=$d.yKd(B.solutionId,
Hc.getDefaultDisplayName()),Ke=$d.RDf();Ae&&this.ribbonManager.Yeb(Ae,ed);Ke&&this.contextMenuManager.x3e(Ke);this.qL.d4e(dc,Ae,Ke,Hc.getDefaultDisplayName());ya.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Hc.getDefaultDisplayName())}catch(Ae){throw OfficeExt.DevConsole.log(Ae),ya.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ae.message),Ae;}else try{const Ae=$d.yKd(B.solutionId,Hc.getDefaultDisplayName()),Ke=$d.RDf();Ae&&this.ribbonManager.Yeb(Ae);
Ke&&this.contextMenuManager.x3e(Ke);this.qL.d4e(dc,Ae,Ke,Hc.getDefaultDisplayName());ya.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Hc.getDefaultDisplayName())}catch(Ae){throw ya.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ae.message),Ae;}}}xEf(B,ra,vb,dc,Hc,ed){ed=void 0===ed?null:ed;const Id={};Id.solutionId=B.solutionId;Id.version=B.version;Id.storeType=B.storeType;Id.storeId=B.storeId;Id.assetId=B.assetId;Id.assetStoreId=B.assetStoreId;Id.targetType=
B.targetType;const Pd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Px.yY,this.Px.formFactor);try{const Rd=ra.getManifest(),$d=Pd.parse(Id,Rd,Hc,this.xua,ra.getSharedRuntimeId(),ra),Ae=vb(B),Ke=dc(B),Ze=new wj(Ae,null,Ke);Ze.commandSurface="PrimaryCommandSurface";$d.apply(Ze,this.xua,!0);if(Ze.ribbonBuilder.nC&&0<Ze.ribbonBuilder.nC.count){const cg=Ze.yKd(B.solutionId,ra.getManifest().getDefaultDisplayName(),1);La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.Yeb(cg,ed):cg&&this.ribbonManager.Yeb(cg,ed);this.qL.Xzh(ra,cg,Hc,ra.getManifest().getDefaultDisplayName());ya.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ra.getManifest().getDefaultDisplayName())}}catch(Rd){ya.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ra.getManifest().getDefaultDisplayName(),Rd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Rd)}}Vrc(B){B.Pw&&this.ribbonManager.Cje(B.Pw);
B.UMb&&this.contextMenuManager.Vlk(B.UMb);this.qL.Dlk(B.hL.getStoreType(),B.hL.getSolutionId())}hYh(B,ra){ra=pf.a(ra);for(const vb of this.qL.Snb){if(vb.hL.getStoreType()!==ra)continue;let dc=!0;for(const Hc of B){const ed=Hc;if(ed&&vb.B3f(ed.storeType,ed.solutionId)){dc=!1;break}}dc&&(this.Vrc(vb),vb.hL.purge(!1))}}b$g(B){return!!B&&!!B.solutionId&&!!B.version&&!!B.storeType&&!!B.storeId}}Object(ha.a)(qk,"AddInCommandsIntegration",null,[]);class Hk{constructor(B,ra,vb,dc,Hc,ed,Id,Pd){Pd=void 0===
Pd?null:Pd;this.ih=new nc.a;this.b8c=B;this.Kkh=ra;this.Er=vb;this.B0e=dc;this.Adb=Hc;this.$hh=ed;this.Jdc=Id;this.drh=Pd}dCh(B){this.ih.addHandler(mc.a.E6e,B)}jEh(B){this.ih.addHandler(mc.a.D7f,B)}PFh(B){this.ih.addHandler(mc.a.qVg,B)}jCh(B){this.ih.addHandler(mc.a.otd,B)}vxj(B,ra,vb){const dc=vb[mc.a.mJb],Hc=void 0===vb[mc.a.D4]?0:vb[mc.a.D4];if(dc&&0!==Hc)if(0>=dc.count&&4!==Hc)this.mxg(new $h(Hc,null,null,ra,null,!0));else{var ed=dc.count,Id=new Yj(new Mc),Pd=void 0===vb[mc.a.A$]?-1:vb[mc.a.A$],
Rd=new qk(Hc,this.Er,this.b8c,Id,this.Kkh,this.Adb,this.Jdc),$d=Vf=>this.B0e.JQh(Vf.solutionId,this.Jdc,this.b8c,B),Ae=Vf=>this.B0e.TPh(Vf.solutionId),Ke=(Vf,Xf,Pf)=>{ed--;Pf=new $h(Hc,Xf,Id,ra,Pf,0>=ed);if(Vf&&Xf)this.mxg(Pf);else{if(3===Hc||Xf&&Xf.isUpgraded)Vf="",Xf&&(Vf=Telemetry.PrivacyRules.GetPrivacyCompliantId(Xf.solutionId,Xf.ownerAddinStoreType||Xf.storeType,Xf.assetId,null,null,Xf.storeId)),ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:Ne.a.xn({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:Vf})});this.lxg(Pf)}ed||La.AFrameworkApplication.ra.aC()},Ze=(Vf,Xf,Pf,Kg)=>{Ke(Vf,Xf,Kg)},cg=()=>{this.U8d();0>=dc.count&&4===Hc&&this.Adb.fqe()};6===Hc?(Pd=vb[mc.a.YYa],vb=vb[mc.a.ZYa],Rd.Ywj(dc.ma(0),Pd,vb,$d,Ae,(Vf,Xf,Pf,Kg)=>{Ke(Vf,Xf,Kg)})):Rd.YZb(dc,$d,Ae,Pd,Ze,cg,this.drh)}else ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:Ne.a.xn({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",
["SDX_Id"]:""})}),ya.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.b8c.yY)),this.lxg(new $h(Hc,null,null,ra,null,!0))}lxg(B){this.U8d(B);this.vWg(!1,B)}mxg(B){const ra=B.ns;let vb=null;null!==ra&&(vb=ra.storeType,vb=vb.toLowerCase());if(B&&"omex"===vb&&(3===B.FA||ra.isUpgraded)){var dc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ra.solutionId,ra.ownerAddinStoreType||
ra.storeType,ra.assetId,null,null,ra.storeId)};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:Ne.a.xn(dc)})}this.U8d(B);dc=Ue()&&"omex"===vb&&!!B.Tca&&!!ra.solutionId&&2===B.FA&&ra.solutionId.toLowerCase()===Fe().toLowerCase();var Hc="excatalog"===vb&&3===B.FA;if("omex"===vb&&B.Tca&&(3===B.FA&&"hardcodedpreinstall"!==vb||ra.isUpgraded)||dc||Hc)dc=new Hb,dc.ns=ra,dc.Pw=B.Tca.t3a,this.ih.raiseEvent(mc.a.otd,dc);dc=ce();Hc=Fe();dc&&ra&&"excatalog"===ra.storeType&&B.Tca&&
5===B.FA&&Hc&&(ra.storeId&&ra.storeId.toLowerCase()===Hc.toLowerCase()||ra.assetId&&ra.assetId.toLowerCase()===Hc.toLowerCase())&&(dc=new Hb,dc.ns=ra,dc.Pw=B.Tca.t3a,this.ih.raiseEvent(mc.a.otd,dc),ya.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));ra&&(Nh.instance.WOg(pf.b(vb),!0),"uploadfiledevcatalog"===vb&&(dc=this.$hh.createAddinDataProvider(vb,this.Er))&&dc.localCacheAddinCommands(this.Er.Qpa,ra.solutionId,ra.version,ra.storeId),sb.a.lRa(mc.a.Sqd,"true",pf.b(vb)));
this.vWg(!0,B)}vWg(B,ra){B?ra.Tca&&5===ra.FA&&ra.Tca.t3a&&void 0!==ra.ns.showCallout&&null!==ra.ns.showCallout&&ra.ns.showCallout?((new Bd(this.ih)).dzh(ra.ns,fc.a.zRb(ra.Tca.t3a)),B=new Hb,B.Pw=ra.Tca.t3a,B.ns=ra.ns,this.ih.raiseEvent(mc.a.qVg,B)):3!==ra.FA?ra.B6f&&this.Adb.fqe():ra.Tca&&ra.Tca.t3a&&"hardcodedpreinstall"!==ra.ns.storeType&&rd.a.tQk(ra.displayName,ra.Tca.t3a,ra.ns.isAutoLaunched):3===ra.FA?ra.ns&&"uploadfiledevcatalog"===ra.ns.storeType.toLowerCase()?(ra=this.Jdc.eMi(ra.ns.solutionId),
rd.a.Ote(ra?ra:Object(xc.a)("InternalError")+" "+Object(xc.a)("InternalError_Directive"))):this.Adb.eQg():ra.B6f&&this.Adb.fqe()}U8d(B){var ra=(B=void 0===B?null:B)?B.ns:null;const vb=new Hb;if(vb.ns=ra){var dc=this.Adb.Kwa(ra.storeType,ra.solutionId,6===B.FA?1:0);if(dc&&dc.Pw){vb.Pw=dc.Pw;var Hc=Fe();Hc=Ue()&&!!ra.solutionId&&!!Hc&&ra.solutionId.toLowerCase()===Hc.toLowerCase()&&2===B.FA;if(3===B.FA&&"hardcodedpreinstall"!==ra.storeType||Hc)B="",dc.Pw.N7&&dc.Pw.N7.nC&&(dc=dc.Pw.N7.nC.ma(0))&&(B=
dc.id),ra={["SDX_CommandPlacement"]:B,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ra.solutionId,ra.ownerAddinStoreType||ra.storeType,ra.assetId,null,null,ra.storeId)},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppPinning",dataFields:Ne.a.xn(ra)})}}this.ih.raiseEvent(mc.a.E6e,vb)}}Object(ha.a)(Hk,"LaunchAddinCommandsHandler",null,[293]);class zh{}zh.xab="Alt";zh.yab="Command";zh.id="Id";zh.Bab="Image16by16";
zh.qdc="LabelText";zh.Eab="Title";zh.GROUP="Group";zh.EFe="Groups";zh.dBb="Controls";zh.button="Button";zh.una="FlyoutAnchor";zh.LARGE="Large";zh.SMALL="Small";Object(ha.a)(zh,"AddinDataNodeConstants",null,[]);var $k=a(290);a(675);var Ik=a(496);class al{constructor(B,ra){this.XTa=this.MKe=null;if(Bf.c(B)||Bf.c(ra))throw ya.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Rkh=
ra;this._id=B;this.j5[zh.id]=this._id}get id(){return this._id||""}get j5(){return this.MKe||(this.MKe={})}get controlType(){return this.Rkh||""}get menuItems(){return this.XTa||(this.XTa=new Ef.a)}}Object(ha.a)(al,"ControlDefinition",null,[292]);class yl{constructor(B){this.DTe=null;if(Bf.c(B))throw ya.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=B;this.Rza[zh.id]=this._id}get Rza(){return this.DTe||
(this.DTe={})}get id(){return this._id||""}}Object(ha.a)(yl,"MenuItemDefinition",null,[341]);class bl{constructor(B){this.aEa=null;if(Bf.c(B))throw ya.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=B}get id(){return this._id}get controls(){return this.aEa||(this.aEa=new Ef.a)}}Object(ha.a)(bl,"OfficeMenuDefinition",null,[290]);var Ag=a(26);class Jk{constructor(B,ra,vb){this.bU=
this.tbb=null;this.hhd=B;this.jbb=ra;this.Hab=vb;this.Dqh=new Ef.a}get wOc(){return this.hhd}get vMb(){return this.jbb}get Pnd(){return this.Hab}addButton(B){ya.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",B.actionType);this.bU=new al(this.fHa(B.id),zh.button);this.bU.j5[zh.qdc]=B.label;this.bU.j5[zh.xab]=B.label;this.bU.j5[zh.Bab]=B.icon["16"];this.xKb(this.bU.j5[zh.id],B.action);this.BVa(this.bU.j5);this.tbb.controls.add(this.bU);this.bU=null}startBuildMenu(B){if(Bf.c(this.tbb))this.tbb=
new bl(B.id);else{const ra=this.fHa(B.id);this.bU=new al(ra,zh.una);this.Mgb(this.bU.j5,B);this.bU.j5[zh.Bab]=B.icon["16"];this.bU.j5[zh.yab]=Ag.a.alwaysEnabled}}addMenuItem(B){ya.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",B.actionType);const ra=new yl(this.fHa(B.id));this.Mgb(ra.Rza,B);B.icon&&(ra.Rza[zh.Bab]=B.icon["16"]);this.xKb(ra.Rza[zh.id],B.action);this.BVa(ra.Rza);this.bU.menuItems.add(ra)}endBuildMenu(){Bf.c(this.bU)?(this.TNc.add(this.tbb),this.tbb=null):
(this.tbb.controls.add(this.bU),this.bU=null)}get TNc(){return this.Dqh}xKb(B,ra){this.Pnd.bindAction(B,ra)}BVa(B){this.vMb.BVa(B)}fHa(B){return this.wOc.u_a(B)}Mgb(B,ra){B[zh.qdc]=ra.label;B[zh.xab]=ra.label}}Object(ha.a)(Jk,"ContextMenuExtensibilityCreator",null,[321,317]);class Kk{constructor(B){this.DFb=B}get S0b(){return this.DFb}u_a(B){return this.S0b+B}}Object(ha.a)(Kk,"DefaultContextMenuNamingProvider",null,[320]);var rk=a(1483);class zl{bindAction(B,ra){OfficeExt.DefaultControlActionBinder.bindAction(B,
ra)}}Object(ha.a)(zl,"DefaultUIControlActionBinder",null,[319]);class cl{constructor(B){this.DSa=B}get command(){return this.DSa}BVa(B){B[zh.yab]=this.command}}Object(ha.a)(cl,"DefaultUIControlCommandBinder",null,[318]);var Al=a(35);class sk{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(ha.a)(sk,"AddInControl",null,[]);class dl{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(ha.a)(dl,"AddInGroup",null,[]);class Bl{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(ha.a)(Bl,"AddInMenuItem",null,[]);class Lk{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(ha.a)(Lk,"AddInTab",null,[]);class el{constructor(B,ra,vb,dc,Hc,ed){this.Gdc=new Ef.a;this.JCb=this.psa=this.ubb=null;this.hhd=
B;this.Hab=ra;this.jbb=vb;this.TG=dc;this.Jdc=Hc;this.QMe=ed}get wOc(){return this.hhd}get nC(){return this.Gdc}get Pnd(){return this.Hab}get vMb(){return this.jbb}startBuildTab(B){const ra=B.isOfficeTab?B.id:this.wOc.ENf(B.id),vb=B.isOfficeTab?null:B.label;this.ubb=Object.assign(new Lk,{id:ra,title:vb,isOfficeTab:B.isOfficeTab,visible:B.visible,groups:[],tabType:B.tabType,insertBefore:B.insertBefore,insertAfter:B.insertAfter,autoFocus:B.autoFocus})}startBuildGroup(B){const ra=this.fHa(B.id);this.psa=
Object.assign(new dl,{id:ra,mlrId:B.mlrId,title:B.label,controls:[],groupType:0})}addNativeGroup(B){this.psa=Object.assign(new dl,{id:B.id,mlrId:B.mlrId,title:B.label,controls:[],groupType:1});this.ubb.groups.push(this.psa)}addButton(B){const ra=this.fHa(B.id);ra&&(this.xKb(ra,B.action),ya.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",B.actionType),B=Object.assign(new sk,{id:ra,title:B.label,iconLocation:this.jNd(B),enabled:B.enabled,controlType:0,attributes:this.Mgb()}),
this.QMe.i3e(new Al.a(ra,this.vMb.command.toString())),this.psa.controls.push(B))}addNativeControl(B){B.id&&(ya.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",B.actionType),B=Object.assign(new sk,{id:B.id,title:"",iconLocation:"",enabled:B.enabled,controlType:2,attributes:this.Mgb()}),this.psa.controls.push(B))}startBuildMenu(B){const ra=this.fHa(B.id);ra&&(this.JCb=Object.assign(new sk,{id:ra,title:B.label,iconLocation:this.jNd(B),controlType:1,attributes:{},
menuItems:[]}))}addMenuItem(B){const ra=this.fHa(B.id);ra&&(this.xKb(ra,B.action),ya.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",B.actionType),B=Object.assign(new Bl,{id:ra,title:B.label,iconLocation:this.jNd(B),enabled:B.enabled,attributes:this.Mgb()}),this.QMe.i3e(new Al.a(ra,this.vMb.command.toString())),this.JCb.menuItems.push(B))}endBuildMenu(){Bf.c(this.JCb.id)||this.psa.controls.push(this.JCb);this.JCb=null}endBuildGroup(){Bf.c(this.psa.id)||this.ubb.groups.push(this.psa);
this.psa=null}endBuildTab(){Bf.c(this.ubb.id)||this.Gdc.add(this.ubb);this.ubb=null}Mgb(){const B={};this.BVa(B);return B}jNd(B){return B.icon["80"]?B.icon["80"]:B.icon["32"]}BVa(B){this.vMb.BVa(B)}fHa(B){return this.wOc.u_a(B)}xKb(B,ra){this.Pnd.bindAction(B,ra)}}Object(ha.a)(el,"OneLineRibbonExtensibilityCreator",null,[316,317]);class fl{constructor(B,ra){this.DFb=B;this.Hab=new zl;this.jbb=new cl(ra)}TPh(B){B=new Kk(B);return new Jk(B,this.jbb,this.Hab)}JQh(B,ra,vb,dc){vb=new rk.a(this.DFb,B,vb,
!0);return new el(vb,this.Hab,this.jbb,B,ra,dc)}}Object(ha.a)(fl,"UIExtensibilityFactory",null,[287]);var Cl=a(1134);class Si{get Lbh(){return La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}constructor(B){this.NVa=this.RVa=this.ns=this.Pw=null;this.fFg=0;this.sXj=()=>{if(this.ns&&this.NVa){const ra=new Ie.a(Ag.a.Uea,0,0,2,null);this.addinUICommandHandler.executeCommand(0,
ra,{["SourceControlId"]:this.NVa},null);ya.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.uQk=(ra,vb)=>{ra=null;if(vb)if(ra=vb,this.ns=ra.ns,(this.Pw=ra.Pw)&&this.Pw.N7&&this.Pw.N7.nC&&(this.RVa=this.Pw.N7.nC.ma(0)),this.RVa&&this.RVa.id)if(La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)&&this.ZQg(),this.RVa.isOfficeTab)if(La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",
!1)||this.ZQg(),this.NVa)if($c.a.contains(this.RVa.id,$e.a.eT,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(fc.a.zRb(this.Pw),()=>{this.iXg(this.NOd(this.NVa))});else{if(vb=this.$.Ia)vb.Jqd(this.psg),ya.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else ya.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),vb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Si.GetPrivacyCompliantId(this.ns),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(vb)}),this.Uha();else this.kXg(this.NOd(this.RVa.id),0);else ya.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),vb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Si.GetPrivacyCompliantId(this.ns),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ne.a.xn(vb)}),this.Uha();else this.Uha()};this.psg=()=>{if($c.a.contains(this.RVa.id,appChrome.selectors.getSelectedTabId(),!0)){var ra=this.$.Ia;ra&&ra.dHg(this.psg);this.iXg(this.NOd(this.NVa))}};this.vXj=()=>{var ra={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Si.zab(this.DM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(ra)});this.Uha();
const vb={};vb[Ic.a.hl]=this.DM;ra={};ra.solutionId=this.DM.solutionId;ra.assetId=this.DM.assetId;ra.assetStoreId=this.DM.assetStoreId;ra.height=0!=this.DM.height?this.DM.height:600;ra.storeId=this.DM.storeId;ra.storeType=this.DM.storeType;ra.targetType=this.DM.targetType;ra.width=0!=this.DM.width?this.DM.width:600;ra.displayName=this.DM.displayName;ra.version=this.DM.version;ra.isAddinCommands=!1;vb[mc.a.yua]=ra;const dc=new Ie.a(-741808261,0,0,2,null);Ka.TaskExtensions.$e(Yc.GetServiceTaskFactory.dk(this.$.qa,
374,375,1),Hc=>{Hc=Hc.result;null!=Hc&&Hc.insertAgave(vb,dc)},this.$.ya,3)};this.xQj=()=>{const ra={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Si.zab(this.DM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(ra)});this.Uha()};this.iSj=()=>{const ra={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Si.zab(this.DM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(ra)});this.Uha()};this.OAa=ra=>{ya.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${ra?ra.httpStatus:-1}`)};this.$=B.$;this.addinUICommandHandler=B;this.appName=La.AFrameworkApplication.ea.Ya("WebAppShortName")||"Excel";this.FGh=La.AFrameworkApplication.ea.Ij("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(B){return Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,
B.storeType,B.assetId,null,null,B.storeId)}static zab(B){return Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.storeType,B.assetId,null,null,B.storeId)}Skk(B){this.DM=B;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.vXj,!0),window.addEventListener("DismissCallout",this.iSj,!0),window.addEventListener("CloseCallout",this.xQj,!0))}ZQg(){var B=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();const ra=this.ns.solutionId;ra in B?this.NVa=
B[ra]:(B=Si.GetPrivacyCompliantId(this.ns),ya.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${B}`),this.NVa=this.eFi(this.Pw))}NOd(B){return"[id="+B+"]"}kXg(B,ra){ra>this.FGh?(window.clearTimeout(this.fFg),this.jXg("[data-unique-id='pivotOverflowButton']"),ya.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+B)?this.jXg(B):this.fFg=window.setTimeout(()=>{this.kXg(B,ra+1)},
1E3)}iXg(B){var ra=document.querySelector("button[data-unique-id='RightPaddle']");if(ra)B={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Si.GetPrivacyCompliantId(this.ns),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(B)});else if(ra=document.querySelector("button"+B),!ra||"none"===window.getComputedStyle(ra).display)if(ra=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),
!ra){ra={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Si.GetPrivacyCompliantId(this.ns),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(ra)});ya.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.Uha();return}this.k3g(ra,"ShowTeachingUIForAddinButton")}jXg(B){B=document.querySelector("button"+B);if(!B&&(B=document.querySelector("button[data-unique-id='pivotOverflowButton']"),
!B)){B={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Si.GetPrivacyCompliantId(this.ns),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(B)});ya.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.Uha();return}this.k3g(B,"ShowTeachingUIForAddinTab")}k3g(B,ra){B.setAttribute("lpp-id","latestAddin");const vb=
Bb.a.instance.Dk("Common.ISystemInitiatedFeedback");vb&&B?(vb.execute(dc=>{dc.logActivity(ra,null)}),B={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Si.GetPrivacyCompliantId(this.ns),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(B)}),ya.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(ya.ULS.sendTraceTag(537170689,
220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),B={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Si.GetPrivacyCompliantId(this.ns),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(B)}),this.Uha())}eFi(B){if(B&&(B=B.N7,(null===B||void 0===B?0:B.nC)&&0<B.nC.count))for(const ra of B.nC)if(ra.groups&&0<ra.groups.length)for(const vb of ra.groups)if(vb.controls&&
0<vb.controls.length)for(const dc of vb.controls){if(dc.attributes&&0===dc.controlType&&dc.enabled)return dc.id;if(dc.menuItems)for(const Hc of dc.menuItems)if(Hc.attributes&&Hc.enabled)return dc.id}}hXg(){var B="button[data-unique-id = 'Ribbon-InsertAppsForOffice']";Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&(B=this.Lbh?"button[data-unique-id = 'Ribbon-InsertAddInFlyout']":B);if((B=document.querySelector(B))&&"none"!==window.getComputedStyle(B).display)ya.ULS.sendTraceTag(527286666,
220,15,"Callout show on OfficeAddin Button");else{B=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==B){B={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Si.zab(this.DM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(B)});ya.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");
this.Uha();return}ya.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const ra=Bb.a.instance.Dk("Common.ISystemInitiatedFeedback");null==ra||null==B?(B={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Si.zab(this.DM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(B)}),ya.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),
this.Uha()):(ra.execute(vb=>{vb.logActivity("ShowTeachingUIForContentAddin",null)}),B={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Si.zab(this.DM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn(B)}),ya.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}CXc(B){const ra={},vb={};vb.LastTeachingUIShowTime=(new Date).toUTCString();
vb.AddinHasShown=B;ra[this.appName]=of.c(vb);this.pJb=new Ec(this.appName,null,null,this.OAa),this.pJb.oyc(ra),ya.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}Uha(){if(!this.gXc){const B=window.g_roamingAddinList;B&&(this.CXc(B),this.gXc=!0)}}}Object(ha.a)(Si,"AddinTeachingCalloutHandler",null,[]);var fk=a(1416),Ql=a(309),Mk=a(48),ej=a(242),li=a(249);class jk extends ej.a{constructor(B,ra,vb,dc){super();
this.H9="calc(100% - 46px)";this.Aka="15px";this.I9="0";this.dDb="WACDialogPanel";this.hO=695;this.eDb=462;this.SL="80%";this.QBb=350;this.RDa="100%";this.V3=null;this.Oh=5;this.fl="AddinInstallDialog";this.Rih=B;this.V9=ra;this.bwh=vb;this.jrh=dc}vG(){super.vG();this.Yo.style.width=this.RDa;this.Yo.style.height=this.H9;this.Yo.style.marginTop=this.Aka;this.Yo.style.padding=this.I9;document.getElementById(this.hp("WACDialogButtonPanel")).style.display="none";this.qva.setAttribute("tabindex","0");
$addHandler(this.qva,"keyup",Object($f.a)(this,this.onKeyUp,"onKeyUp"));const B=document.createElement("iframe");B.setAttribute("id","InstallAddinDialog");B.setAttribute("src","about:blank");B.setAttribute("width","100%");B.setAttribute("height","100%");B.setAttribute("marginHeight","0");B.setAttribute("marginWidth","0");B.setAttribute("frameBorder","0");B.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const ra=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",
this.Rih,this.V9,this.bwh);B.setAttribute("src",ra);this.V3=B;$addHandler(B,"load",Object($f.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object($f.a)(this,this.onMessage,"onMessage"));this.Yo.appendChild(B);this.Yo.appendChild(this.y7h())}y7h(){const B=document.createElement("div");B.setAttribute("tabindex","0");$addHandler(B,"focus",Object($f.a)(this,this.QXj,"onLoopPivotFocus"));return B}onKeyUp(B){13!==B.keyCode&&32!==B.keyCode||this.hide()}QXj(){this.qva.focus()}onLoad(){this.V3.focus()}onMessage(B){B=
B.rawEvent;if(B.source===this.V3.contentWindow&&(B=(B=B.data)?B.split("|"):null)&&0<B.length&&("REFRESH_REQUIRED"===B[0]||"PRELOAD_MANIFEST"===B[0])){fa.a.instance.setItem("refreshRequired","true");const ra={};ra.solutionId=B[1];ra.version=jk.NLj(B[3]);ra.storeType=B[4];ra.storeId=B[5];ra.assetId=B[6];ra.targetType=jk.B6j(B[2]);ra.assetStoreId=B[7];ra.width=parseInt(B[8]);ra.height=parseInt(B[9]);this.jrh(ra)}}ZAa(){this.Yo.style.width=this.RDa;this.Yo.style.height=this.H9;this.Yo.style.marginTop=
this.Aka;this.Yo.style.padding=this.I9;this.hO>li.a.rca?(this.rh.style.width=String.format("{0}px",li.a.rca),this.rh.style.overflowX="scroll",La.AFrameworkApplication.isRtl?this.rh.style.right="0":this.rh.style.left="0"):(this.rh.style.width=String.format("{0}px",this.hO),this.rh.style.overflowX="hidden");this.rh.offsetHeight>li.a.t2||this.eDb+50>li.a.t2?(this.rh.style.height=String.format("{0}px",li.a.t2),this.rh.style.overflowY="scroll",this.rh.style.top="0",La.AFrameworkApplication.isRtl?this.rh.style.right=
"0":this.rh.style.left="0",this.Yo.style.minHeight=String.format("{0}px",this.QBb)):(this.rh.style.overflowY="hidden",this.rh.style.top="10%",this.rh.style.height=this.SL);this.nma()}nma(){if(this.rh){var B=this.rh.style.zIndex;this.rh.style.zIndex="-9999";if(this.hO>li.a.rca)La.AFrameworkApplication.isRtl?this.rh.style.marginRight="0":this.rh.style.marginLeft="0";else{const ra=String.format("{0}px",Math.floor(-this.rh.offsetWidth/2));La.AFrameworkApplication.isRtl?this.rh.style.marginRight=ra:this.rh.style.marginLeft=
ra;La.AFrameworkApplication.isRtl?this.rh.style.right="50%":this.rh.style.left="50%"}this.rh.style.zIndex=String(B)}else ya.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}zT(){super.zT();const B=document.getElementById(this.hp(this.dDb));B.style.width=String.format("{0}px",this.hO);B.style.height=this.SL}get Yma(){return this.Yo}dispose(){super.dispose();$removeHandler(window,"message",Object($f.a)(this,this.onMessage,"onMessage"))}static B6j(B){switch(B){case "1":return 0;
case "2":return 1;default:return 0}}static NLj(B){const ra=B.split(".");for(let vb=0;vb<4-ra.length;vb++)B+=".0";return B}}Object(ha.a)(jk,"AddinInstallDialog",ej.a,[]);class gl{constructor(){this.addInDetails=this.title=null}}Object(ha.a)(gl,"AddInCategoryData",null,[]);class tk{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(ha.a)(tk,"AddInDetailData",null,[]);class hl{constructor(){this.href=this.text=null}}Object(ha.a)(hl,"AddInLinkData",null,
[]);var yj=a(1066),uk;(function(B){B[B.Mfh=0]="S_OK";B[B.Gjl=-2147471590]="E_REQUEST_TIME_OUT";B[B.Hjl=-2147208619]="E_USER_NOT_SIGNED_IN";B[B.sjl=-2147471591]="E_CATALOG_ACCESS_DENIED";B[B.ujl=-2147471589]="E_CATALOG_REQUEST_FAILED";B[B.Bjl=-2147208640]="E_OEM_NO_NETWORK_CONNECTION";B[B.Fjl=-2147208617]="E_PROVIDER_NOT_REGISTERED";B[B.Ajl=-2147208637]="E_OEM_CACHE_SHUTDOWN";B[B.Cjl=-2147209421]="E_OEM_REMOVED_FAILED";B[B.tjl=-1]="E_CATALOG_NO_APPS";B[B.Ijl=-2]="E_USER_NO_MAILBOX";B[B.xjl=-1E3]="E_GENERIC_ERROR";
B[B.Fll=10]="S_HIDE_PROVIDER"})(uk||(uk={}));Object(ha.b)("InvokeResultCode",uk);class il{constructor(B,ra){this.Ea=ra;this.Zw=B}get TSk(){return this.Ea?this.Ea.isChangeGateEnabled("OfficeVSO:8511220_showPopularOnFailForGuests"):!1}OWg(B){return this.TSk?B.failure?-2147208619===B.failure.invokeResultCode:!1:!1}mJf(B,ra){return`invokeFailure/${3===B.errorCode&&B.failure?uk[B.failure.invokeResultCode]:""}/${3===ra.errorCode&&ra.failure?uk[ra.failure.invokeResultCode]:""}`}r9f(B,ra,vb,dc){B={["Source"]:this.Zw,
["MRUListNumber"]:B.toString(),["MyAddinsErrorCode"]:yj.a[ra.errorCode],["MyAddInsResult"]:ra.Nt.length.toString(),["MyAddinsInvokeResultCode"]:ra.failure?ra.failure.invokeResultCode:"N/A",["AdminManagedErrorCode"]:yj.a[vb.errorCode],["AdminManagedResult"]:vb.Nt.length.toString(),["AdminManageInvokeResultCode"]:vb.failure?vb.failure.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:dc?yj.a[dc.errorCode]:"N/A",["PopularAddinsResult"]:dc?dc.Nt.length.toString():"N/A",["PopularAddinsInvokeResultCode"]:dc&&
dc.failure?dc.failure.invokeResultCode:"N/A"};this.JNk&&(B.MyAddinsQueryStart=this.PCc(ra.failure),B.AdminManagedQueryStart=this.PCc(vb.failure),B.PopularQueryStart=this.PCc(dc.failure));ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:Ne.a.xn(B)})}q9f(B,ra,vb,dc,Hc){vb={["MyAddinsResult"]:this.xud(vb),["AdminManagedResult"]:this.xud(dc),["PopularResult"]:this.xud(Hc)};B={["Source"]:this.Zw,["Abnormals"]:ra.join("|"),["NumAddinsInMRU"]:B.toString(),
["DiagnosticDetails"]:JSON.stringify(vb)};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinEntryPointAceMetrics",dataFields:Ne.a.xn(B)})}xud(B){return{["Count"]:B.Nt.length.toString(),["QueryStart"]:this.PCc(B.failure),["ErrorCode"]:yj.a[B.errorCode],["InvokeResultCode"]:B.failure?B.failure.invokeResultCode:"N/A"}}get Q0g(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8393563_FlyoutTelemetryOptimizationEnabled")}get m9f(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8581842_LogAceMetricsEnabled")}PCc(B){let ra=
"N/A";B&&B.queryStart&&window.performance.timeOrigin&&(ra=(new Date(window.performance.timeOrigin+B.queryStart)).toISOString());return ra}get JNk(){return this.Ea?this.Ea.isChangeGateEnabled("OfficeVSO:8546535_LogQueryStartEnabled"):!1}}Object(ha.a)(il,"AddinEntryPointCommon",null,[]);class Ij{constructor(B,ra,vb){this.kka=0;this.lOe=!1;this.jHb=[];this.hSa=void 0;this.Ea=B;this.jka=ra;this.Iid=vb;ya.ULS.sendTraceTag(508396508,220,50,"AddInCategoryManager Initialized")}Q4a(B,ra){B&&ra&&this.VNk(ra)&&
this.Iwg()}VNk(B){0===B.gM&&(this.kka|=1);1===B.gM&&(this.kka|=2);2===B.gM&&(this.kka|=4);return!!this.kka}Iwg(){const B=[];let ra=null;const vb={},dc=this.pqj,Hc=this.WIj,ed=this.jka.$R(0),Id=this.jka.$R(1),Pd=this.jka.$R(2);(2===ed.errorCode||this.Nyb&&2===Pd.errorCode)&&!Hc.length?(ra=this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?{ariaDescription:Object(xc.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(xc.a)("AddinPickerDisableError"),
title:Object(xc.a)("AddInBackstageErrorViewTitle"),linkText:Object(xc.a)("AddinPickerDisableErrorDocumentText"),linkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",La.AFrameworkApplication.uiCulture),onLinkClicked:()=>{ya.ULS.sendTraceTag(507875924,220,15,"User has clicked link on add-in backstage error view")}}:{ariaDescription:Object(xc.a)("AddinPickerDisableError"),
iconName:"StoreDisabled",label:Object(xc.a)("AddinPickerDisableError"),title:Object(xc.a)("AddInBackstageErrorViewTitle")},B.push("storeDisabled")):3!==ed.errorCode||this.E4.OWg(ed)||3!==Id.errorCode?4!==ed.errorCode||Hc.length?!this.D2f&&(!this.Aba||0!==Pd.errorCode&&5!==Pd.errorCode)||Pd.Nt.length||(ya.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.kka,Pd.errorCode),B.push("emptyCategory")):(ra={ariaDescription:Object(xc.a)("AddinPickerServiceDisconnectedError"),
iconName:"StoreDisabled",label:Object(xc.a)("AddinPickerServiceDisconnectedError"),title:Object(xc.a)("AddInBackstageErrorViewTitle")},B.push("serviceDisabled")):(ra={ariaDescription:Object(xc.a)("AddinPickerGeneralError"),iconName:"Common",label:Object(xc.a)("AddinPickerGeneralError"),title:Object(xc.a)("AddInBackstageErrorViewTitle")},B.push(this.E4.mJf(ed,Id)));this.ebc&&this.E4.r9f(Hc.length,ed,Id,Pd);const Rd=!ra;!Rd||dc||Hc.length?(Rd?(vb.mruAddIns=Hc,dc&&(vb.categories=this.R8j)):vb.errorViewProps=
ra,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(vb,Rd)),dc&&Rd&&!this.lOe&&(this.lOe=!0,ya.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.kka))):B.push("emptyPage");this.ebc&&(this.E4.Q0g&&ya.ULS.sendTraceTag(508047441,220,15,`${B.join("|")}`),this.E4.m9f&&this.E4.q9f(Hc.length,B,ed,Id,Pd))}get D2f(){return!!(this.kka&4)}get ebc(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",
!1)}get pqj(){const B=this.jka.$R(2);return(this.D2f||this.Aba||this.ebc)&&(0===B.errorCode||5===B.errorCode)&&!!B.Nt.length}get R8j(){var B=this.jKi();0<B.length&&(this.Iid=B);if(Bf.c(this.Iid))return[];var ra=JSON.parse(this.Iid);B=[];for(var vb of ra)ra=Object.assign(new gl,{title:vb.title,addInDetails:[]}),this.GPh(ra,vb.solutionIds),0<ra.addInDetails.length&&Array.add(B,ra);0<this.jHb.length&&(vb=this.jka.$R(2),ya.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",
this.jHb.length,this.jHb,vb.Nt.length),this.jHb=[]);return B}get WIj(){var B=[],ra=this.jka.$R(0);Array.addRange(B,ra.Nt);ra=this.jka.$R(1);Array.addRange(B,ra.Nt);B.sort((vb,dc)=>{vb=Ve.d(vb.displayName);dc=Ve.d(dc.displayName);return wc.a.localeCompare(vb,dc)});ra=[];for(const vb of B)B=Object.assign(new tk,{description:vb.description,displayName:vb.displayName,solutionId:vb.solutionId,uniqueId:this.ARb(vb)}),Array.add(ra,B);return ra}GPh(B,ra){const vb=this.XIj;let dc=0;for(const Hc of ra){if(4===
dc)break;if(vb.contains(Hc))continue;ra=this.jka.DH(Hc);if(!ra){this.jHb.push(Hc);continue}const ed=Object.assign(new tk,{description:ra.description,displayName:ra.displayName,solutionId:ra.solutionId,uniqueId:this.ARb(ra)});ed.links=[Object.assign(new hl,{text:Object(xc.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+ra.solutionId})];Array.add(B.addInDetails,ed);++dc}}get XIj(){const B=[];var ra=this.jka.$R(0);Array.addRange(B,ra.Nt);ra=this.jka.$R(1);Array.addRange(B,
ra.Nt);ra=new Xb.a(Kb.a.tm());for(const vb of B)ra.add(vb.solutionId);return ra}ARb(B){return this.Aba?String.format("{0}#{1}",B.solutionId,B.storeId):B.solutionId}get Aba(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}jKi(){return this.Ea?this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get Nyb(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8362324_StoreDisabledErrorViewFixEnabled")}get E4(){this.hSa||
(this.hSa=new il("Backstage",this.Ea));return this.hSa}}Object(ha.a)(Ij,"AddInCategoryManager",null,[]);var Vj=a(1067),gk=a(683);class Rj{constructor(B,ra,vb){this.amountToShowWhenCollapsed=B;this.expandButton=ra;this.collapseButton=vb}}Object(ha.a)(Rj,"GallerySectionCollapse",null,[]);class vk{constructor(){this.Collapse=this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(ha.a)(vk,"GallerySectionProps",null,[]);var hk=a(1232);class Nk{constructor(){this.text=this.href=
null}}Object(ha.a)(Nk,"LinkProps",null,[]);var kk=a(1135),Dl=a(1277),zj=a(289),Rl=a(243);class jl{constructor(B,ra,vb){this.F8e="appsource";this.primaryKey="f45d712d6617b7e2b2f1fb0fc9757fa1eb384d7f03f6740a1a474b3ccf95b5d8";this.AAk="99b3e3778ca726c8bd5b4b1b6aa137358f0902d731079ca80e28f79a25d3870a";this.Ea=B;this.UQ=ra;this.FRe=void 0===vb?"en":vb;this.Cl=new bj(this.Ea);this.JVe=this.dRh();this.lz={};this.enh=this.Cl.AGh}woe(B,ra,vb,dc,Hc){dc=void 0===dc?15:dc;Hc=void 0===Hc?!1:Hc;var ed=new zj.QueryStringBuilder("search"),
Id={"api-version":"2023-01-01-preview",gallery:"AppSourceApps",productTypes:"Office365",Market:"ALL",select:"UniqueProductId,DisplayName,LongSummary,SmallIconUri,Popularity"};Id.applicableProducts=this.UQ;Id.supportedProducts=this.UQ+"_Online";Id.Language=this.FRe;Id.searchQuery=B;Id.top=dc.toString();this.$rd("AppSource",Id);for(const Rd in Id)ed.Op(Rd,Id[Rd]);ed="https://catalogapi.azure.com/"+ed.toString();Id={};Id["X-API-Key"]=Hc?this.AAk:this.primaryKey;Id["X-ms-app"]=this.F8e;const Pd=window.performance.now();
this.executeRequest(ed,1,Id,Rd=>{let $d="Query Succeeded",Ae=!0,Ke=0;const Ze=[],cg=[];Rd=Rd.data.responseData;try{var Vf=JSON.parse(Rd);Ke=Vf.totalCount;const Xf=Vf.results;for(Vf=0;Vf<Xf.length;Vf++){const Pf=Xf[Vf],Kg={};Kg.solutionId=Pf.uniqueProductId.toLowerCase();Kg.displayName=Pf.displayName;Kg.description=Pf.longSummary;Kg.iconUrl=Pf.smallIconUri;Kg.assetId=Kg.solutionId;Kg.storeId="en-US";Kg.storeType="omex";Kg.assetStoreId="omex";Ze.push(Kg);this.lz[Kg.solutionId]=Kg;cg.push(Pf.popularity)}}catch(Xf){$d=
"Exception thrown from Json parse for responseData: "+Rd+". Exception: "+Xf,Ae=!1}this.PMa(0<B.length,vb,"AppSource",Ae,$d,window.performance.now()-Pd,Ke,Ze,cg);ra(Ae,Ze)},Rd=>{const $d=[];this.PMa(0<B.length,vb,"AppSource",!1,`Query Failed, httpStatus: ${Rd.data.httpStatus}, responseData: ${Rd.data.responseData}`,window.performance.now()-Pd,0,$d);Hc||Rd.data.httpStatus!==Rl.a.aAe?ra(!1,$d):this.woe(B,ra,vb,dc,!0)})}BNg(B,ra){ra=void 0===ra?15:ra;return new Promise((vb,dc)=>{this.woe(B,(Hc,ed)=>{Hc?
vb(ed):dc()},Date.now(),ra)})}gZi(B,ra){var vb=new zj.QueryStringBuilder("suggestions/products"),dc={"api-version":"2023-01-01-preview",gallery:"AppSourceApps",productTypes:"Office365",Market:"ALL",select:"DisplayText,Id,IconUrl,ProductType"};dc.applicableProducts=this.UQ;dc.Language=this.FRe;dc.suggestionTypes="WordSearch,Entity";dc.searchQuery=B;this.$rd("AppSource",dc);for(const ed in dc)vb.Op(ed,dc[ed]);vb="https://catalogapi.azure.com/"+vb.toString();dc={};dc["X-API-Key"]=this.primaryKey;dc["X-ms-app"]=
this.F8e;const Hc=window.performance.now();this.executeRequest(vb,1,dc,ed=>{let Id="Query Succeeded",Pd=!0;ed=ed.data.responseData;let Rd={};try{Rd=JSON.parse(ed)}catch($d){Id="Exception thrown from Json parse for responseData: "+ed+". Exception: "+$d,Pd=!1}this.PMa(0<B.length,0,"AppSource/suggestions",Pd,Id,window.performance.now()-Hc,0,[]);ra(Pd,Rd)},ed=>{this.PMa(!1,0,"AppSource/suggestions",!1,`Query Failed, httpStatus: ${ed.data.httpStatus}, responseData: ${ed.data.responseData}`,window.performance.now()-
Hc,0,[]);ra(!1,{})})}hZi(B){return new Promise((ra,vb)=>{this.gZi(B,(dc,Hc)=>{dc?ra(Hc):vb()})})}xoe(B,ra,vb,dc,Hc){dc=void 0===dc?"":dc;Hc=void 0===Hc?15:Hc;const ed=new zj.QueryStringBuilder("api/addins/search"),Id={apiversion:"1.0"};0<B.length&&(Id.qu=B);0<dc.length&&(Id.assetids=dc);Id.client="WAC_"+this.UQ;Id.cv=La.AFrameworkApplication.buildVersion;Id.top=Hc.toString();this.$rd("OMEX",Id);for(const Rd in Id)ed.Op(Rd,Id[Rd]);dc="https://api.addins.omex.office.net/"+ed.toString();const Pd=window.performance.now();
this.executeRequest(dc,1,null,Rd=>{let $d="Query Succeeded",Ae=!0,Ke=0;const Ze=[];Rd=Rd.data.responseData;try{var cg=JSON.parse(Rd);Ke=cg.TotalCount;const Vf=cg.Values;for(cg=0;cg<Vf.length;cg++){const Xf=Vf[cg],Pf={};Pf.solutionId=Xf.Id.toLowerCase();Pf.displayName=Xf.Title;Pf.description=Xf.ShortDescription;Pf.iconUrl=Xf.IconUrl;Pf.assetId=Pf.solutionId;Pf.storeId="en-US";Pf.storeType="omex";Pf.assetStoreId="omex";Pf.version=Xf.Version;Pf.targetType=Xf.Shape-1;Pf.height=Xf.Height;Pf.width=Xf.Width;
Ze.push(Pf);this.lz[Pf.solutionId]=Pf}}catch(Vf){$d="Exception thrown from Json parse for responseData: "+Rd+". Exception: "+Vf,Ae=!1}this.PMa(0<B.length,vb,"OMEX",Ae,$d,window.performance.now()-Pd,Ke,Ze);ra(Ae,Ze)},Rd=>{const $d=[];this.PMa(0<B.length,vb,"OMEX",!1,`Query Failed, httpStatus: ${Rd.data.httpStatus}, responseData: ${Rd.data.responseData}`,window.performance.now()-Pd,0,$d);ra(!1,$d)})}CNg(B,ra,vb){ra=void 0===ra?"":ra;vb=void 0===vb?15:vb;return new Promise((dc,Hc)=>{this.xoe(B,(ed,Id)=>
{ed?dc(Id):Hc()},Date.now(),ra,vb)})}yWi(B,ra){var vb=new zj.QueryStringBuilder("api/addins/details");const dc={apiversion:"1.0"};dc.assetid=B;dc.client="WAC_"+this.UQ;dc.cv=La.AFrameworkApplication.buildVersion;for(const ed in dc)vb.Op(ed,dc[ed]);vb="https://api.addins.omex.office.net/"+vb.toString();const Hc=window.performance.now();this.executeRequest(vb,1,null,ed=>{let Id="Query Succeeded",Pd=!0;ed=ed.data.responseData;const Rd={};try{const $d=JSON.parse(ed).Value;Rd.solutionId=B;Rd.displayName=
$d.Title;Rd.shortDescription=$d.ShortDescription;Rd.longDescription=$d.LongDescription;Rd.iconUrl=$d.IconUrl;Rd.videoUrl=$d.VideoUrl;Rd.screenshots=$d.Screenshots.map(Ae=>Ae.FullSize)}catch($d){Id="Exception thrown from Json parse for responseData: "+ed+". Exception: "+$d,Pd=!1}this.PMa(!1,0,"OMEX/details",Pd,Id,window.performance.now()-Hc,0,[]);ra(Pd,Rd)},ed=>{this.PMa(!1,0,"OMEX/details",!1,`Query Failed, httpStatus: ${ed.data.httpStatus}, responseData: ${ed.data.responseData}`,window.performance.now()-
Hc,0,[]);ra(!1,{})})}zWi(B){return new Promise((ra,vb)=>{this.yWi(B,(dc,Hc)=>{dc?ra(Hc):vb()})})}DH(B){return this.lz[B.toLowerCase()]?this.lz[B.toLowerCase()]:null}executeRequest(B,ra,vb,dc,Hc){return La.AFrameworkApplication.lj.qv(B,ra,null,void 0===vb?null:vb,!1,2,dc,Hc,null,null,!1,null,this.enh)}PMa(B,ra,vb,dc,Hc,ed,Id,Pd,Rd){B={["hasSearchValue"]:null===B||void 0===B?void 0:B.toString(),["searchStartTime"]:null===ra||void 0===ra?void 0:ra.toString(),["apiSource"]:vb,["responseSuccess"]:null===
dc||void 0===dc?void 0:dc.toString(),["responseInfo"]:Hc,["timeElapsed"]:null===ed||void 0===ed?void 0:ed.toString(),["totalCount"]:null===Id||void 0===Id?void 0:Id.toString(),["solutionIds"]:Pd.map($d=>this.n3h($d)),["popularity"]:Rd?Rd:[]};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SearchApiMetrics",dataFields:Ne.a.xn(B)})}n3h(B){return Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.storeType,B.assetId,null,null,B.storeId)}dRh(){let B=this.Cl.l5j;if(1>=B.length)return{};
ya.ULS.sendTraceTag(507785891,220,50,"BuildSearchQueryParametersOverrides: overrideString: {0}.",B);const ra={};let vb=!0,dc="";B=B.trim();try{const Hc=B.split("$");for(let ed=0;ed<Hc.length&&vb;ed++){const Id=Hc[ed].split(":");if(2!==Id.length){dc="Invalid override string format: "+Hc[ed];vb=!1;break}const Pd=Id[0].trim(),Rd=[],$d=Id[1].split("|");for(let Ae=0;Ae<$d.length&&vb;Ae++){const Ke=$d[Ae],Ze=Ke.split("\\");if(2<Ze.length){dc="Invalid override string format: "+Ke;vb=!1;break}const cg=Ze[0].trim(),
Vf=2===Ze.length?Ze[1].trim():null;Array.add(Rd,new Fd.a(cg,Vf))}ra[Pd]=Rd}}catch(Hc){dc="Failed in parsing the overrideString: "+B+". Exception: "+Hc.toString(),vb=!1}if(vb)return ra;ya.ULS.sendTraceTag(507785890,220,10,"Build override failed: {0}.",dc);return{}}$rd(B,ra){if(this.JVe[B]){B=this.JVe[B];for(let vb=0;vb<B.length;vb++){const dc=B[vb].key,Hc=B[vb].value;Hc?ra[dc]=Hc:delete ra[dc]}}}}Object(ha.a)(jl,"AddinSearchApiManager",null,[]);var Ok=a(409);class kl{constructor(){this.Hp=B=>{var ra;
if(null===B||null===B.La)return!1;B=B.La.target;for(this.tId=void 0;null!=B&&B.getAttribute;){void 0===this.tId&&0<(null===(ra=B.id)||void 0===ra?void 0:ra.length)&&(this.tId=B.id);if(null!=B.getAttribute("data-contextmenu-id"))break;B=B.parentNode}return!1}}get currentTarget(){return this.tId}Iyj(){Ok.a.instance.xa(window.document.body,this.Hp,null)}dispose(){Ok.a.instance.Oa(window.document.body,this.Hp)}}Object(ha.a)(kl,"AppFlyoutGeneratorContextMenuListener",null,[]);const lk={["WF"]:"wa200001011 wa104382081 wa200000368 wa104380122 wa200000199 wa104381727 wa200005983 wa200001361 wa200000011 wa200005106 wa200005817 wa200004216".split(" "),
["IPWAI"]:"wa200005502 wa200001011 wa200000368 wa200005107 wa200005287 wa104381714 wa200005444 wa200005826 wa200006000 wa200005313 wa200001361 wa200006001 wa200005312".split(" "),["ER"]:"wa200004257 wa104381909 wa104380917 wa200002334 wa200001482 wa200002534 wa200002891 wa104380848".split(" "),["APID"]:"wa200000113 wa104380121 wa104051163 wa104379279 wa104380118 wa104178141 wa200002281 wa104379370 wa104379997 wa104381063 wa104381411".split(" ")},ll={["IPWAI"]:"wa200005502 wa200005271 wa200004935 wa200001584 wa200005281 wa200005107 wa200005333".split(" "),
["DA"]:"wa200003784 wa200000169 wa200000018 wa104381841 wa104380711 wa104381807 wa200002503".split(" "),["APIC"]:"wa102957665 wa200004179 wa104051163 wa104380194 wa200004688 wa200004687 wa104221182 wa200003220 wa104379169 wa103147117".split(" ")},Sl={["IPWAI"]:["wa200003964","wa200005107","wa200005669","wa200006067"],["APIC"]:"wa104221182 wa104178141 wa104381909 wa200000113 wa104381155 wa104380907 wa104380121 wa104379997 wa104381063 wa104379370 wa104380902 wa104381411 wa200003220 wa200003891 wa104380848 wa104381637 wa200001766".split(" "),
["CAIP"]:"wa104379261 wa200001661 wa200002908 wa200000094 wa104218073 wa104381682 wa104382064 wa200004643 wa200004709 wa200003676 wa200001313 wa200003706 wa104381448 wa104380667".split(" ")},Wj={["IPWAI"]:"wa200005502 wa200001011 wa200000368 wa200005107 wa200005287 wa104381714 wa200005444 wa200005826 wa200006000 wa200001361 wa200005313 wa200005312 wa200006001".split(" "),["WF"]:"wa200001011 wa104382081 wa200000368 wa104380122 wa200000199 wa200005983 wa104381727 wa200001361 wa200000011 wa200005106 wa200005817 wa200004216".split(" "),
["ER"]:"wa200004257 wa104381909 wa104380917 wa200002334 wa200001482 wa200002534 wa200002891 wa104380848".split(" "),["APID"]:"wa200000113 wa104380121 wa104051163 wa104379279 wa200002281 wa104178141 wa104380118 wa104379370 wa104379997 wa104381063 wa104381411 wa200001486".split(" ")},Pk={["IPWAI"]:"wa200005502 wa200005271 wa200004935 wa200001584 wa200005669 wa200005281 wa200006009 wa200006007 wa200005333".split(" "),["APIC"]:"wa102957665 wa200004179 wa104051163 wa200000113 wa104380194 wa200004688 wa200004687 wa104221182 wa200003220 wa104379169 wa103147117".split(" "),
["DA"]:"wa200000169 wa200000018 wa200003784 wa104381841 wa200000025 wa200002503 wa104381807 wa104380711 wa200004632 wa200005782 wa200005817 wa200005777 wa200005960 wa200006017 wa200006008".split(" "),["FA"]:"wa104379220 wa200002311 wa104381695 wa200003692 wa104381859 wa104381717 wa104380978".split(" ")},El={["IPWAI"]:["wa200003964","wa200005669","wa200005107","wa200006000","wa200006067"],["APIC"]:"wa104221182 wa104178141 wa104381909 wa104380907 wa200000113 wa104380121 wa104381155 wa104379997 wa104381063 wa104379370 wa104380902 wa104381411 wa200003220 wa200003891 wa104380848 wa104381637 wa200001766".split(" "),
["CAIP"]:"wa104379261 wa200001661 wa200000094 wa200002908 wa104381682 wa104218073 wa104382064 wa200004709 wa200004643 wa200003676 wa200001313 wa200003706 wa104381448 wa104380667".split(" "),["DWT"]:"wa200001625 wa104380602 wa104380526 wa200002334 wa104380050 wa200003052 wa200006046 wa200003157 wa104380955 wa104380278 wa200001396 wa200001409".split(" ")};class mk{constructor(B,ra,vb){this.Cl=B;this.TQ=ra;this.E9={};this.fCb={};this.Xhd={};if(B.fRb||B.afa){this.E9=vb;this.TJh();this.EJh();B=this.Cl.k5j;
try{const dc=B.split("|");B={};for(ra=0;ra<dc.length;ra+=2)B[dc[ra]]=dc[ra+1];this.Xhd=B}catch(dc){}}}TJh(){const B={};var ra=this.Cl.i5j;if(!(1>=ra.length)){ya.ULS.sendTraceTag(507589127,220,50,"BuildCategoryAddinDetailOverrides: overrideString: {0}.",ra);var vb=!0,dc="";ra=ra.trim();try{const Hc=ra.split("$");for(let ed=0;ed<Hc.length&&vb;ed++){const Id=Hc[ed].split(":");if(2<Id.length){dc="Invalid override string format: "+Hc[ed];vb=!1;break}const Pd=Id[0].trim(),Rd=[];if(2===Id.length){const $d=
Id[1].split("|");for(let Ae=0;Ae<$d.length&&vb;Ae++){const Ke=$d[Ae],Ze=Ke.split("\\");if(2>Ze.length||5<Ze.length){dc="Invalid override string format: "+Ke;vb=!1;break}const cg=Ze[0].trim(),Vf={};for(let Xf=1;Xf<Ze.length&&vb;Xf++)if(0<Ze[Xf].trim().length)switch(Xf){case 1:Vf.priority=parseInt(Ze[Xf].trim());break;case 2:Vf.AUP=parseInt(Ze[Xf].trim());break;case 3:Vf.diffAUP=parseInt(Ze[Xf].trim());break;case 4:const Pf=Ze[Xf].trim();if(8!==Pf.length){dc="Invalid override string format: "+Pf;vb=
!1;break}Vf.releaseDate=(new Date(parseInt(Pf.substring(0,4)),parseInt(Pf.substring(4,6))-1,parseInt(Pf.substring(6)))).getTime();break;default:dc="Invalid override string format: "+Ke,vb=!1}if(!vb)break;Array.add(Rd,{solutionId:cg,addinInfo:Vf})}}this.E9[Pd]&&(B[Pd]=Rd)}}catch(Hc){dc="Failed in parsing the overrideString: "+ra+". Exception: "+Hc.toString(),vb=!1}if(vb){for(const Hc in B){if(!this.E9[Hc])continue;const ed=B[Hc];ra=this.E9[Hc].filter(Id=>!ed.some(Pd=>Pd.solutionId.toLowerCase()===
Id.solutionId.toLowerCase()));Array.addRange(ed,ra)}this.E9=B}else ya.ULS.sendTraceTag(507589126,220,10,"Override Failed: {0}.",dc)}}EJh(){for(const B in this.E9){const ra=this.E9[B];for(let vb=0;vb<ra.length;vb++){const dc=ra[vb];dc.addinInfo||(dc.addinInfo={});if(!dc.addinInfo.priority||isNaN(dc.addinInfo.priority))dc.addinInfo.priority=0;if(!dc.addinInfo.AUP||isNaN(dc.addinInfo.AUP))dc.addinInfo.AUP=0;if(!dc.addinInfo.diffAUP||isNaN(dc.addinInfo.diffAUP))dc.addinInfo.diffAUP=0;if(!dc.addinInfo.releaseDate||
isNaN(dc.addinInfo.releaseDate))dc.addinInfo.releaseDate=0}}}JHi(){if(!this.E9||0===Object.keys(this.E9).length)return ya.ULS.sendTraceTag(507589125,220,15,"The category add-in ids mapping is empty."),{};if(Object.keys(this.fCb).length!==Object.keys(this.E9).length){const ra=[],vb={};for(const dc in this.E9){if("PAIYO"===dc){var B=this.TQ.$R(1);0===B.errorCode&&(B=B.Nt)&&0<B.length&&(vb[dc]=B);continue}if(this.fCb[dc]){vb[dc]=this.fCb[dc];continue}B=this.E9[dc];if(!B||0===B.length){ya.ULS.sendTraceTag(507589124,
220,15,"The addin content list is empty for category: {0}.",dc);continue}const Hc=[];for(let ed=0;ed<B.length;ed++){const Id=B[ed],Pd=this.TQ.DH(Id.solutionId);if(!Id.addinInfo||-1===Id.addinInfo.priority||!Pd||-1===Pd.addinInfo.priority)continue;if(!Pd){Array.add(ra,Id.solutionId);continue}const Rd={};Rd.solutionId=Pd.solutionId;Rd.version=Pd.version;Rd.storeType=Pd.storeType;Rd.storeId=Pd.storeId;Rd.assetId=Pd.assetId;Rd.assetStoreId=Pd.assetStoreId;Rd.displayName=Pd.displayName;Rd.provider=Pd.provider;
Rd.description=Pd.description;Rd.targetType=Pd.targetType;Rd.height=Pd.height;Rd.width=Pd.width;Rd.iconUrl=Pd.iconUrl;Rd.webApplicationId=Pd.webApplicationId;Rd.highResolutionIconUrl=Pd.highResolutionIconUrl;Rd.addinInfo=Id.addinInfo;Array.add(Hc,Rd)}0<Hc.length&&("WN"===dc?Hc.sort((ed,Id)=>ed.addinInfo.releaseDate<Id.addinInfo.releaseDate?1:-1):"TD"===dc?Hc.sort((ed,Id)=>ed.addinInfo.diffAUP<Id.addinInfo.diffAUP?1:-1):Hc.sort((ed,Id)=>ed.addinInfo.AUP<Id.addinInfo.AUP?1:-1),vb[dc]=Hc)}this.fCb=vb;
0<ra.length&&ya.ULS.sendTraceTag(507589123,220,10,"{0} AddinIds not found in mapping: {1}, collection length: {2}",ra.length,ra.toString())}return this.fCb}aFg(B,ra,vb){return vb&&0<vb.length&&"PAIYO"!==B?vb.filter(dc=>!ra.some(Hc=>Hc.toLowerCase()===dc.solutionId.toLowerCase())):vb}PYi(){var B,ra,vb;const dc={},Hc=this.Cl.host;if("Word"===Hc)for(const ed in Wj)dc[ed]=(null===(B=Wj[ed])||void 0===B?void 0:B.map(Id=>this.TQ.DH(Id)).filter(Id=>!!Id))||[];else if("Excel"===Hc)for(const ed in Pk)dc[ed]=
(null===(ra=Pk[ed])||void 0===ra?void 0:ra.map(Id=>this.TQ.DH(Id)).filter(Id=>!!Id))||[];else if("PowerPoint"===Hc)for(const ed in El)dc[ed]=(null===(vb=El[ed])||void 0===vb?void 0:vb.map(Id=>this.TQ.DH(Id)).filter(Id=>!!Id))||[];return dc}pJi(B){let ra=null;var vb=this.JHi();if(vb&&0<Object.keys(vb).length){ra={};for(const Hc in vb){const ed=vb[Hc];ra[Hc]=this.aFg(Hc,B.map(Id=>Id.solutionId),ed)}const dc=[];for(const Hc in ra)if((B=ra[Hc])&&0<B.length){B=B.filter(ed=>!dc.some(Id=>Id.toLowerCase()===
ed.solutionId.toLowerCase()));for(vb=0;vb<B.length&&3>vb;vb++)dc.push(B[vb].solutionId);ra[Hc]=B}}else ya.ULS.sendTraceTag(507589122,220,15,"Category addins details dict is empty");return ra}CBc(){const B=this.Cl.host,ra=this.Cl.j5j;return ra?ra.split("|"):"Word"===B?["IPWAI","APID","WF"]:"Excel"===B?["IPWAI","APIC","DA"]:"PowerPoint"===B?["IPWAI","APIC","CAIP"]:[]}DBc(B,ra){var vb,dc,Hc,ed=this.Cl.host;if("Word"===ed)ed=(null===(vb=lk[B])||void 0===vb?void 0:vb.map(Id=>this.TQ.DH(Id)))||[];else if("Excel"===
ed)ed=(null===(dc=ll[B])||void 0===dc?void 0:dc.map(Id=>this.TQ.DH(Id)))||[];else if("PowerPoint"===ed)ed=(null===(Hc=Sl[B])||void 0===Hc?void 0:Hc.map(Id=>this.TQ.DH(Id)))||[];else return[];return ra?this.aFg(B,ra,ed):ed}PHi(B){if(this.Xhd[B])return this.Xhd[B];switch(B){case "APIC":return"Insert Graphics";case "APID":return"Insert Graphics";case "BBM":return"Microsoft";case "CAIP":return"Interactive tools";case "DA":return"Data analytics";case "DWT":return"Templates";case "ER":return"Education";
case "FA":return"Finance";case "IPWAI":return"AI";case "PAIYO":return"Org";case "TD":return"Trending";case "WF":return"Writing Fluently";case "WN":return"New"}return"Popular"}MAc(B){return Hj()[B]||Hj().default}}Object(ha.a)(mk,"AppFlyoutCategories",null,[]);var gi;(function(B){B.LEFT="LEFT";B.fka="MIDDLE";B.RIGHT="RIGHT"})(gi||(gi={}));Object(ha.b)("FRECarouselDirection",gi);class ml{constructor(B,ra){this.categories=B;this.M6b=ra;this.iSa=0}u1j(B){var ra,vb;let dc=!1;try{if(null===B||void 0===B?
0:B.includes("FRECarouselSwitchIcon_")){let Hc=this.iSa;const ed=B.split("_");if(3===ed.length){const Id=ed[1],Pd=parseInt(ed[2],10);if(Id===gi.fka)return;Id===gi.LEFT?(Hc--,0>Hc&&(Hc=Pd-1)):(Hc++,Hc>=Pd&&(Hc=0));this.iSa=Hc;dc=!0}}if(dc){ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchFREBanner",dataFields:Ne.a.ZOa({["controlId"]:B,["currentIndex"]:null===(ra=this.iSa)||void 0===ra?void 0:ra.toString()})});try{this.yGb="banner",null===(vb=this.M6b)||void 0===vb?void 0:vb.call(this)}finally{this.yGb=
void 0}}else ya.ULS.sendTraceTag(507527308,220,10,`Bad fre banner switch. SourceControlId=${B}`)}catch(Hc){ya.ULS.sendTraceTag(507527307,220,10,`Bad fre banner switch. SourceControlId=${B}; error=${null===Hc||void 0===Hc?void 0:Hc.toString()}`)}}v1j(){var B;this.rta=this.categories.CBc()[this.iSa];try{this.yGb="content",null===(B=this.M6b)||void 0===B?void 0:B.call(this)}finally{this.yGb=void 0}ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchFREContent",dataFields:Ne.a.ZOa({["category"]:this.rta})})}uYh(B){B.MenuSectionList.some(ra=>
ra.ControlList.some(vb=>"AddInFlyoutFREBanner"===vb.Id))||r("AddInFlyoutFREBanner",!1,-1)}mrk(B){var ra;const vb=this.categories.CBc(),dc=vb[this.iSa];B.MenuSectionList.unshift(x(dc,vb.length,this.iSa));r("AddInFlyoutFREBanner",!0,1);B={["currentIndex"]:null===(ra=this.iSa)||void 0===ra?void 0:ra.toString(),["category"]:dc};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowFREBanner",dataFields:Ne.a.xn(B)})}uTi(B,ra){if(!this.rta)return B;const vb=this.categories.DBc(this.rta,ra).map(dc=>
dc.solutionId);return B.filter(dc=>!vb.includes(dc.solutionId))}OHi(B){return this.rta?this.categories.DBc(this.rta,B):[]}MAc(){return this.rta?this.categories.MAc(this.rta):""}vak(){this.yGb||(this.rta=void 0)}m$j(){"content"===this.yGb&&setTimeout(()=>{const B=document.querySelector('[id^="FRECategoryAddin"]');if(B){B.scrollIntoView({behavior:"smooth",block:"center"});const ra=B.parentElement.parentElement.parentElement.parentElement;ra.classList.remove("addin-flyout-highlighted");ra.classList.add("addin-flyout-highlight");
setTimeout(()=>{ra.classList.add("addin-flyout-highlighted")},1E3)}},10)}get qBi(){var B;return null===(B=this.rta)||void 0===B?void 0:B.toString()}}Object(ha.a)(ml,"FRECarousel",null,[]);var Fl=a(660);class Qk{constructor(B,ra){this.avh=B;this.bvh=ra;this.Cl=new bj(La.AFrameworkApplication.ea)}L2d(){null==fa.a.instance.getItem("AddinEntryPointSurveyShowed")&&(this.Gsh=window.setTimeout(()=>{this.J_e=Object(Fl.a)();null!=this.J_e&&this.J_e.execute(B=>{if(null==fa.a.instance.getItem("AddinEntryPointSurveyShowed")){var ra=
this.LBc();this.nGi()||ra&&(!ra||"hidden"!==ra.visibility)||(B.d9a(this.avh,null),fa.a.instance.setItem("AddinEntryPointSurveyShowed","1"))}})},this.bvh))}gPa(){window.clearTimeout(this.Gsh)}LBc(){let B=null;try{const ra=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");ra&&(B=ak.a.JE(ra.parentNode.parentNode.parentNode))}catch(ra){ya.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(ra?ra.toString():""))}return B}nGi(){let B=null;try{B=document.getElementById("BackstageGetAddIns")}catch(ra){ya.ULS.sendTraceTag(508343956,
220,10,"Backstage get parent and parent get exception "+(ra?ra.toString():""))}return B}}Object(ha.a)(Qk,"FpsHelper",null,[]);class Rk{constructor(B){this.lz=null;this.Ea=B}DH(B){return this.TXh.find(ra=>ra.solutionId.toLowerCase()===B.toLowerCase())}get TXh(){if(!this.lz){const B=JSON.parse(Rk.aih);Rk.MJb(B);B.sort((ra,vb)=>ra.addinInfo.AUP<vb.addinInfo.AUP?1:-1);this.lz=B}return this.lz}static MJb(B){for(const ra of B)isNaN(ra.targetType)&&(ra.targetType=1),ra.assetId=ra.assetId||ra.solutionId,
ra.storeId=ra.storeId||"en-US",ra.storeType=ra.storeType||"omex",ra.assetStoreId=ra.assetStoreId||"omex",isNaN(ra.width)&&(ra.width=0),isNaN(ra.height)&&(ra.height=0)}}Rk.aih='[{"displayName":"RefWorks Citation Manager","solutionId":"WA104380122","version":"2.1.0.1","description":"Access your reference collection when writing for quick formatting of citations and a bibliography.","iconUrl":"https://store-images.s-microsoft.com/image/apps.65260.65124d22-f776-49df-bc00-7feb775be86b.9c8232a6-57b5-45f6-9998-520f920cffe1.a28c4b83-5b94-4239-a8b2-1dc4fdf62abd.png","licenseUrl":"https://www.proquest.com/about/terms-and-conditions.html","privacyUrl":"https://www.proquest.com/about/privacy-home.html","addinInfo":{"priority":2,"AUP":29000}},{"displayName":"SmartCite for Papers","solutionId":"WA104380917","version":"1.0.1.0","description":"Cite references and generate bibliographies automatically from your ReadCube Papers library!","iconUrl":"https://store-images.s-microsoft.com/image/apps.37206.29ea90e8-6e48-40d7-a6f6-0e3c479febca.1a063694-e16a-4c0c-a2e9-08030cb75f3f.18a6c2f3-4683-4297-be90-d077e8cc1e08.png","licenseUrl":"https://www.papersapp.com/terms","privacyUrl":"https://www.papersapp.com/privacy","addinInfo":{"priority":2,"AUP":13000}},{"displayName":"EasyBib Add-In for Office 365","solutionId":"WA104381648","version":"1.0.0.2","description":"Easily create, save, and add citations to your paper with the EasyBib Add-in for Office 365.","iconUrl":"https://store-images.s-microsoft.com/image/apps.55159.b286607a-d729-4136-bfb1-21ebed7465be.89af5759-1891-4061-882b-18cffb725610.45a13c76-1e24-435f-8539-eebc4c0177fe.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.easybib.com/company/privacy","addinInfo":{"priority":2,"AUP":5000}},{"displayName":"Mendeley Cite","solutionId":"WA104382081","version":"1.55.1.0","description":"Cite as you write. Generate citations and bibliographies and change your citation style.","iconUrl":"https://store-images.s-microsoft.com/image/apps.43392.23c5ae3a-3551-42b6-9ba6-5a9ac6c8ade4.14de091f-6544-45e8-b3a6-4a222e2ca359.f3ef8ae0-fa4a-46f7-9f22-7cb0e2e90fcd.png","licenseUrl":"https://www.mendeley.com/terms","privacyUrl":"https://www.elsevier.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":600000}},{"displayName":"PERRLA","solutionId":"WA200000199","version":"8.2.0.0","description":"Create perfect APA & MLA papers. We\u2019ve helped students write perfectly formatted papers since 1998.","iconUrl":"https://store-images.s-microsoft.com/image/apps.7448.ce605f46-4369-4795-8a16-68d19f80e425.1917fc48-bfda-4ecf-9fb8-aa43ce0dbed9.a79b9edf-f0d2-477c-b0c4-ba812278c907.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.perrlacomplete.com/PrivacyPolicy/WordAddIn","addinInfo":{"priority":2,"AUP":18000}},{"displayName":"Ref-n-Write","solutionId":"WA200001700","version":"2.0.0.0","description":"Ref-n-Write is a cross referencing and paraphrasing tool for writing research papers and theses.","iconUrl":"https://store-images.s-microsoft.com/image/apps.9837.75e7cc1b-a7e7-4ace-8efe-d60f32b31b0d.ff80fa10-c38c-4f9e-b939-658cd2ac0416.039adb78-514a-43b9-816b-c68d3326b264.png","licenseUrl":"https://www.ref-n-write.com/trial/eula","privacyUrl":"https://www.ref-n-write.com/trial/privacy-policy-of-ref-n-write-office-sharepoint-addins","addinInfo":{"priority":2,"AUP":3000}},{"displayName":"Citavi Assistant Beta","solutionId":"WA200002513","version":"2021.3.29.10","description":"The Citavi Assistant automatically formats citations and bibliographies.","iconUrl":"https://store-images.s-microsoft.com/image/apps.49030.0475a4dd-1335-4b98-9dcd-0f5f45db9022.69f86a8e-4c8d-402c-b309-0ab570f7673b.a89c32cb-b0df-4ef6-aa5e-ad19ab74e42e.png","licenseUrl":"https://citavi.com/eula","privacyUrl":"https://citavi.com/privacy","addinInfo":{"priority":2,"AUP":2000}},{"displayName":"Sciwheel","solutionId":"WA200002534","version":"6.0.0.0","description":"Cite effortlessly and format your bibliography with 7000+ styles, all without leaving Word. ","iconUrl":"https://store-images.s-microsoft.com/image/apps.53370.9d5750e6-7257-4e5e-9f38-9d2986f4b795.5095e0db-395b-4d89-8298-0231f31340b2.f4c9aecf-00d0-422f-ba8a-40f9991fa55f.png","licenseUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-download-installation-terms-and-conditions/software-license-agreement","privacyUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-privacy-notice","addinInfo":{"priority":2,"AUP":4000}},{"displayName":"Citavi Assistant","solutionId":"WA200002891","version":"2021.3.29.10","description":"The Citavi Assistant automatically formats citations and bibliographies.","iconUrl":"https://store-images.s-microsoft.com/image/apps.41528.46a7367a-a31d-4175-9c32-fc8e30e8855a.21681137-d1cf-4b73-b8fb-15b7d87b6ef1.72153cd3-7603-49c4-b7d8-6895767a69a6.png","licenseUrl":"https://citavi.com/eula","privacyUrl":"https://citavi.com/privacy","addinInfo":{"priority":2,"AUP":13000}},{"displayName":"EndNote 21 Cite While You Write\u2122 for Word Online","solutionId":"WA200005983","version":"1.2.0","description":"Insert in-text citations while simultaneously creating a bibliography with Cite While You Write\u2122","iconUrl":"https://store-images.s-microsoft.com/image/apps.29751.ac5fb94c-9f9b-453b-a5ac-fecb20593f4e.7052bc0d-7631-4821-bc17-86df446ab06d.f9287209-4488-4e0f-9b23-3030ad68d0f0.png","licenseUrl":"https://endnote.com/license","privacyUrl":"https://endnote.com/privacy","addinInfo":{"priority":2,"AUP":8000}}]';
Object(ha.a)(Rk,"CitationAddinManager",null,[]);class Sk extends ej.a{constructor(B,ra,vb,dc,Hc,ed,Id,Pd,Rd){super(!1,!1,!0);this.Oh=5;this.initializeAndShow("",()=>{this.hide()},{["id"]:"AddInStoreDialog",["bodyControls"]:{},["dataProvider"]:{["getAddinDetails"]:$d=>{$d=B.$R($d);const Ae=$d.Nt&&$d.Nt instanceof Array?$d.Nt.filter(Ke=>Ke.addinInfo&&-1!==Ke.addinInfo.priority):[];Ae.sort((Ke,Ze)=>Ze.addinInfo.AUP-Ke.addinInfo.AUP);return{["errorCode"]:$d.errorCode,["addinDetails"]:Ae,["failure"]:$d.failure}},
["getAddinDetailById"]:B.DH.bind(B)},["host"]:ra,["getCommonString"]:xc.a,["hide"]:this.hide.bind(this),["appsFlyoutGeneratorContext"]:{["host"]:vb.host,["addinFlyoutSearchDebouncingDelay"]:vb.J6e,["addinFlyoutSearchRecommendedKeyword"]:vb.K6e,["flyoutStoreExpEnabled"]:vb.fRb,["flyoutStoreExpUseLabelsEnabled"]:vb.Hzi,["flyoutStoreExpSearchWithAppSourceEnabled"]:vb.Fzi,["flyoutStoreExpUXRenderCheckerEnabled"]:vb.Gzi,["flyoutStoreExpRetryIfNotReady"]:vb.Ezi,["flyoutStoreAdvancedUXEnabled"]:vb.Dzi,["flyoutStoreFooterLabelString"]:vb.Izi},
["addinSearchApiManager"]:{["searchFromAppSource"]:dc.woe.bind(dc),["searchFromAppSourceAsync"]:dc.BNg.bind(dc),["searchFromOMEX"]:dc.xoe.bind(dc),["searchFromOMEXAsync"]:dc.CNg.bind(dc),["getAddinDetailById"]:dc.DH.bind(dc),["getRichAddinDetailFromOMEXAsync"]:dc.zWi.bind(dc),["getSuggestionsFromAppSourceAsync"]:dc.hZi.bind(dc)},["addinCommandsHandlerForStoreExp"]:{["handleInstallPopularAddInAndLaunchIt"]:Hc.xRd.bind(Hc),["handleInstallSearchAddInAndLaunchIt"]:Hc.y4i.bind(Hc),["handleLaunchAppForOfficeDialog"]:Hc.F4i.bind(Hc)},
["appFlyoutCategories"]:{["getContentExpCategoryAddinsRecord"]:ed.pJi.bind(ed),["getStoreExpCategoryAddinsRecord"]:ed.PYi.bind(ed),["getCategoryTitle"]:ed.MAc.bind(ed)},["telemetryForStoreExp"]:{["sendULSInfoTraceTag"]:Id.GCk.bind(Id),["sendULSWarningTraceTag"]:Id.HCk.bind(Id),["sendULSErrorTraceTag"]:Id.FCk.bind(Id),["sendOtelTelemetry"]:Id.eCk.bind(Id),["getPrivacyCompliantId"]:Id.Pga.bind(Id)},["onDialogOpen"]:Pd,["onDialogClose"]:Rd})}}Object(ha.a)(Sk,"AddInStoreDialog",ej.a,[]);class Gl{constructor(){}GCk(B){ya.ULS.sendTraceTag(507343232,
220,50,B)}HCk(B){ya.ULS.sendTraceTag(507343203,220,15,B)}FCk(B){ya.ULS.sendTraceTag(507343202,220,10,B)}eCk(B,ra){ge.a.sendTelemetryEvent({name:B,dataFields:Ne.a.xn(ra)})}Pga(B){return Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,B.storeType,B.assetId,null,null,B.storeId)}}Object(ha.a)(Gl,"TelemetryForStoreExp",null,[]);class nl{constructor(B,ra,vb,dc,Hc,ed,Id,Pd,Rd,$d,Ae){Pd=void 0===Pd?{}:Pd;this.M6b=$d;this.Zbd={};this.vgc={};this.QNe=0;this.NDb=null;this.zBb={};this.hSa=void 0;this.LKe=
this.a0e=this.cIe=this.Nab=null;this.u_e=0;this.Qdb="All";this.Bfd=[];this.Odb="";this.mkc=null;this.MYe=100;this.pkc=!1;this.OGb=[];this.Hbd=new Map;this.Q4a=(Ke,Ze)=>{this.Aba?this.Zjk(Ze):(this.Yjk(Ze),!this.Cl.ebc&&this.$He&&this.$He.Q4a(Ke,Ze))};this.TQ=ra;this.jta=null;this.Yph=dc;this.Ath=Hc;this.$He=void 0===Id?null:Id;this.Ea=(void 0===ed?null:ed)||La.AFrameworkApplication.ea;this.Cl=new bj(this.Ea);this.iPe=Rd;this.ASa=new mk(this.Cl,ra,Pd);this.TQ.cBa(this.Q4a);(null===appChrome||void 0===
appChrome?0:appChrome.addInApi)&&appChrome.addInApi.loadOfficeAddInIcons();this.Cl.zGh&&this.vie("OpenCloseChangedTelemetry",(Ke,Ze)=>{ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutOpenCloseChanged",dataFields:Ne.a.ZOa({["PerformanceNow"]:performance.now(),["DateNow"]:new Date,["IsOpened"]:Ke,["OpenDuration"]:Ze})})});this.Cl.b0&&this.jEg();d((Ke,Ze)=>{this.Hbd.forEach(cg=>{cg(Ke,Ze)})}).catch(Ke=>{ya.ULS.sendTraceTag(507799683,220,15,"Failed to listen flyout open close event: "+
((null===Ke||void 0===Ke?void 0:Ke.toString())||void 0))});if(this.Cl.b0||this.Cl.UXh||this.Cl.fRb)this.Nab=new jl(this.Ea,this.Ea.Ya("Application")),this.MYe=this.Cl.J6e;this.Cl.fRb&&(this.cIe=Ae,this.a0e=new Gl);this.Cl.F6e&&(this.LKe=new kl,this.LKe.Iyj());this.Cl.afa&&(this.Oka=new ml(this.ASa,$d));this.Cl.xGh&&ba();this.Cl.XId&&(this.NDb=new Qk("AddinBackstageFeedbackSurvey",this.Cl.Lzi))}get j3h(){return this.vgc}get Ppj(){const B=document.querySelector('[data-unique-id="Overflow-InsertAddInFlyout"]');
return B?"hidden"!==window.getComputedStyle(B).visibility:!1}vie(B,ra){this.Hbd.set(B,ra)}y5g(B){this.Hbd.delete(B)}Yjk(B){if(B.Nt)for(let ra=0;ra<B.Nt.length;ra++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+B.Nt[ra].solutionId,B.Nt[ra].iconUrl);else 0===B.errorCode&&ya.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get Aba(){return!!this.Ea&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}LNd(B){const ra=this.Cl.M7b,vb=ra?"more"===B?"AddinFlyoutMoreButton":"AddinFlyoutLessButton":"AddinFlyoutMoreButton",dc=ra?"more"===B?Object(xc.a)("AddinsFlyoutSeeAllButtonText"):Object(xc.a)("AddinsFlyoutSeeLessButtonText"):Object(xc.a)("AddinsFlyoutSeeAllButtonText");B=ra?"more"===B?Object(xc.a)("AddinsPickerGalleryButtonMoreArialText"):Object(xc.a)("AddinsPickerGalleryButtonLessArialText"):Object(xc.a)("AddinsPickerGalleryButtonMoreArialText");return Object.assign(new hk.a,{Id:vb,ExternalId:vb,
Icon:"AllApps_16",Command:this.Ath,LabelText:dc,FullIconStyle:{root:{maxWidth:"16px",maxHeight:"16px",minWidth:"16px",minHeight:"16px",border:"1px solid var(--border-color, #c8c8c8)",borderRadius:"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:B})}NQi(B,ra){var vb=void 0===vb?La.AFrameworkApplication.isRtl:vb;vb={["root"]:{["width"]:"32px",["height"]:"32px",["border-radius"]:"6px",["overflow"]:"hidden",["padding"]:"7px",["border"]:"1px solid var(--border-color, #c8c8c8)",
["direction"]:vb?"ltr":void 0}};return Object.assign(new hk.a,{Id:ra,ExternalId:ra,Icon:"AddinFlyoutControl"+B.solutionId,Command:this.Yph,LabelText:B.displayName,Role:"menuitem",FullIconStyle:vb,Alt:B.description})}VJf(B,ra){B=this.UJf("MRUAddinsGalleryControl",B,ra);return Object.assign(new M.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[B],Title:Object(xc.a)("MyAddinSection")})}UJf(B,ra,vb,dc){dc=void 0===dc?this.Cl.M7b:dc;const Hc=v(vk,{SectionId:B+"Section",GalleryButtons:ra.map(ed=>
this.NQi(ed,this.WNi(ed)))});dc&&3<ra.length?Hc.Collapse=new Rj(2,this.LNd("more"),this.LNd("less")):vb&&Hc.GalleryButtons.push(this.LNd("more"));return v(gk.a,{Id:B,ExternalId:B,GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",marginLeft:"12px",width:"100%",maxWidth:"unset"},["inner"]:{margin:"-4px",marginLeft:"0px",maxWidth:"333px",minWidth:"333px"}},["galleryButtonInExpanded"]:{["root"]:{width:100,height:100,backgroundColor:"transparent"},["flexContainer"]:{flexDirection:"column"},["label"]:{marginTop:"4px",
maxWidth:"86px",fontSize:"12px",textOverflow:"ellipsis"}}},Width:3,Type:4,GallerySections:[Hc],GalleryContextMenu:this.Cl&&this.Cl.F6e?{["primaryMenuId"]:"AddInFlyoutMRUContextMenu"}:null})}YQi(){const B=v(M.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[v($k.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:Object(xc.a)("AddinsPickerFooterButtonMoreArialText")})]});appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",Object(xc.a)("AddinPickerButtonMore")));
return B}get jDf(){var B;return null===(B=this.Oka)||void 0===B?void 0:B.qBi}get NNg(){return this.Qdb}LHi(){this.Qdb="All";k(`${"AddinFREButton"}${this.Qdb}`);var B=["All",...this.ASa.CBc()];B=v(vk,{SectionId:"AddinFlyoutButtonGroupSection",GalleryButtons:B.map(ra=>{const vb=this.ASa.PHi(ra);return Object.assign(new hk.a,{Id:"AddinFREButton"+ra,ExternalId:"AddinFREButton"+ra,Command:Ag.a.dac.toString(),LabelText:vb,FullIconStyle:{["root"]:{position:"absolute",["border-radius"]:"10px",width:"100%",
height:"100%"}},Role:"tab",Alt:vb})})});B=v(gk.a,{Id:"AddinFlyoutButtonGroup",ExternalId:"AddinFlyoutButtonGroup",GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",width:"100%",maxWidth:"unset"},["inner"]:{Iol:2,maxWidth:"333px",minWidth:"333px",flexFlow:"nowrap",paddingLeft:15}},["galleryButtonInExpanded"]:{["root"]:{backgroundColor:"transparent",width:"unset",height:"unset",borderRadius:"10px",borderColor:"var(--border-color)",borderWidth:"1px !important",padding:"4px 8px"},["flexContainer"]:{},
["label"]:{fontSize:"12px",textOverflow:"ellipsis"}}},Type:4,GallerySections:[B],DismissHostingSurfaceOnExecute:!1});return v(M.a,{ControlList:[B]})}vZk(B){var ra;if(this.Qdb!==B){var vb=appChrome.selectors.getFlyoutAnchorMenuItems("InsertAddInFlyout");"All"===this.Qdb&&(this.Bfd=Object.entries(vb).filter(Pd=>{var [Rd,$d]=Pd;return"MultiActionButtonModel"===$d&&Rd.startsWith("AddInsListItem")}).map(Pd=>{[Pd]=Pd;return Pd}));this.Qdb=B;k(`${"AddinFREButton"}${B}`);var dc=-1!==Object.keys(vb).indexOf("SearchAddinInFlyout")||
this.Cl.b0?appChrome.api.menuSection(["SearchAddinInFlyout"],""):void 0,Hc=appChrome.api.menuSection(["InsertMoreAddInsFromFooter"],""),ed="All"===B?this.Bfd:null!==(ra=this.ASa.DBc(B).map(Pd=>`AddInsListItem${Pd.solutionId.toLowerCase()}`))&&void 0!==ra?ra:[],Id=new Set(ed);ra=this.Bfd.filter(Pd=>Id.has(Pd));ra=[appChrome.api.menuSection(["AddinFlyoutButtonGroup",...ra],"")];this.Cl.afa&&(ed=Object.keys(vb).filter(Pd=>0<=Pd.indexOf("FRECarousel")||0<=Pd.indexOf("FREBanner")),0<(null===ed||void 0===
ed?void 0:ed.length)&&ra.unshift(appChrome.api.menuSection(ed,"")));"MRUAddinsGalleryControl"in vb&&ra.unshift(appChrome.api.menuSection(["MRUAddinsGalleryControl"],Object(xc.a)("MyAddinSection")));vb=appChrome.actions.updateMenu("InsertAddInFlyout",ra,void 0,void 0,void 0,void 0,void 0,Hc,!0,dc);appChrome.api.dispatch(vb);ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",dataFields:Ne.a.ZOa({["Category"]:B})})}}P3i(B){this.Oka.u1j(B)}Q3i(){this.Oka.v1j()}aRi(B,ra){var vb,
dc,Hc;const ed=[],Id=[],Pd=this.TQ.$R(0);Array.addRange(Id,Pd.Nt);const Rd=this.TQ.$R(1);Array.addRange(Id,Rd.Nt);B||Id.sort((oh,Hg)=>{oh=Ve.d(oh.displayName);Hg=Ve.d(Hg.displayName);return wc.a.localeCompare(oh,Hg)});null===(vb=this.iPe)||void 0===vb?void 0:vb.addNotification(Id);this.pbk(Id);let $d=Id.length,Ae=!1;!this.Cl.M7b&&3<$d&&($d=2,Ae=!0);let Ke=[];vb=null;this.Cl.Nyb||this.Aba||!this.jta?(vb=this.TQ.$R(2),0!==vb.errorCode&&5!==vb.errorCode||vb.Nt.forEach(oh=>{-1!==oh.addinInfo.priority&&
Ke.push(oh)})):Ke=this.jta;ya.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",$d,yj.a[Pd.errorCode],Pd.Nt.length,yj.a[Rd.errorCode],Rd.Nt.length,this.Cl.Nyb?yj.a[vb.errorCode]:"undefined",Ke.length);this.E4.r9f($d,Pd,Rd,vb);this.Cl.XId&&this.NDb&&this.NDb.L2d();const Ze=[],cg=[];B&&(Array.addRange(Ze,this.Owi(this.Odb,Id)),Array.addRange(cg,this.U9e(this.OGb,Id)));const Vf=Object.assign(new M.a,{Id:"HeaderSection",ControlsId:"HeaderSection.Controls",
ControlList:[]}),Xf=Object.assign(new Ik.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuHeaderSection:this.Cl.b0?Vf:void 0,MenuFooterSection:this.YQi(),UpdateDynamically:!0,IsFlexLayout:!0});if((2===Pd.errorCode||this.Cl.Nyb&&2===vb.errorCode)&&!Id.length){ed.push("storeDisabled");ya.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit");var Pf=this.fAc({iconName:"StoreDisabled",xFc:Object(xc.a)("AddinPickerDisableError")});Array.add(Xf.MenuSectionList,Pf)}else if(3!==Pd.errorCode||
this.E4.OWg(Pd)||3!==Rd.errorCode)if(4!==Pd.errorCode||Id.length){const oh=0>=Ze.length&&0>=cg.length;if(this.Cl.b0){const Hg=B?String.format(oh?null!==(dc=Object(xc.a)("AddInSearchNoResultsAriaText"))&&void 0!==dc?dc:"":null!==(Hc=Object(xc.a)("AddInSearchResultsAriaText"))&&void 0!==Hc?Hc:"",this.Odb):null;Array.add(Vf.ControlList,this.ZDi(Hg))}if(B)oh&&this.h9h(Xf),0<Ze.length&&this.E8h(Xf,Ze),0<cg.length&&this.O8h(Xf,cg),Pf={},Pf.MRUAddins=Ze.map(Hg=>n(Hg)),Pf.MoreAddins=cg.map(Hg=>n(Hg)),Pf.HasResults=
!oh,ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SearchingAddinsFromFlyout",dataFields:Ne.a.xn(Pf)});else{if(this.Cl.fRb&&0===Id.length&&!ra&&!this.Ppj)return this.eXg(),Object.assign(new Ik.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[this.VJf([])],UpdateDynamically:!0});0<$d?(Xf.MenuSectionList.push(this.VJf(Id.slice(0,$d),Ae)),La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(B={["solutionIds"]:Rd.Nt.map(Ah=>n(Ah))},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowAdminAddinFromFlyout",
dataFields:Ne.a.xn(B)}))):this.Cl.afa&&this.Oka.mrk(Xf);let Hg=this.Aba?this.q_i(Ke,Id):this.U9e(Ke,Id);Hg&&0!==Hg.length||(ed.push("emptyPopularAddins"),ya.ULS.sendTraceTag(507523101,220,15,"The popular addins list is empty"));Hg=Hg.filter(Ah=>!!Ah).slice(0,30);if(this.Cl.zua){B=this.ASa.CBc();for(var Kg of B)B=this.ASa.DBc(Kg,Id.map(Ah=>Ah.solutionId)),Hg=Hg.concat(B.filter(Ah=>!Hg.some(mi=>mi.solutionId===Ah.solutionId)));ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",
dataFields:Ne.a.ZOa({["Category"]:"All"})})}const Gh=this.Cl.Wqd?null===(Pf=F(this.Cl.I6e,this.Cl.host))||void 0===Pf?void 0:Pf[0]:void 0;Gh&&(Hg=Hg.filter(Ah=>{var mi;return Gh!==(null===(mi=Ah.solutionId)||void 0===mi?void 0:mi.toLowerCase())}));const xi=this.Cl.Vqd?F(this.Cl.I6e,this.Cl.host):void 0;0<(null===xi||void 0===xi?void 0:xi.length)&&(Hg=Hg.filter(Ah=>{var mi;return!xi.includes(null===(mi=Ah.solutionId)||void 0===mi?void 0:mi.toLowerCase())}));Pf=[];this.Cl.afa&&(this.Oka.vak(),Hg=this.Oka.uTi(Hg,
Id.map(Ah=>Ah.solutionId)),Pf=this.Oka.OHi(Id.map(Ah=>Ah.solutionId)));Kg=this.aUi(Hg);this.Cl.zua&&(Xf.MenuSectionList.push(this.LHi()),Kg.Title="");B=this.TQ.DH(Gh);this.Cl.Wqd&&!this.Cl.zua&&B?J(B,Xf,Kg,Pd.Nt,Rd.Nt,this.Cl.b0,this.Cl.host):this.Cl.Vqd&&!this.Cl.zua&&0<(null===xi||void 0===xi?void 0:xi.length)?(B=xi.map(Ah=>this.TQ.DH(Ah)),N(B,Xf,Kg,Pd.Nt,Rd.Nt,this.Cl.b0,this.Cl.host)):Xf.MenuSectionList.push(Kg);0<Pf.length&&(Pf=v(M.a,{Id:"CategoryAddInListSection",ControlsId:"CategoryAddInListSection.Controls",
ControlList:Pf.map(Ah=>this.tAc("FRECategoryAddin"+Ah.solutionId.toLowerCase(),Ah)),Title:this.Oka.MAc()}),Xf.MenuSectionList.push(Pf),this.Oka.m$j())}}else ed.push("serviceDisabled"),ya.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),Pf=this.fAc({iconName:"StoreDisabled",xFc:Object(xc.a)("AddinPickerServiceDisconnectedError")}),Array.add(Xf.MenuSectionList,Pf);else ed.push(this.E4.mJf(Pd,Rd)),ya.ULS.sendTraceTag(509687426,220,10,"dataProvider invokeFailure error hit"),
Pf=this.fAc({iconName:"Common",xFc:Object(xc.a)("AddinPickerGeneralError")}),Array.add(Xf.MenuSectionList,Pf);this.Cl.afa&&this.Oka.uYh(Xf);this.Cl.Wqd&&Q(Xf);this.Cl.Vqd&&O(Xf);this.yXh();0===Xf.MenuSectionList.length&&(Xf.IsFlexLayout=!1,ed.push("emptyMenuSection"),ya.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));this.E4.Q0g&&ya.ULS.sendTraceTag(508047442,220,15,`${ed.join("|")}`);this.E4.m9f&&this.E4.q9f(Id.length,ed,Pd,Rd,vb);return Xf}yXh(){window.setTimeout(()=>{var B=
document.querySelector('#Ribbon-InsertAddInFlyoutDropdown > .ms-FocusZone > div[class^="root"] > div[class^="container"]');B&&(B=B.scrollTop,0<B&&(this.Cl.XId&&this.NDb&&this.NDb.gPa(),ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ScrollableListView",dataFields:Ne.a.xn({["scrollTopValue"]:B.toString()})})))},6E4)}aUi(B){const ra=v(M.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:this.Cl.zua?B.map(vb=>this.tAc("AddInsListItem"+vb.solutionId.toLowerCase(),
vb)):B.map((vb,dc)=>this.tAc("PopularAddInsListItem"+dc,vb)),Title:Object(xc.a)("PopularAddins")});La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(B={["solutionIds"]:B.map(vb=>n(vb))},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",dataFields:Ne.a.xn(B)}));return ra}tAc(B,ra){const vb={default:"AddinFlyoutControl"+ra.solutionId},dc=this.ARb(ra),Hc=[];var ed=ra.solutionId.toLowerCase();ed=Object.assign(new Nk,
{text:Object(xc.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+ed});Array.add(Hc,ed);return Object.assign(new kk.a,{Id:B,ExternalId:B,CommandId:B,CommandIdMapped:Ag.a.D3a.toString(),iconSet:vb,SecondaryLabel:null,Details:[],Label:ra.displayName,ActionText:B.includes("PAIYO_CategoryAddinListItem")?Object(xc.a)("AddinListOpen"):Object(xc.a)("AddinListAdd"),Description:ra.description,Links:Hc,ActionId:B+"Add",ActionIdMapped:Ag.a.qya.toString(),ActionCommandValueId:dc,
CommandValueId:dc})}ARb(B){return this.Aba?String.format("{0}#{1}",B.solutionId,B.storeId):B.solutionId}OJa(B){if(!B)return null;var ra=B.split("#");if(1!==ra.length&&2!==ra.length)return ya.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;B=ra[0].trim();ra=2===ra.length?ra[1].trim():La.AFrameworkApplication.uiCulture;return this.TQ.DH(B,ra)}gXi(B){return B?this.Nab.DH(B):null}Iff(B){return B&&B.hasOwnProperty("solutionId")&&B.hasOwnProperty("version")&&
B.hasOwnProperty("storeType")&&B.hasOwnProperty("storeId")&&B.hasOwnProperty("assetId")&&B.hasOwnProperty("assetStoreId")&&B.hasOwnProperty("targetType")&&B.hasOwnProperty("displayName")&&B.hasOwnProperty("width")&&B.hasOwnProperty("height")?!0:!1}HBf(B){return new Promise((ra,vb)=>{if(this.Iff(B))return ra(B);const dc=(new Date).getTime();this.Nab.xoe("",(Hc,ed)=>Hc?1!==ed.length||ed[0].solutionId.toLowerCase()!==B.solutionId.toLowerCase()?vb(Error("The search add-in and result add-in don't match.")):
this.Iff(ed[0])?ra(ed[0]):vb(Error("The result add-in details are still not ready for install.")):vb(Error("Failed to query add-in details for install.")),dc,B.solutionId)})}WNi(B){if(!(B.solutionId in this.Zbd)){const ra="AddinGalleryButton"+this.QNe.toString();this.Zbd[B.solutionId]=ra;B=this.ARb(B);this.vgc[ra]=B;this.vgc[ra+"Add"]=B;this.QNe++;return ra}return this.Zbd[B.solutionId]}gQd(B){return B?this.vgc[B]:null}fAc(B){var {iconName:ra,xFc:vb,$wl:dc=!1,Lxl:Hc=Object(xc.a)("AddinPickerTryAgain"),
Kxl:ed="ReloadAddInPicker",ool:Id="ReloadAddInPicker"}=B;B=Object.assign(new M.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});let Pd=null;Pd=vb===Object(xc.a)("AddinPickerDisableError")&&this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?Object.assign(new Vj.a,{Id:"ErrorView",ExternalId:"ReloadAddInPickerStoreDisabled",IconName:ra,Label:vb,RetryButtonTitle:dc?Object(xc.a)("AddinPickerTryAgain"):"",OnRetryCommandId:"ReloadAddInPicker",
AriaDescription:"StoreDisabled"===ra?vb:Object(xc.a)("AddinPickerTryAgainAriaLabel"),LinkText:Object(xc.a)("AddinPickerDisableErrorDocumentText"),LinkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",La.AFrameworkApplication.uiCulture),OnLinkClicked:()=>{ya.ULS.sendTraceTag(507875925,220,15,"User has clicked link on add-in picker error view")}}):
Object.assign(new Vj.a,{Id:"ErrorView",ExternalId:Id,IconName:ra,Label:vb,RetryButtonTitle:dc?Hc:"",OnRetryCommandId:ed,AriaDescription:"StoreDisabled"===ra?vb:Object(xc.a)("AddinPickerTryAgainAriaLabel")});Array.add(B.ControlList,Pd);return B}U9e(B,ra){var vb=new Ef.a;for(let dc=0;dc<B.length;dc++)vb.add(B[dc]);if(this.Cl.Nyb||!this.jta)30<vb.count&&(vb=u(vb,(new Date).getDate())),this.jta=vb.toArray();for(B=0;B<this.jta.length;B++)for(vb=0;vb<ra.length;vb++)if(this.jta[B].solutionId.toLowerCase()===
ra[vb].solutionId.toLowerCase()){Array.remove(this.jta,this.jta[B--]);break}return this.jta}bUi(B){var ra=30,vb=(new Date).getDate();ra>B.length&&(ra=B.length);var dc=new xj(vb);for(vb=new Set;vb.size<ra;){const Hc=dc.next(B.length);vb.add(Hc)}for(ra=0;ra<B.length;ra++)dc=B[ra].addinInfo,vb.has(ra)?dc.AUP*=20:dc.AUP=1===dc.priority?4*dc.AUP:2===dc.priority?2*dc.AUP:1*dc.AUP;B.sort((Hc,ed)=>Hc.addinInfo.AUP<ed.addinInfo.AUP?1:-1);return B}q_i(B,ra){B=B.filter(vb=>!ra.some(dc=>dc.solutionId.toLowerCase()===
vb.solutionId.toLowerCase()));return this.bUi(B).slice(0,30)}Zjk(B){if(0===B.errorCode||2===B.gM&&5===B.errorCode)B.Nt?this.ZDg(B.Nt):ya.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${dj.a[B.gM]}`)}ZDg(B){return Promise.all(B.map(ra=>{var vb,dc;if(ra&&ra.solutionId&&ra.iconUrl)return appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+ra.solutionId,ra.iconUrl);ya.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",
null!==(vb=null===ra||void 0===ra?void 0:ra.solutionId)&&void 0!==vb?vb:"null",null!==(dc=null===ra||void 0===ra?void 0:ra.iconUrl)&&void 0!==dc?dc:"null");return Promise.resolve()}))}ZDi(B){var ra;const vb=this.Cl.K6e,dc=vb?String.format(null!==(ra=Object(xc.a)("AddInSearchBoxRecommendationPlaceholder"))&&void 0!==ra?ra:"",vb):Object(xc.a)("AddInSearchBoxPlaceholder");return Object.assign(new Dl.a,{ExternalId:"SearchAddinInFlyout",Label:dc,ShowIcon:!0,Underlined:!0,Value:this.Odb,ResultAriaLiveText:B,
OnChangeCommandId:"SearchAddinInFlyout"})}E8h(B,ra){const vb=Object.assign(new M.a,{Id:"MRUAddinsSearchResutlsSection",ControlsId:"MRUAddinsSearchResutlsSection.Controls",ControlList:[]});Array.add(B.MenuSectionList,vb);B=this.UJf("MRUAddinsSearchResutlsGalleryControl",ra,!1,!1);Array.add(vb.ControlList,B)}O8h(B,ra){const vb=Object.assign(new M.a,{Id:"PopularAddinsListSearchResutlsSection",ControlsId:"PopularAddinsSearchResutlsSection.Controls",ControlList:[],Title:Object(xc.a)("AddInSearchResultsDivider")});
for(let dc=0;dc<ra.length;dc++)vb.ControlList.push(this.tAc("PopularAddinsSearchResultsItem"+dc,ra[dc]));Array.add(B.MenuSectionList,vb)}h9h(B){if(this.Cl.yGh){var ra=f(Object(xc.a)("AddInSearchNoResultsLink1"),"https://aka.ms/Officeaddins"),vb=f(Object(xc.a)("AddInSearchNoResultsLink2"),"https://aka.ms/OfficeAddinOverview");ra="Excel"===this.Cl.host?String.format(Object(xc.a)("AddInSearchNoResultsDescription2"),ra,vb):String.format(Object(xc.a)("AddInSearchNoResultsDescription3"),vb);ra=v(Vj.a,{Id:"ErrorView",
ExternalId:"ReloadAddInPicker",IconName:"NoSearchResultsV2",Title:Object(xc.a)("AddInSearchNoResultsTitle"),IsNoResultView:!0,LinkText:`${Object(xc.a)("AddInSearchNoResultsDescription1")} ${ra}`});vb=v(M.a,{Id:"ErrorViewSection",ControlsId:"ErrorViewSection.Controls",ControlList:[]});Array.add(vb.ControlList,ra);Array.add(B.MenuSectionList,vb)}else ra=this.fAc({iconName:"NoSearchResults",xFc:Object(xc.a)("AddInSearchNoResultsHint")}),Array.add(B.MenuSectionList,ra)}Owi(B,ra){const vb=B.toLocaleLowerCase();
B=ra.filter(dc=>{this.zBb[dc.solutionId]||(this.zBb[dc.solutionId]=dc.displayName.toLocaleLowerCase());return this.zBb[dc.solutionId].includes(vb)});B.sort((dc,Hc)=>this.zBb[dc.solutionId].indexOf(vb)-this.zBb[Hc.solutionId].indexOf(vb));return B}aAk(B){const ra=this;return xo(function*(){ra.OGb=ra.Cl.BGh?yield ra.Nab.CNg(B):yield ra.Nab.BNg(B);yield ra.ZDg(ra.OGb)})}bAk(B){this.Odb=B;appChrome.api.dispatch(appChrome.actions.updateSearchBoxValue("SearchAddinInFlyout",B));this.mkc&&window.clearTimeout(this.mkc);
this.mkc=window.setTimeout(()=>{var ra;this.mkc=null;B?this.aAk(B).catch(()=>{this.OGb=[];ya.ULS.sendTraceTag(507577680,220,10,"Failed to call search addins API")}).finally(()=>{var vb;this.Odb===B&&(this.dgg=!0,null===(vb=this.M6b)||void 0===vb?void 0:vb.call(this))}):(this.dgg=!1,null===(ra=this.M6b)||void 0===ra?void 0:ra.call(this))},this.MYe)}set dgg(B){this.Cl.b0||(this.pkc=!1);this.pkc=B}get Jbi(){let B=!1;this.pkc&&(this.pkc=!1,B=this.Cl.b0);B||(this.Odb="",this.OGb=[]);return B}jEg(){this.vie("SetFocusToSearchBox",
B=>{const ra=document.getElementById("Ribbon-InsertAddInFlyoutDropdown")||document.getElementById("InsertAddInFlyoutMenuId");ra&&B&&ra.addEventListener("focus",()=>{var vb;return null===(vb=document.getElementById("SearchAddinInFlyout"))||void 0===vb?void 0:vb.focus()},{once:!0})})}o9j(B){if(B)try{B.MenuItems=this.aRi(this.Jbi,B.IsShadowMenuOpen)}catch(ra){ya.ULS.sendTraceTag(509687425,220,10,`GetReactGalleryMenu hit exception ${ra.message}; stack: ${ra.stack}`)}else ya.ULS.sendTraceTag(509687424,
220,10,"PopulateMenu menuProps is null")}eXg(){this.y5g("SetFocusToSearchBox");this.vie("SetFocusToStoreDialog",B=>{B&&w()});new Sk(this.TQ,this.Cl.host,this.Cl,this.Nab,this.cIe,this.ASa,this.a0e,this.p1j.bind(this),this.o1j.bind(this))}p1j(B,ra){this.u_e=B;ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAddInStoreDialog",dataFields:Ne.a.ZOa({["IsDataProviderReady"]:ra})})}o1j(B,ra,vb,dc){this.y5g("SetFocusToStoreDialog");this.Cl.b0&&this.jEg();ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.CloseAddInStoreDialog",
dataFields:Ne.a.ZOa({["OpenDuration"]:B-this.u_e,["IsDataProviderReady"]:ra,["IsDialogRenderReady"]:vb,["DialogRenderTime"]:dc})})}dispose(){}pbk(B){var ra;const vb=null===(ra=this.iPe)||void 0===ra?void 0:ra.SVa;B.sort((dc,Hc)=>{dc=null===vb||void 0===vb?void 0:vb.includes(dc.solutionId);Hc=null===vb||void 0===vb?void 0:vb.includes(Hc.solutionId);return dc&&!Hc?-1:!dc&&Hc?1:0})}get E4(){this.hSa||(this.hSa=new il("Flyout",this.Ea));return this.hSa}}Object(ha.a)(nl,"AppsFlyoutGenerator",null,[2]);
var Ti=a(91),wk;(function(B){B.til="APIC";B.uil="APID";B.Iil="BBM";B.Til="CAIP";B.hjl="DA";B.kjl="DWT";B.Jjl="ER";B.Ujl="FA";B.jkl="IPWAI";B.ill="PAIYO";B.eml="TD";B.zml="WF";B.qml="WN"})(wk||(wk={}));Object(ha.b)("AddinCategoryType",wk);const nk={["TD"]:[{solutionId:"wa200004805",addinInfo:{diffAUP:55500}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005502",addinInfo:{AUP:7758,
diffAUP:1900}},{solutionId:"wa102957665",addinInfo:{AUP:42189,diffAUP:1E5}},{solutionId:"wa104379220",addinInfo:{AUP:3017,diffAUP:1E5}},{solutionId:"wa200004935",addinInfo:{AUP:1948,diffAUP:1E5}}],["WN"]:[{solutionId:"wa200006017",addinInfo:{releaseDate:16951392E5}},{solutionId:"wa200006008",addinInfo:{releaseDate:169488E7}},{solutionId:"wa200005960",addinInfo:{releaseDate:16938432E5}},{solutionId:"wa200005817",addinInfo:{releaseDate:16886592E5}},{solutionId:"wa200005702",addinInfo:{releaseDate:16891776E5}},
{solutionId:"wa200005782",addinInfo:{AUP:52,releaseDate:1690128E6}},{solutionId:"wa200005777",addinInfo:{AUP:19,releaseDate:16893504E5}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005669",addinInfo:{AUP:248,releaseDate:16874496E5}}]},Tk={["PAIYO"]:[],["BBM"]:[{solutionId:"wa102957661",addinInfo:{AUP:14891}},{solutionId:"wa104104476",addinInfo:{AUP:14404}},{solutionId:"wa104381701",
addinInfo:{AUP:9652}},{solutionId:"wa104379629",addinInfo:{AUP:4E3}},{solutionId:"wa104381504",addinInfo:{AUP:1820}},{solutionId:"wa200003696",addinInfo:{AUP:1707}},{solutionId:"wa104380330",addinInfo:{AUP:793}},{solutionId:"wa104099688",addinInfo:{AUP:404}},{solutionId:"wa200005702",addinInfo:{AUP:68}}]},Hl={["IPWAI"]:[{solutionId:"wa200005271",addinInfo:{AUP:12195}},{solutionId:"wa200004935",addinInfo:{AUP:1948,diffAUP:1E5}},{solutionId:"wa200001584",addinInfo:{AUP:2278}},{solutionId:"wa200005107",
addinInfo:{AUP:451}},{solutionId:"wa200005281",addinInfo:{AUP:595}},{solutionId:"wa200005333",addinInfo:{AUP:101}},{solutionId:"wa200005502",addinInfo:{AUP:7758,diffAUP:1900}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005669",addinInfo:{AUP:248,releaseDate:16874496E5}}],["APIC"]:[{solutionId:"wa102957665",addinInfo:{AUP:42189,diffAUP:1E5}},{solutionId:"wa104381973",
addinInfo:{AUP:55837}},{solutionId:"wa104051163",addinInfo:{AUP:1643}},{solutionId:"wa104221182",addinInfo:{AUP:2980}},{solutionId:"wa104104476",addinInfo:{AUP:13287}},{solutionId:"wa200004688",addinInfo:{AUP:1260}},{solutionId:"wa104379169",addinInfo:{AUP:69}},{solutionId:"wa103147117",addinInfo:{AUP:89}},{solutionId:"wa200004179",addinInfo:{AUP:1072}},{solutionId:"wa104380194",addinInfo:{AUP:1245}},{solutionId:"wa200003220",addinInfo:{AUP:192}},{solutionId:"wa200004687",addinInfo:{AUP:226}}],["DA"]:[{solutionId:"wa200002503",
addinInfo:{AUP:461}},{solutionId:"wa200000018",addinInfo:{AUP:2210}},{solutionId:"wa200000169",addinInfo:{AUP:1962}},{solutionId:"wa104381841",addinInfo:{AUP:1010}},{solutionId:"wa200003784",addinInfo:{AUP:875}},{solutionId:"wa104381807",addinInfo:{AUP:308}},{solutionId:"wa104380711",addinInfo:{AUP:357}},{solutionId:"wa200000025",addinInfo:{AUP:1058,diffAUP:4600}},{solutionId:"wa200005782",addinInfo:{AUP:52,releaseDate:1690128E6}},{solutionId:"wa200005777",addinInfo:{AUP:19,releaseDate:16893504E5}}],
["FA"]:[{solutionId:"wa104379220",addinInfo:{AUP:3017,diffAUP:1E5}},{solutionId:"wa104381859",addinInfo:{AUP:380}},{solutionId:"wa104381717",addinInfo:{AUP:217}},{solutionId:"wa200003692",addinInfo:{AUP:295}},{solutionId:"wa104381695",addinInfo:{AUP:299}},{solutionId:"wa104380978",addinInfo:{AUP:347}}]};class xk{constructor(B,ra,vb,dc,Hc,ed,Id,Pd){Id=void 0===Id?null:Id;this.WA=Pd;this.disposed=!1;this.$mc=this.foc=null;this.lJb=0;this.insertTab="Insert";this.homeTab="Home";this.R_f=this.Qte=!1;this.yzi=
1E3;this.Jzi="AddinFlyoutFeedbackSurvey";this.Kzi=15E3;this.ste=!0;this.Paf=!1;this.xSh=La.AFrameworkApplication.ea.ka("IsNewStringEnabled")?`[{"title":"${CommonUiStrings.AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUiStrings.AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUiStrings.AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`:
`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`;
this.K2i=(Rd,$d,Ae,Ke)=>{if(Rd){if(Rd=this.OJa(Rd,Ke))Rd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.solutionId,Rd.storeType,Rd.assetId,Rd.storeId)},Rd.href=$d,Rd.UILocation=Ae,Rd.ControlId=Ke,ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:Ne.a.xn(Rd)})}else ya.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.lrk=()=>{this.$mc?this.$mc.Iwg():ya.ULS.sendTraceTag(507896192,220,10,"_addInCategoryManager is null")};
this.x4i=(Rd,$d,Ae)=>{(Rd=this.OJa(Rd,Ae))?this.pC.HBf(Rd).then(Ke=>{const Ze={};Ze.solutionId=Ke.solutionId;Ze.version=Ke.version;Ze.storeType=Ke.storeType;Ze.storeId=Ke.storeId;Ze.assetId=Ke.assetId;Ze.assetStoreId=Ke.assetStoreId;Ze.targetType=Ke.targetType;Ze.displayName=Ke.displayName;Ze.width=Ke.width;Ze.height=Ke.height;this.yRd($d,Ae,Ze)}).catch(Ke=>{ya.ULS.sendTraceTag(507631067,220,10,Ke.message)}):ya.ULS.sendTraceTag(507631068,220,10,"No search add-in details.")};this.A6i=Rd=>{const $d=
Rd.substring(14);"All"===$d||Object.values(wk).some(Ae=>Ae===$d)?this.pC.vZk($d):ya.ULS.sendTraceTag(507564195,220,10,`Bad category switch. SourceControlId=${Rd}.`)};this.C6i=()=>{this.pC?this.pC.Q3i():ya.ULS.sendTraceTag(507523100,220,10,`Bad fre content switch. appsFlyoutGenerator is valid: ${!!this.pC}`)};this.B6i=Rd=>{(Rd=Rd.SourceControlId)&&this.pC?this.pC.P3i(Rd):ya.ULS.sendTraceTag(507560522,220,10,`Bad fre banner switch. SourceControlId=${Rd}; appsFlyoutGenerator is valid: ${!!this.pC}`)};
this.xRd=(Rd,$d,Ae)=>{if(this.b0&&(null===Ae||void 0===Ae?0:Ae.startsWith("PopularAddinsSearchResultsItem")))this.x4i(Rd,$d,Ae);else{if(this.pC.Aba){Rd=this.OJa(Rd,Ae);if(!Rd){ya.ULS.sendTraceTag(508872144,220,10,"Fail to get a valid AddinDetail with provided unique id.");return}Rd=Rd.Hac()}else Rd=this.hJf(Rd,Ae);Rd?this.yRd($d,Ae,Rd):ya.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.")}};this.yRd=(Rd,$d,Ae)=>{const Ke={[mc.a.yua]:Ae,[Ic.a.hl]:this.ti.UHa(Ae)},Ze=new Ie.a(-741808261,
0,this.$.ji,Rd,"");this.$.Ia.qh(Ze,Ke);this.ti.p5a("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Ae);Rd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ae.solutionId,Ae.storeType,Ae.assetId,Ae.storeId),["UILocation"]:Rd,["ControlId"]:$d,["FRECategory"]:this.zua?this.pC.NNg:void 0,["FRECarouselCategory"]:this.afa?this.pC.jDf:void 0};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:Ne.a.xn(Rd)})};this.zRd=(Rd,$d,Ae)=>{Ae=
void 0===Ae?null:Ae;if(Rd)if(Rd=this.OJa(Rd,Ae)){var Ke=this.ti.Fl;Ke=Ke?Ke.getAppUILocale()||"en-US":"en-US";this.foc=new jk(Rd.solutionId,"wac_excel",Ke,Ze=>{this.ti.p5a("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Ze);const cg=new Ie.a(-741808261,0,this.$.ji,$d,null);this.$.Ia.qh(cg,{[mc.a.yua]:Ze,[Ic.a.hl]:this.ti.UHa(Ze)});this.foc&&this.foc.hide();Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(Ze={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ze.solutionId,
Ze.storeType,Ze.assetId,null,null,Ze.storeId),["UILocation"]:$d,["ControlId"]:Ae,["FRECategory"]:this.zua?this.pC.NNg:void 0,["FRECarouselCategory"]:this.afa?this.pC.jDf:void 0},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:Ne.a.xn(Ze)}))});this.foc.initializeAndShow("",null,null)}else ya.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else ya.ULS.sendTraceTag(509362328,220,10,"Unique id is null.")};
this.J4i=(Rd,$d,Ae)=>{var Ke;if(Rd){if(this.pC.Aba){Rd=this.OJa(Rd);if(!Rd){ya.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");return}Rd=Rd.Hac()}else if(Rd=this.hJf(Rd),!Rd){ya.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}var Ze={[mc.a.yua]:Rd,[Ic.a.hl]:this.ti.UHa(Rd)},cg=new Ie.a(-741808261,0,this.$.ji,$d,"");this.$.Ia.qh(cg,Ze);null===(Ke=this.fVf)||void 0===Ke?void 0:Ke.GFj(Rd.solutionId);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",
!0)&&($d={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.solutionId,Rd.storeType,Rd.assetId,null,null,Rd.storeId),["UILocation"]:$d,["ControlId"]:Ae},ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Ne.a.xn($d)}))}else ya.ULS.sendTraceTag(509362326,220,10,"UniqueId is null.")};this.OJa=(Rd,$d)=>this.b0&&(null===$d||void 0===$d?0:$d.startsWith("PopularAddinsSearchResultsItem"))?this.pC.gXi(Rd):this.pC.Aba?this.pC.OJa(Rd):this.vU.DH(Rd);
this.PQf=(Rd,$d)=>{if(Rd){var Ae={};Ae.solutionId=Rd.solutionId;Ae.version=Rd.version;Ae.storeType=Rd.storeType;Ae.storeId=Rd.storeId;Ae.assetId=Rd.assetId;Ae.assetStoreId=Rd.assetStoreId;Ae.targetType=Rd.targetType;Ae.displayName=Rd.displayName;Ae.width=Rd.width;Ae.height=Rd.height;this.yRd(0,"AddinDialogControl"+$d,Ae);Rd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ae.solutionId,Ae.storeType,Ae.assetId,null,null,Ae.storeId),["source"]:$d};ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallAddinFromStoreExp",
dataFields:Ne.a.xn(Rd)})}else ya.ULS.sendTraceTag(507332238,220,10,"AddinDetail is null.")};this.z4i=(Rd,$d)=>{Rd?this.pC.HBf(Rd).then(Ae=>{this.PQf(Ae,$d)}).catch(Ae=>{ya.ULS.sendTraceTag(507332236,220,10,Ae.message)}):ya.ULS.sendTraceTag(507332237,220,10,"AddinDetail is null.")};this.G4i=()=>{const Rd=new Ie.a(1296389134,0,this.$.ji,2,null);this.$.Ia.qh(Rd,{[Ic.a.FVk]:"InsertMoreAddInsFromStoreDialog"});ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAppForOfficeDialogFromStoreExp"})};
this.ate=Rd=>La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",!1)&&"InsertMoreAddInsFromFooter"===(null===Rd||void 0===Rd?void 0:Rd.SourceControlId)?!0:!1;this.H4i=()=>{this.qfb&&this.$.fa.Dn.get(27)&&(this.pC.eXg(),ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchFlyoutStoreDialogFromFooter"}))};this.XOj=(Rd,$d)=>{if($d)if($d)if(Rd=$d.ns){if(Ue()||ce()){const Ke=this.$.fa.workbookContext.WebExtensions;if(Ke){let Ze=!1;for(var Ae of Ke)if(Ae.PrimaryMarketplace.SolutionId.toLowerCase()===
Rd.solutionId.toLowerCase()){Ze=!0;break}if(!Ze){ya.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{ya.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}$d=$d.Pw;Ae=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Rd.solutionId in Ae)$d=Ae[Rd.solutionId];else if($d=this.uJi($d),void 0===$d||null===$d){ya.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Ae=
new Ie.a(Ag.a.Uea,0,0,2,null);this.executeCommand(0,Ae,{["SourceControlId"]:$d},null);Rd.isAutoLaunched=!0}else ya.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else ya.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else ya.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.R0j=(Rd,$d)=>{null==$d?ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ne.a.xn({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"})}):Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8180233_AddNullCheck")&&isNullOrUndefined(this.$)||(this.bzb=new Si(this),this.bzb.Skk($d),Rd=this.$.Ia,Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.qfb?this.JBa?($d=appChrome.selectors.getSelectedTabId())&&Ve.a($d,this.homeTab)?this.bzb.hXg():null!==Rd&&(Rd.Jqd(this.Ibe),ya.ULS.sendTraceTag(508564945,220,50,"Register home tab switched event")):ya.ULS.sendTraceTag(508564944,
802,50,"selector is not ready"):null!==Rd&&(Rd.Jqd(this.Ibe),ya.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))};this.Ibe=(Rd,$d)=>{Rd=this.insertTab;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.qfb&&(Rd=this.homeTab);$d.tabName===Rd&&($d=this.$.Ia,null!=$d&&($d.dHg(this.Ibe),ya.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.bzb.hXg())};this.tXj=(Rd,$d)=>{Rd=null;$d&&(Rd=$d);(null===Rd||void 0===
Rd?0:Rd.Pw)&&this.lIk(Rd.Pw);this.$.Fm();Rd&&Rd.ns&&this.IMh(Rd.ns)};this.D8k=(Rd,$d)=>{$d.gM===dj.a.cKj&&(this.lJb|=1);$d.gM===dj.a.pHh&&(this.lJb|=2);!La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)&&this.QTg()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.$=B;ya.ULS.shipAssertTag(537170659,0,!(void 0===ra||null===ra),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Mk.a.Lfa()}`);
this.ti=ra;this.Yjf=vb;this.boc=dc;this.Ila=Hc;this.nJb=ed;this.Px=new Cl.a;this.xua=new qb;this.Cwa=Id;Ki.a.pnb=Ki.a.Wyf;this.mCd=new Ef.a;this.pjb=new Ef.a;this.qfb&&(this.Qte=La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",!1),this.vU=this.ti.vU,null!==this.vU?(this.$mc=this.zOc?new Ij(La.AFrameworkApplication.ea,this.vU,this.xSh):null,this.fVf=new cj(this.vU),B={xRd:this.PQf.bind(this),y4i:this.z4i.bind(this),F4i:this.G4i.bind(this)},
this.pC=new nl(La.AFrameworkApplication.xh,this.vU,Ag.a.ZZb.toString(),Ag.a.Pqb.toString(),this.M7b?"-1777747317":"1296389134",La.AFrameworkApplication.ea,this.$mc,this.KHi(),this.fVf,()=>{var Rd;return null===(Rd=this.WA)||void 0===Rd?void 0:Rd.call(this,"InsertAddInFlyout")},B),this.vU.cBa(this.D8k)):ya.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get qfb(){return La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}get zOc(){return La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",
!1)}get Zhi(){return La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DistinguishUserSegmentForContentExpEnabled",!1)}get b0(){return La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get afa(){return La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)}get zua(){return La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",
!1)}get M7b(){return La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get isBusinessUser(){return!!La.AFrameworkApplication.mi.IsBusinessUser}get isEduUser(){return!!La.AFrameworkApplication.mi.IsEduUser}get isAnonymousUser(){return La.AFrameworkApplication.ea.ka("IsAnonymousUser")}LRh(){return`IsBusinessUser: ${this.isBusinessUser}, IsEduUser: ${this.isEduUser}, IsAnonymousUser: ${this.isAnonymousUser}`}KHi(){const B=this.Zhi&&this.isBusinessUser?Tk:nk;for(const ra in Hl)B[ra]=
Hl[ra];return B}dispose(){void 0!==this.nJb&&null!==this.nJb&&(this.nJb.dispose(),this.nJb=null);this.ti=this.$=null;this.disposed=!0}gNk(B,ra){switch(B){case Ag.a.Uea:B=this.QMk(ra);break;default:B=!1}return B}Ri(B,ra){return"Dev Box"===La.AFrameworkApplication.ea.Ya("StatusBarEnvironmentNameToUse")?!1:619219938===ra?(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TempTelemetryOfInsertAddInFlyout",!1)&&Object(ti.a)("getRibbonSubComponentStatus")&&(B=appChrome.api.getRibbonSubComponentStatus("insertAddInFlyout"),
ya.ULS.sendTraceTag(507909329,220,50,`insertAddInFlyout status=${B}`)),!this.QTg()):!1}executeCommand(B,ra,vb){B=Ka.TaskExtensions.Yq();var dc=ra.command;ra=ed=>{let Id=null;if(!ed)return Id;(Id=ed.CommandValueId)||(Id=this.pC.gQd(ed.SourceControlId));Id||ya.ULS.sendTraceTag(508560270,220,10,"UniqueId is null.");return Id};switch(dc){case 843847158:break;case Ag.a.ZZb:this.gPa();var Hc=vb.UILocation;this.zOc?(vb=ra(vb),this.zRd(vb,Hc)):(vb=vb.SourceControlId)?this.zRd(this.pC.gQd(vb),Hc):ya.ULS.sendTraceTag(509362329,
220,10,"Control id is null.");break;case Ag.a.D3a:this.gPa();ra=this.zOc?ra(vb):vb.CommandValueId;Hc=vb.UILocation;dc=vb.SourceControlId;"LinkClickedPayload"===vb.Type?this.K2i(ra,vb.Href,Hc,dc):this.zRd(ra,Hc,dc);break;case Ag.a.uoe:this.b0&&this.pC.bAk(null!==(Hc=vb.SearchBoxNewValue)&&void 0!==Hc?Hc:"");break;case Ag.a.dac:this.zua&&(this.gPa(),this.A6i(vb.SourceControlId));break;case Ag.a.M1c:this.afa&&this.B6i(vb);break;case Ag.a.L1c:this.afa&&this.C6i();break;case Ag.a.UPb:this.Paf||(this.vU.cBa(this.lrk),
this.Paf=!0);break;case Ag.a.qya:this.gPa();this.xRd(vb.CommandValueId,vb.UILocation,vb.SourceControlId);break;case Ag.a.Pqb:this.gPa();Hc=vb.UILocation;dc=vb.SqmControlId;const ed=vb.SourceControlId;if(this.zOc)vb=ra(vb);else{if(!ed){ya.ULS.sendTraceTag(508440995,220,10,"ControlId is null.");break}vb=this.pC.Aba?this.pC.gQd(ed):this.pC.j3h[ed]}this.J4i(vb,Hc,null!==dc&&void 0!==dc?dc:ed);break;case -2025863019:rd.a.Ote(vb[mc.a.Uqd].toString(),()=>{ja.f(this.$).focus()});break;case -1777565636:fk.a.showUILessDialog(vb[mc.a.oJb].toString());
this.ti.NQk(vb[mc.a.oJb].toString());break;case 1592314317:fk.a.hideUILessDialog(vb[mc.a.oJb].toString());this.ti.V8i(vb[mc.a.oJb].toString());break;case Ag.a.Uea:B=this.eRd(vb);break;case Ag.a.Nqb:this.YZb(vb);break;case Ag.a.xG:this.adk(vb);break;case Ag.a.Gqa:this.Gqa(vb);break;case Ag.a.I9b:this.nJb.V_c();break;case Ag.a.refreshAddinCommands:this.Cik();break;case 1949669462:this.Ila.eQg(!0);break;case -1014260128:B=this.executeDynamicAddInCommandsAPI(vb);break;case 1296389134:La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",
!1)&&this.H4i();break;default:B=Na.a(dc)}return B}Ei(B,ra,vb,dc){let Hc=!1;switch(ra.command){case Ag.a.D3a:case Ag.a.qya:case Ag.a.ZZb:case Ag.a.Pqb:case Ag.a.uoe:case Ag.a.dac:case Ag.a.M1c:case Ag.a.UPb:Hc=!!vb;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case Ag.a.xG:case Ag.a.Gqa:case Ag.a.I9b:case Ag.a.refreshAddinCommands:case 1949669462:case Ag.a.Nqb:case -1014260128:Hc=!0;break;case Ag.a.Uea:Hc=!La.AFrameworkApplication.protectedFile;break;case 1296389134:Hc=this.ate(vb)&&
1===B&&!!dc&&1===dc.sM}return Hc}QTg(){return!Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8162137_NullCheckForFlyoutControlEnabled")||void 0!==this.$&&null!==this.$?La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)?this.$.L4&&!Ga.EwaSettings.Na(174):0!==this.lJb&&this.$.L4&&!Ga.EwaSettings.Na(174):(ya.ULS.sendTraceTag(508380621,220,15,"ewaControl is null"),!1)}dj(B,ra,vb){switch(ra){case "PopulateAddInGallery":if(La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.shadowRenderMenuFixEnabled",
!1)&&vb.IsShadowMenuOpen)return!0;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.PopulateAddinGallery",dataFields:Ne.a.xn({})});Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8464891_ShowUserSegmentInformationEnabled")&&ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.UserSegmentInformation",dataFields:Ne.a.xn({["UserSegment"]:this.LRh()})});this.pC.o9j(vb);this.Qte&&(this.gPa(),this.L2d());
return!0;default:return!1}}L2d(){fa.a.instance.getItem("AddinFlyoutOnExcelSurveyShowed")&&(this.ste=!1);this.ste&&(window.setTimeout(()=>{const B=this.LBc();B&&"hidden"!==B.visibility&&(this.R_f=!0)},this.yzi),this.jFg=window.setTimeout(()=>{this.h0g=Bb.a.instance.Dk("Common.ISystemInitiatedFeedback");fa.a.instance.setItem("removeFlyoutTaskTimeoutId",this.jFg.toString());this.R_f&&this.h0g&&this.h0g.execute(B=>{const ra=this.LBc();ra&&"hidden"===ra.visibility&&(B.d9a(this.Jzi,null),this.ste=!1,fa.a.instance.setItem("AddinFlyoutOnExcelSurveyShowed",
"1"))})},this.Kzi))}LBc(){let B=null;try{const ra=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");ra&&(B=ak.a.JE(ra.parentNode.parentNode.parentNode))}catch(ra){ya.ULS.sendTraceTag(508911886,220,10,"AddinFlyout get parent and parent get exception "+(ra?ra.toString():""))}return B}gPa(){this.Qte&&(window.clearTimeout(this.jFg),fa.a.instance.removeItem("removeFlyoutTaskTimeoutId"))}uJi(B){if(!B)return ya.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((B=B.N7)&&
B.nC&&0<B.nC.count)for(const ra of B.nC){if(ra.groups&&1===ra.groups.length){B=ra.groups[0];if(B.controls&&1===B.controls.length){const vb=B.controls[0];if(vb.attributes&&!vb.controlType&&vb.enabled)return vb.id}B.controls&&ya.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}ra.groups&&ya.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}get VM(){return La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}adk(B){if(B&&
mc.a.A$ in B)if(this.ti){var ra=B[mc.a.A$];this.VM?mc.a.goc in B&&(B=B[mc.a.goc],this.ti.svb(ra,B),1===B&&this.xG(ra,!0)):this.xG(ra,!0)}else ya.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..");else ya.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}xG(B,ra){ra=void 0===ra?!1:ra;this.ti?(ya.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",B,ra),this.ti.xG(B,ra)):
ya.ULS.sendTraceTag(508564227,220,50,"QueryAddinDetails: abort because ddaFacadeService is null.")}Cik(){if(this.Ila.zMc()){this.Ila.xgf();var B=this.cLd();if(B&&0<B.count)for(const ra of B)B={[mc.a.A$]:ra,[mc.a.D4]:4,[mc.a.PVa]:(new Date).getTime()},this.Gqa(B)}else La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(ya.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.Ila.zMc()),this.xG(10,
!0),this.xG(0,!0))}Gqa(B){ya.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${B[mc.a.D4]}, DataProvider ${B[mc.a.A$]}.`);this.Ila.bEk();window.setTimeout(()=>{if(void 0===this.ti||null===this.ti)ya.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Mk.a.Lfa()}`);else{const ra=new pg(new Ng(this.ti.Fl),Ug.instance,Nh.instance);ra.cCh((vb,dc)=>{La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&
this.xG(B[mc.a.A$]);this.YZb(dc.properties)});ra.QFh(this.R0j);ra.f6k(B)}},0)}YZb(B){if(!this.disposed){ya.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${B[mc.a.D4]}.`);try{if(Ga.EwaSettings.Na(174)){const dc=B[mc.a.mJb];if(dc&&0<dc.count){const Hc=dc.count;for(let ed=Hc-1;0<=ed;ed--){const Id=dc.ma(ed);OSF.OsfControl.isFirstPartyStoreString(Id.storeType)||dc.remove(dc.ma(ed))}if(dc.count<Hc){const ed=Object(Ti.d)(oa.a.resolve(Sa.E,{va:0}));Ka.TaskExtensions.$e(ed,()=>{ed.result.Rm(36,null)},
this.$.ya,3)}if(!dc.count)return}}if(void 0===this.ti||null===this.ti)ya.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Mk.a.Lfa()}`);else{var ra=null;ra=La.AFrameworkApplication.ea.ka("HostInstallAddInsIsEnabled")?new Hk(this.Px,this.Yjf,new Ng(this.ti.Fl),new fl(this.$.xi,Ag.a.Uea),this.Ila,Ug.instance,this.xua,(dc,Hc)=>{const ed={};ed.InstanceId=C.a.create().toString();ed.PrimaryMarketplace={};ed.PrimaryMarketplace.SolutionId=dc.solutionId;
ed.PrimaryMarketplace.SolutionVersion=dc.version;ed.PrimaryMarketplace.MarketplaceType=dc.storeType;ed.PrimaryMarketplace.MarketplaceRef=dc.storeId;ed.WebExtensionType=1;this.ti.ATk(ed,()=>{Hc(dc)})}):new Hk(this.Px,this.Yjf,new Ng(this.ti.Fl),new fl(this.$.xi,Ag.a.Uea),this.Ila,Ug.instance,this.xua);ra.jCh(this.XOj);ra.dCh(this.tXj);var vb=new Si(this);ra.jEh(vb.sXj);ra.PFh(vb.uQk);this.$.qa.zh(53).xs&&Ca.a.get_instance().Hm(5,null).continueWith(()=>{this.disposed||ra.vxj(this.Cwa,this.$.domElement,
B)})}}catch(dc){ya.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${dc.message}.`)}}}eRd(B){const ra=Ka.TaskExtensions.Yq();B=B[this.Px.Fva];const vb=this.boc.Qnd(B),dc=new fk.a(this.$,this.ti,vb.ownerAddinInfo,ra);return this.QPf(ra,B,vb,dc)}QPf(B,ra,vb,dc){this.boc.eRd(ra,this.Ila,dc,new Ng(this.ti.Fl),vb,()=>{B=dc.n2h()},()=>{ja.f(this.$).focus()});return B}IMh(B){const ra=Ka.TaskExtensions.Yq();var vb=this.ti.a6(B.solutionId);if(vb){var dc=this.ti.gY(vb);if(ad.HelperMethods.cG(dc)&&
0!==dc.SharedRuntime.State)return}dc=this.boc.JMh;const Hc=B.solutionId in dc?dc[B.solutionId]:null;if(Hc){const ed=this.boc.Qnd(Hc),Id=new fk.a(this.$,this.ti,ed.ownerAddinInfo,ra),Pd=Telemetry.PrivacyRules.GetPrivacyCompliantId(B.solutionId,null!==ed.ownerAddinInfo?ed.ownerAddinInfo.storeType:B.storeType,B.assetId,null,null,B.storeId);dc=Rd=>{if(Rd){const $d={};for(const Ae of Rd)$d[Ae[0]]=Ae[1];(Rd=mc.a.C6e in $d?$d[mc.a.C6e]:null)&&"true"===Rd.toLowerCase()&&(ya.ULS.sendTraceTag(537170652,220,
50,`Auto-Show AddinCommands TaskPane, StoreType ${B.storeType}, StoreId ${B.storeId}, SolutionId ${Pd}.`),this.QPf(ra,Hc,ed,Id))}};ya.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${B.storeType}, StoreId ${B.storeId}, SolutionId ${Pd}.`);if(vb)dc(this.ti.gY(vb).OsfPropertyBag);else if(vb=this.$.fa.workbookContext.WebExtensions)for(const Rd of vb)if((1===Rd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===B.targetType&&Rd.PrimaryMarketplace.MarketplaceType.toLowerCase()===
B.storeType.toLowerCase()&&Rd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===B.storeId.toLowerCase()&&Rd.PrimaryMarketplace.SolutionId.toLowerCase()===B.solutionId.toLowerCase()){dc(Rd.OsfPropertyBag);break}}}pxe(B,ra,vb){B&&(void 0===vb||!vb||ra||this.mCd.contains(B)||this.mCd.add(B),(vb=this.pjb.contains(B))&&ra&&this.pjb.remove(B),vb||ra||this.pjb.add(B))}lIk(B){if((B=B.N7)&&B.nC)for(const ra of B.nC)if(ra.groups)for(const vb of ra.groups)if(vb.controls)for(const dc of vb.controls)if(this.pxe(dc.id,
dc.enabled,!0),1===dc.controlType&&dc.menuItems)for(const Hc of dc.menuItems)this.pxe(Hc.id,Hc.enabled,!0)}cLd(){const B=new Ef.a;Ga.EwaSettings.Na(52)&&(this.$.fa.Dn.get(27)&&(B.add(0),B.add(16)),this.$.fa.Dn.get(33)&&B.add(1),B.add(8));return B}executeDynamicAddInCommandsAPI(B){let ra=!0;if(void 0===B||null===B||void 0===B[mc.a.tPb]||null===B[mc.a.tPb])return Cf.Task.Ua(!1);switch(B[mc.a.tPb]){case 1:ra=this.w9k(B);break;case 2:ra=this.pIk(B);break;case 4:this.pjb.clear();this.pjb.addRange(this.mCd);
break;case 3:ra=this.installContextualTab(B);break;default:ra=!1}return Cf.Task.Ua(ra)}QMk(B){return B&&this.Px.Fva in B?(B=B[this.Px.Fva])?this.pjb.contains(B):!1:!1}w9k(B){var ra=null;let vb=null,dc=null,Hc=!0;void 0!==B[mc.a.fga]&&null!==B[mc.a.fga]&&void 0!==B[this.Px.Fva]&&null!==B[this.Px.Fva]&&void 0!==B[mc.a.ega]&&null!==B[mc.a.ega]&&(ra=B[mc.a.fga],vb=B[mc.a.Wwc],dc=B[this.Px.Fva],Hc=B[mc.a.ega]);if(!ra||!dc)return ya.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),
!1;B=(new rk.a(this.$.xi,ra,this.Px,!0)).u_a(dc);ra={DynamicAddinCommandsApiName:"UpdateControlEnableState"};ra.AssetId=vb;ra.MaskedTabId=B;ra.IsToEnable=Hc;ya.ULS.sendTraceTag(537170648,220,50,Tc.a.Di(ra));this.pxe(B,Hc);Ql.a.fB.aC();return!0}pIk(B){var ra,vb,dc=null,Hc=null;let ed=null;var Id=null;let Pd=!0;void 0!==B[mc.a.eEd]&&null!==B[mc.a.eEd]&&void 0!==B[mc.a.fga]&&null!==B[mc.a.fga]&&void 0!==B[this.Px.Fva]&&null!==B[this.Px.Fva]&&void 0!==B[mc.a.ega]&&null!==B[mc.a.ega]&&(dc=B[mc.a.eEd],
Hc=B[mc.a.fga],ed=B[mc.a.Wwc],Id=B[this.Px.Fva],Pd=B[mc.a.ega]);if(!dc||!Hc||!Id)return ya.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;B=(new rk.a(this.$.xi,Hc,this.Px,!0)).ENf(Id);Id={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};Id.StoreType=dc;Id.AssetId=ed;Id.MaskedTabId=B;Id.IsToShow=Pd;ya.ULS.sendTraceTag(537170646,220,15,Tc.a.Di(Id));dc=this.Ila.Kwa(dc,Hc,1);Hc=!1;if(null===(vb=null===(ra=null===dc||void 0===dc?void 0:dc.Pw)||
void 0===ra?void 0:ra.N7)||void 0===vb?0:vb.nC)for(const Rd of dc.Pw.N7.nC)if(Rd.id===B){Hc=!0;break}if(!Hc)return ya.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;ra=[];Pd?appChrome.selectors.getSelectedTabId()!==B&&ra.push(appChrome.actions.activateRibbonTab(B)):(appChrome.selectors.getSelectedTabId()===B&&ra.push(appChrome.actions.setCurrentTab($e.a.eT)),ra.push(appChrome.actions.deactivateRibbonTab(B)));appChrome.api.dispatch(ra);return!0}hJf(B,ra){if(this.vU){if(B=
this.OJa(B,ra))return ra={},ra.solutionId=B.solutionId,ra.version=B.version,ra.storeType=B.storeType,ra.storeId=B.storeId,ra.assetId=B.assetId,ra.assetStoreId=B.assetStoreId,ra.targetType=B.targetType,ra.displayName=B.displayName,ra.width=B.width,ra.height=B.height,ra;ya.ULS.sendTraceTag(509362324,0,10,"Get addinDetail fail.");return null}ya.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(B){let ra=null,vb=null,dc=null;var Hc=null;if(void 0!==B[mc.a.fga]&&
null!==B[mc.a.fga]&&void 0!==B[mc.a.ega]&&null!==B[mc.a.ega]){const ed=B[mc.a.ega];ra=B[mc.a.fga];void 0!==ed[mc.a.YYa]&&null!==ed[mc.a.YYa]&&void 0!==ed[mc.a.ZYa]&&null!==ed[mc.a.ZYa]&&(vb=ed[mc.a.YYa],dc=ed[mc.a.ZYa],Hc=ed[mc.a.fEd])}if(!(ra&&dc&&vb&&Hc))return ya.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;B=this.Ila.Kwa(Hc.PrimaryMarketplace.MarketplaceType,Hc.PrimaryMarketplace.SolutionId,1);if(null===B||void 0===B?0:B.Pw)return ya.ULS.sendTraceTag(537170643,
220,15,"InstallContextualTab was called multiple times"),!1;B={};B.solutionId=Hc.PrimaryMarketplace.SolutionId;B.version=Hc.PrimaryMarketplace.SolutionVersion;B.storeType=Hc.PrimaryMarketplace.MarketplaceType;B.storeId=Hc.PrimaryMarketplace.MarketplaceRef;Hc.AssetMarketplace?(B.assetId=Hc.AssetMarketplace.SolutionId,B.assetStoreId=Hc.AssetMarketplace.MarketplaceRef):(B.assetId=null,B.assetStoreId=null);B.targetType=Hc.WebExtensionOsfControlType;B.width=Hc.TaskpaneWidth;B.height=0;B.isAddinCommands=
!0;Hc=new Ef.a;Hc.add(B);B={};B[mc.a.mJb]=Hc;B[mc.a.D4]=6;B[mc.a.YYa]=vb;B[mc.a.ZYa]=dc;this.YZb(B);return!0}get JBa(){return!!window.appChrome&&!!appChrome.selectors}}Object(ha.a)(xk,"AddinUICommandHandler",null,[271,36,2]);var Tl=a(51);class Il{constructor(B,ra,vb,dc){this.tse=void 0===B?null:B;this.Xnd=void 0===ra?null:ra;this.aCd=void 0===vb?null:vb;this.uQb=void 0===dc?0:dc}rQa(){return this.tse()}activate(){return this.Xnd()}deactivate(){this.aCd()}dispose(){this.aCd=this.Xnd=this.tse=null}}
Object(ha.a)(Il,"FeatureActivator",null,[270,2]);var Ul=a(53),Vl=a(45);class ol extends ye.a{constructor(B){super(B);this.handler=null;this.yxh=()=>{ya.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.Kj&16384)}]`);const ra=new le.a;this.$.qa.zi(53,$d=>{ya.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");ra.setResult($d)});const vb=ra.task,dc=
new wa,Hc=ab.a.getInstance(),ed=new Fh(this.$,Hc),Id=Yc.GetServiceTaskFactory.create(this.$.qa,203,this.ya,this.gi),Pd=this.ojk(dc),Rd=Object(Ti.d)(oa.a.resolve(Sa.me,{va:this.gi}));return Ka.TaskExtensions.$e(Ka.TaskExtensions.Dq([vb,Id,Pd,Rd],this.ya),()=>{ya.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Sa.yb.Ma()?void oa.a.resolve(Sa.yb,{va:this.gi}).then($d=>{let Ae;if(La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",
!1)||La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)){const Ke=vb.result;Ae=Ze=>{var cg,Vf;return null===(Vf=null===(cg=null===Ke||void 0===Ke?void 0:Ke.xs)||void 0===cg?void 0:cg.WA)||void 0===Vf?void 0:Vf.call(cg,Ze)}}else Ae=()=>{};this.handler=new xk(this.$,$d,dc,new Jd,Hc,ed,Bb.a.instance.rI("Common.IExternalUICommandDefinitionMapping"),Ae);ya.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");
this.Zt([this.handler]);this.$.qa.Rh(198,this.handler)}):Ka.TaskExtensions.$e(Yc.GetServiceTaskFactory.create(this.$.qa,106,this.ya,this.gi),$d=>{$d=$d.result;let Ae;if(La.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)){const Ke=vb.result;Ae=Ze=>{var cg,Vf;return null===(Vf=null===(cg=null===Ke||void 0===Ke?void 0:Ke.xs)||void 0===cg?void 0:cg.WA)||void 0===Vf?void 0:Vf.call(cg,Ze)}}else Ae=()=>{};this.handler=new xk(this.$,$d,dc,new Jd,
Hc,ed,Bb.a.instance.rI("Common.IExternalUICommandDefinitionMapping"),Ae);ya.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Zt([this.handler]);this.$.qa.Rh(198,this.handler)},this.ya,3)},this.ya,3)};this.Mci=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ia.Cvb(this.handler),this.$.qa.Xma(198),this.handler=null):ya.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
this.$.qa.Xma(204);Vl.a(Ul.a,19,this.$.qa,198)}}sw(){ya.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");const B=Ga.EwaSettings.Tp("AddinUICommandHandler"),ra=B?128:2;Tl.a(this.$).add(Object(lj.a)(new Il,{tse:()=>{const vb=(B?this.$.fa.Vm:this.$.fa.nN)&&this.$.fa.ki&&!!(this.$.Kj&16384)&&this.$.isEditMode;this.$.fa.ki&&ya.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${vb}] IsSessionFullyLoaded [${this.$.fa.nN}] IsSessionActive [${this.$.fa.ki}] ShowCommandUI [${!!(this.$.Kj&
16384)}] IsEditMode [${this.$.isEditMode}] IsAppVisuallyReady [${this.$.fa.Vm}]`);return vb},Xnd:this.yxh,aCd:this.Mci,uQb:ra}))}ojk(B){const ra=Object(Ti.d)(oa.a.resolve(Sa.xf,{va:this.gi}));return Ka.TaskExtensions.$e(ra,()=>{ya.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.qa.Rh(204,new Zf(ra.result,B))},this.ya,3)}static Ga(B){ye.a.jB(199,new ol(B))}}Object(ha.a)(ol,"AddinUICommandHandlerFactory",
ye.a,[]);var yk=a(9),ek=a(432),pl=a(1404),ql=a(1406),rl=a(939);class Uk extends ek.a{constructor(B){super();this.$=B;this.sn()}create(){let B;if(Ga.EwaSettings.Na(355)){const ra=Sa.yb.Ma()?Object(Ti.d)(oa.a.resolve(Sa.yb,{va:this.gi})):Yc.GetServiceTaskFactory.create(this.$.qa,106,this.$.ya,this.gi),vb=Object(Ti.d)(oa.a.resolve(Sa.xd,{va:this.gi}));Ka.TaskExtensions.$e(Cf.Task.t_(ra,vb),()=>{this.dl(Object(rl.a)(this.$.qa,278,()=>new pl.CustomFunctionsInstaller(this.$,ra.result,vb.result)))},this.$.ya,
3)}else B=Object(rl.a)(this.$.qa,278,()=>new ql.CustomFunctionsLegacyInstaller(this.$)),this.dl(B)}static Ga(B){B.qa.Rh(279,new Uk(B))}}Object(ha.a)(Uk,"CustomFunctionsInstallerFactory",ek.a,[]);var sl=a(60),Wl=a(1433),zk=a(1432);class Ak extends ek.a{constructor(B){super();this.xCg=this.ddaFacade=null;this.$=B;B.qa.Rh(106,this);this.sn()}get ti(){return this.ddaFacade||(this.ddaFacade=new Xa.DdaFacade(this.$,this.xCg,this.xk,null))}create(){ya.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");
La.AFrameworkApplication.disableWholeAppsForOfficeFeature?ya.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${La.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):Ga.EwaSettings.Na(359)?Bb.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(B=>{const ra=Bb.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");Promise.all([B.isFeatureEnabled("mso_officeStore",
!0),ra.aS("WACSideloadAddins")]).then(vb=>{var [dc,Hc]=vb;Xa.DdaFacade.XMb=dc;Xa.DdaFacade.WBe=Hc;this.zmf();return null},vb=>{ya.ULS.sendTraceTag(508073758,0,10,`Unsable to fetch office store or add-in sideload enabled flag from OCPS: ${vb}.`);return null})}):this.zmf()}zmf(){const B=Object(Ti.d)(oa.a.resolve(Sa.j,{va:this.gi})),ra=sl.a.y3d(65,()=>!(void 0===window.OSF||null===window.OSF),this.$.ua.MaxRetriesForLoadingScript,this.$.ya,this.gi,106),vb=xf.a(this.ya,this.gi),dc=Object(Ti.d)(oa.a.resolve(Sa.zc,
{va:this.gi}));Ka.TaskExtensions.$e(Ka.TaskExtensions.Dq([B,ra,vb,dc],this.$.ya),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?ya.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Mk.a.Lfa()}`):this.Zbj();ya.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.xCg=B.result;this.xk=dc.result;this.dl(this.ti);ya.ULS.sendTraceTag(537170503,
0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ya,3)}Zbj(){Ga.EwaSettings.Na(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new zk.a);this.$.kk.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new zk.a,new Wl.a(La.AFrameworkApplication.ea.appSettings.WebServiceBase),Ga.EwaSettings.Na(70),!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new zk.a);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new zk.a)}dispose(){za.a.gh(this.ddaFacade);
this.$=this.ddaFacade=null;super.dispose()}static Ga(B){new Ak(B)}}Object(ha.a)(Ak,"DdaFacadeServiceFactory",ek.a,[]);class Bk extends ye.a{constructor(B){super(B)}sw(){Vc.a(this.$,374,375,this.gi,B=>{const ra=[];Sa.h.Ma()||ra.push(new ka(this.$,B));Sa.mg.Ma()||ra.push(new lg(this.$,B));this.Zt(ra)})}static Ga(B){ye.a.jB(76,new Bk(B))}}Object(ha.a)(Bk,"AgaveCommandHandlerFactory",ye.a,[]);var Jl=a(1484),bk=a(138);class Xj{constructor(){this.ti=null;this.Sub=(B,ra,vb,dc,Hc)=>{if(2===vb){B=Hc?Hc:{};
ra=B.callback;vb=B.refresh?B.refresh:!1;if(!ra)return 16;La.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=B.storeType?this.ti.Zzg(ra,vb,B.storeType):this.ti.oge(ra,vb)}return 32};this.IUc=(B,ra,vb,dc,Hc)=>{if(2===vb){B=Hc?Hc:{};ra=B.Observer;if(!ra)return ya.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(B)),16;if(!this.ti||!this.ti.vU)return ya.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",
JSON.stringify(B)),16;this.ti.vU.cBa(ra)}return 32};this.skk=(B,ra,vb,dc,Hc)=>{2===vb&&(B=Hc?Hc.callback:null)&&this.ti.TCh(B);return 32};this.xfj=(B,ra,vb,dc,Hc)=>{2===vb&&this.ti.p5a(null,OSF.AgaveHostAction.InsertAgave,Hc);return 32}}initialize(B){Xj.initialized||(this.ti=B,this.ko(),Xj.initialized=!0)}ko(){La.AFrameworkApplication.xh.Vk(Ag.a.Sub,bk.a.frame,this.Sub,96);La.AFrameworkApplication.xh.Vk(Ag.a.IUc,bk.a.frame,this.IUc,96);La.AFrameworkApplication.xh.Uh(Ag.a.cjk,bk.a.frame,this.skk);
La.AFrameworkApplication.xh.Vk(Ag.a.OWf,bk.a.frame,this.xfj,96)}static get instance(){Xj.Va||(Xj.Va=new Xj);return Xj.Va}}Xj.Va=null;Xj.initialized=!1;Object(ha.a)(Xj,"AgaveCommandActor",null,[]);var Jj=a(1569),Vk=a(372),Xl=a(373);a(1182);var Kl=a(1434),Yl=a(398);class tl{constructor(){this.Gxe=this.e2c=null;this.Fxe=!1;this.Dxe=null;this.h_=0;this.d2c=null}}Object(ha.a)(tl,"FirstPartyAddinTaskpaneOverrides",null,[]);class Ck{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(ha.a)(Ck,"IdeasSelectionContext",null,[]);class ul extends Ck{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(ha.a)(ul,"IdeasTableSelectionContext",Ck,[]);class ik{constructor(B,ra){this.selection=B;this.tables=ra}}Object(ha.a)(ik,"IdeasXLIMTableBoundaries",null,[]);var Dk=a(1139),Ll=a(1610),
Ui=a(1286),Zl=a(155),Wk=a(431),Ml=a(192),$l=a(156);class Nl extends ej.a{constructor(){super();this.H9="calc(100% - 46px)";this.Aka="15px";this.I9="0";this.dDb="WACDialogPanel";this.hO=695;this.eDb=462;this.SL="80%";this.QBb=350;this.RDa="100%";this.Oh=5;this.fl="AppsForOfficeInsertionDialog";this.Lad=!!La.AFrameworkApplication.ea&&La.AFrameworkApplication.ea.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}vG(){var B;super.vG();this.Yo.style.width=this.RDa;this.Yo.style.height=this.H9;this.Yo.style.marginTop=
this.Aka;this.Yo.style.padding=this.I9;if(null===(B=La.AFrameworkApplication.ea)||void 0===B?0:B.isChangeGateEnabled("AddInDialogBugFix"))this.L3.classList.add("AddInDialog"),this.Yo.classList.add("AddInDialog")}ZAa(){this.Yo.style.width=this.RDa;this.Yo.style.height=this.H9;this.Yo.style.marginTop=this.Aka;this.Yo.style.padding=this.I9;this.hO>li.a.rca?(this.rh.style.width=String.format("{0}px",li.a.rca),this.rh.style.overflowX="scroll",La.AFrameworkApplication.isRtl?this.rh.style.right="0":this.rh.style.left=
"0"):(this.rh.style.width=String.format("{0}px",this.hO),this.rh.style.overflowX="hidden");this.rh.offsetHeight>li.a.t2||this.eDb+50>li.a.t2?(this.rh.style.height=String.format("{0}px",li.a.t2),this.rh.style.overflowY="scroll",this.rh.style.top="0",La.AFrameworkApplication.isRtl?this.rh.style.right="0":this.rh.style.left="0",this.Lad||(this.rh.style.marginTop="-48px"),this.Yo.style.minHeight=String.format("{0}px",this.QBb)):(this.rh.style.overflowY="hidden",this.rh.style.top="10%",this.rh.style.height=
this.SL);this.nma()}nma(){if(this.rh){var B=this.rh.style.zIndex;this.rh.style.zIndex="-9999";if(this.hO>li.a.rca)La.AFrameworkApplication.isRtl?this.rh.style.marginRight="0":this.rh.style.marginLeft="0";else{const ra=String.format("{0}px",Math.floor(-this.rh.offsetWidth/2));La.AFrameworkApplication.isRtl?this.rh.style.marginRight=ra:this.rh.style.marginLeft=ra;La.AFrameworkApplication.isRtl?this.rh.style.right="50%":this.rh.style.left="50%"}this.rh.style.zIndex=String(B)}else ya.ULS.sendTraceTag(19976784,
306,10,"_divMessageBox is null in CenterDialog()")}zT(){super.zT();const B=document.getElementById(this.hp(this.dDb));B.style.width=String.format("{0}px",this.hO);B.style.height=this.SL}get Yma(){return this.Yo}}Object(ha.a)(Nl,"AppsForOfficeInsertionDialog",ej.a,[344]);class ok extends ej.a{constructor(B,ra,vb){B=void 0===B?!0:B;ra=void 0===ra?!0:ra;vb=void 0===vb?null:vb;super();this.H9="calc(100% - 46px)";this.Aka="15px";this.I9="0";this.dDb="WACDialogPanel";this.hO=695;this.eDb=462;this.SL="80%";
this.QBb=350;this.RDa="100%";this.MLe=this.ELe=this.Lsa=null;this.YLe="auto";this.ZLe="5px";this.$Le="auto";this.XLe="40px";this.zfc="100px";this.fDb="200px";this.Oh=5;this.fl="SDXDialog";this.thc=B;this.wUb=ra;this.vfc=vb}vG(){super.vG();this.Yo.style.width=this.RDa;this.Yo.style.height=this.H9;this.Yo.style.marginTop=this.Aka;this.Yo.style.padding=this.I9}ZAa(){this.Yo.style.width=this.RDa;this.Yo.style.height=this.thc?this.H9:"100%";this.Yo.style.marginTop=this.thc?this.Aka:"0px";this.Yo.style.padding=
this.I9;if(this.thc){this.zfc&&this.fDb&&(this.hO=parseInt(this.fDb.substring(0,this.fDb.length-2)),this.SL=this.zfc);this.hO>li.a.rca?(this.rh.style.width=String.format("{0}px",li.a.rca),this.rh.style.overflowX="scroll",La.AFrameworkApplication.isRtl?this.rh.style.right="0":this.rh.style.left="0"):(this.rh.style.width=String.format("{0}px",this.hO),this.rh.style.overflowX="hidden");if(this.rh.offsetHeight>li.a.t2||this.eDb+50>li.a.t2)this.rh.style.height=String.format("{0}px",li.a.t2),this.rh.style.overflowY=
"scroll",this.rh.style.top="0",La.AFrameworkApplication.isRtl?this.rh.style.right="0":this.rh.style.left="0",this.Yo.style.minHeight=String.format("{0}px",this.QBb);else{this.rh.style.overflowY="hidden";const B="%"===this.SL.substring(this.SL.length-1,this.SL.length),ra=B?parseInt(this.SL.substring(0,this.SL.length-1)):parseInt(this.SL.substring(0,this.SL.length-2));this.rh.style.top=B?(100-ra)/2+"%":100*(li.a.t2-ra)/li.a.t2/2+"%";this.rh.style.height=this.SL}this.nma()}else this.rh.style.left=this.YLe,
this.rh.style.right=this.ZLe,this.rh.style.top=this.$Le,this.rh.style.bottom=this.XLe,this.rh.style.width=this.fDb,this.rh.style.height=this.zfc,this.rh.style.overflowX="hidden",this.rh.style.overflowY="hidden"}nma(){if(this.rh){var B=this.rh.style.zIndex;this.rh.style.zIndex="-9999";if(this.hO>li.a.rca)La.AFrameworkApplication.isRtl?this.rh.style.marginRight="0":this.rh.style.marginLeft="0";else{const ra=String.format("{0}px",Math.floor(-this.rh.offsetWidth/2));La.AFrameworkApplication.isRtl?this.rh.style.marginRight=
ra:this.rh.style.marginLeft=ra;La.AFrameworkApplication.isRtl?this.rh.style.right="50%":this.rh.style.left="50%"}this.rh.style.zIndex=String(B)}else ya.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}zT(){super.zT();const B=document.getElementById(this.hp(this.dDb));B.style.width=String.format("{0}px",this.hO);B.style.height=this.SL}get yha(){return this.thc}get Yma(){return this.Yo}get instanceId(){return this.Lsa}set instanceId(B){this.Lsa=B}get Jvc(){return this.ELe}set Jvc(B){this.ELe=
B}get Qvc(){return this.MLe}set Qvc(B){this.MLe=B}eFk(B,ra,vb,dc){this.YLe=B;this.ZLe=ra;this.$Le=vb;this.XLe=dc}gFk(B,ra){this.zfc=B;this.fDb=ra}}Object(ha.a)(ok,"SDXDialog",ej.a,[]);var Kj=a(1137),ui=a(101),Ek=a(270),Xk;(function(B){B[B.Valid=2]="Valid";B[B.Invalid=4]="Invalid";B[B.All=6]="All"})(Xk||(Xk={}));Object(ha.b)("MetadataState",Xk);var am=a(396),vl=a(941),Ol=a(1140);class ug extends Gj.a{constructor(B,ra,vb,dc,Hc,ed,Id){super();this.jQa={};this.soe={};this.wId={};this.yOa=this.sdxDialog=
this.noa=null;this.JUg=this.Mie=!1;this.IVk=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"],["InsertMoreAddInsFromStoreDialog","InsertMoreAddInsFromStoreDialog"]]);
this.jPc=()=>{this.yOa=null};this.BCk=Pd=>{const Rd=this;return xo(function*(){yield Rd.$o.submitCustomMessage(Object.assign(new Dk.a,{message:new Ll.a({authToken:Pd})}),"Copilot")})};this.I4i=(Pd,Rd,$d,Ae,Ke)=>{if(2!==$d)return 32;this.gMc(Ke);return 32};this.$Zb=(Pd,Rd,$d,Ae,Ke)=>{2===$d&&(this.ymf(),Pd=Ke.CommandValueId,Rd=[],Rd.push(Ke.SourceControlId),Rd.push(Pd),Rd.push(null),this.ti.N7f(this.noa.Yma,Rd));return 32};this.gMc=Pd=>{var Rd=Pd[Kj.a.qQb];Pd=Pd[Kj.a.Ppa];var $d=Pd.Bk[Yg.a.Bqf];const Ae=
Pd.Bk[Yg.a.Gqf],Ke=Pd.Bk[Yg.a.dialogTitle],Ze=Pd.Bk[Yg.a.dialogHeight],cg=Pd.Bk[Yg.a.dialogWidth],Vf=Pd.Bk[Yg.a.dialogLeft],Xf=Pd.Bk[Yg.a.Fqf],Pf=Pd.Bk[Yg.a.dialogTop],Kg=Pd.Bk[Yg.a.vqf];var oh=Pd.Bk.InstanceToken;oh=null!=oh?oh:(new C.a(Nb.a.create(),1)).toString();this.sdxDialog=new ok($d,Ae);null!=Vf&&null!=Xf&&null!=Pf&&null!=Kg&&this.sdxDialog.eFk(Vf,Xf,Pf,Kg);null!=Ze&&null!=cg&&this.sdxDialog.gFk(Ze,cg);this.sdxDialog.instanceId=oh;this.sdxDialog.Jvc=Pd.Bk[Yg.a.Jvc];this.sdxDialog.Qvc=Pd.Bk[Yg.a.Qvc];
this.sdxDialog.initializeAndShow(Ke,null,null);$d={};$d.div=this.sdxDialog.Yma;$d.id=oh;$d.solutionId=Rd.getId();$d.version=Rd.oSa;$d.storeType=Rd.getStoreType();$d.storeId=Rd.getStoreId();$d.assetId=null;$d.assetStoreId=null;$d.settings=null!=Pd.jx?Pd.jx:{};$d.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;$d.osfControlType=OSF.OsfControlType.ContainerLevel;$d.sourceLocationOverrideResourceId=Pd.Bk[Yg.a.sourceLocationOverrideResourceId];$d.featureGates=La.AFrameworkApplication.ea.UHf(Rd.getId());
$d.onExtensionLaunchCallback=Pd.Bk[Yg.a.onExtensionLaunchCallback];Rd={};Rd.InstanceId=$d.id;Rd.WebExtensionType=2;Rd.PrimaryMarketplace={};Rd.PrimaryMarketplace.SolutionId=$d.solutionId;Rd.PrimaryMarketplace.MarketplaceType=$d.storeType;Rd.PrimaryMarketplace.MarketplaceRef=$d.storeId;Rd.PrimaryMarketplace.SolutionVersion=$d.version;Rd.SrcLocationOverrideResourceId=$d.sourceLocationOverrideResourceId;Rd.WebExtensionOsfControlType=6;Rd.OnExtensionLaunchCallback=$d.onExtensionLaunchCallback;this.jQa[$d.solutionId]=
$d.settings;const {HTc:Hg,OQb:Gh}=this.VNc([],$d.solutionId);Rd.OsfPropertyBag=Hg;Rd.HostPropertyBag=Gh;this.ti.gYa(Rd);this.ti.Fl.insertOsfControl($d)};this.t6i=(Pd,Rd,$d,Ae,Ke)=>{if(2!==$d)return 32;const Ze=Ke[Kj.a.qQb];var cg=Ke[Kj.a.LXa];const Vf=Ke[Kj.a.Ppa];if(null!=Vf.Bk[Yg.a.actionName])return this.pQf(Pd,Rd,$d,Ae,Ke);Pd=new Jj.a;Pd.qGc=Vf.Bk.InstanceToken;Pd.Zs=Vf.Bk[Yg.a.Zs];Pd.DW=Vf.Bk[Yg.a.DW];Yg.a.taskPaneWidth in Vf.Bk&&(Pd.taskPaneWidth=Vf.Bk[Yg.a.taskPaneWidth]);Pd.sourceLocationOverrideResourceId=
Vf.Bk[Yg.a.sourceLocationOverrideResourceId];Pd.onTaskPaneClose=Vf.Bk[Yg.a.onTaskPaneClose];Pd.onExtensionLaunchCallback=Vf.Bk[Yg.a.onExtensionLaunchCallback];Pd.showLoadingSpinner=Vf.Bk[Yg.a.showLoadingSpinner];Pd.UH=Vf.jx;Pd.LXa=cg;cg=new Ie.a(-859308420,0,2,0,"");Rd=Ze.getStoreType()===OSF.StoreType.Sdx;$d=new Ui.a;$d.bba=Vf.Bk.HeaderCssClass||Cb.a.fQb;$d.szb=Vf.Bk.TitleCssClass;this.P8(cg,Ze.getId(),Pd,Rd,$d);return 32};this.V5i=(Pd,Rd,$d,Ae,Ke)=>{if(2!==$d)return 32;Pd=Ke[Kj.a.qQb].getId();Ke=
Ke[Kj.a.Ppa].Bk[Yg.a.sourceLocationOverrideResourceId];return Pd?(this.ti.Fl.refreshOsfControl(Pd,Ke),32):8};this.d$j=Pd=>{Pd=Pd.Result;if(Pd=null===Pd?null:Pd.SolutionId)this.ti.A3e(Pd),rf.a(this.$).IPa(3,Pd)};this.kxg=(Pd,Rd)=>{var $d;const Ae=(Pd=Pd.Result)?Pd.AgaveData:null;if(Ae){var Ke=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ae.PrimaryMarketplace.SolutionId,Ae.PrimaryMarketplace.MarketplaceType,null===($d=null===Ae||void 0===Ae?void 0:Ae.AssetMarketplace)||void 0===$d?void 0:$d.SolutionId,
null,null,Ae.PrimaryMarketplace.MarketplaceRef);ya.ULS.shipAssertTag(537170434,0,Ae.TaskpaneWidth===ug.zpf,`Taskpane width is ${Ae.TaskpaneWidth}, assetId is ${Ke}.`);if($d=this.wId[Ae.PrimaryMarketplace.SolutionId])$d.e2c&&(Ae.TaskpaneTitle=$d.e2c),$d.Gxe&&(Ae.TaskpaneTitleTag=$d.Gxe),$d.Fxe&&(Ae.ShowResizeChatButton=$d.Fxe),$d.d2c&&(Ae.TaskpaneIconId=$d.d2c),$d.Dxe&&(Ae.TaskpaneButtonTooltip=$d.Dxe),0<$d.h_&&(Ae.TaskpaneWidth=$d.h_);Rd&&(Ae.FocusOnIframeWhenLoaded=Rd.focusOnIframeWhenLoaded,Rd.width&&
(Ae.TaskpaneWidth=Rd.width),Ae.TaskpaneIconCssClass=Rd.ay,Ae.TaskpaneHeaderCssClass=Rd.bba,Ae.TaskpaneTitleCssClass=Rd.szb,Ae.IsFirstPartyOptOutAppContextOptmization=Rd.isFirstPartyOptOutAppContextOptmization,Ae.ShowLoadingSpinner=Rd.showLoadingSpinner);if(this.jQa[Ae.PrimaryMarketplace.SolutionId]){const {HTc:Ze,OQb:cg}=this.VNc(Ae.OsfPropertyBag,Ae.PrimaryMarketplace.SolutionId);Ae.OsfPropertyBag=Ze;Ae.HostPropertyBag=cg}Zd.a(Ae)||(Ae.WebExtensionOsfControlType=1);Ae.OnExtensionLaunchCallback=this.soe[Ae.PrimaryMarketplace.SolutionId];
Ae&&(this.ti.A3e(Pd.SolutionId),this.ti.gYa(Ae))}else ya.ULS.sendTraceTag(593285650,220,50,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.pQf=(Pd,Rd,$d,Ae,Ke)=>{if(2!==$d)return 32;if(wb.a.Km(Ke))return 8;Pd=Ke[Kj.a.ejf];if(Pd!==sc.a.action&&Pd!==sc.a.taskpane)return 8;Rd=Ke[Kj.a.Ppa];return Rd?(Pd=(Pd=this.jTi(Ke))?this.ti.a6(Pd):null)?(Ke=this.ti.W4h(Ke[Kj.a.LXa],Rd.Bk[Yg.a.Ond]),Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&
($d=this.ti.gY(Pd),$d.TaskpaneTitle!==Rd.Bk[Yg.a.Zs]&&($d.TaskpaneTitle=Rd.Bk[Yg.a.Zs],$d.TaskpaneIconCssClass=Rd.Bk.IconCssClass,$d.TaskpaneIconUrl=Rd.Bk.TaskPaneIconUrl,$d.TaskpaneIconId=Rd.Bk.TaskPaneIconId,$d.OnExtensionLaunchCallback=Rd.Bk[Yg.a.onExtensionLaunchCallback],Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Rd=this.ti.Fl,Rd.changeIframeTitle(Pd,$d.TaskpaneTitle),$d=Rd.getOsfControl(Pd),Rd.raiseOsfControlStatusChange($d)):(Rd=this.ti.Fl.getOsfControl(Pd),
this.ti.Fl.raiseOsfControlStatusChange(Rd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Pd,Ke,this.W7b),32):8:8};this.W7b=(Pd,Rd)=>{this.ti.dyi(Pd,Rd)};this.MUc=()=>{void oa.a.resolve(Sa.xg,{va:1}).then(Pd=>{Pd.Taa()})};this.$=B;this.viewBlockContainerHelpers=vb;this.ti=ra;this.un=Hc;this.xHh=ed;this.sNj=Id;this.un.Uh(Ag.a.OVg,bk.a.frame,this.t6i);this.un.Uh(Ag.a.SJg,bk.a.frame,this.V5i);this.un.Uh(Ag.a.Yyf,bk.a.frame,this.pQf);this.un.Uh(Ag.a.gMc,bk.a.frame,this.I4i);this.un.Uh(Ag.a.$Zb,
bk.a.frame,this.$Zb);this.JUg=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Augloop.ShowChatPaneAfterSendToken",!1);this.$.fa.d5e(this.jPc)}SDh(B){this.addHandler(ug.kce,B)}Tok(B){this.removeHandler(ug.kce,B)}dispose(){za.a.gh(this.noa);this.noa=null;!Ga.EwaSettings.ul()&&this.Mie&&(this.$.fa.av(this.MUc),this.Mie=!1);super.dispose()}Avd(){this.noa&&this.noa.hide()}MWk(B,ra){var vb;if(B){this.raiseEvent(ug.kce);const dc=B.split("|");this.SBj(B,ra,dc);this.ymf();this.ti.N7f(this.noa.Yma,
dc);window[ug.CGh]=null!==(vb=this.IVk.get(B))&&void 0!==vb?vb:"Unknown"}}ymf(){const B=ra=>{0===ra&&(this.ti.p5a("",OSF.AgaveHostAction.RefreshAddinCommands,{}),ge.a.sendTelemetryEvent({name:"Office.Extensibility.Host.RefreshAddinsAfterClosingDialog"}))};this.noa=new Nl;this.noa.initializeAndShow("",Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8619119_RefreshAddinsAfterClosingDialog")?B:null,null)}rRd(B,ra){var vb=Ka.TaskExtensions.Yq();if(-515602470===ra.command||-167264441===ra.command||-336193495===
ra.command||-1444574190===ra.command)vb=this.o4i(B,ra);418618014===ra.command&&(vb=new Jj.a,vb.Zs=Yb.a.instance.ia(1823),vb=this.P8(ra,ug.D8i,vb,!0));if((ra.tabName===this.$.xi+$e.a.DKg||ra.tabName===$e.a.g8)&&2===ra.jk||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback Tutorials".split(" "),B[Ic.a.Pi])||B[Ic.a.Pi]===$e.a.NK)return this.JQf(B,ra);if(7===ra.jk&&B.SourceControlId===this.$.xi+$e.a.PKa)return B.MenuItemId=$e.a.vhe,this.JQf(B,ra);1221897806===ra.command&&(vb=this.Xte(ra,
"Format"));if(1930653487===ra.command||1172793074===ra.command)vb=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",!1)?this.Xte(ra,"SnowballView"===ra.tabName?ra.tabName:"Data"):this.Xte(ra,"Data");-1753056834===ra.command&&(vb=this.RRk(ra));if(932597253===ra.command){ya.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested");ui.c(932597253,!0);vb=new Jj.a;vb.Zs=Yb.a.instance.ia(2163);vb.sourceLocationOverrideResourceId=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?ug.p$j:ug.r$j;vb.focusOnIframeWhenLoaded=!0;vb.taskPaneWidth=ug.NUf;var dc={};dc.LaunchSource=Object(Aa.a)(String,B.SourceControlId);dc.LaunchMode="Default";vb.UH=dc;vb=this.P8(ra,ug.q$j,vb,!0)}301511274===ra.command&&(vb=this.gSk(ra));if(515196233===ra.command){vb=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8093484_EnableCoauthCheckOnOptimize");if(dc=oa.a.lh(Sa.ve))dc.aha(),vb&&dc.Sej();dc=new Jj.a;dc.Zs=Yb.a.instance.ia(2237);const Hc={};Hc.SourceUILocation=Vk.a[ra.jk];Hc.TaskPaneVisualRefreshEnabled=
Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskPaneVisualRefreshEnabled",!1);vb&&(Hc.SessionID=this.$.fa.sessionId,Hc.EnableCoauthCheckOnOptimize=vb);dc.UH=Hc;vb=new Ui.a;vb.bba=Cb.a.fQb;vb=this.P8(ra,ug.p4j,dc,!0,vb,void 0,dc.Zs)}1723441034===ra.command&&(vb=new Jj.a,vb.Zs=Yb.a.instance.ia(2249),vb.focusOnIframeWhenLoaded=!0,vb.taskPaneWidth=ug.Lck,dc=new Ui.a,dc.bba=Cb.a.Awf,vb=this.P8(ra,Ek.e,vb,!0,dc));La.AFrameworkApplication.Iba(Ek.a)&&B.LoadDataFromPictureTaskpane&&
(vb={},dc=new Jj.a,dc.Zs=Yb.a.instance.ia(2276),vb.SessionID=B.SessionID,dc.UH=vb,dc.focusOnIframeWhenLoaded=!0,vb=this.P8(ra,B.DataFromPictureAssetId,dc,!0));762629271===ra.command&&(this.U8i(),vb=Ka.TaskExtensions.Yq());-1997160483!==ra.command&&1485761473!==ra.command||!ta.a.qV()||(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8777768_ColorFillEntryPointTrigger")&&"FillColor"===B.ParentMenuId&&(vb="ColorFill"+B.CommandValueId.replace(/(^\w|\s\w)/g,Hc=>Hc.toUpperCase()).replace(/\s+/g,""),ui.b(vb)),
vb=this.q3i(B,ra),ta.a.BWd()&&this.xHh.addListener());return vb}insertAgave(B,ra){var vb=Ka.TaskExtensions.Yq();const dc=this.$;var Hc=B[mc.a.yua];const ed=B[Ic.a.hl];let Id=null;Ui.a.key in B&&(Id=B[Ui.a.key]);this.noa&&this.noa.hide();if(!ed||!Hc)return ya.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),vb;this.$.Noa&&$e.a.Ara in B&&(ed.EnabledInViewMode=B[$e.a.Ara]);B=this.LIi(ra.command);if(!ed.EnabledInViewMode&&!dc.wy(null,!1,B))return vb;let Pd=void 0===
ed.IsToBePersisted||null===ed.IsToBePersisted||ed.IsToBePersisted?0:16;if(1===ed.TargetType)vb=this.Ufj(ed,Hc,ra,Id,Pd);else{Hc=ja.f(dc);vb=this.viewBlockContainerHelpers.iab(Hc);const Rd=dc.fa.isNamedObjectViewMode?dc.la.sheetName:dc.la.name;let $d,Ae,Ke,Ze;vb?(Hc=vb.jl,$d=Hc.zj.top,Ae=Hc.zj.left,Ke=vb.TT.x,Ze=vb.TT.y):($d=Ae=1,vb=this.viewBlockContainerHelpers.KKa(Hc),Ke=vb.x,Ze=vb.y);const cg=this.$.oa.ta.Wh();Pd|=64;vb=Wk.a(this.$.userOperationManager,(Vf,Xf,Pf)=>{var Kg=dc.oa.ta,oh=$d,Hg=Ae,
Gh=Ke,xi=Ze;Vf=ee.c(Vf,this.d$j);const Ah=Kg.Za(9,cg);Ah.sharedInfo=ed;Ah.sheetName=Rd;Ah.positionRow=oh;Ah.positionCol=Hg;Ah.positionOffsetX=Gh;Ah.positionOffsetY=xi;return uc.h(Kg,"InsertWebExtension",Ah,Vf,Xf,Pf,null,0)},Vf=>new Nd.a(534,0,Vf,Pd),ra)}return vb}g2h(){var B=Bb.a.instance.Dk("Common.App.ICustomerFeedbackUiWrapper"),ra={};La.AFrameworkApplication.ea.Yod(ra);B=B.instance.getContext(ra);ra={};"telemetryGroup"in B&&(ra=B.telemetryGroup);ra.processSessionId=B.sessionId;ra.officeBuild=
B.build;B.telemetryGroup=ra;B.feedbackType=-1;B.userVoiceEnabled=!1;"disableIncludeScreenshot"in B||(B.disableIncludeScreenshot=!1);"screenshot"in B||(B.screenshot=!1);B.disableScreenshotPreview=!1;B.includeScreenshotSelectedDefault=!0;return B}Jxg(B){if(!this.yOa){var ra=this.uNd();ra=this.hcf(ra);const vb=new Ui.a;vb.ay=Cb.a.jQb;vb.bba=Cb.a.Jwf;vb.szb=Cb.a.UFd;this.yOa=this.QXc(ra,null,!1,null,vb);$l.b(this.$).sj(Zl.a.O$j,{["Location"]:B?Vk.a[B.jk]:0,["InputMethod"]:B?Xl.a[B.method]:0},void 0,!0)}}fQg(B){const ra=
this.$.fa.Dn.get(17);Bb.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(vb=>{vb.isFeatureEnabled("mso_sendASmile",ra).then(dc=>{B.FeedbackEnabled=ra&&dc;return null})})}Jnj(){return this.ti.ytj(this.ti.LJa(ug.V0a,this.uNd()))}onPaneClosed(B){var ra;switch(B){case ug.ytc:null===(ra=this.$o)||void 0===ra?void 0:ra.unregister("Copilot")}}Xte(B,ra){const vb=ja.f(this.$),dc=new Jj.a;var Hc={};Hc.ActiveTab=ra;Hc.IsRTL=this.$.isChromeRtl;Hc.DatapaneFlighting=!0;Hc.MergeIvyBiDataSources=
!0;Hc.ComboChartUIInXLO=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",!1);Hc.ThemeColorsFlighting=!0;Hc.FormatTaskPaneUXImprovePhase2=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);Hc.ChartTPNewFontAndColorTheme=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",!1);Hc.UOMirrorTaskPaneRefactor=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirrorTaskPaneRefactor",
!1);Hc.DataPaneAddNewField=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataPaneAddNewField",!1);Hc.LineFormatTaskPane=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSLineFormatTaskPane",!1);Hc.ChartTaskPaneNewTheme=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneNewTheme",!1);Hc.SnowballChartImprovement=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",!1);Hc.NewTaskPaneEndUserFeedback=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewTaskPaneEndUserFeedback",
!1);this.fQg(Hc);Hc.startTimeMs=Date.now();Hc.UserSessionId=this.$.ua.UserSessionId;(ra=vb.ha.$a.np)&&(Hc.SubSelection=ra);ya.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${Hc.UserSessionId}, UILocation: ${void 0===B.jk||null===B.jk?"Null":Vk.a[B.jk]}, SubSelection: ${ra||"ChartRoot"}`);dc.UH=Hc;dc.Zs=Yb.a.instance.ia(984);Hc=new Ui.a;Hc.bba=Cb.a.fQb;return this.P8(B,ug.PWh,dc,!0,Hc)}RRk(B){const ra=new Jj.a;ra.UH={};ra.Zs=Yb.a.instance.ia(1809);ra.DW=ug.q8f;const vb=
new Ui.a;vb.bba=Cb.a.fQb;return this.P8(B,ug.q8f,ra,!0,vb,void 0,ra.Zs)}gSk(B){const ra=new Jj.a;ra.UH={};ra.Zs=Yb.a.instance.ia(2187);const vb=new Ui.a;vb.bba=Cb.a.qqi;vb.szb=Cb.a.Mwf;const dc=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavPaneWebReadOnly",!1);return this.P8(B,ug.PKj,ra,!0,vb,dc)}JQf(B,ra){const vb=ug.G8i;var dc=B[Ic.a.Pi].toString();const Hc={},ed=new Jj.a;ed.Zs=Yb.a.instance.ia(9);switch(dc){case "A0":Hc.query=(B[Ic.a.hl]||"").split("|").slice(2,Yl.a.v9).join("|");
break;case "A1":Hc.query=B.CommandValueId;break;case "Help":Hc.query="";ed.DW="HelpTaskPane";break;case $e.a.vhe:ed.Zs=Yb.a.instance.ia(1775);ed.sourceLocationOverrideResourceId=ug.DQd;Hc.feedback=this.g2h();break;case "HelpArticle":Hc.query=B[Ic.a.hl];break;case "Tutorials":Hc.query=B.CommandValueId;break;case "ContactSupport":Hc.query=dc;ed.sourceLocationOverrideResourceId=ug.o2h;ed.Zs=Yb.a.instance.ia(2389);ed.DW="ContactSupportTaskPane";break;case "ShowTraining":case "WhatsNew":Hc.query=dc;break;
default:return Cf.Task.Ua(!0)}ed.UH=Hc;dc=new Ui.a;dc.bba=Cb.a.fQb;B=B[$e.a.Ara]||!1;return this.P8(ra,vb,ed,Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8469439_UseSdxActivationFlow"),dc,B)}hcf(B){const ra={};ra.SolutionId=ug.V0a;ra.Version="0.0.0.0";ra.StoreType=OSF.StoreType.Sdx;ra.StoreId=OSF.StoreType.Sdx;ra.AssetId=null;ra.AssetStoreId=null;ra.Height=0;ra.Width=0;ra.TargetType=OSF.OsfControlTarget.TaskPane;ra.IsToBePersisted=!1;ra.SourceLocationOverrideResourceId=B;ra.SharedRuntimeId=B;return ra}o4i(B,
ra){const vb=new Jj.a,dc=new Ui.a,Hc={};this.yOa&&this.fQg(Hc);Hc.LaunchSource="";Hc.StartTimeMs=Date.now();Hc.CorrelationId=Nb.a.create().toString();vb.UH=Hc;vb.focusOnIframeWhenLoaded=!0;vb.taskPaneWidth=ug.NUf;dc.bba=Cb.a.Jwf;dc.szb=Cb.a.UFd;switch(ra.command){case -1444574190:let ed,Id,Pd;Hc.LaunchMode="RecommendedPivotTables";Hc.SelectionContext="";Hc.LaunchSource="PivotTableHandRaise"===Object(Aa.a)(String,B.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
B.SourceSelection){const Rd=B.SourceSelection.split(",")[0],$d=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if((()=>{let Ae=Zc.jb(Rd,this.$.sa);({sheetName:ed,zBg:Id,range:Pd}=Ae);return Ae})().returnValue&&!ja.f(this.$).oh.NY(Pd))B=this.$.sa.getItemByName(ed),Hc.SelectionContext=JSON.stringify(Object(lj.a)(new Ck,{address:Id,addressWithSheet:ed+"!"+Pd.ME(!1),sheetId:$b.d(B),sheetName:ed,isSheetEmpty:!1,columnCount:Pd.width,rowCount:Pd.height,columnIndex:Pd.left+
$d,rowIndex:Pd.top+$d,selectionType:"Continuous"}));else if((B=this.$.$h.getItemByName(Object(Aa.a)(String,B.SourceSelection)))&&$b.m(B)){Pd=Ml.a(B,!0);const Ae=this.$.sa.getItemByName(B.sheetName);Hc.SelectionContext=JSON.stringify(Object(lj.a)(new ul,{tableName:B.name,hasTableHeaders:Ml.d(B),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Pd.ME(!1),addressWithSheet:Ae.name+"!"+Pd.ME(!1),sheetId:$b.d(Ae),sheetName:Ae.name,isSheetEmpty:!1,columnCount:Pd.width,rowCount:Pd.height,columnIndex:Pd.left+
$d,rowIndex:Pd.top+$d,selectionType:"Continuous"}))}}vb.Zs=Yb.a.instance.ia(1821);vb.DW=ug.o8j;vb.ay=Cb.a.Ayf;dc.ay=Cb.a.Ayf;break;case -336193495:Hc.LaunchMode="RecommendedCharts";vb.Zs=Yb.a.instance.ia(1820);vb.DW=ug.xhk;vb.ay=Cb.a.Byf;dc.ay=Cb.a.Byf;break;case -167264441:Hc.LaunchMode="ExcelIntelligence";Hc.TableName=B.tableName;vb.Zs=Yb.a.instance.ia(2287);vb.DW=ug.T7e;vb.ay=Cb.a.jQb;dc.ay=Cb.a.jQb;break;default:Hc.LaunchMode="Default",vb.Zs=Yb.a.instance.ia(1822),vb.DW=ug.T7e,vb.ay=Cb.a.jQb,
dc.ay=Cb.a.jQb}vb.sourceLocationOverrideResourceId=this.uNd();return this.yOa?this.yOa.nB(()=>this.rBk(Hc,vb)):this.Ldj(ra,vb,dc,Hc)}U8i(){const B=this.ti.a6(ug.ytc);if(B){const ra=this.r_k(B);ta.a.xp()?void oa.a.resolve(Sa.lf,{va:0}).then(vb=>vb.hideTaskPane(ra)):void Wf.a.fo().then(vb=>{vb.hideTaskPane(ra,2);return null})}}r_k(B){return ug.s_k+B.replace(/[{}]/g,"")}RKf(){const B=oa.a.lh(Sa.re),ra=ti.c()&&appChrome.api.isCachedControlVisible($e.a.QOa);return void 0!==B?B.CYb:ra}eQi(){const B=new Jj.a;
B.Zs=appChrome.getCopilotString();let ra=!1;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8583475_CheckAccountTypeForPreviewTag")&&(ra="msa"===La.AFrameworkApplication.ea.Ya("HostAuthType").toLowerCase());(ra?Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitleConsumer",!1):Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitle",!1))||(B.F0g=appChrome.getPreviewTaskPaneHeaderTagString());Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")&&
(B.DW=ug.p4h);B.focusOnIframeWhenLoaded=!0;B.taskPaneWidth=ug.zpf;return B}fQi(){const B={};B.AudienceGroup=La.AFrameworkApplication.mi.AudienceGroup;B.StartTimeMs=Date.now();Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8337949_sendAnnotationsToCopilotOnOpen")&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FA000000124.TabularRangeSupportForCopilot",!1)&&(B.TableBoundaries=this.qZi());B.HandoffMessageId=this.$.ua.HandoffMessageId;const ra=Ga.EwaSettings.getBooleanFeatureGate(vl.a.Gva,
!1),vb=Ga.EwaSettings.getBooleanFeatureGate(vl.a.Jkf,!1);B.CopilotSaveAutomation=ra&&this.RKf();B.CopilotPAIntegration=vb&&this.RKf();return B}q3i(B,ra){const vb=this.eQi();var dc=this.fQi();Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)&&B.MenuItemId&&(dc.CopilotStartQuery=JSON.stringify(B.MenuItemId));B=Ol.a.EJf(this.$,!0,"Copilot",{});const Hc={};Hc.devProperties=B.jx;Hc.optionalProperties=B.Bk;dc.LaunchOfficeScriptsSDXOptionalProperties=
JSON.stringify(Hc);vb.UH=dc;const ed=new Ui.a;ed.bba=Cb.a.Awf;const Id=Rd=>{Rd.register(Rd.k6().I8("Copilot").H8(()=>{ya.ULS.sendTraceTag(508347875,0,15,"Copilot AugLoop host received close message")}).activateAnnotation({annotationType:"FakeCopilotAnnotation",EA:!1,Plj:!0}).build())},Pd=()=>this.JUg?Object(Ti.d)(Object(Kl.a)(this.sNj).then(this.BCk.bind(this)).catch(Rd=>{ya.ULS.sendTraceTag(507562076,0,10,`[Copilot Chat] Failed to get and send token. ${Rd}`)}).then(()=>Object(Ti.a)(this.P8(ra,ug.ytc,
vb,!0,ed)))):this.P8(ra,ug.ytc,vb,!0,ed);if(this.$o)return Id(this.$o),Pd();dc=oa.a.resolve(Sa.r,{va:1});return Object(Ti.d)(dc.then(Rd=>{this.$o=Rd;Id(this.$o);ya.ULS.sendTraceTag(508347904,0,15,"Copilot proxy created IAugmentationLoopManager manager");Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8857394_InitPowerQueryOnCopilotLoad")&&this.pzj();return Object(Ti.a)(Pd())}))}pzj(){void oa.a.resolve(Sa.Se,{va:5})}Ldj(B,ra,vb,dc){this.yOa=this.QXc(this.hcf(ra.sourceLocationOverrideResourceId),ra,!1,
B,vb,!1);dc.NoActionMsgOnFirstInstance=!0;this.jQa[ug.V0a]=dc;return this.yOa}rBk(B,ra){const vb=this.ti.a6(this.ti.LJa(ug.V0a,ra.sourceLocationOverrideResourceId));if(vb){this.jQa[ug.V0a]=B;const {HTc:dc,OQb:Hc}=this.VNc(this.ti.gY(vb).OsfPropertyBag,ug.V0a);this.ti.gY(vb).OsfPropertyBag=dc;this.ti.gY(vb).HostPropertyBag=Hc}this.Bza(ug.V0a,sc.a.taskpane,"LaunchIdeasAction",B,"1.0.0.0",ra);return Cf.Task.Ua(!0)}uNd(){switch(La.AFrameworkApplication.ea.Ya("SovereignEnvironmentName")){case "USGov":return"Insights.Https.GCC.Bundle";
case "Pathfinder":return"Insights.Https.DOD.Bundle";case "Trailblazer":return"Insights.Https.GCCH.Bundle"}const B=La.AFrameworkApplication.mi.AudienceGroup;if(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(B){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(B){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}P8(B,ra,vb,dc,Hc,ed,Id){vb=
void 0===vb?null:vb;dc=void 0===dc?!1:dc;Hc=void 0===Hc?null:Hc;ed=void 0===ed?!1:ed;Id=void 0===Id?null:Id;Ka.TaskExtensions.Yq();vb||(vb=new Jj.a);const Pd={};Pd.SolutionId=ra;Pd.Version="0.0.0.0";Pd.StoreType=dc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Pd.StoreId=dc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Pd.AssetId=null;Pd.AssetStoreId=null;Pd.Height=0;Pd.Width=0;Pd.TargetType=OSF.OsfControlTarget.TaskPane;Pd.IsToBePersisted=!1;Pd.SourceLocationOverrideResourceId=vb.sourceLocationOverrideResourceId;
if(vb.Zs||Id)this.wId[ra]=Object(lj.a)(new tl,{e2c:vb.Zs,Gxe:vb.F0g,Fxe:vb.showResizeChatButton,Dxe:Id,d2c:vb.DW});vb.UH||(vb.UH={});vb.UH.ShowFeedback=this.$.isFeedbackEnabled;this.jQa[ra]=vb.UH;this.soe[ra]=vb.onExtensionLaunchCallback;ra={};ra[Ic.a.hl]=Pd;Id={};Id.solutionId=Pd.SolutionId;Id.version=Pd.Version;Id.storeType=Pd.StoreType;Id.storeId=Pd.StoreId;Id.assetId=Pd.AssetId;Id.assetStoreId=Pd.AssetStoreId;Id.height=Pd.Height;Id.targetType=Pd.TargetType;Id.width=Pd.Width;Id.isAddinCommands=
!dc;ra[mc.a.yua]=Id;Hc||(Hc=new Ui.a);Hc.focusOnIframeWhenLoaded=vb.focusOnIframeWhenLoaded;Hc.width=vb.taskPaneWidth;Hc.showLoadingSpinner=vb.showLoadingSpinner;ra[Ui.a.key]=Hc;ra[$e.a.Ara]=ed;return this.insertAgave(ra,B)}Ufj(B,ra,vb,dc,Hc){const ed=($d,Ae)=>{var Ke=$d.SolutionId;const Ze=OSF.OsfControl.isFirstPartyStoreString($d.StoreType);Ze&&$d.SourceLocationOverrideResourceId&&(Ke=this.ti.LJa(Ke,$d.SourceLocationOverrideResourceId));var cg=this.ti.Qff(Ke,null,$d.SharedRuntimeId);if(Ze){if(cg&&
(Ke=this.ti.a6(Ke))){const {HTc:Vf,OQb:Xf}=this.VNc(this.ti.gY(Ke).OsfPropertyBag,$d.SolutionId);if(Ke=this.ti.Fl.getOsfControl(Ke))Ke.setSettings(Vf),Ke.setHostSettings(Xf)}$d.SharedRuntimeId&&cg||this.ti.Fl.refreshOsfControl($d.SolutionId,$d.SourceLocationOverrideResourceId)}if(!cg){const Vf=this.$.oa.ta.Wh();let Xf=519;cg=(Pf,Kg,oh)=>{var Hg=this.$.oa.ta;Pf=ee.c(Pf,this.kxg);const Gh=Hg.Za(9,Vf);Gh.sharedInfo=$d;return uc.h(Hg,"InsertAgaveTaskpane",Gh,Pf,Kg,oh,dc,0)};void 0===$d.IsToBePersisted||
null===$d.IsToBePersisted||$d.IsToBePersisted||(Xf=538,cg=(Pf,Kg,oh)=>{var Hg=Telemetry.PrivacyRules.GetPrivacyCompliantId($d.SolutionId,$d.StoreType,$d.AssetId,null,null,$d.StoreId);ya.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${$d.StoreType}, StoreId ${$d.StoreId}, SolutionId ${Hg}.`);Hg=this.$.oa.ta;Pf=ee.c(Pf,this.kxg);const Gh=Hg.Za(9,void 0===Vf?null:Vf);Gh.sharedInfo=$d;return uc.h(Hg,"ShowAgaveTaskpane",Gh,Pf,Kg,oh,dc,0)});Hc|=64;return Wk.a(this.$.userOperationManager,
cg,Pf=>new Nd.a(Xf,0,Pf,Hc),Ae)}return Ka.TaskExtensions.Vaa()},Id=$d=>{var Ae=Telemetry.PrivacyRules.GetPrivacyCompliantId($d.solutionId,$d.storeType,$d.assetId,null,null,$d.storeId);ya.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Ae} from ${$d.storeType}.`);Ae={};const Ke=[];Ke.push($d);Ae[mc.a.mJb]=Ke;Ae[mc.a.D4]=3;$d=new Ie.a(Ag.a.Nqb,0,this.$.ji,0,null);return this.$.Ia.qh($d,Ae)};if(!Ga.EwaSettings.Na(52)||B.StoreId===OSF.StoreType.FirstParty)return ed(B,vb,dc);if(ra.isAddinCommands)return Id(ra);
const Pd=new le.a,Rd={};Rd.solutionId=B.SolutionId;Rd.version=B.Version;Rd.storeType=B.StoreType;Rd.storeId=B.StoreId;Rd.targetData=B;this.ti.Fl.isAddinCommandsAsync(Rd,($d,Ae,Ke)=>{Pd.setResult(Ae);$d||($d=Ke.targetData,Ae=Telemetry.PrivacyRules.GetPrivacyCompliantId($d.SolutionId,$d.StoreType,$d.AssetId,null,null,$d.StoreId),ya.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Ae} from ${$d.StoreType} during addin inserting`))});return Ka.TaskExtensions.ts(Pd.task,$d=>$d.result?
Id(ra):ed(B,vb,dc),this.$.ya)}VNc(B,ra){if(!this.jQa[ra])return{Wvl:B,OQb:null};const vb={},dc={};if(B)for(var Hc of B){const [Id,Pd]=Hc;vb[Id]=Pd}B=this.jQa[ra];for(var ed of Object.keys(B))Hc=B[ed],ed===ug.Hvi?vb[ed]=dc[ed]=Sys.Serialization.JavaScriptSerializer.serialize(Hc):(!Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8380805_LogsToInvestigateMergeFirstPartySettingsCrash_2")||null!==Hc&&void 0!==Hc||ya.ULS.sendTraceTag(508072652,220,15,"AgaveCommandHandler.mergeFirstPartySettings: value is null or undefined. firstPartySolutionId: "+
ra+". key: "+ed+". value is null: "+(null===Hc)),vb[ed]=dc[ed]=Sys.Serialization.JavaScriptSerializer.serialize(Hc.toString()));ra=Object.keys(vb).map(Id=>[Id,vb[Id].toString()]);ed=Object.keys(dc).map(Id=>[Id,dc[Id].toString()]);return{HTc:ra,OQb:ed}}SBj(B,ra,vb){const dc=this.$.ua.UserSessionId,Hc=this.$.ua.UICultureTag,ed=this.$.ua.UICultureTagLcid,Id=this.$.ua.WacHostId;let Pd="",Rd="";5<=vb.length&&(Pd=vb[3],Rd=vb[4]);this.TBj(Pd,Rd,B,ra,Hc,ed,dc,Id)}TBj(B,ra,vb,dc,Hc,ed,Id,Pd){const Rd={};Rd.a=
Id;Rd.b=vb;Rd.c=dc;Rd.d=B;Rd.e=ra;Rd.f=Hc;Rd.g=ed;Rd.h=Pd;Jf.b().Ol(36,Rd)}QXc(B,ra,vb,dc,Hc,ed){ra=void 0===ra?null:ra;vb=void 0===vb?!1:vb;dc=void 0===dc?null:dc;Hc=void 0===Hc?null:Hc;ed=void 0===ed?!0:ed;var Id=B.SolutionId,Pd=Cf.Task.Ua(!1);B&&Id&&B.SharedRuntimeId&&(dc=dc||new Ie.a(-859308420,0,2,0,""),Id={},Id.solutionId=B.SolutionId,Id.version=B.Version,Id.storeType=B.StoreType,Id.storeId=B.StoreId,Id.assetId=B.AssetId,Id.assetStoreId=B.AssetStoreId,Id.height=B.Height,Id.targetType=B.TargetType,
Id.width=0,Id.isAddinCommands=!1,Id.sharedRuntimeId=B.SharedRuntimeId,B.Preload=ed,Hc=Hc?Hc:new Ui.a,Hc.width=0,ra&&(ed=ra,Hc.focusOnIframeWhenLoaded=ed.focusOnIframeWhenLoaded,Pd=new tl,ed.Zs&&(Pd.e2c=ed.Zs),0<ed.taskPaneWidth&&(Pd.h_=ed.taskPaneWidth),ed.DW&&(Pd.d2c=ed.DW),Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&ed.UH&&(this.jQa[B.SolutionId]=ra.UH),this.wId[B.SolutionId]=Pd,this.soe[B.SolutionId]=ra.onExtensionLaunchCallback),ra={},ra[Ic.a.hl]=B,ra[mc.a.yua]=
Id,ra[Ui.a.key]=Hc,ra[$e.a.Ara]=vb,Pd=this.insertAgave(ra,dc));return Pd}Bza(B,ra,vb,dc,Hc,ed){ed=void 0===ed?null:ed;if(B&&vb){B=new V.a(B,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Hc);Hc=new Kc.a("ExcelOnline","Web",this.$.ua.UICultureTag);const Id=new Fa.a;Id.Bk[Yg.a.Ond]=dc;ed&&(dc=ed,dc.sourceLocationOverrideResourceId&&(Id.Bk[Yg.a.sourceLocationOverrideResourceId]=dc.sourceLocationOverrideResourceId),dc.Zs&&(Id.Bk[Yg.a.Zs]=dc.Zs),dc.ay&&(Id.Bk.IconCssClass=dc.ay),dc.Axe&&(Id.Bk.TaskPaneIconUrl=dc.Axe),
dc.DW&&(Id.Bk.TaskPaneIconId=dc.DW),dc.onExtensionLaunchCallback&&(Id.Bk[Yg.a.onExtensionLaunchCallback]=dc.onExtensionLaunchCallback));vb&&(Id.Bk[Yg.a.actionName]=vb);Ba.a.instance.Bza(B,ra,vb,Hc,Id)}}jTi(B){if(!wb.a.Km(B)){var ra=B[Kj.a.qQb];if(ra&&(ra=ra.getId(),B=B[Kj.a.Ppa],ra&&B))return this.LJa(ra,B.Bk[Yg.a.sourceLocationOverrideResourceId])}return null}LJa(B,ra){ra=void 0===ra?null:ra;return B&&ra?`${B}.${ra}`:B}LIi(B){switch(B){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:return 1;
case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;case 301511274:return 1023;default:return 1}}r3g(){this.$.fa.um?this.MUc():Ga.EwaSettings.ul()?this.$.fa.lr(this.MUc):(this.$.fa.mr(this.MUc),this.Mie=!0)}qZi(){var B=oa.a.lh(Sa.xg);if(!B)return this.r3g(),"";B=B.Taa();if(!B)return this.r3g(),"";var ra=this.$.sa.getItemByName(this.$.fa.isNamedObjectViewMode?this.$.la.sheetName:this.$.la.name);ra=$b.d(ra);var vb=ja.f(this.$).ha.pa.selectedRanges;const dc=[];for(const ed of vb){vb=
new am.a(ed,ra);var Hc=B.BKa(vb,Xk.Valid);vb=[];if(Hc)for(const Id of Hc)(Hc=Id.table.analyzedRange)&&(Hc=Hc.range.toString())&&vb.push(Hc);vb=new ik(ed.toString(),vb);dc.push(vb)}return JSON.stringify(dc)}}ug.kce="IDS";ug.G8i="FA000000012";ug.V0a="FA000000005";ug.D8i="HelloWorld";ug.PWh="FA000000014";ug.DQd="Help.GiveFeedback.Url";ug.o2h="Help.ContactSupport.Url";ug.Hvi="feedback";ug.q8f="FA000000066";ug.r$j="PowerBi.Url";ug.p$j="PowerBi.DevUrl";ug.q$j="FA000000054";ug.PKj="FA000000064";ug.p4j="FA000000075";
ug.T7e="AnalyzeDataTaskPane";ug.xhk="RecommendedChartsTaskPane";ug.o8j="PivotTableTaskPane";ug.NUf=320;ug.Lck=320;ug.p4h="CopilotSDXTaskpane";ug.ytc="FA000000124";ug.zpf=350;ug.s_k="AgaveTaskPane-";ug.CGh="g_InstallOrigin";Object(ha.a)(ug,"AgaveCommandManager",Gj.a,[267,268]);class Fk extends ek.a{constructor(B){super();this.$=B;this.sn()}create(){const B=this.$.qa,ra=Sa.yb.Ma()?Object(Ti.d)(oa.a.resolve(Sa.yb,{va:this.gi})):Yc.GetServiceTaskFactory.create(B,106,this.ya,this.gi),vb=Yc.GetServiceTaskFactory.create(B,
104,this.ya,this.gi),dc=Object(Ti.d)(oa.a.resolve(Sa.i));Ka.TaskExtensions.$e(Ka.TaskExtensions.Dq([vb,ra,dc],this.ya),()=>{let Hc=null;Hc=Bb.a.instance.Dk("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance;Xj.instance.initialize(ra.result);const ed=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(rl.a)(this.$.qa,374,()=>new ug(this.$,ra.result,vb.result,Hc,La.AFrameworkApplication.xh,dc.result,Bb.a.instance.Dk("Common.App.OAuth.IOAuthManager"))):
new ug(this.$,ra.result,vb.result,Hc,La.AFrameworkApplication.xh,dc.result,Bb.a.instance.Dk("Common.App.OAuth.IOAuthManager"));B.Rh(206,ed);this.dl(B.zh(374)||B.Rh(374,ed))},this.ya,3);Bb.a.instance.register(Jl.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Ai().Ii(()=>new Jl.a(this.$.wK))}static Ga(B){B.qa.Rh(375,new Fk(B))}}Object(ha.a)(Fk,"AgaveCommandManagerFactory",ek.a,[]);class wl extends ye.a{constructor(B){super(B)}sw(){const B=Sa.yb.Ma()?Object(Ti.d)(oa.a.resolve(Sa.yb,
{va:this.gi})):Yc.GetServiceTaskFactory.create(this.$.qa,106,this.ya,this.gi),ra=Object(Ti.d)(oa.a.resolve(Sa.ge,{va:this.gi})),vb=xf.a(this.ya,this.gi),dc=Object(Ti.d)(oa.a.resolve(Sa.rd,{va:this.gi})),Hc=Sa.Xb.Ma()?Object(Ti.d)(oa.a.resolve(Sa.Xb,{va:this.gi})):Cf.Task.Ua(null);Ka.TaskExtensions.$e(Ka.TaskExtensions.Dq([B,ra,vb,dc,Hc],this.ya),()=>{const Id=B.result,Pd=Bb.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Zt([new af(this.$,Id,Pd,dc.result,
Hc.result)])},this.ya,3);const ed=Bb.a.instance;Sa.pd.Ma()?void oa.a.resolve(Sa.pd,{va:this.gi}).then(()=>{Bb.a.instance.register(sg,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Ai().Ii(()=>new sg)}):Ka.TaskExtensions.$e(Yc.GetServiceTaskFactory.create(this.$.qa,137,this.$.ya,this.gi),()=>{ed.register(sg,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Ai().Ii(()=>new sg)},this.$.ya)}static Ga(B){ye.a.jB(82,new wl(B))}}Object(ha.a)(wl,
"DdaCommandHandlerFactory",ye.a,[]);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1130);(()=>{yk.a.hh(B=>{Ga.EwaSettings.Na(52)&&ol.Ga(B)})})();(()=>{yk.a.hh(B=>{Ga.EwaSettings.Na(114)&&Uk.Ga(B)})})();(()=>{yk.a.hh(B=>{Sa.yb.Ma()||Ak.Ga(B)})})();(()=>{yk.a.hh(B=>{Sa.h.Ma()&&Sa.mg.Ma()||Bk.Ga(B);Fk.Ga(B)})})();(()=>{yk.a.hh(B=>{wl.Ga(B)})})();String(K);String(E);String(U);String(Xa);String(X);String(ia);String(Ma);String(qa);String(Qj);window.___1712031311577_closurehack=
K;window.___1712031311577_closurehack=E;window.___1712031311577_closurehack=U;window.___1712031311577_closurehack=Xa;window.___1712031311577_closurehack=X;window.___1712031311577_closurehack=ia;window.___1712031311577_closurehack=Ma;window.___1712031311577_closurehack=qa;window.___1712031311577_closurehack=Qj},958:function(y,m,a){a.r(m);a.d(m,"DdaFacade",function(){return Ge});var c=a(0),b=a(2),e=a(15),k=a(1625),d=a(116);class u{constructor(ca,sb,Ba){this._id=ca;this.dih=sb;this.jkh=Ba;this.CXf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get DGh(){return this.dih}get M_h(){return this.jkh}execute(ca,
sb,Ba){Ba=Ba||{};Ba.commandMode=this.CXf;sb.invokeAppCommand(this.DGh,this.M_h,Ba,()=>{ca.mYj(this.id)})}}Object(c.a)(u,"AddinNativeActionBase",null,[357]);class n extends u{constructor(ca,sb){super(1,ca,sb);this.CXf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(n,"AddinTakeSnapshotAction",u,[]);class v{a5h(ca){return new u(3,ca,this.cFi().getNativeActionName(3))}cFi(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(v,"AddinNativeActionManager",null,[342]);var f=
a(242);class w{invokeAppCommand(ca,sb,Ba,V){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ca,sb,Ba,V)}static getInstance(){w.Va||(w.Va=new w);return w.Va}}w.Va=null;Object(c.a)(w,"OSFAddinCommandsRuntimeManager",null,[343]);var r=a(6),t=a(249);class l extends f.a{constructor(ca,sb,Ba){super();this.vla=null;this.wmd="WACDialogTitleText";this.I9="0";this.Aka="15px";this.Dkh="0px";this.H9="calc(100% - 30px)";this.Ckh="100%";this.wXe=0;this.ih=new d.a;this.fih=new v;this.Oh=5;this.fl=this.USa=
Ba;this.qad=ca;this.FLe=sb;this.Lad=!!r.AFrameworkApplication.ea&&r.AFrameworkApplication.ea.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}HEh(ca){this.ih.addHandler("OnDialogClosedEventKey",ca)}hHk(){this.ZTa=null}vG(){super.vG();this.Yo.style.width="100%";this.Yo.style.height=this.wUb?this.H9:this.Ckh;this.Yo.style.marginTop=this.wUb?this.Aka:this.Dkh;this.Yo.style.padding=this.I9}zT(){super.zT();this.rh.style.width=String.format("{0}px",this.qad*window.innerWidth/100);this.rh.style.height=
String.format("{0}px",this.FLe*window.innerHeight/100);this.rh.style.minWidth="0px";this.Lad&&r.AFrameworkApplication.isRtl&&100===this.qad&&(this.rh.style.right="0px",this.rh.style.marginRight="0px");this.vla=document.getElementById(this.hp(this.wmd));this.vla.style.position="absolute";this.vla.style.whiteSpace="nowrap";this.vla.style.textOverflow="ellipsis";r.AFrameworkApplication.isRtl?(this.vla.style.right="14px",this.vla.style.left="44px"):(this.vla.style.right="44px",this.vla.style.left="14px")}yL(ca){super.yL(ca);
this.vla&&this.vla.setAttribute("title",ca)}get Yma(){return this.Yo}ime(){this.rh.style.width=String.format("{0}px",this.qad*window.innerWidth/100);this.rh.style.height=String.format("{0}px",this.FLe*window.innerHeight/100);this.rh.style.overflowY="hidden";this.rh.style.overflowX="hidden";this.rh.style.marginTop="";this.rh.style.top="";this.rh.style.left="";this.rh.style.marginLeft=""}hide(){this.fih.a5h(this.USa).execute(this,w.getInstance(),{});this.wXe=window.setTimeout(()=>{this.ih.raiseEvent("OnDialogClosedEventKey",
this.USa);t.a.prototype.hide.call(this)},500)}mYj(ca){3===ca&&(window.clearTimeout(this.wXe),this.ih.raiseEvent("OnDialogClosedEventKey",this.USa),super.hide())}}Object(c.a)(l,"AppsForOfficeDialog",f.a,[325,326]);class x{constructor(){this.dialog=this.fl=null}}Object(c.a)(x,"DialogInfo",null,[]);class A{}A.url="url";A.height="height";A.width="width";A.tDd="displayInIframe";A.bFc="hideTitle";Object(c.a)(A,"DialogSettings",null,[]);class z{constructor(){this.height=this.width=0;this.fl=this.controlId=
this.pageUrl=null;this.bFc=this.tDd=!1}}Object(c.a)(z,"DisplayDialogParams",null,[]);class F extends Sys.EventArgs{constructor(ca,sb,Ba,V,Fa){Ba=void 0===Ba?null:Ba;V=void 0===V?"":V;Fa=void 0===Fa?"":Fa;super();this.controlId=ca;this.messageType=sb;this.messageContent=Ba;this.messageOrigin=V;this.targetOrigin=Fa}}Object(c.a)(F,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class D extends Sys.EventArgs{constructor(ca,sb,Ba,V,Fa){Ba=void 0===Ba?null:Ba;V=void 0===V?"":V;Fa=void 0===Fa?"":Fa;super();
this.controlId=ca;this.messageType=sb;this.messageContent=Ba;this.messageOrigin=V;this.targetOrigin=Fa}}Object(c.a)(D,"OnMessageParentEventArgs",Sys.EventArgs,[]);var G=a(47),Q=a(34),O=a(191),J=a(107),H=a(24);class N{constructor(ca){this.ih=new d.a;this.cSj=(sb,Ba)=>{if(sb=this.u_a(Ba))this.Er.purgeDialogControl(Ba),N.mka.remove(sb),this.ih.raiseEvent("OnMessageParentEventKey",new D(sb,OSF.DialogMessageType.DialogClosed,null,null,"*"))};this.Er=ca}REh(ca){this.ih.addHandler("OnMessageParentEventKey",
ca)}QEh(ca){this.ih.addHandler("OnMessageDialogEventKey",ca)}showDialog(ca,sb,Ba,V){if(N.mka.mh(sb))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Kd=G.b(ca),Zd=Kd[A.url];if(this.Er.getOsfControl(sb).checkAppDomains(Zd)){var Fa=new z;Fa.width=Kd[A.width];Fa.height=Kd[A.height];Fa.pageUrl=Zd;Fa.tDd=Kd[A.tDd];Fa.bFc=Kd[A.bFc];Fa.controlId=sb;Fa.fl=O.a.create().toString();
var sc=new x;sc.fl=Fa.fl;var Kc=this.Er.getOsfControl(Fa.controlId).getManifest().getDefaultDisplayName(),qd=this.Er.getOsfControl(Fa.controlId).getStoreType().toLowerCase();ca=null;ca=(4===r.AFrameworkApplication.ra.$g.qn&&"hardcodedpreinstall"===qd||"sdxcatalog"===qd)&&Fa.bFc?this.createAndShowAppsForOfficeDialog(Fa.width,Fa.height,Fa.fl,!0,Kc):this.createAndShowAppsForOfficeDialog(Fa.width,Fa.height,Fa.fl,!1,Kc);var Eb=this.Er.getOsfControl(Fa.controlId),vc=Eb.getManifest();sb={};sb.id=Fa.fl;sb.solutionId=
Eb.getSolutionId();sb.version=Eb.getVersion();sb.storeType=qd;sb.storeId=Eb.getStoreId();sb.assetId=Eb.getAssetId();sb.assetStoreId=Eb.getAssetStoreId();sb.ownerAddinSolutionId=Eb.getOwnerAddinSolutionId();sb.ownerAddinStoreType=Eb.getOwnerAddinStoreType();sb.appDomains=vc.getAppDomains();sb.dialogUrl=Zd;sb.osfControlType=1;sb.agaveName=Kc;sb.div=ca.Yma;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(sb.solutionId,sb.ownerAddinStoreType||
sb.storeType,sb.assetId,null,null,sb.storeId),Q.a.uE(Fa.pageUrl));this.Er.insertDialogControl(sb);ca.HEh(this.cSj);sc.dialog=ca;N.mka.ga(Fa.controlId,sc);V&&V(sb);Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Kd){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Kd.message),Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}JHj(ca,
sb,Ba,V){r.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===V&&(V=Ba);try{const Fa=this.u_a(ca);Fa&&this.ih.raiseEvent("OnMessageParentEventKey",new D(Fa,OSF.DialogMessageType.DialogMessageReceived,sb,Ba,V))}catch(Fa){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Fa.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}wXa(ca,
sb){if(N.mka.mh(ca))try{const Ba=N.mka.ma(ca);Ba.dialog&&Ba.dialog.hide();this.Er.purgeDialogControl(Ba.fl);N.mka.remove(ca);sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ba){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Ba.message),sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}$Bk(ca,
sb,Ba,V){r.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===V&&(V=Ba);if(N.mka.mh(ca)&&(ca=N.mka.ma(ca),ca.dialog))try{this.ih.raiseEvent("OnMessageDialogEventKey",new F(ca.fl,OSF.DialogMessageType.DialogParentMessageReceived,sb,Ba,V))}catch(Fa){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Fa.message)}}u_a(ca){let sb=null;for(const Ba of N.mka)if(Ba.value.fl===ca){sb=Ba.key;
break}return sb}createAndShowAppsForOfficeDialog(ca,sb,Ba,V,Fa){ca=new l(ca,sb,Ba);Fa=V?"":String.format(Object(H.a)("ShowDialogApiInlineDialogTitle"),Fa);V&&(ca.wUb=!1,ca.xB=!1);ca.initializeAndShow(Fa,null,null);ca.hHk();return ca}static o1i(){return N.mka}static getInstance(ca){N.Va||(N.Va=new N(ca));return N.Va}}N.Va=null;N.mka=new J.a;Object(c.a)(N,"AppsForOfficeDialogManager",null,[304]);var L=a(1562),Z=a(873),ba=a(658),K=a(215),E=a(439),U=a(1133);class X{constructor(){this.releaseDate=this.diffAUP=
this.AUP=this.priority=0}}Object(c.a)(X,"AddinDetailInfo",null,[]);class ia{constructor(ca,sb){this.failure=null;this.U$=ca;this.errorCode=void 0===sb?0:sb}}Object(c.a)(ia,"AddinQueryResult",null,[]);class Ma extends ia{constructor(ca,sb){super(ca,void 0===sb?0:sb);this.solutionIds=null}}Object(c.a)(Ma,"AddinCollection",ia,[]);var qa;(function(ca){ca[ca.stop=-1]="stop";ca[ca.skip=0]="skip";ca[ca.query=1]="query"})(qa||(qa={}));Object(c.b)("QueryStrategy",qa);var Ha=a(1066);class ha extends Sys.EventArgs{constructor(ca,
sb,Ba,V){V=void 0===V?null:V;super();this.gM=ca;this.errorCode=sb;this.Nt=Ba;this.failure=V}}Object(c.a)(ha,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class La{constructor(ca){this.errorCode=ca;this.Nt=[];this.failure=null}}Object(c.a)(La,"GetAddinDetailsResult",null,[]);var fa=a(947),ja=a(1052);class ta{}Object(c.a)(ta,"GetEntitlementDetailsParameters",null,[]);var Ka=a(125),Ga=a(233),Na=a(173);class cb{constructor(ca){this.sJe=432E5;ca&&(this.sJe=36E5*ca.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutCacheExpiration",
12))}OYi(ca){const sb=new Date;let Ba=new Date(-1);try{const V=cb.W3g(`${ca}_ExpirationTime`);V&&(Ba=new Date(parseInt(V,10)))}catch(V){e.ULS.sendTraceTag(508063829,220,50,`Failed to parse expiration time for add-in ${ca}: ${V}`)}if(sb.getTime()<Ba.getTime()&&(ca=cb.W3g(`${ca}_StoreDisabled`)))return"true"===ca}$Ik(ca,sb){void 0!==sb&&null!==sb&&(cb.q4g(sb.toString(),`${ca}_StoreDisabled`),cb.q4g(((new Date).getTime()+this.sJe).toString(),`${ca}_ExpirationTime`))}static W3g(ca){let sb=null;try{const Ba=
cb.yac;if(void 0!==Ba&&Ba){const V=fa.a.Alb("Flyout")+"_"+ca;sb=Ba.getItem(V)}else e.ULS.sendTraceTag(508063828,220,50,"tryGetCache: Storage.Local null")}catch(Ba){e.ULS.sendTraceTag(508063827,220,10,"tryGetCache: Failed to get data Cache {0} for suffix {1}.","Flyout",ca)}return sb}static q4g(ca,sb){try{const Ba=cb.yac;if(void 0!==Ba&&Ba){const V=fa.a.Alb("Flyout")+"_"+sb;Ba.setItem(V,ca)}else e.ULS.sendTraceTag(508063826,220,50,"trySetCache: Storage.Local null")}catch(Ba){e.ULS.sendTraceTag(508063825,
220,10,"trySetCache: Failed to set AddinCommands Cache {0} for suffix {1}.","Flyout",sb)}}static get yac(){if(!cb.aba)return null;let ca=null;try{ca=localStorage}catch(sb){cb.aba=!1,ca=null,e.ULS.sendTraceTag(508063824,220,50,`Failed to use localStorage: error name: ${sb.name}; message: ${sb.message}; stack: ${sb.stack}`)}return ca}}cb.aba=!0;Object(c.a)(cb,"StoreDisabledCache",null,[]);class jb{constructor(ca,sb,Ba){Ba=void 0===Ba?null:Ba;var V;this.ih=new d.a;this.lz=new Z.a(ba.a.tm());this.jy=
new E.a;this.H3=0;this.nX=new E.a;this.Jid=null;this.ctb=(Fa,sc,Kc)=>{if(Kc)if(this.m4d(Fa,Kc,window.performance.now()-sc),0===Kc.errorCode){let qd;if(Kc.value){let Eb=0;qd=Array(Kc.value.length);Kc.value.forEach(vc=>{qd[Eb++]=vc})}else qd=[];this.pG(new ia(Fa),qd)}else-1===Kc.errorCode||10===Kc.errorCode?this.pG(new ia(Fa),[]):(Fa=this.Nud(Fa,sc,Kc),this.pG(Fa));else Fa=jb.Oud(Fa,sc),this.pG(Fa)};this.Q4a=(Fa,sc)=>{if(0!==sc.errorCode)this.jy.ga(sc.gM,Object.assign(new Ma(sc.gM,sc.errorCode),{failure:sc.failure})),
this.dIj&&this.Jca(sc.gM,1);else{Fa=Object.assign(new Ma(sc.gM),{solutionIds:new K.a});var Kc=sc.Nt;for(const qd of Kc)Kc=qd.solutionId,this.lz.mh(Kc)?this.lz.ga(Kc,this.K6d(this.lz.ma(Kc),sc.gM,qd)):this.lz.add(Kc,qd),Fa.solutionIds.add(Kc);this.jy.ga(sc.gM,Fa);this.Jca(Fa.U$,1)}};this.Gta=new Ga.a;this.Gta.add(OSF.StoreTypeEnum.MarketPlace,0);this.Gta.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ea=ca;this.Er=sb;this.mE=Ba;this.jdd=jb.kNd(ca,"https://store-images.s-microsoft.com");this.MIb(this.Q4a);
this.v_e=null!==(V=Ba.StoreDisabledCache)&&void 0!==V?V:new cb(ca)}get die(){return this.mE&&!0===this.mE.RefreshMyAddinsErrorCodeFixEnabled}get dIj(){return!!this.Ea&&this.Ea.isChangeGateEnabled("MissRegisterCollectionTypeFixEnabled")}get VM(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get o4d(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get bve(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8350408_SingleStoreDisabledQueryEnabled")}get UXk(){return!!this.Ea&&
this.Ea.isChangeGateEnabled("OfficeVSO:8352847_StoreDisabledCacheEnabled")}get isAnonymousUser(){return!!this.Ea&&this.Ea.ka("IsAnonymousUser")}get YId(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get Ukb(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get Aga(){return this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Fl(){return this.Er.value}$R(ca){if(this.VM&&
!this.zya(ca))return new La(0);if(this.die){var sb=this.FRb(ca);0===sb.errorCode&&0===ca&&(sb=this.FRb(2));if(0!==sb.errorCode)return sb}else{if(!this.yya(ca))return ca=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:U.a[ca]}),Object.assign(new La(1),{failure:ca});if(this.jy.ma(ca).failure)return Object.assign(new La(this.jy.ma(ca).errorCode),{failure:this.jy.ma(ca).failure})}e.ULS.shipAssertTag(509870082,220,!!this.jy.ma(ca).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
ca);sb=new La(0);for(const Ba of this.jy.ma(ca).solutionIds)this.lz.mh(Ba)&&Array.add(sb.Nt,this.lz.ma(Ba));return sb}FRb(ca){return this.yya(ca)?this.jy.ma(ca).failure?Object.assign(new La(this.jy.ma(ca).errorCode),{failure:this.jy.ma(ca).failure}):new La(0):(ca=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:U.a[ca]}),Object.assign(new La(1),{failure:ca}))}getUpgradedAddinsOfOmex(){return this.Fl.getUpgradedAddinsOfOmex()}DH(ca){return this.lz.mh(ca)?this.lz.ma(ca):
null}cBa(ca){if(ca){this.MIb(ca);for(const sb of this.jy.keys){if(this.VM&&!this.zya(sb))continue;if(!this.yya(sb)||this.jy.ma(sb).failure)continue;e.ULS.shipAssertTag(509870081,220,!!this.jy.ma(sb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",sb);const Ba=[],V=this.jy.ma(sb);for(const Fa of V.solutionIds)Array.add(Ba,this.lz.ma(Fa));ca(null,new ha(sb,V.errorCode,Ba,V.failure))}}}get name(){return"AddinDetailsManager1"}svb(ca,sb){if(this.VM&&
jb.d3a(ca)){var Ba=Fa=>{this.pG(jb.JWa(Fa,4,"The connected service is disabled."));this.Jca(Fa,-1)},V=Fa=>{this.pG(jb.JWa(Fa,0,"The user doesn't have any addin installed."),[]);this.Jca(Fa,0)};0===ca?(this.EVb(0,sb,Ba,V),this.EVb(2,sb,Ba,()=>{this.w6a(this.ctb)})):10===ca&&this.Jca(1,1)}}xG(ca,sb){jb.d3a(ca)?this.mge(ca,this.ctb,void 0===sb?!1:sb):e.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ja.a[ca])}MIb(ca){this.ih.addHandler(fa.a.eoc,ca)}EVb(ca,sb,Ba,V){this.zya(ca)||
(3===sb&&Ba?Ba(ca):2===sb&&V?V(ca):this.Jca(ca,1))}zya(ca){return this.nX.mh(ca)}Jca(ca,sb){if(this.VM){var Ba=this.zya(ca);if(!Ba||-1!==this.nX.ma(ca)&&this.nX.ma(ca)!==sb)e.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",U.a[ca],Ba?qa[this.nX.ma(ca)]:"undefined",qa[sb]),this.nX.ga(ca,sb)}}Nud(ca,sb,Ba){const V={};V.collectionType=U.a[ca];V.invokeResultCode=Ba.errorCode;V["queryResult.Value"]=Ba.value?String.format("Length: {0}",Ba.value.length):
"null";V.queryStart=sb;V.queryDuration=window.performance.now()-sb;return Object.assign(new ia(ca,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",V)})}bOk(){return this.yya(2)?this.Ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.jy.ma(2).errorCode:!1:!0}byb(ca){return this.VM&&this.nX.mh(ca)?1===this.nX.ma(ca):!0}mge(ca,sb,Ba){Ba=void 0===Ba?!1:Ba;e.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",ca);if(ca!==
OSF.StoreTypeEnum.MarketPlace&&ca!==OSF.StoreTypeEnum.PrivateCatalog)e.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",ca);else{var V=this.Gta.ma(ca);(!this.bve||this.Ukb&&this.isAnonymousUser)&&ca===OSF.StoreTypeEnum.MarketPlace&&this.byb(2)&&this.w6a(sb);this.byb(V)&&(this.Ukb&&this.isAnonymousUser?(ca=jb.yud(V),this.pG(ca)):this.nge(ca,sb,Ba))}}nge(ca,sb,Ba){this.gAg(ca,(V,Fa)=>{if(V===OSF.StoreTypeEnum.MarketPlace&&Fa)Fa=jb.gHa(0),this.pG(Fa),this.bve&&this.pG(jb.gHa(2));else if(V===
OSF.StoreTypeEnum.PrivateCatalog&&Fa)Fa=jb.gHa(1),this.pG(Fa);else{this.bve&&V===OSF.StoreTypeEnum.MarketPlace&&this.byb(2)&&sb(2,window.performance.now(),this.fKg());var sc=window.performance.now();this.Fl.getEntitlementDetails(Object.assign(new ta,{storeType:V,refresh:Ba}),Kc=>{sb(this.Gta.ma(V),sc,Kc)})}})}w6a(ca){this.bOk()&&this.gAg(0,(sb,Ba)=>{Ba?(sb=jb.gHa(2),this.pG(sb)):(sb=window.performance.now(),ca(2,sb,this.fKg()))})}pG(ca,sb){sb=void 0===sb?null:sb;0!==ca.errorCode?(e.ULS.shipAssertTag(509116673,
220,!sb,"The parameter addinDetails must be null for any failed queries"),e.ULS.shipAssertTag(509116672,220,!!ca.failure,"The result.Failure must not be available for any failed queries"),this.dte(ca)?e.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",U.a[ca.U$],Ha.a[ca.errorCode],ca.failure?ca.failure.toString():"null",JSON.stringify(ca.failure)):e.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"(downgraded error)",U.a[ca.U$],Ha.a[ca.errorCode],ca.failure?ca.failure.toString():"null",JSON.stringify(ca.failure))):(e.ULS.shipAssertTag(509116643,220,!!sb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",U.a[ca.U$]),e.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",U.a[ca.U$],sb?sb.length:-1));ca=new ha(ca.U$,ca.errorCode,sb,ca.failure);this.ih.raiseEvent(fa.a.eoc,ca)}dte(ca){return 3===
ca.errorCode&&(this.Ukb&&-2147208619===jb.NSb(ca)||this.YId&&-2===jb.NSb(ca))||4===ca.errorCode?!1:2!==ca.errorCode}yya(ca){return this.jy.mh(ca)?!!this.lz:!1}get hpc(){return this.mE?!this.mE.AreThirdPartyAddInsAllowed||this.mE.AppsForOfficeThirdPartyIsDisabled:!this.Ea.ka("AreThirdPartyAddInsAllowed")||this.Ea.ka("AppsForOfficeThirdPartyIsDisabled")}get RIc(){return this.mE?!this.mE.AppsForOfficeAllowExternalMarketplace:!this.Ea.ka("AppsForOfficeAllowExternalMarketplace")}get jub(){return this.mE?
this.mE.PopularAddinDetailsJsonString:this.Ea.Ya("PopularAddinDetailsJsonString")}queryStoreDisabled(ca,sb){if(this.hpc)sb(ca,!0);else if(ca===OSF.StoreTypeEnum.MarketPlace&&this.RIc)sb(ca,!0);else{const Ba=jb.G2c(ca);if(Ba){const V=window.performance.now();this.Fl.queryStoreDisabled(Ba,Fa=>{e.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",ca,Fa,V,window.performance.now()-V);sb(ca,Fa)})}else sb(ca,!1)}}gAg(ca,sb){if(this.UXk)if(this.hpc)sb(ca,
!0);else if(ca===OSF.StoreTypeEnum.MarketPlace&&this.RIc)sb(ca,!0);else{const Ba=jb.G2c(ca),V=this.v_e.OYi(ca);if(void 0===V)if(Ba){const Fa=window.performance.now();this.Fl.queryStoreDisabled(Ba,sc=>{this.v_e.$Ik(ca,sc);e.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",ca,sc,Fa,window.performance.now()-Fa);sb(ca,void 0!==sc?sc:!0)})}else sb(ca,!1);else sb(ca,V)}else this.queryStoreDisabled(ca,sb)}K6d(ca,sb,Ba){return ca?Ba?
2===sb?jb.s0b(Ba,ca):jb.s0b(ca,Ba):ca:Ba}fKg(){if(!this.Jid){const ca=JSON.parse(this.jub);this.DId(ca);this.Jid=ca}return jb.tqc(0,this.Jid)}DId(ca){jb.MJb(ca);this.$oc(ca);this.EId(ca)}$oc(ca){const sb=this.Kud();for(var Ba=0;Ba<ca.length&&0<sb.count;Ba++){const V=ca[Ba];if(sb.mh(V.solutionId)){let Fa=String.format("Found an override, solutionId: {0}",V.solutionId);const sc=sb.ma(V.solutionId);sc&&(isNaN(sc.addinInfo.priority)||(Fa=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Fa,V.addinInfo.priority,
sc.addinInfo.priority),V.addinInfo.priority=sc.addinInfo.priority),isNaN(sc.addinInfo.AUP)||(Fa=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Fa,V.addinInfo.AUP,sc.addinInfo.AUP),V.addinInfo.AUP=sc.addinInfo.AUP),sc.displayName&&(Fa=String.format("{0}; DisplayName: update {1} to {2}",Fa,V.displayName,sc.displayName),V.displayName=sc.displayName),sc.iconUrl&&(Fa=String.format("{0}; IconUrl: update {1} to {2}",Fa,V.iconUrl,sc.iconUrl),V.iconUrl=sc.iconUrl),sc.description&&(Fa=String.format("{0}; Description: update {1} to {2}",
Fa,V.description,sc.description),V.description=sc.description));sb.remove(V.solutionId);this.Aga&&e.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Fa)}}for(const V of sb.keys)Ba=sb.ma(V),Ba.displayName&&Ba.iconUrl&&Ba.addinInfo&&(ca.push(Ba),this.Aga&&e.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ba)))}Kud(){const ca=new Z.a(ba.a.tm());let sb=this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins",
"");if(!sb)return ca;sb=sb.trim();if(12>=sb.length)return 0<sb.length&&e.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",sb),ca;this.Aga&&e.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",sb);try{const Ba=[],V=sb.split("|");for(let Fa=V.length-1;0<=Fa;Fa--){const sc=V[Fa],Kc=sc.split("\\");if(2>Kc.length){Ba.push(sc);continue}const qd=jb.Zce(Kc);qd?ca.mh(qd.solutionId)||ca.add(qd.solutionId,qd):Ba.push(sc)}this.Aga&&
0<Ba.length&&e.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ba.join("|"));this.Aga&&0<ca.count&&e.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",ca.count,JSON.stringify(Na.toArray(ca.values)));return ca}catch(Ba){e.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",sb,Ba.toString())}return ca}EId(ca){for(let sb=0;sb<ca.length;sb++)Ka.c(ca[sb].iconUrl.toLowerCase(),
"http",0)||(ca[sb].iconUrl=String.format("{0}/image/apps.{1}",this.jdd,ca[sb].iconUrl))}static d3a(ca){return 0===ca||10===ca}static Oud(ca,sb){const Ba={};Ba.collectionType=U.a[ca];Ba.queryResult="null";Ba.queryStart=sb;Ba.queryDuration=window.performance.now()-sb;return Object.assign(new ia(ca,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ba)})}static JWa(ca,sb,Ba){const V={};V.collectionType=U.a[ca];ca=new ia(ca,sb);0!==sb&&(ca.failure=Error.create(Ba,V));return ca}static gHa(ca){return jb.JWa(ca,
2,"The store is disabled.")}static yud(ca){const sb={};sb.collectionType=U.a[ca];sb.invokeResultCode=-2147208619;sb.queryDuration=0;return Object.assign(new ia(ca,3),{failure:Error.create("Anonymous users do not have installed add-ins.",sb)})}static NSb(ca){return ca.failure?ca.failure.invokeResultCode:-1E3}n4d(ca,sb,Ba){const V={};V.AddinCollectionType=U.a[ca];V.ErrorCode=sb.errorCode;V.AddinCount=sb.value?sb.value.length:0;ca=window.performance.now();sb=Date.now()-r.AFrameworkApplication.DR;e.ULS.sendTraceTag(512231322,
220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Ba,ca,sb,JSON.stringify(V))}m4d(ca,sb,Ba){this.o4d?(Ba={["AddinCollectionType"]:U.a[ca],["ErrorCode"]:sb.errorCode,["QueryDuration"]:Ba,["FlyoutDataReadySinceBoot"]:Date.now()-r.AFrameworkApplication.DR},this.FXd(ca)&&e.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(Ba)),Ba.AddinCount=sb.value?sb.value.length:0,e.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",
JSON.stringify(Ba))):this.n4d(ca,sb,Ba)}FXd(ca){0===ca?this.H3|=1:1===ca&&(this.H3|=2);ca=this.H3&131;if(ca=1===ca||2===ca)this.H3=255;return ca}static tqc(ca,sb){const Ba={};Ba.errorCode=ca;Ba.value=sb;return Ba}static G2c(ca){return ca===OSF.StoreTypeEnum.MarketPlace?"omex":ca===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static s0b(ca,sb){sb.solutionId=sb.solutionId||ca.solutionId;sb.version=sb.version||ca.version;sb.storeType=sb.storeType||ca.storeType;sb.storeId=sb.storeId||ca.storeId;
sb.assetId=sb.assetId||ca.assetId;sb.assetStoreId=sb.assetStoreId||ca.assetStoreId;sb.displayName=sb.displayName||ca.displayName;sb.provider=sb.provider||ca.provider;sb.description=sb.description||ca.description;sb.iconUrl=sb.iconUrl||ca.iconUrl;sb.webApplicationId=sb.webApplicationId||ca.webApplicationId;sb.highResolutionIconUrl=sb.highResolutionIconUrl||ca.highResolutionIconUrl;sb.licenseUrl=sb.licenseUrl||ca.licenseUrl;sb.privacyUrl=sb.privacyUrl||ca.privacyUrl;sb.addinInfo=sb.addinInfo||ca.addinInfo;
isNaN(sb.targetType)&&(sb.targetType=ca.targetType);isNaN(sb.height)&&(sb.height=ca.height);isNaN(sb.width)&&(sb.width=ca.width);return sb}static MJb(ca){for(const sb of ca)isNaN(sb.targetType)&&(sb.targetType=1),sb.assetId=sb.assetId||sb.solutionId,sb.storeId=sb.storeId||"en-US",sb.storeType=sb.storeType||"omex",sb.assetStoreId=sb.assetStoreId||"omex",isNaN(sb.width)&&(sb.width=0),isNaN(sb.height)&&(sb.height=0)}static Zce(ca){const sb={};let Ba=0;Ba<ca.length&&0<ca[Ba].trim().length&&ca[Ba].trim().toLowerCase().startsWith("wa")&&
(sb.solutionId=ca[Ba].trim(),sb.addinInfo=Object.assign(new X,{priority:Number.NaN,AUP:Number.NaN}),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.addinInfo.priority=parseInt(ca[Ba].trim())),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.addinInfo.AUP=parseInt(ca[Ba].trim())),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.displayName=ca[Ba].trim()),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.iconUrl=ca[Ba].trim()),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.description=ca[Ba].trim()));return sb.solutionId?
sb:null}static kNd(ca,sb){ca=ca.Ya("AddinImageStoreServiceUrl");if(!ca)return sb;ca=ca.toLowerCase();return ca.startsWith("http://")||ca.startsWith("https://")?ca:sb}}Object(c.a)(jb,"AddinDetailsManager1",null,[355,356]);class Sa{constructor(ca,sb){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=
this.webApplicationId=this.iconUrl=null;this.solutionId=ca.solutionId;this.version=ca.version;this.storeType=ca.storeType;this.storeId=ca.storeId;this.assetId=ca.assetId;this.assetStoreId=ca.assetStoreId;this.displayName=ca.displayName;this.provider=ca.provider;this.description=ca.description;this.targetType=ca.targetType;this.height=ca.height;this.width=ca.width;this.iconUrl=ca.iconUrl;this.webApplicationId=ca.webApplicationId;this.highResolutionIconUrl=ca.highResolutionIconUrl;this.licenseUrl=ca.licenseUrl;
this.privacyUrl=ca.privacyUrl;this.addinInfo=void 0===sb?null:sb}Hac(){const ca={};ca.solutionId=this.solutionId;ca.version=this.version;ca.storeType=this.storeType;ca.storeId=this.storeId;ca.assetId=this.assetId;ca.assetStoreId=this.assetStoreId;ca.targetType=this.targetType;ca.displayName=this.displayName;ca.width=this.width;ca.height=this.height;return ca}}Object(c.a)(Sa,"AddinDetail",null,[]);class bb{constructor(ca,sb,Ba,V,Fa){this.Zkc=null;this.Ea=ca;this.Er=sb;this.rUa=Ba;this.lsh=V;this.GCb=
Fa}xG(ca,sb){this.Fl.queryAppDetails(this.lsh,this.GCb,this.solutionIds,ca,(Ba,V)=>{let Fa=null;if(V){Fa=Array(V.length);for(let sc=0;sc<V.length;sc++)Fa[sc]=new Sa(V[sc],this.TDj(V[sc].solutionId))}sb(Ba,Fa||[])})}get Vmj(){return!!this.Fl.queryAppDetails}TDj(ca){return this.rUa.ma(ca)}get solutionIds(){if(!this.Zkc){this.Zkc=new K.a;for(const ca of this.rUa.keys)this.Zkc.add(Ka.d(ca))}return this.Zkc.toArray()}get Fl(){return this.Er.value}}Object(c.a)(bb,"AddinDetailsLoader",null,[]);class oa{constructor(ca,
sb){this.failure=null;this.U$=ca;this.errorCode=void 0===sb?0:sb}}Object(c.a)(oa,"AddinQueryResult",null,[]);class ka extends oa{constructor(ca,sb){super(ca,void 0===sb?0:sb);this.Cwe=this.solutionIds=null}}Object(c.a)(ka,"AddinCollection",oa,[]);var ya=a(927);class Oa extends ya.a{constructor(){super(ba.a.tm())}}Object(c.a)(Oa,"AddinDetailTable",ya.a,[]);var za;(function(ca){ca[ca.stop=-1]="stop";ca[ca.skip=0]="skip";ca[ca.query=1]="query"})(za||(za={}));Object(c.b)("QueryStrategy",za);class ea{constructor(ca,
sb,Ba){Ba=void 0===Ba?null:Ba;this.ih=new d.a;this.lz=new Z.a(ba.a.tm());this.jy=new E.a;this.H3=0;this.nX=new E.a;this.rUa=this.o9c=null;this.ctb=(V,Fa,sc)=>{sc?(this.m4d(V,sc,window.performance.now()-Fa),0===sc.errorCode?(Fa=sc.value?ea.KIh(sc.value):[],this.pG(new oa(V),Fa)):-1===sc.errorCode||10===sc.errorCode?this.pG(new oa(V),[]):(V=this.Nud(V,Fa,sc),this.pG(V))):(V=ea.Oud(V,Fa),this.pG(V))};this.Q4a=(V,Fa)=>{if(0!==Fa.errorCode&&5!==Fa.errorCode)this.Y5g(Fa.gM,Object.assign(new ka(Fa.gM,Fa.errorCode),
{failure:Fa.failure}));else{V=Object.assign(new ka(Fa.gM,Fa.errorCode),{solutionIds:new K.a,Cwe:new K.a});var sc=Fa.Nt;for(const qd of sc){sc=qd.solutionId;const Eb=qd.storeId;if(this.lz.mh(sc)){var Kc=this.lz.ma(sc);Kc.mh(Eb)?Kc.ga(Eb,this.K6d(Kc.ma(Eb),Fa.gM,qd)):Kc.add(Eb,qd)}else Kc=new Oa,Kc.add(Eb,qd),this.lz.add(sc,Kc);V.solutionIds.add(sc);V.Cwe.add(Eb)}this.Y5g(Fa.gM,V)}};this.Gta=new Ga.a;this.Gta.add(OSF.StoreTypeEnum.MarketPlace,0);this.Gta.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ea=
ca;this.Er=sb;this.mE=Ba;this.jdd=ea.kNd(ca,"https://store-images.s-microsoft.com");this.Kid=null;this.MIb(this.Q4a)}get die(){return this.mE&&!0===this.mE.RefreshMyAddinsErrorCodeFixEnabled}get vqc(){this.o9c||(this.o9c=this.zFf());return this.o9c}zFf(){const ca=JSON.parse(this.jub);this.DId(ca);return ca.map(sb=>new Sa(sb,sb.addinInfo))}get VM(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get o4d(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get isAnonymousUser(){return!!this.Ea&&
this.Ea.ka("IsAnonymousUser")}get YId(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get Ukb(){return!!this.Ea&&this.Ea.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get Aga(){return this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Fl(){return this.Er.value}get Vde(){this.Kid||(this.Kid=new bb(this.Ea,this.Er,this.U8j,0,this.Fl.getAppUILocale()));return this.Kid}$R(ca){if(this.VM&&
!this.zya(ca))return new La(0);if(this.die){var sb=this.FRb(ca);0===sb.errorCode&&0===ca&&(sb=this.FRb(2));if(0!==sb.errorCode)return sb}else{if(!this.yya(ca))return ca=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:U.a[ca]}),Object.assign(new La(1),{failure:ca});sb=this.jy.ma(ca);if(sb.failure)return Object.assign(new La(sb.errorCode),{failure:sb.failure})}sb=this.jy.ma(ca);e.ULS.shipAssertTag(509870082,220,!!sb.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
ca);const Ba=new La(sb.errorCode);for(let V=0;V<sb.solutionIds.count;V++){const Fa=sb.solutionIds.ma(V),sc=sb.Cwe.ma(V);if(this.lz.mh(Fa)){const Kc=this.lz.ma(Fa);Kc.mh(sc)?Array.add(Ba.Nt,Kc.ma(sc)):e.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",Fa,ca,sc)}else e.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",Fa,ca)}return Ba}FRb(ca){return this.yya(ca)?
this.jy.ma(ca).failure?Object.assign(new La(this.jy.ma(ca).errorCode),{failure:this.jy.ma(ca).failure}):new La(0):(ca=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:U.a[ca]}),Object.assign(new La(1),{failure:ca}))}getUpgradedAddinsOfOmex(){return this.Fl.getUpgradedAddinsOfOmex()}DH(ca,sb){sb=void 0===sb?null:sb;if(ca=this.$Ei(ca))if(sb||(sb=this.uiCulture),ca.mh(sb))return ca.ma(sb);return null}$Ei(ca){return this.lz.mh(ca)?this.lz.ma(ca):null}cBa(ca){if(ca){this.MIb(ca);
for(const sb of this.jy.keys){if(this.VM&&!this.zya(sb))continue;if(!this.yya(sb)||this.jy.ma(sb).failure)continue;e.ULS.shipAssertTag(509870081,220,!!this.jy.ma(sb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",sb);const Ba=[],V=this.jy.ma(sb);for(const Fa of V.solutionIds)Array.add(Ba,this.lz.ma(Fa));ca(null,new ha(sb,V.errorCode,Ba,V.failure))}}}get name(){return"AddinDetailsManager2"}svb(ca,sb){if(this.VM&&ea.d3a(ca)){var Ba=Fa=>{this.pG(ea.JWa(Fa,
4,"The connected service is disabled."));this.Jca(Fa,-1)},V=Fa=>{this.pG(ea.JWa(Fa,0,"The user doesn't have any addin installed."),[]);this.Jca(Fa,0)};0===ca?(this.EVb(0,sb,Ba,V),this.EVb(2,sb,Ba,()=>{this.w6a(this.ctb,this.vqc)})):10===ca&&this.Jca(1,1)}}xG(ca,sb){ea.d3a(ca)?this.mge(ca,this.ctb,void 0===sb?!1:sb):e.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ja.a[ca])}MIb(ca){this.ih.addHandler(fa.a.eoc,ca)}EVb(ca,sb,Ba,V){this.zya(ca)||(3===sb&&Ba?Ba(ca):
2===sb&&V?V(ca):this.Jca(ca,1))}zya(ca){return this.nX.mh(ca)}Jca(ca,sb){if(this.VM){var Ba=this.zya(ca);if(!Ba||-1!==this.nX.ma(ca)&&this.nX.ma(ca)!==sb)e.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",U.a[ca],Ba?za[this.nX.ma(ca)]:"undefined",za[sb]),this.nX.ga(ca,sb)}}Nud(ca,sb,Ba){const V={};V.collectionType=U.a[ca];V.invokeResultCode=Ba.errorCode;V["queryResult.Value"]=Ba.value?String.format("Length: {0}",Ba.value.length):"null";V.queryStart=
sb;V.queryDuration=window.performance.now()-sb;return Object.assign(new oa(ca,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",V)})}cOk(ca){if(ca!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.byb(2)){if(!this.yya(2))return!0;if(this.Ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===this.jy.ma(2).errorCode}return!1}byb(ca){return this.VM&&this.nX.mh(ca)?1===this.nX.ma(ca):!0}mge(ca,sb,Ba){Ba=void 0===Ba?!1:Ba;e.ULS.sendTraceTag(510248470,
220,50,"QueryAddinDetailsInternal: storeType: {0}.",ca);if(ca!==OSF.StoreTypeEnum.MarketPlace&&ca!==OSF.StoreTypeEnum.PrivateCatalog)e.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",ca);else{var V=this.Gta.ma(ca);this.cOk(ca)&&this.w6a(sb,this.z$j);this.byb(V)&&(this.Ukb&&this.isAnonymousUser?(ca=ea.yud(V),this.pG(ca)):this.nge(ca,sb,Ba))}}get z$j(){return this.jy.mh(2)?null:this.vqc}nge(ca,sb,Ba){this.queryStoreDisabled(ca,(V,Fa)=>{if(V===OSF.StoreTypeEnum.MarketPlace&&Fa)Fa=ea.gHa(0),
this.pG(Fa);else if(V===OSF.StoreTypeEnum.PrivateCatalog&&Fa)Fa=ea.gHa(1),this.pG(Fa);else{var sc=window.performance.now();this.Fl.getEntitlementDetails(Object.assign(new ta,{storeType:V,refresh:Ba}),Kc=>{sb(this.Gta.ma(V),sc,Kc)})}})}w6a(ca,sb){ca=void 0===ca?null:ca;sb=void 0===sb?null:sb;null===ca&&(ca=this.ctb);this.queryStoreDisabled(0,(Ba,V)=>{V?(Ba=ea.gHa(2),this.pG(Ba)):null!=sb?this.pG(new oa(2,5),sb):this.odk(ca)})}pG(ca,sb){sb=void 0===sb?null:sb;0!==ca.errorCode&&5!==ca.errorCode?(e.ULS.shipAssertTag(509116673,
220,!sb,"The parameter addinDetails must be null for any failed queries"),e.ULS.shipAssertTag(509116672,220,!!ca.failure,"The result.Failure must not be available for any failed queries"),this.dte(ca)?e.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",U.a[ca.U$],Ha.a[ca.errorCode],ca.failure?ca.failure.toString():"null",JSON.stringify(ca.failure)):e.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"(downgraded error)",U.a[ca.U$],Ha.a[ca.errorCode],ca.failure?ca.failure.toString():"null",JSON.stringify(ca.failure))):(e.ULS.shipAssertTag(509116643,220,!!sb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",U.a[ca.U$]),e.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",U.a[ca.U$],sb?sb.length:-1,Ha.a[ca.errorCode]));ca=new ha(ca.U$,ca.errorCode,sb,ca.failure);
this.ih.raiseEvent(fa.a.eoc,ca)}dte(ca){return 3===ca.errorCode&&(this.Ukb&&-2147208619===ea.NSb(ca)||this.YId&&-2===ea.NSb(ca))||4===ca.errorCode?!1:2!==ca.errorCode}Y5g(ca,sb){this.jy.ga(ca,sb);this.Jca(ca,1)}yya(ca){return this.jy.mh(ca)?!!this.lz:!1}get uiCulture(){return this.mE&&this.mE.UICulture?this.mE.UICulture:r.AFrameworkApplication.uiCulture}get hpc(){return this.mE?!this.mE.AreThirdPartyAddInsAllowed||this.mE.AppsForOfficeThirdPartyIsDisabled:!this.Ea.ka("AreThirdPartyAddInsAllowed")||
this.Ea.ka("AppsForOfficeThirdPartyIsDisabled")}get RIc(){return this.mE?!this.mE.AppsForOfficeAllowExternalMarketplace:!this.Ea.ka("AppsForOfficeAllowExternalMarketplace")}get U8j(){if(!this.rUa){this.rUa=new Z.a(ba.a.tm());const ca=JSON.parse(this.jub);for(const sb of ca)this.rUa.add(sb.solutionId,sb.addinInfo)}return this.rUa}get jub(){return this.mE?this.mE.PopularAddinDetailsJsonString:this.Ea.Ya("PopularAddinDetailsJsonString")}queryStoreDisabled(ca,sb){if(this.hpc)sb(ca,!0);else if(ca===OSF.StoreTypeEnum.MarketPlace&&
this.RIc)sb(ca,!0);else{const Ba=ea.G2c(ca);if(Ba){const V=window.performance.now();this.Fl.queryStoreDisabled(Ba,Fa=>{e.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",ca,Fa,V,window.performance.now()-V);sb(ca,Fa)})}else sb(ca,!1)}}K6d(ca,sb,Ba){return ca?Ba?2===sb?ea.s0b(Ba,ca):ea.s0b(ca,Ba):ca:Ba}odk(ca){const sb=(V,Fa,sc)=>{ca(2,sc,ea.tqc(V,Fa))},Ba=window.performance.now();this.Vde&&this.Vde.Vmj?this.Vde.xG(!1,(V,Fa)=>
{this.$oc(Fa);ca(2,Ba,ea.tqc(V,Fa))}):sb(0,this.zFf(),Ba)}DId(ca){ea.MJb(ca);this.$oc(ca);this.EId(ca)}$oc(ca){const sb=this.Kud();for(var Ba=0;Ba<ca.length&&0<sb.count;Ba++){const V=ca[Ba];if(sb.mh(V.solutionId)){let Fa=String.format("Found an override, solutionId: {0}",V.solutionId);const sc=sb.ma(V.solutionId);sc&&(isNaN(sc.addinInfo.priority)||(Fa=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Fa,V.addinInfo.priority,sc.addinInfo.priority),V.addinInfo.priority=sc.addinInfo.priority),
isNaN(sc.addinInfo.AUP)||(Fa=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Fa,V.addinInfo.AUP,sc.addinInfo.AUP),V.addinInfo.AUP=sc.addinInfo.AUP),sc.displayName&&(Fa=String.format("{0}; DisplayName: update {1} to {2}",Fa,V.displayName,sc.displayName),V.displayName=sc.displayName),sc.iconUrl&&(Fa=String.format("{0}; IconUrl: update {1} to {2}",Fa,V.iconUrl,sc.iconUrl),V.iconUrl=sc.iconUrl),sc.description&&(Fa=String.format("{0}; Description: update {1} to {2}",Fa,V.description,sc.description),
V.description=sc.description));sb.remove(V.solutionId);this.Aga&&e.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Fa)}}for(const V of sb.keys)Ba=sb.ma(V),Ba.displayName&&Ba.iconUrl&&Ba.addinInfo&&(ca.push(Ba),this.Aga&&e.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ba)))}Kud(){const ca=new Z.a(ba.a.tm());let sb=this.Ea.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins",
"");if(!sb)return ca;sb=sb.trim();if(12>=sb.length)return 0<sb.length&&e.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",sb),ca;this.Aga&&e.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",sb);try{const Ba=[],V=sb.split("|");for(let Fa=V.length-1;0<=Fa;Fa--){const sc=V[Fa],Kc=sc.split("\\");if(2>Kc.length){Ba.push(sc);continue}const qd=ea.Zce(Kc);qd?ca.mh(qd.solutionId)||ca.add(qd.solutionId,qd):Ba.push(sc)}this.Aga&&
0<Ba.length&&e.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ba.join("|"));this.Aga&&0<ca.count&&e.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",ca.count,JSON.stringify(Na.toArray(ca.values)));return ca}catch(Ba){e.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",sb,Ba.toString())}return ca}EId(ca){for(let sb=0;sb<ca.length;sb++)Ka.c(ca[sb].iconUrl.toLowerCase(),
"http",0)||(ca[sb].iconUrl=String.format("{0}/image/apps.{1}",this.jdd,ca[sb].iconUrl))}static d3a(ca){return 0===ca||10===ca}static Oud(ca,sb){const Ba={};Ba.collectionType=U.a[ca];Ba.queryResult="null";Ba.queryStart=sb;Ba.queryDuration=window.performance.now()-sb;return Object.assign(new oa(ca,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ba)})}static JWa(ca,sb,Ba){const V={};V.collectionType=U.a[ca];ca=new oa(ca,sb);0!==sb&&(ca.failure=Error.create(Ba,V));return ca}static gHa(ca){return ea.JWa(ca,
2,"The store is disabled.")}static yud(ca){const sb={};sb.collectionType=U.a[ca];sb.invokeResultCode=-2147208619;sb.queryDuration=0;return Object.assign(new oa(ca,3),{failure:Error.create("Anonymous users do not have installed add-ins.",sb)})}static NSb(ca){return ca.failure?ca.failure.invokeResultCode:-1E3}n4d(ca,sb,Ba){const V={};V.AddinCollectionType=U.a[ca];V.ErrorCode=sb.errorCode;V.AddinCount=sb.value?sb.value.length:0;ca=window.performance.now();sb=Date.now()-r.AFrameworkApplication.DR;e.ULS.sendTraceTag(512231322,
220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Ba,ca,sb,JSON.stringify(V))}m4d(ca,sb,Ba){this.o4d?(Ba={["AddinCollectionType"]:U.a[ca],["ErrorCode"]:sb.errorCode,["QueryDuration"]:Ba,["FlyoutDataReadySinceBoot"]:Date.now()-r.AFrameworkApplication.DR},this.FXd(ca)&&e.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(Ba)),Ba.AddinCount=sb.value?sb.value.length:0,e.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",
JSON.stringify(Ba))):this.n4d(ca,sb,Ba)}FXd(ca){0===ca?this.H3|=1:1===ca&&(this.H3|=2);ca=this.H3&131;if(ca=1===ca||2===ca)this.H3=255;return ca}static tqc(ca,sb){const Ba={};Ba.errorCode=ca;Ba.value=sb;return Ba}static G2c(ca){return ca===OSF.StoreTypeEnum.MarketPlace?"omex":ca===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static s0b(ca,sb){sb.solutionId=sb.solutionId||ca.solutionId;sb.version=sb.version||ca.version;sb.storeType=sb.storeType||ca.storeType;sb.storeId=sb.storeId||ca.storeId;
sb.assetId=sb.assetId||ca.assetId;sb.assetStoreId=sb.assetStoreId||ca.assetStoreId;sb.displayName=sb.displayName||ca.displayName;sb.provider=sb.provider||ca.provider;sb.description=sb.description||ca.description;sb.iconUrl=sb.iconUrl||ca.iconUrl;sb.webApplicationId=sb.webApplicationId||ca.webApplicationId;sb.highResolutionIconUrl=sb.highResolutionIconUrl||ca.highResolutionIconUrl;sb.licenseUrl=sb.licenseUrl||ca.licenseUrl;sb.privacyUrl=sb.privacyUrl||ca.privacyUrl;sb.addinInfo=sb.addinInfo||ca.addinInfo;
isNaN(sb.targetType)&&(sb.targetType=ca.targetType);isNaN(sb.height)&&(sb.height=ca.height);isNaN(sb.width)&&(sb.width=ca.width);return sb}static KIh(ca){const sb=Array(ca.length);for(let Ba=0;Ba<sb.length;Ba++)sb[Ba]=new Sa(ca[Ba],ca[Ba].addinInfo);return sb}static MJb(ca){for(const sb of ca)isNaN(sb.targetType)&&(sb.targetType=1),sb.assetId=sb.assetId||sb.solutionId,sb.storeId=sb.storeId||"en-US",sb.storeType=sb.storeType||"omex",sb.assetStoreId=sb.assetStoreId||"omex",isNaN(sb.width)&&(sb.width=
0),isNaN(sb.height)&&(sb.height=0)}static Zce(ca){const sb={};let Ba=0;Ba<ca.length&&0<ca[Ba].trim().length&&ca[Ba].trim().toLowerCase().startsWith("wa")&&(sb.solutionId=ca[Ba].trim(),sb.addinInfo=Object.assign(new X,{priority:Number.NaN,AUP:Number.NaN}),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.addinInfo.priority=parseInt(ca[Ba].trim())),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.addinInfo.AUP=parseInt(ca[Ba].trim())),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.displayName=ca[Ba].trim()),++Ba<
ca.length&&0<ca[Ba].trim().length&&(sb.iconUrl=ca[Ba].trim()),++Ba<ca.length&&0<ca[Ba].trim().length&&(sb.description=ca[Ba].trim()));return sb.solutionId?sb:null}static kNd(ca,sb){ca=ca.Ya("AddinImageStoreServiceUrl");if(!ca)return sb;ca=ca.toLowerCase();return ca.startsWith("http://")||ca.startsWith("https://")?ca:sb}}Object(c.a)(ea,"AddinDetailsManager2",null,[354]);class Aa{constructor(ca,sb){this.kub="popular";this.G6e="addinDetails";this.idf="cache-lastUpdate";this.Acf="builtin-lastUpdate";
this.Hwg=144E5;this.Ea=this.XT=null;this.tOj=(Ba,V)=>{2===V.gM&&0===V.errorCode&&(this.gvd=V.Nt,this.Kqc=this.now,e.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};this.XT=sb;this.Ea=ca;this.XT.cBa(this.tOj);this.Hwg=this.Ea.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",144E5)}get oqj(){return this.Kqc?this.now.getTime()-this.Kqc.getTime()>=this.Hwg:!0}$R(ca){var sb=this.XT.$R(ca);2===ca&&this.nqj(sb.errorCode)&&
(ca=this.gvd,null!=ca?(this.oqj&&this.XT.w6a(null,null),sb=this.toDateString(this.now),sb=this.toDateString(this.Qud)===sb?this.wud(5,this.XT.vqc):this.wud(0,ca)):(Aa.aba&&(sb=this.wud(5,this.XT.vqc)),this.Qud=this.now,this.XT.w6a(null,null)));return sb}wud(ca,sb){var Ba=void 0===Ba?null:Ba;return Object.assign(new La(ca),{Nt:sb,failure:Ba})}toDateString(ca){return ca.toISOString().substring(2,16)}get Qud(){const ca=Aa.z$a(this.kub,this.Acf);return null!==ca?new Date(ca):new Date(0)}set Qud(ca){Aa.lRa(this.kub,
ca.toISOString(),this.Acf)}get Kqc(){const ca=Aa.z$a(this.kub,this.idf);return null!==ca?new Date(ca):new Date(0)}set Kqc(ca){Aa.lRa(this.kub,ca.toISOString(),this.idf)}get gvd(){const ca=Aa.z$a(this.kub,this.G6e);let sb=null;ca&&(sb=JSON.parse(ca));return sb}set gvd(ca){ca=JSON.stringify(ca);Aa.lRa(this.kub,ca,this.G6e)}get now(){return new Date}nqj(ca){return 2!==ca&&4!==ca}DH(ca,sb){return this.XT.DH(ca,void 0===sb?null:sb)}getUpgradedAddinsOfOmex(){return this.XT.getUpgradedAddinsOfOmex()}cBa(ca){this.XT.cBa(ca)}get name(){return"AddinDetailsCacheManager"}svb(ca,
sb){this.XT.svb(ca,sb)}xG(ca,sb){this.XT.xG(ca,void 0===sb?!1:sb)}static z$a(ca,sb){let Ba=null;try{const V=Aa.yac;if(void 0!==V&&V){const Fa=fa.a.Alb(ca)+"_"+sb;Ba=V.getItem(Fa)}else e.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(V){e.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",ca,sb)}return Ba}static lRa(ca,sb,Ba){try{const V=Aa.yac;if(void 0!==V&&V){const Fa=fa.a.Alb(ca)+"_"+Ba;V.setItem(Fa,
sb)}else e.ULS.sendTraceTag(508352217,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(V){e.ULS.sendTraceTag(508352216,220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",ca,Ba)}}static get yac(){if(!Aa.aba)return null;let ca=null;try{ca=localStorage}catch(sb){Aa.aba=!1,ca=null,e.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${sb.name}; message: ${sb.message}; stack: ${sb.stack}`)}return ca}}Aa.aba=!0;Object(c.a)(Aa,"AddinDetailsCacheManager",
null,[355]);class ub{static createInstance(ca,sb,Ba){Ba=void 0===Ba?null:Ba;ca=ub.wGh(ca)?new Aa(ca,new ea(ca,sb,Ba)):new jb(ca,sb,Ba);e.ULS.sendTraceTag(508352212,220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${ca.name}`);return ca}static wGh(ca){return(ca||r.AFrameworkApplication.ea).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(c.a)(ub,"AddinDetailsManagerFactory",null,[]);var rb=a(1068),Ja=a(615),Xa=a(1483),Y=a(1609),
Ia=a(1183),$a=a(224),Ea=a(37),Lb=a(184),Ib=a(1484),Mb=a(140),mc=a(183),jc=a(130),Fc=a(95),Gc=a(787),xc=a(154),Uc=a(361),Pa=a(144),Bb=a(608),Nb=a(186),oc=a(41),aa=a(1134),rc=a(1416),yb=a(1138),Fb=a(80);class Qb{constructor(){this.command=0;this.properties=null}}Object(c.a)(Qb,"DdaRequestInfo",null,[]);var ac=a(966),Wa=a(63);class Gb extends Fb.a{constructor(ca,sb){super();this.requests=[];this.disposed=this.vrc=!1;this.im=()=>{if(!this.disposed){this.grid.Dh.Ow(this.im);this.vrc=!1;const Ba=this.requests;
this.requests=[];for(const V of Ba)this.ddaFacade.kV(V.command,V.properties)}};this.ddaFacade=ca;this.grid=sb}Zdi(ca,sb){this.disposed||(this.vrc||(this.grid.Dh.Ox(this.im),this.vrc=!0),this.requests.push(Object(b.a)(new Qb,{command:ca,properties:sb})))}dispose(){if(!this.disposed){this.disposed=!0;this.vrc&&this.grid.Dh.Ow(this.im);var ca=this.requests;this.requests=null;for(const sb of ca)(ca=sb.properties?sb.properties[Wa.a.Wfa]:null)&&this.ddaFacade.qo(ac.a.$Vb,ca);this.ddaFacade=this.grid=null;
super.dispose()}}static P_h(ca,sb){var Ba=!1;974713501===ca&&(sb=(ca=sb?sb[Wa.a.hl]:null)?ca.DdaMethod:null)&&sb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Ba=ca.ArrayData,Ba=!!Ba&&64===(Ba[6]&64));return Ba}}Object(c.a)(Gb,"DdaCellEditDelayRequestHandler",Fb.a,[]);var Ub=a(1003);class Ra extends Ub.a{constructor(ca,sb,Ba,V,Fa,sc,Kc){super(ca,sb,Ba);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=V;this.messageContent=Fa;
this.messageOrigin=sc;this.targetOrigin=Kc}}Object(c.a)(Ra,"DialogMessageReceivedEventArgs",Ub.a,[]);class Rb extends Ub.a{constructor(ca,sb,Ba,V,Fa,sc,Kc){super(ca,sb,Ba);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=V;this.messageContent=Fa;this.messageOrigin=sc;this.targetOrigin=Kc}}Object(c.a)(Rb,"DialogParentMessageReceivedEventArgs",Ub.a,[]);var ib=a(1),la=a(23);class db{constructor(ca){this.Fl=this.dsd=null;this.aYj=(sb,Ba)=>{this.handlers.mh(Ba.controlId)&&
(sb=new Ra(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Ba.controlId,null,Ba.messageType,Ba.messageContent,Ba.messageOrigin,Ba.targetOrigin),this.handlers.ma(Ba.controlId)(sb),Ba.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(Ba.controlId))};this.$Xj=(sb,Ba)=>{this.XNc.mh(Ba.controlId)&&(sb=new Rb(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Ba.controlId,null,Ba.messageType,Ba.messageContent,Ba.messageOrigin,Ba.targetOrigin),this.XNc.ma(Ba.controlId)(sb))};
this.handlers=new J.a;this.XNc=new J.a;this.jq=ca;this.jjb.REh(this.aYj);this.jjb.QEh(this.$Xj)}get jjb(){this.dsd||(this.dsd=N.getInstance(this.contextActivationMgr));return this.dsd}get contextActivationMgr(){!this.Fl&&this.jq&&(this.Fl=this.jq.Fl);return this.Fl}addHandler(ca,sb,Ba,V){e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Fa=sc=>{sc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ga(ca,sb),this.jq.FE(Ba)):(e.ULS.sendTraceTag(537170501,
0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.jq.qo(sc,Ba))};this.handlers.mh(ca)?Fa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(ca,V,Fa)}Ozh(ca,sb,Ba){e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!");this.XNc.ga(ca,sb);this.jq.FE(Ba)}removeHandler(ca,sb){this.handlers.mh(ca)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.jjb.wXa(ca,Ba=>{this.handlers.remove(ca);
Ba===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.jq.FE(sb):(e.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.jq.qo(Ba,sb))})):this.jq.qo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,sb)}Gmk(ca,sb){e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");this.XNc.remove(ca);this.jq.FE(sb)}showDialog(ca,sb,Ba){try{ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&la.f(this.jq.$).isEditing&&
la.f(this.jq.$).Xz(!0),this.jjb.showDialog(sb,ca,Ba,V=>{this.jq.iAh(this.MRh(V))})}catch(V){e.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${V.message}`),Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}MRh(ca){const sb={};sb.InstanceId=ca.id;sb.WebExtensionType=ca.osfControlType===OSF.OsfControlTarget.InContent?0:1;sb.PrimaryMarketplace={};sb.PrimaryMarketplace.SolutionId=ca.solutionId;sb.PrimaryMarketplace.SolutionVersion=ca.version;
sb.PrimaryMarketplace.MarketplaceRef=ca.storeId;sb.PrimaryMarketplace.MarketplaceType=ca.storeType;sb.OwnerAddinSolutionId=ca.ownerAddinSolutionId;sb.OwnerAddinStoreType=ca.ownerAddinStoreType;return sb}static Ga(ca){if(!ca.$.qa.zh(232)){const sb=new db(ca);ca.$.qa.Rh(232,sb)}}}Object(c.a)(db,"DialogMessageReceivedEventManager",null,[278]);class $b{constructor(ca,sb){this.CK=null;this.Csa=ca;this.gvh=sb}Knc(ca){ca&&(this.CK||(this.CK=[]),this.CK.push(ca))}LVc(ca){this.CK&&Array.remove(this.CK,ca)}get eventId(){return this.Csa}get targetId(){return this.gvh}get z7i(){return 0<
this.CK.length}$Fj(ca){return this.eventId!==ca.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===ca.ddaBinding.Name:!0}Yqc(ca){this.CK&&Array.forEach(this.CK,sb=>{sb(ca)})}fPa(){this.CK=[]}}Object(c.a)($b,"DdaEventRegistration",null,[]);class Ic{constructor(ca){this.gP=null;this.lLa=!1;this.Gj=()=>{this.gP.forEach(sb=>{sb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&
sb.Yqc(new Ub.a(sb.eventId,"",null))})};this.jq=ca}invokeDdaMethod(ca,sb){const Ba={};Ba[Wa.a.hl]=ca;Ba[Wa.a.Wfa]=sb;this.jq.kV(974713501,Ba)}registerDdaEventAsync(ca,sb,Ba,V,Fa){Ic.dXb(ca)?(Ic.NWd(ca)&&this.$Sd(),this.gP||(this.gP=[]),sb=this.HQb(ca,Ba),sb||(sb=new $b(ca,Ba),this.gP.push(sb)),sb.Knc(V),this.jq.FE(Fa)):this.jq.qo(-1,Fa)}unregisterDdaEventAsync(ca,sb,Ba,V,Fa){Ic.dXb(ca)?((ca=this.HQb(ca,Ba))&&ca.LVc(V),this.jq.FE(Fa)):this.jq.qo(-1,Fa)}$Sd(){this.lLa||(la.f(this.jq.$).ha.z$(this.Gj),
this.lLa=!0)}HQb(ca,sb){if(!this.gP)return null;for(let Ba=0;Ba<this.gP.length;Ba++){const V=this.gP[Ba];if(V.eventId===ca&&V.targetId===sb)return V}return null}static dXb(ca){return ca===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static NWd(ca){return ca===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(Ic,"EmbeddingPage",null,[256]);var Tc=a(235);class Zc extends Ub.a{constructor(ca,sb,Ba,V,Fa,sc,Kc,qd){super(ca,sb,Ba);this.columnCount=this.rowCount=this.startColumn=
this.startRow=0;this.startColumn=sc-V.Reference.FirstColumn;this.columnCount=qd;ca=Math.max(Fa,V.Reference.FirstRow);Fa=Math.min(Fa+Kc-1,V.Reference.LastRow);ca>Fa?this.startRow=this.rowCount=void 0:(this.startRow=ca-V.Reference.FirstRow,this.rowCount=Fa-ca+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(Zc,"DdaBindingSelectionEventArgs",Ub.a,[]);var cc=a(213),Yc=a(27),Vc=a(46),
wd=a(678),wc=a(40),Ya=a(673),ob=a(325),Cb=a(60),Wb=a(84),ad=a(16),$c=a(13),Ld=a(102),jd=a(91),Td=a(92),re=a(5),Nd=a(364),uc=a(216),pc=a(431);a(1130);class Hd extends Tc.a{constructor(ca,sb,Ba,V,Fa){Fa=void 0===Fa?!1:Fa;super();this.fxb=0;this.gP=null;this.lLa=!1;this.rTc=null;this.C5=0;this.Tuc=this.wbb=this.hLe=this.IIe=null;this.shc=this.KQe=!1;this.Nhd=this.Iqa=this.uDe=null;this.Gj=()=>{this.enabled&&(this.qCk(),this.rTc=Vc.d(la.f(this.$).ha.pa.selectedRanges))};this.dQf=sc=>{sc.controlId===this.Hj.InstanceId&&
Array.forEach(this.gP,Kc=>{Kc.$Fj(sc)&&Kc.Yqc(sc)})};this.Zhg=sc=>{sc=Object(xc.a)(252,sc);if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8220021_ExcludingMisMatchingPaneAndData")&&null!=(null===sc||void 0===sc?void 0:sc.an)&&(null===sc||void 0===sc?void 0:sc.an.InstanceId)!==this.Hj.InstanceId)e.ULS.sendTraceTag(508302915,220,15,"InstanceIds mismatching for webExtensionPane and webExtensionData.");else if(sc&&!sc.T6())if(!this.Hj||OSF.OsfControl.isFirstPartyStoreString(this.Hj.PrimaryMarketplace.MarketplaceType)||
this.$.L4){sc.an=this.Hj;sc.At=this.jq;this.uDe=sc;this.xZc(sc.sJb);const Kc=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&$c.HelperMethods.cG(this.Hj)&&this.Hj.Preload&&!this.Hj.TaskpaneVisible;Kc?sc.oae():ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(sc.oae(),(this.Hj.SharedRuntime&&1===this.Hj.SharedRuntime.LifeTime||this.Hj.SharedRuntimeId)&&!this.Hj.TaskpaneVisible&&sc.iF(!1)):((this.Hj.SharedRuntime&&
1===this.Hj.SharedRuntime.LifeTime||this.Hj.SharedRuntimeId)&&!this.Hj.TaskpaneVisible&&sc.iF(!1),sc.oae());this.$nb||Kc||sc.ZH();this.$.qa.zh(77).YFg(this.Zhg);this.Wla=Object(xc.a)(273,sc)}else e.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(sc,Kc)=>{3===Kc.control.floatingObject.type&&Kc.control.floatingObject.mo.InstanceId===this.Lda.WebExtensionId&&(this.Wla=Object(xc.a)(273,Kc.control),this.xZc(Kc.control.Pj.firstChild),Ld.a(this.$).CVc(this.onFloatingObjectControlAdded))};
this.th=ca.$;this.webExtensionView=V;this.jq=ca;this.Hj=Ba;this.Hj.InstanceId=Ba.SrcLocationOverrideResourceId?ca.LJa(Ba.InstanceId,Ba.SrcLocationOverrideResourceId):Ba.InstanceId;this.eo=sb;this.Lda={};this.Lda.WebExtensionId=Ba.InstanceId;this.Dug="osfControl_"+Ba.InstanceId;this.cDd="disabled_"+Ba.InstanceId;this.Lda.BindingData=Ba.BindingData;this.$nb=this.jq.$nb(Ba.InstanceId);this.RGc=this.jq.RGc(Ba.InstanceId);this.BVe=Ba.WebExtensionOsfControlType;this.jyg=Fa}get controlId(){return this.Hj.InstanceId}get U0f(){return this.shc}Aej(ca){this.Iqa||
(this.Iqa=ca)}HFg(){this.Iqa&&(this.Iqa.dispose(),this.Iqa=null)}get controlType(){return this.Hj.WebExtensionType}get ownerAddinSolutionId(){return this.Hj.OwnerAddinSolutionId}get $(){return this.th}get enabled(){return!this.C5}get visible(){return this.Hj.TaskpaneVisible}get sG(){return this.Nhd}get UX(){return this.Hj.SrcLocationOverrideResourceId?this.jq.LJa(this.Hj.PrimaryMarketplace.SolutionId,this.Hj.SrcLocationOverrideResourceId):this.Hj.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Hj.SrcLocationOverrideResourceId}get mo(){return this.Hj}get Wla(){return this.IIe}set Wla(ca){this.IIe=
ca}get osfControlType(){return this.BVe}get jIa(){return this.hLe}set jIa(ca){this.hLe=ca}get Suc(){return this.wbb}set Suc(ca){this.wbb=ca}get focusOnIframeWhenLoaded(){return this.Hj.FocusOnIframeWhenLoaded}get mJc(){return this.KQe}set mJc(ca){this.KQe=ca}lUd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Hj.PrimaryMarketplace.MarketplaceType)&&ib.EwaSettings.Na(174)){const sb=Object(jd.d)(Td.a.resolve(re.E,{va:0}));wc.TaskExtensions.$e(sb,()=>{sb.result.Rm(36,null)},this.ya,3);return this}if(1===
this.Hj.WebExtensionType)wc.TaskExtensions.$e(wd.a(this.$),sb=>{sb.result.Zlf(this.$.qa,77,this.Zhg)},this.ya,3);else{var ca=this.QAf();const sb=Ld.a(this.$);ca||(ca={Type:3},ca.Id=this.Lda.WebExtensionId,ca.WebExtensionData=this.Hj,ca.ContentHtml="<div/>",ca.Version=0,ca.AbsoluteLeft=0,ca.AbsoluteTop=0,ca.AbsoluteRight=0,ca.AbsoluteBottom=0,ca.Width=0,ca.Height=0,ca.ZOrder=0,ca.OriginDeltaX=0,ca.OriginDeltaY=0,ca=new cc.a(ca),sb.Jtc(ca,null),ca=sb.Xx(ca.Hn()));ca?(this.xZc(ca.Pj.firstChild),this.Wla=
Object(xc.a)(273,ca)):sb.Anc(this.onFloatingObjectControlAdded)}return this}KVf(ca){this.xZc(ca);return this}APc(){this.jyg||this.jq.Fl.purgeOsfControl(this.controlId,!1);if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")&&this.$.isEditMode||!ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")){const sb=this.$.oa.ta.Wh();pc.a(this.$.userOperationManager,(Ba,V,Fa)=>Nd.e(this.$.oa.ta,this.Hj.InstanceId,Ba,V,Fa,sb),Ba=>new uc.a(606,
0,Ba,64),null)}this.b5g(!0);const ca=this.QAf();ca&&Ld.a(this.$).deleteFloatingObject(ca);this.jq.Zn.kmk(this.controlId);this.jq.Zn.puf(this.controlId,!0);this.Nhd=null}Aae(ca){this.Lda=ca}invokeDdaMethod(ca,sb){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Ba={};Ba[Wa.a.hl]=ca;Ba[Wa.a.Wfa]=sb;this.jq.kV(974713501,Ba)}else this.jq.qo(ac.a.$Vb,sb)}qjk(ca,sb,Ba,V){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Hd.Lii(ca)||
void 0!==sb&&null!==sb&&void 0!==this.Jkb(sb)&&null!==this.Jkb(sb))if(e.ULS.sendTraceTag(36444195,0,50,`eventId: ${ca}, targetId: ${sb}`),Hd.HZf(ca)&&this.L9i(),Hd.NWd(ca)&&this.$Sd(),Hd.FZf(ca))this.shc=!0,this.jq.$.qa.zh(232).addHandler(this.controlId,Ba,V,sb);else if(Hd.GZf(ca))this.shc=!0,this.jq.$.qa.zh(232).Ozh(this.controlId,Ba,V);else{Hd.EZf(ca)&&this.gQf(-1777565636,V);this.gP||(this.gP=[]);var Fa=this.HQb(ca,sb);Fa||(Fa=new $b(ca,sb),this.gP.push(Fa));Fa.fPa();Fa.Knc(Ba);this.jq.FE(V);ca===
OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.wbb&&(this.Tuc=Ba)}else this.jq.qo(3002,V);else this.jq.qo(-1,V)}y7k(ca,sb,Ba,V){Hd.FZf(ca)?(this.jq.$.qa.zh(232).removeHandler(this.controlId,V),ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",!1)&&(this.shc=!1)):Hd.GZf(ca)?this.jq.$.qa.zh(232).Gmk(this.controlId,V):(Hd.EZf(ca)&&this.gQf(1592314317,V),sb=this.HQb(ca,sb),this.enabled?(sb&&(sb.LVc(Ba),sb.z7i||Array.remove(this.gP,sb),this.gP.length?Hd.HZf(ca)&&this.c5g(!1):
this.b5g(!1)),this.jq.FE(V)):this.jq.qo(-1,V))}Ga(ca){ad.DOMElementExtensions.getElementById(ca,this.Dug)||ca.appendChild(ad.DOMElementExtensions.jn(this.sG))}showHide(ca){ad.DOMElementExtensions.setVisible(this.sG,ca)}resize(ca,sb){ad.DOMElementExtensions.tI(this.sG,ca);ad.DOMElementExtensions.KW(this.sG,sb)}Rqf(ca){if(!this.C5&&!ad.DOMElementExtensions.getElementById(this.sG,this.cDd)&&this.sG){const sb=document.createElement("div");sb.id=this.cDd;sb.className="ewa-wx-disabled-div";sb.style.backgroundImage=
"url("+Cb.a.current.Tu(103)+")";sb.style.opacity=ca?"1":"0";sb.style.backgroundRepeat="no-repeat";sb.style.backgroundPosition="center";this.sG.insertBefore(sb,this.sG.firstChild)}this.C5++}Qli(){0<this.C5&&this.C5--;this.C5||(ad.DOMElementExtensions.jn(ad.DOMElementExtensions.getElementById(this.sG,this.cDd)),this.lLa&&!Vc.X(this.rTc,la.f(this.$).ha.pa.selectedRanges)&&this.Gj(null,null))}Jkb(ca){if(!this.Lda||!this.Lda.BindingData)return null;for(let sb=0;sb<this.Lda.BindingData.length;sb++)if(this.Lda.BindingData[sb].Name===
ca)return this.Lda.BindingData[sb];return null}getDefaultIconUrl(){const ca=this.bLf();return ca?ca.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Hj.TaskpaneTitle)return this.Hj.TaskpaneTitle;const ca=this.bLf();return ca?ca.getDefaultDisplayName():null}rzg(){if(this.wbb&&this.Tuc){const ca=new Ub.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.wbb);this.Tuc(ca);this.Tuc=this.wbb=null}}iF(ca){this.uDe&&this.uDe.iF(ca)}IEk(){this.$.fa.isNamedObjectViewMode&&this.Eqj()&&
(re.Wg.Ma()?this.webExtensionView.HPg(this.sG):yb.a(this.$).HPg(this.sG),this.showHide(!1));if(this.jq.Dgl){if(!this.jyg){const ca={};ca.div=this.sG;ca.id=this.Hj.InstanceId;ca.solutionId=this.Hj.PrimaryMarketplace.SolutionId;ca.version=this.Hj.PrimaryMarketplace.SolutionVersion;ca.storeId=this.Hj.PrimaryMarketplace.MarketplaceRef;ca.storeType=this.Hj.PrimaryMarketplace.MarketplaceType;ca.ownerAddinSolutionId=this.Hj.OwnerAddinSolutionId;ca.ownerAddinStoreType=this.Hj.OwnerAddinStoreType;this.Hj.AssetMarketplace?
(ca.assetId=this.Hj.AssetMarketplace.SolutionId,ca.assetStoreId=this.Hj.AssetMarketplace.MarketplaceRef):(ca.assetId=null,ca.assetStoreId=null);ca.settings=this.Hj.OsfPropertyBag;ca.hostSettings=this.Hj.HostPropertyBag;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?ca.reason=this.$nb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.RGc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:
ca.reason=this.$nb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;ca.osfControlType=0===this.Hj.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;ca.isForUILessAction=4===this.Hj.WebExtensionOsfControlType;ca.sourceLocationOverrideResourceId=this.Hj.SrcLocationOverrideResourceId;ca.focusOnIframeWhenLoaded=this.Hj.FocusOnIframeWhenLoaded;Ya.a(this.Hj)&&(ca.featureGates=r.AFrameworkApplication.ea.UHf(ca.solutionId));
ca.hostInfoFlags=0;this.jIa&&(ca.hostInfoFlags|=2);$c.HelperMethods.cG(this.Hj)&&(ca.hostInfoFlags|=1);this.$.L4||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),ca.hostInfoFlags|=4);ib.EwaSettings.Na(553)&&(ca.hostInfoFlags|=8);ca.sharedRuntimeId=this.Hj.SharedRuntime?this.Hj.SharedRuntime.Resid:this.Hj.SharedRuntimeId;!$c.HelperMethods.cG(this.Hj)||this.Hj.Preload||Ya.a(this.Hj)||this.jq.Fl.getOsfControl(a(958).DdaFacade.getSolutionId(this.Hj,this.$))||(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?
this.$.isEditMode&&this.jq.itg(this.Hj):this.jq.itg(this.Hj));ca.onExtensionLaunchCallback=this.Hj.OnExtensionLaunchCallback;ca.initialDisplayMode=this.Hj.TaskpaneVisible?2:1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(ca.titleOverride=this.mo.TaskpaneTitle);this.jq.Fl.insertOsfControl(ca)}this.C5=0}else this.Rqf(!0)}b5g(ca){this.c5g(ca);this.f7k()}L9i(){this.fxb||this.eo.Knc(this.dQf);this.fxb++}c5g(ca){0<this.fxb&&(ca?this.fxb=0:this.fxb--,this.fxb||this.eo.LVc(this.dQf))}$Sd(){if(!this.lLa){const ca=
la.f(this.$).ha;this.rTc=Vc.d(la.f(this.$).ha.pa.selectedRanges);ca.z$(this.Gj);this.lLa=!0}}f7k(){this.lLa&&(la.f(this.$).ha.Nca(this.Gj),this.lLa=!1)}fBk(ca){var sb=new Yc.Range(ca.Reference.FirstRow+1,ca.Reference.FirstColumn+1,ca.Reference.LastRow+1,ca.Reference.LastColumn+1,!1,!1);1===ca.BindingType&&(ca.HasHeaders&&--sb.top,ca.HasTotals&&(sb.bottom+=1));var Ba=la.f(this.$).ha.pa.selectedRanges;ca=sb.Tnb(this.rTc);Ba=sb.Tnb(Ba);return(sb=sb.Fk(la.f(this.$).ha.pa.activeRange))&&(ob.a(ca)&&!ob.a(Ba)||
!ob.a(ca)&&!ob.a(Ba)&&!Vc.X(ca,Ba))?sb:null}qCk(){Array.forEach(this.gP,ca=>{if(ca.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&ca.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.jq.Zn.gpc(this.controlId))if(ca.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)ca.Yqc(new Ub.a(ca.eventId,this.controlId,null));else if(ca.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const sb=this.Jkb(ca.targetId);if((null===sb||void 0===
sb?0:sb.IsValidRef)&&(this.$.fa.isNamedObjectViewMode?this.$.$h.la.sheetName:this.$.sa.la.name)===sb.Reference.SheetName){const Ba=this.fBk(sb);Ba&&ca.Yqc(new Zc(ca.eventId,this.controlId,this.jq.Rpc(sb),sb,Ba.top-1,Ba.left-1,Ba.height,Ba.width))}}})}HQb(ca,sb){if(!this.gP)return null;for(let Ba=0;Ba<this.gP.length;Ba++){const V=this.gP[Ba];if(V.eventId===ca&&V.targetId===sb)return V}return null}QAf(){const ca=Ld.a(this.$).b1;for(let sb=ca.length-1;0<=sb;--sb){const Ba=ca[sb];if(3===Ba.floatingObject.type&&
Ba.floatingObject.mo.InstanceId===this.Lda.WebExtensionId)return Ba}return null}Eqj(){for(let ca=0;ca<this.$.$h.count;ca++)if(this.$.$h.getItem(ca).imageId===this.Lda.WebExtensionId)return!0;return!1}xZc(ca){this.Nhd=ca;this.sG.id=this.Dug;this.sG.className="ewa-wx-container-div";this.sG.dir=this.$.isChromeRtl?"rtl":"ltr";this.IEk()}bLf(){if(!this.enabled)return null;const ca=Ya.a(this.mo)?"":this.mo.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.mo.PrimaryMarketplace.SolutionId,
ca)}gQf(ca,sb){try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.BVe)this.jq.qo(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,sb);else{const Ba={};Ba[fa.a.oJb]=this.controlId;const V=new Wb.a(ca,0,this.$.isEditMode?2:1,0,null);this.$.Ia.qh(V,Ba);this.jq.FE(sb)}}catch(Ba){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${Ba.message}.`),this.jq.qo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
sb)}}static Lii(ca){return ca===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ca===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static HZf(ca){return ca===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||ca===OSF.DDA.EventDispId.dispidSettingsChangedEvent||ca===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static NWd(ca){return ca===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ca===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static FZf(ca){return ca===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static GZf(ca){return ca===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static EZf(ca){return ca===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(Hd,"OsfControl",Tc.a,[274]);class wb{constructor(){this.tfb={}}add(ca){this.tfb[ca]=!0}remove(ca){delete this.tfb[ca]}clear(){for(const ca of Object.keys(this.tfb))delete this.tfb[ca]}ERf(){return 0<Object.keys(this.tfb).length}bFi(){return Object.keys(this.tfb)}}Object(c.a)(wb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,
[]);var Xb=a(61);class Kb{constructor(ca,sb,Ba){this.nEg=this.mEg=0;this.i9b=this.Eub=null;this.RPj=()=>{var V=la.f(this.$).ha.$a.AK;if(this.hWd(V)&&(V=this.bSb(V))){var Fa={};Fa.chartId=V;Fa.worksheetId=this.lxa();Fa=Xb.a.Di(Fa);this.Nwa(51,V,Fa);this.Nwa(51,this.lxa(),Fa)}};this.SPj=()=>{if(this.Eub){var V={};V.chartId=this.Eub;V.worksheetId=this.i9b;V=Xb.a.Di(V);this.Nwa(52,this.Eub,V);this.Nwa(52,this.i9b,V)}V=la.f(this.$).ha.$a.AK;this.hWd(V)?(this.Eub=this.bSb(V),this.i9b=this.lxa()):this.i9b=
this.Eub=null};this.$=ca;this.Zn=sb;this.eo=Ba}jKb(ca){51===ca.messageType?this.mEg=this.sWa(ca.actionType,this.mEg,this.RPj):52===ca.messageType&&(this.nEg=this.sWa(ca.actionType,this.nEg,this.SPj))}sWa(ca,sb,Ba){if(1===ca)sb||la.f(this.$).ha.$a.Qpd(Ba),sb++,this.JIk();else if(2===ca){if(1>sb)return sb;1===sb&&la.f(this.$).ha.$a.Rje(Ba);sb--}return sb}Nwa(ca,sb,Ba){sb&&this.Zn.qS(ca,sb)&&this.eo.TM(ca,sb,Ba)}bSb(ca){return ca&&ca.floatingObject?(ca=ca.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===ca.length?ca[0]:null:null}lxa(){const ca=this.$.sa.la;return ca&&0===ca.IG?ca.sheetId:null}JIk(){const ca=la.f(this.$).ha.$a.AK;this.hWd(ca)&&(this.Eub=this.bSb(ca),this.i9b=this.lxa())}hWd(ca){return!!ca&&!!ca.floatingObject&&0===ca.floatingObject.type}}Object(c.a)(Kb,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Zb=a(967),Oc=a(201),Cd=a(746),Wd=a(120),ee=a(68);class he extends Fb.a{constructor(ca,sb,Ba){super();this.C5=this.ePa=0;this.Gj=(V,Fa)=>{if(this.enabled&&!(this.Z0f()||
null!==Fa&&void 0!==Fa&&Fa.H4f)&&(V=Object(xc.a)(Wd.a,this.$.sa.la))&&0===V.IG){const sc=V.sheetId,Kc=this.QGf();let qd=null,Eb=null;this.Zn.x4f()&&(qd=this.grid.oh.Ml(this.grid.ha.pa.activeCell),Eb=sc in this.yLc?this.yLc[sc]:null);this.i$e(sc,Kc)&&wc.TaskExtensions.$e(ee.Task.Ua(!0),()=>{this.Y6i(sc,Kc);this.I6i(sc,Kc,qd,Eb)},this.ya);this.Zrf(sc,Kc,qd)}};this.$=ca;this.Zn=sb;this.eo=Ba;this.grid=la.f(ca);this.x3a={};this.yLc={}}get enabled(){return!this.C5&&0<this.ePa}Bpc(ca){1===ca.actionType?
(this.ePa||this.grid.ha.z$(this.Gj),this.ePa++):2!==ca.actionType||1>this.ePa||(1===this.ePa&&this.grid.ha.Nca(this.Gj),this.ePa--)}gZc(ca){ca?this.C5++:(0<this.C5&&this.C5--,this.C5||this.Gj(null,new Cd.a(!1)))}QGf(){return this.grid.ha.pa.selectedRanges}i$e(ca,sb){return ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!ca&&Oc.e(this.x3a)||ca in this.x3a)&&!Vc.X(this.x3a[ca],sb):ca in this.x3a&&!Vc.X(this.x3a[ca],sb)}Zrf(ca,sb,Ba){this.x3a[ca]=
Vc.d(sb);this.yLc[ca]=Ba}Z0f(){return this.grid.isEditing||this.grid.kq}kBf(ca,sb){this.Zn.qS(14,ca)&&this.eo.TM(14,ca,sb);this.Zn.qS(14,Zb.a.kW)&&this.eo.TM(14,Zb.a.kW,sb)}Y6i(ca,sb){const Ba={};Ba.worksheetId=ca;Ba.address=this.ROd(sb);sb=Xb.a.Di(Ba);this.kBf(ca,sb)}I6i(ca,sb,Ba,V){if(this.Zn.x4f()){var Fa="";let sc="";V&&(Fa=V.Zq);Ba&&(sc=Ba.Zq);V?Ba?(sb=Ba.usedRange.Tnb(sb),Fa!==sc&&this.szc(Fa,"",ca),this.szc(sc,this.ROd(sb),ca)):this.szc(Fa,"",ca):Ba&&(Fa=Ba.usedRange.Tnb(sb),this.szc(sc,this.ROd(Fa),
ca))}}szc(ca,sb,Ba){if(this.Zn.qS(100,ca)){const V={};V.address=sb;V.worksheetId=Ba;this.eo.TM(100,ca,Xb.a.Di(V))}}ROd(ca){return Vc.j(ca,",",this.$,!1)}dispose(){0<this.ePa&&this.grid.ha.Nca(this.Gj);this.yLc=this.x3a=null;this.ePa=0;this.eo=this.Zn=this.$=this.grid=null}}Object(c.a)(he,"RichApiEventSelectionChangedHandler",Fb.a,[]);var pe=a(396);class Se extends he{constructor(ca,sb,Ba){super(ca,sb,Ba);this.N6f=this.O6f=null}QGf(){return pe.a.fuc(this.grid.ha.rangePicker.DZ)}i$e(ca,sb){return this.O6f!==
ca||!Vc.X(this.N6f,sb)}Zrf(ca,sb){this.O6f=ca;this.N6f=Vc.d(sb)}Z0f(){return!this.grid.isEditing&&!this.grid.kq}kBf(ca,sb){this.Zn.qS(2700,Zb.a.kW)&&this.eo.TM(2700,Zb.a.kW,sb)}}Object(c.a)(Se,"RichApiEventPickedRangesChangedHandler",he,[]);class Ta{constructor(ca,sb,Ba){this.X6a=this.W6a=0;this.XWa=this.gva=null;this.Alg=()=>{var V=la.f(this.$).ha.$a.AK;if(0<this.X6a&&this.gva&&this.XWa){var Fa={};Fa.shapeId=this.gva;Fa.worksheetId=this.XWa;Fa=Xb.a.Di(Fa);this.fireEvent(2102,this.gva,Fa)}this.vsj(V)?
(this.gva=this.E5k(V),this.XWa=this.lxa(),this.gva&&this.XWa)?0<this.W6a&&(V={},V.shapeId=this.gva,V.worksheetId=this.XWa,V=Xb.a.Di(V),this.fireEvent(2101,this.gva,V)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.gva}', or worksheet id: '${this.XWa}' from a Floating object or gridview.`):this.XWa=this.gva=null};this.$=ca;this.Zn=sb;this.eo=Ba}jKb(ca){const sb=la.f(this.$).ha;1===ca.actionType?(this.W6a||this.X6a||sb.$a.Qpd(this.Alg),2101===ca.messageType?
this.W6a++:2102===ca.messageType&&this.X6a++):2===ca.actionType&&(2101===ca.messageType?this.W6a=0<this.W6a?this.W6a-1:0:2102===ca.messageType&&(this.X6a=0<this.X6a?this.X6a-1:0),this.W6a||this.X6a||sb.$a.Rje(this.Alg))}vsj(ca){return!!ca&&!!ca.floatingObject&&(0===ca.floatingObject.type||7===ca.floatingObject.type||1===ca.floatingObject.type||3===ca.floatingObject.type||5===ca.floatingObject.type)}E5k(ca){if(!ca||!ca.floatingObject)return null;ca=ca.floatingObject.id;var sb=ca.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));
sb=sb&&1===sb.length?sb[0]:null;return sb?sb:(e.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${ca}', but we failed.`),null)}lxa(){const ca=this.$.sa.la;return ca&&0===ca.IG?ca.sheetId:null}fireEvent(ca,sb,Ba){sb&&this.Zn.qS(ca,sb)&&this.eo.TM(ca,sb,Ba)}}Object(c.a)(Ta,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Qa{constructor(ca,sb,Ba){this.rEg=this.qEg=this.sEg=this.pEg=0;this.f3j=(V,Fa)=>{V=Object(xc.a)(Wd.a,Fa.la);this.fqb(V)&&
(Fa={},Fa.worksheetId=V.sheetId,Fa=Xb.a.Di(Fa),this.Nwa(11,V.sheetId,Fa))};this.i3j=(V,Fa)=>{V=Object(xc.a)(Wd.a,Fa.OB);this.fqb(V)&&(Fa={},Fa.worksheetId=V.sheetId,Fa=Xb.a.Di(Fa),this.Nwa(12,V.sheetId,Fa))};this.g3j=(V,Fa)=>{V=Object(xc.a)(Wd.a,Fa.la);this.fqb(V)&&(Fa={},Fa.worksheetId=V.sheetId,V=Xb.a.Di(Fa),this.Nwa(11,null,V,!0))};this.h3j=(V,Fa)=>{V=Object(xc.a)(Wd.a,Fa.OB);this.fqb(V)&&(Fa={},Fa.worksheetId=V.sheetId,V=Xb.a.Di(Fa),this.Nwa(12,null,V,!0))};this.$=ca;this.Zn=sb;this.eo=Ba}jKb(ca){11===
ca.messageType?ca.targetId===Zb.a.kW?this.FLh(ca.actionType):this.ELh(ca.actionType):12===ca.messageType&&(ca.targetId===Zb.a.kW?this.GLh(ca.actionType):this.HLh(ca.actionType))}ELh(ca){this.pEg=this.sWa(ca,this.pEg,this.f3j)}HLh(ca){this.sEg=this.sWa(ca,this.sEg,this.i3j)}FLh(ca){this.qEg=this.sWa(ca,this.qEg,this.g3j)}GLh(ca){this.rEg=this.sWa(ca,this.rEg,this.h3j)}sWa(ca,sb,Ba){1===ca?sb=this.rWa(sb,Ba):2===ca&&(sb=this.NYa(sb,Ba));return sb}rWa(ca,sb){ca||this.$.sa.vn(sb);ca++;return ca}NYa(ca,
sb){if(1>ca)return ca;1===ca&&this.$.sa.Nn(sb);ca--;return ca}fqb(ca){return!!ca&&0===ca.IG}Nwa(ca,sb,Ba,V){sb=(void 0===V?0:V)?Zb.a.kW:sb;this.Zn.qS(ca,sb)&&this.eo.TM(ca,sb,Ba)}}Object(c.a)(Qa,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Ob=a(308),Jb=a(17),Jc=a(291);class zb extends Sys.EventArgs{constructor(ca,sb,Ba,V){super();this.sheet=ca;this.JVh=sb;this.offsetX=Ba;this.offsetY=V}}Object(c.a)(zb,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class tb{constructor(ca,sb,Ba){this.nsc=
null;this.r0d=!1;this.onPointerDown=V=>{if(3===V.Gh){const {Ihb:Fa}=this.da.OAc(V.clientPoint);this.r0d=!!Fa&&this.da.ha.pa.lsf(Fa)}else this.r0d=!1;this.nsc=V.clientPoint;return!1};this.rj=V=>{if(this.da.inRangePicker||this.da.kq||this.r0d||V.shiftKey||V.ctrlKey||V.La.button!==Sys.UI.MouseButton.leftButton||!this.nsc||!V.clientPoint||V.clientPoint.x!==this.nsc.x||V.clientPoint.y!==this.nsc.y)return!1;let Fa;var sc=(()=>{let qd=this.da.OAc(V.clientPoint);({Ihb:Fa}=qd);return qd})().returnValue;const Kc=
Object(xc.a)(Wd.a,this.$.sa.la);if(sc&&Kc&&0===Kc.IG){if(!this.da.ha.pa.Haa.contains(Fa))return!1;sc=new zb(Kc,Fa,$c.HelperMethods.HSc(sc.x),$c.HelperMethods.HSc(sc.y));this.j3j(sc)}return!1};this.$=ca;this.da=la.f(ca);this.Zn=sb;this.eo=Ba;this.Ukk()}dispose(){this.W7k()}Ukk(){for(const ca of this.da.Av){const sb=ca.domElement;Ob.a.instance.xa(Jb.a.Bj,sb,this.onPointerDown);Jc.a.instance.xa(Jb.a.click,sb,this.rj)}}W7k(){for(const ca of this.da.Av){const sb=ca.domElement;Ob.a.instance.Oa(Jb.a.Bj,
sb,this.onPointerDown);Jc.a.instance.Oa(Jb.a.click,sb,this.rj)}}j3j(ca){var sb=ca.sheet;if(this.fqb(sb)){var Ba={};Ba.worksheetId=sb.sheetId;Ba.address=ca.JVh.toString();Ba.offsetX=ca.offsetX;Ba.offsetY=ca.offsetY;ca=sb.sheetId;this.Zn.qS(21,ca)&&(sb=Xb.a.Di(Ba),this.eo.TM(21,ca,sb));ca=Zb.a.kW;this.Zn.qS(21,ca)&&(Ba=Xb.a.Di(Ba),this.eo.TM(21,ca,Ba))}}fqb(ca){return!!ca&&0===ca.IG}}Object(c.a)(tb,"RichApiEventSingleClickedHandler",null,[]);class zc{constructor(ca,sb,Ba){this.y5b=0;this.pub=this.Bub=
null;this.Itg=()=>{const V=la.f(this.$).ha.$a.AK;if(V)if(this.s5f(V)){const Fa=this.lxa();this.mId(Fa);this.Bub=V.floatingObject.id;this.pub=Fa}else this.Bub&&(this.mId(this.pub),this.pub=this.Bub=null);else this.Bub&&(this.mId(this.pub),this.pub=this.Bub=null)};this.$=ca;this.Zn=sb;this.eo=Ba}Bpc(ca){2E3===ca.messageType&&(1===ca.actionType?(this.y5b||la.f(this.$).ha.$a.Qpd(this.Itg),this.y5b++,this.PEk()):2===ca.actionType&&this.y5b&&(1===this.y5b&&la.f(this.$).ha.$a.Rje(this.Itg),this.y5b--))}mId(ca){var sb;
const Ba={};Ba.worksheetId=ca;Ba.revisionLoad=!1;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")){const V=la.f(this.$).ha.$a.AK;(null===(sb=null===V||void 0===V?void 0:V.floatingObject)||void 0===sb?0:sb.Ui)?Ba.selectedVisualId=V.floatingObject.Ui.VisualID:Ba.selectedVisualId=null}sb=Xb.a.Di(Ba);ca&&this.Zn.qS(2E3,ca)&&this.eo.TM(2E3,ca,sb)}lxa(){const ca=this.$.sa.la;return ca&&0===ca.IG?ca.sheetId:null}PEk(){const ca=la.f(this.$).ha.$a.AK;
this.s5f(ca)&&(this.Bub=ca.floatingObject.id,this.pub=this.lxa())}s5f(ca){return!!ca&&ca.X0d()}}Object(c.a)(zc,"RichApiEventVisualSelectionChangedHandler",null,[]);class dd{constructor(ca,sb,Ba){this.z5b=0;this.Nah=!0;this.Fzc=0;this.d_d=!0;this.Zff=()=>{const V=document.hasFocus();if(this.Nah!==V){if(V){const Fa=Xb.a.Di({});this.eo.TM(2203,Zb.a.kW,Fa)}this.Nah=V}};this.$ff=V=>{(0<V.timeRemaining()||V.didTimeout)&&this.Zff();window.requestIdleCallback(this.$ff)};this.$=ca;this.Zn=sb;this.eo=Ba;window.requestIdleCallback||
(this.d_d=!1)}DLh(ca){1===ca.actionType?(this.z5b||this.SLh(),this.z5b++):2!==ca.actionType||1>this.z5b||(1===this.z5b&&this.rfi(),this.z5b--)}SLh(){if(this.Zn.qS(2203,Zb.a.kW))if(this.d_d){const ca={};ca.timeout=this.$.ua.CheckFocusTimeout;this.Fzc=window.requestIdleCallback(this.$ff,ca)}else this.Fzc=window.setInterval(this.Zff,this.$.ua.CheckFocusTimeInterval)}rfi(){this.d_d?window.cancelIdleCallback(this.Fzc):window.clearInterval(this.Fzc)}}Object(c.a)(dd,"RichApiEventWorkbookActivatedHandler",
null,[]);var od;(function(ca){ca[ca.none=0]="none";ca[ca.registerEvent=1]="registerEvent";ca[ca.unregisterEvent=2]="unregisterEvent";ca[ca.customFunction=3]="customFunction";ca[ca.showCard=4]="showCard";ca[ca.createWorkbook=5]="createWorkbook";ca[ca.openWorkbook=6]="openWorkbook";ca[ca.enableEvents=7]="enableEvents";ca[ca.closeWorkbook=8]="closeWorkbook";ca[ca.setCalculationMode=9]="setCalculationMode";ca[ca.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";ca[ca.workbookLinksRequestRefreshAll=
11]="workbookLinksRequestRefreshAll";ca[ca.workbookLinksEnableContent=12]="workbookLinksEnableContent";ca[ca.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";ca[ca.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";ca[ca.rangePicker=15]="rangePicker";ca[ca.enableRichApiRecording=16]="enableRichApiRecording";ca[ca.recordAction=17]="recordAction";ca[ca.focus=18]="focus";ca[ca.businessBarShow=19]="businessBarShow";ca[ca.businessBarHide=20]="businessBarHide";ca[ca.augmentationLoopActivateAnnotation=
21]="augmentationLoopActivateAnnotation";ca[ca.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";ca[ca.showRangeValuesPreview=23]="showRangeValuesPreview";ca[ca.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(od||(od={}));Object(c.b)("PostProcessActionType",od);var gb=a(288);class gc{constructor(ca,sb,Ba,V){this.Eug=null;this.kId=(Fa,sc)=>{const Kc=Zb.a.kW,qd={};qd.eventId=Fa;qd.payload=sc;this.Zn.qS(2201,Kc)&&this.eo.TM(2201,Kc,Xb.a.Di(qd))};this.$=ca;this.Zn=sb;this.eo=Ba;this.ddaFacade=
V;this.Vdj()}CLh(ca){1===ca.actionType?(this.$.vha=!0,(re.yb.Ma()?this.ddaFacade:Object(xc.a)(a(958).DdaFacade,gb.a(this.$))).lId(!0)):2===ca.actionType&&(this.$.vha=!1);this.Eug=ca.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${od[ca.actionType]}; controlId: ${this.Eug}; this.ewaControl.IsMacroRecorderListening: ${this.$.vha}.`)}qni(ca){(re.yb.Ma()?this.ddaFacade:Object(xc.a)(a(958).DdaFacade,gb.a(this.$))).mBf(ca,this.$.vha)}Vdj(){this.$.a7&&
wc.TaskExtensions.$e(Object(jd.d)(Td.a.resolve(re.Ud,{va:1})),ca=>{(ca=ca.result)&&ca.init(this.kId)},this.$.ya,3)}}Object(c.a)(gc,"RichApiMacroRecorderEventHandler",null,[]);class Dc{}Object(c.a)(Dc,"StyleCacheItem",null,[]);class hd{constructor(ca,sb,Ba){this.$=ca;this.da=sb;this.xk=Ba}Uua(ca){this.range=ca;this.Isc=Array(ca.width);this.p1c=Array.from({length:ca.height},()=>Array(ca.width))}xEk(ca,sb,Ba,V){this.y3f(ca,sb)&&(this.p1c[ca-this.range.top][sb-this.range.left]||(this.p1c[ca-this.range.top][sb-
this.range.left]={backgroundColor:Ba.backgroundColor}),Ba.backgroundColor=V)}zEk(ca,sb,Ba){if(this.y3f(ca,sb)){ca=Yc.Range.yi(ca,sb);var V=this.da.yh(ca);V&&(this.Isc[sb-this.range.left]||(this.Isc[sb-this.range.left]=V.width),sb=this.xk.pue(this.da,[ca],Ba,!1),"Success"!==sb.kind&&e.ULS.sendTraceTag(508303323,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${sb.reason}.`))}}restore(){this.range&&(this.Isc.forEach((ca,sb)=>{ca=this.xk.pue(this.da,[Yc.Range.yi(this.range.top,
this.range.left+sb)],ca,!1);"Success"!==ca.kind&&e.ULS.sendTraceTag(508303322,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${ca.reason}`)}),this.p1c.forEach((ca,sb)=>{ca.forEach((Ba,V)=>{V=Yc.Range.yi(this.range.top+sb,this.range.left+V);if(V=this.da.yh(V))V.cell.backgroundColor=Ba.backgroundColor})}),this.Isc=this.p1c=this.range=void 0)}y3f(ca,sb){if(!this.range)return e.ULS.sendTraceTag(508303321,0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),
!1;(ca=this.range.contains(Yc.Range.yi(ca,sb)))||e.ULS.sendTraceTag(508303320,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");return ca}}Object(c.a)(hd,"InstantaneousGridContentRestorer",null,[]);var xd=a(217),fd=a(158);class kd{constructor(ca,sb,Ba,V){this.iVi=Fa=>{const sc=Fa.Oj.block;if(this.cD.Fk(sc.zj)){this.axg([sc.zj]);const Kc=la.f(this.$).OW(sc.zj),qd=()=>this.Twg([sc.zj]);setTimeout(()=>{Kc.skeletonMode?setTimeout(()=>{Kc.skeletonMode?e.ULS.sendTraceTag(508303319,
0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time."):qd()},kd.Beh):qd()},kd.Rfh)}return!0};this.nia=(Fa,sc)=>{0===sc.zx&&576!==sc.Xl.operation.operationName&&this.jnb(!0)};this.abe=Fa=>{this.b0c&&(this.fyi(Fa),this.NZ())};this.$=ca;this.Zn=sb;this.eo=Ba;this.da=la.f(this.$);this.sGc=new hd(this.$,this.da,V)}v6i(ca,sb,Ba,V){this.K2f(ca)?(sb=this.GTh(sb,Ba))?this.bD?e.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):
(this.worksheetId=ca,this.cD=sb,this.values=Ba,this.T8(V)):e.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):e.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}k4i(ca){this.K2f(ca)?this.jnb(!1):e.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}T8(ca){this.axg(this.sFf());
ca&&(e.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(ca)}`),ca.autoexpandTable&&this.LTh(),ca.autofitColumns&&this.ZSh());this.b0c=this.da.DN.T8(this.cD,this.iVi).then(sb=>{e.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");this.bD=sb;this.sGc.Uua(this.cD);this.Twg(this.sFf());this.$.userOperationManager.qw(this.nia);sb.a7b.then(()=>this.abe(!0),()=>this.abe(!0));return Promise.resolve()},
sb=>{e.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${sb}`);this.NZ();return Promise.resolve()})}jnb(ca){this.b0c&&(e.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),this.b0c.then(()=>{const sb=this.bD;this.abe(ca);sb&&sb.eba("RichApiRangeValuesPreview")},()=>{e.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}GTh(ca,
sb){ca=Vc.jb(ca,this.$.sa);if(ca.returnValue)return new Yc.Range(ca.range.top,ca.range.left,ca.range.top+sb.length-1,ca.range.left+sb[0].length-1,!0,!0)}K2f(ca){const sb=this.$.sa.la;return sb&&ca===sb.sheetId}axg(ca){this.nJd(ca,(sb,Ba,V,Fa)=>{Fa.cell.hQ=this.values[sb][Ba];return!0})}Twg(ca){this.kCa&&this.nJd(ca,(sb,Ba,V,Fa)=>{this.sGc.xEk(V.top,V.left,Fa,this.JMi(V.top));return!0});if(this.mgb){const sb=this.cD.Tnb(ca);0<sb.length&&this.mgb&&this.mgb.forEach((Ba,V)=>{this.sGc.zEk(sb[0].top,this.cD.left+
V,Ba)})}}nJd(ca,sb){for(let V=0;V<this.values.length;++V)for(let Fa=0;Fa<this.values[V].length;++Fa){const sc=Yc.Range.yi(this.cD.top+V,this.cD.left+Fa);if(!ca||ca.some(Kc=>Kc.contains(sc))){var Ba=this.da.wB(sc);if((!Ba||sc.equals(Ba.topLeft))&&(Ba=this.da.yh(sc))&&!sb(V,Fa,sc,Ba))return}}}sFf(){return this.da.za.uA().filter(ca=>ca.la===this.$.la).map(ca=>ca.zj)}fyi(ca){this.Zn.qS(3400,this.worksheetId)&&(ca=Xb.a.Di({type:"RangeValuesPreviewDismissed",source:"Local",tpl:ca}),this.eo.TM(3400,this.worksheetId,
ca))}NZ(){this.$.userOperationManager.vu(this.nia);this.Ivk();this.kCa=this.worksheetId=this.b0c=this.values=this.cD=this.bD=void 0}LTh(){if(this.cD){var ca=this.vZi(this.cD);if(ca){e.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");var sb=(sc,Kc)=>{var qd;return null===(qd=this.da.yh(Yc.Range.yi(sc,Kc)))||void 0===qd?void 0:qd.backgroundColor},Ba=ca.usedRange.top;if(ca.attributes&
16){var V=sb(ca.usedRange.top,ca.usedRange.left);++Ba}var Fa=sb(Ba,ca.usedRange.left);sb=sb(Ba+1,ca.usedRange.left);this.kCa={B2g:ca.usedRange.top,xSd:V,I2k:Fa,COh:sb}}else e.ULS.sendTraceTag(508303318,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else e.ULS.sendTraceTag(509227291,0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}ZSh(){this.mgb=Array(this.cD.width);
let ca=!1;this.nJd(void 0,(sb,Ba,V,Fa)=>{var sc;if(this.da.wB(V))return ca=!0,!1;sb=Fa.cell;sb=sb.Qjf(sb.hQ);sb>Fa.width&&(this.mgb[Ba]=Object(fd.a)(null!==(sc=this.mgb[Ba])&&void 0!==sc?sc:0,sb));return!0});ca&&(this.mgb=void 0)}Ivk(){this.sGc.restore();Vc.B(this.cD,(ca,sb)=>{ca=Yc.Range.yi(ca,sb);if(ca=this.da.yh(ca))ca.cell.hQ=void 0})}JMi(ca){return this.kCa.xSd&&ca===this.kCa.B2g?this.kCa.xSd:0===(ca-this.kCa.B2g-(this.kCa.xSd?1:0))%2?this.kCa.I2k:this.kCa.COh}vZi(ca){const sb=xd.b(this.da.$,
ca,!0);if(!(1<sb.length)){var Ba=Fa=>{var sc;const Kc=null!==(sc=this.da.oh.uZi(Fa))&&void 0!==sc?sc:this.da.oh.wZi(Fa);if(Kc)return Kc},V=Ba(ca);if(V&&0===sb.length)return V;if(0!==sb.length&&(ca=Vc.fb(ca,sb[0].usedRange),1===ca.length))return Ba(ca[0])}}}kd.Rfh=20;kd.Beh=100;Object(c.a)(kd,"RichApiRangeValuesPreview",null,[]);class Yb{}Object(c.a)(Yb,"SessionRecreationInfo",null,[]);class Cc{constructor(ca,sb,Ba){this.$=ca;this.Zn=sb;this.runtimeCalculationMode=Ba}SKj(){return ib.EwaSettings.Na(234)?
this.Zn.M7i()||0!==this.runtimeCalculationMode:!1}ZQh(){var ca={};ca.eventRegistrationInfos=this.Zn.mMi();ca.runtimeCalculationMode=this.runtimeCalculationMode;ca=Object(b.a)(new Yb,{runtimeState:ca});const sb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};sb.RequestBody=JSON.stringify(ca);sb.RequestFlags=1;return sb}}Object(c.a)(Cc,"RichApiRuntimeStateHandler",null,[]);class td{constructor(ca,sb,Ba,V,Fa,sc,Kc,qd,Eb){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=
null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=ca;this.processUtcTime=sb;this.dequeueUtcTime=Ba;this.inQueueDurationInMS=V;this.executionDurationInMS=Fa;this.operationCount=sc;this.ServerCorrelationId=Kc;this.UserOperationName=qd;this.IsDocumentHidden=Eb}}Object(c.a)(td,"UserOperationQueueItemsStatisticsData",null,[]);var Ad=a(1285),oe=a(73),qe=a(256),Be=a(517),Ee=a(64),
Ve=a(78),Oe=a(25),Ye=a(128),nf=a(58),of=a(54),Cf=a(200),Ff=a(134),Wf=a(51),Mf=a(33),ng=a(36),Rf=a(255),$f=a(28),jf=a(12),Hf=a(265),Uf=a(961),If=a(62),sf=a(1136),tc=a(26),ld=a(942);class Ed{constructor(ca,sb,Ba){this.OUc=0;this.t2e=new Set;this.e3f=!1;this.$=ca;this.Zn=sb;this.eo=Ba}BLh(ca){1===ca.actionType?this.Zn.qS(65541,Zb.a.kW)?this.OUc++:e.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===ca.actionType&&0<this.OUc&&this.OUc--}FOj(ca,sb){if(0===this.OUc)e.ULS.sendTraceTag(509649753,
0,50,"No event listeners. Event not fired.");else if(sb){ca=sb.annotation;var Ba=[];Ba.push({content:JSON.stringify(sb.annotation),annotationType:ld.a.getTypeNameFor(ca),id:ca.id});this.eo.TM(65541,Zb.a.kW,JSON.stringify({annotationProperties:Ba}))}else e.ULS.sendTraceTag(509649752,0,10,"Event args are null")}U2i(ca){const sb=this;return xo(function*(){if(!sb.Zn.qS(65541,Zb.a.kW))e.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!sb.t2e.has(ca.annotationType)){var Ba=yield Td.a.resolve(re.r,
{va:1});sb.e3f||(Ba.register(Ba.k6().I8("RichApi").H8(()=>{}).build()),sb.e3f=!0);Ba.uqa("RichApi",{annotationType:ca.annotationType,EA:!1,NV:sb.FOj.bind(sb)});sb.t2e.add(ca.annotationType)}})}V2i(ca){return xo(function*(){(yield Td.a.resolve(re.r,{va:1})).Qyb(JSON.parse(ca.content),"RichApi");e.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${ca.signalType}`)})}}Object(c.a)(Ed,"RichApiAugmentationLoopHandler",null,[]);var ze=a(1069),ge=a(1433),Ne=a(1432);Object(Td.b)(re.yb,{rk:"singleton"})(ca=>
xo(function*(){e.ULS.sendTraceTag(507581071,0,50,"DdaFacade created");if(r.AFrameworkApplication.disableWholeAppsForOfficeFeature)return e.ULS.sendTraceTag(507581070,0,50,`Not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${r.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`),null;const sb=yield Td.a.resolve(re.Ob,ca),Ba=yield Td.a.resolve(re.j,ca),V=yield Td.a.resolve(re.zc,ca),Fa=yield Td.a.resolve(re.Wg,ca);yield Object(jd.a)(Cb.a.y3d(65,()=>!(void 0===window.OSF||null===
window.OSF),sb.ua.MaxRetriesForLoadingScript,sb.ya,ca.va));yield Object(jd.a)(ze.a(sb.ya,ca.va));if(ib.EwaSettings.Na(359)){const sc=yield(yield Object(jd.e)(Ja.a.Bye($a.a.instance.Dk("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")))).isFeatureEnabled("mso_officeStore",!0),Kc=yield $a.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").aS("WACSideloadAddins");Ge.XMb=sc;Ge.WBe=Kc}"undefined"!==typeof OfficeExt&&"undefined"!==typeof OSF&&(ib.EwaSettings.Na(63)&&
OfficeExt.S2SOmexCatalogService.initRequestHandler(new Ne.a),sb.kk.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Ne.a,new ge.a(r.AFrameworkApplication.ea.appSettings.WebServiceBase),ib.EwaSettings.Na(70),!0),OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Ne.a),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Ne.a));return new Ge(sb,Ba,V,Fa)}));class Ge extends oc.a{constructor(ca,sb,Ba,V){super();
this.eo=this.Er=this.fa=null;this.Il=[];this.eZa=null;this.disposed=this.initialized=this.Ucc=this.iof=!1;this.sDa=null;this.ORc=[];this.cof=[];this.S5a=[];this.Vib=null;this.xde=new Gc.a(ba.a.tm());this.aoc=new Z.a(ba.a.tm());this.J3b=[];this.awg=[];this.vOb=350;this.pMa=this.C9=null;this.pnd=!1;this.iYe=this.hYe=this.YXe=this.gYe=this.fYe=this.dYe=this.$Xe=this.eYe=this.aYe=this.cYe=this.ZXe=this.bYe=null;this.bih=3E3;this.c8c=!1;this.XT=this.REb=null;this.kld=!1;this.lhd=new Z.a(ba.a.tm());this.Ahd=
new Z.a(ba.a.tm());this.Wl=()=>{this.TK?this.e_||(this.sDa=this.fa.Aq.WebExtensions):this.sDa=this.fa.Aq.WebExtensions;var Fa=qd=>ib.EwaSettings.Na(114)?!qd.jIa:!0,sc=qd=>ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?!qd.U0f:!0;const Kc=qd=>this.TK?"FA000000124"!==qd.mo.PrimaryMarketplace.SolutionId:!0;for(let qd=this.Il.length-1;0<=qd;--qd){const Eb=this.Il[qd];!this.Yxi(Eb.controlId)&&Fa(Eb)&&sc(Eb)&&Kc(Eb)&&(Eb.APc(),this.Il.splice(qd,1))}if(this.sDa)for(let qd=
0,Eb=this.sDa.length;qd<Eb;qd++)Fa=this.sDa[qd],(sc=this.ks(Fa.WebExtensionId))&&sc.Aae(Fa)};this.EQc=Fa=>{this.raiseEvent("csc",Fa.getID())};this.p5a=(Fa,sc,Kc)=>{if(sc===OSF.AgaveHostAction.KeyboardShortcuts){var qd=Object(xc.a)(Object,Kc);sc={};sc.keyCode=qd.keyCode;sc.type="keydown";sc.ctrlKey=qd.ctrlKey;sc.shiftKey=qd.shiftKey;sc.altKey=qd.altKey;sc.metaKey=qd.metaKey;qd=this.ks(Fa);Fa=qd.Wla;sc.srcElement=Object(Uc.a)(252,Fa)?Fa.sJb:la.f(this.$).ij;Fa=new Sys.UI.DomEvent(sc);qd=Ge.PJa(qd.mo,
this.$);sc={};sc.focusedAddinId=qd;qd=new Wb.a(1461300262,1,this.$.ji,6,null);la.f(this.$).m7b(Fa,qd,sc)}else if(sc===OSF.AgaveHostAction.Select)this.SPf(!0);else if(sc===OSF.AgaveHostAction.UnSelect)this.SPf(!1);else if(sc===OSF.AgaveHostAction.CancelDialog)this.kV(-684355545,null);else if(sc===OSF.AgaveHostAction.InsertAgave)Fa={},Kc&&(this.REb=Kc,Fa[fa.a.yua]=Kc,Fa[Wa.a.hl]=this.UHa(Kc),this.kV(-741808261,Fa));else if(sc===OSF.AgaveHostAction.ClickTrust)this.krd&&Kc&&(this.REb=Kc);else if(sc===
OSF.AgaveHostAction.OsfControlLoad)this.krd&&this.REb&&Kc&&this.xKh(this.REb,Kc)&&Kc.storeType&&(this.REb=null,this.xG(rb.b(Kc.storeType)));else if(sc===OSF.AgaveHostAction.InsertDevManifest)Fa={},Kc&&(Fa[fa.a.yua]=Kc,Fa[Wa.a.hl]=this.UHa(Kc),this.kV(-741808261,Fa));else if(sc===OSF.AgaveHostAction.InsertDevManifestError)Fa=Object(xc.a)(Object,Kc),Fa={[fa.a.Uqd]:this.Er.getDevManifestInvalidUrlErrorString(Fa.manifestUrl)},this.kV(-2025863019,Fa);else if(sc===OSF.AgaveHostAction.NotifyHostError)Fa=
{[fa.a.Uqd]:this.Er.getManifestInvaildErrorString()},this.kV(-2025863019,Fa);else if(sc===OSF.AgaveHostAction.RefreshAddinCommands)ib.EwaSettings.Na(52)&&this.kV(tc.a.refreshAddinCommands,null);else if(sc===OSF.AgaveHostAction.CtrlF6Exit||sc===OSF.AgaveHostAction.CtrlF6ExitShift){if(qd=Td.a.lh(re.Nb)){(Fa=this.ks(Fa).Wla)&&Fa.d1c();Ea.a.Cm&&document.activeElement.blur();var Eb={keyCode:117,type:"keydown",ctrlKey:!0};Eb.shiftKey=sc===OSF.AgaveHostAction.CtrlF6ExitShift;Eb.srcElement=Object(Uc.a)(252,
Fa)?Fa.sJb:la.f(this.$).ij;Fa=new Sys.UI.DomEvent(Eb);qd.rAa(Fa)}}else if(sc===OSF.AgaveHostAction.PageIsReady){if((Fa=this.ks(Fa).Wla)&&Fa.Efb===OSF.OsfControlTarget.TaskPane&&(Fa=null,(Fa=Oe.a.xp()?Td.a.lh(re.lf):this.$.qa.zh(183))&&this.Il))for(qd of this.Il)Ge.L1a(qd.UX)&&Fa.Lp(!0,!1)}else if(sc===OSF.AgaveHostAction.TabExit){sc=this.ks(Fa);const Zd=sc.Wla;Zd?Zd.Efb===OSF.OsfControlTarget.InContent?Zd.s6f():Zd.Efb===OSF.OsfControlTarget.TaskPane&&(Ea.a.Cm&&document.activeElement.blur(),Oe.a.xp()?
void Td.a.resolve(re.lf,{va:3}).then(nb=>{const ic=Object(Uc.a)(252,Zd)?Zd:null;ic?ic.isResizable?nb.focusResizeHandle():nb.focusTabbedTaskPaneArea():nb.focusTabbedTaskPaneArea()}):Lb.a.fo().then(nb=>{const ic=Object(Uc.a)(252,Zd)?Zd:null;ic?ic.isResizable?nb.focusResizeHandle():nb.focusTabbedTaskPaneArea():nb.focusTabbedTaskPaneArea();return null})):sc&&4===sc.osfControlType&&this.Er.notifyAgave(Fa,OSF.AgaveHostAction.TabIn)}else if(sc===OSF.AgaveHostAction.TabExitShift)(sc=this.ks(Fa),qd=sc.Wla)?
qd.Efb===OSF.OsfControlTarget.InContent?qd.t6f():qd.Efb===OSF.OsfControlTarget.TaskPane&&(Fa=Object(Uc.a)(252,qd)?qd:null)&&(Ea.a.Cm&&document.activeElement.blur(),Fa.OFk()):sc&&4===sc.osfControlType&&this.Er.notifyAgave(Fa,OSF.AgaveHostAction.TabIn);else if(sc===OSF.AgaveHostAction.EscExit||sc===OSF.AgaveHostAction.ExitNoFocusable||sc===OSF.AgaveHostAction.ExitNoFocusableShift)if(qd=this.ks(Fa).Wla)qd.d1c();else{if(sc===OSF.AgaveHostAction.EscExit){sc=null;for(Eb of N.o1i())if(Eb.value.fl===Fa){Eb.value.dialog.hide();
sc=Eb.key;break}sc&&(Fa=this.ks(sc))&&4!==Fa.osfControlType&&this.Fl.notifyAgave(sc,OSF.AgaveHostAction.TabIn)}}else if(sc===OSF.AgaveHostAction.InstallCustomFunctions)if(ib.EwaSettings.Na(114)){Wf.a(this.$).GCf(()=>!1);var vc=this.$.qa;wc.TaskExtensions.$e(Ve.GetServiceTaskFactory.dk(vc,278,279,1),Zd=>{Zd=Zd.result;vc.zh(278)||vc.Rh(278,Zd);const nb=Kc.osfControl.getStoreType();Zd.VWf(Kc.osfControl.getSolutionId(),nb,Ge.fKi(Kc.osfControl),Kc).yBa()},this.ya,3)}else e.ULS.sendTraceTag(537170577,0,
10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(sc===OSF.AgaveHostAction.UninstallCustomFunctions)if(ib.EwaSettings.Na(114)){Wf.a(this.$).GCf(()=>!1);var Kd=this.$.qa;wc.TaskExtensions.$e(Ve.GetServiceTaskFactory.dk(Kd,278,279,1),Zd=>{Zd=Zd.result;Kd.zh(278)||Kd.Rh(278,Zd);Zd.e5g(Kc.solutionId,Kc.storeType).yBa()},this.ya,3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");
else sc===OSF.AgaveHostAction.SendTelemetryEvent?mc.a.sendOtelEvent({otelEvent:Kc}):sc===OSF.AgaveHostAction.SendCustomerContent?mc.a.sendOtelCustomerContent({otelEvent:Kc}):sc===OSF.AgaveHostAction.LaunchExtensionComponent?k.a.instance.axj(Kc):sc===OSF.AgaveHostAction.RefreshRibbonGallery?void Td.a.resolve(re.re,{va:0}).then(Zd=>{Zd.JRd(Kc)}):sc===OSF.AgaveHostAction.RemoveAppCommandsAddin?this.Nmk(Kc.solutionId):sc===OSF.AgaveHostAction.GetOriginalControlId&&(Fa=new Xa.a(this.$.xi,Kc.ownerAddinSolutionId,
new aa.a,!0),Kc.originalControlId=Fa?Fa.Bof(Kc.controlId):Kc.controlId)};this.AOg=(Fa,sc)=>{const Kc=Array(2);Kc[0]=sc;Kc[1]=null;this.eo.jyi(Fa,JSON.stringify(Kc))};this.Ktg=()=>{this.$.la&&oe.n(this.$.la)&&(re.Wg.Ma()?this.webExtensionView.JVb():yb.a(this.$).JVb())};this.Dj=()=>{this.E8f()};this.onBlockCacheItemChanged=(Fa,sc)=>{Fa=sc.Oj;(Fa=(Fa=Fa.block.state&1?Fa.block.Yj:null)?Fa.CustomFunctionsObjects:null)&&this.Xzd(Fa)};this.m2=(Fa,sc)=>{var Kc,qd;1===sc.zx&&(Fa=sc.Xl)&&(sc=new td(Ff.toTimestamp(Fa.enqueueUtcTime),
Ff.toTimestamp(Fa.processUtcTime),Ff.toTimestamp(Fa.dequeueUtcTime),Ff.getElapsedMilliseconds(Fa.enqueueUtcTime,Fa.processUtcTime),Ff.getElapsedMilliseconds(Fa.processUtcTime,Fa.dequeueUtcTime),Fa.operationCount,(null===(qd=null===(Kc=Fa.operation)||void 0===Kc?void 0:Kc.lk)||void 0===qd?0:qd.ServerCorrelationId)?Fa.operation.lk.ServerCorrelationId:null,Fa.operation?Enum.toString(Be.a,Fa.operation.operationName):null,Uf.a.iN(Ff.getElapsedMilliseconds(Fa.enqueueUtcTime,Mf.a.kh.vi))),Kc=Sys.Serialization.JavaScriptSerializer.serialize(sc),
e.ULS.sendTraceTag(50872916,0,50,Kc))};this.jPc=()=>{this.KEg()};this.hj=(Fa,sc)=>{!this.fa.ki&&qe.a(sc)?this.KEg():(sc.fN&&(e.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.tJg()),this.lT(),ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.Ucc=!1))};this.$t=()=>{ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),
this.tJg());this.lT();ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.Ucc=!1)};this.nxg=Fa=>{Fa=Fa.Result;if(Fa=null===Fa||void 0===Fa?void 0:Fa.AgaveData){var sc=Fa.PrimaryMarketplace.SolutionId;sc=Fa.SrcLocationOverrideResourceId?this.LJa(Fa.PrimaryMarketplace.SolutionId,Fa.SrcLocationOverrideResourceId):sc;if(sc=this.eId(sc))this.lhd.ga(Fa.InstanceId,sc.controlId),this.Ahd.ga(sc.controlId,Fa.InstanceId)}else e.ULS.sendTraceTag(507637772,0,10,"Silent Reload::postServerReloadSuccess: failed to return valid response.")};
this.mkg=Fa=>{Fa.APc();this.raiseEvent("cd",Fa.controlId)};this.th=ca;this.webExtensionView=V;this.nrd=sb;this.initialize(Ba);db.Ga(this);this.KKg=0;(ca=(ca=!(Ea.a.Oy||Ea.a.H1))&&!Ea.a.Cm)&&OfficeExt.ShortcutKeyDispatchManager.init();this.voh={}}get $fb(){return this.C9||(this.C9=new Ib.a(this.$.wK))}Ipd(ca){this.addHandler("cd",ca)}bok(ca){this.removeHandler("cd",ca)}VCh(ca){this.addHandler("csc",ca)}dok(ca){this.removeHandler("csc",ca)}SCh(ca){this.addHandler("ca",ca)}aok(ca){this.removeHandler("ca",
ca)}TCh(ca){this.addHandler("ci",ca)}UCh(ca){this.addHandler("ekros",ca)}cok(ca){this.removeHandler("ekros",ca)}ade(ca,sb){try{return JSON.parse(ca)[sb].toLowerCase()}catch(Ba){return""}}kMk(ca){const sb=this.ade(ca,"AudienceGroup"),Ba=this.ade(ca,"SessionOrigin");try{const V=parseInt(this.ade(ca,"Ring"),10);if("automation"!==sb&&"bluechicken"!==Ba&&-2<=V)return!0}catch(V){if("automation"!==sb&&"bluechicken"!==Ba)return!0}return!1}get Fl(){if(!this.Er){const ca={},sb=!(this.$.Kj&1),Ba=Cb.a.current.bT,
V=this.$.workbookContext,Fa=r.AFrameworkApplication.w3?r.AFrameworkApplication.ea.Ya("StaticContentHostNonOverriden"):Mb.a.AW,sc=Fa+Mb.a.Osc;ca.pageBaseUrl=Ba.LayoutsContentUrlPrefix;ca.appName=OSF.AppName.ExcelWebApp;ca.appVersion="16";ca.appSettings=this.OOi();ca.singleSignOnSettings=L.a.kYi();ca.clientMode=sb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;ca.appUILocale=this.$.ua.UICultureTag;ca.dataLocale=this.$.ua.DataCultureTag;ca.docUrl=V.ClientUrl;ca.hostControl=this;ca.formFactor=OSF.FormFactor.Default;
ca.lcid=this.$.SN.toString();ca.localizedScriptsUrl=Fa+Mb.a.Rif;ca.localizedImagesUrl=sc;ca.localizedStylesUrl=Fa+Mb.a.Oif;ca.localizedResourcesUrl=sc;ca.osfOmexBaseUrl=Ba.OsfOmexBaseUrl;ca.firstPartyManifestCDNUrl=Ba.FirstPartyAddInManifestCDN;ca.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.ea.Ya("SdxAssetsToPrefetchMapping");ca.sdxCdnUrl=Ba.SdxCdnUrl;ca.sdx1CdnUrl=Ba.Sdx1CdnUrl;ca.forceUseSdx1Cdn=Ba.ForceUseSdx1Cdn;ca.sdxDmsUrl=Ba.SdxDmsUrl;ca.sovereignFederationDMSToken=Ba.SovereignFederationDMSToken;
ca.sovereignFederationDMSTokenSuffix=Ba.SovereignFederationDMSTokenSuffix;ca.defaultManifestTokens=r.AFrameworkApplication.defaultManifestTokens;ca.devCatalogUrl=Ba.DevCatalogUrl;ca.controlStatusChanged=this.EQc;ca.notifyHost=this.p5a;ca.allowExternalMarketplace=this.$.fa.Dn.get(27)&&Ge.XMb;ca.enableAddinCommands=ib.EwaSettings.Na(52);ca.enableBlackForestRedirect=ib.EwaSettings.Na(87);ca.enableMyOrg=this.$.fa.Dn.get(33);ca.enableMyApps=this.$.fa.Dn.get(34);ca.enableDevCatalog=ib.EwaSettings.Na(43);
ca.enablePrivateCatalog=this.hNk();ca.showSignOutFromPrivateCatalogMessage=this.$.fa.Dn.get(36);ca.enableUploadFileDevCatalog=ib.EwaSettings.Na(52)&&!ib.EwaSettings.Na(254)&&Ge.WBe;ca.userNameHashCode=Q.a.uE(r.AFrameworkApplication.userName);ca.envCode=this.$.ua.OfficeAddinTelemetryDataSourceCode.toString();ca.enableSingleSignOnForAddin=r.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;ca.enableDisplayBlockedMinorError=ib.EwaSettings.Na(171);ca.hideAppsExtensionUrl=r.AFrameworkApplication.hideAppsExtensionUrl;
ca.enableAnonymousUseLegacyCatalogService=ib.EwaSettings.Na(162);ca.enableInsertDialogAccessibilityFix=ib.EwaSettings.Na(169);ca.disableAppsForOfficeThirdParty=ib.EwaSettings.Na(174);ca.enableFirstPartySSO=ib.EwaSettings.Na(186);ca.wacSessionId=this.$.ua.UserSessionId;ca.disableLogging=!this.$.ua.AriaLoggingIsEnabled;ca.enableFirstPartySDXErrorMessages=ib.EwaSettings.Na(198);ca.isHostDocumentDomain=ib.EwaSettings.Na(209);ca.loggableUserId=r.AFrameworkApplication.ea.Ya("LoggableUserId");ca.sessionStartInfoJson=
r.AFrameworkApplication.ea.Ya("SessionStartInfoJson");ca.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;ca.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.ea.Ya("PostMessageOrigin");ca.wacIsEmbedded=r.AFrameworkApplication.ea.ka("IsEmbedded");ca.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.ea.ka("AccessibilityAllowFocusAddinTaskpane");ca.enableRemoveAppCommandsAddin=r.AFrameworkApplication.ea.ka("RemoveAppCommandsAddinIsEnabled");ca.isHostFrameTrustCheckEnabledForAddIns=
r.AFrameworkApplication.ea.ka("HostFrameTrustCheckIsEnabledForAddIns");ca.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;ca.agaveAddinUploadEnabled=ib.EwaSettings.Na(45);ca.hostAllowedOfficeStore=r.AFrameworkApplication.ea.ka("HostAllowedOfficeStore");ca.hostAllowedSdxEmbedding=r.AFrameworkApplication.ea.ka("HostAllowedSdxEmbedding");ca.hostInstallAddIns=r.AFrameworkApplication.ea.Ya("HostInstallAddIns");ca.hostInstallAddInsIsEnabled=r.AFrameworkApplication.ea.ka("HostInstallAddInsIsEnabled");
ca.approvedAddIns=r.AFrameworkApplication.ea.Ya("ApprovedAddIns");ca.addinEnforceHttpsIsEnabled=this.kMk(ca.sessionStartInfoJson);ca.hostFeatureGateFlag=0;ca.isUpnCheckEnabled=r.AFrameworkApplication.ea.ka("IsUpnCheckEnabled");ca.wacUpn=r.AFrameworkApplication.ea.Ya("UserPrincipalName");ca.isReactRibbonEnabled=Oe.a.isReactRibbonEnabled();ca.enableSetFocusOnTaskpaneOnUserAction=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);ca.isSafariWithIndexedDBDisabled=
ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ea.a.Ooa;ca.isIndexedDBDisabled=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ea.a.Ooa||ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&Ea.a.Cm;ca.enableCustomShortcuts=!0;ca.changeGetModifierKeyStringOutputOrder=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");ca.officeJsUrl=r.AFrameworkApplication.uL("OfficeJs/excel.js",
5);ca.enableOfficeJsUrlParam=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Er=new OSF.ContextActivationManager(ca);this.Er.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Er.setWSA(r.AFrameworkApplication.cu);this.Er&&"undefined"!==typeof this.Er.hostCheckReadyHandler&&r.AFrameworkApplication.XDh(Object(Pa.a)(this.Er,this.Er.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const Kc=$a.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.Er.setOAuthManager(Kc)}catch(Kc){}}return this.Er}get Dgl(){return this.pnd}get Zn(){return this.bYe}get vBa(){return this.ZXe}get hne(){return this.cYe}get gne(){return this.aYe}get Kwk(){return this.eYe}get Iwk(){return this.$Xe}get Jwk(){return this.dYe}get Lwk(){return this.fYe}get Mwk(){return this.gYe}get ine(){return this.hYe}get JKg(){return this.iYe}get L6(){return this.voh}get $(){return this.th}get fne(){return this.YXe}Rpc(ca){const sb={};sb.Name=ca.Name;sb.BindingType=ca.BindingType;
sb.HasHeaders=ca.HasHeaders;ca.IsValidRef&&(sb.ColCount=ca.Reference.LastColumn-ca.Reference.FirstColumn+1,sb.RowCount=ca.Reference.LastRow-ca.Reference.FirstRow+1);return sb}get qfb(){return r.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&r.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")}N7f(ca,sb){const Ba=this.$Ph(sb);let V=null;if(r.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==sb&&"LaunchAddinDialogFromTellMe"===sb[0])null!==Ba.assetId&&"undefined"!==typeof Ba.assetId&&(V="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.qfb){const Fa=this.$.fa.Dn.get(27);!Fa||null===sb||"InsertMoreAddInsFromFooter"!==sb[0]&&"InsertMoreAddInsFromBackstageFooter"!==sb[0]&&"InsertMoreAddInsFromStoreDialog"!==sb[0]?!Fa||null===sb||"AddinFlyoutMoreButton"!==sb[0]&&"LaunchMyAddInsFromBackstage"!==
sb[0]||(V="0"):V="{98143890-AC66-440E-A448-ED8771A02D52}"}ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8253544_LogTelemetryForStoreDialog")&&mc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowStoreDialog",dataFields:jc.a.xn({["controlId"]:null!==sb?sb[0]:"AllSources"})});this.Er.launchInsertDialog(ca,V,Ba)}get e_(){return this.kld}get TK(){return ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)}get Znj(){return ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",
!1)}yxa(ca){return this.Ahd.mh(ca)?this.Ahd.ma(ca):ca}p6(ca){return this.lhd.mh(ca)?this.lhd.ma(ca):ca}get vU(){return this.OVa}get OVa(){this.krd&&!this.XT&&(this.Bkk&&this.pni(this.bih),this.XT=ub.createInstance(r.AFrameworkApplication.ea,new Bb.a(()=>this.Er),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.l0k,["AreThirdPartyAddInsAllowed"]:this.$.L4,["PopularAddinDetailsJsonString"]:this.wbf&&this.T8j?Ge.S8j:Ge.jub,["UICulture"]:r.AFrameworkApplication.uiCulture}));
return this.XT}get l0k(){return ib.EwaSettings.Na(174)}get allowExternalMarketplace(){return this.$.fa.Dn.get(27)}get krd(){return r.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}static get jub(){return'[{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":45662}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":84}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1759}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":3,"AUP":6458}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":13200}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":73}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":10751}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":3216}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":872}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":3,"AUP":3973}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.7.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"33107.40f3490e-24f2-4502-9a44-28e543d36a75.71f00b00-2d16-4d33-9b7a-7b1cbdbbbf52.5eeb833f-109d-4a4b-8a7d-c5954dfd778e.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":822}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":1968}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":3473}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":346}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":1332}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":533}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":348}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":1167}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1755}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":374}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":9563}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":311}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":1247}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":444}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":54042}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":3,"AUP":699}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1898}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":851}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\'s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":3,"AUP":2986}},{"displayName":"OrbusInfinity Import Tool","solutionId":"wa200000421","version":"2.9.0.0","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your OrbusInfinity Repository","iconUrl":"58921.df1e5367-d9bc-46a7-8259-9b24225f294e.1638f80d-c1de-4a83-96d5-4dd2012058c9.0f1a47c7-5d54-427b-be34-d415727301cc.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":3,"AUP":144554}},{"displayName":"Workspace Lite Add-in","solutionId":"wa200000565","version":"1.0.0.75","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using LSEG\u2019s unique content and analytics","iconUrl":"29750.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.965e10e4-deeb-43e1-b9e3-5801171d8464.baa9f23e-6f54-4889-9419-35de7fe21515.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":516}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":1938}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1073}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":487}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\'s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":996}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":324}},{"displayName":"Excel Labs, a Microsoft Garage project","solutionId":"wa200003696","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"Try experimental features from the Microsoft Excel team.","iconUrl":"56617.70ef3bb6-fd4c-4868-b560-ed816d7473dd.47eea830-aced-47db-900a-a37347c5fdff.edeaaad8-6367-401c-9a40-138c4200c0ec.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":1616}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":798}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":1340}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":955}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":340}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.4.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":1297}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":-1,"AUP":58}},{"displayName":"Formula Bot | AI Formula Generation and Data Automation","solutionId":"wa200004935","version":"6.0.0.0","targetType":1,"width":0,"height":0,"description":"Revolutionize your analytics workflow, from formula generation to data automation.","iconUrl":"55472.02bef729-7dee-4518-80a6-f1201acff812.93152da9-df92-4449-86fb-7b5555756176.fa00d9a4-0225-4c45-a649-c70f05461582.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://formulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":4975}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Use ChatGPT with the CoPilot experience right within your favorite office app.","iconUrl":"33851.9a73910f-bc07-461c-a5aa-da58e2ce898e.fe022fd3-f2d4-4057-bd68-fd8ef192180a.ac2e20fb-999e-43fc-b780-f35d91b9db91.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":402}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":3,"AUP":41}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"2.4.4.0","targetType":1,"width":0,"height":0,"description":"Unlock the Power of Excel with AI intelligence - Chat GPT for Excel ","iconUrl":"19817.86bed75f-2814-457c-b505-403f890ae109.370b210a-a3c6-4be9-a1b5-9cd2ccfd6dc5.ff278ee8-b733-429b-b34b-9fc3b08d5bea.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":9879}},{"displayName":"Numerous.ai - ChatGPT for Excel","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":555}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":123}},{"displayName":"GPT for Excel Word","solutionId":"wa200005502","version":"1.0.0.11","targetType":1,"width":0,"height":0,"description":"Use GPT AI in Excel and Word to edit, translate, explain, ask, classify, extract, summarize.","iconUrl":"57573.f9f47c4a-38c2-4ed8-b7cc-a8815cd3dcd0.c5bed181-b36c-4c88-b989-056784b5402d.c22af8d2-689f-4982-b9e1-80b025140566.png","licenseUrl":"https://static.talarian.io/gpt-in-excel/GPT_in_Excel_TOS.pdf","privacyUrl":"https://talarian.io/privacy-policy","addinInfo":{"priority":1,"AUP":25712}},{"displayName":"Supermetrics","solutionId":"WA104381807","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Unlock the power of your marketing data in Excel with Supermetrics","iconUrl":"19350.bb8cdc30-0a91-4002-884a-b62395c980a4.49156328-1344-48b2-b77d-a29f2fddb106.210c5e26-f550-4bf3-825d-674d9f004172.png","licenseUrl":"https://supermetrics.com/terms-of-service","privacyUrl":"https://supermetrics.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Business Assist - Forecast","solutionId":"WA200005702","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Reduce your organization\'s helpdesk cost by using Business Assist Forecast.","iconUrl":"14472.f9e7cd0c-b0a1-46c9-8121-703e461934bb.9bb6db57-0f7e-4365-83e3-c71dfb411640.49c33548-12d6-4184-a39c-04b1918d113e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":78}},{"displayName":"Autopilot","solutionId":"WA200005669","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Free - Use ChatGPT within Microsoft Office with a Copilot experience.","iconUrl":"63616.36723807-bf6b-458b-85d4-c6c068296f33.f8d6629a-b2a5-468d-9d29-61660784380c.50af4801-c087-475b-af11-23b4531d0479.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":3,"AUP":586}},{"displayName":"Compare and Merge for Excel","solutionId":"WA200005782","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Compare Excel data within minutes. Find and resolve differences. Save hours of manual data review.","iconUrl":"30074.934ac94e-6eb5-42e9-bd61-d950303e2383.64b35664-874b-4eea-a5c5-22b9b1dfa6fd.d9552652-5a80-4f6b-b7dc-254b48fbb5ff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.strivetech.com/apps/excelcompareandmergeprivacy","addinInfo":{"priority":3,"AUP":135}},{"displayName":"Array Assistant","solutionId":"WA200005565","version":"1.0.1.0","targetType":1,"width":0,"height":0,"description":"Your AI Excel Assistant, Helping You Work Smarter and Faster! Try your first two weeks for Free!","iconUrl":"19248.dfd99dce-ae19-48c0-89aa-3654a01080ce.5d15e809-f4e4-42e1-813f-8235aab23209.6bb22ab5-ef1d-4810-8ad3-b0ac5496fc4e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://arrayassistant.ai/legal","addinInfo":{"priority":3,"AUP":100}},{"displayName":"Webex","solutionId":"WA200000068","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Bring Webex messaging and collaboration to your Microsoft files.","iconUrl":"39598.b4ad1d22-0361-475d-8552-534f8374babf.520bf26d-4b81-43fa-ac63-415826cb02fb.11a6abf0-7171-48ff-8c69-26b9e338033f.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848812/Product_42949683051/Asset_46d15f2a-cf03-461d-bd9f-9633d61422c9/universalcloudagreement.pdf","privacyUrl":"https://www.cisco.com/c/en/us/about/legal/privacy-full.html","addinInfo":{"priority":3,"AUP":192}},{"displayName":"draw.io Diagrams","solutionId":"WA200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":1,"AUP":797}},{"displayName":"Personalised QR Code Generator","solutionId":"WA200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":156}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"WA104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":1249}},{"displayName":"Wikipedia","solutionId":"WA104099688","version":"1.7.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":332}},{"displayName":"Bing Maps","solutionId":"WA102957661","version":"1.6.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":13556}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"WA104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":-1,"AUP":697}},{"displayName":"CSV Import+Export","solutionId":"WA200000025","version":"1.0.0","targetType":1,"width":0,"height":0,"description":"Import and export CSV files on Excel.","iconUrl":"58575.082549a1-a61c-4d6a-b397-1281a6b2818d.f4f41bd6-d825-4219-af6e-da610c4a7324.1b9d835d-23bf-45b0-818d-783bef621094.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.emeditor.com/about/privacy-policy","addinInfo":{"priority":3,"AUP":858}},{"displayName":"Money in Excel","solutionId":"WA200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.asp","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Isograd Learning Platform","solutionId":"WA200006017","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Isograd Learning Platform is an online courseware solution for Microsoft 2019 and Microsoft 365.","iconUrl":"6539.d4a08e78-43e8-4bd4-823f-8b9bb98f71c8.358fe9da-edf0-4bd2-8f23-eabe1b2de609.79a5fd12-e871-4f4b-ad2d-e3265cff3b2c.png","licenseUrl":"https://learning.isograd.com/eula","privacyUrl":"https://learning.isograd.com/privacypolicy","addinInfo":{"priority":3,"AUP":10}},{"displayName":"Bracket Builder","solutionId":"WA200006008","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Build double elimination tournament brackets compatible with Little League","iconUrl":"50028.22f4f90a-426f-475a-beba-d0189799b8bd.7f3ed4ca-2f1a-436c-9839-dd7764195b7f.db54fea0-fdaf-44f7-a816-41361b822660.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://addin.red.traynrex.com/help/Privacy.html","addinInfo":{"priority":3,"AUP":3}},{"displayName":"Excel Send to Trello","solutionId":"WA200005960","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"This Excel add-in makes it easy to bulk create cards in Trello from a table.","iconUrl":"8664.52ca8fd6-95d6-47e7-b679-b9f888571bc7.5efe9dcf-a87f-4171-ac66-cb9c30b5226e.5d8ecce4-7fc8-49dd-87fd-07095c48deac.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://kryl.com/?page=/privacy","addinInfo":{"priority":3,"AUP":3}},{"displayName":"XperienceED","solutionId":"WA200005817","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Web-based, hands-on learning for Microsoft 365 Apps and Microsoft 2019.","iconUrl":"6120.0e948c8b-c5cf-4b7a-b18f-3d59a7105ce2.fcdc57d0-ecf7-430c-94c1-9742dc8a097c.af83a49b-bd1c-43a3-bf7d-9c061ec545c8.png","licenseUrl":"https://ccilearning.com/wp-content/uploads/2023/03/XperienceED-EULA-August-14-2022_clear.docx","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":7}},{"displayName":"Green Street Add-In","solutionId":"WA200005876","version":"1.0.4.24","targetType":1,"width":0,"height":0,"description":"Enhance your investment analyses with Green Street\'s industry leading commercial real estate data ","iconUrl":"49943.bc2d4344-5f24-4610-b662-91c4934d717d.590cce90-117c-42db-baa3-83d5d7daa95f.c83b6cf7-1070-4e11-896f-53331b434c3e.png","licenseUrl":"https://www.greenstreet.com/termsofuse","privacyUrl":"https://files.greenstreet.com/public_files/GlobalPrivacyPolicy.pdf","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"R2 Copilot: Private Chat GPT for Excel","solutionId":"WA200006007","version":"1.0.4.0","targetType":1,"width":0,"height":0,"description":"R2 Copilot is a privacy-centric, GPT-powered AI assistant for your everyday business communications.","iconUrl":"56225.35fd77ec-1e64-4d91-b540-7e993a97b899.736533f6-6174-46c6-9736-9d0074bc04cb.93461044-7ae6-496e-abfb-17b484279f77.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://r2copilot.ai/policy","addinInfo":{"priority":2,"AUP":252}},{"displayName":"Spreadsheet AI","solutionId":"WA200006009","version":"1.0.1.6","targetType":1,"width":0,"height":0,"description":"AI chat copilot in Excel who understands your workbook and assists with countless spreadsheet tasks.","iconUrl":"14669.7db070f8-5e86-4224-b93c-0f0447636b16.132765a9-fdd4-41f1-9c90-aa6f0d6b82dc.45c767b9-81c9-4813-a7d1-462156cc844b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/docs/privacy","addinInfo":{"priority":2,"AUP":76}},{"displayName":"Widata","solutionId":"WA200005777","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"WiData is a platform seamlessly integrated into Excel to assist you in accessing all financial data","iconUrl":"42486.cf83fc97-7cc4-4fc9-a442-27252297bd9d.a3b30b83-17e9-41ef-88f3-72c47dfaee63.4eb440c2-941b-4d85-bc6f-a0c115f258ab.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.widata.vn/en/ch%C3%ADnh-s%C3%A1ch-b%E1%BA%A3o-m%E1%BA%ADt","addinInfo":{"priority":3,"AUP":25}},{"displayName":"McGraw Hill","solutionId":"WA200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":-1,"AUP":176861}},{"displayName":"Web Video Player","solutionId":"WA104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":294}},{"displayName":"AP Essentials Online Reports","solutionId":"WA200004805","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Easily generate Excel reports of your AP Essentials documents.","iconUrl":"46463.4f2ef016-20cb-4469-89c8-91b3ed852e94.bc9b4ced-e86a-461d-bf3e-ea85bc5923db.3fc71624-1087-40f3-bdbf-d437b17759cb.png","licenseUrl":"https://www.kofax.com/legal/terms-of-service","privacyUrl":"https://www.kofax.com/Legal/Privacy","addinInfo":{"priority":-1,"AUP":225}},{"displayName":"Velixo","solutionId":"WA200002311","version":"1.2023.8.64","targetType":1,"width":0,"height":0,"description":"Excel-based reporting for your ERP. Build your own reports in less than 5 minutes!","iconUrl":"56800.9a67df19-bebd-46e1-932f-c05f1da5d162.aded0159-fc94-4c0e-922c-a61decdb9403.0ad5536a-3258-403d-8f0a-adb854889d11.png","licenseUrl":"https://www.velixo.com/eula","privacyUrl":"https://www.velixo.com/privacy-policy","addinInfo":{"priority":2,"AUP":880}},{"displayName":"Mail Merge","solutionId":"WA200006466","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Send personalized emails with Excel, create email drafts or schedule emails for sending later.","iconUrl":"6987.7e407018-9102-4508-a2e9-e769a41b7735.b8d24346-5fb6-49bf-b22b-7baa15ddcad8.847e5579-8358-4333-a405-47191f54a8c1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://digitalinspiration.com/privacy","addinInfo":{"priority":2,"AUP":18}},{"displayName":"NielsenIQ Discover","solutionId":"WA200004632","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"The new NielsenIQ Discover add-In makes generating robust Excel reports faster and easier than ever.","iconUrl":"31362.41c487ba-25d8-4918-a85c-916c87cf1a6d.f8335a3c-da4c-4faa-85ef-58d1bd876169.9204b71b-9802-4510-b8d0-81455582dd72.png","licenseUrl":"https://nielseniq.com/global/en/legal/terms-of-use","privacyUrl":"https://nielseniq.com/global/en/legal/privacy-policy","addinInfo":{"priority":-1,"AUP":180}}]'}static get S8j(){return'[{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541}}]'}get T8j(){return r.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinDetailsForTestEnabled",
!1)}get wbf(){return"Dev Box"===r.AFrameworkApplication.ea.Ya("StatusBarEnvironmentNameToUse")}get Bkk(){return r.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}pni(ca){window.setTimeout(()=>{this.iui()},ca)}iui(){this.c8c?e.ULS.sendTraceTag(508826715,220,50,"The 1st attempt succeeded."):(e.ULS.sendTraceTag(508826716,220,15,"the 1st attempt was timeout, trigger another try."),this.xG(0,!0))}static d3a(ca){return 0===ca||10===
ca}svb(ca,sb){this.OVa&&this.OVa.svb(ca,sb)}xG(ca,sb){this.OVa&&(!this.c8c&&Ge.d3a(ca)&&(this.c8c=!0),this.OVa.xG(ca,sb))}IUc(ca){this.OVa&&this.OVa.cBa(ca)}xKh(ca,sb){return ba.a.tm().equals(ca.solutionId,sb.solutionId)&&ba.a.tm().equals(ca.storeType,sb.storeType)}oge(ca,sb){if(r.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.Zzg(ca,sb,OSF.StoreTypeEnum.MarketPlace);else{const Ba={};Ba.callbackFunc=ca;Ba.storeType=OSF.StoreTypeEnum.MarketPlace;
Ba.fromInsertDialog=!1;Ba.refresh=sb;this.Er.queryEntitlementDetails(Ba)}}Zzg(ca,sb,Ba){const V={};V.callbackFunc=ca;V.storeType=Ba;V.fromInsertDialog=!1;V.refresh=sb;this.Er.queryEntitlementDetails(V)}invokeDdaMethod(ca,sb){const Ba=this.ks(ca.DdaMethod.ControlId);if(Ba){if(this.TK&&this.e_){const V=this.yxa(ca.DdaMethod.ControlId);ca.DdaMethod.ControlId=V}Ba.invokeDdaMethod(ca,sb)}else this.qo(ac.a.internalError,sb)}registerDdaEventAsync(ca,sb,Ba,V,Fa){(sb=this.ks(sb))?Ge.dXb(ca)?sb.qjk(ca,Ba,V,
Fa):this.qo(ac.a.rce,Fa):this.qo(ac.a.internalError,Fa)}unregisterDdaEventAsync(ca,sb,Ba,V,Fa){(sb=this.ks(sb))?Ge.dXb(ca)?sb.y7k(ca,Ba,V,Fa):this.qo(ac.a.rce,Fa):this.qo(ac.a.internalError,Fa)}dispose(){if(!this.disposed){this.$.$r(this.Dj);this.fa.ynk(this.jPc);this.fa.Lq(this.hj);this.fa.pQ(this.$t);this.fa.SB(this.Wl);this.nrd.detach(this);this.$.userOperationManager.vu(this.m2);const ca=la.f(this.$);null===ca||void 0===ca?void 0:ca.za.Vz(this.onBlockCacheItemChanged);this.ORc=this.Il=this.eo=
this.nrd=this.th=null;this.eZa&&(this.eZa.dispose(),this.eZa=null);Fc.a.gh(this.hne);Fc.a.gh(this.gne);this.Vib&&(this.Vib.dispose(),this.Vib=null);super.dispose();this.disposed=!0;e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed")}}VLd(ca){return(ca=this.ks(ca))?ca.getDefaultIconUrl():null}gZc(ca){if(this.iof!==ca){this.iof=ca;for(let sb=0,Ba=this.Il.length;sb<Ba;sb++){const V=this.Il[sb];ca?V.Rqf(!1):V.Qli()}this.hne.gZc(ca);this.gne.gZc(ca)}}GKi(ca){return(ca=this.ks(ca))?ca.getDefaultDisplayName():
null}qo(ca,sb,Ba){const V={};V[Wa.a.hl]=ca;V[Wa.a.Wfa]=sb;this.kV(451041795,V,void 0===Ba?!0:Ba)}FE(ca){const sb={};sb[Wa.a.Wfa]=ca;this.kV(1237877382,sb)}kV(ca,sb,Ba){Ba=void 0===Ba?!0:Ba;const V=new Wb.a(ca,0,this.$.ji,0,null),Fa=sb?sb[Wa.a.Wfa]:null;this.Vib&&la.f(this.$).isEditing&&Gb.P_h(ca,sb)?this.Vib.Zdi(ca,sb):(ca=this.$.Ia.qh(V,sb),Ba&&wc.TaskExtensions.$e(ca,sc=>{Cf.a(sc)?this.qo(ac.a.internalError,Fa,!1):sc.result||(la.f(this.$).isEditing?this.qo(ac.a.$Vb,Fa,!1):this.qo(ac.a.internalError,
Fa,!1))},this.ya,8))}u2h(ca){return!!this.Mwa(sb=>Ge.getSolutionId(sb.mo,this.$)===Ge.getSolutionId(ca,this.$)&&sb.mo.PrimaryMarketplace.MarketplaceType===ca.PrimaryMarketplace.MarketplaceType&&sb.mo.PrimaryMarketplace.MarketplaceRef===ca.PrimaryMarketplace.MarketplaceRef&&sb.mo.PrimaryMarketplace.SolutionVersion===ca.PrimaryMarketplace.SolutionVersion)}ks(ca){return this.Mwa(sb=>sb.controlId.startsWith(ca))}LZa(ca){let sb=ca;this.e_&&(sb=this.p6(ca));return this.ks(sb)}Mxi(ca){return this.Mwa(sb=>
sb.jIa===ca)}SAf(ca){return this.Mwa(sb=>sb.UX===ca&&!!sb.jIa)}eBf(ca,sb,Ba,V){return this.Mwa(Fa=>Fa.UX===ca&&Fa.mo.PrimaryMarketplace.MarketplaceRef.toLowerCase()===sb.toLowerCase()&&Fa.mo.PrimaryMarketplace.MarketplaceType.toLowerCase()===Ba.toLowerCase()&&!!Fa.mo.SharedRuntime&&!!Fa.mo.SharedRuntime.Resid&&!!V&&!!V.Resid&&Fa.mo.SharedRuntime.Resid.toLowerCase()===V.Resid.toLowerCase())}jLh(ca,sb){if(ca=this.ks(ca))ca.Ga(sb),ca.showHide(!0)}xRk(ca){(ca=this.ks(ca))&&ca.showHide(!1)}gYa(ca){var sb;
if(1!==ca.WebExtensionType||this.$.Kj&8388608&&ca.TaskpaneVisible||this.$.Kj&8388608&&!ca.TaskpaneVisible&&$c.HelperMethods.cG(ca)){let Ba=null;$c.HelperMethods.cG(ca)&&(Ba=Ge.PJa(ca,this.$),ca.TaskpaneWidth||(ca.TaskpaneWidth=this.vOb));const V=(new Hd(this,this.eo,ca,this.webExtensionView)).lUd();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.PrimaryMarketplace.SolutionId,ca.OwnerAddinStoreType||ca.PrimaryMarketplace.MarketplaceType,
null===(sb=ca.AssetMarketplace)||void 0===sb?void 0:sb.SolutionId,null,null,ca.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${ca.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${$c.HelperMethods.cG(ca)}`);Ba&&(V.jIa=Ba);this.Il.push(V);this.pMa=null;this.$nb(ca.InstanceId)||(ca=String.format("{0}|{1}|{2}|{3}|{4}",ca.PrimaryMarketplace.SolutionId,ca.PrimaryMarketplace.SolutionVersion,ca.PrimaryMarketplace.MarketplaceRef,ca.PrimaryMarketplace.MarketplaceType,ca.WebExtensionType),this.raiseEvent("ci",
ca))}}ATk(ca,sb){ca.TaskpaneWidth=this.vOb;ca.TaskpaneVisible=!0;const Ba={};Ba.SolutionId=ca.PrimaryMarketplace.SolutionId;Ba.TargetType=ca.WebExtensionType;Ba.Version=ca.PrimaryMarketplace.SolutionVersion;Ba.StoreType=ca.PrimaryMarketplace.MarketplaceType;Ba.StoreId=ca.PrimaryMarketplace.MarketplaceRef;ca.AssetMarketplace?(Ba.AssetId=ca.AssetMarketplace.SolutionId,Ba.AssetStoreId=ca.AssetMarketplace.MarketplaceRef):(Ba.AssetId=null,Ba.AssetStoreId=null);Ba.Width=ca.TaskpaneWidth;const V=new Hd(this,
this.eo,ca,this.webExtensionView,!0);V.lUd();this.Il.push(V);const Fa=()=>{this.g7a(V.controlId);this.Fl.purgeOsfControl(V.controlId,!1);sb()};let sc=null;sc=nf.a.instance.$O(()=>{V.sG&&(Fc.a.gh(sc),sc=null,this.Fl.insertBlankControlWithErrorUX(this.l4b(V,Ba),Fa))},100,of.a.Hci)}Xzd(ca){if(ca&&ca.length){var sb=[];ca.forEach(Ba=>{if(Ba.ContainsCustomFunctions){const V=Ge.PJa(Ba,this.$);this.xde.contains(V)||(this.xde.add(V),this.awg.push(Ba));this.u2h(Ba)||sb.push(Ba)}});sb.length&&this.glf(sb)}}rnf(ca,
sb){this.ks(ca.InstanceId)||(sb=sb(),ca=(new Hd(this,this.eo,ca,this.webExtensionView)).KVf(sb),this.Il.push(ca),this.pMa=null)}NQk(ca){Ge.Rib.mh(ca)&&Ge.Rib.ma(ca).initializeAndShowWithTitle()}V8i(ca){Ge.Rib.mh(ca)&&Ge.Rib.ma(ca).hide()}aTi(ca){var sb=null;let Ba=null;const V=Ge.sQd(ca,!0);if(!V)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),ee.Task.Ua(null);const Fa=this.Er.getOsfControl(Ge.getSolutionId(V,this.$));Fa&&(sb=
Fa.getManifest())&&(Ba=sb.getSharedRuntimeForCustomFunctions("Workbook"));if(sb=Ba&&1===Ba.LifeTime?this.eBf(V.PrimaryMarketplace.SolutionId,V.PrimaryMarketplace.MarketplaceRef,V.PrimaryMarketplace.MarketplaceType,Ba):this.Mxi(ca))return ee.Task.Ua(sb.controlId);const sc=new Nb.a;$c.HelperMethods.QKc(Ba)&&(V.SharedRuntime=Ba);ca=Fa?Fa.getNotificationParams():[];if(!ca.length)return this.Nlf(V);this.mVg(ca,()=>{wc.TaskExtensions.$e(sc.task,()=>{this.Nlf(V)},this.ya,3)},()=>{});return sc.task}ZEi(ca){ca=
Ge.sQd(ca,!1);if(!ca)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let sb=null;var Ba=this.Er.getOsfControl(Ge.getSolutionId(ca,this.$));Ba&&(Ba=Ba.getManifest())&&(sb=Ba.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return $c.HelperMethods.QKc(sb)&&(ca=this.eBf(ca.PrimaryMarketplace.SolutionId,ca.PrimaryMarketplace.MarketplaceRef,ca.PrimaryMarketplace.MarketplaceType,sb))?ca.controlId:null}$4h(ca,sb){var Ba=Ge.sQd(ca,!1);if(Ba){var V=
null,Fa=this.Er.getOsfControl(Ge.getSolutionId(Ba,this.$));Fa&&(Fa=Fa.getManifest())&&(V=Fa.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if($c.HelperMethods.QKc(V)){Ba.SharedRuntime=V;var sc=Ba.PrimaryMarketplace.SolutionId;Fa=Ba.PrimaryMarketplace.SolutionVersion;var Kc=OSF.OsfManifestManager.getCachedManifest(sc,Fa);if(Kc)if(this.aoc.mh(ca))V=this.aoc.ma(ca),wc.TaskExtensions.$e(V,vc=>{(vc=vc.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(vc,sb,this.eo.W7b)},
this.ya,3);else{var qd={};qd.solutionId=sc;qd.version=Fa;qd.storeType=Ba.PrimaryMarketplace.MarketplaceType;qd.storeId=Ba.PrimaryMarketplace.MarketplaceRef;Ba.AssetMarketplace?(qd.assetId=Ba.AssetMarketplace.SolutionId,qd.assetStoreId=Ba.AssetMarketplace.MarketplaceRef):(qd.assetId=null,qd.assetStoreId=null);qd.targetType=OSF.OsfControlTarget.TaskPane;var Eb=new Nb.a;Ba=wc.TaskExtensions.Yq();Ba=new rc.a(this.$,this,qd,Ba);V=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(sc,V.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Kc,
V,Fa);Ba.createUILessSandbox(qd,Kc,(vc,Kd)=>{vc&&!Kd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(vc,sb,this.eo.W7b),Eb.setResult(vc)):Eb.setResult(null);this.aoc.remove(ca)});this.aoc.ga(ca,Eb.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}Nff(ca){(ca=this.SAf(ca))&&(ca.mo.SharedRuntime||this.I5b(ca.controlId))}I5b(ca){(ca=this.SAf(ca))&&this.g7a(ca.controlId)}iii(ca,sb){if(!this.Il||!ca||!sb)return!1;
if(ca.toLowerCase()===sb.toLowerCase())return!0;let Ba=null,V=null;for(let Fa=0,sc=this.Il.length;Fa<sc;Fa++){const Kc=this.Il[Fa];if(Kc.ownerAddinSolutionId&&(Kc.controlId===ca&&(Ba=Kc.ownerAddinSolutionId.toLowerCase()),Kc.controlId===sb&&(V=Kc.ownerAddinSolutionId.toLowerCase()),Ba&&V))break}return Ba&&Ba===V?!0:!1}iAh(ca){this.ks(ca.InstanceId)||(ca=new Hd(this,this.eo,ca,this.webExtensionView),this.Il.push(ca),this.pMa=null)}xFg(ca){if(this.Il&&0<=ca&&ca<this.Il.length){const sb=this.Il[ca],
Ba=sb.sG;this.Il.splice(ca,1);this.mkg(sb);ad.DOMElementExtensions.jn(Ba)}}g7a(ca){if(this.Il)for(let sb=0,Ba=this.Il.length;sb<Ba;sb++)if(this.Il[sb].controlId===ca){this.xFg(sb);break}}Nmk(ca){if(this.Il){ca=ca.toLowerCase();for(let sb=0,Ba=this.Il.length;sb<Ba;sb++)if(ca===this.Il[sb].ownerAddinSolutionId.toLowerCase()){this.xFg(sb);break}}}RLh(ca){ca.Zv&&(this.ks(ca.floatingObject.mo.InstanceId)||(this.RGc(ca.floatingObject.mo.InstanceId)||this.ORc.push(ca.floatingObject.mo.InstanceId),this.gYa(ca.floatingObject.mo)),
this.fa.isNamedObjectViewMode&&this.jLh(ca.floatingObject.mo.InstanceId,ca.Pj))}eId(ca){return null==this.Il?null:this.Il.find(sb=>1===sb.controlType&&$f.a.equals(sb.UX,ca,!0))}a6(ca){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return ca=this.eId(ca),null===ca||void 0===ca?void 0:ca.controlId;if(this.Il)for(let sb=0,Ba=this.Il.length;sb<Ba;sb++)if(1===this.Il[sb].controlType&&$f.a.equals(this.Il[sb].UX,ca,!0))return this.Il[sb].controlId;return null}ytj(ca){return(ca=
this.eId(ca))?ca.visible:!1}oxi(ca){const sb=[];if(this.Il)for(let Ba=0,V=this.Il.length;Ba<V;Ba++)$f.a.equals(this.Il[Ba].UX,ca,!0)&&sb.push(this.Il[Ba].controlId);return sb}Txi(ca,sb){if(!sb||!ca)return null;if(this.Il)for(let Ba=0,V=this.Il.length;Ba<V;Ba++)if(1===this.Il[Ba].controlType&&$f.a.equals(this.Il[Ba].UX,ca,!0)&&this.Il[Ba].mo.SharedRuntime&&$f.a.equals(this.Il[Ba].mo.SharedRuntime.Resid,sb.Resid,!0))return this.Il[Ba].controlId;return null}LJa(ca,sb){sb=void 0===sb?null:sb;return ca?
sb?`${ca}.${sb}`:ca:""}Qff(ca,sb,Ba){if(this.pMa===ca)return!0;this.pMa=ca;let V=null,Fa=!1;if(!V&&this.Il)for(let sc=0,Kc=this.Il.length;sc<Kc;sc++)if(1===this.Il[sc].controlType&&$f.a.equals(this.Il[sc].UX,ca,!0)){let qd=!1,Eb=!1;sb?(qd=!0,Eb=!!this.Il[sc].mo.SharedRuntime&&$f.a.equals(this.Il[sc].mo.SharedRuntime.Resid,sb.Resid,!0)):Ba&&(qd=!0,Eb=$f.a.equals(this.Il[sc].mo.SharedRuntimeId,Ba,!0));if(!qd||Eb){Eb&&this.Il[sc].iF(!0);V=this.Il[sc].controlId;Fa=!0;this.pMa=null;break}}V&&this.raiseEvent("ca",
V);return Fa}setAppRuntimeState(ca,sb){var Ba;if(ca){let V;if((V=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?this.LZa(ca):this.ks(ca))&&$c.HelperMethods.cG(V.mo))V.iF(sb),sb&&(this.raiseEvent("ca",ca),(null===(Ba=V.sG)||void 0===Ba?0:Ba.firstChild)&&(ca=V.sG.firstChild.title)&&0<ca.length&&this.$fb.dCk(ca));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(jf.a.instance.ia(2250));}else throw e.ULS.sendTraceTag(537170564,
0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(jf.a.instance.ia(2251));}getAppRuntimeState(ca){if(ca)if((ca=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?this.LZa(ca):this.ks(ca))&&$c.HelperMethods.cG(ca.mo))ca=ca.mo.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(jf.a.instance.ia(2250));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(jf.a.instance.ia(2251));return ca}Jkb(ca,sb){return(ca=this.ks(ca))?ca.Jkb(sb):null}$nb(ca){return this.Sff(this.ORc,ca)}RGc(ca){return this.Sff(this.cof,ca)}A3e(ca){this.cof.push(ca)}gY(ca){return(ca=this.ks(ca))?ca.mo:null}Q8d(ca){this.raiseEvent("ekros",ca,this)}itg(ca){if(ca){var sb=this.ks(ca.InstanceId);sb&&(ca.SharedRuntime||ca.SharedRuntimeId||(this.g7a(sb.controlId),this.Fl.purgeOsfControl(sb.controlId,!1)),sb={},sb.SolutionId=ca.PrimaryMarketplace.SolutionId,sb.TargetType=
ca.WebExtensionType,sb.Version=ca.PrimaryMarketplace.SolutionVersion,sb.StoreType=ca.PrimaryMarketplace.MarketplaceType,sb.StoreId=ca.PrimaryMarketplace.MarketplaceRef,ca.AssetMarketplace?(sb.AssetId=ca.AssetMarketplace.SolutionId,sb.AssetStoreId=ca.AssetMarketplace.MarketplaceRef):(sb.AssetId=null,sb.AssetStoreId=null),sb.Width=ca.TaskpaneWidth,sb.SharedRuntimeId=ca.SharedRuntimeId,this.l3g(sb))}}swa(){this.eo.swa()}TM(ca,sb,Ba){this.eo.TM(ca,sb,Ba)}mBf(ca,sb){sb=Ge.x$h(sb);ca=this.gY(ca);this.eo.rzc(ca.InstanceId,
2202,Zb.a.kW,sb)}lId(ca){for(let sb=0,Ba=this.Il.length;sb<Ba;sb++)this.mBf(this.Il[sb].controlId,ca)}eyi(ca,sb){sb=Ge.G5h(sb);this.eo.rzc(ca,65539,"",sb)}hyi(ca,sb,Ba){this.eo.rzc(ca,1,sb,Ba)}dyi(ca,sb){this.eo.iyi(ca,sb)}W4h(ca,sb){return[[2,1E3,"",JSON.stringify([ca,sb]),0,!1]]}uYf(){return!!this.vBa&&this.vBa.ERf()}kYh(){this.vBa&&this.vBa.clear()}jBf(){if(this.vBa&&this.vBa.ERf()){var ca=this.vBa.bFi();for(const sb of ca){ca=this.oxi(sb);for(const Ba of ca)this.eo.rzc(Ba,65540,"","{}")}}}ijk(ca){this.vBa.add(ca)}v7k(ca){this.vBa.remove(ca)}Mwa(ca){if(!this.Il)return null;
for(const sb of this.Il)if(ca(sb))return sb;return null}Nlf(ca){const sb=new Nb.a,Ba=Ge.PJa(ca,this.$);if($c.HelperMethods.cG(ca))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.Yvg(ca,V=>{V?(ca.InstanceId=V.InstanceId,ca.WebExtensionOsfControlType=3,ca.TaskpaneVisible=!1,this.gYa(ca),sb.setResult(ca.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.PrimaryMarketplace.SolutionId,
ca.PrimaryMarketplace.MarketplaceType,null,null,null,ca.PrimaryMarketplace.MarketplaceRef)} failed`),sb.setException(Error.create("Null insert data")))});else{Ge.Rib.ga(ca.InstanceId,new Y.a);const V=Ge.Rib.ma(ca.InstanceId).Yma;this.I6h(ca,V,Ba);this.Yvg(ca,null);sb.setResult(ca.InstanceId)}return sb.task}I6h(ca,sb,Ba){this.ks(ca.InstanceId)||(ca=new Hd(this,this.eo,ca,this.webExtensionView),ca.jIa=Ba,ca.KVf(sb),this.Il.push(ca),this.pMa=null)}Yvg(ca,sb){const Ba=Ge.PJa(ca,this.$);if(!this.xde.contains(Ba))this.J3b.push(ca),
1<=this.J3b.length&&this.Zvg(ca,sb);else if(sb)for(const V of this.awg)if(Ge.PJa(V,this.$)===Ba){sb(V,0);break}}Zvg(ca,sb){let Ba=null;const V={};V.SolutionId=Ge.getSolutionId(ca,this.$);V.TargetType=ca.WebExtensionType;V.Version=ca.PrimaryMarketplace.SolutionVersion;V.StoreType=ca.PrimaryMarketplace.MarketplaceType;V.StoreId=ca.PrimaryMarketplace.MarketplaceRef;ca.AssetMarketplace?(V.AssetId=ca.AssetMarketplace.SolutionId,V.AssetStoreId=ca.AssetMarketplace.MarketplaceRef):(V.AssetId=null,V.AssetStoreId=
null);V.Width=ca.TaskpaneWidth;V.ContainsCustomFunctions=!0;$c.HelperMethods.cG(ca)&&(V.SharedRuntimeId=ca.SharedRuntime.Resid);const Fa=this.$.oa.ta;ca=this.$.oa.ta.Wh();const sc=Fa.Za(9,ca);sc.sharedInfo=V;const Kc=Eb=>{Eb=Ye.a.$j(Eb.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${ng.a.fi(Eb)}`)},qd=Eb=>{Eb&&!Rf.a(Eb)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(V.SolutionId,
V.StoreType,V.AssetId,null,null,V.StoreId)} finish with errors: ${ng.a.fi(Eb.Errors)}`);this.J3b.shift();0<this.J3b.length&&this.Zvg(this.J3b[0],sb)};if(sb){const Eb=vc=>{const Kd=vc.Result;(Ba=Kd?Kd.AgaveData:null)||sb(null,vc.Errors?vc.Errors[0].ErrorCause:5001);sb(Ba,0)};ca=(vc,Kd,Zd)=>Ee.h(Fa,"InsertAgaveTaskpane",sc,Hf.c(vc,qd,Eb),Hf.b(Kd,Kc),Zd,null,0)}else ca=(Eb,vc,Kd)=>Ee.h(Fa,"InsertAgaveTaskpane",sc,Hf.c(Eb,qd),Hf.b(vc,Kc),Kd,null,0);pc.a(this.$.userOperationManager,ca,Eb=>new uc.a(519,
0,Eb,64),null)}hNk(){return this.$.kk.get(35)}Tmk(ca){ca=this.ks(ca);(null===ca||void 0===ca?0:ca.Iqa)&&ca.HFg()}O8d(ca){var sb=this.Mwa(Ba=>Ge.L1a(Ba.UX));sb&&(sb=this.Fl.getOsfControl(sb.controlId))&&sb.notifyAgave(OSF.AgaveHostAction.SendMessage,ca)}RYf(){return!!this.Mwa(ca=>1===ca.controlType&&Ge.L1a(ca.UX))}QYf(){const ca=this.Mwa(sb=>Ge.L1a(sb.UX));return ca?ca.sG?ad.DOMElementExtensions.isVisible(ca.sG):!1:!1}pQg(){const ca=this.Mwa(sb=>Ge.L1a(sb.UX));ca&&(ca.iF(!0),this.raiseEvent("ca",ca.controlId))}initialize(ca){var {DdaEventDispatch:sb}=
a(1571);const Ba=void 0===this.$||null===this.$||ib.EwaSettings.Na(234);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Ba&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(re.Wg.Ma()||Ad.WebExtensionView.kKb(this.$),this.fa=this.$.fa,this.eo=new sb(this.$,this),this.$.nr(this.Dj),this.fa.d5e(this.jPc),this.fa.Nq(this.hj),this.fa.BO(this.$t),this.fa.vz(this.Wl),
this.$.userOperationManager.qw(this.m2),sb=la.f(this.$),null===sb||void 0===sb?void 0:sb.za.sz(this.onBlockCacheItemChanged),this.E8f(),this.JXj(),this.cdj(),re.Wg.Ma(),re.yb.Ma()||this.$.qa.Rh(35,this),this.nrd.Ga(this),Ba&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.bYe=new Zb.a,Ba&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.eYe=new Qa(this.$,this.Zn,this.eo),new tb(this.$,this.Zn,this.eo),this.cYe=
new he(this.$,this.Zn,this.eo),this.aYe=new Se(this.$,this.Zn,this.eo),this.$Xe=new Kb(this.$,this.Zn,this.eo),this.dYe=new Ta(this.$,this.Zn,this.eo),this.fYe=new zc(this.$,this.Zn,this.eo),this.gYe=new dd(this.$,this.Zn,this.eo),this.$.a7&&(this.hYe=new gc(this.$,this.Zn,this.eo,this)),this.iYe=new kd(this.$,this.Zn,this.eo,ca),this.Vib=new Gb(this,la.f(this.$)),ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.ZXe=new wb),this.YXe=new Ed(this.$,
this.Zn,this.eo),this.initialized=!0,e.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}Yxi(ca){if(!this.sDa)return null;for(let sb=0,Ba=this.sDa.length;sb<Ba;sb++)if(ca.startsWith(this.sDa[sb].WebExtensionId))return this.sDa[sb];return null}E8f(){var ca,sb=this.fa;if(sb.ki&&!this.Ucc){if(sb.workbookContext){if(this.pnd=this.$.fa.Dn.get(22),null===(ca=sb.workbookContext.WebExtensions)||void 0===ca?0:ca.length){ca=sb.workbookContext.WebExtensions;sb=!1;if(r.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TelemetryForAddinsWithinFileEnabled",
!1)&&0<ca.length){var Ba=[];for(var V=ca.length-1;0<=V;V--)Ba.push(Telemetry.PrivacyRules.GetPrivacyCompliantId(ca[V].PrimaryMarketplace.SolutionId,ca[V].PrimaryMarketplace.MarketplaceType,null,null,null,ca[V].PrimaryMarketplace.MarketplaceRef));mc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinsWithinFile",dataFields:jc.a.xn({["solutionIds"]:Ba})})}for(Ba=ca.length-1;0<=Ba;Ba--){if(!this.fa.isNamedObjectViewMode){this.ORc.push(ca[Ba].InstanceId);if(1!==ca[Ba].WebExtensionType){ca.splice(Ba,
1);continue}if($c.HelperMethods.cG(ca[Ba])&&0!==ca[Ba].SharedRuntime.State)1===ca[Ba].SharedRuntime.State?ca[Ba].TaskpaneVisible=!1:2===ca[Ba].SharedRuntime.State?ca[Ba].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!ca[Ba].ContainsCustomFunctions&&!ca[Ba].TaskpaneVisible&&!Ya.a(ca[Ba])){ca.splice(Ba,1);continue}}V=OSF.OsfControl.isFirstPartyStoreString(ca[Ba].PrimaryMarketplace.MarketplaceType);if(ib.EwaSettings.Na(174)&&!V&&(ca.splice(Ba,1),!sb)){sb=
!0;const Fa=Object(jd.d)(Td.a.resolve(re.E,{va:3}));wc.TaskExtensions.$e(Fa,()=>{Fa.result.Rm(36,null)},this.ya,3)}ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&ca[Ba].PrimaryMarketplace&&Ge.L1a(ca[Ba].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),ca.splice(Ba,1))}this.glf(ca)}}else this.pnd=!1;this.Ucc=!0}}SPf(ca){const sb=la.f(this.$),Ba=sb.ha.$a.Ih;if(Ba&&ca){ca=
!1;if(this.Il)for(const V of this.Il)if(Ge.L1a(V.UX)||Ge.Knj(V.UX)||Ge.rpj(V.UX)){ca=!0;break}ca||sb.ha.$a.iP(Ba)}}JXj(){this.Fl&&this.fa.isNamedObjectViewMode&&this.$.la&&oe.n(this.$.la)&&(re.Wg.Ma()?this.webExtensionView.EY?this.webExtensionView.JVb():this.webExtensionView.gA(this.Ktg):yb.a(this.$).EY?yb.a(this.$).JVb():yb.a(this.$).gA(this.Ktg))}glf(ca){let sb=null;sb=Ba=>{const V=Ba.WebExtensionData,Fa=Ba.IsTaskPane,sc=Ba.RecordHandler,Kc=()=>{this.S5a.shift();0<this.S5a.length&&sb(this.S5a[0])};
if(this.a6(V.PrimaryMarketplace.SolutionId))Kc();else{Fa&&(V.WebExtensionOsfControlType=1);var qd=Ya.a(V);if(!Fa||V.TaskpaneVisible||qd||V.SharedRuntime&&0!==V.SharedRuntime.State||V.ContainsCustomFunctions){var Eb=new Hd(this,this.eo,V,this.webExtensionView,!Fa);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(V.PrimaryMarketplace.SolutionId,V.PrimaryMarketplace.MarketplaceType,null,null,null,V.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${V.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${$c.HelperMethods.cG(V)}`);
Eb.lUd();$c.HelperMethods.cG(V)&&(Eb.jIa=Ge.PJa(V,this.$),V.TaskpaneWidth=this.vOb);qd&&(V.WebExtensionToolTip="");!ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&Fa&&V.TaskpaneVisible&&!qd&&(V.TaskpaneWidth=this.vOb);this.Il.push(Eb);var vc=this.pMa=null;vc=nf.a.instance.$O(()=>{Eb.sG&&(Fc.a.gh(vc),vc=null,sc&&sc(Ba,Eb),Kc())},100,of.a.Gci)}else Kc()}};for(let Ba=0;Ba<ca.length;Ba++){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const V=
ca[Ba].WebExtensionType===OSF.OsfControlTarget.TaskPane,Fa=Ya.a(ca[Ba]);V&&!Fa&&(ca[Ba].TaskpaneWidth=this.vOb)}if(!this.ks(ca[Ba].InstanceId))if(1!==ca[Ba].WebExtensionType)this.gYa(ca[Ba]);else if(!ib.EwaSettings.Na(52))this.aIb(ca[Ba],sb);else if(this.$.Kj&8388608||ca[Ba].TaskpaneVisible){const V={};V.solutionId=ca[Ba].PrimaryMarketplace.SolutionId;V.version=ca[Ba].PrimaryMarketplace.SolutionVersion;V.storeType=ca[Ba].PrimaryMarketplace.MarketplaceType;V.storeId=ca[Ba].PrimaryMarketplace.MarketplaceRef;
V.targetData=ca[Ba];this.Fl.isAddinCommandsAsync(V,(Fa,sc,Kc)=>{if(Fa){var qd=Kc.targetData;if(sc)if(V.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Fa=V.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),sc=V.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Fa||sc)&&$c.HelperMethods.cG(qd)&&this.aIb(qd,sb);else if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.d5i(Kc,sb);else{let Eb=
!1;this.oge(vc=>{if(!vc.errorCode){if(vc.value)for(const Kd of vc.value){if(Eb)break;Eb=Ka.e(Kd[1])===Ka.e(qd.PrimaryMarketplace.SolutionId)}Eb?$c.HelperMethods.cG(qd)&&this.aIb(qd,sb):(vc={},vc.SolutionId=Kc.solutionId,vc.Version=Kc.version,vc.StoreType=qd.PrimaryMarketplace.MarketplaceType,vc.StoreId=Kc.storeId,vc.AssetId=null,vc.AssetStoreId=null,vc.Width=qd.TaskpaneWidth,vc.TargetType=qd.WebExtensionType,qd.TaskpaneVisible=!0,this.k2e(vc,qd,sb))}},!0)}else this.aIb(qd,sb)}else Fa=Kc.targetData,
e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Fa.PrimaryMarketplace.SolutionId,Fa.PrimaryMarketplace.MarketplaceType,null,null,null,Fa.PrimaryMarketplace.MarketplaceRef)} from ${Fa.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}d5i(ca,sb){let Ba=!1;this.oge(V=>{const Fa=ca.targetData;if(!V.errorCode){if(V.value)for(const sc of V.value){if(Ba)break;Ba=Ka.e(sc[1])===Ka.e(Fa.PrimaryMarketplace.SolutionId)}Ba?$c.HelperMethods.cG(Fa)&&
this.aIb(Fa,sb):(V={},V.SolutionId=ca.solutionId,V.Version=ca.version,V.StoreType=Fa.PrimaryMarketplace.MarketplaceType,V.StoreId=ca.storeId,V.AssetId=null,V.AssetStoreId=null,V.TargetType=Fa.WebExtensionType,V.Width=Fa.TaskpaneWidth,Fa.TaskpaneVisible=!0,this.k2e(V,Fa,sb))}},!0)}aIb(ca,sb){const Ba={};Ba.WebExtensionData=ca;Ba.IsTaskPane=!0;this.S5a.push(Ba);1===this.S5a.length&&sb(Ba)}k2e(ca,sb,Ba){const V={};V.ActivationInfo=ca;V.WebExtensionData=sb;V.IsTaskPane=!1;V.RecordHandler=(Fa,sc)=>{const Kc=
Fa.ActivationInfo;this.Fl.insertBlankControlWithErrorUX(this.l4b(sc,Kc),()=>{this.g7a(sc.controlId);this.Fl.purgeOsfControl(sc.controlId,!1);this.l3g(Kc)})};this.S5a.push(V);1===this.S5a.length&&Ba(V)}l3g(ca){var sb={};sb.solutionId=ca.SolutionId;sb.version=ca.Version;sb.storeType=ca.StoreType;sb.storeId=ca.StoreId;sb.assetId=ca.AssetId;sb.assetStoreId=ca.AssetStoreId;sb.targetType=ca.TargetType;sb.sharedRuntimeId=ca.SharedRuntimeId;ca=new K.a;ca.add(sb);sb={};sb[fa.a.mJb]=ca;sb[fa.a.D4]=3;ca=new Wb.a(tc.a.Nqb,
0,this.$.ji,0,null);this.$.Ia.qh(ca,sb)}l4b(ca,sb){const Ba={};Ba.div=ca.sG;Ba.id=ca.controlId;Ba.solutionId=sb.SolutionId;Ba.version=sb.Version;Ba.storeId=sb.StoreId;Ba.storeType=sb.StoreType;Ba.osfControlType=OSF.OsfControlTarget.TaskPane;return Ba}KEg(){this.Il.forEach(this.mkg);this.Il.length=0;this.Ucc=!1}DFi(ca){const sb=ca.PrimaryMarketplace.MarketplaceType,Ba=Ge.getSolutionId(ca,this.$);return sb===OSF.StoreType.InMemory&&Ba.toLowerCase().startsWith("wa")?{solutionId:Ba,PZg:OSF.StoreType.OMEX}:
{solutionId:ca.PrimaryMarketplace.SolutionId,PZg:sb}}Pga(ca){var sb;const Ba=this.DFi(ca);return Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba.solutionId,Ba.PZg,null===(sb=ca.AssetMarketplace)||void 0===sb?void 0:sb.SolutionId,null,null,ca.PrimaryMarketplace.MarketplaceRef)}cQk(ca){var sb,Ba;const V=ca.mo,Fa={AssetId:null===(sb=V.AssetMarketplace)||void 0===sb?void 0:sb.SolutionId,AssetStoreId:null===(Ba=V.AssetMarketplace)||void 0===Ba?void 0:Ba.MarketplaceRef,EnabledInViewMode:!0,Height:0,IsToBePersisted:!1,
SolutionId:V.PrimaryMarketplace.SolutionId,SourceLocationOverrideResourceId:V.SrcLocationOverrideResourceId,StoreId:V.PrimaryMarketplace.MarketplaceRef,StoreType:V.PrimaryMarketplace.MarketplaceType,TargetType:V.WebExtensionType,Version:V.PrimaryMarketplace.SolutionVersion,Width:V.TaskpaneWidth},sc={width:V.TaskpaneWidth,ay:V.TaskpaneIconCssClass,showLoadingSpinner:V.ShowLoadingSpinner,focusOnIframeWhenLoaded:V.FocusOnIframeWhenLoaded};let Kc=Fa.IsToBePersisted?0:16;const qd=this.$.oa.ta.Wh();Kc|=
64;this.kld=!0;pc.a(this.$.userOperationManager,(Eb,vc,Kd)=>{var Zd=this.Pga(V);e.ULS.sendTraceTag(507637774,0,50,`Silent Reload::showAgaveTaskpaneReload:Web Method ShowAgaveTaskpane is called, StoreType ${Fa.StoreType}, StoreId ${Fa.StoreId}, SolutionId ${Zd}.`);Zd=this.$.oa.ta;Eb=Hf.c(Eb,this.nxg);const nb=Zd.Za(9,void 0===qd?null:qd);nb.sharedInfo=Fa;return Ee.h(Zd,"ShowAgaveTaskpane",nb,Eb,vc,Kd,sc,0)},Eb=>new uc.a(538,0,Eb,Kc),null)}yfj(ca){const sb=ca.mo,Ba={AssetId:sb.PrimaryMarketplace.SolutionId,
AssetStoreId:sb.PrimaryMarketplace.MarketplaceRef,OwnerAddinSolutionId:sb.OwnerAddinSolutionId,OwnerAddinStoreType:sb.OwnerAddinStoreType,Preload:sb.Preload,SharedRuntimeId:sb.SharedRuntimeId,SolutionId:sb.PrimaryMarketplace.SolutionId,StoreId:sb.PrimaryMarketplace.MarketplaceRef,StoreType:sb.PrimaryMarketplace.MarketplaceType,TargetType:sb.WebExtensionType,Version:sb.PrimaryMarketplace.SolutionVersion,Width:sb.TaskpaneWidth},V=this.$.oa.ta,Fa=V.Za(9);Fa.sharedInfo=Ba;this.kld=!0;pc.a(this.$.userOperationManager,
(sc,Kc,qd)=>{const Eb=this.Pga(sb);e.ULS.sendTraceTag(507637771,0,50,`Silent Reload::insertAgaveSandboxReload:Web Method InsertAgaveTaskpane is called, StoreType ${Ba.StoreType}, StoreId ${Ba.StoreId}, SolutionId ${Eb}.`);return Ee.h(V,"InsertAgaveTaskpane",Fa,Hf.c(sc,this.nxg),Hf.b(Kc,Kc),qd,null,0)},sc=>new uc.a(500,0,sc,64),null)}tJg(){const ca=[];var sb=this.Il.length;for(var Ba=0;Ba<sb;Ba++){var V=this.Il[Ba];if(this.TK){if(V.U0f&&this.Znj){ca.push(V);continue}const Fa=Ya.a(V.mo),sc=3===V.osfControlType,
Kc=0===V.osfControlType||4===V.osfControlType;Fa||sc?V.mo.PrimaryMarketplace?"FA000000112"===V.mo.PrimaryMarketplace.SolutionId?ca.push(V):Fa?this.cQk(V):this.yfj(V):(e.ULS.sendTraceTag(507642883,0,10,"Silent Reload::ResetOsfControlAfterServerReload: PrimaryMarketplace is null."),ca.push(V)):Kc&&ca.push(V)}else 0!==V.osfControlType&&3!==V.osfControlType&&4!==V.osfControlType||ca.push(V)}sb=!1;for(Ba=0;Ba<ca.length;Ba++)V=ca[Ba],this.g7a(V.controlId),!sb&&V&&V.mo&&(sb=$c.HelperMethods.cG(V.mo));sb&&
this.kV(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4});ib.EwaSettings.Na(355)&&wc.TaskExtensions.$e(Ve.GetServiceTaskFactory.dk(this.$.qa,278,279,3),Fa=>{Fa&&(Fa=Fa.result)&&(this.$.qa.zh(278)||this.$.qa.Rh(278,Fa),Fa.XWf().yBa())},this.ya,3)}lT(){var ca=new Cc(this.$,this.Zn,this.KKg);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):ib.EwaSettings.Na(234)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.Zn||null===this.Zn));if(ca.SKj()){const sb=()=>{},Ba=Fa=>{Fa=Ye.a.$j(Fa.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${ng.a.fi(Fa)}.`)},V=ca.ZQh();ca=Ge.nOd(V);ca|=64;this.$.userOperationManager.kP(new uc.a(507,0,(Fa,sc,Kc)=>Ee.h(this.$.oa.ta,"ExecuteRichApiRequest",this.aRh(V),Hf.c(Fa,sb),Hf.b(sc,Ba),Kc,null,0),ca))}}aRh(ca){const sb=this.$.oa.ta.Za(1);sb.request=ca;return sb}Sff(ca,sb){if(ca)for(let Ba=
0;Ba<ca.length;Ba++)if($f.a.equals(ca[Ba],sb,!0))return!0;return!1}$Ph(ca){const sb={};sb.navigationMode=OSF.OsfNavigationMode.DefaultMode;sb.assetId=null;sb.category=null;if(!ca||3>ca.length)return sb;if(ca[0]){const Ba=parseInt(ca[0],10);isNaN(parseInt(Ba,10))||(sb.navigationMode=Ba)}ca[1]&&(sb.assetId=ca[1]);ca[2]&&(sb.category=ca[2]);return sb}cdj(){var ca=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(ca&&"*"!==ca.trim()){this.eZa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new Ic(this),
ca,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.kk.get(2));try{this.eZa.init()}catch(sb){try{this.eZa.dispose()}catch(Ba){}this.eZa=null;e.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+sb.message)}ca={};ca.a=this.$.ua.UserSessionId;If.b().Ol(39,ca)}}mVg(ca,sb,Ba){const V=Ge.lPh(ca[0]),Fa=V.eva,sc=V.dwa;V.eva=()=>{Fa&&Fa();const Kc=V.a1a!==OSF.InfoType.Error?sb:null;ca.shift();ca.length?this.mVg(ca,Kc,Ba):Kc&&Kc()};V.dwa=()=>{sc&&
sc();Ba&&V.a1a!==OSF.InfoType.Error&&Ba()};Ia.a.Pte(V)}OOi(){const ca={};ca.Application=r.AFrameworkApplication.ea.Ya("Application");ca.UICulture=r.AFrameworkApplication.ea.Ya("UICulture");ca.AddinRibbonControlsOverriddenByApi=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();ca.AddinActionDefinitionHybridMode=ib.EwaSettings.Na(556).toString();ca.UseActionIdForUILessCommand=ib.EwaSettings.Na(559).toString();ca.AllowStorageAccessByUserActivationOnIFrame=
ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();ca.RequirementSetRibbonApiOnePointTwo=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();ca.flightingTreatmentVariables=r.AFrameworkApplication.ea.TQb;ca.ShortcutInfoArrayInUserPreferenceData=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();ca.DisabledChangeGates=
r.AFrameworkApplication.ea.Ya("DisabledChangeGates");ca.SdxIsEnabled=r.AFrameworkApplication.ea.ka("SdxIsEnabled");ca.DmsSdxListWorkbook=r.AFrameworkApplication.Orf;ca.AddinDevicePermissionAllowList=r.AFrameworkApplication.ea.Ya("AddinDevicePermissionAllowList");return ca}static get XMb(){return Ge.NKe}static set XMb(ca){Ge.NKe=ca}static getSolutionId(ca){let sb=ca.PrimaryMarketplace.SolutionId;ib.EwaSettings.Na(261)&&ca.OwnerAddinSolutionId&&(sb=ca.OwnerAddinSolutionId);return sb}static nOd(ca){return ca.RequestFlags&
1&&256!==(ca.RequestFlags&256)?0:16}static PJa(ca,sb){sb=Ge.getSolutionId(ca,sb);return Ge.TGf(sb,ca.PrimaryMarketplace.SolutionVersion,ca.PrimaryMarketplace.MarketplaceType,ca.PrimaryMarketplace.MarketplaceRef)}static x$h(ca){return JSON.stringify({["recording"]:ca})}static G5h(ca){const sb={};sb.visibility=ca?"Visible":"Hidden";return JSON.stringify(sb)}static fKi(ca){const sb=ca.getSolutionId(),Ba=ca.getVersion(),V=ca.getStoreType();ca=ca.getStoreId();return Ge.TGf(sb,Ba,V,ca)}static TGf(ca,sb,
Ba,V){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",ca,sb,Ge.QYi(Ba).toString(),V)}static sQd(ca,sb){var Ba=ca.split("|");if(7>Ba.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Ba[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${Ba[0]}'.`),null;let V=Ba[1];const Fa=Ba[2],sc=Ge.RYi(Ba[3]),Kc=Ba[4];Ba=Ba[5];V&&V.length||(V=Ba);Ba=
{};Ba.InstanceId=String.format("{{{0}}}",O.a.create().toString());Ba.WebExtensionOsfControlType=4;Ba.WebExtensionType=1;Ba.PrimaryMarketplace={};Ba.PrimaryMarketplace.SolutionId=V;Ba.PrimaryMarketplace.SolutionVersion=Fa;Ba.PrimaryMarketplace.MarketplaceRef=Kc;Ba.PrimaryMarketplace.MarketplaceType=sc;Ba.ContainsCustomFunctions=sb?!0:!1;sb&&(Ba.OsfPropertyBag=[["customFunctionAddinId",ca]]);return Ba}static RYi(ca){ca=parseInt(ca,10);return ca===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:ca===
OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:ca===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:ca===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:ca===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:ca===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:ca===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:ca===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:ca===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:ca===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:ca===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static QYi(ca){return ca===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:ca===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:ca===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:ca===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:ca===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:ca===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:ca===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
ca===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:ca===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:ca===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:ca===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}UHa(ca){const sb={};sb.Version=ca.version;sb.AssetId=ca.assetId;sb.AssetStoreId=ca.assetStoreId;sb.StoreType=ca.storeType;sb.Height=ca.height;sb.SolutionId=ca.solutionId;sb.StoreId=ca.storeId;sb.TargetType=ca.targetType;sb.Width=
1===sb.TargetType?0:ca.width;sb.SharedRuntimeId=ca.sharedRuntimeId;return sb}static dXb(ca){return ca===OSF.DDA.EventDispId.dispidSettingsChangedEvent||ca===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||ca===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ca===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||ca===OSF.DDA.EventDispId.dispidRichApiMessageEvent||ca===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||ca===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||
ca===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static lPh(ca){return Object(b.a)(new sf.a,{a1a:ca.infoType,id:ca.id,title:ca.title,description:ca.description,buttonText:ca.buttonTxt,eva:ca.buttonCallback,cFc:ca.highPriority,dwa:ca.dismissCallback,errorCode:ca.errorCode,SUf:ca.iframeNotificationUrl})}static L1a(ca){let sb="FA000000014"===ca;sb||(sb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===ca);return sb}static Knj(ca){return"FA000000005"===ca}static rpj(ca){return"FA000000064"===
ca}}Ge.Rib=new J.a;Ge.NKe=!0;Ge.WBe=!0;Object(c.a)(Ge,"DdaFacade",oc.a,[207,253,254,255,256,2])},966:function(y,m,a){a.d(m,"a",function(){return b});y=a(0);var c=a(42);class b{static get HHj(){return b.KTe||(b.KTe={["-2002156328"]:b.Yhf,["-1954750170"]:b.LMf,["317650254"]:b.f_h,["-1005263101"]:b.Agj,["1353664579"]:b.mBk,["159671765"]:b.Bgj,["1446690022"]:b.WGf,["1150069548"]:b.M3c,["-1409306331"]:b.Mef,["338507772"]:b.Gof,["-457159301"]:b.p5j,["-1037701970"]:b.gci,["-1893322318"]:b.Fgj,["965579896"]:b.ici,
["93287890"]:b.hci,["358088857"]:b.WEk,["-1223650923"]:b.Gof,["2007306190"]:b.MVh,["1549955423"]:b.fbf,["-1275974171"]:b.Egj,["382101082"]:b.h4j,["-898776235"]:b.gKj,["335464256"]:b.ZJj,["1677378049"]:b.Dgj,["-261992848"]:b.m7k,["-980820954"]:b.fbf,["-931375837"]:b.g4j,["929186550"]:b.wki,["-982144310"]:b.Kck,["-785741187"]:b.ygj,["2125217573"]:b.Hgj,["299124955"]:b.zgj,["1669853884"]:b.Zwk,["-1515932330"]:b.g_h,["314621024"]:b.yAi,["-300049690"]:b.QVh,["14766835"]:b.xKk,["-1251992761"]:b.isf,["-2087635043"]:b.invalidOrTimedOutSession,
["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.xVa,["49173765"]:b.xVa,["-907155566"]:b.xVa,["-1201603824"]:b.xVa,["1541165282"]:b.xVa,["-1347753427"]:b.xVa,["134912532"]:b.xVa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static rDf(e){return c.a.Vw(b.HHj,e.toString(),b.internalError)}}b.success=0;b.Yhf=
1E3;b.LMf=1001;b.f_h=1002;b.Agj=1003;b.mBk=1004;b.Bgj=1005;b.WGf=1008;b.zAf=1009;b.invalidSheetName=1014;b.M3c=2E3;b.Mef=2001;b.Gof=2002;b.p5j=2003;b.gci=2004;b.Fgj=2005;b.ici=2007;b.hci=2008;b.WEk=2009;b.MVh=2014;b.eBk=3E3;b.fbf=3002;b.Egj=3004;b.h4j=3005;b.gKj=3006;b.ZJj=3007;b.Dgj=3008;b.m7k=3009;b.g4j=3010;b.xKk=4002;b.rce=5E3;b.internalError=5001;b.isf=5002;b.$Vb=5004;b.u8k=5007;b.Maj=5008;b.HIg=5011;b.invalidOrTimedOutSession=5012;b.m6c=5016;b.xVa=5102;b.Atk=5103;b.responsePayloadSizeLimitExceeded=
5104;b.kVh=7001;b.CYg=7002;b.wki=8E3;b.Kck=8001;b.ygj=8010;b.Hgj=8011;b.zgj=8012;b.Zwk=8020;b.g_h=8021;b.yAi=8022;b.QVh=8023;b.mHj=11E3;b.XKj=11001;b.Ggj=11002;b.KTe=null;Object(y.a)(b,"DdaErrorIds",null,[])},967:function(y,m,a){a.d(m,"a",function(){return e});y=a(0);var c=a(15),b=a(94);class e{constructor(){this.Pie=0;this.j8={};this.JHa={}}kTi(k,d){return this.j8[e.Dud(k,d)]}puf(k,d){d||void 0!==this.JHa[k]&&null!==this.JHa[k]?d&&void 0!==this.JHa[k]&&null!==this.JHa[k]&&delete this.JHa[k]:this.JHa[k]=
1}gpc(k){return void 0===this.JHa[k]||null===this.JHa[k]}pRd(k){const d=e.Dud(k.messageType,k.targetId);1===k.actionType?this.P5i(k.controlId,k.messageType,d):2===k.actionType&&this.R6i(k.controlId,k.messageType,d)}kmk(k){if(k){var d=Object.keys(this.j8);if(!(void 0===d||null===d||0>=d.length))for(const u of d)d=this.j8[u],d[k]&&(delete d[k],Object.keys(d).length||delete this.j8[u])}}qS(k,d){k=e.Dud(k,d);k=this.j8[k];return!!k&&0<Object.keys(k).length}M7i(){return!b.a.isEmpty(this.j8)}x4f(){return 0<
this.Pie}mMi(){const k=[],d=this.j8;for(const v in d){var u=v,n=d[v];for(const f in n){n=f;const w={};w.eventType=parseInt(u.split("#")[0],10);w.targetId=u.split("#")[1];w.addinId=n;k.push(w)}}return k}P5i(k,d,u){if(this.j8[u])u=this.j8[u],u[k]=u[k]?u[k]+1:1;else{const n={};n[k]=1;this.j8[u]=n}100===d&&this.Pie++}R6i(k,d,u){if(this.j8[u]){const n=this.j8[u];if(k){const v=n[k];1===v?(delete n[k],Object.keys(n).length||delete this.j8[u]):n[k]=v-1;100===d&&this.Pie--}else c.ULS.sendTraceTag(537170459,
0,50,`The OsfControl[${k}] doesn't register event with key[${u}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${u}] that will be unregistered doesn't exist.`)}static Dud(k,d){return String.format("{0}#{1}",k,d)}}e.kW="Workbook";Object(y.a)(e,"RichApiEventRegistration",null,[])},968:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.Knd="AccessDenied";c.notSupported=
"NotSupported";c.Goc="ApiNotAvailable";c.qgg="NotAllowed";c.oce="OperationCancelled";c.pCe="UserNotSignedIn";c.zAb="UserAborted";c.x8k="UnsupportedUserIdentity";c.Unb="InvalidResourceUrl";c.BGc="InvalidGrant";c.EGh="AddinIsAlreadyRequestingToken";c.jvk="ResourceNotAllowed";c.msc="ClientError";c.serverError="ServerError";c.k3h="ControlIdNotFound";c.lwk="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";
Object(y.a)(c,"ErrorCodes",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.agave.js.map/e28f21c5366d5c005154b51ce2a4a4d6/EwaTS.agave.js.map