'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[48],{1181:function(y,m,a){a.r(m);a.d(m,"FormulaBar",function(){return yb});y=a(0);var c=a(15),b=a(98),e=a(6),k=a(159),d=a(17),u=a(95),n=a(923),v=a(37),f=a(420),w=a(99),r=a(19),t=a(7),l=a(306),x=a(749),A=a(747),z=a(566),F=a(179),D=a(155);m=a(80);var G=a(106);class Q extends G.a{constructor(Fb,Qb,ac,Wa,Gb,Ub){super(Fb);this.sZ=()=>{this.domElement.disabled||(this.Hsc.className=this.ivc+" "+this.weg)};this.rZ=()=>{this.domElement.disabled||
(this.Hsc.className=this.ivc+" "+this.EIj)};this.vog=Ra=>{if(!this.domElement.disabled){const Rb=Ra.keyCode;if("mousedown"===Ra.type||13===Rb||32===Rb)this.Hsc.className=this.ivc+" "+this.Pak}};this.wog=()=>{this.domElement.disabled||(this.Hsc.className=this.ivc+" "+this.weg)};this.ivc=ac;this.weg=Wa;this.EIj=Gb;this.Pak=Ub;this.qj.Ga("mouseover",this.sZ);this.qj.Ga("mouseout",this.rZ);this.qj.Ga("focus",this.sZ);this.qj.Ga("blur",this.rZ);this.qj.Ga("mousedown",this.vog);this.qj.Ga("keydown",this.vog);
this.qj.Ga("mouseup",this.wog);this.qj.Ga("keyup",this.wog);this.Hsc=Qb}}Object(y.a)(Q,"PseudoClassBehavior",G.a,[]);var O=a(16);class J extends m.a{constructor(Fb){super();this.instances=[];this.$=Fb}dispose(){u.a.gj(this.instances);this.instances.length=0;this.$=null;super.dispose()}Cpc(Fb,Qb,ac,Wa,Gb){const Ub=O.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+Fb);Fb=Fb===Qb?Ub:O.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+Qb);if(!Ub)return null;ac=new Q(Ub,Fb,
ac,Wa,"",Gb);this.instances.push(ac);return ac}}J.dSh="ewa-menu-btn-hover";J.fSh="ewa-menu-btn-pressed";Object(y.a)(J,"InitializePseudoClasses",m.a,[]);var H=a(25),N=a(284),L=a(207),Z=a(141),ba=a(40),K=a(23);class E{constructor(Fb,Qb){this.$=Fb;this.ej=Qb;l.a(this.$).Wq(this)}get ij(){return this.ej.Xa.dm}get ap(){return K.f(this.$).isEditing&&K.f(this.$).DA}get el(){return N.a.XCf}Lp(Fb,Qb){Qb||O.DOMElementExtensions.setFocus(this.ij);return!Qb}wq(Fb){return O.DOMElementExtensions.Co(this.ij,Fb)}Rs(){}nu(){}dispose(){l.a(this.$).fI(this)}}
Object(y.a)(E,"FormulaBarFocusManager",null,[42,2]);var U=a(291),X=a(308),ia=a(60),Ma=a(84),qa=a(940),Ha=a(171);class ha extends m.a{constructor(Fb=null,Qb,ac,Wa=null){super();this.i6a=this.Anb=this.nlb=this.LTc=null;this.ZJd=H.a.Oz()?16:13;this.$Jd=H.a.Oz()?16:13;this.Llg=()=>{const Gb=new Ma.a(753860909,2,this.$.ji,2,null);this.$.Ia.qh(Gb);return!0};this.Mlg=Gb=>Gb.La.keyCode===b.a.Au?(Gb=new Ma.a(753860909,1,this.$.ji,2,null),this.$.Ia.qh(Gb),!0):!1;this.Nlg=()=>{this.da.isEditing&&this.da.Fp.Xa.dqc();
return!1};this.$=ac;this.da=K.f(ac);this.Xq=Qb;this.svgIconProvider=Wa;H.a.Oz()?this.nlb=O.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+t.a.rRb):(this.MBi=Qb.ia(1035),this.LTc=Fb.Cpc(t.a.rRb,t.a.rRb,r.a.DDf+" "+r.a.L0,r.a.d2i,""),this.nlb=this.LTc.domElement);this.wbj(this.nlb)}wbj(Fb){Fb.role="button";Fb.title=this.Xq.ia(1035);this.Anb=this.svgIconProvider?this.svgIconProvider.loa(qa.a.LBi,this.ZJd,this.$Jd,Fb,void 0,void 0,void 0,this.Xq.ia(1035)):Ha.b(this.$Jd,this.ZJd,r.a.mri,
ia.a.Gn(0),null,null,!0,this.Xq.ia(1035));Fb.appendChild(this.Anb);U.a.instance.xa(d.a.click,Fb,this.Llg);k.a.instance.xa(d.a.Wi,Fb,this.Mlg);X.a.instance.xa(d.a.Bj,Fb,this.Nlg)}dispose(){this.H$a(this.nlb);this.nlb=null;H.a.Oz()||(u.a.gh(this.LTc),this.LTc=null);O.DOMElementExtensions.jn(this.Anb);this.i6a=this.Anb=null;super.dispose()}H$a(Fb){Fb&&(U.a.instance.Oa(d.a.click,Fb,this.Llg),k.a.instance.Oa(d.a.Wi,Fb,this.Mlg),X.a.instance.Oa(d.a.Bj,Fb,this.Nlg))}s$k(Fb){!this.i6a&&this.svgIconProvider&&
(this.i6a=this.svgIconProvider.loa(qa.a.RBi,this.ZJd,this.$Jd,this.nlb,void 0,void 0,void 0,this.MBi))&&this.i6a.classList.add("ewa-fb-function-button-img");this.Anb&&this.i6a&&(O.DOMElementExtensions.setVisible(this.Anb,!Fb),O.DOMElementExtensions.setVisible(this.i6a,Fb))}}Object(y.a)(ha,"FormulaBarFunctionControl",m.a,[]);var La=a(330),fa=a(196),ja=a(52),ta=a(10),Ka=a(175),Ga=a(160),Na=a(13),cb=a(1);const jb=H.a.Oz()?1:2;class Sa{constructor(Fb){this.FIa=this.expandButton=this.HJa=this.Nbd=this.Mbd=
this.Lbd=null;this.dKc=this.dXd=this.uba=!1;this.gdf=this.FJg=0;this.aFb=H.a.Oz()?16:0;this.IXe=0;this.Uzc=H.a.Oz()?24:Ka.c;this.pha=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.LPc=Qb=>{this.qzf();Qb.La.rawEvent.preventDefault();return!0};this.HPc=Qb=>{this.dXd=!0;this.FJg=Qb.clientPoint.y;document.body.classList.add(r.a.xwf);this.uba||(this.w7a=0);this.Cjb.Ga("mousemove",this.Dkg,!0);this.Cjb.Ga("touchmove",this.Dkg);this.Cjb.Ga("mouseup",this.C$d);this.Cjb.Ga("touchend",
this.C$d);this.Cjb.Ga("mouseleave",this.C$d);return!0};this.C$d=()=>{this.dXd=!1;this.w7a=H.a.Oz()?this.uba?this.HJa.clientHeight-this.Uzc:0:this.Bw.clientHeight-this.Uzc;document.body.classList.remove(r.a.xwf);this.Cjb.LM();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.Bw.clientHeight} pixel`)};this.Dkg=Qb=>{this.dXd?(Qb=Na.HelperMethods.dSb(Qb).y,Qb=this.sKf(this.w7a+Math.min(Qb,this.$.domElement.clientHeight-75)-this.FJg),
this.uba=Qb>=this.lineHeight,O.DOMElementExtensions.toggleCssClass(this.Bw,r.a.ywf,this.uba),Qb=this.Uzc+Math.round(Math.max(Qb-jb,0)),(H.a.Oz()?this.HJa.clientHeight:this.Bw.clientHeight)!==Qb&&(this.Bw.style.height=Qb+"px",this.$.v7a())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.tZ=Qb=>{this.uba&&(this.VZa=Math.round((Math.round(this.VZa/this.lineHeight)+(0<Qb.tDa?1:-1))*this.lineHeight));Qb.La.preventDefault();
return!1};this.dQ=()=>{this.wuk();this.dKc&&(La.a.instance.Oa(d.a.LS,document.body,this.dQ),La.a.instance.Oa(d.a.jNa,document.body,this.dQ),fa.a.instance.Oa(d.a.pl,document.body,this.dQ),this.dKc=!1);return!1};this.onActiveCellChanged=()=>{this.VZa=0};this.Tqg=Qb=>{this.dKc||(La.a.instance.xa(d.a.LS,document.body,this.dQ),La.a.instance.xa(d.a.jNa,document.body,this.dQ),fa.a.instance.xa(d.a.pl,document.body,this.dQ),this.dKc=!0);Qb.preventDefault()};this.onScroll=Qb=>ac=>{Qb.onScroll();this.Tqg(ac)};
this.L1j=Qb=>{this.VZa=this.gdf;Qb.preventDefault()};this.$=Fb;this.Cjb=Ga.a.instance.dYa(document.body.ownerDocument)}get lineHeight(){return this.aFb?this.aFb:ta.a.YCf}set lineHeight(Fb){this.aFb=Fb}get Bw(){const {FormulaBar:Fb}=a(1181);this.Lbd||(this.Lbd=Fb.hIf(this.$));return this.Lbd}get Vzc(){this.Mbd||(this.Mbd=document.getElementById(t.a.sRb));return this.Mbd}get e1(){this.Nbd||(this.Nbd=document.getElementById(t.a.sRb+"_"+t.a.bye));return this.Nbd}get VZa(){return this.e1.scrollTop}set VZa(Fb){this.gdf=
Fb;this.e1.scrollTop!==Fb&&(this.e1.scrollTop=Fb)}get FAi(){return 2*this.lineHeight-jb}get w7a(){return this.IXe}set w7a(Fb){this.IXe=Fb}qzf(){this.uba=!this.uba;O.DOMElementExtensions.toggleCssClass(this.Bw,r.a.ywf,this.uba);this.uba&&!this.w7a&&(this.w7a=this.FAi);this.Bw.style.height=this.Uzc+(this.uba?this.w7a:0)+"px";this.expandButton.setAttribute(t.a.wD,this.uba?"Collapse the formula bar":"Expand the formula bar");this.$.v7a();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.uba?
"expanded":"collapsed"}`)}Gai(Fb){this.HJa=document.createElement("div");this.HJa.id=this.$.xi+t.a.FJd;this.HJa.className=r.a.Spi;this.expandButton=Sa.C7h(this.$.xi,Fb);this.HJa.appendChild(this.expandButton);this.FIa=Sa.b7h(this.$.xi);this.HJa.appendChild(this.FIa);return this.HJa}Jkk(){La.a.instance.xa(d.a.Ty,this.expandButton,this.LPc);fa.a.instance.xa(d.a.Om,this.expandButton,this.LPc);La.a.instance.xa(d.a.Ty,this.FIa,this.HPc);fa.a.instance.xa(d.a.Om,this.FIa,this.HPc)}Mkk(Fb){La.a.instance.xa(d.a.xN,
this.Vzc,this.tZ);ja.a.addHandler(this.e1,d.a.scroll,this.pha?this.onScroll(Fb):this.Tqg);H.a.Oz()&&ja.a.addHandler(this.e1,d.a.scrollEnd,this.dQ);ja.a.addHandler(this.e1,d.a.focus,this.L1j);K.f(this.$).ha.add_activeCellChanged(this.onActiveCellChanged)}U7k(){void 0!==this.expandButton&&null!==this.expandButton&&(La.a.instance.Oa(d.a.Ty,this.expandButton,this.LPc),fa.a.instance.Oa(d.a.Om,this.expandButton,this.LPc));void 0!==this.FIa&&null!==this.FIa&&(La.a.instance.Oa(d.a.Ty,this.FIa,this.HPc),fa.a.instance.Oa(d.a.Om,
this.FIa,this.HPc));void 0!==this.Vzc&&null!==this.Vzc&&La.a.instance.Oa(d.a.xN,this.Vzc,this.tZ);K.f(this.$).ha.remove_activeCellChanged(this.onActiveCellChanged)}wuk(){this.VZa=Math.round(this.sKf(this.VZa))}sKf(Fb){return Math.round(Fb/this.lineHeight)*this.lineHeight}static C7h(Fb,Qb){const ac=document.createElement("a");ac.id=Fb+t.a.IAi;ac.classList.add(r.a.Ipi);O.DOMElementExtensions.wL(ac,t.a.KF);ac.setAttribute(t.a.wD,"Expand the formula bar");Qb.loa(qa.a.y0h,12,12,ac,H.a.Oz()?20:null,H.a.Oz()?
20:null).classList.add(r.a.Jpi);return ac}static b7h(Fb){const Qb=document.createElement("div");Qb.id=Fb+t.a.GAi;Qb.className=r.a.Hpi;return Qb}}Object(y.a)(Sa,"FormulaBarResizeControl",null,[]);G=a(266);var bb=a(46),oa=a(696),ka=a(192),ya=a(102),Oa=a(43),za=a(1386);class ea{}ea.disabled="disabled";ea.oWk="stale";ea.text="text";ea.Iak="presentationMode";ea.viewMode="viewMode";Object(y.a)(ea,"NameBoxStateUpdateKey",null,[]);var Aa=a(149),ub=a(165),rb=a(712);class Ja extends G.a{constructor(Fb,Qb){super(document.createElement("div"));
this.$=Fb;this.jm=null;this.aye="";this.x4k=()=>{this.$.Ia.cUb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.aae=()=>{this.mW(this.da.ha.MLf())};this.Bq=(ac,Wa)=>{this.pqa(ac,Wa);this.t8b(ac,Wa)};this.t8b=()=>{let ac=za.c(this.$,this.da);oa.c(ac,!0)||(this.jm&&(ac=this.$.$h.getItemByName(this.jm))&&ac.deactivate(),this.mW(this.da.ha.pa.activeCell.toString()))};this.G1b=(ac,Wa)=>{var Gb,Ub,Ra,Rb,ib;!(ac=Wa.la)||cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8137505_AvoidViewportJumpWhenScrollingNamedObject")&&
(null===(Gb=Wa.OB)||void 0===Gb?void 0:Gb.name)===(null===ac||void 0===ac?void 0:ac.name)&&(null===(Ub=Wa.OB)||void 0===Ub?void 0:Ub.usedRange.top)===(null===ac||void 0===ac?void 0:ac.usedRange.top)&&(null===(Ra=Wa.OB)||void 0===Ra?void 0:Ra.usedRange.bottom)===(null===ac||void 0===ac?void 0:ac.usedRange.bottom)&&(null===(Rb=Wa.OB)||void 0===Rb?void 0:Rb.usedRange.left)===(null===ac||void 0===ac?void 0:ac.usedRange.left)&&(null===(ib=Wa.OB)||void 0===ib?void 0:ib.usedRange.right)===(null===ac||void 0===
ac?void 0:ac.usedRange.right)||(Gb=ac.usedRange,2===ac.type&&(Gb=ka.a(ac)),Ub=this.da.ha.pa.Yn,Ra=this.da.inRangePicker||this.da.kq,Rb=!1,2===ac.type&&Ub&&!Ra&&(Ub=this.da.ha.pa.activeRange,Rb=ac.sheetName===this.$.sa.la.name&&!!Ub&&Ub.top===Gb.top&&Ub.left===Gb.left&&Ub.bottom===Gb.bottom&&Ub.right===Gb.right),Gb=bb.x(Gb,this.$),Gb.NamedObjectName=ac.name,Gb.SheetName=ac.sheetName,this.da.fp(Gb,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,Wa.disableAutoFocusOnGrid),
Wa=oa.a(ac.name),this.mW(Wa.name,Wa.fullName))};this.Yu=()=>{const ac=za.b(this.da);null!=ac&&this.mW(ac.name)};this.zlg=(ac,Wa)=>{this.aae(ac,Wa)};this.b3b=()=>{this.NOb(!0)};this.a3b=()=>{this.NOb(!1)};this.xx=()=>{cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)?this.p$k(!this.$.isEditMode):this.NOb(!this.$.isEditMode)};this.sog=()=>{Oa.a(this.$).xJ(Aa.a.JAi,ub.a.rj)};this.uZ=(ac,Wa)=>{this.eRg(Wa.sU)};this.onKeyDown=ac=>ac.La.keyCode===b.a.FRa?(this.da.focus(),
!0):!1;this.pqa=()=>{this.H4c({[ea.oWk]:!0})};this.da=K.f(Fb);this.Hcj(Qb);cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8749712_AppendNameBoxStateDuringInit")||(this.mW(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8749724_StartNameBoxWithNamedObjectIfExists")?this.da.ha.QOd():this.da.ha.pa.activeCell.toString(),"",!0),this.NOb(!cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)&&!this.$.isEditMode));this.eRg(Oa.a(this.$).wv());this.Kp();k.a.instance.xa(d.a.Wi,
this.domElement,this.onKeyDown.bind(this))}get text(){return cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8654931_readNameBoxTextFromReact")?appChrome.getNameBoxText():this.aye}dispose(){if(this.$){this.$.vh.iHg(this.b3b.bind(this));this.$.vh.hHg(this.a3b.bind(this));var Fb=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8768614_FixNameBoxNullReferences");Fb&&!this.$.fa||this.$.fa.IZ(this.xx.bind(this));var Qb=ya.a(this.$);if(!Fb||Qb)Qb.DVc(this.zlg.bind(this)),Qb.ske(this.Yu.bind(this));Qb=Oa.a(this.$);
Fb&&!Qb||Qb.Dm.kBa(this.uZ.bind(this));Fb&&!this.$.fa||!this.$.$h||(this.$.$h.Nn(this.G1b.bind(this)),this.$.$h.HVc(this.t8b.bind(this)),this.$.$h.HVc(this.mDg.bind(this)),this.$.$h.Mca(this.pqa.bind(this)),this.$.$h.iBa(this.pqa.bind(this)),this.$.$h.jBa(this.pqa.bind(this)),this.$.$h.c6b(this.pqa.bind(this)));this.$.sa&&this.$.sa.Nn(this.Bq.bind(this))}this.da&&(Fb=this.da.ha,Fb.k8(this.t8b.bind(this)),Fb.Nca(this.aae.bind(this)),Fb.$a.dW(this.Yu.bind(this)));super.dispose()}o$k(Fb){this.H4c({[ea.Iak]:Fb})}p$k(Fb){this.H4c({[ea.viewMode]:Fb})}Hcj(Fb){const Qb=
document.getElementById(this.$.xi+t.a.ZCf);void 0!==Qb&&null!==Qb&&Fb.removeChild(Qb);appChrome.renderNameBoxUI(this.domElement,this.LRi(),this.x4k.bind(this));Fb.insertBefore(this.domElement,Fb.firstChild)}LRi(){return cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8749712_AppendNameBoxStateDuringInit")?{[ea.disabled]:rb.a.LTg(this.$,!1),[ea.text]:cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8749724_StartNameBoxWithNamedObjectIfExists")?this.da.ha.QOd():this.da.ha.pa.activeCell.toString()}:{}}Kp(){this.$.vh.z6e(this.b3b.bind(this));
this.$.vh.y6e(this.a3b.bind(this));this.$.fa.AX(this.xx.bind(this));const Fb=this.da.ha;this.$.$h.vn(this.G1b.bind(this));this.$.sa.vn(this.Bq.bind(this));Fb.C4(this.t8b.bind(this));Fb.z$(this.aae.bind(this));Fb.$a.AO(this.Yu.bind(this));ya.a(this.$).Aqd(this.Yu.bind(this));ya.a(this.$).Bnc(this.zlg.bind(this));Oa.a(this.$).Dm.vua(this.uZ.bind(this));this.$.$h.Fnc(this.t8b.bind(this));this.$.$h.Fnc(this.mDg.bind(this));this.$.$h.z4(this.pqa.bind(this));this.$.$h.rua(this.pqa.bind(this));this.$.$h.sua(this.pqa.bind(this));
this.$.$h.ffb(this.pqa.bind(this))}eRg(Fb){cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8855946_improveNameBoxPartialInteractivity")&&this.NOb(rb.a.LTg(this.$,!0));Fb?this.domElement.addEventListener("pointerdown",this.sog):this.domElement.removeEventListener("pointerdown",this.sog);this.g2k(Fb)}g2k(Fb){for(let Qb=0;Qb<this.domElement.children.length;Qb++)this.domElement.children[Qb].style.pointerEvents=Fb?"none":""}mW(Fb,Qb="",ac=!1){this.aye=Fb;this.jm=""!==Qb?Qb:this.jm;appChrome.setNamedObjectOrActiveCellRange(Qb,
Fb,ac)}NOb(Fb){this.H4c({[ea.disabled]:Fb})}mDg(Fb,Qb){za.a(this.$,!0);this.pqa(Fb,Qb)}H4c(Fb){appChrome.updateNameBoxState(Fb)}}Object(y.a)(Ja,"NameBox",G.a,[2]);var Xa=a(177),Y=a(157);const Ia=r.a.Ihg+" "+r.a.L0,$a=r.a.Lef+" "+r.a.L0;class Ea extends m.a{constructor(Fb=null,Qb,ac,Wa){super();this.sLb=this.C1b=this.tLb=this.D1b=this.KO=this.aQ=null;this.rS=this.JJc=!1;this.fEg=()=>{this.da.MU.Mv(this.Jn);this.da.MU.Ox(this.im);this.JJc=!0};this.Jn=()=>{this.o2g(!0)};this.im=()=>{this.o2g(!1)};this.cpg=
Ub=>this.pPc(!0,`OkCancelEditControl.OnOkClick: ${Ub.Gh}`,Na.HelperMethods.vA(Ub));this.dpg=Ub=>this.pPc(!0,`OkCancelEditControl.OnOkKeyDown: ${Ub.Gh}`);this.Rig=Ub=>this.pPc(!1,`OkCancelEditControl.OnCancelClick: ${Ub.Gh}`,Na.HelperMethods.vA(Ub));this.Uig=Ub=>this.pPc(!1,`OkCancelEditControl.OnCancelKeyDown: ${Ub.Gh}`);this.tJ=()=>{this.f2k(!this.$.isEditMode)};this.onPointerDown=()=>{this.da.isEditing&&(this.da.Fp.Xa.eN=!0);return!1};const {FormulaBar:Gb}=a(1181);this.$=ac;this.da=K.f(ac);this.rS=
H.a.rS();Wa?(this.D1b=Wa.d0a(qa.a.lgf,16),this.tLb=Wa.d0a(qa.a.uei,16),H.a.Oz()||(this.C1b=Wa.d0a(qa.a.MXh,16),this.sLb=Wa.d0a(qa.a.vei,16),this.D1b.style.display="none",this.tLb.style.display="none")):(this.D1b=Ha.b(16,16,r.a.bri,ia.a.Gn(1),null,null,!0,Qb.ia(1041)),this.tLb=Ha.b(16,16,r.a.gri,ia.a.Gn(1),null,null,!0,Qb.ia(1042)));H.a.Oz()?(this.aQ=O.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+Gb.aPc),this.KO=O.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+Gb.erc)):
(this.A9d=Fb.Cpc(Gb.aPc,Gb.aPc,Ia,"",""),this.aQ=this.A9d.domElement,this.Gvd=Fb.Cpc(Gb.erc,Gb.erc,$a,"",""),this.KO=this.Gvd.domElement);this.aQ.appendChild(this.D1b);this.KO.appendChild(this.tLb);H.a.Oz()?(this.aQ.classList.add(r.a.fva),this.KO.classList.add(r.a.fva),O.DOMElementExtensions.toggleCssClass(this.aQ,r.a.mkb,!this.$.isEditMode),O.DOMElementExtensions.toggleCssClass(this.KO,r.a.mkb,!this.$.isEditMode)):(this.aQ.appendChild(this.C1b),this.KO.appendChild(this.sLb));this.da.cellTextEditBox.Mv(this.Jn);
this.da.cellTextEditBox.Ox(this.im);H.a.Oz()&&ac.fa.lK(this.tJ);U.a.instance.xa(d.a.click,this.aQ,this.cpg);k.a.instance.xa(d.a.Wi,this.aQ,this.dpg);X.a.instance.xa(d.a.Bj,this.aQ,this.onPointerDown);U.a.instance.xa(d.a.click,this.KO,this.Rig);k.a.instance.xa(d.a.Wi,this.KO,this.Uig);X.a.instance.xa(d.a.Bj,this.KO,this.onPointerDown);this.rS&&this.da.aDh(this.fEg)}dispose(){this.da&&this.da.cellTextEditBox&&(this.da.cellTextEditBox.Cv(this.Jn),this.da.cellTextEditBox.Ow(this.im));this.da&&this.rS&&
(this.da.hok(this.fEg),this.JJc&&(this.da.MU.Cv(this.Jn),this.da.MU.Ow(this.im),this.JJc=!1));this.aQ&&(U.a.instance.Oa(d.a.click,this.aQ,this.cpg),k.a.instance.Oa(d.a.Wi,this.aQ,this.dpg),X.a.instance.Oa(d.a.Bj,this.aQ,this.onPointerDown),this.aQ=null);this.KO&&(U.a.instance.Oa(d.a.click,this.KO,this.Rig),k.a.instance.Oa(d.a.Wi,this.KO,this.Uig),X.a.instance.Oa(d.a.Bj,this.KO,this.onPointerDown),this.KO=null);H.a.Oz()||(u.a.gh(this.A9d),this.A9d=null,u.a.gh(this.Gvd),this.Gvd=null);H.a.Oz()&&this.$&&
this.$.fa.gI(this.tJ);H.a.Oz()||(O.DOMElementExtensions.jn(this.sLb),this.sLb=null,O.DOMElementExtensions.jn(this.C1b),this.C1b=null);super.dispose()}f2k(Fb){Object(Y.c)(()=>{this.aQ&&this.KO&&(O.DOMElementExtensions.toggleCssClass(this.aQ,r.a.mkb,Fb),O.DOMElementExtensions.toggleCssClass(this.KO,r.a.mkb,Fb))},this.$.ya)}pPc(Fb,Qb,ac=null){const Wa=this.da.Fp;if(ac){const Gb=this.da.DA?"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let Ub;Ub=[Object(Xa.a)(this.da.cellTextEditBox.Xa.TQa)];
Xa.b(this.$).iz(ac.rawEvent,Gb,Ub)}this.JJc&&this.da.MU.fP?this.da.MU.endEdit(Fb,Qb,0):Wa.endEdit(Fb,Qb,0);this.da.focus();return!0}o2g(Fb){if(H.a.Oz())Fb?(this.aQ.classList.remove(r.a.fva),this.KO.classList.remove(r.a.fva)):(this.aQ.classList.add(r.a.fva),this.KO.classList.add(r.a.fva));else{const Qb=Fb?"block":"none";Fb=Fb?"none":"block";this.D1b.style.display=Qb;this.tLb.style.display=Qb;this.C1b.style.display=Fb;this.sLb.style.display=Fb}}}Object(y.a)(Ea,"OkCancelEditControl",m.a,[]);var Lb=a(332),
Ib=a(344),Mb=a(70),mc=a(212),jc=a(12),Fc=a(328),Gc=a(236),xc=a(331),Uc=a(156),Pa=a(164),Bb=a(44),Nb=a(437),oc=a(245),aa=a(163),rc=a(385);class yb extends f.a{constructor(Fb,Qb,ac=null){super(K.f(Fb));this.lCa=Qb;this.KNe=this.UF=this.clearContentNotifier=this.nameBox=this.Bw=this.y1g=null;this.sDe=!1;this.e1=null;this.XUg=this.c2f=this.CHc=this.jdf=this.yEc=!1;this.pha=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.Zpj=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8614675_partialInteractivityFormulaBar");
this.i3f=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8704306_RemoveRegionHeightAfterFormulaBarVisible");this.Jn=()=>{this.sDe=!1;this.dre();this.CHc&&this.Mac(!this.d0f)};this.im=()=>{this.dre();this.CHc&&this.Mac(!1)};this.Mac=(Wa,Gb=!1)=>{if(yb.axa&&this.jdf!==Wa){if(H.a.Oz()){const Ub=()=>{yb.axa&&(O.DOMElementExtensions.toggleCssClass(yb.axa,r.a.mkb,Wa),O.DOMElementExtensions.toggleCssClass(yb.axa,r.a.fva,Wa))};Gb?Ub():Object(Y.c)(()=>{Ub()},this.$.ya)}else O.DOMElementExtensions.toggleCssClass(yb.axa,
r.a.fva,Wa);this.jdf=Wa}};this.wsg=()=>{this.isEditing||this.Xa.disabled||this.startEdit(!0,!1,null)};this.fw=()=>{this.gQa()};this.uZ=(Wa,Gb)=>{this.gQa();yb.axa&&(Gb.sU?this.Zpj?this.Mac(!0):yb.axa.classList.add(r.a.fva):this.joc())};this.JA=(Wa,Gb)=>{Wa=this.grid;this.sDe=!0;this.isEditing?(this.DXb||(Gb.EHc||this.n_(null),this.raiseEvent(f.a.ALb,Gb)),this.DXb||Wa.cellTextEditBox.Xa.isCursorAttached()&&!this.Xa.isCursorAttached()&&Wa.cellTextEditBox.Xa.clearCursorFormatLocation()):Wa.isEditing&&
this.gQa()};this.onBlockCacheItemChanged=(Wa,Gb)=>{(Wa=this.grid.ha.pa.activeCell)&&(Gb=this.grid.XN(Gb.Oj.hash))&&Wa.$i(Gb.zj)&&this.gQa()};this.Uae=(Wa,Gb)=>{-185374993===Gb.command&&this.gQa()};this.onActiveItemChanged=()=>{this.gQa();ba.TaskExtensions.$e(L.a(this.$.qa),()=>{this.yQg()},this.ya,11)};this.mZ=()=>{this.yQg();H.a.e2a()?this.lCa.T5k(this.KNi()):(Bb.a.instance.L2(t.a.g6,rc.a.uac),Bb.a.instance.MZ(t.a.g6,rc.a.uac));Bb.a.instance.Pca(t.a.g6,rc.a.Qcf)};this.onKeyDown=Wa=>{if(Wa.La.keyCode===
b.a.MG){var Gb=this.kKa();const Ub=O.DOMElementExtensions.KE(Gb);Gb=O.DOMElementExtensions.Paa(Gb);return O.DOMElementExtensions.x8a(Wa.La,Ub,Gb)}return!1};this.tJ=()=>{this.joc()};this.rej=()=>{this.Bw?(this.nameBox=new Ja(this.$,this.Bw),this.Qsk()):this.iIg()};ac||c.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");H.a.e2a()&&(Qb||c.ULS.sendTraceTag(507609984,0,10,"FormulaBar.ctor: SkeletonManager must always exist."));this.KNe=new Sa(Fb);this.initialize(this.uqe(Fb,
ac));this.UZa.Jkk();!this.i3f&&e.AFrameworkApplication.ra.$g.Zk&&(Qb=document.getElementById("AdditionalBarsRegion"))&&(Qb.style.height="");this.HWd=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.kM=new Lb.a(this.Bw,1);this.Gmj=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");H.a.Oz()&&cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8773064_FormulabarRemovePseudoClass")?(this.DJd=new ha(void 0,jc.a.instance,Fb,
ac),this.Hhg=new Ea(void 0,jc.a.instance,Fb,ac)):(this.hGc=new J(Fb),this.hGc.Cpc(t.a.m2g,t.a.m2g,t.a.c2k+" cui-TabRowRight",J.dSh,J.fSh),this.DJd=new ha(this.hGc,jc.a.instance,Fb,ac),this.Hhg=new Ea(this.hGc,jc.a.instance,Fb,ac));this.y1g=oc.b(()=>{this.cSg()},1,this.$.ya,"FormulaBar.setTextBoxForActiveItem",!0);Fb.sa.vn(this.onActiveItemChanged);ac=this.grid;ac.cellTextEditBox.Mv(this.Jn);ac.cellTextEditBox.Ox(this.im);ac.cellTextEditBox.LVa(this.JA);ac.zO(this.fw);ac.za.sz(this.onBlockCacheItemChanged);
ac.za.qua(this.onBlockCacheItemChanged);ac.Pnc(this.Uae);Oa.a(Fb).Dm.vua(this.uZ);Fb.fa.lK(this.tJ);ya.a(Fb).Aqd(this.fw);cb.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&Fb.qa.zi(313,Wa=>{this.clearContentNotifier=Wa;this.clearContentNotifier.Dpd(this.JA)});k.a.instance.xa(d.a.Wi,this.ij,this.onKeyDown);ac=this.Xa.style;Fc.c(ac,Fb.isChromeRtl,"0px");ac.textAlign=this.rYf?"right":"left";this.isVisible=!1;this.HWd&&(this.Xa.isVisible=!1);ac=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8654712_PopulateFBTextBoxBeforeCommandUIAttach");
ac||(F.a(this.$).AGa(this.mZ),this.$.fa.Gya&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.mZ(null,null)));cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8605252_FormulaBarInitStateFix")?this.cSg():this.gQa();cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8740111_setDisabledModeSyncInFormulaBarInit")?this.joc(!0):this.joc();this.Xa.rUg=!0;this.bej();l.a(Fb).Wq(this);this.Xa.A5e(this.wsg);this.DXb=!1;this.UF=new E(this.$,
this);this.mcj();ac&&this.Dxk();this.Xa.tfa(()=>{Bb.a.instance.Pca(t.a.g6,rc.a.b1g);this.toggleEditingEvents(!1)});this.CHc=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8106214_disableFunctionButtonV2")}set text(Fb){this.isEditing?this.Xa.setPlainText(Fb):super.text=Fb}get isEditing(){return super.isEditing}set isEditing(Fb){super.isEditing=Fb;this.toggleEditingEvents(Fb)}get d0f(){return this.HFc||0>=this.text.length}get X$b(){return!0}get formattedText(){return this.Xa.getFormattedText()}set formattedText(Fb){this.Xa.setFormattedText(Fb)}get aXb(){return this.isEditing}get isVisible(){return O.DOMElementExtensions.isVisible(this.Bw)}set isVisible(Fb){this.HWd?
O.DOMElementExtensions.setVisible(this.Bw,Fb):(O.DOMElementExtensions.setVisible(this.Bw,Fb),this.Xa.isVisible=Fb)}get ij(){return this.Bw}get ap(){return this.isVisible}get el(){return N.a.EJd}get UZa(){return this.KNe}Lp(Fb,Qb){Fb=!1;Qb||(Fb=this.Szi());return Fb}dispose(){const Fb=this.$;if(Fb){Fb.sa.Nn(this.onActiveItemChanged);var Qb=this.grid;Qb.cellTextEditBox.Cv(this.Jn);Qb.cellTextEditBox.Ow(this.im);Qb.cellTextEditBox.k7a(this.JA);Qb.oQ(this.fw);Qb.za.Vz(this.onBlockCacheItemChanged);Qb.za.Fvb(this.onBlockCacheItemChanged);
Oa.a(this.$).Dm.kBa(this.uZ);Fb.fa.gI(this.tJ);ya.a(Fb).ske(this.fw);Qb=F.a(this.$);k.a.instance.Oa(d.a.Wi,this.ij,this.onKeyDown);this.UZa.U7k();Qb&&Qb.n7a(this.mZ);l.a(Fb).fI(this);cb.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.wVc(this.JA),Fb.qa.Xma(313))}this.Xa&&this.Xa.sGg(this.wsg);u.a.gj([this.kM,this.DJd,this.Hhg,this.hGc,this.nameBox]);u.a.gh(this.UF);this.Bw&&(O.DOMElementExtensions.wM(this.Bw),
this.Bw.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.Bw=null;super.dispose()}endEdit(Fb,Qb,ac,Wa=null){this.Xa.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:Fb,["Caller"]:Qb});this.Vyb(!1);if(this.isEditing){var Gb=null;Wa&&(Gb=this.$.shortcutKeyManager.KD(Wa));var Ub=this.grid.Dh;this.isEditing=!1;this.LO(!0);this.Vpb()&&this.grid.aJ&&this.grid.aJ.glb&&this.grid.aJ.bxb(t.a.pVb);if(Fb){var Ra=new x.a(this.grid.ha.pa.activeCell,
Ub.text,Ub.text,!1,this.grid.$.sa.la);this.yAg(Ra);null!==Ra&&(Ub.text=Ra.newValue)}else this.Xa.setPlainText(this.text);Ra=new A.a(this.grid.ha.pa.activeCell,Ub.text,Fb,Wa);this.wge(Ra);Ub.endEdit(Fb,`${Qb}->FormulaBar.EndEdit`,ac,Wa);this.u4f(Gb)||Ub.Xa.focus();this.Xa.N$b("FormulaBar.EndEdit")}else this.Xa.N$b("FormulaBar.EndEdit",{["IsEditing"]:"false"})}xna(Fb,Qb,ac,Wa=!0,Gb=!0){super.xna(Fb,Qb,ac,Wa,Gb);this.grid.Dh.xna(Fb,Qb,ac,Wa,Gb)}myg(Fb){const Qb=this.grid.Dh,ac=this.Xa.selection;ac.length&&
Qb.xna(ac.index,ac.length,Fb,!1,!1)}wq(Fb){return O.DOMElementExtensions.Co(this.Bw,Fb)}Rs(){e.AFrameworkApplication.ra.Nm.Ev(this.el)}nu(){}b7g(Fb){this.nameBox.o$k(Fb);this.DJd.s$k(Fb)}MBe(){if(this.e1){var Fb=Object(aa.g)(this.text);this.yEc!==Fb&&(this.dSg(Fb),this.yEc=Fb)}}P9d(){this.Xa.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const Fb=this.grid.Dh;Fb.isEditing&&this.isEditing&&(Fb.formattedText=this.formattedText,Fb.setCaretPosition(this.Xa.caretPosition))}S2b(Fb){this.Xa.disabled||
(this.grid.cellTextEditBox.Xa.eN=!0,this.isEditing||this.startEdit(!1,!0,Fb),this.mva())}htb(){this.HZ&&(this.mX=this.Xa.caretPosition,this.h4=this.Xa.Rqa.length);this.n_(null);this.Eqa();this.B4g()}wAa(Fb){var Qb=this.$.shortcutKeyManager.KD(Fb);const ac=this.DXb;1872288872===Qb||125627505===Qb||267796030===Qb?super.wAa(Fb):ac?Mb.g(Fb):this.isEditing&&this.grid.Dh.isEditing&&(Qb=this.grid.Dh,Qb.formattedText=this.formattedText,Qb.setCaretPosition(this.Xa.caretPosition),this.m4c(),0===this.Xa.selection.length&&
this.n_(null,null),this.Gmj&&this.inRangePicker&&this.Rve(),super.wAa(Fb))}Gj(Fb,Qb){this.isEditing&&super.Gj(Fb,Qb)}Wy(Fb,Qb){this.isEditing&&super.Wy(Fb,Qb)}Dxk(){this.$.fa.Gya?(c.ULS.sendTraceTag(507585433,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.mZ(null,null)):F.a(this.$).AGa(this.mZ)}mcj(){const Fb=this.grid.yh(void 0);Fb?(this.yEc=Fb.LC||Object(aa.g)(Fb.text),this.dSg(this.yEc)):c.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}dSg(Fb){O.DOMElementExtensions.toggleCssClass(this.e1,
r.a.NFd,Fb)}uqe(Fb,Qb){this.Bw=yb.hIf(Fb);this.Bw.classList.add(r.a.Npi);this.Bw.classList.add(r.a.Opi);H.a.Oz()&&this.Bw.classList.add(r.a.Lpi);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFluentHighLightsEnabled",!1)&&this.Bw.classList.add("ewa-fb-fluent-formula-highlight");const ac=this.UZa.Gai(Qb);Qb=yb.ZAd();ac.appendChild(Qb);yb.axa=yb.H7h(Fb.xi);const Wa=yb.B7h(),Gb=yb.q9h(Fb.xi),Ub=yb.p9h(Fb.xi),Ra=yb.a6h(Fb.xi);Ub.tabIndex=-1;Ra.tabIndex=-1;Gb.appendChild(Ra);Gb.appendChild(Ub);
Gb.appendChild(yb.axa);Wa.appendChild(Gb);Wa.appendChild(ac);Fb=yb.T8h(Fb.xi);this.Bw.appendChild(Fb);this.Bw.appendChild(Wa);const Rb=new xc.a(Qb,!0,!1);this.e1=Qb;this.UZa.lineHeight=Rb.LNi();Rb.tfa(()=>{Nb.c(Rb.dm,n.a.ariaLabel,"formula bar")});Rb.tfa(()=>{this.UZa.Mkk(this.pha?{onScroll:()=>this.yge()}:{})});Rb.isVisible=!1;return Rb}y5a(Fb){this.ZTc(Fb);super.y5a(Fb);Uc.b(this.$).sj(D.a.QAi,{["Location"]:"canvas"});v.a.io&&window.focus();const Qb=this.$.shortcutKeyManager.KD(Fb);this.Wak(Fb,
Qb);this.Xa.disabled||this.isEditing||this.startEdit(!0,!1,Fb);let ac;ac={};ac.wasEditing=this.isEditing;ac.formulaBar=!0;let Wa=this.Iq(Fb,Qb);!Wa&&mc.d(Qb,this.gpb,!0)&&(Wa=this.u4f(Qb)?!0:this.grid.ha.Iq(Fb,Qb,ac));Wa||Pa.a(this.$).E4d(Fb,0,7)}startEdit(Fb,Qb,ac){const Wa=this.grid;if(!this.isEditing||!Wa.isEditing){this.Xa.N$b("FormulaBar.StartEdit");this.Xa.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:Fb,["IsOnMouseDown"]:Qb});Uc.b(Wa.$).sj(D.a.PAi,{["Location"]:"canvas"});
this.isEditing=this.DXb=!0;Wa.QB&&Wa.QB.XYc(this);Wa.cellTextEditBox.LO(!1);Wa.cellTextEditBox.cme();this.Mqe(!1);var Gb=()=>{var Ub=Wa.$.sa.la;const Ra=Wa.yh(null);Ub=new z.a(Ra,Ub,void 0,void 0,void 0,this.oNd(Ra));this.xge(Ub);this.E8b(Wa.cellTextEditBox.Xa.hP);Ub=()=>{if(this.isEditing&&Wa.isEditing){Wa.isEditing&&Wa.cellTextEditBox.Xa.detachCursorFormat();if(!this.n_(null)){const ib=Wa.cellTextEditBox.formattedText;var Rb=this.Xa.caretPosition;const la=ib.Text.length;Rb=this.Xa.text.length!==
la?la:Rb;this.formattedText=ib;this.Xa.caretPosition=Rb}this.DXb=!1;this.Xa.clearHistory()}else this.isEditing=!1};cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePostTaskHelperInFormulaBarStartEdit",!1)?void Object(Y.b)(Ub):setTimeout(Ub,0);Wa.cellTextEditBox.lJg()};if(Wa.isEditing)Wa.OM=1,Gb();else if(this.Xa.eN=!0,ba.TaskExtensions.$e(Wa.startEdit(!1,1,ac,!1,void 0,Qb,1),Ub=>{Ub.result?(Wa.isEditing||(this.Xa.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),c.ULS.sendTraceTag(37003425,
0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.isEditing&&Wa.isEditing?(Wa.cellTextEditBox.Xa.eN=!0,Ub=Wa.yh(null),this.Xa.vCf(Number.NaN,this.oNd(Ub)),Fb&&this.Xa.setCaretPositionToEnd(),Gb()):this.isEditing=!1):this.isEditing=!1},this.ya,11),this.Xa.eN=!1,Qb=Wa.yh(null),null===Qb||void 0===Qb?0:Qb.tYd)this.Xa.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=Na.HelperMethods.c_g(this.text)}}oRd(Fb){super.oRd(Fb);this.CHc&&
this.grid&&this.grid.isEditing&&2===Fb&&this.Mac(!this.d0f)}onActiveCellChanged(Fb,Qb){super.onActiveCellChanged(Fb,Qb);this.dre()}K8a(Fb){cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&c.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!Fb}`);super.K8a(Fb)}dre(){const Fb=this.grid;Fb.isEditing&&2===Fb.OM||this.gQa()}xm(){var Fb=this.grid;this.isEditing&&Fb.isEditing&&(Fb=Fb.Dh,Fb.text=
this.text,Fb.setCaretPosition(this.Xa.caretPosition),this.inRangePicker&&this.Xa.focus())}gQa(){this.y1g()}jJk(){if(this.Xa){var Fb=this.grid;this.Xa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,["TextBox.Initialized"]:this.Xa.initialized,["Grid.IsEditing"]:Fb.isEditing});if(!this.isEditing){var Qb=Oa.a(this.$).wv();this.Bw.disabled=Qb||!this.$.isEditMode;var ac=(Qb=this.$.XX===Fb)&&1===Fb.ha.Hk;this.Xa.initialized&&(this.Xa.disabled=this.Bw.disabled||
Qb&&!ac);Qb=new Gc.a(this.Xa.style);var Wa=!1;if(ac)if(Fb.isEditing)this.Xa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),ac=Fb.cellTextEditBox.text;else{Wa=Fb.yh(null);ac=new Z.a(this.$.sa);if(!Wa||!ac.Ppb(Wa.range,Fb))return;Fb=ac.Bn;ac=Wa.Xn;var Gb=Wa.formulaBarText;const Ub=Wa.text;this.Xa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:Fb,
["activeCell.IsHidden"]:ac,["activeCell.FormulaBarText"]:!!Gb,["activeCell.Text"]:!!Ub});ac=Fb&&ac?"":Gb||Ub;Wa=Wa.kue}else ac="",Gb=Fb.ha.$a.Ih,Gb=(null===Gb||void 0===Gb?0:Gb.floatingObject)?Gb.floatingObject.Ch:null,64===Fb.ha.Hk&&Gb&&Gb.IsShapeFormulaPresent&&((Fb=(Fb=Gb.ShapeText)?Fb.substring(Fb.indexOf(rb.a.Wzc)+rb.a.Wzc.length,Fb.indexOf(rb.a.hDf)):null)?(this.Xa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),ac=
"="+Fb):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.Mqe(Wa);this.qEb=this.Tqc();Qb.jE.direction=this.R6?w.a.rtl:w.a.a4a;Qb.jE.textAlign=this.R6?w.a.right:w.a.left;H.a.Oz()&&O.DOMElementExtensions.toggleCssClass(this.e1,r.a.Pxc,this.R6);Qb.J4();this.text=ac}}}cSg(){if(!cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8759863_SetTextBoxForActiveItemInternalRefactor"))this.jJk();else if(this.Xa){var Fb=
this.grid;this.Xa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,["TextBox.Initialized"]:this.Xa.initialized,["Grid.IsEditing"]:Fb.isEditing});if(!this.isEditing){var Qb=Oa.a(this.$).wv();this.Bw.disabled=Qb||!this.$.isEditMode;Qb=this.$.XX===Fb;this.Xa.initialized&&(this.Xa.disabled=this.Bw.disabled||Qb&&!Fb.jYd);if(Fb=rb.a.odf(Fb))this.iJk(Fb.GJa),this.Mqe(Fb.ida),this.qEb=this.Tqc(),Qb=new Gc.a(this.Xa.style),Qb.jE.direction=this.R6?w.a.rtl:w.a.a4a,
Qb.jE.textAlign=this.R6?w.a.right:w.a.left,H.a.Oz()&&O.DOMElementExtensions.toggleCssClass(this.e1,r.a.Pxc,this.R6),Qb.J4(),this.text=Fb.GJa}}}iJk(Fb){if(this.grid.jYd)if(this.grid.isEditing)this.Xa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"});else{Fb=new Z.a(this.$.sa);const Qb=this.grid.yh(null);this.Xa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:Fb.Bn,
["activeCell.IsHidden"]:Qb.Xn,["activeCell.FormulaBarText"]:!!Qb.formulaBarText,["activeCell.Text"]:!!Qb.text})}else Fb&&64===this.grid.ha.Hk&&this.Xa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"})}KNi(){return{formulaBarText:this.text,GY:this.GY(),kMa:this.R6,ida:this.XUg}}yQg(){var Fb=this.$.XX;if(this.HWd){var Qb=!!this.grid.MU&&this.grid.MU.fP;this.isVisible=Fb=!!Fb&&this.$.GJd&&!this.$.fa.Kh.inEmbedView;Qb||(this.Xa.isVisible=
Fb)}else this.isVisible=!!Fb&&this.$.GJd&&!this.$.fa.Kh.inEmbedView;this.i3f&&e.AFrameworkApplication.ra.$g.Zk&&(Qb=document.getElementById("AdditionalBarsRegion"))&&(Qb.style.height="",this.$.w1()&&(Qb=document.getElementById("RibbonRegion"),!this.c2f&&Qb&&(Qb.style.height="",this.$.SPb(),this.c2f=!0)));cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")&&H.a.e2a()?this.lCa.aN(t.a.n9a):this.$.yP(t.a.n9a);H.a.e2a()&&this.lCa.C7k();this.$.qQ()}Mqe(Fb){this.XUg=Fb;O.DOMElementExtensions.toggleCssClass(this.Xa.domElement,
r.a.zwf,Fb)}kKa(){return this.Bw.querySelectorAll(O.DOMElementExtensions.cJ+", div[tabindex]")}KE(){return O.DOMElementExtensions.KE(this.kKa())}Szi(){const Fb=this.KE();return Fb?(O.DOMElementExtensions.setFocus(Fb),!0):!1}Wak(Fb,Qb){Qb=-287251124===Qb||-1925065947===Qb||1764140053===Qb;Ib.a.Zpb()&&Qb&&Fb.preventDefault()}joc(Fb=!1){this.Mac(!this.$.isEditMode,Fb);if(H.a.Oz()){const Qb=()=>{this.e1&&O.DOMElementExtensions.toggleCssClass(this.e1,r.a.mkb,!this.$.isEditMode)};Fb?Qb():Object(Y.c)(()=>
{Qb()},this.$.ya)}}E8b(Fb){this.Xa.hP=Fb}toggleEditingEvents(Fb){this.Xa.toggleEditingEvents(Fb)}bej(){this.Bw?this.rej():this.iIg()}Qsk(){H.a.e2a()?this.lCa.U5k(this.MRi()):(Bb.a.instance.L2(t.a.g6,rc.a.Yrb),Bb.a.instance.MZ(t.a.g6,rc.a.Yrb));Bb.a.instance.Pca(t.a.g6,rc.a.Yrb)}MRi(){return{Q0b:this.nameBox.text}}iIg(){c.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}u4f(Fb){return!this.sDe&&(125627505===Fb||706199415===Fb)}get text(){return super.text}static hIf(Fb){return document.getElementById(Fb.xi+
t.a.CYa)}static B7h(){const Fb=document.createElement("div");Fb.className=r.a.Gpi;Fb.classList.add(r.a.L0);return Fb}static q9h(Fb){const Qb=document.createElement("div");Qb.id=Fb+yb.cOj;Qb.className=r.a.bOj;Qb.classList.add(r.a.L0);return Qb}static ZAd(){const Fb=Ib.a.Zpb(),Qb=document.createElement(Fb?"div":"textarea");Qb.className=r.a.Ppi;H.a.N1f()&&Qb.classList.add(r.a.Rpi);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFluentStylingEnabled",!1)&&Qb.classList.add("ewa-fb-fluent-border-highlight");
Qb.classList.add(r.a.Qpi);Qb.classList.add(r.a.XLj);Fb?Qb.id=t.a.sRb:(Qb.cols=20,Qb.rows=2);return Qb}static H7h(Fb){const Qb=document.createElement("div");Qb.id=Fb+t.a.rRb;Qb.className=r.a.DDf;O.DOMElementExtensions.wL(Qb,t.a.KF);Qb.setAttribute(t.a.wD,"insert function");Qb.tabIndex=0;Qb.classList.add(r.a.L0);return Qb}static p9h(Fb){const Qb=document.createElement("div");Qb.id=Fb+yb.aPc;Qb.className=r.a.Ihg;O.DOMElementExtensions.wL(Qb,t.a.KF);Qb.setAttribute(t.a.wD,"commit edit");Qb.tabIndex=0;
Qb.classList.add(r.a.L0);return Qb}static a6h(Fb){const Qb=document.createElement("div");Qb.id=Fb+yb.erc;Qb.className=r.a.Lef;O.DOMElementExtensions.wL(Qb,t.a.KF);Qb.setAttribute(t.a.wD,"cancel edit");Qb.tabIndex=0;Qb.classList.add(r.a.L0);return Qb}static T8h(Fb){const Qb=document.createElement("div");Qb.id=Fb+t.a.ZCf;Qb.className=r.a.Mpi;return Qb}}yb.cOj="okCancelButtonContainer";yb.aPc="okboxButton";yb.erc="cancelboxButton";yb.axa=null;Object(y.a)(yb,"FormulaBar",f.a,[42])},1386:function(y,m,
a){a.d(m,"d",function(){return n});a.d(m,"c",function(){return v});a.d(m,"b",function(){return f});a.d(m,"a",function(){return w});var c=a(28),b=a(696),e=a(1387),k=a(132),d=a(145),u=a(676);const n=t=>255<t.length||!r(t)||c.a.mI(t,"_xl")?!1:!0,v=(t,l)=>{var x=l.ha;l=x.pa.Yn;x=x.pa.activeRange;return t.sa.la&&l?b.b(t.$h,x,t.sa.la.name):null},f=t=>{let l=null;t=t.ha.$a;t.isFloatingObjectSelected&&(l=t.Ih.floatingObject);return l},w=(t,l=!0)=>{const x=e.a.getInstance(t),A=x.aSi();A&&!t.$h.Pq(A)&&u.a(d.a.r_h,
[k.a.cfg],!0,!0,!1,!1,null);x.stop(l)},r=t=>{if(!t.length)return!1;for(let l=0;l<t.length;l++){const x=t.charAt(l),A=t.charCodeAt(l);if(!l){if("\\"!==x&&"_"!==x&&!c.a.isLetter(A))return!1}else if("_"!==x&&"."!==x&&!c.a.g1f(A)&&!c.a.isNumeral(A))return!1}return!0}},1387:function(y,m,a){y=a(0);var c=a(15);class b{constructor(e){this.start=k=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):(this.Mp.start(),
this.inProgress=!0,this.Xfg=k)};this.stop=(k=!0)=>{this.inProgress&&(this.Mp.stop(),k&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.Mp.Ci}}`),this.inProgress=!1,this.Xfg=void 0)};this.aSi=()=>this.Xfg;this.Mp=e.Eh.wm("UserAction","CreateNamedObjectTimer");this.inProgress=!1}}b.getInstance=e=>{void 0===b.instance&&(b.instance=new b(e));return b.instance};m.a=b;Object(y.a)(b,"NameBoxTelemetry",null,[])},1543:function(y,m,a){m=a(492);a=a(1544);a=a.$q?a.default:a;"string"===
typeof a&&(a=[[y.i,a,""]]);m(a,{insert:"head",au:!1});y.exports=a.cw||{}},1544:function(y,m,a){m=a(493)(!1);m.push([y.i,'.ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-presence-cover,.ewa-fb-text-box{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-monospace-experiment,.ewa-fb-text-box-new-theme{overflow:hidden;border:1px solid #e6e7e8;outline:0;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-presence-cover,.ewa-root-ltr .ewa-fb-text-box{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#107C41}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0!important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit!important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.skel-formula-bar .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{overflow-wrap:break-word}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000!important;border:1px solid #000!important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on .ewa-fb .okbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb .cancelbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor ::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130!important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886!important}.ewr-presentMode-transition .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition .functionbox.button-disabled,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb.ewa-fb-refactor.ewa-fb-fluent{height:24px;background-color:#F5F5F5;color:#444;overflow:hidden;padding:4px 8px;position:relative;margin:0;gap:8px;flex-flow:row}.ewa-fb-fluent .ewa-fb.drop-down{flex-flow:row;gap:8px;padding-left:0;padding-right:0}.ewa-fb-fluent .ewa-fb.drop-down .ok-cancel-buttons-container{display:flex;width:66px;border:1px solid #D1D1D1;border-radius:4px;flex-flow:row;top:0;margin:0}.ewa-fb-fluent .functionbox{display:flex;align-items:center;justify-content:center}.ewa-root-ltr .ewa-fb-fluent .functionbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-root-rtl .ewa-fb-fluent .functionbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-ltr .ewa-fb-fluent .cancelbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-rtl .ewa-fb-fluent .cancelbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-fb-fluent .cancelbox:hover,.ewa-fb-fluent .ewa-fb-expand-button-container:hover,.ewa-fb-fluent .functionbox:hover,.ewa-fb-fluent .okbox:hover{background-color:#F5F5F5}.ewa-fb-fluent .cancelbox:focus,.ewa-fb-fluent .ewa-fb-expand-button-container:focus,.ewa-fb-fluent .functionbox:focus,.ewa-fb-fluent .okbox:focus{background-color:#E0E0E0}.ewa-fb-fluent .cancelbox.button-disabled,.ewa-fb-fluent .functionbox.button-disabled,.ewa-fb-fluent .okbox.button-disabled{pointer-events:none;background-color:#FFF!important}.ewa-fb-fluent .cancelbox.button-disabled path,.ewa-fb-fluent .functionbox.button-disabled path,.ewa-fb-fluent .okbox.button-disabled path{fill:#BDBDBD}.ewa-fb-fluent .ewa-fb-text-div-container{display:flex;border-radius:4px;flex-flow:column}.ewa-fb-fluent .ewa-fb-expand-button-container{order:1;height:20px;width:20px;border-radius:4px;flex-grow:0;padding:0}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 4px 0 0}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 0 0 4px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new{border:1px solid #D1D1D1;border-radius:4px;top:0;line-height:16px;padding:3px 0 5px 0;color:#242424}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-rtl .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:12px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement>.ewa-rteLine{cursor:text}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:calc(100% - 4px);width:calc(100% - 22px);margin-top:2px;cursor:default}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:4px;background-color:grey;background-clip:padding-box}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 8px}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 14px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-fluent-border-highlight:focus-within{outline:0;border:1px solid #D1D1D1;border-bottom-style:none}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-fluent-border-highlight:focus-within::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:4px;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:3px solid #107c41;clip-path:inset(calc(100%-3px) 0 0)}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-disabled{border:1px solid #D1D1D1;border-radius:4px;background-color:#F5F5F5}.ewa-fb-fluent .cancelbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .functionbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .okbox.button-disabled.ewa-fb-disabled{background-color:#F5F5F5!important}.ewa-root-ltr .ewa-fb-rtl .ewa-rteLine{padding-right:20px!important}.ewa-fb-fluent-formula-highlight .ql-editor ::selection{background:#616161;color:#FFF}.skel-fb-namebox-wrapper{height:24px;width:124px;line-height:22px;padding:0 16px 0 0;border-color:#d1d1d1;position:relative;background-color:#fff;border-width:1px;border-style:solid;overflow:hidden;white-space:nowrap;box-sizing:border-box;border-radius:4px}.skel-fb-namebox-wrapper.skel-legacy-namebox{border-radius:0;line-height:16px;border-color:#e1dfdd;margin:4px}.skel-fb-namebox-button{position:absolute;border:none;padding:0;background-color:transparent;color:#797775;min-width:16px;right:-1px;display:flex;height:24px;justify-content:center;align-items:center}.skel-fb-namebox-rtl{left:-1px;right:auto}.skel-fb-namebox-icon{display:flex;width:12px;fill:#252423;align-items:center;justify-content:center}.skel-legacy-namebox .skel-fb-namebox-icon{font-size:12px;margin:0;height:8px;line-height:8px;text-align:center;flex-shrink:0;display:flex;width:8px;align-items:center}.skel-fb-namebox-disabled{background-color:#f5f5f5}.skel-fb-namebox-disabled .skel-fb-namebox-span{color:#c8c6c4}.skel-fb-namebox-disabled .skel-svg-disabled{fill:#939393}.skel-fb-namebox-disabled svg{opacity:.4}.skel-fb-namebox-span{color:#252423;float:left;margin-right:4px;margin-top:4px;line-height:16px;background-color:transparent;box-sizing:border-box;border-style:none;outline:0;overflow:hidden;text-overflow:ellipsis;font-size:12px;padding-left:4px}.skel-fb-namebox-span.skel-fb-namebox-v9{font-family:"Aptos Narrow","Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;font-size:11pt;line-height:15px}',
""]);y.exports=m},887:function(y,m,a){a.r(m);y={};a.r(y);a.d(y,"FormulaBarCommandHandler",function(){return Na});var c=a(127);m=a(0);a(215);var b=a(15),e=a(151),k=a(609),d=a(73),u=a(155),n=a(142),v=a(10),f=a(27),w=a(46),r=a(696),t=a(128),l=a(269),x;(function(ea){ea[ea.NONE=0]="NONE";ea[ea.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";ea[ea.PRINT_AREA=2]="PRINT_AREA";ea[ea.DISCONTINUOUS_RANGES=3]="DISCONTINUOUS_RANGES";ea[ea.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";ea[ea.INVALID_NAME=5]="INVALID_NAME";
ea[ea.EMPTY_RANGE=6]="EMPTY_RANGE";ea[ea.GENERIC_ERROR=7]="GENERIC_ERROR";ea[ea.VIEW_MODE=8]="VIEW_MODE"})(x||(x={}));Object(m.b)("NameBoxInvalidOperation",x);var A=a(36),z=a(28),F=a(12),D=a(132),G=a(145),Q=a(676),O=a(107);class J extends l.a{constructor(ea,Aa){super(ea,Aa);this.jw()}get Ji(){return"NameBoxErrorDialog"}jw(){super.jw();const ea=this.error.Caption,Aa=this.dMi(this.error),ub=this.cMi(this.error);this.Oh=0;this.gua(ub);this.So(ea,Aa,2,this.e3)}dMi(ea){return z.a.equals(ea.MessageIdName,
J.N3c,!0)?String.format(ea.Description):z.a.equals(ea.MessageIdName,J.aWb,!0)?"":ea.Description}cMi(ea){const Aa=[];z.a.equals(ea.MessageIdName,J.aWb,!0)&&(ea=String.format(F.a.instance.ia(2253)),Aa.push(...ea.split("-").map(ub=>ub.trim())));return Aa}static X1(ea,Aa=null){if(ea.MessageIdName===J.aWb)b.ULS.sendTraceTag(528053385,0,50,ea.Caption);else{let ub=ea.Caption;ea.MessageIdName===J.N3c&&(ub=`Unsupported Operation: ${x[Aa]}`);ea=new O.a;ea.ga("errorCaption",ub);Q.a(G.a.Hui,[D.a.cfg],!0,!0,!1,
!1,ea)}}static nj(ea){switch(ea){case 3:case 1:case 2:return A.a.nj(1,0,2254,2255,0,-1280789630,J.N3c);case 5:case 4:return A.a.nj(1,0,2252,2253,0,875859818,J.aWb);case 8:case 7:return A.a.nj(1,0,0,1,0,424201999,J.aWb);case 6:return A.a.nj(1,0,2256,2257,0,-1280789630,J.N3c);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}J.N3c="NameBoxUnsupportedOperation";J.aWb="NameBoxInvalidName";Object(m.a)(J,"NameBoxErrorDialog",l.a,[]);const H=
(ea,Aa,ub,rb,Ja,Xa,Y)=>{a:switch(Y){case 2:Y="Table";break a;case 3:Y=z.a.IPb(Aa,"Print_Area")?"Print Area":"Named Range";break a;default:Y="Unknown"}return{key:ea,name:Aa,sheetName:ub,topLeft:rb,bottomRight:Ja,location:Xa,type:Y}};var N=a(1386),L=a(1),Z=a(23),ba=a(156),K=a(1387);class E{constructor(ea,Aa){this.printArea="Print_Area";this.cxk="R";this.E_h="C";this.dKj="Value";this.$=ea;this.da=Z.f(this.$);this.oNa=Aa;this.eKj=K.a.getInstance(this.$)}s9j(){var ea=this.$.$h.items,Aa=this.$.la.name;
const ub={};for(var rb of ea){ea=r.a(rb.name);var Ja=ea.Sxb;if(d.h(rb)&&(!Ja||z.a.equals(ea.scope,Aa,!1))){var Xa=ea.name in ub;if(!Xa||Xa&&Ja)ub[ea.name]={["namedObjectDetails"]:ea,["namedObjectItem"]:rb}}}Aa=[];for(const Y in ub)ea=ub[Y],rb=ea.namedObjectItem,ea=ea.namedObjectDetails,Ja=`${rb.sheetName}!${rb.usedRange.topLeft.ME(!1)}:${rb.usedRange.bottomRight.ME(!1)}`,Xa=rb.type,Aa.push(H(rb.name,ea.name,rb.sheetName,rb.usedRange.topLeft.ME(!1),rb.usedRange.bottomRight.ME(!1),Ja,Xa));Aa.sort((Y,
Ia)=>Y.name.localeCompare(Ia.name));this.oNa.t9j(Aa);N.a(this.$,!1);this.gIg(Aa.length)}Y4i(ea){ea=r.a(ea[this.dKj].toString());const Aa=ea.name,ub=ea.scope.length?ea.scope:null;var rb=this.DXh(ea);this.WAk(ea)||(this.RAj(ea),0!==rb?(this.oNa.vrf(this.$,rb),this.qKg()):N.d(Aa)?(rb=w.t(Z.f(this.$).ha.pa.selectedRanges,this.$),this.oNa.U8h(this.$,Aa,rb,ub,E.qOj,E.pOj),this.eKj.start(ea.name)):(this.oNa.vrf(this.$,5),this.qKg()))}bJd(){this.oNa.bJd()}WAk(ea){const Aa=ea.fullName,ub=ea.name,rb=ea.scope;
let Ja,Xa,Y=!1;!({sheetName:Ja,range:Xa}=w.jb(Aa,this.$.sa)).returnValue||!Xa.EB&&L.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?z.a.equals(ub,this.cxk,!0)?(this.XAk(rb),this.q7a(2)):z.a.equals(ub,this.E_h,!0)?(this.OAk(rb),this.q7a(2)):this.$.$h.Pq(Aa)?(this.INg(Aa),this.q7a(ea.Sxb?1:0)):this.$.$h.Pq(ub)?(this.INg(ub),this.q7a(0)):Y=!0:(this.RAk(Ja,Xa),this.q7a(3));return!Y}RAk(ea,Aa){ea=ea||this.$.sa.la.name;var ub=r.b(this.$.$h,Aa,ea);r.c(ub)||(ub=
w.x(Aa,this.$),ub.SheetName=ea,Z.f(this.$).fp(ub,Aa.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.da.focus())}XAk(ea=null){const Aa=this.da.ha.pa.activeCell;this.wff(ea)&&(ea=new f.Range(Aa.top,0,Aa.bottom,v.a.Ak,!0,!1),this.da.ha.zL([ea],0,ea,0))}OAk(ea=null){const Aa=this.da.ha.pa.activeCell;this.wff(ea)&&(ea=new f.Range(0,Aa.left,v.a.Ok,Aa.right,!0,!1),this.da.ha.zL([ea],0,ea,0))}wff(ea){return ea?(ea=this.$.sa.getItemByName(ea),(null===ea||void 0===ea?0:ea.visible)?
(ea.activate({scenario:"namedObject"}),!0):!1):!0}INg(ea){ea=this.$.$h.getItemByName(ea);r.c(ea);this.da.focus()}DXh(ea){return this.$.isEditMode?this.rmj()?1:z.a.equals(ea.name,this.printArea,!0)?2:this.Ugi()?3:this.O$i(ea)?4:this.olj()?6:0:8}qKg(){var ea=N.b(this.da);null!=ea?this.oNa.swd("",ea.name):(ea=N.c(this.$,this.da))?this.oNa.swd(ea.name,ea.name):this.oNa.swd("",this.da.ha.pa.activeCell.toString())}rmj(){return!!this.da.ha.$a.activeFloatingObjectControlId}Ugi(){return 1<this.da.ha.pa.selectedRanges.length}O$i(ea){return ea.Sxb&&
!this.$.yV(ea.scope)}olj(){return this.da.oh.XLa(this.da.ha.pa.selectedRanges[0])}static qOj(ea){return Aa=>{A.a.ll(Aa.Errors)&&(J.X1(Aa.Errors[0]),new J(ea,Aa.Errors[0]),K.a.getInstance(ea).stop(!1))}}static pOj(ea){return Aa=>{(Aa=t.a.$j(Aa.data))&&0<Aa.length?(J.X1(Aa[0]),new J(ea,Aa[0])):(J.X1(J.nj(7)),new J(ea,J.nj(7)));K.a.getInstance(ea).stop(!1)}}RAj(ea){const Aa=null!=N.c(this.$,this.da);ea.Sxb?this.q7a(Aa?7:6):this.q7a(Aa?5:4)}q7a(ea){ba.b(this.$).sj(u.a.vYk,{type:ea.toString()},null,!0)}gIg(ea){ba.b(this.$).sj(u.a.Wwg,
{Tkl:ea},null,!0)}}Object(m.a)(E,"NameBoxCommandHandler",null,[]);var U=a(431),X=a(216),ia=a(64);const Ma=(ea,Aa,ub,rb,Ja,Xa,Y,Ia,$a,Ea,Lb=null)=>{Lb=ea.Za(9,Lb);Lb.name=Aa;Lb.selectedRanges=ub;Lb.sheetName=rb;Lb.formula=Ja;Lb.comment=Xa;return ia.h(ea,"AddDefinedName",Lb,Y,Ia,$a,Ea,0)};var qa=a(265),Ha=a(112),ha;(function(ea){ea[ea.EMPTY_RANGE=0]="EMPTY_RANGE";ea[ea.RANGE_CREATED=1]="RANGE_CREATED"})(ha||(ha={}));Object(m.b)("NameBoxStatusCalloutType",ha);class La{ohi(){this.Dnf();appChrome.renderNameBoxStatusCallout(La.$0c,
ha.EMPTY_RANGE)}vhi(ea,Aa){this.Dnf();const ub=Object(w.F)(Aa.Ranges[0]);appChrome.renderNameBoxStatusCallout(La.$0c,ha.RANGE_CREATED,ea,Aa.SheetName,`${ub.topLeft.toString()}:${ub.bottomRight.toString()}`)}Dnf(){null==La.$0c&&(La.$0c=document.createElement("div"))}t9j(ea){Ha.c()&&appChrome.populateNameBoxMenu(ea)}U8h(ea,Aa,ub,rb,Ja,Xa){const Y=()=>this.vhi(Aa,ub);U.a(ea.userOperationManager,(Ia,$a,Ea)=>Ma(ea.oa.ta,Aa,ub,rb,"","",qa.c(Ia,Ja(ea),L.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")?
Y:void 0),qa.b($a,Xa(ea)),Ea,ea),Ia=>new X.a(1020,0,Ia),null)}vrf(ea,Aa){J.X1(J.nj(Aa),Aa);8!==Aa&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")&&6===Aa?this.ohi():new J(ea,J.nj(Aa)))}bJd(){appChrome.updateNameBoxState({["focus"]:!0})}swd(ea,Aa){appChrome.setNamedObjectOrActiveCellRange(ea,Aa)}}La.$0c=null;Object(m.a)(La,"NamedObjectsService",null,[396]);var fa=a(212),ja=a(68),ta=a(7),Ka=a(5),Ga=a(92);let Na=class{constructor(ea,Aa){this.$=ea;this.da=Z.f(this.$);
this.Wa=Aa;this.F7d=new E(ea,new La)}Ri(){return!1}executeCommand(ea,Aa,ub){Aa=Aa.command;ea=null;switch(Aa){case 1726517890:this.F7d.Y4i(ub);break;case 2045896573:ub=n.a(this.$);(null===ub||void 0===ub?0:ub.UZa)?ub.UZa.qzf():b.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.F7d.bJd();break;case -1790328692:ub=n.a(this.$);Aa=!this.$.nXb;ub.isVisible=Aa;ub.Xa.isVisible=Aa;this.$.nXb=
Aa;this.$.Fm();try{e.a.HG(ta.a.b0f,Aa.toString(),k.AFrame.bDa)}catch(rb){b.ULS.sendTraceTag(509216780,0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${rb.message}`)}break;default:ea=fa.a(Aa)}return ea||ja.Task.Ua(!0)}Ei(ea,Aa,ub){ea=!1;switch(Aa.command){case 1726517890:ea=!!ub;break;case -1003645154:case 2045896573:ea=!0;break;case -1790328692:ea=L.EwaSettings.isChangeGateEnabled("OfficeVSO:8235335_DisplaySettings")}return ea}dj(ea,Aa){if("PopulateNameBoxMenu"!==Aa)return!1;
ea=this.$.Eh.Oi("UserAction","PopulateNameBoxMenuTimer");this.F7d.s9j();ea.stop();return!0}gIg(ea){ea={["NamedObjectsCount"]:ea};ba.b(this.$).sj(u.a.Wwg,ea,null,!0)}};Na=Object(c.__decorate)([Object(Ga.d)(Ka.Lc),Object(c.__param)(0,Object(Ka.Ob)()),Object(c.__param)(1,Object(Ka.xf)())],Na);Object(m.a)(Na,"FormulaBarCommandHandler",null,[36]);var cb=a(9);c=a(432);var jb=a(78),Sa=a(40),bb=a(1181),oa=a(44),ka=a(939),ya=a(25),Oa=a(91);class za extends c.a{constructor(ea){super();this.$=ea;this.sn()}create(){oa.a.instance.aDa(ta.a.g6);
const ea=jb.GetServiceTaskFactory.dk(this.$.qa,388,387,this.gi),Aa=ya.a.e2a()?Object(Oa.d)(Ga.a.resolve(Ka.fg)):ja.Task.Ua(null);Sa.TaskExtensions.$e(Sa.TaskExtensions.Dq([ea,Aa],this.ya),()=>{this.dl(Object(ka.a)(this.$.qa,172,()=>new bb.FormulaBar(this.$,Aa.result,ea.result)))},this.$.ya,3)}}Object(m.a)(za,"FormulaBarFactory",c.a,[]);(()=>{cb.a.hh(ea=>{L.EwaSettings.isChangeGateEnabled("OfficeVSO:8704628_importFBLessAsCoreCss")||a(1543);ea.qa.Rh(186,new za(ea))})})();String(y);window.___1712031311745_closurehack=
y}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/bcde9f21b1843132b0040599a61835a0/EwaTS.vrd.js.map