'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1086:function(y,m,a){a.d(m,"a",function(){return k});y=a(0);var c=a(15);class b{}Object(y.a)(b,"ExtraInfo",null,[]);class e{}Object(y.a)(e,"PerfOperation",null,[]);class k{constructor(d,u){this.kO=this.jt=null;this.Ww=d;this.Ir=u}get Wt(){return!!this.jt}get Ci(){return this.jt?(new Date).getTime()-this.jt.getTime():0}get id(){throw Error.notImplemented();}start(){this.jt=new Date;return this.kO=null}stop(){this.jt&&
c.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",{["Operation"]:this.Ww,["Target"]:this.Ir,["StartTime"]:this.jt.toUTCString(),["DurationInMilliseconds"]:this.Ci})}reset(){this.stop();this.kO=this.jt=null}Km(d){return!d||""===d}}Object(y.a)(k,"Stopwatch",null,[281,88])},1087:function(y,m,a){a.d(m,"a",function(){return f});y=a(0);var c=a(15);m=a(951);var b=a(608),e=a(6),k=a(17),d=a(129);class u{constructor(w,r,t,l){this.origin=w;this.data=r;this.source=t;this.La=void 0===l?null:l}}Object(y.a)(u,
"MessageEventArgs",null,[]);class n{constructor(w,r){this.Nea=null;this.c4b=t=>this.L_?this.L_(new u(t.origin,t.data,t.source,t.La)):!1;this.PHb=w;this.vk=r;this.L_=null}get f9(){return this.PHb.value}get QN(){return this.vk.value}rWa(w,r){this.L_=w;this.Nea=this.c4b;this.f9.addHandler(k.a.message,this.Nea,r)}NYa(){this.L_=null;this.f9.removeHandler(k.a.message,this.Nea)}yLa(w,r){const t=new d.a(0,1,1,()=>{w(r)},7);this.QN.lm(t)}cWb(w,r){const t=new d.a(0,1,1,()=>{w(r)},7);this.QN.lm(t)}static get instance(){return n.dxa()}static dxa(){return new n(new b.a(()=>
e.AFrameworkApplication.f9),new b.a(()=>e.AFrameworkApplication.Np))}}Object(y.a)(n,"MessageEventHandler",null,[408]);var v=a(974);class f extends m.a{constructor(w,r,t){super(w,r,(void 0===t?null:t)||n.instance,f.HVb)}static HVb(){v.a.sendTraceTag=f.d8b;v.a.debugAssertTag=f.qOb}static d8b(w,r,t,...l){c.ULS.sendTraceTag.apply(null,[w,204,f.INb(r),t].concat(l))}static qOb(){}static INb(w){switch(w){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}
f.z4b="wdPreviousSession";f.YNb="wdUserSession";Object(y.a)(f,"CommonCrossDocumentMessenger",m.a,[])},1110:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{}c.iEd="stid";c.gEd="iid";c.hEd="DynamicImageProvider.aspx";c.N2="RequestStartTime";c.isEwaJsSplitEnabled="IsEwaJsSplitEnabled";c.u2a="IsJsSelfProfilerOnBootEnabled";Object(y.a)(c,"WebServiceConstants",null,[])},1198:function(y,m,a){a.r(m);a.d(m,"RenderingFidelityTracker",function(){return f});y=a(127);m=a(0);var c=a(15),b=a(108),
e=a(80),k=a(13),d=a(432);class u extends d.a{constructor(w){super();this.$=w;this.sn()}create(){const {RenderingFidelityTracker:w}=a(1198);let r=this.$.qa.zh(462);r||(r=this.$.qa.Rh(462,new w));this.dl(r)}}Object(m.a)(u,"RenderingFidelityTrackerFactory",d.a,[]);var n=a(44);d=a(5);var v=a(92);let f=class extends e.a{constructor(){super();this.ZHj=3E4;this.Czb={};this.UCe={};this.obf={};b.Health.instance.addQosPillar("Fidelity")}static Ga(w){w.qa.Rh(463,new u(w))}U7e(w,r,t,l){if(!(n.a.instance.Kna()<
this.ZHj)){var x=k.HelperMethods.vN(()=>{var A=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(r),z=Object.keys(A),F=this.obf[w];for(var D=0;D<z.length;D++){var G=z[D];this.UCe[G]||(null===F||void 0===F?0:F[G])&&this.Czb[G]&&(this.Czb[G]-=F[G])}this.obf[w]=A;for(D=0;D<z.length;D++)if(F=z[D],!this.UCe[F])if(G=A[F],this.Czb[F]&&(G+=this.Czb[F]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(F,G)){this.UCe[F]=!0;A=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(F);
z=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(F);D=!("ThickBorder"===F||"MediumBorder"===F);A&&z&&D&&b.Health.instance.recordQosError(A,[z],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+F+", isHC:"+t+", scaleFactor:"+l+"}");break}else this.Czb[F]=G});1<x&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${x}`)}}};f=Object(y.__decorate)([Object(v.d)(d.uf)],
f);Object(m.a)(f,"RenderingFidelityTracker",e.a,[662,2])},1247:function(y,m,a){a.d(m,"a",function(){return b});y=a(0);var c=a(15);class b{static XXa(e){e=new Date(e);return c.ULS.ljf([b.Fzh(e.getUTCFullYear()),"-",b.Seb(e.getUTCMonth()+1),"-",b.Seb(e.getUTCDate()),"T",b.Seb(e.getUTCHours()),":",b.Seb(e.getUTCMinutes()),":",b.Seb(e.getUTCSeconds()),".",b.X3e(e.getUTCMilliseconds()),"Z"])}static Fzh(e){return 1E3>e?"0"+b.X3e(e):e.toString()}static X3e(e){return 100>e?"0"+b.Seb(e):e.toString()}static Seb(e){return 10>
e?"0"+e:e.toString()}}Object(y.a)(b,"UlsUtils",null,[])},368:function(y,m,a){function c(fb){switch(!0){case fb.fG:return N.MergedCell;case fb.jS:return N.Gch;case fb.LC:return N.Formula;case fb.hasAutoFilter:return N.AutoFilter;case fb.Una:return N.PivotFilter;case !!fb.DSc:return N.PivotTable;case fb.Vxa:return N.Comment;case fb.anb:return N.Sparkline;case fb.B0a:return N.InCellImage;case fb.hasRichText:return N.yfh;default:return""}}function b(fb){if(Na.get(fb))return Na.get(fb);var Va=fb.replace(/-.*/g,
()=>"");Va=Na.get(Va);return null!==Va&&void 0!==Va?Va:fb.startsWith("ooux")?"ooux":"other"}a.r(m);var e={};a.r(e);a.d(e,"DocumentVisibilityObserver",function(){return Q});var k={};a.r(k);a.d(k,"GridActionTelemetryManager",function(){return L});var d={};a.r(d);a.d(d,"EwaHostMessenger",function(){return ja});var u={};a.r(u);a.d(u,"InteractivityTrackerService",function(){return bb});var n={};a.r(n);a.d(n,"PageLoadEngagementInfo",function(){return Y});var v={};a.r(v);a.d(v,"ServiceWorkerRegistrationManager",
function(){return Ib});var f={};a.r(f);a.d(f,"ValidationTelemetryManager",function(){return xc});var w={};a.r(w);a.d(w,"VirtualGetRangeTelemetryManager",function(){return Uc});var r=a(127),t=a(0),l=a(95),x=a(41),A=a(134),z=a(33),F=a(160),D=a(5),G=a(92);let Q=class extends x.a{constructor(){super();this.eU=!1;this.VRe=this.URe=null;this.A$d=()=>{this.p7g()};this.Rae=()=>{l.a.gh(this.jaa);l.a.gh(this.du)};this.jaa=F.a.instance.dYa();this.du=F.a.instance.KU();this.jaa.Ga("visibilitychange",this.A$d);
this.du.Ga("pagehide",this.Rae);this.p7g()}get Xn(){return this.eU}get G6f(){return this.URe}get rLc(){return this.VRe}Zea(fb){this.addHandler("ekdh",fb)}Gvb(fb){this.removeHandler("ekdh",fb)}y4(fb){this.addHandler("ekduh",fb)}jPa(fb){this.removeHandler("ekduh",fb)}iN(fb){return this.Xn?!0:this.rLc?A.getElapsedMilliseconds(this.rLc,z.a.kh.vi)<fb:!1}dispose(){l.a.gh(this.jaa);l.a.gh(this.du);super.dispose()}p7g(){this.eU="hidden"===window.document.visibilityState;this.Xn?(this.raiseEvent("ekdh"),this.URe=
z.a.kh.vi):(this.raiseEvent("ekduh"),this.VRe=z.a.kh.vi)}};Q=Object(r.__decorate)([Object(G.d)(D.Db)],Q);Object(t.a)(Q,"DocumentVisibilityObserver",x.a,[227,2]);var O=a(15),J=a(1),H=a(23);const N={MergedCell:"MergedCell",Gch:"ConditionalFormat",Comment:"Comment",Formula:"Formula",AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",PivotTable:"PivotTable",Sparkline:"Sparkline",InCellImage:"InCellImage",yfh:"RichText"};let L=class{constructor(fb){this.Xi=()=>{const Va=JSON.stringify(this.mif),bd=JSON.stringify(this.lif);
O.ULS.sendTraceTag(508929763,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${Va}}`);O.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${bd}}`)};this.$=fb;this.mif=[];this.lif=[];J.EwaSettings.sXb()&&this.$.Pp(this.Xi)}dispose(){this.$=null}u4e(fb,Va){this.mif.push({commandName:Va,rowColCount:fb.toString()})}Pod(fb,Va){if(fb&&0!==fb.length){var bd=[];const je={};for(const se of fb)se.ejj()&&(fb=c(se),
""!==fb&&(je[fb]=je[fb]?je[fb]+1:1));for(const se of Object.keys(je))bd.push({cellType:se,count:je[se]});0!==bd.length&&this.lif.push({commandName:Va,complexCellTypes:bd})}}v3e(fb,Va,bd,je,se){const Xe=H.f(this.$);var wf=J.EwaSettings.n2a()?J.EwaSettings.vne():J.EwaSettings.i6d(),Nf=Xe.za.DAc(1554436520===se||1051390410===se?wf:0,674605324===se||-706918724===se?wf:0);se=[];wf=!1;"UnhideColumn"!==fb&&"UnhideRow"!==fb&&"insertColumns"!==fb&&"insertRows"!==fb||(wf=!0);for(const Lg of Nf){{Nf=Lg.zj;var fg=
je,Of=bd,Bg=Va,uf=wf;let zg=null;if(fg&&Nf||!J.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))uf?Nf.$i(fg)&&(zg=Nf,Bg?zg.top=zg.bottom-Of+1:zg.left=zg.right-Of+1):Nf.$i(fg)||(zg=Nf,Bg?zg.bottom=zg.top+Of-1:zg.right=zg.left+Of-1);Nf=zg}Nf&&(Nf=Xe.za.nY(Nf))&&(se=[...se,...Nf])}this.Pod(se,fb+"Cascade")}};L=Object(r.__decorate)([Object(G.d)(D.bd),Object(r.__param)(0,Object(D.Ob)())],L);Object(t.a)(L,"GridActionTelemetryManager",null,[669,2]);var Z=a(1087),ba=a(6),
K=a(224),E=a(116),U=a(135),X=a(397),ia=a(237),Ma=a(268),qa=a(66),Ha=a(84),ha=a(28),La=a(164),fa=a(951);Object(G.b)(D.pd,{rk:"singleton"})(fb=>xo(function*(){const Va=yield G.a.resolve(D.Ob,fb),bd=window.parent,je=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?Va.ua.DocumentHostInfo.PostMessageOrigin||fa.a.iM:ba.AFrameworkApplication.WSc||fa.a.iM,se=ba.AFrameworkApplication.ea.ka("HostSendReadyToAcceptPostMessage");K.a.instance.register(ja,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Ai().Ii(()=>
new ja(Va,bd,je,se));return K.a.instance.resolve("Postmessage.IHostPostmessenger")}));class ja extends Z.a{constructor(fb,Va,bd){super(Va,bd);this.eh=new E.a;this.T9i=je=>{if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const se=je.Values.m_Origin;ba.AFrameworkApplication.wopiHostOriginFromPostMessage||(ba.AFrameworkApplication.wopiHostOriginFromPostMessage=se)}switch(je.MessageId){case U.a.iTd:La.a(this.$).MQf(je);break;case U.a.C3d:Ma.a.ltas(null);break;case U.a.rFc:this.yWj();
break;case U.a.mTd:this.xWj(je)}};this.$=fb;bd!==fa.a.iM&&this.xX(bd);this.uej();this.zdj();fb=this.T9i;this.pq(U.a.iTd,fb);this.pq(U.a.C3d,fb);this.pq(U.a.rFc,fb);this.pq(U.a.mTd,fb)}dispose(){this.$=null;super.dispose()}uej(){this.kr(U.a.Pdf);this.kr(U.a.iTd);this.kr(U.a.rFc);this.kr(U.a.mTd);this.AVa(U.a.C3d);this.kr(U.a.lTd)}zdj(){this.wX("App_EwrWorkbookNotSupportedCancelResponse");this.wX(U.a.jGa);this.wX(U.a.E5);this.wX("App_CloseTab");this.wX(U.a.nab);this.wX(U.a.oab);this.wX(U.a.YTf);this.wX(U.a.nFc);
this.wX("App_ModifyURLState")}yWj(){const fb={};fb.hostMessageReceived=(new Date).getTime();O.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");ba.AFrameworkApplication.oKc=!0;fb.appUnloadStart=(new Date).getTime();fb.sendBeaconFlight=ba.AFrameworkApplication.ea.ka("SendBeaconOnShuttingDownRequestsEnabled");fb.sendBeaconSupported=qa.a.KBa();qa.a.L8e();fb.appUnloadEnd=(new Date).getTime();fb.appMessageSent=(new Date).getTime();this.sendMessage(U.a.UIh,fb)}xWj(fb){O.ULS.sendTraceTag(537162882,
0,50,"EwaHostMessenger.OnHostSwitchMode");fb.Values&&X.a.j8d in fb.Values&&ha.a.equals(fb.Values[X.a.j8d],ia.a.edit,!0)&&!this.$.isEditMode&&(O.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${fb.Values[X.a.j8d]}`),fb=new Ha.a(-8805455,0,1,0,null),this.$.Ia.qh(fb))}}Object(t.a)(ja,"EwaHostMessenger",Z.a,[668,441,2]);var ta=a(17),Ka=a(44);const Ga="context-menu floatie task-pane context-menu-auto-filter context-menu-auto-filter-items dialog".split(" "),Na=new Map;
[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])},{name:"scroll_animation",actions:new Set(["viewport_scroll"])},{name:"zoom_animation",actions:new Set(["viewport_zoom"])},{name:"drag_animation",actions:new Set("drag_range_insert drag_range_replace drag_table_row_rearrange drag_table_column_rearrange drag_row_insert drag_row_replace drag_column_insert drag_column_replace drag_pivot_replace drag_pivot_row_rearrange drag_pivot_column_rearrange".split(" "))},{name:"async_ui",actions:new Set(Ga)},{name:"freeze_pane_drag_animation",
actions:new Set(["freeze_pane_header_drag_vertical","freeze_pane_header_drag_horizontal","freeze_pane_line_drag_vertical","freeze_pane_line_drag_horizontal"])}].forEach(fb=>{fb.actions.forEach(Va=>{Na.set(Va,fb.name)})});class cb{constructor(fb){this.$=fb}getAppState(){const fb=Ka.a.instance.Kna();return-1===fb?"boot":3E4>fb?"postboot":"steady"}isChangeGateEnabled(fb){return J.EwaSettings.isChangeGateEnabled(fb)}getBooleanFeatureGate(fb,Va){return J.EwaSettings.getBooleanFeatureGate(fb,Va)}getCurrentAppInfo(){return{appState:this.getAppState(),
appInfoProperties:[{key:"coauthCount",value:this.$.fa.pu.length.toString()}]}}sendBeaconTraceTag(fb,Va,bd,je){this.$.sendBeaconTraceTag(fb,Va,bd,je)}getActionBucket(fb){return b(fb)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.fa.YGj}`}logSlowActionsHandler(){return""}logAsyncActionHandler(){return""}}Object(t.a)(cb,"InteractivityTrackerCallbacks",null,[]);var jb=a(323);const Sa=(fb,Va)=>xo(function*(){return Object(jb.b)("interactivity",Va)});Object(G.b)(D.Gd,{rk:"singleton"})(fb=>
xo(function*(){const Va=yield G.a.resolve(D.Ob,fb);yield Sa(Va,fb);const bd=interactivity.InteractivityTrackerFactoryGlobal.create();return new bb(Va,bd)}));class bb{constructor(fb,Va){this.yA=void 0===Va?null:Va;bb.HIc?O.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(fb),bb.HIc=!0)}initialize(fb){O.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");this.yA?(J.EwaSettings.v0d()&&
bb.E1c.push(ta.a.ava),bb.E1c.push("mouseup"),bb.E1c.push("touchstart"),fb={events:bb.E1c,durationThresholdInMs:bb.durationThresholdInMs,callbacks:new cb(fb),allowAsyncUIContextReporting:J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AllowAsyncUIContextReporting",!1)},J.EwaSettings.isChangeGateEnabled("OfficeVSO:8843901_TrackAsyncUI")&&(fb.asyncUiTracking={slowUiEventThresholdMs:J.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowUIEventThresholdMs",500),asyncUiEventTimeoutMs:J.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AsyncUIEventTimeoutMs",
3E4),allowedAsyncUiNames:[...Ga],slowActionTimeoutOverrides:[]}),fb.periodicReportIntervalMs=6E4,fb.animationTracking={chunkDurationMs:100,minFramesPerChunk:3,animationTimeoutMs:5E3},fb=this.yA.start(fb),fb.started?O.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):O.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+fb.failureReason)):O.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}iz(fb,
Va,bd,je){if(this.yA)return this.yA.trackInteraction(fb,Va,bd,je);O.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Va}`)}Anf(){return this.yA?this.yA.createActionsRetriever():(O.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.yA&&(this.yA.stop(),this.yA=null)}addContext(fb,Va,bd){this.yA?this.yA.addContext(fb,
Va,bd):O.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}startTrackAnimation(fb,Va){return this.yA?bb.HIc?this.yA.startTrackAnimation(fb,Va):(O.ULS.sendTraceTag(507847813,0,50,"InteractivityTrackerService.startTrackAnimation: trying startTrackAnimation but interactivityTrackerService instance was no created."),!1):(O.ULS.sendTraceTag(508343192,0,50,"InteractivityTrackerService.startTrackAnimation: interactivityTracker not initialized."),
!1)}stopTrackAnimation(fb,Va){this.yA?J.EwaSettings.isChangeGateEnabled("OfficeVSO:8500180_checkIfInteractivityServiceExistsBeforeStartTracking")&&!bb.HIc?O.ULS.sendTraceTag(507847812,0,50,"InteractivityTrackerService.startTrackAnimation: trying stopTrackAnimation but interactivityTrackerService instance was no created."):this.yA.stopTrackAnimation(fb,Va):O.ULS.sendTraceTag(508343191,0,50,"InteractivityTrackerService.endTrackAnimation: interactivityTracker not initialized.")}}bb.durationThresholdInMs=
100;bb.E1c="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");bb.HIc=!1;Object(t.a)(bb,"InteractivityTrackerService",null,[145]);var oa=a(2),ka=a(155),ya=a(58),Oa=a(54);class za{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(t.a)(za,"ActionData",null,[]);class ea{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(t.a)(ea,"BlockedEngagementInfo",null,[]);class Aa extends za{constructor(){super();this.inputMethod=
null;this.isCommand=!1}}Object(t.a)(Aa,"SuccessfulActionData",za,[]);class ub{constructor(){this.successfulActions=[]}}Object(t.a)(ub,"SuccessfulEngagementInfo",null,[]);var rb=a(43),Ja=a(47),Xa;let Y=Xa=class{constructor(fb){this.IZa=new Set;this.U$b=null;this.DBf=this.x_g=!1;this.otb=(Va,bd)=>{this.DKb.hasBlockedActions=!0;Va=this.DKb.blockedActions.length;const je=bd.details?bd.actionName+"_"+bd.details:bd.actionName;bd=Object(oa.a)(new za,{order:Va+1,name:je,componentName:bd.componentName,timeFromNavigationStart:bd.timeFromNavigationStart});
this.DKb.blockedActions.push(bd)};this.Lm=()=>{rb.a(this.$).g6b(this.otb);this.yAj();this.U$b=ya.a.instance.create(()=>{this.z_b()},Xa.KYk,Oa.a.z_b)};this.Xi=()=>{this.z_b()};this.Ige=()=>{this.$.oi(2009315810,-1,0,null);this.jte=!1};this.DKb=new ea;this.DKb.hasBlockedActions=!1;this.Syb=new ub;this.Fwi();this.$=fb;J.EwaSettings.ul()?this.$.fa.lr(this.Lm):this.$.fa.mr(this.Lm);this.$.Pp(this.Xi);this.NYk=0;this.jte=!1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&
(this.Hkf=new Promise(Va=>{this.m4h=Va}));rb.a(this.$).Onc(this.otb)}dispose(){this.$.fa&&!J.EwaSettings.ul()&&this.$.fa.av(this.Lm);this.$.wu(this.Xi);l.a.gh(this.U$b);this.$=this.U$b=null}kik(fb,Va,bd){if(void 0!==fb&&null!==fb&&Va){var je=this.Syb.successfulActions.length+1,se="InputMethod"in Va?Va.InputMethod:"",Xe="IsCommand"in Va&&Va.IsCommand;if(this.kuj(fb,Va,se,Xe)){++this.NYk===Xa.$cl?(this.jte=!0,this.A7j=ya.a.instance.create(this.Ige,5E3,Oa.a.Ige)):this.jte&&this.A7j.PA();if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const wf=
!Xe&&fb;this.DBf||wf===ka.a.J$g||wf===ka.a.K$g||wf===ka.a.E$g||wf===ka.a.F$g||(this.DBf=!0,this.m4h(void 0))}je>Xa.Zcg||(fb=Object(oa.a)(new Aa,{order:je,name:fb,componentName:"Location"in Va?Va.Location:"",timeFromNavigationStart:bd,inputMethod:se,isCommand:Xe}),this.Syb.successfulActions.push(fb),1===je?this.uBj():je===Xa.Zcg&&this.z_b())}}}yAj(){O.ULS.sendTraceTag(254546634,0,50,`${Ja.c(this.DKb)}`)}uBj(){Ka.a.instance.Kna()>Xa.Uwi?O.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${Ja.c(this.Syb.successfulActions[0])}`):
O.ULS.sendTraceTag(254563592,0,50,`${Ja.c(this.Syb.successfulActions[0])}`)}z_b(){!this.x_g&&this.Syb.successfulActions.length&&(this.x_g=!0,l.a.gh(this.U$b),this.U$b=null,this.$.sendBeaconTraceTag(254559496,50,!1,Ja.c(this.Syb)))}Fwi(){this.IZa.add(ka.a.mod);this.IZa.add(ka.a.Xoe);this.IZa.add(ka.a.Tee);this.IZa.add(ka.a.Sxg);this.IZa.add(ka.a.Uxg);this.IZa.add(ka.a.Wxg)}kuj(fb,Va,bd,je){bd=!bd||"unknown"===bd;const se="IsSystemInitiated"in Va&&Va.IsSystemInitiated;Va="NoReporting"in Va&&Va.NoReporting;
const Xe=this.IZa.has(fb);fb=ha.a.equals(fb,ka.a.mYc,!0)&&bd;return!se&&!Va&&!Xe&&!fb&&!(je&&bd)}};Y.Zcg=10;Y.Uwi=6E4;Y.KYk=12E4;Y.$cl=25;Y=Xa=Object(r.__decorate)([Object(G.d)(D.xe),Object(r.__param)(0,Object(D.Ob)())],Y);Object(t.a)(Y,"PageLoadEngagementInfo",null,[]);var Ia=a(1198),$a=a(10),Ea=a(37),Lb;let Ib=Lb=class{constructor(){this.Q5i=()=>{const fb=this;return xo(function*(){J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseServiceWorker",!1)?yield fb.register():yield fb.unregister()})};
this.init().then(()=>{O.ULS.sendTraceTag(507654145,0,50,"ServiceWorkerRegistrationManager.init: Initialization complete")}).catch(fb=>{O.ULS.sendTraceTag(507654144,0,15,`ServiceWorkerRegistrationManager.init: Initialization failed: ${fb}`)})}init(){const fb=this;return xo(function*(){Ea.a.gPh&&navigator.serviceWorker.getRegistrations?(Ka.a.instance.Sm("ServiceWorkerSupported"),navigator.serviceWorker.controller&&Ka.a.instance.Sm("ServiceWorkerControlled"),yield fb.Q5i(),fb.HNh()):Ka.a.instance.Sm("ServiceWorkerNotSupported")})}register(){return xo(function*(){try{const fb=
yield navigator.serviceWorker.register(`${$a.a.oDk}`);O.ULS.sendTraceTag(507795410,0,15,`ServiceWorkerRegistrationManager.register: Registration succeeded. workerState = ${fb.active?"active":fb.waiting?"waiting":fb.installing?"installing":"none"}, scope = ${fb.scope}`)}catch(fb){O.ULS.sendTraceTag(507795409,0,15,`ServiceWorkerRegistrationManager.register: call to serviceWorker.register failed: ${fb}`)}})}unregister(){return xo(function*(){try{const fb=yield navigator.serviceWorker.getRegistrations();
for(const Va of fb)(yield Va.unregister())?O.ULS.sendTraceTag(507795408,0,15,"ServiceWorkerRegistrationManager.unregister: Unregistration succeeded"):O.ULS.sendTraceTag(507795407,0,10,"ServiceWorkerRegistrationManager.unregister: Unregistration failed")}catch(fb){O.ULS.sendTraceTag(507795406,0,50,`ServiceWorkerRegistrationManager.unregister: call to serviceWorker.unregister failed: ${fb}`)}})}static f6i(fb){try{const Va=Date.now(),bd=JSON.parse(fb.data).serviceWorkerTime;O.ULS.sendTraceTag(507606657,
0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: delta between sending message from SW to processing message in main thread: ${Va-bd}`)}catch(Va){O.ULS.sendTraceTag(507606656,0,10,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: failed: ${Va}`)}}static g6i(fb){J.EwaSettings.isChangeGateEnabled("OfficeVSO:8617694_HandleServiceWorkerHeartbeat")&&fb.data.includes("heartbeat")?Lb.f6i(fb):O.ULS.sendTraceTag(507795405,0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerMessage: ${fb.data}`)}HNh(){navigator.serviceWorker.addEventListener("message",
Lb.g6i)}};Ib=Lb=Object(r.__decorate)([Object(G.d)(D.If)],Ib);Object(t.a)(Ib,"ServiceWorkerRegistrationManager",null,[]);var Mb=a(215),mc=a(213),jc=a(102);class Fc{constructor(fb,Va,bd){this.ffl=fb;this.X5=Va;this.name=bd}}Object(t.a)(Fc,"Validation",null,[]);var Gc;let xc=Gc=class{constructor(fb){this.zsb=()=>{this.Svg(this.TBf)};this.mq=()=>{this.Svg(this.QNh)};this.$=fb;this.QNh=new Mb.a;this.TBf=new Mb.a;H.f(this.$).za.qy(this.mq);H.f(this.$).za.a5e(this.zsb)}$od(fb,Va,bd,je,se){if(fb&&je){const Xe=
mc.a.mH(Va,bd);this.Vmc(()=>!!jc.a(fb).Xx(Xe),je.StateId,se)}}Vmc(fb,Va,bd){this.QBh(this.TBf,fb,Va,bd)}QBh(fb,Va,bd,je){fb&&Va&&bd!==$a.a.Ek&&fb.add(new Fc(Va,bd,je))}Svg(fb){if(fb){var Va=new Mb.a;for(const bd of fb){if(bd.X5===this.$.fa.yk)try{bd.ffl()||O.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${bd.name}]`)}catch(je){O.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${bd.name}]. Exception: [${je}]`)}Va.add(bd)}for(const bd of Va)fb.remove(bd)}else O.ULS.shipAssertTag(537151011,
0,!!fb,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){H.f(this.$)&&H.f(this.$).za&&(H.f(this.$).za.Ax(this.mq),H.f(this.$).za.Gje(this.zsb));this.$=null}static Ga(fb){const Va=new Gc(fb);fb.qa.Rh(277,Va)}};xc=Gc=Object(r.__decorate)([Object(G.d)(D.Pg),Object(r.__param)(0,Object(D.Ob)())],xc);Object(t.a)(xc,"ValidationTelemetryManager",null,[659,2]);let Uc=class{constructor(fb){this.n6a=void 0;this.Hcg=()=>{this.e$g(!0)};this.Gcg=()=>{this.e$g(!1)};this.j2=
(Va,bd)=>{bd.C9d!==$a.a.Ek&&(this.n6a=bd.nLj===$a.a.Ek?this.$.fa.UC:bd.C9d)};this.Y0c=new Map;fb.fa.mK(this.j2);this.da=H.f(fb);this.$=fb}Fcg(fb){this.Y0c.set(this.$.fa.UC,fb);this.xzh()}e$g(fb){if(void 0!==this.n6a&&this.Y0c.has(this.n6a)){const Va=this.Y0c.get(this.n6a);this.wCj(Va,this.n6a,fb);this.Y0c.delete(this.n6a)}else this.vCj(this.n6a);this.umk()}wCj(fb,Va,bd){O.ULS.sendTraceTag(507623310,1,20,`VirtualGetRangeTelemetryManager.logPrefetchResult. PrefetchResult is ${bd} for the operation with the details OpName ${fb} and stateId ${Va}`)}vCj(fb){O.ULS.sendTraceTag(507623309,
1,20,`VirtualGetRangeTelemetryManager.logPrefetchErrorForStateId. currentStateID ${fb} is not present in StateIdToOperationData`)}xzh(){this.da.gq.lGh(this.Hcg);this.da.gq.kGh(this.Gcg)}umk(){this.da.gq.Zqk(this.Hcg);this.da.gq.Yqk(this.Gcg)}};Uc=Object(r.__decorate)([Object(G.d)(D.Vg),Object(r.__param)(0,Object(D.Ob)())],Uc);Object(t.a)(Uc,"VirtualGetRangeTelemetryManager",null,[667]);class Pa{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=
this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(t.a)(Pa,"BrowserInfo",
null,[]);class Bb{constructor(){this.Version=this.Name=null}}Object(t.a)(Bb,"PluginInfo",null,[]);class Nb{static GBj(){if(ba.AFrameworkApplication.ea.ka("LogBrowserInfoIsEnabled")){var fb=Nb.fCi();try{const Va=JSON.stringify(fb);O.ULS.sendTraceTag(6903563,102,50,Va)}catch(Va){O.ULS.sendTraceTag(6903564,102,15,Va.message)}}else O.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static WTi(){const fb=window.navigator.plugins;if(!fb||!fb.length)return null;const Va=[];
for(let bd=0;bd<fb.length;bd++){const je=fb[bd].name,se=fb[bd].version;Array.add(Va,Object.assign(new Bb,{Name:je,Version:se}))}return Va}static fCi(){const fb=new Pa,Va=new Sys.StringBuilder;Nb.IC(bd=>{fb.DocElemClientHeight=bd},()=>document.documentElement.clientHeight,Va);Nb.IC(bd=>{fb.DocElemClientWidth=bd},()=>document.documentElement.clientWidth,Va);Nb.IC(bd=>{fb.DocElemOffsetHeight=bd},()=>document.documentElement.offsetHeight,Va);Nb.IC(bd=>{fb.DocElemOffsetWidth=bd},()=>document.documentElement.offsetWidth,
Va);Nb.IC(bd=>{fb.ScreenAvailHeight=bd},()=>window.screen.availHeight,Va);Nb.IC(bd=>{fb.ScreenAvailWidth=bd},()=>window.screen.availWidth,Va);Nb.IC(bd=>{fb.ScreenWidth=bd},()=>window.screen.width,Va);Nb.IC(bd=>{fb.ScreenHeight=bd},()=>window.screen.height,Va);Nb.IC(bd=>{fb.ScreenLogicalXdpi=bd},()=>window.screen.logicalXDPI,Va);Nb.IC(bd=>{fb.ScreenLogicalYdpi=bd},()=>window.screen.logicalYDPI,Va);Nb.IC(bd=>{fb.ScreenDeviceXdpi=bd},()=>window.screen.deviceXDPI,Va);Nb.IC(bd=>{fb.ScreenDeviceYdpi=bd},
()=>window.screen.deviceYDPI,Va);Nb.IC(bd=>{fb.WinInnerHeight=bd},()=>window.self.innerHeight,Va);Nb.IC(bd=>{fb.WinInnerWidth=bd},()=>window.self.innerWidth,Va);Nb.IC(bd=>{fb.WinOuterHeight=bd},()=>window.self.outerHeight,Va);Nb.IC(bd=>{fb.WinOuterWidth=bd},()=>window.self.outerWidth,Va);Nb.IC(bd=>{fb.WinOrientation=bd},()=>window.self.orientation,Va);Nb.IC(bd=>{fb.WinDevicePixelRatio=bd},()=>window.self.devicePixelRatio,Va);Nb.IC(bd=>{fb.SupportsTouch=bd},()=>Ea.a.H1c,Va);Nb.IC(bd=>{fb.NavAppName=
bd},()=>window.navigator.appName,Va);Nb.IC(bd=>{fb.NavAppVersion=bd},()=>window.navigator.appVersion,Va);Nb.IC(bd=>{fb.NavLanguage=bd},()=>window.navigator.browserLanguage||window.navigator.language,Va);Nb.IC(bd=>{fb.NavUserAgent=bd},()=>window.navigator.userAgent,Va);Nb.IC(bd=>{fb.NavPlatform=bd},()=>window.navigator.platform,Va);ba.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipLoggingPluginsEnabled",!1)||Nb.IC(bd=>{fb.NavPlugins=bd},Nb.WTi,Va);Nb.IC(bd=>{fb.CalculatedDevicePixelRatio=
bd},()=>Nb.devicePixelRatio,Va);fb.Error=Va.toString();return fb}static get devicePixelRatio(){const fb=window.devicePixelRatio;return isNaN(fb)?window.screen.deviceXDPI/window.screen.logicalXDPI:fb}static IC(fb,Va,bd){try{const je=Va();fb(je)}catch(je){bd.isEmpty()||bd.append(" | "),bd.append(je.message||"null")}}}Object(t.a)(Nb,"BrowserInfoLogger",null,[]);var oc=a(283);class aa{get name(){return"Common.App.BrowserInfoLogger"}co(){}init(){Nb.GBj()}dispose(){}static main(){oc.a.instance.Jo(new aa)}}
Object(t.a)(aa,"BrowserInfoLoggerPackage",null,[13,14]);var rc=a(549),yb=a(29);const Fb=Object(yb.c)(rc.b);var Qb=a(79);class ac{constructor(fb){this.p8c=fb}QZf(fb){if(!this.p8c)return!0;fb=Qb.a.gNd(fb);if(!fb)return!1;fb=fb.toLowerCase();for(let Va=0;Va<this.p8c.length;Va++)if(fb.endsWith(this.p8c[Va]))return!0;return!1}}Object(t.a)(ac,"DomainAllowListManager",null,[]);class Wa{constructor(fb,Va){this.u5=null;this.tmd=fb;this.url=Va}get ZBe(){return Qb.a.Lca(this.url)}get Yz(){return this.tmd}Cye(){const fb=
{},Va=this.Yz;fb.a=this.ZBe;fb.b=this.round(Va.navigationStart);fb.c=this.round(Va.unloadEventStart);fb.d=this.round(Va.unloadEventEnd);fb.e=this.round(Va.redirectStart);fb.f=this.round(Va.redirectEnd);fb.g=this.round(Va.fetchStart);fb.h=this.round(Va.domainLookupStart);fb.i=this.round(Va.domainLookupEnd);fb.j=this.round(Va.connectStart);fb.k=this.round(Va.connectEnd);fb.l=void 0!==Va.secureConnectionStart&&null!==Va.secureConnectionStart?this.round(Va.secureConnectionStart):0;fb.m=this.round(Va.requestStart);
fb.n=this.round(Va.responseStart);fb.o=this.round(Va.responseEnd);fb.q=this.round(Va.domInteractive);fb.r=this.round(Va.domContentLoadedEventStart);fb.s=this.round(Va.domContentLoadedEventEnd);fb.t=this.round(Va.domComplete);fb.u=this.round(Va.loadEventStart);fb.v=this.round(Va.loadEventEnd);fb.w=this.u5;return fb}round(fb){return Math.round(1E3*fb)/1E3}}Object(t.a)(Wa,"PerformanceTimingEntry",null,[]);const Gb=(fb,Va)=>{var bd,je;const se={};let Xe=null;switch(fb){case 0:Xe="ResourceTiming";fb=Va.a;
null!=fb&&(se.Url=fb);fb=Va.b;null!=fb&&(se.InitiatorType=fb);fb=null==Va.c?null:Va.c.toString();null!=fb&&(se.RedirectStart=fb);fb=null==Va.d?null:Va.d.toString();null!=fb&&(se.RedirectEnd=fb);fb=null==Va.e?null:Va.e.toString();null!=fb&&(se.FetchStart=fb);fb=null==Va.f?null:Va.f.toString();null!=fb&&(se.DomainLookupStart=fb);fb=null==Va.g?null:Va.g.toString();null!=fb&&(se.DomainLookupEnd=fb);fb=null==Va.h?null:Va.h.toString();null!=fb&&(se.ConnectStart=fb);fb=null==Va.i?null:Va.i.toString();null!=
fb&&(se.ConnectEnd=fb);fb=null==Va.j?null:Va.j.toString();null!=fb&&(se.SecureConnectionStart=fb);fb=null==Va.k?null:Va.k.toString();null!=fb&&(se.RequestStart=fb);fb=null==Va.l?null:Va.l.toString();null!=fb&&(se.ResponseStart=fb);fb=null==Va.m?null:Va.m.toString();null!=fb&&(se.ResponseEnd=fb);fb=Va.n;null!=fb&&(se.CustomText=fb);fb=null==Va.o?null:Va.o.toString();null!=fb&&(se.DecodedBodySize=fb);fb=null==Va.p?null:Va.p.toString();null!=fb&&(se.EncodedBodySize=fb);fb=null==Va.q?null:Va.q.toString();
null!=fb&&(se.TransferSize=fb);Va=null!==(je=null===(bd=Va.r)||void 0===bd?void 0:bd.toString())&&void 0!==je?je:null;null!=Va&&(se.responseStatus=Va);break;case 1:Xe="PerformanceTiming",bd=Va.a,null!=bd&&(se.Url=bd),bd=null==Va.b?null:Va.b.toString(),null!=bd&&(se.NavigationStart=bd),bd=null==Va.c?null:Va.c.toString(),null!=bd&&(se.UnloadEventStart=bd),bd=null==Va.d?null:Va.d.toString(),null!=bd&&(se.UnloadEventEnd=bd),bd=null==Va.e?null:Va.e.toString(),null!=bd&&(se.RedirectStart=bd),bd=null==Va.f?
null:Va.f.toString(),null!=bd&&(se.RedirectEnd=bd),bd=null==Va.g?null:Va.g.toString(),null!=bd&&(se.FetchStart=bd),bd=null==Va.h?null:Va.h.toString(),null!=bd&&(se.DomainLookupStart=bd),bd=null==Va.i?null:Va.i.toString(),null!=bd&&(se.DomainLookupEnd=bd),bd=null==Va.j?null:Va.j.toString(),null!=bd&&(se.ConnectStart=bd),bd=null==Va.k?null:Va.k.toString(),null!=bd&&(se.ConnectEnd=bd),bd=null==Va.l?null:Va.l.toString(),null!=bd&&(se.SecureConnectionStart=bd),bd=null==Va.m?null:Va.m.toString(),null!=
bd&&(se.RequestStart=bd),bd=null==Va.n?null:Va.n.toString(),null!=bd&&(se.ResponseStart=bd),bd=null==Va.o?null:Va.o.toString(),null!=bd&&(se.ResponseEnd=bd),bd=null==Va.p?null:Va.p.toString(),null!=bd&&(se.DomLoading=bd),bd=null==Va.q?null:Va.q.toString(),null!=bd&&(se.DomInteractive=bd),bd=null==Va.r?null:Va.r.toString(),null!=bd&&(se.DomContentLoadedEventStart=bd),bd=null==Va.s?null:Va.s.toString(),null!=bd&&(se.DomContentLoadedEventEnd=bd),bd=null==Va.t?null:Va.t.toString(),null!=bd&&(se.DomComplete=
bd),bd=null==Va.u?null:Va.u.toString(),null!=bd&&(se.LoadEventStart=bd),bd=null==Va.v?null:Va.v.toString(),null!=bd&&(se.LoadEventEnd=bd),Va=Va.w,null!=Va&&(se.CustomText=Va)}se.Table=Xe;return Sys.Serialization.JavaScriptSerializer.serialize(se)};var Ub=a(55),Ra=a(174),Rb=a(497);class ib{constructor(fb,Va,bd){this.FI=fb;this.YBe=this;this.inh=(void 0===Va?null:Va)||(()=>window.location.href);this.wad=new ac(void 0===bd?null:bd)}run(){if(ib.V4(window.performance))try{const se=this.inh();if(ib.Wvh.exec(se)&&
this.wad.QZf(se)){var fb=new Wa(window.performance.timing,se);Rb.a.instance.Fhk(fb.Yz.fetchStart);Rb.a.instance.Ghk(fb.Yz.navigationStart);Rb.a.instance.p0b(Ub.a.cBi,"connectStart","requestStart");Rb.a.instance.p0b(Ub.a.kBi,"requestStart","responseStart");Rb.a.instance.p0b(Ub.a.nBi,"responseStart","responseEnd");this.YBe.Ol(1,fb.Cye());this.FI.cr(Ub.a.IJa,fb.Yz.fetchStart);this.FI.cr(Ub.a.hBi,fb.Yz.domainLookupStart);this.FI.cr(Ub.a.gBi,fb.Yz.domainLookupEnd);this.FI.cr(Ub.a.eBi,fb.Yz.connectStart);
this.FI.cr(Ub.a.oBi,fb.Yz.secureConnectionStart);this.FI.cr(Ub.a.dBi,fb.Yz.connectEnd);this.FI.cr(Ub.a.lBi,fb.Yz.requestStart);this.FI.cr(Ub.a.vRb,fb.Yz.responseStart);this.FI.cr(Ub.a.iBi,fb.Yz.responseEnd-fb.Yz.responseStart);this.FI.cr(Ub.a.mBi,fb.Yz.responseStart-fb.Yz.requestStart);var Va=0,bd=0,je=0;(()=>{let Xe=this.O5k(se);({transferSize:Va,TEd:bd,gCd:je}=Xe);return Xe})().returnValue&&(this.FI.cr(Ub.a.pBi,Va),this.FI.cr(Ub.a.fBi,je),this.FI.cr(Ub.a.jBi,bd));this.FI.cr(Ub.a.uRb,fb.Yz.navigationStart)}}catch(se){O.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",se)}}O5k(fb){let Va,bd,je;je=bd=Va=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Va,TEd:bd,gCd:je};fb=window.performance.getEntriesByName(fb,"navigation");if(void 0===fb||null===fb||1!==fb.length)return{returnValue:!1,transferSize:Va,TEd:bd,gCd:je};fb=fb[0];var se=fb.transferSize;void 0!==Va&&null!==Va&&(Va=se);se=fb.decodedBodySize;void 0!==se&&null!==
se&&(je=se);fb=fb.encodedBodySize;void 0!==fb&&null!==fb&&(bd=fb);return{returnValue:!0,transferSize:Va,TEd:bd,gCd:je}}Ol(fb,Va){O.ULS.sendTraceTag(4551815,306,50,Gb(fb,Va))}static get instance(){return ib.Va||(ib.Va=new ib(Ra.a.instance,null,ba.AFrameworkApplication.ea.ka("PerfTimingLoggerFilterDomainsIsEnabled")?ba.AFrameworkApplication.ea.Kz("ResourceLoggerDomainAllowList"):null))}static V4(fb){return!(void 0===fb||null===fb)&&!(void 0===fb.timing||null===fb.timing)}}ib.Va=null;ib.Wvh=RegExp("^https?://.*",
"i");Object(t.a)(ib,"PerformanceTimingLogger",null,[701]);var la=a(154);class db{constructor(fb,Va){this.u5=null;this.tmd=fb;this.behavior=Va;this.url=this.Yz.name}get ZBe(){return 2===this.behavior?this.url:Qb.a.Lca(this.url)}get Yz(){return this.tmd}Cye(){const fb={},Va=this.Yz;fb.a=this.ZBe;fb.b=Va.initiatorType;fb.c=this.round(Va.redirectStart);fb.d=this.round(Va.redirectEnd);fb.e=this.round(Va.fetchStart);fb.f=this.round(Va.domainLookupStart);fb.g=this.round(Va.domainLookupEnd);fb.h=this.round(Va.connectStart);
fb.i=this.round(Va.connectEnd);fb.j=void 0!==Va.secureConnectionStart&&null!==Va.secureConnectionStart?this.round(Va.secureConnectionStart):0;fb.k=this.round(Va.requestStart);fb.l=this.round(Va.responseStart);fb.m=this.round(Va.responseEnd);fb.o=this.round(db.Bxa(Va,"decodedBodySize"));fb.p=this.round(db.Bxa(Va,"encodedBodySize"));fb.q=this.round(db.Bxa(Va,"transferSize"));fb.n=this.u5;fb.r=db.Bxa(Va,"responseStatus")||0;return fb}round(fb){return Math.round(1E3*fb)/1E3}static Bxa(fb,Va){return fb[Va]}}
Object(t.a)(db,"ResourceTimingEntry",null,[714]);var $b=a(108),Ic=a(204),Tc=a(94);class Zc{constructor(fb,Va,bd){this.l_e=!1;this.tIe=fb;this.clc=void 0===Va?null:Va;this.KDa={};this.Kjh=void 0===bd?100:bd;this.gIe=ba.AFrameworkApplication&&ba.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",!1)}b5k(fb){var Va=fb.name.toLowerCase();const bd=Qb.a.Nga(Va);this.OJg(bd,Va)&&(bd in this.KDa?O.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
bd):(Va={},Va.starttime=fb.startTime,Va.workerstart=fb.workerStart,Va.redirectstart=fb.redirectStart,Va.redirectend=fb.redirectEnd,Va.fetchstart=fb.fetchStart,Va.domainlookupstart=fb.domainLookupStart,Va.domainlookupend=fb.domainLookupEnd,Va.connectstart=fb.connectStart,Va.secureconnectionstart=fb.secureConnectionStart,Va.connectend=fb.connectEnd,Va.requeststart=fb.requestStart,Va.responsestart=fb.responseStart,Va.responseend=fb.responseEnd,Va.iscached=this.L4f(fb),Va.nexthopprotocol=fb.nextHopProtocol,
Va.encodedsize=db.Bxa(fb,"encodedBodySize"),Va.decodedsize=db.Bxa(fb,"decodedBodySize"),this.KDa[bd]=Va))}c5k(fb){var Va=fb.name.toLowerCase();const bd=Qb.a.Nga(Va);this.nvk(bd,Va)&&(bd in this.KDa?O.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",bd):(Va={},Va.starttime=fb.startTime,Va.workerstart=fb.workerStart,Va.redirectstart=fb.redirectStart,Va.redirectend=fb.redirectEnd,Va.fetchstart=fb.fetchStart,Va.domainlookupstart=fb.domainLookupStart,
Va.domainlookupend=fb.domainLookupEnd,Va.connectstart=fb.connectStart,Va.secureconnectionstart=fb.secureConnectionStart,Va.connectend=fb.connectEnd,Va.requeststart=fb.requestStart,Va.responsestart=fb.responseStart,Va.responseend=fb.responseEnd,Va.iscached=this.L4f(fb),Va.nexthopprotocol=fb.nextHopProtocol,Va.encodedsize=db.Bxa(fb,"encodedBodySize"),Va.decodedsize=db.Bxa(fb,"decodedBodySize"),Va.it=fb.initiatorType,Va.ress=fb.responseStart,Va.cs=fb.connectStart,Va.ce=fb.connectEnd,Va.dls=fb.domainLookupStart,
Va.dle=fb.domainLookupEnd,Va.rs=fb.redirectStart,Va.re=fb.redirectEnd,Va.reqs=fb.requestStart,Va.scs=fb.secureConnectionStart,this.KDa[bd]=Va))}OJg(fb,Va){if(this.tIe)return Array.contains(this.tIe,fb);if(this.clc)for(fb=Qb.a.fV(Va),Va=0;Va<this.clc.length;Va++)if(this.clc[Va]&&fb.endsWith(this.clc[Va]))return!0;return!1}nvk(fb,Va){return this.OJg(fb,Va)?fb.endsWith(".js")||fb.endsWith(".css"):!1}L4f(fb){try{const Va=db.Bxa(fb,"transferSize");if(void 0!==Va&&null!==Va)return!Va;O.ULS.sendTraceTag(51652510,
306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return fb.responseEnd-fb.fetchStart<this.Kjh}catch(Va){O.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Va.message)}return!1}iik(){if(Tc.a.Km(this.KDa))O.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else if(ba.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.StaticResourceMetricsForKpiLogOnlyOnce",
!1)&&this.l_e)O.ULS.sendTraceTag(507581086,306,15,"Static Resource Metrics already logged in KPI");else{var fb=ba.AFrameworkApplication.flightId?ba.AFrameworkApplication.flightId.split(";"):[],Va=Object.assign({},{extendedProperties:Ic.a.yy()});Va.extendedProperties.set("Flights",Ja.c(fb));this.PBj(Va,this.KDa,$b.Health.instance);this.l_e=!0}}SKd(fb){var Va,bd;let je=0,se=0,Xe=0,wf=0,Nf=0;const fg=this.KDa;for(const uf in fg){var Of=uf,Bg=fg[uf];Of.endsWith(".js")&&(Bg=Object(la.a)(Object,Bg),Bg.responseend<
fb&&(je+=1,se+=Bg.decodedsize,wf+=Bg.encodedsize,Xe+=Bg.iscached?0:Bg.encodedsize,Of=Of.toLowerCase(),this.gIe&&((null===(bd=null===(Va=ba.AFrameworkApplication.ea)||void 0===Va?void 0:Va.Ya("Slice1Name"))||void 0===bd?0:bd.toLowerCase().endsWith(Of))?Nf|=1:Of.endsWith(".common.js")||Of.endsWith(".othercommon.js")||Of.endsWith(".ext.js")?Nf|=2:Of.endsWith("common50.min.js")&&(Nf|=4))))}fb={};fb.filesLoaded=je;fb.decodedBytes=se;fb.transferredBytes=Xe;fb.encodedBytes=wf;this.gIe&&(fb.lazyChunksLoaded=
Nf);return fb}PBj(fb,Va,bd){if(Va){var je=0,se=0,Xe=0,wf=0,Nf=0,fg=0,Of=0,Bg=0,uf=0,Lg=0,zg=0;for(const Cg in Va){var mh=Va[Cg];try{const Sf=Object(la.a)(Object,mh);if(!Sf)continue;const dh=Sf.iscached?Boolean.parse(Sf.iscached.toString()):!1,jh=Sf.fetchstart?this.parseFloat(Sf.fetchstart.toString()):0,lc=(Sf.responseend?this.parseFloat(Sf.responseend.toString()):0)-jh,md=Sf.encodedsize?this.parseFloat(Sf.encodedsize.toString()):0,Yd=Sf.decodedsize?this.parseFloat(Sf.decodedsize.toString()):0;je+=
lc;wf+=md;Of+=Yd;Lg++;dh?(Xe+=lc,fg+=md,uf+=Yd,zg++):(se+=lc,Nf+=md,Bg+=Yd)}catch(Sf){O.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Sf.message)}}fb.extendedProperties.set("StaticResources",Ja.c(Va));fb.extendedProperties.set("TotalResourceDownloadLatency",je.toString());fb.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",se.toString());fb.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",Xe.toString());fb.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
wf.toString());fb.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Nf.toString());fb.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",fg.toString());fb.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Of.toString());fb.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Bg.toString());fb.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",uf.toString());fb.extendedProperties.set("TotalNumberOfResourcesDownloaded",
Lg.toString());fb.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",zg.toString());bd.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);bd.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",fb)}}parseFloat(fb){if(!fb)return 0;fb=parseFloat(fb);return isNaN(fb)?0:fb}}Object(t.a)(Zc,"AppStaticResourceManager",null,[]);class cc extends Sys.EventArgs{constructor(fb){super();this.entries=fb}}Object(t.a)(cc,"EntriesAvailableEventArgs",
Sys.EventArgs,[]);var Yc=a(129);class Vc{constructor(fb,Va,bd,je,se,Xe){bd=void 0===bd?null:bd;je=void 0===je?null:je;se=void 0===se?100:se;Xe=void 0===Xe?!1:Xe;this.Xed=!1;this.Fq=null;this.HCb=0;this.ih=new E.a;this.nSa=null;this.aK=!1;this.o0e=0;this.vk=fb;this.pLe=0;this.YBe=this;this.wad=new ac(bd);this.sE=Va;je&&(this.nSa=new Zc(null,je,se));this.nih=Xe}get Ybf(){try{return!(void 0===this.sE||null===this.sE)&&!(void 0===this.sE.getEntriesByType||null===this.sE.getEntriesByType)}catch(fb){return O.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",fb),!1}}get adi(){return this.pLe}get isActive(){return this.aK}get rye(){return this.o0e}jDh(fb){this.ih.addHandler(Vc.sFd,fb)}ook(fb){this.ih.removeHandler(Vc.sFd,fb)}co(fb,Va){const bd=this.rye!==fb;this.o0e=fb;this.isActive&&this.vk&&bd&&(this.Ux(),this.lm());this.pLe=Va}activate(){!this.isActive&&this.Ybf&&(this.lm(),this.aK=!0)}deactivate(fb){this.isActive&&(this.Ux(),fb&&this.flush(),this.aK=!1)}flush(){if(this.isActive&&
this.Ybf)try{var fb=window.performance.getEntriesByType("resource");0<fb.length-this.HCb&&O.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",fb.length-this.HCb);const Va=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Va&&(window.performance.clearResourceTimings(),this.HCb=0);const bd=[];for(let je=this.HCb;je<fb.length;je++)this.wad.QZf(fb[je].name)&&(this.nSa&&(this.nih?
this.nSa.c5k(fb[je]):this.nSa.b5k(fb[je])),bd.push(new db(fb[je],this.adi)));Va||(this.HCb=fb.length);this.ih.raiseEvent(Vc.sFd,new cc(bd));for(fb=0;fb<bd.length;fb++)0!==bd[fb].behavior&&2!==bd[fb].behavior||this.YBe.Ol(0,bd[fb].Cye());0<bd.length&&O.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",bd.length)}catch(Va){O.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Va)}}Ol(fb,Va){O.ULS.sendTraceTag(4310804,
306,50,Gb(fb,Va))}Ehk(){this.nSa.iik()}SKd(fb){return this.nSa.SKd(fb)}lm(){this.vk&&0<this.rye&&(this.Fq=new Yc.a(3,2,1E3*this.rye,()=>{this.flush()},5),this.vk.lm(this.Fq),this.Xed=!0)}Ux(){this.Xed&&(this.vk.Ux(this.Fq),this.Fq=null,this.Xed=!1)}}Vc.sFd="EntriesAvailable";Object(t.a)(Vc,"ResourceTimingLogger",null,[686,701]);var wd=a(140);class wc{constructor(){this.Vh=null}get name(){return"Common.ResourceTiming"}init(){Object(yb.a)(Fb);ib.instance.run()}dispose(){}co(fb){this.Vh=fb;let Va=null;
if(ba.AFrameworkApplication.ea.ka("ResourceLoggerFilterDomainsIsEnabled"))try{Va=ba.AFrameworkApplication.ea.Kz("ResourceLoggerDomainAllowList")}catch(Xe){O.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const bd=[];bd.push(Qb.a.fV(wd.a.AW).toLowerCase());bd.push(Qb.a.fV(wd.a.Mxb).toLowerCase());const je=ba.AFrameworkApplication.ea.Ij("AppStaticResourceMonitorCacheThresholdInMs",100),se=ba.AFrameworkApplication.ea.ka("PPTAggregateResourceTimingV2Enabled");
fb.register(686,"Common.NetworkTiming.IResourceTimingLogger").Ai().Ii(()=>new Vc(ba.AFrameworkApplication.Np,window.performance,Va,bd,je,se))}static main(){oc.a.instance.Jo(new wc)}}Object(t.a)(wc,"ResourceTimingPackage",null,[13,14]);const Ya=Object(yb.b)("Common.App.CpuMeter.ICpuMeterMonitor"),ob=Object(yb.c)(Ya),Cb=Object(yb.b)("Common.App.CpuMeter.CpuMeterProvider"),Wb=Object(yb.c)(Cb);var ad=a(144);class $c extends Sys.EventArgs{constructor(fb,Va){super();this.o0k=fb;this.actualValue=Va}}Object(t.a)($c,
"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var Ld=a(105);class jd{constructor(){this.mbb=[];this.QKe=this.O$c=0;this.osa=null;this.ih=new E.a;this.Q4h=(fb,Va)=>{Ld.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.V6h(Va.o0k,Va.actualValue))}}init(fb,Va,bd){this.osa=fb;this.O$c=Va;this.QKe=bd;this.osa.W5e(Object(ad.a)(this,this.wRj,"onCpuMeterFrameAvailable"));this.GEh(this.Q4h)}wRj(fb,Va){Va.Nfg&&(Array.enqueue(this.mbb,Va.Nfg.CP),this.mbb.length>this.QKe&&
(Array.dequeue(this.mbb),this.dXh()))}dXh(){var fb=this.mbb.length;let Va=0;for(let bd=0;bd<fb;bd++){const je=Array.dequeue(this.mbb);Va+=je;Array.enqueue(this.mbb,je)}fb=Va/fb;fb>this.O$c&&this.ih.raiseEvent("CPTTE",new $c(this.O$c,fb))}GEh(fb){this.ih.addHandler("CPTTE",fb)}V6h(fb,Va){const bd={};bd.ThresholdValue=fb;bd.ActualValue=Va;return bd}}Object(t.a)(jd,"CpuMeterMonitor",null,[719]);var Td=a(186);class re{constructor(){this.S=this.T=this.M=this.C=0}}Object(t.a)(re,"ProfileInformation",null,
[]);var Nd=a(52),uc=a(293);class pc{constructor(fb,Va){this.mdd=!1;this.tTa={};this.gic=void 0===fb?0:fb;this.pic=void 0===Va?0:Va;this.Kmd=0;Nd.a.addHandler(window.self,ta.a.CHh,()=>{this.mdd=!0});Nd.a.addHandler(window.self,ta.a.DHh,()=>{this.mdd=!1})}s7e(fb,Va,bd){const je=pc.generateKey(Va,bd);je in this.tTa?Va=this.tTa[je]:(Va=new re,Va.S=bd?1:0,this.tTa[je]=Va,this.Kmd++);Va.C++;Va.M=fb>Va.M?fb:Va.M;Va.T+=fb}Kla(fb,Va){this.s7e(fb,Va,!1);this.mdd&&this.s7e(fb,Va,!0)}getData(){if(0<this.pic&&
this.Kmd>this.pic)return this.SJi();const fb=0<this.gic,Va={},bd=this.tTa;for(const se in bd){var je=se;const Xe=bd[se];this.$Kg(Xe);fb&&Xe.T>=this.gic&&(Va[je]=Xe)}return fb?Tc.a.Km(Va)?null:Va:this.tTa}SJi(){var fb=0<this.gic,Va=[];const bd=this.tTa;for(const je in bd){const se={key:je,value:bd[je]},Xe=se.value;(!fb||Xe.T>=this.gic)&&Array.add(Va,se)}if(Va.length>this.pic)Va.sort((je,se)=>se.value.T-je.value.T),Va=Va.slice(0,this.pic);else if(!Va.length)return null;fb={};for(const je of Va)Va=je.value,
this.$Kg(Va),fb[je.key]=Va;return fb}$Kg(fb){fb.M=uc.a.Xia(fb.M,0);fb.T=uc.a.Xia(fb.T,0)}reset(){this.tTa={};this.Kmd=0}static generateKey(fb,Va){return Va?fb+" [it]":fb}}Object(t.a)(pc,"FunctionCallAggregator",null,[702]);class Hd{}Hd.iNh="BatchedOperation";Hd.fsk="Replication";Hd.x6k="25";Hd.gsk="9_"+Hd.iNh+"_"+Hd.fsk;Object(t.a)(Hd,"CpuMeterConstants",null,[]);class wb{}Object(t.a)(wb,"CpuMeterFrame",null,[]);class Xb extends Sys.EventArgs{constructor(fb){super();this.Nfg=fb}}Object(t.a)(Xb,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);class Kb{}Object(t.a)(Kb,"MiniTaskItemInfo",null,[]);class Zb{}Object(t.a)(Zb,"TaskItemInfo",null,[]);var Oc=a(608),Cd=a(107);class Wd{static p1i(){if(!Wd.Mdc&&(Wd.Mdc=new Cd.a,ba.AFrameworkApplication.ea&&ba.AFrameworkApplication.ea.Rv("AggregatorIdDisabledList"))){const fb=ba.AFrameworkApplication.ea.Kz("AggregatorIdDisabledList");for(let Va=0;Va<fb.length;Va++)Wd.Mdc.ga(fb[Va],!0)}return Wd.Mdc}}Wd.Mdc=null;Object(t.a)(Wd,"DisabledAggregatorListStore",null,[]);var ee=a(296);class he{constructor(fb,
Va,bd,je,se,Xe,wf,Nf){Xe=void 0===Xe?!0:Xe;wf=void 0===wf?null:wf;this.yof=Nf;this.O9=this.B_e=this.nRe=!1;this.vk=null;if(!fb)throw ee.a.argument("taskManagerLazy");if(!se)throw ee.a.argument("dataAggregator");this.kvh=fb;this.Chd=Va;this._id=bd;this.CPe=6E4*je;this.ifc=se;this.GXe=Xe;this.IGb=wf;Wd.p1i().mh(this._id.toString())&&(this.O9=!0)}get QN(){return this.vk||(this.vk=this.kvh.value)}track(fb,Va){Va=void 0===Va?null:Va;this.O9||(this.Bni(),this.jzk(),this.ifc.Kla(fb,Va))}jzk(){!this.nRe&&
0<this.CPe&&(this.nRe=!0,this.VMg())}VMg(){const fb=new Yc.a(5,1,this.CPe,()=>{this.BBk()},19,this._id.toString());this.QN.lm(fb)}BBk(){!this.IGb||this.IGb.yMk()?this.iOg():this.GXe&&this.ifc.reset();this.VMg()}iOg(){const fb=this.ifc.getData();if(fb){const Va=parseInt(String(fb.length));if(isNaN(Va)||0<Va)this.zYc(fb),this.yof&&this.yof(fb),this.GXe&&this.ifc.reset()}}zYc(fb){O.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:fb})}Bni(){this.B_e||(this.Chd(()=>
{this.iOg()}),this.B_e=!0)}static pY(fb,Va,bd,je,se,Xe){return new he(new Oc.a(()=>ba.AFrameworkApplication.Np),ba.AFrameworkApplication.KQa,fb,Va,bd,je,se,Xe)}static Blb(fb,Va,bd){return he.pY(fb,Va,bd,!0,null,void 0)}}Object(t.a)(he,"Aggregator",null,[717]);class pe{constructor(fb){fb=void 0===fb?null:fb;this.lv=null;this.reset();this.IGb=fb}Kla(fb,Va){if(!this.IGb||this.IGb.yMk())Va in this.lv||(this.lv[Va]=[]),this.lv[Va].push(fb)}getData(){return Tc.a.count(this.lv)?this.lv:null}reset(){this.lv=
{}}}Object(t.a)(pe,"NamedValuesAggregator",null,[702]);var Se=a(247);class Ta{constructor(fb,Va,bd,je,se){this.UUa=0;this.pO=null;this.jkc=this.j_e=0;this.wYe=!1;this.Obb=0;this.yEb=!1;this.rFa=null;this.$gc=0;this.dVe=new E.a;this.ivh=[];this.$W=fb;this.ugd=Va;this.Wbd=bd;this.pTe=je;ba.AFrameworkApplication.ea&&ba.AFrameworkApplication.ea.ka("WrapSetTimeoutForTelemetryIsEnabled")&&this.v1d();this.mmh=se;this.Xbd=new pc(100);this.sqh=he.Blb(1,5,new pe)}W5e(fb){this.dVe.addHandler("OnCpuMeterFrameAvailable",
fb)}Iub(fb,Va,bd,je){bd=(je=void 0===je?null:je)?je.priority:7;const se=this.$W();this.start(Va,bd);try{fb()}finally{this.stop(Va,je),fb=this.$W()-se,this.pTe.track(fb,Va)}}a8(fb,Va){const bd=this.$W();try{fb()}finally{fb=this.$W()-bd,this.Wbd.Kla(fb,Va),0<this.UUa&&this.Xbd.Kla(fb,Va),this.pTe.track(fb,Va)}}Jbe(fb){const Va=new Zb;Va.TN=fb.WMc;Va.TP=fb.priority;this.nBg(1,Va)}Crb(fb){this.$gc|=fb}start(fb,Va){if(!this.UUa){this.Xbd.reset();const bd=this.c5f(fb);bd&&this.d6d(1);this.pO=new Zb;this.pO.TN=
fb;this.pO.TP=Va;this.pO.ST=(new Date).toISOString();this.pO.STS=uc.a.Xia(this.$W(),2);bd?this.pO.UI=1:this.epj(fb)?this.pO.UI=2:this.pO.UI=0}this.UUa++}d6d(fb){this.Obb|=fb}$wd(fb,Va){this.Obb=void 0===fb||fb?0:this.Obb&~(void 0===Va?0:Va)}stop(fb,Va){Va=void 0===Va?null:Va;let bd;this.UUa--;0>=this.UUa&&this.pO&&(bd=this.$W()-this.pO.STS,this.jkc+=bd,this.ugd.Kla(bd,fb),this.c5f(fb)&&this.$wd(!1,1),this.pO.TRT=uc.a.Xia(bd,2),Va&&(this.pO.TQT=uc.a.Xia(Va.Wdk,2),this.pO.TDT=uc.a.Xia(Va.E6f,2)),this.mmh&&
(this.nBg(0,this.pO),this.Osk()),this.UUa=0);0<=fb.indexOf(Hd.x6k)&&this.Crb(2);0<=fb.indexOf(Hd.gsk)&&this.Crb(4);1===(this.Obb&1)&&this.Crb(1);2===(this.Obb&2)&&this.Crb(8)}Osk(){var fb=this.pO.TRT;if(750<fb){let bd=this.Xbd.getData();if(bd){const je={};for(const se in bd){var Va=bd[se];const Xe=se;Xe.startsWith("SiOp_")||Xe.endsWith("[it]")||(je[Xe]=Math.round(100*Va.T/fb))}bd=je}fb=Object.assign(new Kb,{B:this.pO.STS,T:fb,S:bd});this.sqh.track(fb,this.pO.TN)}}qVk(){var fb=this.$W()-this.j_e,Va=
uc.a.Xia(this.jkc/fb*100,2);fb=new wb;fb.CP=Va;fb.II=this.$gc;Va=this.ugd.getData();Tc.a.count(Va)&&(fb.LRT=Va);Va=this.Wbd.getData();Tc.a.count(Va)&&(fb.FP=Va);this.dVe.raiseEvent("OnCpuMeterFrameAvailable",new Xb(fb));this.TYg()}TYg(){this.ugd.reset();this.Wbd.reset();this.jkc=this.UUa=0;this.j_e=this.$W();this.$gc=0;this.pO=null}run(){this.wYe?this.qVk():(this.TYg(),this.wYe=!0);this.rFa?this.rFa(Object(ad.a)(this,this.run,"run"),1E3):window.setTimeout(Object(ad.a)(this,this.run,"run"),1E3)}nBg(fb,
Va){fb=this.ivh[fb];if(!Se.a.Km(fb))for(let je=0;je<fb.length;je++){var bd=fb[je];const se=bd[0];bd=bd[1];se&&!se(Va)||bd(Va)}}v1d(){if(!this.yEb){const fb=window.setTimeout;this.rFa=(Va,bd)=>fb(Va,bd);this.yEb=!0}}c5f(fb){return fb.startsWith("key")||fb.startsWith("input")}epj(fb){return fb.startsWith("click")||fb.startsWith("mouse")||fb.startsWith("pointer")}}Object(t.a)(Ta,"CpuMeter",null,[72]);class Qa{constructor(fb){this.FCb=null;this.kt=new Td.a;this.$W=fb}initialize(fb,Va,bd,je){this.FCb||
(this.FCb=new Ta(this.$W,fb,Va,bd,void 0===je?!1:je),this.kt.setResult(this.FCb));return this.FCb}}Object(t.a)(Qa,"CpuMeterProvider",null,[718]);class Ob{constructor(fb){this.DF=[];this.qfc=[];this._count=void 0===fb?1:fb}Dxi(){let fb=0;for(let Va=0;Va<this.DF.length;Va++)this.DF[Va]<this.DF[fb]&&(fb=Va);return fb}Kla(fb,Va){fb=uc.a.Xia(fb,2);if(this.DF.length<this._count)Array.add(this.DF,fb),Array.add(this.qfc,Va);else{var bd=this.Dxi();fb>this.DF[bd]&&(this.DF[bd]=fb,this.qfc[bd]=Va)}}getData(){return this.DF.length?
{["Vals"]:this.DF,["Desc"]:this.qfc}:null}reset(){this.DF=[];this.qfc=[]}}Object(t.a)(Ob,"MaxDataAggregator",null,[702]);var Jb=a(59);class Jc{get name(){return"Common.App.CpuMeter"}co(fb){fb.register(Qa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").Ai().Ii(()=>new Qa(Jb.a.Cj));fb.register(jd,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").Ai().Ii(()=>new jd)}init(){const fb=ba.AFrameworkApplication.ea;if(fb.ka("CpuMeterIsEnabled")&&!fb.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableCpuMeter",
!1)){const Va=Object(yb.a)(Wb);Rb.a.instance.z8e.continueWith(()=>{Jc.Vcj(fb,Va)})}}dispose(){}static Vcj(fb,Va){const bd=he.Blb(10,5,new pc(fb.Ij("TaskManagerLoggingThreshold",0),fb.Ij("CpuMeterMaximumEntriesToLog",0)));Va=Va.initialize(new Ob(5),new pc,bd,fb.ka("CPUMeterExposeTaskDetailsIsEnabled"));fb.ka("WordEditorInteractivePerfDisableCpuMeterFrames")||(Va.run(),fb.ka("CpuMeterMonitorIsEnabled")&&Object(yb.a)(ob).init(Va,fb.Jga("CpuMeterAverageCpuPercentThreshold",80),fb.Ij("CpuMeterRollingAverageFramesCount",
15)));Ld.a(16827671,306,50,"Initializing CpuMeter")}static main(){oc.a.instance.Jo(new Jc)}}Object(t.a)(Jc,"CpuMeterPackage",null,[13,14]);var zb=a(1186);class tb{get name(){return"Common.App.EventsCachePackage"}co(){}init(){zb.a.instance.init()}dispose(){}static main(){oc.a.instance.Jo(new tb)}}Object(t.a)(tb,"EventsCachePackage",null,[13,14]);var zc=a(9),dd=a(432);class od extends dd.a{constructor(fb){super();this.djf=!1;this.$=fb;this.sn()}create(){const fb=this.$.qa,Va=K.a.instance;if(!this.djf){this.djf=
!0;let bd;bd=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.ua.DocumentHostInfo.PostMessageOrigin||fa.a.iM:ba.AFrameworkApplication.WSc||fa.a.iM;Va.register(ja,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Ai().Ii(()=>new ja(this.$,window.parent,bd,ba.AFrameworkApplication.ea.ka("HostSendReadyToAcceptPostMessage")))}this.dl(fb.zh(21)||fb.Rh(21,Va.resolve("Postmessage.IHostPostmessenger")))}}Object(t.a)(od,
"HostMessengerFactory",dd.a,[]);var gb=a(130),gc=a(183),Dc=a(873),hd=a(658),xd=a(80),fd=a(245),kd=a(373),Yb=a(372),Cc=a(511),td=a(7),Ad=a(62),oe=a(63);class qe{constructor(fb,Va,bd){this.correlations=this.properties=this.operation=null;this.operation=fb;this.properties=Va;this.correlations=bd}static Yui(fb,Va,bd){const je={},se=Ad.b();switch(fb.command){case -1537138325:je.Action=Va.LabelText;break;case -1104934572:je.PrevTab=se.kp(parseInt(Va.OldContextCommand,10));je.NextTab=se.kp(parseInt(Va.NewContextCommand,
10));break;case 802602464:je.Origin=Va[td.a.QM];break;case -1027730316:case -1059615499:je.MenuType=Va.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Va&&(je.SqmControlId=Va.SqmControlId);break;case 1371713064:case 875133075:oe.a.Pi in Va&&(je.SampleTableId=Va[oe.a.Pi])}je.InputMethod=kd.a[fb.method];je.Location=Yb.a[fb.jk];je.Mode=Cc.a[fb.mode];je.ParentName=fb.tabName;je.IsSystemInitiated="IsSystemInitiated"in Va?
Va.IsSystemInitiated:!1;je.NoReporting="NoReporting"in Va?Va.NoReporting:!1;"ControlIdToLog"in Va&&(je.ControlId=Va.ControlIdToLog);"TerminalParentControlIdToLog"in Va&&(je.TerminalParentControlId=Va.TerminalParentControlIdToLog);for(const Xe of Object.keys(bd))je[Xe]=bd[Xe];return je}}Object(t.a)(qe,"InteractivityRecord",null,[]);class Be extends qe{constructor(fb,Va,bd){super(fb.operation,fb.properties,fb.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=
Va;this.timeFromNavigationStart=bd}}Object(t.a)(Be,"FirstUserInteractivityRecord",qe,[]);var Ee=a(787);class Ve{constructor(){this.commandSurface=this.triggerMethod=gb.a.Xzb}static ndj(){Ve.Okb||(Ve.Okb=new Ee.a(hd.a.tm()),Ve.Okb.add("InputMethod"),Ve.Okb.add("Location"),Ve.Okb.add("Mode"))}}Ve.Okb=null;Object(t.a)(Ve,"ExcelUserAction",null,[]);var Oe=a(205),Ye=a(509),nf=a(118),of=a(157),Cf=a(111);class Ff extends xd.a{constructor(fb){super();this.bXf=0;this.EBf=!1;this.f2d=Array(Ff.Grb);this.Euc=
0;this.$=fb;this.A4f=J.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");gb.a.lTi();this.poa={};Ff.jmc||(Ff.jmc=new Dc.a(hd.a.tm()),Ff.pcj(Ff.jmc));Ve.ndj();if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(fb=0;fb<Ff.Grb;fb++)this.f2d[fb]="NA"}dispose(){this.$=this.poa=null;super.dispose()}RHg(fb,Va,bd){const je=Ad.b().kp(fb.command),se=JSON.stringify(fb);je||O.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${je}, command: ${fb.command}, commandInfo: ${se}`);
Va=qe.Yui(fb,Va,bd);bd=!!Va&&(!("IsSystemInitiated"in Va)||!Va.IsSystemInitiated);this.$&&this.$.fa.um&&bd&&zb.a.instance.LCg("OtelUserAction",new Ye.a(je,fb.tabName,Date.now()));this.dIg(je,Va,null,!0,!0)}sj(fb,Va,bd,je){this.dIg(fb,Va,void 0===bd?null:bd,!1,void 0===je?!1:je)}XYg(fb){if(this.poa){++this.bXf;this.poa[fb]||(this.poa[fb]=[]);var Va=this.bXf.toString();this.poa[fb].push(Va);O.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${fb}', correlation=${Va}`)}else O.ULS.shipAssertTag(537155554,
0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${fb}] == null`)}EZg(fb){if(this.poa&&this.poa[fb]){var Va=this.poa[fb],bd=Va.pop().toString();Va.length||delete this.poa[fb];O.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${fb}', correlation=${bd}`)}else O.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${fb}] == null`)}C0(fb,Va,bd){bd=void 0===
bd?!1:bd;return fd.b(je=>{this.sj(fb,je(),void 0,bd)},Ff.q0k,this.ya,Oa.a.qgj,!1,!Va)}jle(){let fb="";for(let Va=0;Va<Ff.Grb;Va++)fb+=this.f2d[(this.Euc+Ff.Grb-Va-1)%Ff.Grb]+",";O.ULS.sendTraceTag(557188890,0,15,`Last operations ${fb}`)}Y$k(fb){fb&&(this.f2d[this.Euc]=fb,this.Euc=(this.Euc+1)%Ff.Grb)}LBj(fb,Va,bd){ba.AFrameworkApplication.vxc();const je=fb.operation,se=fb.properties;void 0!==bd?void G.a.resolve(D.xe,{va:0}).then(Xe=>{Xe.kik(je,se,bd)}):this.H6k(fb);this.I6k(fb);this.x4j(Va,se,je)}H6k(fb){this.vUk(fb)||
(this.EBf=!0,fb=new Be(fb,Ka.a.instance.Kna(),Object(Cf.b)()),fb=Sys.Serialization.JavaScriptSerializer.serialize(fb),O.ULS.sendTraceTag(458261331,0,50,`${fb}`))}vUk(fb){const Va=fb.properties;fb=fb.operation;return this.EBf||void 0===fb||null===fb||fb===ka.a.mod||fb===ka.a.Xoe||fb===ka.a.Tee||qa.a.HZd(fb)||!!Va&&"IsSystemInitiated"in Va&&Va.IsSystemInitiated}I6k(fb){J.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.Y$k(fb.operation);fb=Sys.Serialization.JavaScriptSerializer.serialize(fb);
O.ULS.sendTraceTag(21542793,0,50,`${fb}`)}x4j(fb,Va,bd){gb.a.pza()&&(Va?"NoReporting"in Va&&Va.NoReporting||"IsSystemInitiated"in Va&&Va.IsSystemInitiated||!fb&&!this.A4f||((fb=gb.a.xn(Va,Ff.jmc,Ve.Okb))?(Va=Ff.gvi(Va))?gc.a.sendUserActionEvent(gb.a.juc(bd,null,Va.triggerMethod,Va.commandSurface,fb)):O.ULS.sendTraceTag(537155550,0,50,"user action was null"):O.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):O.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${bd}`))}dIg(fb,
Va,bd,je,se){const Xe=Oe.a(this.$);if(this.A4f){let Nf=null;ha.a.equals(fb,ka.a.mYc,!0)&&Va&&"InputMethod"in Va&&(Nf=ka.a.PCf(fb,Va.InputMethod));Xe.D6b(Nf||fb,bd)}else ha.a.equals(fb,ka.a.mYc,!0)&&Va&&"InputMethod"in Va&&(fb=ka.a.PCf(fb,Va.InputMethod)),Xe.D6b(fb,bd);Va&&(Va.IsCommand=je);const wf="ActionRelativeTime"in Va?Va.ActionRelativeTime:Object(Cf.b)();Object(of.e)(()=>{const Nf=new qe(fb,Va,this.poa);this.LBj(Nf,se,wf)},this.$.ya,50)}static gvi(fb){if(!fb)return null;const Va=new Ve;"InputMethod"in
fb&&(Va.triggerMethod=fb.InputMethod);"Location"in fb&&(Va.commandSurface=fb.Location);return Va}static pcj(fb){fb?(fb.add("Origin",nf.g.String),fb.add("InputMethod",nf.g.String),fb.add("ButtonType",nf.g.String),fb.add("selectedRange",nf.g.String),fb.add("SelectedRanges",nf.g.String),fb.add("editRange",nf.g.String),fb.add("Location",nf.g.String),fb.add("Mode",nf.g.String),fb.add("CurrentSelectionMode",nf.g.String),fb.add("Action",nf.g.String),fb.add("type",nf.g.String),fb.add("floatingObjectType",
nf.g.String),fb.add("PrevTab",nf.g.String),fb.add("NextTab",nf.g.String),fb.add("DialogName",nf.g.String),fb.add("dx",nf.g.Int64),fb.add("dy",nf.g.Int64),fb.add("NumberOfSelectedRanges",nf.g.Int64),fb.add("IsCommand",nf.g.Boolean),fb.add("IsInFormulaBarEdit",nf.g.Boolean),fb.add("isLink",nf.g.Boolean),fb.add("isSheetRef",nf.g.Boolean),fb.add("isEmptyText",nf.g.Boolean),fb.add("isFormula",nf.g.Boolean),fb.add("IsResizingHiddenHeader",nf.g.Boolean)):O.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}
Ff.q0k=1E3;Ff.Grb=40;Ff.jmc=null;Object(t.a)(Ff,"InteractivityLogger",xd.a,[21]);var Wf=a(78),Mf=a(85),ng=a(146),Rf=a(607),$f=a(88),jf=a(61),Hf=a(309),Uf=a(40),If=a(42),sf=a(263);class tc extends Sys.EventArgs{constructor(fb){super();this.lP=fb}}Object(t.a)(tc,"ErrorDataArgs",Sys.EventArgs,[]);var ld=a(791);class Ed{constructor(fb,Va){this.Gec=null;this.Yuc=this.dTd=!1;this.IYe=this.JYe=null;this.snb=this.rnb=0;this.gNg=fb;this.MVe=Va}get Pug(){return this.MVe}get F7b(){return this.JYe}get fNg(){return this.IYe}get Jvj(){return this.Cdf(this.gNg.getTime())}get C5j(){return this.Cdf(this.fNg.getTime())}get fUg(){return!(this.Yuc||
void 0===window.bsqmXLSPageLoadStartTime)}get xxd(){try{return this.Gec||(this.Gec=A.toUtc(window.bsqmXLSPageLoadStartTime)),this.Gec}catch(fb){return null}}set xxd(fb){this.Gec=fb}BIk(fb){this.Yuc||(this.JYe=fb,this.IYe=A.toUtc(this.F7b))}Z9i(fb){if(fb.Values&&(!this.rnb||!this.snb))try{X.a.cUf in fb.Values&&(this.rnb=parseInt(fb.Values[X.a.cUf].toString(),10));X.a.dUf in fb.Values&&(this.snb=parseInt(fb.Values[X.a.dUf].toString(),10));const Va=Rb.a.instance;0<this.rnb&&(this.i$f(this.rnb,"PageLoadFromHostClick"),
Va.mik(this.rnb));0<this.snb&&(this.i$f(this.snb,"PageLoadFromHostFrameCreation"),Va.oik(this.snb));const bd=fb.Values[X.a.b$i]||0,je=fb.Values[X.a.$9i]||fb.Values[X.a.a$i]||0;0<je&&Va.Rhk(je);Va.Shk(bd)}catch(Va){}}Cuk(){this.gNg=this.xxd=z.a.kh.vi;this.MVe=0;this.dTd=this.Yuc=!1}Cdf(fb){const Va=this.xxd.getTime();return Va>=fb?0:fb-Va+this.Pug}i$f(fb,Va){if(fb){const bd=Ad.b();bd.S0c("UserAction",Va,Va,z.a.P5d(fb),ld.EcmaDateClock.instance.appStart);bd.sxc(Va,A.toTimestamp(this.F7b))}}}Object(t.a)(Ed,
"PageLoadPerfInfo",null,[]);var ze=a(70);class ge{constructor(fb,Va,bd){this.vld=fb.keyCode;this.v8b(fb.ctrlKey,1);this.v8b(fb.shiftKey,2);this.v8b(fb.altKey,4);this.v8b(ze.b(fb),8);this.v8b(bd,16);this.vld=this.Fyb|Va<<24}get Fyb(){return this.vld}get keyCode(){return this.Fyb&65535}v8b(fb,Va){fb&&(this.vld=this.Fyb|Va<<16)}}Object(t.a)(ge,"ShortcutSqmData",null,[]);class Ne{constructor(){this.M4d=null;this.N_h={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.rJg()}rVh(fb,Va,bd){0===
bd&&(bd=this.N_h[Va.toString()]);return Ne.shouldLog(fb,bd)&&(fb=new ge(fb,bd,Ea.a.isMac),!If.a.Ym(this.M4d,fb.Fyb.toString()))?(this.M4d[fb.Fyb.toString()]=!0,fb):null}rJg(){this.M4d={}}static Umj(fb){return 112<=fb&&123>=fb||61440<=fb&&61451>=fb}static Koj(fb){return 17!==fb&&18!==fb&&16!==fb&&91!==fb&&93!==fb}static shouldLog(fb,Va){let bd=fb.ctrlKey||fb.altKey||ze.b(fb);fb=fb.keyCode;bd=Ne.Umj(fb)||bd;bd=Ne.Koj(fb)&&bd;return 0!==Va&&bd}}Object(t.a)(Ne,"UnhandledShortcutLogger",null,[]);class Ge{constructor(fb){this.Ksc=
[];this.TIh=null;this.sqmManager=fb}Qmc(fb){this.Ksc.push(fb)}s7(fb,Va,bd){try{if(Va)Va.endTime=bd,this.sqmManager.t3e(Va);else for(let je=0,se=this.Ksc.length;je<se;je++){const Xe=this.Ksc[je];fb?(Xe.endTime=Xe.startTime,Xe.nif=0):Xe.endTime=bd;this.sqmManager.t3e(Xe)}}catch(je){}finally{this.Ksc.length=0}}}Object(t.a)(Ge,"UserInteractionPerfInfo",null,[]);var ca=a(38),sb=a(75),Ba=a(260);class V extends xd.a{constructor(fb,Va){super();this.VRd=this.G6b=!1;this.iUg=!0;this.eh=new x.a;this.S$c=!1;
this.Xi=()=>{const bd=sb.a(this.$).yj.activityState,je=If.a.Ym(bd,ca.a.Y2e);If.a.Ym(bd,ca.a.jIb)||je||this.upload()};this.$=fb;this.uSb=Va;this.fa=fb.fa;this.$.Pp(this.Xi);this.a5g=new Ne;this.L5a=new Ed(qa.a.boe,fb.ua.PageGenerationMetrics.TimeToCompleteFirstFlush);this.n5c=new Ge(this)}Mpd(fb){this.eh.addHandler("EREK",fb)}Oje(fb){this.eh.removeHandler("EREK",fb)}get Obi(){return this.S$c}get mgj(){return this.$.frame.O1?$a.a.ogj:$a.a.ngj}get workbookContext(){return this.$.workbookContext}get W4(){V.TBb||
(V.TBb=this.Xuf());V.vud||(V.vud=!0,this.gWf());return V.TBb}set W4(fb){V.TBb=fb;V.TBb||(V.vud=!1)}get vfa(){return $f.a(this.$.ua,3)}dispose(){this.Obi&&ba.AFrameworkApplication.cu&&ba.AFrameworkApplication.cu.disable();this.$&&this.$.wu(this.Xi);this.$=this.n5c=this.L5a=this.W4=null;super.dispose()}MQf(fb){this.L5a.Z9i(fb);this.BBj()}Kpe(fb){this.setDw(9415,fb)}Qmc(fb){this.n5c.Qmc(fb)}s7(fb,Va,bd){this.n5c.s7(fb,Va,bd)}e4d(fb){if(this.vfa){fb=this.$.isEditMode||fb&&!!(this.fa.workbookContext.Options&
512);if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:8784630_SupportCollabViewInApplicationModeExtended")){const Va=this.fa.N1a;fb=fb?2:Va?20:this.fa.Kh.inEmbedView?14:1}else fb=fb?2:this.fa.Kh.inEmbedView?14:1;this.setDw(8721,fb);this.Hyi(fb);this.S$c=!1}}y$f(){const fb=this.L5a;this.vfa&&fb.fUg&&(this.setDw(9450,fb.Pug),this.setDw(9085,fb.Jvj))}z$f(fb){if(!this.G6b){this.G6b=!0;const Va=this.L5a;let bd=0;this.vfa&&Va.fUg?(Va.BIk(fb),this.n5c.TIh=Va.fNg,this.setDw(9086,Va.C5j),Va.Yuc=!0,bd=this.L5a.F7b.getTime()):
bd=fb.getTime();Uf.TaskExtensions.$e(this.uSb.value,je=>{je.result.sendMessage(U.a.OIh,{[X.a.PIh]:bd})},this.ya,3)}}t3e(fb){this.vfa&&fb&&1!==fb.qra&&this.oua(8327,sf.b(fb),sf.l(fb),sf.a(fb),2,fb.nif,sf.m(fb),sf.d(fb),sf.e(fb))}fle(fb,Va){fb&&fb.MessageIdHash&&this.ele(fb.MessageIdHash,fb.MessageIdName,fb.MessageId,fb.ErrorCause?fb.ErrorCause:Mf.a.A3c,!1,Va,fb,null)}ele(fb,Va,bd,je,se,Xe,wf,Nf){V.Ird||(V.Ird=!0,ng.a.get_instance().isCompleted(13)||(ng.a.get_instance().hy(13),O.ULS.sendTraceTag(537151323,
0,50,"App encountered its first error so updating app init status")));fb=this.ekb(fb);const fg=!!wf,Of={};Of.ErrorName=Va;Of.ErrorHashCode=fb.toString();Of.ErrorId=bd.toString();Of.ErrorCause=je.toString();Of.ErrorType=0===Xe?"ErrorDialog":"BusinessBar";Of.BusinessBarEntryName=Nf||"null";Of.ServerCorrelationId=fg?wf.CorrelationId:"null";Of.WebMethodName=fg?wf.WebMethodName:"null";Of.SessionHostingEcs=this.fa.workbookContext?this.fa.workbookContext.EcsServerName:"null";Of.WfeServerId=fg?wf.WfeServerId:
"null";Va=jf.a.Di(Of);this.eh.raiseEvent("EREK",new tc(Of));O.ULS.sendTraceTag(1881314,0,15,Va);this.vfa&&(Ic.a.NCg(fb.toString()),this.oua(9134,fb,je,Mf.a.jAe),this.fa.zA||se||(this.setDw(10459,fb),this.e4d(!0),this.VRd=!0,this.upload(),this.gWf()))}ekb(fb){return 5439488|(fb>>>16^fb&65535)&65535}E4d(fb,Va,bd){fb=this.a5g.rVh(fb,Va,bd);this.vfa&&fb&&this.oua(11007,fb.Fyb)}upload(){!this.vfa||!this.G6b&&!this.VRd||Ea.a.Cm&&ba.AFrameworkApplication.Vl?Ea.a.Cm&&ba.AFrameworkApplication.Vl&&O.ULS.sendTraceTag(537151320,
0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.W4.Zbc(),this.S$c=!0);ba.AFrameworkApplication.cu=this.W4=null;this.L5a.Cuk();this.G6b=!1;ba.AFrameworkApplication.cu=this.W4=this.Xuf();this.a5g.rJg()}BBj(){const fb=this.L5a;if(this.vfa&&!fb.dTd){var Va=fb.rnb,bd=fb.snb,je=fb.F7b.getTime();ba.AFrameworkApplication.ZX=fb.F7b;Va&&this.setDw(10324,Va>je?0:je-Va);bd&&this.setDw(10325,bd>je?0:je-bd);fb.dTd=!0}}oua(fb,...Va){this.vfa&&this.W4.oua(fb,...Va)}setDw(fb,Va){this.vfa&&this.W4.setDw(fb,
Va)}Xuf(){Hf.a.uvf(this.$.ua);return ba.AFrameworkApplication.cu}Hyi(fb){let Va;try{Va=Object(la.a)(Object,jf.a.Vp(ba.AFrameworkApplication.ea.appSettings.SessionStartInfoJson))}catch(bd){O.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${bd.message}`);return}if(Va){let bd=Object(la.a)(String,Va.ApplicationModeExtended),je=Object(la.a)(String,Va.ApplicationMode);bd&&je&&(bd=bd.toUpperCase(),2!==fb&&16!==fb||"VIEW"!==bd&&"UNIFIED"!==bd?1!==fb||"EDIT"!==bd&&"UNIFIED"!==
bd||(bd="VIEW",je="View"):(bd="EDIT",je="Edit"),Va.ApplicationModeExtended=bd,Va.ApplicationMode=je,ba.AFrameworkApplication.ea.appSettings.SessionStartInfoJson=jf.a.Di(Va))}}gWf(){const fb=this.$.ua;this.W4.RY=!0;this.W4.Q$a(fb.BWsaStartTime);this.setDw(59,83);this.G6b=!1;if(this.vfa){const Va=fb.DocumentHostInfo;this.uai();this.setDw(8491,this.$.SN);this.setDw(9236,fb.RequestedUILcid);this.setDw(8473,fb.WacHostId);this.setDw(9902,sf.c(Va.ClusterId));J.EwaSettings.Na(398)?this.W4.jQg(""):this.W4.jQg(fb.FlightHolder?
fb.FlightHolder.FlightId:"");this.Kpe(this.fa.Kh.inEmbedView?1:0);this.VRd=!1;this.setDw(9104,sf.c(Va.FileSourceId));this.setDw(10309,this.mgj);this.FKk();ba.AFrameworkApplication.xh.Eie(Rf.a.getInstance(!1))}}FKk(){Rb.a.instance.vcj(this.W4);if(this.iUg){const fb=Rb.a.instance;fb.Lhk();fb.hik();fb.eik();fb.dik();fb.Yhk();this.iUg=!1}}uai(){this.createStream(8327,1,Ba.a.Adi,Ba.a.Yib);this.createStream(9134,1,3,Ba.a.Yib);this.createStream(11007,1,1,Ba.a.Yib)}createStream(fb,Va,bd,je){this.W4.createStream(fb,
Va,bd,je)}}V.TBb=null;V.vud=!1;V.Ird=!1;Object(t.a)(V,"SqmManager",xd.a,[201,684]);var Fa=a(91),sc=a(961);class Kc{constructor(fb,Va){this.entryTypes=null;this.buffered=!1;this.entryTypes=fb;this.buffered=void 0===Va?!1:Va}}Object(t.a)(Kc,"PerformanceObserverInit",null,[]);class qd extends Sys.EventArgs{constructor(fb){super();this.xvf=fb}}Object(t.a)(qd,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class Eb extends Sys.EventArgs{constructor(fb){super();this.iGc=fb}}Object(t.a)(Eb,"LongTaskPerformanceObserverInitializedEventArgs",
Sys.EventArgs,[]);class vc{constructor(fb){this.eh=new x.a;this.ydd=!1;this.Lm=()=>{if(Ea.a.$v){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.QDj)).observe(new Kc([$a.a.Q4d])),this.ydd=!0)}catch(Va){this.ydd=!1,O.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Va}`)}this.eh.raiseEvent("ltpoiek",new Eb(this.iGc))}};this.QDj=Va=>{this.eh.raiseEvent("ltoek",new qd(Va))};this.$=fb;this.$.fa.um?this.Lm():J.EwaSettings.ul()?
this.$.fa.lr(this.Lm):this.$.fa.mr(this.Lm)}get iGc(){return this.ydd}N5e(fb){this.eh.addHandler("ltoek",fb)}npk(fb){this.eh.removeHandler("ltoek",fb)}pEh(fb){this.eh.addHandler("ltpoiek",fb)}opk(fb){this.eh.removeHandler("ltpoiek",fb)}dispose(){J.EwaSettings.ul()||this.$.fa.av(this.Lm);l.a.gh(this.eh);this.$=this.eh=null}}Object(t.a)(vc,"LongTaskPerformanceObserver",null,[2]);var Kd=a(187);class Zd{constructor(fb,Va){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===
fb?0:fb;this.longTaskDuration=void 0===Va?0:Va}get R4d(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}Huj(fb){return 100*this.R4d>fb}DBh(fb){this.M4e(fb.longTaskDuration);this.xpd(fb.activeSessionDuration)}M4e(fb){this.longTaskDuration+=fb}xpd(fb){this.activeSessionDuration+=fb}}Object(t.a)(Zd,"LongTaskPerformanceData",null,[]);class nb{constructor(fb,Va,bd,je,se){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;
this.maxUsersCount=0;this.isVetoSession=fb;this.entireSessionData=Va;this.worstWindowData=bd;this.postBootWindowData=je;this.maxUsersCount=se}get reportName(){return"LongTaskPerformance"}static get Jli(){return new nb(!1,new Zd,new Zd,new Zd,0)}}Object(t.a)(nb,"LongTaskPerformanceDataStatistics",null,[182]);class ic extends Sys.EventArgs{constructor(fb){super();this.S4d=fb}}Object(t.a)(ic,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Bc=a(442),Qc=a(337),pd=a(363);class Xd{constructor(fb,Va){this.eh=
new x.a;this.u3a=this.Qha=this.x3=this.Lk=null;this.u6f=this.Cte=this.HKc=!1;this.Y3a=null;this.maxUsersCount=0;this.oQc=(bd,je)=>{bd=je.xvf.getEntriesByType($a.a.Q4d);for(const se of bd)this.Lk.iN(se.duration)||ba.AFrameworkApplication.$2a||(this.x3.M4e(se.duration),this.eh.raiseEvent("lttek",new ic(se)),bd={},bd.LongTaskDuration=se.duration,bd.LongTaskStartTime=se.startTime,O.ULS.sendTraceTag(187982418,0,50,JSON.stringify(bd)))};this.Lm=()=>{this.Cte=!0;this.H$b()};this.aF=(bd,je)=>{je&&(this.maxUsersCount=
Math.max(this.maxUsersCount,je.n9g));this.Qha.maxUsersCount=this.maxUsersCount};this.Dj=()=>{this.H$b()};this.Xi=()=>{this.M$b()};this.eog=(bd,je)=>{je.iGc&&this.H$b()};this.hag=()=>{this.x3.xpd(A.getElapsedMilliseconds(this.u3a,z.a.kh.vi));this.Mve(!0);var bd=!1;this.Qha.postBootWindowData.activeSessionDuration?(!this.u6f&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Ad.b().eIg(2),$b.Health.instance.recordKpiUsage(Qc.a.longJsTask,pd.b.FailureBased,Bc.a.Kvj,null),
this.u6f=!0),!this.Qha.isVetoSession&&this.x3.Huj(this.r$g)&&(this.Qha.isVetoSession=!0,J.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Ad.b().fIg(2,this.ODj),$b.Health.instance.recordKpiFailure(Qc.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.Qha.worstWindowData.R4d<=this.x3.R4d&&(this.Qha.worstWindowData=this.x3),this.Qha.entireSessionData.DBh(this.x3)):(this.Qha.postBootWindowData=new Zd(this.x3.activeSessionDuration,this.x3.longTaskDuration),bd=
!0);const je={};je.LastWindowScore=this.x3;je.postBootWindow=bd;je.CoauthersNumber=this.$.fa.pu.length;bd=JSON.stringify(je);O.ULS.sendTraceTag(20779346,0,50,bd);this.x3=new Zd};this.hPc=()=>{this.Lk.Xn||ba.AFrameworkApplication.$2a||this.Mve(!1)};this.gPc=()=>{this.x3.xpd(A.getElapsedMilliseconds(this.u3a,z.a.kh.vi));this.u3a=null;this.Y3a.cancel()};this.$=fb;this.r$g=fb.ua.LongTaskPerformanceVetoThreshold;this.ODj="PercentageOver_"+this.r$g.toString();this.T4d=fb.ua.LongTaskPerformanceWindowDurationInMs;
this.aZ=Va;J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void G.a.resolve(D.Db).then(bd=>{this.Lk=bd;this.H$b()}):this.$.qa.zi(291,bd=>{this.Lk=bd;this.H$b()});this.$.fa.um?this.Lm():J.EwaSettings.ul()?this.$.fa.lr(this.Lm):this.$.fa.mr(this.Lm);this.aZ.pEh(this.eog);this.$.nr(this.Dj);this.$.Pp(this.Xi)}qEh(fb){this.eh.addHandler("lttek",fb)}ppk(fb){this.eh.removeHandler("lttek",fb)}dispose(){this.Cte=!1;this.M$b();this.$.$r(this.Dj);this.$.wu(this.Xi);
this.aZ.opk(this.eog);l.a.gh(this.Y3a);this.aZ=this.$=this.Y3a=null;void 0!==this.Lk&&null!==this.Lk&&l.a.gh(this.Lk)}H$b(){void 0===this.Lk||null===this.Lk?O.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.aZ.iGc?this.HKc?O.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.Cte?(this.HKc=
!0,this.Qha=nb.Jli,this.x3=new Zd,this.$.fa.$ea(this.aF),this.maxUsersCount=this.$.fa.pu.length,this.aZ.N5e(this.oQc),this.Lk.Zea(this.gPc),this.Lk.y4(this.hPc),ba.AFrameworkApplication.b5e(this.gPc),ba.AFrameworkApplication.c5e(this.hPc),this.Y3a=ya.a.instance.create(this.hag,this.T4d,Oa.a.n$f,!1),Oe.a(this.$).v$(this.Qha),this.Lk.Xn||ba.AFrameworkApplication.$2a||this.Mve(!0),O.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):O.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):O.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}M$b(){this.HKc&&(this.HKc=!1,J.EwaSettings.ul()||this.$.fa.av(this.Lm),this.aZ.npk(this.oQc),this.$.fa.l8(this.aF),void 0!==this.Lk&&null!==this.Lk&&(this.Lk.Gvb(this.gPc),this.Lk.jPa(this.hPc)),
ba.AFrameworkApplication.wnk(this.gPc),ba.AFrameworkApplication.xnk(this.hPc),this.Y3a.cancel(),this.u3a=this.x3=this.Qha=null,this.maxUsersCount=0)}Mve(fb){fb||void 0===this.u3a||null===this.u3a?(this.u3a=z.a.kh.vi,this.Y3a=Kd.AsyncMethodContext.yNb(this.hag,fb?this.T4d:this.T4d-this.x3.activeSessionDuration,Oa.a.n$f,this.Y3a)):O.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}
Object(t.a)(Xd,"LongTaskPerformanceTracker",null,[2]);var ue=a(25);class Ie extends x.a{constructor(fb,Va){super();this.statusBarManager=this.Lk=null;this.fog=(bd,je)=>{je.S4d&&je.S4d.duration>=this.RDj&&(this.Aag++,this.W6f=je.S4d.duration)};this.$=fb;this.$.qa.zi(29,bd=>{this.statusBarManager=bd;bd.vO(this)});J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void G.a.resolve(D.Db).then(bd=>{this.Lk=bd}):this.$.qa.zi(291,bd=>{this.Lk=bd});this.W6f=
this.Aag=0;this.RDj=fb.ua.LongTaskThresholdMs;this.nrb=Va;this.nrb.qEh(this.fog)}ry(fb){this.addHandler("LTSCEK",fb)}fy(fb){this.removeHandler("LTSCEK",fb)}ew(){this.Up("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}Aw(fb,Va){if("QueryLongTasksCount"!==fb)return!1;this.B5i(Va);return!0}Up(){return J.EwaSettings.Na(505)}dispose(){this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null);this.nrb.ppk(this.fog);super.dispose()}B5i(fb){const Va=`Long Tasks: ${this.Aag} | Last Task Duration: ${Math.round(this.W6f)}ms`;
ue.a.Qo(this.$)?(fb.LabelText=Va,fb.Visible=!0):fb.Value=Va}}Object(t.a)(Ie,"LongTasksStatusBarManager",x.a,[2,176,177]);var Je=a(13);class He{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(t.a)(He,"NetworkInfoData",null,[]);class hf extends x.a{constructor(fb){super();this.statusBarManager=null;this.fpd=!1;this.Ggg=()=>{this.raiseEvent("NetworkInformation")};this.$=fb;J.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&
(this.NS=this.Lze("connection")||this.Lze("mozConnection")||this.Lze("webkitConnection"))&&J.EwaSettings.Na(410)&&fb.qa.zi(29,Va=>{this.statusBarManager=Va;Va.vO(this);this.NS.addEventListener("change",this.Ggg);this.fpd=!0})}ry(fb){this.addHandler("NetworkInformation",fb)}fy(fb){this.removeHandler("NetworkInformation",fb)}tKa(){return this.NS?Object(oa.a)(new He,{bandwidthMps:this.NS.downlink,rttMs:this.NS.rtt,connectionType:this.NS.type,effectiveConnection:this.NS.effectiveType,downlinkMaxMps:this.NS.downlinkMax}):
null}Aw(fb,Va){if("QueryNetworkInformation"!==fb)return!1;this.C5i(Va);return!0}Up(){return this.fpd}dispose(){this.fpd&&(this.statusBarManager&&(this.statusBarManager.GN(this),this.statusBarManager=null),this.NS&&this.NS.removeEventListener("change",this.Ggg));this.$=null;super.dispose()}Lze(fb){return Je.HelperMethods.aw(window.navigator,fb)?window.navigator[fb]:null}C5i(fb){const Va="Network: "+this.NS.downlink.toString()+" Mbps, "+this.NS.rtt.toString()+" ms";ue.a.Qo(this.$)?(fb.LabelText=Va,
fb.Visible=!0):fb.Value=Va}}Object(t.a)(hf,"NetworkInformationManager",x.a,[176,177]);class rf{constructor(fb,Va,bd,je,se,Xe,wf,Nf,fg,Of){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===fb?"":fb;this.startTime=void 0===Va?-1:Va;this.startToNextFrame=void 0===bd?-1:bd;this.startToResponseRenderEnd=
void 0===je?-1:je;this.wasHidden=void 0===se?!1:se;this.isUserOperation=void 0===Xe?!0:Xe;this.isGroupBreaking=void 0===wf?!0:wf;this.operationThatLedToLogging=void 0===fg?"":fg;this.startToOperationThatLedToLogging=void 0===Of?-1:Of;this.isPartOfGroup=void 0===Nf?!1:Nf}}Object(t.a)(rf,"OperationStatisticsData",null,[]);class qf{constructor(){this.JRc=null;this.Ibj()}isGroup(fb,Va,bd){const je=new Mb.a;je.addRange(fb);je.addRange(Va);for(let se=0;se<this.JRc.count;se++)if(this.vqj(this.JRc.ma(se),
je,bd))return O.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${bd}' is part of a group ( operationsList: ${this.xug(fb)} , frameOperationsList: ${this.xug(Va)})`),!0;O.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${bd}' is NOT part of a group.`);return!1}vqj(fb,Va,bd){let je=0;for(let se=0;se<Va.count;se++)if(Va.ma(se).isGroupBreaking){if(fb.count<=je||!ha.a.equals(Va.ma(se).name,fb.ma(je),!0))return!1;je++}return fb.count>je&&ha.a.equals(bd,fb.ma(je),
!0)}xug(fb){return`[${fb.toArray().map(Va=>Va.name).join(", ")}]`}Ibj(){this.JRc=new Mb.a;this.Teb(new Mb.a(["Paste","SelectingRange_unknown"]));this.Teb(new Mb.a(["AutoSum","SelectingRange_unknown"]));this.Teb(new Mb.a(["ChangeSheetDirection","ActiveItemChanged"]));this.Teb(new Mb.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.Teb(new Mb.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.Teb(new Mb.a(["EditBoxEndEdit","SetCell","SelectingRange_keyboard",
"MoveDownWithinSelectionOrCommitEdit"]))}Teb(fb){this.JRc.add(fb)}}Object(t.a)(qf,"OperationsGroupDetector",null,[]);var We=a(26);class Jf{constructor(fb,Va,bd,je){this.w6b=this.qca=this.qda=null;this.Dsk=()=>{this.Drd=-1;const se=Je.HelperMethods.Mh();this.Jbl(se);this.N7b&&(O.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.Pbc(this.bP,se),this.N7b=!1);this.JIc&&(this.Pbc(this.fQ,se),this.N7b||this.Pbc(this.bP,
se));window.setTimeout(this.yBj,0)};this.yBj=()=>{var se=[];const Xe=this.$.ua.OperationToPrevOperationThreshold;for(var wf=0;wf<this.bP.count;wf++){var Nf=this.bP.ma(wf);wf<Xe&&se.push(Nf);this.fQ.add(Nf)}H.f(this.$)&&H.f(this.$).za?((wf=this.sessionStatisticsManager.ULd(0))?(Nf=JSON.stringify(this.G_b),se=JSON.stringify(se),O.ULS.sendTraceTag(237798547,1,50,`DOM count: (${wf.SHj}, ${wf.RMh}, ${wf.CGj}), long tasks: ${Nf}, operations count: ${this.bP.count}, operations: ${se}`)):O.ULS.sendTraceTag(537153876,
1,50,"Report Manager NumberOfDomElements does not exist"),this.bP.count>Xe&&O.ULS.sendTraceTag(537153875,1,50,`More than ${Xe} operations are in the operationsList. count: ${this.bP.count}`),this.bP.clear(),this.G_b.clear()):O.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.oQc=(se,Xe)=>{this.PDj(Xe.xvf)};this.$=fb;this.wT=Va;this.$p=this.$p||z.a.kh;this.fQ=new Mb.a;this.bP=new Mb.a;this.Drd=this.Aqb=-1;this.G_b=new Mb.a;this.k4j=new qf;this.N7b=this.JIc=!1;this.jcj();
this.Kbj();this.Jbj();this.sessionStatisticsManager=bd;this.aZ=je;this.aZ.N5e(this.oQc)}D6b(fb){var Va=Je.HelperMethods.Mh();const bd=this.k4j.isGroup(this.fQ,this.bP,fb);(this.JIc=this.Lpj(fb))&&0<this.fQ.count&&!bd&&(this.Dal(),this.Cal(fb,Va),this.pzi());this.Aqb=-1;if(H.f(this.$)&&H.f(this.$).za){var je=!this.qda.contains(fb);Va=new rf(fb,Va,void 0,void 0,void 0,je,this.JIc,bd);this.bP.add(Va);!this.N7b&&this.w6b.contains(fb)&&(this.N7b=!0);-1===this.Drd&&(this.Drd=window.requestAnimationFrame(this.Dsk))}else O.ULS.sendTraceTag(537153879,
1,10,"Grid == null or BlockManager == null")}oWc(){this.Aqb=Je.HelperMethods.Mh()}xWc(){this.fQ.count||this.bP.count?(this.Pbc(this.bP,this.Aqb),this.Pbc(this.fQ,this.Aqb)):O.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistent when no operations in the list. Last block render time: ${this.Aqb}`);this.Aqb=-1}Lpj(fb){return!this.qca.contains(fb)&&!fb.includes("Menu")&&!fb.includes("TellMe")}pzi(){for(let fb=0;fb<this.fQ.count;fb++){const Va=this.fQ.ma(fb);this.wT.jxh(Va);this.eCj(Va)}this.fQ.clear()}Jbl(fb){for(let Va=
0;Va<this.bP.count;Va++)this.bP.ma(Va).startToNextFrame=this.mOd(this.bP.ma(Va).startTime,fb),this.bP.ma(Va).wasHidden=sc.a.iN(this.bP.ma(Va).startToNextFrame)}Cal(fb,Va){for(let bd=0;bd<this.fQ.count;bd++)-1===this.fQ.ma(bd).startToResponseRenderEnd&&(this.fQ.ma(bd).operationThatLedToLogging=fb,this.fQ.ma(bd).startToOperationThatLedToLogging=this.mOd(this.fQ.ma(bd).startTime,Va))}Dal(){var fb=!1;for(const Va of this.fQ)if(Va.isPartOfGroup){fb=!0;break}if(fb)for(fb=0;fb<this.fQ.count;fb++)this.fQ.ma(fb).isPartOfGroup=
this.fQ.ma(fb).isGroupBreaking}Pbc(fb,Va){for(let bd=0;bd<fb.count;bd++)fb.ma(bd).startToResponseRenderEnd=this.mOd(fb.ma(bd).startTime,Va),fb.ma(bd).wasHidden=sc.a.iN(fb.ma(bd).startToResponseRenderEnd)}eCj(fb){fb=JSON.stringify(fb);O.ULS.sendTraceTag(2020372336,1,50,`${fb}`)}mOd(fb,Va){return-1===fb?-1:-1===Va?-2:Va-fb}PDj(fb){fb=fb.getEntriesByType($a.a.Q4d);for(let Va=0;Va<fb.length;Va++)if(30>this.G_b.count)if(this.bP.count)this.G_b.add(this.y7j(fb[Va]));else{const bd=fb[Va];if(null===bd||void 0===
bd?0:bd.attribution)void 0!==bd.attribution.containerSrc&&null!==bd.attribution.containerSrc&&(bd.attribution.containerSrc=""),void 0!==bd.attribution.containerId&&null!==bd.attribution.containerId&&(bd.attribution.containerId=""),void 0!==bd.attribution.containerName&&null!==bd.attribution.containerName&&(bd.attribution.containerName="");O.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{O.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${fb.length} First long task: ${this.G_b.ma(0)}`);
break}}y7j(fb){return`name:${fb.name}, startTime:${fb.startTime}, duration:${fb.duration}`}jcj(){this.qda||(this.qda=new Ee.a(hd.a.tm()),this.qda.add("ActiveItemChanged"),this.qda.add(Ad.b().kp(-1398645260)),this.qda.add(Ad.b().kp(722290388)),this.qda.add(Ad.b().kp(974713501)),this.qda.add(We.a.l1(We.a.xsc)),this.qda.add(We.a.l1(We.a.wsc)),this.qda.add(We.a.l1(We.a.oMb)),this.qda.add(We.a.l1(We.a.Yzg)),this.qda.add(We.a.l1(We.a.Gqa)))}Kbj(){this.qca||(this.qca=new Ee.a(hd.a.tm()),this.qca.add("PromptEditInBrowser"),
this.qca.add(Ad.b().kp(-1398645260)),this.qca.add(Ad.b().kp(722290388)),this.qca.add(Ad.b().kp(974713501)),this.qca.add(We.a.l1(We.a.xsc)),this.qca.add(We.a.l1(We.a.wsc)),this.qca.add(We.a.l1(We.a.oMb)),this.qca.add(We.a.l1(We.a.Yzg)),this.qca.add(We.a.l1(We.a.Gqa)))}Jbj(){this.w6b||(this.w6b=new Ee.a(hd.a.tm()),this.w6b.add("SelectingRange_keyboard"),this.w6b.add("SelectingRange_mouse"))}}Object(t.a)(Jf,"OperationStatistics",null,[]);var tf=a(703);class ff{constructor(fb,Va){this.messageIdName=null;
this.errorCause=0;this.messageIdName=fb;this.errorCause=Va}}Object(t.a)(ff,"RequestError",null,[]);class xf{constructor(fb,Va,bd,je,se,Xe,wf,Nf,fg,Of,Bg,uf,Lg,zg,mh,Cg,Sf){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=
!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=fb;this.isUserTriggeredRequest=xf.HPi(fb);this.isFullyLoggedKPIRequest=xf.xPi(fb);this.isPromotedUTRRequest=xf.zPi(fb);this.requestDuration=Va;this.totalOperationDuration=bd;this.requestTimeInQueue=je;this.requestInvokedTime=
se;this.ecsOperationDuration=Xe.EcsOperationDuration;this.EcsRequestDuration=Xe.EcsRequestDuration;this.WfeRequestDuration=Xe.WfeRequestDuration;this.TimeFromLastEcsFreeze=Xe.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=Xe.DuringLoadOnDemand;this.correlationID=wf;this.errors=xf.m2h(Nf);this.httpStatus=fg;this.requestResourceTiming=Of;this.communicationErrorRetryCount=Bg;this.successfulCall=uf;this.isDocumentHidden=Lg;this.coauthorsCount=zg;this.responseSize=mh;this.networkInfoData=Cg;this.responseToCallbackTime=
Sf}static m2h(fb){if(!fb)return[];const Va=[];for(const bd of fb)Va.push(new ff(bd.MessageIdName,bd.ErrorCause));return Va}static HPi(fb){return!xf.LLj.contains(fb)}static qSi(){const fb=new Ee.a(hd.a.tm());fb.add("CheckPersistedContentUpdate");fb.add("GetContentBundle");fb.add("GetSessionStatus");fb.add("GetStatusBarAggregates");fb.add("PollSessionStatus");fb.add("UpdatePresenceUsers");fb.add("UploadLatencyTelemetry");return fb}static xPi(fb){return xf.JBi.contains(fb)}static zPi(fb){return xf.Cck.contains(fb)}static SNi(){const fb=
new Ee.a(hd.a.tm());fb.add("SetRichTextCell");fb.add("Copy");fb.add("FormatCells");fb.add("PasteRange");fb.add("FindCell");fb.add("ApplyToRangesV2");fb.add("ResizeRowsColumns");fb.add("InsertDeleteCells");fb.add("FillRange");fb.add("PasteHtmlContent");fb.add("ApplyFilter");fb.add("PasteString");fb.add("Undo");fb.add("LineageUpdateView");fb.add("FindAll");fb.add("ApplyHyperlink");fb.add("AutoFit");fb.add("GetPrintSettings");fb.add("GetEdgeCell");fb.add("Paste");fb.add("MoveAndResizeFloatingObject");
fb.add("FindRange");fb.add("SetCustomFilter");fb.add("RenameSheet");fb.add("ApplyThreadedComment");fb.add("SortFilterColumn");fb.add("InsertCopiedCutCellsV2");fb.add("InsertSheet");fb.add("ToggleAutoFilter");fb.add("ReorderSheets");fb.add("SetOutlineLevel");fb.add("RefreshAll");fb.add("LineageOpenPaneOrChangeFilter");fb.add("ApplySlicerSelection");fb.add("GetCardViewCardByCell");fb.add("AutoSum");fb.add("LineageClosePane");fb.add("Sort");fb.add("ClearAutoFilter");fb.add("DeleteSheet");fb.add("Redo");
J.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(fb.add("RemovePageBreak"),fb.add("InsertPageBreak"),fb.add("SetPrintArea"),fb.add("ClearPrintArea"));return fb}static APi(){const fb=new Ee.a(hd.a.tm());fb.add("DeleteConditionalFormattingRules");fb.add("GetConditionalFormattingRules");fb.add("AddConditionalFormattingRule");fb.add("QuickEditConditionalFormattingRule");fb.add("GetPrintSettings");fb.add("UpdatePresenceUsers");fb.add("GetThemeInfo");fb.add("InsertCopiedCutCellsV2");
fb.add("PasteRange");fb.add("FillRange");fb.add("InsertCopiedCutCellsCrossSession");J.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(fb.add("LineageOpenPaneOrChangeFilter"),fb.add("LineageUpdateView"),fb.add("LineageRefreshView"),fb.add("LineageLoadMore"));J.EwaSettings.isChangeGateEnabled("OfficeVSO:8609133_PromoteGetNumberFormatViewModelData")&&fb.add("GetNumberFormatViewModelData");fb.add("PasteString");return fb}}xf.LLj=xf.qSi();xf.JBi=xf.SNi();xf.Cck=xf.APi();Object(t.a)(xf,
"RequestStatisticsData",null,[]);class Lf{constructor(fb,Va,bd){this.$=fb;this.wT=Va;this.Yza=bd}BWc(fb,Va,bd,je,se,Xe,wf,Nf,fg,Of,Bg,uf,Lg,zg){uf=tf.a(uf);fb=new xf(fb,Va,bd,je,se,Xe,wf,Nf,fg,uf,Of,Bg,sc.a.iN(Va),this.ANd(null),Lg,this.Yza.tKa(),zg);this.Lle(fb)}Ap(fb,Va){fb="UnknownMethodName";var bd=-1;void 0!==Va.context&&null!==Va.context&&(fb=Va.context.methodName,bd=Va.context.communicationErrorRetryCount);let je,se={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,
DuringLoadOnDemand:!1};Va.lk?(je=Va.lk.Errors||[],this.wT.wsk(Va.lk.EditSessionIsDirty),void 0!==Va.lk.RequestTelemetryData&&null!==Va.lk.RequestTelemetryData&&(se=Va.lk.RequestTelemetryData)):je=[];const Xe=Va.duration,wf=tf.a(Va.url);fb=new xf(fb,Xe,Va.totalOperationDuration,Va.iye,Va.EP,se,Va.upe,je,Va.httpStatus,wf,bd,!0,sc.a.iN(Xe),this.ANd(Va.lk),Va.responseSize,this.Yza.tKa(),Va.responseToCallbackTime);this.Lle(fb);fb.requestResourceTiming&&(bd=fb.requestResourceTiming.totalDuration-fb.WfeRequestDuration,
bd>=this.$.ua.LongNetworkTimeTelemetryThresholdInMilliseconds&&Va.responseHeaders&&O.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${fb.requestName}, requestDuration = ${fb.requestDuration}, networkTime = ${bd},  ServerCorrelation = ${fb.correlationID}, msEdgeHeader = ${$a.a.K0b in Va.responseHeaders?Va.responseHeaders[$a.a.K0b]:""}, backendDatacenter = ${$a.a.n9d in Va.responseHeaders?Va.responseHeaders[$a.a.n9d]:""}, proxyDatacenter = ${$a.a.p9d in
Va.responseHeaders?Va.responseHeaders[$a.a.p9d]:""}`))}Xy(fb,Va){fb="UnknownMethodName";let bd=-1;void 0!==Va.context&&null!==Va.context&&(fb=Va.context.methodName,bd=Va.context.communicationErrorRetryCount);const je=Va.duration,se=tf.a(Va.url);Va=new xf(fb,je,Va.totalOperationDuration,Va.iye,Va.EP,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},Va.upe,Va.errors||[],Va.httpStatus,se,bd,!1,sc.a.iN(je),this.ANd(null),-1,this.Yza.tKa(),
Va.responseToCallbackTime);this.Lle(Va)}Lle(fb){this.wT.HHh(fb);if(J.EwaSettings.Na(212)){var Va=fb.requestName;if(Va!==$a.a.AKa&&"SetCell"!==Va&&"FindRange"!==Va&&"FindAll"!==Va&&"FindCell"!==Va)return}Va=J.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===fb.requestName||null===fb.requestName)&&fb.isPromotedUTRRequest;Lf.Hji(fb,Va);this.wT.kxh(fb)}ANd(fb){var Va;if(null===(Va=null===fb||void 0===fb?void 0:fb.CollaborationResult)||void 0===Va?0:Va.Users)return fb.CollaborationResult.Users.length;
fb=this.$.fa.pu.length;return 0<fb?fb:1}static Hji(fb,Va){Va?Ad.b().BYc(388829456,0,15,fb):(Va=Sys.Serialization.JavaScriptSerializer.serialize(fb),O.ULS.sendTraceTag(388829456,0,50,Va));if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==fb.requestName&&null!==fb.requestName&&fb.isFullyLoggedKPIRequest){Va=new Map;Va.set("isUserTriggeredRequest",fb.isUserTriggeredRequest.toString());Va.set("requestDuration",fb.requestDuration.toString());Va.set("totalOperationDuration",
fb.totalOperationDuration.toString());Va.set("requestTimeInQueue",fb.requestTimeInQueue.toString());Va.set("requestInvokedTime",fb.requestInvokedTime.toString());Va.set("ecsOperationDuration",fb.ecsOperationDuration.toString());Va.set("ecsRequestDuration",fb.EcsRequestDuration.toString());Va.set("wfeRequestDuration",fb.WfeRequestDuration.toString());Va.set("timeFromLastEcsFreeze",fb.TimeFromLastEcsFreeze.toString());Va.set("duringLoadOnDemand",fb.DuringLoadOnDemand.toString());Va.set("correlationID",
fb.correlationID);Va.set("errors",fb.errors.toString());Va.set("httpStatus",fb.httpStatus.toString());if(fb.networkInfoData){var bd=fb.networkInfoData;Va.set("networkInfoData_bandwidthMps",void 0===bd.bandwidthMps||null===bd.bandwidthMps?"NA":bd.bandwidthMps.toString());Va.set("networkInfoData_rttMs",void 0===bd.rttMs||null===bd.rttMs?"NA":bd.rttMs.toString());Va.set("networkInfoData_effectiveConnection",void 0===bd.effectiveConnection||null===bd.effectiveConnection?"NA":bd.effectiveConnection)}fb.requestResourceTiming&&
(bd=fb.requestResourceTiming,Va.set("requestResourceTiming_fetchStart",void 0===bd.downloadDuration||null===bd.downloadDuration?"NA":bd.downloadDuration.toString()));Va.set("communicationErrorRetryCount",fb.communicationErrorRetryCount.toString());Va.set("successfulCall",fb.successfulCall.toString());Va.set("isDocumentHidden",fb.isDocumentHidden.toString());Va.set("coauthorsCount",fb.coauthorsCount.toString());Va.set("responseSize",fb.responseSize.toString());Va.set("responseToCallbackTime",fb.responseToCallbackTime.toString());
Ad.b().yWc(fb.requestName,fb.successfulCall,Va)}}}Object(t.a)(Lf,"RequestStatistics",null,[]);var Ig=a(238),vf=a(64),rg=a(267);class jg{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(t.a)(jg,"OperationTypeStatisticsData",null,[]);class sg{constructor(fb,Va){this.data=new jg;this.data.operationName=fb;this.data.isUserOperation=Va;this.data.totalCount=
0;this.iZg=[];this.jZg=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}sj(fb){this.data.totalCount<sg.cEd&&(this.iZg.push(fb.startToNextFrame),this.jZg.push(fb.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<fb.startToNextFrame&&(this.data.longestStartToNextFrame=fb.startToNextFrame);this.data.longestStartToResponse<fb.startToResponseRenderEnd&&(this.data.longestStartToResponse=
fb.startToResponseRenderEnd)}SHd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.kLf(this.iZg),this.data.startToResponsePercentiles=this.kLf(this.jZg))}kLf(fb){fb.sort(Je.HelperMethods.SS);let Va;Va="("+sc.a.nxa(fb,25).toString();Va=Va+", "+sc.a.nxa(fb,50).toString();Va=Va+", "+sc.a.nxa(fb,75).toString();Va=Va+", "+sc.a.nxa(fb,95).toString();return Va+")"}}sg.cEd=1E3;Object(t.a)(sg,"OperationTypeStatistics",null,[]);class af{constructor(){this.requestName=null;this.averageWfeDuration=
this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(t.a)(af,"RequestTypeStatisticsData",null,[]);class Ef{constructor(fb){this.data=new af;this.data.requestName=fb;this.data.totalCount=0;this.awb=
[];this.fze=this.Yye=this.Zye=this.cze=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=-1}ctk(fb){this.data.totalCount<Ef.cEd&&this.awb.push(fb.requestDuration);this.data.totalCount++;this.cze+=fb.requestDuration;this.Zye+=Ef.NKd(fb.ecsOperationDuration);this.Yye+=
Ef.NKd(fb.EcsRequestDuration);this.fze+=Ef.NKd(fb.WfeRequestDuration);0<fb.TimeFromLastEcsFreeze&&fb.TimeFromLastEcsFreeze<Ef.uBi&&this.data.callsDuringEcsFreeze++;fb.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;fb.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<fb.requestDuration)this.data.longestRequest=fb}SHd(){0<this.data.totalCount&&(this.data.averageDuration=
Math.floor(this.cze/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.Zye/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.Yye/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.fze/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.awb.sort(Je.HelperMethods.SS),this.data.requestDurationPercentile25=sc.a.nxa(this.awb,
25),this.data.requestDurationPercentile50=sc.a.nxa(this.awb,50),this.data.requestDurationPercentile75=sc.a.nxa(this.awb,75),this.data.requestDurationPercentile95=sc.a.nxa(this.awb,95))}static NKd(fb){return 0>fb?0:fb}}Ef.uBi=3E3;Ef.cEd=1E3;Object(t.a)(Ef,"RequestTypeStatistics",null,[]);class be{constructor(fb,Va,bd,je,se,Xe,wf,Nf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=
!1;this.requests=null;this.mode=fb;this.ocsCapable=Va;this.endedBySplashScreen=bd;this.dirtySessionOnLastRecordedRequest=je;this.loadOnDemandCount=se;this.maxCoauthorsCount=Xe;this.everConnectedToOcs=wf;fb=[];for(const fg in Nf)Va=Nf[fg],Va.SHd(),fb.push(Va.data);this.requests=fb}}Object(t.a)(be,"SessionStatisticsData",null,[]);class h{constructor(fb){this.dirtySessionOnLastRecordedRequest=this.Fve=!1;this.K8f=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=fb;this.VHb={};this.UHb={};
this.FBd={}}Xi(){var fb=this.qbi();if(qa.a.KBa()){var Va={};Va.xlendJson=fb;this.$.PPa(Ig.a.Fhl,Va,!1)}else vf.P(this.$.oa.ta,fb,null,null,null,null,null);fb=this.rbi();qa.a.KBa()?(Va={},Va.xlenoJson=fb,this.$.PPa(Ig.a.Ghl,Va,!1)):O.ULS.sendTraceTag(388776782,0,50,fb);fb=this.J6h();qa.a.KBa()?(Va={},Va.xlencJson=fb,this.$.PPa(Ig.a.Ehl,Va,!1)):O.ULS.sendTraceTag(388776770,0,50,fb);this.Rtk()}MKc(){this.everConnectedToOcs=this.$.fa.cqb||this.everConnectedToOcs;$b.Health.instance&&$b.Health.instance.addOrUpdatePartCDimension("IsOcsSession",
this.everConnectedToOcs.toString())}Lm(){const fb=new rg.a;let Va="";const bd=!this.$.isAnonymousUser(),je=fb.zl();if(je){if(bd){fb.R8b("UMI_Linkable","true");return}Va=fb.H_a("UMI_Linkable")}bd||O.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${je}, UMIIsLinkable:${!!Va}`)}Zvb(){this.Fve=!0}wsk(fb){this.dirtySessionOnLastRecordedRequest=fb}HHh(fb){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,fb.coauthorsCount);$b.Health.instance&&
$b.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}kxh(fb){if(!(fb.requestName in this.VHb)){const Va=new Ef(fb.requestName);this.VHb[fb.requestName]=Va}this.VHb[fb.requestName].ctk(fb)}jxh(fb){if(!(fb.name in this.UHb)){const Va=new sg(fb.name,fb.isUserOperation);this.UHb[fb.name]=Va}this.UHb[fb.name].sj(fb)}v$(fb){this.FBd[fb.reportName]=fb}Rtk(){this.dirtySessionOnLastRecordedRequest=this.Fve=!1;this.K8f=this.$.fa.w3d;this.maxCoauthorsCount=1;this.everConnectedToOcs=
!1;this.VHb={};this.UHb={};this.FBd={}}qbi(){const fb=new be(this.$.isEditMode?"edit":"view",this.$.fa.ocsCapable,this.Fve,this.dirtySessionOnLastRecordedRequest,this.$.fa.w3d-this.K8f,this.maxCoauthorsCount,this.everConnectedToOcs,this.VHb);return Sys.Serialization.JavaScriptSerializer.serialize(fb)}rbi(){var fb=new Mb.a;const Va=this.UHb;for(const bd in Va){const je=Va[bd];je.SHd();fb.add(je.data)}fb=fb.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(fb)}J6h(){return Sys.Serialization.JavaScriptSerializer.serialize(this.FBd)}}
Object(t.a)(h,"SessionStatistics",null,[]);class qc extends xd.a{constructor(fb){super();this.oBa=this.AAa=null;this.wof=Array(1);this.tgd=this.U4d=null;this.Ap=(Va,bd)=>{J.EwaSettings.Na(39)&&(this.oBa=this.oBa||new Lf(this.$,this.wT,this.Yza),this.oBa.Ap(Va,bd))};this.Xy=(Va,bd)=>{J.EwaSettings.Na(39)&&(this.oBa=this.oBa||new Lf(this.$,this.wT,this.Yza),this.oBa.Xy(Va,bd))};this.Xi=(Va,bd)=>{J.EwaSettings.Na(39)&&this.wT.Xi(Va,bd)};this.Lm=()=>{J.EwaSettings.Na(39)&&this.wT.Lm()};this.MKc=(Va,bd)=>
{J.EwaSettings.Na(39)&&this.wT.MKc(Va,bd)};this.$=fb;J.EwaSettings.Na(39)&&(sc.a.RVf(this.$),this.aZ=new vc(this.$),this.C8h(),J.EwaSettings.Na(505)&&this.nrb&&(this.U4d=new Ie(this.$,this.nrb)),this.wT=new h(this.$),this.Yza=new hf(this.$),this.$.Pp(this.Xi),this.$.oa.MI(this.Ap),this.$.oa.CX(this.Xy),this.$.fa.H5e(this.MKc),J.EwaSettings.ul()?this.$.fa.lr(this.Lm):this.$.fa.mr(this.Lm))}get nrb(){return this.tgd}dispose(){this.$&&J.EwaSettings.Na(39)&&(this.$.wu(this.Xi),this.$.oa.oL(this.Ap),this.$.oa.KZ(this.Xy),
this.$.fa.yGg(this.MKc),J.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.fa.av(this.Lm));l.a.gh(this.Yza);l.a.gh(this.nrb);this.tgd=null;l.a.gh(this.aZ);this.aZ=null;l.a.gh(this.U4d);this.$=this.U4d=null;super.dispose()}Zvb(){J.EwaSettings.Na(39)&&this.wT.Zvb()}BWc(fb,Va,bd,je,se,Xe,wf,Nf,fg,Of,Bg,uf,Lg,zg){J.EwaSettings.Na(39)&&(this.oBa=this.oBa||new Lf(this.$,this.wT,this.Yza),this.oBa.BWc(fb,Va,bd,je,se,Xe,wf,Nf,fg,Of,Bg,uf,Lg,zg))}D6b(fb,Va){J.EwaSettings.Na(39)&&
(this.AAa=this.AAa||new Jf(this.$,this.wT,this,this.aZ),this.AAa.D6b(fb,Va))}oWc(){J.EwaSettings.Na(39)&&(this.AAa=this.AAa||new Jf(this.$,this.wT,this,this.aZ),this.AAa.oWc())}xWc(){J.EwaSettings.Na(39)&&(this.AAa=this.AAa||new Jf(this.$,this.wT,this,this.aZ),this.AAa.xWc())}v$(fb){J.EwaSettings.Na(39)&&this.wT.v$(fb)}ULd(fb){return J.EwaSettings.Na(39)?this.wof[fb]:null}MPg(fb){fb&&(this.wof[fb.type]=fb)}tKa(){return this.Yza.tKa()}C8h(){Ea.a.$v&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&
(this.tgd=new Xd(this.$,this.aZ))}}Object(t.a)(qc,"SessionStatisticsManager",xd.a,[19]);var ma=a(126),Ab=a(1238),ec=a(147);class na{constructor(fb,Va){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=
this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=fb;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=Va}Iac(){return jf.a.Di(this)}}Object(t.a)(na,"AppUnloadInfo",null,[]);var pb=a(927),R=a(121),ua=a(674);class xb{constructor(fb){this.lostOperationsCount=
0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=fb.Jhf+fb.O4g;this.dataLossReason=fb.Ldf;this.WSh(fb.qCe)}WSh(fb){const Va=new pb.a(ua.a.iV());let bd=0,je=0;for(const se of fb)Va.mh(se)||Va.ga(se,0),fb=Va.ga(se,Va.ma(se)+1),fb>bd&&(bd=fb,je=se);bd>this.mostCommonOperationCount&&(this.mostCommonOperationName=R.a(je),this.mostCommonOperationCount=bd)}}Object(t.a)(xb,"DataLossInfo",null,[]);var W=a(71);class xa{constructor(fb){this.Nrd=
"AppUnloadInfo";this.du=this.$=this.workbookHashedId=this.NI=null;this.oIe=this.LLe=!1;this.Jl=null;this.jVf=0;this.Mpa=(Va,bd)=>{this.jVf=bd.w2c};this.ptg=(Va,bd)=>{bd.qCe.length&&this.$.nV&&(this.NI.dataLossInfo=new xb(bd),this.NI.wasDataLostDuringUnload=!0,this.Iwb())};this.Lm=()=>{this.Z7b();this.$.fa.av(this.Lm)};this.Gp=()=>{this.Z7b();this.$.fa.az(this.Gp)};this.S4a=()=>{this.NI.wasUpdatedOnBeforeUnload=!0;this.NI.inactivityDurationBeforeUnloadSeconds=this.Jl.pzb<xa.TGj?this.jVf:this.Jl.pzb;
this.D7g()};this.W2b=()=>{this.NI.wasUpdatedOnUnload=!0;this.D7g();Sys.Application.remove_unload(this.W2b)};this.jRc=()=>{this.NI.lastSilentReopenStartTime=z.a.kh.vi;this.NI.lastSilentReopenEndTime=null;this.Iwb();this.$.nr(this.N2b)};this.N2b=()=>{this.NI.lastSilentReopenEndTime=z.a.kh.vi;this.Iwb();this.$.$r(this.N2b)};this.localStorage=new rg.a;this.localStorage.zl()&&(this.$=fb,this.workbookHashedId=W.a(this.$),this.NI=new na(this.workbookHashedId,this.$.ua.UserSessionId),this.du=F.a.instance.KU(),
this.du.Ga("beforeunload",this.S4a),this.$.userOperationManager.iGh(this.ptg),J.EwaSettings.isChangeGateEnabled("OfficeVSO:8779648_AppVisuallyReadyMigration-AppUnloadTelemetryManager")?fb.fa.Vm?this.Z7b():this.$.fa.rv(this.Gp):fb.fa.um?this.Z7b():J.EwaSettings.ul()?this.$.fa.lr(this.Z7b):this.$.fa.mr(this.Lm),this.Jl=this.$.fa.Jl,this.Jl.CGa(this.Mpa),Sys.Application.add_unload(this.W2b),this.$.fa.hJb(this.jRc))}get dialogPromptedOnUnload(){return this.LLe}set dialogPromptedOnUnload(fb){this.LLe=
fb;this.NI?(this.NI.dialogPromptedOnUnload=fb,this.Iwb()):this.localStorage.zl()&&O.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.zl()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.oIe}set apiBeforeCloseNotificationEnabledOnUnload(fb){this.oIe=fb;this.NI?(this.NI.apiBeforeCloseNotificationEnabledOnUnload=fb,this.Iwb()):this.localStorage.zl()&&O.ULS.sendTraceTag(537151057,0,
10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.zl()}`)}dispose(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.Wqk(this.ptg);this.Jl&&(this.Jl.lPa(this.Mpa),this.Jl=null);this.du.LM();this.$=this.du=null}D7g(){this.qJk();this.Iwb()}qJk(){this.NI.wasOfflineDuringUnload=this.$.nm.Cha;this.NI.timeFromLastConnectivity=ec.a(z.a.kh,this.$.nm.t7f);this.NI.timeFromLastDisconnectionStart=ec.a(z.a.kh,this.$.nm.xwj);
this.NI.disconnectionSource=Enum.toString(Ab.a,this.$.nm.disconnectionSource);this.NI.hadConnectivityIssuesDuringUnload=this.$.nm.Kya;this.NI.timeFromLastStatusCode0=ec.a(z.a.kh,this.$.nm.s7f)}Iwb(){this.NI.timestamp=Date.now();this.localStorage.R8b(this.Nrd,this.NI.Iac())}Z7b(){const fb=this.localStorage.H_a(this.Nrd);if(fb)try{const Va=jf.a.Vp(fb);this.localStorage.nFg(this.Nrd);const bd=this.$Ej(Va);O.ULS.sendTraceTag(574677456,0,50,bd)}catch(Va){O.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Va.message}`)}else O.ULS.sendTraceTag(574677457,
0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}$Ej(fb){const Va={};Va.WACSessionID=fb.wacSessionId;Va.wasRefreshed=this.xXh(fb,this.$.ua.MaxAppReloadDurationIndicatingRefresh);Va.closedWithDialogConfirmation=fb.dialogPromptedOnUnload;Va.wasOfflineDuringUnload=fb.wasOfflineDuringUnload;Va.TimeFromLastConnectivityMs=fb.timeFromLastConnectivity;Va.TimeFromLastDisconnectionStart=fb.timeFromLastDisconnectionStart;Va.wasDataLostDuringUnload=fb.wasDataLostDuringUnload;
Va.DataLossInfo=fb.dataLossInfo;Va.flushedOnUnload=fb.wasUpdatedOnUnload;Va.flushedOnBeforeUnload=fb.wasUpdatedOnBeforeUnload;Va.InactivityDurationBeforeUnload=fb.inactivityDurationBeforeUnloadSeconds;Va.DisconnectionSource=fb.disconnectionSource;Va.hadConnectivityIssuesDuringUnload=fb.hadConnectivityIssuesDuringUnload;Va.TimeFromLastStatusCode0=fb.timeFromLastStatusCode0;Va.LastSilentReopenStartTime=fb.lastSilentReopenStartTime;Va.LastSilentReopenEndTime=fb.lastSilentReopenEndTime;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&
(Va.ApiBeforeCloseNotificationEnabledOnUnload=fb.apiBeforeCloseNotificationEnabledOnUnload);return Ja.c(Va)}xXh(fb,Va){const bd=window.performance.timing.navigationStart-fb.timestamp;(fb=this.workbookHashedId===fb.workbookHashedId&&bd<Va)&&O.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return fb}static Ga(fb){fb.fa.Kh.inWebPart||fb.qa.Rh(410,new xa(fb))}}xa.TGj=10;Object(t.a)(xa,"AppUnloadTelemetryManager",null,[666,2]);var kb=a(12),Pb=a(30),
T=a(328);class Za{constructor(fb){this.ipf=!1;this.kpf=null;this.Gj=()=>{this.Axk();H.f(this.$).ha&&H.f(this.$).ha.Nca(this.Gj)};this.Bq=(Va,bd)=>{bd.la&&!this.Txe.has(bd.la.name)&&(this.Txe.add(bd.la.name),H.f(this.$).ha&&(H.f(this.$).ha.Nca(this.Gj),H.f(this.$).ha.z$(this.Gj)))};this.$=fb;this.$0g=new Set;this.Txe=new Set;this.$.sa&&this.$.sa.la&&this.Txe.add(this.$.sa.la.name);H.f(this.$).ha.z$(this.Gj);this.$.sa.vn(this.Bq)}dispose(){this.$=null}Axk(){this.kpf||this.gTh();var fb=H.f(this.$);const Va=
[];for(var bd of fb.Oaa()){fb=bd.domElement.getElementsByClassName(Pb.wb);for(let se=fb.length-1;0<=se;se--){var je=fb[se].firstChild;(je=je?T.b(je.currentStyle):"")&&!Va.includes(je)&&Va.push(je)}}this.ipf||(bd=kb.a.instance.Aa(281).split(","),Va.push(...bd),this.ipf=!0);for(const se of Va)se&&!this.$0g.has(se)&&(this.wBj(se),this.$0g.add(se))}wBj(fb){this.EUh(fb)}gTh(){this.kpf=Za.lKa("monospace");Za.lKa("sans-serif");Za.lKa("serif")}EUh(fb){Za.lKa(`${fb},${"monospace"}`);Za.lKa(`${fb},${"sans-serif"}`);
Za.lKa(`${fb},${"serif"}`)}static Ga(fb){if(J.EwaSettings.Na(61)){const Va=new Za(fb);fb.qa.Rh(210,Va)}}static lKa(fb){const Va=document.createElement("div"),bd=document.createElement("div");Va.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Za.aJk(bd,fb);document.body.appendChild(Va);Va.appendChild(bd);bd.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";fb=bd.offsetWidth+"x"+bd.offsetHeight;document.body.removeChild(bd.parentNode);return fb}static aJk(fb,
Va){fb.style.cssText="display: inline; visibility: hidden;";fb.style.fontSize="100px";fb.style.fontWeight="normal";fb.style.fontStyle="normal";fb.style.letterSpacing="normal";fb.style.lineHeight="normal";fb.style.whiteSpace="nowrap";fb.style.fontFamily=Va}}Object(t.a)(Za,"FontTelemetryManager",null,[2]);var Db=a(1086);class kc{wm(fb,Va){return new Db.a(fb,Va)}Oi(fb,Va){fb=this.wm(fb,Va);fb.start();return fb}}Object(t.a)(kc,"DefaultStopwatchBuilder",null,[202]);class Wc{constructor(){this.uEa=new kc}wm(fb,
Va){return this.uEa.wm(fb,Va)}Oi(fb,Va){return this.uEa.Oi(fb,Va)}}Object(t.a)(Wc,"StopwatchBuilder",null,[202]);var yd=a(361),Od=a(1110),me=a(1247),De;(function(fb){fb[fb.actions=0]="actions";fb[fb.correlationStart=1]="correlationStart";fb[fb.reorderSheetOp=2]="reorderSheetOp";fb[fb.formatCellOp=3]="formatCellOp";fb[fb.copyOp=4]="copyOp";fb[fb.pasteOp=5]="pasteOp";fb[fb.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";fb[fb.instantaneousSetData=7]="instantaneousSetData";fb[fb.immediateSetData=
8]="immediateSetData";fb[fb.dependentCellsCalc=9]="dependentCellsCalc";fb[fb.dependentCellsGraphStat=10]="dependentCellsGraphStat";fb[fb.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";fb[fb.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";fb[fb.gridBlockUpdates=13]="gridBlockUpdates";fb[fb.browserAppStart=14]="browserAppStart";fb[fb.linkedObjects=15]="linkedObjects";fb[fb.longFrames=16]="longFrames";fb[fb.task=17]="task";fb[fb.conflictInEditing=18]="conflictInEditing";
fb[fb.incomingPresenceData=19]="incomingPresenceData";fb[fb.editorTableDelay=20]="editorTableDelay";fb[fb.presenceStartup=21]="presenceStartup";fb[fb.presenceDelete=22]="presenceDelete";fb[fb.editorEvent=23]="editorEvent";fb[fb.editorTime=24]="editorTime";fb[fb.gridScreenReaderOps=25]="gridScreenReaderOps";fb[fb.sendPresenceToService=26]="sendPresenceToService";fb[fb.IME=27]="IME";fb[fb.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";fb[fb.customizeStatusBar=29]="customizeStatusBar";fb[fb.clientWebRequests=
30]="clientWebRequests";fb[fb.showCommentTaskPane=31]="showCommentTaskPane";fb[fb.applyThreadedCommentChange=32]="applyThreadedCommentChange";fb[fb.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";fb[fb.findNextOrPreviousComment=34]="findNextOrPreviousComment";fb[fb.goto=35]="goto";fb[fb.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";fb[fb.richApiInvocation=37]="richApiInvocation";fb[fb.fxLibrary=38]="fxLibrary";fb[fb.embeddedApiSession=39]="embeddedApiSession";fb[fb.numberFormattingCalculator=
40]="numberFormattingCalculator";fb[fb.requestDataAfterSend=41]="requestDataAfterSend";fb[fb.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";fb[fb.copy=43]="copy";fb[fb.paste=44]="paste";fb[fb.dragDrop=45]="dragDrop";fb[fb.clearCopyState=46]="clearCopyState";fb[fb.webWorkerRecalcStats=47]="webWorkerRecalcStats";fb[fb.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";fb[fb.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";fb[fb.customSort=50]="customSort";
fb[fb.namedSheetViewUserAction=51]="namedSheetViewUserAction";fb[fb.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";fb[fb.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";fb[fb.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";fb[fb.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";fb[fb.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";fb[fb.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";fb[fb.raiseEventsAndGenerateBlockRequests=
58]="raiseEventsAndGenerateBlockRequests";fb[fb.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(De||(De={}));Object(t.b)("UsageTable",De);var Le=a(494),Pe=a(555),ef=a(730),yf=a(794),Kf=a(311),ig=a(137);class kg extends Sys.EventArgs{constructor(){super();this.YKj=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(t.a)(kg,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class vg{constructor(fb,Va){this.Jne=void 0===Va?1:Va;this.total=fb}get average(){return this.total/this.Jne}I_h(fb){return new vg(this.total+
fb.total,this.Jne+fb.Jne)}static sQh(fb,Va){return`${fb}_${Va}`}}Object(t.a)(vg,"StopwatchAverage",null,[]);var yg;(function(fb){fb[fb.longFrame=0]="longFrame";fb[fb.longGetRange=1]="longGetRange";fb[fb.longJsTask=2]="longJsTask";fb[fb.viewportCalculationLoops=3]="viewportCalculationLoops"})(yg||(yg={}));Object(t.b)("UtrKpiVeto",yg);class ag{static zDc(fb){return Enum.toString(yg,fb)}}ag.ERa="UTR";Object(t.a)(ag,"KpiConstants",null,[]);class gg{}gg.A9g="UTRVetoName";gg.r9g="UTRErrorName";gg.w9g="UTROperationName";
gg.r5c="UTRDuration";gg.y9g="UTREndedInPhase";gg.sCe="UTRMessage";gg.z9g="UtrUnavailabilityType";gg.operationName="OperationName";gg.duration="Duration";gg.message="Message";Object(t.a)(gg,"UtrAdditionalData",null,[]);class ch{}ch.Hfl="VetoLike";ch.ftf="E2EOperationPerf";ch.Ctk="RequestPerf";ch.M6k="UnavailabilityDurations";Object(t.a)(ch,"UtrTypes",null,[]);class Eg{B6b(fb,Va,bd){bd=void 0===bd?null:bd;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(bd=bd?{extendedProperties:bd}:
null,fb=ag.zDc(fb),$b.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+fb,Va,!1,!0,"",bd))}i8b(fb,Va,bd,je,se,Xe){Xe[ag.ERa]=ch.Hfl;Xe[gg.A9g]=ag.zDc(je);Xe[gg.r9g]=se;O.ULS.sendTraceTag(fb,Va,bd,jf.a.Di(Xe));delete Xe[ag.ERa];delete Xe[gg.A9g];delete Xe[gg.r9g]}}Object(t.a)(Eg,"UtrKpiVetoReporter",null,[]);class ph{Ile(fb,Va){Va=void 0===Va?null:Va;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||$b.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+ag.zDc(fb),pd.b.FailureBased,
"",Va)}B6b(fb,Va,bd){bd=void 0===bd?null:bd;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(fb=ag.zDc(fb),$b.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+fb,Va,!1,!0,this.b5h(bd)))}b5h(fb){return fb?{extendedProperties:fb}:null}}Object(t.a)(ph,"UtrKpiVetoUsageReporter",null,[]);class Rg{pWc(fb,Va,bd){bd=void 0===bd?null:bd;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||$b.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+fb,
"",{extendedProperties:bd,durationMs:Va})}yWc(fb,Va,bd){bd=void 0===bd?null:bd;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Va?$b.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+fb,"",{extendedProperties:bd}):$b.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+fb,"",!1,!1,"",{extendedProperties:bd}))}f8b(fb,Va,bd,je,se,Xe,wf,...Nf){wf=String.format(wf,...Nf);Nf={};Nf[ag.ERa]=ch.ftf;Nf[gg.w9g]=je;Nf[gg.y9g]=se;Nf[gg.r5c]=Xe;Nf[gg.sCe]=wf;O.ULS.sendTraceTag(fb,
Va,bd,jf.a.Di(Nf))}AYc(fb,Va,bd,je,se,Xe,wf){const Nf={};Nf[ag.ERa]=ch.ftf;Nf[gg.w9g]=je;Nf[gg.y9g]=se;Nf[gg.r5c]=Xe;Nf[gg.sCe]=wf;O.ULS.sendTraceTag(fb,Va,bd,jf.a.Di(Nf))}h8b(fb,Va,bd,je,se,Xe){this.jSg(Xe,je,se);O.ULS.sendTraceTag(fb,Va,bd,jf.a.Di(Xe));this.Fei(Xe)}g8b(fb,Va,bd,je,se,Xe,...wf){Xe=String.format(Xe,...wf);wf={};this.jSg(wf,je,se,Xe);O.ULS.sendTraceTag(fb,Va,bd,jf.a.Di(wf))}BYc(fb,Va,bd,je){je[ag.ERa]=ch.Ctk;O.ULS.sendTraceTag(fb,Va,bd,jf.a.Di(je));delete je[ag.ERa]}jSg(fb,Va,bd,je){je=
void 0===je?null:je;fb[ag.ERa]=ch.M6k;fb[gg.z9g]=Va;fb[gg.r5c]=bd;je&&(fb[gg.sCe]=je)}Fei(fb){delete fb[ag.ERa];delete fb[gg.z9g];delete fb[gg.r5c]}}Object(t.a)(Rg,"UtrOperationPerfReporter",null,[]);class Dg extends x.a{constructor(fb,Va,bd,je,se,Xe){bd=void 0===bd?null:bd;je=void 0===je?null:je;se=void 0===se?null:se;Xe=void 0===Xe?!1:Xe;super();this.Qti=[td.a.Dbf,td.a.jwf,td.a.kwf,td.a.XFc,td.a.yMc,td.a.Mzj,td.a.renderCachedContent,td.a.renderServerContent,td.a.kuc,td.a.Iyk,td.a.yMg,td.a.zMg,td.a.WCk];
this.DGb=this.RSa=this.bcc=this.AAb=this.fTe=this.Laf=this.ldb=this.s_e=null;this.Mvg=this.Bbf=!1;this.v9g=this.t9g=this.x9g=this.Xle=this.T$g=null;this.Cqg=(wf,Nf)=>{for(wf=0;wf<Nf.entries.length;wf++){const uf=Nf.entries[wf];uf.url=Qb.a.removeParameter(uf.url,ba.AFrameworkApplication.eM);var fg=Qb.a.Lca(uf.url);!J.EwaSettings.Na(426)&&this.lrj(uf.url,fg)&&(uf.behavior=1);if("img"===uf.Yz.initiatorType&&fg.endsWith(Od.a.hEd)){var Of=Qb.a.Qaa(uf.url,Od.a.gEd),Bg=Qb.a.Qaa(uf.url,Od.a.iEd);uf.u5=`${uf.u5}imageID=${Of}, imgStateID=${Bg}`}"css"===
uf.Yz.initiatorType&&"responseStatus"in uf.Yz&&(Of=`responseStatus=${uf.Yz.responseStatus}`,uf.u5=uf.u5?`${uf.u5},${Of}`:Of);Of=uf.Yz.transferSize;let Lg;Bg=uf.Yz.decodedBodySize;void 0!==Of&&null!==Of&&void 0!==Bg&&null!==Bg?Lg=0===Of&&0<Bg:void 0!==Of&&null!==Of&&(Lg=0===Of);Ka.a.instance.OAh(fg,Math.round(uf.Yz.fetchStart),Math.round(uf.Yz.responseEnd),Lg,this.Usj);ha.a.contains(fg,td.a.richTextEditor,!0)&&(fg=ig.TextEditorTelemetry.instance,fg.yO(td.a.ivk,Math.round(uf.Yz.fetchStart)),fg.yO(td.a.kvk,
Math.round(uf.Yz.responseEnd)))}};this.nZ=()=>{const wf=this.Eja;for(const Nf in wf)wf[Nf].h=!0};this.userSessionId=fb;this.qib=bd=bd||new ef.a;this.$p=je||z.a.kh;this.QXk=se||this;this.Usj=Xe;this.apf=bd.zrb();J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void G.a.resolve(D.Db).then(wf=>{this.Lk=wf;this.Lk.Zea(this.nZ)}):(this.Lk=new Q,this.Lk.Zea(this.nZ),Va.Rh(291,this.Lk))}get Eja(){return this.s_e||(this.s_e={})}get fof(){return this.AAb||
this.apf}get pof(){return this.RSa||Dg.egg}get vwe(){return this.Laf=this.Laf||{}}get sSc(){return this.ldb||"undefined"===typeof Stw?this.ldb:this.ldb=Stw.swpc}get qag(){return this.fTe=this.fTe||{}}get tPa(){return this.DGb||(this.DGb=K.a.instance.Dk("Common.NetworkTiming.IResourceTimingLogger"))}get s9g(){return this.t9g||(this.t9g=new Eg)}get cab(){return this.x9g||(this.x9g=new Rg)}get u9g(){return this.v9g||(this.v9g=new ph)}S0c(fb,Va,bd,je,se){se=void 0===se?null:se;if(this.Eja[bd])throw Error.invalidOperation("The specified stopwatchId is already in use.");
this.Eja[bd]=this.Enf(fb,Va,bd,je,se)}sxc(fb,Va){const bd=this.Eja[fb];bd&&(this.ajf(bd,Va),this.O8k(bd),delete this.Eja[fb])}KFg(fb){delete this.Eja[fb]}kZg(fb,Va){this.AAb||this.aZg(fb,Va)}UYg(){this.kZg(Dg.XQd,this.$p.Xj)}Puf(fb,Va){Va=void 0===Va?!1:Va;if(this.AAb){if(this.RSa===Dg.Ice||this.RSa===Dg.XQd){const bd=Rb.a.instance;bd.userSessionId=this.userSessionId;if(this.RSa===Dg.Ice){this.Bbf||(this.ipa(fb.m,Object(ad.a)(bd,bd.Khk,"recordContentFetchEnd")),this.Bbf=!0);if(Va){this.Mvg||(this.ipa(fb.m,
Object(ad.a)(bd,bd.Zhk,"recordPerceivedContentDisplayed")),this.Mvg=!0);return}this.ipa(fb.m,Object(ad.a)(bd,bd.Jhk,"recordContentDisplayed"))}else this.RSa===Dg.XQd&&(Va=this.Eja[this.bcc])&&this.ipa(Kf.a(fb,Va.s),Object(ad.a)(bd,bd.Thk,"recordInteractivityContentDisplayed"),!1)}this.sxc(this.bcc,fb);this.bcc=this.RSa=this.AAb=null}}ipa(fb,Va,bd){bd=void 0===bd?!0:bd;Rb.a.V4&&Object(yd.a)(yf.PerformanceClock,z.a.kh)&&bd&&(fb+=window.performance.timing.navigationStart);Va(fb)}kp(fb){return Le.a(fb)}Ol(fb,
Va,bd){bd=void 0===bd?!1:bd;try{if(this.qag[De[fb]]=!0,bd){var je=O.ULS,se=je.sendTraceTag;const Dd={};let Jg=null;switch(fb){case 0:Jg="Actions";var Xe=Va.a;null!=Xe&&(Dd.Id=Xe);var wf=null==Va.b?null:Va.b;null!=wf&&(Dd.Operation=wf);var Nf=Va.c;null!=Nf&&(Dd.Target=Nf);var fg=null==Va.d?null:Va.d.toString();null!=fg&&(Dd.StartTime=fg);var Of=null==Va.e?null:Va.e.toString();null!=Of&&(Dd.Duration=Of);var Bg=Va.f;null!=Bg&&(Dd.CorrelationId=Bg);var uf=Va.g;null!=uf&&(Dd.ParentAction=uf);var Lg=null==
Va.h?null:Va.h.toString();null!=Lg&&(Dd.DocumentHidden=Lg);break;case 1:Jg="CorrelationStart";var zg=Va.a;null!=zg&&(Dd.CorrelationId=zg);var mh=Va.b;null!=mh&&(Dd.UserSessionId=mh);var Cg=Va.c;null!=Cg&&(Dd.UserAction=Cg);break;case 2:Jg="ReorderSheetOp";var Sf=Va.a;null!=Sf&&(Dd.UserSessionId=Sf);var dh=null==Va.b?null:Va.b.toString();null!=dh&&(Dd.IsDragReorder=dh);var jh=null==Va.c?null:Va.c.toString();null!=jh&&(Dd.DocumentUp=jh);var lc=null==Va.d?null:Va.d.toString();null!=lc&&(Dd.OldIndex=
lc);var md=null==Va.e?null:Va.e.toString();null!=md&&(Dd.NewIndex=md);var Yd=null==Va.f?null:Va.f.toString();null!=Yd&&(Dd.TotalSheets=Yd);break;case 3:Jg="FormatCellOp";var ke=Va.a;null!=ke&&(Dd.UserSessionId=ke);var bf=null==Va.b?null:Va.b.toString();null!=bf&&(Dd.TaskId=bf);var cf=null==Va.c?null:Va.c.toString();null!=cf&&(Dd.NumberOfRanges=cf);var Df=Va.d;null!=Df&&(Dd.Ranges=Df);var Af=Va.e;null!=Af&&(Dd.ActiveCell=Af);var qg=null==Va.f?null:Va.f.toString();null!=qg&&(Dd.ActionId=qg);var Pg=
Va.g;null!=Pg&&(Dd.CommandParameters=Pg);var Mg=Va.h;null!=Mg&&(Dd.UserActionStopwatchId=Mg);break;case 4:Jg="CopyOp";var gh=Va.a;null!=gh&&(Dd.UserSessionId=gh);var Hh=null==Va.b?null:Va.b.toString();null!=Hh&&(Dd.IsChrome=Hh);var Ph=null==Va.c?null:Va.c.toString();null!=Ph&&(Dd.IsIE=Ph);var rh=null==Va.d?null:Va.d.toString();null!=rh&&(Dd.IsFromUI=rh);var eh=null==Va.e?null:Va.e.toString();null!=eh&&(Dd.IsCopyInLoadedRange=eh);var Yf=null==Va.f?null:Va.f.toString();null!=Yf&&(Dd.IsRepeatedCopy=
Yf);var Qg=null==Va.g?null:Va.g.toString();null!=Qg&&(Dd.IsClipboarAccessSupported=Qg);var uh=null==Va.h?null:Va.h.toString();null!=uh&&(Dd.IsClipboarAccessInstallationSupported=uh);var Kh=null==Va.i?null:Va.i.toString();null!=Kh&&(Dd.RibbonCommand=Kh);var ai=null==Va.j?null:Va.j.toString();null!=ai&&(Dd.CutCopyPasteFlags=ai);var fh=null==Va.k?null:Va.k.toString();null!=fh&&(Dd.IsDrag=fh);var Uh=null==Va.l?null:Va.l.toString();null!=Uh&&(Dd.IsIeBeforeAlowDenyPopUp=Uh);var Sg=Va.m;null!=Sg&&(Dd.IsPasteMatchCopy=
Sg);var xh=Va.n;null!=xh&&(Dd.WaitMessageInClipboard=xh);var Fg=null==Va.o?null:Va.o.toString();null!=Fg&&(Dd.CallCount=Fg);break;case 5:Jg="PasteOp";var Tg=Va.a;null!=Tg&&(Dd.UserSessionId=Tg);var sh=null==Va.b?null:Va.b.toString();null!=sh&&(Dd.IsChrome=sh);var Vh=null==Va.c?null:Va.c.toString();null!=Vh&&(Dd.IsIE=Vh);var Qf=null==Va.d?null:Va.d.toString();null!=Qf&&(Dd.IsCopyActive=Qf);var vh=null==Va.e?null:Va.e.toString();null!=vh&&(Dd.IsFromUI=vh);var bg=null==Va.f?null:Va.f.toString();null!=
bg&&(Dd.IsClipboarAccessSupported=bg);var Wh=null==Va.g?null:Va.g.toString();null!=Wh&&(Dd.IsClipboarAccessInstallationSupported=Wh);var Zg=null==Va.h?null:Va.h.toString();null!=Zg&&(Dd.RibbonCommand=Zg);var sa=null==Va.i?null:Va.i.toString();null!=sa&&(Dd.CutCopyPasteFlags=sa);var Vb=Va.j;null!=Vb&&(Dd.WaitMessageInClipboard=Vb);var Sc=Va.k;null!=Sc&&(Dd.PopupDialog=Sc);var ud=Va.l;null!=ud&&(Dd.SimplePopupMessage=ud);var va=Va.m;null!=va&&(Dd.DialogCloseButton=va);var mb=Va.n;null!=mb&&(Dd.UserPressedInstallLink=
mb);var Tb=null==Va.o?null:Va.o.toString();null!=Tb&&(Dd.CallCount=Tb);break;case 6:Jg="GetNumberViewModelDataOp";var yc=Va.a;null!=yc&&(Dd.UserSessionId=yc);var Nc=Va.b;null!=Nc&&(Dd.NumberFormatOptionsPreviousOutputJson=Nc);var zd=Va.c;null!=zd&&(Dd.NumberFormatOptionsNewInputJson=zd);break;case 7:Jg="InstantaneousSetData";var fe=Va.a;null!=fe&&(Dd.Id=fe);var Ud=null==Va.b?null:Va.b.toString();null!=Ud&&(Dd.WasEmpty=Ud);var P=null==Va.c?null:Va.c.toString();null!=P&&(Dd.ValueNotChanged=P);var Da=
Va.d;null!=Da&&(Dd.Source=Da);var eb=null==Va.e?null:Va.e.toString();null!=eb&&(Dd.ProcessingCompleted=eb);break;case 8:Jg="ImmediateSetData";var bc=Va.a;null!=bc&&(Dd.ClientStopwatchId=bc);var Pc=Va.b;null!=Pc&&(Dd.Operation=Pc);var gd=Va.c;null!=gd&&(Dd.Parameters=gd);var nd=null==Va.d?null:Va.d.toString();null!=nd&&(Dd.WasUpdatedByImmediate=nd);var Vd=null==Va.e?null:Va.e.toString();null!=Vd&&(Dd.areHtmlElementsEqualClientComparison=Vd);var ie=null==Va.f?null:Va.f.toString();null!=ie&&(Dd.WasDecisionMadeByHtmlComparison=
ie);var vd=null==Va.g?null:Va.g.toString();null!=vd&&(Dd.IsNumeric=vd);var Sd=null==Va.h?null:Va.h.toString();null!=Sd&&(Dd.IsDateTime=Sd);var te=null==Va.i?null:Va.i.toString();null!=te&&(Dd.HasCurrencySymbol=te);var ne=null==Va.j?null:Va.j.toString();null!=ne&&(Dd.HasPercentSymbol=ne);var Ce=null==Va.k?null:Va.k.toString();null!=Ce&&(Dd.IsFunc=Ce);var Qe=null==Va.l?null:Va.l.toString();null!=Qe&&(Dd.DiffInWrappingWhitespace=Qe);var df=Va.m;null!=df&&(Dd.ImmediatePattern=df);var da=null==Va.n?null:
Va.n.toString();null!=da&&(Dd.TextAlignmentMatch=da);var hb=null==Va.o?null:Va.o.toString();null!=hb&&(Dd.FontColorMatch=hb);var Ac=null==Va.p?null:Va.p.toString();null!=Ac&&(Dd.FormulaTextMatch=Ac);var Lc=null==Va.q?null:Va.q.toString();null!=Lc&&(Dd.isFormula=Lc);var Qd=Va.r;null!=Qd&&(Dd.FormulaText=Qd);var de=Va.s;null!=de&&(Dd.InstantaneousPattern=de);var Me=null==Va.t?null:Va.t.toString();null!=Me&&(Dd.AreHtmlInnerTextElementsEqualClientComparison=Me);var Te=Va.u;null!=Te&&(Dd.HtmlComparisonDecision=
Te);break;case 9:Jg="DependentCellsCalc";var zf=Va.a;null!=zf&&(Dd.CalcStatus=zf);var dg=null==Va.b?null:Va.b.toString();null!=dg&&(Dd.SuccessfullyCalculatedRanges=dg);var tg=null==Va.c?null:Va.c.toString();null!=tg&&(Dd.RangesSkipped=tg);var Gg=null==Va.d?null:Va.d.toString();null!=Gg&&(Dd.TotalErrors=Gg);var ah=null==Va.e?null:Va.e.toString();null!=ah&&(Dd.Partial=ah);var bh=null==Va.f?null:Va.f.toString();null!=bh&&(Dd.Canceled=bh);var Bh=null==Va.g?null:Va.g.toString();null!=Bh&&(Dd.Aggregate=
Bh);var Qh=null==Va.h?null:Va.h.toString();null!=Qh&&(Dd.Unknown=Qh);var Lh=null==Va.i?null:Va.i.toString();null!=Lh&&(Dd.UnavailableData=Lh);var Rh=null==Va.j?null:Va.j.toString();null!=Rh&&(Dd.Cycle=Rh);var Gf=null==Va.k?null:Va.k.toString();null!=Gf&&(Dd.NotImplemented=Gf);var Yh=null==Va.l?null:Va.l.toString();null!=Yh&&(Dd.InvalidInput=Yh);var wg=null==Va.m?null:Va.m.toString();null!=wg&&(Dd.AreDepCells=wg);break;case 10:Jg="DependentCellsGraphStat";var Ai=null==Va.a?null:Va.a.toString();null!=
Ai&&(Dd.ParsedFormulas=Ai);var yh=null==Va.b?null:Va.b.toString();null!=yh&&(Dd.GraphNodes=yh);var bi=null==Va.c?null:Va.c.toString();null!=bi&&(Dd.GraphArcs=bi);var vi=null==Va.d?null:Va.d.toString();null!=vi&&(Dd.AnalyzedBlocks=vi);var Vi=null==Va.e?null:Va.e.toString();null!=Vi&&(Dd.IterationId=Vi);var Wi=Va.f;null!=Wi&&(Dd.UniqueId=Wi);var wi=null==Va.g?null:Va.g.toString();null!=wi&&(Dd.Aborted=wi);break;case 11:Jg="DependentCellsGraphSectionStat";var Xi=null==Va.a?null:Va.a.toString();null!=
Xi&&(Dd.IterationId=Xi);var fj=Va.b;null!=fj&&(Dd.BlockHash=fj);var Mi=Va.c;null!=Mi&&(Dd.Functions=Mi);var pj=Va.d;null!=pj&&(Dd.Operators=pj);var Yi=null==Va.e?null:Va.e.toString();null!=Yi&&(Dd.CrossDocRefs=Yi);var qj=null==Va.f?null:Va.f.toString();null!=qj&&(Dd.CrossSheetRefs=qj);var ni=null==Va.g?null:Va.g.toString();null!=ni&&(Dd.ErrRefs=ni);var Zh=null==Va.h?null:Va.h.toString();null!=Zh&&(Dd.LargeRanges=Zh);var Ni=null==Va.i?null:Va.i.toString();null!=Ni&&(Dd.NameRefs=Ni);var Xh=null==Va.j?
null:Va.j.toString();null!=Xh&&(Dd.ParserErrors=Xh);var di=null==Va.k?null:Va.k.toString();null!=di&&(Dd.RowRefs=di);var gj=null==Va.l?null:Va.l.toString();null!=gj&&(Dd.ColumnRefs=gj);var kh=null==Va.m?null:Va.m.toString();null!=kh&&(Dd.TableRefs=kh);var Bi=Va.n;null!=Bi&&(Dd.UniqueId=Bi);var Ci=null==Va.o?null:Va.o.toString();null!=Ci&&(Dd.UnreachableReferences=Ci);break;case 12:Jg="GetRangeContentPrefetchFailures";var hj=Va.a;null!=hj&&(Dd.UserSessionId=hj);var ij=Va.b;null!=ij&&(Dd.ClientStopwatchId=
ij);var wh=null==Va.c?null:Va.c.toString();null!=wh&&(Dd.StateId=wh);break;case 13:Jg="GridBlockUpdates";var Ih=Va.a;null!=Ih&&(Dd.UserSessionId=Ih);var jj=Va.b;null!=jj&&(Dd.CorrelationId=jj);var kj=Va.c;null!=kj&&(Dd.Operation=kj);var Dh=null==Va.d?null:Va.d.toString();null!=Dh&&(Dd.PerformanceType=Dh);var oi=Va.e;null!=oi&&(Dd.BlockHash=oi);var og=null==Va.f?null:Va.f.toString();null!=og&&(Dd.DurationInMs=og);break;case 14:Jg="BrowserAppStart";var Jh=null==Va.a?null:me.a.XXa(Va.a.getTime());null!=
Jh&&(Dd.ScriptExecutionStart=Jh);var rj=Va.b;null!=rj&&(Dd.UserSessionId=rj);var ei=Va.c;null!=ei&&(Dd.ClockMechanism=ei);var Bj=null==Va.d?null:Va.d.toString();null!=Bj&&(Dd.ScreenDPI=Bj);var Ch=null==Va.e?null:Va.e.toString();null!=Ch&&(Dd.NavigationToScriptExecutionDelta=Ch);break;case 15:Jg="LinkedObjects";var Cj=Va.a;null!=Cj&&(Dd.ChildId=Cj);var sj=Va.b;null!=sj&&(Dd.ParentId=sj);var Md=Va.c;null!=Md&&(Dd.ChildTable=Md);var ve=Va.d;null!=ve&&(Dd.ParentTable=ve);break;case 16:Jg="LongFrames";
var Oi=null==Va.a?null:me.a.XXa(Va.a.getTime());null!=Oi&&(Dd.StartTime=Oi);var nh=null==Va.b?null:Va.b.toString();null!=nh&&(Dd.DurationInMs=nh);break;case 17:Jg="Task";var ii=Va.a;null!=ii&&(Dd.StopwatchId=ii);var Ei=null==Va.b?null:Va.b.toString();null!=Ei&&(Dd.Status=Ei);var tj=null==Va.c?null:Va.c.toString();null!=tj&&(Dd.CreateTime=tj);var Zi=null==Va.d?null:Va.d.toString();null!=Zi&&(Dd.TaskId=Zi);break;case 18:Jg="ConflictInEditing";var uj=Va.a;null!=uj&&(Dd.OtherUserState=uj);var $i=Va.b;
null!=$i&&(Dd.UserSessionId=$i);var ji=null==Va.c?null:me.a.XXa(Va.c.getTime());null!=ji&&(Dd.ConflictTime=ji);break;case 19:Jg="IncomingPresenceData";var ci=Va.a;null!=ci&&(Dd.UserSessionId=ci);var Tj=Va.b;null!=Tj&&(Dd.UserId=Tj);var pi=null==Va.c?null:Va.c.toString();null!=pi&&(Dd.Disconnected=pi);var ki=null==Va.d?null:me.a.XXa(Va.d.getTime());null!=ki&&(Dd.ReceivedTime=ki);break;case 20:Jg="EditorTableDelay";var lh=Va.a;null!=lh&&(Dd.UserSessionId=lh);var qi=Va.b;null!=qi&&(Dd.UserId=qi);var Fi=
null==Va.c?null:Va.c.toString();null!=Fi&&(Dd.Received=Fi);var Sh=null==Va.d?null:Va.d.toString();null!=Sh&&(Dd.DurationInMs=Sh);var Dj=null==Va.e?null:Va.e.toString();null!=Dj&&(Dd.NotAloneAtLogTime=Dj);var Pi=null==Va.f?null:me.a.XXa(Va.f.getTime());null!=Pi&&(Dd.Time=Pi);break;case 21:Jg="PresenceStartup";var Uj=Va.a;null!=Uj&&(Dd.UserSessionId=Uj);var Ej=null==Va.b?null:Va.b.toString();null!=Ej&&(Dd.EverReceived=Ej);var aj=null==Va.c?null:Va.c.toString();null!=aj&&(Dd.NotAloneOnOpen=aj);var Fj=
null==Va.d?null:Va.d.toString();null!=Fj&&(Dd.NotAloneAtLogTime=Fj);var eg=null==Va.e?null:Va.e.toString();null!=eg&&(Dd.EditorCount=eg);var gf=null==Va.f?null:Va.f.toString();null!=gf&&(Dd.WorkbookOpenToFirstReceivedInMs=gf);break;case 22:Jg="PresenceDelete";var Eh=Va.a;null!=Eh&&(Dd.UserSessionId=Eh);var th=Va.b;null!=th&&(Dd.UserId=th);var qh=Va.c;null!=qh&&(Dd.Context=qh);var Lj=Va.d;null!=Lj&&(Dd.Reason=Lj);var vj=null==Va.e?null:me.a.XXa(Va.e.getTime());null!=vj&&(Dd.Time=vj);break;case 23:Jg=
"EditorEvent";var Gi=Va.a;null!=Gi&&(Dd.UserSessionId=Gi);var Pj=Va.b;null!=Pj&&(Dd.UserId=Pj);var mf=Va.c;null!=mf&&(Dd.Context=mf);var Hi=null==Va.d?null:me.a.XXa(Va.d.getTime());null!=Hi&&(Dd.Time=Hi);break;case 24:Jg="EditorTime";var lj=Va.a;null!=lj&&(Dd.UserSessionId=lj);var Mj=Va.b;null!=Mj&&(Dd.UserId=Mj);var Yg=null==Va.c?null:Va.c.toString();null!=Yg&&(Dd.DurationInMs=Yg);break;case 25:Jg="GridScreenReaderOps";var Gj=Va.a;null!=Gj&&(Dd.UserSessionId=Gj);var Zj=Va.b;null!=Zj&&(Dd.CommandTaskId=
Zj);var mj=null==Va.c?null:Va.c.toString();null!=mj&&(Dd.CommandId=mj);var ri=null==Va.d?null:Va.d.toString();null!=ri&&(Dd.ClientSideOnly=ri);var Qi=null==Va.e?null:Va.e.toString();null!=Qi&&(Dd.DurationInMS=Qi);var Mh=null==Va.f?null:Va.f.toString();null!=Mh&&(Dd.ReachedMaxReadoutCells=Mh);var Ri=null==Va.g?null:Va.g.toString();null!=Ri&&(Dd.RequstedCellCount=Ri);var nj=null==Va.h?null:Va.h.toString();null!=nj&&(Dd.NonEmptyCellCount=nj);var ck=null==Va.i?null:Va.i.toString();null!=ck&&(Dd.Succeeded=
ck);var Vg=null==Va.j?null:Va.j.toString();null!=Vg&&(Dd.Canceled=Vg);var Th=Va.k;null!=Th&&(Dd.ErrorType=Th);break;case 26:Jg="SendPresenceToService";var lg=Va.a;null!=lg&&(Dd.UserSessionId=lg);var Qj=null==Va.b?null:Va.b.toString();null!=Qj&&(Dd.TotalCount=Qj);var M=null==Va.c?null:Va.c.toString();null!=M&&(Dd.SendCount=M);break;case 27:Jg="IME";var wa=Va.a;null!=wa&&(Dd.UserSessionId=wa);break;case 28:Jg="FreezePaneFloatingObjects";var ab=Va.a;null!=ab&&(Dd.UserSessionId=ab);var Sb=null==Va.b?
null:Va.b.toString();null!=Sb&&(Dd.ObjectType=Sb);var fc=Va.c;null!=fc&&(Dd.ObjectID=fc);var Mc=null==Va.d?null:Va.d.toString();null!=Mc&&(Dd.SpannedPanesCount=Mc);break;case 29:Jg="CustomizeStatusBar";var rd=Va.a;null!=rd&&(Dd.UserSessionId=rd);var Jd=Va.b;null!=Jd&&(Dd.UIControlName=Jd);var le=null==Va.c?null:Va.c.toString();null!=le&&(Dd.IsControlVisible=le);break;case 30:Jg="ClientWebRequests";var ye=Va.a;null!=ye&&(Dd.Path=ye);var $e=Va.b;null!=$e&&(Dd.ProxyStopwatchId=$e);var kf=Va.c;null!=
kf&&(Dd.RequestStatus=kf);var Bf=null==Va.d?null:Va.d.toString();null!=Bf&&(Dd.ResponseSizeInBytes=Bf);var Zf=Va.e;null!=Zf&&(Dd.ClientRequestId=Zf);var xg=null==Va.f?null:Va.f.toString();null!=xg&&(Dd.StateId=xg);break;case 31:Jg="ShowCommentTaskPane";var Og=Va.a;null!=Og&&(Dd.UserSessionId=Og);var hh=null==Va.b?null:Va.b.toString();null!=hh&&(Dd.IsFromKeyboardShortcut=hh);var ih=null==Va.c?null:Va.c.toString();null!=ih&&(Dd.IsShowPane=ih);var Ii=null==Va.d?null:Va.d.toString();null!=Ii&&(Dd.ShowForDeepLink=
Ii);var Fh=null==Va.e?null:Va.e.toString();null!=Fh&&(Dd.DeepLinkFound=Fh);break;case 32:Jg="ApplyThreadedCommentChange";var $g=Va.a;null!=$g&&(Dd.UserSessionId=$g);var si=null==Va.b?null:Va.b.toString();null!=si&&(Dd.Operation=si);var Nh=Va.c;null!=Nh&&(Dd.CommentId=Nh);var ti=null==Va.d?null:Va.d.toString();null!=ti&&(Dd.CommentsCount=ti);break;case 33:Jg="UpgradeLegacyCommentsChange";var bj=Va.a;null!=bj&&(Dd.UserSessionId=bj);var oj=null==Va.b?null:Va.b.toString();null!=oj&&(Dd.OperationSuccessful=
oj);break;case 34:Jg="FindNextOrPreviousComment";var Hj=Va.a;null!=Hj&&(Dd.UserSessionId=Hj);var Oh=null==Va.b?null:Va.b.toString();null!=Oh&&(Dd.Succeeded=Oh);break;case 35:Jg="Goto";var xj=Va.a;null!=xj&&(Dd.UserSessionId=xj);var cj=null==Va.b?null:Va.b.toString();null!=cj&&(Dd.IsSucceeded=cj);var dj=null==Va.c?null:Va.c.toString();null!=dj&&(Dd.IsNOVMode=dj);break;case 36:Jg="LaunchOfficeAddInDialog";var Ki=Va.a;null!=Ki&&(Dd.UserSessionId=Ki);var ak=Va.b;null!=ak&&(Dd.SourceId=ak);var C=Va.c;
null!=C&&(Dd.SourceLabel=C);var Ca=Va.d;null!=Ca&&(Dd.Flight=Ca);var qb=Va.e;null!=qb&&(Dd.Experiment=qb);var nc=Va.f;null!=nc&&(Dd.UICultureTag=nc);var Rc=null==Va.g?null:Va.g.toString();null!=Rc&&(Dd.UICultureTagLcid=Rc);var id=null==Va.h?null:Va.h.toString();null!=id&&(Dd.WacHostId=id);break;case 37:Jg="RichApiInvocation";var sd=Va.a;null!=sd&&(Dd.UserSessionId=sd);var Fd=null==Va.b?null:Va.b.toString();null!=Fd&&(Dd.Succeeded=Fd);var S=Va.c;null!=S&&(Dd.ErrorType=S);var Ua=Va.d;null!=Ua&&(Dd.ResultInfo=
Ua);var Hb=Va.e;null!=Hb&&(Dd.Source=Hb);break;case 38:Jg="FxLibrary";var Ec=Va.a;null!=Ec&&(Dd.EntityName=Ec);var cd=null==Va.b?null:Va.b.toString();null!=cd&&(Dd.EntryPoint=cd);var Bd=null==Va.c?null:Va.c.toString();null!=Bd&&(Dd.Action=Bd);var ce=null==Va.d?null:Va.d.toString();null!=ce&&(Dd.InsertLocation=ce);break;case 39:Jg="EmbeddedApiSession";var Fe=Va.a;null!=Fe&&(Dd.UserSessionId=Fe);break;case 40:Jg="NumberFormattingCalculator";var Ue=Va.a;null!=Ue&&(Dd.Id=Ue);var pf=Va.b;null!=pf&&(Dd.CounterName=
pf);var Tf=Va.c;null!=Tf&&(Dd.Values=Tf);break;case 41:Jg="RequestDataAfterSend";var pg=Va.a;null!=pg&&(Dd.ClientStopwatchId=pg);var Ng=Va.b;null!=Ng&&(Dd.RequestStatus=Ng);var Ug=null==Va.c?null:Va.c.toString();null!=Ug&&(Dd.SendDuration=Ug);var $h=null==Va.d?null:Va.d.toString();null!=$h&&(Dd.RequestId=$h);break;case 42:Jg="FloatingObjectsStopwatchData";var Yj=Va.a;null!=Yj&&(Dd.StopMessage=Yj);var Oj=null==Va.b?null:Va.b.toString();null!=Oj&&(Dd.Type=Oj);var Sj=Va.c;null!=Sj&&(Dd.GUID=Sj);var Di=
null==Va.d?null:Va.d.toString();null!=Di&&(Dd.Pane=Di);var fi=null==Va.e?null:Va.e.toString();null!=fi&&(Dd.IsAboveGrid=fi);var Ji=Va.f;null!=Ji&&(Dd.StartCorrelation=Ji);var dk=Va.g;null!=dk&&(Dd.LoadImageCorrelation=dk);var wj=null==Va.h?null:Va.h.toString();null!=wj&&(Dd.SkippedGetEffectsExtents=wj);var qk=null==Va.i?null:Va.i.toString();null!=qk&&(Dd.Version=qk);break;case 43:Jg="Copy";var Hk=Va.a;null!=Hk&&(Dd.UserSessionId=Hk);var zh=Va.b;null!=zh&&(Dd.Trigger=zh);var $k=Va.c;null!=$k&&(Dd.RibbonCommandName=
$k);var Ik=Va.d;null!=Ik&&(Dd.SourceItem=Ik);var al=null==Va.e?null:Va.e.toString();null!=al&&(Dd.SourceRangeCellCount=al);var yl=Va.f;null!=yl&&(Dd.ClientSideStopwatchId=yl);var bl=Va.g;null!=bl&&(Dd.CopyOperationId=bl);var Ag=null==Va.h?null:Va.h.toString();null!=Ag&&(Dd.IsAsync=Ag);var Jk=null==Va.i?null:Va.i.toString();null!=Jk&&(Dd.IsFromCache=Jk);var Kk=null==Va.j?null:Va.j.toString();null!=Kk&&(Dd.IsSuccessiveCopy=Kk);var rk=null==Va.k?null:Va.k.toString();null!=rk&&(Dd.IsSelectionAllowed=
rk);var zl=null==Va.l?null:Va.l.toString();null!=zl&&(Dd.IsSuccess=zl);var cl=null==Va.m?null:Va.m.toString();null!=cl&&(Dd.IsExpectedError=cl);var Al=Va.n;null!=Al&&(Dd.ExpectedErrorReason=Al);var sk=Va.o;null!=sk&&(Dd.ErrorMessage=sk);var dl=null==Va.p?null:Va.p.toString();null!=dl&&(Dd.ClientSideCopyTimeInMs=dl);var Bl=null==Va.q?null:Va.q.toString();null!=Bl&&(Dd.TotalTimeInMs=Bl);var Lk=null==Va.r?null:Va.r.toString();null!=Lk&&(Dd.PlainTextPayloadSize=Lk);var el=Va.s;null!=el&&(Dd.CopyPasteTargetType=
el);var fl=null==Va.t?null:Va.t.toString();null!=fl&&(Dd.ShadowWorkbookPayloadSize=fl);var Cl=null==Va.u?null:Va.u.toString();null!=Cl&&(Dd.HtmlPayloadSize=Cl);var Si=null==Va.v?null:Va.v.toString();null!=Si&&(Dd.HtmlSizeExceedsLimit=Si);var fk=null==Va.w?null:Va.w.toString();null!=fk&&(Dd.CopyTotalSizeExceedsLimit=fk);var Ql=null==Va.x?null:Va.x.toString();null!=Ql&&(Dd.ErrorReason=Ql);var Mk=Va.y;null!=Mk&&(Dd.ErrorName=Mk);var ej=null==Va.z?null:Va.z.toString();null!=ej&&(Dd.IsSucceededWithAlert=
ej);var li=null==Va.ba?null:Va.ba.toString();null!=li&&(Dd.EncounteredDeploymentErrors=li);var jk=null==Va.bb?null:Va.bb.toString();null!=jk&&(Dd.ShadowWorkbookSizeExceedsLimit=jk);var gl=Va.bc;null!=gl&&(Dd.CopyPasteTargetName=gl);var tk=Va.bd;null!=tk&&(Dd.CCPSliceName=tk);var hl=Va.be;null!=hl&&(Dd.SyncClipboardItemsKeys=hl);var yj=Va.bf;null!=yj&&(Dd.AsyncClipboardItemsKeys=yj);var uk=Va.bg;null!=uk&&(Dd.CopyPasteHandlerName=uk);var il=Va.bh;null!=il&&(Dd.SucceededPopulatingSystemClipboardSync=
il);var Ij=Va.bi;null!=Ij&&(Dd.SucceededPopulatingSystemClipboardAsync=Ij);var Vj=Va.bj;null!=Vj&&(Dd.Location=Vj);var gk=Va.bk;null!=gk&&(Dd.CopyContextId=gk);var Rj=null==Va.bl?null:Va.bl.toString();null!=Rj&&(Dd.ServerRequestTimeInMs=Rj);var vk=null==Va.bm?null:Va.bm.toString();null!=vk&&(Dd.EcsOperationDuration=vk);var hk=null==Va.bn?null:Va.bn.toString();null!=hk&&(Dd.EcsRequestDuration=hk);var Nk=null==Va.bo?null:Va.bo.toString();null!=Nk&&(Dd.WfeRequestDuration=Nk);var kk=null==Va.bp?null:
Va.bp.toString();null!=kk&&(Dd.OriginalSourceRangesCountExceedsLimit=kk);var Dl=null==Va.bq?null:Va.bq.toString();null!=Dl&&(Dd.UploadToClipServiceAttempted=Dl);var zj=null==Va.br?null:Va.br.toString();null!=zj&&(Dd.FloatingObjectType=zj);var Rl=null==Va.bs?null:Va.bs.toString();null!=Rl&&(Dd.IsCopyWithAsyncClipboardAPI=Rl);break;case 44:Jg="Paste";var jl=Va.a;null!=jl&&(Dd.UserSessionId=jl);var Ok=Va.b;null!=Ok&&(Dd.Trigger=Ok);var kl=Va.c;null!=kl&&(Dd.RibbonCommandName=kl);var lk=null==Va.d?null:
Va.d.toString();null!=lk&&(Dd.PasteTypeFlagValue=lk);var ll=Va.e;null!=ll&&(Dd.PasteOperationId=ll);var Sl=Va.f;null!=Sl&&(Dd.CopyOperationId=Sl);var Wj=Va.g;null!=Wj&&(Dd.ClientSideStopwatchId=Wj);var Pk=Va.h;null!=Pk&&(Dd.OriginalDestinationRange=Pk);var El=Va.i;null!=El&&(Dd.ExpandDestinationRange=El);var mk=Va.j;null!=mk&&(Dd.SourceItem=mk);var gi=null==Va.k?null:Va.k.toString();null!=gi&&(Dd.SourceRangeCellCount=gi);var ml=null==Va.l?null:Va.l.toString();null!=ml&&(Dd.IsSuccess=ml);var Fl=null==
Va.m?null:Va.m.toString();null!=Fl&&(Dd.IsExpectedError=Fl);var Qk=Va.n;null!=Qk&&(Dd.ClipboardFormatReadTimeInMs=Qk);var Rk=Va.o;null!=Rk&&(Dd.ClipboardFormatReadStatus=Rk);var Sk=null==Va.p?null:Va.p.toString();null!=Sk&&(Dd.ClipboardReadPermissionPromptShown=Sk);var Gl=null==Va.q?null:Va.q.toString();null!=Gl&&(Dd.AsyncApiReadTimedOut=Gl);var nl=Va.r;null!=nl&&(Dd.ExpectedErrorReason=nl);var Ti=Va.s;null!=Ti&&(Dd.ErrorMessage=Ti);var wk=null==Va.t?null:Va.t.toString();null!=wk&&(Dd.TotalTimeInMs=
wk);var nk=null==Va.u?null:Va.u.toString();null!=nk&&(Dd.PlainTextPayloadSize=nk);var Tk=null==Va.v?null:Va.v.toString();null!=Tk&&(Dd.ShadowWorkbookPayloadSize=Tk);var Hl=null==Va.w?null:Va.w.toString();null!=Hl&&(Dd.HtmlPayloadSize=Hl);var xk=Va.x;null!=xk&&(Dd.CopyPasteTargetType=xk);var Tl=null==Va.y?null:Va.y.toString();null!=Tl&&(Dd.IsLastCopyWasExternal=Tl);var Il=null==Va.z?null:Va.z.toString();null!=Il&&(Dd.IsClipboardDataContainShadowWorkbook=Il);var Ul=null==Va.ba?null:Va.ba.toString();
null!=Ul&&(Dd.IsShadowWorkbookParsedSuccessfully=Ul);var Vl=Va.bb;null!=Vl&&(Dd.ActiveSelectionType=Vl);var ol=Va.bc;null!=ol&&(Dd.PasteResult=ol);var yk=null==Va.bd?null:Va.bd.toString();null!=yk&&(Dd.ErrorReason=yk);var ek=Va.be;null!=ek&&(Dd.ErrorName=ek);var pl=null==Va.bf?null:Va.bf.toString();null!=pl&&(Dd.IsSucceededWithAlert=pl);var ql=null==Va.bg?null:Va.bg.toString();null!=ql&&(Dd.IsAfterCut=ql);var rl=null==Va.bh?null:Va.bh.toString();null!=rl&&(Dd.EncounteredDeploymentErrors=rl);var Uk=
null==Va.bi?null:Va.bi.toString();null!=Uk&&(Dd.IsCrossSession=Uk);var sl=null==Va.bj?null:Va.bj.toString();null!=sl&&(Dd.ShadowWorkbookSizeExceedsLimit=sl);var Wl=null==Va.bk?null:Va.bk.toString();null!=Wl&&(Dd.ClipboardContainXLOPayload=Wl);var zk=Va.bl;null!=zk&&(Dd.CopyPasteTargetName=zk);var Ak=Va.bm;null!=Ak&&(Dd.ChromeExtensionId=Ak);var Bk=Va.bn;null!=Bk&&(Dd.PayloadOrigin=Bk);var Jl=Va.bo;null!=Jl&&(Dd.PayloadType=Jl);var bk=Va.bp;null!=bk&&(Dd.CCPSliceName=bk);var Xj=Va.bq;null!=Xj&&(Dd.ClipboardItemsKeys=
Xj);var Jj=Va.br;null!=Jj&&(Dd.CopyPasteHandlerName=Jj);var Vk=null==Va.bs?null:Va.bs.toString();null!=Vk&&(Dd.IsSourceItemOriginSameSession=Vk);var Xl=Va.bt;null!=Xl&&(Dd.Location=Xl);var Kl=Va.bu;null!=Kl&&(Dd.ExternalAppSource=Kl);var Yl=Va.bv;null!=Yl&&(Dd.PasteContextId=Yl);var tl=null==Va.bw?null:Va.bw.toString();null!=tl&&(Dd.ServerRequestTimeInMs=tl);var Ck=null==Va.bx?null:Va.bx.toString();null!=Ck&&(Dd.IndicationDisplayScheduled=Ck);var ul=Va.by;null!=ul&&(Dd.PasteIndicationDisplayStatus=
ul);var ik=null==Va.bz?null:Va.bz.toString();null!=ik&&(Dd.PasteRecoveryUIDisplayed=ik);var Dk=null==Va.ca?null:Va.ca.toString();null!=Dk&&(Dd.IsFromPasteRecoveryUI=Dk);var Ll=null==Va.cb?null:Va.cb.toString();null!=Ll&&(Dd.EcsOperationDuration=Ll);var Ui=null==Va.cc?null:Va.cc.toString();null!=Ui&&(Dd.EcsRequestDuration=Ui);var Zl=null==Va.cd?null:Va.cd.toString();null!=Zl&&(Dd.WfeRequestDuration=Zl);var Wk=null==Va.ce?null:Va.ce.toString();null!=Wk&&(Dd.OriginalSourceRangesCountExceedsLimit=Wk);
var Ml=Va.cf;null!=Ml&&(Dd.PasteRecoveryUndoStopwatchId=Ml);var $l=null==Va.cg?null:Va.cg.toString();null!=$l&&(Dd.PasteRecoveryUndoTimeInMs=$l);var Nl=null==Va.ch?null:Va.ch.toString();null!=Nl&&(Dd.PasteCSEPerformed=Nl);var ok=null==Va.ci?null:Va.ci.toString();null!=ok&&(Dd.CSEStatus=ok);var Kj=null==Va.cj?null:Va.cj.toString();null!=Kj&&(Dd.IsFromEnterShortcut=Kj);var ui=null==Va.ck?null:Va.ck.toString();null!=ui&&(Dd.pasteDestinationHasMergedCells=ui);var Ek=Va.cl;null!=Ek&&(Dd.ArtSourceItemType=
Ek);var Xk=null==Va.cm?null:Va.cm.toString();null!=Xk&&(Dd.IsPasteWithAsyncClipboardAPI=Xk);var am=null==Va.cn?null:Va.cn.toString();null!=am&&(Dd.IsPasteWithChromiumExtension=am);break;case 45:Jg="DragDrop";var vl=Va.a;null!=vl&&(Dd.UserSessionId=vl);var Ol=Va.b;null!=Ol&&(Dd.Trigger=Ol);var ug=Va.c;null!=ug&&(Dd.RibbonCommandName=ug);var Fk=Va.d;null!=Fk&&(Dd.OperationId=Fk);var wl=Va.e;null!=wl&&(Dd.ClientSideStopwatchId=wl);var B=Va.f;null!=B&&(Dd.SourceRange=B);var ra=Va.g;null!=ra&&(Dd.DestinationRange=
ra);var vb=Va.h;null!=vb&&(Dd.CutCopyType=vb);var dc=null==Va.i?null:Va.i.toString();null!=dc&&(Dd.IsShiftKeyDown=dc);var Hc=null==Va.j?null:Va.j.toString();null!=Hc&&(Dd.IsDragInsert=Hc);var ed=null==Va.k?null:Va.k.toString();null!=ed&&(Dd.IsSuccess=ed);var Id=null==Va.l?null:Va.l.toString();null!=Id&&(Dd.IsExpectedError=Id);var Pd=Va.m;null!=Pd&&(Dd.ExpectedErrorReason=Pd);var Rd=Va.n;null!=Rd&&(Dd.ErrorMessage=Rd);var $d=null==Va.o?null:Va.o.toString();null!=$d&&(Dd.TotalTimeInMs=$d);var Ae=Va.p;
null!=Ae&&(Dd.ErrorName=Ae);var Ke=null==Va.q?null:Va.q.toString();null!=Ke&&(Dd.IsSucceededWithAlert=Ke);var Ze=Va.r;null!=Ze&&(Dd.CopyPasteTargetType=Ze);var cg=null==Va.s?null:Va.s.toString();null!=cg&&(Dd.EncounteredDeploymentErrors=cg);var Vf=null==Va.t?null:Va.t.toString();null!=Vf&&(Dd.IsHeaderDrag=Vf);break;case 46:Jg="ClearCopyState";var Xf=Va.a;null!=Xf&&(Dd.UserSessionId=Xf);var Pf=Va.b;null!=Pf&&(Dd.ClientSideStopwatchId=Pf);var Kg=Va.c;null!=Kg&&(Dd.Trigger=Kg);var oh=null==Va.d?null:
Va.d.toString();null!=oh&&(Dd.IsClearClipboard=oh);var Hg=null==Va.e?null:Va.e.toString();null!=Hg&&(Dd.IsExplicit=Hg);var Gh=null==Va.f?null:Va.f.toString();null!=Gh&&(Dd.IsSuccess=Gh);var xi=Va.g;null!=xi&&(Dd.ErrorMessage=xi);var Ah=Va.h;null!=Ah&&(Dd.ErrorName=Ah);var mi=null==Va.i?null:Va.i.toString();null!=mi&&(Dd.TotalTimeInMs=mi);var em=Va.j;null!=em&&(Dd.CopyPasteTargetType=em);break;case 47:Jg="WebWorkerRecalcStats";var Gk=null==Va.a?null:Va.a.toString();null!=Gk&&(Dd.SuccessCount=Gk);var fm=
null==Va.b?null:Va.b.toString();null!=fm&&(Dd.FailureCount=fm);var xl=null==Va.c?null:Va.c.toString();null!=xl&&(Dd.ValueTypeMismatchCount=xl);var gm=null==Va.d?null:Va.d.toString();null!=gm&&(Dd.CellValueMismatchCount=gm);var hm=null==Va.e?null:Va.e.toString();null!=hm&&(Dd.IfmtMismatchCount=hm);var om=null==Va.f?null:Va.f.toString();null!=om&&(Dd.FormattedTextMismatchCount=om);var bm=null==Va.g?null:Va.g.toString();null!=bm&&(Dd.CellValueStringMismatchCount=bm);var Yk=null==Va.h?null:Va.h.toString();
null!=Yk&&(Dd.CellValueNumberMismatchCount=Yk);var im=null==Va.i?null:Va.i.toString();null!=im&&(Dd.CellValueBooleanMismatchCount=im);var jm=null==Va.j?null:Va.j.toString();null!=jm&&(Dd.CellValueBlankMismatchCount=jm);var cm=null==Va.k?null:Va.k.toString();null!=cm&&(Dd.CellValueErrorMismatchCount=cm);var km=null==Va.l?null:Va.l.toString();null!=km&&(Dd.FormattedTextStringMismatchCount=km);var pm=null==Va.m?null:Va.m.toString();null!=pm&&(Dd.FormattedTextNumberMismatchCount=pm);var lm=null==Va.n?
null:Va.n.toString();null!=lm&&(Dd.FormattedTextBooleanMismatchCount=lm);var dm=null==Va.o?null:Va.o.toString();null!=dm&&(Dd.FormattedTextBlankMismatchCount=dm);var I=null==Va.p?null:Va.p.toString();null!=I&&(Dd.FormattedTextErrorMismatchCount=I);var pa=null==Va.q?null:Va.q.toString();null!=pa&&(Dd.StringMismatchCount=pa);var lb=null==Va.r?null:Va.r.toString();null!=lb&&(Dd.NumericMismatchCount=lb);var hc=null==Va.s?null:Va.s.toString();null!=hc&&(Dd.ErrorMismatchCount=hc);var Xc=null==Va.t?null:
Va.t.toString();null!=Xc&&(Dd.StringValuesCount=Xc);var Gd=null==Va.u?null:Va.u.toString();null!=Gd&&(Dd.NumericValuesCount=Gd);var ae=null==Va.v?null:Va.v.toString();null!=ae&&(Dd.BooleanValuesCount=ae);var we=null==Va.w?null:Va.w.toString();null!=we&&(Dd.BlankValuesCount=we);var Re=null==Va.x?null:Va.x.toString();null!=Re&&(Dd.ErrorValuesCount=Re);var lf=null==Va.y?null:Va.y.toString();null!=lf&&(Dd.NumericValuesDiffAverage=lf);var hg=Va.z;null!=hg&&(Dd.NumericEvaluatedValuesMismatchSamples=hg);
var Wg=Va.ba;null!=Wg&&(Dd.NumericFormattedTextMismatchSamples=Wg);var mg=Va.bb;null!=mg&&(Dd.NumericMismatchSamples=mg);var Xg=Va.bc;null!=Xg&&(Dd.CellValueTypeMismatchSamples=Xg);var hi=Va.bd;null!=hi&&(Dd.IfmtMismatchSamples=hi);var Nj=Va.be;null!=Nj&&(Dd.BlockHashCode=Nj);break;case 48:Jg="DataValidationEditOpenDialog";var yi=Va.a;null!=yi&&(Dd.ServerCommand=yi);var Li=null==Va.b?null:Va.b.toString();null!=Li&&(Dd.SubDialogOpened=Li);var zi=Va.c;null!=zi&&(Dd.SubDialogButtonClicked=zi);var pk=
null==Va.d?null:Va.d.toString();null!=pk&&(Dd.DialogOpened=pk);var Aj=Va.e;null!=Aj&&(Dd.RuleType=Aj);var Zk=Va.f;null!=Zk&&(Dd.ConditionType=Zk);var Pl=null==Va.g?null:Va.g.toString();null!=Pl&&(Dd.LowerBoundaryFilled=Pl);var mm=null==Va.h?null:Va.h.toString();null!=mm&&(Dd.UpperBoundaryFilled=mm);var nm=null==Va.i?null:Va.i.toString();null!=nm&&(Dd.IgnoreBlank=nm);var vm=null==Va.j?null:Va.j.toString();null!=vm&&(Dd.InCellDropdown=vm);var wm=null==Va.k?null:Va.k.toString();null!=wm&&(Dd.ShowInputMessage=
wm);var xm=null==Va.l?null:Va.l.toString();null!=xm&&(Dd.InputTitleFilled=xm);var ym=null==Va.m?null:Va.m.toString();null!=ym&&(Dd.InputMessageFilled=ym);var zm=null==Va.n?null:Va.n.toString();null!=zm&&(Dd.ShowErrorAlert=zm);var Am=null==Va.o?null:Va.o.toString();null!=Am&&(Dd.AlertBlocking=Am);var Bm=null==Va.p?null:Va.p.toString();null!=Bm&&(Dd.AlertTitleFilled=Bm);var Cm=null==Va.q?null:Va.q.toString();null!=Cm&&(Dd.AlertMessageFilled=Cm);var Dm=Va.r;null!=Dm&&(Dd.StopWatchId=Dm);break;case 49:Jg=
"DataValidationEditSubmitRule";var Em=Va.a;null!=Em&&(Dd.RuleType=Em);var Fm=Va.b;null!=Fm&&(Dd.ConditionType=Fm);var Gm=null==Va.c?null:Va.c.toString();null!=Gm&&(Dd.LowerBoundaryFilled=Gm);var Hm=null==Va.d?null:Va.d.toString();null!=Hm&&(Dd.UpperBoundaryFilled=Hm);var Im=null==Va.e?null:Va.e.toString();null!=Im&&(Dd.IgnoreBlank=Im);var Jm=null==Va.f?null:Va.f.toString();null!=Jm&&(Dd.InCellDropdown=Jm);var Km=null==Va.g?null:Va.g.toString();null!=Km&&(Dd.ShowInputMessage=Km);var Lm=null==Va.h?
null:Va.h.toString();null!=Lm&&(Dd.InputTitleFilled=Lm);var Mm=null==Va.i?null:Va.i.toString();null!=Mm&&(Dd.InputMessageFilled=Mm);var Nm=null==Va.j?null:Va.j.toString();null!=Nm&&(Dd.ShowErrorAlert=Nm);var Om=null==Va.k?null:Va.k.toString();null!=Om&&(Dd.AlertBlocking=Om);var Pm=null==Va.l?null:Va.l.toString();null!=Pm&&(Dd.AlertTitleFilled=Pm);var Qm=null==Va.m?null:Va.m.toString();null!=Qm&&(Dd.AlertMessageFilled=Qm);var Rm=null==Va.n?null:Va.n.toString();null!=Rm&&(Dd.ClearAllPressed=Rm);var Sm=
Va.o;null!=Sm&&(Dd.ActionStatus=Sm);var Tm=Va.p;null!=Tm&&(Dd.Error=Tm);var Um=Va.q;null!=Um&&(Dd.StopWatchId=Um);var Vm=null==Va.r?null:Va.r.toString();null!=Vm&&(Dd.InsertDropdownButton=Vm);break;case 50:Jg="CustomSort";var Wm=Va.a;null!=Wm&&(Dd.RangeType=Wm);var Xm=null==Va.b?null:Va.b.toString();null!=Xm&&(Dd.HasHeaders=Xm);var Ym=null==Va.c?null:Va.c.toString();null!=Ym&&(Dd.SortTopToBottom=Ym);var Zm=null==Va.d?null:Va.d.toString();null!=Zm&&(Dd.ColumnCount=Zm);var $m=null==Va.e?null:Va.e.toString();
null!=$m&&(Dd.RowCount=$m);var an=null==Va.f?null:Va.f.toString();null!=an&&(Dd.RangeLimitExceeded=an);var bn=null==Va.g?null:Va.g.toString();null!=bn&&(Dd.CaseSensitive=bn);var cn=null==Va.h?null:Va.h.toString();null!=cn&&(Dd.GetSortInfoDuration=cn);var dn=null==Va.i?null:Va.i.toString();null!=dn&&(Dd.LevelCount=dn);var en=null==Va.j?null:Va.j.toString();null!=en&&(Dd.SortOnValuesCount=en);var fn=null==Va.k?null:Va.k.toString();null!=fn&&(Dd.SortOnCellColorCount=fn);var gn=null==Va.l?null:Va.l.toString();
null!=gn&&(Dd.SortOnFontColorCount=gn);var hn=null==Va.m?null:Va.m.toString();null!=hn&&(Dd.SortOnIconCount=hn);var jn=null==Va.n?null:Va.n.toString();null!=jn&&(Dd.CustomOrderCount=jn);var kn=null==Va.o?null:Va.o.toString();null!=kn&&(Dd.AvgCellColorCount=kn);var ln=null==Va.p?null:Va.p.toString();null!=ln&&(Dd.MaxCellColorCount=ln);var mn=null==Va.q?null:Va.q.toString();null!=mn&&(Dd.AvgFontColorCount=mn);var nn=null==Va.r?null:Va.r.toString();null!=nn&&(Dd.MaxFontColorCount=nn);var on=null==Va.s?
null:Va.s.toString();null!=on&&(Dd.AvgIconsCount=on);var pn=null==Va.t?null:Va.t.toString();null!=pn&&(Dd.MaxIconsCount=pn);var qn=null==Va.u?null:Va.u.toString();null!=qn&&(Dd.Executed=qn);break;case 51:Jg="NamedSheetViewUserAction";var rn=Va.a;null!=rn&&(Dd.UserSessionId=rn);var sn=Va.b;null!=sn&&(Dd.UserActionName=sn);var tn=null==Va.c?null:Va.c.toString();null!=tn&&(Dd.UserActionSource=tn);var un=Va.d;null!=un&&(Dd.UserActionData=un);var vn=Va.e;null!=vn&&(Dd.OtherData=vn);break;case 52:Jg="NamedSheetViewTeachingCallout";
var wn=Va.a;null!=wn&&(Dd.UserSessionId=wn);var xn=null==Va.b?null:Va.b.toString();null!=xn&&(Dd.TeachingCalloutSequence=xn);var yn=null==Va.c?null:Va.c.toString();null!=yn&&(Dd.TeachingCalloutIndex=yn);var zn=null==Va.d?null:Va.d.toString();null!=zn&&(Dd.UserActionName=zn);var An=Va.e;null!=An&&(Dd.UserActionData=An);var Bn=null==Va.f?null:Va.f.toString();null!=Bn&&(Dd.DurationInMs=Bn);break;case 53:Jg="NamedSheetViewTeachingDialog";var Cn=Va.a;null!=Cn&&(Dd.UserSessionId=Cn);var Dn=Va.b;null!=Dn&&
(Dd.UserActionName=Dn);var En=Va.c;null!=En&&(Dd.ButtonClicked=En);var Fn=null==Va.d?null:Va.d.toString();null!=Fn&&(Dd.DurationInMs=Fn);var Gn=null==Va.e?null:Va.e.toString();null!=Gn&&(Dd.IsNewTeachingDialog=Gn);break;case 54:Jg="NamedSheetViewOptionsDialog";var Hn=Va.a;null!=Hn&&(Dd.UserSessionId=Hn);var In=null==Va.b?null:Va.b.toString();null!=In&&(Dd.OptionsAction=In);var Jn=Va.c;null!=Jn&&(Dd.OptionsActionData=Jn);var Kn=Va.d;null!=Kn&&(Dd.OptionsOtherData=Kn);var Ln=null==Va.e?null:Va.e.toString();
null!=Ln&&(Dd.DurationInMs=Ln);break;case 55:Jg="NamedSheetViewTempViewSaveDialog";var Mn=Va.a;null!=Mn&&(Dd.UserSessionId=Mn);var Nn=Va.b;null!=Nn&&(Dd.TriggeredFrom=Nn);var On=Va.c;null!=On&&(Dd.ButtonClicked=On);var Pn=null==Va.d?null:Va.d.toString();null!=Pn&&(Dd.NameUpdated=Pn);var Qn=null==Va.e?null:Va.e.toString();null!=Qn&&(Dd.DurationInMs=Qn);break;case 56:Jg="TemporaryViewStartedDataRestore";var Rn=Va.a;null!=Rn&&(Dd.UserSessionId=Rn);var Sn=null==Va.b?null:Va.b.toString();null!=Sn&&(Dd.CountOfTempViews=
Sn);break;case 57:Jg="TemporaryViewFetchedVersion";var Tn=Va.a;null!=Tn&&(Dd.UserSessionId=Tn);var Un=null==Va.b?null:Va.b.toString();null!=Un&&(Dd.NumberOfBytes=Un);break;case 58:Jg="RaiseEventsAndGenerateBlockRequests";var Vn=null==Va.a?null:Va.a.toString();null!=Vn&&(Dd.ReturnContentStatus=Vn);var Wn=null==Va.b?null:Va.b.toString();null!=Wn&&(Dd.CacheState=Wn);var Xn=null==Va.c?null:Va.c.toString();null!=Xn&&(Dd.FromXhrCallback=Xn);var Yn=null==Va.d?null:Va.d.toString();null!=Yn&&(Dd.AreGeneralErrorsPresent=
Yn);var Zn=Va.e;null!=Zn&&(Dd.BlockCacheItemHash=Zn);var $n=Va.f;null!=$n&&(Dd.StopwatchId=$n);var ao=Va.g;null!=ao&&(Dd.BlockCacheItemProcessingStopwatchId=ao);var bo=null==Va.h?null:Va.h.toString();null!=bo&&(Dd.StateId=bo);var co=null==Va.i?null:Va.i.toString();null!=co&&(Dd.IsHighPriority=co);var eo=null==Va.j?null:Va.j.toString();null!=eo&&(Dd.CalcComplete=eo);var fo=null==Va.k?null:Va.k.toString();null!=fo&&(Dd.EditedCellsUpdatedByCse=fo);var go=null==Va.l?null:Va.l.toString();null!=go&&(Dd.DependentCellsUpdatedByCse=
go);var ho=null==Va.m?null:Va.m.toString();null!=ho&&(Dd.Revision=ho);var io=null==Va.n?null:Va.n.toString();null!=io&&(Dd.SheetProcessedDataVersion=io);var jo=null==Va.o?null:Va.o.toString();null!=jo&&(Dd.RefCount=jo);var ko=null==Va.p?null:Va.p.toString();null!=ko&&(Dd.ExistsInView=ko);var lo=null==Va.q?null:Va.q.toString();null!=lo&&(Dd.ContentSource=lo);break;case 59:Jg="LaunchMakerCodeEditor";var mo=Va.a;null!=mo&&(Dd.SessionId=mo);var no=Va.b;null!=no&&(Dd.Command=no);var oo=null==Va.c?null:
Va.c.toString();null!=oo&&(Dd.IsPreviewGallery=oo);var po=Va.d;null!=po&&(Dd.MenuItemId=po);var qo=Va.e;null!=qo&&(Dd.ScriptId=qo);var ro=Va.f;null!=ro&&(Dd.ShareId=ro);var so=null==Va.g?null:Va.g.toString();null!=so&&(Dd.IsOwner=so);var to=null==Va.h?null:Va.h.toString();null!=to&&(Dd.PublishedScriptCount=to);var uo=null==Va.i?null:Va.i.toString();null!=uo&&(Dd.RecentScriptCount=uo);var vo=null==Va.j?null:Va.j.toString();null!=vo&&(Dd.WorkbookScriptCount=vo)}Dd.Table=Jg;var Bo=Sys.Serialization.JavaScriptSerializer.serialize(Dd);
se.call(je,3704927,0,50,Bo)}}catch(Dd){O.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${fb} exception: ${Dd}`)}}YEd(fb,Va,bd){if(this.sSc){const je=this.ldb[fb+Va];je&&(je.e=bd,this.THd(je));delete this.ldb[fb+Va]}}P3d(fb,Va){De[fb]in this.qag||this.Ol(fb,Va)}J7j(){this.$p.appStart&&this.aZg(Dg.Ice,this.$p.appStart)}kDj(fb){const Va={};Va.a=fb.i;Va.b=fb.o;Va.c=fb.t;Va.d=Kf.a(fb.s,fb.p||this.$p.appStart);Va.e=Kf.a(fb.e,fb.s);Va.f=fb.c;Va.g=fb.a;Va.h=fb.h;this.Ol(0,Va,this.Mpj(Va.b,
Va.c))}Mpj(fb,Va){return["CommandTask","QueuedTask","Task"].includes(fb)&&!this.Qti.includes(Va)?!1:!0}JI(fb,Va,bd,je,se){if(fb&&Va){const Xe={};Xe.a=fb;Xe.b=Va;Xe.c=bd.toString();Xe.d=je.toString();this.Ol(15,Xe,void 0===se?!0:se)}}Y$f(fb,Va,bd,je){const se={};fb&&(se.c=Kf.a(fb,this.$p.appStart));se.b=Va;se.a=bd;se.d=je;this.Ol(17,se)}dispose(){this.tPa.execute(fb=>{fb.deactivate(!0);fb.ook(this.Cqg)});this.Lk&&this.Lk.Gvb(this.nZ);super.dispose()}NOf(){return this.T$g=this.T$g||new Wc}Enf(fb,Va,
bd,je,se){const Xe={};Xe.o=fb;Xe.t=Va;Xe.p=void 0===se?null:se;Xe.s=(void 0===je?null:je)||this.$p.Xj;this.BUd(Xe,void 0===bd?null:bd);return Xe}ajf(fb,Va){fb&&(fb.e=(void 0===Va?null:Va)||this.$p.Xj,fb.i=fb.i||this.qib.zrb(),fb.c=fb.c||this.fof,fb.a=fb.a||this.pof,fb.h=void 0!==fb.h&&null!==fb.h?fb.h:this.Lk?this.Lk.Xn:!1,this.THd(fb))}gag(fb){const Va=fb.context;fb.duration>Dg.Nji&&(Va.methodName===$a.a.nTb||Va.methodName===$a.a.AKa)&&this.uWc(1,Dg.mVi);if("GetSessionStatus"!==Va.methodName){const bd=
{};bd.a=Va.methodName;bd.b=Va.stopwatch.id;bd.c=fb.HWc;bd.d=fb.responseSize;bd.e=Va.tXa;bd.f=fb.lk?fb.lk.StateId:$a.a.dAe;this.Ol(30,bd,!0);this.JI(bd.b,fb.lk.ServerCorrelationId,"clientWebRequests","ServerActions")}}NZg(){if(this.sSc){const fb=this.ldb.LoadingUIShownSplashScreen;fb&&Ka.a.instance.$Gk(fb.s)}}uWc(fb,Va){this.s9g.B6b(fb,Va,null)}eIg(fb){this.u9g.Ile(fb,null)}fIg(fb,Va){this.u9g.B6b(fb,Va,null)}pWc(fb,Va,bd){this.cab.pWc(fb,Va,void 0===bd?null:bd)}yWc(fb,Va,bd){this.cab.yWc(fb,Va,void 0===
bd?null:bd)}f8b(fb,Va,bd,je,se,Xe,wf,...Nf){this.cab.f8b(fb,Va,bd,je,se,Xe,wf,...Nf)}AYc(fb,Va,bd,je,se,Xe,wf){this.cab.AYc(fb,Va,bd,je,se,Xe,wf)}h8b(fb,Va,bd,je,se,Xe){this.cab.h8b(fb,Va,bd,je,se,Xe)}g8b(fb,Va,bd,je,se,Xe,...wf){this.cab.g8b(fb,Va,bd,je,se,Xe,...wf)}i8b(fb,Va,bd,je,se,Xe){this.s9g.i8b(fb,Va,bd,je,se,Xe)}BYc(fb,Va,bd,je){this.cab.BYc(fb,Va,bd,je)}THd(fb){this.QXk.kDj(fb)}K7j(){if(this.sSc){Stw.swpc=null;const fb=this.sSc;for(const Va in fb)this.BUd(fb[Va])}}ixi(){const fb=window[Pe.a.namespace];
if(fb){const Va=fb[Pe.a.aif];Va&&(delete fb[Pe.a.aif],Va.forEach(bd=>{this.BUd(bd);this.THd(bd)}))}}lrj(fb,Va){if("about:blank"===fb||"renamehandler.ashx"===Va&&"2"===Qb.a.Ey(fb,"u"))return!0;for(fb=0;fb<this.Xle.length;fb++)if(Va.endsWith(this.Xle[fb]))return!0;return!1}AAj(){this.tPa.execute(fb=>{fb.co(Dg.EMh,0);fb.jDh(this.Cqg);fb.activate()})}rAj(){const fb={};fb.a=new Date(ld.EcmaDateClock.instance.appStart.m);fb.b=this.userSessionId;fb.c=this.$p.U1g;fb.d=Dg.ddi*Nb.devicePixelRatio;fb.e=z.a.kh.appStart.m;
this.Ol(14,fb,!0);this.ipa(z.a.kh.appStart.m,Object(ad.a)(Rb.a.instance,Rb.a.instance.Ahk,"recordAppInitStart"))}aZg(fb,Va){this.AAb=this.qib.zrb();this.bcc=this.qib.zrb();this.RSa=fb;this.S0c("UserAction",fb,this.bcc,Va);this.K9f(fb,this.AAb)}k_k(){const fb=window[Pe.a.namespace];fb&&!Dg.Glf&&(fb[Pe.a.SWk]=(Va,bd)=>this.Enf(Va,bd),fb[Pe.a.hmi]=Va=>{this.ajf(Va)},Dg.Glf=!0)}O8k(fb){const Va=vg.sQh(fb.o,fb.t),bd=new vg(Kf.a(fb.e,fb.s)),je=Va in this.vwe?this.vwe[Va].I_h(bd):bd;this.vwe[Va]=je;if(bd===
je||bd.average!==je.average)fb=Object(oa.a)(new kg,{operation:fb.o,target:fb.t,YKj:je.average,sender:this}),this.raiseEvent(Va,fb)}K9f(fb,Va){const bd={};bd.a=Va;bd.b=this.userSessionId;bd.c=fb;this.Ol(1,bd,!0)}idj(){this.Xle=[$a.a.Blk,$a.a.getSessionStatus,$a.a.AKa,$a.a.s_h,$a.a.cXh,$a.a.pAb,$a.a.xCc,$a.a.getObjectMetadata,$a.a.GSi,$a.a.setRichTextCell,$a.a.HKa,$a.a.Ecl,$a.a.pollSessionStatus,$a.a.LYi,$a.a.AWi,$a.a.pPi]}BUd(fb,Va){fb.i=(void 0===Va?null:Va)||this.qib.zrb();fb.a=this.pof;fb.c=this.fof;
fb.h=this.Lk?this.Lk.Xn:!1}static Ga(fb){const Va=new Dg(fb.ua.UserSessionId,fb.qa,void 0,void 0,void 0,!0);Va.K9f(Dg.egg,Va.apf);O.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Va.AAj();Va.k_k();Va.J7j();Va.rAj();Va.ixi();Va.K7j();Va.idj();Dg.CEk(fb);ma.a.Yx.Rh(41,Va)}static CEk(fb){const Va=Nb.devicePixelRatio;1<Va&&fb.Kh.gF(!0,2<=Va?8388608:4194304)}}Dg.egg="UnassignedUserAction";Dg.Ice="PageLoad";Dg.XQd="GridUpdateOperation";Dg.Nji=5E3;Dg.mVi=
"MoreThan_5000_Ms";Dg.ddi=96;Dg.EMh=30;Dg.Glf=!1;Object(t.a)(Dg,"TelemetryManager",x.a,[17,18,660,661]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");aa.main();Type.registerNamespace("CNT");wc.main();Type.registerNamespace("CACPU");Jc.main();Type.registerNamespace("Common.App.EventsCacheManager");tb.main();(()=>{zc.a.hh(fb=>{D.pd.Ma()||fb.qa.Rh(137,new od(fb))})})();(()=>{zc.a.hh(fb=>{fb.qa.Rh(37,new Ff(fb))})})();(()=>{zc.a.hh(fb=>{fb.qa.Rh(40,new V(fb,new Oc.a(()=>
D.pd.Ma()?Object(Fa.d)(G.a.resolve(D.pd,{va:1})):Wf.GetServiceTaskFactory.create(fb.qa,137,fb.ya,1))))})})();(()=>{zc.a.hh(fb=>{fb.qa.Rh(276,new qc(fb))})})();(()=>{zc.a.hh(fb=>{ma.a.Yx.zi(135,()=>{Dg.Ga(fb);Za.Ga(fb);J.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")||xc.Ga(fb);xa.Ga(fb);J.EwaSettings.isChangeGateEnabled("OfficeVSO:8680491_MigrateRenderingFidelityTracker")||Ia.RenderingFidelityTracker.Ga(fb)})})})();String(e);String(k);String(d);String(u);String(n);
String(Ia);String(v);String(f);String(w);window.___1712031311723_closurehack=e;window.___1712031311723_closurehack=k;window.___1712031311723_closurehack=d;window.___1712031311723_closurehack=u;window.___1712031311723_closurehack=n;window.___1712031311723_closurehack=Ia;window.___1712031311723_closurehack=v;window.___1712031311723_closurehack=f;window.___1712031311723_closurehack=w},951:function(y,m,a){a.d(m,"a",function(){return w});y=a(0);var c=a(6),b=a(79),e=a(34),k=a(191);class d{constructor(r,
t){this.message=r;this.bJa=t}}Object(y.a)(d,"CrossDocumentEventArgs",null,[]);var u=a(975),n=a(397),v=a(294),f=a(974);class w{constructor(r,t,l,x){this._name="";this.fC={};this.oea=null;this.ackMessageHandler=A=>{A=A.CorrelationId;""!==A&&A in this.fC&&(f.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.fC[A],A),this.fC[A]="ACK_RECEIVED")};this.w0b=A=>{const z=this.YSb(A);if(!z)return!1;if(this.gs[z.MessageId])return this.kR.yLa(this.gs[z.MessageId],z),!0;if(this.Gt[z.MessageId]){const F=
this.Gt[z.MessageId];A=new d(z,A);this.kR.cWb(F,A);return!0}return!1};this.pR=[];this.eR=[];this.fR=[];this.nR=[];this.UFa=r;this.SFa=t;this.gs={};this.Gt={};this.kR=l;w._id++;x&&x();this.mv=this.enable()}get targetOrigin(){return this.SFa}get QQa(){return this.UFa}enable(){if(!v.a())return f.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.WVb();f.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.mv}WVb(){f.a.debugAssertTag(5018253,!!this.kR,null);this.oea=
this.w0b;this.kR.rWa(this.oea,null)}disable(){this.mv=!1;this.pR=[];this.eR=[];this.fR=[];this.nR=[];this.UFa=null;this.SFa="";this.kR.NYa(this.oea);this.gs={};this.Gt={}}dispose(){this.disable()}xha(r){return!!this.pR&&Array.contains(this.pR,r)||this.QLa(r)}QLa(r){return!!this.eR&&Array.contains(this.eR,r)}kr(r){f.a.debugAssertTag(5018259,!!this.pR,null);Array.add(this.pR,r);f.a.sendTraceTag(5018260,2,"Allow receiving : {0}",r)}AVa(r){f.a.debugAssertTag(5018261,!!this.eR,null);Array.add(this.eR,
r);f.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",r)}QXb(r){return!!this.fR&&Array.contains(this.fR,r)}wX(r){f.a.debugAssertTag(5018263,!!this.fR,null);Array.add(this.fR,r);f.a.sendTraceTag(5018264,2,"Allow free sending: {0}",r)}aYb(r){r=b.a.getOrigin(r);return!!r&&!!this.nR&&Array.contains(this.nR,r)}xX(r){f.a.debugAssertTag(5018265,!!this.nR,null);if(r===w.iM)return f.a.debugAssertTag(5018266,!1,null),!1;let t=b.a.getOrigin(r);if(!t)return f.a.sendTraceTag(5018267,4,"Get origin fail:{0}",
r),!1;c.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(t=e.a.As(t));Array.add(this.nR,t);f.a.sendTraceTag(5018268,2,"Add origin:{0}",t);return!0}send(r,t){t=void 0===t?null:t;let l=this.targetOrigin;if(t){t=b.a.getOrigin(t);if(!t)return!1;l=t}return this.bda(r,this.QQa,l)}sendMessage(r,t,l){l=(l=void 0===l?"":l)&&""!==l?l:k.a.create().toString();return this.send(this.via(r,t,l,c.AFrameworkApplication.userSessionId))}postMessage(r){const t=
k.a.create().toString();if(!c.AFrameworkApplication.ea.ka("RetryablePostMessagingIsEnabled")||!r.cra)return this.send(this.via(r.messageId,r.values,t,r.userSessionId));this.gs[r.o$]||(this.kr(r.o$),this.pq(r.o$,this.ackMessageHandler));this.fC[t]="";return this.xOa(r,t,1)}xOa(r,t,l){if(""!==t&&t in this.fC&&"ACK_RECEIVED"===this.fC[t])return delete this.fC[t],!0;if(l>r.UP)return f.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',r.o$,t),delete this.fC[t],
!1;f.a.sendTraceTag(40716251,1<l?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',r.UP-l,r.messageId,t);l++;window.setTimeout(()=>{this.xOa(r,t,l)},r.Nnd);r.values[n.a.Lnd]=!0;return this.send(this.via(r.messageId,r.values,t,r.userSessionId))}via(r,t,l,x){r=new u.a(r);r.CorrelationId=l;t&&(r.Values=t);r.Values.wdUserSession=x;return r}bda(r,t,l){f.a.debugAssertTag(5018269,!!r,null);if(!this.mv)return!1;f.a.debugAssertTag(5018270,!!t,null);f.a.debugAssertTag(5018271,
!!l,null);if(!t||!l)return f.a.debugAssertTag(5018272,!1,null),!1;if(l===w.iM&&!this.QXb(r.MessageId))return f.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:r.MessageId}),!1;r.SendTime=(new Date).getTime();let x="";try{x=Sys.Serialization.JavaScriptSerializer.serialize(r)}catch(A){return f.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:A.message}),!1}t=w.sendMessage(t,x,l);f.a.sendTraceTag(5018275,2,"Send {0}. {1}",t?"succeeded":"failed",{["id"]:r.MessageId,["origin"]:l});
return t}pq(r,t){f.a.debugAssertTag(5018304,!!t,null);f.a.debugAssertTag(5018305,!!this.gs&&!!this.Gt,null);if(!this.mv)return!1;if(!this.xha(r))return f.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:r}),!1;this.gs[r]!==t&&(f.a.debugAssertTag(5018307,!this.gs[r]&&!this.Gt[r],null),this.gs[r]=t,delete this.Gt[r]);return!0}registerEventCallback(r,t){f.a.debugAssertTag(40420062,!!t,null);f.a.debugAssertTag(40420063,!!this.Gt&&!!this.gs,null);if(!this.mv)return!1;if(!this.xha(r))return f.a.sendTraceTag(40420064,
2,"Not allow receiving {0}",{["id"]:r}),!1;this.Gt[r]!==t&&(f.a.debugAssertTag(40420065,!this.gs[r]&&!this.Gt[r],null),this.Gt[r]=t,delete this.gs[r]);return!0}RT(r){this.mv&&(this.gs[r]&&delete this.gs[r],this.Gt[r]&&delete this.Gt[r])}YSb(r){const t=new Date;this.x_b(r);if(!r.origin||!r.source||void 0===r.data||null===r.data)return f.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const l=this.sZb(r.data);if(!l)return null;if(!this.aYb(r.origin)){if(!this.QLa(l.MessageId))return f.a.sendTraceTag(5018309,
1,"{0}",{["id"]:l.MessageId}),null;if(r.source!==this.QQa)return f.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}f.a.debugAssertTag(5018311,!!l.Values,null);l.Values.m_Source=r.source;l.Values.m_Origin=r.origin;l.Values.m_ReceivedTime=t.getTime();return l}sZb(r){if(!r)return null;let t=null;try{t=Sys.Serialization.JavaScriptSerializer.deserialize(r,!0)}catch(A){return 2>w.iEa&&(f.a.sendTraceTag(5018312,2,"Deser failed"),w.iEa++),null}if(!t)return f.a.debugAssertTag(5018313,
!1,null),null;for(r=0;r<w.D0.length;r++)if(!t[w.D0[r]])return"MessageId"!==w.D0[r]&&f.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",w.D0[r]),null;if(t.Values)try{t.Values}catch(A){return f.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",A.message),null}else f.a.sendTraceTag(41502556,2,"No values in message");r=t.MessageId;if(!this.xha(r))return f.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:r}),null;const l=t.SendTime,x=(new Date).getTime()-l;if(0>l)return f.a.sendTraceTag(520435660,
2,"{0}",{["t"]:l,["id"]:r}),null;6E4<x&&f.a.sendTraceTag(520435659,2,"{0}",{["t"]:l,["delta"]:x,["id"]:r});-300>x&&f.a.sendTraceTag(520435658,2,"{0}",{["t"]:l,["delta"]:x,["id"]:r});r=new u.a;r.MessageId=t.MessageId;r.SendTime=t.SendTime;r.CorrelationId=t.CorrelationId;t.Values&&(r.Values=t.Values);f.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",r.MessageId,r.SendTime,r.CorrelationId);return r}x_b(r){f.a.sendTraceTag(5018318,1,String.format("Received: {0}",
{["origin"]:r.origin,["data"]:r.data,["source"]:r.source}))}static sendMessage(r,t,l){if(!v.a())return f.a.debugAssertTag(5018319,!1,null),!1;try{return r.postMessage(t,l),!0}catch(x){f.a.sendTraceTag(5018320,4,"{0}",{["exception"]:x.message})}return!1}}w.D0=["MessageId","SendTime"];w.iM="*";w._id=0;w.iEa=0;Object(y.a)(w,"CrossDocumentMessenger",null,[2,441])},961:function(y,m,a){a.d(m,"a",function(){return k});y=a(0);var c=a(1),b=a(92),e=a(5);class k{static RVf(d){k.$=d;c.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void b.a.resolve(e.Db).then(u=>{k.Lk=u}):k.$.qa.zi(291,u=>{k.Lk=u})}static nxa(d,u){return d[Math.round((d.length-1)*u/100)]}static iN(d){return k.Lk?k.Lk.iN(d):!1}}k.Lk=null;k.$=null;Object(y.a)(k,"SessionStatisticsManagerHelper",null,[])},974:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{static e8b(){}static rOb(){}}c.sendTraceTag=c.e8b;c.debugAssertTag=c.rOb;Object(y.a)(c,"BULS",null,[])},975:function(y,m,a){a.d(m,"a",function(){return c});y=a(0);class c{constructor(b){this.MessageId=
b;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(y.a)(c,"CrossDocumentMessage",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/87eebccc748f066cd51e0079b8fb9ee8/EwaTS.tm.js.map